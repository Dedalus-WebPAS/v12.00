.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.02.01 19.05.2011 Sandra Barcham   239574
.           New printer/department table mods
.-------------------------------------------------------
. V9.04.01  13.04.2005 Peter Vela CAR 59696
.           Recompiled for SINSUAFD
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B02 21.02.2001 Sandra Barcham
.           Print Print Name & Store Initial
. VF.09.B01 20.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.01  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  03.11.1999 Sandra Barcham
.           Change locked message to use X
.-------------------------------------------------------
MYCOL     FORM      2
MYVERT    FORM      2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN56
.   Function      :   Print Receivals                         
.   Generated  On :   19/05/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       IBAPRNFD/INC
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCIEFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINPOAFD/INC
          INC       SINPOBFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINPOFFD/INC
          INC       SINRCPFD/INC
          INC       SINSCDFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINTRNFD/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMLAB   DIM       7 * Scr 03 Fld     4
TOLAB     DIM       7 * Scr 03 Fld     6
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN56"
PRGNAM    INIT      "Print Receivals                         "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SELPRT00
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          MOVE      "   24",AUDTSECT
          MOVE      "219",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudsa";
            OPEN      SINAUDSA,"sinaudsa"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA4,"sincicaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpobaf";
          OPEN      SINPOBA1,"sinpobaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA8,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA1,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA2,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA3,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA4,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinrcpaf";
          OPEN      SINRCPA1,"sinrcpaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA1,"sintrnaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA2,"sintrnaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Screen                        
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Print Receival                     
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Print Range of Receivals           
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Print All Receivals Not Yet Printed
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Screen                        
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      ONAT0000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Screen                        
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Screen                        
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Screen                        
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Screen                        
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Screen                        
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Screen                        
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Screen                        
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SINRECPR
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Print Receival                     
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETACCEP
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print Receival                     
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SIPAPON 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print Receival                     
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print Receival                     
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print Receival                     
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print Receival                     
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print Receival                     
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Print Receival                     
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SINPRT00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCODS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Print Range of Receivals           
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      SETACCEP
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print Range of Receivals           
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMLAB 
          MOVE      SP70,TOLAB   
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print Range of Receivals           
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print Range of Receivals           
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print Range of Receivals           
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print Range of Receivals           
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print Range of Receivals           
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L999,PS03L102
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Print Range of Receivals           
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L105
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L020,SF03L105
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCODF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCODT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
            BRANCH    EXIT,SF03L105,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Print All Receivals Not Yet Printed
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      SETACCEP
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print All Receivals Not Yet Printed
.-------------------------------------------------------
CF04L000
          MOVE      SP70,FROMLAB 
          MOVE      SP70,TOLAB   
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print All Receivals Not Yet Printed
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print All Receivals Not Yet Printed
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print All Receivals Not Yet Printed
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print All Receivals Not Yet Printed
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print All Receivals Not Yet Printed
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L999,PS04L102
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Print All Receivals Not Yet Printed
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006,SF04L104
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L020,SF04L104
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRECP000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
.
SF04L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRECF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRECT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.**********************************************************************
. SELPRT00 - select printer routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
SELPRT00  OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
          MOVE      SP70,SPLFILE
          CALL      SELPRINT
          RETURN
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.**********************************************************************
. SINRECPR - print purchase order routine
. SINRECLU - print purchase order lineup routine
.
.  Requires SIPAPON (Purchase order number)
.           NOPRINT (0=print from this routine, 1=print elsewhere)
.           SELPRINT called prior to this routine   } These two requirements
.           Open Files : IBACODE1 + IBAPRINT1       } exist in function SELPRT00
.           Includes   : IBACODFD/INC IBAPRNFD/INC
.                        IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.                        SINTMPDF/INC SINCODFD/IO SINORIFD/IO APSMASFD/IO
.                        SINSIAFD/IO SINPOAFD/IO SINPOBFD/INC SINPOCFD/INC
.                        SINPODFD/IO SINCONFD
.           Note : already includes IBAPASFD & IBAPASIO
.
.**********************************************************************
SINRECPR
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TWENTY4;*227,HRECPRT     * 0=Standard,1=St V, 2=Mod
.
          IF        NOPRINT=0
            CALL      OPNPRINT              * Open print file
          ENDIF
.
          CALL      PORD0000                * print routine
.                                           * check if anything to print
          IF        !(CPAGENO>0)
            DISPLAY   *P1:24,*B,*EL,"Nothing to Print !! - ";
            CALL      HITENTER
          ENDIF
.
          IF        NOPRINT=0
            DISPLAY   *P1:24,*EL
            CALL      CLSPRINT              * Close print file
          ENDIF
.
SINREC99  RETURN
.********************************************************************
. PORD - print report
.        Requires SIPAPON (Purchase order number)
.********************************************************************
PORD0000  DISPLAY   *P1:24,*EL,"Printing Purchase Order ",*V2LON,SIPAPON;
          MOVE      "35",MAXITEMS
          MOVE      ONE,CNOUNDLN                 * no underlines
          MOVE      ZERO,CPAGENO                 * reset page no.
          MOVE      "99",CLNO                    * init last line number
          MOVE      ZERO,TOTALORD                * clear total
          MOVE      "0",COUNTFL2
.
          CALL      WRIT0000                     * print details
          MOVE      "1",ENDPRT
          CALL      ENDP0000                     * print end of purchase order
          MOVE      ZERO,EXIT                    * everything is cool !!
.
PORD9999  RETURN
.********************************************************************
. HEAD - print report                               Called by PORD
.********************************************************************
HEAD0000  IF        COUNTFL2=1
            ADD       ONE,CPAGENO           * next page
            MOVE      "0",CLNO              * reset line number
            GOTO      HEAD9999              * just counting
          ENDIF
.
          IF        CPAGENO>0
            MOVE      "0",ENDPRT
            CALL      ENDP0000              * print end of purchase order
          ENDIF
.
          CLOCK     TIME,CTIMEIS
          CALL      HEAD132                 * print header
.
          MOVE      ZERO,CLNO
.
          UNPACK    SP70,APMASN1,APMASN2    * get supplier details
          UNPACK    SP70,APMASA1,APMASA2
          UNPACK    SP70,APMASA3,APMASPC,APMASTEL,APMASFAX
          PACK      KEY5,SIPASUP,SP70
          CALL      RDAPMA1
.
          MOVE      SP70,SICDDESC           * get message code
          MATCH     SP70,SIPAMES
          IF        !@EQUAL
            MOVE      "ME ",KEY3
            PACK      KEY6,KEY3,SIPAMES
            CALL      RDSICD1
          ENDIF
.
          CALL      PSNAME00
          PRINT     *N,"Purchase Order : ",SIPAPON:
                    *N,"Supplier       : ",SUPNAM70,*98,"Code  : ",SIPASUP:
                    *N,"               : ",SUPADD90:
                    *N,"Phone          : ",APMASTEL,"  Fax : ",APMASFAX:
                     "    Contact        : ",SIPASCN:
                    *N,"Delivery Point : ",SIPADEL:
                       "  Message        : ",SICDDESC:
                    *N,"Int. Delivery  : ",SIPAIDP:
                       "  Int. Contact   : ",SIPAICN
.
          CALL      UND132
          BRANCH    HRECPRT,HEAD1000,HEAD2000
          PRINT     "Item Catalog Part Number                    Warehou":
                    "se/Cost Centre          Product Group Rack & Shelf ":
                    "                 |    Received",*N:
                    "     Part Description                              ":
                    "               Quantity     Unit Cost Supply Unit  ":
                    "       Total Cost|    Quantity"
          GOTO      HEAD9000
.
HEAD1000  PRINT     "Item Catalog Part Number                    Warehou":
                    "se/Cost Centre          Product Group Rack & Shelf ":
                    "    Internal Ref.|    Received",*N:
                    "     Part Description                              ":
                    "               Quantity     Unit Cost Supply Unit  ":
                    "       Total Cost|    Quantity"
          GOTO      HEAD9000
.
HEAD2000  PRINT     "Item Catalog Part Number                    Warehou":
                    "se/Cost Centre          Commodity     Rack & Shelf ":
                    "                 |    Received",*N:
                    "     Part Description                              ":
                    "               Quantity     Unit Cost Supply Unit  ":
                    "       Total Cost|    Quantity"
.
HEAD9000  CALL      UND132
.
HEAD9999  RETURN
.********************************************************************
. WRIT - print data line                            Called by PORD
.********************************************************************
WRIT0000
.
.---- line item loop ----
.
          PACK      KEY10,SIPAPON,SP70         * loop through line items
          CALL      RSSIPC1
.
WRIT1000  CALL      RKSIPC1                    * get next line item
          BRANCH    OVRCD,WRIT5000
          MATCH     SIPCPON,SIPAPON            * at end of purchase order ?
          GOTO      WRIT5000 IF NOT EQUAL
          MATCH     SP70,SIPCEDD
          GOTO      WRIT2000 IF NOT EQUAL
.
          PACK      KEY12,SIPCPON,SIPCITM,Z70
          CALL      RSSIPF1                    * check if finalised at last rec
.
          CALL      RPSIPF1
          BRANCH    OVRCD,WRIT1050
          PACK      KEY10,SIPFPON,SIPFITM,Z70
          MATCH     KEY10,KEY12
          GOTO      WRIT1050 IF NOT EQUAL
.
          MATCH     SP70,SIPFDUP               * updated ?
          GOTO      WRIT1050 IF EQUAL
          MATCH     SP70,SIPFNDD               * any next delivery date ?
          GOTO      WRIT1050 IF NOT EQUAL
          GOTO      WRIT1000
.
WRIT1050  PACK      KEY7,SIPCCAT
          CALL      RDSIIA1
          BRANCH    OVRCD,WRIT1100
.
          PACK      KEY30,SIIAISS,SIPCSUT
          MOVE      ONE,SIFACTOR
          CALL      RDSIFA1
          BRANCH    OVRCD,WRIT1100
.
          ASSIGN    SIPCOQT-SIPCRQT/SIFACTOR,SIPFQTY
          GOTO      WRIT1200
.
WRIT1100  ASSIGN    SIPCOQT-SIPCRQT,SIPFQTY
.
WRIT1200  IF        SIPFQTY>0
            GOTO      WRIT2000
          ENDIF
          GOTO      WRIT1000
.
WRIT2000  MOVE      "1",COUNTFL2               * just counting !!
          MOVE      CLNO,SCLNO                 * save current line number
          MOVE      CPAGENO,SCPAGENO           * save current page number
          CALL      PRTA0000                   * count line item data lines
.                                              * check if page will be filled
.                                              * and if item goes over 1 page
          IF        (CPAGENO-1=SCPAGENO)&!(CLNO>SCLNO)&!(999=SCLNO)
            MOVE      SCLNO,CLNO               * restore current line number
            MOVE      SCPAGENO,CPAGENO         * restore current page number
            MOVE      "0",COUNTFL2
            CALL      HEAD0000                 * get next page
            GOTO      WRIT2000                 * restart from next page
          ENDIF
.
          MOVE      SCLNO,CLNO                 * restore current line number
          MOVE      SCPAGENO,CPAGENO           * restore current page number
          MOVE      "0",COUNTFL2
          CALL      PRTA0000                   * print line item data lines
.
          GOTO      WRIT1000                   * get next line item
.
.---- purchase order comment loop ----
.
WRIT5000  PACK      KEY10,SIPAPON,SP70         * loop through purch ord comments
          MOVE      ZERO,PRTFLAG
          CALL      RSSIPB1
.
WRIT6000  CALL      RKSIPB1                    * get next line item comment
          BRANCH    OVRCD,WRIT9000
          MATCH     SIPBPON,SIPAPON            * at end of comments ?
          GOTO      WRIT9000 IF NOT EQUAL
.
          MATCH     SIPBCOM,SP70               * blank line ?
          GOTO      WRIT6000 IF EQUAL
.
          COMPARE   MAXITEMS,CLNO              * end of page ?
          CALL      HEAD0000 IF NOT LESS       * start new page
          ADD       "1",CLNO                   * increment line number
          IF        PRTFLAG=0
            MOVE      ONE,PRTFLAG
            PRINT     "Purchase Order Comments   :  ";
          ENDIF
          PRINT     *30,SIPBCOM,*120,"|"
          GOTO      WRIT6000
.
WRIT9000  COMPARE   ONE,PRTFLAG
          CALL      UND132 IF EQUAL
.
WRIT9999  RETURN
.********************************************************************
. PRTA - print line items                           Called by WRIT
.        Requires : COUNTFL2 (1=dont print just count for paging)
.********************************************************************
PRTA0000  COMPARE   MAXITEMS,CLNO            * end of page ?
          CALL      HEAD0000 IF NOT LESS     * start new page
          BRANCH    COUNTFL2,PRTA1000
          GOTO      PRTA0050
.
PRTA0050  MOVE      SP70,SIICPD1
          MOVE      SP70,SIICPD2
          MOVE      SP70,SIIERAS
          PACK      SIICPD1,SIPCPD,SP70
          MOVE      ONE,SIFACTOR
          MOVE      ONE,SIIANON
          MATCH     SP70,SIPCCAT
          IF        !@EQUAL
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
            PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
            CALL      RDSIIC1
            PACK      KEY30,SIIAISS,SIPCSUT
            CALL      RDSIFA1
            IF        OVRCD=1
              MOVE      ONE,SIFACTOR
            ENDIF
          ENDIF
          IF        SIIANON=0
            PACK      KEY12,SIPCCAT,SIPCWAR,SP70
            CALL      RDSIIE1
            MOVE      SIPCWAR,KEY5
            CALL      RDSIWA1
          ELSE
            MOVE      SIPCCST,KEY5
            CALL      RDSICA1
          ENDIF
.
PRTA0100  IF        SIPCRQT<>0
            ASSIGN    SIPCOQT-(SIPCRQT/SIFACTOR),SIPCOQT
          ENDIF
.
          MOVE      "99,999,999",KEY10
          MOVE      SIPCOQT,F10
          FEDIT     F10,KEY10
          IF        SIPCECT<0
            MOVE      "       T.B.A.",KEY13
            MOVE      "         T.B.A.",KEY15
            MOVE      ZERO,F12P2
          ELSE
            MOVE      "999,999.9999",KEY13
            FEDIT     SIPCECT,KEY13
            ASSIGN    SIPCOQT*SIPCECT,F12P2
            MOVE      "9999,999,999.99",KEY15
            FEDIT     F12P2,KEY15
          ENDIF
          ADD       F12P2,TOTALORD
          IF        SIIANON=0
            MOVE      SIPCWAR,KEY5
            MOVE      SIWADES,KEY30
          ELSE
            MOVE      SIPCCST,KEY5
            MOVE      SICADESC,KEY30
            MOVE      SP70,SIIERAS
          ENDIF
.
          ADD       TWO,CLNO
          BRANCH    HRECPRT,PRTA0200,PRTA0300
          PRINT     *1,SIPCITM,*5,SIPCCAT,SP1,SIPCPN,SP1:     * STANDARD
                    KEY5,SP1,KEY30,SP1,*84,SIPCPRD,*90,SIIERAS,*120,"|",*N:
                    *5,SIICPD1,KEY10,SP2,KEY13,SIPCSUT:
                    *105,KEY15,*120,"|"
          MATCH     SIICPD2,SP70
          GOTO      PRTA1000 IF EQUAL
          PRINT     *5,SIICPD2,*120,"|"
          ADD       ONE,CLNO
          GOTO      PRTA1000
.
PRTA0200  PRINT     *1,SIPCITM,*5,SIPCCAT,SP1,SIPCPN,SP1:     * ST VINCIENTS
                    KEY5,SP1,KEY30,SP1,*84,SIPCPRD,*90,SIIERAS:
                    *105,SIPCUR1,*120,"|",*N:
                    *5,SIICPD1,KEY10,SP2,KEY13,SIPCSUT:
                    *105,KEY15,*120,"|"
          MATCH     SIICPD2,SP70
          GOTO      PRTA1000 IF EQUAL
          PRINT     *5,SIICPD2,*120,"|"
          ADD       ONE,CLNO
          GOTO      PRTA1000
.
PRTA0300  MOVE      SIPCPRD,KEY5
          CALL      RDSISA1
          PRINT     *1,SIPCITM,*5,SIPCCAT,SP1,SIPCPN,SP1:     * STANDARD
                    KEY5,SP1,KEY30,SP1,*84,SISACOMM,*90,SIIERAS,*120,"|",*N:
                    *5,SIICPD1,KEY10,SP2,KEY13,SIPCSUT:
                    *105,KEY15,*120,"|"
          MATCH     SIICPD2,SP70
          GOTO      PRTA1000 IF EQUAL
          PRINT     *5,SIICPD2,*120,"|"
          ADD       ONE,CLNO
          GOTO      PRTA1000
.
.---- get purchase order references from contract details ----
.
PRTA1000  PACK      SISDPO1,SP70
          PACK      SISDPO2,SP70
          PACK      KEY45,SIPCCON,SIPASUP,SIPCCAT,SIPCCDT,SIPCSUT,SP70
          CALL      RDSISD1
.
          MATCH     SP70,SISDPO1
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       "1",CLNO                 * increment line number
            IF        COUNTFL2=0
              PRINT     *5,SISDPO1,*120,"|"
            ENDIF
          ENDIF
          MATCH     SP70,SISDPO2
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       "1",CLNO                 * increment line number
            IF        COUNTFL2=0
              PRINT     *5,SISDPO2,*120,"|"
            ENDIF
          ENDIF
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
.     ---- line item comment loop ----
.
          PACK      KEY13,SIPCPON,SIPCITM,SP70 * loop through line item comments
          MOVE      ZERO,PRTFLAG
          CALL      RSSIPD1
.
PRTA2000  CALL      RKSIPD1                    * get next line item comment
          BRANCH    OVRCD,PRTA4000
          MATCH     SIPDPON,SIPCPON            * at end of comments ?
          GOTO      PRTA4000 IF NOT EQUAL
          MATCH     SIPDITM,SIPCITM            * at end of comments ?
          GOTO      PRTA4000 IF NOT EQUAL
.
          MATCH     SIPDCOM,SP70               * blank line ?
          GOTO      PRTA2000 IF EQUAL
.
          COMPARE   MAXITEMS,CLNO              * end of page ?
          CALL      HEAD0000 IF NOT LESS       * start new page
          ADD       "1",CLNO                   * increment line number
          IF        COUNTFL2=0
            IF        PRTFLAG=0
              MOVE      ONE,PRTFLAG
              PRINT     "Comments  :  ";
            ENDIF
            PRINT     *16,SIPDCOM,*120,"|"
          ENDIF
          GOTO      PRTA2000
.
PRTA4000  IF        COUNTFL2=0
            CALL      UND132
          ELSE
            ADD       "1",CLNO                   * increment line number
          ENDIF
.
PRTA9999  RETURN
.********************************************************************
. ENDP - print end of purchase order                Called by PORD
.********************************************************************
ENDP0000  IF        ENDPRT=1
            MOVE      "9999,999,999.99",KEY15
            FEDIT     TOTALORD,KEY15
            PRINT     *70,"Order Total :",*89,KEY15,*120,"|"
            ADD       "1",CLNO
            CALL      UND132
          ENDIF
.
.---- fill rest of purchase order body ----
.
          WHILE     MAXITEMS>CLNO
            ADD       "1",CLNO                   * print blank lines
            PRINT     SP1
          DO
.
.---- print end ----
.
          IF        ENDPRT=1
            PRINT     *N,*N
          ELSE
            CALL      UND132
            PRINT     *40,"*** Continued on next page ***"
          ENDIF
          PRINT     *N,*N,*N,*5,"Received By : ",UNDLN30:
                    *60,"Date :  __/__/__",*85,"Packing Slip => ",UNDLN10,*N:
                    *N,*5,"Print Name  : ",UNDLN30:
                       *51,"Store Initial : ",UNDLN10:
                       *85,"Invoice No.  => ",UNDLN10,*N
.
ENDP9999  RETURN
.------------------------------------------------------------
. Pack Name and Address for Printing
.------------------------------------------------------------
PSNAME00  STRIP    APMASN1
          STRIP    APMASN2
          CLEAR    SUPNAM70
          APPEND   APMASN1,SUPNAM70
          APPEND   SP1,SUPNAM70
          APPEND   APMASN2,SUPNAM70
          RESET    SUPNAM70
.
          STRIP    APMASA1
          STRIP    APMASA2
          STRIP    APMASA3
          STRIP    APMASPC
          CLEAR    SUPADD90
          APPEND   APMASA1,SUPADD90
          APPEND   SP1,SUPADD90
          APPEND   APMASA2,SUPADD90
          APPEND   SP1,SUPADD90
          APPEND   APMASA3,SUPADD90
          APPEND   SP1,SUPADD90
          APPEND   APMASPC,SUPADD90
          RESET    SUPADD90
          RETURN
.
.********************************************************************
. SINRECLU - print lineup
.********************************************************************
.SINRECLU
.          CALL      OPNPRINT                * open print file
..
.          PRINT     *F:
.                    *121,"*******",*N,*N:
.                    *62,"**********",*108,"**",*116,"**",*N,*N:
.                    *110,"**********",*N:
.                    *53,"******************************",*N,*N,*N,*N,*N:
.                    *2,"******************************":
.                        *51,"****************************************",*N:
.                    *2,"******************************",*N:
.                    *2,"*************************":
.                        *62,"********************",*N:
.                    *2,"*************************",*N:
.                    *2,"*************************":
.                        *28,"******",*62,"**********",*N:
.                    *2,"***********************************",*N,*N,*N,*N,*N
..
.          CALL      CLSPRINT                * close print file & print
.
.          RETURN
.
.********************************************************************
. Set accept mode
.********************************************************************
SETACCEP  MOVE      ONE,ACCEPT
          RETURN
.********************************************************************
. Single Order Print
.********************************************************************
SINPRT00  MOVE      ZERO,NOPRINT
          CALL      SINRECPR                     * print purchase order
          MOVE      ZERO,EXIT
          RETURN
.********************************************************************
. Keyin Single Code (Routine KCODS Copied from Process Receivals)
.********************************************************************
KCODS000  MOVE      ZERO,CKEYTYP
          CALL      KSIPAA00
          BRANCH    EXIT,KCODS999,KCODS999
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            IF        OVRCD=1
              CLEAR     DISPMSG
              APPEND    "You have no access for Warehouse ",DISPMSG
              APPEND    SIPAWAR,DISPMSG
              APPEND    " - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              MOVE      TWO,EXIT
              GOTO      KCODS999
            ENDIF
          ENDIF
.
KCODS100  MATCH     SP70,SIPADCN
          IF        !(@EQUAL)
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            CLEAR     DISPMSG
            APPEND    "Order Cancelled on ",DISPMSG
            APPEND    CPCDATE,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      KCODS000
          ENDIF
.
          MATCH     SP70,SIPADCM
          IF        !(@EQUAL)
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            CLEAR     DISPMSG
            APPEND    "Order Completed on ",DISPMSG
            APPEND    CPCDATE,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      KCODS000
          ENDIF
.
          MATCH     SP70,SIPADPR
          IF        @EQUAL
            MOVE      "WARNING : Order has NOT Been Printed. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
.
          MOVE      SIPAPON,KEY7
          CALL      RLSIPA1
          BRANCH    OVRCD,KCODS000,KCODS200
.
          CALL      CHKORD00
          BRANCH    EXIT,KCODS000
.
          CALL      UUSIPA1
          GOTO      KCODS999
.
KCODS200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MOVE      SIPAPON,KEY7
          CALL      RDSIPA1
          BRANCH    OVRCD,KCODS000
          MATCH     ANSR,ANS
          GOTO      KCODS100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      KCODS000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      KCODS200 IF NOT EQUAL
          GOTO      KCODS000
.
KCODS999  RETURN
.------------------------------------------------------------
. Check for End of Order
. Order Complete when no more deliveries expected
.------------------------------------------------------------
CHKORD00  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
CHKORD10  CALL      RKSIPC1
          BRANCH    OVRCD,CHKORD50
          MATCH     SIPCPON,SIPAPON
          GOTO      CHKORD50 IF NOT EQUAL
.
          MATCH     SP70,SIPCEDD
          GOTO      CHKORD99 IF NOT EQUAL
.
          PACK      KEY7,SIPCCAT
          CALL      RDSIIA1
          BRANCH    OVRCD,CHKORD20
          PACK      KEY30,SIIAISS,SIPCSUT
          CALL      RDSIFA1
          BRANCH    OVRCD,CHKORD20
.
          ASSIGN   (SIPCOQT*SIFACTOR)-SIPCRQT,SIPFQTY
          GOTO     CHKORD30
.
CHKORD20  ASSIGN    SIPCOQT-SIPCRQT,SIPFQTY
.
CHKORD30  IF        SIPFQTY>0
            GOTO      CHKORD99
          ENDIF
          GOTO      CHKORD10
.
CHKORD50  PACK      SIPADCM,CCC,CYY,CMM,CDD
          REP       " 0",SIPADCM              * Order Complete
          CALL      UPSIPA1
          MOVE      ONE,EXIT
.
CHKORD99  IF        EXIT=1
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            CLEAR     DISPMSG
            APPEND    "No Outstanding Details. Order Completed on ",DISPMSG
            APPEND    CPCDATE,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
            CALL      UUSIPA1
          ENDIF
          RETURN
.********************************************************************
. PRNT - print report
.********************************************************************
PRNT0000  MOVE      ONE,NOPRINT                  * we'll control printing here !
          CALL      OPNPRINT                     * open print file
.
          IF        OPTIONA=1
            PACK      TOCOD7,FROMCOD7,SP70
          ELSE
            MATCH     FROMCOD7,TOCOD7
            IF        @LESS
              DISPLAY   *P1:24,*EL,*B,"Illegal Purchase Order Range - ";
              CALL      HITENTER
              GOTO      PRNT9500
            ENDIF
          ENDIF
.
          PACK      KEY7,FROMCOD7,SP70
          CALL      RSSIPA1
          CALL      RPSIPA1
.
PRNT1000  CALL      RKSIPA1
          BRANCH    OVRCD,PRNT9000
          MATCH     SIPAPON,TOCOD7
          GOTO      PRNT9000 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,PRNT1000
          ENDIF
.
          CALL      CHPUR000                     * Check Completed or Not
          BRANCH    EXIT,PRNT1000
.
          CALL      SINRECPR                     * print purchase order
.
          GOTO      PRNT1000                     * get next record
.
PRNT9000  MOVE      ZERO,EXIT
          GOTO      PRNT9999
.
PRNT9500  MOVE      ONE,EXIT
.
PRNT9999  DISPLAY   *P1:24,*EL
          CALL      CLSPRINT                     * close print file & print
          RETURN
.------------------------------------------------------------
. Check for completed Orders
.------------------------------------------------------------
CHPUR000  MOVE      ZERO,EXIT
          MATCH     SP70,SIPADCN
          IF        !(@EQUAL)
            MOVE      ONE,EXIT
            GOTO      CHPUR999
          ENDIF
.
          MATCH     SP70,SIPADCM
          IF        !(@EQUAL)
            MOVE      ONE,EXIT
            GOTO      CHPUR999
          ENDIF
.
          MOVE      SIPAPON,KEY7
          CALL      RLSIPA1
          BRANCH    OVRCD,CHPUR000,CHPUR200
.
          CALL      ORDCHK00
          CALL      UUSIPA1
          BRANCH    EXIT,CHPUR999
.
          MATCH     SP70,SIPADPR
          IF        @EQUAL
            CLEAR     DISPMSG
            APPEND    "WARNING : Order ",DISPMSG
            APPEND    SIPAPON,DISPMSG
            APPEND    " has NOT Been Printed. - ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
.
          GOTO      CHPUR999
.
CHPUR200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Order ",SIPAPON," Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MOVE      SIPAPON,KEY7
          CALL      RDSIPA1
          BRANCH    OVRCD,CHPUR900
          MATCH     ANSR,ANS
          GOTO      CHPUR000 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      CHPUR900 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      CHPUR200 IF NOT EQUAL
.
CHPUR900  MOVE      ONE,EXIT
.
CHPUR999  RETURN
.------------------------------------------------------------
. Check for End of Order
. Order Complete when no more deliveries expected
.------------------------------------------------------------
ORDCHK00  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
ORDCHK10  CALL      RKSIPC1
          BRANCH    OVRCD,ORDCHK50
          MATCH     SIPCPON,SIPAPON
          GOTO      ORDCHK50 IF NOT EQUAL
.
          MATCH     SP70,SIPCEDD
          GOTO      ORDCHK99 IF NOT EQUAL
.
          PACK      KEY7,SIPCCAT
          CALL      RDSIIA1
          BRANCH    OVRCD,ORDCHK20
          PACK      KEY30,SIIAISS,SIPCSUT
          CALL      RDSIFA1
          BRANCH    OVRCD,ORDCHK20
.
          ASSIGN   (SIPCOQT*SIFACTOR)-SIPCRQT,SIPFQTY
          GOTO     ORDCHK30
.
ORDCHK20  ASSIGN    SIPCOQT-SIPCRQT,SIPFQTY
.
ORDCHK30  IF        SIPFQTY>0
            GOTO      ORDCHK99
          ENDIF
          GOTO      ORDCHK10
.
ORDCHK50  PACK      SIPADCM,CCC,CYY,CMM,CDD
          REP       " 0",SIPADCM              * Order Complete
          CALL      UPSIPA1
          MOVE      ONE,EXIT
.
ORDCHK99  RETURN
.********************************************************************
. Keyin From Code
.********************************************************************
KCODF000
          PACK      FROMCOD7,SP70
          PACK      FROMLAB,START,SP70
          CALL      KSIPAA00           * keyin purchase order
          BRANCH    EXIT,KCODF900,KCODF950
.
          PACK      FROMCOD7,SIPAPON,SP70
          PACK      FROMLAB,SIPAPON,SP70
.
KCODF900  MOVE      ZERO,EXIT
          GOTO      KCODF999
.
KCODF950  MOVE      TWO,EXIT
.
KCODF999  RETURN
.********************************************************************
. Keyin To Code
.********************************************************************
KCODT000
          PACK      TOCOD7,Z70
          PACK      TOLAB,END,SP70
          CALL      KSIPAA00           * keyin purchase order
          BRANCH    EXIT,KCODT900,KCODT950
.
          PACK      TOCOD7,SIPAPON,SP70
          PACK      TOLAB,SIPAPON,SP70
.
KCODT900  MOVE      ZERO,EXIT
          GOTO      KCODT999
.
KCODT950  MOVE      TWO,EXIT
.
KCODT999  RETURN
.********************************************************************
. PRECP - Print report for Not Yet Printed
.********************************************************************
PRECP000  MOVE      ONE,NOPRINT                  * we'll control printing here !
          CALL      OPNPRINT                     * open print file
.
          IF        OPTIONA=1
            PACK      TOCOD7,FROMCOD7,SP70
          ELSE
            MATCH     FROMCOD7,TOCOD7
            IF        @LESS
              DISPLAY   *P1:24,*EL,*B,"Illegal Purchase Order Range - ";
              CALL      HITENTER
              GOTO      PRECP950
            ENDIF
          ENDIF
.
          PACK      KEY7,FROMCOD7,SP70
          CALL      RSSIRP1
          CALL      RPSIRP1
.
PRECP100  CALL      RKSIRP1
          BRANCH    OVRCD,PRECP900
          MATCH     SIRPPON,TOCOD7
          GOTO      PRECP900 IF LESS             * out of range ?
.
          PACK      KEY7,SIRPPON
          CALL      RDSIPA1
          BRANCH    OVRCD,PRECP100               * Ignore - shouldn't happen
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,PRECP100
          ENDIF
.
          CALL      CHPUR000                     * Check Completed or Not
          BRANCH    EXIT,PRECP100
.
          CALL      SINRECPR                     * print purchase order
          PACK      KEY7,SIRPPON,SP70
          CALL      DESIRP1
          CALL      RSSIRP1
          GOTO      PRECP100                     * get next record
.
PRECP900  MOVE      ZERO,EXIT
          GOTO      PRECP999
.
PRECP950  MOVE      ONE,EXIT
.
PRECP999  DISPLAY   *P1:24,*EL
          CALL      CLSPRINT                     * close print file & print
          RETURN
.********************************************************************
. Keyin From Code
.********************************************************************
KRECF000
          PACK      FROMCOD7,SP70
          PACK      FROMLAB,START,SP70
          CALL      KSIRPA00           * keyin purchase order
          BRANCH    EXIT,KRECF900,KRECF950
.
          PACK      FROMCOD7,SIRPPON,SP70
          PACK      FROMLAB,SIRPPON,SP70
.
KRECF900  MOVE      ZERO,EXIT
          GOTO      KRECF999
.
KRECF950  MOVE      TWO,EXIT
.
KRECF999  RETURN
.********************************************************************
. Keyin To Code
.********************************************************************
KRECT000
          PACK      TOCOD7,Z70
          PACK      TOLAB,END,SP70
          CALL      KSIRPA00           * keyin purchase order
          BRANCH    EXIT,KRECT900,KRECT950
.
          PACK      TOCOD7,SIRPPON,SP70
          PACK      TOLAB,SIRPPON,SP70
.
KRECT900  MOVE      ZERO,EXIT
          GOTO      KRECT999
.
KRECT950  MOVE      TWO,EXIT
.
KRECT999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSMASIO/INC
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
          INC       SINCCAIO/INC
          INC       SINCIAIO/INC
          INC       SINCICIO/INC
          INC       SINCIEIO/INC
          INC       SINCODIO/INC
          INC       SINFACIO/INC
          INC       SINNATIO/INC
          INC       SINPOAIO/INC
          INC       SINPOAKY    
          INC       SINPOBIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINPOFIO/INC
          INC       SINRCPIO/INC
          INC       SINRCPKY    
          INC       SINSCDIO/INC
          INC       SINSUAIO/INC
          INC       SINTRNIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
.
          INC       STDGENCD
.
