.------------------------------------------------------------
. Multiple Procedures Table
.
. Inputs  -  Valid record from the pmsmpraf
. Outputs -  Field specified by FLDITMNO & DIM127 for any parameters
.
. Include's needed - PMSMPRFD
.                    PATCODFD
. Modifications :
.         V11.00.01 04/03/2020  J.Tan          TSK 0838262
.                   Added Effective from and to date to MBS Item file
.         V10.01.01 19/01/2011  Mike Laming  CAR 233054
.                   Added PMMPR009 (Contract Id.)
.
.------------------------------------------------------------
.------------------------------------------------------------
. Multiple Procedures table
.------------------------------------------------------------
MPRC0000  BRANCH    FLDITMNO,MPRC0100,MPRC0200,MPRC0300,MPRC0400,MPRC0500:
                             MPRC0600,MPRC0700,MPRC0800,MPRC0900
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CMTX9999
.
MPRC0100  MOVE      "CL",CATEGORY            * Claim Code
          MOVE      PMMPCCOD,CODE
          CALL      CODITM00
          GOTO      MPRC9999
.
MPRC0200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,MPRC0210
          WRITE     HTMLFILE;PMMPHFUN;       * Health Fund
          GOTO      MPRC9999
.
MPRC0210  MATCH     SP70,PMMPHFUN
          GOTO      MPRC9999 IF EQUAL
.
          PACK      KEY14,PMMPHFUN,SP70
          CALL      RDSFUND1
          CALL      RDKFUND1
          BRANCH    OVRCD,MPRC9999
          WRITE     HTMLFILE;HFNAME;        * Health Fund Name
          GOTO      MPRC9999
.
MPRC0300  MOVE      "HT",CATEGORY           * HF Table Type
          MOVE      PMMPHFTY,CODE
          CALL      CODITM00
          GOTO      MPRC9999
.
MPRC0400  WRITE     HTMLFILE;PMMPMPRC;      * Multiple Procedures Code
          GOTO      MPRC9999
.
MPRC0500  WRITE     HTMLFILE;PMMPPAMT;      * Patient amount
          GOTO      MPRC9999
.
MPRC0600  WRITE     HTMLFILE;PMMPRAMT;      * Rebate amount
          GOTO      MPRC9999
.
MPRC0700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,MPRC0710
          WRITE     HTMLFILE;PMMPITMN;      * MBS Item code
          GOTO      MPRC9999
.
MPRC0710  PACK      KEY17,PMMPITMN,SP70
          CALL      PATITMRD                * Item 
          BRANCH    OVRCD,MPRC9999
          WRITE     HTMLFILE;IDESC;         * Item Description
          GOTO      MPRC9999
.
MPRC0800  WRITE     HTMLFILE;PMMPCOUN;
          GOTO      MPRC9999
.
MPRC0900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,MPRC0910
          WRITE     HTMLFILE;PMMPCNID;      * Contract Id. Code
          GOTO      MPRC9999
.
MPRC0910  MOVE      PMMPCNID,KEY6
          CALL      RDPMCID1                * Contract Id.
          BRANCH    OVRCD,MPRC9999
          WRITE     HTMLFILE;PMCIDESC;      * Contract Id. Desc.
          GOTO      MPRC9999
.
MPRC9999  RETURN
.
.------------------------------------------------------------
.  Update Multiple procedures fields
.------------------------------------------------------------
UPMPRC00  MATCH     PMMPR001,Z70
          IF        !@EQUAL
            MOVE      PMMPR001,PMMPCCOD
          ENDIF
.
          MATCH     PMMPR002,Z70
          IF        !@EQUAL
            MOVE      PMMPR002,PMMPHFUN
          ENDIF
.
          MATCH     PMMPR003,Z70
          IF        !@EQUAL
            MOVE      PMMPR003,PMMPHFTY
          ENDIF
.
          MATCH     PMMPR004,Z70
          IF        !@EQUAL
            MOVE      PMMPR004,PMMPMPRC
          ENDIF
.
          MATCH     PMMPR005,Z70
          IF        !@EQUAL
            MOVE      PMMPR005,PMMPCOUN
          ENDIF
.
          MOVE      PMMPR006,PMMPPAMT
          MOVE      PMMPR007,PMMPRAMT
.
          MATCH     PMMPR008,Z70
          IF        !@EQUAL
            MOVE      PMMPR008,PMMPITMN
          ENDIF
.
          MATCH     PMMPR009,Z70
          IF        !@EQUAL
            MOVE      PMMPR009,PMMPCNID
          ENDIF
.
UPMPRC99  RETURN
.
.------------------------------------------------------------------------
.   Clear Parameters for Multiple Procedures table
.------------------------------------------------------------------------
CLRMPR00  MOVE      Z70,PMMPR001
          MOVE      Z70,PMMPR002
          MOVE      Z70,PMMPR003
          MOVE      Z70,PMMPR004
          MOVE      Z70,PMMPR005
          MOVE      ZERO,PMMPR006
          MOVE      ZERO,PMMPR007
          MOVE      Z70,PMMPR008
          MOVE      Z70,PMMPR009
.
CLRMPR99  RETURN
.------------------------------------------------------------------------
.   Clear Multiple Procedures table variables
.------------------------------------------------------------------------
CLRPMMPR  MOVE    SP70,PMMPCCOD
          MOVE    SP70,PMMPHFUN
          MOVE    SP70,PMMPHFTY
          MOVE    SP70,PMMPMPRC
          MOVE    ZERO,PMMPCOUN
          MOVE    ZERO,PMMPPAMT
          MOVE    ZERO,PMMPRAMT
          MOVE    SP70,PMMPITMN
          MOVE    SP70,PMMPCNID
          RETURN
+
.------------------------------------------------------------
.   Set Parameters for Multiple Procedures file
.------------------------------------------------------------
SVMPR000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SVMPR010,SVMPR020,SVMPR030,SVMPR040,SVMPR050:
                       SVMPR060,SVMPR070,SVMPR080,SVMPR090
.
          MOVE      ONE,EXIT
          GOTO      SVMTX999
.
SVMPR010  MOVE      QRYDATA,PMMPR001
          PACK      PMMPR001,PMMPR001,SP70
          GOTO      SVMPR999
.
SVMPR020  MOVE      QRYDATA,PMMPR002
          PACK      PMMPR002,PMMPR002,SP70
          GOTO      SVMPR999
.
SVMPR030  MOVE      QRYDATA,PMMPR003
          PACK      PMMPR003,PMMPR003,SP70
          GOTO      SVMPR999
.
SVMPR040  MOVE      QRYDATA,PMMPR004
          PACK      PMMPR004,PMMPR004,SP70
          GOTO      SVMPR999
.
SVMPR050  MOVE      QRYDATA,PMMPR005
          PACK      PMMPR005,PMMPR005,SP70
          GOTO      SVMPR999
.
SVMPR060  MOVE      QRYDATA,PMMPR006
          GOTO      SVMPR999
.
SVMPR070  MOVE      QRYDATA,PMMPR007
          GOTO      SVMPR999
.
SVMPR080  MOVE      QRYDATA,PMMPR008
          PACK      PMMPR008,PMMPR008,SP70
          GOTO      SVMPR999
.
SVMPR090  MOVE      QRYDATA,PMMPR009
          PACK      PMMPR009,PMMPR009,SP70
          GOTO      SVMPR999
.
SVMPR999  RETURN
+
