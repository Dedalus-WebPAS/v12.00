. *----------------------------------------------------------------------
. * Include Name  :   EMRACITM.PBL
. *
. * Function      :   CGI Variables for EMRACAFD - emracaaf
. *
. * Mods          :
. *
. *       V11.01.00 22/07/2021 DA Sarkies        TSK 0905305
. *                Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------------------
CPEMAI00  MOVE      Z70,EMACI001
          MOVE      Z70,EMACI002
          MOVE      Z70,EMACI003
          PACK      EMACI004,Z70,Z70,Z70,Z70
          MOVE      Z70,EMACI005
          MOVE      ZERO,EMACI006
          MOVE      ZERO,EMACI007
          MOVE      Z70,EMACI008
.
CPEMAI99  RETURN
.
.------------------------------------------------------------
. Set variables for AECC Coefficents ECDG Subcategories
.------------------------------------------------------------
SPEMAI00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMAI01,SPEMAI02,SPEMAI03,SPEMAI04,SPEMAI05,SPEMAI06:
                    SPEMAI07,SPEMAI08
          GOTO      SPEMAI99
.
SPEMAI01  PACK      EMACI001,QRYDATA,SP70
          GOTO      SPEMAI99
.
SPEMAI02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00 
          PACK      EMACI002,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMAI99
.
SPEMAI03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00 
          PACK      EMACI003,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMAI99
.
SPEMAI04  MOVE      QRYDATA,EMACI004
          GOTO      SPEMAI99
.
SPEMAI05  MOVE      QRYDATA,EMACI005
          GOTO      SPEMAI99
.
SPEMAI06  MOVE      QRYDATA,EMACI006
          GOTO      SPEMAI99
.
SPEMAI07  MOVE      QRYDATA,EMACI007
          GOTO      SPEMAI99
.
SPEMAI08  MOVE      QRYDATA,EMACI008
          GOTO      SPEMAI99
.
SPEMAI99  RETURN
.
.------------------------------------------------------------
. Tags for AECC Coefficients for ECDG Subcategories
.------------------------------------------------------------
EMAI0000  BRANCH    FLDITMNO,EMAI0100,EMAI0200,EMAI0300,EMAI0400:
                    EMAI0500,EMAI0600,EMAI0700,EMAI0800,EMAI0900:
                    EMAI1000,EMAI1100,EMAI1200,EMAI1300,EMAI1300:
                    EMAI1400
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMAI9999
.
EMAI0100  WRITE     HTMLFILE;EMRASUBV;
          GOTO      EMAI9999
.
EMAI0200  MATCH     EMRAFDAT,SP70             * effective date from
          GOTO      EMAI9999 IF EQUAL
          UNPACK    EMRAFDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAI9999
.
EMAI0300  MATCH     EMRATDAT,SP70             * effective date to
          GOTO      EMAI9999 IF EQUAL
          UNPACK    EMRATDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAI9999
.
EMAI0400  WRITE     HTMLFILE;EMRASUBD;
          GOTO      EMAI9999
.
EMAI0500  WRITE     HTMLFILE;EMRACODE;
          GOTO      EMAI9999
.
EMAI0600  WRITE     HTMLFILE;EMRACINT;
          GOTO      EMAI9999
.
EMAI0700  WRITE     HTMLFILE;EMRACITS;
          GOTO      EMAA9999
.
EMAI0800  MATCH     EMRADATC,SP70             * Date record created
          GOTO      EMAI9999 IF EQUAL
          UNPACK    EMRADATC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAI9999
.
EMAI0900  WRITE     HTMLFILE;EMRATIMC;
          GOTO      EMAI9999
.
EMAI1000  WRITE     HTMLFILE;EMRAUSRC;
          GOTO      EMAI9999
.
EMAI1100  MATCH     EMRADATU,SP70             * Update date record
          GOTO      EMAI9999 IF EQUAL
          UNPACK    EMRADATU,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAI9999
.
EMAI1200  WRITE     HTMLFILE;EMRATIMU;
          GOTO      EMAI9999
.
EMAI1300  WRITE     HTMLFILE;EMRAUSRU;
          GOTO      EMAI9999
.
EMAI1400  WRITE     HTMLFILE;EMRAAFLG;
          GOTO      EMAI9999
.
EMAI9999  RETURN
.
.------------------------------------------------------------
. Moved cgi variables to file variables
.------------------------------------------------------------
MVEMAI00  MATCH     Z70,EMACI001
          IF        !@EQUAL
            MOVE      EMACI001,EMRASUBV
          ENDIF       
.
          MATCH     Z70,EMACI002
          IF        !@EQUAL
            MOVE      EMACI002,EMRAFDAT
          ENDIF       
.
          MATCH     Z70,EMACI003
          IF        !@EQUAL
            MOVE      EMACI003,EMRATDAT
          ENDIF       
.
          MATCH     Z70,EMACI004
          IF        !@EQUAL
            MOVE      EMACI004,EMRASUBD
          ENDIF       
.
          MATCH     Z70,EMACI005
          IF        !@EQUAL
            MOVE      EMACI005,EMRACODE
          ENDIF       
.
          COMPARE   ZERO,EMACI006
          IF        !@EQUAL
            MOVE      ZERO,EMRACINT
            MOVE      EMACI006,EMRACINT
          ENDIF       
.
          COMPARE   ZERO,EMACI007
          IF        !@EQUAL
            MOVE      ZERO,EMRACITS
            MOVE      EMACI007,EMRACITS
          ENDIF       
.
          MATCH     Z70,EMACI008
          IF        !@EQUAL
            MOVE      EMACI008,EMRAAFLG  
          ENDIF       
.
MVEMAI99  RETURN
