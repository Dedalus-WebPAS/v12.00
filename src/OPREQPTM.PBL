. *----------------------------------------------------------------------
. * Include Name  :   OPREQPTM.PBL
. *
. * Function      :   CGI variable functions for OPREQPFD - oprEQPaf.dat
. *
. * Modifications :
. *
.------------------------------------------------------------------------
. V11.04.01 06/02/2024  Thanh T.           TSK 0923560
.           Added Hospital Id field. Added OPEQ0310 and OPEQ0320 sections
. V11.03.01 31/01/2023  Thanh T.           TSK 0919770
.           Changed OPIT0151, OPIT0161 to cater for adding Hospital field
.------------------------------------------------------------------------
. V10.04.01 08/02/2014 Ania P                   CAR 267230
.           Added OPEQACTV/OPEQP030
.  V9.04.00 17/02/2005 Lina Vo                  CAR 56404
.           Created include
.------------------------------------------------------------------------
.   Clear parameters for the equipment details file
.------------------------------------------------------------------------
CPOPEQ00  MOVE      Z70,OPEQP001
          MOVE      Z70,OPEQP002
          MOVE      Z70,OPEQP003
          MOVE      Z70,OPEQP004
          MOVE      Z70,OPEQP005
          MOVE      Z70,OPEQP006
          MOVE      Z70,OPEQP007
          MOVE      Z70,OPEQP008
          MOVE      Z70,OPEQP009
          MOVE      Z70,OPEQP010
          MOVE      Z70,OPEQP011
          MOVE      Z70,OPEQP012
          MOVE      Z70,OPEQP013
          MOVE      Z70,OPEQP014
          MOVE      Z70,OPEQP015
          MOVE      Z70,OPEQP016
          MOVE      Z70,OPEQP017
          MOVE      Z70,OPEQP018
          MOVE      Z70,OPEQP019
          MOVE      Z70,OPEQP020
          MOVE      Z70,OPEQP021
          MOVE      Z70,OPEQP022
          MOVE      Z70,OPEQP023
          MOVE      Z70,OPEQP024
          MOVE      Z70,OPEQP025
          MOVE      Z70,OPEQP026
          MOVE      Z70,OPEQP027
          MOVE      Z70,OPEQP028
          MOVE      Z70,OPEQP029
          MOVE      Z70,OPEQP030
.
CPOPEQ99  RETURN
.
.------------------------------------------------------------
. equipment details file standard tags
.------------------------------------------------------------
OPEQ0000  BRANCH    FLDITMNO,OPEQ0010,OPEQ0020,OPEQ0030,OPEQ0040,OPEQ0050:
                             OPEQ0060,OPEQ0070,OPEQ0080,OPEQ0090,OPEQ0100:
                             OPEQ0110,OPEQ0120,OPEQ0130,OPEQ0140,OPEQ0150:
                             OPEQ0160,OPEQ0170,OPEQ0180,OPEQ0190,OPEQ0200:
                             OPEQ0210,OPEQ0220,OPEQ0230,OPEQ0240,OPEQ0250:
                             OPEQ0260,OPEQ0270,OPEQ0280,OPEQ0290,OPEQ0300:
                             OPEQ0310,OPEQ0320
.
          WRITE     HTMLFILE;"Invalid IBA Tag ",FLDITMNO;
          GOTO      OPEQ9999
.
OPEQ0010  WRITE     HTMLFILE;OPEQCODE;  
          GOTO      OPEQ9999
.
OPEQ0020  WRITE     HTMLFILE;OPEQDESC; 
          GOTO      OPEQ9999
.
OPEQ0030  MOVE      "OE",CATEGORY
          MOVE      OPEQTYPE,CODE
          CALL      CODITM00
          GOTO      OPEQ9999
.
OPEQ0040  WRITE     HTMLFILE;OPEQUNIQ;  
          GOTO      OPEQ9999
.
OPEQ0050  WRITE     HTMLFILE;OPEQTEAM;
          GOTO      OPEQ9999
.
OPEQ0060  MOVE      "ER",CATEGORY
          MOVE      OPEQSTAT,CODE
          CALL      CODITM00
          GOTO      OPEQ9999
.
OPEQ0070  MATCH     OPEQDTSC,SP70
          GOTO      OPEQ9999 IF EQUAL
.
          UNPACK    OPEQDTSC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPEQ9999
.
OPEQ0080  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPEQ0081
.
          WRITE     HTMLFILE;OPEQUSLO;
          GOTO      OPEQ9999
.
OPEQ0081  PACK      KEY18,OPEQUSLO,OPEQHOSP,SP70
          CALL      RDOPTRA1
          BRANCH    OVRCD,OPEQ9999
.
          WRITE     HTMLFILE;OPTHDESC;
          GOTO      OPEQ9999

OPEQ0090  UNPACK    DIM127,ANS,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPEQ0091
.
          WRITE     HTMLFILE;OPEQCULO;
          GOTO      OPEQ9999
.
OPEQ0091  PACK      KEY18,OPEQCULO,OPEQHOSP,SP70
          CALL      RDOPTRA1
          BRANCH    OVRCD,OPEQ9999
.
          WRITE     HTMLFILE;OPTHDESC;
          GOTO      OPEQ9999
.
OPEQ0100  MATCH     OPEQDE1U,SP70
          GOTO      OPEQ9999 IF EQUAL
.
          UNPACK    OPEQDE1U,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPEQ9999
.
OPEQ0110  WRITE     HTMLFILE;OPEQMNOU;
          GOTO      OPEQ9999
.
OPEQ0120  MATCH     OPEQEEDT,SP70
          GOTO      OPEQ9999 IF EQUAL
.
          UNPACK    OPEQEEDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPEQ9999
.
OPEQ0130  WRITE     HTMLFILE;OPEQNOUR;
          GOTO      OPEQ9999
.
OPEQ0140  MATCH     OPEQLSDT,SP70
          GOTO      OPEQ9999 IF EQUAL
.
          UNPACK    OPEQLSDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPEQ9999
.
OPEQ0150  WRITE     HTMLFILE;OPEQULST;
          GOTO      OPEQ9999
.
OPEQ0160  MATCH     OPEQLMDT,SP70
          GOTO      OPEQ9999 IF EQUAL
.
          UNPACK    OPEQLMDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPEQ9999
.
OPEQ0170  WRITE     HTMLFILE;OPEQULMT;
          GOTO      OPEQ9999
.
OPEQ0180  WRITE     HTMLFILE;OPEQSRNO;
          GOTO      OPEQ9999
.
OPEQ0190  WRITE     HTMLFILE;OPEQSPNO;
          GOTO      OPEQ9999
.
OPEQ0200  WRITE     HTMLFILE;OPEQSPDT;
          GOTO      OPEQ9999
.
OPEQ0210  WRITE     HTMLFILE;OPEQNOTE;
          GOTO      OPEQ9999
.
OPEQ0220  WRITE     HTMLFILE;OPEQUDT1;
          GOTO      OPEQ9999
.
OPEQ0230  WRITE     HTMLFILE;OPEQUDT2;
          GOTO      OPEQ9999
.
OPEQ0240  MOVE      "o6",CATEGORY
          MOVE      OPEQUDF1,CODE
          CALL      CODITM00
          GOTO      OPEQ9999
.
OPEQ0250  MOVE      "o7",CATEGORY
          MOVE      OPEQUDF2,CODE
          CALL      CODITM00
          GOTO      OPEQ9999
.
OPEQ0260  MATCH     OPEQDTE1,SP70
          GOTO      OPEQ9999 IF EQUAL
.         
          UNPACK    OPEQDTE1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;  
          GOTO      OPEQ9999
.
OPEQ0270  MATCH     OPEQDTE2,SP70
          GOTO      OPEQ9999 IF EQUAL
.
          UNPACK    OPEQDTE2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPEQ9999
.
OPEQ0280  WRITE     HTMLFILE;OPEQTME1;
          GOTO      OPEQ9999
.
OPEQ0290  WRITE     HTMLFILE;OPEQTME2;
          GOTO      OPEQ9999
.
OPEQ0300  WRITE     HTMLFILE;OPEQACTV;
          GOTO      OPEQ9999
.
OPEQ0310  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPEQ0311,OPEQ0312
.
          MATCH     SP70,OPEQHOSP
          GOTO      OPEQ9999 IF EQUAL
.
          PACK      KEY3,OPEQHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,OPEQ0311
.
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      OPEQ9999
.
OPEQ0311  WRITE     HTMLFILE;OPEQHOSP;
          GOTO      OPEQ9999
.
OPEQ0312  MOVE      OPEQHOSP,DEFTHOSP
          CALL      HSPSEN00
          GOTO      OPEQ9999
.
OPEQ0320  MOVE      WBSEHOSP,DEFTHOSP
          CALL      HSPSEN00
          GOTO      OPEQ9999
.
OPEQ9999  RETURN
.------------------------------------------------------------
.   Set Parameters for the equipment details file
.------------------------------------------------------------
SPEQP000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEQP010,SPEQP020,SPEQP030,SPEQP040,SPEQP050:
                       SPEQP060,SPEQP070,SPEQP080,SPEQP090,SPEQP100:
                       SPEQP110,SPEQP120,SPEQP130,SPEQP140,SPEQP150:
                       SPEQP160,SPEQP170,SPEQP180,SPEQP190,SPEQP200:
                       SPEQP210,SPEQP220,SPEQP230,SPEQP240,SPEQP250:
                       SPEQP260,SPEQP270,SPEQP280,SPEQP290,SPEQP300
.
          MOVE      ONE,EXIT
          GOTO      SPEQP999
.
SPEQP010  SQUEEZE   QRYDATA
          MOVE      QRYDATA,OPEQP001
          PACK      OPEQP001,OPEQP001,SP70
          GOTO      SPEQP999
.
SPEQP020  MOVE      QRYDATA,OPEQP002
          GOTO      SPEQP999
.
SPEQP030  MOVE      QRYDATA,OPEQP003
          GOTO      SPEQP999
.
SPEQP040  MOVE      QRYDATA,OPEQP004
          GOTO      SPEQP999
.
SPEQP050  MOVE      QRYDATA,OPEQP005
          GOTO      SPEQP999
.
SPEQP060  MOVE      QRYDATA,OPEQP006
          GOTO      SPEQP999
.
SPEQP070  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP007,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP080  MOVE      QRYDATA,OPEQP008
          GOTO      SPEQP999
.
SPEQP090  MOVE      QRYDATA,OPEQP009
          GOTO      SPEQP999
.
SPEQP100  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP010,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP110  SQUEEZE   QRYDATA
          MOVE      ZERO,F5
          MOVE      QRYDATA,F5
          MOVE      F5,OPEQP011     * Right Justify
          GOTO      SPEQP999
.
SPEQP120  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP012,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP130  SQUEEZE   QRYDATA
          MOVE      ZERO,F5
          MOVE      QRYDATA,F5
          MOVE      F5,OPEQP013     * Right Justify
          GOTO      SPEQP999
.
SPEQP140  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP014,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP150  SQUEEZE   QRYDATA
          MOVE      ZERO,F5
          MOVE      QRYDATA,F5
          MOVE      F5,OPEQP015     * Right Justify
          GOTO      SPEQP999
.
SPEQP160  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP016,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP170  SQUEEZE   QRYDATA
          MOVE      ZERO,F5
          MOVE      QRYDATA,F5
          MOVE      F5,OPEQP017     * Right Justify
          GOTO      SPEQP999
.
SPEQP180  MOVE      QRYDATA,OPEQP018
          GOTO      SPEQP999
.
SPEQP190  MOVE      QRYDATA,OPEQP019
          GOTO      SPEQP999
.
SPEQP200  MOVE      QRYDATA,OPEQP020
          GOTO      SPEQP999
.
SPEQP210  MOVE      QRYDATA,OPEQP021
          GOTO      SPEQP999
.
SPEQP220  MOVE      QRYDATA,OPEQP022
          GOTO      SPEQP999
.
SPEQP230  MOVE      QRYDATA,OPEQP023
          GOTO      SPEQP999
.
SPEQP240  MOVE      QRYDATA,OPEQP024
          GOTO      SPEQP999
.
SPEQP250  MOVE      QRYDATA,OPEQP025
          GOTO      SPEQP999
.
SPEQP260  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP026,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP270  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPEQP027,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEQP999
.
SPEQP280  MOVE      QRYDATA,OPEQP028
          GOTO      SPEQP999
.
SPEQP290  MOVE      QRYDATA,OPEQP029
          GOTO      SPEQP999
.
SPEQP300  MOVE      QRYDATA,OPEQP030
          GOTO      SPEQP999
.
SPEQP999  RETURN
.
.------------------------------------------------------------
.  Update equipment details file
.------------------------------------------------------------
MVOPEQ00  MATCH     OPEQP001,Z70
          IF        !@EQUAL
            MOVE      OPEQP001,OPEQCODE
          ENDIF
.
          MATCH     OPEQP002,Z70
          IF        !@EQUAL
            MOVE      OPEQP002,OPEQDESC
          ENDIF
.
          MATCH     OPEQP003,Z70
          IF        !@EQUAL
            MOVE      OPEQP003,OPEQTYPE
          ENDIF
.
          MATCH     OPEQP004,Z70
          IF        !@EQUAL
            MOVE      OPEQP004,OPEQUNIQ
          ENDIF
.
          MATCH     OPEQP005,Z70
          IF        !@EQUAL
            MOVE      OPEQP005,OPEQTEAM
          ENDIF
.
          MATCH     OPEQP006,Z70
          IF        !@EQUAL
            MOVE      OPEQP006,OPEQSTAT
          ENDIF
.
          MATCH     OPEQP007,Z70
          IF        !@EQUAL
            MOVE      OPEQP007,OPEQDTSC
          ENDIF
.
          MATCH     OPEQP008,Z70
          IF        !@EQUAL
            MOVE      OPEQP008,OPEQUSLO
          ENDIF
.
          MATCH     OPEQP009,Z70
          IF        !@EQUAL
            MOVE      OPEQP009,OPEQCULO
          ENDIF
.
          MATCH     OPEQP010,Z70
          IF        !@EQUAL
            MOVE      OPEQP010,OPEQDE1U
          ENDIF
.
          MATCH     OPEQP011,Z70
          IF        !@EQUAL
            MOVE      OPEQP011,OPEQMNOU
          ENDIF
.
          MATCH     OPEQP012,Z70
          IF        !@EQUAL
            MOVE      OPEQP012,OPEQEEDT
          ENDIF
.
          MATCH     OPEQP013,Z70
          IF        !@EQUAL
            MOVE      OPEQP013,OPEQNOUR
          ENDIF
.
          MATCH     OPEQP014,Z70
          IF        !@EQUAL
            MOVE      OPEQP014,OPEQLSDT
          ENDIF
.
          MATCH     OPEQP015,Z70
          IF        !@EQUAL
            MOVE      OPEQP015,OPEQULST
          ENDIF
.
          MATCH     OPEQP016,Z70
          IF        !@EQUAL
            MOVE      OPEQP016,OPEQLMDT
          ENDIF
.
          MATCH     OPEQP017,Z70
          IF        !@EQUAL
            MOVE      OPEQP017,OPEQULMT
          ENDIF
.
          MATCH     OPEQP018,Z70
          IF        !@EQUAL
            MOVE      OPEQP018,OPEQSRNO
          ENDIF
.
          MATCH     OPEQP019,Z70
          IF        !@EQUAL
            MOVE      OPEQP019,OPEQSPNO
          ENDIF
.
          MATCH     OPEQP020,Z70
          IF        !@EQUAL
            MOVE      OPEQP020,OPEQSPDT
          ENDIF
.
          MATCH     OPEQP021,Z70
          IF        !@EQUAL
            MOVE      OPEQP021,OPEQNOTE
          ENDIF
.
          MATCH     OPEQP022,Z70
          IF        !@EQUAL
            MOVE      OPEQP022,OPEQUDT1
          ENDIF
.
          MATCH     OPEQP023,Z70
          IF        !@EQUAL
            MOVE      OPEQP023,OPEQUDT2
          ENDIF
.
          MATCH     OPEQP024,Z70
          IF        !@EQUAL
            MOVE      OPEQP024,OPEQUDF1
          ENDIF
.
          MATCH     OPEQP025,Z70
          IF        !@EQUAL
            MOVE      OPEQP025,OPEQUDF2
          ENDIF
.
          MATCH     OPEQP026,Z70
          IF        !@EQUAL
            MOVE      OPEQP026,OPEQDTE1
          ENDIF
.
          MATCH     OPEQP027,Z70
          IF        !@EQUAL
            MOVE      OPEQP027,OPEQDTE2
          ENDIF
.
          MATCH     OPEQP028,Z70
          IF        !@EQUAL
            MOVE      OPEQP028,OPEQTME1
          ENDIF
.
          MATCH     OPEQP029,Z70
          IF        !@EQUAL
            MOVE      OPEQP029,OPEQTME2
          ENDIF
.
          MATCH     OPEQP030,Z70
          IF        !@EQUAL
            MOVE      OPEQP030,OPEQACTV
          ENDIF
.
MVOPEQ99  RETURN
.
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLREQP00  MOVE      SP70,OPEQCODE  * equipment Code
          MOVE      SP70,OPEQDESC  * equipment Description
          MOVE      SP70,OPEQTYPE  * Type (Cat OE)
          MOVE      SP70,OPEQUNIQ  * Unique Number
          MOVE      SP70,OPEQTEAM  * Team Number
          MOVE      ZERO,OPEQSTAT  * Current Status (Cat ER)
          MOVE      SP70,OPEQDTSC  * Date Status Changed (CCYYMMDD)
          MOVE      SP70,OPEQUSLO  * Usual Location/Tray
          MOVE      SP70,OPEQCULO  * Current Location/Tray
          MOVE      SP70,OPEQDE1U  * Date Equipment 1st Used (CCYYMMDD)
          MOVE      ZERO,F5
          MOVE      F5,OPEQMNOU    * Maximum Number os Uses        
          MOVE      SP70,OPEQEEDT  * Equipment Expiry Date (CCYYMMDD)
          MOVE      F5,OPEQNOUR    * Number of Uses Remaining
          MOVE      SP70,OPEQLSDT  * Last Sterilisation Date (CCYYMMDD)
          MOVE      F5,OPEQMNOU    * Total Number of Uses Since last Sterilis.
          MOVE      SP70,OPEQLMDT  * Last Maintenance Date (CCYYMMDD)
          MOVE      F5,OPEQULMT    * Total Number of Uses Since last Maintained
          MOVE      SP70,OPEQSRNO  * Equipment Serial Number
          MOVE      SP70,OPEQSPNO  * Supplier Catalog Number
          MOVE      SP70,OPEQSPDT  * Supplier Details
          MOVE      SP70,OPEQNOTE  * Notes/Comments
          MOVE      SP70,OPEQUDT1  * User Defined Text 1
          MOVE      SP70,OPEQUDT2  * User Defined Text 2
          MOVE      SP70,OPEQUDF1  * User Defined Cat 1 (Category o6)
          MOVE      SP70,OPEQUDF2  * User Defined Cat 2 (Category o7)
          MOVE      SP70,OPEQDTE1  * User Defined Date 1 (CCYYMMDD)
          MOVE      SP70,OPEQDTE2  * User Defined Date 2 (CCYYMMDD)
          MOVE      SP70,OPEQTME1  * User Defined Time 1 (HH:MM:SS)
          MOVE      SP70,OPEQTME2  * User Defined Time 2 (HH:MM:SS)
          MOVE      SP70,OPEQACTV  * Inactive? 1=Y,0=N
          MOVE      SP70,OPEQHOSP  * Hospital Id
          MOVE      SP70,OPEQSPAR  * Spare variable
.
CLREQP99  RETURN
