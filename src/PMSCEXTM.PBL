. *----------------------------------------------------------------------
. * Include Name  :   PMSCEXTM.INC
. *
. * Function      :   CGI variables for PMSCEXFD - pmscexaf.dat
. *----------------------------------------------------------------------
.  Modifications Done :
.------------------------------------------------------------------------
.  V11.05.02  20.12.2024 DA Sarkies      TSK 0954547
.             Commented out <cat> tags to prevent browser incompatibility
.  V11.05.01  26.11.2024  Ebon Clements Task 0954547
.             Added <cat-c> start and end tag to category=XX tag
.  V11.04.03  06/05/2024  Thanh T       TSK 0941543
.             Added PMCE4300 and PMCE4400
.  V11.04.02  22/01/2024  Ebon Clements TSK 0932545
.             Correctly formatted textarea comment to store and display
.             - PMCE4200,SPPMC027,SPPMC028                   
.  V11.04.01  12/01/2024  Alina Bhari   TSK 0932545
.             Added comment free text PMCEX027                
.             - PMCE4100,MVPMCE00,CPPMCE00                    
.  V11.00.01  30/04/2020  Thanh T       TSK 0876574
.             Added PMCE4000 and SPPMC026 sections  
.------------------------------------------------------------------------
.  V10.13.01  22/08/2018  Peter Vela    TSK 0859742
.             Added Contact Medicare Number, Reference, DOB
.  V10.07.01  04/01/2016  Ebon Clements TSK 0294154
.             Added send SMS
.  V10.03.05  27/11/2012  Jill Parkinson CAR 276961
.             Added replace " with '
.  V10.03.04  06/03/2012  Davin         CAR 261243
.             Output quotes around country description (OSEA0000)
.  V10.03.03  08/12/2011  Ebon Clements CAR 248529
.             Added get contact webPAS unique id - CONU0000
.  V10.03.02  08/11/2011  Ebon Clements CAR 248529
.             Added counter
.  V10.03.01  07/11/2011  J.Tan         CAR 252790
.             Fixed set up parameter for Contact address line 1
.  V10.02.02  07/06/2011  Ebon Clements CAR 239530
.             Added created/updated by tags. Added country of birth
.  V10.02.01  07/06/2011  J.Tan         CAR 239592
.             Added Second given name
.  V9.05.00   24/03/2006  Ebon Clements CAR 79277
.             Created include
.------------------------------------------------------------------------
.
.------------------------------------------------------------
.clear cgi vars for extra contact details file
.------------------------------------------------------------
CPPMCE00  MOVE      Z70,PMCEX001
          MOVE      Z70,PMCEX002
          MOVE      Z70,PMCEX003
          MOVE      Z70,PMCEX004
          MOVE      Z70,PMCEX005
          MOVE      Z70,PMCEX006
          MOVE      Z70,PMCEX007
          MOVE      Z70,PMCEX008
          MOVE      Z70,PMCEX009
          MOVE      Z70,PMCEX010
          MOVE      Z70,PMCEX011
          MOVE      Z70,PMCEX012
          MOVE      Z70,PMCEX013
          MOVE      Z70,PMCEX014
          MOVE      Z70,PMCEX015
          MOVE      Z70,PMCEX016
          MOVE      Z70,PMCEX017
          MOVE      Z70,PMCEX018
          MOVE      Z70,PMCEX019
          MOVE      Z70,PMCEX020
          MOVE      Z70,PMCEX021
          MOVE      Z70,PMCEX022
          MOVE      Z70,PMCEX023
          MOVE      Z70,PMCEX024
          MOVE      Z70,PMCEX025
          MOVE      Z70,PMCEX026
          MOVE      Z70,PMCEX027
          MOVE      SP70,PMCEX028
          MOVE      SP70,PMCEX029
          MOVE      SP70,PMCEX030
          MOVE      SP70,PMCEX031
          MOVE      Z70,PMCEX032
          MOVE      Z70,PMCEX033
.
CPPMCE99  RETURN
.------------------------------------------------------------
. Add extra contact details file
.------------------------------------------------------------
PMCE0000  BRANCH    FLDITMNO,PMCE0100,PMCE0200,PMCE0300,PMCE0400,PMCE0500:
                             PMCE0600,PMCE0700,PMCE0800,PMCE0900,PMCE1000:
                             PMCE1100,PMCE1200,PMCE1300,PMCE1400,PMCE1500:
                             PMCE1600,PMCE1700,PMCE1800,PMCE1900,PMCE2000:
                             PMCE2100,PMCE2200,PMCE2300,PMCE2400,PMCE2500:
                             PMCE2600,PMCE2700,PMCE2800,PMCE2900,PMCE3000:
                             PMCE3100,PMCE3200,PMCE3300,PMCE3400,PMCE3500:
                             PMCE3600,PMCE3700,PMCE3800,PMCE3900,PMCE4000:
                             PMCE4100,PMCE4200,PMCE4300,PMCE4400
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMCE9999
.
PMCE0100  WRITE     HTMLFILE;PMCEURNO;
          GOTO      PMCE9999
.
PMCE0200  MOVE      "tc",CATEGORY
          MOVE      PMCETYPE,CODE
          CALL      CODITM00
          GOTO      PMCE9999
.
PMCE0300  WRITE     HTMLFILE;PMCECNTR;
          GOTO      PMCE9999
.
PMCE0400  REP       "#"'",PMCETITL
          WRITE     HTMLFILE;PMCETITL;
          GOTO      PMCE9999
.
PMCE0500  REP       "#"'",PMCESNAM
          WRITE     HTMLFILE;PMCESNAM;
          GOTO      PMCE9999
.
PMCE0600  REP       "#"'",PMCEGNAM
          WRITE     HTMLFILE;PMCEGNAM;
          GOTO      PMCE9999
.
PMCE0700  REP       "#"'",PMCEADD1
          WRITE     HTMLFILE;PMCEADD1;
          GOTO      PMCE9999
.
PMCE0800  REP       "#"'",PMCEADD2
          WRITE     HTMLFILE;PMCEADD2;
          GOTO      PMCE9999
.
PMCE0900  REP       "#"'",PMCEADD3
          WRITE     HTMLFILE;PMCEADD3;
          GOTO      PMCE9999
.
PMCE1000  REP       "#"'",PMCEADD4
          WRITE     HTMLFILE;PMCEADD4;
          GOTO      PMCE9999
.
PMCE1100  REP       "#"'",PMCEPOST
          WRITE     HTMLFILE;PMCEPOST;
          GOTO      PMCE9999
.
PMCE1200  REP       "#"'",PMCETELP
          WRITE     HTMLFILE;PMCETELP;
          GOTO      PMCE9999
.
PMCE1300  REP       "#"'",PMCETELB
          WRITE     HTMLFILE;PMCETELB;
          GOTO      PMCE9999
.
PMCE1400  REP       "#"'",PMCETELM
          WRITE     HTMLFILE;PMCETELM;
          GOTO      PMCE9999
.
PMCE1500  REP       "#"'",PMCERELP
          WRITE     HTMLFILE;PMCERELP;
          GOTO      PMCE9999
.
PMCE1600  REP       "#"'",PMCEEMAI
          WRITE     HTMLFILE;PMCEEMAI;
          GOTO      PMCE9999
.
PMCE1700  WRITE     HTMLFILE;PMCESLET;
          GOTO      PMCE9999
.
PMCE1800  WRITE     HTMLFILE;PMCEACTV;
          GOTO      PMCE9999
.
PMCE1900  CALL      OSEA0000                * Overseas Countries Pulldown
          GOTO      PMCE9999
.
PMCE2000  REP       "#"'",PMCEGNM2
          WRITE     HTMLFILE;PMCEGNM2;
          GOTO      PMCE9999
.
PMCE2100  MATCH     PMCECDAT,SP70
          GOTO      PMCE9999 IF EQUAL
.
          UNPACK    PMCECDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCE9999
.
PMCE2200  WRITE     HTMLFILE;PMCECTIM;
          GOTO      PMCE9999
.
PMCE2300  MATCH     SP70,PMCECUID
          GOTO      PMCE9999 IF EQUAL
.
          PACK      KEY10,PMCECUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMCECUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMCE9999
.
PMCE2400  MATCH     PMCEUDAT,SP70
          GOTO      PMCE9999 IF EQUAL
.
          UNPACK    PMCEUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;

          GOTO      PMCE9999
.
PMCE2500  WRITE     HTMLFILE;PMCEUTIM;
          GOTO      PMCE9999
.
PMCE2600  MATCH     SP70,PMCEUUID
          GOTO      PMCE9999 IF EQUAL
.
          PACK      KEY10,PMCEUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMCEUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMCE9999
.
PMCE2700  MOVE      "C ",CATEGORY
          MOVE      PMCECONT,CODE
          CALL      CODITM00
          GOTO      PMCE9999
.
PMCE2800  MATCH     PMCEDINA,SP70
          GOTO      PMCE9999 IF EQUAL
.
          UNPACK    PMCEDINA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCE9999
.
PMCE2900  MATCH     SP70,PMCERELP
          GOTO      PMCE9999 IF EQUAL
.
          PACK      KEY10,PMCERELP,SP70
          CALL      RDPMREL1
          IF        OVRCD=1
            MOVE      PMCERELP,PMRLDESC
          ENDIF
          WRITE     HTMLFILE;PMRLDESC;
          GOTO      PMCE9999
.
PMCE3000  MATCH     SP70,PMCETITL
          GOTO      PMCE9999 IF EQUAL
.
          PACK      KEY4,PMCETITL,SP70
          CALL      RDPMTLE1
          IF        OVRCD=1
            MOVE      PMCETITL,PMTLDESC
          ENDIF
          WRITE     HTMLFILE;PMTLDESC;
          GOTO      PMCE9999
.
PMCE3100  MATCH     "1",PMCESLET
          GOTO      PMCE9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;DYES;
          GOTO      PMCE9999
.
PMCE3200  MATCH     "1",PMCEACTV
          GOTO      PMCE9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;DYES;
          GOTO      PMCE9999
.
PMCE3300  MATCH     "8888",PMCEPOST
          GOTO      PMCE9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;DYES;
          GOTO      PMCE9999
.
PMCE3400  WRITE     HTMLFILE;PMCETPID;
          GOTO      PMCE9999
.
PMCE3500  WRITE     HTMLFILE;PMCEWPID;
          GOTO      PMCE9999
.
PMCE3600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMCE3610
.
          MATCH     "1",PMCESSMS
          IF        @EQUAL
            WRITE     HTMLFILE;YES;
          ELSE
            WRITE     HTMLFILE;No;
          ENDIF
          GOTO      PMCE9999
.
PMCE3610  WRITE     HTMLFILE;PMCESSMS;
          GOTO      PMCE9999
.
PMCE3700  WRITE     HTMLFILE;PMCECMED;
          GOTO      PMCE9999
.
PMCE3800  WRITE     HTMLFILE;PMCECREF;
          GOTO      PMCE9999
.
PMCE3900  MATCH     PMCECDOB,SP70
          GOTO      PMCE9999 IF EQUAL
.
          UNPACK    PMCECDOB,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCE9999
.

PMCE4000  WRITE     HTMLFILE;PMCESSMS;
          GOTO      PMCE9999
.
PMCE4100  WRITE     HTMLFILE;PMCEFTXT;
          GOTO      PMCE9999
.
PMCE4200  PACK      PMCEFTXT,PMCEFTXT,SP70,SP70,SP70,SP70
          PACK      PMCEXD27,SP70
          PACK      PMCEXD28,SP70
          PACK      PMCEXD29,SP70
          PACK      PMCEXD30,SP70
          PACK      PMCEXD31,SP70
          UNPACK    PMCEFTXT,PMCEXD27,PMCEXD28,PMCEXD29,PMCEXD30,PMCEXD31
.
          STRIP     PMCEXD27
          MOVELPTR  PMCEXD27,F2
          IF        F2=0
            MOVE      ONE,F2
          ENDIF
          SFORMAT   VAR,F2
          MOVE      PMCEXD27,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          STRIP     PMCEXD28
          MOVELPTR  PMCEXD28,F2
          IF        F2=0
            MOVE      ONE,F2
          ENDIF
          SFORMAT   VAR,F2
          MOVE      PMCEXD28,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          STRIP     PMCEXD29
          MOVELPTR  PMCEXD29,F2
          IF        F2=0
            MOVE      ONE,F2
          ENDIF
          SFORMAT   VAR,F2
          MOVE      PMCEXD29,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          STRIP     PMCEXD30
          MOVELPTR  PMCEXD30,F2
          IF        F2=0
            MOVE      ONE,F2
          ENDIF
          SFORMAT   VAR,F2
          MOVE      PMCEXD30,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          STRIP     PMCEXD31
          MOVELPTR  PMCEXD31,F2
          IF        F2=0
            MOVE      ONE,F2
          ENDIF
          SFORMAT   VAR,F2
          MOVE      PMCEXD31,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          GOTO      PMCE9999
.
PMCE4300  MOVE      "l1",CATEGORY
          MOVE      PMCELAN1,CODE                * Main Language Spoken 1
          CALL      CODITM00
          GOTO      PMCE9999
.
PMCE4400  MOVE      "l1",CATEGORY
          MOVE      PMCELAN2,CODE                * Main Language Spoken 2
          CALL      CODITM00
          GOTO      PMCE9999
.
PMCE9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for extra contact table file
.------------------------------------------------------------
SPPMC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMC001,SPPMC002,SPPMC003,SPPMC004,SPPMC005:
                       SPPMC006,SPPMC007,SPPMC008,SPPMC009,SPPMC010:
                       SPPMC011,SPPMC012,SPPMC013,SPPMC014,SPPMC015:
                       SPPMC016,SPPMC017,SPPMC018,SPPMC019,SPPMC020:
                       SPPMC021,SPPMC022,SPPMC023,SPPMC024,SPPMC025:
                       SPPMC026,SPPMC027,SPPMC999,SPPMC999,SPPMC999:
                       SPPMC999,SPPMC032,SPPMC033
.
          MOVE      ONE,EXIT
          GOTO      SPPMC999
.
SPPMC001  PACK      PMCEX001,QRYDATA,SP70
          GOTO      SPPMC999
.
SPPMC002  PACK      PMCEX002,QRYDATA,SP70
          GOTO      SPPMC999
.
SPPMC003  PACK      PMCEX003,QRYDATA,SP70
          GOTO      SPPMC999
.
SPPMC004  MOVE      QRYDATA,PMCEX004
          GOTO      SPPMC999
.
SPPMC005  MOVE      QRYDATA,PMCEX005
          GOTO      SPPMC999
.
SPPMC006  MOVE      QRYDATA,PMCEX006
          GOTO      SPPMC999
.
SPPMC007  PACK      PMCEX007,QRYDATA,SP70
          GOTO      SPPMC999
.
SPPMC008  MOVE      QRYDATA,PMCEX008
          GOTO      SPPMC999
.
SPPMC009  MOVE      QRYDATA,PMCEX009
          GOTO      SPPMC999
.
SPPMC010  MOVE      QRYDATA,PMCEX010
          GOTO      SPPMC999
.
SPPMC011  MOVE      QRYDATA,PMCEX011
          GOTO      SPPMC999
.
SPPMC012  MOVE      QRYDATA,PMCEX012
          GOTO      SPPMC999
.
SPPMC013  MOVE      QRYDATA,PMCEX013
          GOTO      SPPMC999
.
SPPMC014  MOVE      QRYDATA,PMCEX014
          GOTO      SPPMC999
.
SPPMC015  MOVE      QRYDATA,PMCEX015
          GOTO      SPPMC999
.
SPPMC016  MOVE      QRYDATA,PMCEX016
          GOTO      SPPMC999
.
SPPMC017  MOVE      QRYDATA,PMCEX017
          GOTO      SPPMC999
.
SPPMC018  MOVE      QRYDATA,PMCEX018
          GOTO      SPPMC999
.
SPPMC019  MOVE      QRYDATA,PMCEX019
          GOTO      SPPMC999
.
SPPMC020  MOVE      QRYDATA,PMCEX020
          GOTO      SPPMC999
.
SPPMC021  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMCEX021,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMC999
.
SPPMC022  MOVE      QRYDATA,PMCEX022
          GOTO      SPPMC999
.
SPPMC023  MOVE      QRYDATA,PMCEX023
          GOTO      SPPMC999
.
SPPMC024  MOVE      QRYDATA,PMCEX024
          GOTO      SPPMC999
.
SPPMC025  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMCEX025,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMC999
.
SPPMC026  MOVE      QRYDATA,PMCEX026
          GOTO      SPPMC999
.
. PMCEX027 is a textarea and will populate PMCEX027, PMCEX028, PMCECX029
.          PMCECX030 and PMCECX031 
.
SPPMC027  PACK      PMCEX027,QRYDATA,SP70         * Some comment received
          MOVE      ZERO,F1
.
SPPMC028  READ      CONFFILE,SEQ;QRYNAME,QRYDATA
          GOTO      SPPMC999 IF OVER
.
          ADD       ONE,F1
.
          MATCH     SP70,QRYNAME
          IF        !@EQUAL
            MOVE      ONE,TEXTAREA                 * Flag for Next CGI Paramete
            GOTO      SPPMC999
          ENDIF
.
          PACK      QRYDATA,QRYDATA,SP70
          STORE     QRYDATA,F1,PMCEX028,PMCEX029,PMCEX030,PMCEX031
          GOTO      SPPMC028
.
SPPMC032  PACK      PMCEX032,QRYDATA,SP70
          GOTO      SPPMC999
.
SPPMC033  PACK      PMCEX033,QRYDATA,SP70
          GOTO      SPPMC999
.
SPPMC999  RETURN  
.
.------------------------------------------------------------
.  Create Countries Pulldown List
.------------------------------------------------------------
OSEA0000  MOVE      SP70,TDESC
          MOVE      "C ",CATEGORY
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
OSEA0100  CALL      RDKCODE2
          BRANCH    OVRCD,OSEA9999
          MATCH     CATEGORY,TCODE
          GOTO      OSEA9999 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      OSEA0100 IF EQUAL
.
          MATCH     PMCEADD4,TDESC
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",TDESC,"#" selected>":
                               TDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",TDESC,"#">",TDESC,"</option>"
          ENDIF
          GOTO      OSEA0100
OSEA9999  RETURN


.------------------------------------------------------------
.  Update extra contact details table file
.------------------------------------------------------------
MVPMCE00  MATCH     PMCEX001,Z70
          IF        !@EQUAL
            MOVE      PMCEX001,PMCEURNO
          ENDIF
. 
          MATCH     PMCEX002,Z70
          IF        !@EQUAL
            MOVE      PMCEX002,PMCETYPE
          ENDIF
. 
          MATCH     PMCEX003,Z70
          IF        !@EQUAL
            MOVE      PMCEX003,PMCECNTR
          ENDIF
. 
          MATCH     PMCEX004,Z70
          IF        !@EQUAL
            MOVE      PMCEX004,PMCETITL
          ENDIF
. 
          MATCH     PMCEX005,Z70
          IF        !@EQUAL
            MOVE      PMCEX005,PMCESNAM
          ENDIF
. 
          MATCH     PMCEX006,Z70
          IF        !@EQUAL
            MOVE      PMCEX006,PMCEGNAM
          ENDIF
. 
          MATCH     PMCEX007,Z70
          IF        !@EQUAL
            MOVE      PMCEX007,PMCEADD1
          ENDIF
. 
          MATCH     PMCEX008,Z70
          IF        !@EQUAL
            MOVE      PMCEX008,PMCEADD2
          ENDIF
. 
          MATCH     PMCEX009,Z70
          IF        !@EQUAL
            MOVE      PMCEX009,PMCEADD3
          ENDIF
. 
          MATCH     PMCEX010,Z70
          IF        !@EQUAL
            MOVE      PMCEX010,PMCEADD4
          ENDIF
. 
          MATCH     PMCEX011,Z70
          IF        !@EQUAL
            MOVE      PMCEX011,PMCEPOST
          ENDIF
. 
          MATCH     PMCEX012,Z70
          IF        !@EQUAL
            MOVE      PMCEX012,PMCETELP
          ENDIF
. 
          MATCH     PMCEX013,Z70
          IF        !@EQUAL
            MOVE      PMCEX013,PMCETELB
          ENDIF
. 
          MATCH     PMCEX014,Z70
          IF        !@EQUAL
            MOVE      PMCEX014,PMCETELM
          ENDIF
. 
          MATCH     PMCEX015,Z70
          IF        !@EQUAL
            MOVE      PMCEX015,PMCERELP
          ENDIF
. 
          MATCH     PMCEX016,Z70
          IF        !@EQUAL
            MOVE      PMCEX016,PMCEEMAI
          ENDIF
. 
          MATCH     PMCEX017,Z70
          IF        !@EQUAL
            MOVE      PMCEX017,PMCESLET
          ENDIF
. 
          MATCH     PMCEX018,Z70
          IF        !@EQUAL
            MOVE      PMCEX018,PMCEACTV
          ENDIF
. 
          MATCH     PMCEX019,Z70
          IF        !@EQUAL
            MOVE      PMCEX019,PMCEGNM2
          ENDIF
. 
          MATCH     PMCEX020,Z70
          IF        !@EQUAL
            MOVE      PMCEX020,PMCECONT
          ENDIF
. 
          MATCH     PMCEX021,Z70
          IF        !@EQUAL
            MOVE      PMCEX021,PMCEDINA
          ENDIF
. 
          MATCH     PMCEX022,Z70
          IF        !@EQUAL
            MOVE      PMCEX022,PMCESSMS
          ENDIF
.
          MATCH     PMCEX023,Z70
          IF        !@EQUAL
            MOVE      PMCEX023,PMCECMED
          ENDIF
.
          MATCH     PMCEX024,Z70
          IF        !@EQUAL
            MOVE      PMCEX024,PMCECREF
          ENDIF
.
          MATCH     PMCEX025,Z70
          IF        !@EQUAL
            MOVE      PMCEX025,PMCECDOB
          ENDIF
.
          MATCH     PMCEX026,Z70
          IF        !@EQUAL
            MOVE      PMCEX026,PMCESSMS
          ENDIF
.
          MATCH     PMCEX027,Z70
          IF        !@EQUAL
            PACK      PMCEFTXT,PMCEX027,PMCEX028,PMCEX029,PMCEX030,PMCEX031,SP70
          ENDIF 
.
          MATCH     PMCEX032,Z70
          IF        !@EQUAL
            MOVE      PMCEX032,PMCELAN1
          ENDIF
.
          MATCH     PMCEX033,Z70
          IF        !@EQUAL
            MOVE      PMCEX033,PMCELAN2
          ENDIF
.
MVPMCE99  RETURN
.
.------------------------------------------------------------
. Calculate the counter number for this U/R and contact type
.------------------------------------------------------------
CONC0000  MOVE      ZERO,F3                       * Set contact type counter
.
          PACK      KEY14,PMCEX001,PMCEX002,Z70
          CALL      RSPMCEX1
          CALL      RPPMCEX1
          BRANCH    OVRCD,CONC2000
.
          MATCH     PMCEX001,PMCEURNO
          GOTO      CONC2000 IF NOT EQUAL
.
          MATCH     PMCEX002,PMCETYPE
          GOTO      CONC2000 IF NOT EQUAL
.
          MOVE      PMCECNTR,F3
.
CONC2000  MATCH     "1",PTCNNWCA                 * Check if using audit file
          GOTO      CONC9000 IF NOT EQUAL
.
          PACK      KEY33,PMCEX001,PMCEX002,Z70
          CALL      ASPMCEX2
          CALL      APPMCEX2
          BRANCH    OVRCD,CONC9000
.
          MATCH     PMCEX001,PMCEURNO
          GOTO      CONC9000 IF NOT EQUAL
.
          MATCH     PMCEX002,PMCETYPE
          GOTO      CONC9000 IF NOT EQUAL
.
          MOVE      ZERO,F3A                    * Use audit file counter if
          MOVE      PMCECNTR,F3A                * higher
          IF        F3A>F3
            MOVE      F3A,F3
          ENDIF
.
CONC9000  ADD       ONE,F3
          MOVE      F3,PMCEX003                 * U/R, Contact Type and Counter
.
CONC9999  RETURN
.
.------------------------------------------------------------
. Get contact webPAS unique id
.------------------------------------------------------------
CONU0000  MATCH     "1",PTCNH7ID       * HL7 ignore delete segment for NK1/ZAL
          GOTO      CONU9999 IF NOT EQUAL
.
          MOVE      "118",PRXCODE      * System Lock Sector 118
          CALL      GETSLK00           * Get System Lock of Sector 118
.
          READ      CONTROLF,HUND18;*168,PTCNCONU
.
          MOVE      ZERO,F10
          MOVE      PTCNCONU,F10
          ADD       ONE,F10
          MOVE      F10,PTCNCONU
.
          WRITAB    CONTROLF,HUND18;*168,PTCNCONU
.
          CALL      RELSLK00           * Release System Lock of Sector 118
          MOVE      PTCNCONU,PMCEWPID  * got next webPAS unique id
.
CONU9999  RETURN
