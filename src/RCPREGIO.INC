.
.    INC       RCPREGIO.INC
.
.    FILE  I/O REQUESTS FOR REGISTER FILE.
.
.OVRCD  FORM            1             0=NOT OVER
.                                     1= OVER
.KEY3   DIM             3             KEY FOR RCPREGA1
.
.         NOTE  OVRCD=1   RECORD DOES NOT EXIST
.                     2   RECORD IS LOCKED
.
.Mods:
.    V9.04.02  24/05/2003  Mike Laming   CAR 58556
.              1) Add fourth index RCPREGA4 based on Description REGDESC
.              2) Add Activity Indicator REGACTIV (0(or blank)=Active)
.
RDAREGA1 RESET     KEY3
         MOVE      ZERO,OVRCD
         READ      RCPREGA1,KEY3;ANS
         GOTO      OVERCOND IF OVER
         RETURN  
.
RDSREGA1 RESET     KEY3
         READ      RCPREGA1,KEY3;;
         RETURN  
.
RDREGA1  MOVE      ZERO,OVRCD
         RESET     KEY3
         READ      RCPREGA1,KEY3;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                                 REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                                 REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                                 REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
RLREGA1  MOVE      ZERO,OVRCD
         RESET     KEY3
         READL     RCPREGA1,KEY3;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                                 REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                                 REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                                 REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         GOTO      OVERLOCK IF LOCKED
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
RDKREGA1 MOVE      ZERO,OVRCD
         READKS    RCPREGA1;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
RDPREGA1 MOVE      ZERO,OVRCD
         READKP    RCPREGA1;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
WRREGA1  RESET     KEY3
         MOVE      ZERO,OVRCD
         MOVE      REGIBACD,REGISTRG
         TRAP      OVERLOCK IF IO
         PACK      REGSPARE,SP70
         WRITE     RCPREGA1,KEY3;KEY3,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         TRAPCLR   IO
.
         RETURN
.
UPREGA1  MOVE      REGIBACD,REGISTRG
         PACK      REGSPARE,SP70
         UPDATE    RCPREGA1;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         RETURN  
.
ULREGA1  UNLOCK    RCPREGA1
         RETURN
.
DEREGA1  RESET     KEY3
         MOVE      ZERO,OVRCD
         DELETE    RCPREGA1,KEY3
         RETURN
.
.
RDAREGA2 RESET     KEY6
         MOVE      ZERO,OVRCD
         READ      RCPREGA2,KEY6;ANS
         GOTO      OVERCOND IF OVER
         RETURN  
.
RDSREGA2 RESET     KEY6
         READ      RCPREGA2,KEY6;;
         RETURN  
.
RDREGA2  MOVE      ZERO,OVRCD
         RESET     KEY6
         READ      RCPREGA2,KEY6;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                                 REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                                 REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                                 REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
RDKREGA2 MOVE      ZERO,OVRCD
         READKS    RCPREGA2;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
.
RDAREGA3 RESET     KEY5
         MOVE      ZERO,OVRCD
         READ      RCPREGA3,KEY5;ANS
         GOTO      OVERCOND IF OVER
         RETURN  
.
RDSREGA3 RESET     KEY5
         READ      RCPREGA3,KEY5;;
         RETURN  
.
RDREGA3  MOVE      ZERO,OVRCD
         RESET     KEY5
         READ      RCPREGA3,KEY5;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                                 REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                                 REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                                 REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
RDKREGA3 MOVE      ZERO,OVRCD
         READKS    RCPREGA3;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN  
.
.
RDSREGA4 RESET     KEY38
         READ      RCPREGA4,KEY38;;
         RETURN
.
RDKREGA4 MOVE      ZERO,OVRCD
         READKS    RCPREGA4;REGCODE,REGDESC,REGCHQCD,REGGENLD,REGGENBK:
                            REGGROUP,REGIBACD,REGSUNDT,REGDISS,REGRESP:
                            REGGENDS,REGGST,REGISTRG,REGHOSP,REGACTIV:
                            REGGENDB,REGGENGS,RCRECSUR,REGSPARE
         GOTO      OVERCOND IF OVER
         MOVE      REGGROUP,SAVGROUP
         RETURN
