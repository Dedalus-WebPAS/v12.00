. *----------------------------------------------------------------------
. * Include Name  :   COMDEPTM.PBL
. *
. * Function      :   CGI variable functions for COMDEPFD - comdepaf.dat
. *
. * Modifications :                                                       
. *
. *V10.04.01 28/02/2014 J.Tan                    CAR 297922
. *          Added PP Service Doctor
. * V9.10.01 05/05/2008 J.Tan                    CAR 162313
. *          Added Deposit status
. * V9.03.04 13/01/2004 Lina Vo                  CAR 44073 
. *          Removed MVTMDP00 & MVRLDP00.                   
. * V9.03.03 15/12/2003 Lina Vo 
. *          Added Medical practice
. *          Added MVTMDP00 & MVRLDP00.          CAR 44073
. * V9.03.01 02/12/2003 Davin                    CAR 44095
. *          Added u/r, admn & sflg
. * V9.03.00 26/11/2003 Ebon Clements            CAR 44095
. *          Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear parameters for the common deposit file
.------------------------------------------------------------------------
CPCOMD00  MOVE      Z70,COMDP001
          MOVE      Z70,COMDP002
          MOVE      Z70,COMDP003
          MOVE      Z70,COMDP004
          MOVE      Z70,COMDP005
          MOVE      Z70,COMDP006
          MOVE      Z70,COMDP007
          MOVE      Z70,COMDP008
          MOVE      Z70,COMDP009
          MOVE      Z70,COMDP010
          MOVE      Z70,COMDP011
          MOVE      Z70,COMDP012
          MOVE      Z70,COMDP013
          MOVE      Z70,COMDP014
          MOVE      Z70,COMDP015
          MOVE      Z70,COMDP016
          MOVE      Z70,COMDP017
          MOVE      Z70,COMDP018
.
CPCOMD99  RETURN
.
.------------------------------------------------------------
. Common deposit file standard tags
.------------------------------------------------------------
CMDP0000  BRANCH    FLDITMNO,CMDP0010,CMDP0020,CMDP0030,CMDP0040,CMDP0050:
                             CMDP0060,CMDP0070,CMDP0080,CMDP0090,CMDP0100:
                             CMDP0110,CMDP0120,CMDP0130,CMDP0140,CMDP0150:
                             CMDP0160,CMDP0170,CMDP0180
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CMDP9999
.
CMDP0010  MATCH     CMDETDAT,SP70
          GOTO      CMDP9999 IF EQUAL
.
          UNPACK    CMDETDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CMDP9999
.
CMDP0020  WRITE     HTMLFILE;CMDERECN;
          GOTO      CMDP9999
.
CMDP0030  WRITE     HTMLFILE;CMDETCNT;
          GOTO      CMDP9999
.
CMDP0040  MOVE      "DP",CATEGORY
          MOVE      CMDEDTYP,CODE
          CALL      CODITM00
          GOTO      CMDP9999
.
CMDP0050  MOVE      "DR",CATEGORY
          MOVE      CMDERRFN,CODE
          CALL      CODITM00
          GOTO      CMDP9999
.
CMDP0060  MATCH     CMDEREFD,SP70
          GOTO      CMDP9999 IF EQUAL
.
          UNPACK    CMDEREFD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CMDP9999
.
CMDP0070  WRITE     HTMLFILE;CMDEREFT;
          GOTO      CMDP9999
.
CMDP0080  WRITE     HTMLFILE;CMDEURNO;
          GOTO      CMDP9999
.
CMDP0090  WRITE     HTMLFILE;CMDEADMN;
          GOTO      CMDP9999
.
CMDP0100  WRITE     HTMLFILE;CMDESFLG;
          GOTO      CMDP9999
.
CMDP0110  WRITE     HTMLFILE;CMDESYST;
          GOTO      CMDP9999
.
CMDP0120  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CMDP0122
          MOVE      CMDEPRAC,KEY6
          CALL      RDPRPR1
          BRANCH    OVRCD,CMDP9999
          WRITE     HTMLFILE;PRPRDESC;
          GOTO      CMDP9999
.
CMDP0122  PACK      CMDEPRAC,CMDEPRAC,SP70
          MATCH     SP70,CMDEPRAC
          GOTO      CMDP9999 IF EQUAL
          WRITE     HTMLFILE;CMDEPRAC;
          GOTO      CMDP9999
.
CMDP0130  MATCH     CMDECDAT,SP70
          GOTO      CMDP9999 IF EQUAL
.
          UNPACK    CMDECDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CMDP9999
.
CMDP0140  WRITE     HTMLFILE;CMDECTIM;
          GOTO      CMDP9999
.
CMDP0150  MATCH     SP70,CMDECUID
          GOTO      CMDP9999 IF EQUAL
.
          PACK      KEY10,CMDECUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      CMDECUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM; 
          GOTO      CMDP9999
.
CMDP0160  MATCH     CMDEUDAT,SP70
          GOTO      CMDP9999 IF EQUAL
.
          UNPACK    CMDEUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CMDP9999
.
CMDP0170  WRITE     HTMLFILE;CMDEUTIM;
          GOTO      CMDP9999
.
CMDP0180  MATCH     SP70,CMDEUUID
          GOTO      CMDP9999 IF EQUAL
.
          PACK      KEY10,CMDEUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      CMDEUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM; 
          GOTO      CMDP9999
.
CMDP9999  RETURN
.------------------------------------------------------------
.   Set Parameters for common deposit file
.------------------------------------------------------------
SPCMD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPCMD010,SPCMD020,SPCMD030,SPCMD040,SPCMD050:
                       SPCMD060,SPCMD070,SPCMD080,SPCMD090,SPCMD100:
                       SPCMD110,SPCMD120,SPCMD130,SPCMD140,SPCMD150:
                       SPCMD160,SPCMD170,SPCMD180
.
          MOVE      ONE,EXIT
          GOTO      SPCMD999
.
SPCMD010  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      COMDP001,CCENT,CYEAR,CMON,CDAY
          GOTO      SPCMD999
.
SPCMD020  MOVE      QRYDATA,COMDP002
          GOTO      SPCMD999
.
SPCMD030  MOVE      QRYDATA,COMDP003
          GOTO      SPCMD999
.
SPCMD040  MOVE      QRYDATA,COMDP004
          GOTO      SPCMD999
.
SPCMD050  MOVE      QRYDATA,COMDP005
          GOTO      SPCMD999
.
SPCMD060  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      COMDP006,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPCMD999
.
SPCMD070  MOVE      QRYDATA,COMDP007
          GOTO      SPCMD999
.
SPCMD080  MOVE      QRYDATA,COMDP008
          GOTO      SPCMD999
.
SPCMD090  MOVE      QRYDATA,COMDP009
          GOTO      SPCMD999
.
SPCMD100  MOVE      QRYDATA,COMDP010
          GOTO      SPCMD999
.
SPCMD110  MOVE      QRYDATA,COMDP011
          GOTO      SPCMD999
.
SPCMD120  MOVE      QRYDATA,COMDP012
          GOTO      SPCMD999
.
SPCMD130  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      COMDP013,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPCMD999
.
SPCMD140  MOVE      QRYDATA,COMDP014
          GOTO      SPCMD999
.
SPCMD150  MOVE      QRYDATA,COMDP015
          GOTO      SPCMD999
.
SPCMD160  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      COMDP016,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPCMD999
.
SPCMD170  MOVE      QRYDATA,COMDP017
          GOTO      SPCMD999
.
SPCMD180  MOVE      QRYDATA,COMDP018
          GOTO      SPCMD999
.
SPCMD999  RETURN
.------------------------------------------------------------
.  Update common deposit file
.------------------------------------------------------------
MVCOMD00  MATCH     COMDP001,Z70
          IF        !@EQUAL
            MOVE      COMDP001,CMDETDAT
          ENDIF
.
          MATCH     COMDP002,Z70
          IF        !@EQUAL
            MOVE      COMDP002,CMDERECN
          ENDIF
.
          MATCH     COMDP003,Z70
          IF        !@EQUAL
            MOVE      COMDP003,CMDETCNT
          ENDIF
.
          MATCH     COMDP004,Z70
          IF        !@EQUAL
            MOVE      COMDP004,CMDEDTYP
          ENDIF
.
          MATCH     COMDP005,Z70
          IF        !@EQUAL
            MOVE      COMDP005,CMDERRFN
          ENDIF
.
          MATCH     COMDP006,Z70
          IF        !@EQUAL
            MOVE      COMDP006,CMDEREFD
          ENDIF
.
          MATCH     COMDP007,Z70
          IF        !@EQUAL
            MOVE      COMDP007,CMDEREFT
          ENDIF
.
          MATCH     COMDP008,Z70
          IF        !@EQUAL
            MOVE      COMDP008,CMDEURNO
          ENDIF
.
          MATCH     COMDP009,Z70
          IF        !@EQUAL
            MOVE      COMDP009,CMDEADMN
          ENDIF
.
          MATCH     COMDP010,Z70
          IF        !@EQUAL
            MOVE      COMDP010,CMDESFLG
          ENDIF
.
          MATCH     COMDP011,Z70
          IF        !@EQUAL
            MOVE      COMDP011,CMDESYST
          ENDIF
.
          MATCH     COMDP012,Z70
          IF        !@EQUAL
            MOVE      COMDP012,CMDEPRAC
          ENDIF
.
          MATCH     COMDP013,Z70
          IF        !@EQUAL
            MOVE      COMDP013,CMDECDAT
          ENDIF
.
          MATCH     COMDP014,Z70
          IF        !@EQUAL
            MOVE      COMDP014,CMDECTIM
          ENDIF
.
          MATCH     COMDP015,Z70
          IF        !@EQUAL
            MOVE      COMDP015,CMDECUID
          ENDIF
.
          MATCH     COMDP016,Z70
          IF        !@EQUAL
            MOVE      COMDP016,CMDEUDAT
          ENDIF
.
          MATCH     COMDP017,Z70
          IF        !@EQUAL
            MOVE      COMDP017,CMDEUTIM
          ENDIF
.
          MATCH     COMDP018,Z70
          IF        !@EQUAL
            MOVE      COMDP018,CMDEUUID
          ENDIF
.
MVCOMD99  RETURN
.
.------------------------------------------------------------
.  Clear common deposit file
.------------------------------------------------------------
CLCMDP00  MOVE      SP70,CMDETDAT
          MOVE      SP70,CMDERECN
          MOVE      SP70,CMDETCNT
          MOVE      SP70,CMDEDTYP
          MOVE      SP70,CMDERRFN
          MOVE      SP70,CMDEREFD
          MOVE      SP70,CMDEREFT
          MOVE      SP70,CMDEURNO
          MOVE      SP70,CMDEADMN
          MOVE      SP70,CMDESFLG
          MOVE      ZERO,CMDESYST
          MOVE      SP70,CMDEPRAC
          MOVE      SP70,CMDECDAT
          MOVE      SP70,CMDECTIM
          MOVE      SP70,CMDECUID
          MOVE      SP70,CMDEUDAT
          MOVE      SP70,CMDEUTIM
          MOVE      SP70,CMDEUUID
          MOVE      "0",CMDESTAT
          MOVE      SP70,CMDEAINV
          MOVE      SP70,CMDESDOC
          MOVE      SP70,CMDESPAR
.
CLCMDP99  RETURN
