.******************************************************************************
.* LABELWAT - This is a proc to display the variables painted for             *
.*            Waiting List Labels.                                            *
.* PARAMETERS  :                                                              *
.*                                                                            *
.*               KEY19 = U/R,PROCEDURE CODE,COUNT                             *
.*               USINGELT - Using Eltron printer                              *
.*                     0 = No                                                 *
.*                     1 = Yes                                                *
.*                                                                            *
.* RETURNS     : EXIT 0 = Labels Printed / Zero Labels Selected               *
.*                    1 = Not Screen Painted                                  *
.*               NOLABEL = Number of labels to print                          *
.* Mods        :                                                              *
.******************************************************************************
.* V11.02.01 14/04/2022  Thanh T          TSK 0903453                         *
.*           Changed INIT0000 to read pmspx2af so data to be avaliable for    *
.*           printing                                                         *
.******************************************************************************
.*               12/07/2007  Peter Vela CAR 142913                            *
.*               Added call to GCCSJG00                                       *
.*               28/09/2000  Dean Cramer                                      *
.*               Recomplied for DXPATMAS                                      *
.*               Changed for SLA code in PATMX1FD                             *
.*               14/10/1997  Steve Armstrong                                  *
.*               Mods for Wrist Band Labels                                   *
.*               19/05/1997  Steve Armstrong      WHL                         *
.*               Mods for Eltron printer                                      *
.*                                                                            *
.******************************************************************************
          DEFPROC   LABELWAT
.
          INC       IBAPASFD/INC
          INC       WATPROFD/INC
          INC       NHIETHFD/INC
          INC       WATAHSVR/INC
.
FORM3     FORM      3
FORM5     FORM      5
DIM2      DIM       2
DIM80     DIM       80
FIELDNO   FORM      5
NMPNUMB   DIM       20
NOTSCPT   FORM      1          * not screen painted flag
PAGELIMT  FORM      "55"
.
STATDES   DIM       20
.
BJDAY     FORM      2
CJDAY     FORM      2
.
SP80      INIT      "                                   ":
                    "                                             "
ZERO4     INIT      "04"
.
CYRSFDTE  DIM       8
CYRSTDTE  DIM       8
CYRSYEAR  FORM      3
.
CATAI     INIT      "AI"
IND1AI    FORM      1
CATAP     INIT      "AP"
CATAR     INIT      "AR"
.
CODEA1    INIT      "A1"
CODEA2    INIT      "A2"
CODEA3    INIT      "A3"
CODEA4    INIT      "A4"
CODEA5    INIT      "A5"
CODEAC    INIT      "AC"
CODEBT    INIT      "BT"
CODECL    INIT      "CL"
CODEC     INIT      "C "
CODECC    INIT      "CC"
CODEDA    INIT      "DA"
CODEEA    INIT      "EA"
CODEEP    INIT      "EP"
CODEES    INIT      "ES"
CODEEW    INIT      "EW"
CODEDC    INIT      "DC"
CODEH1    INIT      "H1"
CODEH2    INIT      "H2"
CODEH3    INIT      "H3"
CODELT    INIT      "LT"
CODEM     INIT      "M "
CODEP     INIT      "P "
CODEP1    INIT      "P1"
CODEP2    INIT      "P2"
CODEP3    INIT      "P3"
CODEP4    INIT      "P4"
CODEP5    INIT      "P5"
CODEP6    INIT      "P6"
CODER     INIT      "R "
CODES     INIT      "S "
CODET     INIT      "T "
CODETY    INIT      "TY"
CODEU1    INIT      "U1"
CODEU2    INIT      "U2"
CODEU3    INIT      "U3"
CODEU4    INIT      "U4"
CODEU5    INIT      "U5"
CODEU6    INIT      "U6"
CODEU7    INIT      "U7"
CODEUNK   INIT      "UNK"
CODEV6    INIT      "V6"
CODEV7    INIT      "V7"
CODEV8    INIT      "V8"
CODEXM    INIT      "XM"
THIRTY7   FORM      "37"
.
.
.--------------------------------------------------------------------------
.
MAIN0000  CALL      INIT0000                * open files
.
..          READ      CONTROLF,THIRTY7;*229,WTCNLABL
..          MOVE      WTCNLABL,NOLABEL        * set the number of labels
          MOVE      ONE,LABCOS
          MOVE      ONE,LABSIZE
.
          CALL      LABELCOM                * process screen painted labels
.
MAIN9999  GOTO      LABWAT99
.
+
.******************************************************************************
.*        INIT0000 - Open some files.                                         *
.******************************************************************************
.
INIT0000  UNPACK    LABELTYP,PRGID,SCRID
.
.-------  Open Patient Files  -------
.
          PACK      KEY19,WAITKEYS,SP70
          CALL      RDTREA1
.
          PACK      KEY8,URNUMBER
          CALL      RDMAST1
.
          OPEN      PMSPX2A1,"pmspx2af"
          PACK      KEY8,URNUMBER,SP70
          CALL      RDPMPX21
          IF        OVRCD = 1
            CALL     CLPMSPX2
          ENDIF
.
          CALL      GCCSJG00
.
.         set the PMI GP details
.
          MOVE      SP30,PMHCSNAM
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
.
          MOVE      SP70,PMHGADD1
          PACK      KEY10,PMPXRH1G,SP70  * GP Practice code
          PACK      KEY12,KEY10,PMPXR1GC,SP70  * GP Practice code
          CALL      RDPMHCG1
.
          READ      CONTROLF,TWENTY1;*138,PTCNNHII
.
          IF        PTCNNHII = 1
            MOVE      SP10,NHMARES
            MOVE      SP10,NHMAETH
            MOVE      SP30,NMPNUMB 
            MOVE      URNUMBER,KEY8
            CALL      RDNHMAS2
          ELSE
            MOVE      SP20,NMPNUMB
            PACK      KEY10,CHOSINDX,URNUMBER,SP10 
            CALL      RDPTNID1
            MOVE      PTNINMPI,NMPNUMB
          ENDIF 
.
.         See if using Eltron printer
.
          READ      CONTROLF,THIRTY7;*231,WTCNWELT
          MOVE      WTCNWELT,USINGELT       * save parameter
.
INIT9999  RETURN
+
.
.*****************************************************************
.*        DISPVARS  Display Items            Called By :         *
.*****************************************************************
DISPVARS  MOVE      SCPSITM,FIELDNO
          MOVE      SCPSLEN,LLCNT
.
          COMPARE   "500",FIELDNO
          GOTO      DVARS100 IF LESS
.
          SUB       "500",FIELDNO
          MOVE      FIELDNO,SCPSITM
          CALL      DXWATTRE
          GOTO      DVARS999
.
DVARS100  CALL      DXPATMAS
.
DVARS999  RETURN
+
          INC       AGECHK
          INC       CALCYRS
          INC       DSPFIELD
          INC       DXPATCOD
          INC       DXPATDOC
          INC       DXPATMAS
          INC       DXWATTRE
          INC       IBAOVRIO/INC
          INC       IBAPASIO/INC
          INC       NHIETHIO/INC
          INC       WATPROIO/INC
          INC       WEBLBCOM
          INC       PMIGTNID
.
LABWAT99  ENDPROC
