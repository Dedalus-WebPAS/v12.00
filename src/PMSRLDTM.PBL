. *----------------------------------------------------------------------
. * Include Name  :   PMSRLDTM.PBL
. *
. * Function      :   CGI variables for PMSRLDFD - pmsrldaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.02.01  04/07/2011  Davin         CAR 240723
.             Created include
.------------------------------------------------------------------------
.   Clear parameters for doctor roles file
.------------------------------------------------------------------------
CPPMRL00  MOVE      Z70,PMRLD001
          MOVE      Z70,PMRLD002
          MOVE      Z70,PMRLD003
          MOVE      Z70,PMRLD004
CPPMRL99  RETURN
.------------------------------------------------------------
. Tags for doctor roles table
.------------------------------------------------------------
PMRL0000  BRANCH    FLDITMNO,PMRL0010,PMRL0020,PMRL0030,PMRL0040,PMRL0050:
                             PMRL0060,PMRL0070,PMRL0080,PMRL0090,PMRL0100
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMRL9999
.
PMRL0010  WRITE     HTMLFILE;PMRDDOCT;
          GOTO      PMRL9999
.
PMRL0020  WRITE     HTMLFILE;PMRDHOSP;
          GOTO      PMRL9999
.
PMRL0030  MOVE      "rm",CATEGORY
          MOVE      PMRDROLE,CODE
          CALL      CODITM00
          GOTO      PMRL9999
.
PMRL0040  WRITE     HTMLFILE;PMRDACTV;
          GOTO      PMRL9999
.
PMRL0050  MATCH     SP70,PMRDCUID
          GOTO      PMRL9999 IF EQUAL
.
          PACK      KEY10,PMRDCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMRDCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMRL9999
.
PMRL0060  MATCH     PMRDCDAT,SP70
          GOTO      PMRL9999 IF EQUAL
.
          UNPACK    PMRDCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMRL9999
.
PMRL0070  WRITE     HTMLFILE;PMRDCTIM;
          GOTO      PMRL9999
.
PMRL0080  MATCH     SP70,PMRDUUID
          GOTO      PMRL9999 IF EQUAL
.
          PACK      KEY10,PMRDUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMRDUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMRL9999
.
PMRL0090  MATCH     PMRDUDAT,SP70
          GOTO      PMRL9999 IF EQUAL
.
          UNPACK    PMRDUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMRL9999
.
PMRL0100  WRITE     HTMLFILE;PMRDUTIM;
          GOTO      PMRL9999
.
PMRL9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for doctor roles
.------------------------------------------------------------
SPPMO000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMO001,SPPMO002,SPPMO003,SPPMO004
.
          MOVE      ONE,EXIT
          GOTO      SPPMO999
.
SPPMO001  MOVE      QRYDATA,PMRLD001
          GOTO      SPPMO999
.
SPPMO002  MOVE      QRYDATA,PMRLD002
          GOTO      SPPMO999
.
SPPMO003  MOVE      QRYDATA,PMRLD003
          GOTO      SPPMO999
.
SPPMO004  MOVE      QRYDATA,PMRLD004
          GOTO      SPPMO999
.
SPPMO999  RETURN
.
.------------------------------------------------------------
.  Update doctor roles details
.------------------------------------------------------------
MVPMRL00  MATCH     PMRLD001,Z70
          IF        !@EQUAL
            MOVE      PMRLD001,PMRDDOCT
          ENDIF
.
          MATCH     PMRLD002,Z70
          IF        !@EQUAL
            MOVE      PMRLD002,PMRDHOSP
          ENDIF
.
          MATCH     PMRLD003,Z70
          IF        !@EQUAL
            MOVE      PMRLD003,PMRDROLE
          ENDIF
.
          MATCH     "2",PMRLD004
          IF        @EQUAL
            MOVE      ZERO,PMRDACTV       * active
          ELSE
            MOVE      ONE,PMRDACTV        * not active
          ENDIF
.
MVPMRL99  RETURN
+
