. Modifications
.   V11.02.02 02/03/2022 Peter Vela    Task 0914306
.             Fixed DSWOECST -> DSWOEMST
.   V11.02.01 10/12/2021 Peter Vela    Task 0914306
.             Fixed labels
.   V11.01.01 30/11/2021 Peter Vela    CAR 0914306
.             Created Include
.
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
WBOM0000  BRANCH    FLDITMNO,WBOM0100,WBOM0200,WBOM0300,WBOM0400,WBOM0500:
                             WBOM0600,WBOM0700,WBOM0800,WBOM0900,WBOM1000:
                             WBOM1100,WBOM1200,WBOM1300,WBOM1400,WBOM1500

          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      WBOM9999
.
WBOM0100  WRITE     HTMLFILE;WBOEVISN;
          GOTO      WBOM9999
.
WBOM0200  WRITE     HTMLFILE;WBOECNTR;
          GOTO      WBOM9999
.
WBOM0300  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MATCH     SP70,WBOESTAT
          GOTO      WBOM9999 IF EQUAL
          BRANCH    F1,WBOM0310
          WRITE     HTMLFILE;WBOESTAT;
          GOTO      WBOM9999
WBOM0310  PACK      DSWOEMST,SP70
          MOVE      WBOESTAT,F2
          LOAD      DSWOEMST,F2,DSPWBOM1,DSPWBOM2,DSPWBOM3,DSPWBOM4,DSPWBOM5:
                                DSPWBOM6,DSPWBOM7
          MATCH     " 0",WBOESTAT
          IF        @EQUAL
            MOVE      DSPWBOM0,DSWOEMST
          ENDIF
          WRITE     HTMLFILE;DSWOEMST
          GOTO      WBOM9999
.
WBOM0400  WRITE     HTMLFILE;WBOEURNO;
          GOTO      WBOM9999
.
WBOM0500  WRITE     HTMLFILE;WBOEARID;
          GOTO      WBOM9999
.
WBOM0600  WRITE     HTMLFILE;WBOETRID;
          GOTO      WBOM9999
.
WBOM0700  UNPACK    WBOERQDT,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOERQDT
          GOTO      WBOM9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOM9999
.
WBOM0800  WRITE     HTMLFILE;WBOEETYP;
          GOTO      WBOM9999
.
WBOM0900  WRITE     HTMLFILE;WBOEERRC;
          GOTO      WBOM9999
.
WBOM1000  WRITE     HTMLFILE;WBOEERRD;
          GOTO      WBOM9999
.
WBOM1100  UNPACK    WBOECDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOECDTE
          GOTO      WBOM9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOM9999
.
WBOM1200  WRITE     HTMLFILE;WBOECTIM;
          GOTO      WBOM9999
.
WBOM1300  UNPACK    WBOEUDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOEUDTE
          GOTO      WBOM9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOM9999
.
WBOM1400  WRITE     HTMLFILE;WBOEUTIM;
          GOTO      WBOM9999
.
WBOM1500  WRITE     HTMLFILE;WBOEHOSP;
          GOTO      WBOM9999
.
WBOM9999  RETURN
.------------------------------------------------------------
.   Set Parameters for weboecaf file
.------------------------------------------------------------
SWBOM000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SWBOM010,SWBOM020,SWBOM030,SWBOM040,SWBOM050:
                       SWBOM060,SWBOM070,SWBOM080,SWBOM090,SWBOM100:
                       SWBOM110,SWBOM120,SWBOM130,SWBOM140,SWBOM150
.                      
          MOVE      ONE,EXIT
          GOTO      SWBOM999
.
SWBOM010  MOVE      QRYDATA,WEBOM001
          GOTO      SWBOM999
.
SWBOM020  MOVE      QRYDATA,WEBOM002
          GOTO      SWBOM999
.
SWBOM030  MOVE      QRYDATA,WEBOM003
          GOTO      SWBOM999
.
SWBOM040  MOVE      QRYDATA,WEBOM004
          GOTO      SWBOM999
.
SWBOM050  MOVE      QRYDATA,WEBOM005
          GOTO      SWBOM999
.
SWBOM060  MOVE      QRYDATA,WEBOM006
          GOTO      SWBOM999
.
SWBOM070  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOM007,CCENT,CYEAR,CMON,CDAY
          GOTO      SWBOM999
.
SWBOM080  MOVE      QRYDATA,WEBOM008
          GOTO      SWBOM999
.
SWBOM090  MOVE      QRYDATA,WEBOM009
          GOTO      SWBOM999
.
SWBOM100  MOVE      QRYDATA,WEBOM010
          GOTO      SWBOM999
.
SWBOM110  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOM011,CCENT,CYEAR,CMON,CDAY 
          GOTO      SWBOM999
.
SWBOM120  MOVE      QRYDATA,WEBOM012
          GOTO      SWBOM999
.
SWBOM130  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOC013,CCENT,CYEAR,CMON,CDAY
          GOTO      SWBOM999
.
SWBOM140  MOVE      QRYDATA,WEBOM014
          GOTO      SWBOM999
.
SWBOM150  MOVE      QRYDATA,WEBOM015
          GOTO      SWBOM999
.
SWBOM999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters 
.------------------------------------------------------------
CWBOM000  MOVE      Z70,WEBOM001
          MOVE      Z70,WEBOM002
          MOVE      Z70,WEBOM003
          MOVE      Z70,WEBOM004 
          MOVE      Z70,WEBOM005
          MOVE      Z70,WEBOM006
          MOVE      Z70,WEBOM007
          MOVE      Z70,WEBOM008
          MOVE      Z70,WEBOM009
          MOVE      Z70,WEBOM010
          MOVE      Z70,WEBOM011
          MOVE      Z70,WEBOM012
          MOVE      Z70,WEBOM013
          MOVE      Z70,WEBOM014
          MOVE      Z70,WEBOM015
.
          RETURN
.
.------------------------------------------------------------
.  Update 
.------------------------------------------------------------
UPWBOM00  MATCH     WEBOM001,Z70  
          IF        !@EQUAL
            MOVE       WEBOM001,WBOEVISN
          ENDIF
.
          MATCH     WEBOM002,Z70
          IF        !@EQUAL
            MOVE      WEBOM002,WBOECNTR
          ENDIF
.
          MATCH     WEBOM003,Z70   
          IF        !@EQUAL
            MOVE      WEBOM003,WBOESTAT
          ENDIF
.
          MATCH     WEBOM004,Z70
          IF        !@EQUAL
            MOVE      WEBOM004,WBOEURNO
          ENDIF
.
          MATCH     WEBOM005,Z70
          IF        !@EQUAL
            MOVE      WEBOM005,WBOEARID
          ENDIF
.
          MATCH     WEBOM006,Z70   
          IF        !@EQUAL
            MOVE      WEBOM006,WBOETRID
          ENDIF
.
          MATCH     WEBOM007,Z70
          IF        !@EQUAL
            MOVE      WEBOM007,WBOERQDT
          ENDIF
.
          MATCH     WEBOM008,Z70
          IF        !@EQUAL
            MOVE      WEBOM008,WBOEETYP
          ENDIF
.
          MATCH     WEBOM009,Z70
          IF        !@EQUAL
            MOVE      WEBOM009,WBOEERRC
          ENDIF
.
          MATCH     WEBOM010,Z70
          IF        !@EQUAL
            MOVE      WEBOM010,WBOEERRD
          ENDIF
.
          MATCH     WEBOM011,Z70
          IF        !@EQUAL
            MOVE      WEBOM011,WBOECDTE
          ENDIF
.
          MATCH     WEBOM012,Z70
          IF        !@EQUAL
            MOVE      WEBOM012,WBOECTIM
          ENDIF
.
          MATCH     WEBOM013,Z70
          IF        !@EQUAL
            MOVE      WEBOM013,WBOEUDTE
          ENDIF
.
          MATCH     WEBOM014,Z70
          IF        !@EQUAL
            MOVE      WEBOM014,WBOEUTIM
          ENDIF
.
          MATCH     WEBOM015,Z70
          IF        !@EQUAL
            MOVE      WEBOM015,WBOEHOSP
          ENDIF
.
UPWBOM99  RETURN
+
