.******************************************************************************
.* System         : Outpatients                                               *
.*                                                                            *
.* Include Name   : DXOUTDET.PBL                                              *
.*                                                                            *
.* Function       : To Display all the variables for Outpatient visit based   *
.*                  details                                                   *
.*                                                                            *
.* Author         : Justin Coates           14/12/1992                        *
.*                                                                            *
.* Parameters     : SCRPSTFD record                                           *
.*                                                                            *
.* Modifications  :                                                           *
.*        V11.02.01 12/05/2022  Jacob Jackson     TSK 0919301                 *
.*                  Modify DOTDT085 & DOTDT086 labels to use OTHELTYP (clinic *
.*                  booking) instead of OTMALTYP (clinic master)              *
.*        V10.15.01 17/10/2019  Ken Bell          TSK 0875392                 *
.*                  Exclude Claim Data if Claim is Cancelled                  *
.******************************************************************************
.*        V10.08.01 28/06/2016  Nicole Torrisi    TSK 0817199                 *
.*                  Added Attending Doctor - OBADOCT                          *
.*        V10.06.01 14/07/2015  Peter Vela        CAR 312033                  *
.*                  Changed DOTDT058 and DOTDT062 to HCP                      *
.*        V10.05.01 13/10/2014  Ania P            CAR 303879                  *
.*                  Added HP code output                                      *
.*        V10.02.02 01/07/2011  Ebon Clements     CAR 242246                  *
.*                  Added clinic phone number                                 *
.*        V10.02.01 09/06/2011  Ebon Clements     CAR 239530                  *
.*                  Added print extra contact functionality                   *
.*        V9.12.02  16/10/2009  Ebon Clements     CAR 206812                  *
.*                  Pack 684 formatted app date and time with spaces          *
.*        V9.12.01  16/10/2009  Ebon Clements     CAR 190680                  *
.*                  Fixed pack of VAR after calls to CMPH0000                 *
.*        V9.10.01  09/09/2008  Ebon Clements     CAR 175728                  *
.*                  Added item 104 - Compensable/Heath Fund Name              *
.*                  Added item 105 - Compensable/Heath Fund Number            *
.*        V9.09.02  04/12/2007  Peter McMullen   CAR 137137                   *
.*                  Added item 103 - Clinic Description (raw)                 *
.*        V9.09.01  19/09/2007  Steve Armstrong  CAR 124435                   *
.*                  Added item 102 - ACC Number                               *
.******************************************************************************
.*        V9.08.01  23/11/2006  Steve Armstrong  CAR 125800                   *
.*                  Added interpreter name (sing) - 101                       *
.******************************************************************************
.*        V9.05.01  28/03/2006  Ebon Clements    CAR 79277                    *
.*                  Added carer contact details                               *
.*        V9.03.02  02/03/2004  Jill Habasque    CAR 47859                    *
.*                  Fixed output of times in not using 12 hour clock          *
.*        V9.03.01  23/12/2003  Peter Vela       * I CAR 37624                *
.*                  Added Clinic Location Type and Clinic Location Type Desc  *
.*        V9.00.B01 14.07.2001  Sandra Barcham                                *
.*                  Replaced GP with HCP                                      *
.*        V5.09.B02 01/02/2001  Greg Horvat                                   *
.*                  Changed to not use CODE?? variables for setting up the    *
.*                  TCODE variable                                            *
.*        V5.09.B01 10/01/2001  Greg Horvat                                   *
.*                  Replaced certain DIM variables with KEY variables         *
.*        V5.08.01  06/06/2000  Jill Habasque                                 *
.*                  Changed from key10 to key14 for the health fund file      *
.*                  20/11/98 J.Tan   SRF 645120                               *
.*                           Fixed 12 hour clock                              *
.*                  13/04/93  Steve O'Gorman                                  *
.*                            Changes CODES to OSTCATG for Src of Refferal    *
.*                  03/11/1993    Justin Coates  QUOTE 440017 SRF 440204      *
.*                  added display of practice count to practice code field    *
.*                  07/03/1994    Justin Coates  SRF 440204                   *
.*                  added display of district of residence                    *
.*                  30/03/1994    Justin Coates                               *
.*                  added GP code - not related to a practice                 *
.*                  10/11/1995    MATT                                        *
.*                  added OCACLIN  - Clinic Id                                *
.*                        OCADESC  - Clinic Description                       *
.*                        OCTCTYP  - Clinic Type Id                           *
.*                        OCTDESC  - Clinic Type Description                  *
.*                        OTMACLSE - Session Id                               *
.*                        OCADESC  - Session Description                      *
.*                        OTMAHOSP - Hospital Id                              *
.*                        PTHSNAME - Hospital Name                            *
.*                        OMASTART - Session Start Time                       *
.*                        OBASTART - Slot Start Time                          *
.*                  20/12/1995    MATT                                        *
.*                  Added HCMN0000 routine.                                   *
.*                 21/04/1997   Howellsy         rha                          *
.*                 added otbbrank,obousr5-8                                   *
.*                 26/05/1997   Howellsy         rha                          *
.*                 added obaoutno                                             *
.*                 12/10/1998  Steve Armstrong    srf 644150                  *
.*                 Mods for doctor description                                *
.******************************************************************************
DXOUTDET  MOVE      SCPSITM,FORM5
          BRANCH    FORM5,DOTDT001,DOTDT002,DOTDT003,DOTDT004,DOTDT005:
                          DOTDT006,DOTDT007,DOTDT008,DOTDT009,DOTDT010:
                          DOTDT011,DOTDT012,DOTDT013,DOTDT014,DOTDT015:
                          DOTDT016,DOTDT017,DOTDT018,DOTDT019,DOTDT020:
                          DOTDT021,DOTDT022,DOTDT023,DOTDT024,DOTDT025:
                          DOTDT026,DOTDT027,DOTDT028,DOTDT029,DOTDT030:
                          DOTDT031,DOTDT032,DOTDT033,DOTDT034,DOTDT035:
                          DOTDT036,DOTDT037,DOTDT038,DOTDT039,DOTDT040:
                          DOTDT041,DOTDT042,DOTDT043,DOTDT044,DOTDT045:
                          DOTDT046,DOTDT047,DOTDT048,DOTDT049,DOTDT050:
                          DOTDT051,DOTDT052,DOTDT053,DOTDT054,DOTDT055:
                          DOTDT056,DOTDT057,DOTDT058,DOTDT059,DOTDT060:
                          DOTDT061,DOTDT062,DOTDT063,DOTDT064,DOTDT065:
                          DOTDT066,DOTDT067,DOTDT068,DOTDT069,DOTDT070:
                          DOTDT071,DOTDT072,DOTDT073,DOTDT074,DOTDT075:
                          DOTDT076,DOTDT077,DOTDT078,DOTDT079,DOTDT080:
                          DOTDT081,DOTDT082,DOTDT083,DOTDT084,DOTDT085:
                          DOTDT086,DOTDT087,DOTDT088,DOTDT089,DOTDT090:
                          DOTDT091,DOTDT092,DOTDT093,DOTDT094,DOTDT095:
                          DOTDT096,DOTDT097,DOTDT098,DOTDT099,DOTDT100:
                          DOTDT101,DOTDT102,DOTDT103,DOTDT104,DOTDT105:
                          DOTDT106,DOTDT107,DOTDT108,DOTDT109,DOTDT110
          RETURN
.                         
DOTDT001  PACK      VAR,OBASRCR,SP30,SP30,SP20      * source of referral
          GOTO      DOTDT995
.
DOTDT002  MOVE      OSTCATG,TCODE           * category
          MOVE      OBASRCR,ACODE           * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT003  PACK      VAR,OBACLASS,SP30,SP30,SP20     * patient classification
          GOTO      DOTDT995
.
DOTDT004  PACK      TCODE,ANSA,SP1          * category
          MOVE      OBACLASS,ACODE          * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT005  PACK      VAR,OBACAT,SP30,SP30,SP20       * patient category
          GOTO      DOTDT995
.
DOTDT006  PACK      TCODE,ANSP,SP1          * category
          MOVE      OBACAT,ACODE            * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT007  PACK      VAR,OBAPRTY,SP30,SP30,SP20      * priority
          GOTO      DOTDT995
.
DOTDT008  MOVE      "PR",TCODE            * category
          MOVE      OBAPRTY,ACODE           * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT009  PACK      VAR,PTYPE,SP30,SP30,SP20        * resident status
          GOTO      DOTDT995
.
DOTDT010  MOVE      "T ",TCODE             * category
          MOVE      PTYPE,ACODE             * code
          CALL      DXPATCOD 
          GOTO      DOTDT999
.
DOTDT011  PACK      VAR,OBACOMP,SP30,SP30,SP20      * claim code
          GOTO      DOTDT995
.
DOTDT012  PACK      TCODE,ANSC,ANSL         * category
          MOVE      OBACOMP,ACODE           * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT013  PACK      VAR,PTVKCARD,SP30,SP30,SP20     * card number
          GOTO      DOTDT995
.
DOTDT014  PACK      PTVKCEXP,PTVKCEXP,SP8
          UNPACK    PTVKCEXP,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP30,SP30,SP20
          ELSE
            PACK      VAR,CPDATE,SP30,SP30,SP20
          ENDIF
          CALL      DISPITEM
          RETURN
.
DOTDT015  PACK      VAR,PTVKCXMP,SP30,SP30,SP20     * exemption code
          GOTO      DOTDT995
.
DOTDT016  PACK      TCODE,ANSX,ANSM         * category
          MOVE      PTVKCXMP,ACODE          * code
          CALL      DXPATCOD                * display description
          GOTO      DOTDT999
.
DOTDT017  PACK      VAR,OTBBPVIS,SP30,SP30,SP20     * previous visits
          GOTO      DOTDT995
.
DOTDT018  PACK      VAR,PTVKFMLY,SP30,SP30,SP20     * family id
          GOTO      DOTDT995
.
DOTDT019  PACK      VAR,OBAINS,SP30,SP30,SP20       * special UD field
          GOTO      DOTDT995
DOTDT020  PACK      TCODE,ANSU,ONE          * category
          MOVE      OBAINS,ACODE            * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT021  PACK      VAR,OBOUSR1,SP30,SP30,SP20      * OUT UD 1
          GOTO      DOTDT995
.
DOTDT022  PACK      TCODE,ANSO,ONE          * category
          MOVE      OBOUSR1,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT023  PACK      VAR,OBOUSR2,SP30,SP30,SP20      * OUT UD 2
          GOTO      DOTDT995
.
DOTDT024  PACK      TCODE,ANSO,TWO          * category
          MOVE      OBOUSR2,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT025  PACK      VAR,OBOUSR3,SP30,SP30,SP20      * OUT UD 3
          GOTO      DOTDT995
.
DOTDT026  PACK      TCODE,ANSO,THREE        * category
          MOVE      OBOUSR3,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT027  PACK      VAR,OBOUSR4,SP30,SP30,SP20      * OUT UD 4
          GOTO      DOTDT995
.
DOTDT028  PACK      TCODE,ANSO,FOUR         * category
          MOVE      OBOUSR4,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT029  PACK      VAR,OTBBFUND,SP30,SP30,SP20     * health fund
          GOTO      DOTDT995
.
DOTDT030  MOVE      SP30,HFNAME
          PACK      KEY6,OTBBFUND,SP6
          MATCH     SP6,KEY6                * is there a code
          IF        !@EQUAL
            MOVE      "Invalid Code",HFNAME
            PACK      KEY14,KEY6,ZERO,ZERO,ZERO,ZERO,SP10
            CALL      RDFUND1
          ENDIF
          PACK      VAR,HFNAME,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT031  PACK      VAR,OTBBDEPT,SP30,SP30,SP20     * department
          GOTO      DOTDT995
.
DOTDT032  PACK      TCODE,ANSA,ANSC         * category
          MOVE      OTBBDEPT,ACODE          * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT033  CALL      HCMN0000                          * see if any comments
          MOVE      DYES,ACODE
          LOAD      ACODE,EXIT,DNO          
          PACK      VAR,ACODE,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT034  PACK      VAR,OPDICODE,SP30,SP30,SP20     * diagnosis
          GOTO      DOTDT995
.
DOTDT035  PACK      VAR,OPDIDESC,SP30,SP30,SP20     * diagnosis description
          GOTO      DOTDT995
.
DOTDT036  UNPACK    OTBCRDAT,CCENT,CYEAR,CMON,CDAY    * Referral date
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP30,SP30,SP20
          ELSE
            PACK      VAR,CPDATE,SP30,SP30,SP20
          ENDIF
          GOTO      DOTDT995
.
DOTDT037  PACK      VAR,OTBBTRAN,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT038  PACK      TCODE,ANSO,ANSB         * category
          MOVE      OTBBTRAN,ACODE          * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT039  PACK      VAR,OTBBLNGI,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT040  PACK      TCODE,ANSO,ANSL         * category
          MOVE      OTBBLNGI,ACODE          * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT041  PACK      VAR,OTBBTMFS,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT042  PACK      VAR,OTBBTMBO,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT043  PACK      VAR,OTBBGPFA,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT044  PACK      VAR,OTBBECRA,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT045  PACK      VAR,OTBBRFGP,SP30,SP30,SP20
          GOTO      DOTDT995
.
. Registered HCP Name
.
DOTDT046  PACK      PMHCSNAM,SP70
          PACK      PMHCGNAM,SP70
          PACK      PMHCTITL,SP70
          PACK      KEY10,OTBBRFGP,SP70
          CALL      RDPMHCP1
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME
          PACK      VAR,PACFNAME,SP70,SP10
          GOTO      DOTDT995
.
. HCP Practice code
.
DOTDT047  MOVE      "-",ANS
          MATCH     SP2,OTBBGPPT
          IF        @EQUAL
            MOVE      SP1,ANS
          ENDIF
          PACK      VAR,OTBBGPPC,ANS,OTBBGPPT,SP70,SP10
          GOTO      DOTDT995
.
. HCP Practice name
.
DOTDT048  PACK      PMHGPNAM,SP70
          PACK      KEY10,OTBBGPPC,SP70
          PACK      KEY12,SP70,OTBBGPPT,SP70
          CALL      RDPMHCG1
          PACK      VAR,PMHGPNAM,SP70,SP10
          GOTO      DOTDT995
.
DOTDT049  PACK      VAR,OBAVISIT,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT050  PACK      TCODE,ANSC,ANSV         * category
          MOVE      OBAVISIT,ACODE          * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT051  MOVE      SP3,ACODE
          MATCH     ANSN,OTBBSNDL
          IF        @EQUAL
            MOVE      DNO,ACODE
          ENDIF
          MATCH     ANSY,OTBBSNDL
          IF        @EQUAL
            MOVE      DYES,ACODE
          ENDIF
          PACK      VAR,ACODE,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT052  PACK      VAR,OTBBDOFR,SP30,SP30,SP20  * district of residence
          GOTO      DOTDT995
.
DOTDT053  MOVE      "DA",TCODE              * category
          MOVE      OTBBDOFR,ACODE          * code
          CALL      DXPATCOD
          GOTO      DOTDT999
.
DOTDT054  PACK      VAR,OTBBRFGP,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT055  PACK      VAR,OTBBOPER,SP70,SP10    * security code         
          GOTO      DOTDT995
.
DOTDT056  MOVE      SP70,SECUSER
          MATCH     SP4,OTBBOPER
          IF        !@EQUAL
            CALL      OPPASS1
            PACK      KEY4,OTBBOPER,SP6
            CALL      RDPASS1  
          ENDIF
          PACK      VAR,SECUSER,SP70,SP10
          GOTO      DOTDT995
.
DOTDT057  PACK      VAR,OCACLIN,SP70,SP10    * Clinic Code
          GOTO      DOTDT995
.
.DOTDT058  MATCH     SP6,OCADOCT
.          IF        @EQUAL
.            PACK      VAR,OCADESC,SP70,SP10  * Clinic Description
.            GOTO      DOTDT995
.          ELSE
.            MOVE      OCADOCT,KEY6
.            OPEN      PATDO1A1,"patdo1af"               * Doctor description
.            CALL      DXPATDOC
.            GOTO      DOTDT999
.          ENDIF
.
DOTDT058  MATCH     SP70,OCADOCT
          IF        @EQUAL
            PACK      VAR,OCADESC,SP70,SP10  * Clinic Description
            GOTO      DOTDT995
          ELSE
            OPEN      PMSHCPA1,"pmshcpaf"
            PACK      KEY10,OCADOCT,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,DOTDT999
.
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      TWO,PACFRMT
            CALL      PACNAME
            PACK      VAR,PACFNAME,SP70
            GOTO      DOTDT995
          ENDIF
.
DOTDT059  PACK      VAR,OCTCTYP,SP70,SP10    * Clinic Type Code
          GOTO      DOTDT995
.
DOTDT060  PACK      VAR,OCTDESC,SP70,SP10    * Clinic Type Description
          GOTO      DOTDT995
.
DOTDT061  PACK      VAR,OTMACLSE,SP70,SP10   * Clinic Session Code
          GOTO      DOTDT995
.
.DOTDT062  MATCH     SP6,OCADOCT
.          IF        @EQUAL
.            PACK      VAR,OCADESC,SP70,SP10  * Clinic Description
.            GOTO      DOTDT995
.          ELSE
.            MOVE      OCADOCT,KEY6
.            OPEN      PATDO1A1,"patdo1af"               * Doctor description
.            CALL      DXPATDOC
.            GOTO      DOTDT999
.          ENDIF
.
DOTDT062  MATCH     SP70,OCADOCT
          IF        @EQUAL
            PACK      VAR,OCADESC,SP70,SP10  * Clinic Description
            GOTO      DOTDT995
          ELSE
            OPEN      PMSHCPA1,"pmshcpaf"
            PACK      KEY10,OCADOCT,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,DOTDT999
.
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      TWO,PACFRMT
            CALL      PACNAME
            PACK      VAR,PACFNAME,SP70
            GOTO      DOTDT995
          ENDIF
.
DOTDT063  PACK      VAR,OTMAHOSP,SP70,SP10   * Hospital Code
          GOTO      DOTDT995
.
DOTDT064  PACK      VAR,PTHSNAME,SP70,SP10   * Hospital Description
          GOTO      DOTDT995
.
DOTDT065  MOVE      OMASTART,VSTIM           * Session Start time
          CALL      CTIM0000
          PACK      VAR,VSTIM,KEY3,SP70,SP10   * Session Start Time
          GOTO      DOTDT995
.
DOTDT066  MOVE      OBATIME,VSTIM            * Slot Start Time
          CALL      CTIM0000
          PACK      VAR,VSTIM,KEY3,SP70,SP10    * Slot Start Time
          GOTO      DOTDT995
.
DOTDT067  PACK      KEY10,OTBBRFGP,SP10
          MATCH     SP10,KEY10                * no HCP?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP10
          ENDIF
.
          MATCH     SP10,KEY10
          GOTO      DOTDT999 IF EQUAL       * no code
.
          OPEN      PMSHCPA1,"pmshcpaf"
          CALL      RDPMHCP1
          BRANCH    OVRCD,DOTDT999
.
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
          PACK      VAR,PACFNAME,SP70
          GOTO      DOTDT995
.
DOTDT068  PACK      KEY10,OTBBRFGP,SP10
          MATCH     SP10,KEY10                * no HCP?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP10
          ENDIF
.
          MATCH     SP10,KEY10
          GOTO      DOTDT999 IF EQUAL       * no code
.
          OPEN      PMSHCPA1,"pmshcpaf"
          CALL      RDPMHCP1
          BRANCH    OVRCD,DOTDT999
.
          PACK      VAR,PMHCADR1,SP70
          GOTO      DOTDT995
.
DOTDT069  PACK      KEY10,OTBBRFGP,SP10
          MATCH     SP10,KEY10                * no HCP?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP10
          ENDIF
.
          MATCH     SP10,KEY10
          GOTO      DOTDT999 IF EQUAL       * no code
.
          OPEN      PMSHCPA1,"pmshcpaf"
          CALL      RDPMHCP1
          BRANCH    OVRCD,DOTDT999
.
          PACK      VAR,PMHCADR2,SP70
          GOTO      DOTDT995
.
DOTDT070  PACK      KEY10,OTBBRFGP,SP10
          MATCH     SP10,KEY10                * no HCP?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP10
          ENDIF
.
          MATCH     SP10,KEY10
          GOTO      DOTDT999 IF EQUAL       * no code
.
          OPEN      PMSHCPA1,"pmshcpaf"
          CALL      RDPMHCP1
          BRANCH    OVRCD,DOTDT999
.
          PACK      VAR,PMHCADR3,SP70
          GOTO      DOTDT995
.
DOTDT071  PACK      KEY10,OTBBRFGP,SP10
          MATCH     SP10,KEY10                * no HCP?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP10
          ENDIF
.
          MATCH     SP10,KEY10
          GOTO      DOTDT999 IF EQUAL       * no code
.
          OPEN      PMSHCPA1,"pmshcpaf"
          CALL      RDPMHCP1
          BRANCH    OVRCD,DOTDT999
.
          PACK      VAR,PMHCADR4,SP70
          GOTO      DOTDT995
.
DOTDT072  PACK      KEY10,OTBBRFGP,SP10
          MATCH     SP10,KEY10                * no HCP?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP10
          ENDIF
.
          MATCH     SP10,KEY10
          GOTO      DOTDT999 IF EQUAL       * no code
.
          OPEN      PMSHCPA1,"pmshcpaf"
          CALL      RDPMHCP1
          BRANCH    OVRCD,DOTDT999
.
          PACK      VAR,PMHCPOST,SP70
          GOTO      DOTDT995
.
DOTDT073  UNPACK    OBADATE,CCENT,CYEAR,CMON,CDAY    * Referral date
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP30,SP30,SP20
          ELSE
            PACK      VAR,CPDATE,SP30,SP30,SP20
          ENDIF
          GOTO      DOTDT995
.
DOTDT074  PACK      VAR,OBOUSR5,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT075  PACK      TCODE,ANSO,FIVE         * category
          MOVE      OBOUSR5,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT076  PACK      VAR,OBOUSR6,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT077  PACK      TCODE,ANSO,SIX          * category
          MOVE      OBOUSR6,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT078  PACK      VAR,OBOUSR7,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT079  PACK      TCODE,ANSO,SEVEN        * category
          MOVE      OBOUSR7,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT080  PACK      VAR,OBOUSR8,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT081  PACK      TCODE,ANSO,EIGHT        * category
          MOVE      OBOUSR8,ACODE           * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT082  PACK      VAR,OTBBRANK,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT083  PACK      VAR,OBAOUTNO,SP30,SP30,SP20    
          GOTO      DOTDT995
.
. Formatted Appointment Date
.
DOTDT084  UNPACK    OBADATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,FORM2
          LOAD      DMONTH,FORM2,DJAN,DFEB,DMAR,DAPR,DMAY,DJUN:
                                 DJUL,DAUG,DSEP,DOCT,DNOV,DDEC
.
          STRIP     DMONTH
.
          LOAD      DDAY,OBADAY,DMON,DTUE,DWED,DTHU,DFRI,DSAT,DSUN
          STRIP     DDAY
.
          PACK      VAR,DDAY,SP1,CDAY,SP1,DMONTH,SP1,CCENT,CYEAR,SP70,SP70
          GOTO      DOTDT995
.
DOTDT085  PACK      VAR,OTHELTYP,SP30,SP30,SP20          * I CAR 37624
          GOTO      DOTDT995
.
DOTDT086  PACK      TCODE,ANSC,ANST         * category   * I CAR 37624
          MOVE      OTHELTYP,ACODE          * code
          CALL      DXPATCOD                * display desc
          GOTO      DOTDT999
.
DOTDT087  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          MOVE      PMCESNAM,PACSNAME       * Formatted Carer Name (for LABELS)
          MOVE      PMCEGNAM,PACGNAME
          MOVE      PMCETITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME
          PACK      VAR,PACFNAME,SP70,SP10
          GOTO      DOTDT995
.
DOTDT088  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCETITL,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT089  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCESNAM,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT090  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEGNAM,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT091  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEADD1,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT092  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEADD2,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT093  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEADD3,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT094  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEADD4,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT095  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEPOST,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT096  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCETELP,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT097  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCETELB,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT098  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCETELM,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT099  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCERELP,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT100  MOVE      "C",CONTTYPE            * Carer
          CALL      XCON0000                * Get extra contact details
          PACK      VAR,PMCEEMAI,SP30,SP30,SP20    
          GOTO      DOTDT995
.
DOTDT101  PACK      VAR,PMVXUDF2,SP30,SP30,SP20
          GOTO      DOTDT995
.
DOTDT102  PACK      VAR,SP70,SP10
          OPEN      PATWC1A1,"patwc1af"          * ACC Number
          MOVE      OBAOUTNO,KEY8
          CALL      RDWCOM1
          IF        OVRCD = 0
            OPEN      PMSWX1A1,"pmswx1af"        * ACC Extension data
            CALL      RDPMWX11
            IF        OVRCD = 0
              MATCH     "3",PMWXCSTA             * Cancelled Claim
              IF        !@EQUAL
                MATCH     SP20,WCCLMNO
                IF        !@EQUAL
                  PACK      VAR,WCCLMNO,SP70,SP10
                ENDIF
              ENDIF
            ELSE
              MATCH     SP20,WCCLMNO
              IF        !@EQUAL
                PACK      VAR,WCCLMNO,SP70,SP10
              ENDIF
            ENDIF
          ENDIF
          GOTO      DOTDT995
.
DOTDT103  PACK      VAR,OCADESC,SP70,SP10  * Clinic Description
          GOTO      DOTDT995
.
DOTDT104  MOVE      OBACOMP,CLAIMCOD
          CALL      CMPH0000
          PACK      VAR,CLMDET1,SP70,SP10
          GOTO      DOTDT995
.
DOTDT105  MOVE      OBACOMP,CLAIMCOD
          CALL      CMPH0000
          PACK      VAR,CLMDET2,SP70,SP10 
          GOTO      DOTDT995
.
DOTDT106  PACK      VAR,OTHECTEL,SP70,SP10  * Clinic Phone Number
          GOTO      DOTDT995
.
DOTDT107  PACK      VAR,OTMAROOM,SP70,SP10  * Clinic Room Number
          GOTO      DOTDT995
.
DOTDT108  PACK      VAR,OTBBPURC,SP70
          GOTO      DOTDT995
.
DOTDT109  PACK      KEY5,CATHP,OTBBPURC
          MOVE      SP70,TDESC
          CALL      RDCODE1
          PACK      VAR,TDESC,SP70
          GOTO      DOTDT995
.
DOTDT110  MOVE      OBADOCT,KEY6
          CALL      DXPATDOC
          GOTO      DOTDT999
.
.>>>>>>>>>>>>>>>>>>>>>>>
. Add New Variables Here
.>>>>>>>>>>>>>>>>>>>>>>>
.
DOTDT995  CALL      DISPITEM
.
DOTDT999  RETURN
+
.******************************************************************************
.         Check if it's using 12 hour time 
.******************************************************************************
CTIM0000  MOVE      SP3,KEY3
          IF        OTCNAP12 = ZERO
            GOTO      CTIM9999
          ENDIF
.
          UNPACK    VSTIM,KEY2,CKYIDEF3                 * Using 12 Hr Time
          REP       " 0",KEY2
          MOVE      KEY2,FORM2
          IF        FORM2 = 12
            MOVE      " PM",KEY3
            GOTO      CTIM9999
          ENDIF
          IF        FORM2 > 12
            SUB      TEN2,FORM2
            MOVE     FORM2,KEY2
            MOVE     " PM",KEY3
          ELSE
            IF        FORM2 = 0
              MOVE      TEN2,KEY2
            ENDIF
            MOVE     " AM",KEY3
          ENDIF
.
CTIM9000  PACK      VSTIM,KEY2,CKYIDEF3,KEY3            * reset the time
CTIM9999  RETURN
+
