.******************************************************************************
.                                 OPRCLIDS
.                       Operating Clinics code D.S.
.
. Description : Display Clinic Codes in description order from the oprcliaf
.               file using the 2nd index.
.
. Requirements: This routine requires OPRCLIFD and OPRCLIIO.INC and KEY36
.
.             OPRCLIDS was programed by Bill Dew on the 20/12/1989
.                        I.B.A. Development Department
.                             D. Jones supervisor
.
.   Modifications :  29/09/93  Whirlpool    SRF 440359
.                              Changed to use doctors name if applicable
.
.******************************************************************************
OPRCLIDS 
.
          DISPLAY    *P1:4,*EF,*P34:4,*V2LON,*ULON,"CLINIC ITEMS"
          MOVE       FIVE,CVERT
          MOVE       ONE,CCOL
.
.>>>>>>>  TRAP       CLIDS900 IF F1
.
          PACK       KEY36,SP30,SP6
          CALL       RSOPCLI2
CLIDS222  
          CALL       RKOPCLI2
          BRANCH     OVRCD,CLIDS990
.
          MATCH      SP6,OPCLDOCT
          GOTO       CLIDS280 IF EQUAL
.
          PACK      KEY6,OPCLDOCT
          CALL      RDDOCT1
          BRANCH    OVRCD,CLIDS280
          MOVE      DTITL,PACTITLE         *
          MOVE      DSNAME,PACSNAME        *
          MOVE      DGNAME,PACGNAME        * Format Doctors name
          MOVE      TWO,PACFRMT            *
          CALL      PACNAME                *
          MOVE      PACFNAME,OPCLDESC
.
          MOVE      ZERO,EXIT
         
CLIDS280  DISPLAY    *PCCOL:CVERT,*V2LON,OPCLCLIN,SP2,*HOFF,OPCLDESC
          ADD        ONE,CVERT
          COMPARE    TWENTY3,CVERT
          GOTO       CLIDS222 IF LESS
          MOVE       FIVE,CVERT
          ADD        "40",CCOL
          COMPARE    "70",CCOL
          GOTO       CLIDS222 IF LESS
.
.>>>>>>>  TRAPCLR   F1
.
.         Check for old or new standards question
.
          BRANCH    CNEWDS,CLIDS200
.
          KEYIN     *P1:24,*EL," (",*V2LON,"E",*HOFF,")xit, (":
                    *V2LON,"F",*HOFF,")irst Screen, (":
                    *V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
          CMATCH    ANSF,ANS
          GOTO      OPRCLIDS IF EQUAL
          CMATCH    ANSE,ANS
          GOTO      CLIDS999 IF EQUAL
          GOTO      CLIDS400
.
.         New standards question
.
CLIDS200  KEYIN     *P1:24,*EL," (",*V2LON,"C",*HOFF,")ontinue, ":
                    "(",*V2LON,"F",*HOFF,")irst Screen, ":
                    "(",*V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
          CMATCH    ANSC,ANS
          GOTO      CLIDS999 IF EQUAL
          CMATCH    ANSF,ANS
          GOTO      OPRCLIDS IF EQUAL
.
.         Clear the screen
.
CLIDS400  MOVE      FIVE,CVERT
          MOVE      ONE,CCOL
          DISPLAY   *P1:CVERT,*EF
.
.>>>>>>>  TRAP      CLIDS900 IF F1
          GOTO      CLIDS222
.
CLIDS900  NORETURN
.>>>>>>>  TRAPCLR   F1
CLIDS990  
          BRANCH    CNEWDS,CLIDS999
          DISPLAY   *P1:24,*EL;
          CALL      HITENTER
CLIDS999  RETURN
