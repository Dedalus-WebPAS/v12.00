.----------------------------------------------------------------------
. Modifications
.
. V10.10.01  30/05/2017  Peter Vela    TSK 0837660
.            Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for Theatre staff details Table
.------------------------------------------------------------------------
CLRSDT00  MOVE      SP70,OPSDT001
          MOVE      SP70,OPSDT002
          MOVE      SP70,OPSDT003
          MOVE      SP70,OPSDT004
          MOVE      SP70,OPSDT005
          MOVE      SP70,OPSDT006
          MOVE      SP70,OPSDT007
          MOVE      SP70,OPSDT008
          MOVE      SP70,OPSDT009
          MOVE      SP70,OPSDT010
          MOVE      SP70,OPSDT011
          MOVE      SP70,OPSDT012
.
CLRSDT99  RETURN
+
.------------------------------------------------------------
. Output Theatre Staff Details Field
.------------------------------------------------------------
OPSI0000  BRANCH    FLDITMNO,OPSI0100,OPSI0200,OPSI0300,OPSI0400,OPSI0500:
                             OPSI0600,OPSI0700,OPSI0800,OPSI0900,OPSI1000:
                             OPSI1100,OPSI1200
.
OPSI0100  WRITE     HTMLFILE;OPSDUNIQ;
          GOTO      OPSI9999
.
OPSI0200  WRITE     HTMLFILE;OPSDTNUM;
          GOTO      OPSI9999
.
OPSI0300  WRITE     HTMLFILE;OPSDSTYP;
          GOTO      OPSI9999
.
OPSI0400  WRITE     HTMLFILE;OPSDSNAM;
          GOTO      OPSI9999
.
OPSI0500  MATCH     SP70,OPSDSDAT
          GOTO      OPSI9999 IF EQUAL
          UNPACK    OPSDSDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPSI9999
.
OPSI0600  WRITE     HTMLFILE;OPSDSTIM;
          GOTO      OPSI9999
.
OPSI0700  MATCH     SP70,OPSDEDAT
          GOTO      OPSI9999 IF EQUAL
          UNPACK    OPSDEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPSI9999
.
OPSI0800  WRITE     HTMLFILE;OPSDETIM;
          GOTO      OPSI9999
.
OPSI0900  WRITE     HTMLFILE;OPSDSLEV;
          GOTO      OPSI9999
.
OPSI1000  WRITE     HTMLFILE;OPSDSTCC;
          GOTO      OPSI9999
.
OPSI1100  WRITE     HTMLFILE;OPSDFICT;
          GOTO      OPSI9999
.
OPSI1200  WRITE     HTMLFILE;OPSDUYN1;
          GOTO      OPSI9999
.
OPSI9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for theatre staff details table
.------------------------------------------------------------
SOPSDT00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SOPSDT01,SOPSDT02,SOPSDT03,SOPSDT04,SOPSDT05:
                       SOPSDT06,SOPSDT07,SOPSDT08,SOPSDT09,SOPSDT10:
                       SOPSDT11,SOPSDT12
.
          MOVE      ONE,EXIT
          GOTO      SOPSDT99
.
SOPSDT01  MOVE      QRYDATA,OPSDT001
          GOTO      SOPSDT99
.
SOPSDT02  MOVE      QRYDATA,OPSDT002
          GOTO      SOPSDT99
.
SOPSDT03  MOVE      QRYDATA,OPSDT003
          RJUSTIFY  OPSDT003
          GOTO      SOPSDT99
.
SOPSDT04  MOVE      QRYDATA,OPSDT004
          GOTO      SOPSDT99
.
SOPSDT05  MATCH     SP70,QRYDATA
          GOTO      SOPSDT99 IF EQUAL
          GOTO      SOPSDT99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPSDT005,CCENT,CYEAR,CMON,CDAY
          GOTO      SOPSDT99
.
SOPSDT06  MOVE      QRYDATA,OPSDT006
          GOTO      SOPSDT99
.
SOPSDT07  MATCH     SP70,QRYDATA
          GOTO      SOPSDT99 IF EQUAL
          GOTO      SOPSDT99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPSDT007,CCENT,CYEAR,CMON,CDAY
          GOTO      SOPSDT99
.
SOPSDT08  MOVE      QRYDATA,OPSDT008
          GOTO      SOPSDT99
.
SOPSDT09  MOVE      QRYDATA,OPSDT009
          GOTO      SOPSDT99
.
SOPSDT10  MOVE      QRYDATA,OPSDT010
          GOTO      SOPSDT99
.
SOPSDT11  MOVE      QRYDATA,OPSDT011
          GOTO      SOPSDT99
.
SOPSDT12  MOVE      QRYDATA,OPSDT012
          GOTO      SOPSDT99
.
SOPSDT99  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to theatre staff details file variables
.------------------------------------------------------------------------
MVOPRSDT  PACK      OPSDUNIQ,OPSDT001,SP70
          PACK      OPSDTNUM,OPSDT002,SP70
          PACK      OPSDSTYP,OPSDT003,SP70
          PACK      OPSDSNAM,OPSDT004,SP70
          PACK      OPSDSDAT,OPSDT005,SP70
          PACK      OPSDSTIM,OPSDT006,SP70
          PACK      OPSDEDAT,OPSDT007,SP70
          PACK      OPSDETIM,OPSDT008,SP70
          PACK      OPSDSLEV,OPSDT009,SP70
          PACK      OPSDSTCC,OPSDT010,SP70
          PACK      OPSDFICT,OPSDT011,SP70      
          PACK      OPSDUYN1,OPSDT012,SP70     
.
          RETURN
+
