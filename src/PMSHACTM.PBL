. *----------------------------------------------------------------------
. * Include Name  :   PMSHACTM.PBL
. *
. * Function      :   CGI variables for PMSHACFD - pmshacaf.dat
. *
. * Includes Needed : PMSHACFD - ABF HAC Baseline Complexity Table
. *                   PMSHACIO - IO for ABF HAC Baseline Complexity Table
. * Modifications :
. *
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for ABF HAC Baseline Complexity Table
.------------------------------------------------------------------------
.
CLRHAC00  MOVE      Z70,PMHAC001
          MOVE      Z70,PMHAC002
          MOVE      Z70,PMHAC003
          MOVE      ZERO,PMHAC004
          MOVE      Z70,PMHAC005
          MOVE      Z70,PMHAC006
          MOVE      Z70,PMHAC007
          MOVE      Z70,PMHAC008
          MOVE      Z70,PMHAC009
          MOVE      Z70,PMHAC010
.
          MOVE      ZERO,PMHAC011
          MOVE      ZERO,PMHAC012
          MOVE      ZERO,PMHAC013
          MOVE      ZERO,PMHAC014
          MOVE      ZERO,PMHAC015
          MOVE      ZERO,PMHAC016
          MOVE      ZERO,PMHAC017
          RETURN
.
.------------------------------------------------------------
. ABF HAC Baseline Complexity Table fields
.-----------------------------------------------------------
PMHA0000  BRANCH    FLDITMNO,PMHA0010,PMHA0020,PMHA0030,PMHA0040,PMHA0050:
                             PMHA0060,PMHA0070,PMHA0080,PMHA0090,PMHA0100
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMHA9999
.
PMHA0010  UNPACK    DIM127,D1,KEY1,DIM127        * Contract ID
          MOVE      KEY1,F1
          BRANCH    F1,PMHA0012
.
          WRITE     HTMLFILE;PMHACNTR;
          GOTO      PMHA9999
.
PMHA0012  PACK      KEY6,PMHACNTR,SP70
          CALL      RDPMCID1
          BRANCH    OVRCD,PMHA9999
.
          WRITE     HTMLFILE;PMCIDESC;
          GOTO      PMHA9999
.
PMHA0020  MOVE      "Ha",CATEGORY
          MOVE      PMHAHACG,CODE
          CALL      CODITM00
          GOTO      PMHA9999 
.
PMHA0030  WRITE     HTMLFILE;PMHAHACF;
          GOTO      PMHA9999
.
PMHA0040  WRITE     HTMLFILE;PMHAHACV;
          GOTO      PMHA9999
.
PMHA0050  MATCH     PMHACDAT,SP70
          GOTO      PMHA9999 IF EQUAL
.
          UNPACK    PMHACDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMHA9999
.
PMHA0060  WRITE     HTMLFILE;PMHACTIM;
          GOTO      PMHA9999
.
PMHA0070  WRITE     HTMLFILE;PMHACUID;
          GOTO      PMHA9999
.
PMHA0080  MATCH     PMHAUDAT,SP70
          GOTO      PMHA9999 IF EQUAL
.
          UNPACK    PMHAUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR; 
          GOTO      PMHA9999
.
PMHA0090  WRITE     HTMLFILE;PMHAUTIM;
          GOTO      PMHA9999
.
PMHA0100  WRITE     HTMLFILE;PMHAUUID;
          GOTO      PMHA9999
.
PMHA9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for ABF HAC Baseline Complexity Table
.------------------------------------------------------------
SPPHA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPHA001,SPPHA002,SPPHA003,SPPHA004,SPPHA005:
                       SPPHA006,SPPHA007,SPPHA008,SPPHA009,SPPHA010:
                       SPPHA011,SPPHA012,SPPHA013,SPPHA014,SPPHA015:
                       SPPHA016,SPPHA017
.
          MOVE      ONE,EXIT
          GOTO      SPPHA999
.
SPPHA001  MOVE      QRYDATA,PMHAC001
          PACK      PMHAC001,PMHAC001,SP70
          GOTO      SPPHA999
.
SPPHA002  MOVE      QRYDATA,PMHAC002
          PACK      PMHAC002,PMHAC002,SP70
          GOTO      SPPHA999
.
SPPHA003  MOVE      QRYDATA,PMHAC003
          PACK      PMHAC003,PMHAC003,SP70
          GOTO      SPPHA999
.
SPPHA004  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC004
          GOTO      SPPHA999
.
SPPHA005  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMHAC005,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPHA999
.
SPPHA006  MOVE      QRYDATA,PMHAC006
          PACK      PMHAC006,PMHAC006,SP70
          GOTO      SPPHA999
.
SPPHA007  MOVE      QRYDATA,PMHAC007
          PACK      PMHAC007,PMHAC007,SP70
          GOTO      SPPHA999
.
SPPHA008  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMHAC008,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPHA999
.
SPPHA009  MOVE      QRYDATA,PMHAC009
          PACK      PMHAC009,PMHAC009,SP70
          GOTO      SPPHA999
.
SPPHA010  MOVE      QRYDATA,PMHAC010
          PACK      PMHAC010,PMHAC010,SP70
          GOTO      SPPHA999
.
SPPHA011  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC011
          GOTO      SPPHA999
.
SPPHA012  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC012
          GOTO      SPPHA999
.
SPPHA013  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC013
          GOTO      SPPHA999
.
SPPHA014  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC014
          GOTO      SPPHA999
.
SPPHA015  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC015
          GOTO      SPPHA999
.
SPPHA016  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC016
          GOTO      SPPHA999
.
SPPHA017  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHAC017
          GOTO      SPPHA999
.
SPPHA999  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to ABF HAC Baseline Complexity Table
.------------------------------------------------------------------------
MVPMHA00  MATCH     PMHAC001,Z70
          IF        !@EQUAL
            MOVE      PMHAC001,PMHACNTR
          ENDIF
.
          MATCH     PMHAC002,Z70
          IF        !@EQUAL
            MOVE      PMHAC002,PMHAHACG
          ENDIF
.
          MATCH     PMHAC003,Z70
          IF        !@EQUAL
            MOVE      PMHAC003,PMHAHACF
          ENDIF
.
          COMPARE   PMHAC004,ZERO
          IF        !@EQUAL
            MOVE      PMHAC004,PMHAHACV
          ENDIF
.
          MATCH     PMHAC005,Z70
          IF        !@EQUAL
            MOVE      PMHAC005,PMHACDAT
          ENDIF
.
          MATCH     PMHAC006,Z70
          IF        !@EQUAL
            MOVE      PMHAC006,PMHACTIM
          ENDIF
.
          MATCH     PMHAC007,Z70
          IF        !@EQUAL
            MOVE      PMHAC007,PMHACUID
          ENDIF
.
          MATCH     PMHAC008,Z70
          IF        !@EQUAL
            MOVE      PMHAC008,PMHAUDAT
          ENDIF
.
          MATCH     PMHAC009,Z70
          IF        !@EQUAL
            MOVE      PMHAC009,PMHAUTIM
          ENDIF
.
          MATCH     PMHAC010,Z70
          IF        !@EQUAL
            MOVE      PMHAC010,PMHAUUID
          ENDIF
.
MVPMHA99  RETURN
+
