. *----------------------------------------------------------------------
. * Include Name  :   OPRARDTM.INC
. *
. * Function      :   CGI variables for OPRARDFD - oprardaf.dat
. *
. * Includes Needed : OPRNURFD - Theatre Nurses file
. *                   OPRNURIO - IO for Theatre Nurses file
. *----------------------------------------------------------------------
.  V11.03.01  13.12.2022  DA Sarkies    TSK 0919497
.             Added tag to display Exit time from theatre complex
.  V11.02.01  12.12.2022  DA Sarkies    TSK 0919497
.             Added tag to display Exit time from theatre complex
.  V11.01.01  19/07/2021  Thanh T.      TSK 0895165
.             Added OPAR1150  - Admitting Nurse Start Time and
.                   OPAR1160 - Admitting Nurse End Time
.  V10.12.01  19/01/2018  Tracey Nguyen TSK 0825792
.             Modified OPAR0030/OPAR0720/OPAR0730/OPAR0750/OPAR0760/OPAR0780/
.             OPAR0790/OPAR1130/OPAR1140
.             to use pmshcpaf if OPCNURSE=1
.  V10.08.01  23/06/2016  Ebon Clements TSK 0312728
.             Changed OPARD030/OPARUT02 from a time to a date
.  V9.11.01   19/01/2009  Ebon Clements CAR 169339
.             Added OPARUYN1 and OPARUYN2
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for Theatre Operating (Arrival & Recovery) Details
.------------------------------------------------------------------------
.
CPOPAR00  MOVE      Z70,OPARD001
          MOVE      Z70,OPARD002
          MOVE      Z70,OPARD003
          MOVE      Z70,OPARD004
          MOVE      Z70,OPARD005
          MOVE      Z70,OPARD006
          MOVE      Z70,OPARD007
          MOVE      Z70,OPARD008
          MOVE      Z70,OPARD009
          MOVE      Z70,OPARD010
          MOVE      Z70,OPARD011
          MOVE      Z70,OPARD012
          MOVE      Z70,OPARD013
          MOVE      Z70,OPARD014
          MOVE      Z70,OPARD015
          MOVE      Z70,OPARD016
          MOVE      Z70,OPARD017
          MOVE      Z70,OPARD018
          MOVE      Z70,OPARD019
          MOVE      Z70,OPARD020
          MOVE      Z70,OPARD021
          MOVE      Z70,OPARD022
          MOVE      Z70,OPARD023
          MOVE      Z70,OPARD024
          MOVE      Z70,OPARD025
          MOVE      Z70,OPARD026
          MOVE      Z70,OPARD027
          MOVE      Z70,OPARD028
          MOVE      Z70,OPARD029
          MOVE      Z70,OPARD030
          MOVE      Z70,OPARD031
          MOVE      Z70,OPARD032
          MOVE      Z70,OPARD033
          MOVE      ZERO,OPARD034
          MOVE      ZERO,OPARD035
          MOVE      ZERO,OPARD036
          MOVE      ZERO,OPARD037
          MOVE      ZERO,OPARD038
          MOVE      Z70,OPARD039
          MOVE      Z70,OPARD040
          MOVE      Z70,OPARD041
          MOVE      Z70,OPARD042
          MOVE      Z70,OPARD043
          MOVE      Z70,OPARD044
          MOVE      Z70,OPARD045
          MOVE      Z70,OPARD046
          MOVE      Z70,OPARD047
          MOVE      Z70,OPARD048
          MOVE      Z70,OPARD049
          MOVE      Z70,OPARD050
          MOVE      Z70,OPARD051
          MOVE      Z70,OPARD052
          MOVE      Z70,OPARD053
          MOVE      Z70,OPARD054
          MOVE      Z70,OPARD055
          MOVE      Z70,OPARD056
          MOVE      Z70,OPARD057
          MOVE      Z70,OPARD058
          MOVE      Z70,OPARD059
          MOVE      Z70,OPARD060
          MOVE      Z70,OPARD061
          MOVE      Z70,OPARD062
          MOVE      Z70,OPARD063
          MOVE      Z70,OPARD064
          MOVE      ZERO,OPARD065
          MOVE      ZERO,OPARD066
          MOVE      ZERO,OPARD067
          MOVE      ZERO,OPARD068
          MOVE      ZERO,OPARD069
          MOVE      Z70,OPARD070
          MOVE      Z70,OPARD071
          MOVE      Z70,OPARD072
          MOVE      Z70,OPARD073
          MOVE      Z70,OPARD074
          MOVE      Z70,OPARD075
          MOVE      Z70,OPARD076
          MOVE      Z70,OPARD077
          MOVE      Z70,OPARD078
          MOVE      Z70,OPARD079
          MOVE      Z70,OPARD080
          MOVE      Z70,OPARD081
          MOVE      Z70,OPARD082
          MOVE      Z70,OPARD083
          MOVE      Z70,OPARD084
          MOVE      Z70,OPARD085
          MOVE      Z70,OPARD086
          MOVE      Z70,OPARD087
          MOVE      Z70,OPARD088
          MOVE      Z70,OPARD089
          MOVE      Z70,OPARD090
          MOVE      Z70,OPARD091
          MOVE      Z70,OPARD092
          MOVE      Z70,OPARD093
          MOVE      Z70,OPARD094
          MOVE      Z70,OPARD095
          MOVE      Z70,OPARD096
          MOVE      Z70,OPARD097
          MOVE      Z70,OPARD098
          MOVE      Z70,OPARD101
          MOVE      Z70,OPARD102
          MOVE      Z70,OPARD103
          MOVE      Z70,OPARD104
          MOVE      Z70,OPARD105
          MOVE      Z70,OPARD106
          MOVE      Z70,OPARD107
          MOVE      ZERO,OPARD108
          MOVE      ZERO,OPARD109
          MOVE      ZERO,OPARD110
          MOVE      ZERO,OPARD111
          MOVE      ZERO,OPARD112
          MOVE      Z70,OPARD113
          MOVE      Z70,OPARD114
          MOVE      Z70,OPARD115
          MOVE      Z70,OPARD116
.
CPOPAR99  RETURN 
.------------------------------------------------------------
. Add Operating Arrival & Recovery Details file
.------------------------------------------------------------
OPAR0000  BRANCH    FLDITMNO,OPAR0010,OPAR0020,OPAR0030,OPAR0040,OPAR0050:
                             OPAR0060,OPAR0070,OPAR0080,OPAR0090,OPAR0100:
                             OPAR0110,OPAR0120,OPAR0130,OPAR0140,OPAR0150:
                             OPAR0160,OPAR0170,OPAR0180,OPAR0190,OPAR0200:
                             OPAR0210,OPAR0220,OPAR0230,OPAR0240,OPAR0250:
                             OPAR0260,OPAR0270,OPAR0280,OPAR0290,OPAR0300:
                             OPAR0310,OPAR0320,OPAR0330,OPAR0340,OPAR0350:
                             OPAR0360,OPAR0370,OPAR0380,OPAR0390,OPAR0400:
                             OPAR0410,OPAR0420,OPAR0430,OPAR0440,OPAR0450:
                             OPAR0460,OPAR0470,OPAR0480,OPAR0490,OPAR0500:
                             OPAR0510,OPAR0520,OPAR0530,OPAR0540,OPAR0550:
                             OPAR0560,OPAR0570,OPAR0580,OPAR0590,OPAR0600:
                             OPAR0610,OPAR0620,OPAR0630,OPAR0640,OPAR0650:
                             OPAR0660,OPAR0670,OPAR0680,OPAR0690,OPAR0700:
                             OPAR0710,OPAR0720,OPAR0730,OPAR0740,OPAR0750:
                             OPAR0760,OPAR0770,OPAR0780,OPAR0790,OPAR0800:
                             OPAR0810,OPAR0820,OPAR0830,OPAR0840,OPAR0850:
                             OPAR0860,OPAR0870,OPAR0880,OPAR0890,OPAR0900:
                             OPAR0910,OPAR0920,OPAR0930,OPAR0940,OPAR0950:
                             OPAR0960,OPAR0970,OPAR0980,OPAR0990
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OPAR9999
.
OPAR0010  WRITE     HTMLFILE;OPARUNID;
          GOTO      OPAR9999
.
OPAR0020  WRITE     HTMLFILE;OPARATIM;
          GOTO      OPAR9999
.
OPAR0030  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0031
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARANUR,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARANUR
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0031  WRITE     HTMLFILE;OPARANUR;
          GOTO      OPAR9999
.
OPAR0040  MOVE      "Os",CATEGORY             * Reason Patient Late 
          PACK      CODE,OPARRLAT,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0050  MOVE      NO,YESNO
          MATCH     "1",OPARPCLC
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0060  MOVE      NO,YESNO
          MATCH     "1",OPARCSFS
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0070  MOVE      NO,YESNO
          MATCH     "1",OPARMDRE
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0080  MOVE      NO,YESNO
          MATCH     "1",OPARXRAY
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0090  MOVE      NO,YESNO
          MATCH     "1",OPARBLEM
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0100  MOVE      NO,YESNO
          MATCH     "1",OPARMUPJ
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0110  MOVE      NO,YESNO
          MATCH     "1",OPARPMED
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0120  MOVE      NO,YESNO
          MATCH     "1",OPARALCK
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0130  WRITE     HTMLFILE;OPARPROT;
          GOTO      OPAR9999
.
OPAR0140  MOVE      "oa",CATEGORY             * User Defined Code 1    
          PACK      CODE,OPARUC01,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0150  MOVE      "ob",CATEGORY             * User Defined Code 2    
          PACK      CODE,OPARUC02,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0160  MOVE      "oc",CATEGORY             * User Defined Code 3    
          PACK      CODE,OPARUC03,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0170  MOVE      "od",CATEGORY             * User Defined Code 4    
          PACK      CODE,OPARUC04,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0180  MOVE      "oe",CATEGORY             * User Defined Code 5    
          PACK      CODE,OPARUC05,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0190  MOVE      "of",CATEGORY             * User Defined Code 6    
          PACK      CODE,OPARUC06,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0200  MOVE      "og",CATEGORY             * User Defined Code 7    
          PACK      CODE,OPARUC07,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0210  MOVE      "oh",CATEGORY             * User Defined Code 8    
          PACK      CODE,OPARUC08,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0220  MOVE      "oi",CATEGORY             * User Defined Code 9    
          PACK      CODE,OPARUC09,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0230  MOVE      "oj",CATEGORY             * User Defined Code 10   
          PACK      CODE,OPARUC10,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0240  MOVE      NO,YESNO
          MATCH     "1",OPARUY01
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0250  MOVE      NO,YESNO
          MATCH     "1",OPARUY02
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0260  MOVE      NO,YESNO
          MATCH     "1",OPARUY03
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0270  MOVE      NO,YESNO
          MATCH     "1",OPARUY04
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0280  MOVE      NO,YESNO
          MATCH     "1",OPARUY05
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0290  WRITE     HTMLFILE;OPARUT01;
          GOTO      OPAR9999
.
OPAR0300  MATCH     OPARUT02,SP70
          GOTO      OPAR9999 IF EQUAL
.
          UNPACK    OPARUT02,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPAR9999
.
OPAR0310  WRITE     HTMLFILE;OPARUT03;
          GOTO      OPAR9999
.
OPAR0320  WRITE     HTMLFILE;OPARUT04;
          GOTO      OPAR9999
.
OPAR0330  WRITE     HTMLFILE;OPARUT05;
          GOTO      OPAR9999
.
OPAR0340  WRITE     HTMLFILE;OPARUF01;
          GOTO      OPAR9999
.
OPAR0350  WRITE     HTMLFILE;OPARUF02;
          GOTO      OPAR9999
.
OPAR0360  WRITE     HTMLFILE;OPARUF03;
          GOTO      OPAR9999
.
OPAR0370  WRITE     HTMLFILE;OPARUF04;
          GOTO      OPAR9999
.
OPAR0380  WRITE     HTMLFILE;OPARUF05;
          GOTO      OPAR9999
.
OPAR0390  WRITE     HTMLFILE;OPARTCAL;
          GOTO      OPAR9999
.
OPAR0400  MATCH     SP70,OPARUIAR
          GOTO      OPAR9999 IF EQUAL
          PACK      KEY10,OPARUIAR
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      OPARUIAR,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      OPAR9999
.
OPAR0410  WRITE     HTMLFILE;OPARANAP;
          GOTO      OPAR9999
.
OPAR0420  WRITE     HTMLFILE;OPARANAS;
          GOTO      OPAR9999
.
OPAR0430  WRITE     HTMLFILE;OPARANAE;
          GOTO      OPAR9999
.
OPAR0440  MOVE      "Ot",CATEGORY             * Type of Intubation  
          PACK      CODE,OPARITYP,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0450  MOVE      "ok",CATEGORY             * User Defined Code 11   
          PACK      CODE,OPARUC11,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0460  MOVE      "ol",CATEGORY             * User Defined Code 12   
          PACK      CODE,OPARUC12,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0470  MOVE      "om",CATEGORY             * User Defined Code 13   
          PACK      CODE,OPARUC13,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0480  MOVE      "on",CATEGORY             * User Defined Code 14   
          PACK      CODE,OPARUC14,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0490  MOVE      "oo",CATEGORY             * User Defined Code 15   
          PACK      CODE,OPARUC15,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0500  MOVE      "op",CATEGORY             * User Defined Code 16   
          PACK      CODE,OPARUC16,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0510  MOVE      "oq",CATEGORY             * User Defined Code 17   
          PACK      CODE,OPARUC17,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0520  MOVE      "or",CATEGORY             * User Defined Code 18   
          PACK      CODE,OPARUC18,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0530  MOVE      "os",CATEGORY             * User Defined Code 19   
          PACK      CODE,OPARUC19,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0540  MOVE      "ot",CATEGORY             * User Defined Code 20   
          PACK      CODE,OPARUC20,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0550  MOVE      NO,YESNO
          MATCH     "1",OPARUY06
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0560  MOVE      NO,YESNO
          MATCH     "1",OPARUY07
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0570  MOVE      NO,YESNO
          MATCH     "1",OPARUY08
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0580  MOVE      NO,YESNO
          MATCH     "1",OPARUY09
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0590  MOVE      NO,YESNO
          MATCH     "1",OPARUY10
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0600  WRITE     HTMLFILE;OPARUT06;
          GOTO      OPAR9999
.
OPAR0610  WRITE     HTMLFILE;OPARUT07;
          GOTO      OPAR9999
.
OPAR0620  WRITE     HTMLFILE;OPARUT08;
          GOTO      OPAR9999
.
OPAR0630  WRITE     HTMLFILE;OPARUT09;
          GOTO      OPAR9999
.
OPAR0640  WRITE     HTMLFILE;OPARUT10;
          GOTO      OPAR9999
.
OPAR0650  WRITE     HTMLFILE;OPARUF06;
          GOTO      OPAR9999
.
OPAR0660  WRITE     HTMLFILE;OPARUF07;
          GOTO      OPAR9999
.
OPAR0670  WRITE     HTMLFILE;OPARUF08;
          GOTO      OPAR9999
.
OPAR0680  WRITE     HTMLFILE;OPARUF09;
          GOTO      OPAR9999
.
OPAR0690  WRITE     HTMLFILE;OPARUF10;
          GOTO      OPAR9999
.
OPAR0700  MATCH     SP70,OPARUANA
          GOTO      OPAR9999 IF EQUAL
          PACK      KEY10,OPARUANA
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      OPARUANA,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      OPAR9999
.
OPAR0710  WRITE     HTMLFILE;OPARTIRF;
          GOTO      OPAR9999
.
OPAR0720  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0721
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARNUF1,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARNUF1
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0721  WRITE     HTMLFILE;OPARNUF1;
          GOTO      OPAR9999
.
OPAR0730  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0731
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARNUF2,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARNUF2
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0731  WRITE     HTMLFILE;OPARNUF2;
          GOTO      OPAR9999
.
OPAR0740  WRITE     HTMLFILE;OPARTIRB;
          GOTO      OPAR9999
.
OPAR0750  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0751
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARNUB1,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARNUB1
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0751  WRITE     HTMLFILE;OPARNUB1;
          GOTO      OPAR9999
.
OPAR0760  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0761
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARNUB2,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARNUB2
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0761  WRITE     HTMLFILE;OPARNUB2;
          GOTO      OPAR9999
.
OPAR0770  WRITE     HTMLFILE;OPARTIRD;
          GOTO      OPAR9999
.
OPAR0780  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0781
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARNUD1,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARNUD1
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0781  WRITE     HTMLFILE;OPARNUD1;
          GOTO      OPAR9999
.
OPAR0790  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR0791
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARNUD2,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARNUD2
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR0791  WRITE     HTMLFILE;OPARNUD2;
          GOTO      OPAR9999
.
OPAR0800  WRITE     HTMLFILE;OPARTETC;
          GOTO      OPAR9999
.
OPAR0810  MATCH     SP70,OPARUREC
          GOTO      OPAR9999 IF EQUAL
          PACK      KEY10,OPARUREC
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      OPARUREC,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      OPAR9999
.
OPAR0820  WRITE     HTMLFILE;OPARTEXP;
          GOTO      OPAR9999
.
OPAR0830  WRITE     HTMLFILE;OPARTICU;
          GOTO      OPAR9999
.
OPAR0840  MOVE      "Ou",CATEGORY             * Recovery Delay Code
          PACK      CODE,OPARRDCD,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0850  WRITE     HTMLFILE;OPARTIDP;
          GOTO      OPAR9999
.
OPAR0860  MOVE      "ou",CATEGORY             * User Defined Code 21   
          PACK      CODE,OPARUC21,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0870  MOVE      "ov",CATEGORY             * User Defined Code 22   
          PACK      CODE,OPARUC22,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0880  MOVE      "ow",CATEGORY             * User Defined Code 23   
          PACK      CODE,OPARUC23,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0890  MOVE      "ox",CATEGORY             * User Defined Code 24   
          PACK      CODE,OPARUC24,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0900  MOVE      "oy",CATEGORY             * User Defined Code 25   
          PACK      CODE,OPARUC25,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0910  MOVE      "oz",CATEGORY             * User Defined Code 26   
          PACK      CODE,OPARUC26,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0920  MOVE      "oA",CATEGORY             * User Defined Code 27   
          PACK      CODE,OPARUC27,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0930  MOVE      "oB",CATEGORY             * User Defined Code 28   
          PACK      CODE,OPARUC28,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0940  MOVE      "oC",CATEGORY             * User Defined Code 29   
          PACK      CODE,OPARUC29,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0950  MOVE      "oD",CATEGORY             * User Defined Code 30   
          PACK      CODE,OPARUC30,SP70
          CALL      CODITM00
          GOTO      OPAR9999
.
OPAR0960  MOVE      NO,YESNO
          MATCH     "1",OPARUY11
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0970  MOVE      NO,YESNO
          MATCH     "1",OPARUY12
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR0980  MOVE      NO,YESNO
          MATCH     "1",OPARUY13 
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
.         If the field item no is 99 then the next numbers after the dot will
.         be the extension field number
.         eg: %PATWEB89.04.a99.xxx.y
.         xxx will be the extension field number and 'y' will be the indicator
.         for displaying selection, code or description
.
OPAR0990  UNPACK    DIM127,DIM1,KEY3,DIM127
          MOVE      KEY3,FORM3
          BRANCH    FORM3,OPAR1010,OPAR1020,OPAR1030,OPAR1040,OPAR1050:
                          OPAR1060,OPAR1070,OPAR1080,OPAR1090,OPAR1100:
                          OPAR1110,OPAR1120,OPAR1130,OPAR1140,OPAR1150:
                          OPAR1160,OPAR1170
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OPAR9999
.
OPAR1010  MOVE      NO,YESNO
          MATCH     "1",OPARUY14
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR1020  MOVE      NO,YESNO
          MATCH     "1",OPARUY15 
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OPAR9999
.
OPAR1030  WRITE     HTMLFILE;OPARUT11;
          GOTO      OPAR9999
.
OPAR1040  WRITE     HTMLFILE;OPARUT12;
          GOTO      OPAR9999
.
OPAR1050  WRITE     HTMLFILE;OPARUT13;
          GOTO      OPAR9999
.
OPAR1060  WRITE     HTMLFILE;OPARUT14;
          GOTO      OPAR9999
.
OPAR1070  WRITE     HTMLFILE;OPARUT15;
          GOTO      OPAR9999
.
OPAR1080  WRITE     HTMLFILE;OPARUF11;
          GOTO      OPAR9999
.
OPAR1090  WRITE     HTMLFILE;OPARUF12;
          GOTO      OPAR9999
.
OPAR1100  WRITE     HTMLFILE;OPARUF13;
          GOTO      OPAR9999
.
OPAR1110  WRITE     HTMLFILE;OPARUF14;
          GOTO      OPAR9999
.
OPAR1120  WRITE     HTMLFILE;OPARUF15;
          GOTO      OPAR9999
.
OPAR1130  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR1131
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARUYN1,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARUYN1
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR1131  WRITE     HTMLFILE;OPARUYN1;
          GOTO      OPAR9999
.
OPAR1140  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPAR1141
.
.         CONTROLF.OPCNURSE - Use oprnuraf/pmshcpaf for OT Nurse?
          READ      CONTROLF,HUND13;*51,OPCNURSE
          MATCH     "1",OPCNURSE
          IF        @EQUAL
            PACK      KEY10,OPARUYN2,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,OPAR9999
            PACK      FMTTITLE,SP20
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
            WRITE     HTMLFILE;DOCFNAME;
            GOTO      OPAR9999
          ENDIF
.
          PACK      KEY6,OPARUYN2
          CALL      RDOPNUR1
          BRANCH    OVRCD,OPAR9999
          PACK      FMTTITLE,SP20
          MOVE      OPNRGNAM,FMTGNAME
          MOVE      OPNRSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OPAR9999
.
OPAR1141  WRITE     HTMLFILE;OPARUYN2;
          GOTO      OPAR9999
.
OPAR1150  WRITE     HTMLFILE;OPARADST;
          GOTO      OPAR9999
.
OPAR1160  WRITE     HTMLFILE;OPARADET;
          GOTO      OPAR9999
.
OPAR1170  WRITE     HTMLFILE;EXTIM001;
          GOTO      OPAR9999
.
OPAR9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Operating Arrival & Recovery Details
.------------------------------------------------------------
SPOAR000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPOAR001,SPOAR002,SPOAR003,SPOAR004,SPOAR005:
                       SPOAR006,SPOAR007,SPOAR008,SPOAR009,SPOAR010:
                       SPOAR011,SPOAR012,SPOAR013,SPOAR014,SPOAR015:
                       SPOAR016,SPOAR017,SPOAR018,SPOAR019,SPOAR020:
                       SPOAR021,SPOAR022,SPOAR023,SPOAR024,SPOAR025:
                       SPOAR026,SPOAR027,SPOAR028,SPOAR029,SPOAR030:
                       SPOAR031,SPOAR032,SPOAR033,SPOAR034,SPOAR035:
                       SPOAR036,SPOAR037,SPOAR038,SPOAR039,SPOAR040:
                       SPOAR041,SPOAR042,SPOAR043,SPOAR044,SPOAR045:
                       SPOAR046,SPOAR047,SPOAR048,SPOAR049,SPOAR050:
                       SPOAR051,SPOAR052,SPOAR053,SPOAR054,SPOAR055:
                       SPOAR056,SPOAR057,SPOAR058,SPOAR059,SPOAR060:
                       SPOAR061,SPOAR062,SPOAR063,SPOAR064,SPOAR065:
                       SPOAR066,SPOAR067,SPOAR068,SPOAR069,SPOAR070:
                       SPOAR071,SPOAR072,SPOAR073,SPOAR074,SPOAR075:
                       SPOAR076,SPOAR077,SPOAR078,SPOAR079,SPOAR080:
                       SPOAR081,SPOAR082,SPOAR083,SPOAR084,SPOAR085:
                       SPOAR086,SPOAR087,SPOAR088,SPOAR089,SPOAR090:
                       SPOAR091,SPOAR092,SPOAR093,SPOAR094,SPOAR095:
                       SPOAR096,SPOAR097,SPOAR098,SPOAR999,SPOAR999:
                       SPOAR101,SPOAR102,SPOAR103,SPOAR104,SPOAR105:
                       SPOAR106,SPOAR107,SPOAR108,SPOAR109,SPOAR110:
                       SPOAR111,SPOAR112,SPOAR113,SPOAR114,SPOAR115:
                       SPOAR116
.
          MOVE      ONE,EXIT
          GOTO      SPOAR999
.
SPOAR001  SQUEEZE   QRYDATA 
          MOVE      QRYDATA,OPARD001
          PACK      OPARD001,OPARD001,SP70
          GOTO      SPOAR999
.
SPOAR002  MOVE      QRYDATA,OPARD002
          GOTO      SPOAR999
.
SPOAR003  MOVE      QRYDATA,OPARD003
          GOTO      SPOAR999
.
SPOAR004  MOVE      QRYDATA,OPARD004
          GOTO      SPOAR999
.
SPOAR005  MOVE      QRYDATA,OPARD005
          GOTO      SPOAR999
.
SPOAR006  MOVE      QRYDATA,OPARD006
          GOTO      SPOAR999
.
SPOAR007  MOVE      QRYDATA,OPARD007
          GOTO      SPOAR999
.
SPOAR008  MOVE      QRYDATA,OPARD008
          GOTO      SPOAR999
.
SPOAR009  MOVE      QRYDATA,OPARD009
          GOTO      SPOAR999
.
SPOAR010  MOVE      QRYDATA,OPARD010
          GOTO      SPOAR999
.
SPOAR011  MOVE      QRYDATA,OPARD011
          GOTO      SPOAR999
.
SPOAR012  MOVE      QRYDATA,OPARD012
          GOTO      SPOAR999
.
SPOAR013  MOVE      QRYDATA,OPARD013
          GOTO      SPOAR999
.
SPOAR014  MOVE      QRYDATA,OPARD014
          GOTO      SPOAR999
.
SPOAR015  MOVE      QRYDATA,OPARD015
          GOTO      SPOAR999
.
SPOAR016  MOVE      QRYDATA,OPARD016
          GOTO      SPOAR999
.
SPOAR017  MOVE      QRYDATA,OPARD017
          GOTO      SPOAR999
.
SPOAR018  MOVE      QRYDATA,OPARD018
          GOTO      SPOAR999
.
SPOAR019  MOVE      QRYDATA,OPARD019
          GOTO      SPOAR999
.
SPOAR020  MOVE      QRYDATA,OPARD020
          GOTO      SPOAR999

SPOAR021  MOVE      QRYDATA,OPARD021
          GOTO      SPOAR999
.
SPOAR022  MOVE      QRYDATA,OPARD022
          GOTO      SPOAR999
.
SPOAR023  MOVE      QRYDATA,OPARD023
          GOTO      SPOAR999
.
SPOAR024  MOVE      QRYDATA,OPARD024
          GOTO      SPOAR999
.
SPOAR025  MOVE      QRYDATA,OPARD025
          GOTO      SPOAR999
.
SPOAR026  MOVE      QRYDATA,OPARD026
          GOTO      SPOAR999
.
SPOAR027  MOVE      QRYDATA,OPARD027
          GOTO      SPOAR999
.
SPOAR028  MOVE      QRYDATA,OPARD028
          GOTO      SPOAR999
.
SPOAR029  MOVE      QRYDATA,OPARD029
          GOTO      SPOAR999
.
SPOAR030  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPARD030,CCENT,CYEAR,CMON,CDAY
          GOTO      SPOAR999
.
SPOAR031  MOVE      QRYDATA,OPARD031
          GOTO      SPOAR999
.
SPOAR032  MOVE      QRYDATA,OPARD032
          GOTO      SPOAR999
.
SPOAR033  MOVE      QRYDATA,OPARD033
          GOTO      SPOAR999
.
SPOAR034  MOVE      QRYDATA,OPARD034
          GOTO      SPOAR999
.
SPOAR035  MOVE      QRYDATA,OPARD035
          GOTO      SPOAR999
.
SPOAR036  MOVE      QRYDATA,OPARD036
          GOTO      SPOAR999
.
SPOAR037  MOVE      QRYDATA,OPARD037
          GOTO      SPOAR999
.
SPOAR038  MOVE      QRYDATA,OPARD038
          GOTO      SPOAR999
.
SPOAR039  MOVE      QRYDATA,OPARD039
          GOTO      SPOAR999
.
SPOAR040  MOVE      QRYDATA,OPARD040
          GOTO      SPOAR999
.
SPOAR041  MOVE      QRYDATA,OPARD041
          GOTO      SPOAR999
.
SPOAR042  MOVE      QRYDATA,OPARD042
          GOTO      SPOAR999
.
SPOAR043  MOVE      QRYDATA,OPARD043
          GOTO      SPOAR999
.
SPOAR044  MOVE      QRYDATA,OPARD044
          GOTO      SPOAR999
.
SPOAR045  MOVE      QRYDATA,OPARD045
          GOTO      SPOAR999
.
SPOAR046  MOVE      QRYDATA,OPARD046
          GOTO      SPOAR999
.
SPOAR047  MOVE      QRYDATA,OPARD047
          GOTO      SPOAR999
.
SPOAR048  MOVE      QRYDATA,OPARD048
          GOTO      SPOAR999
.
SPOAR049  MOVE      QRYDATA,OPARD049
          GOTO      SPOAR999
.
SPOAR050  MOVE      QRYDATA,OPARD050
          GOTO      SPOAR999
.
SPOAR051  MOVE      QRYDATA,OPARD051
          GOTO      SPOAR999
.
SPOAR052  MOVE      QRYDATA,OPARD052
          GOTO      SPOAR999
.
SPOAR053  MOVE      QRYDATA,OPARD053
          GOTO      SPOAR999
.
SPOAR054  MOVE      QRYDATA,OPARD054
          GOTO      SPOAR999
.
SPOAR055  MOVE      QRYDATA,OPARD055
          GOTO      SPOAR999
.
SPOAR056  MOVE      QRYDATA,OPARD056
          GOTO      SPOAR999
.
SPOAR057  MOVE      QRYDATA,OPARD057
          GOTO      SPOAR999
.
SPOAR058  MOVE      QRYDATA,OPARD058
          GOTO      SPOAR999
.
SPOAR059  MOVE      QRYDATA,OPARD059
          GOTO      SPOAR999
.
SPOAR060  MOVE      QRYDATA,OPARD060
          GOTO      SPOAR999
.
SPOAR061  MOVE      QRYDATA,OPARD061
          GOTO      SPOAR999
.
SPOAR062  MOVE      QRYDATA,OPARD062
          GOTO      SPOAR999
.
SPOAR063  MOVE      QRYDATA,OPARD063
          GOTO      SPOAR999
.
SPOAR064  MOVE      QRYDATA,OPARD064
          GOTO      SPOAR999
.
SPOAR065  MOVE      QRYDATA,OPARD065
          GOTO      SPOAR999
.
SPOAR066  MOVE      QRYDATA,OPARD066
          GOTO      SPOAR999
.
SPOAR067  MOVE      QRYDATA,OPARD067
          GOTO      SPOAR999
.
SPOAR068  MOVE      QRYDATA,OPARD068
          GOTO      SPOAR999
.
SPOAR069  MOVE      QRYDATA,OPARD069
          GOTO      SPOAR999
.
SPOAR070  MOVE      QRYDATA,OPARD070
          GOTO      SPOAR999
.
SPOAR071  MOVE      QRYDATA,OPARD071
          GOTO      SPOAR999
.
SPOAR072  MOVE      QRYDATA,OPARD072
          GOTO      SPOAR999
.
SPOAR073  MOVE      QRYDATA,OPARD073
          GOTO      SPOAR999
.
SPOAR074  MOVE      QRYDATA,OPARD074
          GOTO      SPOAR999
.
SPOAR075  MOVE      QRYDATA,OPARD075
          GOTO      SPOAR999
.
SPOAR076  MOVE      QRYDATA,OPARD076
          GOTO      SPOAR999
.
SPOAR077  MOVE      QRYDATA,OPARD077
          GOTO      SPOAR999
.
SPOAR078  MOVE      QRYDATA,OPARD078
          GOTO      SPOAR999
.
SPOAR079  MOVE      QRYDATA,OPARD079
          GOTO      SPOAR999
.
SPOAR080  MOVE      QRYDATA,OPARD080
          GOTO      SPOAR999
.
SPOAR081  MOVE      QRYDATA,OPARD081
          GOTO      SPOAR999
.
SPOAR082  MOVE      QRYDATA,OPARD082
          GOTO      SPOAR999
.
SPOAR083  MOVE      QRYDATA,OPARD083
          GOTO      SPOAR999
.
SPOAR084  MOVE      QRYDATA,OPARD084
          GOTO      SPOAR999
.
SPOAR085  MOVE      QRYDATA,OPARD085
          GOTO      SPOAR999
.
SPOAR086  MOVE      QRYDATA,OPARD086
          GOTO      SPOAR999
.
SPOAR087  MOVE      QRYDATA,OPARD087
          GOTO      SPOAR999
.
SPOAR088  MOVE      QRYDATA,OPARD088
          GOTO      SPOAR999
.
SPOAR089  MOVE      QRYDATA,OPARD089
          GOTO      SPOAR999
.
SPOAR090  MOVE      QRYDATA,OPARD090
          GOTO      SPOAR999
.
SPOAR091  MOVE      QRYDATA,OPARD091
          GOTO      SPOAR999
.
SPOAR092  MOVE      QRYDATA,OPARD092
          GOTO      SPOAR999
.
SPOAR093  MOVE      QRYDATA,OPARD093
          GOTO      SPOAR999
.
SPOAR094  MOVE      QRYDATA,OPARD094
          GOTO      SPOAR999
.
SPOAR095  MOVE      QRYDATA,OPARD095
          GOTO      SPOAR999
.
SPOAR096  MOVE      QRYDATA,OPARD096
          GOTO      SPOAR999
.
SPOAR097  MOVE      QRYDATA,OPARD097
          GOTO      SPOAR999
.
SPOAR098  MOVE      QRYDATA,OPARD098
          GOTO      SPOAR999
.
SPOAR101  MOVE      QRYDATA,OPARD101
          GOTO      SPOAR999
.
SPOAR102  MOVE      QRYDATA,OPARD102
          GOTO      SPOAR999
.
SPOAR103  MOVE      QRYDATA,OPARD103
          GOTO      SPOAR999
.
SPOAR104  MOVE      QRYDATA,OPARD104
          GOTO      SPOAR999
.
SPOAR105  MOVE      QRYDATA,OPARD105
          GOTO      SPOAR999
.
SPOAR106  MOVE      QRYDATA,OPARD106
          GOTO      SPOAR999
.
SPOAR107  MOVE      QRYDATA,OPARD107
          GOTO      SPOAR999
.
SPOAR108  MOVE      QRYDATA,OPARD108
          GOTO      SPOAR999
.
SPOAR109  MOVE      QRYDATA,OPARD109
          GOTO      SPOAR999
.
SPOAR110  MOVE      QRYDATA,OPARD110
          GOTO      SPOAR999
.
SPOAR111  MOVE      QRYDATA,OPARD111
          GOTO      SPOAR999
.
SPOAR112  MOVE      QRYDATA,OPARD112
          GOTO      SPOAR999
.
SPOAR113  MOVE      QRYDATA,OPARD113
          GOTO      SPOAR999
.
SPOAR114  MOVE      QRYDATA,OPARD114
          GOTO      SPOAR999
.
SPOAR115  MOVE      QRYDATA,OPARD115
          GOTO      SPOAR999
.
SPOAR116  MOVE      QRYDATA,OPARD116
          GOTO      SPOAR999
.
SPOAR999  RETURN
.------------------------------------------------------------
.  Update Operating Arrival & Recovery Details file
.------------------------------------------------------------
MVOPAR00  MATCH     OPARD001,Z70
          IF        !@EQUAL
            MOVE      OPARD001,OPARUNID
          ENDIF
.
          MATCH     OPARD002,Z70
          IF        !@EQUAL
            MOVE      OPARD002,OPARATIM
          ENDIF
.
          MATCH     OPARD003,Z70
          IF        !@EQUAL
            MOVE      OPARD003,OPARANUR
          ENDIF
.
          MATCH     OPARD004,Z70
          IF        !@EQUAL
            MOVE      OPARD004,OPARRLAT
          ENDIF
.
          MATCH     OPARD005,Z70
          IF        !@EQUAL
            MOVE      OPARD005,OPARPCLC
          ENDIF
.
          MATCH     OPARD006,Z70
          IF        !@EQUAL
            MOVE      OPARD006,OPARCSFS
          ENDIF
.
          MATCH     OPARD007,Z70
          IF        !@EQUAL
            MOVE      OPARD007,OPARMDRE
          ENDIF
.
          MATCH     OPARD008,Z70
          IF        !@EQUAL
            MOVE      OPARD008,OPARXRAY
          ENDIF
.
          MATCH     OPARD009,Z70
          IF        !@EQUAL
            MOVE      OPARD009,OPARBLEM
          ENDIF
.
          MATCH     OPARD010,Z70
          IF        !@EQUAL
            MOVE      OPARD010,OPARMUPJ
          ENDIF
.
          MATCH     OPARD011,Z70
          IF        !@EQUAL
            MOVE      OPARD011,OPARPMED
          ENDIF
.
          MATCH     OPARD012,Z70
          IF        !@EQUAL
            MOVE      OPARD012,OPARALCK
          ENDIF
.
          MATCH     OPARD013,Z70
          IF        !@EQUAL
            MOVE      OPARD013,OPARPROT
          ENDIF
.
          MATCH     OPARD014,Z70
          IF        !@EQUAL
            MOVE      OPARD014,OPARUC01
          ENDIF
.
          MATCH     OPARD015,Z70
          IF        !@EQUAL
            MOVE      OPARD015,OPARUC02
          ENDIF
.
          MATCH     OPARD016,Z70
          IF        !@EQUAL
            MOVE      OPARD016,OPARUC03
          ENDIF
.
          MATCH     OPARD017,Z70
          IF        !@EQUAL
            MOVE      OPARD017,OPARUC04
          ENDIF
.
          MATCH     OPARD018,Z70
          IF        !@EQUAL
            MOVE      OPARD018,OPARUC05
          ENDIF
.
          MATCH     OPARD019,Z70
          IF        !@EQUAL
            MOVE      OPARD019,OPARUC06
          ENDIF
.
          MATCH     OPARD020,Z70
          IF        !@EQUAL
            MOVE      OPARD020,OPARUC07
          ENDIF
.
          MATCH     OPARD021,Z70
          IF        !@EQUAL
            MOVE      OPARD021,OPARUC08
          ENDIF
.
          MATCH     OPARD022,Z70
          IF        !@EQUAL
            MOVE      OPARD022,OPARUC09
          ENDIF
.
          MATCH     OPARD023,Z70
          IF        !@EQUAL
            MOVE      OPARD023,OPARUC10
          ENDIF
.
          MATCH     OPARD024,Z70
          IF        !@EQUAL
            MOVE      OPARD024,OPARUY01
          ENDIF
.
          MATCH     OPARD025,Z70
          IF        !@EQUAL
            MOVE      OPARD025,OPARUY02
          ENDIF
.
          MATCH     OPARD026,Z70
          IF        !@EQUAL
            MOVE      OPARD026,OPARUY03
          ENDIF
.
          MATCH     OPARD027,Z70
          IF        !@EQUAL
            MOVE      OPARD027,OPARUY04
          ENDIF
.
          MATCH     OPARD028,Z70
          IF        !@EQUAL
            MOVE      OPARD028,OPARUY05
          ENDIF
.
          MATCH     OPARD029,Z70
          IF        !@EQUAL
            MOVE      OPARD029,OPARUT01
          ENDIF
.
          MATCH     OPARD030,Z70
          IF        !@EQUAL
            MOVE      OPARD030,OPARUT02
          ENDIF
.
          MATCH     OPARD031,Z70
          IF        !@EQUAL
            MOVE      OPARD031,OPARUT03
          ENDIF
.
          MATCH     OPARD032,Z70
          IF        !@EQUAL
            MOVE      OPARD032,OPARUT04
          ENDIF
.
          MATCH     OPARD033,Z70
          IF        !@EQUAL
            MOVE      OPARD033,OPARUT05
          ENDIF
.
          COMPARE   OPARD034,ZERO
          IF        !@EQUAL
            MOVE      OPARD034,OPARUF01
          ENDIF
.
          COMPARE   OPARD035,ZERO
          IF        !@EQUAL
            MOVE      OPARD035,OPARUF02
          ENDIF
.
          COMPARE   OPARD036,ZERO
          IF        !@EQUAL
            MOVE      OPARD036,OPARUF03
          ENDIF
.
          COMPARE   OPARD037,ZERO
          IF        !@EQUAL
            MOVE      OPARD037,OPARUF04
          ENDIF
.
          COMPARE   OPARD038,ZERO
          IF        !@EQUAL
            MOVE      OPARD038,OPARUF05
          ENDIF
.
          MATCH     OPARD039,Z70
          IF        !@EQUAL
            MOVE      OPARD039,OPARTCAL
          ENDIF
.
          MATCH     OPARD040,Z70
          IF        !@EQUAL
            MOVE      OPARD040,OPARUIAR
          ENDIF
.
          MATCH     OPARD041,Z70
          IF        !@EQUAL
            MOVE      OPARD041,OPARANAP
          ENDIF
.
          MATCH     OPARD042,Z70
          IF        !@EQUAL
            MOVE      OPARD042,OPARANAS
          ENDIF
.
          MATCH     OPARD043,Z70
          IF        !@EQUAL
            MOVE      OPARD043,OPARANAE
          ENDIF
.
          MATCH     OPARD044,Z70
          IF        !@EQUAL
            MOVE      OPARD044,OPARITYP
          ENDIF
.
          MATCH     OPARD045,Z70
          IF        !@EQUAL
            MOVE      OPARD045,OPARUC11
          ENDIF
.
          MATCH     OPARD046,Z70
          IF        !@EQUAL
            MOVE      OPARD046,OPARUC12
          ENDIF
.
          MATCH     OPARD047,Z70
          IF        !@EQUAL
            MOVE      OPARD047,OPARUC13
          ENDIF
.
          MATCH     OPARD048,Z70
          IF        !@EQUAL
            MOVE      OPARD048,OPARUC14
          ENDIF
.
          MATCH     OPARD049,Z70
          IF        !@EQUAL
            MOVE      OPARD049,OPARUC15
          ENDIF
.
          MATCH     OPARD050,Z70
          IF        !@EQUAL
            MOVE      OPARD050,OPARUC16
          ENDIF
.
          MATCH     OPARD051,Z70
          IF        !@EQUAL
            MOVE      OPARD051,OPARUC17
          ENDIF
.
          MATCH     OPARD052,Z70
          IF        !@EQUAL
            MOVE      OPARD052,OPARUC18
          ENDIF
.
          MATCH     OPARD053,Z70
          IF        !@EQUAL
            MOVE      OPARD053,OPARUC19
          ENDIF
.
          MATCH     OPARD054,Z70
          IF        !@EQUAL
            MOVE      OPARD054,OPARUC20
          ENDIF
.
          MATCH     OPARD055,Z70
          IF        !@EQUAL
            MOVE      OPARD055,OPARUY06
          ENDIF
.
          MATCH     OPARD056,Z70
          IF        !@EQUAL
            MOVE      OPARD056,OPARUY07
          ENDIF
.
          MATCH     OPARD057,Z70
          IF        !@EQUAL
            MOVE      OPARD057,OPARUY08
          ENDIF
.
          MATCH     OPARD058,Z70
          IF        !@EQUAL
            MOVE      OPARD058,OPARUY09
          ENDIF
.
          MATCH     OPARD059,Z70
          IF        !@EQUAL
            MOVE      OPARD059,OPARUY10
          ENDIF
.
          MATCH     OPARD060,Z70
          IF        !@EQUAL
            MOVE      OPARD060,OPARUT06
          ENDIF
.
          MATCH     OPARD061,Z70
          IF        !@EQUAL
            MOVE      OPARD061,OPARUT07
          ENDIF
.
          MATCH     OPARD062,Z70
          IF        !@EQUAL
            MOVE      OPARD062,OPARUT08
          ENDIF
.
          MATCH     OPARD063,Z70
          IF        !@EQUAL
            MOVE      OPARD063,OPARUT09
          ENDIF
.
          MATCH     OPARD064,Z70
          IF        !@EQUAL
            MOVE      OPARD064,OPARUT10
          ENDIF
.
          COMPARE   OPARD065,ZERO
          IF        !@EQUAL
            MOVE      OPARD065,OPARUF06
          ENDIF
.
          COMPARE   OPARD066,ZERO
          IF        !@EQUAL
            MOVE      OPARD066,OPARUF07
          ENDIF
.
          COMPARE   OPARD067,ZERO
          IF        !@EQUAL
            MOVE      OPARD067,OPARUF08
          ENDIF
.
          COMPARE   OPARD068,ZERO
          IF        !@EQUAL
            MOVE      OPARD068,OPARUF09
          ENDIF
.
          COMPARE   OPARD069,ZERO
          IF        !@EQUAL
            MOVE      OPARD069,OPARUF10
          ENDIF
.
          MATCH     OPARD070,Z70 
          IF        !@EQUAL
            MOVE      OPARD070,OPARUANA
          ENDIF
.
          MATCH     OPARD071,Z70 
          IF        !@EQUAL
            MOVE      OPARD071,OPARTIRF
          ENDIF
.
          MATCH     OPARD072,Z70 
          IF        !@EQUAL
            MOVE      OPARD072,OPARNUF1
          ENDIF
.
          MATCH     OPARD073,Z70 
          IF        !@EQUAL
            MOVE      OPARD073,OPARNUF2
          ENDIF
.
          MATCH     OPARD074,Z70 
          IF        !@EQUAL
            MOVE      OPARD074,OPARTIRB
          ENDIF
.
          MATCH     OPARD075,Z70 
          IF        !@EQUAL
            MOVE      OPARD075,OPARNUB1
          ENDIF
.
          MATCH     OPARD076,Z70 
          IF        !@EQUAL
            MOVE      OPARD076,OPARNUB2
          ENDIF
.
          MATCH     OPARD077,Z70 
          IF        !@EQUAL
            MOVE      OPARD077,OPARTIRD
          ENDIF
.
          MATCH     OPARD078,Z70 
          IF        !@EQUAL
            MOVE      OPARD078,OPARNUD1
          ENDIF
.
          MATCH     OPARD079,Z70 
          IF        !@EQUAL
            MOVE      OPARD079,OPARNUD2
          ENDIF
.
          MATCH     OPARD080,Z70 
          IF        !@EQUAL
            MOVE      OPARD080,OPARTETC
          ENDIF
.
          MATCH     OPARD081,Z70 
          IF        !@EQUAL
            MOVE      OPARD081,OPARUREC
          ENDIF
.
          MATCH     OPARD082,Z70 
          IF        !@EQUAL
            MOVE      OPARD082,OPARTEXP
          ENDIF
.
          MATCH     OPARD083,Z70 
          IF        !@EQUAL
            MOVE      OPARD083,OPARTICU
          ENDIF
.
          MATCH     OPARD084,Z70 
          IF        !@EQUAL
            MOVE      OPARD084,OPARRDCD
          ENDIF
.
          MATCH     OPARD085,Z70 
          IF        !@EQUAL
            MOVE      OPARD085,OPARTIDP
          ENDIF
.
          MATCH     OPARD086,Z70
          IF        !@EQUAL
            MOVE      OPARD086,OPARUC21
          ENDIF
.
          MATCH     OPARD087,Z70
          IF        !@EQUAL
            MOVE      OPARD087,OPARUC22
          ENDIF
.
          MATCH     OPARD088,Z70
          IF        !@EQUAL
            MOVE      OPARD088,OPARUC23
          ENDIF
.
          MATCH     OPARD089,Z70
          IF        !@EQUAL
            MOVE      OPARD089,OPARUC24
          ENDIF
.
          MATCH     OPARD090,Z70
          IF        !@EQUAL
            MOVE      OPARD090,OPARUC25
          ENDIF
.
          MATCH     OPARD091,Z70
          IF        !@EQUAL
            MOVE      OPARD091,OPARUC26
          ENDIF
.
          MATCH     OPARD092,Z70
          IF        !@EQUAL
            MOVE      OPARD092,OPARUC27
          ENDIF
.
          MATCH     OPARD093,Z70
          IF        !@EQUAL
            MOVE      OPARD093,OPARUC28
          ENDIF
.
          MATCH     OPARD094,Z70
          IF        !@EQUAL
            MOVE      OPARD094,OPARUC29
          ENDIF
.
          MATCH     OPARD095,Z70
          IF        !@EQUAL
            MOVE      OPARD095,OPARUC30
          ENDIF
.
          MATCH     OPARD096,Z70
          IF        !@EQUAL
            MOVE      OPARD096,OPARUY11
          ENDIF
.
          MATCH     OPARD097,Z70
          IF        !@EQUAL
            MOVE      OPARD097,OPARUY12
          ENDIF
.
          MATCH     OPARD098,Z70
          IF        !@EQUAL
            MOVE      OPARD098,OPARUY13
          ENDIF
.
          MATCH     OPARD101,Z70
          IF        !@EQUAL
            MOVE      OPARD101,OPARUY14
          ENDIF
.
          MATCH     OPARD102,Z70
          IF        !@EQUAL
            MOVE      OPARD102,OPARUY15
          ENDIF
.
          MATCH     OPARD103,Z70
          IF        !@EQUAL
            MOVE      OPARD103,OPARUT11
          ENDIF
.
          MATCH     OPARD104,Z70
          IF        !@EQUAL
            MOVE      OPARD104,OPARUT12
          ENDIF
.
          MATCH     OPARD105,Z70
          IF        !@EQUAL
            MOVE      OPARD105,OPARUT13
          ENDIF
.
          MATCH     OPARD106,Z70
          IF        !@EQUAL
            MOVE      OPARD106,OPARUT14
          ENDIF
.
          MATCH     OPARD107,Z70
          IF        !@EQUAL
            MOVE      OPARD107,OPARUT15
          ENDIF
.
          COMPARE   OPARD108,ZERO
          IF        !@EQUAL
            MOVE      OPARD108,OPARUF11
          ENDIF
.
          COMPARE   OPARD109,ZERO
          IF        !@EQUAL
            MOVE      OPARD109,OPARUF12
          ENDIF
.
          COMPARE   OPARD110,ZERO
          IF        !@EQUAL
            MOVE      OPARD110,OPARUF13
          ENDIF
.
          COMPARE   OPARD111,ZERO
          IF        !@EQUAL
            MOVE      OPARD111,OPARUF14
          ENDIF
.
          COMPARE   OPARD112,ZERO
          IF        !@EQUAL
            MOVE      OPARD112,OPARUF15
          ENDIF
.
          MATCH     OPARD113,Z70
          IF        !@EQUAL
            MOVE      OPARD113,OPARUYN1
          ENDIF
.
          MATCH     OPARD114,Z70
          IF        !@EQUAL
            MOVE      OPARD114,OPARUYN2
          ENDIF
.
          MATCH     OPARD115,Z70
          IF        !@EQUAL
            MOVE      OPARD115,OPARADST
          ENDIF
.
          MATCH     OPARD116,Z70
          IF        !@EQUAL
            MOVE      OPARD116,OPARADET
          ENDIF
.
MVOPAR99  RETURN
