.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
VDGF0000  MOVE      ZERO,F2
          PACK      MTHNAM3,SP70
          BRANCH    FLDITMNO,VDGF0100,VDGF0200,VDGF0300
          GOTO      VDGF9999
.
VDGF0100  PACK      KEY9,ADMISSNO,SP70
          IF        EMCNICDF=1
            MOVE      "Unknown diagnosis",EMICDESC
            IF        EMICFLAG=1
              CALL      RDEMICD3
              MOVE      EMICDESC,DIM40
            ELSE
              CALL      RDEMICD1
              MOVE      EMICDESC,DIM40
            ENDIF
          ELSE
            MOVE      "Unknown diagnosis",DDESC
            CALL      RD10T9D1
            IF        OVRCD=1
              CALL      RDPT10D1
            ENDIF
            MOVE      DDESC,DIM40
          ENDIF
.
          UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,VDGF0110           * 1= code,(2=selection),0=description
.
          WRITE     HTMLFILE;DIM40
          GOTO      VDGF9999
.
VDGF0110  WRITE     HTMLFILE;EMVDCODE
          GOTO      VDGF9999
.
.VRPF0120  CALL      DIASEL00
.          GOTO      VDGF9999
.
VDGF0200  MOVE      "Yes",PRIMARY
          MATCH     EMVDPRIM,DIMN
          IF        @EQUAL
            MOVE      "No",PRIMARY
          ENDIF
.
          WRITE     HTMLFILE;PRIMARY
          GOTO      VDGF9999
.
VDGF0300  MOVE      "Yes",EXTRACT
          MATCH     EMVDSEND,DIMN
          IF        @EQUAL
            MOVE      "No",EXTRACT
          ENDIF
.
          WRITE     HTMLFILE;EXTRACT
          GOTO      VDGF9999
.
VDGF9999  RETURN
.------------------------------------------------------------
. Add Selection Options to form for diag
.------------------------------------------------------------
DIASEL00  PACK      KEY9,SP70
          CALL      RSEMPRO1
DIASEL10  CALL      RSEMPRO2
          BRANCH    OVRCD,DIASEL99
          MATCH     SP70,EMPRCODE
          GOTO      DIASEL10 IF EQUAL
          PACK      KEY15,QUOTE,EMPRCODE,QUOTE,SP70
          MATCH     EMVDCODE,EMPRCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY15," selected>":
                               TDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY15,">",TDESC,"</option>"
          ENDIF
          GOTO      DIASEL10
DIASEL99  RETURN
.
