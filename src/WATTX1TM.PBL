. *----------------------------------------------------------------------
. * Include Name  :   WATTX1TM.PBL
. *
. * Function      :   CGI variables for WATTX1FD - wattx1af.dat
. *
. * Includes Needed : WATPROFD - Procedure code file
. *                   WATPROIO - IO for procedure code file
. *                   PATWR1FD - Ward file 
. *                   PATWR1IO - IO for ward file
. *                    
. *----------------------------------------------------------------------
.
. Modifications  :
.----------------------------------------------------------------------
. V10.13.01 09/01/2019  Thanh T.         TSK 0863964
.                       Added WTTX5800 WTTX5900 
. V10.07.01 30/10/2015  Don Nguyen       CAR 320394
.                       Added WATTX052-WATTX056 and WTTX5300-WTTX5700
. V10.04.01 08.05.2014  Peter Vela       CAR 279020
.                       Added WTTXPRPB and WTTXAASC
. V10.03.05 30.09.2013  Peter Vela       CAR 291974
.                       Added Start/End date validations to HCPHOS00 
. V10.03.04 26.08.2013  Ebon Clements    CAR 275205
.                       Added WTTXPSAH and WTTXPHOS
. V10.03.03 08.05.2013  Ania P         CAR 284957
.                       Fixed WTTX3000 to use code XH not XG
. V10.03.02 18.01.2012  Peter Vela     CAR 254454
.                       Added tag for numerical Inform GP
. V10.03.01 12.01.2012  Peter Vela     CAR 254454
.                       Fixed unknown in Inform GP
. V10.02.03 13.09.2011  Sandra Barcham CAR 250840
.                       Allow for unknown in Inform Gp
. V10.02.02 18.07.2011  Jill Parkinson CAR 243296
.                       Added new wahealth fields
.           21/07/2011  Davin         CAR 240723
.                       Added tag to display Teams (wattm000)
. V10.02.01 29.06.2011  Peter McMullen CAR 240725
.                       Change ward selection list to common WSEL0000 
.                       routine (in parent).
. V10.00.01 21.04.2010  Saroeun Soeur CAR 196071
.                       Add WATTX033
. V9.08.01  08.05.2007  Jill Habasque CAR 139862
.                       Added planned 23 hour stay  
. V9.04.02  04.04.2005  Ebon Clements CAR 55594
.                       Added pre anaesthetic fields
. V9.04.01  27.08.2004  Jill Habasque CAR 53046
.                       Added check for multi hospital for post of ward
. V9.02.06  02.10.2002  Peter Vela    SRF 17693
.                       Mods to read from patcodes instead of patwr1af for 
.                       Admitting point.
. V9.02.05  24.08.2002  Jill Habasque SRF 20795
.                       Mods to display WTTXPATM if admitted to other hospital
. V9.02.04  23.01.2002  Ebon Clements 
.                       Add WTTXPTIM and WTTXPOTM
. V9.02.03  18.12.2001  Ashwin
.                       Add Equipment Required 3
. V9.02.02  14.11.2001  Rahghunandan Surve - HPS
.                       Don't display adm. date/time for "removed" status
. V9.02.01  13.09.2001  Rahul Gupta - HPS
.                       Changed Z characters to spaces.
.------------------------------------------------------------------------
.   Clear Parameters for waiting list extension file
.------------------------------------------------------------------------
.
CPWTTX00  MOVE      Z70,WATTX001
          MOVE      Z70,WATTX002
          MOVE      Z70,WATTX003
          MOVE      Z70,WATTX004
          MOVE      Z70,WATTX005
          MOVE      Z70,WATTX006
          MOVE      SP70,WATTX007
          MOVE      SP70,WATTX008
          MOVE      SP70,WATTX009
          MOVE      Z70,WATTX010
          MOVE      Z70,WATTX011
          MOVE      Z70,WATTX012
          MOVE      SP70,WATTX013
          MOVE      SP70,WATTX014
          MOVE      Z70,WATTX015
          MOVE      SP70,WATTX016
          MOVE      SP70,WATTX017
          MOVE      SP70,WATTX018
          MOVE      Z70,WATTX019
          MOVE      SP70,WATTX020
          MOVE      SP70,WATTX021
          MOVE      SP70,WATTX022
          MOVE      Z70,WATTX023
          MOVE      Z70,WATTX024
          MOVE      Z70,WATTX025
          MOVE      Z70,WATTX026
          MOVE      Z70,WATTX027
          MOVE      Z70,WATTX028
          MOVE      Z70,WATTX029
          MOVE      Z70,WATTX030
          MOVE      Z70,WATTX031
          MOVE      Z70,WATTX032
          MOVE      Z70,WATTX033
          MOVE      Z70,WATTX034
          MOVE      Z70,WATTX035
          MOVE      Z70,WATTX036
          MOVE      Z70,WATTX037
          MOVE      Z70,WATTX038
          MOVE      Z70,WATTX039
          MOVE      Z70,WATTX040
          MOVE      Z70,WATTX041
          MOVE      Z70,WATTX042
          MOVE      Z70,WATTX043
          MOVE      Z70,WATTX044
          MOVE      Z70,WATTX045
          MOVE      Z70,WATTX046
          MOVE      Z70,WATTX047
          MOVE      Z70,WATTX048
          MOVE      Z70,WATTX049
          MOVE      Z70,WATTX050
          MOVE      Z70,WATTX051
          MOVE      Z70,WATTX052
          MOVE      Z70,WATTX053
          MOVE      Z70,WATTX054
          MOVE      Z70,WATTX055
          MOVE      Z70,WATTX056
          MOVE      Z70,WATTX057
.
CPWTTX99  RETURN
.------------------------------------------------------------
. Add waiting list Extension Fields
.------------------------------------------------------------
WTTX0000  BRANCH    FLDITMNO,WTTX0100,WTTX0200,WTTX0300,WTTX0400,WTTX0500:
                             WTTX0600,WTTX0700,WTTX0800,WTTX0900,WTTX1000:
                             WTTX1100,WTTX1200,WTTX1300,WTTX1400,WTTX1500:
                             WTTX1600,WTTX1700,WTTX1800,WTTX1900,WTTX2000:
                             WTTX2100,WTTX2200,WTTX2300,WTTX2400,WTTX2500:
                             WTTX2600,WTTX2700,WTTX2800,WTTX2900,WTTX3000:
                             WTTX3100,WTTX3200,WTTX3300,WTTX3400,WTTX3500:
                             WTTX3600,WTTX3700,WTTX3800,WTTX3900,WTTX4000:
                             WTTX4100,WTTX4200,WTTX4300,WTTX4400,WTTX4500:
                             WTTX4600,WTTX4700,WTTX4800,WTTX4900,WTTX5000:
                             WTTX5100,WTTX5200,WTTX5300,WTTX5400,WTTX5500:
                             WTTX5600,WTTX5700,WTTX5800,WTTX5900,WTTX6000
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      WTTX9999
.
WTTX0100  WRITE     HTMLFILE;WTTXURNO;
          GOTO      WTTX9999
.
WTTX0200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WTTX0210
          PACK      KEY9,WTTXPCOD    
          CALL      RDPROA1
          BRANCH    OVRCD,WTTX9999
          WRITE     HTMLFILE;WPDESC;
          GOTO      WTTX9999
.
WTTX0210  WRITE     HTMLFILE;WTTXPCOD;
          GOTO      WTTX9999
.
WTTX0300  WRITE     HTMLFILE;WTTXPCNT;
          GOTO      WTTX9999
.
WTTX0400  MOVE      "VL",CATEGORY
          MOVE      WTTXPLST,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX0500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WTTX0510,WTTX0520
          PACK      KEY6,WTTXPOWD,SP30
          CALL      RDWARD1
          BRANCH    OVRCD,WTTX9999
          WRITE     HTMLFILE;WBDESC;
          GOTO      WTTX9999
.
WTTX0510  WRITE     HTMLFILE;WTTXPOWD;
          GOTO      WTTX9999
.
WTTX0520  PACK      DFLTWARD,WTTXPOWD  * post op ward selection list 
          CALL      WSEL0000                         
          GOTO      WTTX9999
.
WTTX0600  MOVE      "ap",CATEGORY                   * I SRF 17693
          MOVE      WTTXADMW,CODE                   * Set parameter 
          CALL      CODITM00                        * Look in patcodes for desc
          GOTO      WTTX9999                        * end I SRF 17693
.
WTTX0700  MOVE      NO,YESNO
          MATCH     "1",WTTXPSTY
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      WTTX9999
.
WTTX0800  MOVE      "XB",CATEGORY
          MOVE      WTTXIDYC,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX0900  MOVE      "XA",CATEGORY
          MOVE      WTTXADMF,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX1000  MOVE      "XE",CATEGORY
          MOVE      WTTXEQR1,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX1100  MOVE      "XE",CATEGORY
          MOVE      WTTXEQR2,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX1200  MOVE      "XG",CATEGORY
          MOVE      WTTXPAST,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX1300  MOVE      NO,YESNO
          MATCH     "1",WTTXCNSN
          IF        @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      WTTX9999
.
WTTX1400  MATCH     "0",WTTXNTGP
          IF        @EQUAL
            WRITE     HTMLFILE;NO;
            GOTO      WTTX9999
          ENDIF
          MATCH     "1",WTTXNTGP
          IF        @EQUAL
            WRITE     HTMLFILE;YES;
            GOTO      WTTX9999
          ENDIF
          MATCH     "2",WTTXNTGP
          IF        @EQUAL
            WRITE     HTMLFILE;DUNK;
            GOTO      WTTX9999
          ENDIF
          GOTO      WTTX9999
.
WTTX1500  IF        WMSTAT=6
            MATCH     SP70,WMREMOVE
            GOTO      WTTX9999 IF EQUAL
.
            PACK      KEY5,ANSW,ANSR,WMREMOVE,SP70
            CALL      RDCODE1
            BRANCH    OVRCD,WTTX9999
.
            MATCH     ANSX,THCSCOD
            GOTO      WTTX9999 IF NOT EQUAL
          ENDIF 
          MATCH     Z70,WTTXPATM
          IF        !@EQUAL
            WRITE     HTMLFILE;WTTXPATM;
          ENDIF
          GOTO      WTTX9999
.
WTTX1600  MATCH     SP70,WTTXUIDR
          GOTO      WTTX9999 IF EQUAL
          PACK      KEY10,WTTXUIDR
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      WTTXUIDR,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      WTTX9999
.
WTTX1700  MOVE      "XO",CATEGORY
          MOVE      WTTXLEQR,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX1800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WTTX1810
          PACK      KEY9,WTTXDPRC    
          CALL      RDPROA1
          BRANCH    OVRCD,WTTX9999
          MATCH     Z70,WPDESC
          IF        !@EQUAL
            WRITE     HTMLFILE;WPDESC;
          ELSE
            WRITE     HTMLFILE;SP1;
          ENDIF
          GOTO      WTTX9999
.
WTTX1810  MATCH     Z70,WTTXDPRC
          IF        !@EQUAL
            WRITE     HTMLFILE;WTTXDPRC;
          ELSE
            WRITE     HTMLFILE;SP1;
          ENDIF
          GOTO      WTTX9999
.
WTTX1900  WRITE     HTMLFILE;WTTXDPCN;
          GOTO      WTTX9999
.
WTTX2000  MATCH     WTTXCDTE,SP70
          GOTO      WTTX9999 IF EQUAL
          UNPACK    WTTXCDTE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WTTX9999
.
WTTX2100  WRITE     HTMLFILE;WTTXCTIM;
          GOTO      WTTX9999
.
WTTX2200  MATCH     Z70,WTTXWEBC
          GOTO      WTTX9999 IF EQUAL
.          MOVE      SP70,WBSENAM
          PACK      KEY10,WTTXWEBC
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      WTTXWEBC,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      WTTX9999
.
WTTX2300  MATCH     WTTXLUPD,SP70
          GOTO      WTTX9999 IF EQUAL
          UNPACK    WTTXLUPD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WTTX9999
.
WTTX2400  WRITE     HTMLFILE;WTTXLUPT;
          GOTO      WTTX9999
.
WTTX2500  MATCH     SP70,WTTXWEBU
          GOTO      WTTX9999 IF EQUAL
          PACK      KEY10,WTTXWEBU
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      WTTXWEBU,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      WTTX9999
.
WTTX2600  MOVE      "CL",CATEGORY
          MOVE      WTTXCTYP,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX2700  MOVE      "XE",CATEGORY
          MOVE      WTTXEQR3,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX2800  WRITE     HTMLFILE;WTTXPTIM;
          GOTO      WTTX9999
.
WTTX2900  WRITE     HTMLFILE;WTTXPOTM;
          GOTO      WTTX9999
.
WTTX3000  MOVE      "XH",CATEGORY
          MOVE      WTTXPANS,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX3100  WRITE     HTMLFILE;WTTXPANT;
          GOTO      WTTX9999
.
WTTX3200  MOVE      NO,YESNO
          MATCH     "1",WTTX23HR
          IF        @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      WTTX9999
.
WTTX3300  MOVE      "OA",CATEGORY
          MOVE      WTTXANAE,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX3400  MOVE      "BK",CATEGORY
          MOVE      WTTXBOTY,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX3500  PROC      WATTM000                 * display Team/s
          GOTO      WTTX9999
.
WTTX3600  MOVE      "cx",CATEGORY
          MOVE      WTTXFUND,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX3700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WTTX3710
.
          WRITE     HTMLFILE;WTTXWARD;
          GOTO      WTTX9999
.
WTTX3710  MATCH     SP70,WTTXWARD
          GOTO      WTTX9999 IF EQUAL
.
          PACK      KEY6,WTTXWARD,SP70
          CALL      RDWARD1
          BRANCH    OVRCD,WTTX9999
          WRITE     HTMLFILE;WBDESC;
          GOTO      WTTX9999
.
WTTX3800  MOVE      "BP",CATEGORY
          MOVE      WTTXPREF,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX3900  MOVE      "cw",CATEGORY
          MOVE      WTTXNWHC,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX4000  MOVE      "VI",CATEGORY
          MOVE      WTTXINTD,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX4100  WRITE     HTMLFILE;WTTXMAUT;
          GOTO      WTTX9999
.
WTTX4200  MATCH     WTTXEXPD,SP70
          GOTO      WTTX9999 IF EQUAL
          UNPACK    WTTXEXPD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WTTX9999
.
WTTX4300  MOVE      "WH",CATEGORY
          MOVE      WTTXTCRS,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX4400  WRITE     HTMLFILE;WTTXDISC;
          GOTO      WTTX9999
.
WTTX4500  WRITE     HTMLFILE;WTTXRTIM;
          GOTO      WTTX9999
.
WTTX4600  PACK      GENPCODE,WTTXRCLI,SP70
          CALL      HCPDET00        
          GOTO      WTTX9999
.
WTTX4700  MOVE      ZERO,F2
          MOVE      WTWMGPPT,F2
          PACK      KEY10,WTTXRCLP,SP70
          PACK      GPPCCODE,KEY10,F2
          CALL      HCGDET00
          GOTO      WTTX9999
.
WTTX4800  WRITE     HTMLFILE;WTTXNTGP;
          GOTO      WTTX9999
.
WTTX4900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WTTX4910,WTTX4920
.
          WRITE     HTMLFILE;WTTXPSAH;
          GOTO      WTTX9999
.
WTTX4910  MOVE      ZERO,F1
          MOVE      WTTXPSAH,F1
.
          IF        F1=ZERO
            WRITE     HTMLFILE;"No";
          ENDIF
.
          IF        F1=ONE
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          IF        F1=TWO
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      WTTX9999
.
WTTX4920  MOVE      ZERO,F1
          MOVE      WTTXPSAH,F1
.
          IF        F1=ZERO
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          IF        F1=ONE
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          IF        F1=TWO
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
.
WTTX5000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WTTX5010,WTTX5020
.
          WRITE     HTMLFILE;WTTXPHOS;
          GOTO      WTTX9999
.
WTTX5010  PACK      KEY3,WTTXPHOS,SP70
          CALL      RDPTHSP1
          IF        OVRCD=1
            MOVE      WTTXPHOS,PTHSNAME
          ENDIF
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      WTTX9999
.
WTTX5020  CALL      HCPHOS00
          GOTO      WTTX9999
.
WTTX5100  MOVE      "yh",CATEGORY
          MOVE      WTTXPRPB,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX5200  WRITE     HTMLFILE;WTTXAASC;
          GOTO      WTTX9999
.
WTTX5300  MOVE      "X9",CATEGORY
          MOVE      WTTXUD09,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX5400  MOVE      "x1",CATEGORY
          MOVE      WTTXUD10,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX5500  MOVE      "x2",CATEGORY
          MOVE      WTTXUD11,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX5600  MOVE      "x3",CATEGORY
          MOVE      WTTXUD12,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX5700  MOVE      "x4",CATEGORY
          MOVE      WTTXUD13,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX5800  CALL      WTPACM00
          GOTO      WTTX9999
.
WTTX5900  UNPACK    WATTRKEY,BKREURNO,BKREPROC,DBKRECNT
          CALL      WTPACM00
          GOTO      WTTX9999
.
WTTX6000  MOVE      "As",CATEGORY
          MOVE      WTTXASAS,CODE
          CALL      CODITM00
          GOTO      WTTX9999
.
WTTX9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for waiting list extension file
.------------------------------------------------------------
SPWTTX00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPWTTX01,SPWTTX02,SPWTTX03,SPWTTX04,SPWTTX05:
                       SPWTTX06,SPWTTX07,SPWTTX08,SPWTTX09,SPWTTX10:
                       SPWTTX11,SPWTTX12,SPWTTX13,SPWTTX14,SPWTTX15:
                       SPWTTX16,SPWTTX17,SPWTTX18,SPWTTX19,SPWTTX20:
                       SPWTTX21,SPWTTX22,SPWTTX23,SPWTTX24,SPWTTX25:
                       SPWTTX26,SPWTTX27,SPWTTX28,SPWTTX29,SPWTTX30:
                       SPWTTX31,SPWTTX32,SPWTTX33,SPWTTX34,SPWTTX35:
                       SPWTTX36,SPWTTX37,SPWTTX38,SPWTTX39,SPWTTX40:
                       SPWTTX41,SPWTTX42,SPWTTX43,SPWTTX44,SPWTTX45:
                       SPWTTX46,SPWTTX47,SPWTTX48,SPWTTX49,SPWTTX50:
                       SPWTTX51,SPWTTX52,SPWTTX53,SPWTTX54,SPWTTX55:
                       SPWTTX56,SPWTTX57
.
          MOVE      ONE,EXIT
          GOTO      SPWTTX99
.
SPWTTX01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,WATTX001
          PACK      WATTX001,WATTX001,SP70
          GOTO      SPWTTX99
.
SPWTTX02  SQUEEZE   QRYDATA
          MOVE      QRYDATA,WATTX002
          PACK      WATTX002,WATTX002,SP70
          GOTO      SPWTTX99
.
SPWTTX03  SQUEEZE   QRYDATA
          MOVE      QRYDATA,WATTX003
          PACK      WATTX003,WATTX003,SP70
          GOTO      SPWTTX99
.
SPWTTX04  MOVE      QRYDATA,WATTX004
          GOTO      SPWTTX99
.
SPWTTX05  MOVE      QRYDATA,WATTX005
          GOTO      SPWTTX99
.
SPWTTX06  MOVE      QRYDATA,WATTX006
          GOTO      SPWTTX99
.
SPWTTX07  MOVE      QRYDATA,WATTX007
          GOTO      SPWTTX99
.
SPWTTX08  MOVE      QRYDATA,WATTX008
          GOTO      SPWTTX99
.
SPWTTX09  MOVE      QRYDATA,WATTX009
          GOTO      SPWTTX99
.
SPWTTX10  MOVE      QRYDATA,WATTX010
          GOTO      SPWTTX99
.
SPWTTX11  MOVE      QRYDATA,WATTX011
          GOTO      SPWTTX99
.
SPWTTX12  MOVE      QRYDATA,WATTX012
          GOTO      SPWTTX99
.
SPWTTX13  MOVE      QRYDATA,WATTX013
          GOTO      SPWTTX99
.
SPWTTX14  MOVE      QRYDATA,WATTX014
          GOTO      SPWTTX99
.
SPWTTX15  MOVE      QRYDATA,WATTX015
          GOTO      SPWTTX99
.
SPWTTX16  MOVE      QRYDATA,WATTX016
          GOTO      SPWTTX99
.
SPWTTX17  MOVE      QRYDATA,WATTX017
          GOTO      SPWTTX99
.
SPWTTX18  MOVE      QRYDATA,WATTX018
          GOTO      SPWTTX99
.
SPWTTX19  MOVE      QRYDATA,WATTX019
          GOTO      SPWTTX99
.
SPWTTX20  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WATTX020,CCENT,CYEAR,CMON,CDAY
          GOTO      SPWTTX99
.
SPWTTX21  MOVE      QRYDATA,WATTX021
          GOTO      SPWTTX99
.
SPWTTX22  MOVE      QRYDATA,WATTX022
          GOTO      SPWTTX99
.
SPWTTX23  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WATTX023,CCENT,CYEAR,CMON,CDAY
          GOTO      SPWTTX99
.
SPWTTX24  MOVE      QRYDATA,WATTX024
          GOTO      SPWTTX99
.
SPWTTX25  MOVE      QRYDATA,WATTX025
          GOTO      SPWTTX99
.
SPWTTX26  MOVE      QRYDATA,WATTX026
          GOTO      SPWTTX99
.
SPWTTX27  MOVE      QRYDATA,WATTX027
          GOTO      SPWTTX99
.
SPWTTX28  MOVE      QRYDATA,WATTX028
          GOTO      SPWTTX99
.
SPWTTX29  MOVE      QRYDATA,WATTX029
          GOTO      SPWTTX99
.
SPWTTX30  MOVE      QRYDATA,WATTX030
          GOTO      SPWTTX99
.
SPWTTX31  MOVE      QRYDATA,WATTX031
          GOTO      SPWTTX99
.
SPWTTX32  MOVE      QRYDATA,WATTX032
          GOTO      SPWTTX99
.
SPWTTX33  MOVE      QRYDATA,WATTX033
          GOTO      SPWTTX99
.
SPWTTX34  MOVE      QRYDATA,WATTX034
          GOTO      SPWTTX99
.
SPWTTX35  MOVE      QRYDATA,WATTX035
          GOTO      SPWTTX99
.
SPWTTX36  MOVE      QRYDATA,WATTX036
          GOTO      SPWTTX99
.
SPWTTX37  MOVE      QRYDATA,WATTX037
          GOTO      SPWTTX99
.
SPWTTX38  MOVE      QRYDATA,WATTX038
          GOTO      SPWTTX99
.
SPWTTX39  MOVE      QRYDATA,WATTX039
          GOTO      SPWTTX99
.
SPWTTX40  MOVE      QRYDATA,WATTX040
          GOTO      SPWTTX99
.
SPWTTX41  MOVE      QRYDATA,WATTX041
          GOTO      SPWTTX99
.
SPWTTX42  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WATTX042,CCENT,CYEAR,CMON,CDAY
          GOTO      SPWTTX99
.
SPWTTX43  MOVE      QRYDATA,WATTX043
          GOTO      SPWTTX99
.
SPWTTX44  MOVE      QRYDATA,WATTX044
          GOTO      SPWTTX99
.
SPWTTX45  MOVE      QRYDATA,WATTX045
          GOTO      SPWTTX99
.
SPWTTX46  MOVE      QRYDATA,WATTX046
          GOTO      SPWTTX99
.
SPWTTX47  MOVE      QRYDATA,WATTX047
          GOTO      SPWTTX99
.
SPWTTX48  MOVE      QRYDATA,WATTX048
          GOTO      SPWTTX99
.
SPWTTX49  MOVE      QRYDATA,WATTX049
          GOTO      SPWTTX99
.
SPWTTX50  MOVE      QRYDATA,WATTX050
          GOTO      SPWTTX99
.
SPWTTX51  MOVE      QRYDATA,WATTX051
          GOTO      SPWTTX99
.
SPWTTX52  MOVE      QRYDATA,WATTX052
          GOTO      SPWTTX99
.
SPWTTX53  MOVE      QRYDATA,WATTX053
          GOTO      SPWTTX99
.
SPWTTX54  MOVE      QRYDATA,WATTX054
          GOTO      SPWTTX99
.
SPWTTX55  MOVE      QRYDATA,WATTX055
          GOTO      SPWTTX99
.
SPWTTX56  MOVE      QRYDATA,WATTX056
          GOTO      SPWTTX99
.
SPWTTX57  MOVE      QRYDATA,WATTX057
          GOTO      SPWTTX99
.
SPWTTX99  RETURN
.------------------------------------------------------------
.  Update extension file
.------------------------------------------------------------
MVWTTX00  MATCH     WATTX001,Z70
          IF        !@EQUAL
            MOVE      WATTX001,WTTXURNO
          ENDIF
.
          MATCH     WATTX002,Z70
          IF        !@EQUAL
            MOVE      WATTX002,WTTXPCOD
          ENDIF
.
          MATCH     WATTX003,Z70
          IF        !@EQUAL
            MOVE      WATTX003,WTTXPCNT
          ENDIF
.
          MATCH     WATTX004,Z70
          IF        !@EQUAL
            MOVE      WATTX004,WTTXPLST
          ENDIF
.
          MATCH     WATTX005,Z70
          IF        !@EQUAL
            MOVE      WATTX005,WTTXPOWD
          ENDIF
.
          MATCH     WATTX006,Z70
          IF        !@EQUAL
            MOVE      WATTX006,WTTXADMW
          ENDIF
.
          MATCH     WATTX007,Z70
          IF        !@EQUAL
            MOVE      WATTX007,WTTXPSTY
          ELSE
            MOVE      ZERO,WTTXPSTY
          ENDIF
.
          MATCH     WATTX008,Z70
          IF        !@EQUAL
            MOVE      WATTX008,WTTXIDYC
          ENDIF
.
          MATCH     WATTX009,Z70
          IF        !@EQUAL
            MOVE      WATTX009,WTTXADMF
          ENDIF
.
          MATCH     WATTX010,Z70
          IF        !@EQUAL
            MOVE      WATTX010,WTTXEQR1
          ENDIF
.
          MATCH     WATTX011,Z70
          IF        !@EQUAL
            MOVE      WATTX011,WTTXEQR2
          ENDIF
.
          MATCH     WATTX012,Z70
          IF        !@EQUAL
            MOVE      WATTX012,WTTXPAST
          ENDIF
.
          MATCH     WATTX013,Z70
          IF        !@EQUAL
            MOVE      WATTX013,WTTXCNSN
          ELSE
            MOVE      ZERO,WTTXCNSN
          ENDIF
.
          MATCH     WATTX014,Z70
          IF        !@EQUAL
            MOVE      WATTX014,WTTXNTGP
          ENDIF
.
          MATCH     WATTX015,Z70
          IF        !@EQUAL
            MOVE      WATTX015,WTTXPATM
          ENDIF
.
          MATCH     WATTX016,Z70
          IF        !@EQUAL
            MOVE      WATTX016,WTTXUIDR
          ENDIF
.
          MATCH     WATTX017,Z70
          IF        !@EQUAL
            MOVE      WATTX017,WTTXLEQR
          ENDIF
.
          MATCH     WATTX018,Z70
          IF        !@EQUAL
            MOVE      WATTX018,WTTXDPRC
          ENDIF
.
          MATCH     WATTX019,Z70
          IF        !@EQUAL
            MOVE      WATTX019,WTTXDPCN
          ENDIF
.
          MATCH     WATTX020,Z70
          IF        !@EQUAL
            MOVE      WATTX020,WTTXCDTE
          ENDIF
.
          MATCH     WATTX021,Z70
          IF        !@EQUAL
            MOVE      WATTX021,WTTXCTIM
          ENDIF
.
          MATCH     WATTX022,Z70
          IF        !@EQUAL
            MOVE      WATTX022,WTTXWEBC
          ENDIF
.
          MATCH     WATTX023,Z70
          IF        !@EQUAL
            MOVE      WATTX023,WTTXLUPD
          ENDIF
.
          MATCH     WATTX024,Z70
          IF        !@EQUAL
            MOVE      WATTX024,WTTXLUPT
          ENDIF
.
          MATCH     WATTX025,Z70
          IF        !@EQUAL
            MOVE      WATTX025,WTTXWEBU
          ENDIF
.
          MATCH     WATTX026,Z70
          IF        !@EQUAL
            MOVE      WATTX026,WTTXCTYP
          ENDIF
.
          MATCH     WATTX027,Z70
          IF        !@EQUAL
            MOVE      WATTX027,WTTXEQR3
          ENDIF
.
          MATCH     WATTX028,Z70
          IF        !@EQUAL
            MOVE      WATTX028,WTTXPTIM
          ENDIF
.
          MATCH     WATTX029,Z70
          IF        !@EQUAL
            MOVE      WATTX029,WTTXPOTM
          ENDIF
.
          MATCH     WATTX030,Z70
          IF        !@EQUAL
            MOVE      WATTX030,WTTXPANS
          ENDIF
.
          MATCH     WATTX031,Z70
          IF        !@EQUAL
            MOVE      WATTX031,WTTXPANT
          ENDIF
.
          MATCH     WATTX032,Z70
          IF        !@EQUAL
            MOVE      WATTX032,WTTX23HR
          ENDIF
.
          MATCH     WATTX033,Z70
          IF        !@EQUAL
            MOVE      WATTX033,WTTXANAE
          ENDIF
.          
          MATCH     WATTX034,Z70
          IF        !@EQUAL
            MOVE      WATTX034,WTTXBOTY
          ENDIF
.          
          MATCH     WATTX035,Z70
          IF        !@EQUAL
            MOVE      WATTX035,WTTXTEAM
          ENDIF
.          
          MATCH     WATTX036,Z70
          IF        !@EQUAL
            MOVE      WATTX036,WTTXFUND
          ENDIF
.          
          MATCH     WATTX037,Z70
          IF        !@EQUAL
            MOVE      WATTX037,WTTXWARD
          ENDIF
.          
          MATCH     WATTX038,Z70
          IF        !@EQUAL
            MOVE      WATTX038,WTTXPREF
          ENDIF
.          
          MATCH     WATTX039,Z70
          IF        !@EQUAL
            MOVE      WATTX039,WTTXNWHC
          ENDIF
.          
          MATCH     WATTX040,Z70
          IF        !@EQUAL
            MOVE      WATTX040,WTTXINTD
          ENDIF
.          
          MATCH     WATTX041,Z70
          IF        !@EQUAL
            MOVE      WATTX041,WTTXMAUT
          ENDIF
.          
          MATCH     WATTX042,Z70
          IF        !@EQUAL
            MOVE      WATTX042,WTTXEXPD
          ENDIF
.          
          MATCH     WATTX043,Z70
          IF        !@EQUAL
            MOVE      WATTX043,WTTXTCRS
          ENDIF
.          
          MATCH     WATTX044,Z70
          IF        !@EQUAL
            MOVE      WATTX044,WTTXDISC
          ENDIF
.          
          MATCH     WATTX045,Z70
          IF        !@EQUAL
            MOVE      WATTX045,WTTXRTIM
          ENDIF
.          
          MATCH     WATTX046,Z70
          IF        !@EQUAL
            MOVE      WATTX046,WTTXRCLI
          ENDIF
.          
          MATCH     WATTX047,Z70
          IF        !@EQUAL
            MOVE      WATTX047,WTTXRCLP
          ENDIF
.          
          MATCH     WATTX048,Z70
          IF        !@EQUAL
            MOVE      WATTX048,WTTXPSAH
          ENDIF
.          
          MATCH     WATTX049,Z70
          IF        !@EQUAL
            MOVE      WATTX049,WTTXPHOS
          ENDIF

.
          MATCH     WATTX050,Z70
          IF        !@EQUAL
            MOVE      WATTX050,WTTXPRPB
          ENDIF
.
          MATCH     WATTX051,Z70
          IF        !@EQUAL
            MOVE      WATTX051,WTTXAASC
          ENDIF
.          
          MATCH     WATTX052,Z70
          IF        !@EQUAL
            MOVE      WATTX052,WTTXUD09    (NZ only - Clinician susp. of Cancer)
          ENDIF
.
          MATCH     WATTX053,Z70
          IF        !@EQUAL
            MOVE      WATTX053,WTTXUD10
          ENDIF
.
          MATCH     WATTX054,Z70
          IF        !@EQUAL
            MOVE      WATTX054,WTTXUD11
          ENDIF
.
          MATCH     WATTX055,Z70
          IF        !@EQUAL
            MOVE      WATTX055,WTTXUD12
          ENDIF
.
          MATCH     WATTX056,Z70
          IF        !@EQUAL
            MOVE      WATTX056,WTTXUD13
          ENDIF
.
          MATCH     WATTX057,Z70
          IF        !@EQUAL
            MOVE      WATTX057,WTTXASAS
          ENDIF
.
MVWTTX99  RETURN
.
.......................................................................
.  WATTM000 - display Teams
.    Tag Parameters   0=Description
.                     1=Code
.                     2=Selection List
.......................................................................
          DEFPROC   WATTM000
.
          INC       PMSTEMFD/INC
.
WATTM100  OPEN      PMSTEMA1,"pmstemaf"
.
WATTM200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WATTM210,WATTM220
.
          UNPACK    SP70,PMTMTEAM,PMTMDESC       * default - display Desc
          PACK      KEY5,WTTXTEAM,SP8
          CALL      RDPMTEM1
          MATCH     SP70,PMTMDESC
          GOTO      WATTM999 IF EQUAL
          WRITE     HTMLFILE;PMTMDESC;
          GOTO      WATTM999
.
WATTM210  PACK      WTTXTEAM,WTTXTEAM,SP8        * display Code
          MATCH     SP70,WTTXTEAM
          GOTO      WATTM999 IF EQUAL
          WRITE     HTMLFILE;WTTXTEAM;
          GOTO      WATTM999
.
WATTM220  UNPACK    SP70,PMTMTEAM,PMTMDESC       * display selection list
          PACK      KEY5,SP8
          CALL      RSPMTEM1
WATTM221  CALL      RKPMTEM1
          BRANCH    OVRCD,WATTM999
.
          MATCH     "1",PMTMACTV
          GOTO      WATTM221 IF EQUAL            * don't display inactive codes
.
          MATCH     WTTXTEAM,PMTMTEAM
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",PMTMTEAM,"#" selected>":
                               PMTMDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PMTMTEAM,"#">":
                               PMTMDESC,"</option>"
          ENDIF
          GOTO      WATTM221
.
.
OVERCOND  MOVE      ONE,OVRCD
          RETURN
.
          INC       PMSTEMIO/INC
.
WATTM999  CLOSE     PMSTEMA1
.
          ENDPROC
+
.
.------------------------------------------------------------
. Select list of linked hospital for a HCP
.------------------------------------------------------------
HCPHOS00  MATCH     SP70,WMDOCTOR
          GOTO      HCPHOS99 IF EQUAL
.
          CALL      IBACLOCK
          PACK      DIM8,CCC,CYY,CMM,CDD
          REP       " 0",DIM8
.
          MOVE      ZERO,F1                 * Hospital on file not displayed
.
          PACK      KEY10,WMDOCTOR,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,HCPHOS99
.
          MATCH     "1",PMHCHOSS            * Hospital Specific HCP
          GOTO      HCPHOS50 IF NOT EQUAL
.
          PACK      KEY13,WMDOCTOR,SP70
          CALL      RSMLHCP2                * positional read
HCPHOS10  CALL      RKMLHCP2                * read a record
          BRANCH    OVRCD,HCPHOS90
.
          MATCH     MLHCHCPC,WMDOCTOR
          GOTO      HCPHOS90 IF NOT EQUAL
.
          MATCH     "1",MLHCACTV            * skip inactive codes
          GOTO      HCPHOS10 IF EQUAL
.
          MATCH     MLHCSDAT,DIM8
          GOTO      HCPHOS10 IF LESS
.
          MATCH     SP70,MLHCEDAT
          IF        !@EQUAL & !@EOS
            MATCH     DIM8,MLHCEDAT
            GOTO      HCPHOS10 IF LESS
          ENDIF
.
          PACK      KEY3,MLHCHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,HCPHOS10
.
          MATCH     PTHSHOSP,WTTXPHOS
          IF        @EQUAL
            MOVE      ONE,F1                * Hospital on file displayed
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                               PTHSNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#">":
                               PTHSNAME,"</option>"
          ENDIF
          GOTO      HCPHOS10
.
HCPHOS50  PACK      KEY3,SP70
          CALL      RSPTHSP1                * positional read
HCPHOS60  CALL      RKPTHSP1                * read a record
          BRANCH    OVRCD,HCPHOS90
.
          MATCH     PTHSHOSP,WTTXPHOS
          IF        @EQUAL
            MOVE      ONE,F1                * Hospital on file displayed
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                               PTHSNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#">":
                               PTHSNAME,"</option>"
          ENDIF
.
          GOTO      HCPHOS60
.
HCPHOS90  BRANCH    F1,HCPHOS99             * Has hospital on file been listed
.
          PACK      KEY3,WTTXPHOS,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,HCPHOS99
.
          WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                             PTHSNAME,"</option>"
.
HCPHOS99  RETURN
.
.------------------------------------------------------------
. Display Preadmission Notes
.------------------------------------------------------------
WTPACM00  PACK      KEY21,BKREURNO,BKREPROC,DBKRECNT,SP70
          CALL      RSWTPAC1
WTPACM10  CALL      RKWTPAC1
          BRANCH    OVRCD,WTPACM99
          MATCH     BKREURNO,WTPCURNO
          GOTO      WTPACM99 IF NOT EQUAL
          MATCH     BKREPROC,WTPCPCOD
          GOTO      WTPACM99 IF NOT EQUAL
          MATCH     DBKRECNT,WTPCPCNT
          GOTO      WTPACM10 IF NOT EQUAL
          STRIP     WTPCCOMM
          MOVELPTR  WTPCCOMM,F3
          IF        F3>0
            SFORMAT   VAR,F3
          ELSE
            SFORMAT   VAR,1
          ENDIF
          MOVE      WTPCCOMM,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          GOTO      WTPACM10
.
WTPACM99  RETURN
.
