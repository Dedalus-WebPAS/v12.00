.------------------------------------------------------------------------------
. Get patient attribute details for admissno, urno, adm date, adm time and
. attribute type "024"
. Input: URNUMBER
.        ADMISSNO
.        DDATE
.        DTIME
.        SUBITMNO
.
. Modifications:
.------------------------------------------------------------------------------
. V11.03.00 13/02/2023 Thanh T        TSK 0917555
.           Initial version
.------------------------------------------------------------------------------
ATRFC000  UNPACK    DIM127,D1,SUBITMNO,DIM127
          MATCH     SP70,SUBITMNO
          GOTO      ATRFC999 IF EQUAL
          MOVE      SUBITMNO,SUBITMFO
.
          MOVE      "024",DIM3
          PACK      KEY35,URNUMBER,ADMISSNO,DDATE,DTIME,DIM3,Z70
          CALL      RDPTATR2
          BRANCH    OVRCD,ATRFC004
.
          MATCH     "1",PTARDELR
          GOTO      ATRFC004 IF EQUAL
.
          GOTO      ATRFC005
.
. No row found
.
ATRFC004  CALL      CLPATATR
.
ATRFC005  BRANCH    SUBITMFO,ATRFC010,ATRFC020,ATRFC030,ATRFC040,ATRFC050:
                             ATRFC060,ATRFC070,ATRFC080,ATRFC090,ATRFC100:
                             ATRFC110,ATRFC120,ATRFC130,ATRFC140,ATRFC150:
                             ATRFC160,ATRFC170
.
          GOTO      ATRFC999
.
ATRFC010  MOVE      "ZS",CATEGORY
          MOVE      PTARCOD1,CODE
          CALL      CODITM00
          GOTO      ATRFC999
.
ATRFC020  WRITE     HTMLFILE;PTARCOD2;
          GOTO      ATRFC999
.
ATRFC030  WRITE     HTMLFILE;PTARCOD3;
          GOTO      ATRFC999
.
ATRFC040  WRITE     HTMLFILE;PTARCOD4;
          GOTO      ATRFC999
.
ATRFC050  WRITE     HTMLFILE;PTARVAL1;
          GOTO      ATRFC999
.
ATRFC060  WRITE     HTMLFILE;PTARVAL2;
          GOTO      ATRFC999
.
ATRFC070  WRITE     HTMLFILE;PTARVAL3;
          GOTO      ATRFC999
.
ATRFC080  WRITE     HTMLFILE;PTARVAL4;
          GOTO      ATRFC999
.
ATRFC090  WRITE     HTMLFILE;PTARTXT1;
          GOTO      ATRFC999
.
ATRFC100  WRITE     HTMLFILE;PTARTXT2;
          GOTO      ATRFC999
.
ATRFC110  WRITE     HTMLFILE;PTARTXT3;
          GOTO      ATRFC999
.
ATRFC120  WRITE     HTMLFILE;PTARTXT4;
          GOTO      ATRFC999
.
ATRFC130  MATCH     SP70,PTARDATE
          GOTO      ATRFC999 IF EQUAL
          UNPACK    PTARDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ATRFC999
.
ATRFC140  WRITE     HTMLFILE;PTARTIME;
          GOTO      ATRFC999
.
ATRFC150  MOVE      "D6",CATEGORY
          MOVE      PTARCOD2,CODE
          CALL      CODITM00
          GOTO      ATRFC999
.
ATRFC160  UNPACK    PTARTXT2,TXTFST40,TXTLST40
          WRITE     HTMLFILE;TXTFST40;
          GOTO      ATRFC999
.
ATRFC170  UNPACK    PTARTXT2,TXTFST40,TXTLST40
          WRITE     HTMLFILE;TXTLST40;
          GOTO      ATRFC999
.
ATRFC999  RETURN

