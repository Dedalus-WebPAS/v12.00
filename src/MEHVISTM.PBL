.----------------------------------------------------------------------
. Program       : MEHVISTM
.
. Function      : Output Mental Health Visit Variables           
.
. Modifications :
.----------------------------------------------------------------------
.   V10.06.02 20/03/2015  Don Nguyen     CAR 306757
.             Modified MHVS5800 - read mehdlsaf instead of mehhlsaf
.   V10.06.01 16/03/2015  Don Nguyen     CAR 306757
.             Added MHVS5900 - Output Clinician Referring (Role)
.   V10.05.01 06/02/2015  Don Nguyen     CAR 306757
.             Added MHVS5800 - Legal Status (active) w/o end date
.   V10.03.01 22/02/2012  Peter Vela     CAR 260225
.             Added variables for delete mh admission
.   V10.02.03 08/09/2011  J.Tan          CAR 242151
.             Added External MH for WA
.   V10.02.02 23/06/2011  Peter Vela     CAR 239556
.             Added some more WA Mental Health variables
.   V10.02.01 05/05/2011  Peter Vela     CAR 239556
.             Added WA Mental Health variables
.   V9.04.01  13/10/2004  Jill Habasque  CAR 46397
.             Added mhcempst
.   V9.02.00  Jill Habasque  - Created
.   V9.02.01  10/12/2002     Peter Vela     - SRF 33833
.                            - Moved ZERO to cgi form variables in CLRMEH00
.----------------------------------------------------------------------
.
.
.------------------------------------------------------------
. Visit Details 
.------------------------------------------------------------
MHVS0000  BRANCH    FLDITMNO,MHVS0100,MHVS0200,MHVS0300,MHVS0400,MHVS0500:
                             MHVS0600,MHVS0700,MHVS0800,MHVS0900,MHVS1000:
                             MHVS1100,MHVS1200,MHVS1300,MHVS1400,MHVS1500:
                             MHVS1600,MHVS1700,MHVS1800,MHVS1900,MHVS2000:
                             MHVS2100,MHVS2200,MHVS2300,MHVS2400,MHVS2500:
                             MHVS2600,MHVS2700,MHVS2800,MHVS2900,MHVS3000:
                             MHVS3100,MHVS3200,MHVS3300,MHVS3400,MHVS3500:
                             MHVS3600,MHVS3700,MHVS3800,MHVS3900,MHVS4000:
                             MHVS4100,MHVS4200,MHVS4300,MHVS4400,MHVS4500:
                             MHVS4600,MHVS4700,MHVS4800,MHVS4900,MHVS5000:
                             MHVS5100,MHVS5200,MHVS5300,MHVS5400,MHVS5500:
                             MHVS5600,MHVS5700,MHVS5800,MHVS5900
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      MHVS9999
.
MHVS0100  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          WRITE     HTMLFILE;LINKPRG,".pbl?":
                             "&reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&urnumber=",URNUMBER:
                             "&admissno=",ADMISSNO;
          GOTO      MHVS9999
.
MHVS0200  WRITE     HTMLFILE;MHVIADMN;
          GOTO      MHVS9999
.
MHVS0300  WRITE     HTMLFILE;MHVISTAT; 
          GOTO      MHVS9999
.
MHVS0400  MATCH     MHVILSRV,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVILSRV,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS0500  WRITE     HTMLFILE;MHVITHER;
          GOTO      MHVS9999
.
MHVS0600  WRITE     HTMLFILE;MHVIADD1; 
          GOTO      MHVS9999
.
MHVS0700  WRITE     HTMLFILE;MHVIADD2;  
          GOTO      MHVS9999
.
MHVS0800  WRITE     HTMLFILE;MHVISUBR;  
          GOTO      MHVS9999
.
MHVS0900  WRITE     HTMLFILE;MHVIADD4;  
          GOTO      MHVS9999
.
MHVS1000  WRITE     HTMLFILE;MHVIPOST;  
          GOTO      MHVS9999
.
MHVS1100  WRITE     HTMLFILE;MHVISPR1;  
          GOTO      MHVS9999
.
MHVS1200  MOVE      "AY",CATEGORY
          PACK      CODE,MHVIACTY,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS1300  MATCH     MHVIRFDT,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVIRFDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS1400  MATCH     MHVIFCDT,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVIFCDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS1500  MATCH     MHVIRODT,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVIRODT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS1600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHVS1610
          WRITE     HTMLFILE;MHVIVISI;
          GOTO      MHVS9999
.
MHVS1610  COMPARE   ONE,MHVIVISI
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHVIVISI
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHVS9999
. 
MHVS1700  MOVE      "BY",CATEGORY
          PACK      CODE,MHVIBENE,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS1800  WRITE     HTMLFILE;MHVIBEPD;
          GOTO      MHVS9999
. 
MHVS1900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHVS1910
          WRITE     HTMLFILE;MHVIMXBE;
          GOTO      MHVS9999
.
MHVS1910  COMPARE   ONE,MHVIMXBE
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHVIMXBE
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          COMPARE   THREE,MHVIMXBE
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      MHVS9999
.
MHVS2000  MATCH     MHVIMXDT,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVIMXDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS2100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHVS2110
          WRITE     HTMLFILE;MHVISUPP;
          GOTO      MHVS9999
.
MHVS2110  COMPARE   ONE,MHVISUPP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHVISUPP
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHVS9999
.
MHVS2200  MOVE      "V1",CATEGORY 
          PACK      CODE,MHVIUSR1,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2300  MOVE      "V2",CATEGORY
          PACK      CODE,MHVIUSR2,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2400  MOVE      "V3",CATEGORY
          PACK      CODE,MHVIUSR3,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2500  MOVE      "V4",CATEGORY
          PACK      CODE,MHVIUSR4,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2600  MOVE      "V5",CATEGORY
          PACK      CODE,MHVIUSR5,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2700  MOVE      "TA",CATEGORY
          PACK      CODE,MHVIATYP,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2800  MOVE      "MH",CATEGORY
          PACK      CODE,MHVIMCAT,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS2900  MOVE      "PT",CATEGORY
          PACK      CODE,MHVIPSPS,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS3000  WRITE     HTMLFILE;MHVILAWR;
          GOTO      MHVS9999
. 
MHVS3100  MOVE      "OH",CATEGORY
          PACK      CODE,MHVIORDH,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS3200  MATCH     MHVICJAR,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVICJAR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS3300  MATCH     MHVIREDD,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVIREDD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS3400  MATCH     MHVIS76R,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHVIS76R,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS3500  MOVE      "LS",CATEGORY
          PACK      CODE,MHLESTAT,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS3600  MATCH     MHLEDATE,SP70
          GOTO      MHVS9999 IF EQUAL
          UNPACK    MHLEDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS3700  MOVE      "CJ",CATEGORY
          PACK      CODE,MHCJSTAT,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS3800  WRITE     HTMLFILE;MHLETIME;
          GOTO      MHVS9999
.
MHVS3900  WRITE     HTMLFILE;NEWLEGFL;
          GOTO      MHVS9999
.
MHVS4000  READ      CONTROLF,SIXTY9;*84,MHCEMPST
          PACK      CATEGORY,MHCEMPST,SP70
          UNPACK    MHCEMPST,DIM1,DIM1A
          MOVE      DIM1A,F1
          LOAD      CODE,F1,MHVIUSR1,MHVIUSR2,MHVIUSR3,MHVIUSR4,MHVIUSR5
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS4100  READ      CONTROLF,HUND05;*208,PTCNSORP
          PACK      CATEGORY,PTCNSORP,SP70
          UNPACK    PTCNSORP,DIM1,DIM1A
          MOVE      DIM1A,F1
          LOAD      CODE,F1,AUSR2,AUSR2,AUSR3,AUSR4,AUSR5,AUSR6,AUSR7:
                            PTMIUSR8,PTMIUSR9,PTMIUSR0
          MATCH     "U0",PTCNSORP
          IF        @EQUAL
            PACK      CODE,PTMIUSR0
          ENDIF
.
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS4200  READ      CONTROLF,HUND05;*206,PTCNFPST
          PACK      CATEGORY,PTCNFPST,SP70
          UNPACK    PTCNFPST,DIM1,DIM1A
          MOVE      DIM1A,F1
          SUB       FOUR,F1      
          LOAD      CODE,F1,MHDSUSR1,MHDSUSR2,MHDSUSR3,MHDSUSR4:
                        MHDSUSR5
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS4300  WRITE     HTMLFILE;MHVIROTM; 
          GOTO      MHVS9999
.
MHVS4400  MATCH     MHVIPDDT,SP70
          GOTO      MHVS9999 IF EQUAL
          GOTO      MHVS9999 IF EOS
          UNPACK    MHVIPDDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS4500  WRITE     HTMLFILE;MHVIPDTM;
          GOTO      MHVS9999
.
MHVS4600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHVS4610
          PACK      KEY10,MHVICSMN,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,MHVS9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      MHVS9999
.
MHVS4610  WRITE     HTMLFILE;MHVICSMN;
          GOTO      MHVS9999
.
MHVS4700  WRITE     HTMLFILE;MHVIPYCL;
          GOTO      MHVS9999
.
MHVS4800  MOVE      "TO",CATEGORY
          PACK      CODE,MHVITROR,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS4900  WRITE     HTMLFILE;MHVIPDGV;
          GOTO      MHVS9999
.
MHVS5000  MOVE      "AY",CATEGORY
          PACK      CODE,MHVIACDE,SP70
          CALL      CODITM00
          GOTO      MHVS9999
.
MHVS5100  WRITE     HTMLFILE;MHVIRMHA;
          GOTO      MHVS9999
.
MHVS5200  MOVE      "rm",CATEGORY
          PACK      CODE,MHVIRMHC,SP70
          CALL      CODITM00
          GOTO      MHVS9999 
.
MHVS5300  WRITE     HTMLFILE;MHVIRFTM;
          GOTO      MHVS9999
.
MHVS5400  MATCH     MHVIAMDT,SP70
          GOTO      MHVS9999 IF EQUAL
          GOTO      MHVS9999 IF EOS
          UNPACK    MHVIAMDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHVS9999
.
MHVS5500  WRITE     HTMLFILE;MHVIAMTM;
          GOTO      MHVS9999
.
MHVS5600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHVS5610,MHVS5620
.
          OPEN      PATEORA1,"pateoraf"
          PACK      KEY7,ANSA,MHVIMHOR,SP70
          CALL      RDPTEOR1
          BRANCH    OVRCD,MHVS9999
          WRITE     HTMLFILE;PTERNAME;
          GOTO      MHVS9999
.
MHVS5610  WRITE     HTMLFILE;MHVIMHOR;
          GOTO      MHVS9999
.
MHVS5620  OPEN      PATEORA1,"pateoraf"
          PACK      KEY7,ANSA,SP70
          CALL      RSPTEOR1
MHVS5630  CALL      RKPTEOR1
          BRANCH    OVRCD,MHVS9999
.
          MATCH     ANSA,PTERTYPE             * selected Organisation?
          GOTO      MHVS9999 IF NOT EQUAL
.
          MATCH     PTERCODE,MHVIMHOR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",PTERCODE,"#" selected> ":
                               PTERCODE,": ",PTERNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTERCODE,"#"> ":
                               PTERCODE,": ",PTERNAME,"</option>"
          ENDIF
          GOTO      MHVS5630
.
MHVS5700  MATCH     "1",MHVIRMHA
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHVS9999
.
MHVS5800  PACK      KEY16,URNUMBER,Z70
          CALL      RSMHDLS1
MHVS5810  CALL      RPMHDLS1
          BRANCH    OVRCD,MHVS5890
.
          MATCH     URNUMBER,MHDLURNO
          GOTO      MHVS5890 IF NOT EQUAL
.
          MATCH     "1",MHDLACTV            * Inactive?
          GOTO      MHVS5810 IF EQUAL       * yes, ignore
.
          MATCH     MHDLEDAT,SP70           * No End Date?
          GOTO      MHVS5891 IF EQUAL       * yes, output 1
.
          GOTO      MHVS5810
.
MHVS5890  WRITE     HTMLFILE;ZERO;
          GOTO      MHVS9999
.
MHVS5891  WRITE     HTMLFILE;ONE;
          GOTO      MHVS9999
.
MHVS5900  WRITE     HTMLFILE;MHVIRMHC;
          GOTO      MHVS9999
.
MHVS9999  RETURN
+
.------------------------------------------------------------
. Clear cgi variables
.------------------------------------------------------------
CLRMEH00  MOVE      Z70,MEHVS001
          MOVE      Z70,MEHVS002
          MOVE      Z70,MEHVS003
          MOVE      Z70,MEHVS004
          MOVE      Z70,MEHVS005
          MOVE      Z70,MEHVS006
          MOVE      Z70,MEHVS007
          MOVE      Z70,MEHVS008
          MOVE      Z70,MEHVS009
          MOVE      Z70,MEHVS010
          MOVE      Z70,MEHVS011
          MOVE      Z70,MEHVS012
          MOVE      Z70,MEHVS013
          MOVE      Z70,MEHVS014
          MOVE      ZERO,MEHVS015
          MOVE      Z70,MEHVS016
          MOVE      Z70,MEHVS017
          MOVE      ZERO,MEHVS018
          MOVE      Z70,MEHVS019
          MOVE      ZERO,MEHVS020
          MOVE      Z70,MEHVS021
          MOVE      Z70,MEHVS022
          MOVE      Z70,MEHVS023
          MOVE      Z70,MEHVS024
          MOVE      Z70,MEHVS025
          MOVE      Z70,MEHVS026
          MOVE      Z70,MEHVS027
          MOVE      Z70,MEHVS028
          MOVE      Z70,MEHVS029
          MOVE      Z70,MEHVS030
          MOVE      Z70,MEHVS031
          MOVE      Z70,MEHVS032
          MOVE      Z70,MEHVS033
          MOVE      Z70,MEHVS034
          MOVE      Z70,MEHVS035
          MOVE      Z70,MEHVS036
          MOVE      Z70,MEHVS037
          MOVE      Z70,MEHVS038
          MOVE      Z70,MEHVS039
          MOVE      Z70,MEHVS040
          MOVE      Z70,MEHVS041
          MOVE      Z70,MEHVS042
          MOVE      Z70,MEHVS043
          MOVE      Z70,MEHVS044
          MOVE      Z70,MEHVS045
          MOVE      Z70,MEHVS046
          MOVE      Z70,MEHVS047
          MOVE      Z70,MEHVS048
          MOVE      Z70,MEHVS049
          MOVE      Z70,MEHVS050
          MOVE      Z70,MEHVS051
          MOVE      Z70,MEHVS052
          MOVE      Z70,MEHVS053
          MOVE      Z70,MEHVS054
.
CLRMEH99  RETURN
+
.------------------------------------------------------------
.   Set Parameters for mental health  visit table
.------------------------------------------------------------
SETMHF00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
.
          BRANCH    F3,SETMHF01,SETMHF02,SETMHF03,SETMHF04,SETMHF05:
                       SETMHF06,SETMHF07,SETMHF08,SETMHF09,SETMHF10:
                       SETMHF11,SETMHF12,SETMHF13,SETMHF14,SETMHF15:
                       SETMHF16,SETMHF17,SETMHF18,SETMHF19,SETMHF20:
                       SETMHF21,SETMHF22,SETMHF23,SETMHF24,SETMHF25:
                       SETMHF26,SETMHF27,SETMHF28,SETMHF29,SETMHF30:
                       SETMHF31,SETMHF32,SETMHF33,SETMHF34,SETMHF35:
                       SETMHF36,SETMHF37,SETMHF38,SETMHF39,SETMHF40:
                       SETMHF41,SETMHF42,SETMHF43,SETMHF44,SETMHF45:
                       SETMHF46,SETMHF47,SETMHF48,SETMHF49,SETMHF50:
                       SETMHF51,SETMHF52,SETMHF53,SETMHF54
.
          MOVE      ONE,EXIT
          GOTO      SETMHF99
.
SETMHF01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,MEHVS001
          PACK      MEHVS001,MEHVS001,SP70
          GOTO      SETMHF99
.
SETMHF02  MOVE      QRYDATA,MEHVS002
          GOTO      SETMHF99
.
SETMHF03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS003,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF04  MOVE      QRYDATA,MEHVS004
          GOTO      SETMHF99
.
SETMHF05  MOVE      QRYDATA,MEHVS005
          GOTO      SETMHF99
.
SETMHF06  MOVE      QRYDATA,MEHVS006
          GOTO      SETMHF99
.
SETMHF07  MOVE      QRYDATA,MEHVS007
          GOTO      SETMHF99
.
SETMHF08  MOVE      QRYDATA,MEHVS008
          GOTO      SETMHF99
.
SETMHF09  MOVE      QRYDATA,MEHVS009
          GOTO      SETMHF99
.
SETMHF10  MOVE      QRYDATA,MEHVS010
          GOTO      SETMHF99
.
SETMHF11  MOVE      QRYDATA,MEHVS011
          GOTO      SETMHF99
.
SETMHF12  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS012,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF13  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS013,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF14  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS014,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF15  MOVE      QRYDATA,MEHVS015
          GOTO      SETMHF99
.
SETMHF16  MOVE      QRYDATA,MEHVS016
          GOTO      SETMHF99
.
SETMHF17  MOVE      QRYDATA,MEHVS017
          GOTO      SETMHF99
.
SETMHF18  MOVE      QRYDATA,MEHVS018
          GOTO      SETMHF99
.
SETMHF19  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS019,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF20  MOVE      QRYDATA,MEHVS020
          GOTO      SETMHF99
.
SETMHF21  MOVE      QRYDATA,MEHVS021
          GOTO      SETMHF99
.
SETMHF22  MOVE      QRYDATA,MEHVS022
          GOTO      SETMHF99
.
SETMHF23  MOVE      QRYDATA,MEHVS023
          GOTO      SETMHF99
.
SETMHF24  MOVE      QRYDATA,MEHVS024
          GOTO      SETMHF99
.
SETMHF25  MOVE      QRYDATA,MEHVS025
          GOTO      SETMHF99
.
SETMHF26  MOVE      QRYDATA,MEHVS026
          GOTO      SETMHF99
.
SETMHF27  MOVE      QRYDATA,MEHVS027
          GOTO      SETMHF99
.
SETMHF28  MOVE      QRYDATA,MEHVS028
          GOTO      SETMHF99
.
SETMHF29  MOVE      QRYDATA,MEHVS029
          GOTO      SETMHF99
.
SETMHF30  MOVE      QRYDATA,MEHVS030
          GOTO      SETMHF99
.
SETMHF31  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS031,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF32  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS032,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF33  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS033,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF34  MOVE      QRYDATA,MEHVS034
          GOTO      SETMHF99
.
SETMHF35  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS035,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF36  MOVE      QRYDATA,MEHVS036
          GOTO      SETMHF99
.
SETMHF37  MOVE      QRYDATA,MEHVS037
          GOTO      SETMHF99
.
SETMHF38  MOVE      QRYDATA,MEHVS038
          GOTO      SETMHF99
.
SETMHF39  MOVE      QRYDATA,MEHVS039
          GOTO      SETMHF99
.
SETMHF40  MOVE      QRYDATA,MEHVS040
          GOTO      SETMHF99
.
SETMHF41  MOVE      QRYDATA,MEHVS041
          GOTO      SETMHF99
.
SETMHF42  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS042,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF43  MOVE      QRYDATA,MEHVS043
          GOTO      SETMHF99
.
SETMHF44  MOVE      QRYDATA,MEHVS044
          GOTO      SETMHF99
.
SETMHF45  MOVE      QRYDATA,MEHVS045
          GOTO      SETMHF99
.
SETMHF46  MOVE      QRYDATA,MEHVS046
          GOTO      SETMHF99
.
SETMHF47  MOVE      QRYDATA,MEHVS047
          GOTO      SETMHF99
.
SETMHF48  MOVE      QRYDATA,MEHVS048
          GOTO      SETMHF99
.
SETMHF49  MOVE      QRYDATA,MEHVS049
          GOTO      SETMHF99
.
SETMHF50  MOVE      QRYDATA,MEHVS050
          GOTO      SETMHF99
.
SETMHF51  MOVE      QRYDATA,MEHVS051
          GOTO      SETMHF99
.
SETMHF52  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHVS052,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMHF99
.
SETMHF53  MOVE      QRYDATA,MEHVS053
          GOTO      SETMHF99
.
SETMHF54  MOVE      QRYDATA,MEHVS054
          GOTO      SETMHF99
.
SETMHF99  RETURN

.------------------------------------------------------------
.   Move cgi's into file variables               
.------------------------------------------------------------
.
MVMEH000  MATCH     Z70,MEHVS003
          IF        !@EQUAL
            MOVE      MEHVS003,MHVILSRV
          ENDIF
.
          MATCH     Z70,MEHVS004
          IF        !@EQUAL
            MOVE      MEHVS004,MHVITHER
          ENDIF
.
          MATCH     Z70,MEHVS005
          IF        !@EQUAL
            MOVE      MEHVS005,MHVIADD1
          ENDIF
.
          MATCH     Z70,MEHVS006
          IF        !@EQUAL
            MOVE      MEHVS006,MHVIADD2
          ENDIF
.
          MATCH     Z70,MEHVS007
          IF        !@EQUAL
            MOVE      MEHVS007,MHVISUBR
          ENDIF
.
          MATCH     Z70,MEHVS008
          IF        !@EQUAL
            MOVE      MEHVS008,MHVIADD4
          ENDIF
.
          MATCH     Z70,MEHVS009
          IF        !@EQUAL
            MOVE      MEHVS009,MHVIPOST
          ENDIF
.
          MATCH     Z70,MEHVS010
          IF        !@EQUAL
            MOVE      MEHVS010,MHVISPR1
          ENDIF
.
          MATCH     Z70,MEHVS011
          IF        !@EQUAL
            MOVE      MEHVS011,MHVIACTY
          ENDIF
.
          MATCH     Z70,MEHVS012
          IF        !@EQUAL
            MOVE      MEHVS012,MHVIRFDT
          ENDIF
.
          MATCH     Z70,MEHVS013
          IF        !@EQUAL
            MOVE      MEHVS013,MHVIFCDT
          ENDIF
.
          MATCH     Z70,MEHVS014
          IF        !@EQUAL
            MOVE      MEHVS014,MHVIRODT
          ENDIF
.
          COMPARE   ZERO,MEHVS015
          IF        !@EQUAL
            MOVE      MEHVS015,MHVIVISI
          ENDIF
.
          MATCH     Z70,MEHVS016
          IF        !@EQUAL
            MOVE      MEHVS016,MHVIBENE
          ENDIF
.
          MATCH     Z70,MEHVS017
          IF        !@EQUAL
            MOVE      MEHVS017,MHVIBEPD
          ENDIF
.
          COMPARE   ZERO,MEHVS018
          IF        !@EQUAL
            MOVE      MEHVS018,MHVIMXBE
          ENDIF
.
          MATCH     Z70,MEHVS019
          IF        !@EQUAL
            MOVE      MEHVS019,MHVIMXDT
          ENDIF
.
          COMPARE   ZERO,MEHVS020
          IF        !@EQUAL
            MOVE      MEHVS020,MHVISUPP
          ENDIF
.
          MATCH     Z70,MEHVS021
          IF        !@EQUAL
            MOVE      MEHVS021,MHVIUSR1
          ENDIF
.
          MATCH     Z70,MEHVS022
          IF        !@EQUAL
            MOVE      MEHVS022,MHVIUSR2
          ENDIF
.
          MATCH     Z70,MEHVS023
          IF        !@EQUAL
            MOVE      MEHVS023,MHVIUSR3
          ENDIF
.
          MATCH     Z70,MEHVS024
          IF        !@EQUAL
            MOVE      MEHVS024,MHVIUSR4
          ENDIF
.
          MATCH     Z70,MEHVS025
          IF        !@EQUAL
            MOVE      MEHVS025,MHVIUSR5
          ENDIF
.
          MATCH     Z70,MEHVS026
          IF        !@EQUAL
            MOVE      MEHVS026,MHVIATYP
          ENDIF
.
          MATCH     Z70,MEHVS027
          IF        !@EQUAL
            MOVE      MEHVS027,MHVIMCAT
          ENDIF
.
          MATCH     Z70,MEHVS028
          IF        !@EQUAL
            MOVE      MEHVS028,MHVIPSPS
          ENDIF
.
          MATCH     Z70,MEHVS029
          IF        !@EQUAL
            MOVE      MEHVS029,MHVILAWR
          ENDIF
.
          MATCH     Z70,MEHVS030
          IF        !@EQUAL
            MOVE      MEHVS030,MHVIORDH
          ENDIF
.
          MATCH     Z70,MEHVS031
          IF        !@EQUAL
            MOVE      MEHVS031,MHVICJAR
          ENDIF
.
          MATCH     Z70,MEHVS032
          IF        !@EQUAL
            MOVE      MEHVS032,MHVIREDD
          ENDIF
.
          MATCH     Z70,MEHVS033
          IF        !@EQUAL
            MOVE      MEHVS033,MHVIS76R
          ENDIF
.
          MATCH     Z70,MEHVS034
          IF        !@EQUAL
            MOVE      MEHVS034,MHLESTAT
          ENDIF
.
          MATCH     Z70,MEHVS035
          IF        !@EQUAL
            MOVE      MEHVS035,MHLEDATE
          ENDIF
.
          MATCH     Z70,MEHVS036
          IF        !@EQUAL
            MOVE      MEHVS036,MHCJSTAT
          ENDIF
.
          MATCH     Z70,MEHVS037
          IF        !@EQUAL
            MOVE      MEHVS037,MHLETIME
          ENDIF
.
          MATCH     Z70,MEHVS038
          IF        !@EQUAL
            READ      CONTROLF,SIXTY9;*84,MHCEMPST
            UNPACK    MHCEMPST,DIM1,DIM1A
            MOVE      DIM1A,F1
            STORE     MEHVS038,F1,MHVIUSR1,MHVIUSR2,MHVIUSR3,MHVIUSR4:
                                        MHVIUSR5
          ENDIF
.
          MATCH     Z70,MEHVS039
          IF        !@EQUAL
            READ      CONTROLF,HUND05;*208,PTCNSORP
            UNPACK    PTCNSORP,DIM1,DIM1A
            MOVE      DIM1A,F1
            STORE     MEHVS039,F1,AUSR1,AUSR2,AUSR3,AUSR4,AUSR5,AUSR6:
                                  AUSR7,PTMIUSR8,PTMIUSR9
            MATCH     "0",DIM1A
            IF        !@EQUAL
              PACK      PTMIUSR0,MEHVS039
            ENDIF
          ENDIF
.
          MATCH     Z70,MEHVS040
          IF        !@EQUAL
            READ      CONTROLF,HUND05;*206,PTCNFPST
            UNPACK    PTCNFPST,DIM1,DIM1A
            MOVE      DIM1A,F1
            SUB       FOUR,F1
            STORE     MEHVS040,F1,MHDSUSR1,MHDSUSR2,MHDSUSR3,MHDSUSR4:
                                  MHDSUSR5
          ENDIF
.
          MATCH     Z70,MEHVS041
          IF        !@EQUAL
            MOVE      MEHVS041,MHVIROTM
          ENDIF
.
          MATCH     Z70,MEHVS042
          IF        !@EQUAL
            MOVE      MEHVS042,MHVIPDDT
          ENDIF
.
          MATCH     Z70,MEHVS043
          IF        !@EQUAL
            MOVE      MEHVS043,MHVIPDTM
          ENDIF
.
          MATCH    Z70,MEHVS044
          IF        !@EQUAL
            MOVE      MEHVS044,MHVICSMN
          ENDIF
.
          MATCH     Z70,MEHVS045
          IF        !@EQUAL
            MOVE      MEHVS045,MHVIPYCL
          ENDIF
.
          MATCH     Z70,MEHVS046
          IF        !@EQUAL
            MOVE      MEHVS046,MHVITROR
          ENDIF
.
          MATCH     Z70,MEHVS047
          IF        !@EQUAL
            MOVE      MEHVS047,MHVIPDGV
          ENDIF
.
          MATCH     Z70,MEHVS048
          IF        !@EQUAL
            MOVE      MEHVS048,MHVIACDE
          ENDIF
.
          MATCH     Z70,MEHVS049
          IF        !@EQUAL
            MOVE      MEHVS049,MHVIRMHA
          ENDIF
.
          MATCH     Z70,MEHVS050
          IF        !@EQUAL
            MOVE      MEHVS050,MHVIRMHC
          ENDIF
.
          MATCH     Z70,MEHVS051
          IF        !@EQUAL
            MOVE      MEHVS051,MHVIRFTM
          ENDIF
.
          MATCH     Z70,MEHVS052
          IF        !@EQUAL
            MOVE      MEHVS052,MHVIAMDT
          ENDIF
.
          MATCH     Z70,MEHVS053
          IF        !@EQUAL
            MOVE      MEHVS053,MHVIAMTM
          ENDIF
.
          MATCH     Z70,MEHVS054
          IF        !@EQUAL
            MOVE      MEHVS054,MHVIMHOR
          ENDIF
.
          RETURN
.

