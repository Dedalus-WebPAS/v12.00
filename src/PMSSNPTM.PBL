. *-----------------------------------------------------------------------------
. * Include Name  :  PMSSNPTM.PBL
. *
. * Function      :  CGI Variables for PMSSNPFD - pmssnpaf
. *
. * Modifications :                                                       
. * V10.08.01 29/03/2018 Peter Vela        CAR 0813961
. *           Changed pmsnp001 to DIM
. * V10.06.02 10/06/2015 Patrick Adair     CAR 290369
. *           Completed changes for PMSNHDPE, PMSNHCPE & PMSNANSE
. * V10.06.01 20/04/2015 Steve Armstrong   CAR 290369
. *           Added PMSNHDPE, PMSNHCPE & PMSNANSE to CLPMSN00
. * V10.03.00 05/03/2012 Patrick Adair     CAR 257776
. *           Created include
. *-----------------------------------------------------------------------------
.-------------------------------------------------------------------------------
. Clear Classification Code Parameters
.-------------------------------------------------------------------------------
CPPMSN00  MOVE      Z70,PMSNP001
          MOVE      Z70,PMSNP002
          MOVE      Z70,PMSNP003
          MOVE      Z70,PMSNP004
          MOVE      Z70,PMSNP005
          MOVE      Z70,PMSNP006
          MOVE      Z70,PMSNP007
          MOVE      Z70,PMSNP014
          MOVE      Z70,PMSNP015
          MOVE      Z70,PMSNP016
.
CPPMSN99  RETURN
.
.-------------------------------------------------------------------------------
. Set Classification Code Parameters
.-------------------------------------------------------------------------------
SPPMSN00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMSN01,SPPMSN02,SPPMSN03,SPPMSN04,SPPMSN05:
                       SPPMSN06,SPPMSN07,SPPMSN99,SPPMSN99,SPPMSN99:
                       SPPMSN99,SPPMSN99,SPPMSN99,SPPMSN14,SPPMSN15:
                       SPPMSN16 
          GOTO      SPPMSN99
.
SPPMSN01  PACK      PMSNP001,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN02  PACK      PMSNP002,QRYDATA,SP70
          RJUSTIFY  PMSNP002
          GOTO      SPPMSN99
.
SPPMSN03  PACK      PMSNP003,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN04  PACK      PMSNP004,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN05  PACK      PMSNP005,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN06  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSNP006,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMSN99
.
SPPMSN07  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSNP007,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMSN99
.
SPPMSN14  PACK      PMSNP014,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN15  PACK      PMSNP015,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN16  PACK      PMSNP016,QRYDATA,SP70
          GOTO      SPPMSN99
.
SPPMSN99  RETURN
.
.-------------------------------------------------------------------------------
. Output Classification Code tags
.-------------------------------------------------------------------------------
PMSN0000  BRANCH    FLDITMNO,PMSN0100,PMSN0200,PMSN0300,PMSN0400,PMSN0500:
                             PMSN0600,PMSN0700,PMSN0800,PMSN0900,PMSN1000:
                             PMSN1100,PMSN1200,PMSN1300,PMSN1400,PMSN1500:
                             PMSN1600
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMSN9999
.
PMSN0100  WRITE     HTMLFILE;PMSNCLCD;
          GOTO      PMSN9999
.
PMSN0200  WRITE     HTMLFILE;PMSNVERS;
          GOTO      PMSN9999
.
PMSN0300  WRITE     HTMLFILE;PMSNDESC;
          GOTO      PMSN9999
.
PMSN0400  WRITE     HTMLFILE;PMSNETYP;
          GOTO      PMSN9999
.
PMSN0500  WRITE     HTMLFILE;PMSNACTV;
          GOTO      PMSN9999
.
PMSN0600  MATCH     PMSNDACT,SP70
          GOTO      PMSN9999 IF EQUAL
          UNPACK    PMSNDACT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMSN9999
.
PMSN0700  MATCH     PMSNDIAC,SP70
          GOTO      PMSN9999 IF EQUAL
          UNPACK    PMSNDIAC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDIAC,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDIAC;
          GOTO      PMSN9999
.
PMSN0800  WRITE     HTMLFILE;PMSNCUID;
          GOTO      PMSN9999
.
PMSN0900  MATCH     PMSNCDAT,SP70
          GOTO      PMSN9999 IF EQUAL
          UNPACK    PMSNCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPCDAT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPCDAT;
          GOTO      PMSN9999
.
PMSN1000  WRITE     HTMLFILE;PMSNCTIM;
          GOTO      PMSN9999
.
PMSN1100  WRITE     HTMLFILE;PMSNUUID;
          GOTO      PMSN9999
.
PMSN1200  MATCH     PMSNUDAT,SP70
          GOTO      PMSN9999 IF EQUAL
          UNPACK    PMSNUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPUDAT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPUDAT;
          GOTO      PMSN9999
.
PMSN1300  WRITE     HTMLFILE;PMSNUTIM;
          GOTO      PMSN9999
.
PMSN1400  WRITE     HTMLFILE;PMSNHDPE;
          GOTO      PMSN9999
.
PMSN1500  WRITE     HTMLFILE;PMSNHCPE;
          GOTO      PMSN9999
.
PMSN1600  WRITE     HTMLFILE;PMSNANSE;
          GOTO      PMSN9999
.
PMSN9999  RETURN
.
.-------------------------------------------------------------------------------
. Move Classification Code cgi variables to file variables
.-------------------------------------------------------------------------------
MVPMSN00  MATCH     Z70,PMSNP001
          IF        !@EQUAL
            MOVE      PMSNP001,PMSNCLCD
          ENDIF
.
          MATCH     Z70,PMSNP002
          IF        !@EQUAL
            SQUEEZE   PMSNP002
            MOVE      PMSNP002,VERSFRM2
            MOVE      VERSFRM2,PMSNVERS
          ENDIF
.
          MATCH     Z70,PMSNP003
          IF        !@EQUAL
            MOVE      PMSNP003,PMSNDESC
          ENDIF
.
          MATCH     Z70,PMSNP004
          IF        !@EQUAL
            MOVE      PMSNP004,PMSNETYP
          ENDIF
.
          MATCH     Z70,PMSNP005
          IF        !@EQUAL
            MOVE      PMSNP005,PMSNACTV
          ENDIF
.
          MATCH     Z70,PMSNP006
          IF        !@EQUAL
            MOVE      PMSNP006,PMSNDACT
          ENDIF
.
          MATCH     Z70,PMSNP007
          IF        !@EQUAL
            MOVE      PMSNP007,PMSNDIAC
          ENDIF
.
          MATCH     Z70,PMSNP014
          IF        !@EQUAL
            MOVE      PMSNP014,PMSNHDPE
          ENDIF
.
          MATCH     Z70,PMSNP015
          IF        !@EQUAL
            MOVE      PMSNP015,PMSNHCPE
          ENDIF
.
          MATCH     Z70,PMSNP016
          IF        !@EQUAL
            MOVE      PMSNP016,PMSNANSE
          ENDIF
.
MVPMSN99  RETURN
.
.-------------------------------------------------------------------------------
. Clear Classification Code file variables
.-------------------------------------------------------------------------------
CLPMSN00  MOVE      SP70,PMSNCLCD
          MOVE      SP70,PMSNVERS
          MOVE      SP70,PMSNDESC
          MOVE      SP70,PMSNETYP
          MOVE      SP70,PMSNACTV
          MOVE      SP70,PMSNDACT
          MOVE      SP70,PMSNDIAC
          MOVE      SP70,PMSNCUID
          MOVE      SP70,PMSNCDAT
          MOVE      SP70,PMSNCTIM
          MOVE      SP70,PMSNUUID
          MOVE      SP70,PMSNUDAT
          MOVE      SP70,PMSNUTIM
          MOVE      SP70,PMSNHDPE
          MOVE      SP70,PMSNHCPE
          MOVE      SP70,PMSNANSE
          MOVE      SP70,PMSNSPAR
.
CLPMSN99  RETURN
