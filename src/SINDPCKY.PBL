.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINDPCKY
.   Routine   :   HSIDPA00 Delivery Point      
.   Return    :           
.-------------------------------------------------------------------------------
HSIDPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "25",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIDPA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIDPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Delive"             
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"ry Point"           
.
          MOVE      STDCOL02,STDCOL03
          ADD       "40",STDCOL03
HSIDPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIDPCODE
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
          CALL      RSSIDP1 
HSIDPA10
          CALL      RKSIDP1 
          BRANCH    OVRCD,HSIDPA15
          PACK      KEY3,SIDPCODE,SP70                                          .
          MATCH     "IBASIN55",PRGID
          IF        !@EQUAL
            MATCH     "1",SIDPACTV
            GOTO      HSIDPA10 IF NOT EQUAL
          ENDIF
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSIDPA12
          CALL      HSIDPA60
          BRANCH    OVRCD,HSIDPA10
HSIDPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIDPCODE
          DISPLAY   *PSTDCOL02:STDROW,SIDPADD1
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIDPA10 IF NOT EQUAL
HSIDPA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIDPA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIDPA30,HSIDPA35,HSIDPA40,HSIDPA45,HSIDPA04:
                              HSIDPA91,HSIDPA50
          GOTO      HSIDPA92
HSIDPA30
          CALL      RKSIDP1 
          BRANCH    OVRCD,HSIDPA85
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
          CALL      RPSIDP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIDPA10
HSIDPA35
          MOVE      ST1,KEY3 
          CALL      RDSIDP1 
          CALL      RPSIDP1 
          BRANCH    OVRCD,HSIDPA85
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIDPA36
          CALL      RPSIDP1 
          BRANCH    OVRCD,HSIDPA37
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIDPA36 IF NOT EQUAL
HSIDPA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIDPA10
HSIDPA40
          MOVE      ST1,KEY3 
          CALL      RDSIDP1 
          CALL      RPSIDP1 
          BRANCH    OVRCD,HSIDPA85
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIDPA08
HSIDPA45
          CALL      RKSIDP1 
          BRANCH    OVRCD,HSIDPA85
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIDP1 
HSIDPA46
          CALL      RPSIDP1 
          BRANCH    OVRCD,HSIDPA47
          PACK      KEY3,SIDPCODE,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIDPA46 IF NOT EQUAL
HSIDPA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIDPA10
HSIDPA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIDPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIDPA08
HSIDPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIDPA08
HSIDPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIDPA61 IF EQUAL
          MATCH     SCHFLD01,SIDPCODE
          GOTO      HSIDPA72 IF NOT EQUAL
HSIDPA61
          MATCH     SP70,SCHFLD02
          GOTO      HSIDPA62 IF EQUAL
          MATCH     SCHFLD02,SIDPADD1
          GOTO      HSIDPA72 IF NOT EQUAL
HSIDPA62
HSIDPA63
HSIDPA64
HSIDPA65
HSIDPA66
HSIDPA67
HSIDPA68
HSIDPA69
HSIDPA70
          GOTO      HSIDPA75
HSIDPA72  MOVE      ONE,OVRCD
HSIDPA75  RETURN
HSIDPA85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,SIDPCODE                                               
          CALL      RDSIDP1 
HSIDPA90
.                                                                               
          BEEP
          GOTO      HSIDPA20
HSIDPA91
          MOVE      SP70,SIDPADD1
          MOVE      SP70,SIDPADD2
          MOVE      SP70,SIDPACTV
          MOVE      SP70,SIDPSPAR
          MOVE      SP70,KEY3 
          MOVE      SP70,SIDPCODE
          GOTO      HSIDPA96
HSIDPA92
          MOVE      SP70,KEY3 
          MOVE      SP70,SIDPCODE
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,SIDPCODE                                               
HSIDPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIDPA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINDPCKY
.   Routine   :   KSIDPA00 Keyin Delivery Point      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIDPA00 TOPIC     "SIDPCODE"
          MOVE      UNDLN70,SIDPCODE
          KEYIN     *PCCOL:CVERT,*DV,SIDPCODE:                                  
                    *PCCOL:CVERT,*V2LON,SIDPCODE:                               
                    *PCCOL:CVERT,*DV,SIDPCODE
.
          ENDSET    SIDPCODE
          APPEND    SP70,SIDPCODE
          RESET     SIDPCODE
.
          MATCH     SP70,SIDPCODE
          GOTO      KSIDPA90 IF EQUAL
.
          CMATCH    EXITCHAR,SIDPCODE
          GOTO      KSIDPA95 IF EQUAL
.
          CMATCH    QUEST,SIDPCODE
          GOTO      KSIDPA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSIDPA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIDPCODE
          APPEND    SP70,SIDPCODE
          RESET     SIDPCODE
.
          MATCH     SP70,SIDPCODE
          GOTO      KSIDPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIDPCODE                                
KSIDPA10
          PACK      KEY3,SIDPCODE                                               
          CALL      RASIDP1 
          BRANCH    OVRCD,KSIDPA80
          BRANCH    CKEYTYP,KSIDPA75
          CALL      RDSIDP1 
KSIDPA70
          MOVE      ZERO,EXIT
          GOTO      KSIDPA99
KSIDPA75
          MOVE      "Delivery Point Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KSIDPA00
KSIDPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIDPA99,KSIDPA99
          MOVE      "Delivery Point Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KSIDPA00
KSIDPA90
          MOVE      ONE,EXIT
          GOTO      KSIDPA99
KSIDPA95
          MOVE      TWO,EXIT
KSIDPA99 TOPIC    PRGID
          RETURN
