. *----------------------------------------------------------------------
. * Include Name  :   PMSPCTTM.PBL
. *
. * Function      :   CGI variables for PMSPCTFD - pmspctaf
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.00.00  07/07/2010  Jill Parkinson CAR 222551
.             Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for pregnancy complications table
.------------------------------------------------------------------------
CPPMPC00  MOVE      Z70,PMPCT001
          MOVE      Z70,PMPCT002
          MOVE      Z70,PMPCT003
          MOVE      Z70,PMPCT004
          MOVE      Z70,PMPCT005
          MOVE      Z70,PMPCT006
          MOVE      Z70,PMPCT007
          MOVE      Z70,PMPCT008
          MOVE      Z70,PMPCT009
.
CPPMPC99  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Pregnancy Details table
.------------------------------------------------------------
SPMPC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMPC001,SPMPC002,SPMPC003,SPMPC004,SPMPC005:
                       SPMPC006,SPMPC007,SPMPC008,SPMPC009
.
          MOVE      ONE,EXIT
          GOTO      SPMPC999
.
SPMPC001  PACK      PMPCT001,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC002  PACK      PMPCT002,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC003  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMPCT003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMPC999
.
SPMPC004  PACK      PMPCT004,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC005  PACK      PMPCT005,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC006  PACK      PMPCT006,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC007  PACK      PMPCT007,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC008  PACK      PMPCT008,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC009  PACK      PMPCT009,QRYDATA,SP70
          GOTO      SPMPC999
.
SPMPC999 RETURN
+
.------------------------------------------------------------
. Output pregnancy complication details
.------------------------------------------------------------
PMPC0000  BRANCH    FLDITMNO,PMPC0010,PMPC0020,PMPC0030,PMPC0040,PMPC0050:
                             PMPC0060,PMPC0070,PMPC0080,PMPC0090,PMPC0100:
                             PMPC0110,PMPC0120,PMPC0130,PMPC0140,PMPC0150:
                             PMPC0160,PMPC0170,PMPC0180,PMPC0190,PMPC0200
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMPC9999
.
PMPC0010  WRITE     HTMLFILE;PMPCUNIQ;      * Pregnancy Unique Id
          GOTO      PMPC9999
.
PMPC0020  WRITE     HTMLFILE;PMPCADMN;      * Admission Number
          GOTO      PMPC9999
.
PMPC0030  MATCH     PMPCDATE,SP70           * Compication/treatment date
          GOTO      PMPC9999 IF EQUAL
          UNPACK    PMPCDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMPC9999
.
PMPC0040  WRITE     HTMLFILE;PMPCTIME;      * Time
          GOTO      PMPC9999
.
PMPC0050  WRITE     HTMLFILE;PMPCTYPE;      * Record Type
          GOTO      PMPC9999
.
PMPC0060  MOVE      "CK",CATEGORY           * Event Type
          MOVE      PMPCETYP,CODE
          CALL      CODITM00
          GOTO      PMPC9999
.
PMPC0070  MOVE      "EK",CATEGORY           * Event Status
          MOVE      PMPCESTA,CODE
          CALL      CODITM00
          GOTO      PMPC9999
.
PMPC0080  WRITE     HTMLFILE;PMPCDES1;      * Description 1
          GOTO      PMPC9999
.
PMPC0090  WRITE     HTMLFILE;PMPCDES2;      * Description 2
          GOTO      PMPC9999
.
PMPC0100  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. creator
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMPC0105
          WRITE     HTMLFILE;PMPCWEBC;
          GOTO      PMPC9999
PMPC0105  PACK      KEY10,PMPCWEBC,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,PMPC9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMPC9999
.
PMPC0110  MATCH     PMPCDATC,SP70             * Date Record Created
          GOTO      PMPC9999 IF EQUAL
          UNPACK    PMPCDATC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMPC9999
.
PMPC0120  MATCH     PMPCTIMC,SP70             * Time Record Created
          GOTO      PMPC9999 IF EQUAL
          WRITE     HTMLFILE;PMPCTIMC;
          GOTO      PMRG9999
.
PMPC0130  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. updated
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMPC0135
          WRITE     HTMLFILE;PMPCWEBU;
          GOTO      PMPC9999
PMPC0135  PACK      KEY10,PMPCWEBU,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,PMPC9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMPC9999
.
PMPC0140  MATCH     PMPCDATU,SP70             * Date Record Updated
          GOTO      PMPC9999 IF EQUAL
          UNPACK    PMPCDATU,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMPC9999
.
PMPC0150  MATCH     PMPCTIMU,SP70             * Time Record Created
          GOTO      PMPC9999 IF EQUAL
          WRITE     HTMLFILE;PMPCTIMU;
          GOTO      PMPC9999
.
PMPC0160  WRITE     HTMLFILE;PMPCRECS;
          GOTO      PMPC9999
.
PMPC0170  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. deleted
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMPC0175
          WRITE     HTMLFILE;PMPCWEBD;
          GOTO      PMPC9999
PMPC0175  PACK      KEY10,PMPCWEBD,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,PMPC9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMPC9999
.
PMPC0180  MATCH     PMPCDATD,SP70             * Date Record Deleted
          GOTO      PMPC9999 IF EQUAL
          UNPACK    PMPCDATD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMPC9999
.
PMPC0190  MATCH     PMPCTIMD,SP70             * Time Record Deleted
          GOTO      PMPC9999 IF EQUAL
          WRITE     HTMLFILE;PMPCTIMD;
          GOTO      PMRG9999
.
PMPC0200  CALL      RPCT0000                  * Complication List
          GOTO      PMRG9999
.
PMPC9999  RETURN
+
.------------------------------------------------------------
.  Update complications file
.------------------------------------------------------------
MVPMPC00  MATCH     PMPCT001,Z70
          IF        !@EQUAL
            MOVE      PMPCT001,PMPCUNIQ
          ENDIF
.
          MATCH     PMPCT002,Z70
          IF        !@EQUAL
            MOVE      PMPCT002,PMPCADMN
          ENDIF
.
          MATCH     PMPCT003,Z70
          IF        !@EQUAL
            MOVE      PMPCT003,PMPCDATE
          ENDIF
.
          MATCH     PMPCT004,Z70
          IF        !@EQUAL
            MOVE      PMPCT004,PMPCTIME
          ENDIF
.
          MATCH     PMPCT005,Z70
          IF        !@EQUAL
            MOVE      PMPCT005,PMPCTYPE
          ENDIF
.
          MATCH     PMPCT006,Z70
          IF        !@EQUAL
            MOVE      PMPCT006,PMPCETYP
          ENDIF
.
          MATCH     PMPCT007,Z70
          IF        !@EQUAL
            MOVE      PMPCT007,PMPCESTA
          ENDIF
.
          MATCH     PMPCT008,Z70
          IF        !@EQUAL
            MOVE      PMPCT008,PMPCDES1
          ENDIF
.
          MATCH     PMPCT009,Z70
          IF        !@EQUAL
            MOVE      PMPCT009,PMPCDES2
          ENDIF
.
MVPMPC99  RETURN
+
.------------------------------------------------------------
.  Clear complications file variables
.------------------------------------------------------------
CLPMPC00  PACK      PMPCUNIQ,SP70
          PACK      PMPCADMN,SP70
          PACK      PMPCDATE,SP70
          PACK      PMPCTIME,SP70
          PACK      PMPCTYPE,SP70
          PACK      PMPCETYP,SP70
          PACK      PMPCESTA,SP70
          PACK      PMPCDES1,SP70
          PACK      PMPCDES2,SP70
          PACK      PMPCWEBC,SP70
          PACK      PMPCDATC,SP70
          PACK      PMPCTIMC,SP70
          PACK      PMPCWEBU,SP70
          PACK      PMPCDATU,SP70
          PACK      PMPCTIMU,SP70
          PACK      PMPCRECS,SP70
          PACK      PMPCWEBD,SP70
          PACK      PMPCDATD,SP70
          PACK      PMPCTIMD,SP70
          PACK      PMPCSPAR,SP70
.
          RETURN
+
.------------------------------------------------------------
.   List of records on pmspctaf for a pregnancy
.------------------------------------------------------------
RPCT0000  MATCH     SP70,PREGUNIQ
          GOTO      RPCT9999 IF EQUAL
.
          PACK      KEY40,PREGUNIQ,Z70
          CALL      RSPMPCT1
RPCT0100  CALL      RPPMPCT1
          BRANCH    OVRCD,RPCT9999
.
          MATCH     PREGUNIQ,PMPCUNIQ
          GOTO      RPCT9999 IF NOT EQUAL
.
          CLEAR     HTMLLINK
          APPEND    "javascript:ViewDetails('",HTMLLINK
          APPEND    URNUMBER,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMPCUNIQ,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMPCADMN,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMPCDATE,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMPCTIME,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMPCTYPE,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMPCETYP,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
          PACK      RECODESC,SP70
          MATCH     "001",PMPCTYPE
          IF        @EQUAL
            PACK      RECODESC,COMPLICN,SP70
          ENDIF
          MATCH     "002",PMPCTYPE
          IF        @EQUAL
            PACK      RECODESC,BIRTHEVN,SP70
          ENDIF
          MATCH     "003",PMPCTYPE
          IF        @EQUAL
            PACK      RECODESC,LABOUREV,SP70
          ENDIF
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",PMPCUNIQ,"#",":
                             "#"",PMPCADMN,"#",":
                             "#"",PMPCDATE,"#",":
                             "#"",PMPCTIME,"#",":
                             "#"",PMPCTYPE,"#",":
                             "#"",PMPCETYP,"#",":
                             "#"",PMPCESTA,"#",":
                             "#"",PMPCDES1,"#",":
                             "#"",PMPCDES2,"#",":
                             "#"",PMPCWEBC,"#",":
                             "#"",PMPCDATC,"#",":
                             "#"",PMPCTIMC,"#",":
                             "#"",PMPCWEBU,"#",":
                             "#"",PMPCDATU,"#",":
                             "#"",PMPCTIMU,"#",":
                             "#"",RECODESC,"#");"
.
          GOTO      RPCT0100
.
RPCT9999  RETURN
+




