. *----------------------------------------------------------------------
. * Include Name  :   PMSLETTM.INC
. *
. * Function      :   CGI Variables for PMSLETFD - pmsletaf
. *
. * Mods          :   V9.02.01 28.08.2001 Ebon Clements
. *                            Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for research extract file
.------------------------------------------------------------------------
CPPMLE00  MOVE      Z70,PMSLE001
          MOVE      Z70,PMSLE002 
          MOVE      Z70,PMSLE003
          MOVE      Z70,PMSLE004
          MOVE      Z70,PMSLE005
          MOVE      Z70,PMSLE006
          MOVE      Z70,PMSLE007
          MOVE      Z70,PMSLE008
          MOVE      Z70,PMSLE009
          MOVE      Z70,PMSLE010
          MOVE      Z70,PMSLE011
          MOVE      Z70,PMSLE012
          MOVE      Z70,PMSLE013
          MOVE      Z70,PMSLE014
          MOVE      Z70,PMSLE015
          MOVE      Z70,PMSLE016
          MOVE      Z70,PMSLE017
          MOVE      Z70,PMSLE018
          MOVE      Z70,PMSLE019
          MOVE      Z70,PMSLE020
          MOVE      Z70,PMSLE021
          MOVE      Z70,PMSLE022
          MOVE      Z70,PMSLE023
          MOVE      Z70,PMSLE024
          MOVE      Z70,PMSLE025
          MOVE      Z70,PMSLE026
          MOVE      Z70,PMSLE027
          MOVE      Z70,PMSLE028
          MOVE      Z70,PMSLE029
.
CPPMLE99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for patient selection file
.------------------------------------------------------------
SPPMLE00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMLE01,SPPMLE02,SPPMLE03,SPPMLE04,SPPMLE05:
                       SPPMLE06,SPPMLE07,SPPMLE08,SPPMLE09,SPPMLE10:
                       SPPMLE11,SPPMLE12,SPPMLE13,SPPMLE14,SPPMLE15:
                       SPPMLE16,SPPMLE17,SPPMLE18,SPPMLE19,SPPMLE20:
                       SPPMLE21,SPPMLE22,SPPMLE23,SPPMLE24,SPPMLE25:
                       SPPMLE26,SPPMLE27,SPPMLE28,SPPMLE29
.
          MOVE      ONE,EXIT
          GOTO      SPPMLE99
.
SPPMLE01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMSLE001
          PACK      PMSLE001,PMSLE001,SP70
          GOTO      SPPMLE99
.
SPPMLE02  MOVE      QRYDATA,PMSLE002
          GOTO      SPPMLE99
.
SPPMLE03  MOVE      QRYDATA,PMSLE003
          GOTO      SPPMLE99
.
SPPMLE04  MOVE      QRYDATA,PMSLE004
          GOTO      SPPMLE99
.
SPPMLE05  MOVE      QRYDATA,PMSLE005
          GOTO      SPPMLE99
.
SPPMLE06  MOVE      QRYDATA,PMSLE006
          GOTO      SPPMLE99
.
SPPMLE07  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPPMLE99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSLE007,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMLE99
.
SPPMLE08  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPPMLE99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSLE008,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMLE99
.
SPPMLE09  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPPMLE99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSLE009,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMLE99
.
SPPMLE10  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPPMLE99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSLE010,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMLE99
.
SPPMLE11  MOVE      QRYDATA,PMSLE011
          GOTO      SPPMLE99
.
SPPMLE12  MOVE      QRYDATA,PMSLE012
          GOTO      SPPMLE99
.
SPPMLE13  MOVE      QRYDATA,PMSLE013
          GOTO      SPPMLE99
.
SPPMLE14  MOVE      QRYDATA,PMSLE014
          GOTO      SPPMLE99
.
SPPMLE15  MOVE      QRYDATA,PMSLE015
          GOTO      SPPMLE99
.
SPPMLE16  MOVE      QRYDATA,PMSLE016
          GOTO      SPPMLE99
.
SPPMLE17  MOVE      QRYDATA,PMSLE017
          GOTO      SPPMLE99
.
SPPMLE18  MOVE      QRYDATA,PMSLE018
          GOTO      SPPMLE99
.
SPPMLE19  MOVE      QRYDATA,PMSLE019
          GOTO      SPPMLE99
.
SPPMLE20  MOVE      QRYDATA,PMSLE020
          GOTO      SPPMLE99
.
SPPMLE21  MOVE      QRYDATA,PMSLE021
          GOTO      SPPMLE99
.
SPPMLE22  MOVE      QRYDATA,PMSLE022
          GOTO      SPPMLE99
.
SPPMLE23  MOVE      QRYDATA,PMSLE023
          GOTO      SPPMLE99
.
SPPMLE24  MOVE      QRYDATA,PMSLE024
          GOTO      SPPMLE99
.
SPPMLE25  MOVE      QRYDATA,PMSLE025
          GOTO      SPPMLE99
.
SPPMLE26  MOVE      QRYDATA,PMSLE026
          GOTO      SPPMLE99
.
SPPMLE27  MOVE      QRYDATA,PMSLE027
          GOTO      SPPMLE99
.
SPPMLE28  MOVE      QRYDATA,PMSLE028
          GOTO      SPPMLE99
.
SPPMLE29  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMSLE029
          PACK      PMSLE029,PMSLE029,SP70
          GOTO      SPPMLE99
.
SPPMLE99  RETURN
.------------------------------------------------------------
. Clear Letter selection variables Variables
.------------------------------------------------------------
CLPMSL00  MOVE      SP70,PMLESEID
          MOVE      SP70,PMLESEDC
          MOVE      SP70,PMLEURFR
          MOVE      SP70,PMLEURTO
          MOVE      SP70,PMLESUFR
          MOVE      SP70,PMLESUTO
          MOVE      SP70,PMLEADFR
          MOVE      SP70,PMLEADTO
          MOVE      SP70,PMLEDDFR
          MOVE      SP70,PMLEDDTO
          MOVE      SP70,PMLEATFR
          MOVE      SP70,PMLEATTO
          MOVE      SP70,PMLECLFR
          MOVE      SP70,PMLECLTO
          MOVE      SP70,PMLECCFR
          MOVE      SP70,PMLECCTO
          MOVE      SP70,PMLEACFR
          MOVE      SP70,PMLEACTO
          MOVE      SP70,PMLERSFR
          MOVE      SP70,PMLERSTO
          MOVE      SP70,PMLEDSFR
          MOVE      SP70,PMLEDSTO
          MOVE      SP70,PMLECBFR
          MOVE      SP70,PMLECBTO
          MOVE      SP70,PMLERLFR
          MOVE      SP70,PMLERLTO
          MOVE      SP70,PMLEHFFR
          MOVE      SP70,PMLEHFTO
          MOVE      SP70,PMLEDCST
          MOVE      SP70,PMLESPAR
.
CLPMSL99  RETURN
.------------------------------------------------------------
. Add Patient Letter Fields
.------------------------------------------------------------
PMLE0000  BRANCH    FLDITMNO,PMLE0100,PMLE0200,PMLE0300,PMLE0400,PMLE0500:
                             PMLE0600,PMLE0700,PMLE0800,PMLE0900,PMLE1000:
                             PMLE1100,PMLE1200,PMLE1300,PMLE1400,PMLE1500:
                             PMLE1600,PMLE1700,PMLE1800,PMLE1900,PMLE2000:
                             PMLE2100,PMLE2200,PMLE2300,PMLE2400,PMLE2500:
                             PMLE2600,PMLE2700,PMLE2800,PMLE2900,PMLE3000
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMLE9999
.
PMLE0100  WRITE     HTMLFILE;PMLESEID;
          GOTO      PMLE9999
.
PMLE0200  WRITE     HTMLFILE;PMLESEDC;
          GOTO      PMLE9999
.
PMLE0300  WRITE     HTMLFILE;PMLEURFR;
          GOTO      PMLE9999
.
PMLE0400  WRITE     HTMLFILE;PMLEURTO;
          GOTO      PMLE9999
.
PMLE0500  WRITE     HTMLFILE;PMLESUFR;
          GOTO      PMLE9999
.
PMLE0600  WRITE     HTMLFILE;PMLESUTO;
          GOTO      PMLE9999
.
PMLE0700  MATCH     PMLEADFR,SP70
          GOTO      PMLE9999 IF EQUAL
          UNPACK    PMLEADFR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMLE9999
.
PMLE0800  MATCH     PMLEADTO,SP70
          GOTO      PMLE9999 IF EQUAL
          UNPACK    PMLEADTO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMLE9999
.
PMLE0900  MATCH     PMLEDDFR,SP70
          GOTO      PMLE9999 IF EQUAL
          UNPACK    PMLEDDFR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMLE9999
.
PMLE1000  MATCH     PMLEDDTO,SP70
          GOTO      PMLE9999 IF EQUAL
          UNPACK    PMLEDDTO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMLE9999
.
PMLE1100  MOVE      "A ",CATEGORY
          MOVE      PMLEATFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1200  MOVE      "A ",CATEGORY
          MOVE      PMLEATTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1300  MOVE      "CL",CATEGORY
          MOVE      PMLECLFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1400  MOVE      "CL",CATEGORY
          MOVE      PMLECLTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1500  MOVE      "CC",CATEGORY
          MOVE      PMLECCFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1600  MOVE      "CC",CATEGORY
          MOVE      PMLECCTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1700  MOVE      "P ",CATEGORY
          MOVE      PMLEACFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1800  MOVE      "P ",CATEGORY
          MOVE      PMLEACTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE1900  MOVE      "S ",CATEGORY
          MOVE      PMLERSFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE2000  MOVE      "S ",CATEGORY
          MOVE      PMLERSTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE2100  MOVE      "D ",CATEGORY
          MOVE      PMLEDSFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE2200  MOVE      "D ",CATEGORY
          MOVE      PMLEDSTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE2300  WRITE     HTMLFILE;PMLECBFR;
          GOTO      PMLE9999
.
PMLE2400  WRITE     HTMLFILE;PMLECBTO;
          GOTO      PMLE9999
.
PMLE2500  MOVE      "R ",CATEGORY
          MOVE      PMLERLFR,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE2600  MOVE      "R ",CATEGORY
          MOVE      PMLERLTO,CODE
          CALL      CODITM00
          GOTO      PMLE9999
.
PMLE2700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMLE2710
          MATCH     SP70,PMLEHFFR
          GOTO      PMLE9999 IF EQUAL
          WRITE     HTMLFILE;PMLEHFFR;
          GOTO      PMLE9999
.
PMLE2710  PACK      KEY14,PMLEHFFR,ZERO,ZERO,ZERO,ZERO,SP70
          CALL      RDFUND1
          IF        OVRCD=0
            WRITE     HTMLFILE;HFNAME;
          ELSE
            WRITE     HTMLFILE;PMLEHFFR;
          ENDIF
          GOTO      PMLE9999
.
PMLE2800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMLE2810
          MATCH     SP70,PMLEHFTO
          GOTO      PMLE9999 IF EQUAL
          WRITE     HTMLFILE;PMLEHFTO;
          GOTO      PMLE9999
.
PMLE2810  PACK      KEY14,PMLEHFTO,ZERO,ZERO,ZERO,ZERO,SP70
          CALL      RDFUND1
          IF        OVRCD=0
            WRITE     HTMLFILE;HFNAME;
          ELSE
            WRITE     HTMLFILE;PMLEHFFR;
          ENDIF
          GOTO      PMLE9999
.
PMLE2900  WRITE     HTMLFILE;PMLEDCST;
          GOTO      PMLE9999
.
PMLE3000  CALL      SELTAB00   
          GOTO      PMLE9999
.
PMLE9999  RETURN
.------------------------------------------------------------
.  Update patient list file
.------------------------------------------------------------
MVPMLE00  MATCH     PMSLE001,Z70
          IF        !@EQUAL
            MOVE      PMSLE001,PMLESEID
          ENDIF
.
          MATCH     PMSLE002,Z70
          IF        !@EQUAL
            MOVE      PMSLE002,PMLESEDC
          ENDIF
.
          MATCH     PMSLE003,Z70
          IF        !@EQUAL
            MOVE      PMSLE003,PMLEURFR
          ENDIF
.
          MATCH     PMSLE004,Z70
          IF        !@EQUAL
            MOVE      PMSLE004,PMLEURTO
          ENDIF
.
          MATCH     PMSLE005,Z70
          IF        !@EQUAL
            MOVE      PMSLE005,PMLESUFR
          ENDIF
.
          MATCH     PMSLE006,Z70
          IF        !@EQUAL
            MOVE      PMSLE006,PMLESUTO
          ENDIF
.
          MATCH     PMSLE007,Z70
          IF        @EQUAL
            MOVE      SP70,PMLEADFR
          ELSE
            MOVE      PMSLE007,PMLEADFR
          ENDIF
.
          MATCH     PMSLE008,Z70
          IF        @EQUAL
            MOVE      SP70,PMLEADTO
          ELSE
            MOVE      PMSLE008,PMLEADTO
          ENDIF
.
          MATCH     PMSLE009,Z70
          IF        @EQUAL
            MOVE      SP70,PMLEDDFR
          ELSE
            MOVE      PMSLE009,PMLEDDFR
          ENDIF
.
          MATCH     PMSLE010,Z70
          IF        @EQUAL
            MOVE      SP70,PMLEDDTO
          ELSE
            MOVE      PMSLE010,PMLEDDTO
          ENDIF
.
          MATCH     PMSLE011,Z70
          IF        !@EQUAL
            MOVE      PMSLE011,PMLEATFR
          ENDIF
.
          MATCH     PMSLE012,Z70
          IF        !@EQUAL
            MOVE      PMSLE012,PMLEATTO
          ENDIF
.
          MATCH     PMSLE013,Z70
          IF        !@EQUAL
            MOVE      PMSLE013,PMLECLFR
          ENDIF
.
          MATCH     PMSLE014,Z70
          IF        !@EQUAL
            MOVE      PMSLE014,PMLECLTO
          ENDIF
.
          MATCH     PMSLE015,Z70
          IF        !@EQUAL
            MOVE      PMSLE015,PMLECCFR
          ENDIF
.
          MATCH     PMSLE016,Z70
          IF        !@EQUAL
            MOVE      PMSLE016,PMLECCTO
          ENDIF
.
          MATCH     PMSLE017,Z70
          IF        !@EQUAL
            MOVE      PMSLE017,PMLEACFR
          ENDIF
.
          MATCH     PMSLE018,Z70
          IF        !@EQUAL
            MOVE      PMSLE018,PMLEACTO
          ENDIF
.
          MATCH     PMSLE019,Z70
          IF        !@EQUAL
            MOVE      PMSLE019,PMLERSFR
          ENDIF
.
          MATCH     PMSLE020,Z70
          IF        !@EQUAL
            MOVE      PMSLE020,PMLERSTO
          ENDIF
.
          MATCH     PMSLE021,Z70
          IF        !@EQUAL
            MOVE      PMSLE021,PMLEDSFR
          ENDIF
.
          MATCH     PMSLE022,Z70
          IF        !@EQUAL
            MOVE      PMSLE022,PMLEDSTO
          ENDIF
.
          MATCH     PMSLE023,Z70
          IF        !@EQUAL
            MOVE      PMSLE023,PMLECBFR
          ENDIF
.
          MATCH     PMSLE024,Z70
          IF        !@EQUAL
            MOVE      PMSLE024,PMLECBTO
          ENDIF
.
          MATCH     PMSLE025,Z70
          IF        !@EQUAL
            MOVE      PMSLE025,PMLERLFR
          ENDIF
.
          MATCH     PMSLE026,Z70
          IF        !@EQUAL
            MOVE      PMSLE026,PMLERLTO
          ENDIF
.
          MATCH     PMSLE027,Z70
          IF        !@EQUAL
            MOVE      PMSLE027,PMLEHFFR
          ENDIF
.
          MATCH     PMSLE028,Z70
          IF        !@EQUAL
            MOVE      PMSLE028,PMLEHFTO
          ENDIF
.
          MATCH     PMSLE029,Z70
          IF        !@EQUAL
            MOVE      PMSLE029,PMLEDCST
          ENDIF
.
MVPMLE99  RETURN
.------------------------------------------------------------
. List of patient lists
.------------------------------------------------------------
SELTAB00  MOVE      SP70,KEY4
          CALL      RSPMLET1
SELTAB10  CALL      RKPMLET1
          BRANCH    OVRCD,SELTAB99
.
          CLEAR     HTMLLINK
          APPEND    "javascript:UpdateItem('",HTMLLINK
          APPEND    PMLESEID,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",PMLESEID,"#",":
                             "#"",PMLESEDC,"#",":
                             "#"",PMLEURFR,"#",":
                             "#"",PMLEURTO,"#",":
                             "#"",PMLESUFR,"#",":
                             "#"",PMLESUTO,"#");"
.
          GOTO      SELTAB10
.
SELTAB99  RETURN
