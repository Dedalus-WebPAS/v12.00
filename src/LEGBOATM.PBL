.------------------------------------------------------------
. Outpatient Booking Field
. V9.03.00  07/05/2004  Ebon Clements  CAR 49209
.           Ported from V9.03
.------------------------------------------------------------
       
LOBA0000  BRANCH    FLDITMNO,LOBA0100,LOBA0200,LOBA0300,LOBA0400,LOBA0500:
                             LOBA0600,LOBA0700,LOBA0800,LOBA0900,LOBA1000:
                             LOBA1100,LOBA1200,LOBA1300,LOBA1400,LOBA1500:
                             LOBA1600,LOBA1700,LOBA1800,LOBA1900,LOBA2000
.                                            
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      LOBA9999
.
LOBA0100  PACK      KEY12,LOBASITE,LOBACLIN,SP70
          CALL      RDLGCLI1
          BRANCH    OVRCD,LOBA9999
.
          MOVE      LOCADESC,DOCFNAME     * If no Doctor Use Clinic Name
          MATCH     SP6,LOCADOCT
          GOTO      LOBA0110 IF EQUAL
.
          MOVE      LOCADOCT,KEY6         * Read the doctor's file to get nam
          CALL      RDLGDOC1
          IF        OVRCD=1
            CLEAR     DOCFNAME
            APPEND    "Invalid Doctor - ",DOCFNAME
            APPEND    LVIDOCT,DOCFNAME
            RESET     DOCFNAME
            GOTO      GETVIS70
          ELSE
.           CALL      DOCNAM00             * format doctors name
            MOVE      LDTITL,FMTTITLE            * I CAR 13038
            MOVE      LDGNAME,FMTGNAME
            MOVE      LDSNAME,FMTSNAME
            CALL      DOCNM000                  * end I CAR 13038
          ENDIF
.
LOBA0110  WRITE     HTMLFILE;DOCFNAME;
          GOTO      LOBA9999
.
LOBA0200  MATCH     SP70,LOBASTRT
          GOTO      LOBA9999 IF EQUAL
.
          LOAD      DAYNAM3,LOBADAY,MON,TUE,WED,THU,FRI,SAT,SUN
          WRITE     HTMLFILE;DAYNAM3;
          GOTO      LOBA9999
.
LOBA0300  MATCH     SP70,LOBADATE
          GOTO      LOBA9999 IF EQUAL
.
          UNPACK    LOBADATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      LOBA9999
.
LOBA0400  MATCH     SP70,LOBATIME
          GOTO      LOBA9999 IF EQUAL
          WRITE     HTMLFILE;LOBATIME;
          GOTO      LOBA9999
.
LOBA0500  MOVE      "OL",CATEGORY
          MOVE      LOTBBLNG,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA0600  PACK      KEY6,LOBASITE,SP70
          CALL      RDLGSIT1
          BRANCH    OVRCD,LOBA9999
.
          MOVE      LOSTCATG,CATEGORY
          MOVE      LOBASRCR,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA0700  MOVE      "PR",CATEGORY
          MOVE      LOBAPRTY,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA0800  MOVE      "OB",CATEGORY
          MOVE      LOTBBTRA,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA0900  MOVE      "AC",CATEGORY
          MOVE      LOTBBDEP,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA1000  MOVE      "CL",CATEGORY
          MOVE      LOBACOMP,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA1100  PACK      GENPCODE,LOTBBRFG,SP70
          CALL      HCPDET00
          GOTO      LOBA9999
.
LOBA1200  WRITE     HTMLFILE;LOBAOUTN;
          GOTO      LOBA9999
.
LOBA1300  MOVE      LOBADOCT,DOCTCODE
          CALL      LDCDET00 
          GOTO      LOBA9999
.
LOBA1400  MOVE      "RR",CATEGORY
          MOVE      LOBARSCH,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA1500  WRITE     HTMLFILE;LOTBBTMF;
          GOTO      LOBA9999
.
LOBA1600  MOVE      LOTBBADC,DOCTCODE
          CALL      LDCDET00
          GOTO      LOBA9999
.
LOBA1700  WRITE     HTMLFILE;LOTBBCIT;
          GOTO      LOBA9999
.
LOBA1800  WRITE     HTMLFILE;LOTBBAST;
          GOTO      LOBA9999
.
LOBA1900  WRITE     HTMLFILE;LOTBBDPT;
          GOTO      LOBA9999
.
LOBA2000  MOVE      "OZ",CATEGORY
          MOVE      LOTBBOUT,CODE
          CALL      LCDITM00
          GOTO      LOBA9999
.
LOBA9999  RETURN
.
