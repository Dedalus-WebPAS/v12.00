. *----------------------------------------------------------------------
. * Include Name  :   SINPOATM.PBL
. *
. * Function      :   CGI variable functions for SINPOAFD - sinpoaaf.dat
. *
. * Modifications :
. *
. * V9.04.00 25/01/2005 Lina Vo                  CAR 56406
. *          Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear parameters for the Purchase Order header file
.------------------------------------------------------------------------
CPSIPA00  MOVE      Z70,SIPOA001
          MOVE      Z70,SIPOA002
          MOVE      Z70,SIPOA003
          MOVE      Z70,SIPOA004
          MOVE      Z70,SIPOA005
          MOVE      Z70,SIPOA006
          MOVE      Z70,SIPOA007
          MOVE      Z70,SIPOA008
          MOVE      Z70,SIPOA009
          MOVE      Z70,SIPOA010
          MOVE      Z70,SIPOA011
          MOVE      Z70,SIPOA012
          MOVE      Z70,SIPOA013
          MOVE      Z70,SIPOA014
          MOVE      Z70,SIPOA015
          MOVE      Z70,SIPOA016
          MOVE      Z70,SIPOA017
          MOVE      Z70,SIPOA018
          MOVE      Z70,SIPOA019
          MOVE      Z70,SIPOA020
          MOVE      Z70,SIPOA021
          MOVE      Z70,SIPOA022
          MOVE      Z70,SIPOA023
          MOVE      Z70,SIPOA024
          MOVE      Z70,SIPOA025
.
CPSIPA99  RETURN
.------------------------------------------------------------
. Purchase Order header file standard tags
.------------------------------------------------------------
SIPA0000  BRANCH    FLDITMNO,SIPA0010,SIPA0020,SIPA0030,SIPA0040,SIPA0050:
                             SIPA0060,SIPA0070,SIPA0080,SIPA0090,SIPA0100:
                             SIPA0110,SIPA0120,SIPA0130,SIPA0140,SIPA0150:
                             SIPA0160,SIPA0170,SIPA0180,SIPA0190,SIPA0200:
                             SIPA0210,SIPA0220,SIPA0230,SIPA0240,SIPA0250
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      SIPA9999
.
SIPA0010  WRITE     HTMLFILE;SIPAPON;
          GOTO      SIPA9999
.
SIPA0020  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0021
          WRITE     HTMLFILE;SIPASUP;
          GOTO      SIPA9999
.
SIPA0021  PACK      KEY5,SIPASUP,SP10
          CALL      RDAPMA1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;APMASN1;
          GOTO      SIPA9999
.
SIPA0030  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0031,SIPA0032
          WRITE     HTMLFILE;SIPAORI;
          GOTO      SIPA9999
.
SIPA0031  PACK      KEY3,SIPAORI,SP10
          CALL      RDSIOR1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SIORNAME;
          GOTO      SIPA9999
.
SIPA0032  PACK      KEY3,SP10
          CALL      RSSIOR1
SIPA0033  CALL      RKSIOR1
          BRANCH    OVRCD,SIPA9999
.
          PACK      KEY5,QUOTE,SIORORIG,QUOTE,SP10
          MATCH     SIPAORI,SIORORIG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>",SIORNAME:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",SIORNAME:
                               "</option>";
          ENDIF
          GOTO      SIPA0033

SIPA0040  WRITE     HTMLFILE;SIPAICN;
          GOTO      SIPA9999
.
SIPA0050  WRITE     HTMLFILE;SIPASCN;
          GOTO      SIPA9999
.
SIPA0060  WRITE     HTMLFILE;SIPADEL;
          GOTO      SIPA9999
.
SIPA0070  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0071,SIPA0072
          WRITE     HTMLFILE;SIPAMES;
          GOTO      SIPA9999
.
SIPA0071  PACK      KEY6,ANSM,ANSE,SP1,SIPAMES,SP10
          CALL      RDSICD1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SICDDESC;
          GOTO      SIPA9999
.
SIPA0072  PACK      KEY3,ANSM,ANSE,SP10
          PACK      CODE,SIPAMES,SP10
          CALL      SELLST00
          GOTO      SIPA9999
.
SIPA0080  MATCH     SIPADIN,SP70
          GOTO      SIPA9999 IF EQUAL
.         
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPA9999
.
SIPA0090  MATCH     SIPADPR,SP70
          GOTO      SIPA9999 IF EQUAL
.         
          UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPA9999
.
SIPA0100  MATCH     SIPADCN,SP70
          GOTO      SIPA9999 IF EQUAL
.         
          UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPA9999
.
SIPA0110  MATCH     SIPADCM,SP70
          GOTO      SIPA9999 IF EQUAL
.         
          UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPA9999
.
SIPA0120  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0121,SIPA0122
          WRITE     HTMLFILE;SIPACON;
          GOTO      SIPA9999
.
SIPA0121  PACK      KEY6,ANSC,ANSF,SP1,SIPACON,SP10
          CALL      RDSICD1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SICDDESC;
          GOTO      SIPA9999
.
SIPA0122  PACK      KEY3,ANSC,ANSF,SP10
          PACK      CODE,SIPACON,SP10
          CALL      SELLST00
          GOTO      SIPA9999
.
SIPA0130  WRITE     HTMLFILE;SIPAIDP;
          GOTO      SIPA9999
.
SIPA0140  WRITE     HTMLFILE;SIPAUR1;
          GOTO      SIPA9999
.
SIPA0150  WRITE     HTMLFILE;SIPAUR2;
          GOTO      SIPA9999
.
SIPA0160  MATCH     SIPAUD1,SP70
          GOTO      SIPA9999 IF EQUAL
.         
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPA9999
.
SIPA0170  MATCH     SIPAUD2,SP70
          GOTO      SIPA9999 IF EQUAL
.         
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPA9999
.
SIPA0180  WRITE     HTMLFILE;SIPAUC1;
          GOTO      SIPA9999
.
SIPA0190  WRITE     HTMLFILE;SIPAUC2;
          GOTO      SIPA9999
.
SIPA0200  WRITE     HTMLFILE;SIPAUY1;
          GOTO      SIPA9999
.
SIPA0210  WRITE     HTMLFILE;SIPAUY2;
          GOTO      SIPA9999
.
SIPA0220  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0221
          WRITE     HTMLFILE;SIPACST;
          GOTO      SIPA9999
.
SIPA0221  PACK      KEY5,SIPACST,SP10
          CALL      RDSICA1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SICADESC;
          GOTO      SIPA9999
.
SIPA0230  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0231
          WRITE     HTMLFILE;SIPAWAR;
          GOTO      SIPA9999
.
SIPA0231  PACK      KEY5,SIPAWAR,SP10
          CALL      RDSIWA1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SIWADES;
          GOTO      SIPA9999
.
SIPA0240  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0241,SIPA0242
          WRITE     HTMLFILE;SIPAPNT;
          GOTO      SIPA9999
.
SIPA0241  PACK      KEY6,ANSP,ANSN,ANST,SIPAPNT,SP10
          CALL      RDSICD1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SICDDESC;
          GOTO      SIPA9999
.
SIPA0242  PACK      KEY3,ANSP,ANSN,ANST,SP10
          PACK      CODE,SIPAPNT,SP10
          CALL      SELLST00
          GOTO      SIPA9999
.
SIPA0250  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPA0251,SIPA0252
          WRITE     HTMLFILE;SIPAMDP;
          GOTO      SIPA9999
.
SIPA0251  PACK      KEY3,SIPAMDP,SP10
          CALL      RDSIDP1
          BRANCH    OVRCD,SIPA9999
.
          WRITE     HTMLFILE;SIDPADD1,SP1,SIDPADD2;
          GOTO      SIPA9999
.
SIPA0252  PACK      KEY3,SP10
          CALL      RSSIDP1
SIPA0253  CALL      RKSIDP1
          BRANCH    OVRCD,SIPA9999
.
          MATCH     "1",SIDPACTV  
          GOTO      SIPA0253 IF NOT EQUAL
.
          PACK      KEY5,QUOTE,SIDPCODE,QUOTE,SP10
          MATCH     SIDPCODE,SIPAMDP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               SIDPADD1,SP1,SIDPADD2,"</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">":
                               SIDPADD1,SP1,SIDPADD2,"</option>";
          ENDIF
          GOTO      SIPA0253
.
SIPA9999  RETURN
.
.------------------------------------------------------------
.   Display Selection list from sincodaf      
.------------------------------------------------------------
SELLST00  PACK      KEY6,KEY3,SP10
          CALL      RSSICD1
SELLST10  CALL      RKSICD1
          BRANCH    OVRCD,SELLST99
.
          MATCH     SICDCATA,KEY3
          GOTO      SELLST99 IF NOT EQUAL
.
          MATCH     SP10,SICDCODE
          GOTO      SELLST10 IF EQUAL
.
          PACK      KEY5,QUOTE,SICDCODE,QUOTE,SP10
          MATCH     SICDCODE,CODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>",SICDDESC:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",SICDDESC:
                               "</option>";
          ENDIF
          GOTO      SELLST10
          
SELLST99  RETURN
.------------------------------------------------------------
.   Set Parameters for the Purchase Order header file
.------------------------------------------------------------
SPSPA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPSPA010,SPSPA020,SPSPA030,SPSPA040,SPSPA050:
                       SPSPA060,SPSPA070,SPSPA080,SPSPA090,SPSPA100:
                       SPSPA110,SPSPA120,SPSPA130,SPSPA140,SPSPA150:
                       SPSPA160,SPSPA170,SPSPA180,SPSPA190,SPSPA200:
                       SPSPA210,SPSPA220,SPSPA230,SPSPA240,SPSPA250
.
          MOVE      ONE,EXIT
          GOTO      SPSPA999
.
SPSPA010  MOVE      QRYDATA,SIPOA001
          GOTO      SPSPA999
.
SPSPA020  MOVE      QRYDATA,SIPOA002
          GOTO      SPSPA999
.
SPSPA030  MOVE      QRYDATA,SIPOA003
          GOTO      SPSPA999
.
SPSPA040  MOVE      QRYDATA,SIPOA004
          GOTO      SPSPA999
.
SPSPA050  MOVE      QRYDATA,SIPOA005
          GOTO      SPSPA999
.
SPSPA060  MOVE      QRYDATA,SIPOA006
          GOTO      SPSPA999
.
SPSPA070  MOVE      QRYDATA,SIPOA007
          GOTO      SPSPA999
.
SPSPA080  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOA008,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPA999
.
SPSPA090  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOA009,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPA999
.
SPSPA100  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOA010,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPA999
.
SPSPA110  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOA011,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPA999
.
SPSPA120  MOVE      QRYDATA,SIPOA012
          GOTO      SPSPA999
.
SPSPA130  MOVE      QRYDATA,SIPOA013
          GOTO      SPSPA999
.
SPSPA140  MOVE      QRYDATA,SIPOA014
          GOTO      SPSPA999
.
SPSPA150  MOVE      QRYDATA,SIPOA015
          GOTO      SPSPA999
.
SPSPA160  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOA016,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPA999
.
SPSPA170  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOA017,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPA999
.
SPSPA180  MOVE      QRYDATA,SIPOA018
          GOTO      SPSPA999
.
SPSPA190  MOVE      QRYDATA,SIPOA019
          GOTO      SPSPA999
.
SPSPA200  MOVE      QRYDATA,SIPOA020
          GOTO      SPSPA999
.
SPSPA210  MOVE      QRYDATA,SIPOA021
          GOTO      SPSPA999
.
SPSPA220  MOVE      QRYDATA,SIPOA022
          GOTO      SPSPA999
.
SPSPA230  MOVE      QRYDATA,SIPOA023
          GOTO      SPSPA999
.
SPSPA240  MOVE      QRYDATA,SIPOA024
          GOTO      SPSPA999
.
SPSPA250  MOVE      QRYDATA,SIPOA025
          GOTO      SPSPA999
.
SPSPA999  RETURN
.
.------------------------------------------------------------
.  Update Purchase Order header file
.------------------------------------------------------------
MVSIPA00  MATCH     SIPOA001,Z70
          IF        !@EQUAL
            MOVE      SIPOA001,SIPAPON
          ENDIF
.
          MATCH     SIPOA002,Z70
          IF        !@EQUAL
            MOVE      SIPOA002,SIPASUP
          ENDIF
.
          MATCH     SIPOA003,Z70
          IF        !@EQUAL
            MOVE      SIPOA003,SIPAORI
          ENDIF
.
          MATCH     SIPOA004,Z70
          IF        !@EQUAL
            MOVE      SIPOA004,SIPAICN
          ENDIF
.
          MATCH     SIPOA005,Z70
          IF        !@EQUAL
            MOVE      SIPOA005,SIPASCN
          ENDIF
.
          MATCH     SIPOA006,Z70
          IF        !@EQUAL
            MOVE      SIPOA006,SIPADEL
          ENDIF
.
          MATCH     SIPOA007,Z70
          IF        !@EQUAL
            MOVE      SIPOA007,SIPAMES
          ENDIF
.
          MATCH     SIPOA008,Z70
          IF        !@EQUAL
            MOVE      SIPOA008,SIPADIN
          ENDIF
.
          MATCH     SIPOA009,Z70
          IF        !@EQUAL
            MOVE      SIPOA009,SIPADPR
          ENDIF
.
          MATCH     SIPOA010,Z70
          IF        !@EQUAL
            MOVE      SIPOA010,SIPADCN
          ENDIF
.
          MATCH     SIPOA011,Z70
          IF        !@EQUAL
            MOVE      SIPOA011,SIPADCM
          ENDIF
.
          MATCH     SIPOA012,Z70
          IF        !@EQUAL
            MOVE      SIPOA012,SIPACON
          ENDIF
.
          MATCH     SIPOA013,Z70
          IF        !@EQUAL
            MOVE      SIPOA013,SIPAIDP
          ENDIF
.
          MATCH     SIPOA014,Z70
          IF        !@EQUAL
            MOVE      SIPOA014,SIPAUR1
          ENDIF
.
          MATCH     SIPOA015,Z70
          IF        !@EQUAL
            MOVE      SIPOA015,SIPAUR2
          ENDIF
.
          MATCH     SIPOA016,Z70
          IF        !@EQUAL
            MOVE      SIPOA016,SIPAUD1
          ENDIF
.
          MATCH     SIPOA017,Z70
          IF        !@EQUAL
            MOVE      SIPOA017,SIPAUD2
          ENDIF
.
          MATCH     SIPOA018,Z70
          IF        !@EQUAL
            MOVE      SIPOA018,SIPAUC1
          ENDIF
.
          MATCH     SIPOA019,Z70
          IF        !@EQUAL
            MOVE      SIPOA019,SIPAUC2
          ENDIF
.
          MATCH     SIPOA020,Z70
          IF        !@EQUAL
            MOVE      SIPOA020,SIPAUY1
          ENDIF
.
          MATCH     SIPOA021,Z70
          IF        !@EQUAL
            MOVE      SIPOA021,SIPAUY2
          ENDIF
.
          MATCH     SIPOA022,Z70
          IF        !@EQUAL
            MOVE      SIPOA022,SIPACST
          ENDIF
.
          MATCH     SIPOA023,Z70
          IF        !@EQUAL
            MOVE      SIPOA023,SIPAWAR
          ENDIF
.
          MATCH     SIPOA024,Z70
          IF        !@EQUAL
            MOVE      SIPOA024,SIPAPNT
          ENDIF
.
          MATCH     SIPOA025,Z70
          IF        !@EQUAL
            MOVE      SIPOA025,SIPAMDP
          ENDIF
.
MVSIPA99  RETURN
.
.------------------------------------------------------------
.  Clear Purchase Order header file
.------------------------------------------------------------
CLRSPA00  MOVE      SP70,SIPAPON 
          MOVE      SP70,SIPASUP 
          MOVE      ZERO,SIPAORI 
          MOVE      SP70,SIPAICN 
          MOVE      SP70,SIPASCN 
          MOVE      SP70,SIPADEL 
          MOVE      SP70,SIPAMES 
          MOVE      SP70,SIPADIN 
          MOVE      SP70,SIPADPR 
          MOVE      SP70,SIPADCN 
          MOVE      SP70,SIPADCM 
          MOVE      SP70,SIPACON 
          MOVE      SP70,SIPAIDP 
          MOVE      SP70,SIPAUR1 
          MOVE      SP70,SIPAUR2 
          MOVE      SP70,SIPAUD1 
          MOVE      SP70,SIPAUD2 
          MOVE      SP70,SIPAUC1 
          MOVE      SP70,SIPAUC2 
          MOVE      SP70,SIPAUY1 
          MOVE      SP70,SIPAUY2 
          MOVE      SP70,SIPACST 
          MOVE      SP70,SIPAWAR 
          MOVE      SP70,SIPAPNT 
          MOVE      SP70,SIPAMDP 
          MOVE      SP70,SIPASPA 
.
CLRSPA99  RETURN
