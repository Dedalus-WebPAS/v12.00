.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.09.01  25.06.2007 Sandra Barcham 123735
.           Added Contract Item and Contract Expiry Date
.-------------------------------------------------------
. V9.05.B01 03.02.2006 Sandra Barcham 93464
.           Extended Unit of Measure
.-------------------------------------------------------
. V9.04.01  22.04.2005 Peter Vela CAR 59698
.           Added functionality to display Catalog Extended Desc (sincijaf)
.           13.04.2005 Peter Vela CAR 59696
.           Recompiled for SINSUAFD
. V9.03.02  10.09.2003 Steve Downing (VF.11.02 CAR 9375)
.           Recompiled for SINREBFD & SINREBIO
. V9.03.01  04.07.2003 Henry Son   41043
.           Displaying incorrect Outstanding
.           Purchase orders.
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.01  20.03.2003 Henry Son CAR 14035
.           Not displaying usage because of warehouse
.           Security.
. VF.09.B02 02.04.2001 David Bell
.           Added new Screen Item
. VF.09.B01 14.11.2000 Charles Handaya
.           Recompiled for SINCIAKY changes
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.03  11.08.2000 Charles Handaya
.           Re-Generated & Recompiled with SBSCR05
.           SRF 4646
. VF.01.02  18.07.2000 Charles Handaya
.           Omnicell import file - Add Restock ID (SIBARESI)
.           in Backorder Catalog Details (18) Screen for standard & Australia
.           screens only
.           Quote 9817
. VF.01.01  18.05.2000 Charles Handaya
.           Add an item and painted it on screen
.-------------------------------------------------------
. VF.00.07  12.01.2000 Sandra Barcham
.           Check all screens for descending order using SP70 not Z70
.           srf 637009
. VF.00.06  11.01.2000 Sandra Barcham
.           Fix Purchase Order History was using descending SP70 not Z70
.           srf 637009
. VF.00.05  24.12.1999 Sandra Barcham
.           Fix outstanding orders not displaying expected delivery date 2000
.           srf 636709
. VF.00.04  22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.03  02.11.1999 Sandra Barcham
.           Change locked message to use X
. VF.00.02  02.06.1999 Sandra Barcham
.           Change transaction display on item history
.           srf 645595 & 645639
. VF.00.01  04.03.1999 Sandra Barcham
.           Fixed usage keys for batch screens
.-------------------------------------------------------
SECSIWS   FORM      1
WHOLEROL  FORM      12
WHOLEROQ  FORM      12
WHOLESOH  FORM      12
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN12
.   Function      :   Catalog File Enquiries                  
.   Generated  On :   16/07/2007
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       GPHSTDDF    
          INC       IBAGSTFD/INC
          INC       SINBACFD/INC
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIBFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCIEFD/INC
          INC       SINCIFFD/INC
          INC       SINCIGFD/INC
          INC       SINCIHFD/INC
          INC       SINCIJFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINIMPFD/INC
          INC       SINITMFD/INC
          INC       SINNATFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINREAFD/INC
          INC       SINREBFD/INC
          INC       SINSCDFD/INC
          INC       SINSCFFD/INC
          INC       SINSCMFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
UDC1DESC  DIM      30 * Scr 00 Fld    25
UDC2DESC  DIM      30 * Scr 00 Fld    26
NOTESIIB  DIM       5 * Scr 00 Fld    30
.
.Word Processor File * Scr 00 Fld    31
.
NAMSIIB1  INIT      "Wsiib1"
FILSIIB1  DIM       8
.
SUSPDESC  DIM      25 * Scr 00 Fld    32
TOTALUQT  FORM     12.2 * Scr 00 Fld    42
TOTALUAM  FORM     12.2 * Scr 00 Fld    43
TOTALPQT  FORM     12.2 * Scr 00 Fld    44
TOTALPAM  FORM     12.2 * Scr 00 Fld    45
TOTALRQT  FORM     12.2 * Scr 00 Fld    46
TOTALRAM  FORM     12.2 * Scr 00 Fld    47
TOTSOH    FORM     12.2 * Scr 01 Fld    34
USVALUE   FORM     12.2 * Scr 01 Fld    35
USQUANT   FORM     12.2 * Scr 01 Fld    36
DEFROQ    FORM     12.2 * Scr 01 Fld    37
DEFROL    FORM     12.2 * Scr 01 Fld    38
DEFRAS    DIM       8 * Scr 01 Fld    39
DEFFAC    FORM     12 * Scr 01 Fld    40
SUP1CODE  DIM       5 * Scr 01 Fld    41
SUP2CODE  DIM       5 * Scr 01 Fld    42
SUP3CODE  DIM       5 * Scr 01 Fld    43
SUP4CODE  DIM       5 * Scr 01 Fld    44
SUP5CODE  DIM       5 * Scr 01 Fld    45
SUP1DESC  DIM      30 * Scr 01 Fld    46
SUP2DESC  DIM      30 * Scr 01 Fld    47
SUP3DESC  DIM      30 * Scr 01 Fld    48
SUP4DESC  DIM      30 * Scr 01 Fld    49
SUP5DESC  DIM      30 * Scr 01 Fld    50
DEFLEAD   FORM     12 * Scr 01 Fld    51
DEFSUT    DIM      15 * Scr 01 Fld    52
.
.Word Processor File * Scr 01 Fld    56
.
NAMSIIJ1  INIT      "Wsiij1"
FILSIIJ1  DIM       8
.
.
.    Multi Item Key Fields Scr 02 Fld     2
.-------------------------------------------------------
SIIC1NAM  INIT      "SIIC1"
SIIC1END  FORM      1   * End Display
SIIC1SNO  FORM      5   * Number of Items on the Screen
SIIC1MKY  DIM       127 * Match Key 
SIIC1EKY  DIM       127 * End Key
SIIC1SKY  DIM       127 * Start Key
SIIC1IDX  INIT      " 132 UC1-5"
SIIC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIC1FNM  DIM       8  * Filename
SIIC1CNT  FORM      3  * Number of Items on Screen
ISSLCOST  FORM     12.6 * Scr 02 Fld     7
ISSCCOST  FORM     12.6 * Scr 02 Fld    12
PSNAME    DIM      30 * Scr 02 Fld    20
CVSCCON   DIM      10 * Scr 02 Fld    21
CVSCDES   DIM      40 * Scr 02 Fld    22
CVSCSDT   DIM      10 * Scr 02 Fld    23
CVSCEDT   DIM      10 * Scr 02 Fld    24
CVSFAQT   FORM     12.2 * Scr 02 Fld    25
CVSFAPC   FORM     12.2 * Scr 02 Fld    26
CVSFEQT   FORM     12.2 * Scr 02 Fld    27
CVSFECT   FORM     12.2 * Scr 02 Fld    28
CVSDSUP   DIM       5 * Scr 02 Fld    29
CVSDSDT   DIM       8 * Scr 02 Fld    30
CVSDSUT   DIM      15 * Scr 02 Fld    31
CVMASN1   DIM      30 * Scr 02 Fld    32
CVMASN2   DIM      30 * Scr 02 Fld    33
.
.    Multi Item Key Fields Scr 03 Fld     1
.-------------------------------------------------------
SIIE1NAM  INIT      "SIIE1"
SIIE1END  FORM      1   * End Display
SIIE1SNO  FORM      5   * Number of Items on the Screen
SIIE1MKY  DIM       127 * Match Key 
SIIE1EKY  DIM       127 * End Key
SIIE1SKY  DIM       127 * Start Key
SIIE1IDX  INIT      " 132 UC1-5"
SIIE1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIE1FNM  DIM       8  * Filename
SIIE1CNT  FORM      3  * Number of Items on Screen
FINYEAR   DIM       4 * Scr 04 Fld     2
ACTPER01  FORM     12.2 * Scr 04 Fld    15
ACTPER02  FORM     12.2 * Scr 04 Fld    16
ACTPER03  FORM     12.2 * Scr 04 Fld    17
ACTPER04  FORM     12.2 * Scr 04 Fld    18
ACTPER05  FORM     12.2 * Scr 04 Fld    19
ACTPER06  FORM     12.2 * Scr 04 Fld    20
ACTPER07  FORM     12.2 * Scr 04 Fld    21
ACTPER08  FORM     12.2 * Scr 04 Fld    22
ACTPER09  FORM     12.2 * Scr 04 Fld    23
ACTPER10  FORM     12.2 * Scr 04 Fld    24
ACTPER11  FORM     12.2 * Scr 04 Fld    25
ACTPER12  FORM     12.2 * Scr 04 Fld    26
ACTPERXX  FORM     12.2 * Scr 04 Fld    27
BUDPER01  FORM     12.2 * Scr 04 Fld    28
BUDPER02  FORM     12.2 * Scr 04 Fld    29
BUDPER03  FORM     12.2 * Scr 04 Fld    30
BUDPER04  FORM     12.2 * Scr 04 Fld    31
BUDPER05  FORM     12.2 * Scr 04 Fld    32
BUDPER06  FORM     12.2 * Scr 04 Fld    33
BUDPER07  FORM     12.2 * Scr 04 Fld    34
BUDPER08  FORM     12.2 * Scr 04 Fld    35
BUDPER09  FORM     12.2 * Scr 04 Fld    36
BUDPER10  FORM     12.2 * Scr 04 Fld    37
BUDPER11  FORM     12.2 * Scr 04 Fld    38
BUDPER12  FORM     12.2 * Scr 04 Fld    39
BUDPERXX  FORM     12.2 * Scr 04 Fld    40
VARPER01  FORM     12.4 * Scr 04 Fld    41
VARPER02  FORM     12.4 * Scr 04 Fld    42
VARPER03  FORM     12.4 * Scr 04 Fld    43
VARPER04  FORM     12.4 * Scr 04 Fld    44
VARPER05  FORM     12.4 * Scr 04 Fld    45
VARPER06  FORM     12.4 * Scr 04 Fld    46
VARPER07  FORM     12.4 * Scr 04 Fld    47
VARPER08  FORM     12.4 * Scr 04 Fld    48
VARPER09  FORM     12.4 * Scr 04 Fld    49
VARPER10  FORM     12.4 * Scr 04 Fld    50
VARPER11  FORM     12.4 * Scr 04 Fld    51
VARPER12  FORM     12.4 * Scr 04 Fld    52
VARPERXX  FORM     12.4 * Scr 04 Fld    53
ACTPER13  FORM     12.2 * Scr 04 Fld    62
BUDPER13  FORM     12.2 * Scr 04 Fld    63
VARPER13  FORM     12.4 * Scr 04 Fld    64
.
.    Multi Item Key Fields Scr 06 Fld     3
.-------------------------------------------------------
SIPC3NAM  INIT      "SIPC3"
SIPC3END  FORM      1   * End Display
SIPC3SNO  FORM      5   * Number of Items on the Screen
SIPC3MKY  DIM       127 * Match Key 
SIPC3EKY  DIM       127 * End Key
SIPC3SKY  DIM       127 * Start Key
SIPC3IDX  INIT      " 132 UC1-5"
SIPC3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC3FNM  DIM       8  * Filename
SIPC3CNT  FORM      3  * Number of Items on Screen
PERUSAGE  DIM       7 * Scr 06 Fld     6
CANIND    DIM       1 * Scr 06 Fld    18
.
.    Multi Item Key Fields Scr 07 Fld    27
.-------------------------------------------------------
SIIT1NAM  INIT      "SIIT1"
SIIT1END  FORM      1   * End Display
SIIT1SNO  FORM      5   * Number of Items on the Screen
SIIT1MKY  DIM       127 * Match Key 
SIIT1EKY  DIM       127 * End Key
SIIT1SKY  DIM       127 * Start Key
SIIT1IDX  INIT      " 132 UC1-5"
SIIT1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIT1FNM  DIM       8  * Filename
SIIT1CNT  FORM      3  * Number of Items on Screen
ITEMSOH   FORM      8 * Scr 07 Fld    29
TRANDESC  DIM      20 * Scr 07 Fld    40
USAGEPER  DIM       7 * Scr 07 Fld    41
LINEREF   DIM      60 * Scr 07 Fld    42
.
.    Multi Item Key Fields Scr 08 Fld    14
.-------------------------------------------------------
SISD2NAM  INIT      "SISD2"
SISD2END  FORM      1   * End Display
SISD2SNO  FORM      5   * Number of Items on the Screen
SISD2MKY  DIM       127 * Match Key 
SISD2EKY  DIM       127 * End Key
SISD2SKY  DIM       127 * Start Key
SISD2IDX  INIT      " 132 UC1-5"
SISD2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SISD2FNM  DIM       8  * Filename
SISD2CNT  FORM      3  * Number of Items on Screen
TYPEREQ   DIM       1 * Scr 09 Fld     4
.
.    Multi Item Key Fields Scr 09 Fld     6
.-------------------------------------------------------
SIRB2NAM  INIT      "SIRB2"
SIRB2END  FORM      1   * End Display
SIRB2SNO  FORM      5   * Number of Items on the Screen
SIRB2MKY  DIM       127 * Match Key 
SIRB2EKY  DIM       127 * End Key
SIRB2SKY  DIM       127 * Start Key
SIRB2IDX  INIT      " 132 UC1-5"
SIRB2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIRB2FNM  DIM       8  * Filename
SIRB2CNT  FORM      3  * Number of Items on Screen
REQINDIC  DIM      12 * Scr 09 Fld    20
NOTESIID  DIM       5 * Scr 10 Fld    42
.
.Word Processor File * Scr 10 Fld    43
.
NAMSIID1  INIT      "Wsiid1"
FILSIID1  DIM       8
.
NOTESIIG  DIM       5 * Scr 11 Fld    25
.
.Word Processor File * Scr 11 Fld    26
.
NAMSIIG1  INIT      "Wsiig1"
FILSIIG1  DIM       8
.
SUSPDES1  DIM      25 * Scr 11 Fld    27
BOCOST    FORM      4 * Scr 11 Fld    30
BOTOTAL   FORM     12.2 * Scr 11 Fld    31
ITEMDESC  DIM      60 * Scr 14 Fld    29
ORDQTY    FORM     12.2 * Scr 14 Fld    34
ITEMCOST  DIM      12 * Scr 14 Fld    37
.
.Word Processor File * Scr 14 Fld    58
.
NAMSIPD1  INIT      "Wsipd1"
FILSIPD1  DIM       8
.
.
.    Multi Item Key Fields Scr 16 Fld     3
.-------------------------------------------------------
SIPC6NAM  INIT      "SIPC6"
SIPC6END  FORM      1   * End Display
SIPC6SNO  FORM      5   * Number of Items on the Screen
SIPC6MKY  DIM       127 * Match Key 
SIPC6EKY  DIM       127 * End Key
SIPC6SKY  DIM       127 * Start Key
SIPC6IDX  INIT      " 132 UC1-5"
SIPC6FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC6FNM  DIM       8  * Filename
SIPC6CNT  FORM      3  * Number of Items on Screen
OUTQTY    FORM     12.2 * Scr 16 Fld    10
.
.    Multi Item Key Fields Scr 17 Fld     8
.-------------------------------------------------------
SIBA3NAM  INIT      "SIBA3"
SIBA3END  FORM      1   * End Display
SIBA3SNO  FORM      5   * Number of Items on the Screen
SIBA3MKY  DIM       127 * Match Key 
SIBA3EKY  DIM       127 * End Key
SIBA3SKY  DIM       127 * Start Key
SIBA3IDX  INIT      " 132 UC1-5"
SIBA3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIBA3FNM  DIM       8  * Filename
SIBA3CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 19 Fld     1
.-------------------------------------------------------
SIIM2NAM  INIT      "SIIM2"
SIIM2END  FORM      1   * End Display
SIIM2SNO  FORM      5   * Number of Items on the Screen
SIIM2MKY  DIM       127 * Match Key 
SIIM2EKY  DIM       127 * End Key
SIIM2SKY  DIM       127 * Start Key
SIIM2IDX  INIT      " 132 UC1-5"
SIIM2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIM2FNM  DIM       8  * Filename
SIIM2CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN12"
PRGNAM    INIT      "Catalog File Enquiries                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIJ1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIC1FL1,DELETE
.
          CLOSE     SIIE1FL1,DELETE
.
          CLOSE     SIPC3FL1,DELETE
.
          CLOSE     SIIT1FL1,DELETE
.
          CLOSE     SISD2FL1,DELETE
.
          CLOSE     SIRB2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIID1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIG1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPD1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIPC6FL1,DELETE
.
          CLOSE     SIBA3FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA3,"ibagstaf"
          MOVE      "   24",AUDTSECT
          MOVE      "204",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudim";
            OPEN      SINAUDIM,"sinaudim"
          ENDIF
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA1,"sinbacaf"
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA2,"sinbacaf"
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA3,"sinbacaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincibaf";
          OPEN      SINCIBA1,"sincibaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA4,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincigaf";
          OPEN      SINCIGA1,"sincigaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA1,"sincihaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA2,"sincihaf"
          DISPLAY   *P56:24,"Opening sincijaf";
          OPEN      SINCIJA1,"sincijaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA1,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA2,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA3,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinitmaf";
          OPEN      SINITMA1,"sinitmaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA1,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA2,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA3,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA4,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA1,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA2,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA3,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscfaf";
          OPEN      SINSCFA1,"sinscfaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Wp Filename for Notes for Catalog                  
.--------------------------------------------------------
          PACK      FILSIIB1,NAMSIIB1,PORT
          REP       " 0",FILSIIB1
          DISPLAY   *P56:24,"Create & Open ",FILSIIB1;
          PREP      TEMPWORD,FILSIIB1
.
.--------------------------------------------------------
. Initialise Wp Filename for Extended Description for Catalog   
.--------------------------------------------------------
          PACK      FILSIIJ1,NAMSIIJ1,PORT
          REP       " 0",FILSIIJ1
          DISPLAY   *P56:24,"Create & Open ",FILSIIJ1;
          PREP      TEMPWORD,FILSIIJ1
.
.--------------------------------------------------------
. Initialise Batch Screen Supply Unit                        
.--------------------------------------------------------
          MOVE     ZERO,SIIC1SNO
          MOVE     "02    2",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIC1SNO
            ENDIF
          ENDIF
          PACK      SIIC1FNM,ANST,SIIC1NAM,PORT
          REP       " 0",SIIC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIC1FL1,SIIC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIC1FNM,SIIC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIC1FL1,SIIC1FNM
.--------------------------------------------------------
. Initialise Batch Screen Warehouse Code                     
.--------------------------------------------------------
          MOVE     ZERO,SIIE1SNO
          MOVE     "03    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIE1SNO
            ENDIF
          ENDIF
          PACK      SIIE1FNM,ANST,SIIE1NAM,PORT
          REP       " 0",SIIE1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIE1FL1,SIIE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIE1FNM,SIIE1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIE1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIE1FL1,SIIE1FNM
.--------------------------------------------------------
. Initialise Batch Screen Purchase Order                     
.--------------------------------------------------------
          MOVE     ZERO,SIPC3SNO
          MOVE     "06    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC3SNO
            ENDIF
          ENDIF
          PACK      SIPC3FNM,ANST,SIPC3NAM,PORT
          REP       " 0",SIPC3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC3FL1,SIPC3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC3FNM,SIPC3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC3FL1,SIPC3FNM
.--------------------------------------------------------
. Initialise Batch Screen Date of Transaction                
.--------------------------------------------------------
          MOVE     ZERO,SIIT1SNO
          MOVE     "07   27",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIT1SNO
            ENDIF
          ENDIF
          PACK      SIIT1FNM,ANST,SIIT1NAM,PORT
          REP       " 0",SIIT1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIT1FL1,SIIT1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIT1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIT1FNM,SIIT1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIT1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIT1FL1,SIIT1FNM
.--------------------------------------------------------
. Initialise Batch Screen Price Effective Date               
.--------------------------------------------------------
          MOVE     ZERO,SISD2SNO
          MOVE     "08   14",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SISD2SNO
            ENDIF
          ENDIF
          PACK      SISD2FNM,ANST,SISD2NAM,PORT
          REP       " 0",SISD2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SISD2FL1,SISD2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SISD2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SISD2FNM,SISD2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SISD2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SISD2FL1,SISD2FNM
.--------------------------------------------------------
. Initialise Batch Screen Requisition Type                   
.--------------------------------------------------------
          MOVE     ZERO,SIRB2SNO
          MOVE     "09    6",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIRB2SNO
            ENDIF
          ENDIF
          PACK      SIRB2FNM,ANST,SIRB2NAM,PORT
          REP       " 0",SIRB2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIRB2FL1,SIRB2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIRB2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIRB2FNM,SIRB2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIRB2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIRB2FL1,SIRB2FNM
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Supplier Notes             
.--------------------------------------------------------
          PACK      FILSIID1,NAMSIID1,PORT
          REP       " 0",FILSIID1
          DISPLAY   *P56:24,"Create & Open ",FILSIID1;
          PREP      TEMPWORD,FILSIID1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Warehouse Notes            
.--------------------------------------------------------
          PACK      FILSIIG1,NAMSIIG1,PORT
          REP       " 0",FILSIIG1
          DISPLAY   *P56:24,"Create & Open ",FILSIIG1;
          PREP      TEMPWORD,FILSIIG1
.
.--------------------------------------------------------
. Initialise Wp Filename for Comments                           
.--------------------------------------------------------
          PACK      FILSIPD1,NAMSIPD1,PORT
          REP       " 0",FILSIPD1
          DISPLAY   *P56:24,"Create & Open ",FILSIPD1;
          PREP      TEMPWORD,FILSIPD1
.
.--------------------------------------------------------
. Initialise Batch Screen Purchase Order Number              
.--------------------------------------------------------
          MOVE     ZERO,SIPC6SNO
          MOVE     "16    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC6SNO
            ENDIF
          ENDIF
          PACK      SIPC6FNM,ANST,SIPC6NAM,PORT
          REP       " 0",SIPC6FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC6FL1,SIPC6FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC6FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC6FNM,SIPC6IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC6FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC6FL1,SIPC6FNM
.--------------------------------------------------------
. Initialise Batch Screen Cost Centre                        
.--------------------------------------------------------
          MOVE     ZERO,SIBA3SNO
          MOVE     "17    8",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIBA3SNO
            ENDIF
          ENDIF
          PACK      SIBA3FNM,ANST,SIBA3NAM,PORT
          REP       " 0",SIBA3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIBA3FL1,SIBA3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIBA3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIBA3FNM,SIBA3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIBA3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIBA3FL1,SIBA3FNM
.--------------------------------------------------------
. Initialise Batch Screen Cost Centre                        
.--------------------------------------------------------
          MOVE     ZERO,SIIM2SNO
          MOVE     "19    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIM2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Selections                         
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Basic Catalog Details Display      
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Supplier Summary                   
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Warehouse Summary                  
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Usage Analysis                     
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Purchasing Analysis                
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Purchase Order Analysis            
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Item History Summary               
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Contract Summary                   
          ENDIF
          MATCH     "09",SCRID
          IF         @EQUAL
            CALL       PS09L000   * Requisitions Enquiry               
          ENDIF
          MATCH     "10",SCRID
          IF         @EQUAL
            CALL       PS10L000   * Supplier Details                   
          ENDIF
          MATCH     "11",SCRID
          IF         @EQUAL
            CALL       PS11L000   * Warehouse Details                  
          ENDIF
          MATCH     "12",SCRID
          IF         @EQUAL
            CALL       PS12L000   * Item History Detail Screen         
          ENDIF
          MATCH     "13",SCRID
          IF         @EQUAL
            CALL       PS13L000   * Contract Detail Display            
          ENDIF
          MATCH     "14",SCRID
          IF         @EQUAL
            CALL       PS14L000   * Purchase Order Details             
          ENDIF
          MATCH     "15",SCRID
          IF         @EQUAL
            CALL       PS15L000   * Requisition Details                
          ENDIF
          MATCH     "16",SCRID
          IF         @EQUAL
            CALL       PS16L000   * Outstanding Orders                 
          ENDIF
          MATCH     "17",SCRID
          IF         @EQUAL
            CALL       PS17L000   * Backorder Details Screen           
          ENDIF
          MATCH     "18",SCRID
          IF         @EQUAL
            CALL       PS18L000   * Backorder Catalog Details          
          ENDIF
          MATCH     "19",SCRID
          IF         @EQUAL
            CALL       PS19L000   * Imprest Cost Centres               
          ENDIF
          RETURN
.--------------------------------
. Screen - Selections                         
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RINCOCAT
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Selections                         
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIASUB 
          MOVE      SP70,SIIAISS 
          MOVE      SP70,SIIASTI 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,SIIANAT 
          MOVE      SP70,SIIAABC 
          MOVE      SP70,SIIAPSC 
          MOVE      ZERO,SIIAREX 
          MOVE      ZERO,SIIANON 
          MOVE      ZERO,SIIASAB 
          MOVE      ZERO,SIIASUS 
          MOVE      SP70,SIIADTC 
          MOVE      SP70,SIIATMC 
          MOVE      SP70,SIIAUSC 
          MOVE      SP70,SIIAUR1 
          MOVE      SP70,SIIAUR2 
          MOVE      SP70,SIIAUD1 
          MOVE      SP70,SIIAUD2 
          MOVE      SP70,SIIAUC1 
          MOVE      SP70,SIIAUC2 
          MOVE      SP70,SIIAUY1 
          MOVE      SP70,SIIAUY2 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,SISADESC
          MOVE      SP70,APMASN1 
          MOVE      SP70,NOTESIIB
          MOVE      SP70,SUSPDESC
          MOVE      ZERO,TOTALUQT
          MOVE      ZERO,TOTALUAM
          MOVE      ZERO,TOTALPQT
          MOVE      ZERO,TOTALPAM
          MOVE      ZERO,TOTALRQT
          MOVE      ZERO,TOTALRAM
          MOVE      SP70,SIIAGST 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Selections                         
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIAGST 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAGST,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Selections                         
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILSIIB1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIB1 
          IF        OVRCD=0
            CALL      RPSIIB1 
          ENDIF
WP00L100
          CALL     RKSIIB1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY10,SIIBCAT,SIIBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,SIIBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Selections                         
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Selections                         
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Selections                         
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L124,PS00L125,PS00L126,PS00L127:
                            PS00L999,PS00L128,PS00L129,PS00L130:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L131,PS00L132,PS00L133:
                            PS00L134,PS00L135,PS00L136,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L137
          GOTO     PS00L999
.
PS00L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          CALL      REDITM00
          GOTO     PS00L999
.
PS00L108
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          UNPACK    SIIADTC,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      SIIATMC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      SIIAUSC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          CALL      NSIIB000
          MOVE     FILSIIB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L130
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      TOTALUQT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      TOTALUAM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      TOTALPQT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      TOTALPAM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      TOTALRQT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      TOTALRAM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      SIIAGST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Selections                         
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L101,SF00L006:
                            SF00L102,SF00L103,SF00L104,SF00L105:
                            SF00L106,SF00L107,SF00L108,SF00L109:
                            SF00L110,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L111:
                            SF00L112,SF00L113,SF00L114,SF00L115:
                            SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L101,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF00L001
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC04L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC05L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC07L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L110
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC08L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L112
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC09L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L113
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC16L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L114
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC17L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L115
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC19L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Basic Catalog Details Display      
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETSCR01
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Basic Catalog Details Display      
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Basic Catalog Details Display      
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Basic Catalog Details Display      
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILSIIB1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIB1 
          IF        OVRCD=0
            CALL      RPSIIB1 
          ENDIF
WP01L100
          CALL     RKSIIB1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY10,SIIBCAT,SIIBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,SIIBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILSIIJ1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIJ1 
          IF        OVRCD=0
            CALL      RPSIIJ1 
          ENDIF
WP01L110
          CALL     RKSIIJ1 
          BRANCH   OVRCD,WP01L115
          PACK     KEY10,SIIJCAT,SIIJLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP01L115 IF NOT EQUAL
          PACK     VAR,SIIJCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIJCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L110
WP01L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Basic Catalog Details Display      
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Basic Catalog Details Display      
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Basic Catalog Details Display      
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L127,PS01L999:
                            PS01L128,PS01L129,PS01L130,PS01L999:
                           PS01L999,PS01L131,PS01L132,PS01L133:
                            PS01L134,PS01L135,PS01L136,PS01L137:
                            PS01L138,PS01L139,PS01L140,PS01L141:
                            PS01L142,PS01L143,PS01L144,PS01L145:
                            PS01L146,PS01L147,PS01L148,PS01L149:
                            PS01L150,PS01L151,PS01L152,PS01L153
          GOTO     PS01L999
.
PS01L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          UNPACK    SIIADTC,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      SIIATMC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      SIIAUSC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          CALL      NSIIB000
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE     FILSIIB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L130
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      TOTSOH,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      USVALUE,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      USQUANT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      DEFROQ,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      DEFROL,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      DEFRAS,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      DEFFAC,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          MOVE      SUP1CODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          MOVE      SUP2CODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE      SUP3CODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L141
          MOVE      SUP4CODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L142
          MOVE      SUP5CODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L143
          MOVE      SUP1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L144
          MOVE      SUP2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L145
          MOVE      SUP3DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L146
          MOVE      SUP4DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L147
          MOVE      SUP5DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L148
          MOVE      DEFLEAD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L149
          MOVE      DEFSUT,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L150
          MOVE      SIIADUN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L151
          MOVE      SIIAGST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L152
          MOVE      IBGSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L153
          MOVE     FILSIIJ1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Basic Catalog Details Display      
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L101,SF01L006,SF01L006:
                           SF01L102,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L103
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L101,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L103
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L102
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 8",SCPSROW
              MOVE     " 19",SCPSCOL
              MOVE     " 57",SCPSLEN
              MOVE     " 2",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIJ1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIJ1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Supplier Summary                   
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      SETSCR02
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Supplier Summary                   
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Summary                   
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Supplier Summary                   
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Supplier Summary                   
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     2 Supply Unit                        
.---------------------------------------------------------
          UNPACK    SP70,SIICCAT,SIICSUP,SIICSUT
          PACK      KEY27,SIIACAT,SP70
          MOVE      KEY27,SIIC1EKY
          STRIP     SIIC1SKY
          SETLPTR   SIIC1EKY,7
          MOVE      SIIC1EKY,SIIC1SKY
          CALL      RDSIIC1 
          IF        OVRCD=0
            CALL      RPSIIC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIIC1CNT
          MOVE     ZERO,SIIC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L101,DP02L102,DP02L103:
                            DP02L104,DP02L105,DP02L106,DP02L107:
                            DP02L108,DP02L109,DP02L110,DP02L111:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SIIC1MKY,SP70,SP70
          CALL      UPTSIIC1
          IF        SIIC1END=0
            CALL      RKSIIC1 
            IF        OVRCD=0
              PACK      SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
              MATCH     SIIC1EKY,SIIC1MKY
              IF        @EQUAL
                MOVE      ZERO,SIIC1END
                ADD       ONE,SIIC1CNT
                CALL      UPTSIIC1
          CALL      SUPDET00
                MOVE      SIICSUT,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIIC1END
              ENDIF
            ELSE
              MOVE      ONE,SIIC1END
            ENDIF
          ENDIF
          IF        SIIC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SIIC1END=0
            MOVE      SIFACTOR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SIIC1END=0
            MOVE      SIICSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SIIC1END=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SIIC1END=0
            MOVE      SIICLCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SIIC1END=0
            MOVE      ISSLCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SIIC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICMAN,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SIIC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICAPO,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SIIC1END=0
            MOVE      SIICLTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SIIC1END=0
            MOVE      SIICCCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        SIIC1END=0
            MOVE      ISSCCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIIC1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIIC1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY27,SIIC1SKY,SP70
          CALL     RDSIIC1  * Start
          IF       OVRCD=0
            CALL     RPSIIC1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIIC1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY27,SIIC1SKY,Z70
          CALL     RSSIIC1  * End
          IF       OVRCD=1
            CALL     RPSIIC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIC1SNO
            CALL     RPSIIC1 
            IF       OVRCD=1
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
            MATCH    SIIC1EKY,SIIC1MKY
            IF       !@EQUAL
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIIC1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSIIC1
          BRANCH   OVRCD,PP02L115
          MOVE      SIIC1MKY,KEY27 
          CALL      RSSIIC1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIC1SNO
            CALL     RPSIIC1 
            IF       OVRCD=1
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
            MATCH    SIIC1EKY,SIIC1MKY
            IF       !@EQUAL
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIC1SNO
            CALL     RKSIIC1 
            IF       OVRCD=1
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
            MATCH    SIIC1EKY,SIIC1MKY
            IF       !@EQUAL
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIIC1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIIC1 
          BRANCH   OVRCD,NP02L110
          PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
          MATCH    SIIC1EKY,SIIC1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIIC1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIIC1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Supplier Summary                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     2 Supply Unit                        
.---------------------------------------------------------
UPTSIIC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIC1FL1,KEY5;SCPSROW,SCPSCOL,SIIC1MKY
          ELSE
            UPDATE    SIIC1FL1;SCPSROW,SCPSCOL,SIIC1MKY
          ENDIF
          RETURN
RDTSIIC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIC1FL1,KEY5;SCPSROW,SCPSCOL,SIIC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIC1FL1,KEY5;;
          READKS    SIIC1FL1;SCPSROW,SCPSCOL,SIIC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Supplier Summary                   
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Supplier Summary                   
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L101,PS02L102:
                            PS02L103,PS02L104,PS02L105,PS02L106:
                            PS02L107,PS02L108,PS02L109,PS02L110:
                            PS02L111,PS02L112,PS02L113,PS02L114:
                            PS02L115
          GOTO     PS02L999
.
PS02L101
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      PSNAME,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CVSCCON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      CVSCDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          UNPACK    CVSCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          UNPACK    CVSCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CVSFAQT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CVSFAPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      CVSFEQT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      CVSFECT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      CVSDSUP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          UNPACK    CVSDSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      CVSDSUT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      CVMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      CVMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Supplier Summary                   
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L102,SF02L103,SF02L104,SF02L006:
                           SF02L105,SF02L106,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L101,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSIIC1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SIIC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SIIC1MKY,KEY27 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODSUP00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIC1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SIIC1MKY,KEY27 
            CALL      RSSIIC1 
            CALL      RPSIIC1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L105
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Warehouse Summary                  
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Warehouse Summary                  
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Warehouse Summary                  
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Warehouse Summary                  
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Warehouse Summary                  
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     1 Warehouse Code                     
.---------------------------------------------------------
          UNPACK    SP70,SIIECAT,SIIEWAR
          PACK      KEY12,SIIACAT,SP70
          MOVE      KEY12,SIIE1EKY
          STRIP     SIIE1SKY
          SETLPTR   SIIE1EKY,7
          MOVE      SIIE1EKY,SIIE1SKY
          CALL      RDSIIE1 
          IF        OVRCD=0
            CALL      RPSIIE1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,SIIE1CNT
          MOVE     ZERO,SIIE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L101,DP03L102,DP03L103,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L104,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          PACK      SIIE1MKY,SP70,SP70
          CALL      UPTSIIE1
          IF        SIIE1END=0
            CALL      RKSIIE1 
            IF        OVRCD=0
              PACK      SIIE1MKY,SIIECAT,SIIEWAR                                                                
              MATCH     SIIE1EKY,SIIE1MKY
              IF        @EQUAL
                MOVE      ZERO,SIIE1END
                ADD       ONE,SIIE1CNT
                CALL      UPTSIIE1
                MOVE      SIIEWAR,VAR      
                CALL      DISPITEM
          CALL      WARDET00
              ELSE
                MOVE      ONE,SIIE1END
              ENDIF
            ELSE
              MOVE      ONE,SIIE1END
            ENDIF
          ENDIF
          IF        SIIE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        SIIE1END=0
            MOVE      SIIERAS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        SIIE1END=0
            MOVE      SIIESOH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        SIIE1END=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "SIIE1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "SIIE1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY12,SIIE1SKY,SP70
          CALL     RDSIIE1  * Start
          IF       OVRCD=0
            CALL     RPSIIE1  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "SIIE1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY12,SIIE1SKY,Z70
          CALL     RSSIIE1  * End
          IF       OVRCD=1
            CALL     RPSIIE1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIE1SNO
            CALL     RPSIIE1 
            IF       OVRCD=1
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
            MATCH    SIIE1EKY,SIIE1MKY
            IF       !@EQUAL
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "SIIE1",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          CALL      RFTSIIE1
          BRANCH   OVRCD,PP03L115
          MOVE      SIIE1MKY,KEY12 
          CALL      RSSIIE1 
PP03L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIE1SNO
            CALL     RPSIIE1 
            IF       OVRCD=1
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
            MATCH    SIIE1EKY,SIIE1MKY
            IF       !@EQUAL
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIE1SNO
            CALL     RKSIIE1 
            IF       OVRCD=1
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
            MATCH    SIIE1EKY,SIIE1MKY
            IF       !@EQUAL
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "SIIE1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RKSIIE1 
          BRANCH   OVRCD,NP03L110
          PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
          MATCH    SIIE1EKY,SIIE1MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RPSIIE1 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RPSIIE1 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Warehouse Summary                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Warehouse Code                     
.---------------------------------------------------------
UPTSIIE1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIE1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIE1FL1,KEY5;SCPSROW,SCPSCOL,SIIE1MKY
          ELSE
            UPDATE    SIIE1FL1;SCPSROW,SCPSCOL,SIIE1MKY
          ENDIF
          RETURN
RDTSIIE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIE1FL1,KEY5;SCPSROW,SCPSCOL,SIIE1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIE1FL1,KEY5;;
          READKS    SIIE1FL1;SCPSROW,SCPSCOL,SIIE1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIE1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Warehouse Summary                  
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Warehouse Summary                  
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L103,PS03L104,PS03L105:
                            PS03L106,PS03L107,PS03L108,PS03L109:
                            PS03L110,PS03L111,PS03L112,PS03L113:
                            PS03L114,PS03L115,PS03L116,PS03L117:
                            PS03L118,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SIIESOO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      SIIEROQ,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SIIEROL,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESTI,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          UNPACK    SIIESTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESIC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      SIIESUS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Warehouse Summary                  
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L102:
                            SF03L103,SF03L104,SF03L006,SF03L006:
                           SF03L105,SF03L106
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          COMPARE   ONE,ACCEPT
          GOTO      SF03L001 IF EQUAL
          CALL      RDTSIIE1
          IF        OVRCD=1
            BEEP
            GOTO      SF03L001
          ENDIF
          MATCH     SP70,SIIE1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF03L001
          ENDIF
          MOVE      SIIE1MKY,KEY12 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODWAR00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIE1
          IF        OVRCD=1
            CALL      FP03L000
          ELSE
            MOVE      SIIE1MKY,KEY12 
            CALL      RSSIIE1 
            CALL      RPSIIE1 
            CALL      DP03L000
          ENDIF
          GOTO     SF03L001
.
SF03L102
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Usage Analysis                     
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Usage Analysis                     
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Usage Analysis                     
.--------------------------------------------------------
KY04L000
.
KY04L110
.
.
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EWARE000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY04L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          BRANCH    EXIT,KY04L110,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Usage Analysis                     
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Usage Analysis                     
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Usage Analysis                     
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Usage Analysis                     
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L101,PS04L102:
                            PS04L103,PS04L104,PS04L105,PS04L106:
                            PS04L107,PS04L108,PS04L109,PS04L110:
                            PS04L111,PS04L112,PS04L113,PS04L114:
                            PS04L115,PS04L116,PS04L117,PS04L118:
                            PS04L119,PS04L120,PS04L121,PS04L122:
                            PS04L123,PS04L124,PS04L125,PS04L126:
                            PS04L127,PS04L128,PS04L129,PS04L130:
                            PS04L131,PS04L132,PS04L133,PS04L134:
                            PS04L135,PS04L136,PS04L137,PS04L138:
                            PS04L139,PS04L140,PS04L141,PS04L142:
                            PS04L143,PS04L144,PS04L145,PS04L146:
                            PS04L147,PS04L148,PS04L149,PS04L150:
                            PS04L151,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L152:
                            PS04L153,PS04L154,PS04L155,PS04L156
          GOTO     PS04L999
.
PS04L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L152
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L153
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L154
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L155
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L156
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Usage Analysis                     
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L101,SF04L102:
                            SF04L103,SF04L104,SF04L105,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPUA0000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
.
SF04L103
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPUC0000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
.
SF04L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPUQ0000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Purchasing Analysis                
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchasing Analysis                
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchasing Analysis                
.--------------------------------------------------------
KY05L000
.
KY05L110
.
.
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EWARE000
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY05L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EPYRR000
          BRANCH    EXIT,KY05L110,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchasing Analysis                
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchasing Analysis                
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchasing Analysis                
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchasing Analysis                
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L101,PS05L102:
                            PS05L103,PS05L104,PS05L105,PS05L106:
                            PS05L107,PS05L108,PS05L109,PS05L110:
                            PS05L111,PS05L112,PS05L113,PS05L114:
                            PS05L115,PS05L116,PS05L117,PS05L118:
                            PS05L119,PS05L120,PS05L121,PS05L122:
                            PS05L123,PS05L124,PS05L125,PS05L126:
                            PS05L127,PS05L128,PS05L129,PS05L130:
                            PS05L131,PS05L132,PS05L133,PS05L134:
                            PS05L135,PS05L136,PS05L137,PS05L138:
                            PS05L139,PS05L140,PS05L141,PS05L142:
                            PS05L143,PS05L144,PS05L145,PS05L146:
                            PS05L147,PS05L148,PS05L149,PS05L150:
                            PS05L151,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L152:
                            PS05L153,PS05L154,PS05L155,PS05L156
          GOTO     PS05L999
.
PS05L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L152
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L153
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L154
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L155
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L156
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchasing Analysis                
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L101,SF05L102:
                            SF05L103,SF05L104,SF05L105,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPUA0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L103
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPUC0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPUQ0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Purchase Order Analysis            
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Analysis            
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Analysis            
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Analysis            
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Analysis            
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :     3 Purchase Order                     
.---------------------------------------------------------
          UNPACK    SP70,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM
          PACK      KEY23,SIIACAT,Z70
          MOVE      KEY23,SIPC3EKY
          STRIP     SIPC3SKY
          SETLPTR   SIPC3EKY,7
          MOVE      SIPC3EKY,SIPC3SKY
          CALL      RDSIPC3 
          IF        OVRCD=0
            CALL      RPSIPC3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,SIPC3CNT
          MOVE     ZERO,SIPC3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L010,DP06L010,DP06L101,DP06L010:
                           DP06L102,DP06L103,DP06L104,DP06L105:
                            DP06L106,DP06L107,DP06L108,DP06L109:
                            DP06L110,DP06L111,DP06L112,DP06L113:
                            DP06L114,DP06L115,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010
          GOTO      DP06L010
.
DP06L101
          PACK      SIPC3MKY,SP70,SP70
          CALL      UPTSIPC3
          IF        SIPC3END=0
            CALL      RPSIPC3 
            IF        OVRCD=0
              PACK      SIPC3MKY,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM                                                
              MATCH     SIPC3EKY,SIPC3MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC3END
                ADD       ONE,SIPC3CNT
                CALL      UPTSIPC3
                MOVE      SIPCPON,VAR      
                CALL      DISPITEM
          CALL      ORDDET00
              ELSE
                MOVE      ONE,SIPC3END
              ENDIF
            ELSE
              MOVE      ONE,SIPC3END
            ENDIF
          ENDIF
          IF        SIPC3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        SIPC3END=0
            MOVE      SIPCITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        SIPC3END=0
            MOVE      PERUSAGE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        SIPC3END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L105
          IF        SIPC3END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L106
          IF        SIPC3END=0
            UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L107
          IF        SIPC3END=0
            MOVE      SIPCOQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L108
          IF        SIPC3END=0
            MOVE      SIPCRQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L109
          IF        SIPC3END=0
            MOVE      SIPCECT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L110
          IF        SIPC3END=0
            MOVE      SIPASUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L111
          IF        SIPC3END=0
            UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L112
          IF        SIPC3END=0
            UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L113
          IF        SIPC3END=0
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L114
          IF        SIPC3END=0
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L115
          IF        SIPC3END=0
            MOVE      CANIND,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "SIPC3",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          MATCH    "SIPC3",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          PACK     KEY23,SIPC3SKY,Z70
          CALL     RDSIPC3  * Start
          IF       OVRCD=0
            CALL     RPSIPC3  * Start
          ENDIF
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          MATCH    "SIPC3",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY23,SIPC3SKY,SP70
          CALL     RSSIPC3  * End
          IF       OVRCD=1
            CALL     RKSIPC3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC3SNO
            CALL     RKSIPC3 
            IF       OVRCD=1
              MOVE     SIPC3SNO,SECTOR
            ENDIF
            PACK     SIPC3MKY,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM                                                
            MATCH    SIPC3EKY,SIPC3MKY
            IF       !@EQUAL
              MOVE     SIPC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
          MATCH    "SIPC3",NAMSSFFI
          GOTO     PP06L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP06L105
          CALL      RFTSIPC3
          BRANCH   OVRCD,PP06L115
          MOVE      SIPC3MKY,KEY23 
          CALL      RSSIPC3 
PP06L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC3SNO
            CALL     RKSIPC3 
            IF       OVRCD=1
              MOVE     SIPC3SNO,SECTOR
            ENDIF
            PACK     SIPC3MKY,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM                                                
            MATCH    SIPC3EKY,SIPC3MKY
            IF       !@EQUAL
              MOVE     SIPC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC3SNO
            CALL     RPSIPC3 
            IF       OVRCD=1
              MOVE     SIPC3SNO,SECTOR
            ENDIF
            PACK     SIPC3MKY,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM                                                
            MATCH    SIPC3EKY,SIPC3MKY
            IF       !@EQUAL
              MOVE     SIPC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP06L999
PP06L120
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "SIPC3",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          CALL     RPSIPC3 
          BRANCH   OVRCD,NP06L110
          PACK     SIPC3MKY,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM                                                
          MATCH    SIPC3EKY,SIPC3MKY
          GOTO     NP06L110 IF NOT EQUAL
          CALL     RKSIPC3 
          CALL     DP06L000
          GOTO     NP06L999
NP06L110
          CALL     RKSIPC3 
          BEEP
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
CT06L105
CT06L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Order Analysis            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Purchase Order                     
.---------------------------------------------------------
UPTSIPC3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC3FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC3FL1,KEY5;SCPSROW,SCPSCOL,SIPC3MKY
          ELSE
            UPDATE    SIPC3FL1;SCPSROW,SCPSCOL,SIPC3MKY
          ENDIF
          RETURN
RDTSIPC3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC3FL1,KEY5;SCPSROW,SCPSCOL,SIPC3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC3FL1,KEY5;;
          READKS    SIPC3FL1;SCPSROW,SCPSCOL,SIPC3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Analysis            
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "SIPC3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Analysis            
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Analysis            
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L103,SF06L104,SF06L105:
                            SF06L106
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L102,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          COMPARE   ONE,ACCEPT
          GOTO      SF06L001 IF EQUAL
          CALL      RDTSIPC3
          IF        OVRCD=1
            BEEP
            GOTO      SF06L001
          ENDIF
          MATCH     SP70,SIPC3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF06L001
          ENDIF
          MOVE      SIPC3MKY,KEY23 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELORD00
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC3
          IF        OVRCD=1
            CALL      FP06L000
          ELSE
            MOVE      SIPC3MKY,KEY23 
            CALL      RSSIPC3 
            CALL      RKSIPC3 
            CALL      DP06L000
          ENDIF
          GOTO     SF06L001
.
SF06L103
          MOVE      "SIPC3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L104
          MOVE      "SIPC3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "SIPC3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L106
          MOVE      "SIPC3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
SF06L990  MOVE      ONE,EXIT * Exit Char Restart
SF06L999  RETURN
.--------------------------------
. Screen - Item History Summary               
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Item History Summary               
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Item History Summary               
.--------------------------------------------------------
KY07L000
.
KY07L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EWARA000
          BRANCH    EXIT,KY07L900,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Item History Summary               
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Item History Summary               
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :    27 Date of Transaction                
.---------------------------------------------------------
          UNPACK    SP70,SIITWAR,SIITCAT,SIITDAT,SIITTIM
          PACK      KEY28,SIWAWAR,SIIACAT,Z70
          MOVE      KEY28,SIIT1EKY
          STRIP     SIIT1SKY
          SETLPTR   SIIT1EKY,12
          MOVE      SIIT1EKY,SIIT1SKY
          CALL      RDSIIT1 
          IF        OVRCD=0
            CALL      RPSIIT1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,SIIT1CNT
          MOVE     ZERO,SIIT1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L101,DP07L102:
                            DP07L103,DP07L104,DP07L105,DP07L106:
                            DP07L107,DP07L108,DP07L109,DP07L110:
                            DP07L111,DP07L112,DP07L113,DP07L114:
                            DP07L115,DP07L116,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010
          GOTO      DP07L010
.
DP07L101
          PACK      SIIT1MKY,SP70,SP70
          CALL      UPTSIIT1
          IF        SIIT1END=0
            CALL      RPSIIT1 
            IF        OVRCD=0
              PACK      SIIT1MKY,SIITWAR,SIITCAT,SIITDAT,SIITTIM                                                
              MATCH     SIIT1EKY,SIIT1MKY
              IF        @EQUAL
                MOVE      ZERO,SIIT1END
                ADD       ONE,SIIT1CNT
                CALL      UPTSIIT1
          CALL      SETDAT00
                UNPACK    SIITDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      ITMDET00
              ELSE
                MOVE      ONE,SIIT1END
              ENDIF
            ELSE
              MOVE      ONE,SIIT1END
            ENDIF
          ENDIF
          IF        SIIT1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        SIIT1END=0
            MOVE      SIITTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        SIIT1END=0
            MOVE      ITEMSOH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        SIIT1END=0
            MOVE      SIITPOR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L105
          IF        SIIT1END=0
            MOVE      SIITPRG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L106
          IF        SIIT1END=0
            MOVE      SIITPER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L107
          IF        SIIT1END=0
            MOVE      SIITQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L108
          IF        SIIT1END=0
            MOVE      SIITAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L109
          IF        SIIT1END=0
            MOVE      SIITTYP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L110
          IF        SIIT1END=0
            MOVE      SIITCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L111
          IF        SIIT1END=0
            MOVE      SIITREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L112
          IF        SIIT1END=0
            MOVE      SIITPUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L113
          IF        SIIT1END=0
            MOVE      SIITREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L114
          IF        SIIT1END=0
            MOVE      TRANDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L115
          IF        SIIT1END=0
            MOVE      USAGEPER,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L116
          IF        SIIT1END=0
            MOVE      LINEREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "SIIT1",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          MATCH    "SIIT1",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          PACK     KEY28,SIIT1SKY,Z70
          CALL     RDSIIT1  * Start
          IF       OVRCD=0
            CALL     RPSIIT1  * Start
          ENDIF
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          MATCH    "SIIT1",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY28,SIIT1SKY,SP70
          CALL     RSSIIT1  * End
          IF       OVRCD=1
            CALL     RKSIIT1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIT1SNO
            CALL     RKSIIT1 
            IF       OVRCD=1
              MOVE     SIIT1SNO,SECTOR
            ENDIF
            PACK     SIIT1MKY,SIITWAR,SIITCAT,SIITDAT,SIITTIM                                                
            MATCH    SIIT1EKY,SIIT1MKY
            IF       !@EQUAL
              MOVE     SIIT1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
          MATCH    "SIIT1",NAMSSFFI
          GOTO     PP07L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP07L105
          CALL      RFTSIIT1
          BRANCH   OVRCD,PP07L115
          MOVE      SIIT1MKY,KEY28 
          CALL      RSSIIT1 
PP07L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIT1SNO
            CALL     RKSIIT1 
            IF       OVRCD=1
              MOVE     SIIT1SNO,SECTOR
            ENDIF
            PACK     SIIT1MKY,SIITWAR,SIITCAT,SIITDAT,SIITTIM                                                
            MATCH    SIIT1EKY,SIIT1MKY
            IF       !@EQUAL
              MOVE     SIIT1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIT1SNO
            CALL     RPSIIT1 
            IF       OVRCD=1
              MOVE     SIIT1SNO,SECTOR
            ENDIF
            PACK     SIIT1MKY,SIITWAR,SIITCAT,SIITDAT,SIITTIM                                                
            MATCH    SIIT1EKY,SIIT1MKY
            IF       !@EQUAL
              MOVE     SIIT1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP07L999
PP07L120
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "SIIT1",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          CALL     RPSIIT1 
          BRANCH   OVRCD,NP07L110
          PACK     SIIT1MKY,SIITWAR,SIITCAT,SIITDAT,SIITTIM                                                
          MATCH    SIIT1EKY,SIIT1MKY
          GOTO     NP07L110 IF NOT EQUAL
          CALL     RKSIIT1 
          CALL     DP07L000
          GOTO     NP07L999
NP07L110
          CALL     RKSIIT1 
          BEEP
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
CT07L105
CT07L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Item History Summary               
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    27 Date of Transaction                
.---------------------------------------------------------
UPTSIIT1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIT1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIT1FL1,KEY5;SCPSROW,SCPSCOL,SIIT1MKY
          ELSE
            UPDATE    SIIT1FL1;SCPSROW,SCPSCOL,SIIT1MKY
          ENDIF
          RETURN
RDTSIIT1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIT1FL1,KEY5;SCPSROW,SCPSCOL,SIIT1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIT1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIT1FL1,KEY5;;
          READKS    SIIT1FL1;SCPSROW,SCPSCOL,SIIT1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIT1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Item History Summary               
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "SIIT1",NAMSSFFI
          MOVE      "   27",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Item History Summary               
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L101,PS07L102,PS07L103:
                            PS07L104,PS07L105,PS07L106,PS07L107:
                            PS07L108,PS07L109,PS07L110,PS07L111:
                            PS07L112,PS07L113,PS07L114,PS07L115:
                            PS07L116,PS07L117,PS07L118,PS07L119:
                            PS07L120,PS07L121,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999
          GOTO     PS07L999
.
PS07L101
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L103
          MOVE      SIIERAS,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L104
          MOVE      SIIESOH,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L105
          MOVE      SIIESOO,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L106
          MOVE      SIIEROQ,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L107
          MOVE      SIIEROL,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L108
          MOVE      SIIESTI,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L109
          UNPACK    SIIESTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESIC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L112
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L113
          MOVE      SIIESUS,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L114
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L115
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L116
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L117
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L118
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L119
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Item History Summary               
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L006,SF07L006,SF07L101:
                            SF07L102,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L103,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L104,SF07L105:
                            SF07L006,SF07L006,SF07L106,SF07L107
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L103,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIT1",NAMSSFFI
          MOVE      "   27",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L102
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L103
          CALL      SELECTED
          BRANCH    EXIT,SF07L001
          COMPARE   ONE,ACCEPT
          GOTO      SF07L001 IF EQUAL
          CALL      RDTSIIT1
          IF        OVRCD=1
            BEEP
            GOTO      SF07L001
          ENDIF
          MATCH     SP70,SIIT1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF07L001
          ENDIF
          MOVE      SIIT1MKY,KEY28 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      ITMSCR00
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIT1
          IF        OVRCD=1
            CALL      FP07L000
          ELSE
            MOVE      SIIT1MKY,KEY28 
            CALL      RSSIIT1 
            CALL      RKSIIT1 
            CALL      DP07L000
          ENDIF
          GOTO     SF07L001
.
SF07L104
          MOVE      "SIIT1",NAMSSFFI
          MOVE      "   27",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L105
          MOVE      "SIIT1",NAMSSFFI
          MOVE      "   27",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L106
          MOVE      "SIIT1",NAMSSFFI
          MOVE      "   27",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L107
          MOVE      "SIIT1",NAMSSFFI
          MOVE      "   27",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.--------------------------------
. Screen - Contract Summary                   
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC08L200
          CALL      CF08L000 * Clear Fields
          CALL      GETCON00
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Summary                   
.-------------------------------------------------------
CF08L000
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Summary                   
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Summary                   
.---------------------------------------------------------
WP08L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Summary                   
.---------------------------------------------------------
LM08L000
.---------------------------------------------------------
. Load for :    14 Price Effective Date               
.---------------------------------------------------------
          UNPACK    SP70,SISDCAT,SISDSDT,SISDSUP,SISDCON,SISDSUT
          PACK      KEY45,SIIACAT,Z70
          MOVE      KEY45,SISD2EKY
          STRIP     SISD2SKY
          SETLPTR   SISD2EKY,7
          MOVE      SISD2EKY,SISD2SKY
          CALL      RDSISD2 
          IF        OVRCD=0
            CALL      RPSISD2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP08L000
          MOVE     ZERO,SISD2CNT
          MOVE     ZERO,SISD2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP08L600
          MATCH    PRGID,SCPSPID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP08L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L101,DP08L102,DP08L103:
                            DP08L104,DP08L105,DP08L106,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010
          GOTO      DP08L010
.
DP08L101
          PACK      SISD2MKY,SP70,SP70
          CALL      UPTSISD2
          IF        SISD2END=0
            CALL      RPSISD2 
            IF        OVRCD=0
              PACK      SISD2MKY,SISDCAT,SISDSDT,SISDSUP,SISDCON,SISDSUT                                        
              MATCH     SISD2EKY,SISD2MKY
              IF        @EQUAL
                MOVE      ZERO,SISD2END
                ADD       ONE,SISD2CNT
                CALL      UPTSISD2
                UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      CONDET00
              ELSE
                MOVE      ONE,SISD2END
              ENDIF
            ELSE
              MOVE      ONE,SISD2END
            ENDIF
          ENDIF
          IF        SISD2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L102
          IF        SISD2END=0
            MOVE      SISDCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L103
          IF        SISD2END=0
            MOVE      SISDSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L104
          IF        SISD2END=0
            MOVE      SISDSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L105
          IF        SISD2END=0
            MOVE      SISDUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L106
          IF        SISD2END=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
DP08L600
          MATCH    "SISD2",NAMSSFFI
          GOTO     DP08L605 IF NOT EQUAL
          GOTO     DP08L999
DP08L605
DP08L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP08L000
.
          MATCH    "SISD2",NAMSSFFI
          GOTO     FP08L105 IF NOT EQUAL
          PACK     KEY45,SISD2SKY,Z70
          CALL     RDSISD2  * Start
          IF       OVRCD=0
            CALL     RPSISD2  * Start
          ENDIF
          CALL     DP08L000
          GOTO     FP08L999
FP08L105
FP08L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP08L000
.
          MATCH    "SISD2",NAMSSFFI
          GOTO     LP08L105 IF NOT EQUAL
          PACK     KEY45,SISD2SKY,SP70
          CALL     RSSISD2  * End
          IF       OVRCD=1
            CALL     RKSISD2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SISD2SNO
            CALL     RKSISD2 
            IF       OVRCD=1
              MOVE     SISD2SNO,SECTOR
            ENDIF
            PACK     SISD2MKY,SISDCAT,SISDSDT,SISDSUP,SISDCON,SISDSUT                                        
            MATCH    SISD2EKY,SISD2MKY
            IF       !@EQUAL
              MOVE     SISD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     LP08L999
LP08L105
LP08L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP08L000
.
          MATCH    "SISD2",NAMSSFFI
          GOTO     PP08L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP08L105
          CALL      RFTSISD2
          BRANCH   OVRCD,PP08L115
          MOVE      SISD2MKY,KEY45 
          CALL      RSSISD2 
PP08L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SISD2SNO
            CALL     RKSISD2 
            IF       OVRCD=1
              MOVE     SISD2SNO,SECTOR
            ENDIF
            PACK     SISD2MKY,SISDCAT,SISDSDT,SISDSUP,SISDCON,SISDSUT                                        
            MATCH    SISD2EKY,SISD2MKY
            IF       !@EQUAL
              MOVE     SISD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     PP08L999
PP08L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SISD2SNO
            CALL     RPSISD2 
            IF       OVRCD=1
              MOVE     SISD2SNO,SECTOR
            ENDIF
            PACK     SISD2MKY,SISDCAT,SISDSDT,SISDSUP,SISDCON,SISDSUT                                        
            MATCH    SISD2EKY,SISD2MKY
            IF       !@EQUAL
              MOVE     SISD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP08L999
PP08L120
PP08L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP08L000
          MATCH    "SISD2",NAMSSFFI
          GOTO     NP08L115 IF NOT EQUAL
NP08L105
          CALL     RPSISD2 
          BRANCH   OVRCD,NP08L110
          PACK     SISD2MKY,SISDCAT,SISDSDT,SISDSUP,SISDCON,SISDSUT                                        
          MATCH    SISD2EKY,SISD2MKY
          GOTO     NP08L110 IF NOT EQUAL
          CALL     RKSISD2 
          CALL     DP08L000
          GOTO     NP08L999
NP08L110
          CALL     RKSISD2 
          BEEP
          GOTO     NP08L999
NP08L115
NP08L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT08L000
CT08L105
CT08L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Contract Summary                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    14 Price Effective Date               
.---------------------------------------------------------
UPTSISD2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SISD2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SISD2FL1,KEY5;SCPSROW,SCPSCOL,SISD2MKY
          ELSE
            UPDATE    SISD2FL1;SCPSROW,SCPSCOL,SISD2MKY
          ENDIF
          RETURN
RDTSISD2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SISD2FL1,KEY5;SCPSROW,SCPSCOL,SISD2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSISD2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SISD2FL1,KEY5;;
          READKS    SISD2FL1;SCPSROW,SCPSCOL,SISD2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SISD2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Summary                   
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
          MOVE      "SISD2",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      FP08L000
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Summary                   
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L101,PS08L102,PS08L103,PS08L104:
                            PS08L105,PS08L106,PS08L107,PS08L108:
                            PS08L109,PS08L110,PS08L111,PS08L112:
                            PS08L113,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999
          GOTO     PS08L999
.
PS08L101
          MOVE      CVSCCON,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L102
          MOVE      CVSCDES,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L103
          UNPACK    CVSCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L104
          UNPACK    CVSCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L105
          MOVE      CVSFAQT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L106
          MOVE      CVSFAPC,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L107
          MOVE      CVSFEQT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L108
          MOVE      CVSFECT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L109
          MOVE      CVSDSUP,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L110
          UNPACK    CVSDSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L111
          MOVE      CVSDSUT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L112
          MOVE      CVMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L113
          MOVE      CVMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Summary                   
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L101,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L102:
                            SF08L103,SF08L104,SF08L105,SF08L006:
                            SF08L106
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L101,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          MOVE      "SISD2",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L101
          CALL      SELECTED
          BRANCH    EXIT,SF08L001
          COMPARE   ONE,ACCEPT
          GOTO      SF08L001 IF EQUAL
          CALL      RDTSISD2
          IF        OVRCD=1
            BEEP
            GOTO      SF08L001
          ENDIF
          MATCH     SP70,SISD2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF08L001
          ENDIF
          MOVE      SISD2MKY,KEY45 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELCON00
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSISD2
          IF        OVRCD=1
            CALL      FP08L000
          ELSE
            MOVE      SISD2MKY,KEY45 
            CALL      RSSISD2 
            CALL      RKSISD2 
            CALL      DP08L000
          ENDIF
          GOTO     SF08L001
.
SF08L102
          MOVE      "SISD2",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      NP08L000
          GOTO     SF08L001
.
SF08L103
          MOVE      "SISD2",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      PP08L000
          GOTO     SF08L001
.
SF08L104
          MOVE      "SISD2",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L105
          MOVE      "SISD2",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      LP08L000
          GOTO     SF08L001
.
SF08L106
          MOVE      ZERO,EXIT
          GOTO      SF08L999
SF08L990  MOVE      ONE,EXIT * Exit Char Restart
SF08L999  RETURN
.--------------------------------
. Screen - Requisitions Enquiry               
.--------------------------------
SC09L000
SC09L100
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC09L200
          CALL      CF09L000 * Clear Fields
SC09L300
          CALL      KY09L000 * Enter Key Fields
          BRANCH    EXIT,SC09L999,SC09L999
SC09L400
          CALL      WP09L000 * Load any WP Details
SC09L500
          CALL      LM09L000 * Load any Batch Details
SC09L600
          CALL      DF09L000 * Display Fields
SC09L700
          CALL      SF09L000 * Select Fields
          BRANCH    EXIT,SC09L100,SC09L100,SC09L200
SC09L800
SC09L900
SC09L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Requisitions Enquiry               
.-------------------------------------------------------
CF09L000
CF09L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Requisitions Enquiry               
.--------------------------------------------------------
KY09L000
.
KY09L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SICDDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSICD000
          BRANCH    EXIT,KY09L900,KY09L900
          MOVE      ZERO,ACCEPT
          MOVE      TYPEREQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SICDDESC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY09L999
.
KY09L900  MOVE      ONE,EXIT
KY09L999  RETURN
.---------------------------------------------------------
. Load WP files for : Requisitions Enquiry               
.---------------------------------------------------------
WP09L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Requisitions Enquiry               
.---------------------------------------------------------
LM09L000
.---------------------------------------------------------
. Load for :     6 Requisition Type                   
.---------------------------------------------------------
          UNPACK    SP70,SIRBCAT,SIRBTYP,SIRBREQ,SIRBWAR
          PACK      KEY20,SIIACAT,TYPEREQ,Z70
          MOVE      KEY20,SIRB2EKY
          STRIP     SIRB2SKY
          SETLPTR   SIRB2EKY,8
          MOVE      SIRB2EKY,SIRB2SKY
          CALL      RDSIRB2 
          IF        OVRCD=0
            CALL      RPSIRB2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP09L000
          MOVE     ZERO,SIRB2CNT
          MOVE     ZERO,SIRB2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP09L600
          MATCH    PRGID,SCPSPID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP09L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L101,DP09L010,DP09L010:
                            DP09L102,DP09L103,DP09L010,DP09L010:
                            DP09L104,DP09L105,DP09L106,DP09L107:
                            DP09L108,DP09L109,DP09L110,DP09L111:
                            DP09L112,DP09L113
          GOTO      DP09L010
.
DP09L101
          PACK      SIRB2MKY,SP70,SP70
          CALL      UPTSIRB2
          IF        SIRB2END=0
            CALL      RPSIRB2 
            IF        OVRCD=0
              PACK      SIRB2MKY,SIRBCAT,SIRBTYP,SIRBREQ,SIRBWAR                                                
              MATCH     SIRB2EKY,SIRB2MKY
              IF        @EQUAL
                MOVE      ZERO,SIRB2END
                ADD       ONE,SIRB2CNT
                CALL      UPTSIRB2
          CALL      REQDET00
                MOVE      SIRBTYP,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIRB2END
              ENDIF
            ELSE
              MOVE      ONE,SIRB2END
            ENDIF
          ENDIF
          IF        SIRB2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L102
          IF        SIRB2END=0
            MOVE      SIRBREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L103
          IF        SIRB2END=0
            MOVE      SIRBWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L104
          IF        SIRB2END=0
            MOVE      SIRBRQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L105
          IF        SIRB2END=0
            MOVE      SIRBIQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L106
          IF        SIRB2END=0
            MOVE      SIRBAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L107
          IF        SIRB2END=0
            UNPACK    SIRBDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L108
          IF        SIRB2END=0
            MOVE      SIRACST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L109
          IF        SIRB2END=0
            UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L110
          IF        SIRB2END=0
            MOVE      SIRADEL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L111
          IF        SIRB2END=0
            MOVE      REQINDIC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L112
          IF        SIRB2END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L113
          IF        SIRB2END=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
DP09L600
          MATCH    "SIRB2",NAMSSFFI
          GOTO     DP09L605 IF NOT EQUAL
          GOTO     DP09L999
DP09L605
DP09L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP09L000
.
          MATCH    "SIRB2",NAMSSFFI
          GOTO     FP09L105 IF NOT EQUAL
          PACK     KEY20,SIRB2SKY,Z70
          CALL     RDSIRB2  * Start
          IF       OVRCD=0
            CALL     RPSIRB2  * Start
          ENDIF
          CALL     DP09L000
          GOTO     FP09L999
FP09L105
FP09L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP09L000
.
          MATCH    "SIRB2",NAMSSFFI
          GOTO     LP09L105 IF NOT EQUAL
          PACK     KEY20,SIRB2SKY,SP70
          CALL     RSSIRB2  * End
          IF       OVRCD=1
            CALL     RKSIRB2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRB2SNO
            CALL     RKSIRB2 
            IF       OVRCD=1
              MOVE     SIRB2SNO,SECTOR
            ENDIF
            PACK     SIRB2MKY,SIRBCAT,SIRBTYP,SIRBREQ,SIRBWAR                                                
            MATCH    SIRB2EKY,SIRB2MKY
            IF       !@EQUAL
              MOVE     SIRB2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     LP09L999
LP09L105
LP09L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP09L000
.
          MATCH    "SIRB2",NAMSSFFI
          GOTO     PP09L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP09L105
          CALL      RFTSIRB2
          BRANCH   OVRCD,PP09L115
          MOVE      SIRB2MKY,KEY20 
          CALL      RSSIRB2 
PP09L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIRB2SNO
            CALL     RKSIRB2 
            IF       OVRCD=1
              MOVE     SIRB2SNO,SECTOR
            ENDIF
            PACK     SIRB2MKY,SIRBCAT,SIRBTYP,SIRBREQ,SIRBWAR                                                
            MATCH    SIRB2EKY,SIRB2MKY
            IF       !@EQUAL
              MOVE     SIRB2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     PP09L999
PP09L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRB2SNO
            CALL     RPSIRB2 
            IF       OVRCD=1
              MOVE     SIRB2SNO,SECTOR
            ENDIF
            PACK     SIRB2MKY,SIRBCAT,SIRBTYP,SIRBREQ,SIRBWAR                                                
            MATCH    SIRB2EKY,SIRB2MKY
            IF       !@EQUAL
              MOVE     SIRB2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP09L999
PP09L120
PP09L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP09L000
          MATCH    "SIRB2",NAMSSFFI
          GOTO     NP09L115 IF NOT EQUAL
NP09L105
          CALL     RPSIRB2 
          BRANCH   OVRCD,NP09L110
          PACK     SIRB2MKY,SIRBCAT,SIRBTYP,SIRBREQ,SIRBWAR                                                
          MATCH    SIRB2EKY,SIRB2MKY
          GOTO     NP09L110 IF NOT EQUAL
          CALL     RKSIRB2 
          CALL     DP09L000
          GOTO     NP09L999
NP09L110
          CALL     RKSIRB2 
          BEEP
          GOTO     NP09L999
NP09L115
NP09L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT09L000
CT09L105
CT09L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Requisitions Enquiry               
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     6 Requisition Type                   
.---------------------------------------------------------
UPTSIRB2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIRB2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIRB2FL1,KEY5;SCPSROW,SCPSCOL,SIRB2MKY
          ELSE
            UPDATE    SIRB2FL1;SCPSROW,SCPSCOL,SIRB2MKY
          ENDIF
          RETURN
RDTSIRB2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIRB2FL1,KEY5;SCPSROW,SCPSCOL,SIRB2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIRB2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIRB2FL1,KEY5;;
          READKS    SIRB2FL1;SCPSROW,SCPSCOL,SIRB2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIRB2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Requisitions Enquiry               
.---------------------------------------------------------
DF09L000
          BRANCH   ACCEPT,DF09L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF09L900
          MATCH    PRGID,SCPSPID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF09L010 IF NOT EQUAL
.
          CALL     PS09L000 * Display Field
          GOTO     DF09L010
DF09L900
          MOVE      "SIRB2",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP09L000
DF09L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Requisitions Enquiry               
.---------------------------------------------------------
PS09L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L101,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999
          GOTO     PS09L999
.
PS09L101
          MOVE      SICDDESC,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
PS09L999
          RETURN
.---------------------------------------------------------
. Selections for : Requisitions Enquiry               
.---------------------------------------------------------
SF09L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF09L001  BRANCH   ACCEPT,SF09L020
.
SF09L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L006,SF09L101,SF09L102,SF09L006:
                            SF09L006,SF09L103,SF09L104,SF09L105:
                            SF09L006,SF09L006,SF09L106,SF09L107:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006
SF09L006  BEEP
          GOTO     SF09L005
SF09L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF09L090
          MATCH    PRGID,SCSLPID
          GOTO     SF09L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF09L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L103,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020
          GOTO     SF09L020
SF09L090  MOVE     ZERO,ACCEPT
          MOVE      "SIRB2",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L101
          MOVE      ZERO,EXIT
          GOTO      SF09L999
.
SF09L102
          MOVE      ONE,EXIT
          GOTO      SF09L999
.
SF09L103
          CALL      SELECTED
          BRANCH    EXIT,SF09L001
          COMPARE   ONE,ACCEPT
          GOTO      SF09L001 IF EQUAL
          CALL      RDTSIRB2
          IF        OVRCD=1
            BEEP
            GOTO      SF09L001
          ENDIF
          MATCH     SP70,SIRB2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF09L001
          ENDIF
          MOVE      SIRB2MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELREQ00
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIRB2
          IF        OVRCD=1
            CALL      FP09L000
          ELSE
            MOVE      SIRB2MKY,KEY20 
            CALL      RSSIRB2 
            CALL      RKSIRB2 
            CALL      DP09L000
          ENDIF
          GOTO     SF09L001
.
SF09L104
          MOVE      "SIRB2",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      NP09L000
          GOTO     SF09L001
.
SF09L105
          MOVE      "SIRB2",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      PP09L000
          GOTO     SF09L001
.
SF09L106
          MOVE      "SIRB2",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L107
          MOVE      "SIRB2",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      LP09L000
          GOTO     SF09L001
SF09L990  MOVE      ONE,EXIT * Exit Char Restart
SF09L999  RETURN
.--------------------------------
. Screen - Supplier Details                   
.--------------------------------
SC10L000
SC10L100
          MOVE      "10",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC10L200
          CALL      CF10L000 * Clear Fields
SC10L300
          CALL      KY10L000 * Enter Key Fields
          BRANCH    EXIT,SC10L999,SC10L999
SC10L400
          CALL      WP10L000 * Load any WP Details
SC10L500
          CALL      LM10L000 * Load any Batch Details
SC10L600
          CALL      DF10L000 * Display Fields
SC10L700
          CALL      SF10L000 * Select Fields
          BRANCH    EXIT,SC10L100,SC10L100,SC10L200
SC10L800
SC10L900
SC10L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Supplier Details                   
.-------------------------------------------------------
CF10L000
CF10L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Details                   
.--------------------------------------------------------
KY10L000
          MOVE      ZERO,EXIT
          GOTO      KY10L999
.
KY10L900  MOVE      ONE,EXIT
KY10L999  RETURN
.---------------------------------------------------------
. Load WP files for : Supplier Details                   
.---------------------------------------------------------
WP10L000
          PREP     TEMPWORD,FILSIID1
          PACK     KEY15,SIICCAT,SIICSUP,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIID1 
          IF        OVRCD=0
            CALL      RPSIID1 
          ENDIF
WP10L100
          CALL     RKSIID1 
          BRANCH   OVRCD,WP10L105
          PACK     KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP10L105 IF NOT EQUAL
          PACK     VAR,SIIDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP10L100
WP10L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Supplier Details                   
.---------------------------------------------------------
LM10L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Supplier Details                   
.---------------------------------------------------------
DF10L000
          BRANCH   ACCEPT,DF10L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF10L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF10L900
          MATCH    PRGID,SCPSPID
          GOTO     DF10L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF10L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF10L010 IF NOT EQUAL
.
          CALL     PS10L000 * Display Field
          GOTO     DF10L010
DF10L900
DF10L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Supplier Details                   
.---------------------------------------------------------
PS10L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS10L101,PS10L102,PS10L103,PS10L104:
                            PS10L105,PS10L106,PS10L107,PS10L108:
                            PS10L109,PS10L110,PS10L111,PS10L112:
                            PS10L113,PS10L114,PS10L115,PS10L116:
                            PS10L117,PS10L118,PS10L119,PS10L120:
                            PS10L121,PS10L122,PS10L123,PS10L124:
                            PS10L125,PS10L126,PS10L127,PS10L128:
                            PS10L129,PS10L130,PS10L131,PS10L999:
                           PS10L132,PS10L133,PS10L134,PS10L135:
                            PS10L136,PS10L999,PS10L999,PS10L999:
                            PS10L999,PS10L137,PS10L138,PS10L139:
                            PS10L140,PS10L141,PS10L142,PS10L143:
                            PS10L144
          GOTO     PS10L999
.
PS10L101
          MOVE      SIICSUP,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L102
          MOVE      SIICSUT,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L103
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L104
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L105
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L106
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L107
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L108
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L111
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L112
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L113
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L114
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L115
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L116
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L119
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L120
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L121
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L122
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L123
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L124
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L125
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L126
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L127
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L132
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L133
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L134
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L135
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L136
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L137
          CALL      NSIID000
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L138
          MOVE     FILSIID1,WORDNAME
          CALL     DISPWORD
          GOTO     PS10L999
.
PS10L139
          MOVE      SIFACTOR,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L140
          MOVE      ISSLCOST,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L141
          MOVE      ISSCCOST,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L142
          MOVE      SIICUOM,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICCONT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L144
          UNPACK    SIICCTEX,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS10L999
PS10L999
          RETURN
.---------------------------------------------------------
. Selections for : Supplier Details                   
.---------------------------------------------------------
SF10L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF10L001  BRANCH   ACCEPT,SF10L020
.
SF10L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                           SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L101,SF10L006,SF10L102,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006
SF10L006  BEEP
          GOTO     SF10L005
SF10L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF10L090
          MATCH    PRGID,SCSLPID
          GOTO     SF10L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF10L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                           SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L102,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020
          GOTO     SF10L020
SF10L090  MOVE     ZERO,ACCEPT
          GOTO     SF10L001
.
SF10L101
          MOVE      ZERO,EXIT
          GOTO      SF10L999
.
SF10L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 8",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "14",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIID1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIID1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF10L001
SF10L990  MOVE      ONE,EXIT * Exit Char Restart
SF10L999  RETURN
.--------------------------------
. Screen - Warehouse Details                  
.--------------------------------
SC11L000
SC11L100
          MOVE      "11",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC11L200
          CALL      CF11L000 * Clear Fields
          CALL      SETBO000
SC11L300
          CALL      KY11L000 * Enter Key Fields
          BRANCH    EXIT,SC11L999,SC11L999
SC11L400
          CALL      WP11L000 * Load any WP Details
SC11L500
          CALL      LM11L000 * Load any Batch Details
SC11L600
          CALL      DF11L000 * Display Fields
SC11L700
          CALL      SF11L000 * Select Fields
          BRANCH    EXIT,SC11L100,SC11L100,SC11L200
SC11L800
SC11L900
SC11L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Warehouse Details                  
.-------------------------------------------------------
CF11L000
CF11L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Warehouse Details                  
.--------------------------------------------------------
KY11L000
          MOVE      ZERO,EXIT
          GOTO      KY11L999
.
KY11L900  MOVE      ONE,EXIT
KY11L999  RETURN
.---------------------------------------------------------
. Load WP files for : Warehouse Details                  
.---------------------------------------------------------
WP11L000
          PREP     TEMPWORD,FILSIIG1
          PACK     KEY15,SIIECAT,SIIEWAR,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIIG1 
          IF        OVRCD=0
            CALL      RPSIIG1 
          ENDIF
WP11L100
          CALL     RKSIIG1 
          BRANCH   OVRCD,WP11L105
          PACK     KEY15,SIIGCAT,SIIGWAR,SIIGLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP11L105 IF NOT EQUAL
          PACK     VAR,SIIGCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIGCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP11L100
WP11L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Warehouse Details                  
.---------------------------------------------------------
LM11L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Warehouse Details                  
.---------------------------------------------------------
DF11L000
          BRANCH   ACCEPT,DF11L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF11L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF11L900
          MATCH    PRGID,SCPSPID
          GOTO     DF11L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF11L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF11L010 IF NOT EQUAL
.
          CALL     PS11L000 * Display Field
          GOTO     DF11L010
DF11L900
DF11L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Warehouse Details                  
.---------------------------------------------------------
PS11L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS11L101,PS11L102,PS11L103,PS11L104:
                            PS11L105,PS11L106,PS11L107,PS11L108:
                            PS11L109,PS11L110,PS11L111,PS11L112:
                            PS11L113,PS11L114,PS11L115,PS11L116:
                            PS11L117,PS11L118,PS11L119,PS11L120:
                            PS11L121,PS11L122,PS11L123,PS11L124:
                            PS11L125,PS11L126,PS11L127,PS11L999:
                            PS11L999,PS11L128,PS11L129
          GOTO     PS11L999
.
PS11L101
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L102
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L103
          MOVE      SIIERAS,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L104
          MOVE      SIIESOH,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L105
          MOVE      SIIESOO,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L106
          MOVE      SIIEROQ,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L107
          MOVE      SIIEROL,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESTI,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L109
          UNPACK    SIIESTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESIC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L112
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L113
          MOVE      SIIESUS,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L114
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L115
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L116
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L117
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L118
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L119
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L122
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L123
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L124
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L125
          CALL      NSIIG000
          MOVE      NOTESIIG,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L126
          MOVE     FILSIIG1,WORDNAME
          CALL     DISPWORD
          GOTO     PS11L999
.
PS11L127
          MOVE      SUSPDES1,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L128
          MOVE      BOCOST,VAR       
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L129
          MOVE      BOTOTAL,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
PS11L999
          RETURN
.---------------------------------------------------------
. Selections for : Warehouse Details                  
.---------------------------------------------------------
SF11L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF11L001  BRANCH   ACCEPT,SF11L020
.
SF11L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L101,SF11L006,SF11L006:
                            SF11L102,SF11L006,SF11L006
SF11L006  BEEP
          GOTO     SF11L005
SF11L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF11L090
          MATCH    PRGID,SCSLPID
          GOTO     SF11L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF11L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L101,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020
          GOTO     SF11L020
SF11L090  MOVE     ZERO,ACCEPT
          GOTO     SF11L001
.
SF11L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIG1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIG1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF11L001
.
SF11L102
          MOVE      ZERO,EXIT
          GOTO      SF11L999
SF11L990  MOVE      ONE,EXIT * Exit Char Restart
SF11L999  RETURN
.--------------------------------
. Screen - Item History Detail Screen         
.--------------------------------
SC12L000
SC12L100
          MOVE      "12",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC12L200
          CALL      CF12L000 * Clear Fields
SC12L300
          CALL      KY12L000 * Enter Key Fields
          BRANCH    EXIT,SC12L999,SC12L999
SC12L400
          CALL      WP12L000 * Load any WP Details
SC12L500
          CALL      LM12L000 * Load any Batch Details
SC12L600
          CALL      DF12L000 * Display Fields
SC12L700
          CALL      SF12L000 * Select Fields
          BRANCH    EXIT,SC12L100,SC12L100,SC12L200
SC12L800
SC12L900
SC12L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Item History Detail Screen         
.-------------------------------------------------------
CF12L000
CF12L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Item History Detail Screen         
.--------------------------------------------------------
KY12L000
          MOVE      ZERO,EXIT
          GOTO      KY12L999
.
KY12L900  MOVE      ONE,EXIT
KY12L999  RETURN
.---------------------------------------------------------
. Load WP files for : Item History Detail Screen         
.---------------------------------------------------------
WP12L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Item History Detail Screen         
.---------------------------------------------------------
LM12L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Item History Detail Screen         
.---------------------------------------------------------
DF12L000
          BRANCH   ACCEPT,DF12L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF12L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF12L900
          MATCH    PRGID,SCPSPID
          GOTO     DF12L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF12L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF12L010 IF NOT EQUAL
.
          CALL     PS12L000 * Display Field
          GOTO     DF12L010
DF12L900
DF12L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Item History Detail Screen         
.---------------------------------------------------------
PS12L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS12L101,PS12L102,PS12L103,PS12L104:
                            PS12L105,PS12L106,PS12L107,PS12L108:
                            PS12L109,PS12L110,PS12L111,PS12L112:
                            PS12L113,PS12L114,PS12L115,PS12L116:
                            PS12L999,PS12L999,PS12L117,PS12L118:
                            PS12L119
          GOTO     PS12L999
.
PS12L101
          UNPACK    SIITDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L102
          MOVE      SIITTIM,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L103
          MOVE      SIITOPR,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L104
          MOVE      SIITPOR,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L105
          MOVE      SIITPRG,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L106
          MOVE      SIITPER,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L107
          MOVE      SIITQTY,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L108
          MOVE      SIITAMT,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L109
          MOVE      SIITTYP,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L110
          MOVE      SIITCST,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L111
          MOVE      SIITREQ,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L112
          MOVE      SIITPUR,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L113
          MOVE      SIITREF,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L114
          MOVE      TRANDESC,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L115
          MOVE      USAGEPER,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L116
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L117
          MOVE      SIITSOH,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L118
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L119
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
PS12L999
          RETURN
.---------------------------------------------------------
. Selections for : Item History Detail Screen         
.---------------------------------------------------------
SF12L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF12L001  BRANCH   ACCEPT,SF12L020
.
SF12L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L101,SF12L006,SF12L006:
                            SF12L006
SF12L006  BEEP
          GOTO     SF12L005
SF12L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF12L090
          MATCH    PRGID,SCSLPID
          GOTO     SF12L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF12L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020
          GOTO     SF12L020
SF12L090  MOVE     ZERO,ACCEPT
          GOTO     SF12L001
.
SF12L101
          MOVE      ZERO,EXIT
          GOTO      SF12L999
SF12L990  MOVE      ONE,EXIT * Exit Char Restart
SF12L999  RETURN
.--------------------------------
. Screen - Contract Detail Display            
.--------------------------------
SC13L000
SC13L100
          MOVE      "13",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   56",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC13L200
          CALL      CF13L000 * Clear Fields
SC13L300
          CALL      KY13L000 * Enter Key Fields
          BRANCH    EXIT,SC13L999,SC13L999
SC13L400
          CALL      WP13L000 * Load any WP Details
SC13L500
          CALL      LM13L000 * Load any Batch Details
SC13L600
          CALL      DF13L000 * Display Fields
SC13L700
          CALL      SF13L000 * Select Fields
          BRANCH    EXIT,SC13L100,SC13L100,SC13L200
SC13L800
SC13L900
SC13L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Detail Display            
.-------------------------------------------------------
CF13L000
CF13L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Detail Display            
.--------------------------------------------------------
KY13L000
          MOVE      ZERO,EXIT
          GOTO      KY13L999
.
KY13L900  MOVE      ONE,EXIT
KY13L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Detail Display            
.---------------------------------------------------------
WP13L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Detail Display            
.---------------------------------------------------------
LM13L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Detail Display            
.---------------------------------------------------------
DF13L000
          BRANCH   ACCEPT,DF13L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF13L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF13L900
          MATCH    PRGID,SCPSPID
          GOTO     DF13L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF13L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF13L010 IF NOT EQUAL
.
          CALL     PS13L000 * Display Field
          GOTO     DF13L010
DF13L900
DF13L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Detail Display            
.---------------------------------------------------------
PS13L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS13L101,PS13L102,PS13L103,PS13L104:
                            PS13L105,PS13L106,PS13L107,PS13L108:
                            PS13L109,PS13L110,PS13L111,PS13L112:
                            PS13L113,PS13L114,PS13L115,PS13L116:
                            PS13L117,PS13L118,PS13L119,PS13L120:
                            PS13L121,PS13L122,PS13L123,PS13L124:
                            PS13L125,PS13L126,PS13L127,PS13L128:
                            PS13L129,PS13L130,PS13L131,PS13L132:
                            PS13L133,PS13L134,PS13L135,PS13L136:
                            PS13L137,PS13L138,PS13L139,PS13L140:
                            PS13L141,PS13L142,PS13L143,PS13L144:
                            PS13L145,PS13L146,PS13L147,PS13L148:
                            PS13L149,PS13L150,PS13L151,PS13L152:
                            PS13L153,PS13L154,PS13L155,PS13L999:
                            PS13L999
          GOTO     PS13L999
.
PS13L101
          MOVE      SISCCON,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L102
          MOVE      SISCDES,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L103
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L104
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L105
          MOVE      SISCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L106
          MOVE      SISCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L107
          UNPACK    SISCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L108
          UNPACK    SISCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L109
          MOVE      SISCUC1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L110
          MOVE      SISCUC2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L113
          MOVE      SISDSUP,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L114
          UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L115
          MOVE      SISDSUT,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L116
          MOVE      SISDUC1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L117
          MOVE      SISDUC2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L118
          MOVE      SISDUC3,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L119
          MOVE      SISDUC4,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L120
          MOVE      SISDBQ1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L121
          MOVE      SISDBQ2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L122
          MOVE      SISDBQ3,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L123
          MOVE      SISDMQT,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L124
          MOVE      SISDPO1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L125
          MOVE      SISDPO2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L126
          MOVE      SISDUR1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L127
          MOVE      SISDUR2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L128
          UNPACK    SISDUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L129
          UNPACK    SISDUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISDUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISDUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L132
          MOVE      SISFAQT,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L133
          MOVE      SISFAPC,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L134
          MOVE      SISFEQT,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L135
          MOVE      SISFECT,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L136
          MOVE      SISFUR1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L137
          MOVE      SISFUR2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L138
          UNPACK    SISFUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L139
          UNPACK    SISFUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L140
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISFUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L141
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISFUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L142
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L143
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L144
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L145
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L146
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L147
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L148
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L149
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L150
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L151
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L152
          MOVE      APMAHOR,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L153
          MOVE      APMAHIN,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L154
          MOVE      APMAHCR,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L155
          MOVE      APMAHPY,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
PS13L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Detail Display            
.---------------------------------------------------------
SF13L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF13L001  BRANCH   ACCEPT,SF13L020
.
SF13L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L101
SF13L006  BEEP
          GOTO     SF13L005
SF13L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF13L090
          MATCH    PRGID,SCSLPID
          GOTO     SF13L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF13L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020
          GOTO     SF13L020
SF13L090  MOVE     ZERO,ACCEPT
          GOTO     SF13L001
.
SF13L101
          MOVE      ZERO,EXIT
          GOTO      SF13L999
SF13L990  MOVE      ONE,EXIT * Exit Char Restart
SF13L999  RETURN
.--------------------------------
. Screen - Purchase Order Details             
.--------------------------------
SC14L000
SC14L100
          MOVE      "14",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC14L200
          CALL      CF14L000 * Clear Fields
SC14L300
          CALL      KY14L000 * Enter Key Fields
          BRANCH    EXIT,SC14L999,SC14L999
SC14L400
          CALL      WP14L000 * Load any WP Details
SC14L500
          CALL      LM14L000 * Load any Batch Details
SC14L600
          CALL      DF14L000 * Display Fields
SC14L700
          CALL      SF14L000 * Select Fields
          BRANCH    EXIT,SC14L100,SC14L100,SC14L200
SC14L800
SC14L900
SC14L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Details             
.-------------------------------------------------------
CF14L000
CF14L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Details             
.--------------------------------------------------------
KY14L000
          MOVE      ZERO,EXIT
          GOTO      KY14L999
.
KY14L900  MOVE      ONE,EXIT
KY14L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Details             
.---------------------------------------------------------
WP14L000
          PREP     TEMPWORD,FILSIPD1
          PACK     KEY13,SIPCPON,SIPCITM,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDSIPD1 
          IF        OVRCD=0
            CALL      RPSIPD1 
          ENDIF
WP14L100
          CALL     RKSIPD1 
          BRANCH   OVRCD,WP14L105
          PACK     KEY13,SIPDPON,SIPDITM,SIPDLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP14L105 IF NOT EQUAL
          PACK     VAR,SIPDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP14L100
WP14L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Details             
.---------------------------------------------------------
LM14L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Details             
.---------------------------------------------------------
DF14L000
          BRANCH   ACCEPT,DF14L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF14L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF14L900
          MATCH    PRGID,SCPSPID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF14L010 IF NOT EQUAL
.
          CALL     PS14L000 * Display Field
          GOTO     DF14L010
DF14L900
DF14L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Details             
.---------------------------------------------------------
PS14L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS14L999,PS14L999,PS14L101,PS14L102:
                            PS14L103,PS14L104,PS14L105,PS14L106:
                            PS14L107,PS14L108,PS14L109,PS14L110:
                            PS14L111,PS14L112,PS14L113,PS14L114:
                            PS14L115,PS14L116,PS14L117,PS14L118:
                            PS14L119,PS14L120,PS14L121,PS14L122:
                            PS14L123,PS14L124,PS14L125,PS14L126:
                            PS14L127,PS14L128,PS14L129,PS14L130:
                            PS14L131,PS14L132,PS14L133,PS14L134:
                            PS14L135,PS14L136,PS14L137,PS14L138:
                            PS14L139,PS14L140,PS14L141,PS14L142:
                            PS14L143,PS14L144,PS14L145,PS14L146:
                            PS14L147,PS14L148,PS14L149,PS14L150:
                            PS14L151,PS14L152,PS14L153,PS14L154:
                            PS14L155,PS14L156,PS14L157,PS14L158:
                            PS14L159,PS14L160,PS14L161,PS14L162:
                            PS14L163,PS14L164
          GOTO     PS14L999
.
PS14L101
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L102
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L103
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L104
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L105
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L106
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L107
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L108
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L109
          UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L110
          UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L111
          UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L112
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L113
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L114
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L115
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L116
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L117
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L120
          MOVE      SIPCITM,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L121
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L122
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L123
          UNPACK    SIPCFDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L124
          MOVE      SIPCWAR,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L125
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L126
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L127
          MOVE      ITEMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L128
          MOVE      SIPCCON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L129
          UNPACK    SIPCCDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L130
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L131
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L132
          MOVE      ORDQTY,VAR       
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L133
          MOVE      SIPCIQT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L134
          MOVE      SIPCRQT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L135
          MOVE      ITEMCOST,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L136
          MOVE      SIPCTCR,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L137
          MOVE      SIPCTIN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L138
          MOVE      SIPCOQO,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L139
          MOVE      SIPCOOP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L140
          MOVE      SIPCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L141
          MOVE      SIPCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L142
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L143
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L145
          MOVE      SIPCUY2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L146
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L147
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L148
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L149
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L150
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L151
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L152
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L153
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L154
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L155
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L156
          MOVE     FILSIPD1,WORDNAME
          CALL     DISPWORD
          GOTO     PS14L999
.
PS14L157
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L158
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L159
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L160
          MOVE      SICAGL,VAR       
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L161
          MOVE      SICADAD1,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L162
          MOVE      SICADAD2,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L163
          MOVE      SICADAD3,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L164
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
PS14L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Details             
.---------------------------------------------------------
SF14L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF14L001  BRANCH   ACCEPT,SF14L020
.
SF14L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L006,SF14L101,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L102,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006
SF14L006  BEEP
          GOTO     SF14L005
SF14L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF14L090
          MATCH    PRGID,SCSLPID
          GOTO     SF14L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF14L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L102,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020
          GOTO     SF14L020
SF14L090  MOVE     ZERO,ACCEPT
          GOTO     SF14L001
.
SF14L101
          MOVE      ZERO,EXIT
          GOTO      SF14L999
.
SF14L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPD1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPD1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF14L001
SF14L990  MOVE      ONE,EXIT * Exit Char Restart
SF14L999  RETURN
.--------------------------------
. Screen - Requisition Details                
.--------------------------------
SC15L000
SC15L100
          MOVE      "15",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC15L200
          CALL      CF15L000 * Clear Fields
SC15L300
          CALL      KY15L000 * Enter Key Fields
          BRANCH    EXIT,SC15L999,SC15L999
SC15L400
          CALL      WP15L000 * Load any WP Details
SC15L500
          CALL      LM15L000 * Load any Batch Details
SC15L600
          CALL      DF15L000 * Display Fields
SC15L700
          CALL      SF15L000 * Select Fields
          BRANCH    EXIT,SC15L100,SC15L100,SC15L200
SC15L800
SC15L900
SC15L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Requisition Details                
.-------------------------------------------------------
CF15L000
CF15L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Requisition Details                
.--------------------------------------------------------
KY15L000
          MOVE      ZERO,EXIT
          GOTO      KY15L999
.
KY15L900  MOVE      ONE,EXIT
KY15L999  RETURN
.---------------------------------------------------------
. Load WP files for : Requisition Details                
.---------------------------------------------------------
WP15L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Requisition Details                
.---------------------------------------------------------
LM15L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Requisition Details                
.---------------------------------------------------------
DF15L000
          BRANCH   ACCEPT,DF15L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF15L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF15L900
          MATCH    PRGID,SCPSPID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF15L010 IF NOT EQUAL
.
          CALL     PS15L000 * Display Field
          GOTO     DF15L010
DF15L900
DF15L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Requisition Details                
.---------------------------------------------------------
PS15L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS15L999,PS15L999,PS15L999,PS15L999:
                           PS15L999,PS15L101,PS15L999,PS15L999:
                           PS15L102,PS15L103,PS15L999,PS15L999:
                           PS15L104,PS15L105,PS15L106,PS15L107:
                            PS15L108,PS15L109,PS15L110,PS15L111:
                            PS15L112,PS15L113
          GOTO     PS15L999
.
PS15L101
          CALL      REQDET00
          MOVE      SIRBTYP,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L102
          MOVE      SIRBREQ,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L103
          MOVE      SIRBWAR,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L104
          MOVE      SIRBRQT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L105
          MOVE      SIRBIQT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L106
          MOVE      SIRBAMT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L107
          UNPACK    SIRBDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L108
          MOVE      SIRACST,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L109
          UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L110
          MOVE      SIRADEL,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L111
          MOVE      REQINDIC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L112
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L113
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
PS15L999
          RETURN
.---------------------------------------------------------
. Selections for : Requisition Details                
.---------------------------------------------------------
SF15L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF15L001  BRANCH   ACCEPT,SF15L020
.
SF15L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L006,SF15L101,SF15L006,SF15L006:
                           SF15L006,SF15L006,SF15L006,SF15L006:
                           SF15L006,SF15L006,SF15L006,SF15L006:
                           SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006
SF15L006  BEEP
          GOTO     SF15L005
SF15L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF15L090
          MATCH    PRGID,SCSLPID
          GOTO     SF15L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF15L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L020,SF15L020,SF15L020,SF15L020:
                           SF15L020,SF15L020,SF15L020,SF15L020:
                           SF15L020,SF15L020,SF15L020,SF15L020:
                           SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020
          GOTO     SF15L020
SF15L090  MOVE     ZERO,ACCEPT
          GOTO     SF15L001
.
SF15L101
          MOVE      ZERO,EXIT
          GOTO      SF15L999
SF15L990  MOVE      ONE,EXIT * Exit Char Restart
SF15L999  RETURN
.--------------------------------
. Screen - Outstanding Orders                 
.--------------------------------
SC16L000
SC16L100
          MOVE      "16",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC16L200
          CALL      CF16L000 * Clear Fields
SC16L300
          CALL      KY16L000 * Enter Key Fields
          BRANCH    EXIT,SC16L999,SC16L999
SC16L400
          CALL      WP16L000 * Load any WP Details
SC16L500
          CALL      LM16L000 * Load any Batch Details
SC16L600
          CALL      DF16L000 * Display Fields
SC16L700
          CALL      SF16L000 * Select Fields
          BRANCH    EXIT,SC16L100,SC16L100,SC16L200
SC16L800
SC16L900
SC16L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Outstanding Orders                 
.-------------------------------------------------------
CF16L000
CF16L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Outstanding Orders                 
.--------------------------------------------------------
KY16L000
          MOVE      ZERO,EXIT
          GOTO      KY16L999
.
KY16L900  MOVE      ONE,EXIT
KY16L999  RETURN
.---------------------------------------------------------
. Load WP files for : Outstanding Orders                 
.---------------------------------------------------------
WP16L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Outstanding Orders                 
.---------------------------------------------------------
LM16L000
.---------------------------------------------------------
. Load for :     3 Purchase Order Number              
.---------------------------------------------------------
          UNPACK    SP70,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM
          PACK      KEY25,SIIACAT,ONE,SP70
          MOVE      KEY25,SIPC6EKY
          STRIP     SIPC6SKY
          SETLPTR   SIPC6EKY,7
          MOVE      SIPC6EKY,SIPC6SKY
          CALL      RDSIPC6 
          IF        OVRCD=0
            CALL      RPSIPC6 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP16L000
          MOVE     ZERO,SIPC6CNT
          MOVE     ZERO,SIPC6END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP16L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP16L600
          MATCH    PRGID,SCPSPID
          GOTO     DP16L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP16L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP16L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP16L010,DP16L010,DP16L101,DP16L102:
                            DP16L103,DP16L104,DP16L105,DP16L106:
                            DP16L107,DP16L108,DP16L109,DP16L110:
                            DP16L111,DP16L112,DP16L113,DP16L114:
                            DP16L115,DP16L010,DP16L010,DP16L010:
                           DP16L010,DP16L010,DP16L010
          GOTO      DP16L010
.
DP16L101
          PACK      SIPC6MKY,SP70,SP70
          CALL      UPTSIPC6
          IF        SIPC6END=0
            CALL      RKSIPC6 
            IF        OVRCD=0
              PACK      SIPC6MKY,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM                                                
              MATCH     SIPC6EKY,SIPC6MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC6END
                ADD       ONE,SIPC6CNT
                CALL      UPTSIPC6
          CALL      CHKDET00
                MOVE      SIPCPON,VAR      
                CALL      DISPITEM
          CALL      OUTDET00
              ELSE
                MOVE      ONE,SIPC6END
              ENDIF
            ELSE
              MOVE      ONE,SIPC6END
            ENDIF
          ENDIF
          IF        SIPC6END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L102
          IF        SIPC6END=0
            MOVE      SIPCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L103
          IF        SIPC6END=0
            MOVE      SIPCITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L104
          IF        SIPC6END=0
            MOVE      PERUSAGE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L105
          IF        SIPC6END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L106
          IF        SIPC6END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L107
          IF        SIPC6END=0
            UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L108
          IF        SIPC6END=0
            MOVE      OUTQTY,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L109
          IF        SIPC6END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L110
          IF        SIPC6END=0
            MOVE      ITEMCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L111
          IF        SIPC6END=0
            MOVE      SIPASUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L112
          IF        SIPC6END=0
            UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L113
          IF        SIPC6END=0
            UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L114
          IF        SIPC6END=0
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L115
          IF        SIPC6END=0
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
DP16L600
          MATCH    "SIPC6",NAMSSFFI
          GOTO     DP16L605 IF NOT EQUAL
          GOTO     DP16L999
DP16L605
DP16L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP16L000
.
          MATCH    "SIPC6",NAMSSFFI
          GOTO     FP16L105 IF NOT EQUAL
          PACK     KEY25,SIPC6SKY,SP70
          CALL     RDSIPC6  * Start
          IF       OVRCD=0
            CALL     RPSIPC6  * Start
          ENDIF
          CALL     DP16L000
          GOTO     FP16L999
FP16L105
FP16L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP16L000
.
          MATCH    "SIPC6",NAMSSFFI
          GOTO     LP16L105 IF NOT EQUAL
          PACK     KEY25,SIPC6SKY,Z70
          CALL     RSSIPC6  * End
          IF       OVRCD=1
            CALL     RPSIPC6 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC6SNO
            CALL     RPSIPC6 
            IF       OVRCD=1
              MOVE     SIPC6SNO,SECTOR
            ENDIF
            PACK     SIPC6MKY,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM                                                
            MATCH    SIPC6EKY,SIPC6MKY
            IF       !@EQUAL
              MOVE     SIPC6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP16L000
          GOTO     LP16L999
LP16L105
LP16L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP16L000
.
          MATCH    "SIPC6",NAMSSFFI
          GOTO     PP16L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP16L105
          CALL      RFTSIPC6
          BRANCH   OVRCD,PP16L115
          MOVE      SIPC6MKY,KEY25 
          CALL      RSSIPC6 
PP16L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC6SNO
            CALL     RPSIPC6 
            IF       OVRCD=1
              MOVE     SIPC6SNO,SECTOR
            ENDIF
            PACK     SIPC6MKY,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM                                                
            MATCH    SIPC6EKY,SIPC6MKY
            IF       !@EQUAL
              MOVE     SIPC6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP16L000
          GOTO     PP16L999
PP16L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC6SNO
            CALL     RKSIPC6 
            IF       OVRCD=1
              MOVE     SIPC6SNO,SECTOR
            ENDIF
            PACK     SIPC6MKY,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM                                                
            MATCH    SIPC6EKY,SIPC6MKY
            IF       !@EQUAL
              MOVE     SIPC6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP16L999
PP16L120
PP16L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP16L000
          MATCH    "SIPC6",NAMSSFFI
          GOTO     NP16L115 IF NOT EQUAL
NP16L105
          CALL     RKSIPC6 
          BRANCH   OVRCD,NP16L110
          PACK     SIPC6MKY,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM                                                
          MATCH    SIPC6EKY,SIPC6MKY
          GOTO     NP16L110 IF NOT EQUAL
          CALL     RPSIPC6 
          CALL     DP16L000
          GOTO     NP16L999
NP16L110
          CALL     RPSIPC6 
          BEEP
          GOTO     NP16L999
NP16L115
NP16L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT16L000
CT16L105
CT16L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Outstanding Orders                 
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Purchase Order Number              
.---------------------------------------------------------
UPTSIPC6
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC6FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC6FL1,KEY5;SCPSROW,SCPSCOL,SIPC6MKY
          ELSE
            UPDATE    SIPC6FL1;SCPSROW,SCPSCOL,SIPC6MKY
          ENDIF
          RETURN
RDTSIPC6
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC6FL1,KEY5;SCPSROW,SCPSCOL,SIPC6MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC6
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC6FL1,KEY5;;
          READKS    SIPC6FL1;SCPSROW,SCPSCOL,SIPC6MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC6MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Outstanding Orders                 
.---------------------------------------------------------
DF16L000
          BRANCH   ACCEPT,DF16L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF16L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF16L900
          MATCH    PRGID,SCPSPID
          GOTO     DF16L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF16L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF16L010 IF NOT EQUAL
.
          CALL     PS16L000 * Display Field
          GOTO     DF16L010
DF16L900
          MOVE      "SIPC6",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP16L000
DF16L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Outstanding Orders                 
.---------------------------------------------------------
PS16L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                           PS16L999,PS16L999,PS16L999
          GOTO     PS16L999
PS16L999
          RETURN
.---------------------------------------------------------
. Selections for : Outstanding Orders                 
.---------------------------------------------------------
SF16L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF16L001  BRANCH   ACCEPT,SF16L020
.
SF16L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF16L006,SF16L101,SF16L102,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L006,SF16L103,SF16L104,SF16L006:
                           SF16L006,SF16L105,SF16L106
SF16L006  BEEP
          GOTO     SF16L005
SF16L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF16L090
          MATCH    PRGID,SCSLPID
          GOTO     SF16L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF16L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF16L020,SF16L020,SF16L102,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                           SF16L020,SF16L020,SF16L020
          GOTO     SF16L020
SF16L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC6",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP16L000
          GOTO     SF16L001
.
SF16L101
          MOVE      ZERO,EXIT
          GOTO      SF16L999
.
SF16L102
          CALL      SELECTED
          BRANCH    EXIT,SF16L001
          COMPARE   ONE,ACCEPT
          GOTO      SF16L001 IF EQUAL
          CALL      RDTSIPC6
          IF        OVRCD=1
            BEEP
            GOTO      SF16L001
          ENDIF
          MATCH     SP70,SIPC6MKY
          IF        @EQUAL
            BEEP
            GOTO      SF16L001
          ENDIF
          MOVE      SIPC6MKY,KEY25 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELORD00
          MOVE      "16",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC6
          IF        OVRCD=1
            CALL      FP16L000
          ELSE
            MOVE      SIPC6MKY,KEY25 
            CALL      RSSIPC6 
            CALL      RPSIPC6 
            CALL      DP16L000
          ENDIF
          GOTO     SF16L001
.
SF16L103
          MOVE      "SIPC6",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP16L000
          GOTO     SF16L001
.
SF16L104
          MOVE      "SIPC6",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP16L000
          GOTO     SF16L001
.
SF16L105
          MOVE      "SIPC6",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP16L000
          GOTO     SF16L001
.
SF16L106
          MOVE      "SIPC6",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP16L000
          GOTO     SF16L001
SF16L990  MOVE      ONE,EXIT * Exit Char Restart
SF16L999  RETURN
.--------------------------------
. Screen - Backorder Details Screen           
.--------------------------------
SC17L000
SC17L100
          MOVE      "17",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC17L200
          CALL      CF17L000 * Clear Fields
SC17L300
          CALL      KY17L000 * Enter Key Fields
          BRANCH    EXIT,SC17L999,SC17L999
SC17L400
          CALL      WP17L000 * Load any WP Details
SC17L500
          CALL      LM17L000 * Load any Batch Details
SC17L600
          CALL      DF17L000 * Display Fields
SC17L700
          CALL      SF17L000 * Select Fields
          BRANCH    EXIT,SC17L100,SC17L100,SC17L200
SC17L800
SC17L900
SC17L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Backorder Details Screen           
.-------------------------------------------------------
CF17L000
CF17L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Backorder Details Screen           
.--------------------------------------------------------
KY17L000
.
KY17L110
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EBWAR000
          BRANCH    EXIT,KY17L900,KY17L900
          MOVE      ZERO,ACCEPT
          MOVE      SIWAWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY17L999
.
KY17L900  MOVE      ONE,EXIT
KY17L999  RETURN
.---------------------------------------------------------
. Load WP files for : Backorder Details Screen           
.---------------------------------------------------------
WP17L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Backorder Details Screen           
.---------------------------------------------------------
LM17L000
.---------------------------------------------------------
. Load for :     8 Cost Centre                        
.---------------------------------------------------------
          UNPACK    SP70,SIBACAT,SIBAWAR,SIBACST,SIBAREQ
          PACK      KEY25,SIIACAT,SIWAWAR,SP70
          MOVE      KEY25,SIBA3EKY
          STRIP     SIBA3SKY
          SETLPTR   SIBA3EKY,12
          MOVE      SIBA3EKY,SIBA3SKY
          CALL      RDSIBA3 
          IF        OVRCD=0
            CALL      RPSIBA3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP17L000
          MOVE     ZERO,SIBA3CNT
          MOVE     ZERO,SIBA3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP17L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP17L600
          MATCH    PRGID,SCPSPID
          GOTO     DP17L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP17L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP17L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP17L010,DP17L010,DP17L010,DP17L010:
                            DP17L010,DP17L010,DP17L010,DP17L101:
                            DP17L102,DP17L103,DP17L104,DP17L105:
                            DP17L106,DP17L107,DP17L010,DP17L010:
                            DP17L010,DP17L010,DP17L010,DP17L010
          GOTO      DP17L010
.
DP17L101
          PACK      SIBA3MKY,SP70,SP70
          CALL      UPTSIBA3
          IF        SIBA3END=0
            CALL      RKSIBA3 
            IF        OVRCD=0
              PACK      SIBA3MKY,SIBACAT,SIBAWAR,SIBACST,SIBAREQ                                                
              MATCH     SIBA3EKY,SIBA3MKY
              IF        @EQUAL
                MOVE      ZERO,SIBA3END
                ADD       ONE,SIBA3CNT
                CALL      UPTSIBA3
                MOVE      SIBACST,VAR      
                CALL      DISPITEM
          CALL      REDITM00
              ELSE
                MOVE      ONE,SIBA3END
              ENDIF
            ELSE
              MOVE      ONE,SIBA3END
            ENDIF
          ENDIF
          IF        SIBA3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L102
          IF        SIBA3END=0
            MOVE      SIBAREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L103
          IF        SIBA3END=0
            UNPACK    SIBADAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L104
          IF        SIBA3END=0
            MOVE      SIBAQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L105
          IF        SIBA3END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L106
          IF        SIBA3END=0
            MOVE      SICACONT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L107
          IF        SIBA3END=0
            MOVE      SICATELE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
DP17L600
          MATCH    "SIBA3",NAMSSFFI
          GOTO     DP17L605 IF NOT EQUAL
          GOTO     DP17L999
DP17L605
DP17L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP17L000
.
          MATCH    "SIBA3",NAMSSFFI
          GOTO     FP17L105 IF NOT EQUAL
          PACK     KEY25,SIBA3SKY,SP70
          CALL     RDSIBA3  * Start
          IF       OVRCD=0
            CALL     RPSIBA3  * Start
          ENDIF
          CALL     DP17L000
          GOTO     FP17L999
FP17L105
FP17L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP17L000
.
          MATCH    "SIBA3",NAMSSFFI
          GOTO     LP17L105 IF NOT EQUAL
          PACK     KEY25,SIBA3SKY,Z70
          CALL     RSSIBA3  * End
          IF       OVRCD=1
            CALL     RPSIBA3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIBA3SNO
            CALL     RPSIBA3 
            IF       OVRCD=1
              MOVE     SIBA3SNO,SECTOR
            ENDIF
            PACK     SIBA3MKY,SIBACAT,SIBAWAR,SIBACST,SIBAREQ                                                
            MATCH    SIBA3EKY,SIBA3MKY
            IF       !@EQUAL
              MOVE     SIBA3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP17L000
          GOTO     LP17L999
LP17L105
LP17L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP17L000
.
          MATCH    "SIBA3",NAMSSFFI
          GOTO     PP17L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP17L105
          CALL      RFTSIBA3
          BRANCH   OVRCD,PP17L115
          MOVE      SIBA3MKY,KEY25 
          CALL      RSSIBA3 
PP17L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIBA3SNO
            CALL     RPSIBA3 
            IF       OVRCD=1
              MOVE     SIBA3SNO,SECTOR
            ENDIF
            PACK     SIBA3MKY,SIBACAT,SIBAWAR,SIBACST,SIBAREQ                                                
            MATCH    SIBA3EKY,SIBA3MKY
            IF       !@EQUAL
              MOVE     SIBA3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP17L000
          GOTO     PP17L999
PP17L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIBA3SNO
            CALL     RKSIBA3 
            IF       OVRCD=1
              MOVE     SIBA3SNO,SECTOR
            ENDIF
            PACK     SIBA3MKY,SIBACAT,SIBAWAR,SIBACST,SIBAREQ                                                
            MATCH    SIBA3EKY,SIBA3MKY
            IF       !@EQUAL
              MOVE     SIBA3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP17L999
PP17L120
PP17L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP17L000
          MATCH    "SIBA3",NAMSSFFI
          GOTO     NP17L115 IF NOT EQUAL
NP17L105
          CALL     RKSIBA3 
          BRANCH   OVRCD,NP17L110
          PACK     SIBA3MKY,SIBACAT,SIBAWAR,SIBACST,SIBAREQ                                                
          MATCH    SIBA3EKY,SIBA3MKY
          GOTO     NP17L110 IF NOT EQUAL
          CALL     RPSIBA3 
          CALL     DP17L000
          GOTO     NP17L999
NP17L110
          CALL     RPSIBA3 
          BEEP
          GOTO     NP17L999
NP17L115
NP17L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT17L000
CT17L105
CT17L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Backorder Details Screen           
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     8 Cost Centre                        
.---------------------------------------------------------
UPTSIBA3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIBA3FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIBA3FL1,KEY5;SCPSROW,SCPSCOL,SIBA3MKY
          ELSE
            UPDATE    SIBA3FL1;SCPSROW,SCPSCOL,SIBA3MKY
          ENDIF
          RETURN
RDTSIBA3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIBA3FL1,KEY5;SCPSROW,SCPSCOL,SIBA3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIBA3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIBA3FL1,KEY5;;
          READKS    SIBA3FL1;SCPSROW,SCPSCOL,SIBA3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIBA3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Backorder Details Screen           
.---------------------------------------------------------
DF17L000
          BRANCH   ACCEPT,DF17L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF17L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF17L900
          MATCH    PRGID,SCPSPID
          GOTO     DF17L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF17L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF17L010 IF NOT EQUAL
.
          CALL     PS17L000 * Display Field
          GOTO     DF17L010
DF17L900
          MOVE      "SIBA3",NAMSSFFI
          MOVE      "    8",ITMSSFFI
          CALL      FP17L000
DF17L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Backorder Details Screen           
.---------------------------------------------------------
PS17L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS17L999,PS17L999,PS17L101,PS17L102:
                            PS17L103,PS17L104,PS17L105,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999
          GOTO     PS17L999
.
PS17L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS17L999
.
PS17L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS17L999
.
PS17L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS17L999
.
PS17L104
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS17L999
.
PS17L105
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS17L999
PS17L999
          RETURN
.---------------------------------------------------------
. Selections for : Backorder Details Screen           
.---------------------------------------------------------
SF17L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF17L001  BRANCH   ACCEPT,SF17L020
.
SF17L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L101:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L102,SF17L103:
                            SF17L104,SF17L006,SF17L105,SF17L106
SF17L006  BEEP
          GOTO     SF17L005
SF17L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF17L090
          MATCH    PRGID,SCSLPID
          GOTO     SF17L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF17L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L101:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020
          GOTO     SF17L020
SF17L090  MOVE     ZERO,ACCEPT
          MOVE      "SIBA3",NAMSSFFI
          MOVE      "    8",ITMSSFFI
          CALL      FP17L000
          GOTO     SF17L001
.
SF17L101
          CALL      SELECTED
          BRANCH    EXIT,SF17L001
          COMPARE   ONE,ACCEPT
          GOTO      SF17L001 IF EQUAL
          CALL      RDTSIBA3
          IF        OVRCD=1
            BEEP
            GOTO      SF17L001
          ENDIF
          MATCH     SP70,SIBA3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF17L001
          ENDIF
          MOVE      SIBA3MKY,KEY25 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODITM00
          MOVE      "17",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIBA3
          IF        OVRCD=1
            CALL      FP17L000
          ELSE
            MOVE      SIBA3MKY,KEY25 
            CALL      RSSIBA3 
            CALL      RPSIBA3 
            CALL      DP17L000
          ENDIF
          GOTO     SF17L001
.
SF17L102
          MOVE      "SIBA3",NAMSSFFI
          MOVE      "    8",ITMSSFFI
          CALL      NP17L000
          GOTO     SF17L001
.
SF17L103
          MOVE      "SIBA3",NAMSSFFI
          MOVE      "    8",ITMSSFFI
          CALL      PP17L000
          GOTO     SF17L001
.
SF17L104
          MOVE      ONE,EXIT
          GOTO      SF17L999
.
SF17L105
          MOVE      "SIBA3",NAMSSFFI
          MOVE      "    8",ITMSSFFI
          CALL      FP17L000
          GOTO     SF17L001
.
SF17L106
          MOVE      "SIBA3",NAMSSFFI
          MOVE      "    8",ITMSSFFI
          CALL      LP17L000
          GOTO     SF17L001
SF17L990  MOVE      ONE,EXIT * Exit Char Restart
SF17L999  RETURN
.--------------------------------
. Screen - Backorder Catalog Details          
.--------------------------------
SC18L000
SC18L100
          MOVE      "18",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "15",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC18L200
          CALL      CF18L000 * Clear Fields
SC18L300
          CALL      KY18L000 * Enter Key Fields
          BRANCH    EXIT,SC18L999,SC18L999
SC18L400
          CALL      WP18L000 * Load any WP Details
SC18L500
          CALL      LM18L000 * Load any Batch Details
SC18L600
          CALL      DF18L000 * Display Fields
SC18L700
          CALL      SF18L000 * Select Fields
          BRANCH    EXIT,SC18L100,SC18L100,SC18L200
SC18L800
SC18L900
SC18L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Backorder Catalog Details          
.-------------------------------------------------------
CF18L000
CF18L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Backorder Catalog Details          
.--------------------------------------------------------
KY18L000
          MOVE      ZERO,EXIT
          GOTO      KY18L999
.
KY18L900  MOVE      ONE,EXIT
KY18L999  RETURN
.---------------------------------------------------------
. Load WP files for : Backorder Catalog Details          
.---------------------------------------------------------
WP18L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Backorder Catalog Details          
.---------------------------------------------------------
LM18L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Backorder Catalog Details          
.---------------------------------------------------------
DF18L000
          BRANCH   ACCEPT,DF18L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF18L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF18L900
          MATCH    PRGID,SCPSPID
          GOTO     DF18L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF18L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF18L010 IF NOT EQUAL
.
          CALL     PS18L000 * Display Field
          GOTO     DF18L010
DF18L900
DF18L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Backorder Catalog Details          
.---------------------------------------------------------
PS18L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS18L101,PS18L102,PS18L103,PS18L104:
                            PS18L105,PS18L106,PS18L107,PS18L999:
                            PS18L999,PS18L108
          GOTO     PS18L999
.
PS18L101
          MOVE      SIBACST,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L102
          MOVE      SIBAREQ,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L103
          UNPACK    SIBADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L104
          MOVE      SIBAQTY,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L105
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L106
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L107
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L108
          MOVE      SIBARESI,VAR     
          CALL      DISPITEM
          GOTO     PS18L999
PS18L999
          RETURN
.---------------------------------------------------------
. Selections for : Backorder Catalog Details          
.---------------------------------------------------------
SF18L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF18L001  BRANCH   ACCEPT,SF18L020
.
SF18L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF18L006,SF18L006,SF18L101,SF18L006:
                            SF18L006,SF18L006,SF18L006,SF18L006:
                            SF18L102,SF18L006
SF18L006  BEEP
          GOTO     SF18L005
SF18L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF18L090
          MATCH    PRGID,SCSLPID
          GOTO     SF18L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF18L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF18L020,SF18L020,SF18L101,SF18L020:
                            SF18L020,SF18L020,SF18L020,SF18L020:
                            SF18L020,SF18L020
          GOTO     SF18L020
SF18L090  MOVE     ZERO,ACCEPT
          GOTO     SF18L001
.
SF18L101
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIBADAT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIBADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF18L001
.
SF18L102
          CALL      UUSIBA3 
          MOVE      ZERO,EXIT
          GOTO      SF18L999
SF18L990  MOVE      ONE,EXIT * Exit Char Restart
SF18L999  RETURN
.--------------------------------
. Screen - Imprest Cost Centres               
.--------------------------------
SC19L000
SC19L100
          MOVE      "19",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC19L200
          CALL      CF19L000 * Clear Fields
SC19L300
          CALL      KY19L000 * Enter Key Fields
          BRANCH    EXIT,SC19L999,SC19L999
SC19L400
          CALL      WP19L000 * Load any WP Details
SC19L500
          CALL      LM19L000 * Load any Batch Details
SC19L600
          CALL      DF19L000 * Display Fields
SC19L700
          CALL      SF19L000 * Select Fields
          BRANCH    EXIT,SC19L100,SC19L100,SC19L200
SC19L800
SC19L900
SC19L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Imprest Cost Centres               
.-------------------------------------------------------
CF19L000  COMPARE   ZERO,ACCEPT
              GOTO      CF19L999 IF EQUAL
          MOVE      SP70,SIIMCST 
          MOVE      SP70,SICADESC
          MOVE      SP70,SIIMSEQ 
          MOVE      ZERO,SIIMMAX 
          MOVE      SP70,SIIMUR1 
          MOVE      SP70,SIIMUR2 
          MOVE      SP70,SIIMUD1 
          MOVE      SP70,SIIMUD2 
          MOVE      SP70,SIIMUC1 
          MOVE      SP70,SIIMUC2 
          MOVE      SP70,SIIMUY1 
          MOVE      SP70,SIIMUY2 
          MOVE      SP70,SIIAISS 
CF19L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Imprest Cost Centres               
.--------------------------------------------------------
KY19L000
          MOVE      ZERO,EXIT
          GOTO      KY19L999
.
KY19L900  MOVE      ONE,EXIT
KY19L999  RETURN
.---------------------------------------------------------
. Load WP files for : Imprest Cost Centres               
.---------------------------------------------------------
WP19L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Imprest Cost Centres               
.---------------------------------------------------------
LM19L000
.---------------------------------------------------------
. Load for :     1 Cost Centre                        
.---------------------------------------------------------
          UNPACK    SP70,SIIMCAT,SIIMCST
          PACK      KEY12,SIIACAT,SP70
          MOVE      KEY12,SIIM2EKY
          STRIP     SIIM2SKY
          SETLPTR   SIIM2EKY,7
          MOVE      SIIM2EKY,SIIM2SKY
          CALL      RDSIIM2 
          IF        OVRCD=0
            CALL      RPSIIM2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP19L000
          MOVE     ZERO,SIIM2CNT
          MOVE     ZERO,SIIM2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP19L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP19L600
          MATCH    PRGID,SCPSPID
          GOTO     DP19L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP19L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP19L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP19L101,DP19L102,DP19L103,DP19L104:
                            DP19L105,DP19L106,DP19L107,DP19L108:
                            DP19L109,DP19L110,DP19L111,DP19L112:
                            DP19L113,DP19L010,DP19L010,DP19L010:
                            DP19L010,DP19L010,DP19L010
          GOTO      DP19L010
.
DP19L101
          IF        SIIM2END=0
            CALL      RKSIIM2 
            IF        OVRCD=0
              PACK      SIIM2MKY,SIIMCAT,SIIMCST                                                                
              MATCH     SIIM2EKY,SIIM2MKY
              IF        @EQUAL
                MOVE      ZERO,SIIM2END
                ADD       ONE,SIIM2CNT
          CALL      SCR19DIS
                MOVE      SIIMCST,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIIM2END
              ENDIF
            ELSE
              MOVE      ONE,SIIM2END
            ENDIF
          ENDIF
          IF        SIIM2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L102
          IF        SIIM2END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L103
          IF        SIIM2END=0
            MOVE      SIIMSEQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L104
          IF        SIIM2END=0
            MOVE      SIIMMAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L105
          IF        SIIM2END=0
            MOVE      SIIMUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L106
          IF        SIIM2END=0
            MOVE      SIIMUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L107
          IF        SIIM2END=0
            UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L108
          IF        SIIM2END=0
            UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L109
          IF        SIIM2END=0
            MOVE      SIIMUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L110
          IF        SIIM2END=0
            MOVE      SIIMUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L111
          IF        SIIM2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIMUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L112
          IF        SIIM2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIMUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
.
DP19L113
          IF        SIIM2END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP19L010
DP19L600
          MATCH    "SIIM2",NAMSSFFI
          GOTO     DP19L605 IF NOT EQUAL
          GOTO     DP19L999
DP19L605
DP19L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP19L000
.
          MATCH    "SIIM2",NAMSSFFI
          GOTO     FP19L105 IF NOT EQUAL
          PACK     KEY12,SIIM2SKY,SP70
          CALL     RDSIIM2  * Start
          IF       OVRCD=0
            CALL     RPSIIM2  * Start
          ENDIF
          CALL     DP19L000
          GOTO     FP19L999
FP19L105
FP19L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP19L000
.
          MATCH    "SIIM2",NAMSSFFI
          GOTO     LP19L105 IF NOT EQUAL
          PACK     KEY12,SIIM2SKY,Z70
          CALL     RSSIIM2  * End
          IF       OVRCD=1
            CALL     RPSIIM2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM2SNO
            CALL     RPSIIM2 
            IF       OVRCD=1
              MOVE     SIIM2SNO,SECTOR
            ENDIF
            PACK     SIIM2MKY,SIIMCAT,SIIMCST                                                                
            MATCH    SIIM2EKY,SIIM2MKY
            IF       !@EQUAL
              MOVE     SIIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP19L000
          GOTO     LP19L999
LP19L105
LP19L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP19L000
.
          MATCH    "SIIM2",NAMSSFFI
          GOTO     PP19L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP19L105
          COMPARE  SECTOR,SIIM2SNO
          GOTO     PP19L110 IF EQUAL
          CALL     RPSIIM2 
          BRANCH   OVRCD,PP19L115
          PACK     SIIM2MKY,SIIMCAT,SIIMCST                                                                
          MATCH    SIIM2EKY,SIIM2MKY
          GOTO     PP19L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP19L105
PP19L110
          MOVE     ZERO,SECTOR
          IF       SIIM2CNT=SIIM2SNO
            SUB      ONE,SIIM2CNT
          ENDIF
          WHILE    SECTOR<=SIIM2CNT
            CALL     RPSIIM2 
            IF       OVRCD=1
              MOVE     SIIM2SNO,SECTOR
            ENDIF
            PACK     SIIM2MKY,SIIMCAT,SIIMCST                                                                
            MATCH    SIIM2EKY,SIIM2MKY
            IF       !@EQUAL
              MOVE     SIIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP19L000
          GOTO     PP19L999
PP19L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM2SNO
            CALL     RKSIIM2 
            IF       OVRCD=1
              MOVE     SIIM2SNO,SECTOR
            ENDIF
            PACK     SIIM2MKY,SIIMCAT,SIIMCST                                                                
            MATCH    SIIM2EKY,SIIM2MKY
            IF       !@EQUAL
              MOVE     SIIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP19L999
PP19L120
PP19L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP19L000
          MATCH    "SIIM2",NAMSSFFI
          GOTO     NP19L115 IF NOT EQUAL
NP19L105
          CALL     RKSIIM2 
          BRANCH   OVRCD,NP19L110
          PACK     SIIM2MKY,SIIMCAT,SIIMCST                                                                
          MATCH    SIIM2EKY,SIIM2MKY
          GOTO     NP19L110 IF NOT EQUAL
          CALL     RPSIIM2 
          CALL     DP19L000
          GOTO     NP19L999
NP19L110
          CALL     RPSIIM2 
          BEEP
          GOTO     NP19L999
NP19L115
NP19L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT19L000
CT19L105
CT19L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Imprest Cost Centres               
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Imprest Cost Centres               
.---------------------------------------------------------
DF19L000
          BRANCH   ACCEPT,DF19L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF19L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF19L900
          MATCH    PRGID,SCPSPID
          GOTO     DF19L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF19L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF19L010 IF NOT EQUAL
.
          CALL     PS19L000 * Display Field
          GOTO     DF19L010
DF19L900
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP19L000
DF19L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Imprest Cost Centres               
.---------------------------------------------------------
PS19L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS19L999,PS19L999,PS19L999,PS19L999:
                            PS19L999,PS19L999,PS19L999,PS19L999:
                            PS19L999,PS19L999,PS19L999,PS19L999:
                            PS19L999,PS19L999,PS19L999,PS19L999:
                            PS19L999,PS19L999,PS19L999
          GOTO     PS19L999
PS19L999
          RETURN
.---------------------------------------------------------
. Selections for : Imprest Cost Centres               
.---------------------------------------------------------
SF19L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF19L001  BRANCH   ACCEPT,SF19L020
.
SF19L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L101,SF19L102,SF19L103:
                            SF19L104,SF19L105,SF19L006
SF19L006  BEEP
          GOTO     SF19L005
SF19L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF19L090
          MATCH    PRGID,SCSLPID
          GOTO     SF19L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF19L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020
          GOTO     SF19L020
SF19L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP19L000
          GOTO     SF19L001
.
SF19L101
          MOVE      ZERO,EXIT
          GOTO      SF19L999
.
SF19L102
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP19L000
          GOTO     SF19L001
.
SF19L103
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP19L000
          GOTO     SF19L001
.
SF19L104
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP19L000
          GOTO     SF19L001
.
SF19L105
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP19L000
          GOTO     SF19L001
SF19L990  MOVE      ONE,EXIT * Exit Char Restart
SF19L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
. ------------------------------------------------------------
. Read Catalog Code Keyin Control Information
.
. INCOCATE  FORM      1         67      Catalog Code Type
. 0 Normal Keyin,   1 *JR *DE,   2 Generated ,  3 Generated with Check Digit
.------------------------------------------------------------
RINCOCAT  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*67,INCOCATE:
                                    *150,SNCOPRS,SNCOPPR,SNCOIMS
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCOCATE
            WRITAB    CONTROLF,SIXTY3;*67,INCOCATE
          ENDIF
.
          CALL      CSIWS000           * check warehouse security
.
          RETURN
.----------------------------------------------------------------------
. Check warehouse security
. Returns SECSIWS : 0 = no access to any warehouse
.                   1 = access to one warehouse
.                   2 = access to more than one warehouse
.                   3 = access to all warehouse(Not Applicable - for future use)
.----------------------------------------------------------------------
..                                            * (for future use)
..CSIWS000  MOVE      "3",SECSIWS             * default to all warehouse's
.
..          PACK      KEY9,SP70               * any security set up ???
..          CALL      RSSIWS1
..          CALL      RKSIWS1
..          BRANCH    OVRCD,CSIWS999
.
CSIWS000  MOVE      "0",SECSIWS             * check for no warehouse's
          PACK      KEY9,PASSCODE,SP70
          CALL      RSSIWS1
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "1",SECSIWS             * check for one warehouse's
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "2",SECSIWS             * more than one warehouse
.
CSIWS999  RETURN
REDITM00  MOVE      SP70,SICADESC
          MOVE      SIBACST,KEY5
          CALL      RDSICA1
          RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIIB000  MOVE        SP70,NOTESIIB
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIIB1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIIB999
NSIIB100  READ        TEMPWORD,SEQ;SIIBCOM
          GOTO        NSIIB900 IF OVER
          MATCH       SP70,SIIBCOM
          GOTO        NSIIB100 IF EQUAL
          MOVE        "Notes",NOTESIIB
.
NSIIB900  CLOSE       TEMPWORD
NSIIB999  RETURN
.
ECATB000  MOVE      ZERO,CKEYTYP
          CALL      KSIIAA00
          BRANCH    EXIT,ECATB999,ECATB999
.
ECATB100  MOVE      SIIACAT,KEY5
          CALL      RDSIIA1
          BRANCH    OVRCD,ECATB000
.
          READ      CONTROLF,TWENTY3;*143,HDEFWH
          MOVE      SP70,KEY5
.
          MOVE      ZERO,TOTSOH        * calculate total SOH
          MOVE      SP70,DEFRAS
          MOVE      ZERO,DEFROL
          MOVE      ZERO,DEFROQ
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
.
ECATB200  CALL      RKSIIE1
          BRANCH    OVRCD,ECATB210
          MATCH     SIIACAT,SIIECAT
          GOTO      ECATB210 IF NOT EQUAL
.
          ADD       SIIESOH,TOTSOH
          CALL      SWARN000
.
          MATCH     HDEFWH,SIIEWAR     * Default Warehouse ?
          IF        @EQUAL
            MOVE      SP70,KEY5
          ENDIF
.
          MATCH     SP70,KEY5          * Save first or default warehouse
          IF        @EQUAL
            MOVE      SIIEWAR,KEY5
            MOVE      SIIERAS,DEFRAS
            MOVE      SIIEROL,DEFROL
            MOVE      SIIEROQ,DEFROQ
          ENDIF
          GOTO      ECATB200
.
ECATB210  MOVE      ZERO,F7            * get alternate suppliers
          UNPACK    SP70,SUP1CODE,SUP1DESC
          UNPACK    SP70,SUP2CODE,SUP2DESC
          UNPACK    SP70,SUP3CODE,SUP3DESC
          UNPACK    SP70,SUP4CODE,SUP4DESC
          UNPACK    SP70,SUP5CODE,SUP5DESC
          UNPACK    SP70,DEFSUT
          MOVE      ZERO,DEFLEAD
          MOVE      ONE,DEFFAC
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
.
ECATB220  CALL      RKSIIC1
          BRANCH    OVRCD,ECATB230
          MATCH     SIIACAT,SIICCAT
          GOTO      ECATB230 IF NOT EQUAL
.
          MATCH     SIIAPSC,SIICSUP    * preferred supplier ?
          IF        @EQUAL
            MATCH     SP70,DEFSUT
            IF        @EQUAL
              MOVE      SIICSUT,DEFSUT
              MOVE      SIICLTM,DEFLEAD
              MOVE      ONE,SIFACTOR
              PACK      KEY30,SIIAISS,DEFSUT,SP70
              CALL      RDSIFA1
              MOVE      SIFACTOR,DEFFAC
            ENDIF
          ELSE
            ADD       ONE,F7
            MOVE      SP70,APMASN1
            PACK      KEY5,SIICSUP,SP70
            CALL      RDAPMA1
            STORE     SIICSUP,F7,SUP1CODE,SUP2CODE,SUP3CODE,SUP4CODE,SUP5CODE
            STORE     APMASN1,F7,SUP1DESC,SUP2DESC,SUP3DESC,SUP4DESC,SUP5DESC
          ENDIF
          GOTO      ECATB220
.
ECATB230  MOVE      ZERO,USVALUE       * calculate usage
          MOVE      ZERO,USQUANT
.
          PACK      SIPEDATE,CCC,CYY,CMM,CDD,SP70
          REP       " 0",SIPEDATE      * get current period
          CALL      RSIPE000
          BRANCH    EXIT,ECATB250
.
          PACK      KEY18,SIIACAT,SIPEYEAR,SIPEPER,Z70
          CALL      RSSIIH2
          CALL      RKSIIH2
.
ECATB240  CALL      RPSIIH2
          BRANCH    OVRCD,ECATB250
          MATCH     SIIHCAT,SIIACAT
          GOTO      ECATB250 IF NOT EQUAL
.
          ADD       SIIHUAM,USVALUE
          ADD       SIIHUQT,USQUANT
          GOTO      ECATB240
.
ECATB250  MOVE      SP70,APMASN1       * get preferred supplier data
          MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
.
          MOVE      SP70,SISADESC      * get product group data
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "ia1",KEY6
          APPEND    SIIAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "ia2",KEY6
          APPEND    SIIAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
.
          PACK      IBGSDESC,SP70
          PACK      KEY6,SIIAGST,SP70
          CALL      RDIBGS1
.
          ADD       ONE,SIIASUS
          BRANCH    SIIASUS,ECATB810,ECATB820,ECATB830,ECATB840
.
ECATB810  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ECATB890
.
ECATB820  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ECATB890
.
ECATB830  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ECATB890
.
ECATB840  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ECATB890
.
ECATB890  SUB       ONE,SIIASUS
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ECATB999
.
ECATB900  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECATB100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECATB000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ECATB900 IF NOT EQUAL
          GOTO      ECATB000
.
ECATB999  RETURN
.------------------------------------------------------------
. Stock Level Warning
.------------------------------------------------------------
SWARN000  COMPARE   ONE,SNCOIMS
          GOTO      SWARN999 IF NOT EQUAL
.
          MOVE      SIIEROL,WHOLEROL
          IF        SIIESOH<SIIEROL
            BEEP
            CLEAR     DISPMSG
            APPEND    "WARNING W/H ",DISPMSG
            APPEND    SIIEWAR,DISPMSG
            APPEND    " LOW STOCK ON HAND (ROL=",DISPMSG
            APPEND    WHOLEROL,DISPMSG
            APPEND    ") ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
          ENDIF
.
SWARN999  RETURN
.
SETSCR01
          MOVE      SP70,APMACN1
          MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
.
          MOVE      SP70,SISADESC
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
.
          RETURN
SETSCR02  MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
          IF        OVRCD=0
            MOVE      APMASN1,PSNAME
          ELSE
            MOVE      SP70,SIIAPSC
            MOVE      SP70,PSNAME
          ENDIF
.
          CALL      GETCON00     * Get Contract Details
.
          RETURN
SUPDET00  PACK      KEY5,SIICSUP
          MOVE      "Invalid Supplier Code         ",APMASN1
          CALL      RDAPMA1
          BRANCH    OVRCD,SUPDET98
.
          PACK      KEY30,SIIAISS,SIICSUT
          CALL      RDSIFA1
          ASSIGN    SIICCCT/SIFACTOR,ISSCCOST
          ASSIGN    SIICLCT/SIFACTOR,ISSLCOST
          GOTO      SUPDET99
.
SUPDET98  MOVE      "Invalid Supplier Code         ",APMASN1
.
SUPDET99  RETURN
MODSUP00  MOVE      SIIC1MKY,KEY27
          CALL      RDSIIC1
          IF        OVRCD=1
            MOVE      "Catalog/Supplier/Supply Unit Not File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      MODSUP90
          ENDIF
.
          MOVE      SIIACAT,SIICCAT
          MOVE      SIICSUP,KEY5
          CALL      RDAPMA1
.
          PACK      KEY30,SIIAISS,SIICSUT
          CALL      RDSIFA1
          ASSIGN    SIICLCT/SIFACTOR,ISSLCOST
          ASSIGN    SIICCCT/SIFACTOR,ISSCCOST
.
          CALL      SC10L000
.
MODSUP90  MOVE      ZERO,EXIT
          RETURN
WARDET00  PACK      KEY5,SIIEWAR
          CALL      RDSIWA1
          RETURN
MODWAR00  MOVE      SIIE1MKY,KEY12
          CALL      RDSIIE1
          IF        OVRCD=1
            BEEP
            MOVE      "Catalog/Warehouse NOT On File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      MODWAR99
          ENDIF
.
. check warehouse security access
.
          PACK      KEY9,PASSCODE,SIIEWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,MODWAR90
.
          MOVE      SIIACAT,SIIECAT
          MOVE      SIIEWAR,KEY5
          CALL      RDSIWA1
          MOVE      ZERO,ACCEPT
          CALL      SC11L000
          GOTO      MODWAR99
.
MODWAR90  CLEAR     DISPMSG
          APPEND    "You have no access for Warehouse ",DISPMSG
          APPEND    SIIEWAR,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      MODWAR99
.
MODWAR99  RETURN
EWARE000  BRANCH    SIIANON,EWARE100
          CALL      KSIWSA00
          BRANCH    EXIT,EWARE900,EWARE999
          PACK      KEY12,SIIACAT,SIWAWAR
          CALL      RDSIIE1
          IF        OVRCD=1
            BEEP
            MOVE      "Catalog Not Available in This Warehouse - ",DISPMSG
            CALL       MESSAGE1
            GOTO       EWARE000
          ENDIF
          GOTO      EWARE999
.
EWARE100  MOVE      ZERO,EXIT
          MOVE      SP70,SIIEWAR
          MOVE      SP70,SIWAWAR
          MOVE      "All Warehouses                       ",SIWADES
          GOTO      EWARE999
.
EWARE900  COMPARE   ZERO,SECSIWS
          GOTO      EWARE100 IF NOT EQUAL
          BEEP
          MOVE      "You have no access for all Warehouses - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ZERO,EXIT
          MOVE      SP70,SIIEWAR
          MOVE      SP70,SIWAWAR
          GOTO      EWARE999
.
EWARE999  RETURN
EYEAR000  COMPARE   ZERO,SECSIWS       * no warehouse access
          GOTO      EYEAR990 IF EQUAL
.
          CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EYEAR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      EYEAR990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      EYEAR000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
EYEAR100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EYEAR900
          ENDIF
          PACK      SIIHDAT,FINYEAR,F2
          REP       " 0",SIIHDAT
          MATCH     SP70,SIWAWAR
          GOTO      EYEAR700 IF NOT EQUAL
          PACK      KEY18,SIIACAT,SIIHDAT,SP70
          PACK      KEY13,SIIACAT,SIIHDAT,SP70
          MOVE      ZERO,TOTALUQT
          MOVE      ZERO,TOTALUAM
          MOVE      ZERO,TOTALPQT
          MOVE      ZERO,TOTALPAM
          MOVE      ZERO,TOTALRQT
          MOVE      ZERO,TOTALRAM
          CALL      RSSIIH2
          CALL      RPSIIH2
EYEAR400
          CALL      RKSIIH2
          BRANCH    OVRCD,EYEAR600
          PACK      KEY18,SIIHCAT,SIIHDAT,SP70
          MATCH     KEY13,KEY18
          GOTO      EYEAR600 IF NOT EQUAL
.
. check warehouse access
.
.
.         if its a non-stocked item then bypass security check
.
          IF        SIIANON = 1
            GOTO      EYEAR410                                         *I-F0901
          ENDIF                                                        *I-F0901
...
          PACK      KEY9,PASSCODE,SIIHWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,EYEAR400     * warehouse access denied
.
EYEAR410  ADD       SIIHUQT,TOTALUQT                                   *C-F0901
          ADD       SIIHUAM,TOTALUAM
          ADD       SIIHPQT,TOTALPQT
          ADD       SIIHPAM,TOTALPAM
          ADD       SIIHRQT,TOTALRQT
          ADD       SIIHRAM,TOTALRAM
          GOTO      EYEAR400
EYEAR600
          MOVE      TOTALUQT,SIIHUQT
          MOVE      TOTALUAM,SIIHUAM
          MOVE      TOTALPQT,SIIHPQT
          MOVE      TOTALPAM,SIIHPAM
          MOVE      TOTALRQT,SIIHRQT
          MOVE      TOTALRAM,SIIHRAM
          GOTO      EYEAR800
EYEAR700
          PACK      KEY18,SIIACAT,SIWAWAR,SIIHDAT
          CALL      RDSIIH1
          IF        OVRCD=1
            MOVE      ZERO,SIIHUQT
            MOVE      ZERO,SIIHUAM
          ENDIF
.
EYEAR800  STORE     SIIHUQT,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SIIHUAM,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SIIHUAM/SIIHUQT,VARPERXX
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          ADD       SIIHUQT,BUDPERXX
          ADD       SIIHUAM,ACTPERXX
          GOTO      EYEAR100
.
EYEAR900  ASSIGN    ACTPERXX/BUDPERXX,VARPERXX
          GOTO      EYEAR999
EYEAR990  MOVE      TWO,EXIT
EYEAR999  RETURN
GPUA0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPUA1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM
          LOAD      SCGPVAL,F3,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          COMPARE   SIPENUM,F3
          GOTO      GPUA1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          MOVE      SIIADES,KEY30
          STRIP     KEY30
          CLEAR     GPHNAME
          APPEND    "Catalog : ",GPHNAME
          APPEND    SIIACAT,GPHNAME
          APPEND    KEY30,GPHNAME
          MATCH     "04",SCRID
          IF        @EQUAL
            APPEND    " Average Usage Cost for ",GPHNAME
          ELSE
            APPEND    " Average Purchase Price for ",GPHNAME
          ENDIF
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Average Cost $ ",GPHLEDG[1]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      ONE,GPHNTYP    * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.
GPUC0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPUC1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Quantity
          LOAD      SCGPVAL,F3,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          COMPARE   SIPENUM,F3
          GOTO      GPUC1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          MOVE      SIIADES,KEY30
          STRIP     KEY30
          CLEAR     GPHNAME
          APPEND    "Catalog : ",GPHNAME
          APPEND    SIIACAT,GPHNAME
          APPEND    KEY30,GPHNAME
          MATCH     "04",SCRID
          IF        @EQUAL
            APPEND    " Usage Cost for ",GPHNAME
          ELSE
            APPEND    " Purchases for ",GPHNAME
          ENDIF
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Cost  ",GPHLEDG[1]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      ONE,GPHNTYP    * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.
GPUQ0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPUQ1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Quantity
          LOAD      SCGPVAL,F3,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          COMPARE   SIPENUM,F3
          GOTO      GPUQ1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          MOVE      SIIADES,KEY30
          STRIP     KEY30
          CLEAR     GPHNAME
          APPEND    "Catalog : ",GPHNAME
          APPEND    SIIACAT,GPHNAME
          APPEND    KEY30,GPHNAME
          MATCH     "04",SCRID
          IF        @EQUAL
            APPEND    " Usage Quantities for ",GPHNAME
          ELSE
            APPEND    " Quantities Purchased for ",GPHNAME
          ENDIF
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Quantity  ",GPHLEDG[1]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      ONE,GPHNTYP    * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.
EPYRR000  COMPARE   ZERO,SECSIWS       * no warehouse access
          GOTO      EPYRR990 IF EQUAL
.
          CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EPYRR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      EPYRR990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      EPYRR000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
EPYRR100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EPYRR900
          ENDIF
          PACK      SIIHDAT,FINYEAR,F2
          REP       " 0",SIIHDAT
          MATCH     SP70,SIWAWAR
          GOTO      EPYRR700 IF NOT EQUAL
          PACK      KEY18,SIIACAT,SIIHDAT,SP70
          PACK      KEY13,SIIACAT,SIIHDAT,SP70
          MOVE      ZERO,TOTALUQT
          MOVE      ZERO,TOTALUAM
          MOVE      ZERO,TOTALPQT
          MOVE      ZERO,TOTALPAM
          MOVE      ZERO,TOTALRQT
          MOVE      ZERO,TOTALRAM
          CALL      RSSIIH2
          CALL      RPSIIH2
EPYRR400
          CALL      RKSIIH2
          BRANCH    OVRCD,EPYRR600
          PACK      KEY18,SIIHCAT,SIIHDAT,SP70
          MATCH     KEY13,KEY18
          GOTO      EPYRR600 IF NOT EQUAL
.
. check warehouse access
.
          PACK      KEY9,PASSCODE,SIIHWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,EPYRR400     * warehouse access denied
.
          ADD       SIIHUQT,TOTALUQT
          ADD       SIIHUAM,TOTALUAM
          ADD       SIIHPQT,TOTALPQT
          ADD       SIIHPAM,TOTALPAM
          ADD       SIIHRQT,TOTALRQT
          ADD       SIIHRAM,TOTALRAM
          GOTO      EPYRR400
EPYRR600
          MOVE      TOTALUQT,SIIHUQT
          MOVE      TOTALUAM,SIIHUAM
          MOVE      TOTALPQT,SIIHPQT
          MOVE      TOTALPAM,SIIHPAM
          MOVE      TOTALRQT,SIIHRQT
          MOVE      TOTALRAM,SIIHRAM
          GOTO      EPYRR800
.
EPYRR700  PACK      KEY18,SIIACAT,SIWAWAR,SIIHDAT
          CALL      RDSIIH1
          IF        OVRCD=1
            MOVE      ZERO,SIIHPQT
            MOVE      ZERO,SIIHPAM
          ENDIF
.
EPYRR800  STORE     SIIHPQT,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SIIHPAM,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SIIHPAM/SIIHPQT,VARPERXX
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          ADD       SIIHPQT,BUDPERXX
          ADD       SIIHPAM,ACTPERXX
          GOTO      EPYRR100
.
EPYRR900  ASSIGN    ACTPERXX/BUDPERXX,VARPERXX
          GOTO      EPYRR999
.
EPYRR990  MOVE      TWO,EXIT
EPYRR999  RETURN
ORDDET00  MOVE     SIPCPON,KEY7
          CALL     RDSIPA1
          MOVE     SIPASUP,KEY5
          CALL     RDAPMA1
          MOVE     SIPCWAR,KEY5
          CALL     RDSIWA1
          UNPACK   SIPCDAT,CCENT,CYEAR,CMON
          PACK     PERUSAGE,CMON,SLASH,CCENT,CYEAR
          MOVE     SP1,CANIND
          MATCH    SP8,SIPADCN
          IF       !@EQUAL
            MOVE     "*",CANIND
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Selected Order Display
.----------------------------------------------------------------------
SELORD00  MATCH     "06",SCRID
          IF        @EQUAL
            UNPACK    SIPC3MKY,SIPCCAT,SIPCDAT,SIPCPON,SIPCITM
          ELSE
            UNPACK    SIPC6MKY,SIPCCAT,SIPCEDD,SIPCPON,SIPCITM
          ENDIF
          PACK      KEY10,SIPCPON,SIPCITM
          CALL      RDSIPC1
          IF        OVRCD=1
            BEEP
            MOVE      "Purchase Not Found - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SELORD99
          ENDIF
.
. check warehouse security
.
          PACK      KEY9,PASSCODE,SIPCWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,SELORD90
.
          MATCH     SP70,SIPCCAT
          IF        @EQUAL
            PACK      ITEMDESC,SIPCPD,SP70
            MOVE      ONE,SIFACTOR
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
            PACK      ITEMDESC,SIIADES
            PACK      KEY30,SIIAISS,SIPCSUT
            CALL      RDSIFA1
            IF        OVRCD=1
              MOVE      ONE,SIFACTOR
            ENDIF
          ENDIF
          ASSIGN    SIPCOQT*SIFACTOR,ORDQTY
          ASSIGN    SIPCECT*SIPCOQT,F12P2
          IF        SIPCECT<0
            MOVE      "      T.B.A,",ITEMCOST
          ELSE
            MOVE      "9,999,999.99",ITEMCOST
            FEDIT     F12P2,ITEMCOST
            MATCH     "*",ITEMCOST
            IF        @EQUAL
              MOVE      F12P2,F9P2
              MOVE      F9P2,ITEMCOST
            ENDIF
          ENDIF
          MOVE      SIPCPON,KEY7
          CALL      RDSIPA1
          MOVE      SIPASUP,KEY5
          CALL      RDAPMA1
.
          MOVE      SP70,SICADESC
          MOVE      SIPCCST,KEY5
          CALL      RDSICA1
.
          CALL      SC14L000
          GOTO      SELORD99
.
SELORD90  CLEAR     DISPMSG
          APPEND    "You have no access for Warehouse ",DISPMSG
          APPEND    SIPCWAR,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      SELORD99
.
SELORD99  RETURN
.--------------------------------------------------------------------------
. Set Date
.--------------------------------------------------------------------------
SETDAT00
.          UNPACK    SIITDAT,CCENT,CYEAR,CMON,CDAY
.          CALL      PACDATE
.          MOVE      CPCDATE,SIITDAT
          MOVE      ZERO,ITEMSOH
          SQUEEZE   SIITSOH
          MOVE      SIITSOH,ITEMSOH
.
SETDAT99  RETURN
ITMDET00  BRANCH    SIITTYP,ITMDET01,ITMDET02,ITMDET03,ITMDET04,ITMDET05:
                            ITMDET06,ITMDET07,ITMDET08,ITMDET09,ITMDET10:
                            ITMDET11,ITMDET12,ITMDET13,ITMDET14,ITMDET15
          MOVE      "New Stock Item",TRANDESC
          GOTO      ITMDET80
ITMDET01  MOVE      "Stock Adj.",TRANDESC
          GOTO      ITMDET20
ITMDET02  MOVE      "Stocktake Adj.",TRANDESC
          GOTO      ITMDET20
ITMDET03  MOVE      "Stocktake Bal.",TRANDESC
          GOTO      ITMDET20
ITMDET04  MOVE      "Receival",TRANDESC
          GOTO      ITMDET20
ITMDET05  MOVE      "Int. Req.",TRANDESC
          GOTO      ITMDET20
ITMDET06  MOVE      "Backorder",TRANDESC
          GOTO      ITMDET20
ITMDET07  MOVE      "Imp. Req.",TRANDESC
          GOTO      ITMDET20
ITMDET08  MOVE      "Stock Ret.",TRANDESC
          GOTO      ITMDET20
ITMDET09  MOVE      "Stock Var.",TRANDESC
          GOTO      ITMDET20
ITMDET10  MOVE      "Stock Correction",TRANDESC
          GOTO      ITMDET20
ITMDET11  MOVE      "Stock Trans.",TRANDESC
          GOTO      ITMDET20
ITMDET12  MOVE      "Ward Req.",TRANDESC
          GOTO      ITMDET20
ITMDET13  MOVE      "Script Cancel",TRANDESC
          GOTO      ITMDET20
ITMDET14  MOVE      "Rev. Rece.",TRANDESC
          GOTO      ITMDET20
ITMDET15  MOVE      "Rev. Backorder Req.",TRANDESC
          GOTO      ITMDET20
ITMDET20
          MATCH     SP70,SIITSOH
          IF        @EQUAL
            MOVE      "Unknown        ",SIITSOH
          ENDIF
.
          UNPACK    SIITPER,KEY4,DIM2
          PACK      USAGEPER,DIM2,SLASH,KEY4
          CLEAR     LINEREF
          APPEND    TRANDESC,LINEREF
          APPEND    SP1,LINEREF
          IF        SIITTYP<>6
            MATCH     SP70,SIITPUR
            IF        !(@EQUAL)
              APPEND    "P/O:",LINEREF
              APPEND    SIITPUR,LINEREF
              APPEND    SP1,LINEREF
            ENDIF
          ENDIF
          MATCH     SP70,SIITREQ
          IF        !(@EQUAL)
            APPEND    SIITREQ,LINEREF
            APPEND    SP1,LINEREF
          ENDIF
          MATCH     SP70,SIITCST
          IF        !(@EQUAL)
            APPEND    "C/C:",LINEREF
            APPEND    SIITCST,LINEREF
            APPEND    SP1,LINEREF
          ENDIF
          MATCH     SP70,SIITREF
          IF        !(@EQUAL)
            APPEND    "Ref.:",LINEREF
            APPEND    SIITREF,LINEREF
          ENDIF
          RESET     LINEREF
          GOTO      ITMDET99
.
ITMDET80  CLEAR     LINEREF
          APPEND    TRANDESC,LINEREF
          RESET     LINEREF
.
ITMDET99  RETURN
.
EWARA000  BRANCH    SIIANON,EWARA100
          CALL      KSIWSA00
          BRANCH    EXIT,EWARA999,EWARA999
.
          PACK      KEY12,SIIACAT,SIWAWAR
          CALL      RDSIIE1
          IF        OVRCD=1
            BEEP
            MOVE      "Catalog Not Available in This Warehouse - ",DISPMSG
            CALL       MESSAGE1
            GOTO       EWARA000
          ENDIF
          GOTO       EWARA999
.
EWARA100  MOVE       SP70,SIWAWAR
          MOVE       SP70,SIWADES
          MOVE       SP70,SIIEWAR
          MOVE       ZERO,SIIESOH
          MOVE       ZERO,EXIT
.
EWARA999  RETURN
ITMSCR00  MOVE      SIIT1MKY,KEY28
          CALL      RDSIIT1
          IF        OVRCD=1
            MOVE      "Item History Detail Not Found - ",DISPMSG
            CALL      MESSAGE1
            GOTO      ITMSCR99
          ENDIF
          MOVE      SIITCST,KEY5
          CALL      RDSICA1
.
          BRANCH    SIITTYP,ITMSCR01,ITMSCR02,ITMSCR03,ITMSCR04,ITMSCR05:
                            ITMSCR06,ITMSCR07,ITMSCR08,ITMSCR09,ITMSCR10:
                            ITMSCR11,ITMSCR12,ITMSCR13,ITMSCR14,ITMSCR15
          MOVE      "New Stock Item",TRANDESC
          GOTO      ITMSCR20
ITMSCR01  MOVE      "Stock Adjustment",TRANDESC
          GOTO      ITMSCR20
ITMSCR02  MOVE      "Stocktake Adjustment",TRANDESC
          GOTO      ITMSCR20
ITMSCR03  MOVE      "Stocktake Balance",TRANDESC
          GOTO      ITMSCR20
ITMSCR04  MOVE      "Stock Receival ",TRANDESC
          GOTO      ITMSCR20
ITMSCR05  MOVE      "Internal Requisition",TRANDESC
          GOTO      ITMSCR20
ITMSCR06  MOVE      "Backorder Requisition",TRANDESC
          GOTO      ITMSCR20
ITMSCR07  MOVE      "Imprest Requisition",TRANDESC
          GOTO      ITMSCR20
ITMSCR08  MOVE      "Stock Return",TRANDESC
          GOTO      ITMSCR20
ITMSCR09  MOVE      "Stock Variance",TRANDESC
          GOTO      ITMSCR20
ITMSCR10  MOVE      "Stock Correction",TRANDESC
          GOTO      ITMSCR20
ITMSCR11  MOVE      "Stock Transfer",TRANDESC
          GOTO      ITMSCR20
ITMSCR12  MOVE      "Ward Requisition",TRANDESC
          GOTO      ITMSCR20
ITMSCR13  MOVE      "Script Cancellation",TRANDESC
          GOTO      ITMSCR20
ITMSCR14  MOVE      "Reverse Receival",TRANDESC
          GOTO      ITMSCR20
ITMSCR15  MOVE      "Rev. Backorder Req.",TRANDESC
          GOTO      ITMSCR20
ITMSCR20
          MATCH     SP70,SIITSOH
          IF        @EQUAL
            MOVE      "Unknown        ",SIITSOH
          ENDIF
.
          PACK      SIPASUP,SP70
          PACK      APMASN1,SP70
.
          MATCH     SP7,SIITPUR
          GOTO      ITMSCR30 IF EQUAL
.
          PACK      KEY7,SIITPUR,SP70
          CALL      RDSIPA1
          BRANCH    OVRCD,ITMSCR30
.
          PACK      KEY5,SIPASUP,SP70
          CALL      RDAPMA1
.
ITMSCR30  UNPACK    SIITPER,KEY4,DIM2
          PACK      USAGEPER,DIM2,SLASH,KEY4
          CALL      SC12L000
.
ITMSCR99
          RETURN
.
.----------------------------------------------------------------------
. Get Current Contract Details
.----------------------------------------------------------------------
GETCON00  CALL     CLRCON00
          PACK     KEY8,CCC,CYY,CMM,CDD
          REP      " 0",KEY8
          PACK     KEY45,SIIACAT,KEY8,Z70
          CALL     RSSISD2
          CALL     RPSISD2
          BRANCH   OVRCD,GETCON90
          MATCH    SIIACAT,SISDCAT
          GOTO     GETCON90 IF NOT EQUAL
.
          MOVE     SISDCON,KEY10
          CALL     RDSISC1
          BRANCH   OVRCD,GETCON90
          REP      " 0",SISCEDT
          MATCH    KEY8,SISCEDT
          GOTO     GETCON90 IF LESS
.
          PACK     KEY37,SISDCON,SISDSUP,SISDCAT,SISDSUT
          CALL     RDSISF1
.
          MOVE     SISDSUP,KEY5
          CALL     RDAPMA1
.
          CALL     MOVCON00   * Move to Current Contract Variables
.
          GOTO     GETCON99
.
GETCON90  CALL     CLRCON00
.
GETCON99  RETURN
.
MOVCON00  MOVE      SISCCON,CVSCCON
          MOVE      SISCDES,CVSCDES
          MOVE      SISCSDT,CVSCSDT
          MOVE      SISCEDT,CVSCEDT
.
          MOVE      SISDSUP,CVSDSUP
          MOVE      SISDSDT,CVSDSDT
          MOVE      SISDSUT,CVSDSUT
.
          MOVE      SISFAQT,CVSFAQT
          MOVE      SISFAPC,CVSFAPC
          MOVE      SISFEQT,CVSFEQT
          MOVE      SISFECT,CVSFECT
.
          MOVE      APMASN1,CVMASN1
          MOVE      APMASN2,CVMASN2
.
          RETURN
.
CLRCON00  MOVE     SP70,CVSCCON
          MOVE     SP70,CVSCDES
          MOVE     SP70,CVSCSDT
          MOVE     SP70,CVSCEDT
.
          MOVE      SP70,CVMASN1
          MOVE      SP70,CVMASN2
.
          MOVE     SP70,CVSDSUP
          MOVE     SP70,CVSDSDT
          MOVE     SP70,CVSDSUT
.
          MOVE     ZERO,CVSFAQT
          MOVE     ZERO,CVSFAPC
          MOVE     ZERO,CVSFEQT
          MOVE     ZERO,CVSFECT
.
          RETURN
.
CONDET00   MOVE     SISDSUP,KEY5
           CALL     RDAPMA1
           RETURN
.----------------------------------------------------------------------
. Get Current Contract Details
.----------------------------------------------------------------------
SELCON00
          MOVE     SISD2MKY,KEY45
          CALL     RDSISD2
          IF       OVRCD=1
            BEEP
            MOVE     "Contract Not Found - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SELCON99
          ENDIF
          MOVE     SISDCON,KEY10
          CALL     RDSISC1
          PACK     KEY37,SISDCON,SISDSUP,SISDCAT,SISDSUT
          CALL     RDSISF1
          MOVE     SISDSUP,KEY5
          CALL     RDAPMA1
.
          CALL     SC13L000
SELCON99  RETURN
REQDET00
          PACK     KEY8,SIRBTYP,SIRBREQ,SP70
          CALL     RDSIRA1
          MOVE     SP70,SIWADES
          PACK     KEY5,SIRBWAR,SP70
          CALL     RDSIWA1
          MOVE     SP70,SICADESC
          PACK     KEY5,SIRACST,SP70
          CALL     RDSICA1
          IF       SIRAIND=1
            MOVE     "Return      ",REQINDIC
          ELSE
            MOVE     "Requisition ",REQINDIC
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Keyin SICD
.----------------------------------------------------------------------
KSICD000
          MOVE      "RT ",SICDCATA
          CALL      KREQT000                     * keyin SICD
          BRANCH    EXIT,KSICD950,KSICD950
.
          MOVE      SICDCODE,TYPEREQ
.
KSICD900  MOVE      ZERO,EXIT
          GOTO      KSICD999
.
KSICD950  MOVE      TWO,EXIT
.
KSICD999  RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory
.   Include   :   SINCODKY
.   Routine   :   KREQT000 Keyin Code
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KREQT000 TOPIC     "SICDCODE"
          MOVE      UNDLN70,ANS
          KEYIN     *PCCOL:CVERT,*DV,ANS:
                    *PCCOL:CVERT,*V2LON,ANS:
                    *PCCOL:CVERT,*DV,ANS
.
          REP       UPPLOW,ANS
          PACK      SICDCODE,ANS,SP70
.
          MATCH     SP70,SICDCODE
          GOTO      KREQT090 IF EQUAL
.
          CMATCH    EXITCHAR,SICDCODE
          GOTO      KREQT095 IF EQUAL
.
          CMATCH    QUEST,SICDCODE
          GOTO      KREQT010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSICDB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SICDCODE
          APPEND    SP70,SICDCODE
          RESET     SICDCODE
.
          MATCH     SP70,SICDCODE
          GOTO      KREQT000 IF EQUAL
.
          PACK      ANS,SICDCODE,SP70
          DISPLAY   *PCCOL:CVERT,*V2LON,ANS
KREQT010
          PACK      KEY6,SICDCATA,SICDCODE
          CALL      RASICD1
          BRANCH    OVRCD,KREQT080
          BRANCH    CKEYTYP,KREQT075
          CALL      RDSICD1
KREQT070
          MOVE      ZERO,EXIT
          GOTO      KREQT999
KREQT075
          MOVE      "Code Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KREQT000
KREQT080
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KREQT999,KREQT999
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KREQT000
KREQT090
          MOVE      ONE,EXIT
          GOTO      KREQT999
KREQT095
          MOVE      TWO,EXIT
KREQT999 TOPIC    PRGID
          RETURN
.----------------------------------------------------------------------
. Selected Requisition Display
.----------------------------------------------------------------------
SELREQ00  MOVE      SIRB2MKY,KEY20
          CALL      RDSIRB2
          IF        OVRCD=1
            BEEP
            MOVE      "Requisition Not Found - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SELREQ99
          ENDIF
.
. check warehouse security
.
          PACK      KEY9,PASSCODE,SIRBWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,SELREQ90
.
          CALL      REQDET00
          CALL      SC15L000
          GOTO      SELREQ99
.
SELREQ90  CLEAR     DISPMSG
          APPEND    "You have no access for Warehouse ",DISPMSG
          APPEND    SIRBWAR,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      SELREQ99
.
SELREQ99  RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIID000  MOVE        SP70,NOTESIID
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIID1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIID999
NSIID100  READ        TEMPWORD,SEQ;SIIDCOM
          GOTO        NSIID900 IF OVER
          MATCH       SP70,SIIDCOM
          GOTO        NSIID100 IF EQUAL
          MOVE        "Notes",NOTESIID
.
NSIID900  CLOSE       TEMPWORD
NSIID999  RETURN
.
.----------------------------------------------------------------------
. Set Backorder Details
.----------------------------------------------------------------------
SETBO000  MOVE      ZERO,BOCOST
          MOVE      ZERO,BOTOTAL
          PACK      KEY25,SIIACAT,SIWAWAR,SP70
          CALL      RSSIBA3
          REPEAT
            CALL      RKSIBA3
            PACK      KEY12,SIBACAT,SIBAWAR,SP70
            MATCH     KEY12,KEY25
            IF        !@EQUAL | OVRCD=1
              MOVE      ONE,OVRCD
            ELSE
              ADD       ONE,BOCOST
              ADD       SIBAQTY,BOTOTAL
            ENDIF
          UNTIL     OVRCD=1
.
          ADD       ONE,SIIESUS
          BRANCH    SIIESUS,SETBO100,SETBO200,SETBO300,SETBO400
.
SETBO100  MOVE      "Not Suspend               ",SUSPDES1
          GOTO      SETBO999
.
SETBO200  MOVE      "Requisitions              ",SUSPDES1
          GOTO      SETBO999
.
SETBO300  MOVE      "Suspend P/O              ",SUSPDES1
          GOTO      SETBO999
.
SETBO400  MOVE      "Suspend P/O & Requisition",SUSPDES1
          GOTO      SETBO999
.
SETBO999  RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIIG000  MOVE        SP70,NOTESIIG
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIIG1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIIG999
NSIIG100  READ        TEMPWORD,SEQ;SIIGCOM
          GOTO        NSIIG900 IF OVER
          MATCH       SP70,SIIGCOM
          GOTO        NSIIG100 IF EQUAL
          MOVE        "Notes",NOTESIIG
.
NSIIG900  CLOSE       TEMPWORD
NSIIG999  RETURN
.---------------------------------------------------------             *I-F1101
. CHKDET00 :  Check the Expected Delivery day to see if                *I-F1101
.             it is blank. If it is then it is not oustanding.         *I-F1101
.             Get the next Purchase order.                             *I-F1101
.---------------------------------------------------------             *I-F1101
.                                                                      *I-F1101
CHKDET00  MATCH     SP8,SIPCEDD                                        *I-F1101
          IF        @EQUAL
            SUB       ONE,SIPC6CNT     * do not add screen items       *I-F1101
            NORETURN                   * using goto so get rid of call *I-F1101
            GOTO      DP16L101         * get next PO                   *I-F1101
          ENDIF                                                        *I-F1101
.                                                                      *I-F1101
CHKDET99  RETURN                                                       *I-F1101
OUTDET00  MOVE     SIPCPON,KEY7
          CALL     RDSIPA1
.
          MOVE     ONE,SIFACTOR
          MATCH    SP7,SIPCCAT
          IF       !@EQUAL
            PACK     KEY7,SIPCCAT,SP70
            CALL     RDSIIA1
            IF       OVRCD=0
              MOVE     SIIADES,SIPCPD
              PACK     KEY30,SIIAISS,SIPCSUT,SP70
              CALL     RDSIFA1
            ENDIF
          ENDIF
.
          ASSIGN   SIPCOQT-(SIPCRQT/SIFACTOR),OUTQTY
.
          ASSIGN   SIPCECT*OUTQTY,F12P2
          IF       SIPCECT<0
            MOVE     "      T.B.A,",ITEMCOST
          ELSE
            MOVE     "9,999,999.99",ITEMCOST
            FEDIT    F12P2,ITEMCOST
            MATCH    "*",ITEMCOST
            IF       @EQUAL
              MOVE     F12P2,F9P2
              MOVE     F9P2,ITEMCOST
            ENDIF
          ENDIF
          RETURN
.------------------------------------------------------------
. Enter Warehouse
.------------------------------------------------------------
EBWAR000  CALL      KSIWSA00
          BRANCH    EXIT,EBWAR999,EBWAR999
.
          PACK      KEY12,SIIACAT,SIWAWAR,SP70
          PACK      KEY25,SIIACAT,SIWAWAR,SP70
          CALL      RSSIBA3
          CALL      RKSIBA3
          BRANCH    OVRCD,EBWAR100
          PACK      KEY25,SIBACAT,SIBAWAR,SP70
          MATCH     KEY12,KEY25
          GOTO      EBWAR999 IF EQUAL
EBWAR100  MOVE      "Catalog/Warehouse Not on Back Order - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      EBWAR000
.
EBWAR999  RETURN
MODITM00  MOVE      SIBA3MKY,KEY25
          CALL      RDSIBA3
          BRANCH    OVRCD,MODITM80,MODITM90
          MOVE      SIBACST,KEY5
          CALL      RDSICA1
          CALL      SC18L000          * Maintenance Screen
          GOTO      MODITM99
.
MODITM80  BEEP
          MOVE      "Item Not Found - ",DISPMSG
          CALL      MESSAGE1
          GOTO      MODITM99
.
MODITM90  MOVE      "Record Locked - ",DISPMSG
          CALL      MESSAGE1
          GOTO      MODITM99
.
MODITM99  RETURN
EQTY0000  KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIBAQTY:
                    *PCCOL:CVERT
          IF        SIBAQTY>0
            GOTO      EQTY9999
          ELSE
            MOVE      "Quantity Must be Greater Than 0. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EQTY0000
          ENDIF
EQTY9999  RETURN
SCR19DIS  PACK      SICADESC,SP70
          PACK      KEY5,SIIMCST,SP70
          CALL      RDSICA1
.
          PACK      SIIAISS,SP70
          PACK      KEY7,SIIMCAT,SP70
          CALL      RDSIIA1
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSMASIO/INC
          INC       GPHSTDCD    
          INC       IBAGSTIO/INC
          INC       SINBACIO/INC
          INC       SINCCAIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIBIO/INC
          INC       SINCICIO/INC
          INC       SINCIDIO/INC
          INC       SINCIEIO/INC
          INC       SINCIFIO/INC
          INC       SINCIGIO/INC
          INC       SINCIHIO/INC
          INC       SINCIJIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINFACIO/INC
          INC       SINIMPIO/INC
          INC       SINITMIO/INC
          INC       SINNATIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINREAIO/INC
          INC       SINREBIO/INC
          INC       SINSCDIO/INC
          INC       SINSCFIO/INC
          INC       SINSCMIO/INC
          INC       SINSUAIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
