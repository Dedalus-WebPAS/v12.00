. *----------------------------------------------------------------------
. * Include Name  :   PMSDRATM.PBL
. *
. * Function      :   CGI variables for PMSDRAFD - pmsdraaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.02.01  04/07/2011  Davin         CAR 240723
.             Created include
.------------------------------------------------------------------------
.   Clear parameters for doctor arrangements file
.------------------------------------------------------------------------
CPPMDR00  MOVE      Z70,PMDRA001
          MOVE      Z70,PMDRA002
          MOVE      Z70,PMDRA003
          MOVE      Z70,PMDRA004
CPPMDR99  RETURN
.------------------------------------------------------------
. Tags for doctor arrangements table
.------------------------------------------------------------
PMDR0000  BRANCH    FLDITMNO,PMDR0010,PMDR0020,PMDR0030,PMDR0040,PMDR0050:
                             PMDR0060,PMDR0070,PMDR0080,PMDR0090,PMDR0100
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMDR9999
.
PMDR0010  WRITE     HTMLFILE;PMDRDOCT;
          GOTO      PMDR9999
.
PMDR0020  MOVE      "da",CATEGORY
          MOVE      PMDRARRA,CODE
          CALL      CODITM00
          GOTO      PMDR9999
.
PMDR0030  MATCH     PMDRAFDT,SP70
          GOTO      PMDR9999 IF EQUAL
.
          UNPACK    PMDRAFDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDR9999
.
PMDR0040  MATCH     PMDRATDT,SP70
          GOTO      PMDR9999 IF EQUAL
.
          UNPACK    PMDRATDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDR9999
.
PMDR0050  MATCH     SP70,PMDRCUID
          GOTO      PMDR9999 IF EQUAL
.
          PACK      KEY10,PMDRCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMDRCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMDR9999
.
PMDR0060  MATCH     PMDRCDAT,SP70
          GOTO      PMDR9999 IF EQUAL
.
          UNPACK    PMDRCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDR9999
.
PMDR0070  WRITE     HTMLFILE;PMDRCTIM;
          GOTO      PMDR9999
.
PMDR0080  MATCH     SP70,PMDRUUID
          GOTO      PMDR9999 IF EQUAL
.
          PACK      KEY10,PMDRUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMDRUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMDR9999
.
PMDR0090  MATCH     PMDRUDAT,SP70
          GOTO      PMDR9999 IF EQUAL
.
          UNPACK    PMDRUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDR9999
.
PMDR0100  WRITE     HTMLFILE;PMDRUTIM;
          GOTO      PMDR9999
.
PMDR9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for doctor arrangements
.------------------------------------------------------------
SPPMA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMA001,SPPMA002,SPPMA003,SPPMA004
.
          MOVE      ONE,EXIT
          GOTO      SPPMA999
.
SPPMA001  MOVE      QRYDATA,PMDRA001
          GOTO      SPPMA999
.
SPPMA002  MOVE      QRYDATA,PMDRA002
          GOTO      SPPMA999
.
SPPMA003  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDRA003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMA999
.
SPPMA004  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDRA004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMA999
.
SPPMA999  RETURN
.
.------------------------------------------------------------
.  Update doctor arrangements details
.------------------------------------------------------------
MVPMDA00  MATCH     PMDRA001,Z70
          IF        !@EQUAL
            MOVE      PMDRA001,PMDRDOCT
          ENDIF
.
          MATCH     PMDRA002,Z70
          IF        !@EQUAL
            MOVE      PMDRA002,PMDRARRA
          ENDIF
.
          MATCH     PMDRA003,Z70
          IF        !@EQUAL
            MOVE      PMDRA003,PMDRAFDT
          ENDIF
.
          MATCH     PMDRA004,Z70
          IF        !@EQUAL
            MOVE      PMDRA004,PMDRATDT
          ENDIF
.
MVPMDA99  RETURN
+
