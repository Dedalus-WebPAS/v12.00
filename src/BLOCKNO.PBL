          INC       STD001FD
          INC       PATICGFD/INC
.
FORM3     FORM      3
KEY127    DIM       127
RECCNT    FORM      6
WRTCNT    FORM      6
.
TEMP1     FILE      ASCII, FIXED=305
BLOCKNO   DIM       4
LDESC1    DIM       127
LDESC2    DIM       73
SDESC     DIM       100
.
PRGID     INIT      "BLOCKNO"
PRGNAM    INIT      "Block No Conversion"
VERSION   INIT      "V12.00.00"
+
ML0000    CALL      DISPHEAD
          OPEN      PATICDG1,"paticdgf"
          OPEN      TEMP1,"blockno"
          MOVE      ZERO,RECCNT
          DISPLAY   *P1:24,*EL,"Reading : ",*P35:24,"Writing : ";
.
ML1000    READ      TEMP1,SEQ;BLOCKNO,SDESC,LDESC1,LDESC2
          GOTO      ML8000 IF OVER
.
          ADD       ONE,RECCNT
          IF        RECCNT%100=1
            DISPLAY   *P11:24,*V2LON,BLOCKNO,*P70:24,RECCNT;
          ENDIF
.
          MOVE      ANSO,GIDCODE
          MOVE      BLOCKNO,GGPCODE
          MOVE      LDESC1,GDESC            * Long description
          MOVE      LDESC1,KEY127
          STRIP     KEY127
          MOVELPTR  KEY127,FORM3
          IF        FORM3>70
            PACK      GDESC,SDESC,SP30,SP30 * Short description
          ENDIF
          REP       UPPLOW,GDESC
.
          PACK      KEY5,GIDCODE,GGPCODE
          CALL      RDICG1                  * Read an ICD group file record
          COMPARE   ONE,OVRCD
          GOTO      ML2000 IF NOT EQUAL
.
          CALL      WRICG1                  * Write an ICD group file record
.
          ADD       ONE,WRTCNT
          IF        WRTCNT%100=1
            DISPLAY   *P45:24,*V2LON,GGPCODE;
          ENDIF
          GOTO      ML1000
.
ML2000    KEYIN     *P1:10,*EL,"Duplicate .... ",*EOFF,ANS,*P1:10,*EL;
          GOTO      ML1000
.
ML8000    DISPLAY   *P1:23,*EF,*B,"Conversion Finished.",*P1:24:
                    *V2LON,RECCNT,*HOFF," Records read  ":
                    *V2LON,WRTCNT,*HOFF," Records written.  ";
          CALL      HITENTER
ML9999    CHAIN     PGM
+
          INC       STD001IO
          INC       PATICGIO/INC
+
.

