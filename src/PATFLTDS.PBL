
.  ****************************************************************************
.  *                                                                          *
.  *  Program Name     :  PATFLTDS.PBL                                        *
.  *                                                                          *
.  *  Function         :  Displays the financial letters on file.             *
.  *                      using PATFLET2                                      *
.  *                                                                          *
.  *  Author           :  Steve Armstrong      19/04/91                       *
.  *                                                                          *
.  *  Keys             :  KEY6                                                *
.  *  Modifications    :                                                      *
.  *                                                                          *
.  ****************************************************************************
.
PATFLTDS  DISPLAY    *P1:4,*EF,*P20:4,*V2LON,*ULON,"FINANCIAL LETTER CODES"
          MOVE       FIVE,CVERT
.
          PACK       KEY6,SP2,ZERO,SP3
          CALL       RSPTFL2 
FLETR100  CALL       RKPTFL2 
          BRANCH     OVRCD,FLETR999
.
          COMPARE    ZERO,PTFLLINO               * header line ?
          GOTO       FLETR999 IF NOT EQUAL       * no
.
          ADD        ONE,CVERT
          COMPARE    TWENTY4,CVERT
          GOTO       FLETR150 IF LESS
          GOTO       FLETR200 
.
FLETR150  DISPLAY    *P1:CVERT,*V2LON,DPTFLLTN,SP2,*HOFF,PTFLTEXT
          GOTO       FLETR100
.
.         Page full
.
FLETR200  KEYIN     *P1:24,*EL," (",*V2LON,"C",*HOFF,")ontinue, ":
                    "(",*V2LON,"F",*HOFF,")irst Screen, ":
                    "(",*V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
.
          REP       UPPLOW,ANS
          CMATCH    ANSC,ANS
          GOTO      FLETR999 IF EQUAL
.
          CMATCH    ANSF,ANS
          GOTO      PATFLTDS IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      FLETR400 IF EQUAL
.
.         Clear the screen
.
FLETR400  MOVE      FIVE,CVERT
          DISPLAY   *P1:CVERT,*EF
          GOTO      FLETR150
.
FLETR999  RETURN
