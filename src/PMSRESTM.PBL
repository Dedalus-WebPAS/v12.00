.----------------------------------------------------------------------
. Modifications
.
. V10.02.01  20/07/2011  J.Tan         CAR 239592
.            Added free format Name of school
. V10.02.00  07/06/2011  J.Tan      CAR 239592
.            Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for patient system visit extention table
.------------------------------------------------------------------------
.
CPMRES00  MOVE      Z70,PMRES001
          MOVE      Z70,PMRES002
          MOVE      Z70,PMRES003
          MOVE      Z70,PMRES004
          MOVE      Z70,PMRES005
          MOVE      Z70,PMRES006
          MOVE      Z70,PMRES007
          MOVE      Z70,PMRES008
          MOVE      Z70,PMRES009
          MOVE      Z70,PMRES010
          MOVE      Z70,PMRES011
          MOVE      Z70,PMRES012
          MOVE      Z70,PMRES013
          MOVE      Z70,PMRES014
          MOVE      Z70,PMRES015
          MOVE      Z70,PMRES016
          MOVE      Z70,PMRES017
          MOVE      Z70,PMRES018
          MOVE      Z70,PMRES019
          MOVE      Z70,PMRES020
          MOVE      Z70,PMRES021
          MOVE      Z70,PMRES022
          MOVE      Z70,PMRES023
          MOVE      Z70,PMRES024
          MOVE      Z70,PMRES025
          MOVE      Z70,PMRES026
          MOVE      Z70,PMRES027
          MOVE      Z70,PMRES028
          MOVE      Z70,PMRES029
          MOVE      Z70,PMRES030
          MOVE      Z70,PMRES031
          MOVE      Z70,PMRES032
          MOVE      Z70,PMRES033
          MOVE      Z70,PMRES034
          MOVE      Z70,PMRES035
          MOVE      Z70,PMRES036
          MOVE      Z70,PMRES037
          MOVE      Z70,PMRES038
          MOVE      Z70,PMRES039
          MOVE      Z70,PMRES040
CPMRES99  RETURN
+
+
.------------------------------------------------------------
. Add Resident Field
.------------------------------------------------------------
RESD0000  BRANCH    FLDITMNO,RESD0100,RESD0200,RESD0300,RESD0400,RESD0500:
                             RESD0600,RESD0700,RESD0800,RESD0900,RESD1000:
                             RESD1100,RESD1200,RESD1300,RESD1400,RESD1500:
                             RESD1600,RESD1700,RESD1800,RESD1900,RESD2000:
                             RESD2100,RESD2200,RESD2300,RESD2400,RESD2500:
                             RESD2600,RESD2700,RESD2800,RESD2900,RESD3000:
                             RESD3100,RESD3200,RESD3300,RESD3400,RESD3500:
                             RESD3600,RESD3700,RESD3800,RESD3900,RESD4000
.
RESD0100  MOVE      "C ",CATEGORY
          MOVE      PMRSCONT,CODE
          CALL      CODITM00
          GOTO      RESD9999
.
RESD0200  MATCH     SP70,PMRSTEXP
          GOTO      RESD9999 IF EQUAL
          UNPACK    PMRSTEXP,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RESD9999
.
RESD0300  MATCH     SP70,PMRSGRDT
          GOTO      RESD9999 IF EQUAL
          UNPACK    PMRSGRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RESD9999
.
RESD0400  WRITE     HTMLFILE;PMRSCOMM;    
          GOTO      RESD9999        
.
RESD0500  MATCH     SP70,PMRSVISN   
          GOTO      RESD9999 IF EQUAL
.
          WRITE     HTMLFILE;PMRSVISN;
          GOTO      RESD9999
.
RESD0600  MATCH     SP70,PMRSVEXP
          GOTO      RESD9999 IF EQUAL
          UNPACK    PMRSVEXP,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RESD9999
.
RESD0700  MOVE      "vt",CATEGORY
          MOVE      PMRSVTYP,CODE           * visa type
          CALL      CODITM00
          GOTO      RESD9999
.
RESD0800  WRITE     HTMLFILE;PMRSPNUM;      *  Passport number
          GOTO      RESD9999
.
RESD0900  MATCH     SP70,PMRSPEXP
          GOTO      RESD9999 IF EQUAL
          UNPACK    PMRSPEXP,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RESD9999
.
RESD1000  MOVE      "C ",CATEGORY
          MOVE      PMRSPCOU,CODE           * passport country
          CALL      CODITM00
          GOTO      RESD9999
.
RESD1100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,RESD1110,RESD1120
.
          WRITE     HTMLFILE;PMRSINCD;      * Insurance code
          GOTO      RESD9999
.
RESD1110  PACK      KEY6,PMRSINCD,SP70
          CALL      RDINSR1
          IF        OVRCD=0
            WRITE     HTMLFILE;INAME;
          ELSE
            WRITE     HTMLFILE;PMRSINCD;
          ENDIF

          GOTO      RESD9999
.
RESD1120  PACK      KEY6,SP70
          CALL      RDSINSR1
RESD1122  CALL      RDKINSR1
          BRANCH    OVRCD,RESD9999
.
          MATCH     SP70,ICODE
          GOTO      RESD1122 IF EQUAL
.
          PACK      KEY8,QUOTE,ICODE,QUOTE
          MATCH     ICODE,PMRSINCD
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               INAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",INAME,"</option>"
          ENDIF
          GOTO      RESD1122
.
RESD1200  WRITE     HTMLFILE;PMRSINFM;      * Fund membership no
          GOTO      RESD9999
.
RESD1300  MATCH     SP70,PMRSINEX
          GOTO      RESD9999 IF EQUAL
          UNPACK    PMRSINEX,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RESD9999
.
RESD1400  WRITE     HTMLFILE;PMRSSTDN;       * Student Number
          GOTO      RESD9999
.
RESD1500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,RESD1510
          WRITE     HTMLFILE;PMRSSCHL;       * Name of School
          GOTO      RESD9999
.
RESD1510  CALL      LSCH0000                * List of schools
          GOTO      RESD9999
.
RESD1600  WRITE     HTMLFILE;PMRSECON;      * Employer Name
          GOTO      RESD9999
.
RESD1700  MATCH     SP70,PMRSCAD1
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSCAD1;      * Address 1
          GOTO      RESD9999
.
RESD1800  MATCH     SP70,PMRSCAD2
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSCAD2;      * Address 2
          GOTO      RESD9999
.
RESD1900  MATCH     SP70,PMRSCAD3
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSCAD3;      * Address 3
          GOTO      RESD9999
.
RESD2000  MATCH     SP70,PMRSCAD4
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSCAD4;      * Address 4
          GOTO      RESD9999
.
RESD2100  MATCH     SP70,PMRSCPCD
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSCPCD;      * Postcode
          GOTO      RESD9999
.
RESD2200  WRITE     HTMLFILE;PMRSSBIL;      * Send bill to local address
          GOTO      RESD9999
.
RESD2300  WRITE     HTMLFILE;PMRSTINS;      * Travel Insurance
          GOTO      RESD9999
.
RESD2400  WRITE     HTMLFILE;PMRSIPOL;      * Travel Insurance policy number
          GOTO      RESD9999
.
RESD2500  WRITE     HTMLFILE;PMRSIEXD;      * Policy Number expiry date
          GOTO      RESD9999
.
RESD2600  WRITE     HTMLFILE;PMRSUCM1;      * comment 1
          GOTO      RESD9999
.
RESD2700  WRITE     HTMLFILE;PMRSUCM2;      * comment 2
          GOTO      RESD9999
.
RESD2800  WRITE     HTMLFILE;PMRSUCM3;      * comment 3
          GOTO      RESD9999
.
RESD2900  WRITE     HTMLFILE;PMRSUCM4;      * comment 4
          GOTO      RESD9999
.
RESD3000  WRITE     HTMLFILE;PMRSUCM5;      * comment 5
          GOTO      RESD9999
.
RESD3100  WRITE     HTMLFILE;PMRSCCNT;      * Employer Contact
          GOTO      RESD9999
.
RESD3200  WRITE     HTMLFILE;PMRSCPHN;      * Employer Phone
          GOTO      RESD9999
.
RESD3300  
.         MATCH     SP70,PMRSFSCH
.         GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSFSCH;      * Free Format Name of School
          GOTO      RESD9999
.
RESD3400  MATCH     SP70,PMRSSAD1
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSAD1;      * School Address line 1
          GOTO      RESD9999
.
RESD3500  MATCH     SP70,PMRSSAD2
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSAD2;      * School Address line 2
          GOTO      RESD9999
.
RESD3600  MATCH     SP70,PMRSSAD3
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSAD3;      * School Address line 3
          GOTO      RESD9999
.
RESD3700  MATCH     SP70,PMRSSAD4
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSAD4;      * School Address line 4
          GOTO      RESD9999
.
RESD3800  MATCH     SP70,PMRSSPCD
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSPCD;      * School postcode
          GOTO      RESD9999
.
RESD3900  MATCH     SP70,PMRSSCNT
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSCNT;      * School contact
          GOTO      RESD9999
.
RESD4000  MATCH     SP70,PMRSSPHN
          GOTO      RESD9999 IF EQUAL
          WRITE     HTMLFILE;PMRSSPHN;      * School phone
          GOTO      RESD9999
.
RESD9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for patient system Residency table
.------------------------------------------------------------
SPMRES00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMRES01,SPMRES02,SPMRES03,SPMRES04,SPMRES05:
                       SPMRES06,SPMRES07,SPMRES08,SPMRES09,SPMRES10:
                       SPMRES11,SPMRES12,SPMRES13,SPMRES14,SPMRES15:
                       SPMRES16,SPMRES17,SPMRES18,SPMRES19,SPMRES20:
                       SPMRES21,SPMRES22,SPMRES23,SPMRES24,SPMRES25:
                       SPMRES26,SPMRES27,SPMRES28,SPMRES29,SPMRES30:
                       SPMRES31,SPMRES32,SPMRES33,SPMRES34,SPMRES35:
                       SPMRES36,SPMRES37,SPMRES38,SPMRES39,SPMRES40
.
          MOVE      ONE,EXIT
          GOTO      SPMRES99
.
SPMRES01  MOVE      QRYDATA,PMRES001
          GOTO      SPMRES99
.
SPMRES02  MATCH     SP70,QRYDATA
          IF        @EQUAL|@EOS
            PACK      PMRES002,QRYDATA,SP70
            GOTO      SPMRES99
          ENDIF
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00              * Set CMON from MTHNAM3
          PACK      PMRES002,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMRES99
.
SPMRES03  MATCH     SP70,QRYDATA
          GOTO      SPMRES99 IF EQUAL
          GOTO      SPMRES99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00              * Set CMON from MTHNAM3
          PACK      PMRES003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMRES99
.
SPMRES04  MOVE      QRYDATA,PMRES004
          GOTO      SPMRES99
.
SPMRES05  MOVE      QRYDATA,PMRES005
          GOTO      SPMRES99
.
SPMRES06  MATCH     SP70,QRYDATA
          GOTO      SPMRES99 IF EQUAL
          GOTO      SPMRES99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMRES006,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMRES99
.
SPMRES07  MOVE      QRYDATA,PMRES007
          GOTO      SPMRES99
.
SPMRES08  MOVE      QRYDATA,PMRES008
          GOTO      SPMRES99
.
SPMRES09  MATCH     SP70,QRYDATA
          GOTO      SPMRES99 IF EQUAL
          GOTO      SPMRES99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMRES009,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMRES99
.
SPMRES10  MOVE      QRYDATA,PMRES010
          GOTO      SPMRES99
.
SPMRES11  MOVE      QRYDATA,PMRES011
          GOTO      SPMRES99
SPMRES12  MOVE      QRYDATA,PMRES012
          GOTO      SPMRES99
.
SPMRES13  MATCH     SP70,QRYDATA
          GOTO      SPMRES99 IF EQUAL
          GOTO      SPMRES99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMRES013,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMRES99
.
SPMRES14  MOVE      QRYDATA,PMRES014
          GOTO      SPMRES99
.
SPMRES15  MOVE      QRYDATA,PMRES015
          GOTO      SPMRES99
.
SPMRES16  MOVE      QRYDATA,PMRES016
          GOTO      SPMRES99
.
SPMRES17  
.         MATCH     SP70,QRYDATA
.         GOTO      SPMRES99 IF EQUAL
.         GOTO      SPMRES99 IF EOS
.
          MOVE      QRYDATA,PMRES017
          GOTO      SPMRES99
.
SPMRES18  MOVE      QRYDATA,PMRES018
          GOTO      SPMRES99
.
SPMRES19  MOVE      QRYDATA,PMRES019
          GOTO      SPMRES99
.
SPMRES20  MOVE      QRYDATA,PMRES020
          GOTO      SPMRES99
.
SPMRES21  MOVE      QRYDATA,PMRES021
          GOTO      SPMRES99
.
SPMRES22  MOVE      QRYDATA,PMRES022
          GOTO      SPMRES99
.
SPMRES23  MOVE      QRYDATA,PMRES023
          GOTO      SPMRES99
.
SPMRES24  MOVE      QRYDATA,PMRES024
          GOTO      SPMRES99
.
SPMRES25  MATCH     SP70,QRYDATA
          GOTO      SPMRES99 IF EQUAL
          GOTO      SPMRES99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMRES025,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMRES99
.
SPMRES26  MOVE      QRYDATA,PMRES026
          GOTO      SPMRES99
.
SPMRES27  MOVE      QRYDATA,PMRES027
          GOTO      SPMRES99
.
SPMRES28  MOVE      QRYDATA,PMRES028
          GOTO      SPMRES99
.
SPMRES29  MOVE      QRYDATA,PMRES029
          GOTO      SPMRES99
.
SPMRES30  MOVE      QRYDATA,PMRES030
          GOTO      SPMRES99
.
SPMRES31  MOVE      QRYDATA,PMRES031
          GOTO      SPMRES99
.
SPMRES32  MOVE      QRYDATA,PMRES032
          GOTO      SPMRES99
.
SPMRES33  MOVE      QRYDATA,PMRES033
          GOTO      SPMRES99
.
SPMRES34  MOVE      QRYDATA,PMRES034
          GOTO      SPMRES99
.
SPMRES35  MOVE      QRYDATA,PMRES035
          GOTO      SPMRES99
.
SPMRES36  MOVE      QRYDATA,PMRES036
          GOTO      SPMRES99
.
SPMRES37  MOVE      QRYDATA,PMRES037
          GOTO      SPMRES99
.
SPMRES38  MOVE      QRYDATA,PMRES038
          GOTO      SPMRES99
.
SPMRES39  MOVE      QRYDATA,PMRES039
          GOTO      SPMRES99
.
SPMRES40  MOVE      QRYDATA,PMRES040
          GOTO      SPMRES99
.
SPMRES99  RETURN
.------------------------------------------------------------------------
.         Update residency file
.------------------------------------------------------------------------
MVPMSRES  MATCH     Z70,PMRES001
          IF        !@EQUAL
            PACK      PMRSCONT,PMRES001,SP70
          ENDIF
          MATCH     Z70,PMRES002
          IF        !@EQUAL
            PACK      PMRSTEXP,PMRES002,SP70
          ENDIF
          MATCH     Z70,PMRES003
          IF        !@EQUAL
            PACK      PMRSGRDT,PMRES003,SP70
          ENDIF
          MATCH     Z70,PMRES004
          IF        !@EQUAL
            PACK      PMRSCOMM,PMRES004,SP70,SP70
          ENDIF
          MATCH     Z70,PMRES005
          IF        !@EQUAL
            PACK      PMRSVISN,PMRES005,SP70
          ENDIF
          MATCH     Z70,PMRES006
          IF        !@EQUAL
            PACK      PMRSVEXP,PMRES006,SP70
          ENDIF
          MATCH     Z70,PMRES007
          IF        !@EQUAL
            PACK      PMRSVTYP,PMRES007,SP70
          ENDIF
          MATCH     Z70,PMRES008
          IF        !@EQUAL
            PACK      PMRSPNUM,PMRES008,SP70
          ENDIF
          MATCH     Z70,PMRES009
          IF        !@EQUAL
            PACK      PMRSPEXP,PMRES009,SP70
          ENDIF
          MATCH     Z70,PMRES010
          IF        !@EQUAL
            PACK      PMRSPCOU,PMRES010,SP70
          ENDIF
          MATCH     Z70,PMRES011
          IF        !@EQUAL
            PACK      PMRSINCD,PMRES011,SP70
          ENDIF
          MATCH     Z70,PMRES012
          IF        !@EQUAL
            PACK      PMRSINFM,PMRES012,SP70
          ENDIF
          MATCH     Z70,PMRES013
          IF        !@EQUAL
            PACK      PMRSINEX,PMRES013,SP70
          ENDIF
          MATCH     Z70,PMRES014
          IF        !@EQUAL
            PACK      PMRSSTDN,PMRES014,SP70
          ENDIF
          MATCH     Z70,PMRES015
          IF        !@EQUAL
            PACK      PMRSSCHL,PMRES015,SP70
          ENDIF
          MATCH     Z70,PMRES016
          IF        !@EQUAL
            PACK      PMRSECON,PMRES016,SP70
          ENDIF
          MATCH     Z70,PMRES017
          IF        !@EQUAL
            PACK      PMRSCAD1,PMRES017,SP70
          ENDIF
          MATCH     Z70,PMRES018
          IF        !@EQUAL
            PACK      PMRSCAD2,PMRES018,SP70
          ENDIF
          MATCH     Z70,PMRES019
          IF        !@EQUAL
            PACK      PMRSCAD3,PMRES019,SP70
          ENDIF
          MATCH     Z70,PMRES020
          IF        !@EQUAL
            PACK      PMRSCAD4,PMRES020,SP70
          ENDIF
          MATCH     Z70,PMRES021
          IF        !@EQUAL
            PACK      PMRSCPCD,PMRES021,SP70
          ENDIF
          MATCH     Z70,PMRES022
          IF        !@EQUAL
            PACK      PMRSSBIL,PMRES022,SP70
          ENDIF
          MATCH     Z70,PMRES023
          IF        !@EQUAL
            PACK      PMRSTINS,PMRES023,SP70
          ENDIF
          MATCH     Z70,PMRES024
          IF        !@EQUAL
            PACK      PMRSIPOL,PMRES024,SP70
          ENDIF
          MATCH     Z70,PMRES025
          IF        !@EQUAL
            PACK      PMRSIEXD,PMRES025,SP70
          ENDIF
          MATCH     Z70,PMRES026
          IF        !@EQUAL
            PACK      PMRSUCM1,PMRES026,SP70
          ENDIF
          MATCH     Z70,PMRES027
          IF        !@EQUAL
            PACK      PMRSUCM2,PMRES027,SP70
          ENDIF
          MATCH     Z70,PMRES028
          IF        !@EQUAL
            PACK      PMRSUCM3,PMRES028,SP70
          ENDIF
          MATCH     Z70,PMRES029
          IF        !@EQUAL
            PACK      PMRSUCM4,PMRES029,SP70
          ENDIF
          MATCH     Z70,PMRES030
          IF        !@EQUAL
            PACK      PMRSUCM5,PMRES030,SP70
          ENDIF
          MATCH     Z70,PMRES031
          IF        !@EQUAL
            PACK      PMRSCCNT,PMRES031,SP70
          ENDIF
          MATCH     Z70,PMRES032
          IF        !@EQUAL
            PACK      PMRSCPHN,PMRES032,SP70
          ENDIF
          MATCH     Z70,PMRES033
          IF        !@EQUAL
            PACK      PMRSFSCH,PMRES033,SP70
          ENDIF
          MATCH     Z70,PMRES034
          IF        !@EQUAL
            PACK      PMRSSAD1,PMRES034,SP70
          ENDIF
          MATCH     Z70,PMRES035
          IF        !@EQUAL
            PACK      PMRSSAD2,PMRES035,SP70
          ENDIF
          MATCH     Z70,PMRES036
          IF        !@EQUAL
            PACK      PMRSSAD3,PMRES036,SP70
          ENDIF
          MATCH     Z70,PMRES037
          IF        !@EQUAL
            PACK      PMRSSAD4,PMRES037,SP70
          ENDIF
          MATCH     Z70,PMRES038
          IF        !@EQUAL
            PACK      PMRSSPCD,PMRES038,SP70
          ENDIF
          MATCH     Z70,PMRES039
          IF        !@EQUAL
            PACK      PMRSSCNT,PMRES039,SP70
          ENDIF
          MATCH     Z70,PMRES040
          IF        !@EQUAL
            PACK      PMRSSPHN,PMRES040,SP70
          ENDIF
          RETURN
.------------------------------------------------------------
.         List of School
.------------------------------------------------------------
LSCH0000  MOVE      "C",KEY1
          PACK      KEY7,KEY1,SP70
          CALL      RSPTEOR1
LSCH1000  CALL      RKPTEOR1
          BRANCH    OVRCD,LSCH9999
.
          MATCH     "C",PTERTYPE             * School Origanisation?
          GOTO      LSCH9999 IF NOT EQUAL
.
          MATCH     PTERCODE,PMRSSCHL
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",PTERCODE,"#" selected> ":
                               PTERCODE,": ",PTERNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTERCODE,"#"> ":
                               PTERCODE,": ",PTERNAME,"</option>"
          ENDIF
          GOTO      LSCH1000
.
LSCH9999  RETURN
