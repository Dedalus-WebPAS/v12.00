.----------------------------------------------------------------------
. Modifications
.
. V11.03.01  14/06/2023  J.Tan         TSK 0923703
.            Mod for MH events
. V11.02.02  24/10/2022  Davin         TSK 0923862
.            Added type 3 - VSTYP003
. V11.02.01  07/04/2022  Ebon Clements TSK 0915984
.            Added type 2 - VSTYP002
. V10.10.01  02/05/2017  Peter Vela    TSK 0837389
.            Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for Visit Extra Data Table
.------------------------------------------------------------------------
CLRVXD00  PACK      VSXDC001,SP70
          PACK      VSXDC002,SP70
          PACK      VSXDC003,SP70
          PACK      VSXDC004,SP70
          PACK      VSXDC005,SP70
          PACK      VSXDC006,SP70
          PACK      VSXDC007,SP70
          PACK      VSXDC008,SP70
          PACK      VSXDC009,SP70
          PACK      VSXDC010,SP70
          PACK      VSXDC011,SP70
          PACK      VSXDC012,SP70
          PACK      VSXDC013,SP70
          PACK      VSXDC014,SP70
          PACK      VSXDC015,SP70
          PACK      VSXDC016,SP70
          PACK      VSXDC017,SP70
          PACK      VSXDC018,SP70
          PACK      VSXDC019,SP70
          PACK      VSXDC020,SP70
          PACK      VSXDC021,SP70
          PACK      VSXDC022,SP70
          PACK      VSXDC023,SP70,SP70
          PACK      VSXDC024,SP70,SP70
          PACK      VSXDC025,SP70,SP70
          PACK      VSXDC026,SP70,SP70
          PACK      VSXDC027,SP70,SP70
          PACK      VSXDC028,SP70,SP70
          PACK      VSXDC029,SP70,SP70
          PACK      VSXDC030,SP70,SP70
          PACK      VSXDC031,SP70,SP70
          PACK      VSXDC032,SP70,SP70
          PACK      VSXDC033,SP70
          PACK      VSXDC034,SP70
          PACK      VSXDC035,SP70
          PACK      VSXDC036,SP70
          PACK      VSXDC037,SP70
          PACK      VSXDC038,SP70
          PACK      VSXDC039,SP70
          PACK      VSXDC040,SP70
          PACK      VSXDC041,SP70
          PACK      VSXDC042,SP70
          PACK      VSXDC043,SP70
          PACK      VSXDC044,SP70
          PACK      VSXDC045,SP70
          PACK      VSXDC046,SP70
          PACK      VSXDC047,SP70
          PACK      VSXDC048,SP70
          PACK      VSXDC049,SP70
          PACK      VSXDC050,SP70
          PACK      VSXDC051,SP70
          PACK      VSXDC052,SP70
          PACK      VSXDC053,SP70
          PACK      VSXDC054,SP70
          PACK      VSXDC055,SP70
          PACK      VSXDC056,SP70
          PACK      VSXDC057,SP70
          PACK      VSXDC058,SP70
          PACK      VSXDC059,SP70
          PACK      VSXDC060,SP70
          PACK      VSXDC061,SP70
          PACK      VSXDC062,SP70
          PACK      VSXDC063,SP70
          PACK      VSXDC064,SP70
          PACK      VSXDC065,SP70
          PACK      VSXDC066,SP70
          PACK      VSXDC067,SP70
          PACK      VSXDC068,SP70
          PACK      VSXDC069,SP70
          PACK      VSXDC070,SP70
          PACK      VSXDC071,SP70
          PACK      VSXDC072,SP70
.
CLRVXD99  RETURN
+
.------------------------------------------------------------
. Output Visit Extra Data Field
.------------------------------------------------------------
VSXD0000  BRANCH    FLDITMNO,VSXD0100,VSXD0200,VSXD0300,VSXD0400,VSXD0500:
                             VSXD0600,VSXD0700,VSXD0800,VSXD0900,VSXD1000:
                             VSXD1100,VSXD1200,VSXD1300,VSXD1400,VSXD1500:
                             VSXD1600,VSXD1700,VSXD1800,VSXD1900,VSXD2000:
                             VSXD2100,VSXD2200,VSXD2300,VSXD2400,VSXD2500:
                             VSXD2600,VSXD2700,VSXD2800,VSXD2900,VSXD3000:
                             VSXD2600,VSXD2700,VSXD2800,VSXD2900,VSXD3000:
                             VSXD3100,VSXD3200,VSXD3300,VSXD3400,VSXD3500:
                             VSXD3600,VSXD3700,VSXD3800,VSXD3900,VSXD4000:
                             VSXD4100,VSXD4200,VSXD4300,VSXD4400,VSXD4500:
                             VSXD4600,VSXD4700,VSXD4800,VSXD4900,VSXD5000:
                             VSXD5100,VSXD5200,VSXD5300,VSXD5400,VSXD5500:
                             VSXD5600,VSXD5700,VSXD5800,VSXD5900,VSXD6000:
                             VSXD6100,VSXD6200,VSXD6300,VSXD6400,VSXD6500:
                             VSXD6600,VSXD6700,VSXD6800,VSXD6900,VSXD7000:
                             VSXD7100,VSXD7200
.
VSXD0100  WRITE     HTMLFILE;VSXDVISN;
          GOTO      VSXD9999
.
VSXD0200  WRITE     HTMLFILE;VSXDTYDA;
          GOTO      VSXD9999
.
VSXD0300  WRITE     HTMLFILE;VSXDVAL1;
          GOTO      VSXD9999
.
VSXD0400  WRITE     HTMLFILE;VSXDVAL2;
          GOTO      VSXD9999
.
VSXD0500  WRITE     HTMLFILE;VSXDVAL3;
          GOTO      VSXD9999
.
VSXD0600  WRITE     HTMLFILE;VSXDVAL4;
          GOTO      VSXD9999
.
VSXD0700  WRITE     HTMLFILE;VSXDVAL5;
          GOTO      VSXD9999
.
VSXD0800  WRITE     HTMLFILE;VSXDVAL6;
          GOTO      VSXD9999
.
VSXD0900  WRITE     HTMLFILE;VSXDVAL7;
          GOTO      VSXD9999
.
VSXD1000  WRITE     HTMLFILE;VSXDVAL8;
          GOTO      VSXD9999
.
VSXD1100  WRITE     HTMLFILE;VSXDVAL9;
          GOTO      VSXD9999
.
VSXD1200  WRITE     HTMLFILE;VSXDVA10;
          GOTO      VSXD9999
.
VSXD1300  WRITE     HTMLFILE;VSXDCOD1;
          GOTO      VSXD9999
.
VSXD1400  WRITE     HTMLFILE;VSXDCOD2;
          GOTO      VSXD9999
.
VSXD1500  WRITE     HTMLFILE;VSXDCOD3;
          GOTO      VSXD9999
.
VSXD1600  WRITE     HTMLFILE;VSXDCOD4;
          GOTO      VSXD9999
.
VSXD1700  WRITE     HTMLFILE;VSXDCOD5;
          GOTO      VSXD9999
.
VSXD1800  WRITE     HTMLFILE;VSXDCOD6;
          GOTO      VSXD9999
.
VSXD1900  WRITE     HTMLFILE;VSXDCOD7;
          GOTO      VSXD9999
.
VSXD2000  WRITE     HTMLFILE;VSXDCOD8;
          GOTO      VSXD9999
.
VSXD2100  WRITE     HTMLFILE;VSXDCOD9;
          GOTO      VSXD9999
.
VSXD2200  WRITE     HTMLFILE;VSXDCO10;
          GOTO      VSXD9999
.
VSXD2300  WRITE     HTMLFILE;VSXDTXT1;
          GOTO      VSXD9999
.
VSXD2400  WRITE     HTMLFILE;VSXDTXT2;
          GOTO      VSXD9999
.
VSXD2500  WRITE     HTMLFILE;VSXDTXT3;
          GOTO      VSXD9999
.
VSXD2600  WRITE     HTMLFILE;VSXDTXT4;
          GOTO      VSXD9999
.
VSXD2700  WRITE     HTMLFILE;VSXDTXT5;
          GOTO      VSXD9999
.
VSXD2800  WRITE     HTMLFILE;VSXDTXT6;
          GOTO      VSXD9999
.
VSXD2900  WRITE     HTMLFILE;VSXDTXT7;
          GOTO      VSXD9999
.
VSXD3000  WRITE     HTMLFILE;VSXDTXT8;
          GOTO      VSXD9999
.
VSXD3100  WRITE     HTMLFILE;VSXDTXT9;
          GOTO      VSXD9999
.
VSXD3200  WRITE     HTMLFILE;VSXDTX10;
          GOTO      VSXD9999
.
VSXD3300  WRITE     HTMLFILE;VSXDYN01;
          GOTO      VSXD9999
.
VSXD3400  WRITE     HTMLFILE;VSXDYN02;
          GOTO      VSXD9999
.
VSXD3500  WRITE     HTMLFILE;VSXDYN03;
          GOTO      VSXD9999
.
VSXD3600  WRITE     HTMLFILE;VSXDYN04;
          GOTO      VSXD9999
.
VSXD3700  WRITE     HTMLFILE;VSXDYN05;
          GOTO      VSXD9999
.
VSXD3800  WRITE     HTMLFILE;VSXDYN06;
          GOTO      VSXD9999
.
VSXD3900  WRITE     HTMLFILE;VSXDYN07;
          GOTO      VSXD9999
.
VSXD4000  WRITE     HTMLFILE;VSXDYN08;
          GOTO      VSXD9999
.
VSXD4100  WRITE     HTMLFILE;VSXDYN09;
          GOTO      VSXD9999
.
VSXD4200  WRITE     HTMLFILE;VSXDYN10;
          GOTO      VSXD9999
.
VSXD4300  MATCH     SP70,VSXDDAT1
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD4400  WRITE     HTMLFILE;VSXDTIM1;
          GOTO      VSXD9999
.
VSXD4500  MATCH     SP70,VSXDDAT2
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD4600  WRITE     HTMLFILE;VSXDTIM2;
          GOTO      VSXD9999
.
VSXD4700  MATCH     SP70,VSXDDAT3
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD4800  WRITE     HTMLFILE;VSXDTIM3;
          GOTO      VSXD9999
.
VSXD4900  MATCH     SP70,VSXDDAT4
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD5000  WRITE     HTMLFILE;VSXDTIM4;
          GOTO      VSXD9999
.
VSXD5100  MATCH     SP70,VSXDDAT5
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT5,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD5200  WRITE     HTMLFILE;VSXDTIM5;
          GOTO      VSXD9999
.
VSXD5300  MATCH     SP70,VSXDDAT6
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT6,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD5400  WRITE     HTMLFILE;VSXDTIM6;
          GOTO      VSXD9999
.
VSXD5500  MATCH     SP70,VSXDDAT7
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT7,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD5600  WRITE     HTMLFILE;VSXDTIM7;
          GOTO      VSXD9999
.
VSXD5700  MATCH     SP70,VSXDDAT8
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT8,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD5800  WRITE     HTMLFILE;VSXDTIM8;
          GOTO      VSXD9999
.
VSXD5900  MATCH     SP70,VSXDDAT9
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDAT9,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD6000  WRITE     HTMLFILE;VSXDTIM9;
          GOTO      VSXD9999
.
VSXD6100  MATCH     SP70,VSXDDA10
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDDA10,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD6200  WRITE     HTMLFILE;VSXDTI10;
          GOTO      VSXD9999
.
VSXD6300  WRITE     HTMLFILE;VSXDDELT;
          GOTO      VSXD9999
.
VSXD6400  WRITE     HTMLFILE;VSXDCUSR;
          GOTO      VSXD9999
.
VSXD6500  MATCH     SP70,VSXDCDAT
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD6600  WRITE     HTMLFILE;VSXDCTIM;
          GOTO      VSXD9999
.
VSXD6700  WRITE     HTMLFILE;VSXDUUSR;
          GOTO      VSXD9999
.
VSXD6800  MATCH     SP70,VSXDUDAT
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD6900  WRITE     HTMLFILE;VSXDUTIM;
          GOTO      VSXD9999
.
VSXD7000  WRITE     HTMLFILE;VSXDUCID;
          GOTO      VSXD9999
.
VSXD7100  MATCH     SP70,VSXDUCDT
          GOTO      VSXD9999 IF EQUAL
          UNPACK    VSXDUCDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      VSXD9999
.
VSXD7200  WRITE     HTMLFILE;VSXDUCTM;
          GOTO      VSXD9999
.
VSXD9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for visit extra data table
.------------------------------------------------------------
SVSXDC00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SVSXDC01,SVSXDC02,SVSXDC03,SVSXDC04,SVSXDC05:
                       SVSXDC06,SVSXDC07,SVSXDC08,SVSXDC09,SVSXDC10:
                       SVSXDC11,SVSXDC12,SVSXDC13,SVSXDC14,SVSXDC15:
                       SVSXDC16,SVSXDC17,SVSXDC18,SVSXDC19,SVSXDC20:
                       SVSXDC21,SVSXDC22,SVSXDC23,SVSXDC24,SVSXDC25:
                       SVSXDC26,SVSXDC27,SVSXDC28,SVSXDC29,SVSXDC30:
                       SVSXDC31,SVSXDC32,SVSXDC33,SVSXDC34,SVSXDC35:
                       SVSXDC36,SVSXDC37,SVSXDC38,SVSXDC39,SVSXDC40:
                       SVSXDC41,SVSXDC42,SVSXDC43,SVSXDC44,SVSXDC45:
                       SVSXDC46,SVSXDC47,SVSXDC48,SVSXDC49,SVSXDC50:
                       SVSXDC51,SVSXDC52,SVSXDC53,SVSXDC54,SVSXDC55:
                       SVSXDC56,SVSXDC57,SVSXDC58,SVSXDC59,SVSXDC60:
                       SVSXDC61,SVSXDC62,SVSXDC63,SVSXDC64,SVSXDC65:
                       SVSXDC66,SVSXDC67,SVSXDC68,SVSXDC69,SVSXDC70:
                       SVSXDC71,SVSXDC72
.
          MOVE      ONE,EXIT
          GOTO      SVSXDC99
.
SVSXDC01  MOVE      QRYDATA,VSXDC001
          GOTO      SVSXDC99
.
SVSXDC02  MOVE      QRYDATA,VSXDC002
          GOTO      SVSXDC99
.
SVSXDC03  MOVE      QRYDATA,VSXDC003
          GOTO      SVSXDC99
.
SVSXDC04  MOVE      QRYDATA,VSXDC004
          GOTO      SVSXDC99
.
SVSXDC05  MOVE      QRYDATA,VSXDC005
          GOTO      SVSXDC99
.
SVSXDC06  MOVE      QRYDATA,VSXDC006
          GOTO      SVSXDC99
.
SVSXDC07  MOVE      QRYDATA,VSXDC007
          GOTO      SVSXDC99
.
SVSXDC08  MOVE      QRYDATA,VSXDC008
          GOTO      SVSXDC99
.
SVSXDC09  MOVE      QRYDATA,VSXDC009
          GOTO      SVSXDC99
.
SVSXDC10  MOVE      QRYDATA,VSXDC010
          GOTO      SVSXDC99
.
SVSXDC11  MOVE      QRYDATA,VSXDC011
          GOTO      SVSXDC99
.
SVSXDC12  MOVE      QRYDATA,VSXDC012
          GOTO      SVSXDC99
.
SVSXDC13  MOVE      QRYDATA,VSXDC013
          GOTO      SVSXDC99
.
SVSXDC14  MOVE      QRYDATA,VSXDC014
          GOTO      SVSXDC99
.
SVSXDC15  MOVE      QRYDATA,VSXDC015
          GOTO      SVSXDC99
.
SVSXDC16  MOVE      QRYDATA,VSXDC016 
          GOTO      SVSXDC99
.
SVSXDC17  MOVE      QRYDATA,VSXDC017
          GOTO      SVSXDC99
.
SVSXDC18  MOVE      QRYDATA,VSXDC018
          GOTO      SVSXDC99
.
SVSXDC19  MOVE      QRYDATA,VSXDC019
          GOTO      SVSXDC99
.
SVSXDC20  MOVE      QRYDATA,VSXDC020
          GOTO      SVSXDC99
.
SVSXDC21  MOVE      QRYDATA,VSXDC021
          GOTO      SVSXDC99
.
SVSXDC22  MOVE      QRYDATA,VSXDC022
          GOTO      SVSXDC99
.
SVSXDC23  MOVE      QRYDATA,VSXDC023
          GOTO      SVSXDC99
.
SVSXDC24  MOVE      QRYDATA,VSXDC024
          GOTO      SVSXDC99
.
SVSXDC25  MOVE      QRYDATA,VSXDC025
          GOTO      SVSXDC99
.
SVSXDC26  MOVE      QRYDATA,VSXDC026
          GOTO      SVSXDC99
.
SVSXDC27  MOVE      QRYDATA,VSXDC027
          GOTO      SVSXDC99
.
SVSXDC28  MOVE      QRYDATA,VSXDC028
          GOTO      SVSXDC99
.
SVSXDC29  MOVE      QRYDATA,VSXDC029
          GOTO      SVSXDC99
.
SVSXDC30  MOVE      QRYDATA,VSXDC030
          GOTO      SVSXDC99
.
SVSXDC31  MOVE      QRYDATA,VSXDC031
          GOTO      SVSXDC99
.
SVSXDC32  MOVE      QRYDATA,VSXDC032
          GOTO      SVSXDC99
.
SVSXDC33  MOVE      QRYDATA,VSXDC033 
          GOTO      SVSXDC99
.
SVSXDC34  MOVE      QRYDATA,VSXDC034
          GOTO      SVSXDC99
.
SVSXDC35  MOVE      QRYDATA,VSXDC035
          GOTO      SVSXDC99
.
SVSXDC36  MOVE      QRYDATA,VSXDC036
          GOTO      SVSXDC99
.
SVSXDC37  MOVE      QRYDATA,VSXDC037
          GOTO      SVSXDC99
.
SVSXDC38  MOVE      QRYDATA,VSXDC038
          GOTO      SVSXDC99
.
SVSXDC39  MOVE      QRYDATA,VSXDC039
          GOTO      SVSXDC99
.
SVSXDC40  MOVE      QRYDATA,VSXDC040
          GOTO      SVSXDC99
.
SVSXDC41  MOVE      QRYDATA,VSXDC041
          GOTO      SVSXDC99
.
SVSXDC42  MOVE      QRYDATA,VSXDC042
          GOTO      SVSXDC99
.
SVSXDC43  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC043,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC44  MOVE      QRYDATA,VSXDC044
          GOTO      SVSXDC99
.
SVSXDC45  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC045,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC46  MOVE      QRYDATA,VSXDC046
          GOTO      SVSXDC99
.
SVSXDC47  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC047,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC48  MOVE      QRYDATA,VSXDC048
          GOTO      SVSXDC99
.
SVSXDC49  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC049,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC50  MOVE      QRYDATA,VSXDC050
          GOTO      SVSXDC99
.
SVSXDC51  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC051,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC52  MOVE      QRYDATA,VSXDC052
          GOTO      SVSXDC99
.
SVSXDC53  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC053,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC54  MOVE      QRYDATA,VSXDC054
          GOTO      SVSXDC99
.
SVSXDC55  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC055,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC56  MOVE      QRYDATA,VSXDC056
          GOTO      SVSXDC99
.
SVSXDC57  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC057,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC58  MOVE      QRYDATA,VSXDC058
          GOTO      SVSXDC99
.
SVSXDC59  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC059,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC60  MOVE      QRYDATA,VSXDC060
          GOTO      SVSXDC99
.
SVSXDC61  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC061,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC62  MOVE      QRYDATA,VSXDC062
          GOTO      SVSXDC99
.
SVSXDC63  MOVE      QRYDATA,VSXDC063
          GOTO      SVSXDC99
.
SVSXDC64  MOVE      QRYDATA,VSXDC064
          GOTO      SVSXDC99
.
SVSXDC65  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC065,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC66  MOVE      QRYDATA,VSXDC066
          GOTO      SVSXDC99
.
SVSXDC67  MOVE      QRYDATA,VSXDC067
          GOTO      SVSXDC99
.
SVSXDC68  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC068,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC69  MOVE      QRYDATA,VSXDC069
          GOTO      SVSXDC99
.
SVSXDC70  MOVE      QRYDATA,VSXDC070
          GOTO      SVSXDC99
.
SVSXDC71  MATCH     SP70,QRYDATA
          GOTO      SVSXDC99 IF EQUAL
          GOTO      SVSXDC99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      VSXDC071,CCENT,CYEAR,CMON,CDAY
          GOTO      SVSXDC99
.
SVSXDC72  MOVE      QRYDATA,VSXDC072
          GOTO      SVSXDC99
.
SVSXDC99  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to theatre attributes file variables
.------------------------------------------------------------------------
MVVISXDC  PACK      VSXDVISN,VSXDC001,SP70
          PACK      VSXDTYDA,VSXDC002,SP70
          PACK      VSXDVAL1,VSXDC003,SP70
          PACK      VSXDVAL2,VSXDC004,SP70
          PACK      VSXDVAL3,VSXDC005,SP70
          PACK      VSXDVAL4,VSXDC006,SP70
          PACK      VSXDVAL5,VSXDC007,SP70
          PACK      VSXDVAL6,VSXDC008,SP70
          PACK      VSXDVAL7,VSXDC009,SP70
          PACK      VSXDVAL8,VSXDC010,SP70
          PACK      VSXDVAL9,VSXDC011,SP70
          PACK      VSXDVA10,VSXDC012,SP70
          PACK      VSXDCOD1,VSXDC013,SP70
          PACK      VSXDCOD2,VSXDC014,SP70
          PACK      VSXDCOD3,VSXDC005,SP70
          PACK      VSXDCOD4,VSXDC006,SP70
          PACK      VSXDCOD5,VSXDC007,SP70
          PACK      VSXDCOD6,VSXDC008,SP70
          PACK      VSXDCOD7,VSXDC009,SP70
          PACK      VSXDCOD8,VSXDC020,SP70
          PACK      VSXDCOD9,VSXDC021,SP70
          PACK      VSXDCO10,VSXDC022,SP70
          PACK      VSXDTXT1,VSXDC023,SP70,SP70
          PACK      VSXDTXT2,VSXDC024,SP70,SP70
          PACK      VSXDTXT3,VSXDC025,SP70,SP70
          PACK      VSXDTXT4,VSXDC026,SP70,SP70
          PACK      VSXDTXT5,VSXDC027,SP70,SP70
          PACK      VSXDTXT6,VSXDC028,SP70,SP70
          PACK      VSXDTXT7,VSXDC029,SP70,SP70
          PACK      VSXDTXT8,VSXDC030,SP70,SP70
          PACK      VSXDTXT9,VSXDC031,SP70,SP70
          PACK      VSXDTX10,VSXDC032,SP70,SP70
          PACK      VSXDYN01,VSXDC033,SP70
          PACK      VSXDYN02,VSXDC034,SP70
          PACK      VSXDYN03,VSXDC035,SP70
          PACK      VSXDYN04,VSXDC036,SP70
          PACK      VSXDYN05,VSXDC037,SP70
          PACK      VSXDYN06,VSXDC038,SP70
          PACK      VSXDYN07,VSXDC039,SP70
          PACK      VSXDYN08,VSXDC040,SP70
          PACK      VSXDYN09,VSXDC041,SP70
          PACK      VSXDYN10,VSXDC042,SP70
          PACK      VSXDDAT1,VSXDC043,SP70
          PACK      VSXDTIM1,VSXDC044,SP70
          PACK      VSXDDAT2,VSXDC045,SP70
          PACK      VSXDTIM2,VSXDC046,SP70
          PACK      VSXDDAT3,VSXDC047,SP70
          PACK      VSXDTIM3,VSXDC048,SP70
          PACK      VSXDDAT4,VSXDC049,SP70
          PACK      VSXDTIM4,VSXDC050,SP70
          PACK      VSXDDAT5,VSXDC051,SP70
          PACK      VSXDTIM5,VSXDC052,SP70
          PACK      VSXDDAT6,VSXDC053,SP70
          PACK      VSXDTIM6,VSXDC054,SP70
          PACK      VSXDDAT7,VSXDC055,SP70
          PACK      VSXDTIM7,VSXDC056,SP70
          PACK      VSXDDAT8,VSXDC057,SP70
          PACK      VSXDTIM8,VSXDC058,SP70
          PACK      VSXDDAT9,VSXDC059,SP70
          PACK      VSXDTIM9,VSXDC060,SP70
          PACK      VSXDDA10,VSXDC061,SP70
          PACK      VSXDTI10,VSXDC062,SP70
          PACK      VSXDDELT,VSXDC063,SP70
          PACK      VSXDCUSR,VSXDC064,SP70
          PACK      VSXDCDAT,VSXDC065,SP70
          PACK      VSXDCTIM,VSXDC066,SP70
          PACK      VSXDUUSR,VSXDC067,SP70
          PACK      VSXDUDAT,VSXDC068,SP70
          PACK      VSXDUTIM,VSXDC069,SP70
          PACK      VSXDUCID,VSXDC070,SP70
          PACK      VSXDUCDT,VSXDC071,SP70
          PACK      VSXDUCTM,VSXDC072,SP70
.
          RETURN
+
.------------------------------------------------------------
.         Get the Coded Field (1-10) value for the specified 
.         Type of Data Collection (1).
.
.         Parameters:
.           VSXDC001  Theatre Unique ID
.           VSTYPIND  Type of Data Collection index (1)
.           VSCODIND  Coded Field index (1-10)
.
.         Return:
.           VSCODVAL  Coded Field Value (DIM3)
.------------------------------------------------------------
GETVCV00  MOVE      SP70,VSCODVAL
          MOVE      SP70,VSXDC002
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,GETVCV91
.
          BRANCH    VSCODIND,GETVCV21,GETVCV22,GETVCV23,GETVCV24,GETVCV25:
                             GETVCV26,GETVCV27,GETVCV28,GETVCV29,GETVCV30
          GOTO      GETVCV91
.
GETVCV21  MOVE      VSXDCOD1,VSCODVAL
          GOTO      GETVCV90
.
GETVCV22  MOVE      VSXDCOD2,VSCODVAL
          GOTO      GETVCV90
.
GETVCV23  MOVE      VSXDCOD3,VSCODVAL
          GOTO      GETVCV90
.
GETVCV24  MOVE      VSXDCOD4,VSCODVAL
          GOTO      GETVCV90
.
GETVCV25  MOVE      VSXDCOD5,VSCODVAL
          GOTO      GETVCV90
.
GETVCV26  MOVE      VSXDCOD6,VSCODVAL
          GOTO      GETVCV90
.
GETVCV27  MOVE      VSXDCOD7,VSCODVAL
          GOTO      GETVCV90
.
GETVCV28  MOVE      VSXDCOD8,VSCODVAL
          GOTO      GETVCV90
.
GETVCV29  MOVE      VSXDCOD9,VSCODVAL
          GOTO      GETVCV90
.
GETVCV30  MOVE      VSXDCO10,VSCODVAL
          GOTO      GETVCV90
.
GETVCV90  MOVE      ZERO,EXIT
          GOTO      GETVCV99
.
GETVCV91  MOVE      ONE,EXIT
GETVCV99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Coded Field (1-10) value for the specified 
.         Type of Data Collection (1).
.         If a record does not exist for the specified type of data, a new 
.         record will be written to file.
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data Collection
.           VSTYPIND  Type of Data Collection index (1)
.           VSCODIND  Coded Field index (1-10)
.           VSCODVAL  Coded Field value (DIM3)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDVCV00  MOVE      SP70,VSXDC002
          CALL      IBACLOCK
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
.         RJUSTIFY  VSCODVAL
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,UPDVCV91
.
          BRANCH    VSCODIND,UPDVCV21,UPDVCV22,UPDVCV23,UPDVCV24,UPDVCV25:
                             UPDVCV26,UPDVCV27,UPDVCV28,UPDVCV29,UPDVCV30
          GOTO      UPDVCV90
.
UPDVCV21  MOVE      VSCODVAL,VSXDCOD1
          GOTO      UPDVCV90
.
UPDVCV22  MOVE      VSCODVAL,VSXDCOD2
          GOTO      UPDVCV90
.
UPDVCV23  MOVE      VSCODVAL,VSXDCOD3
          GOTO      UPDVCV90
.
UPDVCV24  MOVE      VSCODVAL,VSXDCOD4
          GOTO      UPDVCV90
.
UPDVCV25  MOVE      VSCODVAL,VSXDCOD5
          GOTO      UPDVCV90
.
UPDVCV26  MOVE      VSCODVAL,VSXDCOD6
          GOTO      UPDVCV90
.
UPDVCV27  MOVE      VSCODVAL,VSXDCOD7
          GOTO      UPDVCV90
.
UPDVCV28  MOVE      VSCODVAL,VSXDCOD8
          GOTO      UPDVCV90
.
UPDVCV29  MOVE      VSCODVAL,VSXDCOD9
          GOTO      UPDVCV90
.
UPDVCV30  MOVE      VSCODVAL,VSXDCO10
          GOTO      UPDVCV90
.
UPDVCV90  MOVE      USERID,VSXDUUSR
          PACK      VSXDUDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDUDAT
          MOVE      CTIMEIS,VSXDUTIM
          CALL      UPVSXDC1
          MOVE      ZERO,EXIT
          GOTO      UPDVCV99
.
UPDVCV91  CALL      CLVISXDC
          MOVE      VSXDC001,VSXDVISN
          MOVE      VSXDC002,VSXDTYDA
          STORE     VSCODVAL,VSCODIND,VSXDCOD1,VSXDCOD2,VSXDCOD3,VSXDCOD4:
                                      VSXDCOD5,VSXDCOD6,VSXDCOD7,VSXDCOD8:
                                      VSXDCOD9,VSXDCO10
          MOVE      USERID,VSXDCUSR
          PACK      VSXDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDCDAT
          MOVE      CTIMEIS,VSXDCTIM
.
          PACK      KEY11,VSXDVISN,VSXDTYDA,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRVSXDC1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDVCV99
.
UPDVCV99  RETURN
+
.------------------------------------------------------------------------------
.         Get the Text Field (1-10) value for the specified Type of Data (1)
.
.         Parameters:
.           VSXDC001  Theatre Unique ID
.           VSXDC002  Type of Attribute
.           VSTYPIND  Attribute Type index (1)
.           VSTXTIND  Text Field index (1-10)
.
.         Return:
.           VSTXTVAL  Text Field Value (DIM80)
.------------------------------------------------------------------------------
GETTVV00  PACK      VSTXTVAL,SP70,SP70
          MOVE      SP70,VSXDC002
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,GETTVV91
.
          BRANCH    VSTXTIND,GETTVV21,GETTVV22,GETTVV23,GETTVV24,GETTVV25:
                             GETTVV26,GETTVV27,GETTVV28,GETTVV29,GETTVV30
          GOTO      GETTVV91
.
GETTVV21  MOVE      VSXDTXT1,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV22  MOVE      VSXDTXT2,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV23  MOVE      VSXDTXT3,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV24  MOVE      VSXDTXT4,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV25  MOVE      VSXDTXT5,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV26  MOVE      VSXDTXT6,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV27  MOVE      VSXDTXT7,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV28  MOVE      VSXDTXT8,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV29  MOVE      VSXDTXT9,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV30  MOVE      VSXDTX10,VSTXTVAL
          GOTO      GETTVV90
.
GETTVV90  MOVE      ZERO,EXIT
          GOTO      GETTVV99
.
GETTVV91  MOVE      ONE,EXIT
GETTVV99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Text Field (1-10) value for the specified 
.         Type of Data (1-10); 
.         If a record does not exist for the specified type of data, a new 
.         record will be written to file.
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data Collection
.           VSTYPIND  Type of Data index (1)
.           VSTXTIND  Text Field index (1-10)
.           VSTXTVAL  Text Field value (DIM80)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDVTV00  MOVE      SP70,VSXDC002
          CALL      IBACLOCK
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,UPDVTV91
.
          BRANCH    VSTXTIND,UPDVTV21,UPDVTV22,UPDVTV23,UPDVTV24,UPDVTV25:
                             UPDVTV26,UPDVTV27,UPDVTV28,UPDVTV29,UPDVTV30
          GOTO      UPDVTV90
.
UPDVTV21  MOVE      VSTXTVAL,VSXDTXT1
          GOTO      UPDVTV90
.
UPDVTV22  MOVE      VSTXTVAL,VSXDTXT2
          GOTO      UPDVTV90
.
UPDVTV23  MOVE      VSTXTVAL,VSXDTXT3
          GOTO      UPDVTV90
.
UPDVTV24  MOVE      VSTXTVAL,VSXDTXT4
          GOTO      UPDVTV90
.
UPDVTV25  MOVE      VSTXTVAL,VSXDTXT5
          GOTO      UPDVTV90
.
UPDVTV26  MOVE      VSTXTVAL,VSXDTXT6
          GOTO      UPDVTV90
.
UPDVTV27  MOVE      VSTXTVAL,VSXDTXT7
          GOTO      UPDVTV90
.
UPDVTV28  MOVE      VSTXTVAL,VSXDTXT8
          GOTO      UPDVTV90
.
UPDVTV29  MOVE      VSTXTVAL,VSXDTXT9
          GOTO      UPDVTV90
.
UPDVTV30  MOVE      VSTXTVAL,VSXDTX10
          GOTO      UPDVTV90
.
UPDVTV90  MOVE      USERID,VSXDUUSR
          PACK      VSXDUDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDUDAT
          MOVE      CTIMEIS,VSXDUTIM
          CALL      UPVSXDC1
          MOVE      ZERO,EXIT
          GOTO      UPDVTV99
.
UPDVTV91  CALL      CLVISXDC
          MOVE      VSXDC001,VSXDVISN
          MOVE      VSXDC002,VSXDTYDA
          STORE     VSTXTVAL,VSTXTIND,VSXDTXT1,VSXDTXT2,VSXDTXT3,VSXDTXT4:
                                      VSXDTXT5,VSXDTXT6,VSXDTXT7,VSXDTXT8:
                                      VSXDTXT9,VSXDTX10
          PACK      VSXDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDCDAT
          MOVE      CTIMEIS,VSXDCTIM
          MOVE      USERID,VSXDCUSR
.
          PACK      KEY11,VSXDVISN,VSXDTYDA,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRVSXDC1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDVTV99
.
UPDVTV99  RETURN
+
.------------------------------------------------------------
.         Get the Value Field (1-10) value for the specified
.         Type of Data (1).
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSVALIND  Value Field index (1-10)
.
.         Return:
.           VSVALVAL  Value Field Value (DIM10)
.------------------------------------------------------------
GETOVL00  MOVE      SP70,VSVALVAL
          MOVE      SP70,VSXDC002
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,GETOVL91
.
          BRANCH    VSVALIND,GETOVL21,GETOVL22,GETOVL23,GETOVL24
          GOTO      GETOVL91
.
GETOVL21  MOVE      VSXDVAL1,VSVALVAL
          GOTO      GETOVL90
.
GETOVL22  MOVE      VSXDVAL2,VSVALVAL
          GOTO      GETOVL90
.
GETOVL23  MOVE      VSXDVAL3,VSVALVAL
          GOTO      GETOVL90
.
GETOVL24  MOVE      VSXDVAL4,VSVALVAL
          GOTO      GETOVL90
.
GETOVL25  MOVE      VSXDVAL5,VSVALVAL
          GOTO      GETOVL90
.
GETOVL26  MOVE      VSXDVAL6,VSVALVAL
          GOTO      GETOVL90
.
GETOVL27  MOVE      VSXDVAL7,VSVALVAL
          GOTO      GETOVL90
.
GETOVL28  MOVE      VSXDVAL8,VSVALVAL
          GOTO      GETOVL90
.
GETOVL29  MOVE      VSXDVAL9,VSVALVAL
          GOTO      GETOVL90
.
GETOVL30  MOVE      VSXDVA10,VSVALVAL
          GOTO      GETOVL90
.
GETOVL90  MOVE      ZERO,EXIT
          GOTO      GETOVL99
.
GETOVL91  MOVE      ONE,EXIT
GETOVL99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Value Field (1-10) value for the specified
.         Type of data (1); 
.         If a record does not exist for the specified type of data, a new
.         record will be written to file.
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSVALIND  Coded Field index (1-10)
.           VSVALVAL  Coded Field value (DIM10)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDOVL00  MOVE      SP70,VSXDC002
          CALL      IBACLOCK
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
.         RJUSTIFY  VSVALVAL
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,UPDOVL91
.
          BRANCH    VSVALIND,UPDOVL21,UPDOVL22,UPDOVL23,UPDOVL24,UPDOVL25:
                             UPDOVL26,UPDOVL27,UPDOVL28,UPDOVL29,UPDOVL30
          GOTO      UPDOVL90
.
UPDOVL21  MOVE      VSVALVAL,VSXDVAL1
          GOTO      UPDOVL90
.
UPDOVL22  MOVE      VSVALVAL,VSXDVAL2
          GOTO      UPDOVL90
.
UPDOVL23  MOVE      VSVALVAL,VSXDVAL3
          GOTO      UPDOVL90
.
UPDOVL24  MOVE      VSVALVAL,VSXDVAL4
          GOTO      UPDOVL90
.
UPDOVL25  MOVE      VSVALVAL,VSXDVAL5
          GOTO      UPDOVL90
.
UPDOVL26  MOVE      VSVALVAL,VSXDVAL6
          GOTO      UPDOVL90
.
UPDOVL27  MOVE      VSVALVAL,VSXDVAL7
          GOTO      UPDOVL90
.
UPDOVL28  MOVE      VSVALVAL,VSXDVAL8
          GOTO      UPDOVL90
.
UPDOVL29  MOVE      VSVALVAL,VSXDVAL9
          GOTO      UPDOVL90
.
UPDOVL30  MOVE      VSVALVAL,VSXDVA10
          GOTO      UPDOVL90
.
UPDOVL90  MOVE      USERID,VSXDUUSR
          PACK      VSXDUDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDUDAT
          MOVE      CTIMEIS,VSXDUTIM
          CALL      UPVSXDC1
          MOVE      ZERO,EXIT
          GOTO      UPDOVL99
.
UPDOVL91  CALL      CLVISXDC
          MOVE      VSXDC001,VSXDVISN
          MOVE      VSXDC002,VSXDTYDA
          STORE     VSVALVAL,VSVALIND,VSXDVAL1,VSXDVAL2,VSXDVAL3,VSXDVAL4:
                                      VSXDVAL5,VSXDVAL6,VSXDVAL7,VSXDVAL8:
                                      VSXDVAL9,VSXDVA10
          PACK      VSXDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDCDAT
          MOVE      CTIMEIS,VSXDCTIM
          MOVE      USERID,VSXDCUSR
.
          PACK      KEY11,VSXDVISN,VSXDTYDA,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRVSXDC1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDOVL99
.
UPDOVL99  RETURN
+
.------------------------------------------------------------
.         Get the Yes No Field (1-10) value for the specified
.         Type of Data (1).
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSYENIND  Yes/No Field index (1-10)
.
.         Return:
.           VSYENVAL  Yes No Field Value (DIM1)
.------------------------------------------------------------
GETVYN00  MOVE      SP70,VSYENVAL
          MOVE      SP70,VSXDC002
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,GETVYN91
.
          BRANCH    VSYENIND,GETVYN21,GETVYN22,GETVYN23,GETVYN24,GETVYN25:
                             GETVYN26,GETVYN27,GETVYN28,GETVYN29,GETVYN30
          GOTO      GETVYN91
.
GETVYN21  MOVE      VSXDYN01,VSYENVAL
          GOTO      GETVYN90
.
GETVYN22  MOVE      VSXDYN02,VSYENVAL
          GOTO      GETVYN90
.
GETVYN23  MOVE      VSXDYN03,VSYENVAL
          GOTO      GETVYN90
.
GETVYN24  MOVE      VSXDYN04,VSYENVAL
          GOTO      GETVYN90
.
GETVYN25  MOVE      VSXDYN05,VSYENVAL
          GOTO      GETVYN90
.
GETVYN26  MOVE      VSXDYN06,VSYENVAL
          GOTO      GETVYN90
.
GETVYN27  MOVE      VSXDYN07,VSYENVAL
          GOTO      GETVYN90
.
GETVYN28  MOVE      VSXDYN08,VSYENVAL
          GOTO      GETVYN90
.
GETVYN29  MOVE      VSXDYN09,VSYENVAL
          GOTO      GETVYN90
.
GETVYN30  MOVE      VSXDYN10,VSYENVAL
          GOTO      GETVYN90
.
GETVYN90  MOVE      ZERO,EXIT
          GOTO      GETVYN99
.
GETVYN91  MOVE      ONE,EXIT
GETVYN99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Yes No Field (1-10) value for the specified
.         Type of Data (1);
.         If a record does not exist for the specified type of data, a new
.         record will be written to file.
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSYENIND  Y/N Field index (1-10)
.           VSYENVAL  Y/N Field value (DIM1)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDVYN00  MOVE      SP70,VSXDC002
          CALL      IBACLOCK
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
.         RJUSTIFY  VSYENVAL
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,UPDVYN91
.
          BRANCH    VSYENIND,UPDVYN21,UPDVYN22,UPDVYN23,UPDVYN24,UPDVYN25:
                             UPDVYN26,UPDVYN27,UPDVYN28,UPDVYN29,UPDVYN30
          GOTO      UPDVYN90
.
UPDVYN21  MOVE      VSYENVAL,VSXDYN01
          GOTO      UPDVYN90
.
UPDVYN22  MOVE      VSYENVAL,VSXDYN02
          GOTO      UPDVYN90
.
UPDVYN23  MOVE      VSYENVAL,VSXDYN03
          GOTO      UPDVYN90
.
UPDVYN24  MOVE      VSYENVAL,VSXDYN04
          GOTO      UPDVYN90
.
UPDVYN25  MOVE      VSYENVAL,VSXDYN05
          GOTO      UPDVYN90
.
UPDVYN26  MOVE      VSYENVAL,VSXDYN06
          GOTO      UPDVYN90
.
UPDVYN27  MOVE      VSYENVAL,VSXDYN07
          GOTO      UPDVYN90
.
UPDVYN28  MOVE      VSYENVAL,VSXDYN08
          GOTO      UPDVYN90
.
UPDVYN29  MOVE      VSYENVAL,VSXDYN09
          GOTO      UPDVYN90
.
UPDVYN30  MOVE      VSYENVAL,VSXDYN10
          GOTO      UPDVYN90
.
UPDVYN90  MOVE      USERID,VSXDUUSR
          PACK      VSXDUDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDUDAT
          MOVE      CTIMEIS,VSXDUTIM
          CALL      UPVSXDC1
          MOVE      ZERO,EXIT
          GOTO      UPDVYN99
.
UPDVYN91  CALL      CLVISXDC
          MOVE      VSXDC001,VSXDVISN
          MOVE      VSXDC002,VSXDTYDA
          STORE     VSYENVAL,VSYENIND,VSXDYN01,VSXDYN02,VSXDYN03,VSXDYN04:
                                      VSXDYN05,VSXDYN06,VSXDYN07,VSXDYN08:
                                      VSXDYN09,VSXDYN10
          PACK      VSXDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDCDAT
          MOVE      CTIMEIS,VSXDCTIM
          MOVE      USERID,VSXDCUSR
.
          PACK      KEY11,VSXDVISN,VSXDTYDA,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRVSXDC1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDVYN99
.
UPDVYN99  RETURN
+
.------------------------------------------------------------
.         Get the Date Field (1-10) value for the specified
.         Type of Data (1).
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSDATIND  Date Field index (1-10)
.
.         Return:
.           VSDATVAL  Date Field Value (DIM8)
.------------------------------------------------------------
GETVDT00  MOVE      SP70,VSDATVAL
          MOVE      SP70,VSXDC002
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,GETVDT91
.
          BRANCH    VSDATIND,GETVDT21,GETVDT22,GETVDT23,GETVDT24,GETVDT25:
                             GETVDT26,GETVDT27,GETVDT28,GETVDT29,GETVDT30
          GOTO      GETVDT91
.
GETVDT21  MOVE      VSXDDAT1,VSDATVAL
          GOTO      GETVDT90
.
GETVDT22  MOVE      VSXDDAT2,VSDATVAL
          GOTO      GETVDT90
.
GETVDT23  MOVE      VSXDDAT3,VSDATVAL
          GOTO      GETVDT90
.
GETVDT24  MOVE      VSXDDAT4,VSDATVAL
          GOTO      GETVDT90
.
GETVDT25  MOVE      VSXDDAT5,VSDATVAL
          GOTO      GETVDT90
.
GETVDT26  MOVE      VSXDDAT6,VSDATVAL
          GOTO      GETVDT90
.
GETVDT27  MOVE      VSXDDAT7,VSDATVAL
          GOTO      GETVDT90
.
GETVDT28  MOVE      VSXDDAT8,VSDATVAL
          GOTO      GETVDT90
.
GETVDT29  MOVE      VSXDDAT9,VSDATVAL
          GOTO      GETVDT90
.
GETVDT30  MOVE      VSXDDA10,VSDATVAL
          GOTO      GETVDT90
.
GETVDT90  MOVE      ZERO,EXIT
          GOTO      GETVDT99
.
GETVDT91  MOVE      ONE,EXIT
GETVDT99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Date Field (1-10) value for the specified
.         Type of Data (1);
.         If a record does not exist for the specified type of data, a new
.         record will be written to file.
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSDATIND  Date Field index (1-10)
.           VSDATVAL  Date Field value (DIM8)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDVDT00  MOVE      SP70,VSXDC002
          CALL      IBACLOCK
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
.         RJUSTIFY  VSDATVAL
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,UPDVDT91
.
          BRANCH    VSDATIND,UPDVDT21,UPDVDT22,UPDVDT23,UPDVDT24,UPDVDT25:
                             UPDVDT26,UPDVDT27,UPDVDT28,UPDVDT29,UPDVDT30
          GOTO      UPDVDT90
.
UPDVDT21  MOVE      VSDATVAL,VSXDDAT1
          GOTO      UPDVDT90
.
UPDVDT22  MOVE      VSDATVAL,VSXDDAT2
          GOTO      UPDVDT90
.
UPDVDT23  MOVE      VSDATVAL,VSXDDAT3
          GOTO      UPDVDT90
.
UPDVDT24  MOVE      VSDATVAL,VSXDDAT4
          GOTO      UPDVDT90
.
UPDVDT25  MOVE      VSDATVAL,VSXDDAT5
          GOTO      UPDVDT90
.
UPDVDT26  MOVE      VSDATVAL,VSXDDAT6
          GOTO      UPDVDT90
.
UPDVDT27  MOVE      VSDATVAL,VSXDDAT7
          GOTO      UPDVDT90
.
UPDVDT28  MOVE      VSDATVAL,VSXDDAT8
          GOTO      UPDVDT90
.
UPDVDT29  MOVE      VSDATVAL,VSXDDAT9
          GOTO      UPDVDT90
.
UPDVDT30  MOVE      VSDATVAL,VSXDDA10
          GOTO      UPDVDT90
.
UPDVDT90  MOVE      USERID,VSXDUUSR
          PACK      VSXDUDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDUDAT
          MOVE      CTIMEIS,VSXDUTIM
          CALL      UPVSXDC1
          MOVE      ZERO,EXIT
          GOTO      UPDVDT99
.
UPDVDT91  CALL      CLVISXDC
          MOVE      VSXDC001,VSXDVISN
          MOVE      VSXDC002,VSXDTYDA
          STORE     VSDATVAL,VSDATIND,VSXDDAT1,VSXDDAT2,VSXDDAT3,VSXDDAT4:
                                      VSXDDAT5,VSXDDAT6,VSXDDAT7,VSXDDAT8:
                                      VSXDDAT9,VSXDDA10
          PACK      VSXDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDCDAT
          MOVE      CTIMEIS,VSXDCTIM
          MOVE      USERID,VSXDCUSR
.
          PACK      KEY11,VSXDVISN,VSXDTYDA,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRVSXDC1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDVDT99
.
UPDVDT99  RETURN
+
.------------------------------------------------------------
.         Get the Time Field (1-10) value for the specified
.         Type of Data (1).
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSTIMIND  Time Field index (1-10)
.
.         Return:
.           VSTIMVAL  Time Field Value (DIM8)
.------------------------------------------------------------
GETVTM00  MOVE      SP70,VSTIMVAL
          MOVE      SP70,VSXDC002
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,GETVTM91
.
          BRANCH    VSTIMIND,GETVTM21,GETVTM22,GETVTM23,GETVTM24,GETVTM25:
                             GETVTM26,GETVTM27,GETVTM28,GETVTM29,GETVTM30
          GOTO      GETVTM91
.
GETVTM21  MOVE      VSXDTIM1,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM22  MOVE      VSXDTIM2,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM23  MOVE      VSXDTIM3,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM24  MOVE      VSXDTIM4,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM25  MOVE      VSXDTIM5,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM26  MOVE      VSXDTIM6,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM27  MOVE      VSXDTIM7,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM28  MOVE      VSXDTIM8,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM29  MOVE      VSXDTIM9,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM30  MOVE      VSXDTI10,VSTIMVAL
          GOTO      GETVTM90
.
GETVTM90  MOVE      ZERO,EXIT
          GOTO      GETVTM99
.
GETVTM91  MOVE      ONE,EXIT
GETVTM99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Time Field (1-10) value for the specified
.         Type of Data (1);
.         If a record does not exist for the specified type of data, a new
.         record will be written to file.
.
.         Parameters:
.           VSXDC001  Visit Number
.           VSXDC002  Type of Data
.           VSTYPIND  Type of Data index (1)
.           VSTIMIND  Time Field index (1-10)
.           VSTIMVAL  Time Field value (DIM8)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDVTM00  MOVE      SP70,VSXDC002
          CALL      IBACLOCK
.
          LOAD      VSXDC002,VSTYPIND,VSTYP001,VSTYP002,VSTYP003
.
.         RJUSTIFY  VSTIMVAL
.
          PACK      KEY11,VSXDC001,VSXDC002,SP70
          CALL      RDVSXDC1
          BRANCH    OVRCD,UPDVTM91
.
          BRANCH    VSTIMIND,UPDVTM21,UPDVTM22,UPDVTM23,UPDVTM24,UPDVTM25:
                             UPDVTM26,UPDVTM27,UPDVTM28,UPDVTM29,UPDVTM30
          GOTO      UPDVTM90
.
UPDVTM21  MOVE      VSTIMVAL,VSXDTIM1
          GOTO      UPDVTM90
.
UPDVTM22  MOVE      VSTIMVAL,VSXDTIM2
          GOTO      UPDVTM90
.
UPDVTM23  MOVE      VSTIMVAL,VSXDTIM3
          GOTO      UPDVTM90
.
UPDVTM24  MOVE      VSTIMVAL,VSXDTIM4
          GOTO      UPDVTM90
.
UPDVTM25  MOVE      VSTIMVAL,VSXDTIM5
          GOTO      UPDVTM90
.
UPDVTM26  MOVE      VSTIMVAL,VSXDTIM6
          GOTO      UPDVTM90
.
UPDVTM27  MOVE      VSTIMVAL,VSXDTIM7
          GOTO      UPDVTM90
.
UPDVTM28  MOVE      VSTIMVAL,VSXDTIM8
          GOTO      UPDVTM90
.
UPDVTM29  MOVE      VSTIMVAL,VSXDTIM9
          GOTO      UPDVTM90
.
UPDVTM30  MOVE      VSTIMVAL,VSXDTI10
          GOTO      UPDVTM90
.
UPDVTM90  MOVE      USERID,VSXDUUSR
          PACK      VSXDUDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDUDAT
          MOVE      CTIMEIS,VSXDUTIM
          CALL      UPVSXDC1
          MOVE      ZERO,EXIT
          GOTO      UPDVTM99
.
UPDVTM91  CALL      CLVISXDC
          MOVE      VSXDC001,VSXDVISN
          MOVE      VSXDC002,VSXDTYDA
          STORE     VSTIMVAL,VSTIMIND,VSXDTIM1,VSXDTIM2,VSXDTIM3,VSXDTIM4:
                                      VSXDTIM5,VSXDTIM6,VSXDTIM7,VSXDTIM8:
                                      VSXDTIM9,VSXDTI10
          PACK      VSXDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",VSXDCDAT
          MOVE      CTIMEIS,VSXDCTIM
          MOVE      USERID,VSXDCUSR
.
          PACK      KEY11,VSXDVISN,VSXDTYDA,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRVSXDC1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDVTM99
.
UPDVTM99  RETURN
+
