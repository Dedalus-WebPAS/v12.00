+
.  Modifications : 
.                  V5.07.00 Moved sectors for the extractions to secto 93,94,95
.****************************************************************************
.                         V5.01  27/02/91  DIG
.                         Changed EDATE,EFDATE, and ETDATE to use century.
.                         Altered screen display for the above change, and
.                         changed keyin the to underlines.
.
.            EXTRACTION MENU  and ETABPOS
.
GEXTN   DISPLAY    *P1:3,*EF,*P1:4,*V2LON,*ULON:
                   "Extract File ##",*P20:4,"  Created ":
                   *P40:4,"     Period Covered     "
.
	MOVE       ONE,OPTION
.
NEXTET  
	COMPARE    "17",OPTION
	GOTO       EFIELD IF EQUAL
.
	CALL       ETABPOS
        READ       CONTROLF,SEC;*ETABPS,EDATE,EFDATE,ETDATE
.
	MOVE       FIVE,VERT
	ADD        OPTION,VERT
.
        MATCH      SP8,EDATE
	GOTO       DSPNOG IF EQUAL
.
        UNPACK     EDATE,CCENT,CYEAR,CMON,CDAY
.
        CALL       PACDATE                  * pack the date
.
        MOVE       CPCDATE,EXCDATE
.
        UNPACK     EFDATE,CCENT,CYEAR,CMON,CDAY
.
        CALL       PACDATE                  * pack the date
.
        MOVE       CPCDATE,EXFDATE
.
        UNPACK     ETDATE,CCENT,CYEAR,CMON,CDAY
.
        CALL       PACDATE                  * pack the date
.
        MOVE       CPCDATE,EXTDATE
.
	DISPLAY    *P13:VERT,OPTION,*P20:VERT,EXCDATE:
                   *P40:VERT,EXFDATE," to ",EXTDATE;
        ADD        ONE,OPTION
	GOTO       NEXTET
.
DSPNOG
	DISPLAY    *P13:VERT,OPTION
        ADD        ONE,OPTION
	GOTO       NEXTET
.
EFIELD  DISPLAY    *P1:24,*EL,"Select Extraction File : ",UNDLN2;
        KEYIN      *P26:24,*V2LON,OPTION; 
.
	COMPARE    ZERO,OPTION
	GOTO       ENDGEXT IF EQUAL
	GOTO       INVEFLD IF LESS
.
	COMPARE    "17",OPTION
	GOTO       INVEFLD IF NOT LESS
        GOTO       ENDGEXT
.
INVEFLD DISPLAY    *P40:24,*B,*EL,*V2LON:
                   "*** Invalid FILE ## ***",*W2;
        GOTO       EFIELD
.
+
.
.       CALCULATE SEC AND TAB POS FOR DATES
.
ETABPOS MOVE       OPTION,ETABPS
	MOVE       TEN1,SEC       ***** SECTOR 11 & 12
	COMPARE    "9",ETABPS
	GOTO       ETABOK IF LESS
	SUB        "8",ETABPS
        ADD        ONE,SEC
.
ETABOK  MULT       "30",ETABPS
	SUB        "29",ETABPS
.
ENDGEXT RETURN
+
.
.           CALCULATE SEC AND TAB POS FOR TOTAL VALUES
.
ETOTPOS MOVE       OPTION,ETABPS
	MOVE       "93",SEC       ***** SECTOR 93,94,95
	COMPARE    "8",ETABPS
	GOTO       ETOTP20 IF LESS
.
        COMPARE    "15",ETABPS
        GOTO       ETOTP10 IF LESS
        SUB        "7",ETABPS
        ADD        ONE,SEC
.
ETOTP10 SUB        "7",ETABPS
        ADD        ONE,SEC
.
ETOTP20 MULT       "34",ETABPS
	SUB        "33",ETABPS
        RETURN
