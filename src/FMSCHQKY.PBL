KCHQFM00  MOVE      ZERO,CKEYTYP
          CALL      KFMCHA00
          RETURN
ACHQFM00  MOVE      ONE,CKEYTYP
          CALL      KFMCHA00
          RETURN

.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSCHQKY
.   Routine   :   HFMCHA00 Cheque Account      
.   Return    :           
.-------------------------------------------------------------------------------
HFMCHA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "14",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMCHA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMCHA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Cheque Account"     
.
          MOVE      STDCOL01,STDCOL02
          ADD       "16",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "40",STDCOL03
HFMCHA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMCHCHQ 
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          CALL      RSFMCH1 
HFMCHA10
          CALL      RKFMCH1 
          BRANCH    OVRCD,HFMCHA15
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HFMCHA12
          CALL      HFMCHA60
          BRANCH    OVRCD,HFMCHA10
HFMCHA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMCHCHQ 
          DISPLAY   *PSTDCOL02:STDROW,FMCHDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMCHA10 IF NOT EQUAL
HFMCHA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMCHA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMCHA30,HFMCHA35,HFMCHA40,HFMCHA45,HFMCHA04:
                              HFMCHA91,HFMCHA50
          GOTO      HFMCHA92
HFMCHA30
          CALL      RKFMCH1 
          BRANCH    OVRCD,HFMCHA85
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          CALL      RPFMCH1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMCHA10
HFMCHA35
          MOVE      ST1,KEY15
          CALL      RDFMCH1 
          CALL      RPFMCH1 
          BRANCH    OVRCD,HFMCHA85
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMCHA36
          CALL      RPFMCH1 
          BRANCH    OVRCD,HFMCHA37
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMCHA36 IF NOT EQUAL
HFMCHA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMCHA10
HFMCHA40
          MOVE      ST1,KEY15
          CALL      RDFMCH1 
          CALL      RPFMCH1 
          BRANCH    OVRCD,HFMCHA85
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMCHA08
HFMCHA45
          CALL      RKFMCH1 
          BRANCH    OVRCD,HFMCHA85
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY15,Z70                                                   
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMCH1 
HFMCHA46
          CALL      RPFMCH1 
          BRANCH    OVRCD,HFMCHA47
          PACK      KEY15,FMCHCHQ,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMCHA46 IF NOT EQUAL
HFMCHA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMCHA10
HFMCHA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMCHA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMCHA08
HFMCHA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMCHA08
HFMCHA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMCHA61 IF EQUAL
          MATCH     SCHFLD01,FMCHCHQ 
          GOTO      HFMCHA72 IF NOT EQUAL
HFMCHA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMCHA62 IF EQUAL
          MATCH     SCHFLD02,FMCHDES 
          GOTO      HFMCHA72 IF NOT EQUAL
HFMCHA62
HFMCHA63
HFMCHA64
HFMCHA65
HFMCHA66
HFMCHA67
HFMCHA68
HFMCHA69
HFMCHA70
          GOTO      HFMCHA75
HFMCHA72  MOVE      ONE,OVRCD
HFMCHA75  RETURN
HFMCHA85
          LOAD      KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY15,FMCHCHQ                                               
          CALL      RDFMCH1 
HFMCHA90
.                                                                               
          BEEP
          GOTO      HFMCHA20
HFMCHA91
          MOVE      SP70,FMCHDES 
          MOVE      ZERO,FMCHBAL 
          MOVE      SP70,FMCHBDT 
          MOVE      ZERO,FMCHFMT 
          MOVE      SP70,FMCHBSB 
          MOVE      SP70,FMCHSPA 
          MOVE      SP70,KEY15
          MOVE      SP70,FMCHCHQ 
          GOTO      HFMCHA96
HFMCHA92
          MOVE      SP70,KEY15
          MOVE      SP70,FMCHCHQ 
          LOAD      KEY15,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY15,FMCHCHQ                                               
HFMCHA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMCHA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSCHQKY
.   Routine   :   KFMCHA00 Keyin Cheque Account      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMCHA00 TOPIC     "FMCHCHQ "
          MOVE      UNDLN70,FMCHCHQ 
          KEYIN     *PCCOL:CVERT,*DV,FMCHCHQ:                                   
                    *PCCOL:CVERT,*V2LON,FMCHCHQ:                                
                    *PCCOL:CVERT,*DV,FMCHCHQ 
.
          ENDSET    FMCHCHQ 
          APPEND    SP70,FMCHCHQ 
          RESET     FMCHCHQ 
.
          MATCH     SP70,FMCHCHQ 
          GOTO      KFMCHA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMCHCHQ 
          GOTO      KFMCHA95 IF EQUAL
.
          CMATCH    QUEST,FMCHCHQ 
          GOTO      KFMCHA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMCHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMCHCHQ 
          APPEND    SP70,FMCHCHQ 
          RESET     FMCHCHQ 
.
          MATCH     SP70,FMCHCHQ 
          GOTO      KFMCHA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMCHCHQ                                 
KFMCHA10
          PACK      KEY15,FMCHCHQ                                               
          CALL      RAFMCH1 
          BRANCH    OVRCD,KFMCHA80
          BRANCH    CKEYTYP,KFMCHA75
          CALL      RDFMCH1 
KFMCHA70
          MOVE      ZERO,EXIT
          GOTO      KFMCHA99
KFMCHA75
          MOVE      "Cheque Account Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KFMCHA00
KFMCHA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMCHA99,KFMCHA99
          MOVE      "Cheque Account Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KFMCHA00
KFMCHA90
          MOVE      ONE,EXIT
          GOTO      KFMCHA99
KFMCHA95
          MOVE      TWO,EXIT
KFMCHA99 TOPIC    PRGID
          RETURN
