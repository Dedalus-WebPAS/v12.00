.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.03.02  15/07/2004  Mike Laming  CAR 51712
.           Change SUPCATYN Y=0 to Yes=1 to correct NREC0000 selects
. V9.03.01  03.06.2003 Mike Laming CAR 38586
.           Added Suppress Suspended Catalogs by Warehouse
. V9.02.00  03.05.2002 Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B02 15.01.2001 Charles Handaya
.           Printed GST Code on report for Australian GST parameter
. VF.09.B01 23.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.02  03.10.2000 Charles Handaya
.           Make sure to put pointer back to the same spot after Read Next
.           srf 6385
. VF.01.01  28.07.2000 Charles Handaya
.           Fix Catalog Descripiton keyin range Search
.           Fix Non-stock item doesn't require to keyin Range of Warehouse
.           srf 4557
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.02  01.12.1999 Charles Handaya
.           Added Rack & Shelf Sequence, and Warehouse Range
.           srf 636079
. VF.00.01  20.08.1999 Sandra Barcham
.           Print one more supplier
.           srf 634045
.-------------------------------------------------------
EXPORTFL  FILE      ASCII, FIXED=400
FORM6P6   FORM      6.6
TABDELM   EQU       0x09
.
PREFNAME  DIM       30
PREFSUT   DIM       15
PREFPNO   DIM       30
PREFPD1   DIM       60
PREFCCT   FORM      12.4
PREFLCT   FORM      10.4
PREFLTM   FORM      6
PRNGST    FORM      1
.
PTRPDES2  FORM      2
.
SVKEY12   DIM       12
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN80
.   Function      :   Catalog Master Listing                  
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       IBACONFD/INC
          INC       SINCGAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIBFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCIEFD/INC
          INC       SINCIFFD/INC
          INC       SINCIGFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINNATFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
DESCCATA  DIM      40 * Scr 00 Fld    26
SVCATALG  DIM       7 * Scr 00 Fld    27
CHKSTOCK  FORM      1 * Scr 00 Fld    28
PRN1WARE  FORM      1 * Scr 00 Fld    29
FROMLAB   DIM       7 * Scr 01 Fld     4
TOLAB     DIM       7 * Scr 01 Fld     5
EXPORTYN  FORM      1 * Scr 01 Fld    10
STRWARE   DIM       6 * Scr 01 Fld    11
ENDWARE   DIM       6 * Scr 01 Fld    12
FROMWARE  DIM      40 * Scr 01 Fld    13
TOWARE    DIM      40 * Scr 01 Fld    14
FRWARECD  DIM       5 * Scr 01 Fld    15
TOWARECD  DIM       5 * Scr 01 Fld    16
SUPCATYN  FORM      1 * Scr 01 Fld    17
STRRACK   DIM       8 * Scr 04 Fld     4
ENDRACK   DIM       8 * Scr 04 Fld     5
FROMRACK  DIM       8 * Scr 04 Fld     6
TORACK    DIM       8 * Scr 04 Fld     7
WAREHOUS  DIM       5 * Scr 04 Fld    17
WAREDESC  DIM      40 * Scr 04 Fld    18
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN80"
PRGNAM    INIT      "Catalog Master Listing                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      OPEN0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          MOVE      "   24",AUDTSECT
          MOVE      "201",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudga";
            OPEN      SINAUDGA,"sinaudga"
          ENDIF
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA2,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincibaf";
          OPEN      SINCIBA1,"sincibaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA3,"sincieaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincigaf";
          OPEN      SINCIGA1,"sincigaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Menu                          
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Print By Product Group             
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Print By Code                      
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Print By Description               
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Print by Rack & Shelf              
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Menu                          
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      D00SC000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Menu                          
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Menu                          
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KREPT000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      DETAILED,VAR     
          CALL      DISPITEM
.
KY00L120
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KRANG000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      RANGETYP,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Menu                          
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Menu                          
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Menu                          
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Menu                          
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L110,PS00L111,PS00L112:
                            PS00L113
          GOTO     PS00L999
.
PS00L101
          MOVE      SEL1,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SEL2,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SEL3,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SEL4,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SEL5,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      SEL6,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SEL7,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SEL8,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      SEL9,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      DESCCATA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      SVCATALG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      CHKSTOCK,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      PRN1WARE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Menu                          
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L101,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L110:
                            SF00L006,SF00L006,SF00L006,SF00L111:
                            SF00L112,SF00L006,SF00L006,SF00L006:
                            SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G01RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G02RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G03RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G04RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G05RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G06RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G07RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G08RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      G09RA000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L110
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GRANG000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L112
          CALL      RINCOCAT
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Print By Product Group             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETSCR00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print By Product Group             
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print By Product Group             
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print By Product Group             
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print By Product Group             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print By Product Group             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print By Product Group             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104,PS01L105:
                            PS01L106,PS01L107,PS01L108,PS01L109:
                            PS01L110,PS01L111,PS01L112,PS01L113:
                            PS01L114
          GOTO     PS01L999
.
PS01L101
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      DESC1,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DESC2,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SEL,VAR          
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      ENDWARE,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      FROMWARE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      TOWARE,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      FRWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      TOWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Print By Product Group             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L104,SF01L105,SF01L106,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L107
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L104,SF01L105,SF01L106,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L107
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLAB   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC2   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RPRG0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLAB,VAR        
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC1,VAR        
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC2,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSPAC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,EXPORTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ENDWARE 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMWARE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWARE  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ENDWARE,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMWARE,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWARE,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L107
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SUPCATYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Print By Code                      
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      SETSCR00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print By Code                      
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print By Code                      
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print By Code                      
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print By Code                      
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print By Code                      
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print By Code                      
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104,PS02L105:
                            PS02L106,PS02L107,PS02L108,PS02L109:
                            PS02L110,PS02L111,PS02L112,PS02L113:
                            PS02L114
          GOTO     PS02L999
.
PS02L101
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      DESC1,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      DESC2,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      SEL,VAR          
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      ENDWARE,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      FROMWARE,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      TOWARE,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      FRWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      TOWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          CALL      DEFAULTY
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Print By Code                      
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L104,SF02L105,SF02L106,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L107
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L104,SF02L105,SF02L106,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L107
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLAB   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC2   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCAC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLAB,VAR        
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC1,VAR        
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC2,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSPAC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,EXPORTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ENDWARE 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMWARE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWARE  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
            BRANCH    EXIT,SF02L106,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ENDWARE,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMWARE,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWARE,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L107
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SUPCATYN
          CALL      DEFAULTY
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Print By Description               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      SETSCR00
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print By Description               
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print By Description               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print By Description               
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print By Description               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print By Description               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print By Description               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L103,PS03L104,PS03L105:
                            PS03L999,PS03L999,PS03L106,PS03L107:
                            PS03L108,PS03L109,PS03L110,PS03L111:
                            PS03L112
          GOTO     PS03L999
.
PS03L101
          MOVE      DESC1,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      DESC2,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      SEL,VAR          
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      ENDWARE,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      FROMWARE,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      TOWARE,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      FRWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      TOWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Print By Description               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L006,SF03L104,SF03L105:
                            SF03L006,SF03L006,SF03L106,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L107
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L020,SF03L020,SF03L104,SF03L105:
                            SF03L020,SF03L020,SF03L106,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L107
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC2   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      RCAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      DESC1,VAR        
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC2,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSPAC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,EXPORTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ENDWARE 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMWARE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWARE  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L106
            ENDIF
            BRANCH    EXIT,SF03L106,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ENDWARE,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMWARE,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWARE,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L107
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SUPCATYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Print by Rack & Shelf              
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      SETSCR00
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print by Rack & Shelf              
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print by Rack & Shelf              
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print by Rack & Shelf              
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print by Rack & Shelf              
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print by Rack & Shelf              
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print by Rack & Shelf              
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L103,PS04L104,PS04L105:
                            PS04L106,PS04L107,PS04L108,PS04L109:
                            PS04L110,PS04L111,PS04L112,PS04L113:
                            PS04L114,PS04L115,PS04L116
          GOTO     PS04L999
.
PS04L101
          MOVE      STRRACK,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      ENDRACK,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      FROMRACK,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      TORACK,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      SEL,VAR          
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      ENDWARE,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      FROMWARE,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      TOWARE,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      FRWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      TOWARECD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      WAREHOUS,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      WAREDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Print by Rack & Shelf              
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L104,SF04L105,SF04L106,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L107,SF04L006,SF04L108
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L104,SF04L105,SF04L106,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L107,SF04L020,SF04L108
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ENDRACK 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RRAC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      STRRACK,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ENDRACK,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSPAC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      SPACING,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,EXPORTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ENDWARE 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMWARE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWARE  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L106
            ENDIF
            BRANCH    EXIT,SF04L106,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      STRWARE,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ENDWARE,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMWARE,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWARE,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L107
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,WAREDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L107
            ENDIF
            BRANCH    EXIT,SF04L107,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      WAREHOUS,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      WAREDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L108
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SUPCATYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SUPCATYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read in Data
.----------------------------------------------------------------------
OPEN0000
          CALL      RINCOCAT           * read in parameters
.
.      SETUP CATALOG TITLE
.
          MOVE      "All Stock & Non-Stock Items       ",SEL1
          MOVE      "All Stock Items                   ",SEL2
          MOVE      "All Non-Stock Items               ",SEL3
          MOVE      "No Catalog Title in Codes File",SEL4
          MOVE      SEL4,SEL5
          MOVE      SEL4,SEL6
          MOVE      SEL4,SEL7
          MOVE      SEL4,SEL8
          MOVE      SEL4,SEL9
          MOVE      ONE,F1
.
OPEN1000  PACK      KEY6,TITLE,F1,SP70
          CALL      RDSICD1
          BRANCH    OVRCD,OPEN2000
.
          STORE     SICDDESC,F1,SEL4,SEL5,SEL6,SEL7,SEL8,SEL9
.
OPEN2000  COMPARE   SIX,F1
          GOTO      OPEN9999 IF NOT LESS
.
          ADD       ONE,F1
          GOTO      OPEN1000
.
OPEN9999  CALL      ONAT0000
.
          READ      CONTROLF,ZERO;*85,IBCNUGST
.
          RETURN
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
          MOVE      "63",AUDTSECT
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,AUDTSECT;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,AUDTSECT;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.----------------------------------------------------------------------
. Display screen 00
.----------------------------------------------------------------------
D00SC000
          MOVE      ZERO,ACCEPT
          UNPACK    SP70,YESNO,SPACING,DETAILED
          CALL      DF00L000
          MOVE      ONE,ACCEPT
.
D00SC999  RETURN
.----------------------------------------------------------------------
. Get range and print report 01
.----------------------------------------------------------------------
G01RA000
          MOVE      "1",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 02
.----------------------------------------------------------------------
G02RA000
          MOVE      "2",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 03
.----------------------------------------------------------------------
G03RA000
          MOVE      "3",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 04
.----------------------------------------------------------------------
G04RA000
          MOVE      "4",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 05
.----------------------------------------------------------------------
G05RA000
          MOVE      "5",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 06
.----------------------------------------------------------------------
G06RA000
          MOVE      "6",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 07
.----------------------------------------------------------------------
G07RA000
          MOVE      "7",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 08
.----------------------------------------------------------------------
G08RA000
          MOVE      "8",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Get range and print report 09
.----------------------------------------------------------------------
G09RA000
          MOVE      "9",OPTIONA
          CALL      GRANG000
          RETURN
.
.----------------------------------------------------------------------
. Keyin Report Type
.----------------------------------------------------------------------
KREPT000
          MOVE      "G",DETAILED
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,DETAILED;
          REP       UPPLOW,DETAILED
          PACK      ANS,DETAILED,SP70
          MATCH     EXITCHAR,ANS
          GOTO      KREPT950 IF EQUAL
.
          REP       "1x2x3xC1G2A3",ANS
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,KREPT900,KREPT900,KREPT900
          BEEP
          GOTO      KREPT000
.
KREPT900
          MOVE     ZERO,EXIT
          GOTO     KREPT999
.
KREPT950  MOVE     TWO,EXIT
.
KREPT999  RETURN
.----------------------------------------------------------------------
. Keyin Range Type
.----------------------------------------------------------------------
KRANG000
          MOVE      "C",RANGETYP
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,RANGETYP;
          REP       UPPLOW,RANGETYP
          PACK      ANS,RANGETYP,SP70
          MATCH     SP70,ANS
          GOTO      KRANG950 IF EQUAL
          MATCH     EXITCHAR,ANS
          GOTO      KRANG950 IF EQUAL
.
KRANG100  REP       "1xC1D1P1R1",ANS
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,KRANG900
          BEEP
          GOTO      KRANG000
.
KRANG900  MOVE     ZERO,EXIT
          GOTO     KRANG999
.
KRANG950  MOVE     TWO,EXIT
.
KRANG999  RETURN
.----------------------------------------------------------------------
. Get range and print report
.----------------------------------------------------------------------
GRANG000
          LOAD      SEL,OPTIONA,SEL1,SEL2,SEL3,SEL4,SEL5,SEL6,SEL7,SEL8,SEL9
          MATCH     "P",RANGETYP
          IF        @EQUAL
            UNPACK    SP70,FROMLAB,TOLAB,DESC1,DESC2,SPACING
            UNPACK    SP70,FROMWARE,TOWARE,STRWARE,ENDWARE
            CALL      SC01X000
          ENDIF
          MATCH     "C",RANGETYP
          IF        @EQUAL
            UNPACK    SP70,FROMLAB,TOLAB,DESC1,DESC2,SPACING
            UNPACK    SP70,FROMWARE,TOWARE,STRWARE,ENDWARE
            CALL      SC02X000
          ENDIF
          MATCH     "D",RANGETYP
          IF        @EQUAL
            UNPACK    SP70,FROMLAB,TOLAB,DESC1,DESC2,SPACING
            UNPACK    SP70,FROMWARE,TOWARE,STRWARE,ENDWARE
            CALL      SC03X000
          ENDIF
          MATCH     "R",RANGETYP
          IF        @EQUAL
            UNPACK    SP70,FROMLAB,TOLAB,DESC1,DESC2,SPACING
            UNPACK    SP70,WAREHOUS,WAREDESC
..            UNPACK    SP70,FROMWARE,TOWARE,STRWARE,ENDWARE
            CALL      SC04X000
          ENDIF
          MOVE      "00",SCRID
.
GRANG999  RETURN
.--------------------------------
. Screen - Print By Code
.--------------------------------
SC01X000
SC01X100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01X200
          CALL      CF01L000 * Clear Fields
          CALL      SETSCR00
SC01X300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01X999,SC01X999
SC01X400
          CALL      WP01L000 * Load any WP Details
SC01X500
          CALL      LM01L000 * Load any Batch Details
SC01X600
          MOVE      ZERO,ACCEPT
          CALL      DF01L000 * Display Fields
          MOVE      ONE,ACCEPT
SC01X700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01X100,SC01X100,SC01X200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01X800
SC01X900
SC01X999  RETURN
.--------------------------------
. Screen - Print By Code
.--------------------------------
SC02X000
SC02X100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02X200
          CALL      CF02L000 * Clear Fields
          CALL      SETSCR00
SC02X300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02X999,SC02X999
SC02X400
          CALL      WP02L000 * Load any WP Details
SC02X500
          CALL      LM02L000 * Load any Batch Details
SC02X600
          MOVE      ZERO,ACCEPT
          CALL      DF02L000 * Display Fields
          MOVE      ONE,ACCEPT
SC02X700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02X100,SC02X100,SC02X200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02X800
SC02X900
SC02X999  RETURN
.--------------------------------
. Screen - Print By Desc
.--------------------------------
SC03X000
SC03X100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03X200
          CALL      CF03L000 * Clear Fields
          CALL      SETSCR00
SC03X300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03X999,SC03X999
SC03X400
          CALL      WP03L000 * Load any WP Details
SC03X500
          CALL      LM03L000 * Load any Batch Details
SC03X600
          MOVE      ZERO,ACCEPT
          CALL      DF03L000 * Display Fields
          MOVE      ONE,ACCEPT
SC03X700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03X100,SC03X100,SC03X200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03X800
SC03X900
SC03X999  RETURN
.--------------------------------
. Screen - Print By Rack & Shelf
.--------------------------------
SC04X000
SC04X100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04X200
          CALL      CF04L000 * Clear Fields
          CALL      SETSCR00
SC04X300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04X999,SC04X999
SC04X400
          CALL      WP04L000 * Load any WP Details
SC04X500
          CALL      LM04L000 * Load any Batch Details
SC04X600
          MOVE      ZERO,ACCEPT
          CALL      DF04L000 * Display Fields
          MOVE      ONE,ACCEPT
SC04X700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04X100,SC04X100,SC04X200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04X800
SC04X900
SC04X999  RETURN
.
. ------------------------------------------------------------
. Read Catalog Code Keyin Control Information
.
. INCOCATE  FORM      1         67      Catalog Code Type
. 0 Normal Keyin,   1 *JR *DE,   2 Generated ,  3 Generated with Check Digit
.------------------------------------------------------------
RINCOCAT  MOVE      "63",SECTOR
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SECTOR;*67,INCOCATE
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCOCATE
            WRITAB    CONTROLF,SECTOR;*67,INCOCATE
          ENDIF
.
          RETURN
.********************************************************************
. SETSCR00 - set up for screens
.********************************************************************
SETSCR00  MOVE      "1",ACCEPT
.
          PACK      STRWARE,SP70
          PACK      ENDWARE,SP70
.
SETSCR99  RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.********************************************************************
. PRNT - print report                               Called by ML
.         Requires : FROMLAB,TOLAB   (print range display labels)
.                    FROMCOD7,TOCOD7 (print range)
.********************************************************************
PRNT0000  IF        EXPORTYN=1
            CALL      MAKEXP00
          ENDIF
          LOAD      SEL,OPTIONA,SEL1,SEL2,SEL3,SEL4,SEL5,SEL6,SEL7,SEL8,SEL9
          STRIP     SEL
          MOVE      OPTIONA,CATFLAG
          SUB       "3",CATFLAG
.
          MOVE      "1",OPTIONR        * set up range type
          MATCH     "D",RANGETYP
          IF        @EQUAL
            MOVE      "2",OPTIONR
            STRIP     PDESC1
            STRIP     PDESC2
            MOVELPTR  PDESC2,PTRPDES2
          ENDIF
          MATCH     "P",RANGETYP
          IF        @EQUAL
            MOVE      "3",OPTIONR
          ENDIF
          MATCH     "R",RANGETYP
          IF        @EQUAL
            MOVE      "4",OPTIONR
          ENDIF
.
..          IF        2=OPTIONR
..            MATCH     PDESC1,PDESC2           * check if range ok
..            IF        @LESS
..              CLEAR     DISPMSG
..              APPEND    "Illegal Range Entered - ",DISPMSG
..              CALL      MESSAGE1
..              GOTO      PRNT9500
..            ENDIF
..          ELSE
..            MATCH     FROMCOD7,TOCOD7         * check if range ok
..            IF        @LESS
..              CLEAR     DISPMSG
..              APPEND    "Illegal Range Entered - ",DISPMSG
..              CALL      MESSAGE1
..              GOTO      PRNT9500
..            ENDIF
..          ENDIF
.
          DISPLAY   *P50:24,"Printing :   ";
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "999",CLNO                   * init last line number
          MOVE      SP70,LASTCOD7                * clear last item
.
          CALL      FILE0000                    * go to correct position in file
.
PRNT1000  CALL      NREC0000                     * get next record
          BRANCH    OVRCD,PRNT9000               * end of file ?
          PACK      SVCATALG,SP70                * initialise save variable
.
PRNT1100  IF        OPTIONR=1
            CALL      GWAR0000
            BRANCH    OVRCD,PRNT1000
.
            DISPLAY   *P61:24,*V2LON,SIIACAT,SLASH,SIIEWAR,*EL;
          ENDIF
          IF        OPTIONR=2
            CALL      GWAR0000
            BRANCH    OVRCD,PRNT1000
.
            DISPLAY   *P61:24,*V2LON,SIIADES,SLASH,SIIEWAR,*EL;
          ENDIF
          IF        OPTIONR=3
            CALL      GWAR0000
            BRANCH    OVRCD,PRNT1000
.
            DISPLAY   *P61:24,*V2LON,SIIASUB,SLASH,SIIEWAR,*EL;
          ENDIF
.
          IF        OPTIONR=4
            PACK      KEY7,SIIECAT,SP70
            CALL      RDSIIA1
            BRANCH    OVRCD,PRNT1000
            DISPLAY   *P61:24,*V2LON,SIIACAT,SLASH,SIIEWAR,*EL;
            CALL      WRIT0000                     * print Rack & Shelf details
            GOTO      PRNT1000
          ENDIF
.
          CALL      WRIT0000                     * print details
          BRANCH    SIIANON,PRNT1000             * get next record
          BRANCH    OPTIONA,PRNT1100,PRNT1100    * get next record
          GOTO      PRNT1000                     * get next record
.
PRNT9000  COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL          * print header if nothing printed
          MATCH     "A",DETAILED
          IF        @EQUAL
            CALL      UND80                      * print line
          ELSE
            CALL      UND132                     * print line
            MATCH     "G",DETAILED
            IF        @EQUAL
              PRINT     "Note : '*' = Stock Item"
            ENDIF
          ENDIF
          PRINT     "****   End of Report   ****"
          IF        EXPORTYN=1
            CALL      TRAN0000
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      PRNT9999
.
PRNT9500  MOVE      ONE,EXIT
.
PRNT9999  RETURN
.**********************************************************************
.  FILE - Set file pointer                             Called By PRNT
.**********************************************************************
FILE0000  BRANCH    OPTIONR,FILE0100,FILE0200,FILE0300,FILE0400
.
.---- print by type 1 ----
.
FILE0100  PACK      KEY7,FROMCOD7,SP70
          CALL      RSSIIA1
          CALL      RPSIIA1
          GOTO      FILE9999
.
.---- print by type 2 ----
.
FILE0200  PACK      KEY67,PDESC1,SP70
          CALL      RSSIIA3
          CALL      RPSIIA3
          GOTO      FILE9999
.
.---- print by type 3 ----
.
FILE0300  PACK      KEY12,FROMCOD7,SP70
          CALL      RSSIIA2
          CALL      RPSIIA2
          GOTO      FILE9999
.
.---- print by type 4 ----
.
FILE0400  PACK      KEY15,FROMRACK,SP70
          CALL      RSSIIE3
          CALL      RPSIIE3
.
FILE9999  RETURN
.**********************************************************************
.  NREC - Get next record                              Called By PRNT
.**********************************************************************
NREC0000  BRANCH    OPTIONR,NREC0100,NREC0200,NREC0300,NREC0400
.
.---- print by type 1 ----
.
NREC0100  CALL      RKSIIA1
          BRANCH    OVRCD,NREC9500
.
          MATCH     SIIACAT,TOCOD7
          GOTO      NREC9500 IF LESS             * out of range ?
.         srf 18093 - begin If sup catlg is yes then if susp for reqn & PO
.                                     * SUPCATYN was 0=yes - now 1=yes *C-51712
          IF        SUPCATYN=1
            IF        SIIASUS=3
              GOTO      NREC0100            * Don't print the record
            ENDIF
          ENDIF
.                                           * srf 18093 - end
          CALL      CKDAT000                     * check if valid record
          BRANCH    EXIT,NREC0000
          GOTO      NREC9000
.
.---- print by type 2 ----
.
NREC0200  CALL      RKSIIA3
          BRANCH    OVRCD,NREC9500
.
          MATCH     Z70,PDESC2
          GOTO      NREC0250 IF EQUAL
.
          MOVELPTR  SIIADES,F2
          SETLPTR   SIIADES,PTRPDES2
          MATCH     SIIADES,PDESC2
          GOTO      NREC9500 IF LESS             * out of range ?
.
          RESET     SIIADES,F2
          RESET     SIIADES
.         srf 18093 - begin If sup catlg is yes then if susp for reqn & PO
.                                     * SUPCATYN was 0=yes - now 1=yes *C-51712
          IF        SUPCATYN=1
            IF        SIIASUS=3
              GOTO      NREC0200            * Read the next record
            ENDIF
          ENDIF
.                                           * srf 18093 - end
NREC0250  CALL      CKDAT000                     * check if valid record
          BRANCH    EXIT,NREC0200
          GOTO      NREC9000
.
.---- print by type 3 ----
.
NREC0300  CALL      RKSIIA2
          BRANCH    OVRCD,NREC9500
.
          MATCH     SIIASUB,TOCOD7
          GOTO      NREC9500 IF LESS             * out of range ?
.         srf 18093 - begin If sup catlg is yes then if susp for reqn & PO
.                                     * SUPCATYN was 0=yes - now 1=yes *C-51712
          IF        SUPCATYN=1
            IF        SIIASUS=3
              GOTO      NREC0300            * Read the next record
            ENDIF
          ENDIF
.                                           * srf 18093 - end
          CALL      CKDAT000                     * check if valid record
          BRANCH    EXIT,NREC0000
          GOTO      NREC9000
.
.---- print by type 4 ----
.
NREC0400  CALL      RKSIIE3
          BRANCH    OVRCD,NREC9500
.
          MATCH     SIIERAS,TORACK
          GOTO      NREC9500 IF LESS             * out of range ?
.
          MATCH     SIIEWAR,WAREHOUS
          GOTO      NREC0400 IF NOT EQUAL
.
NREC9000  MOVE      ZERO,OVRCD         * continue
          GOTO      NREC9999
.
NREC9500  MOVE      ONE,OVRCD          * quit
.
NREC9999  RETURN
.********************************************************************
. CKDAT - Check if valid record
.********************************************************************
CKDAT000  IF        OPTIONA=2
            COMPARE   ONE,SIIANON
            GOTO      CKDAT950 IF EQUAL
          ENDIF
          IF        OPTIONA=3
            COMPARE   ONE,SIIANON
            GOTO      CKDAT950 IF NOT EQUAL
          ENDIF
          IF        OPTIONA>3
            RESET     SIIASTI,CATFLAG
            CMATCH    "1",SIIASTI
            GOTO      CKDAT950 IF NOT EQUAL
          ENDIF
.
          IF        OPTIONA<3
            MOVE      ZERO,CHKSTOCK              * stock / non-stock flag
            BRANCH    SIIANON,CKDAT300           * stock / non-stock item?
            GOTO      CKDAT500
.
CKDAT300    MATCH     SP5,FRWARECD
            GOTO      CKDAT500 IF NOT EQUAL
            MATCH     "~~~~~",TOWARECD
            GOTO      CKDAT500 IF NOT EQUAL
            MOVE      ONE,CHKSTOCK               * stock / non-stock flag
            GOTO      CKDAT900

CKDAT500    PACK      KEY12,SIIACAT,FRWARECD,SP70
            CALL      RSSIIE1
            CALL      RPSIIE1
          ENDIF
.
CKDAT900  MOVE      ZERO,EXIT
          GOTO      CKDAT999
.
CKDAT950  MOVE      ONE,EXIT
.
CKDAT999  RETURN
.**********************************************************************
.  GWAR - Get next Warehouse                           Called By PRNT
.**********************************************************************
GWAR0000  BRANCH    OPTIONA,GWAR0100,GWAR0100
          GOTO      GWAR9000
.
GWAR0100  BRANCH    CHKSTOCK,GWAR9000
          CALL      RKSIIE1
          BRANCH    OVRCD,GWAR9999
.
          MATCH     SIIACAT,SIIECAT
          GOTO      GWAR9100 IF NOT EQUAL
.
          MATCH     SIIEWAR,TOWARECD
          GOTO      GWAR9100 IF LESS
.
.                                           * If Suppress Susp. Items  *I-f0903
.                                     * SUPCATYN was 0=yes - now 1=yes *C-51712
          IF        SUPCATYN = 1
            COMPARE   THREE,SIIESUS         * Check if Suspended       *I-f0902
            GOTO      GWAR0100 IF EQUAL                                *I-f0902
          ENDIF                                                        *I-f0903
.
. check warehouse security
.
          MATCH     SP70,SIIEWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIIEWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,GWAR0100
          ENDIF
.
          GOTO      GWAR9000
.
GWAR9000  MOVE      ZERO,OVRCD
          GOTO      GWAR9999
.
GWAR9100  MOVE      ONE,OVRCD
          PACK      SIIEWAR,SP70
.
GWAR9999  RETURN
.********************************************************************
. HEAD - print report                               Called by PRNT
.         Requires : FROMLAB,TOLAB   (print range display labels)
.                    FROMCOD7,TOCOD7 (print range)
.********************************************************************
HEAD0000
          MATCH     "A",DETAILED
          IF        @EQUAL
            CALL      HEAD80                     * print heading
            MOVE      "20",F2
          ELSE
            CALL      HEAD132                    * print heading
            MOVE      "40",F2
          ENDIF
.
          ADD       "3",CLNO
          IF        OPTIONR=1
            PRINT        *F2,"Print ",*+,SEL," by Catalog Code":
                      *N,*1,"From Catalog   : ",FROMLAB,SP2,DESC1:
                      *N,*1,"To   Catalog   : ",TOLAB,SP2,DESC2:
                      *N,*1,"From Warehouse : ",STRWARE,SP2,FROMWARE:
                      *N,*1,"To   Warehouse : ",ENDWARE,SP2,TOWARE
          ENDIF
          IF        OPTIONR=2
            PRINT        *F2,"Print ",*+,SEL," by Catalog Description":
                      *N,*1,"From Catalog   : ",DESC1:
                      *N,*1,"To   Catalog   : ",DESC2:
                      *N,*1,"From Warehouse : ",STRWARE,SP2,FROMWARE:
                      *N,*1,"To   Warehouse : ",ENDWARE,SP2,TOWARE
          ENDIF
          IF        OPTIONR=3
            PRINT        *F2,"Print ",*+,SEL," by Product Group":
                      *N,*1,"From Product Group : ",FROMLAB,SP2,DESC1:
                      *N,*1,"To   Product Group : ",TOLAB,SP2,DESC2:
                      *N,*1,"From Warehouse     : ",STRWARE,SP2,FROMWARE:
                      *N,*1,"To   Warehouse     : ",ENDWARE,SP2,TOWARE
          ENDIF
.
          IF        OPTIONR=4
            PRINT        *F2,"Print ",*+,SEL," by Rack & Shelf":
                      *N,*1,"From Rack & Shelf : ",STRRACK:
                      *N,*1,"To   Rack & Shelf : ",ENDRACK:
                      *N,*1,"Warehouse         : ",WAREHOUS,SP2,WAREDESC
          ENDIF
          ADD       "2",CLNO
.
          MATCH     "A",DETAILED
          IF        @EQUAL
            CALL      UND80                      * print line
            IF        OPTIONR=4
              PRINT     "| Catalog                         ":
                        "|Rak/Shlf|Prod.|Issue Unit     |    Ave. Cost":
                        *80,"|"
            ELSE
              PRINT     "| Catalog                               |":
                        " Prod. | Issue Unit":
                        "     |  Ave. Cost":
                        *80,"|"
            ENDIF
            CALL      UND80                      * print line
          ELSE
            MATCH     "G",DETAILED
            IF        OPTIONR=4 | PRN1WARE=1
              CALL      UND132                     * print line
              PRINT     "|   Catalog",*74,"(Rack/Shelf)":
                        *132,"|"
              CALL      UND132                     * print line
            ELSE
              CALL      UND132                     * print line
              PRINT     "| Catalog ":
                        *132,"|"
              CALL      UND132                     * print line
            ENDIF
          ENDIF
.
HEAD9999  RETURN
.********************************************************************
. WRIT - print data line                            Called by PRNT
.********************************************************************
WRIT0000  IF        EXPORTYN=1
            CALL      WREXPT00
          ENDIF
          MATCH     "A",DETAILED
          IF        @EQUAL
            BRANCH    OPTIONA,WRIT0100,WRIT0100,WRIT0200
            GOTO      WRIT0200
.
WRIT0100    MATCH     SIIACAT,SVCATALG
            GOTO      WRIT9999 IF EQUAL
.
WRIT0200    COMPARE   "55",CLNO                  * end of page ?
            CALL      HEAD0000 IF NOT LESS       * start new page
            UNPACK    SIIADES,KEY30
            UNPACK    SIIADES,KEY25
            MOVE      SIIAAVC,FORM6P6
            IF        OPTIONR=4
              PRINT     "|",SIIACAT," ",KEY25:
                        "|",SIIERAS,"|",SIIASUB,"|",SIIAISS:
                        "|",FORM6P6:
                        *80,"|"
            ELSE
              PRINT     "|",SIIACAT," ",KEY30:
                        " | ",SIIASUB," | ",SIIAISS,"|",FORM6P6:
                        *80,"|"
            ENDIF
            ADD       "1",CLNO                   * add one to line number
            CALL      DOUBL000                   * double spacing ?
            MOVE      SIIACAT,SVCATALG
          ELSE
            MATCH     "C",DETAILED
            IF        @EQUAL
              CALL      WRCOM000                 * print comprehensive report
            ELSE
              IF        OPTIONR=4
                CALL      WRGEN000               * print general report
                GOTO      WRIT9999
              ENDIF
              MATCH     SIIACAT,SVCATALG
              GOTO      WRIT9999 IF EQUAL
.
              CALL      WRGEN000                 * print general report
              MOVE      SIIACAT,SVCATALG
            ENDIF
          ENDIF
.
WRIT9999  RETURN
.********************************************************************
. DOUBL - Double spacing
.********************************************************************
DOUBL000
            MATCH     "D",SPACING
            IF        @EQUAL
              MATCH     "A",DETAILED
              IF        @EQUAL
                PRINT     "|",*80,"|"
                ADD       "1",CLNO          * add one to line number
              ELSE
                PRINT     "|",*132,"|"
                ADD       "1",CLNO          * add one to line number
              ENDIF
            ENDIF
.
DOUBL999  RETURN
.********************************************************************
. WRGEN - Print general report
.********************************************************************
WRGEN000
          MOVE      "*",ANS
          LOAD      ANS,SIIANON,SP70
          COMPARE   "55",CLNO                  * end of page ?
          CALL      HEAD0000 IF NOT LESS       * start new page
          ADD       "2",CLNO
.
          MOVE      SP70,APMACN1
          PACK      KEY5,SIIAPSC,SP70
          CALL      RDAPMA1
.
          UNPACK    SP70,SIICPNO,SIICCAT,SIICSUP
          PACK      KEY27,SIIACAT,SIIAPSC,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          PACK      KEY12,SIICCAT,SIICSUP,SP70
          MATCH     KEY12,KEY27             * correct cat/supp ?
          IF        !@EQUAL
            MOVE      SP70,SIICPNO
          ENDIF
.
          IF        OPTIONR=4 | PRN1WARE=1
            PRINT     "| ",ANS,SP1,SIIACAT,SP1,SIIADES:
                      " (",SIIERAS,")  Issue: ",SIIAISS," AVG:",SIIAAVC:
                      *132,"|"
          ELSE
            PRINT     "| ",ANS,SP1,SIIACAT,SP1,SIIADES:
                      " Issue unit : ",SIIAISS," AV cost : ",SIIAAVC:
                      *132,"|"
          ENDIF
          CALL      DOUBL000                   * double spacing ?
          PRINT     "|          ":
                    " Preferred Supplier : ",SIIAPSC,SP1,APMACN1:
                    "    Part No.:",SIICPNO," Product Grp: ",SIIASUB:
                    *132,"|"
          CALL      DOUBL000                   * double spacing ?
.
WRGEN999  RETURN
.********************************************************************
. WRCOM - Print comprehensive report
.********************************************************************
WRCOM000
.
.---- catalog details ----
.
          COMPARE   "53",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
          ADD       "4",CLNO
          PRINT     "|",*132,"|",*N:
                    "| ",SIIACAT," ",SIIADES:
                    "  ":
                    "    Issue Unit : ",SIIAISS:
                    "   Product Group : ",SIIASUB:
                    *132,"|",*N:
                    "|     ":
                    "    Average Cost : ",SIIAAVC:
                    "    Preferred Supplier : ",SIIAPSC:
                    "    NATO No. : ",SIIANAT:
                    "       Stock Category : ",SIIASTI:
                    *132,"|",*N:
                    *1,"|         Catalog Comments          : ";
          MOVE      ONE,PRNGST            * flag to print GST Code - Yes
          PACK      KEY10,SIIACAT,SP70
          CALL      RSSIIB1
.
WRCOM100
          CALL      RKSIIB1
          BRANCH    OVRCD,WRCOM200
          MATCH     SIIACAT,SIIBCAT
          GOTO      WRCOM200 IF NOT EQUAL
.
          ADD       "1",CLNO
          IF        55<CLNO
            PRINT     *132,"|"
            CALL      HEAD0000
            PRINT     "|                                     ";
          ENDIF
          IF        PRNGST=1 & IBCNUGST=2
            PRINT     SIIBCOM,*118,"GST : ",SIIAGST,*132,"|",*N:
                      "|                                     ";
            MOVE      ZERO,PRNGST
          ELSE
            PRINT     SIIBCOM,*132,"|",*N:
                      "|                                     ";
          ENDIF
          GOTO      WRCOM100
.
WRCOM200
          IF        PRNGST=1 & IBCNUGST=2
            PRINT     *118,"GST : ",SIIAGST,*132,"|"
            MOVE      ZERO,PRNGST
          ELSE
            PRINT     *132,"|"
          ENDIF
.
.---- warehouse details ----
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
.
WRCOM300
          CALL      RKSIIE1
          BRANCH    OVRCD,WRCOM400
          MATCH     SIIACAT,SIIECAT
          GOTO      WRCOM400 IF NOT EQUAL
.
. check warehouse security
.
          MATCH     SP70,SIIEWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIIEWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,WRCOM300
          ENDIF
.
          ADD       "4",CLNO
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
          MOVE      SP70,SIWADES
          PACK      KEY5,SIIEWAR,SP70
          CALL      RDSIWA1
          PRINT     "|",*132,"|",*N:
                    "|         Warehouse     : ",SIIEWAR,SP1,SIWADES:
                    "  Rack/Shelf : ",SIIERAS:
                    "  Reorder Level : ",SIIEROL:
                    *132,"|",*N:
                    "|         Stock on Hand : ",SIIESOH:
                    "            Stock on Order : ",SIIESOO:
                    "         Reorder Quantity : ",SIIEROQ:
                    *132,"|",*N:
                    "|         Catalog/Warehouse Comments : ";
          PACK      KEY15,SIIECAT,SIIEWAR,SP70
          CALL      RSSIIG1
.
WRCOM310
          CALL      RKSIIG1
          BRANCH    OVRCD,WRCOM320
          MATCH     SIIECAT,SIIGCAT
          GOTO      WRCOM320 IF NOT EQUAL
          MATCH     SIIEWAR,SIIGWAR
          GOTO      WRCOM320 IF NOT EQUAL
.
          ADD       "1",CLNO
          IF        55<CLNO
            PRINT     *132,"|"
            CALL      HEAD0000
            PRINT     "|                                      ";
          ENDIF
          PRINT     SIIGCOM,*132,"|",*N:
                    "|                                      ";
          GOTO      WRCOM310
.
WRCOM320
          PRINT     *132,"|"
          GOTO      WRCOM300
.
WRCOM400
.
.---- supplier details ----
.
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
.
WRCOM500
          CALL      RKSIIC1
          BRANCH    OVRCD,WRCOM600
          MATCH     SIIACAT,SIICCAT
          GOTO      WRCOM600 IF NOT EQUAL
.
          ADD       "4",CLNO
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
          MOVE      SP70,APMASN1
          PACK      KEY5,SIICSUP,SP70
          CALL      RDAPMA1
          PRINT     "|",*132,"|",*N:
                    "|         Supplier      : ",SIICSUP,SP1,APMASN1:
                    "          Lead Time : ",SIICLTM:
                    "        Current Cost : ",SIICCCT,*132,"|",*N:
                    "|         Part No.      : ",SIICPNO:
                    "              Supply Unit : ",SIICSUT:
                    "  Last Cost : ",SIICLCT:
                    *132,"|",*N:
                    "|         Catalog/Supplier Comments  : ";
          PACK      KEY15,SIICCAT,SIICSUP,SP70
          CALL      RSSIID1
.
WRCOM510
          CALL      RKSIID1
          BRANCH    OVRCD,WRCOM520
          MATCH     SIICCAT,SIIDCAT
          GOTO      WRCOM520 IF NOT EQUAL
          MATCH     SIICSUP,SIIDSUP
          GOTO      WRCOM520 IF NOT EQUAL
.
          ADD       "1",CLNO
          IF        55<CLNO
            PRINT     *132,"|"
            CALL      HEAD0000
            PRINT     "|                                      ";
          ENDIF
          PRINT     SIIDCOM,*132,"|",*N:
                    "|                                      ";
          GOTO      WRCOM510
.
WRCOM520
          PRINT     *132,"|"
          GOTO      WRCOM500
.
WRCOM600
.
WRCOM999  RETURN
.********************************************************************
. WRAC - print Rack & Shelf details                 Called by PRNT
.********************************************************************
WRAC0000    COMPARE   "55",CLNO                  * end of page ?
            CALL      HEAD0000 IF NOT LESS       * start new page
.
            PACK      KEY7,SIIECAT,SP70
            CALL      RDSIIA1
            UNPACK    SIIADES,KEY30
            PRINT     "|",SIIEWAR,SP6:
                      "|",SIIECAT," ",KEY30:
                      " | ",SIIERAS:
                      *80,"|"
            ADD       "1",CLNO                   * add one to line number
            CALL      DOUBL000                   * double spacing ?
.
WRAC9999  RETURN
.--------------------------------------------------------------------------
. Execute Transfer Script eg softerm
.--------------------------------------------------------------------------
TRAN0000  MOVE     YES,DEFYESNO
          CLOSE    EXPORTFL
          DISPLAY  *P1:24,*EL,"Execute Transfer Now (":
                              *V2LON,"Y",*HOFF,"/":
                              *V2LON,"N",*HOFF,") ? "
          MOVE     "24",CVERT
          MOVE     "30",CCOL
          CALL     YORN0000
          COMPARE  ZERO,FYESNO,
          GOTO     TRAN9999 IF EQUAL   *  No Transfer
.
          MOVE     ZERO,HLEF
          CALL     GETSCR00
.
          MOVE     "EXPORT",KEY6
          PACK     KEY8,KEY6,PORT
          REP      " 0",KEY8
          CLEAR    KEY80
          APPEND   "keatran ",KEY80
          APPEND   KEY8,KEY80
          APPEND   ".txt",KEY80
          RESET    KEY80
          EXECUTE  KEY80,TASKID
.
          CALL     PUTSCR00
.
          DISPLAY  *P1:24,*EL,"Transfer Completed Ok (":
                              *V2LON,"Y",*HOFF,"/":
                              *V2LON,"N",*HOFF,") ? "
          MOVE     "24",CVERT
          MOVE     "31",CCOL
          CALL     YORN0000
          COMPARE  ZERO,FYESNO,
          GOTO     TRAN0000 IF EQUAL   *  Not ok
.
          PREP     EXPORTFL,KEY8
          CLOSE    EXPORTFL
.
TRAN9999  RETURN
.------------------------------------------------------------
. Create Export File
.------------------------------------------------------------
MAKEXP00  MOVE     "EXPORT",KEY6
          PACK     KEY8,KEY6,PORT
          REP      " 0",KEY8
          PREP     EXPORTFL,KEY8
          WRITE    EXPORTFL,SEQ;"Catalog",TABDELM,"Catalog Name",TABDELM:
                                "Issue Unit",TABDELM:
                                "Average Cost",TABDELM:
                                "Pref. Supplier",TABDELM:
                                "Pref. Supplier",TABDELM:
                                "Supply Unit",TABDELM:
                                "Part Number",TABDELM:
                                "Part Description",TABDELM:
                                "Current Cost",TABDELM:
                                "Last Inv. Cost",TABDELM:
                                "Lead Time",TABDELM:
                                "Product Group",TABDELM:
                                "Product Group Name",TABDELM:
                                "Commodity Group",TABDELM:
                                "Commodity Group Name",TABDELM:
                                "Warehouse Code",TABDELM:
                                "Warehouse Description",TABDELM:
                                "Rack & Shelf",TABDELM:
                                "Stock on Hand",TABDELM:
                                "Stock on Order",TABDELM:
                                "Re-Order Level",TABDELM:
                                "Re-Order Qty",TABDELM:
                                "Other Supplier",TABDELM:
                                "Other Supplier",TABDELM:
                                "Supply Unit",TABDELM:
                                "Part Number",TABDELM:
                                "Part Description",TABDELM:
                                "Current Cost",TABDELM:
                                "Last Inv. Cost",TABDELM:
                                "Lead Time"
MAKEXP99  RETURN
.------------------------------------------------------------
. Write to Export File
.------------------------------------------------------------
WREXPT00  MOVE      SP70,APMACN1
          PACK      KEY5,SIIAPSC,SP70
          CALL      RDAPMA1
.
          PACK      KEY5,SIIASUB
          CALL      RDSISA1
.
          PACK      KEY6,SISACOMM                                      *C-59696
          CALL      RDSIGA1
.
          PACK      SVKEY12,SIIECAT,SIIEWAR,SP70  * save current pointer
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
          CALL      RKSIIE1
          IF        OVRCD=0
            MOVE      SIIEWAR,KEY5
          ENDIF
.
          MOVE      SVKEY12,KEY12                 * restore pointer
          CALL      RASIIE1
.
          CALL      RDSIWA1
          BRANCH    OVRCD,WREXPT10
          MATCH     SIIECAT,SIIACAT
          GOTO      WREXPT20 IF EQUAL
.
WREXPT10  MOVE      SP70,SIIERAS
          MOVE      SP70,SIWADES
          MOVE      ZERO,SIIESOH
          MOVE      ZERO,SIIESOO
          MOVE      ZERO,SIIEROQ
          MOVE      ZERO,SIIEROL
.
WREXPT20  UNPACK    SP70,SIICPNO,SIICCAT,SIICSUP
          PACK      KEY27,SIIACAT,SIIAPSC,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          PACK      KEY12,SIICCAT,SIICSUP,SP70
          MATCH     KEY12,KEY27             * correct cat/supp ?
          IF        !@EQUAL
            MOVE      SP70,PREFNAME
            MOVE      SP70,PREFSUT
            MOVE      SP70,PREFPNO
            MOVE      SP70,PREFPD1
            MOVE      ZERO,PREFCCT
            MOVE      ZERO,PREFLCT
            MOVE      ZERO,PREFLTM
          ENDIF
.
          MOVE      APMASN1,PREFNAME
          MOVE      SIICSUT,PREFSUT
          MOVE      SIICPNO,PREFPNO
          MOVE      SIICPD1,PREFPD1
          MOVE      SIICCCT,PREFCCT
          MOVE      SIICLCT,PREFLCT
          MOVE      SIICLTM,PREFLTM
.
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
.
WREXPT30  CALL      RKSIIC1
          BRANCH    OVRCD,WREXPT40
          MATCH     SIIACAT,SIICCAT
          GOTO      WREXPT40 IF NOT EQUAL
          MATCH     SIIAPSC,SIICSUP
          GOTO      WREXPT30 IF EQUAL
.
          MOVE      SP70,APMASN1
          PACK      KEY5,SIICSUP,SP70
          CALL      RDAPMA1
          GOTO      WREXPT50
.
WREXPT40  PACK      APMASN1,SP70
          PACK      SIICSUT,SP70
          PACK      SIICPNO,SP70
          PACK      SIICPD1,SP70
          MOVE      ZERO,SIICCCT
          MOVE      ZERO,SIICLCT
          MOVE      ZERO,SIICLTM
.
WREXPT50  WRITE     EXPORTFL,SEQ;SIIACAT,TABDELM,SIIADES,TABDELM:
                                 SIIAISS,TABDELM,SIIAAVC,TABDELM:
                                 SIIAPSC,TABDELM,PREFNAME,TABDELM:
                                 PREFSUT,TABDELM,PREFPNO,TABDELM:
                                 PREFPD1,TABDELM,PREFCCT,TABDELM:
                                 PREFLCT,TABDELM,PREFLTM,TABDELM:
                                 SISACODE,TABDELM,SISADESC,TABDELM:
                                 SIGACOD,TABDELM,SIGADES,TABDELM:
                                 SIIEWAR,TABDELM,SIWADES,TABDELM:
                                 SIIERAS,TABDELM,SIIESOH,TABDELM:
                                 SIIESOO,TABDELM,SIIEROL,TABDELM:
                                 SIIEROQ,TABDELM:
                                 SIICSUP,TABDELM,APMASN1,TABDELM:
                                 SIICSUT,TABDELM,SIICPNO,TABDELM:
                                 SIICPD1,TABDELM,SIICCCT,TABDELM:
                                 SIICLCT,TABDELM,SIICLTM
WREXPT99  RETURN
.
.----------------------------------------------------------------------
. Range of Product Group Code
.----------------------------------------------------------------------
RPRG0000  MOVE      "    4",FLDID
          PACK      FROMLAB,SP70
          MOVE      FROMLAB,VAR
          CALL      GETPOSIT
          PACK      SISACODE,SP70
          CALL      KSISAA00
          BRANCH    EXIT,RPRG0100,RPRG9999
          MOVE      SISACODE,FROMCOD7
          PACK      FROMLAB,SISACODE,SP70
          PACK      DESC1,SISADESC,SP70
          GOTO      RPRG0140
.
RPRG0100  PACK      FROMCOD7,SP70
          MOVE      "Start  ",FROMLAB
          PACK      DESC1,SP70
.
RPRG0140  MOVE      "    6",FLDID
          CALL      GETPOSIT
          MOVE      DESC1,VAR
          CALL      DISPITEM
.
RPRG0150  MOVE      "    5",FLDID
          PACK      TOLAB,SP70
          MOVE      TOLAB,VAR
          CALL      GETPOSIT
          PACK      SISACODE,SP70
          CALL      KSISAA00
          BRANCH    EXIT,RPRG0200,RPRG9999
          MOVE      SISACODE,TOCOD7
          PACK      TOLAB,SISACODE,SP70
          PACK      DESC2,SISADESC,SP70
.
          MATCH     FROMCOD7,TOCOD7
          GOTO      RPRG9900 IF EQUAL
          GOTO      RPRG9900 IF NOT LESS
          BEEP
          MOVE      "To Product Group Must Be > From Product Group - ",DISPMSG
          CALL      MESSAGE1
          GOTO      RPRG0000
.
RPRG0200  PACK      TOCOD7,Z70
          MOVE      "Finish ",TOLAB
          PACK      DESC2,SP70
.
RPRG9900  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
RPRG9999  RETURN
.
.----------------------------------------------------------------------
. Keyin To Code
.----------------------------------------------------------------------
KPRDT000
          MOVE      SP70,TOLAB
          DISPLAY   *PCCOL:CVERT,TOLAB;
.
          CALL      KSISAA00
          PACK      TOCOD7,SISACODE,SP70
          LOAD      TOCOD7,EXIT,Z70,SP70
.
          PACK      DESC2,SISADESC,SP70
          LOAD      DESC2,EXIT,SP70,SP70
.
          PACK      TOLAB,SISACODE,SP70
          LOAD      TOLAB,EXIT,END,SP70
.
KPRDT999  RETURN
.----------------------------------------------------------------------
. Keyin Spacing
.----------------------------------------------------------------------
KSPAC000
          MOVE      "S",SPACING
          MATCH     "G",DETAILED
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,SPACING;
            REP       UPPLOW,SPACING
            PACK      ANS,SPACING,SP70
            MATCH     SP70,ANS
            GOTO      KSPAC950 IF EQUAL
            MATCH     EXITCHAR,ANS
            GOTO      KSPAC950 IF EQUAL
.
            REP       "1x2xD1S1",ANS
            MOVE      ZERO,F1
            MOVE      ANS,F1
            BRANCH    F1,KSPAC900
            BEEP
            GOTO      KSPAC000
          ELSE
            IF        ACCEPT=0
              BEEP
              CLEAR     DISPMSG
              APPEND "Only Single Spacing For a Comprehensive Report - ",DISPMSG
              CALL      MESSAGE1
            ENDIF
          ENDIF
.
KSPAC900  MOVE     ZERO,EXIT
          GOTO     KSPAC999
.
KSPAC950  MOVE     TWO,EXIT
.
KSPAC999  RETURN
.----------------------------------------------------------------------
. Range of Warehouse Code
.----------------------------------------------------------------------
RWAR0000  MOVE      ZERO,PRN1WARE
.
          MOVE      "   11",FLDID
          PACK      STRWARE,SP70
          MOVE      STRWARE,VAR
          CALL      GETPOSIT
.
. for Non-stock selected, skip keyin range of warehouse
.
          COMPARE   THREE,OPTIONA
          GOTO      RWAR0200 IF EQUAL            * SRF 4557
.
          PACK      SIWAWAR,SP70
          CALL      KSIWSA00
          BRANCH    EXIT,RWAR0200,RWAR9999
          MOVE      SIWAWAR,FRWARECD
          PACK      STRWARE,SIWAWAR,SP70
          PACK      FROMWARE,SIWADES,SP70
          GOTO      RWAR0300
.
RWAR0200  PACK      FRWARECD,SP70
          MOVE      "Start ",STRWARE
          PACK      FROMWARE,SP70
.
RWAR0300  MOVE      "   13",FLDID
          CALL      GETPOSIT
          MOVE      FROMWARE,VAR
          CALL      DISPITEM
.
          MOVE      "   12",FLDID
          PACK      ENDWARE,SP70
          MOVE      ENDWARE,VAR
          CALL      GETPOSIT
.
. for Non-stock selected, skip keyin range of warehouse
.
          COMPARE   THREE,OPTIONA
          GOTO      RWAR0600 IF EQUAL           * SRF 4557
.
          PACK      SIWAWAR,SP70
          CALL      KSIWSA00
          BRANCH    EXIT,RWAR0600,RWAR9999
          MOVE      SIWAWAR,TOWARECD
          PACK      ENDWARE,SIWAWAR,SP70
          PACK      TOWARE,SIWADES,SP70
.
          MATCH     FRWARECD,TOWARECD
          GOTO      RWAR0700 IF EQUAL
          GOTO      RWAR9900 IF NOT LESS
          BEEP
          MOVE      "To Warehouse Must Be > From Warehouse - ",DISPMSG
          CALL      MESSAGE1
          GOTO      RWAR0000
.
RWAR0600  PACK      TOWARECD,Z70
          MOVE      "Finish",ENDWARE
          PACK      TOWARE,SP70
          GOTO      RWAR9900
.
RWAR0700  MOVE      ONE,PRN1WARE                 * 1 warehouse selected
.
RWAR9900  MOVE      "   11",FLDID
          CALL      GETPOSIT
.
RWAR9999  RETURN
.
.----------------------------------------------------------------------
. Range of Catalog Code
.----------------------------------------------------------------------
RCAC0000  MOVE      "    4",FLDID
          PACK      FROMLAB,SP70
          MOVE      FROMLAB,VAR
          CALL      GETPOSIT
          PACK      SIIACAT,SP70
          CALL      KSIIAA00
          BRANCH    EXIT,RCAC0100,RCAC9999
          MOVE      SIIACAT,FROMCOD7
          PACK      FROMLAB,SIIACAT,SP70
          PACK      DESC1,SIIADES,SP70
          GOTO      RCAC0140
.
RCAC0100  PACK      FROMCOD7,SP70
          MOVE      "Start  ",FROMLAB
          PACK      DESC1,SP70
.
RCAC0140  MOVE      "    6",FLDID
          CALL      GETPOSIT
          MOVE      DESC1,VAR
          CALL      DISPITEM
.
RCAC0150  MOVE      "    5",FLDID
          PACK      TOLAB,SP70
          MOVE      TOLAB,VAR
          CALL      GETPOSIT
          PACK      SIIACAT,SP70
          CALL      KSIIAA00
          BRANCH    EXIT,RCAC0200,RCAC9999
          MOVE      SIIACAT,TOCOD7
          PACK      TOLAB,SIIACAT,SP70
          PACK      DESC2,SIIADES,SP70
.
          MATCH     FROMCOD7,TOCOD7
          GOTO      RCAC9900 IF EQUAL
          GOTO      RCAC9900 IF NOT LESS
          BEEP
          MOVE      "To Catalog Code Must Be > From Catalog Code - ",DISPMSG
          CALL      MESSAGE1
          GOTO      RCAC0000
.
RCAC0200  PACK      TOCOD7,Z70
          MOVE      "Finish ",TOLAB
          PACK      DESC2,SP70
.
RCAC9900  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
RCAC9999  RETURN
.
.----------------------------------------------------------------------
. Keyin To Code
.----------------------------------------------------------------------
KCODT000
          MATCH     "C",RANGETYP
          IF        @EQUAL
            MOVE      SP70,TOLAB
            DISPLAY   *PCCOL:CVERT,TOLAB;
.
            CALL      KSIIAA00
            PACK      TOCOD7,SIIACAT,SP70
            LOAD      TOCOD7,EXIT,Z70,SP70
.
            PACK      DESC2,SIIADES,SP70
            LOAD      DESC2,EXIT,SP70,SP70
.
            PACK      TOLAB,SIIACAT,SP70
            LOAD      TOLAB,EXIT,END,SP70
          ELSE
            MOVE      ZERO,EXIT
            MOVE      SP70,DESC2
            KEYIN     *PCCOL:CVERT,*DV,DESC2:
                      *PCCOL:CVERT,*V2LON,DESC2;
            PACK      PDESC2,DESC2,Z70
            PACK      DESC2,DESC2,SP70
.
            MATCH     DESC2,SP70
            IF        @EQUAL
              PACK      DESC2,END,SP70
            ENDIF
          ENDIF
.
KCODT999  RETURN
.----------------------------------------------------------------------
. Range of Catalog Description
.----------------------------------------------------------------------
RCAD0000  MOVE      "    4",FLDID
          PACK      DESC1,SP70
          MOVE      DESC1,VAR
          CALL      GETPOSIT
          PACK      DESCCATA,SP70
          CALL      KCDS0000
          BRANCH    EXIT,RCAD0100,RCAD9999
          PACK      DESC1,DESCCATA,SP70
          PACK      PDESC1,DESCCATA,SP70
          GOTO      RCAD0140
.
RCAD0100  PACK      PDESC1,SP70
          MOVE      "Start  ",DESC1
.
RCAD0140  MOVE      DESC1,VAR
          CALL      DISPITEM
.
RCAD0150  MOVE      "    5",FLDID
          PACK      DESC2,SP70
          MOVE      DESC2,VAR
          CALL      GETPOSIT
          PACK      DESCCATA,SP70
          CALL      KCDS0000
          BRANCH    EXIT,RCAD0200,RCAD9999
          PACK      DESC2,DESCCATA,SP70
          PACK      PDESC2,DESCCATA,SP70
.
          MATCH     PDESC1,PDESC2
          GOTO      RCAD9900 IF EQUAL
          GOTO      RCAD9900 IF NOT LESS
          BEEP
          MOVE      "To Catalog Desc. Must Be > From Catalog Desc. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      RCAD0000
.
RCAD0200  PACK      PDESC2,Z70
          MOVE      "Finish ",DESC2
.
RCAD9900  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
RCAD9999  RETURN
.----------------------------------------------------------------------
. Keyin Catalog Description
.----------------------------------------------------------------------
KCDS0000  MOVE      ZERO,EXIT
          KEYIN     *PCCOL:CVERT,*DV,DESCCATA:
                    *PCCOL:CVERT,*V2LON,DESCCATA;
.
          ENDSET    DESCCATA
          APPEND    SP70,DESCCATA
          RESET     DESCCATA
.
          MATCH     SP70,DESCCATA
          GOTO      KCDS9800 IF EQUAL
.
          CMATCH    EXITCHAR,DESCCATA
          GOTO      KCDS9900 IF EQUAL
          GOTO      KCDS9999
.
KCDS9800  MOVE      ONE,EXIT
          GOTO      KCDS9999
.
KCDS9900  MOVE      TWO,EXIT
          GOTO      KCDS9999
.
KCDS9999  RETURN
.
.----------------------------------------------------------------------
. Range of Rack & Shelf Code
.----------------------------------------------------------------------
RRAC0000  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
          PACK      STRRACK,SP70
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,STRRACK;
          ENDSET    STRRACK
          APPEND    SP70,STRRACK
          RESET     STRRACK
.
          MATCH     SP70,STRRACK
          GOTO      RRAC0100 IF EQUAL
.
          CMATCH    EXITCHAR,STRRACK
          GOTO      RRAC9990 IF EQUAL
.
          MOVE      STRRACK,FROMRACK
          GOTO      RRAC0150
.
RRAC0100  MOVE      "Start   ",STRRACK
          PACK      FROMRACK,SP70
.
RRAC0150  MOVE      "    5",FLDID
          CALL      GETPOSIT
.
          PACK      ENDRACK,SP70
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,ENDRACK;
          ENDSET    ENDRACK
          APPEND    SP70,ENDRACK
          RESET     ENDRACK
.
          MATCH     SP70,ENDRACK
          GOTO      RRAC0200 IF EQUAL
.
          CMATCH    EXITCHAR,ENDRACK
          GOTO      RRAC9990 IF EQUAL
.
          MOVE      ENDRACK,TORACK
.
          MATCH     FROMRACK,TORACK
          GOTO      RRAC9900 IF EQUAL
          GOTO      RRAC9900 IF NOT LESS
          BEEP
          MOVE      "To Rack & Shelf Must Be > From Rack & Shelf - ",DISPMSG
          CALL      MESSAGE1
          GOTO      RRAC0000
.
RRAC0200  MOVE      "Finish  ",ENDRACK
          PACK      TORACK,Z70
.
RRAC9900  MOVE      "    4",FLDID
          CALL      GETPOSIT
          GOTO      RRAC9999
.
RRAC9980  MOVE      ONE,EXIT
          GOTO      RRAC9999
.
RRAC9990  MOVE      TWO,EXIT
          GOTO      RRAC9999
.
RRAC9999  RETURN
.
.----------------------------------------------------------------------
. Enter Warehouse Code
.----------------------------------------------------------------------
EWAR0000  PACK      SIWAWAR,SP70
          PACK      WAREHOUS,SP70
          MOVE      "Not Applicable for Non-Stock Item",WAREDESC
.
. for Non-stock selected, skip keyin warehouse
.
          COMPARE   THREE,OPTIONA
          GOTO      EWAR9999 IF EQUAL            * SRF 4557
.
          CALL      KSIWSA00
          BRANCH    EXIT,EWAR0000,EWAR9999
          MOVE      SIWAWAR,WAREHOUS
          PACK      WAREDESC,SIWADES,SP70
.
EWAR9999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSMASIO/INC
          INC       SINCGAIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIBIO/INC
          INC       SINCICIO/INC
          INC       SINCIDIO/INC
          INC       SINCIEIO/INC
          INC       SINCIFIO/INC
          INC       SINCIGIO/INC
          INC       SINCODIO/INC
          INC       SINNATIO/INC
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
