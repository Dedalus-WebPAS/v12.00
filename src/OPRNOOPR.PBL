.***************************************************************************
.*  Include    :  OPRNOOPR.PBL                                             *
.*  Function   :  Calculate No. of procedures/operations for a case/team   *
.*                                                                         *
.*  Author     :  ROD  (27/03/95)                                          *
.*                                                                         *
.*  Parameters :  OPCNNOOP (Sys Par) - Using No. of operations             *
.*                oprdetcf record                                          *
.*                                                                         *
.*  Returns    :  NUMOPERS (Form 6) - Number of operations                 *
.*                                                                         *
.*  Modifications:                                                         *
.*               V11.01.01 18/02/2021  J.Tan           TSK 0888639         *
.*                         Changed Counter OPRPMBFD to DIM 3               *
.*                V9.08.01 21/05/2007 CAR 140351                           *
.*                         Ported to V9.07                                 *
.***************************************************************************
OPRNOOPR  IF        OPCNNOOP=1
            MOVE      OPSGNOOP,NUMOPERS           * No. Opers = No. Procedures
          ELSE

. NB: cant just use zzz and do readp since oper codes stored in billing order
.
            MOVE      ZERO,NUMOPERS
            PACK      KEY14,OPSGUNID,OPSGTMNO,SP10
            CALL      RSOPPMB1
NOOPR100    CALL      RKOPPMB1
            BRANCH    OVRCD,NOOPR999
.
            MATCH     OPSGUNID,OPPMUNID
            GOTO      NOOPR999 IF NOT EQUAL
.
            MATCH     OPSGTMNO,OPPMTMNO       * Are you all from the same team?
            GOTO      NOOPR999 IF NOT EQUAL
.
            ADD       ONE,NUMOPERS            * no. of procedures
            GOTO      NOOPR100
          ENDIF
.
NOOPR999  RETURN

