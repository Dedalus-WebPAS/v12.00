.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRMASKY
.   Routine   :   KSCMAA00 Keyin Screen ID           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSCMAA00 TOPIC     "SCMASID "
          MOVE      UNDLN70,SCMASID 
          KEYIN     *PCCOL:CVERT,*DV,SCMASID:                                   
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,SCMASID:                        
                    *PCCOL:CVERT,*DV,SCMASID 
.
          ENDSET    SCMASID 
          APPEND    SP70,SCMASID 
          RESET     SCMASID 
.
          MATCH     SP70,SCMASID 
          GOTO      KSCMAA90 IF EQUAL
.
          ENDSET    SCMASID 
          CMATCH    EXITCHAR,SCMASID 
          GOTO      KSCMAA95 IF EQUAL
.
          CMATCH    QUEST,SCMASID 
          GOTO      KSCMAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSCMAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SCMASID 
          APPEND    SP70,SCMASID 
          RESET     SCMASID 
.
          MATCH     SP70,SCMASID 
          GOTO      KSCMAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SCMASID                                 
KSCMAA10
          RESET     SCMASID 
          PACK      KEY10,SCMAPID,SCMASID                                       
          CALL      RASCMA1 
          BRANCH    OVRCD,KSCMAA80
          BRANCH    CKEYTYP,KSCMAA75
          CALL      RDSCMA1 
KSCMAA70
          MOVE      ZERO,EXIT
          GOTO      KSCMAA99
KSCMAA75
          MOVE      "Screen ID Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KSCMAA00
KSCMAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSCMAA99,KSCMAA99
          MOVE      "Screen ID Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KSCMAA00
KSCMAA90
          MOVE      ONE,EXIT
          GOTO      KSCMAA99
KSCMAA95
          MOVE      TWO,EXIT
KSCMAA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRMASKY
.   Routine   :   HSCMAA00 Screen Id           
.   Return    :           
.-------------------------------------------------------------------------------
HSCMAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HSCMAA04
          CALL      GSCRN000
          BRANCH    EXIT,HSCMAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Screen ID"          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "35",STDCOL03
HSCMAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SCMASID 
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          PACK      SAVKEY80,SCMAPID,SCMASID,SP70                               
          SETLPTR   SAVKEY80,8                                                  
          CALL      RSSCMA1 
HSCMAA10
          CALL      RKSCMA1 
          BRANCH    OVRCD,HSCMAA15
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSCMAA12
          CALL      HSCMAA60
          BRANCH    OVRCD,HSCMAA10
HSCMAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY10,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SCMASID 
          DISPLAY   *PSTDCOL02:STDROW,SCMADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSCMAA10 IF NOT EQUAL
HSCMAA15
          UNPACK    SAVKEY80,SCMAPID,SCMASID                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSCMAA20
          CALL      HSCRI000
          BRANCH    EXIT,HSCMAA30,HSCMAA35,HSCMAA40,HSCMAA45,HSCMAA04:
                              HSCMAA91,HSCMAA50
          GOTO      HSCMAA92
HSCMAA30
          CALL      RKSCMA1 
          BRANCH    OVRCD,HSCMAA85
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA85 IF NOT EQUAL                                       
          CALL      RPSCMA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCMAA10
HSCMAA35
          MOVE      ST1,KEY10
          CALL      RDSCMA1 
          CALL      RPSCMA1 
          BRANCH    OVRCD,HSCMAA85
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA85 IF NOT EQUAL                                       
          MATCH     SP70,SCMASID                                                
          GOTO      HSCMAA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSCMAA36
          CALL      RPSCMA1 
          BRANCH    OVRCD,HSCMAA37
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCMAA36 IF NOT EQUAL
HSCMAA37
          MOVE      ZERO,XITEMNO
          GOTO      HSCMAA10
HSCMAA40
          MOVE      ST1,KEY10
          CALL      RDSCMA1 
          CALL      RPSCMA1 
          BRANCH    OVRCD,HSCMAA85
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCMAA08
HSCMAA45
          CALL      RKSCMA1 
          BRANCH    OVRCD,HSCMAA85
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY10,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSCMA1 
HSCMAA46
          CALL      RPSCMA1 
          BRANCH    OVRCD,HSCMAA47
          PACK      KEY10,SCMAPID,SCMASID,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HSCMAA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCMAA46 IF NOT EQUAL
HSCMAA47
          MOVE      ZERO,XITEMNO
          GOTO      HSCMAA10
HSCMAA50  COMPARE   ZERO,CSEARCH
          GOTO      HSCMAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCMAA08
HSCMAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCMAA08
HSCMAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSCMAA61 IF EQUAL
          MATCH     SCHFLD01,SCMASID 
          GOTO      HSCMAA72 IF NOT EQUAL
HSCMAA61
          MATCH     SP70,SCHFLD02
          GOTO      HSCMAA62 IF EQUAL
          MATCH     SCHFLD02,SCMADES 
          GOTO      HSCMAA72 IF NOT EQUAL
HSCMAA62
HSCMAA63
HSCMAA64
HSCMAA65
HSCMAA66
HSCMAA67
HSCMAA68
HSCMAA69
HSCMAA70
          GOTO      HSCMAA75
HSCMAA72  MOVE      ONE,OVRCD
HSCMAA75  RETURN
HSCMAA85
          LOAD      KEY10,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY10,SCMAPID,SCMASID                                       
          CALL      RDSCMA1 
HSCMAA90
          UNPACK    SAVKEY80,SCMAPID,SCMASID                                    
          BEEP
          GOTO      HSCMAA20
HSCMAA91
          MOVE      SP70,SCMADES 
          MOVE      ZERO,SCMATOP 
          MOVE      ZERO,SCMALEF 
          MOVE      ZERO,SCMABOT 
          MOVE      ZERO,SCMARIG 
          MOVE      SP70,SCMACBF 
          MOVE      SP70,SCMACAF 
          MOVE      ZERO,SCMATYP 
          MOVE      SP70,SCMASEX 
          MOVE      SP70,SCMAFSC 
          MOVE      SP70,SCMACLR 
          MOVE      SP70,SCMAFPR 
          MOVE      SP70,SCMASPA 
          MOVE      SP70,KEY10
          MOVE      SP70,SCMASID 
          GOTO      HSCMAA96
HSCMAA92
          MOVE      SP70,KEY10
          MOVE      SP70,SCMASID 
          LOAD      KEY10,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY10,SCMAPID,SCMASID                                       
HSCMAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSCMAA99
          RETURN
