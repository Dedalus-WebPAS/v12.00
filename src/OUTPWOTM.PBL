. *----------------------------------------------------------------------
. * Include Name  :   OUTPWOTM.PBL
. *
. * Function      :   CGI variables for OUTPWOFD - outpwoaf.dat
. *
. * Includes Needed : OUTPWOFD - ABF Non-Admitted Price Weights
. *                   OUTPWOIO - IO for ABF Non-Admitted Price Weights
. * Modifications :
. *
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for ABF Non Admitted price weights
.------------------------------------------------------------------------
.
CLRPWO00  MOVE      SP70,OTPWO001
          MOVE      SP70,OTPWO002
          MOVE      ZERO,OTPWO003
          RETURN
.
.------------------------------------------------------------------------
. ABF Non Admitted PW Fields
.------------------------------------------------------------------------
OTPW0000  BRANCH    FLDITMNO,OTPW0010,OTPW0020,OTPW0030
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OTPW9999
.
OTPW0010  UNPACK    DIM127,D1,KEY1,DIM127         * Contract ID
          MOVE      KEY1,F1
          BRANCH    F1,OTPW0012
.
          WRITE     HTMLFILE;OTPWCNTR;
          GOTO      OTPW9999
.
OTPW0012  PACK      KEY6,OTPWCNTR,SP70
          CALL      RDPMCID1
          BRANCH    OVRCD,OTPW9999
.
          WRITE     HTMLFILE;PMCIDESC;
          GOTO      OTPW9999
.
OTPW0020  UNPACK    DIM127,D1,KEY1,DIM127
          MATCH     SP70,OTPWTIER
          GOTO      OTPW9999 IF EQUAL
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OTPW0021
.
          WRITE     HTMLFILE;OTPWTIER;           * Tier 2 Clinic V5.0 Cat NC
          GOTO      OTPW9999
.
OTPW0021  PACK      TDESC,SP70
          PACK      KEY5,CATNC,OTPWTIER,SP70
          CALL      RDCODE1 
          BRANCH    OVRCD,OTPW9999
.
          WRITE     HTMLFILE;TDESC;
          GOTO      OTPW9999
.
OTPW0030  WRITE     HTMLFILE;OTPWPWEI;            * Price Weight
          GOTO      OTPW9999
.
OTPW9999  RETURN
.
.------------------------------------------------------------
. Set Parameters for ABF Non Admitted PW
.------------------------------------------------------------
SPOPW000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPOPW001,SPOPW002,SPOPW003
.
          MOVE      ONE,EXIT
          GOTO      SPOPW999
.
SPOPW001  MOVE      QRYDATA,OTPWO001
          PACK      OTPWO001,OTPWO001,SP70
          GOTO      SPOPW999
.
SPOPW002  MOVE      QRYDATA,OTPWO002
          PACK      OTPWO002,OTPWO002,SP70
          GOTO      SPOPW999
.
SPOPW003  SQUEEZE   QRYDATA
          MOVE      QRYDATA,OTPWO003
          GOTO      SPOPW999
.
SPOPW999  RETURN
.
.------------------------------------------------------------------------
.         Move work variables to ABF Non Admitted PW file variables
.------------------------------------------------------------------------
MVOTPW00  MATCH     OTPWO001,SP70
          IF        !@EQUAL
            MOVE      OTPWO001,OTPWCNTR
          ENDIF
.
          MATCH     OTPWO002,SP70
          IF        !@EQUAL
            MOVE      OTPWO002,OTPWTIER
          ENDIF
.
          COMPARE   OTPWO003,ZERO
          IF        !@EQUAL
            MOVE      OTPWO003,OTPWPWEI
          ENDIF
.
MVOTPW99  RETURN
