. *----------------------------------------------------------------------
. * Include Name  :   OUTADLTM.PBL
. *
. * Function      :   CGI Variables for OUTADLFD - outadlaf
. *
. * Mods          :   
. *
. *       V11.00.02 02/09/2020  Jill Parkinson Task 0894534
. *                 Fixed checking of sms outletaf reads to be 3 characters
. *       V11.00.01 23.03.2020  Peter Vela     TSK 0889143
. *                 Fixed OUTLET IO  calls
. *       V10.07.03 06.01.2016  Ebon Clements  TSK 0294154
. *                 Added SMS message selection list - SELSMS00
. *       V10.07.02 17/12/2015  Ebon Clements  CAR 294154
. *                 Added SMS notification functionality
. *       V10.07.01 23/10/2015  Ebon Clements  CAR 320819
. *                Added Inactive test to letter selection lists      
. *       V10.05.01 06/10/2014  Ebon Clements  CAR 268970
. *                Change to use OUTCLIFD index 1 instead of index 2
. *       V9.04.01 13.07.2005  Peter Vela CAR 63400
. *                Added tags for Clinic Code From (Code) and 
. *                Clinic Code To (Code) OTAL0000
. *       V9.03.01 23.06.2003  Davin CAR 40610
. *                Changed outpatient letter type selection list to only 
. *                show letter type (not every line of letter)
. *       V9.02.02 11.04.2003  Tonii CAR 35446
. *                Moved Z70 into working variables instead of spaces
. *                Removed "#" when creating a selection list
. *       V9.02.01 10.10.2001 Kuldeep Singh 
. *                Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for Adhoc letter 
.------------------------------------------------------------------------
CPOTAL00  MOVE      Z70,OTAL0001
          MOVE      Z70,OTAL0002 
          MOVE      Z70,OTAL0003
          MOVE      Z70,OTAL0004
          MOVE      Z70,OTAL0005
          MOVE      Z70,OTAL0006
          MOVE      Z70,OTAL0007
          MOVE      Z70,OTAL0008
          MOVE      Z70,OTAL0009
          MOVE      Z70,OTAL0010
          MOVE      Z70,OTAL0011
          MOVE      Z70,OTAL0012
          MOVE      Z70,OTAL0013
          MOVE      Z70,OTAL0014
          MOVE      Z70,OTAL0015
          MOVE      Z70,OTAL0016
          MOVE      Z70,OTAL0017
          MOVE      Z70,OTAL0018
          MOVE      Z70,OTAL0019
          MOVE      Z70,OTAL0020
          MOVE      Z70,OTAL0021
          MOVE      Z70,OTAL0022
          MOVE      Z70,OTAL0023
.
CPOTAL99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Adhoc selection file
.------------------------------------------------------------
SPOTAL00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPOTAL01,SPOTAL02,SPOTAL03,SPOTAL04,SPOTAL05:
                       SPOTAL06,SPOTAL07,SPOTAL08,SPOTAL09,SPOTAL10:
                       SPOTAL11,SPOTAL12,SPOTAL13,SPOTAL14,SPOTAL15:
                       SPOTAL16,SPOTAL17,SPOTAL18,SPOTAL19,SPOTAL20:
                       SPOTAL21,SPOTAL22,SPOTAL23
.
          MOVE      ONE,EXIT
          GOTO      SPOTAL99
.
SPOTAL01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,OTAL0001
          PACK      OTAL0001,OTAL0001,SP70
          GOTO      SPOTAL99
.
SPOTAL02  MOVE      QRYDATA,OTAL0002
          GOTO      SPOTAL99
.
SPOTAL03  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPOTAL99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTAL0003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPOTAL99 
.
SPOTAL04  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPOTAL99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTAL0004,CCENT,CYEAR,CMON,CDAY 
          GOTO      SPOTAL99
.
SPOTAL05  MOVE      QRYDATA,OTAL0005 
          GOTO      SPOTAL99
.
SPOTAL06  MOVE      QRYDATA,OTAL0006 
          GOTO      SPOTAL99
.
SPOTAL07  MOVE      QRYDATA,OTAL0007 
          GOTO      SPOTAL99
.
SPOTAL08  MOVE      QRYDATA,OTAL0008 
          GOTO      SPOTAL99
.
SPOTAL09  MOVE      QRYDATA,OTAL0009
          GOTO      SPOTAL99
.
SPOTAL10  MOVE      QRYDATA,OTAL0010
          GOTO      SPOTAL99
.
SPOTAL11  MOVE      QRYDATA,OTAL0011
          GOTO      SPOTAL99
.
SPOTAL12  MOVE      QRYDATA,OTAL0012 
          GOTO      SPOTAL99
.
SPOTAL13  MOVE      QRYDATA,OTAL0013
          GOTO      SPOTAL99
.
SPOTAL14  MOVE      QRYDATA,OTAL0014
          GOTO      SPOTAL99
.
SPOTAL15  MOVE      QRYDATA,OTAL0015 
          GOTO      SPOTAL99
.
SPOTAL16  MOVE      QRYDATA,OTAL0016 
          GOTO      SPOTAL99
.
SPOTAL17  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPOTAL99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTAL0017,CCENT,CYEAR,CMON,CDAY 
          GOTO      SPOTAL99
.
SPOTAL18  PACK      QRYDATA,QRYDATA,SP70
          MATCH     SP70,QRYDATA
          GOTO      SPOTAL99 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTAL0018,CCENT,CYEAR,CMON,CDAY 
          GOTO      SPOTAL99
.
SPOTAL19  MOVE      QRYDATA,OTAL0019
          GOTO      SPOTAL99
.
SPOTAL20  MOVE      QRYDATA,OTAL0020
          GOTO      SPOTAL99
.
SPOTAL21  MOVE      QRYDATA,OTAL0021
          GOTO      SPOTAL99
.
SPOTAL22  MOVE      QRYDATA,OTAL0022
          GOTO      SPOTAL99
.
SPOTAL23  MOVE      QRYDATA,OTAL0023
          GOTO      SPOTAL99
.
SPOTAL99  RETURN
.------------------------------------------------------------
. Clear Letter selection variables Variables
.------------------------------------------------------------
CLOTAL00  MOVE      SP70,OTALSEID           * Selection ID.
          MOVE      SP70,OTALSEDC           * Selection Description
          MOVE      SP70,OTALBDFR           * Booking Date Fron (ccyymmdd)
          MOVE      SP70,OTALBDTO           * Booking Date To (ccyymmdd)
          MOVE      SP70,OTALBKTY           * Booking Type Code
          MOVE      SP70,OTALSIFR           * Site Code From
          MOVE      SP70,OTALSITO           * Site Code To
          MOVE      SP70,OTALCLFR           * Clinic Code From
          MOVE      SP70,OTALCLTO           * Clinic Code To
          MOVE      SP70,OTALSTFR           * Session Time From (HH:MM)
          MOVE      SP70,OTALSTTO           * Session Time To (HH:MM)
          MOVE      SP70,OTALURFR           * U/R Number From
          MOVE      SP70,OTALURTO           * U/R Number To
          MOVE      SP70,OTALDPYN           * Deceased Patients - Yes or No?
          MOVE      SP70,OTALVTFR           * Visit Type From (category CV)
          MOVE      SP70,OTALVTTO           * Visit Type To (category CV)
          MOVE      SP70,OTALMDFR           * Booking Made Date From (ccyymmdd)
          MOVE      SP70,OTALMDTO           * Booking Made Date To (ccyymmdd)
          MOVE      SP70,OTALCTFR           * Clinic Type From
          MOVE      SP70,OTALCTTO           * Clinic Type To
          MOVE      SP70,OTALOCFR           * Outcome Code From (category OZ)
          MOVE      SP70,OTALOCTO           * Outcome Code To (category OZ)
          MOVE      SP70,OTALLTYP           * Out letter to print
.
CLOTAL99  RETURN
.------------------------------------------------------------
. Add Adhoc Letter Fields
.------------------------------------------------------------
OTAL0000  BRANCH    FLDITMNO,OTAL0100,OTAL0200,OTAL0300,OTAL0400,OTAL0500:
                             OTAL0600,OTAL0700,OTAL0800,OTAL0900,OTAL1000:
                             OTAL1100,OTAL1200,OTAL1300,OTAL1400,OTAL1500:
                             OTAL1600,OTAL1700,OTAL1800,OTAL1900,OTAL2000:
                             OTAL2100,OTAL2200,OTAL2300,OTAL2400,OTAL2500:
                             OTAL2600,OTAL2700
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OTAL9999
.
OTAL0100  WRITE     HTMLFILE;OTALSEID;
          GOTO      OTAL9999
.
OTAL0200  WRITE     HTMLFILE;OTALSEDC;
          GOTO      OTAL9999
.
OTAL0300  MATCH     OTALBDFR,SP70
          GOTO      OTAL9999 IF EQUAL
          UNPACK    OTALBDFR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      OTAL9999 
.
OTAL0400  MATCH     OTALBDTO,SP70
          GOTO      OTAL9999 IF EQUAL
          UNPACK    OTALBDTO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      OTAL9999 
.
OTAL0500  WRITE     HTMLFILE;OTALBKTY;
          GOTO      OTAL9999 
.
OTAL0600  MOVE      OTALSIFR,OUTSIT01 
          CALL      SELSIT00 
          GOTO      OTAL9999 
.
OTAL0700  MOVE      OTALSITO,OUTSIT01 
          CALL      SELSIT00 
          GOTO      OTAL9999
.
OTAL0800  MOVE      OTALCLFR,OUTCLI01 
          CALL      SELCLI00
          GOTO      OTAL9999
.
OTAL0900  MOVE      OTALCLTO,OUTCLI01 
          CALL      SELCLI00 
          GOTO      OTAL9999
.
OTAL1000  WRITE     HTMLFILE;OTALSTFR; 
          GOTO      OTAL9999
.
OTAL1100  WRITE     HTMLFILE;OTALSTTO; 
          GOTO      OTAL9999
.
OTAL1200  WRITE     HTMLFILE;OTALURFR; 
          GOTO      OTAL9999
.
OTAL1300  WRITE     HTMLFILE;OTALURTO; 
          GOTO      OTAL9999
.
OTAL1400  WRITE     HTMLFILE;OTALDPYN; 
          GOTO      OTAL9999
.
OTAL1500  MOVE      "CV",CATEGORY
          MOVE      OTALVTFR,CODE
          CALL      CODITM00 
          GOTO      OTAL9999
.
OTAL1600  MOVE      "CV",CATEGORY
          MOVE      OTALVTTO,CODE
          CALL      CODITM00 
          GOTO      OTAL9999
.
OTAL1700  MATCH     OTALMDFR,SP70
          GOTO      OTAL9999 IF EQUAL
          UNPACK    OTALMDFR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR 
          GOTO      OTAL9999
.
OTAL1800  MATCH     OTALMDTO,SP70
          GOTO      OTAL9999 IF EQUAL
          UNPACK    OTALMDTO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR 
          GOTO      OTAL9999
.
OTAL1900  MOVE      OTALCTFR,CLINICTY
          CALL      SELCLT00 
          GOTO      OTAL9999
.
OTAL2000  MOVE      OTALCTTO,CLINICTY
          CALL      SELCLT00 
          GOTO      OTAL9999
.
OTAL2100  MOVE      "OZ",CATEGORY
          MOVE      OTALOCTO,CODE
          CALL      CODITM00 
          GOTO      OTAL9999
.
OTAL2200  MOVE      "OZ",CATEGORY
          MOVE      OTALOCTO,CODE
          CALL      CODITM00 
          GOTO      OTAL9999
.
OTAL2300  CALL      OTATAB00
          GOTO      OTAL9999
. 
OTAL2400  CALL      SELOLT00
          GOTO      OTAL9999
.
OTAL2500  WRITE     HTMLFILE;OTALCLFR;
          GOTO      OTAL9999
.
OTAL2600  WRITE     HTMLFILE;OTALCLTO;
          GOTO      OTAL9999
. 
OTAL2700  CALL      SELSMS00
          GOTO      OTAL9999
.
OTAL9999  RETURN
.------------------------------------------------------------
.  move CGI variable to file variable 
.------------------------------------------------------------
MVOTAL00  MATCH     Z70,OTAL0001
          IF        !@EQUAL
            MOVE      OTAL0001,OTALSEID
          ENDIF
.
          MATCH     Z70,OTAL0002
          IF        !@EQUAL
            MOVE      OTAL0002,OTALSEDC
          ENDIF
.
          MATCH     Z70,OTAL0003
          IF        !@EQUAL
            MOVE      OTAL0003,OTALBDFR
          ENDIF
.
          MATCH     Z70,OTAL0004
          IF        !@EQUAL
            MOVE      OTAL0004,OTALBDTO
          ENDIF
.
          MATCH     Z70,OTAL0005
          IF        !@EQUAL
            MOVE      OTAL0005,OTALBKTY
          ENDIF
.
          MATCH     Z70,OTAL0006
          IF        !@EQUAL
            MOVE      OTAL0006,OTALSIFR
          ENDIF
.
          MATCH     Z70,OTAL0007
          IF        !@EQUAL
            MOVE      OTAL0007,OTALSITO
          ENDIF
.
          MATCH     Z70,OTAL0008
          IF        !@EQUAL
            MOVE      OTAL0008,OTALCLFR
          ENDIF
.
          MATCH     Z70,OTAL0009
          IF        !@EQUAL
            MOVE      OTAL0009,OTALCLTO
          ENDIF
.
          MATCH     Z70,OTAL0010
          IF        !@EQUAL
            MOVE      OTAL0010,OTALSTFR
          ENDIF
.
          MATCH     Z70,OTAL0011
          IF        !@EQUAL
            MOVE      OTAL0011,OTALSTTO
          ENDIF
.
          MATCH     Z70,OTAL0012
          IF        !@EQUAL
            MOVE      OTAL0012,OTALURFR
          ENDIF
.
          MATCH     Z70,OTAL0013
          IF        !@EQUAL
            MOVE      OTAL0013,OTALURTO
          ENDIF
.
          MATCH     Z70,OTAL0014
          IF        !@EQUAL
            MOVE      OTAL0014,OTALDPYN
          ENDIF
.
          MATCH     Z70,OTAL0015
          IF        !@EQUAL
            MOVE      OTAL0015,OTALVTFR
          ENDIF
.
          MATCH     Z70,OTAL0016
          IF        !@EQUAL
            MOVE      OTAL0016,OTALVTTO
          ENDIF
.
          MATCH     Z70,OTAL0017
          IF        !@EQUAL
            MOVE      OTAL0017,OTALMDFR
          ENDIF
.
          MATCH     Z70,OTAL0018
          IF        !@EQUAL
            MOVE      OTAL0018,OTALMDTO
          ENDIF
.
          MATCH     Z70,OTAL0019
          IF        !@EQUAL
            MOVE      OTAL0019,OTALCTFR
          ENDIF
.
          MATCH     Z70,OTAL0020
          IF        !@EQUAL
            MOVE      OTAL0020,OTALCTTO
          ENDIF
.
          MATCH     Z70,OTAL0021
          IF        !@EQUAL
            MOVE      OTAL0021,OTALOCFR
          ENDIF
.
          MATCH     Z70,OTAL0022
          IF        !@EQUAL
            MOVE      OTAL0022,OTALOCTO
          ENDIF
.
          MATCH     Z70,OTAL0023
          IF        !@EQUAL
            MOVE      OTAL0023,OTALLTYP
          ENDIF
.
MVOTAL99  RETURN
.------------------------------------------------------------
. List of Adhoc lists
.------------------------------------------------------------
OTATAB00  MOVE      SP70,KEY4
          CALL      RSOTADL1
OTATAB10  CALL      RKOTADL1
          BRANCH    OVRCD,OTATAB99
.
          CLEAR     HTMLLINK
          APPEND    "javascript:UpdateItem('",HTMLLINK
          APPEND    OTALSEID,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
.
          MATCH     OTALBDFR,SP70
          IF        @EQUAL
            PACK      PMLDAT01,SP1
          ELSE
            UNPACK    OTALBDFR,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      PMLDAT01,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          MATCH     OTALBDTO,SP70
          IF        @EQUAL
            PACK      PMLDAT02,SP1
          ELSE
            UNPACK    OTALBDTO,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      PMLDAT02,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",OTALSEID,"#",":
                             "#"",OTALSEDC,"#",":
                             "#"",PMLDAT01,"#",":
                             "#"",PMLDAT02,"#");"
.
          GOTO      OTATAB10
.
OTATAB99  RETURN
.
.------------------------------------------------------------
. Sites Selection
.------------------------------------------------------------
SELSIT00  PACK      KEY6,SP70
          CALL      RDSSITA1
SELSIT10  CALL      RDKSITA1
          BRANCH    OVRCD,SELSIT99
.
          PACK      KEY25,OSTDESC,SP20
          PACK      KEY8,QUOTE,OSTSITE,QUOTE
.
          MATCH     OSTSITE,OUTSIT01
          IF        @EQUAL
             WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                       "(",OSTSITE,") ",KEY25,"</option>"
          ELSE
             WRITE     HTMLFILE;"<option value=",KEY8,">":
                       "(",OSTSITE,") ",KEY25,"</option>"
          ENDIF
.
          GOTO      SELSIT10
.
SELSIT99  RETURN
.------------------------------------------------------------
. Clinic Selection
.------------------------------------------------------------
SELCLI00  PACK      KEY20,SP70
          CALL      RDSCLIA1
SELCLI10  CALL      RDKCLIA1
          BRANCH    OVRCD,SELCLI99
.
.         A clinic id has been found, so get the latest record to display
.
          PACK      KEY20,OCASITE,OCACLIN,Z70
          CALL      RDSCLIA1
SELCLI20  CALL      RDPCLIA1
          BRANCH    OVRCD,SELCLI99
.
          MOVE      SP30,KEY25           * initialise doctor name
          MATCH     SP6,OCADOCT
          IF        @EQUAL
            MOVE      OCACLIN,DCODE
            PACK      KEY25,OCADESC
            GOTO      SELCLI30
          ENDIF
.
          MOVE      OCADOCT,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD,SELCLI30
.
          MOVE      DTITL,PACTITLE
          MOVE      DGNAME,PACGNAME
          MOVE      DSNAME,PACSNAME
          MOVE      ONE,PACFRMT
          CALL      PACNAME
          PACK      KEY25,PACFNAME
.
SELCLI30  PACK      KEY8,QUOTE,DCODE,QUOTE
.
          MATCH     DCODE,OUTCLI01 
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                      "(",DCODE,") ",KEY25,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">":
                      "(",DCODE,") ",KEY25,"</option>"
          ENDIF
          GOTO      SELCLI10
.
SELCLI99  RETURN
.
.------------------------------------------------------------
. Clinic Option List
.------------------------------------------------------------
SELCLT00  PACK      KEY42,WBSESIT,SP70
          CALL      RDSCTYA2
SELCLT10  CALL      RDKCTYA2
          BRANCH    OVRCD,SELCLT99
          MATCH     OCTSITE,WBSESIT
          GOTO      SELCLT99 IF NOT EQUAL
          MATCH     "1",OCTACT
          GOTO      SELCLT10 IF EQUAL
          MATCH     CLINICTY,OCTCTYP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",OCTCTYP," selected>":
                               OCTDESC,"</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",OCTCTYP,">":
                               OCTDESC,"</option>";
          ENDIF
          GOTO      SELCLT10
.
SELCLT99  RETURN
.
.------------------------------------------------------------
. Outpatient Letter Types
.------------------------------------------------------------
SELOLT00  MOVE      ZERO,OTLTLINO
          PACK      KEY6,OTLTLINO,SP70
          CALL      RSOTLET2
SELOLT10  CALL      RKOTLET2
          BRANCH    OVRCD,SELOLT99
.
          MATCH     "  0",DOTLTLIN
          GOTO      SELOLT10 IF NOT EQUAL
.
          PACK      KEY25,OTLTTEXT,SP30
          PACK      KEY8,QUOTE,DOTLTLTN,QUOTE
.
          MATCH     OTALLTYP,DOTLTLTN
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                      "(",DOTLTLTN,") ",KEY25,"</option>"
          ELSE
            MATCH     "1",OTLTACTV                 * Skip Inactive
            GOTO      SELOLT10 IF EQUAL
.
            MATCH     "1",OTLTCOMM                 * Skip if SMS   
            GOTO      SELOLT10 IF EQUAL
.
            WRITE     HTMLFILE;"<option value=",KEY8,">":
                      "(",DOTLTLTN,") ",KEY25,"</option>"
          ENDIF
.
          GOTO      SELOLT10
.
SELOLT99  RETURN
.
.
.------------------------------------------------------------
. Outpatient SMS Message list
.------------------------------------------------------------
SELSMS00  MOVE      ZERO,OTLTLINO
          PACK      KEY6,OTLTLINO,SP70
          CALL      RSOTLET2
SELSMS10  CALL      RKOTLET2
          BRANCH    OVRCD,SELSMS99
.
          MATCH     "  0",DOTLTLIN
          GOTO      SELSMS10 IF NOT EQUAL
.
          PACK      KEY25,OTLTTEXT,SP30
          PACK      KEY8,QUOTE,DOTLTLTN,QUOTE
.
          MATCH     "1",OTLTACTV                 * Skip Inactive
          GOTO      SELSMS10 IF EQUAL
.
          MATCH     "1",OTLTCOMM                 * Skip if NOT SMS
          GOTO      SELSMS10 IF NOT EQUAL
.
          WRITE     HTMLFILE;"<option value=",KEY8,">":
                    KEY25,"</option>"
.
          GOTO      SELSMS10
.
SELSMS99  RETURN
