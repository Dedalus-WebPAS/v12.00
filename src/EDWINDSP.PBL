.******************************************************************************
.* EDWINDSP - This is a routine used by IBAPMS40 to extract NSW EDWARD        *
.*            Individual Service Provider Department Data                     *
.*                                                                            *
.* PARAMETERS  :                                                              *
.* RETURNS     :                                                              *
.* Mods        :                                                              *
.* V11.04.02 14/03/2023 Ebon Clements  TSK 0944290                            *
.*           Report Obj 37 ISP_ALT_ID_TYPE_CODE = 041 for HCP                 *
.*           National Registration Number if PMHCUDF3 is blank - EHDD0000     *
.*           EPRV0000 - Type 12                                               *
.* V11.04.01 14/12/2023 Ebon Clements  TSK 0933826                            *
.*           Corrected Obj 43 organisation end date when inactivating a       *
.*           practice - EIPR0000                                              *
.*           Corrected Obj 42 telecommunication mode end date when            *
.*           inactivating a practice - EIPR0000, EPTL0000, EPFX0000 and       *
.*           EPEM0000                                                         *
.* V11.03.04 16/11/2023 Sunny          TSK 0916075                            *
.*           Fixed AHPRA ID Changes - EPRV0000                                *
.* V11.03.03 10/11/2023 Sunny          TSK 0916075                            *
.*           Fixed AHPRA ID Changes when blank EHDD0000                       *
.* V11.03.02 12/10/2023 Sunny          TSK 0916075                            *
.*           Added check for Stafflink ID, AHPRA ID Changes                   *
.* V11.03.01 11/08/2023 Sunny          TSK 0916075                            *
.*           Added AHPRA Type (PMHCUDF3) and Stafflink                        *
.* V11.02.01 22/08/2022 Ebon Clements  Tsk 0922786                            *
.*           Report PAEDIATRIC_SPECIALTY_FLAG cat DT ind 2 - Default value N  *
.*           obj 33                                                           *
.* V11.01.02 28/09/2021 Ebon Clements  Tsk 0899679                            *
.*           Write add practice organsication obj 43 - EPRA2000 and EIPR0000  *
.*           EPTL7000, EIPR8000, EPRA3000, EPFX7000 and EPEM7000              *
.*           Write add practice telecommunication obj 42                      *
.*           EPRA1000, EIPR8000 and EPAD8000                                  *
.*           Write add practice name obj 40 - EPRA2000                        *
.*           EPRA1000, EIPR8000 and EPAD8000                                  *
.*           Write add, change and inactivate practice address obj 38         *
.*           EPRA1000, EIPR8000 and EPAD8000                                  *
.*           Write add practice and inactivate practice obj 32                *
.*           EIPR8000 - EPRA0000                                              *
.* V11.01.01 21/09/2021 Ebon Clements  Tsk 0899679                            *
.*           Report HCP primary speciality 1 for all attending type HCP codes *
.*           EHBB0000 and EHCC0000                                            *
.* V11.00.03 10/08/2020 Ebon Clements  Tsk 0895726                            *
.*           Fixed Repeat remove leading 3 alph characters infinite loop      *
.* V11.00.02 10/08/2020 Ebon Clements  Tsk 0895726                            *
.*           Repeat remove leading 3 alph characters from the provider number *
.*           to ensure ISP_ALT_ID_RECORD_ID doesn't exceed 20 characters.     *
.*           Obj 37, EHDD0000, EPRV0000, EPAC0000 and EPPV0000                *
.* V11.00.01 10/08/2020 Ebon Clements  Tsk 0895726                            *
.*           Remove leading 3 alph characters from the provider number        *
.*           to ensure ISP_ALT_ID_RECORD_ID doesn't exceed 20 characters.     *
.*           Obj 37, EHDD0000, EPRV0000, EPAC0000 and EPPV0000                *
.* V10.15.03 05/02/2020 Ebon Clements  Tsk 0888002                            *
.*           Don't end date previous gender record when gender changes. Send  *
.*           and update record with a new source modifed date - EGND0000      *
.* V10.15.02 27/11/2019 Ebon Clements  Tsk 0885257                            *
.*           Use trigger date as effectice from date - EPTL0000               *
.* V10.15.01 20/11/2019 Ebon Clements  Tsk 0884982                            *
.*           Use trigger date/time for source created/modified date/time      *
.*           Obj 38 - EPAD0000, Obj 42 EPTL0000, EPFX0000, EPEM0000, Obj 32   *
.*           EGND0000                                                         *
.* V10.14.12 01/10/2019 Ebon Clements  Tsk 0882197                            *
.*           Removed SQUEEZE of PMHCHCPC                                      *
.* V10.14.11 12/09/2019 Ebon Clements  Tsk 0881147                            *
.*           Added effective start date to ISP_ADDRESS_RECORD_ID              *
.* V10.14.10 05/09/2019 Ebon Clements  Tsk 0881147                            *
.*           Added ISP trigger 23 - GP add speciality.                        *
.*           Changed CSOF0000 calls to LSOF0000                               *
.* V10.14.09 07/05/2019 Ebon Clements  Tsk 0874075                            *
.*           Fixed Obj 33,34,38 & 42 effective start and end dates            *
.* V10.14.08 15/04/2019 Ebon Clements  Tsk 0873156                            *
.*           Read cat DT instead of AC for speciality from doctor units       *
.*           Use trigger date as source modified date - Obj 38 - EPAD0000     *
.* V10.14.07 03/04/2019 Ebon Clements  Tsk 0872690                            *
.*           Chaged Obj 37 provider id change record source modified          *
.*           date/time to be the trigger date time EPRV0000 EPPV0000          *
.*           End date Obj 34 when deleting a HPC unit - EUND0000              *
.*           Changed obj 38 CSOF0000 calls to LSOF0000 so it will only add    *
.*           the end date to the last send object with a blank end date       *
.* V10.14.06 20/03/2019 Ebon Clements  Tsk 0871866                            *
.*           Added EFFECTIVE_END_DATE to Obj 32 - Individual provider         *
.* V10.14.05 19/03/2019 Ebon Clements  Tsk 0871780                            *
.*           Report individual provider discipline specialty for all          *
.*           HCP types OBJ 33  - EHBB0000                                     *
.*           Don't report individual provider organisation for referring      *
.*           types - EHHH0000                                                 *
.* V10.14.04 01/03/2019 Ebon Clements  Tsk 0871097                            *
.*           Added HCP Gender change functionality                            *
.* V10.14.03 01/03/2019 Ebon Clements  Tsk 0871097                            *
.*           Fixed reporting of multiple doctor units                         *
.* V10.14.02 21/02/2019 Ebon Clements  Tsk 0870899                            *
.*           Fixed reporting of attending doctor address obj 38 - EHEE0000    *
.*           Removed practice link loop to report all objects   - EHLN0000    *
.* V10.14.01 01/02/2019 Ebon Clements  Tsk 0869605                            *
.*           Fixed delete record source modifed date - OBJ 32 inactivate HCP  *
.* V10.13.04 21/01/2019 Ebon Clements  Tsk 0868909                            *
.*           ISP Audit rebounds                                               *
.* V10.13.03 10/01/2019 Ebon Clements  Tsk 0868909                            *
.*           Added ISP Audit file changes                                     *
.* V10.13.02 12/12/2018 Jill Parkinson Tsk 0867207                            *
.*           SIT 1 issues                                                     *
.* V10.13.01 30/09/2018 Jill Parkinson Tsk 0862271                            *
.*           Beta rebound document 1                                          *
.* V10.12.07 06/09/2018 Jill Parkinson Tsk 0862271                            *
.*           Changed primary keys as per CR                                   *
.* V10.12.06 08/08/2018 Jill Parkinson Tsk 0861501                            *
.*           Changed to send hospital address for hcp types other than 1,3,5,12
.* V10.12.05 20/06/2018 Ebon Clements  Task 0848318                           *
.*           Don't send blank 42 records - EHGG0000                           *
.*           Report all practice addresses - EHEE0000                         *
.* V10.12.04 14/06/2018 Ebon Clements  Task 0848318                           *
.*           Fixed post code file read - EHEE0000                             *
.* V10.12.03 28/05/2018 Ebon Clements  Task 0848318                           *
.*           Populate ISP_ALT_ID_TYPE_CODE in object 37 - EHDD0000            *
.* V10.12.02 02/05/2018 Ebon Clements  Task 0848318                           *
.*           Fixed start date EHDD0000                                        *
.* V10.12.01 26/04/2018 Ebon Clements  Task 0848318                           *
.*           Extract individual service provider details                      *
.* V10.12.00 23/01/2018 Jill Parkinson Task 0846167                           *
.*           Created include                                                  *
.******************************************************************************
EDIS0000  CALL      EHCP0000           * HCP by created
          CALL      EHCH0000           * Extract changes
.
EDIS9999  RETURN
.
+
.******************************************************************************
.* EHCP0000 - Loop pmshcpaf and extract ISP details
.******************************************************************************
EHCP0000  PACK      KEY26,STRTDATE,SP70
          CALL      RSPMHCP5
EHCP1000  CALL      RKPMHCP5                * Loop HCP file 
          BRANCH    OVRCD,EHCP9999
.
          MATCH     PMHCCDTE,ENDDATE        * Date created
          GOTO      EHCP9999 IF LESS
.
          CALL      EOBJ0000                * Extract all objects
.
          GOTO      EHCP1000
.
EHCP9999  RETURN
+
.******************************************************************************
. EOBJ0000 - Extract all objects for a HCP
.******************************************************************************
EOBJ0000  CALL      EHAA0000   * 32 - Individual Provider
          CALL      EHBB0000   * 33 - Individual Provider Discipline Specialty 
          CALL      EHCC0000   * 34 - Individual Provider Specialty Practice
          CALL      EHDD0000   * 37 - Individual Provider Alternate Identifier
          CALL      EHEE0000   * 38 - Individual Provider Address
          CALL      EHFF0000   * 40 - Individual Provider Name
          CALL      EHGG0000   * 42 - Individual Provider Telecommunication mode
          CALL      EHGH0000   * 42 - Ind Provider Telecommunication Practice
          CALL      EHHH0000   * 43 - Individual Provider Organisation
.
EOBJ9999  RETURN
+
.******************************************************************************
. EHAA0000 - 32 Individual Provider 
.******************************************************************************
EHAA0000  MOVE      "32",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCDTOB,DIM8
          MOVE      PMHCSDAT,DIM8A
.
          MOVE      SP70,DIM8B              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8B      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9",DIM1      * Unknown
.
          MATCH     "M",PMHCGNDR
          IF        @EQUAL
            MOVE      "1",DIM1    * Male
          ENDIF
.
          MATCH     "F",PMHCGNDR
          IF        @EQUAL
            MOVE      "2",DIM1    * Female
          ENDIF
.
          MATCH     "I",PMHCGNDR
          IF        @EQUAL
            MOVE      "3",DIM1    * Indeterminate
          ENDIF
.
          MATCH     "U",PMHCGNDR
          IF        @EQUAL
            MOVE      "9",DIM1    * Unknown
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:   * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:          * ISP_SOURCE_ID
                             DIM10,TILDA:             * ISP_ID
                             DIM1,TILDA:              * SEX_CODE
                             TILDA:                   * COUNTRY_OF_BIRTH_CODE
                             DIM8,TILDA:              * DATE_OF_BIRTH
                             TILDA:                   * INDIGENOUS_STATUS_CODE
                             DIM8A,TILDA:             * EFFECTIVE_START_DATE
                             DIM8B:                   * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHAA9999  RETURN
+
.******************************************************************************
. EHBB0000 - 33 Individual Provider Discipline Specialty
.******************************************************************************
EHBB0000  MOVE      ONE,REPTCNTR                 * Clear value reported array
          WHILE     REPTCNTR <= 99
            MOVE      SP70,REPTARRY[REPTCNTR]    * Clear repored values array
            ADD       ONE,REPTCNTR
          DO
          MOVE      ZERO,REPTCNTR                * Clear value reported array
.      
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=7
            GOTO      EHBB5000         
          ENDIF
.
          IF        PMHCHCST=9|PMHCHCST=14|PMHCHCST=15
            GOTO      EHBB5000         
          ENDIF
.
          MATCH     SP70,PMHCLDOC           * No linked doctor code
          GOTO      EHBB5000 IF EQUAL
.
          PACK      KEY9,PMHCLDOC,SP70
          CALL      RSPMDUN1
EHBB1000  CALL      RKPMDUN1                * Get units for linked Dr code
          BRANCH    OVRCD,EHBB5000
.
          MATCH     PMHCLDOC,PMDUDOCT
          GOTO      EHBB5000 IF NOT EQUAL
.
          MOVE      "33",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMDUUNIT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      SP70,DIM10A
          MOVE      ANSN,DIM1P                  * PAEDIATRIC_SPECIALTY_FLAG
          PACK      KEY5,ANSD,ANST,PMDUUNIT,SP70   * (Use DT instead of AC)
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
.
            MATCH     ANSP,TCINDC2
            IF        @EQUAL
              MOVE      ANSY,DIM1P              * PAEDIATRIC_SPECIALTY_FLAG
            ENDIF
          ENDIF
.
          IF        REPTCNTR < 99
            ADD       ONE,REPTCNTR              * Save value as reported
            MOVE      PTCDUDF3,REPTARRY[REPTCNTR]
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          SQUEEZE   PMDUDOCT
          SQUEEZE   PMDUUNIT
          PACK      KEY20,PMDUDOCT,DASH,PMDUUNIT
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             KEY20,TILDA:            * ISP_DISC_SPEC_RECORD_ID
                             DIM10A,TILDA:           * ISP_DISC_SPEC_CODE 
                             DIM1P,TILDA:            * PAEDIATRIC_SPECIALTY_FLAG
                             DIM8,TILDA:             * EFFECTIVE_START_DATE
                             DIM8A:                  * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCLUPD,SP70
          PACK      SRMDTIME,PMHCLUPT,SP70
          CALL      WRCOND00     * write record to container detail table
          MOVE      ONE,REPORTED
          GOTO      EHBB1000
.
EHBB5000  MOVE      "33",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHCSPC1,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      SP70,DIM10A
          MOVE      ANSN,DIM1P                  * PAEDIATRIC_SPECIALTY_FLAG
          PACK      KEY5,ANSD,ANST,PMHCSPC1,SP70
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
.
            MATCH     ANSP,TCINDC2
            IF        @EQUAL
              MOVE      ANSY,DIM1P              * PAEDIATRIC_SPECIALTY_FLAG
            ENDIF
          ENDIF
.
          MOVE      ONE,F3
          WHILE     F3 <= REPTCNTR
            MATCH     PTCDUDF3,REPTARRY[F3]
            GOTO      EHBB9999 IF EQUAL          * Value already reported
            ADD       ONE,F3                     * so exit
          DO
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          SQUEEZE   PMHCSPC1
          PACK      KEY20,DIM10,DASH,PMHCSPC1
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             KEY20,TILDA:            * ISP_DISC_SPEC_RECORD_ID
                             DIM10A,TILDA:           * ISP_DISC_SPEC_CODE
                             DIM1P,TILDA:            * PAEDIATRIC_SPECIALTY_FLAG
                             DIM8,TILDA:             * EFFECTIVE_START_DATE
                             DIM8A:                  * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCLUPD,SP70
          PACK      SRMDTIME,PMHCLUPT,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHBB9999  RETURN
+
.******************************************************************************
. EHCC0000 - 34 Individual Provider Specialty Practice
.******************************************************************************
EHCC0000  MOVE      PMHCHCPC,SAVKEY10       * Save HCP Code
          MOVE      PMHCLDOC,PMHCHCPC       * Move linked Dr code over HCP code
          MOVE      "3  ",DELETSTM          * 3=ISP
          MOVE      "34 ",DELETOBJ          * Individual Prov Specialty Practice
          CALL      EIDL0000
          MOVE      SAVKEY10,PMHCHCPC       * Restore HCP code
.
          MOVE      ONE,REPTCNTR                 * Clear value reported array
          WHILE     REPTCNTR <= 99
            MOVE      SP70,REPTARRY[REPTCNTR]    * Clear repored values array
            ADD       ONE,REPTCNTR
          DO
          MOVE      ZERO,REPTCNTR                * Clear value reported array
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=7
            GOTO      EHCC5000
          ENDIF
.
          IF        PMHCHCST=9|PMHCHCST=14|PMHCHCST=15
            GOTO      EHCC5000
          ENDIF
.
          MATCH     SP70,PMHCLDOC           * No linked doctor code
          GOTO      EHCC9999 IF EQUAL
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHCC9999
          ENDIF
.
          PACK      KEY9,PMHCLDOC,SP70  
          CALL      RSPMDUN1
EHCC1000  CALL      RKPMDUN1                * Get units for linked Dr code
          BRANCH    OVRCD,EHCC5000
.
          MATCH     PMHCLDOC,PMDUDOCT
          GOTO      EHCC5000 IF NOT EQUAL
.
          MOVE      "34",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMDUUNIT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9475-001",DIM8B
          MOVE      PMDUUNIT,DIM3
.
          MOVE      SP70,DIM10A
          PACK      KEY5,ANSD,ANST,PMDUUNIT,SP70 * (Use DT instead of AC)
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
          ENDIF
.
          IF        REPTCNTR < 99
            ADD       ONE,REPTCNTR            * Save value as reported
            MOVE      PTCDUDF3,REPTARRY[REPTCNTR]
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM10A
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM3,TILDA:   * ISP_SPEC_PRAC_RECORD_ID
                             DIM10A,TILDA:       * ISP_DISC_SPEC_CODE
                             DIM8B,TILDA:        * OSP_SOURCE_ID
                             PTCNNIAI,TILDA:     * OSP_ID
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCLUPD,SP70
          PACK      SRMDTIME,PMHCLUPT,SP70
          CALL      WRCOND00     * write record to container detail table
          MOVE      ZERO,REPORTED
.
          GOTO      EHCC1000
.
EHCC5000  MOVE      "34",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHCSPC1,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9475-001",DIM8B
          MOVE      PMHCSPC1,DIM3
.
          MOVE      SP70,DIM10A
          PACK      KEY5,ANSD,ANST,PMHCSPC1,SP70
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
          ENDIF
.
          MOVE      ONE,F3
          WHILE     F3 <= REPTCNTR
            MATCH     PTCDUDF3,REPTARRY[F3]
            GOTO      EHCC9999 IF EQUAL          * Value already reported
            ADD       ONE,F3                     * so exit
          DO
.
          SQUEEZE   DIM3
          SQUEEZE   DIM10A
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM3,TILDA:   * ISP_SPEC_PRAC_RECORD_ID
                             DIM10A,TILDA:       * ISP_DISC_SPEC_CODE
                             DIM8B,TILDA:        * OSP_SOURCE_ID
                             PTCNNIAI,TILDA:     * OSP_ID
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCLUPD,SP70
          PACK      SRMDTIME,PMHCLUPT,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHCC9999  RETURN
+
.******************************************************************************
. EHDD0000 - 37 Individual Provider Alternate Identifier
.******************************************************************************
EHDD0000  MOVE      ZERO,F1
          IF        PMHCHCST=0|PMHCHCST=2|PMHCHCST=4|PMHCHCST=6|PMHCHCST=8|PMHCHCST=10|PMHCHCST=11|PMHCHCST=13|PMHCHCST=14|PMHCHCST=15
            GOTO      EHDD1000
          ENDIF
          GOTO      EHDD5000
.
EHDD1000  ADD       ONE,F1
.
          COMPARE   EIGHT,F1
          GOTO      EHDD5000 IF EQUAL
.
          MOVE      SP70,DIM20
          LOAD      DIM20,F1,PMHCPRV1,PMHCPRV2,PMHCPRV3,PMHCPRV4:
                             PMHCPRV5,PMHCNHTA,PMHCMPGN
.
          MATCH     SP70,DIM20
          GOTO      EHDD1000 IF EQUAL
.
          IF       F1<=5
            IF       F1=2
              MOVE     "049",DIM3           * Stafflink
            ELSE
              MOVE     "019",DIM3           * Medicare   
            ENDIF
          ENDIF
.
          IF       F1=6
            MOVE     "055",DIM3             * NEHTA
          ENDIF
.
          IF       F1=7
            IF       PMHCHCST=14 | PMHCHCST=15
              MOVE     "042",DIM3             * Nation Reg Number (nurse)
            ELSE
              MATCH     SP70,PMHCUDF3
              IF        !@EQUAL
                PACK     KEY5,ANSR,SEVEN,PMHCUDF3,SP70
                CALL     RDCODE1
                IF       OVRCD=0
                  MATCH     SP70,THCSCOD
                  IF        !@EQUAL
                    MOVE     THCSCOD,DIM3 
                  ELSE
                    MOVE     SP70,DIM3           * Nation Reg Number (doctor) 
                  ENDIF
                ELSE
                  MOVE     SP70,DIM3           * Nation Reg Number (doctor) 
                ENDIF    
              ELSE  
                MOVE     "041",DIM3            * Nation Reg Number (doctor)
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      "37",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    DIM20,SP70,SP70
.
          IF        F1<=5
            IF        F1=2
              MOVE      "1000910",DIM7           * Stafflink
            ELSE
              MOVE      "3003357",DIM7
            ENDIF
          ENDIF
.
          IF        F1=6
            MOVE      "3003819",DIM7
          ENDIF
.
          IF        F1=7
            MOVE      "3003818",DIM7
          ENDIF
.        
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
          MOVE      SP70,DIM8A
.
. If any of the privider numbers are greater that 10 characters and start
. with 3 alpha characters. Remove the 3 alpha characters for reporting in
. ISP_ALT_ID_RECORD_ID as it's ony 20 characters (HCP Code + provider Number)
.
          MOVE      DIM20,DIM20A
EHDD1500  MOVE      ZERO,F2
          SQUEEZE   DIM20A
          MOVELPTR  DIM20A,F2
          IF        F2>10
            UNPACK    DIM20A,DIM3A,DIM17
            TYPE      DIM3A
            IF        !@EQUAL
              PACK     DIM20A,DIM17,SP70
              GOTO     EHDD1500
            ENDIF
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM7
          PACK      DIM8,PMHCLUPD,SP70
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM20
          SQUEEZE   DIM20A
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM20A,TILDA:     * ISP_ALT_ID_RECORD_ID
                             DIM3,TILDA:             * ISP_ALT_ID_TYPE_CODE
                             DIM7,TILDA:    * ISP_ALT_ID_ISSUING_AUTHORITY 
                             DIM20,TILDA:   * ISP_ALT_ID
                             TILDA:         * MEDICARE_SPECIALTY_CODE
                             DIM8,TILDA:    * EFFECTIVE_START_DATE
                             SP70:          * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHDD1000
.
EHDD5000  PACK      KEY20,PMHCHCPC,SP70
          CALL      RSPMHCL1
EHDD6000  CALL      RKPMHCL1                 * Get first linked practice
          BRANCH    OVRCD,EHDD9999
.
          MATCH     PMHCHCPC,PMHLHCPC        * Correct HCP
          GOTO      EHDD9999 IF NOT EQUAL
.
          MOVE      PMHLPRV1,DIM20           * Link practice provider number
.
          MATCH     SP70,DIM20
          GOTO      EHDD6000 IF EQUAL
.
          MOVE      "019",DIM3                * Medicare
.
          MOVE      "37",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHLHCPR,DIM20,SP70,SP70
.
          MOVE      "3003357",DIM7
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
          MOVE      SP70,DIM8A
.
. If any of the privider numbers are greater that 10 characters and start
. with 3 alpha characters. Remove the 3 alpha characters for reporting in
. ISP_ALT_ID_RECORD_ID as it's ony 20 characters (HCP Code + provider Number)
.
          MOVE      DIM20,DIM20A
EHDD6500  MOVE      ZERO,F2
          SQUEEZE   DIM20A
          MOVELPTR  DIM20A,F2
          IF        F2>10
            UNPACK    DIM20A,DIM3A,DIM17
            TYPE      DIM3A
            IF        !@EQUAL
              PACK     DIM20A,DIM17,SP70
              GOTO     EHDD6500
            ENDIF
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM7
          PACK      DIM8,PMHCLUPD,SP70
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM20
          SQUEEZE   DIM20A
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM20A,TILDA:    * ISP_ALT_ID_RECORD_ID
                             DIM3,TILDA:             * ISP_ALT_ID_TYPE_CODE
                             DIM7,TILDA:    * ISP_ALT_ID_ISSUING_AUTHORITY
                             DIM20,TILDA:   * ISP_ALT_ID
                             TILDA:         * MEDICARE_SPECIALTY_CODE
                             DIM8,TILDA:    * EFFECTIVE_START_DATE
                             SP70:          * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHDD6000
.
EHDD9999  RETURN
.
.******************************************************************************
. EHEE0000 - 38 Individual Provider Address                   
.******************************************************************************
EHEE0000  IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHEE0500
          ELSE
            GOTO      EHEE2000     * send hospital address
          ENDIF
.
. ** only send addresses for Referring, GP, Referring and GP or Ref. GP Other
EHEE0500  PACK      KEY20,PMHCHCPC,SP70
          CALL      RSPMHCL1
EHEE1000  CALL      RKPMHCL1                 * Get first linked practice
          BRANCH    OVRCD,EHEE9999
.
          MATCH     PMHCHCPC,PMHLHCPC        * Correct HCP
          GOTO      EHEE9999 IF NOT EQUAL
.
          PACK      KEY12,PMHLHCPR,SP70
          CALL      RSPMHCG1
          CALL      RKPMHCG1
          BRANCH    OVRCD,EHEE1000
.
          MATCH     PMHLHCPR,PMHGPRAC
          GOTO      EHEE1000 IF NOT EQUAL
.
EHEE1500  MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHLHCPR,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHLHCPR,DIM10A
          MOVE      PMHLJPDT,DIM8
          MOVE      PMHLLPDT,DIM8A
.
          MOVE      PMHGADD3,KEY45
          PACK      KEY56,PMHGPOST,KEY45,PMHGADD4,SP70
          CALL      RDIBPOS1
          IF        OVRCD=1
            MOVE      SP70,IBPOASGC
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          STRIP     PMHGADD1
          STRIP     PMHGADD2
          STRIP     PMHGADD3
          STRIP     PMHGADD4
          STRIP     PMHGPOST
          STRIP     IBPOASGC
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10A,DIM8,TILDA:      * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             PMHGADD1:
                             SP1,PMHGADD2:
                             TILDA:            * ORIGINAL_ADDRESS
                             PMHGADD3,TILDA:   * ORIGINAL_SUBURB_LOCALITY
                             PMHGPOST,TILDA:   * ORIGINAL_POSTCODE
                             PMHGADD4,TILDA:   * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHEE1000
.
EHEE2000  MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PTCNNECI,DIM10A
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          STRIP     CHADD1
          STRIP     CHADD2
          STRIP     CHPOST
.
          IF        PTCNHDPS=3
            MOVE      "VIC",D3
          ENDIF
          IF        PTCNHDPS=2
            MOVE      "NSW",D3
          ENDIF
          IF        PTCNHDPS=4
            MOVE      "QLD",D3
          ENDIF
          IF        PTCNHDPS=5
            MOVE      "SA",D3
          ENDIF
.
          STRIP     D3
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             PTCNNECI,DIM8,TILDA:    * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             CHADD1:
                             TILDA:            * ORIGINAL_ADDRESS
                             CHADD2,TILDA:     * ORIGINAL_SUBURB_LOCALITY
                             CHPOST,TILDA:     * ORIGINAL_POSTCODE
                             D3,TILDA: 
.                                              * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHEE9999  RETURN
+
.******************************************************************************
. EHFF0000 - 40 Individual Provider Name
.******************************************************************************
EHFF0000  MOVE      "40",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    ANSL,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHCSNAM
          STRIP     PMHCGNAM
          STRIP     PMHCTITL
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DASH,ZERO,ZERO:
                             TILDA:              * ISP_NAME_RECORD_ID
                             ANSL,TILDA:         * NAME_TYPE_CODE
                             PMHCSNAM,TILDA:     * FAMILY_NAME
                             PMHCGNAM,TILDA:     * GIVEN_NAME
                             TILDA:              * MIDDLE_NAMES
                             PMHCTITL,TILDA:     * NAME_TITLE
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHFF9999  RETURN
+
.******************************************************************************
. EHGG0000 - 42 Individual Provider Telecommunication mode
.******************************************************************************
EHGG0000  MATCH     SP70,PMHCSEML            * Email blank
          GOTO      EHGG1000 IF EQUAL
.
. ** only send email for Referring, GP, Referring and GP or Ref. GP Other
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHGG0500
          ENDIF
          GOTO      EHGG1000
.
EHGG0500  MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,ONE,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHCSEML
.
          PACK      DIM20,ZERO,ONE,PMHCSEML,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,ONE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHCSEML,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHGG1000
. ** send hospital numbers if not Referring,GP,Referring and GP or Ref. GP Other
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHGG1100
          ELSE
            PACK      PMHCSTEL,CHTELEB,SP70
          ENDIF
.
EHGG1100  MATCH     SP70,PMHCSTEL            * Telephone blank
          GOTO      EHGG2000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,TWO,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHCSTEL
.
          PACK      DIM20,ZERO,TWO,PMHCSTEL,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,TWO,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHCSTEL,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHGG2000
. ** send hospital numbers if not Referring,GP,Referring and GP or Ref. GP Other
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHGG2100
          ELSE
            PACK      PMHCFAXN,PTCNHFAX,SP70
          ENDIF
.
EHGG2100  MATCH     SP70,PMHCFAXN            * Fax blank
          GOTO      EHGG9999 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,THREE,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHCFAXN
.
          PACK      DIM20,ZERO,THREE,PMHCFAXN,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,THREE,TILDA: * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHCFAXN,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHGG9999  RETURN
+
.******************************************************************************
. EHGH0000 - 42 Individual Provider Telecommunication mode
.******************************************************************************
EHGH0000  IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHGH0500
          ENDIF
          GOTO      EHGH9999
.
.** only send for Referring, GP, Referring and GP or Ref. GP Other
.
EHGH0500  PACK      KEY20,PMHCHCPC,SP70
          CALL      RSPMHCL1
EHGH1000  CALL      RKPMHCL1                 * Get linked practice code
          BRANCH    OVRCD,EHGH9999
.
          MATCH     PMHCHCPC,PMHLHCPC        * Correct HCP
          GOTO      EHGH9999 IF NOT EQUAL
.
          PACK      KEY12,PMHLHCPR,SP70
          CALL      RSPMHCG1
          CALL      RKPMHCG1                 * Read linked practice 
          BRANCH    OVRCD,EHGH1000
.
          MATCH     PMHLHCPR,PMHGPRAC
          GOTO      EHGH1000 IF NOT EQUAL
.
          MATCH     SP70,PMHGPEML            * Practice Email Address
          GOTO      EHGH2000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,ONE,PMHGPRAC,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPEML
.
          PACK      DIM20,ZERO,ONE,PMHGPRAC,PMHGPEML,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,ONE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPEML,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHGCDTE,SP70
          PACK      SRCRTIME,PMHGCTIM,SP70
          PACK      SRMDDATE,PMHGCDTE,SP70
          PACK      SRMDTIME,PMHGCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHGH2000  MATCH     SP70,PMHGPTEL            * Practice Telephone Number
          GOTO      EHGH3000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,TWO,PMHGPRAC,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGPTEL
.
          PACK      DIM20,ZERO,TWO,PMHGPRAC,PMHGPTEL,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,TWO,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPTEL,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHGCDTE,SP70
          PACK      SRCRTIME,PMHGCTIM,SP70
          PACK      SRMDDATE,PMHGCDTE,SP70
          PACK      SRMDTIME,PMHGCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHGH3000  MATCH     SP70,PMHGPFAX            * Practice Fax Number
          GOTO      EHGH1000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,THREE,PMHGPRAC,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGPFAX
.
          PACK      DIM20,ZERO,THREE,PMHGPRAC,PMHGPFAX,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,THREE,TILDA: * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPFAX,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHGCDTE,SP70
          PACK      SRCRTIME,PMHGCTIM,SP70
          PACK      SRMDDATE,PMHGCDTE,SP70
          PACK      SRMDTIME,PMHGCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHGH1000
.
EHGH9999  RETURN
+
.******************************************************************************
. EHHH0000 - 43 Individual Provider Organisation
.******************************************************************************
EHHH0000  IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHHH9999
          ENDIF
.
          MOVE      "43",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCHCPC,DIM10A

          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9475-001",DIM8B
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10A,TILDA:       * ISP_OSP_RECORD_ID
                             DIM8B,TILDA:        * OSP_SOURCE_ID
                             PTCNNIAI,TILDA:     * OSP_ID
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EHHH9999  RETURN
.
.******************************************************************************
.* EIDL0000 - Send delete records for object X for this HCP
.******************************************************************************
EIDL0000  PACK      KEY13,ZERO,THREE,FIVE,PMHCHCPC,SP70
.
          PACK      KEY112,DELETSTM,DELETOBJ,KEY13,SP70
          CALL      RSCMEWD2
EIDL1000  CALL      RKCMEWD2
          BRANCH    OVRCD,EIDL9999
.
          MATCH     DELETSTM,CMEWDSTR            * 3 = ISP
          GOTO      EIDL9999 IF NOT EQUAL
.
          MATCH     DELETOBJ,CMEWOBJT            * Correct Object
          GOTO      EIDL9999 IF NOT EQUAL
.
          MATCH     KEY13,CMEWOKEY               * First 13 chars is 035 plus
          GOTO      EIDL9999 IF NOT EQUAL        * the HCP code
.
          MATCH     "D",CMEWRTYP                 * Skip deletes
          GOTO      EIDL1000 IF EQUAL
.
          MOVE      CMEWOBJT,OBJECTTY            * Object
          PACK      OBJECTKY,CMEWOKEY,SP70       * Key
          PACK      OBJECTTX,CMEWTEXT,SP900      * Text
.
          MOVE      ANSD,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EIDL1000
.
EIDL9999  RETURN
.
.******************************************************************************
.* EHCH0000 - Send any ISP extract audit changes
.******************************************************************************
EHCH0000  PACK      KEY41,STRTDATE,SP70
          CALL      RSPMIDW1
EHCH1000  CALL      RKPMIDW1                * Loop audit change file
          BRANCH    OVRCD,EHCH9999
.
          MATCH     PMIWCDAT,ENDDATE        * Date created
          GOTO      EHCH9999 IF LESS
.
          MATCH     "01 ",PMIWTYPE          * HCP Name Change
          IF        @EQUAL
            CALL      ENAM0000
          ENDIF
.
          MATCH     "02 ",PMIWTYPE          * HCP Practice Address Change
          IF        @EQUAL
            CALL      EPAD0000
          ENDIF
.
          MATCH     "03 ",PMIWTYPE          * HCP Practice Telephone No. Change
          IF        @EQUAL
            CALL      EPTL0000
          ENDIF
.
          MATCH     "04 ",PMIWTYPE          * HCP Link Provider No. Change
          IF        @EQUAL
            CALL      EPPV0000
          ENDIF
.
          MATCH     "05 ",PMIWTYPE          * HCP Added to Practice 
          IF        @EQUAL
            CALL      EPAC0000
          ENDIF
.
          MATCH     "06 ",PMIWTYPE          * HCP Inactivate From Practice 
          IF        @EQUAL
            CALL      EHIP0000
          ENDIF
.
          MATCH     "07 ",PMIWTYPE          * Inactivate Practice 
          IF        @EQUAL
            CALL      EIPR0000
          ENDIF
.
          MATCH     "08 ",PMIWTYPE          * HCP Unit Add
          IF        @EQUAL
            CALL      EUNA0000
          ENDIF
.
          MATCH     "09 ",PMIWTYPE          * HCP Unit Deleted
          IF        @EQUAL
            CALL      EUND0000
          ENDIF
.
          MATCH     "10 ",PMIWTYPE          * HCP made Inactive
          IF        @EQUAL
            CALL      EACT0000
          ENDIF
.
          MATCH     "11 ",PMIWTYPE          * HCP Provider Number Change
          IF        @EQUAL
            CALL      EPRV0000
          ENDIF
.
          MATCH     "12 ",PMIWTYPE          * HCP National Ref No. Number Change
          IF        @EQUAL
            CALL      EPRV0000
          ENDIF
.
          MATCH     "13 ",PMIWTYPE          * HCP Practice Added
          IF        @EQUAL
            CALL      EPRA0000
          ENDIF
.
          MATCH     "14 ",PMIWTYPE          * HCP end date added
          IF        @EQUAL
            CALL      EACT0000
          ENDIF
.
          MATCH     "15 ",PMIWTYPE          * HCP end date removed
          IF        @EQUAL
            UNPACK    PMIWCODE,PMHCHCPC       * Set HCP code from audit
            PACK      KEY10,PMHCHCPC,SP70
            CALL      RDPMHCP1
            BRANCH    OVRCD,EHCH1000
            CALL      EOBJ0000                * Extract all objects
          ENDIF
.
          MATCH     "16 ",PMIWTYPE          * HCP NEHTA Number Change
          IF        @EQUAL
            CALL      EPRV0000
          ENDIF
.
          MATCH     "17 ",PMIWTYPE          * HCP Practice Fax Num. Change
          IF        @EQUAL
            CALL      EPFX0000
          ENDIF
.
          MATCH     "18 ",PMIWTYPE          * HCP Practice Email Change
          IF        @EQUAL
            CALL      EPEM0000
          ENDIF
.
          MATCH     "19 ",PMIWTYPE          * Hospital Address Change
          IF        @EQUAL
            CALL      EHAD0000
          ENDIF
.
          MATCH     "20 ",PMIWTYPE          * Hospital Phone Number Change
          IF        @EQUAL
            CALL      EHPH0000
          ENDIF
.
          MATCH     "21 ",PMIWTYPE          * Hospital Fax Number Change
          IF        @EQUAL
            CALL      EHFX0000
          ENDIF
.
          MATCH     "22 ",PMIWTYPE          * HCP Gender Change
          IF        @EQUAL
            CALL      EGND0000
          ENDIF
.
          MATCH     "23 ",PMIWTYPE          * HCP Speciality Change (GP)
          IF        @EQUAL
            CALL      EGPS0000            
          ENDIF
.
          MATCH     "24 ",PMIWTYPE          * Stafflink ID Change        
          IF        @EQUAL
            CALL      EPRV0000
          ENDIF
.
          MATCH     "25 ",PMIWTYPE          * AHPRA ID Change
          IF        @EQUAL
            CALL      EPRV0000
          ENDIF
.
          GOTO      EHCH1000

EHCH9999  RETURN
.
.******************************************************************************
.* ENAM0000 - Extract HCP Name Change - OBJ 40
.******************************************************************************
ENAM0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ENAM9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      ENAM9999 IF EQUAL               * HCP created date

          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "40 ",CHANGOBJ                     * Individual Prov Name
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,ANSL,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "40",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    ANSL,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
.
          MOVE      PMIWCDAT,DIM8
          UNPACK    PMIWNEWV,PMHCTITL,PMHCGNAM,PMHCSNAM
.
          MOVE      SP70,DIM8A
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHCSNAM
          STRIP     PMHCGNAM
          STRIP     PMHCTITL
.
          PACK      SAVKEY41,PMIWCDAT,PMIWCTIM:
                             PMIWCODE,PMIWTYPE,SP70 * Save current ISP audit key
          MOVE      PMIWCDAT,THISDATE       * Current ISP audit created date
          MOVE      PMIWCTIM,THISTIME       * Current ISP audit created time
.
          MOVE      ONE,F2
          PACK      KEY22,PMHCHCPC,SP70     * HCP code and spaces for type 01
          PACK      KEY41,KEY22,SP70
          CALL      RSPMIDW2
ENAM4000  CALL      RKPMIDW2
          BRANCH    OVRCD,ENAM5000
.         
          MATCH     PMIWCODE,KEY22          * Same code
          GOTO      ENAM5000 IF NOT EQUAL
.
          MATCH     "01 ",PMIWTYPE          * HCP Name Change
          GOTO      ENAM5000 IF NOT EQUAL
.
          MATCH     THISDATE,PMIWCDAT
          IF        @EQUAL
            MATCH     THISTIME,PMIWCTIM     * Exit as we have reached the
            GOTO      ENAM5000 IF EQUAL     * current ISP audit record
          ENDIF
.
          ADD       ONE,F2
          GOTO      ENAM4000
. 
ENAM5000  PACK      KEY41,SAVKEY41,SP70
          CALL      RDPMIDW1                * Re Read original record
          BRANCH    OVRCD,ENAM9999
.
          MOVE      SP70,DIM2               * New record counter
          MOVE      F2,DIM2
          REP       " 0",DIM2
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DASH,DIM2:
                             TILDA:              * ISP_NAME_RECORD_ID
                             ANSL,TILDA:         * NAME_TYPE_CODE
                             PMHCSNAM,TILDA:     * FAMILY_NAME
                             PMHCGNAM,TILDA:     * GIVEN_NAME
                             TILDA:              * MIDDLE_NAMES
                             PMHCTITL,TILDA:     * NAME_TITLE
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
ENAM9999  RETURN
.
.******************************************************************************
.* EPRV0000 - Extract Individual Provider Alternate Identifier Change - OBJ 37
.******************************************************************************
EPRV0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EPRV9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EPRV9999 IF EQUAL               * HCP created date
.
          IF        PMHCHCST=0|PMHCHCST=2|PMHCHCST=4|PMHCHCST=6|PMHCHCST=8|PMHCHCST=10|PMHCHCST=11|PMHCHCST=13|PMHCHCST=14|PMHCHCST=15
            GOTO      EPRV1000
          ENDIF
          GOTO      EPRV9999
.
EPRV1000  MATCH     "25 ",PMIWTYPE          * AHPRA ID Change
          IF        @EQUAL
            UNPACK    PMIWOLDV,DIM3,DIM20 
            GOTO      EPRV1050    
          ENDIF  
. 
          UNPACK    PMIWOLDV,DIM20                     * Old provider no
EPRV1050  MATCH     SP70,DIM20                          
          GOTO      EPRV2000 IF EQUAL
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "37 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "15",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,DIM20,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
EPRV2000  MATCH     "25 ",PMIWTYPE          * AHPRA ID Change
          IF        @EQUAL
            UNPACK    PMIWNEWV,DIM3,DIM20
            GOTO      EPRV2050
          ENDIF
.
          UNPACK    PMIWNEWV,DIM20
EPRV2050  MATCH     SP70,DIM20
          GOTO      EPRV9999 IF EQUAL
.
          MOVE      "37",OBJECTTY            * Individual Provider ident.
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    DIM20,PMIWCDAT,SP70,SP70
.
          MATCH     "11 ",PMIWTYPE          * HCP Provider Number Change
          IF        @EQUAL
            MOVE     "019",DIM3             * Medicare
          ENDIF
.
          MATCH     "16 ",PMIWTYPE          * HCP NEHTA Number Change
          IF        @EQUAL
            MOVE     "055",DIM3             * NEHTA
          ENDIF
.
          MATCH     "12 ",PMIWTYPE          * HCP National Ref Number Change
          IF        @EQUAL
            MATCH     SP70,PMHCUDF3    
            IF        !@EQUAL
              PACK     KEY5,ANSR,SEVEN,PMHCUDF3,SP70
              CALL     RDCODE1
              IF       OVRCD=0
                MOVE     THCSCOD,DIM3
              ENDIF
            ELSE
              IF       PMHCHCST=14 | PMHCHCST=15
                MOVE     "042",DIM3             * Nation Reg Number (nurse)
              ELSE
                MOVE     "041",DIM3             * Nation Reg Number (doctor)
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     "24 ",PMIWTYPE          * Stafflink ID Change
          IF        @EQUAL
            MOVE     "049",DIM3             * Stafflink
          ENDIF
.
          MATCH     "25 ",PMIWTYPE          * AHPRA ID Change
          IF        @EQUAL
            MATCH     SP70,DIM3    
            IF        !@EQUAL
              PACK     KEY5,ANSR,SEVEN,DIM3,SP70
              CALL     RDCODE1
              IF       OVRCD=0
                MOVE     THCSCOD,DIM3
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     "11 ",PMIWTYPE          * HCP Provider Number Change
          IF        @EQUAL
            MOVE      "3003357",DIM7
          ENDIF
.
          MATCH     "16 ",PMIWTYPE          * HCP NEHTA Number Change
          IF        @EQUAL
            MOVE      "3003819",DIM7
          ENDIF
.
          MATCH     "12 ",PMIWTYPE          * HCP National Ref Number Change
          IF        @EQUAL
            MOVE      "3003818",DIM7
          ENDIF
.
          MATCH     "24 ",PMIWTYPE          * Stafflink ID Change
          IF        @EQUAL
            MOVE      "1000910",DIM7
          ENDIF
.
          MATCH     "25 ",PMIWTYPE          * AHPRA ID Change 
          IF        @EQUAL
            MOVE      "3003818",DIM7
          ENDIF
.
          MOVE      PMHCHCPC,DIM10
          MOVE      SP70,DIM8A
          PACK      DIM8,PMIWCDAT,SP70
.
. If any of the privider numbers are greater that 10 characters and start
. with 3 alpha characters. Remove the 3 alpha characters for reporting in
. ISP_ALT_ID_RECORD_ID as it's ony 20 characters (HCP Code + provider Number)
.
          MOVE      DIM20,DIM20A
EPRV2500  MOVE      ZERO,F2
          SQUEEZE   DIM20A
          MOVELPTR  DIM20A,F2
          IF        F2>10
            UNPACK    DIM20A,DIM3A,DIM17
            TYPE      DIM3A
            IF        !@EQUAL
              PACK     DIM20A,DIM17,SP70
              GOTO     EPRV2500
            ENDIF
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM7
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM20
          SQUEEZE   DIM20A
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM20A,TILDA:     * ISP_ALT_ID_RECORD_ID
                             DIM3,TILDA:             * ISP_ALT_ID_TYPE_CODE
                             DIM7,TILDA:    * ISP_ALT_ID_ISSUING_AUTHORITY
                             DIM20,TILDA:   * ISP_ALT_ID
                             TILDA:         * MEDICARE_SPECIALTY_CODE
                             DIM8,TILDA:    * EFFECTIVE_START_DATE
                             SP70:          * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRV9999  RETURN
.
.******************************************************************************
.* EACT0000 - Extract HCP made inactive - Add End date to all objects
.******************************************************************************
EACT0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EACT9999
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "32 ",CHANGOBJ                     * Individual Provider
          MOVE      "14",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "33 ",CHANGOBJ                     * Provider Specialty
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHCSPC1,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "34 ",CHANGOBJ                     * Specialty Prac
          MOVE      "14",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHCSPC1,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MATCH     SP70,PMHCLDOC
          GOTO      EACT6000 IF EQUAL
.
          PACK      KEY9,PMHCLDOC,SP70
          CALL      RSPMDUN1
EACT5500  CALL      RKPMDUN1                * Get units for linked Dr code
          BRANCH    OVRCD,EACT6000
.
          MATCH     PMHCLDOC,PMDUDOCT
          GOTO      EACT6000 IF NOT EQUAL
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "33 ",CHANGOBJ                     * Provider Specialty
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMDUUNIT,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "34 ",CHANGOBJ                     * Specialty Prac
          MOVE      "14",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMDUUNIT,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.    
          GOTO      EACT5500
.
EACT6000  MOVE      ZERO,F1
EACT6500  ADD       ONE,F1
.
          COMPARE   EIGHT,F1
          GOTO      EACT7000 IF EQUAL
.
          MOVE      SP70,DIM20
          LOAD      DIM20,F1,PMHCPRV1,PMHCPRV2,PMHCPRV3,PMHCPRV4:
                             PMHCPRV5,PMHCNHTA,PMHCMPGN
.
          MATCH     SP70,DIM20
          GOTO      EACT6500 IF EQUAL
. 
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "37 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "15",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,DIM20,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
          GOTO      EACT6500
.
EACT7000  PACK      KEY20,PMHCHCPC,SP70
          CALL      RSPMHCL1
EACT7500  CALL      RKPMHCL1                 * Get first linked practice
          BRANCH    OVRCD,EACT8000
.
          MATCH     PMHCHCPC,PMHLHCPC        * Correct HCP
          GOTO      EACT8000 IF NOT EQUAL
.
          MOVE      PMHLPRV1,DIM20           * Link practice provider number
.
          MATCH     SP70,DIM20
          GOTO      EACT7500 IF EQUAL
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "37 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "15",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,DIM20,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Provider Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          GOTO      EACT7500
.
EACT8000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Provider Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "40 ",CHANGOBJ                     * Individual Prov Name
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,ONE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,TWO,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,THREE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "43 ",CHANGOBJ                     * Provider Organisation
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
EACT9999  RETURN
.
.******************************************************************************
.* EUNA0000 - Extract Add Individual Provider Discipline Specialty - Obj 33
.******************************************************************************
EUNA0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EUNA9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EUNA9999 IF EQUAL               * HCP created date
.
          MOVE      PMHCLDOC,PMDUDOCT
          UNPACK    PMIWNEWV,PMDUUNIT                  * New Unit
.
          MOVE      "33",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMDUUNIT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      SP70,DIM10A
          MOVE      ANSN,DIM1P                  * PAEDIATRIC_SPECIALTY_FLAG
          PACK      KEY5,ANSD,ANST,PMDUUNIT,SP70
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
.
            MATCH     ANSP,TCINDC2
            IF        @EQUAL
              MOVE      ANSY,DIM1P            * PAEDIATRIC_SPECIALTY_FLAG
            ENDIF
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          SQUEEZE   PMDUDOCT
          SQUEEZE   PMDUUNIT
          PACK      KEY20,PMDUDOCT,DASH,PMDUUNIT
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             KEY20,TILDA:            * ISP_DISC_SPEC_RECORD_ID
                             DIM10A,TILDA:           * ISP_DISC_SPEC_CODE
                             DIM1P,TILDA:            * PAEDIATRIC_SPECIALTY_FLAG
                             DIM8,TILDA:             * EFFECTIVE_START_DATE
                             DIM8A:                  * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          MOVE      "34",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMDUUNIT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9475-001",DIM8B
          MOVE      PMDUUNIT,DIM3
.
          MOVE      SP70,DIM10A
          PACK      KEY5,ANSD,ANST,PMDUUNIT,SP70 * (Use DT instead of AC)
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM10A
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM3,TILDA:   * ISP_SPEC_PRAC_RECORD_ID
                             DIM10A,TILDA:         * ISP_DISC_SPEC_CODE
                             DIM8B,TILDA:        * OSP_SOURCE_ID
                             PTCNNIAI,TILDA:     * OSP_ID
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EUNA9999  RETURN
.
.******************************************************************************
.* EUND0000 - Extract Delete Individual Provider Discipline Specialty - Obj 33
.******************************************************************************
EUND0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EUND9999
.
          MOVE      PMHCLDOC,PMDUDOCT
          UNPACK    PMIWOLDV,PMDUUNIT                  * Deleted Unit
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "33 ",CHANGOBJ                     * Provider Specialty
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMDUUNIT,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "34 ",CHANGOBJ                     * Specialty Prac
          MOVE      "14",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMDUUNIT,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
EUND9999  RETURN
.
.******************************************************************************
.* EPAD0000  - Extract Practice Address Change - Obj 38
.******************************************************************************
EPAD0000  UNPACK    PMIWCODE,DIM10,PMHGPRAC,PMHGCNTR        * Practice/count
.
          PACK      KEY12,PMHGPRAC,PMHGCNTR,SP70
          CALL      RDPMHCG1                          * Read Practice
          BRANCH    OVRCD,EPAD9999
.
          PACK      KEY20,PMHGPRAC,SP70
          CALL      RSPMHCL2
EPAD1000  CALL      RKPMHCL2                          * Find all linked
          BRANCH    OVRCD,EPAD5000                    * HCP codes
.
          MATCH     PMHGPRAC,PMHLHCPR                 * Same Practice
          GOTO      EPAD5000 IF NOT EQUAL
.
          PACK      KEY10,PMHLHCPC,SP70
          CALL      RDPMHCP1                          * Read HCP
          BRANCH    OVRCD,EPAD1000
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EPAD1000 IF EQUAL               * HCP created date
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EPAD1500
          ELSE
            GOTO      EPAD1000
          ENDIF
.
EPAD1500  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Provider Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          GOTO      EPAD1000
.
EPAD5000  PACK      KEY20,PMHGPRAC,SP70
          CALL      RSPMHCL2
EPAD6000  CALL      RKPMHCL2                          * Find all linked
          BRANCH    OVRCD,EPAD8000                    * HCP codes
.
          MATCH     PMHGPRAC,PMHLHCPR                 * Same Practice
          GOTO      EPAD8000 IF NOT EQUAL
.
          PACK      KEY10,PMHLHCPC,SP70
          CALL      RDPMHCP1                          * Read HCP
          BRANCH    OVRCD,EPAD6000
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EPAD6000 IF EQUAL               * HCP created date
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EPAD7000
          ELSE
            GOTO      EPAD6000
          ENDIF
.
EPAD7000  MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHLHCPR,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHLHCPR,DIM10A
          MOVE      PMIWCDAT,DIM8
          MOVE      PMHLLPDT,DIM8A
.
          MOVE      PMHGADD3,KEY45
          PACK      KEY56,PMHGPOST,KEY45,PMHGADD4,SP70
          CALL      RDIBPOS1
          IF        OVRCD=1
            MOVE      SP70,IBPOASGC
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          STRIP     PMHGADD1
          STRIP     PMHGADD2
          STRIP     PMHGADD3
          STRIP     PMHGADD4
          STRIP     PMHGPOST
          STRIP     IBPOASGC
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10A,DIM8,TILDA:      * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             PMHGADD1:
                             SP1,PMHGADD2:
                             TILDA:            * ORIGINAL_ADDRESS
                             PMHGADD3,TILDA:   * ORIGINAL_SUBURB_LOCALITY
                             PMHGPOST,TILDA:   * ORIGINAL_POSTCODE
                             PMHGADD4,TILDA:   * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EPAD6000
.
EPAD8000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Individual Prov Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHGPRAC: * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC,PMIWCDAT,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
          MOVE      PMHGDSDT,DIM8A
.
          MOVE      PMHGADD3,KEY45
          PACK      KEY56,PMHGPOST,KEY45,PMHGADD4,SP70
          CALL      RDIBPOS1
          IF        OVRCD=1
            MOVE      SP70,IBPOASGC
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGADD1
          STRIP     PMHGADD2
          STRIP     PMHGADD3
          STRIP     PMHGADD4
          STRIP     PMHGPOST
          STRIP     IBPOASGC
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,TILDA:      * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             PMHGADD1:
                             SP1,PMHGADD2:
                             TILDA:            * ORIGINAL_ADDRESS
                             PMHGADD3,TILDA:   * ORIGINAL_SUBURB_LOCALITY
                             PMHGPOST,TILDA:   * ORIGINAL_POSTCODE
                             PMHGADD4,TILDA:   * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPAD9999  RETURN
.
.******************************************************************************
.* EPTL0000 - Extract Practice Telephone No. Change - Obj 42
.******************************************************************************
EPTL0000  UNPACK    PMIWCODE,DIM10,PMHGPRAC,PMHGCNTR        * Practice/count
.
          PACK      KEY12,PMHGPRAC,PMHGCNTR,SP70
          CALL      RDPMHCG1                          * Read Practice
          BRANCH    OVRCD,EPTL9999
.
          PACK      KEY20,PMHGPRAC,SP70
          CALL      RSPMHCL2
EPTL5000  CALL      RKPMHCL2                          * Find all linked
          BRANCH    OVRCD,EPTL7000                    * HCP codes
.
          MATCH     PMHGPRAC,PMHLHCPR                 * Same Practice
          GOTO      EPTL7000 IF NOT EQUAL
.
          PACK      KEY10,PMHLHCPC,SP70
          CALL      RDPMHCP1                          * Read HCP
          BRANCH    OVRCD,EPTL5000
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EPTL5000 IF EQUAL               * HCP created date
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,TWO,PMHGPRAC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EPTL6000
          ELSE
            GOTO      EPTL5000
          ENDIF
.
EPTL6000  UNPACK    PMIWNEWV,PMHGPTEL        * Practice Telephone Number
 
          MATCH     SP70,PMHGPTEL            * Practice Telephone Number
          GOTO      EPTL5000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,TWO,PMHGPRAC,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGPTEL
.
          PACK      DIM20,ZERO,TWO,PMHGPRAC,PMHGPTEL,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,TWO,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPTEL,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EPTL5000
.
EPTL7000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Individual Tel Mode
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE:          * Change Key
                    PMHGPRAC,ZERO,TWO,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC:
                    ZERO,TWO,PMIWCDAT,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPTEL
.
          PACK      DIM20,ZERO,TWO,PMHGPTEL,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,TWO,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPTEL,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPTL9999  RETURN
.
.******************************************************************************
.* EPAC0000 - Extract HCP Added to Practice
.******************************************************************************
EPAC0000  UNPACK    PMIWCODE,PMHCHCPC,PMHLHCPR      * HCP/Practice
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1                        * Read HCP
          BRANCH    OVRCD,EPAC9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      ENAM9999 IF EQUAL               * HCP created date
.
          PACK      KEY20,PMHCHCPC,PMHLHCPR,SP70
          CALL      RDPMHCL1                        * Read Linked Practice
          BRANCH    OVRCD,EPAC9999
.
          MATCH     PMHLCDTE,PMHCCDTE               * Already reported by
          GOTO      EPAC9999 IF EQUAL               * HCP created date
.
          PACK      KEY12,PMHLHCPR,SP70
          CALL      RSPMHCG1
          CALL      RKPMHCG1                        * Read Practice
          BRANCH    OVRCD,EPAC9999
.
          MATCH     PMHLHCPR,PMHGPRAC
          GOTO      EPAC9999 IF NOT EQUAL
.
          CALL      EHHH0000   * 43 - Individual Provider Organisation
.
          MOVE      PMHLPRV1,DIM20
          MATCH     SP70,DIM20
          GOTO      EPAC9999 IF EQUAL
.
          MOVE      "019",DIM3                * Medicare
.
          MOVE      "37",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHLHCPR,DIM20,SP70,SP70
.
          MOVE      "3003357",DIM7
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHLJPDT,DIM8
          MOVE      PMHLLPDT,DIM8A
.
. If any of the privider numbers are greater that 10 characters and start
. with 3 alpha characters. Remove the 3 alpha characters for reporting in
. ISP_ALT_ID_RECORD_ID as it's ony 20 characters (HCP Code + provider Number)
.
          MOVE      DIM20,DIM20A
EPAC1500  MOVE      ZERO,F2
          SQUEEZE   DIM20A
          MOVELPTR  DIM20A,F2
          IF        F2>10
            UNPACK    DIM20A,DIM3A,DIM17
            TYPE      DIM3A
            IF        !@EQUAL
              PACK     DIM20A,DIM17,SP70
              GOTO     EPAC1500
            ENDIF
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM7
          PACK      DIM8,PMHCLUPD,SP70
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM20
          SQUEEZE   DIM20A
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM20A,TILDA:     * ISP_ALT_ID_RECORD_ID
                             DIM3,TILDA:             * ISP_ALT_ID_TYPE_CODE
                             DIM7,TILDA:    * ISP_ALT_ID_ISSUING_AUTHORITY
                             DIM20,TILDA:   * ISP_ALT_ID
                             TILDA:         * MEDICARE_SPECIALTY_CODE
                             DIM8,TILDA:    * EFFECTIVE_START_DATE
                             SP70:          * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHLHCPR,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHLHCPR,DIM10A
          MOVE      PMHLJPDT,DIM8
          MOVE      PMHLLPDT,DIM8A
.
          MOVE      PMHGADD3,KEY45
          PACK      KEY56,PMHGPOST,KEY45,PMHGADD4,SP70
          CALL      RDIBPOS1
          IF        OVRCD=1
            MOVE      SP70,IBPOASGC
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          STRIP     PMHGADD1
          STRIP     PMHGADD2
          STRIP     PMHGADD3
          STRIP     PMHGADD4
          STRIP     PMHGPOST
          STRIP     IBPOASGC
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10A,DIM8,TILDA:      * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             PMHGADD1:
                             SP1,PMHGADD2:
                             TILDA:            * ORIGINAL_ADDRESS
                             PMHGADD3,TILDA:   * ORIGINAL_SUBURB_LOCALITY
                             PMHGPOST,TILDA:   * ORIGINAL_POSTCODE
                             PMHGADD4,TILDA:   * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMHCCDTE,SP70
          PACK      SRMDTIME,PMHCCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPAC9999  RETURN
.
.******************************************************************************
.* EPPV0000 - Extract Linked Provider Number Change - Obj 37
.******************************************************************************
EPPV0000  UNPACK    PMIWCODE,PMHCHCPC,PMHLHCPR      * HCP/Practice
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EPPV9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EPPV9999 IF EQUAL               * HCP created date
.
          UNPACK    PMIWOLDV,DIM20                     * Old provider no
          MATCH     SP70,DIM20
          GOTO      EPPV2000 IF EQUAL
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "37 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "15",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,DIM20,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
EPPV2000  UNPACK    PMIWNEWV,DIM20
          MATCH     SP70,DIM20
          GOTO      EPPV9999 IF EQUAL
.
          MOVE      "019",DIM3                * Medicare
.
          MOVE      "37",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHLHCPR,DIM20,PMIWCDAT,SP70,SP70
.
          MOVE      "3003357",DIM7
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
          MOVE      SP70,DIM8A
.
. If any of the privider numbers are greater that 10 characters and start
. with 3 alpha characters. Remove the 3 alpha characters for reporting in
. ISP_ALT_ID_RECORD_ID as it's ony 20 characters (HCP Code + provider Number)
.
          MOVE      DIM20,DIM20A
EPPV2500  MOVE      ZERO,F2
          SQUEEZE   DIM20A
          MOVELPTR  DIM20A,F2
          IF        F2>10
            UNPACK    DIM20A,DIM3A,DIM17
            TYPE      DIM3A
            IF        !@EQUAL
              PACK     DIM20A,DIM17,SP70
              GOTO     EPPV2500
            ENDIF
          ENDIF
.
          SQUEEZE   DIM3
          SQUEEZE   DIM7
          PACK      DIM8,PMHCLUPD,SP70
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM20
          SQUEEZE   DIM20A
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DIM20A,TILDA:     * ISP_ALT_ID_RECORD_ID
                             DIM3,TILDA:             * ISP_ALT_ID_TYPE_CODE
                             DIM7,TILDA:    * ISP_ALT_ID_ISSUING_AUTHORITY
                             DIM20,TILDA:   * ISP_ALT_ID
                             TILDA:         * MEDICARE_SPECIALTY_CODE
                             DIM8,TILDA:    * EFFECTIVE_START_DATE
                             SP70:          * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPPV9999  RETURN
.
.******************************************************************************
.* EHIP0000 - Extract HCP Inactivated from practice
.******************************************************************************
EHIP0000  UNPACK    PMIWCODE,PMHCHCPC,PMHLHCPR      * HCP/Practice
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "37 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "15",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,DIM20,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Provider Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "43 ",CHANGOBJ                     * Provider Organisation
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
EHIP9999  RETURN
.
.******************************************************************************
.* EIPR0000 - Extract Inactivate practice
.******************************************************************************
EIPR0000  UNPACK    PMIWCODE,DIM10,PMHGPRAC           * Practice
.
          PACK      KEY20,PMHGPRAC,SP70
          CALL      RSPMHCL2
EIPR1000  CALL      RKPMHCL2                          * Find all linked
          BRANCH    OVRCD,EIPR8000                    * HCP codes
.
          MATCH     PMHGPRAC,PMHLHCPR                 * Same Practice
          GOTO      EIPR8000 IF NOT EQUAL
.
          MOVE      PMHLHCPC,PMHCHCPC                 * Populate HCP Code
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "37 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "15",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Provider Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMHLHCPR,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "43 ",CHANGOBJ                     * Provider Organisation
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          GOTO      EIPR1000
.
EIPR8000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "32 ",CHANGOBJ                     * Individual Prov ident.
          MOVE      "14",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHGPRAC: * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Individual Prov Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHGPRAC: * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "40 ",CHANGOBJ                     * Individual Prov Address
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHGPRAC: * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Individual Tel Mode    
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE:          * Change Key
                    PMHGPRAC,ZERO,ONE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Individual Tel Mode
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE:          * Change Key
                    PMHGPRAC,ZERO,TWO,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Individual Tel Mode
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE:          * Change Key
                    PMHGPRAC,ZERO,THREE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "43 ",CHANGOBJ                     * Individual Prov Org    
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHGPRAC: * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
EIPR9999  RETURN
.
.******************************************************************************
.* EFXL0000 - Extract Practice Fax No. Change - Obj 42
.******************************************************************************
EPFX0000  UNPACK    PMIWCODE,DIM10,PMHGPRAC,PMHGCNTR        * Practice/count
.
          PACK      KEY12,PMHGPRAC,PMHGCNTR,SP70
          CALL      RDPMHCG1                          * Read Practice
          BRANCH    OVRCD,EPFX9999
.
          PACK      KEY20,PMHGPRAC,SP70
          CALL      RSPMHCL2
EPFX5000  CALL      RKPMHCL2                          * Find all linked
          BRANCH    OVRCD,EPFX7000                    * HCP codes
.
          MATCH     PMHGPRAC,PMHLHCPR                 * Same Practice
          GOTO      EPFX7000 IF NOT EQUAL
.
          PACK      KEY10,PMHLHCPC,SP70
          CALL      RDPMHCP1                          * Read HCP
          BRANCH    OVRCD,EPFX5000
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,THREE,PMHGPRAC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EPFX6000
          ELSE
            GOTO      EPFX5000
          ENDIF
.
EPFX6000  UNPACK    PMIWNEWV,PMHGPFAX        * Practice Fax Number
.
          MATCH     SP70,PMHGPFAX            * Practice Fax Number
          GOTO      EPFX5000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,THREE,PMHGPRAC,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGPFAX
.
          PACK      DIM20,ZERO,THREE,PMHGPRAC,PMHGPFAX,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,THREE,TILDA: * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPFAX,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EPFX5000
.
EPFX7000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Individual Tel Mode
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE:          * Change Key
                    PMHGPRAC,ZERO,THREE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC:
                    ZERO,THREE,PMIWCDAT,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPFAX
.
          PACK      DIM20,ZERO,THREE,PMHGPFAX,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,THREE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPFAX,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPFX9999  RETURN
.
.******************************************************************************
.* EFXL0000 - Extract Practice Email Change - Obj 42
.******************************************************************************
EPEM0000  UNPACK    PMIWCODE,DIM10,PMHGPRAC,PMHGCNTR        * Practice/count
.
          PACK      KEY12,PMHGPRAC,PMHGCNTR,SP70
          CALL      RDPMHCG1                          * Read Practice
          BRANCH    OVRCD,EPEM9999
.
          PACK      KEY20,PMHGPRAC,SP70
          CALL      RSPMHCL2
EPEM5000  CALL      RKPMHCL2                          * Find all linked
          BRANCH    OVRCD,EPEM7000                    * HCP codes
.
          MATCH     PMHGPRAC,PMHLHCPR                 * Same Practice
          GOTO      EPEM7000 IF NOT EQUAL
.
          PACK      KEY10,PMHLHCPC,SP70
          CALL      RDPMHCP1                          * Read HCP
          BRANCH    OVRCD,EPEM5000
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EPEM5000 IF EQUAL               * HCP created date
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,ONE,PMHGPRAC,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EPEM6000
          ELSE
            GOTO      EPEM5000
          ENDIF
.
EPEM6000  UNPACK    PMIWNEWV,PMHGPEML        * Practice Email Address

          MATCH     SP70,PMHGPEML            * Practice Email Address
          GOTO      EPEM5000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,ONE,PMHGPRAC,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPEML
.
          PACK      DIM20,ZERO,ONE,PMHGPRAC,PMHGPEML,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,ONE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPEML,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EPEM5000
.
EPEM7000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Individual Tel Mode
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE:          * Change Key
                    PMHGPRAC,ZERO,ONE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC:
                    ZERO,ONE,PMIWCDAT,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPEML
.
          PACK      DIM20,ZERO,ONE,PMHGPEML,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,ONE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPEML,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPEM9999  RETURN
.
.******************************************************************************
.* EHAD0000 - Extract Hospital Address Change - Obj 38
.******************************************************************************
EHAD0000  UNPACK    PMIWNEWV,DIM30,DIM30A,DIM1:  * Address 1, Address 2, State
                             DIM4                * Postcode
.
          PACK      KEY10,SP70
          CALL      RSPMHCP1
EHAD1000  CALL      RKPMHCP1                * Loop HCP file
          BRANCH    OVRCD,EHAD9999
.
. ** Skip if Referring, GP, Referring and GP or Ref. GP Other
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHAD1000              
          ENDIF
.
EHAD2000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "38 ",CHANGOBJ                     * Provider Address
          MOVE      "21",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field

          MATCH     "1",PMHCSTTS            * Inactive
          GOTO      EHAD1000 IF EQUAL
.
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     STRTDATE,PMHCEDAT     * HCP End date prior
            GOTO      EHAD1000 IF LESS      * to extract date
          ENDIF
.
          MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PTCNNECI,DIM10A
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          STRIP     DIM30
          STRIP     DIM30A
          STRIP     DIM4
.
          MATCH     "3",DIM1
          IF        @EQUAL
            MOVE      "VIC",D3
          ENDIF
          MATCH     "2",DIM1
          IF        @EQUAL
            MOVE      "NSW",D3
          ENDIF
          MATCH     "4",DIM1
          IF        @EQUAL
            MOVE      "QLD",D3
          ENDIF
          MATCH     "5",DIM1
          IF        @EQUAL
            MOVE      "SA",D3
          ENDIF
.
          STRIP     D3
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             PTCNNECI,DIM8,TILDA:    * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             DIM30:
                             TILDA:            * ORIGINAL_ADDRESS
                             DIM30A,TILDA:     * ORIGINAL_SUBURB_LOCALITY
                             DIM4,TILDA:     * ORIGINAL_POSTCODE
                             D3,TILDA:
.                                              * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHAD1000
.
EHAD9999  RETURN
.
.******************************************************************************
.* EHPH0000 - Extract Hospital Phone Number Change - Obj 42
.******************************************************************************
EHPH0000  UNPACK    PMIWNEWV,DIM12               * Hospital phone number
.
          PACK      KEY10,SP70
          CALL      RSPMHCP1
EHPH1000  CALL      RKPMHCP1                * Loop HCP file
          BRANCH    OVRCD,EHPH9999
.
. ** Skip if Referring, GP, Referring and GP or Ref. GP Other
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHPH1000
          ENDIF
.
EHPH2000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,TWO,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          MATCH     "1",PMHCSTTS            * Inactive
          GOTO      EHPH1000 IF EQUAL
.
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     STRTDATE,PMHCEDAT     * HCP End date prior
            GOTO      EHPH1000 IF LESS      * to extract date
          ENDIF
.
          MATCH     SP70,DIM12              * Hospital Phone Number
          GOTO      EHPH1000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,TWO,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     DIM12
.
          PACK      DIM20,ZERO,TWO,DIM12,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,TWO,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             DIM12,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHPH1000
.
EHPH9999  RETURN
.
.******************************************************************************
.* EHFX0000 - Extract Hospital Fax Number Change - Obj 42
.******************************************************************************
EHFX0000  UNPACK    PMIWNEWV,DIM12               * Hospital fax number
.
          PACK      KEY10,SP70
          CALL      RSPMHCP1
EHFX1000  CALL      RKPMHCP1                * Loop HCP file
          BRANCH    OVRCD,EHFX9999
.
. ** Skip if Referring, GP, Referring and GP or Ref. GP Other
.
          IF        PMHCHCST=1|PMHCHCST=3|PMHCHCST=5|PMHCHCST=12
            GOTO      EHFX1000
          ENDIF
.
EHFX2000  MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "42 ",CHANGOBJ                     * Provider Telecomm.
          MOVE      "16",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    ZERO,THREE,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change last sent stream object field
.
          MATCH     "1",PMHCSTTS            * Inactive
          GOTO      EHFX1000 IF EQUAL
.
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     STRTDATE,PMHCEDAT     * HCP End date prior
            GOTO      EHFX1000 IF LESS      * to extract date
          ENDIF
.
          MATCH     SP70,DIM12              * Hospital Fax Number
          GOTO      EHFX1000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                    ZERO,THREE,PMIWCDAT,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMIWCDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     DIM12
.
          PACK      DIM20,ZERO,THREE,DIM12,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,THREE,TILDA: * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             DIM12,TILDA:      * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      EHFX1000
.
EHFX9999  RETURN
.
.******************************************************************************
.* EGND0000 - Extract HCP gender Change - OBJ 32
.******************************************************************************
EGND0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EGND9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EGND9999 IF EQUAL               * HCP created date
.
          MOVE      "32",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC:
                             SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCDTOB,DIM8
          MOVE      PMIWCDAT,DIM8A
.
          MOVE      SP70,DIM8B              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8B      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9",DIM1      * Unknown
.
          UNPACK    PMIWNEWV,PMHCGNDR            * HCP Gender
.
          MATCH     "M",PMHCGNDR
          IF        @EQUAL
            MOVE      "1",DIM1    * Male
          ENDIF
.
          MATCH     "F",PMHCGNDR
          IF        @EQUAL
            MOVE      "2",DIM1    * Female
          ENDIF
.
          MATCH     "I",PMHCGNDR
          IF        @EQUAL
            MOVE      "3",DIM1    * Indeterminate
          ENDIF
.
          MATCH     "U",PMHCGNDR
          IF        @EQUAL
            MOVE      "9",DIM1    * Unknown
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:   * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:          * ISP_SOURCE_ID
                             DIM10,TILDA:             * ISP_ID
                             DIM1,TILDA:              * SEX_CODE
                             TILDA:                   * COUNTRY_OF_BIRTH_CODE
                             DIM8,TILDA:              * DATE_OF_BIRTH
                             TILDA:                   * INDIGENOUS_STATUS_CODE
                             DIM8A,TILDA:             * EFFECTIVE_START_DATE
                             DIM8B:                   * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EGND9999  RETURN
.
.******************************************************************************
. EGPS0000 - 33 Individual Provider Discipline Specialty - GP
.            Report the primary speciality for a HCP as long as they have
.            no linked doctor
.******************************************************************************
EGPS0000  UNPACK    PMIWCODE,PMHCHCPC                  * Set HCP code from audit
.
          PACK      KEY10,PMHCHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EGPS9999
.
          MATCH     PMIWCDAT,PMHCCDTE               * Already reported by
          GOTO      EGPS9999 IF EQUAL               * HCP created date
.
          MATCH     SP70,PMHCLDOC                   * linked doctor code
          GOTO      EGPS9999 IF NOT EQUAL
.
          UNPACK    PMIWOLDV,PMDUUNIT                  * Deleted Unit
.
          MOVE      "3  ",CHANGSTM                     * 3=ISP Extract
          MOVE      "33 ",CHANGOBJ                     * Provider Specialty
          MOVE      "13",CHANGCOL                      * Change column number
          MOVE      SP70,CHANGOVL                      * Change old value
          MOVE      PMIWCDAT,CHANGNVL                  * Change new value
          PACK      CHANGKEY,ZERO,THREE,FIVE,PMHCHCPC:   * Change Key
                    PMHCHCPC,PMDUUNIT,SP70,SP70
          PACK      CHANGPRM,SP70,SP70                 * Change primary key
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      LSOF0000           * Change sent stream object field
.
          UNPACK    PMIWNEWV,PMHCSPC1
.
          MOVE      "33",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHCHCPC,PMHCHCPC:
                    PMHCSPC1,SP70,SP70
.
          MOVE      PMHCHCPC,DIM10
          MOVE      PMHCSDAT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHCEDAT
          IF        !@EQUAL
            MATCH     PMHCEDAT,ENDDATE
            IF        !@LESS
              MOVE      PMHCEDAT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      SP70,DIM10A
          MOVE      ANSN,DIM1P                  * PAEDIATRIC_SPECIALTY_FLAG
          PACK      KEY5,ANSD,ANST,PMHCSPC1,SP70
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      PTCDUDF3,DIM10A           * User defined field 3
.
            MATCH     ANSP,TCINDC2
            IF        @EQUAL
              MOVE      ANSY,DIM1P            * PAEDIATRIC_SPECIALTY_FLAG
            ENDIF
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          SQUEEZE   DIM10A
          SQUEEZE   PMHCSPC1
          PACK      KEY20,DIM10,DASH,PMHCSPC1
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             KEY20,TILDA:            * ISP_DISC_SPEC_RECORD_ID
                             DIM10A,TILDA:           * ISP_DISC_SPEC_CODE
                             DIM1P,TILDA:            * PAEDIATRIC_SPECIALTY_FLAG
                             DIM8,TILDA:             * EFFECTIVE_START_DATE
                             DIM8A:                  * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMHCCDTE,SP70
          PACK      SRCRTIME,PMHCCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EGPS9999  RETURN
.
.******************************************************************************
. EPRA0000 - 32 Individual Provider for add medical practice 
.            38 Add address for add medical practice
.            40 Add practice name
.            42 Add preactice telecommunication
.******************************************************************************
EPRA0000  UNPACK    PMIWCODE,DIM10,PMHGPRAC,PMHGCNTR  * Practice/count
.
          PACK      KEY12,PMHGPRAC,PMHGCNTR,SP70
          CALL      RDPMHCG1                          * Read Practice
          BRANCH    OVRCD,EPRA9999
.
          MOVE      "32",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8A
.
          MOVE      SP70,DIM8B              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8B      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:   * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:          * ISP_SOURCE_ID
                             DIM10,TILDA:             * ISP_ID
                             NINE,TILDA:              * SEX_CODE
                             TILDA:                   * COUNTRY_OF_BIRTH_CODE
                             TILDA:                   * DATE_OF_BIRTH
                             TILDA:                   * INDIGENOUS_STATUS_CODE
                             DIM8A,TILDA:             * EFFECTIVE_START_DATE
                             DIM8B:                   * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRA1000  MOVE      "38",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
          MOVE      PMHGDSDT,DIM8A
.
          MOVE      PMHGADD3,KEY45
          PACK      KEY56,PMHGPOST,KEY45,PMHGADD4,SP70
          CALL      RDIBPOS1
          IF        OVRCD=1
            MOVE      SP70,IBPOASGC
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGADD1
          STRIP     PMHGADD2
          STRIP     PMHGADD3
          STRIP     PMHGADD4
          STRIP     PMHGPOST
          STRIP     IBPOASGC
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,TILDA:      * ISP_ADDRESS_RECORD_ID
                             FIVE,TILDA:       * ADDRESS_TYPE_CODE
                             PMHGADD1:
                             SP1,PMHGADD2:
                             TILDA:            * ORIGINAL_ADDRESS
                             PMHGADD3,TILDA:   * ORIGINAL_SUBURB_LOCALITY
                             PMHGPOST,TILDA:   * ORIGINAL_POSTCODE
                             PMHGADD4,TILDA:   * ORIGINAL_STATE_TERRITORY_ABBREV
                             TILDA:            * ORIGINAL_LATITUDE
                             TILDA:            * ORIGINAL_LONGITUDE
                             TILDA:            * ORIGINAL_DELIVERY_POINT_ID
                             ONE,ONE,ZERO,ONE,TILDA:  * COUNTRY_OF_ADDRESS_CODE
                             ANSN,TILDA:       * ADDRESS_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRA2000  MOVE      "40",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
          STRIP     PMHGPNAM
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,DASH,ZERO,ZERO:
                             TILDA:              * ISP_NAME_RECORD_ID
                             ANSL,TILDA:         * NAME_TYPE_CODE
                             PMHGPNAM,TILDA:     * FAMILY_NAME
                             TILDA:              * GIVEN_NAME
                             TILDA:              * MIDDLE_NAMES
                             TILDA:              * NAME_TITLE
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRA3000  MOVE      "43",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10

          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          MOVE      "9475-001",DIM8B
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM8B
          SQUEEZE   DIM10
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM10,TILDA:        * ISP_OSP_RECORD_ID
                             DIM8B,TILDA:        * OSP_SOURCE_ID
                             PTCNNIAI,TILDA:     * OSP_ID
                             DIM8,TILDA:         * EFFECTIVE_START_DATE
                             DIM8A:              * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
          MATCH     SP70,PMHGPTEL            * No email
          GOTO      EPRA4000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC:
                    ZERO,ONE,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPEML
.
          PACK      DIM20,ZERO,ONE,PMHGPEML,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,ONE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPEML,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRA4000  MATCH     SP70,PMHGPTEL           * No telephone
          GOTO      EPRA5000 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC:
                    ZERO,TWO,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPTEL
.
          PACK      DIM20,ZERO,TWO,PMHGPTEL,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,TWO,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPTEL,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRA5000  MATCH     SP70,PMHGPFAX           * No fax
          GOTO      EPRA9999 IF EQUAL
.
          MOVE      "42",OBJECTTY            * Individual Provider
          PACK      OBJECTKY,ZERO,THREE,FIVE,PMHGPRAC:
                    ZERO,THREE,SP70,SP70
.
          MOVE      PMHGPRAC,DIM10
          MOVE      PMHGFMDT,DIM8
.
          MOVE      SP70,DIM8A              * Effective end date
          MATCH     SP70,PMHGDSDT
          IF        !@EQUAL
            MATCH     PMHGDSDT,ENDDATE
            IF        !@LESS
              MOVE      PMHGDSDT,DIM8A      * Only report effective end date
            ENDIF                           * if less than extract end date
          ENDIF
.
          SQUEEZE   DIM8
          SQUEEZE   DIM8A
          SQUEEZE   DIM10
.
          SQUEEZE   PMHGPFAX
.
          PACK      DIM20,ZERO,THREE,PMHGPFAX,SP70
          SQUEEZE   DIM20
.
          PACK      OBJECTTX,ZERO,THREE,FIVE,TILDA:  * ISP_ID_TYPE_CODE
                             PTCNNSSI,TILDA:         * ISP_SOURCE_ID
                             DIM10,TILDA:            * ISP_ID
                             DIM20,TILDA:      * ISP_TELECOM_RECORD_ID
                             ZERO,THREE,TILDA:   * ISP_TELECOM_MODE_CODE
                             ZERO,TWO,TILDA:   * ISP_TELECOM_CONTACT_USE_CODE
                             TILDA:            * TELECOM_CONTACT_NOTES
                             PMHGPFAX,TILDA:   * TELECOM_NUMBER_ADDRESS_VALUE
                             ANSN,TILDA:       * TELECOM_RESTRICTION_FLAG
                             DIM8,TILDA:       * EFFECTIVE_START_DATE
                             DIM8A:            * EFFECTIVE_END_DATE
                             SP900
.
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,PMIWCDAT,SP70
          PACK      SRCRTIME,PMIWCTIM,SP70
          PACK      SRMDDATE,PMIWCDAT,SP70
          PACK      SRMDTIME,PMIWCTIM,SP70
          CALL      WRCOND00     * write record to container detail table
.
EPRA9999  RETURN
