.
.         PATSHT4
.         -------
.
.         THIS INCLUDE PRINTS THE PATIENT SUMMARY (IDENTIFICATION) DETAILS
.
.         Layout 1 - Modbury
.
.        MODIFICATIONS:  
.         V11.00.01 02/04/2020  J.Tan             TSK 0868813
.                   Changed PKNAME to DIM80
.         V9.08.01  08/06/2007  Mike Laming    CAR 125736
.                   Changes to PATDO1af Address lines - change DSADD3 to
.                   DSADD4 and DSADD2 to DSADD3 (new DSADD2 still to go in)
.*        V5.08.02  30/08/2000  Tonii                                         
.*                  Mods to accept Unknown and Indeterminate as valid patient 
.*                  sex description, Indeterminate=3, Unknown=9
.*        V5.08.01  06/06/2000  Jill Habasque                                 
.*                  Changed from key10 to key14 for the health fund file      
.                   08/10/1998  Glenn Berry      5.07 changes
.******************************************************************************
.                        V5.01 12/04/89 Karin Peak
.                              Case Notes Indicator Added
.                              SRF 6
.                        V5.02 24/04/89 Karin Peak
.                              Standby Clinic Unit Number  SRF  4707
.
.        IDENTIFICATION VARIABLES
.
. DIM22    DIM      22
. ADOCDESC DIM      22
. LDOCDESC DIM      22
. RDRCOD   DIM       4
. ADRCOD   DIM       4
. LDRCOD   DIM       4
.
. A8DATE   DIM      8
. D8DATE   DIM      8
. XDAY     DIM      2
. XMON     DIM      2
. XYEAR    DIM      2
. MARITAL  DIM      10
. RELIGN   DIM      20
. ADMSRC   DIM      20
. COUNTRY  DIM      12
. WDIM3    DIM      3
. MDIM3    DIM      3
. HDIM4    DIM      4
. XAGE     DIM      3
.
.        LINEUP PRINT
.
LINUPID4
        CALL      OPNPRINT
        PRINT     *N,*N:
                  *18,X5,X1,*N:
                  *18,X5,X1,*N:
                  *29,X10,X1,*N:
                  *29,X10,X1,*N:
                  *16,X20,X4,*N:
                  *16,X20,X4,*N:
                  *13,X20,X5,X2,*46,"99:99":
                  *57,X1,*62,X1,*67,"99",*70,"99",*73,"9999",*N:
                  *6,X30,X4,*N:
                  *6,X15,X3,*28,X10,X2,*N:
                  *15,X4,*29,X10,X1,*N:
                  *37,X3,*N:
                  *8,X5,*29,"99/99/9999",*N:
                  *14,X20,*37,X3,*N:
                  *N:
                  *37,X3,*N:
                  *N:
                  *37,X3,*N:
                  *10,X20,X4,*37,X3,*N:
                  *12,X20,X2,*N:
                  *37,X3,*N:
                  *37,X3,*N:
                  *37,*N:
                  *37,X3,*N:
                  *37,X3,*N:
                  *N:
                  *6,X20,X2,*31,X5,X4,*N:
                  *N,*6,X20,X2,*33,X5,X2:
                  *43,X30,X2,*N:
                  *N,*37,X3,*43,X30,X3:
                  *N,*N:
                  *6,X30,X3:
                  *43,X20,X3,*69,X3,SLASH,X3,*N,*N:
                  *N,*6,X20,X5,X2,*35,X10,X3:
                  *50,X10,X1,*N:
                  *11,X30,X5,*N:
                  *6,X20,X20,X2,*N:
                  *6,X20,X20,X2:
                  *51,X4,*N:
                  *N,*13,X15,X4,*35,X10,X3:
                  *50,X10,X1,*N:
                  *11,X30,X5,*N:
                  *6,X20,X20,X2,*N:
                  *6,X20,X20,X2:
                  *51,X4
                  
.
        CALL      CLSPRINT
        RETURN
.
.       SETUP ALL VARIABLES FOR PRINT
.
SETLID4 CALL            LABELAGE            * format age
. 
        UNPACK      ADATE,XCENT,XYEAR,XMON,XDAY
        PACK            A8DATE WITH XDAY,SP1,XMON,SP1,XYEAR
.
        UNPACK      PBDATE,XCENT,XYEAR,XMON,XDAY
        PACK            DIM7 WITH AWARD,SLASH,ABED
        MOVE            SP5,DIM5
        MATCH           SP11,PPENNO
        GOTO            NOPEN4 IF EQUAL
.
        UNPACK          PPNDTE,XCENT1,XYEAR1,XMON1
        PACK            DIM5 WITH XMON1,SLASH,XYEAR1
.
.       ATTENDING DOCTOR INFO
.
NOPEN4  MOVE            ADOCTA,KEY6
        CALL            GETDOC1
        MOVE            DIM22,ADOCDESC
.
.       REFERRING DOCTOR INFO
.
        BRANCH          CRDRTYP OF GETSEX
.
        MOVE            ADOCTR,KEY6
        CALL            GETDOC1
        PACK            ARDRNAM WITH ADOCTR,SP1,DIM22
.
.       CHANGE SEX 1=MALE,2=FEMALE,3=INDETERMINATE,9=UNKNOWN
.
GETSEX  REP             "M1F2I3U9",PSEX
.
.       MARITAL DESCRIPTION
.
        MOVE            SP10,HCSMAR
        MATCH           SP3,PMSTAT
        GOTO            GETCAT IF EQUAL
.
        PACK            KEY5 WITH CODEM,PMSTAT
        CALL            RDCODE1
        BRANCH          OVRCD OF GETCAT
        MOVE            THCSCOD,HCSMAR
.
.       PATIENT CATEGORY
.
GETCAT  MOVE            SP10,HCSCAT
        MATCH           SP3,ACLSS
        GOTO            GETINS IF EQUAL
.
        PACK            KEY5 WITH CODEP,ACLSS
        CALL            RDCODE1
        BRANCH          OVRCD OF GETINS
.
        MOVE            THCSCOD,HCSCAT
.
.       INSURANCE STATUS 
.
GETINS  MOVE            SP10,HCSINS
        MATCH           SP3,AUSR1
        GOTO            GETELC IF EQUAL
.
        PACK            KEY5 WITH CODEU1,AUSR1
        CALL            RDCODE1
        BRANCH          OVRCD OF GETELC
.
        MOVE            THCSCOD,HCSINS
.
.       ELECTION STATUS
.
GETELC  MOVE            SP10,HCSTYP
        MATCH           SP3,ATYPE
        GOTO            GETRAC IF EQUAL
.
        PACK            KEY5 WITH CODEA,ATYPE
        CALL            RDCODE1
        BRANCH          OVRCD OF GETRAC
.
        MOVE            TCINDC1,HCSTYP
.
.       RACE STATUS
.
GETRAC  MOVE            SP10,HCSRAC
        MATCH           SP3,PUSR1
        GOTO            GETADC IF EQUAL
.
        PACK            KEY5 WITH CODEP1,PUSR1
        CALL            RDCODE1
        BRANCH          OVRCD OF GETADC
        MOVE            THCSCOD,HCSRAC
.
.       ADMISSION CATEGORY
.
GETADC  MOVE            SP10,HCSADM
        MATCH           SP3,ACARE
        GOTO            GETREF IF EQUAL
.
        PACK            KEY5 WITH CODECC,ACARE
        CALL            RDCODE1
        BRANCH          OVRCD OF GETREF
        MOVE            THCSCOD,HCSADM
.
.      SOURCE OF REFERRAL
.
GETREF  MOVE            SP10,HCSSRC
        MOVE            SP20,ADMSRC
.
        MATCH           SP3,ASRCE
        GOTO            GETCHT IF EQUAL
.
        PACK            KEY5 WITH CODES,ASRCE
        CALL            RDCODE1
        BRANCH          OVRCD OF GETCHT
        MOVE            THCSCOD,HCSSRC
        MOVE            TDESC,ADMSRC
.
.      CHARGE TYPE
.
GETCHT  MOVE            SP10,HCSU2
        MATCH           SP3,AUSR2
        GOTO            GETDIA IF EQUAL
.
        PACK            KEY5 WITH CODEU2,AUSR2
        CALL            RDCODE1
        BRANCH          OVRCD OF GETDIA
        MOVE            THCSCOD,HCSU2
.
.      REASON FOR ADMISSION
.
GETDIA  MOVE            SP35,DIM35
        MOVE            ADIAG1,DIM35
.
.       RELIGION DESCRIPTION
.
        MOVE            SP20,RELIGN
        MOVE            SP10,HCSREG
.
        MATCH           SP3,PREG
        GOTO            CHKFND IF EQUAL
.
        PACK            KEY5 WITH CODER,PREG
        CALL            RDCODE1
        BRANCH          OVRCD OF CHKFND
.
        MOVE            TDESC,RELIGN
        MOVE            THCSCOD,HCSREG
.
.       FUND DESCRIPTION
.
CHKFND  MOVE            SP30,FUNDESC
        MOVE            SP30,TABDESC
        MATCH           SP6,AFUNDH
        GOTO            GETCNTR IF EQUAL
        PACK            KEY14 WITH AFUNDH,ZERO4,SP10
        CALL            RDFUND1
        BRANCH          OVRCD OF GETCNTR
        MOVE            HFNAME,FNDESC
.
. 
.       COUNTRY DESCRIPTION
.
GETCNTR MOVE            SP20,TDESC
        MOVE            SP20,COUNTRY
        MOVE            SP10,HCSTRY
.
        MATCH           SP3,PCONT
        GOTO            CHCLM IF EQUAL
.
        PACK            KEY5 WITH CODEC,PCONT
        CALL            RDCODE1
        BRANCH          OVRCD OF CHCLM
.
        MOVE            TDESC,COUNTRY
        MOVE            THCSCOD,HCSTRY
.
.       Get claim details if any
.
CHCLM   MOVE            SP3,WDIM3
        MOVE            SP3,MDIM3
        MOVE            SP4,HDIM4
.
        MOVE            SP4,THCSCOD
        UNPACK          SP5 WITH TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
.
        PACK            KEY5 WITH CODECL,ACLAIM
        CALL            RDCODE1
        MOVE            THCSCOD,HDIM4
.
        MOVE            ZERO,FORM2
GETCLL4 ADD             ONE,FORM2
        COMPARE         SIX,FORM2
        GOTO            ENDCLM1 IF NOT LESS
.
        LOAD            ANS USING FORM2 OF TCINDC1,TCINDC2,TCINDC3:
                                           TCINDC4,TCINDC5
.
        CMATCH          "W" TO ANS
        GOTO            CLWCO4 IF EQUAL
        CMATCH          "M" TO ANS
        GOTO            CLMAB4 IF EQUAL
.
        GOTO            GETCLL4
.
CLWCO4  MOVE            ACLAIM,WDIM3
        GOTO            ENDCLM4
.
CLMAB4  MOVE            ACLAIM,MDIM3
.
ENDCLM4 RETURN
.
.      GET DOCTOR RECORD...... SET KEY6
.
GETDOC4 MOVE            SP20,DGNAME
        MOVE            SP20,DSNAME
        MOVE            SP12,DTELES
        MOVE            SP30,DSADD1
        MOVE            SP30,DSADD2
        MOVE            SP30,DSADD3
        MOVE            SP30,DSADD4
        MOVE            SP30,DSPOST
        MOVE            SP30,DIM22
.
        CALL            RDDOCT1
.
        MATCH           SP20,DSNAME
        RETURN          IF EQUAL
.
        MOVE            DGNAME,ANS
        CLEAR           DIM22
        MATCH           SP1,ANS
        GOTO            APPDSN4 IF EQUAL
        APPEND          ANS,DIM22
        APPEND          DOT,DIM22
APPDSN4 APPEND          DSNAME,DIM22
        APPEND          SP2,DIM22
        RESET           DIM22
        RETURN
.
.        PRINT PATIENT ID
.
PRTSHT4  
        CALL      OPNPRINT
	MOVE      SP1,ANS
        LOAD      ANS USING PCASE OF CCNOTES
.
        UNPACK    PKNAME,KEY20
        PRINT     *N:
                  *21,CHCSCOD,*N:                                *      (LINE 1)
                  *21,AUSR6,*N:                                  *      (LINE 2)
                  *32,PURNO,ANS,*N:                              *      (LINE 3)
                  *29,PMEDI,*44,AADMNO,*N:                       *      (LINE 4)
                  *16,PTITL,*21,PSNAME,*N:                       *      (LINE 5)
                  *16,PGNAME,*N:                                 *      (LINE 6)
                  *13,PADD1,*46,ATIME,*57,HCSTYP,*62,HCSU2,*68,A8DATE:
                  *N:                                            *      (LINE 7)
                  *6,PADD2,*N:                                   *      (LINE 8)
                  *6,PSUBRB,*29,PTELEP,*N:                       *      (LINE 9)
                  *16,PPOST,*N:                                  *     (LINE 10)
                  *38,PSEX,*N:                                   *     (LINE 11)
                  *8,XAGE,*30,XDAY,SLASH,XMON:
                               SLASH,XCENT,XYEAR:                *    (LINE 12)
                  *N,*15,COUNTRY,*37,HCSTRY,*N:                  *     (LINE 13)
                  *N,*37,HCSRAC,*N:                              *     (LINE 14)
                  *N,*37,HCSMAR,*N:                              *     (LINE 15)
                  *11,RELIGN,*37,HCSREG,*N:                      *     (LINE 16)
                  *13,POCCUP,*N:                                 *     (LINE 17)
                  *37,HCSCAT,*N:                                 *     (LINE 18)
                  *37,HCSADM,*N:                                 *     (LINE 19)
                  *N:                                                  
                  *37,HCSSRC,*N:                                 *     (LINE 20)
                  *37,HCSINS,*N,*N:                              *     (LINE 21)
                  *6,FNDESC,*31,AFNDTB:
                  *N,*47,ADOCTL:
                  *N,*6,PPENNO,"  ",DIM5:
                  *N,*N:                                         *     (LINE 22)
                  *43,ARDRNAM,*N,*N:                             *     (LINE 23)
                  *6,DIM35,*43,ADOCTA," ",ADOCDESC,*69,DIM7,*N:  *     (LINE 24)
                  *N,*N:
                  *6,PNKNAME,*35,PNKRELP,*50,PNKTELP,*N:         *     (LINE 25)
                  *11,PNKADD1,*N:                                *     (LINE 26)
                  *6,PNKADD2,*N:                                 *     (LINE 27)
                  *6,PNKSUBR,*50,PNKPOST,*N,*N:                  *     (LINE 28)
                  *14,KEY20,*35,PKRELP,*50,PKTELEP,*N:          *     (LINE 29)
                  *11,PKADD1,*N:                                 *     (LINE 30)
                  *6,PKADD2,*N:                                  *     (LINE 31)
                  *6,PKSUBR,*50,PKPOST,*N                        *     (LINE 32)
.
        CALL      CLSPRINT
        RETURN
.
