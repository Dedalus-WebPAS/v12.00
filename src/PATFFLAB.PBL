.
.            INCLUDE NAME : PATFFLAB.PBL
.
.         Routine to print free format labels
.
.         V5.01.01  19/08/92 J.Tan  SRF 116799
.                   Mod to print 8 lines per label regardless the size of labels
.         V5.01.02  24/08/92 J.Tan  SRF 111487
.                   Mods Wellington labels to have 5 lines per label
.         V5.01.03  17/09/92 J.Tan  SRF 117164
.                   Changed the position of second & third column for 38 Chars
.         V5.01.04  22/11/93 Matt Surridge  MTA
.                   Mods for MtAlvernia to have only 5 lines per label
.         V5.01.05  24/11/93 Gabrielle     Hawkes Bay 
.                   Print only 5 lines for Hawkes Bay Label
.         V5.01.06  15/04/1994 Glenn Berry        Taranaki Mods
.                   Print only 5 lines for Taranaki Label
.         V5.02.01  13/02/1995  Greg Horvat      SRF 133927
.                   Changed small labels to print its char seperation at 37 &
.                   73 instead of 34 & 67.
.         V5.03.01  14/07/1995  Greg Horvat      SRF 135786
.                   Changed to print only 5 lines for Greenslopes labels
.         V5.03.02  24/07/1995  Greg Horvat      SRF 640515
.                   Changed to print only 5 lines for Coast Health Care labels
.         V5.03.03  28/07/1995  Greg Horvat
.                   Fixed free format labels when printing 2 & 3 labels across
.                   page
.
.
PATFFLAB  MOVE      ZERO,ENDFLG
          CALL      OPNPRINT
          COMPARE   ZERO,NOLABEL
          GOTO      PATFF900 IF EQUAL
.
.   START OF PRINTING LABELS
.
          BRANCH    PTCNCHFF,PATFF100
.
          MOVE      "42",TABPOS2          * 38 Chars
          MOVE      "83",TABPOS3
          GOTO      PATFF300
.
PATFF100  MOVE      "37",TABPOS2          * 33 Chars
          MOVE      "73",TABPOS3
.
.         Loop over the number of labels still to print
.
PATFF300  IF        CTYPLAB=TEN6
            PRINT     *CPI12; 
          ENDIF
          COMPARE   ZERO,NOLABEL
          GOTO      PATFF900 IF EQUAL
.         GOTO      PATFF900 IF LESS
          COMPARE   NOLABEL,LABCOS
          GOTO      PATFF310 IF LESS
          MOVE      NOLABEL,LABCOS
.
PATFF310  BRANCH    LABCOS,PATFF400,PATFF500,PATFF600
.
PATFF400  PRINT     *1,WLINE1A,*N:
                    *1,WLINE2A,*N:
                    *1,WLINE3A,*N:
                    *1,WLINE4A,*N:
                    *1,WLINE5A,*N;
.
          COMPARE   SIX,CTYPLAB
          GOTO      PATFF490 IF EQUAL       * Wellington only have 5 lines 
.
          COMPARE   TEN5,CTYPLAB
          GOTO      PATFF490 IF EQUAL       * Hawkes Bay only have 5 lines 
.
          COMPARE   TEN7,CTYPLAB
          GOTO      PATFF490 IF EQUAL       *  Taranaki only have 5 lines 
.
          COMPARE   TEN6,CTYPLAB
          GOTO      PATFF490 IF EQUAL       * Mt Alvernia only have 5 lines 
.
          COMPARE   TEN9,CTYPLAB
          GOTO      PATFF490 IF EQUAL       * Greenslopes only have 5 lines 
.
          COMPARE   TWENTY1,CTYPLAB
          GOTO      PATFF490 IF EQUAL       * C.H.C only have 5 lines 
.
.         COMPARE   SIX,PTCNLNFF
.         GOTO      PATFF490 IF LESS
          PRINT     *1,WLINE6A,*N;
.
.         COMPARE   SEVEN,PTCNLNFF
.         GOTO      PATFF490 IF LESS
          PRINT     *1,WLINE7A,*N;
.
.         COMPARE   EIGHT,PTCNLNFF
.         GOTO      PATFF490 IF LESS
          PRINT     *1,WLINE8A,*N;
.
PATFF490  PRINT     *N;
          SUB       ONE,NOLABEL
          GOTO      PATFF300
.
PATFF500  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*N;
.
          COMPARE   SIX,CTYPLAB
          GOTO      PATFF590 IF EQUAL       * Wellington only have 5 lines 
.
          COMPARE   TEN5,CTYPLAB
          GOTO      PATFF590 IF EQUAL       * Hawkes Bay only have 5 lines 
.
          COMPARE   TEN7,CTYPLAB
          GOTO      PATFF590 IF EQUAL       *  Taranaki only have 5 lines 
.
          COMPARE   TEN6,CTYPLAB
          GOTO      PATFF590 IF EQUAL       * Mt Alvernia only have 5 lines 
.
          COMPARE   TEN9,CTYPLAB
          GOTO      PATFF590 IF EQUAL       * Greenslopes only have 5 lines 
.
          COMPARE   TWENTY1,CTYPLAB
          GOTO      PATFF590 IF EQUAL       * C.H.C only have 5 lines 
.
.         COMPARE   SIX,PTCNLNFF
.         GOTO      PATFF590 IF LESS
          PRINT     *1,WLINE6A,*TABPOS2,WLINE6A,*N;
.
.         COMPARE   SEVEN,PTCNLNFF
.         GOTO      PATFF590 IF LESS
          PRINT     *1,WLINE7A,*TABPOS2,WLINE7A,*N;
.
.         COMPARE   EIGHT,PTCNLNFF
.         GOTO      PATFF590 IF LESS
          PRINT     *1,WLINE8A,*TABPOS2,WLINE8A,*N;
.
PATFF590  PRINT     *N;
          SUB       TWO,NOLABEL
          GOTO      PATFF300
.
PATFF600  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*TABPOS3,WLINE5A,*N;
.
          COMPARE   SIX,CTYPLAB
          GOTO      PATFF690 IF EQUAL       * Wellington only have 5 lines 
.
          COMPARE   TEN5,CTYPLAB
          GOTO      PATFF690 IF EQUAL       * Hawkes Bay only have 5 lines 
.
          COMPARE   TEN7,CTYPLAB
          GOTO      PATFF690 IF EQUAL       * Taranaki only have 5 lines 
.
          COMPARE   TEN6,CTYPLAB
          GOTO      PATFF690 IF EQUAL       * Mt Alvernia only have 5 lines 
.
          COMPARE   TEN9,CTYPLAB
          GOTO      PATFF690 IF EQUAL       * Greenslopes only have 5 lines 
.
          COMPARE   TWENTY1,CTYPLAB
          GOTO      PATFF690 IF EQUAL       * C.H.C only have 5 lines 
.
.         COMPARE   SIX,PTCNLNFF
.         GOTO      PATFF690 IF LESS
          PRINT     *1,WLINE6A,*TABPOS2,WLINE6A,*TABPOS3,WLINE6A,*N;
.
.         COMPARE   SEVEN,PTCNLNFF
.         GOTO      PATFF690 IF LESS
          PRINT     *1,WLINE7A,*TABPOS2,WLINE7A,*TABPOS3,WLINE7A,*N;
.
.         COMPARE   EIGHT,PTCNLNFF
.         GOTO      PATFF690 IF LESS
          PRINT     *1,WLINE8A,*TABPOS2,WLINE8A,*TABPOS3,WLINE8A,*N;
.
PATFF690  PRINT     *N;
          SUB       THREE,NOLABEL
          GOTO      PATFF300
.
. ------- Finished printing -------
.
PATFF900  COMPARE   ONE,ENDFLG
          GOTO      PATF999 IF EQUAL
.
          MOVE      CADDLAB,NOLABEL
          MOVE      CLABPG,LABCOS
.
          PACK      WLINE1A,SP30,SP10
          PACK      WLINE2A,SP30,SP10
          PACK      WLINE3A,SP30,SP10
          PACK      WLINE4A,SP30,SP10
          PACK      WLINE5A,SP30,SP10
          PACK      WLINE6A,SP30,SP10
          PACK      WLINE7A,SP30,SP10
          PACK      WLINE8A,SP30,SP10
.
          MOVE      ONE,ENDFLG
          GOTO      PATFF300
.
PATF999   CALL      CLSPRINT
          RETURN
