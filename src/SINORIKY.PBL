.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINORIKY
.   Routine   :   HSIORA00 Originator          
.   Return    :           
.-------------------------------------------------------------------------------
HSIORA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIORA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIORA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Originator"         
.
          MOVE      STDCOL02,STDCOL03
          ADD       "21",STDCOL03
HSIORA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIORORIG
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          CALL      RSSIOR1 
HSIORA10
          CALL      RKSIOR1 
          BRANCH    OVRCD,HSIORA15
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSIORA12
          CALL      HSIORA60
          BRANCH    OVRCD,HSIORA10
HSIORA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIORORIG
          DISPLAY   *PSTDCOL02:STDROW,SIORNAME
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIORA10 IF NOT EQUAL
HSIORA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIORA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIORA30,HSIORA35,HSIORA40,HSIORA45,HSIORA04:
                              HSIORA91,HSIORA50
          GOTO      HSIORA92
HSIORA30
          CALL      RKSIOR1 
          BRANCH    OVRCD,HSIORA85
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          CALL      RPSIOR1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIORA10
HSIORA35
          MOVE      ST1,KEY3 
          CALL      RDSIOR1 
          CALL      RPSIOR1 
          BRANCH    OVRCD,HSIORA85
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIORA36
          CALL      RPSIOR1 
          BRANCH    OVRCD,HSIORA37
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIORA36 IF NOT EQUAL
HSIORA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIORA10
HSIORA40
          MOVE      ST1,KEY3 
          CALL      RDSIOR1 
          CALL      RPSIOR1 
          BRANCH    OVRCD,HSIORA85
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIORA08
HSIORA45
          CALL      RKSIOR1 
          BRANCH    OVRCD,HSIORA85
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIOR1 
HSIORA46
          CALL      RPSIOR1 
          BRANCH    OVRCD,HSIORA47
          PACK      KEY3,SIORORIG,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIORA46 IF NOT EQUAL
HSIORA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIORA10
HSIORA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIORA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIORA08
HSIORA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIORA08
HSIORA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIORA61 IF EQUAL
          MATCH     SCHFLD01,SIORORIG
          GOTO      HSIORA72 IF NOT EQUAL
HSIORA61
          MATCH     SP70,SCHFLD02
          GOTO      HSIORA62 IF EQUAL
          MATCH     SCHFLD02,SIORNAME
          GOTO      HSIORA72 IF NOT EQUAL
HSIORA62
HSIORA63
HSIORA64
HSIORA65
HSIORA66
HSIORA67
HSIORA68
HSIORA69
HSIORA70
          GOTO      HSIORA75
HSIORA72  MOVE      ONE,OVRCD
HSIORA75  RETURN
HSIORA85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,SIORORIG                                               
          CALL      RDSIOR1 
HSIORA90
.                                                                               
          BEEP
          GOTO      HSIORA20
HSIORA91
          MOVE      SP70,SIORNAME
          MOVE      SP70,SIORHOSP
          MOVE      ZERO,SIORDEL 
          MOVE      SP70,SIORMESS
          MOVE      SP70,SIOREXT 
          MOVE      SP70,SIORCON 
          MOVE      SP70,SIORUR1 
          MOVE      SP70,SIORUR2 
          MOVE      SP70,SIORUD1 
          MOVE      SP70,SIORUD2 
          MOVE      SP70,SIORUC1 
          MOVE      SP70,SIORUC2 
          MOVE      SP70,SIORUY1 
          MOVE      SP70,SIORUY2 
          MOVE      SP70,SIORSPA 
          MOVE      SP70,KEY3 
          MOVE      SP70,SIORORIG
          GOTO      HSIORA96
HSIORA92
          MOVE      SP70,KEY3 
          MOVE      SP70,SIORORIG
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,SIORORIG                                               
HSIORA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIORA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINORIKY
.   Routine   :   KSIORA00 Keyin Originator          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIORA00 
          CLEAR     SIORORIG
          RESET     SIORORIG
          PACK      SIORORIG,SP70
.
          KEYIN     *PCCOL:CVERT,*V2LON,SIORORIG:                               
                    *PCCOL:CVERT,*DV,SIORORIG
.
          PACK      SIORORIG,SIORORIG,SP70
          MATCH     SIORORIG,SP70
          GOTO      KSIORA90 IF EQUAL
.
          CMATCH    EXITCHAR,SIORORIG
          GOTO      KSIORA95 IF EQUAL
.
          CMATCH    QUEST,SIORORIG
          GOTO      KSIORA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSIORA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIORORIG
          APPEND    SP70,SIORORIG
          RESET     SIORORIG
.
          MATCH     SP70,SIORORIG
          GOTO      KSIORA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIORORIG                                
KSIORA10
          PACK      KEY3,SIORORIG                                               
          CALL      RASIOR1 
          BRANCH    OVRCD,KSIORA80
          BRANCH    CKEYTYP,KSIORA75
          CALL      RDSIOR1 
KSIORA70
          MOVE      ZERO,EXIT
          GOTO      KSIORA99
KSIORA75
          MOVE      "Originator Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KSIORA00
KSIORA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIORA99,KSIORA99
          MOVE      "Originator Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KSIORA00
KSIORA90
          MOVE      ONE,EXIT
          GOTO      KSIORA99
KSIORA95
          MOVE      TWO,EXIT
KSIORA99 TOPIC    PRGID
          RETURN
