. *----------------------------------------------------------------------
. * Include Name  :   EMRACPTM.PBL
. *
. * Function      :   CGI Variables for EMRACPFD - emracpaf
. *
. * Mods          :
. *
. *       V11.02.01 01.04.2022 DA Sarkies        TSK 0918429 
. *                Fixed malformed code by removing SP70
. *       V11.01.01 31/05/2021 Tony Hui          TSK 0905305 
. *                Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
. Clear CGI Variables 
.------------------------------------------------------------------------
CLEMAP00  MOVE      Z70,EMACP001
          MOVE      Z70,EMACP002
          MOVE      Z70,EMACP003
          MOVE      Z70,EMACP004
          MOVE      Z70,EMACP005
          MOVE      Z70,EMACP006
          MOVE      Z70,EMACP007
          MOVE      Z70,EMACP008
          MOVE      Z70,EMACP009
          MOVE      Z70,EMACP010
          MOVE      Z70,EMACP011
.
CLEMAP99  RETURN
.
.------------------------------------------------------------
. Set CGI Variables for AAEC Codes for Admitted Predictors
.------------------------------------------------------------
SPEMAP00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMAP01,SPEMAP02,SPEMAP03,SPEMAP04,SPEMAP05:
                       SPEMAP06,SPEMAP07,SPEMAP08,SPEMAP09,SPEMAP10:
                       SPEMAP11
          GOTO      SPEMAP99
.
SPEMAP01  PACK      EMACP001,QRYDATA,SP70
          GOTO      SPEMAP99
.
SPEMAP02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMACP002,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEMAP99
.
SPEMAP03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMACP003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEMAP99
.
SPEMAP04  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP004
          GOTO      SPEMAP99
.
SPEMAP05  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP005
          GOTO      SPEMAP99
.
SPEMAP06  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP006
          GOTO      SPEMAP99
.
SPEMAP07  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP007
          GOTO      SPEMAP99
.
SPEMAP08  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP008
          GOTO      SPEMAP99
.
SPEMAP09  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP009
          GOTO      SPEMAP99
.
SPEMAP10  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACP010
          GOTO      SPEMAP99
.
SPEMAP11  PACK      EMACP011,QRYDATA,SP70
          GOTO      SPEMAP99 
.
SPEMAP99  RETURN
.
.------------------------------------------------------
. Output Tags for AAEC Codes for Admitted Predictors
.------------------------------------------------------
EMAP0000  BRANCH    FLDITMNO,EMAP0010,EMAP0020,EMAP0030,EMAP0040,EMAP0050:
			     EMAP0060,EMAP0070,EMAP0080,EMAP0090,EMAP0100:
                             EMAP0110,EMAP0120,EMAP0130,EMAP0140,EMAP0150:
                             EMAP0160,EMAP0170,EMAP0175
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMAP9999
.
EMAP0010  WRITE     HTMLFILE;EMAPCODE;
          GOTO      EMAP9999
.
EMAP0020  MATCH     EMAPFDAT,SP70
          GOTO      EMAP9999 IF EQUAL
.
	  UNPACK    EMAPFDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAP9999
.
EMAP0030  MATCH     EMAPTDAT,SP70
	  GOTO      EMAP9999 IF EQUAL
.
	  UNPACK    EMAPTDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAP9999
.
EMAP0040  WRITE     HTMLFILE;EMAPAGE1;
          GOTO      EMAP9999
.
EMAP0050  WRITE     HTMLFILE;EMAPAGE2;
	  GOTO      EMAP9999
.
EMAP0060  WRITE     HTMLFILE;EMAPTCT1;
          GOTO      EMAP9999
.
EMAP0070  WRITE     HTMLFILE;EMAPTCT2;
          GOTO      EMAP9999
.
EMAP0080  WRITE     HTMLFILE;EMAPTCT3;
          GOTO      EMAP9999
.
EMAP0090  WRITE     HTMLFILE;EMAPTCT4;
          GOTO      EMAP9999
.
EMAP0100  WRITE     HTMLFILE;EMAPTCT5;
          GOTO      EMAP9999
.
EMAP0110  MATCH     EMAPCDAT,SP70
          GOTO      EMAP9999 IF EQUAL
.
          UNPACK    EMAPCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAP9999
.
EMAP0120  WRITE     HTMLFILE;EMAPCTIM;
          GOTO      EMAP9999
.
EMAP0130  MATCH     SP70,EMAPCUID
          GOTO      EMAP9999 IF EQUAL
.
          PACK      KEY10,EMAPCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMAPCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMAP9999 
.
EMAP0140  MATCH     EMAPUDAT,SP70
          GOTO      EMAP9999 IF EQUAL
.
          UNPACK    EMAPUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAP9999
.
EMAP0150  WRITE     HTMLFILE;EMAPUTIM;
          GOTO      EMAP9999
.
EMAP0160  MATCH     SP70,EMAPUUID
          GOTO      EMAP9999 IF EQUAL
.
          PACK      KEY10,EMAPUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMAPUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMAP9999
.
EMAP0170  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,EMAP0175
.
          MATCH     "1",EMAPAFLG
          IF        @EQUAL
            WRITE     HTMLFILE;"Inactive";
          ELSE
            WRITE     HTMLFILE;"Active";
          ENDIF
.
EMAP0175  WRITE     HTMLFILE;EMAPAFLG;
          GOTO      EMAP9999 
.
EMAP9999  RETURN
.
.--------------------------------------------------------------
. Update File Variables for AAEC Codes for Admitted Predictors
.--------------------------------------------------------------
MVEMAP00  MATCH     Z70,EMACP001
          IF        !@EQUAL
            MOVE      EMACP001,EMAPCODE
          ENDIF       
.
          MATCH     Z70,EMACP002
          IF        !@EQUAL
            MOVE      EMACP002,EMAPFDAT
          ENDIF
.
          MATCH     Z70,EMACP003
          IF        !@EQUAL
            MOVE      EMACP003,EMAPTDAT
          ENDIF
.
          MATCH     Z70,EMACP004
          IF        !@EQUAL
            MOVE      EMACP004,EMAPAGE1
          ENDIF
.
          MATCH     Z70,EMACP005
          IF        !@EQUAL
            MOVE      EMACP005,EMAPAGE2
          ENDIF
.
          MATCH     Z70,EMACP006
          IF        !@EQUAL
            MOVE      EMACP006,EMAPTCT1
          ENDIF
.
          MATCH     Z70,EMACP007
          IF        !@EQUAL
            MOVE      EMACP007,EMAPTCT2	
          ENDIF
.
          MATCH     Z70,EMACP008
          IF        !@EQUAL
            MOVE      EMACP008,EMAPTCT3
          ENDIF
.
          MATCH     Z70,EMACP009
          IF        !@EQUAL
            MOVE      EMACP009,EMAPTCT4
          ENDIF
.
          MATCH     Z70,EMACP010
          IF        !@EQUAL
            MOVE      EMACP010,EMAPTCT5
          ENDIF
.
          MATCH     Z70,EMACP011
          IF        !@EQUAL
            MOVE      EMACP011,EMAPAFLG
          ENDIF
.
MVEMAP99  RETURN
