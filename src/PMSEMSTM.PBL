. *-----------------------------------------------------------------------------
. * Include Name  :  PMSEMSTM.PBL
. *
. * Function      :  CGI Variables for PMSEMSFD - pmsemsaf
. *
. * Mods          :  V10.03.00 15/03/2012   Patrick Adair     CAR 257776
. *                            Created include
. *-----------------------------------------------------------------------------
.-------------------------------------------------------------------------------
. Clear Modified Elderly Mobility Scale Parameters
.-------------------------------------------------------------------------------
CPPEMS00  MOVE      Z70,PMEMS001
          MOVE      Z70,PMEMS002
          MOVE      Z70,PMEMS003
          MOVE      Z70,PMEMS004
          MOVE      Z70,PMEMS005
          MOVE      Z70,PMEMS006
          MOVE      Z70,PMEMS007
          MOVE      Z70,PMEMS008
          MOVE      Z70,PMEMS009
          MOVE      Z70,PMEMS010
          MOVE      Z70,PMEMS011
          MOVE      Z70,PMEMS012
.
CPPEMS99  RETURN
.
.-------------------------------------------------------------------------------
. Set Modified Elderly Mobility Scale Parameters
.-------------------------------------------------------------------------------
SPPEMS00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPEMS01,SPPEMS02,SPPEMS03,SPPEMS04,SPPEMS05:
                       SPPEMS06,SPPEMS07,SPPEMS08,SPPEMS09,SPPEMS10:
                       SPPEMS11,SPPEMS12
          GOTO      SPPEMS99
.
SPPEMS01  PACK      PMEMS001,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMEMS002,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPEMS99
.
SPPEMS03  PACK      PMEMS003,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS04  PACK      PMEMS004,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS05  PACK      PMEMS005,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS06  PACK      PMEMS006,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS07  PACK      PMEMS007,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS08  PACK      PMEMS008,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS09  PACK      PMEMS009,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS10  PACK      PMEMS010,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS11  PACK      PMEMS011,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS12  PACK      PMEMS012,QRYDATA,SP70
          GOTO      SPPEMS99
.
SPPEMS99  RETURN
.
.-------------------------------------------------------------------------------
. Output Modified Elderly Mobility Scale tags
.-------------------------------------------------------------------------------
PEMS0000  BRANCH    FLDITMNO,PEMS0100,PEMS0200,PEMS0300,PEMS0400,PEMS0500:
                             PEMS0600,PEMS0700,PEMS0800,PEMS0900,PEMS1000:
                             PEMS1100,PEMS1200,PEMS1300,PEMS1400
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PEMS9999
.
PEMS0100  WRITE     HTMLFILE;PMEMVISN;
          GOTO      PEMS9999
.
PEMS0200  MATCH     PMEMADAT,SP70
          GOTO      PEMS9999 IF EQUAL
          UNPACK    PMEMADAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PEMS9999
.
PEMS0300  WRITE     HTMLFILE;PMEMATIM;
          GOTO      PEMS9999
.
PEMS0400  WRITE     HTMLFILE;PMEMLYSI;
          GOTO      PEMS9999
.
PEMS0500  WRITE     HTMLFILE;PMEMSILY;
          GOTO      PEMS9999
.
PEMS0600  WRITE     HTMLFILE;PMEMSIST;
          GOTO      PEMS9999
.
PEMS0700  WRITE     HTMLFILE;PMEMSTAN;
          GOTO      PEMS9999
.
PEMS0800  WRITE     HTMLFILE;PMEMGAIT;
          GOTO      PEMS9999
.
PEMS0900  WRITE     HTMLFILE;PMEMTWLK;
          GOTO      PEMS9999
.
PEMS1000  WRITE     HTMLFILE;PMEMFUNR;
          GOTO      PEMS9999
.
PEMS1100  WRITE     HTMLFILE;PMEMSTPS;
          GOTO      PEMS9999
.
PEMS1200  WRITE     HTMLFILE;PMEMGUGO;
          GOTO      PEMS9999
.
PEMS1300  WRITE     HTMLFILE;VISITDTE;
          GOTO      PEMS9999
.
PEMS1400  WRITE     HTMLFILE;VISITTME;
          GOTO      PEMS9999
.
PEMS9999  RETURN
.
.-------------------------------------------------------------------------------
. Move Modified Elderly Mobility Scale cgi variables to file variables
.-------------------------------------------------------------------------------
MVPEMS00  MATCH     Z70,ADMISSNO
          IF        !@EQUAL
            MOVE      ADMISSNO,PMEMVISN
          ENDIF
.
          MATCH     Z70,PMEMS002
          IF        !@EQUAL
            MOVE      PMEMS002,PMEMADAT
          ENDIF
.
          MATCH     Z70,PMEMS003
          IF        !@EQUAL
            MOVE      PMEMS003,PMEMATIM
          ENDIF
.
          MATCH     Z70,PMEMS004
          IF        !@EQUAL
            MOVE      PMEMS004,PMEMLYSI
          ENDIF
.
          MATCH     Z70,PMEMS005
          IF        !@EQUAL
            MOVE      PMEMS005,PMEMSILY
          ENDIF
.
          MATCH     Z70,PMEMS006
          IF        !@EQUAL
            MOVE      PMEMS006,PMEMSIST
          ENDIF
.
          MATCH     Z70,PMEMS007
          IF        !@EQUAL
            MOVE      PMEMS007,PMEMSTAN
          ENDIF
.
          MATCH     Z70,PMEMS008
          IF        !@EQUAL
            MOVE      PMEMS008,PMEMGAIT
          ENDIF
.
          MATCH     Z70,PMEMS009
          IF        !@EQUAL
            MOVE      PMEMS009,PMEMTWLK
          ENDIF
.
          MATCH     Z70,PMEMS010
          IF        !@EQUAL
            MOVE      PMEMS010,PMEMFUNR
          ENDIF
.
          MATCH     Z70,PMEMS011
          IF        !@EQUAL
            MOVE      PMEMS011,PMEMSTPS
          ENDIF
.
          MATCH     Z70,PMEMS012
          IF        !@EQUAL
            MOVE      PMEMS012,PMEMGUGO
          ENDIF
.
MVPEMS99  RETURN
.
.-------------------------------------------------------------------------------
. Clear Modified Elderly Mobility Scale file variables
.-------------------------------------------------------------------------------
CLPEMS00  MOVE      SP70,PMEMVISN
          MOVE      SP70,PMEMADAT
          MOVE      SP70,PMEMATIM
          MOVE      SP70,PMEMLYSI
          MOVE      SP70,PMEMSILY
          MOVE      SP70,PMEMSIST
          MOVE      SP70,PMEMSTAN
          MOVE      SP70,PMEMGAIT
          MOVE      SP70,PMEMTWLK
          MOVE      SP70,PMEMFUNR
          MOVE      SP70,PMEMSTPS
          MOVE      SP70,PMEMGUGO
          MOVE      SP70,PMEMCDAT
          MOVE      SP70,PMEMCTIM
          MOVE      SP70,PMEMCUID
          MOVE      SP70,PMEMUDAT
          MOVE      SP70,PMEMUTIM
          MOVE      SP70,PMEMUUID
.
CLPEMS99  RETURN
