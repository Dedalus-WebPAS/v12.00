.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.03.01  10.09.2003 Steve Downing (VF.11.01 CAR 9375)
.           Recompiled for SINREBFD & SINREBIO
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.02  15.01.2002 Steve Downing  SRF 13520
.           Fixed display of order history
. VF.09.B01 14.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.01  13.07.2000 Charles Handaya
.           Omnicell import file - Add Restock ID (SIIPRESI)
.           in Backorder Details (11) Screen
.           Quote 9817
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           23.12.1999 Sandra Barcham
.           Recompiled for FMSCCAFD
.           srf 646145
. VF.00.02  22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  04.03.1999 Sandra Barcham
.           Fixed usage screen keys
.-------------------------------------------------------
SAVKEY10  DIM       10
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN14
.   Function      :   Cost Centre Enquiries                   
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       FMSAMAFD/INC
          INC       FMSCCAFD/INC
          INC       FMSCONFD/INC
          INC       FMSLMAFD/INC
          INC       GPHSTDDF    
          INC       IBAPASFD/INC
          INC       SINBACFD/INC
          INC       SINCCAFD/INC
          INC       SINCCBFD/INC
          INC       SINCCCFD/INC
          INC       SINCCEFD/INC
          INC       SINCCFFD/INC
          INC       SINCGAFD/INC
          INC       SINCIAFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINCSEFD/INC
          INC       SINFACFD/INC
          INC       SINIMPFD/INC
          INC       SINNATFD/INC
          INC       SINOQAFD/INC
          INC       SINOQBFD/INC
          INC       SINOQCFD/INC
          INC       SINORIFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINREAFD/INC
          INC       SINREBFD/INC
          INC       SINSCDFD/INC
          INC       SINSCFFD/INC
          INC       SINSCMFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
IMPMON    DIM       1 * Scr 00 Fld    20
IMPTUE    DIM       1 * Scr 00 Fld    21
IMPWED    DIM       1 * Scr 00 Fld    22
IMPTHU    DIM       1 * Scr 00 Fld    23
IMPFRI    DIM       1 * Scr 00 Fld    24
IMPSAT    DIM       1 * Scr 00 Fld    25
.
.Word Processor File * Scr 00 Fld    26
.
NAMSICC1  INIT      "Wsicc1"
FILSICC1  DIM       8
.
COSTCOMM  DIM       5 * Scr 00 Fld    28
UDC1DESC  DIM      30 * Scr 00 Fld    29
UDC2DESC  DIM      30 * Scr 00 Fld    30
IMPSUN    DIM       1 * Scr 00 Fld    36
.
.    Multi Item Key Fields Scr 02 Fld     1
.-------------------------------------------------------
SIIM1NAM  INIT      "SIIM1"
SIIM1END  FORM      1   * End Display
SIIM1SNO  FORM      5   * Number of Items on the Screen
SIIM1MKY  DIM       127 * Match Key 
SIIM1EKY  DIM       127 * End Key
SIIM1SKY  DIM       127 * Start Key
SIIM1IDX  INIT      " 132 UC1-5"
SIIM1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIM1FNM  DIM       8  * Filename
SIIM1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 03 Fld     1
.-------------------------------------------------------
SIBA1NAM  INIT      "SIBA1"
SIBA1END  FORM      1   * End Display
SIBA1SNO  FORM      5   * Number of Items on the Screen
SIBA1MKY  DIM       127 * Match Key 
SIBA1EKY  DIM       127 * End Key
SIBA1SKY  DIM       127 * Start Key
SIBA1IDX  INIT      " 132 UC1-5"
SIBA1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIBA1FNM  DIM       8  * Filename
SIBA1CNT  FORM      3  * Number of Items on Screen
FINYEAR   DIM       4 * Scr 04 Fld     1
ACTPER01  FORM     12.2 * Scr 04 Fld    14
ACTPER02  FORM     12.2 * Scr 04 Fld    15
ACTPER03  FORM     12.2 * Scr 04 Fld    16
ACTPER04  FORM     12.2 * Scr 04 Fld    17
ACTPER05  FORM     12.2 * Scr 04 Fld    18
ACTPER06  FORM     12.2 * Scr 04 Fld    19
ACTPER07  FORM     12.2 * Scr 04 Fld    20
ACTPER08  FORM     12.2 * Scr 04 Fld    21
ACTPER09  FORM     12.2 * Scr 04 Fld    22
ACTPER10  FORM     12.2 * Scr 04 Fld    23
ACTPER11  FORM     12.2 * Scr 04 Fld    24
ACTPER12  FORM     12.2 * Scr 04 Fld    25
ACTPERXX  FORM     12.2 * Scr 04 Fld    26
BUDPER01  FORM     12.2 * Scr 04 Fld    27
BUDPER02  FORM     12.2 * Scr 04 Fld    28
BUDPER03  FORM     12.2 * Scr 04 Fld    29
BUDPER04  FORM     12.2 * Scr 04 Fld    30
BUDPER05  FORM     12.2 * Scr 04 Fld    31
BUDPER06  FORM     12.2 * Scr 04 Fld    32
BUDPER07  FORM     12.2 * Scr 04 Fld    33
BUDPER08  FORM     12.2 * Scr 04 Fld    34
BUDPER09  FORM     12.2 * Scr 04 Fld    35
BUDPER10  FORM     12.2 * Scr 04 Fld    36
BUDPER11  FORM     12.2 * Scr 04 Fld    37
BUDPER12  FORM     12.2 * Scr 04 Fld    38
BUDPERXX  FORM     12.2 * Scr 04 Fld    39
VARPER01  FORM     12.2 * Scr 04 Fld    40
VARPER02  FORM     12.2 * Scr 04 Fld    41
VARPER03  FORM     12.2 * Scr 04 Fld    42
VARPER04  FORM     12.2 * Scr 04 Fld    43
VARPER05  FORM     12.2 * Scr 04 Fld    44
VARPER06  FORM     12.2 * Scr 04 Fld    45
VARPER07  FORM     12.2 * Scr 04 Fld    46
VARPER08  FORM     12.2 * Scr 04 Fld    47
VARPER09  FORM     12.2 * Scr 04 Fld    48
VARPER10  FORM     12.2 * Scr 04 Fld    49
VARPER11  FORM     12.2 * Scr 04 Fld    50
VARPER12  FORM     12.2 * Scr 04 Fld    51
VARPERXX  FORM     12.2 * Scr 04 Fld    52
PVAPER01  FORM     12.2 * Scr 04 Fld    53
PVAPER02  FORM     12.2 * Scr 04 Fld    54
PVAPER03  FORM     12.2 * Scr 04 Fld    55
PVAPER04  FORM     12.2 * Scr 04 Fld    56
PVAPER05  FORM     12.2 * Scr 04 Fld    57
PVAPER06  FORM     12.2 * Scr 04 Fld    58
PVAPER07  FORM     12.2 * Scr 04 Fld    59
PVAPER08  FORM     12.2 * Scr 04 Fld    60
PVAPER09  FORM     12.2 * Scr 04 Fld    61
PVAPER10  FORM     12.2 * Scr 04 Fld    62
PVAPER11  FORM     12.2 * Scr 04 Fld    63
PVAPER12  FORM     12.2 * Scr 04 Fld    64
PVAPERXX  FORM     12.2 * Scr 04 Fld    65
ACTPER13  FORM     12.2 * Scr 04 Fld    72
BUDPER13  FORM     12.2 * Scr 04 Fld    73
VARPER13  FORM     12.2 * Scr 04 Fld    74
PVAPER13  FORM     12.2 * Scr 04 Fld    75
.
.    Multi Item Key Fields Scr 07 Fld     3
.-------------------------------------------------------
SIPC2NAM  INIT      "SIPC2"
SIPC2END  FORM      1   * End Display
SIPC2SNO  FORM      5   * Number of Items on the Screen
SIPC2MKY  DIM       127 * Match Key 
SIPC2EKY  DIM       127 * End Key
SIPC2SKY  DIM       127 * Start Key
SIPC2IDX  INIT      " 132 UC1-5"
SIPC2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC2FNM  DIM       8  * Filename
SIPC2CNT  FORM      3  * Number of Items on Screen
PERUSAGE  DIM       7 * Scr 07 Fld     6
.
.    Multi Item Key Fields Scr 08 Fld     3
.-------------------------------------------------------
SIPC5NAM  INIT      "SIPC5"
SIPC5END  FORM      1   * End Display
SIPC5SNO  FORM      5   * Number of Items on the Screen
SIPC5MKY  DIM       127 * Match Key 
SIPC5EKY  DIM       127 * End Key
SIPC5SKY  DIM       127 * Start Key
SIPC5IDX  INIT      " 132 UC1-5"
SIPC5FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC5FNM  DIM       8  * Filename
SIPC5CNT  FORM      3  * Number of Items on Screen
OUTQTY    FORM     12.2 * Scr 08 Fld    10
ITEMCOST  DIM      12 * Scr 08 Fld    12
.
.    Multi Item Key Fields Scr 09 Fld     6
.-------------------------------------------------------
SIRA4NAM  INIT      "SIRA4"
SIRA4END  FORM      1   * End Display
SIRA4SNO  FORM      5   * Number of Items on the Screen
SIRA4MKY  DIM       127 * Match Key 
SIRA4EKY  DIM       127 * End Key
SIRA4SKY  DIM       127 * Start Key
SIRA4IDX  INIT      " 132 UC1-5"
SIRA4FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIRA4FNM  DIM       8  * Filename
SIRA4CNT  FORM      3  * Number of Items on Screen
REQINDIC  DIM      12 * Scr 09 Fld     8
.
.    Multi Item Key Fields Scr 12 Fld     1
.-------------------------------------------------------
SICE1NAM  INIT      "SICE1"
SICE1END  FORM      1   * End Display
SICE1SNO  FORM      5   * Number of Items on the Screen
SICE1MKY  DIM       127 * Match Key 
SICE1EKY  DIM       127 * End Key
SICE1SKY  DIM       127 * Start Key
SICE1IDX  INIT      " 132 UC1-5"
SICE1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SICE1FNM  DIM       8  * Filename
SICE1CNT  FORM      3  * Number of Items on Screen
FINPERD   DIM       2 * Scr 12 Fld    12
VARIANCE  FORM     12.2 * Scr 12 Fld    13
PVARIANC  FORM     12.4 * Scr 12 Fld    14
.
.    Multi Item Key Fields Scr 13 Fld     1
.-------------------------------------------------------
SICF1NAM  INIT      "SICF1"
SICF1END  FORM      1   * End Display
SICF1SNO  FORM      5   * Number of Items on the Screen
SICF1MKY  DIM       127 * Match Key 
SICF1EKY  DIM       127 * End Key
SICF1SKY  DIM       127 * Start Key
SICF1IDX  INIT      " 132 UC1-5"
SICF1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SICF1FNM  DIM       8  * Filename
SICF1CNT  FORM      3  * Number of Items on Screen
ITEMDESC  DIM      60 * Scr 14 Fld    29
ORDQTY    FORM     12.2 * Scr 14 Fld    34
.
.Word Processor File * Scr 14 Fld    58
.
NAMSIPD1  INIT      "Wsipd1"
FILSIPD1  DIM       8
.
.
.    Multi Item Key Fields Scr 15 Fld    10
.-------------------------------------------------------
SIRB1NAM  INIT      "SIRB1"
SIRB1END  FORM      1   * End Display
SIRB1SNO  FORM      5   * Number of Items on the Screen
SIRB1MKY  DIM       127 * Match Key 
SIRB1EKY  DIM       127 * End Key
SIRB1SKY  DIM       127 * Start Key
SIRB1IDX  INIT      " 132 UC1-5"
SIRB1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIRB1FNM  DIM       8  * Filename
SIRB1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 16 Fld     3
.-------------------------------------------------------
SIQA1NAM  INIT      "SIQA1"
SIQA1END  FORM      1   * End Display
SIQA1SNO  FORM      5   * Number of Items on the Screen
SIQA1MKY  DIM       127 * Match Key 
SIQA1EKY  DIM       127 * End Key
SIQA1SKY  DIM       127 * Start Key
SIQA1IDX  INIT      " 132 UC1-5"
SIQA1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIQA1FNM  DIM       8  * Filename
SIQA1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 17 Fld     3
.-------------------------------------------------------
SIQC1NAM  INIT      "SIQC1"
SIQC1END  FORM      1   * End Display
SIQC1SNO  FORM      5   * Number of Items on the Screen
SIQC1MKY  DIM       127 * Match Key 
SIQC1EKY  DIM       127 * End Key
SIQC1SKY  DIM       127 * Start Key
SIQC1IDX  INIT      " 132 UC1-5"
SIQC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIQC1FNM  DIM       8  * Filename
SIQC1CNT  FORM      3  * Number of Items on Screen
PTYDESC   DIM      70 * Scr 17 Fld    29
PIDDESC   DIM      35 * Scr 17 Fld    42
.
.Word Processor File * Scr 18 Fld    17
.
NAMSIQB1  INIT      "Wsiqb1"
FILSIQB1  DIM       8
.
.
.    Multi Item Key Fields Scr 20 Fld     1
.-------------------------------------------------------
SIIM3NAM  INIT      "SIIM3"
SIIM3END  FORM      1   * End Display
SIIM3SNO  FORM      5   * Number of Items on the Screen
SIIM3MKY  DIM       127 * Match Key 
SIIM3EKY  DIM       127 * End Key
SIIM3SKY  DIM       127 * Start Key
SIIM3IDX  INIT      " 132 UC1-5"
SIIM3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIM3FNM  DIM       8  * Filename
SIIM3CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN14"
PRGNAM    INIT      "Cost Centre Enquiries                   "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RDCON000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSICC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSICC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIM1FL1,DELETE
.
          CLOSE     SIBA1FL1,DELETE
.
          CLOSE     SIPC2FL1,DELETE
.
          CLOSE     SIPC5FL1,DELETE
.
          CLOSE     SIRA4FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPD1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIQA1FL1,DELETE
.
          CLOSE     SIQC1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIQB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIQB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIM3FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA1,"sinbacaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccbaf";
          OPEN      SINCCBA1,"sinccbaf"
          DISPLAY   *P56:24,"Opening sincccaf";
          OPEN      SINCCCA1,"sincccaf"
          DISPLAY   *P56:24,"Opening sincceaf";
          OPEN      SINCCEA1,"sincceaf"
          DISPLAY   *P56:24,"Opening sinccfaf";
          OPEN      SINCCFA1,"sinccfaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincseaf";
          OPEN      SINCSEA1,"sincseaf"
          DISPLAY   *P56:24,"Opening sincseaf";
          OPEN      SINCSEA2,"sincseaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA1,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA3,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinoqaaf";
          OPEN      SINOQAA1,"sinoqaaf"
          DISPLAY   *P56:24,"Opening sinoqbaf";
          OPEN      SINOQBA1,"sinoqbaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA1,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA2,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA3,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA4,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA8,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA1,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA2,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA3,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA4,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA1,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA2,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA3,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscfaf";
          OPEN      SINSCFA1,"sinscfaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Wp Filename for Cost Centre Comments File          
.--------------------------------------------------------
          PACK      FILSICC1,NAMSICC1,PORT
          REP       " 0",FILSICC1
          DISPLAY   *P56:24,"Create & Open ",FILSICC1;
          PREP      TEMPWORD,FILSICC1
.
.--------------------------------------------------------
. Initialise Batch Screen Catalog                            
.--------------------------------------------------------
          MOVE     ZERO,SIIM1SNO
          MOVE     "02    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIM1SNO
            ENDIF
          ENDIF
          PACK      SIIM1FNM,ANST,SIIM1NAM,PORT
          REP       " 0",SIIM1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIM1FL1,SIIM1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIM1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIM1FNM,SIIM1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIM1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIM1FL1,SIIM1FNM
.--------------------------------------------------------
. Initialise Batch Screen Catalog                            
.--------------------------------------------------------
          MOVE     ZERO,SIBA1SNO
          MOVE     "03    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIBA1SNO
            ENDIF
          ENDIF
          PACK      SIBA1FNM,ANST,SIBA1NAM,PORT
          REP       " 0",SIBA1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIBA1FL1,SIBA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIBA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIBA1FNM,SIBA1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIBA1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIBA1FL1,SIBA1FNM
.--------------------------------------------------------
. Initialise Batch Screen Purchase Order                     
.--------------------------------------------------------
          MOVE     ZERO,SIPC2SNO
          MOVE     "07    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC2SNO
            ENDIF
          ENDIF
          PACK      SIPC2FNM,ANST,SIPC2NAM,PORT
          REP       " 0",SIPC2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC2FL1,SIPC2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC2FNM,SIPC2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC2FL1,SIPC2FNM
.--------------------------------------------------------
. Initialise Batch Screen Purchase Order                     
.--------------------------------------------------------
          MOVE     ZERO,SIPC5SNO
          MOVE     "08    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC5SNO
            ENDIF
          ENDIF
          PACK      SIPC5FNM,ANST,SIPC5NAM,PORT
          REP       " 0",SIPC5FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC5FL1,SIPC5FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC5FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC5FNM,SIPC5IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC5FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC5FL1,SIPC5FNM
.--------------------------------------------------------
. Initialise Batch Screen Requisition Type (Display Key)     
.--------------------------------------------------------
          MOVE     ZERO,SIRA4SNO
          MOVE     "09    6",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIRA4SNO
            ENDIF
          ENDIF
          PACK      SIRA4FNM,ANST,SIRA4NAM,PORT
          REP       " 0",SIRA4FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIRA4FL1,SIRA4FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIRA4FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIRA4FNM,SIRA4IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIRA4FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIRA4FL1,SIRA4FNM
.--------------------------------------------------------
. Initialise Batch Screen Commodity Group                    
.--------------------------------------------------------
          MOVE     ZERO,SICE1SNO
          MOVE     "12    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SICE1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Product Group Code                 
.--------------------------------------------------------
          MOVE     ZERO,SICF1SNO
          MOVE     "13    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SICF1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Wp Filename for Comments                           
.--------------------------------------------------------
          PACK      FILSIPD1,NAMSIPD1,PORT
          REP       " 0",FILSIPD1
          DISPLAY   *P56:24,"Create & Open ",FILSIPD1;
          PREP      TEMPWORD,FILSIPD1
.
.--------------------------------------------------------
. Initialise Batch Screen Warehouse                          
.--------------------------------------------------------
          MOVE     ZERO,SIRB1SNO
          MOVE     "15   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIRB1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Purchase Requisition               
.--------------------------------------------------------
          MOVE     ZERO,SIQA1SNO
          MOVE     "16    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIQA1SNO
            ENDIF
          ENDIF
          PACK      SIQA1FNM,ANST,SIQA1NAM,PORT
          REP       " 0",SIQA1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIQA1FL1,SIQA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIQA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIQA1FNM,SIQA1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIQA1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIQA1FL1,SIQA1FNM
.--------------------------------------------------------
. Initialise Batch Screen Purchase Requisition               
.--------------------------------------------------------
          MOVE     ZERO,SIQC1SNO
          MOVE     "17    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIQC1SNO
            ENDIF
          ENDIF
          PACK      SIQC1FNM,ANST,SIQC1NAM,PORT
          REP       " 0",SIQC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIQC1FL1,SIQC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIQC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIQC1FNM,SIQC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIQC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIQC1FL1,SIQC1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Notes                              
.--------------------------------------------------------
          PACK      FILSIQB1,NAMSIQB1,PORT
          REP       " 0",FILSIQB1
          DISPLAY   *P56:24,"Create & Open ",FILSIQB1;
          PREP      TEMPWORD,FILSIQB1
.
.--------------------------------------------------------
. Initialise Batch Screen Catalog                            
.--------------------------------------------------------
          MOVE     ZERO,SIIM3SNO
          MOVE     "20    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIM3SNO
            ENDIF
          ENDIF
          PACK      SIIM3FNM,ANST,SIIM3NAM,PORT
          REP       " 0",SIIM3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIM3FL1,SIIM3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIM3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIM3FNM,SIIM3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIM3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIM3FL1,SIIM3FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Control Screen                     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Cost Centre Static Details         
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Imprest Summary - Catalog Order    
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Backorder Summary                  
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Stock Usage Analysis               
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Stock Usage by Commodity Group     
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Stock Usage by Product Group       
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Purchase Order Summary             
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Outstanding Purchase Orders        
          ENDIF
          MATCH     "09",SCRID
          IF         @EQUAL
            CALL       PS09L000   * Requisitions Summary               
          ENDIF
          MATCH     "10",SCRID
          IF         @EQUAL
            CALL       PS10L000   * Imprest Detail Display             
          ENDIF
          MATCH     "11",SCRID
          IF         @EQUAL
            CALL       PS11L000   * Backorder Detail                   
          ENDIF
          MATCH     "12",SCRID
          IF         @EQUAL
            CALL       PS12L000   * Commodity Usage for a Period       
          ENDIF
          MATCH     "13",SCRID
          IF         @EQUAL
            CALL       PS13L000   * Product Group Usage for a Period   
          ENDIF
          MATCH     "14",SCRID
          IF         @EQUAL
            CALL       PS14L000   * Purchase Order Details             
          ENDIF
          MATCH     "15",SCRID
          IF         @EQUAL
            CALL       PS15L000   * Requisition Details                
          ENDIF
          MATCH     "16",SCRID
          IF         @EQUAL
            CALL       PS16L000   * Outstanding Purchase Requisitions  
          ENDIF
          MATCH     "17",SCRID
          IF         @EQUAL
            CALL       PS17L000   * Purchase Requisitions History      
          ENDIF
          MATCH     "18",SCRID
          IF         @EQUAL
            CALL       PS18L000   * Outstanding Purchase Req Details   
          ENDIF
          MATCH     "19",SCRID
          IF         @EQUAL
            CALL       PS19L000   * Purchase Requisition History Detail
          ENDIF
          MATCH     "20",SCRID
          IF         @EQUAL
            CALL       PS20L000   * Imprest Details - Sequence Order   
          ENDIF
          RETURN
.--------------------------------
. Screen - Control Screen                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Control Screen                     
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,SICACODE
          MOVE      SP70,SICADESC
          MOVE      SP70,SICATELE
          MOVE      SP70,SICACONT
          MOVE      SP70,SICAGL  
          MOVE      SP70,SICAIMPD
          MOVE      SP70,SICADAD1
          MOVE      SP70,SICADAD2
          MOVE      SP70,SICADAD3
          MOVE      ZERO,SICALOC 
          MOVE      SP70,SICAMES 
          MOVE      SP70,SICAUR1 
          MOVE      SP70,SICAUR2 
          MOVE      SP70,SICAUD1 
          MOVE      SP70,SICAUD2 
          MOVE      SP70,SICAUC1 
          MOVE      SP70,SICAUC2 
          MOVE      SP70,SICAUY1 
          MOVE      SP70,SICAUY2 
          MOVE      SP70,IMPMON  
          MOVE      SP70,IMPTUE  
          MOVE      SP70,IMPWED  
          MOVE      SP70,IMPTHU  
          MOVE      SP70,IMPFRI  
          MOVE      SP70,IMPSAT  
          MOVE      SP70,COSTCOMM
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,FMCCLEDG
          MOVE      SP70,FMCCCOCE
          MOVE      SP70,FMLADESC
          MOVE      SP70,FMCCDESC
          MOVE      SP70,IMPSUN  
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Control Screen                     
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,COSTCOMM
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SICACODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      COSTCOMM,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Control Screen                     
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILSICC1
          PACK     KEY8,SICACODE,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDSICC1 
          IF        OVRCD=0
            CALL      RPSICC1 
          ENDIF
WP00L100
          CALL     RKSICC1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY8,SICCCST,SICCLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,SICCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SICCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Control Screen                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Control Screen                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Control Screen                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L124,PS00L125,PS00L999,PS00L126:
                            PS00L127,PS00L128,PS00L129,PS00L130:
                            PS00L131,PS00L132,PS00L999,PS00L133:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SICAGL,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SICAIMPD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      SICADAD1,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SICADAD2,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SICADAD3,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICALOC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      SICAMES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      SICAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SICAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          UNPACK    SICAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          UNPACK    SICAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      SICAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      SICAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPMON,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTUE,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPWED,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTHU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPFRI,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSAT,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE     FILSICC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L126
          MOVE      COSTCOMM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      FMCCLEDG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      FMCCCOCE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      FMCCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSUN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Control Screen                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L101,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L102,SF00L006:
                            SF00L006,SF00L103,SF00L104,SF00L105:
                            SF00L106,SF00L107,SF00L108,SF00L109:
                            SF00L110,SF00L111,SF00L112,SF00L113:
                            SF00L114,SF00L115
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L101,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMCCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "18",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSICC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSICC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMCCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L102
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC07L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC04L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC05L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC09L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L112
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC08L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L113
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC16L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L114
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC17L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L115
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC20L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Cost Centre Static Details         
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Centre Static Details         
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Centre Static Details         
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Centre Static Details         
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILSICC1
          PACK     KEY8,SICACODE,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDSICC1 
          IF        OVRCD=0
            CALL      RPSICC1 
          ENDIF
WP01L100
          CALL     RKSICC1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY8,SICCCST,SICCLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,SICCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SICCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Centre Static Details         
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Centre Static Details         
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Centre Static Details         
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L999,PS01L127:
                            PS01L128,PS01L129,PS01L130,PS01L131:
                            PS01L132,PS01L133,PS01L999,PS01L999:
                           PS01L999,PS01L134,PS01L135
          GOTO     PS01L999
.
PS01L101
          MOVE      SICACODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SICAGL,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      SICAIMPD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      SICADAD1,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SICADAD2,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      SICADAD3,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICALOC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      SICAMES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      SICAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      SICAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          UNPACK    SICAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          UNPACK    SICAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SICAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      SICAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPMON,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTUE,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPWED,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTHU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPFRI,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSAT,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE     FILSICC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L127
          MOVE      COSTCOMM,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      FMCCLEDG,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      FMCCCOCE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      FMCCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      SICAPACC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Centre Static Details         
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L101,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L102,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L101,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMCCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "18",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSICC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSICC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMCCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L102
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Imprest Summary - Catalog Order    
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 4",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Imprest Summary - Catalog Order    
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Imprest Summary - Catalog Order    
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Imprest Summary - Catalog Order    
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Imprest Summary - Catalog Order    
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     1 Catalog                            
.---------------------------------------------------------
          UNPACK    SP70,SIIMCST,SIIMCAT
          PACK      KEY12,SICACODE,SP70
          MOVE      KEY12,SIIM1EKY
          STRIP     SIIM1SKY
          SETLPTR   SIIM1EKY,5
          MOVE      SIIM1EKY,SIIM1SKY
          CALL      RDSIIM1 
          IF        OVRCD=0
            CALL      RPSIIM1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIIM1CNT
          MOVE     ZERO,SIIM1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L101,DP02L102,DP02L103,DP02L104:
                            DP02L105,DP02L106,DP02L107,DP02L108:
                            DP02L109,DP02L110,DP02L111,DP02L112:
                            DP02L113,DP02L114,DP02L115,DP02L116:
                            DP02L010,DP02L117,DP02L118,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SIIM1MKY,SP70,SP70
          CALL      UPTSIIM1
          IF        SIIM1END=0
            CALL      RKSIIM1 
            IF        OVRCD=0
              PACK      SIIM1MKY,SIIMCST,SIIMCAT                                                                
              MATCH     SIIM1EKY,SIIM1MKY
              IF        @EQUAL
                MOVE      ZERO,SIIM1END
                ADD       ONE,SIIM1CNT
                CALL      UPTSIIM1
                MOVE      SIIMCAT,VAR      
                CALL      DISPITEM
          CALL      IMPLIN00
              ELSE
                MOVE      ONE,SIIM1END
              ENDIF
            ELSE
              MOVE      ONE,SIIM1END
            ENDIF
          ENDIF
          IF        SIIM1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SIIM1END=0
            MOVE      SIIMSEQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SIIM1END=0
            MOVE      SIIMMAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SIIM1END=0
            MOVE      SIIMREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SIIM1END=0
            MOVE      SIIMQOH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SIIM1END=0
            MOVE      SIIMUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SIIM1END=0
            MOVE      SIIMUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SIIM1END=0
            UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SIIM1END=0
            UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SIIM1END=0
            MOVE      SIIMUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        SIIM1END=0
            MOVE      SIIMUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        SIIM1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIMUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        SIIM1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIMUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        SIIM1END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        SIIM1END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        SIIM1END=0
            MOVE      SIIAAVC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        SIIM1END=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        SIIM1END=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIIM1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIIM1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY12,SIIM1SKY,SP70
          CALL     RDSIIM1  * Start
          IF       OVRCD=0
            CALL     RPSIIM1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIIM1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY12,SIIM1SKY,Z70
          CALL     RSSIIM1  * End
          IF       OVRCD=1
            CALL     RPSIIM1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM1SNO
            CALL     RPSIIM1 
            IF       OVRCD=1
              MOVE     SIIM1SNO,SECTOR
            ENDIF
            PACK     SIIM1MKY,SIIMCST,SIIMCAT                                                                
            MATCH    SIIM1EKY,SIIM1MKY
            IF       !@EQUAL
              MOVE     SIIM1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIIM1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSIIM1
          BRANCH   OVRCD,PP02L115
          MOVE      SIIM1MKY,KEY12 
          CALL      RSSIIM1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIM1SNO
            CALL     RPSIIM1 
            IF       OVRCD=1
              MOVE     SIIM1SNO,SECTOR
            ENDIF
            PACK     SIIM1MKY,SIIMCST,SIIMCAT                                                                
            MATCH    SIIM1EKY,SIIM1MKY
            IF       !@EQUAL
              MOVE     SIIM1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM1SNO
            CALL     RKSIIM1 
            IF       OVRCD=1
              MOVE     SIIM1SNO,SECTOR
            ENDIF
            PACK     SIIM1MKY,SIIMCST,SIIMCAT                                                                
            MATCH    SIIM1EKY,SIIM1MKY
            IF       !@EQUAL
              MOVE     SIIM1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIIM1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIIM1 
          BRANCH   OVRCD,NP02L110
          PACK     SIIM1MKY,SIIMCST,SIIMCAT                                                                
          MATCH    SIIM1EKY,SIIM1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIIM1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIIM1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Imprest Summary - Catalog Order    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Catalog                            
.---------------------------------------------------------
UPTSIIM1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIM1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIM1FL1,KEY5;SCPSROW,SCPSCOL,SIIM1MKY
          ELSE
            UPDATE    SIIM1FL1;SCPSROW,SCPSCOL,SIIM1MKY
          ENDIF
          RETURN
RDTSIIM1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIM1FL1,KEY5;SCPSROW,SCPSCOL,SIIM1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIM1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIM1FL1,KEY5;;
          READKS    SIIM1FL1;SCPSROW,SCPSCOL,SIIM1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIM1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Imprest Summary - Catalog Order    
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIIM1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Imprest Summary - Catalog Order    
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Imprest Summary - Catalog Order    
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L102:
                            SF02L103,SF02L104,SF02L006,SF02L105:
                            SF02L106
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIM1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSIIM1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SIIM1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SIIM1MKY,KEY12 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      IMPDET00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIM1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SIIM1MKY,KEY12 
            CALL      RSSIIM1 
            CALL      RPSIIM1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "SIIM1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "SIIM1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L105
          MOVE      "SIIM1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "SIIM1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Backorder Summary                  
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Backorder Summary                  
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Backorder Summary                  
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Backorder Summary                  
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Backorder Summary                  
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     1 Catalog                            
.---------------------------------------------------------
          UNPACK    SP70,SIBACST,SIBACAT,SIBAREQ,SIBAWAR
          PACK      KEY25,SICACODE,SP70
          MOVE      KEY25,SIBA1EKY
          STRIP     SIBA1SKY
          SETLPTR   SIBA1EKY,5
          MOVE      SIBA1EKY,SIBA1SKY
          CALL      RDSIBA1 
          IF        OVRCD=0
            CALL      RPSIBA1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,SIBA1CNT
          MOVE     ZERO,SIBA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L101,DP03L102,DP03L103,DP03L104:
                            DP03L105,DP03L106,DP03L107,DP03L108:
                            DP03L109,DP03L110,DP03L111,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010
          GOTO      DP03L010
.
DP03L101
          PACK      SIBA1MKY,SP70,SP70
          CALL      UPTSIBA1
          IF        SIBA1END=0
            CALL      RKSIBA1 
            IF        OVRCD=0
              PACK      SIBA1MKY,SIBACST,SIBACAT,SIBAREQ,SIBAWAR                                                
              MATCH     SIBA1EKY,SIBA1MKY
              IF        @EQUAL
                MOVE      ZERO,SIBA1END
                ADD       ONE,SIBA1CNT
                CALL      UPTSIBA1
                MOVE      SIBACAT,VAR      
                CALL      DISPITEM
          CALL      BACDET00
              ELSE
                MOVE      ONE,SIBA1END
              ENDIF
            ELSE
              MOVE      ONE,SIBA1END
            ENDIF
          ENDIF
          IF        SIBA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        SIBA1END=0
            MOVE      SIBAREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        SIBA1END=0
            MOVE      SIBAWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        SIBA1END=0
            UNPACK    SIBADAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        SIBA1END=0
            MOVE      SIBAQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L106
          IF        SIBA1END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L107
          IF        SIBA1END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L108
          IF        SIBA1END=0
            MOVE      SIIAAVC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L109
          IF        SIBA1END=0
            MOVE      SIIANAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L110
          IF        SIBA1END=0
            MOVE      SIIAABC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L111
          IF        SIBA1END=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "SIBA1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "SIBA1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY25,SIBA1SKY,SP70
          CALL     RDSIBA1  * Start
          IF       OVRCD=0
            CALL     RPSIBA1  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "SIBA1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY25,SIBA1SKY,Z70
          CALL     RSSIBA1  * End
          IF       OVRCD=1
            CALL     RPSIBA1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIBA1SNO
            CALL     RPSIBA1 
            IF       OVRCD=1
              MOVE     SIBA1SNO,SECTOR
            ENDIF
            PACK     SIBA1MKY,SIBACST,SIBACAT,SIBAREQ,SIBAWAR                                                
            MATCH    SIBA1EKY,SIBA1MKY
            IF       !@EQUAL
              MOVE     SIBA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "SIBA1",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          CALL      RFTSIBA1
          BRANCH   OVRCD,PP03L115
          MOVE      SIBA1MKY,KEY25 
          CALL      RSSIBA1 
PP03L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIBA1SNO
            CALL     RPSIBA1 
            IF       OVRCD=1
              MOVE     SIBA1SNO,SECTOR
            ENDIF
            PACK     SIBA1MKY,SIBACST,SIBACAT,SIBAREQ,SIBAWAR                                                
            MATCH    SIBA1EKY,SIBA1MKY
            IF       !@EQUAL
              MOVE     SIBA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIBA1SNO
            CALL     RKSIBA1 
            IF       OVRCD=1
              MOVE     SIBA1SNO,SECTOR
            ENDIF
            PACK     SIBA1MKY,SIBACST,SIBACAT,SIBAREQ,SIBAWAR                                                
            MATCH    SIBA1EKY,SIBA1MKY
            IF       !@EQUAL
              MOVE     SIBA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "SIBA1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RKSIBA1 
          BRANCH   OVRCD,NP03L110
          PACK     SIBA1MKY,SIBACST,SIBACAT,SIBAREQ,SIBAWAR                                                
          MATCH    SIBA1EKY,SIBA1MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RPSIBA1 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RPSIBA1 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Backorder Summary                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Catalog                            
.---------------------------------------------------------
UPTSIBA1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIBA1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIBA1FL1,KEY5;SCPSROW,SCPSCOL,SIBA1MKY
          ELSE
            UPDATE    SIBA1FL1;SCPSROW,SCPSCOL,SIBA1MKY
          ENDIF
          RETURN
RDTSIBA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIBA1FL1,KEY5;SCPSROW,SCPSCOL,SIBA1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIBA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIBA1FL1,KEY5;;
          READKS    SIBA1FL1;SCPSROW,SCPSCOL,SIBA1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIBA1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Backorder Summary                  
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "SIBA1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Backorder Summary                  
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Backorder Summary                  
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L102:
                            SF03L103,SF03L104,SF03L105,SF03L006:
                            SF03L106
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "SIBA1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          COMPARE   ONE,ACCEPT
          GOTO      SF03L001 IF EQUAL
          CALL      RDTSIBA1
          IF        OVRCD=1
            BEEP
            GOTO      SF03L001
          ENDIF
          MATCH     SP70,SIBA1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF03L001
          ENDIF
          MOVE      SIBA1MKY,KEY25 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      BACSEL00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIBA1
          IF        OVRCD=1
            CALL      FP03L000
          ELSE
            MOVE      SIBA1MKY,KEY25 
            CALL      RSSIBA1 
            CALL      RPSIBA1 
            CALL      DP03L000
          ENDIF
          GOTO     SF03L001
.
SF03L102
          MOVE      "SIBA1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L103
          MOVE      "SIBA1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "SIBA1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "SIBA1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Stock Usage Analysis               
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Stock Usage Analysis               
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Stock Usage Analysis               
.--------------------------------------------------------
KY04L000
.
KY04L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Stock Usage Analysis               
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Stock Usage Analysis               
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Stock Usage Analysis               
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Stock Usage Analysis               
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L101,PS04L102,PS04L103:
                            PS04L104,PS04L105,PS04L106,PS04L107:
                            PS04L108,PS04L109,PS04L110,PS04L111:
                            PS04L112,PS04L113,PS04L114,PS04L115:
                            PS04L116,PS04L117,PS04L118,PS04L119:
                            PS04L120,PS04L121,PS04L122,PS04L123:
                            PS04L124,PS04L125,PS04L126,PS04L127:
                            PS04L128,PS04L129,PS04L130,PS04L131:
                            PS04L132,PS04L133,PS04L134,PS04L135:
                            PS04L136,PS04L137,PS04L138,PS04L139:
                            PS04L140,PS04L141,PS04L142,PS04L143:
                            PS04L144,PS04L145,PS04L146,PS04L147:
                            PS04L148,PS04L149,PS04L150,PS04L151:
                            PS04L152,PS04L153,PS04L154,PS04L155:
                            PS04L156,PS04L157,PS04L158,PS04L159:
                            PS04L160,PS04L161,PS04L162,PS04L163:
                            PS04L164,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L165,PS04L166:
                            PS04L167,PS04L168,PS04L169,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L152
          MOVE      PVAPER01,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L153
          MOVE      PVAPER02,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L154
          MOVE      PVAPER03,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L155
          MOVE      PVAPER04,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L156
          MOVE      PVAPER05,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L157
          MOVE      PVAPER06,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L158
          MOVE      PVAPER07,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L159
          MOVE      PVAPER08,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L160
          MOVE      PVAPER09,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L161
          MOVE      PVAPER10,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L162
          MOVE      PVAPER11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L163
          MOVE      PVAPER12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L164
          MOVE      PVAPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L165
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L166
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L167
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L168
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L169
          MOVE      PVAPER13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Stock Usage Analysis               
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L101:
                            SF04L102,SF04L103,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L104
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPHU0000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
.
SF04L103
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PERANA00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Stock Usage by Commodity Group     
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Stock Usage by Commodity Group     
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Stock Usage by Commodity Group     
.--------------------------------------------------------
KY05L000
.
KY05L110
.
.
          MOVE      "   76",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIGADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIGAA00
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      SIGACOD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   76",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIGADES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY05L120
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECOMY000
          BRANCH    EXIT,KY05L110,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Stock Usage by Commodity Group     
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Stock Usage by Commodity Group     
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Stock Usage by Commodity Group     
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Stock Usage by Commodity Group     
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L101,PS05L102,PS05L103:
                            PS05L104,PS05L105,PS05L106,PS05L107:
                            PS05L108,PS05L109,PS05L110,PS05L111:
                            PS05L112,PS05L113,PS05L114,PS05L115:
                            PS05L116,PS05L117,PS05L118,PS05L119:
                            PS05L120,PS05L121,PS05L122,PS05L123:
                            PS05L124,PS05L125,PS05L126,PS05L127:
                            PS05L128,PS05L129,PS05L130,PS05L131:
                            PS05L132,PS05L133,PS05L134,PS05L135:
                            PS05L136,PS05L137,PS05L138,PS05L139:
                            PS05L140,PS05L141,PS05L142,PS05L143:
                            PS05L144,PS05L145,PS05L146,PS05L147:
                            PS05L148,PS05L149,PS05L150,PS05L151:
                            PS05L152,PS05L153,PS05L154,PS05L155:
                            PS05L156,PS05L157,PS05L158,PS05L159:
                            PS05L160,PS05L161,PS05L162,PS05L163:
                            PS05L164,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L165,PS05L166:
                            PS05L167,PS05L168,PS05L169,PS05L170
          GOTO     PS05L999
.
PS05L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L152
          MOVE      PVAPER01,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L153
          MOVE      PVAPER02,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L154
          MOVE      PVAPER03,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L155
          MOVE      PVAPER04,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L156
          MOVE      PVAPER05,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L157
          MOVE      PVAPER06,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L158
          MOVE      PVAPER07,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L159
          MOVE      PVAPER08,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L160
          MOVE      PVAPER09,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L161
          MOVE      PVAPER10,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L162
          MOVE      PVAPER11,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L163
          MOVE      PVAPER12,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L164
          MOVE      PVAPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L165
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L166
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L167
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L168
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L169
          MOVE      PVAPER13,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L170
          MOVE      SIGADES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Stock Usage by Commodity Group     
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L101:
                            SF05L102,SF05L103,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPHU0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L103
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Stock Usage by Product Group       
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Stock Usage by Product Group       
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Stock Usage by Product Group       
.--------------------------------------------------------
KY06L000
.
KY06L110
.
.
          MOVE      "   76",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSISAA00
          BRANCH    EXIT,KY06L900,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      SISACODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   76",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISADESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY06L120
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EPRDY000
          BRANCH    EXIT,KY06L110,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Stock Usage by Product Group       
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Stock Usage by Product Group       
.---------------------------------------------------------
LM06L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Stock Usage by Product Group       
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Stock Usage by Product Group       
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L101,PS06L102,PS06L103:
                            PS06L104,PS06L105,PS06L106,PS06L107:
                            PS06L108,PS06L109,PS06L110,PS06L111:
                            PS06L112,PS06L113,PS06L114,PS06L115:
                            PS06L116,PS06L117,PS06L118,PS06L119:
                            PS06L120,PS06L121,PS06L122,PS06L123:
                            PS06L124,PS06L125,PS06L126,PS06L127:
                            PS06L128,PS06L129,PS06L130,PS06L131:
                            PS06L132,PS06L133,PS06L134,PS06L135:
                            PS06L136,PS06L137,PS06L138,PS06L139:
                            PS06L140,PS06L141,PS06L142,PS06L143:
                            PS06L144,PS06L145,PS06L146,PS06L147:
                            PS06L148,PS06L149,PS06L150,PS06L151:
                            PS06L152,PS06L153,PS06L154,PS06L155:
                            PS06L156,PS06L157,PS06L158,PS06L159:
                            PS06L160,PS06L161,PS06L162,PS06L163:
                            PS06L164,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L165,PS06L166:
                            PS06L167,PS06L168,PS06L169,PS06L170
          GOTO     PS06L999
.
PS06L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L152
          MOVE      PVAPER01,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L153
          MOVE      PVAPER02,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L154
          MOVE      PVAPER03,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L155
          MOVE      PVAPER04,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L156
          MOVE      PVAPER05,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L157
          MOVE      PVAPER06,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L158
          MOVE      PVAPER07,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L159
          MOVE      PVAPER08,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L160
          MOVE      PVAPER09,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L161
          MOVE      PVAPER10,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L162
          MOVE      PVAPER11,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L163
          MOVE      PVAPER12,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L164
          MOVE      PVAPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L165
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L166
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L167
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L168
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L169
          MOVE      PVAPER13,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L170
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Stock Usage by Product Group       
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L101:
                            SF06L102,SF06L103,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          GOTO     SF06L001
.
SF06L101
          MOVE      ONE,EXIT
          GOTO      SF06L999
.
SF06L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPHU0000
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF06L001
.
SF06L103
          MOVE      ZERO,EXIT
          GOTO      SF06L999
SF06L990  MOVE      ONE,EXIT * Exit Char Restart
SF06L999  RETURN
.--------------------------------
. Screen - Purchase Order Summary             
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Summary             
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Summary             
.--------------------------------------------------------
KY07L000
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Summary             
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Summary             
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :     3 Purchase Order                     
.---------------------------------------------------------
          UNPACK    SP70,SIPCCST,SIPCDAT,SIPCPON,SIPCITM
          PACK      KEY21,SICACODE,SP70
          MOVE      KEY21,SIPC2EKY
          STRIP     SIPC2SKY
          SETLPTR   SIPC2EKY,5
          MOVE      SIPC2EKY,SIPC2SKY
          CALL      RDSIPC2 
          IF        OVRCD=0
            CALL      RPSIPC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,SIPC2CNT
          MOVE     ZERO,SIPC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L010,DP07L101,DP07L010:
                           DP07L102,DP07L103,DP07L104,DP07L105:
                            DP07L106,DP07L107,DP07L108,DP07L109:
                            DP07L110,DP07L111,DP07L112,DP07L113:
                            DP07L114,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010
          GOTO      DP07L010
.
DP07L101
          PACK      SIPC2MKY,SP70,SP70
          CALL      UPTSIPC2
          IF        SIPC2END=0
            CALL      RPSIPC2 
            IF        OVRCD=0
              PACK      SIPC2MKY,SIPCCST,SIPCDAT,SIPCPON,SIPCITM                                                
              MATCH     SIPC2EKY,SIPC2MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC2END
                ADD       ONE,SIPC2CNT
                CALL      UPTSIPC2
                MOVE      SIPCPON,VAR      
                CALL      DISPITEM
          CALL      ORDDET00
              ELSE
                MOVE      ONE,SIPC2END
              ENDIF
            ELSE
              MOVE      ONE,SIPC2END
            ENDIF
          ENDIF
          IF        SIPC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        SIPC2END=0
            MOVE      SIPCITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        SIPC2END=0
            MOVE      PERUSAGE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        SIPC2END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L105
          IF        SIPC2END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L106
          IF        SIPC2END=0
            UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L107
          IF        SIPC2END=0
            MOVE      SIPCTCR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L108
          IF        SIPC2END=0
            MOVE      SIPCRQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L109
          IF        SIPC2END=0
            MOVE      SIPCECT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L110
          IF        SIPC2END=0
            MOVE      SIPASUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L111
          IF        SIPC2END=0
            UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L112
          IF        SIPC2END=0
            UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L113
          IF        SIPC2END=0
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L114
          IF        SIPC2END=0
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "SIPC2",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          MATCH    "SIPC2",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          PACK     KEY21,SIPC2SKY,Z70
          CALL     RDSIPC2  * Start
          IF       OVRCD=0
            CALL     RPSIPC2  * Start
          ENDIF
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          MATCH    "SIPC2",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY21,SIPC2SKY,SP70
          CALL     RSSIPC2  * End
          IF       OVRCD=1
            CALL     RKSIPC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC2SNO
            CALL     RKSIPC2 
            IF       OVRCD=1
              MOVE     SIPC2SNO,SECTOR
            ENDIF
            PACK     SIPC2MKY,SIPCCST,SIPCDAT,SIPCPON,SIPCITM                                                
            MATCH    SIPC2EKY,SIPC2MKY
            IF       !@EQUAL
              MOVE     SIPC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
          MATCH    "SIPC2",NAMSSFFI
          GOTO     PP07L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP07L105
          CALL      RFTSIPC2
          BRANCH   OVRCD,PP07L115
          MOVE      SIPC2MKY,KEY21 
          CALL      RSSIPC2 
PP07L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC2SNO
            CALL     RKSIPC2 
            IF       OVRCD=1
              MOVE     SIPC2SNO,SECTOR
            ENDIF
            PACK     SIPC2MKY,SIPCCST,SIPCDAT,SIPCPON,SIPCITM                                                
            MATCH    SIPC2EKY,SIPC2MKY
            IF       !@EQUAL
              MOVE     SIPC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC2SNO
            CALL     RPSIPC2 
            IF       OVRCD=1
              MOVE     SIPC2SNO,SECTOR
            ENDIF
            PACK     SIPC2MKY,SIPCCST,SIPCDAT,SIPCPON,SIPCITM                                                
            MATCH    SIPC2EKY,SIPC2MKY
            IF       !@EQUAL
              MOVE     SIPC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP07L999
PP07L120
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "SIPC2",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          CALL     RPSIPC2 
          BRANCH   OVRCD,NP07L110
          PACK     SIPC2MKY,SIPCCST,SIPCDAT,SIPCPON,SIPCITM                                                
          MATCH    SIPC2EKY,SIPC2MKY
          GOTO     NP07L110 IF NOT EQUAL
          CALL     RKSIPC2 
          CALL     DP07L000
          GOTO     NP07L999
NP07L110
          CALL     RKSIPC2 
          BEEP
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
CT07L105
CT07L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Order Summary             
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Purchase Order                     
.---------------------------------------------------------
UPTSIPC2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC2FL1,KEY5;SCPSROW,SCPSCOL,SIPC2MKY
          ELSE
            UPDATE    SIPC2FL1;SCPSROW,SCPSCOL,SIPC2MKY
          ENDIF
          RETURN
RDTSIPC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC2FL1,KEY5;SCPSROW,SCPSCOL,SIPC2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC2FL1,KEY5;;
          READKS    SIPC2FL1;SCPSROW,SCPSCOL,SIPC2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Summary             
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "SIPC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Summary             
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Summary             
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L101,SF07L102,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L103,SF07L104,SF07L006:
                           SF07L006,SF07L105,SF07L106
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L102,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L102
          CALL      SELECTED
          BRANCH    EXIT,SF07L001
          COMPARE   ONE,ACCEPT
          GOTO      SF07L001 IF EQUAL
          CALL      RDTSIPC2
          IF        OVRCD=1
            BEEP
            GOTO      SF07L001
          ENDIF
          MATCH     SP70,SIPC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF07L001
          ENDIF
          MOVE      SIPC2MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELORD00
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC2
          IF        OVRCD=1
            CALL      FP07L000
          ELSE
            MOVE      SIPC2MKY,KEY21 
            CALL      RSSIPC2 
            CALL      RKSIPC2 
            CALL      DP07L000
          ENDIF
          GOTO     SF07L001
.
SF07L103
          MOVE      "SIPC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L104
          MOVE      "SIPC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L105
          MOVE      "SIPC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L106
          MOVE      "SIPC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.--------------------------------
. Screen - Outstanding Purchase Orders        
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC08L200
          CALL      CF08L000 * Clear Fields
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Outstanding Purchase Orders        
.-------------------------------------------------------
CF08L000
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Outstanding Purchase Orders        
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Outstanding Purchase Orders        
.---------------------------------------------------------
WP08L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Outstanding Purchase Orders        
.---------------------------------------------------------
LM08L000
.---------------------------------------------------------
. Load for :     3 Purchase Order                     
.---------------------------------------------------------
          UNPACK    SP70,SIPCCST,SIPCEDD,SIPCPON,SIPCITM
          PACK      KEY23,SICACODE,ONE,SP70
          MOVE      KEY23,SIPC5EKY
          STRIP     SIPC5SKY
          SETLPTR   SIPC5EKY,6
          MOVE      SIPC5EKY,SIPC5SKY
          CALL      RDSIPC5 
          IF        OVRCD=0
            CALL      RPSIPC5 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP08L000
          MOVE     ZERO,SIPC5CNT
          MOVE     ZERO,SIPC5END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP08L600
          MATCH    PRGID,SCPSPID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP08L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP08L010,DP08L010,DP08L101,DP08L010:
                           DP08L102,DP08L103,DP08L104,DP08L105:
                            DP08L106,DP08L107,DP08L108,DP08L109:
                            DP08L110,DP08L111,DP08L112,DP08L113:
                            DP08L114,DP08L010,DP08L010,DP08L010:
                           DP08L010,DP08L010,DP08L010
          GOTO      DP08L010
.
DP08L101
          PACK      SIPC5MKY,SP70,SP70
          CALL      UPTSIPC5
          IF        SIPC5END=0
            CALL      RKSIPC5 
            IF        OVRCD=0
              PACK      SIPC5MKY,SIPCCST,SIPCEDD,SIPCPON,SIPCITM                                                
              MATCH     SIPC5EKY,SIPC5MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC5END
                ADD       ONE,SIPC5CNT
                CALL      UPTSIPC5
                MOVE      SIPCPON,VAR      
                CALL      DISPITEM
          CALL      OUTDET00
              ELSE
                MOVE      ONE,SIPC5END
              ENDIF
            ELSE
              MOVE      ONE,SIPC5END
            ENDIF
          ENDIF
          IF        SIPC5END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L102
          IF        SIPC5END=0
            MOVE      SIPCITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L103
          IF        SIPC5END=0
            MOVE      PERUSAGE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L104
          IF        SIPC5END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L105
          IF        SIPC5END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L106
          IF        SIPC5END=0
            UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L107
          IF        SIPC5END=0
            MOVE      OUTQTY,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L108
          IF        SIPC5END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L109
          IF        SIPC5END=0
            MOVE      ITEMCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L110
          IF        SIPC5END=0
            MOVE      SIPASUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L111
          IF        SIPC5END=0
            UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L112
          IF        SIPC5END=0
            UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L113
          IF        SIPC5END=0
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L114
          IF        SIPC5END=0
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
DP08L600
          MATCH    "SIPC5",NAMSSFFI
          GOTO     DP08L605 IF NOT EQUAL
          GOTO     DP08L999
DP08L605
DP08L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP08L000
.
          MATCH    "SIPC5",NAMSSFFI
          GOTO     FP08L105 IF NOT EQUAL
          PACK     KEY23,SIPC5SKY,SP70
          CALL     RDSIPC5  * Start
          IF       OVRCD=0
            CALL     RPSIPC5  * Start
          ENDIF
          CALL     DP08L000
          GOTO     FP08L999
FP08L105
FP08L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP08L000
.
          MATCH    "SIPC5",NAMSSFFI
          GOTO     LP08L105 IF NOT EQUAL
          PACK     KEY23,SIPC5SKY,Z70
          CALL     RSSIPC5  * End
          IF       OVRCD=1
            CALL     RPSIPC5 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC5SNO
            CALL     RPSIPC5 
            IF       OVRCD=1
              MOVE     SIPC5SNO,SECTOR
            ENDIF
            PACK     SIPC5MKY,SIPCCST,SIPCEDD,SIPCPON,SIPCITM                                                
            MATCH    SIPC5EKY,SIPC5MKY
            IF       !@EQUAL
              MOVE     SIPC5SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     LP08L999
LP08L105
LP08L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP08L000
.
          MATCH    "SIPC5",NAMSSFFI
          GOTO     PP08L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP08L105
          CALL      RFTSIPC5
          BRANCH   OVRCD,PP08L115
          MOVE      SIPC5MKY,KEY23 
          CALL      RSSIPC5 
PP08L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC5SNO
            CALL     RPSIPC5 
            IF       OVRCD=1
              MOVE     SIPC5SNO,SECTOR
            ENDIF
            PACK     SIPC5MKY,SIPCCST,SIPCEDD,SIPCPON,SIPCITM                                                
            MATCH    SIPC5EKY,SIPC5MKY
            IF       !@EQUAL
              MOVE     SIPC5SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     PP08L999
PP08L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC5SNO
            CALL     RKSIPC5 
            IF       OVRCD=1
              MOVE     SIPC5SNO,SECTOR
            ENDIF
            PACK     SIPC5MKY,SIPCCST,SIPCEDD,SIPCPON,SIPCITM                                                
            MATCH    SIPC5EKY,SIPC5MKY
            IF       !@EQUAL
              MOVE     SIPC5SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP08L999
PP08L120
PP08L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP08L000
          MATCH    "SIPC5",NAMSSFFI
          GOTO     NP08L115 IF NOT EQUAL
NP08L105
          CALL     RKSIPC5 
          BRANCH   OVRCD,NP08L110
          PACK     SIPC5MKY,SIPCCST,SIPCEDD,SIPCPON,SIPCITM                                                
          MATCH    SIPC5EKY,SIPC5MKY
          GOTO     NP08L110 IF NOT EQUAL
          CALL     RPSIPC5 
          CALL     DP08L000
          GOTO     NP08L999
NP08L110
          CALL     RPSIPC5 
          BEEP
          GOTO     NP08L999
NP08L115
NP08L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT08L000
CT08L105
CT08L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Outstanding Purchase Orders        
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Purchase Order                     
.---------------------------------------------------------
UPTSIPC5
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC5FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC5FL1,KEY5;SCPSROW,SCPSCOL,SIPC5MKY
          ELSE
            UPDATE    SIPC5FL1;SCPSROW,SCPSCOL,SIPC5MKY
          ENDIF
          RETURN
RDTSIPC5
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC5FL1,KEY5;SCPSROW,SCPSCOL,SIPC5MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC5
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC5FL1,KEY5;;
          READKS    SIPC5FL1;SCPSROW,SCPSCOL,SIPC5MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC5MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Outstanding Purchase Orders        
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
          MOVE      "SIPC5",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP08L000
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Outstanding Purchase Orders        
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L999,PS08L999,PS08L999,PS08L999:
                           PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                           PS08L999,PS08L999,PS08L999
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Outstanding Purchase Orders        
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L006,SF08L101,SF08L102,SF08L006:
                           SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L103,SF08L104,SF08L006:
                           SF08L006,SF08L105,SF08L106
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L020,SF08L020,SF08L102,SF08L020:
                           SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                           SF08L020,SF08L020,SF08L020
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC5",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L101
          MOVE      ZERO,EXIT
          GOTO      SF08L999
.
SF08L102
          CALL      SELECTED
          BRANCH    EXIT,SF08L001
          COMPARE   ONE,ACCEPT
          GOTO      SF08L001 IF EQUAL
          CALL      RDTSIPC5
          IF        OVRCD=1
            BEEP
            GOTO      SF08L001
          ENDIF
          MATCH     SP70,SIPC5MKY
          IF        @EQUAL
            BEEP
            GOTO      SF08L001
          ENDIF
          MOVE      SIPC5MKY,KEY23 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELORD00
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC5
          IF        OVRCD=1
            CALL      FP08L000
          ELSE
            MOVE      SIPC5MKY,KEY23 
            CALL      RSSIPC5 
            CALL      RPSIPC5 
            CALL      DP08L000
          ENDIF
          GOTO     SF08L001
.
SF08L103
          MOVE      "SIPC5",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP08L000
          GOTO     SF08L001
.
SF08L104
          MOVE      "SIPC5",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP08L000
          GOTO     SF08L001
.
SF08L105
          MOVE      "SIPC5",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L106
          MOVE      "SIPC5",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP08L000
          GOTO     SF08L001
SF08L990  MOVE      ONE,EXIT * Exit Char Restart
SF08L999  RETURN
.--------------------------------
. Screen - Requisitions Summary               
.--------------------------------
SC09L000
SC09L100
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC09L200
          CALL      CF09L000 * Clear Fields
SC09L300
          CALL      KY09L000 * Enter Key Fields
          BRANCH    EXIT,SC09L999,SC09L999
SC09L400
          CALL      WP09L000 * Load any WP Details
SC09L500
          CALL      LM09L000 * Load any Batch Details
SC09L600
          CALL      DF09L000 * Display Fields
SC09L700
          CALL      SF09L000 * Select Fields
          BRANCH    EXIT,SC09L100,SC09L100,SC09L200
SC09L800
          CALL      DTEMP000
SC09L900
SC09L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Requisitions Summary               
.-------------------------------------------------------
CF09L000
CF09L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Requisitions Summary               
.--------------------------------------------------------
KY09L000
.
KY09L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KYRPD000
          BRANCH    EXIT,KY09L900,KY09L900
          MOVE      ZERO,ACCEPT
          MOVE      CURCODE,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC1,VAR        
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY09L999
.
KY09L900  MOVE      ONE,EXIT
KY09L999  RETURN
.---------------------------------------------------------
. Load WP files for : Requisitions Summary               
.---------------------------------------------------------
WP09L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Requisitions Summary               
.---------------------------------------------------------
LM09L000
.---------------------------------------------------------
. Load for :     6 Requisition Type (Display Key)     
.---------------------------------------------------------
          UNPACK    SP70,SIRACST,SIRADAT,SIRATYP,SIRAREQ
          PACK      KEY21,SICACODE,SP70
          MOVE      KEY21,SIRA4EKY
          STRIP     SIRA4SKY
          SETLPTR   SIRA4EKY,5
          MOVE      SIRA4EKY,SIRA4SKY
          CALL      RDSIRA4 
          IF        OVRCD=0
            CALL      RPSIRA4 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP09L000
          MOVE     ZERO,SIRA4CNT
          MOVE     ZERO,SIRA4END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP09L600
          MATCH    PRGID,SCPSPID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP09L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L101,DP09L102,DP09L103:
                            DP09L104,DP09L105,DP09L106,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010
          GOTO      DP09L010
.
DP09L101
          PACK      SIRA4MKY,SP70,SP70
          CALL      UPTSIRA4
          IF        SIRA4END=0
            CALL      RPSIRA4 
            IF        OVRCD=0
              PACK      SIRA4MKY,SIRACST,SIRADAT,SIRATYP,SIRAREQ                                                
              MATCH     SIRA4EKY,SIRA4MKY
              IF        @EQUAL
                MOVE      ZERO,SIRA4END
                ADD       ONE,SIRA4CNT
                CALL      UPTSIRA4
          CALL      REQDET00
                MOVE      SIRATYP,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIRA4END
              ENDIF
            ELSE
              MOVE      ONE,SIRA4END
            ENDIF
          ENDIF
          IF        SIRA4END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L102
          IF        SIRA4END=0
            MOVE      SIRAREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L103
          IF        SIRA4END=0
            MOVE      REQINDIC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L104
          IF        SIRA4END=0
            MOVE      SIRATOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L105
          IF        SIRA4END=0
            MOVE      SIRADEL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L106
          IF        SIRA4END=0
            UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
DP09L600
          MATCH    "SIRA4",NAMSSFFI
          GOTO     DP09L605 IF NOT EQUAL
          GOTO     DP09L999
DP09L605
DP09L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP09L000
.
          MATCH    "SIRA4",NAMSSFFI
          GOTO     FP09L105 IF NOT EQUAL
          PACK     KEY21,SIRA4SKY,Z70
          CALL     RDSIRA4  * Start
          IF       OVRCD=0
            CALL     RPSIRA4  * Start
          ENDIF
          CALL     DP09L000
          GOTO     FP09L999
FP09L105
FP09L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP09L000
.
          MATCH    "SIRA4",NAMSSFFI
          GOTO     LP09L105 IF NOT EQUAL
          PACK     KEY21,SIRA4SKY,SP70
          CALL     RSSIRA4  * End
          IF       OVRCD=1
            CALL     RKSIRA4 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRA4SNO
            CALL     RKSIRA4 
            IF       OVRCD=1
              MOVE     SIRA4SNO,SECTOR
            ENDIF
            PACK     SIRA4MKY,SIRACST,SIRADAT,SIRATYP,SIRAREQ                                                
            MATCH    SIRA4EKY,SIRA4MKY
            IF       !@EQUAL
              MOVE     SIRA4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     LP09L999
LP09L105
LP09L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP09L000
.
          MATCH    "SIRA4",NAMSSFFI
          GOTO     PP09L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP09L105
          CALL      RFTSIRA4
          BRANCH   OVRCD,PP09L115
          MOVE      SIRA4MKY,KEY21 
          CALL      RSSIRA4 
PP09L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIRA4SNO
            CALL     RKSIRA4 
            IF       OVRCD=1
              MOVE     SIRA4SNO,SECTOR
            ENDIF
            PACK     SIRA4MKY,SIRACST,SIRADAT,SIRATYP,SIRAREQ                                                
            MATCH    SIRA4EKY,SIRA4MKY
            IF       !@EQUAL
              MOVE     SIRA4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     PP09L999
PP09L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRA4SNO
            CALL     RPSIRA4 
            IF       OVRCD=1
              MOVE     SIRA4SNO,SECTOR
            ENDIF
            PACK     SIRA4MKY,SIRACST,SIRADAT,SIRATYP,SIRAREQ                                                
            MATCH    SIRA4EKY,SIRA4MKY
            IF       !@EQUAL
              MOVE     SIRA4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP09L999
PP09L120
PP09L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP09L000
          MATCH    "SIRA4",NAMSSFFI
          GOTO     NP09L115 IF NOT EQUAL
NP09L105
          CALL     RPSIRA4 
          BRANCH   OVRCD,NP09L110
          PACK     SIRA4MKY,SIRACST,SIRADAT,SIRATYP,SIRAREQ                                                
          MATCH    SIRA4EKY,SIRA4MKY
          GOTO     NP09L110 IF NOT EQUAL
          CALL     RKSIRA4 
          CALL     DP09L000
          GOTO     NP09L999
NP09L110
          CALL     RKSIRA4 
          BEEP
          GOTO     NP09L999
NP09L115
NP09L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT09L000
CT09L105
CT09L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Requisitions Summary               
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     6 Requisition Type (Display Key)     
.---------------------------------------------------------
UPTSIRA4
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIRA4FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIRA4FL1,KEY5;SCPSROW,SCPSCOL,SIRA4MKY
          ELSE
            UPDATE    SIRA4FL1;SCPSROW,SCPSCOL,SIRA4MKY
          ENDIF
          RETURN
RDTSIRA4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIRA4FL1,KEY5;SCPSROW,SCPSCOL,SIRA4MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIRA4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIRA4FL1,KEY5;;
          READKS    SIRA4FL1;SCPSROW,SCPSCOL,SIRA4MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIRA4MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Requisitions Summary               
.---------------------------------------------------------
DF09L000
          BRANCH   ACCEPT,DF09L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF09L900
          MATCH    PRGID,SCPSPID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF09L010 IF NOT EQUAL
.
          CALL     PS09L000 * Display Field
          GOTO     DF09L010
DF09L900
          MOVE      "SIRA4",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP09L000
DF09L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Requisitions Summary               
.---------------------------------------------------------
PS09L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L101,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999
          GOTO     PS09L999
.
PS09L101
          MOVE      DESC1,VAR        
          CALL      DISPITEM
          GOTO     PS09L999
PS09L999
          RETURN
.---------------------------------------------------------
. Selections for : Requisitions Summary               
.---------------------------------------------------------
SF09L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF09L001  BRANCH   ACCEPT,SF09L020
.
SF09L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L006,SF09L101,SF09L102,SF09L006:
                            SF09L006,SF09L103,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L104:
                            SF09L105,SF09L006,SF09L006,SF09L106:
                            SF09L107
SF09L006  BEEP
          GOTO     SF09L005
SF09L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF09L090
          MATCH    PRGID,SCSLPID
          GOTO     SF09L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF09L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L103,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020
          GOTO     SF09L020
SF09L090  MOVE     ZERO,ACCEPT
          MOVE      "SIRA4",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L101
          MOVE      ZERO,EXIT
          GOTO      SF09L999
.
SF09L102
          MOVE      ONE,EXIT
          GOTO      SF09L999
.
SF09L103
          CALL      SELECTED
          BRANCH    EXIT,SF09L001
          COMPARE   ONE,ACCEPT
          GOTO      SF09L001 IF EQUAL
          CALL      RDTSIRA4
          IF        OVRCD=1
            BEEP
            GOTO      SF09L001
          ENDIF
          MATCH     SP70,SIRA4MKY
          IF        @EQUAL
            BEEP
            GOTO      SF09L001
          ENDIF
          MOVE      SIRA4MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELREQ00
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIRA4
          IF        OVRCD=1
            CALL      FP09L000
          ELSE
            MOVE      SIRA4MKY,KEY21 
            CALL      RSSIRA4 
            CALL      RKSIRA4 
            CALL      DP09L000
          ENDIF
          GOTO     SF09L001
.
SF09L104
          MOVE      "SIRA4",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      NP09L000
          GOTO     SF09L001
.
SF09L105
          MOVE      "SIRA4",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      PP09L000
          GOTO     SF09L001
.
SF09L106
          MOVE      "SIRA4",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L107
          MOVE      "SIRA4",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      LP09L000
          GOTO     SF09L001
SF09L990  MOVE      ONE,EXIT * Exit Char Restart
SF09L999  RETURN
.--------------------------------
. Screen - Imprest Detail Display             
.--------------------------------
SC10L000
SC10L100
          MOVE      "10",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC10L200
          CALL      CF10L000 * Clear Fields
SC10L300
          CALL      KY10L000 * Enter Key Fields
          BRANCH    EXIT,SC10L999,SC10L999
SC10L400
          CALL      WP10L000 * Load any WP Details
SC10L500
          CALL      LM10L000 * Load any Batch Details
SC10L600
          CALL      DF10L000 * Display Fields
SC10L700
          CALL      SF10L000 * Select Fields
          BRANCH    EXIT,SC10L100,SC10L100,SC10L200
SC10L800
SC10L900
SC10L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Imprest Detail Display             
.-------------------------------------------------------
CF10L000
CF10L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Imprest Detail Display             
.--------------------------------------------------------
KY10L000
          MOVE      ZERO,EXIT
          GOTO      KY10L999
.
KY10L900  MOVE      ONE,EXIT
KY10L999  RETURN
.---------------------------------------------------------
. Load WP files for : Imprest Detail Display             
.---------------------------------------------------------
WP10L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Imprest Detail Display             
.---------------------------------------------------------
LM10L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Imprest Detail Display             
.---------------------------------------------------------
DF10L000
          BRANCH   ACCEPT,DF10L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF10L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF10L900
          MATCH    PRGID,SCPSPID
          GOTO     DF10L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF10L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF10L010 IF NOT EQUAL
.
          CALL     PS10L000 * Display Field
          GOTO     DF10L010
DF10L900
DF10L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Imprest Detail Display             
.---------------------------------------------------------
PS10L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS10L101,PS10L102,PS10L103,PS10L104:
                            PS10L105,PS10L106,PS10L107,PS10L108:
                            PS10L109,PS10L110,PS10L111,PS10L112:
                            PS10L113,PS10L114,PS10L115,PS10L116:
                            PS10L117,PS10L118,PS10L119,PS10L120:
                            PS10L121,PS10L999,PS10L999,PS10L122:
                            PS10L123
          GOTO     PS10L999
.
PS10L101
          MOVE      SIIMCAT,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L102
          MOVE      SIIMSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L103
          MOVE      SIIMMAX,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L104
          MOVE      SIIMREQ,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L105
          MOVE      SIIMQOH,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L106
          MOVE      SIIMUR1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L107
          MOVE      SIIMUR2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L108
          UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L109
          UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L110
          MOVE      SIIMUC1,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L111
          MOVE      SIIMUC2,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIMUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIMUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L114
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L115
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L116
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L117
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L118
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L119
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L120
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L121
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L122
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
.
PS10L123
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS10L999
PS10L999
          RETURN
.---------------------------------------------------------
. Selections for : Imprest Detail Display             
.---------------------------------------------------------
SF10L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF10L001  BRANCH   ACCEPT,SF10L020
.
SF10L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L006,SF10L006:
                            SF10L006,SF10L006,SF10L101,SF10L006:
                            SF10L006
SF10L006  BEEP
          GOTO     SF10L005
SF10L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF10L090
          MATCH    PRGID,SCSLPID
          GOTO     SF10L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF10L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020,SF10L020,SF10L020,SF10L020:
                            SF10L020
          GOTO     SF10L020
SF10L090  MOVE     ZERO,ACCEPT
          GOTO     SF10L001
.
SF10L101
          MOVE      ZERO,EXIT
          GOTO      SF10L999
SF10L990  MOVE      ONE,EXIT * Exit Char Restart
SF10L999  RETURN
.--------------------------------
. Screen - Backorder Detail                   
.--------------------------------
SC11L000
SC11L100
          MOVE      "11",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC11L200
          CALL      CF11L000 * Clear Fields
SC11L300
          CALL      KY11L000 * Enter Key Fields
          BRANCH    EXIT,SC11L999,SC11L999
SC11L400
          CALL      WP11L000 * Load any WP Details
SC11L500
          CALL      LM11L000 * Load any Batch Details
SC11L600
          CALL      DF11L000 * Display Fields
SC11L700
          CALL      SF11L000 * Select Fields
          BRANCH    EXIT,SC11L100,SC11L100,SC11L200
SC11L800
SC11L900
SC11L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Backorder Detail                   
.-------------------------------------------------------
CF11L000
CF11L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Backorder Detail                   
.--------------------------------------------------------
KY11L000
          MOVE      ZERO,EXIT
          GOTO      KY11L999
.
KY11L900  MOVE      ONE,EXIT
KY11L999  RETURN
.---------------------------------------------------------
. Load WP files for : Backorder Detail                   
.---------------------------------------------------------
WP11L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Backorder Detail                   
.---------------------------------------------------------
LM11L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Backorder Detail                   
.---------------------------------------------------------
DF11L000
          BRANCH   ACCEPT,DF11L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF11L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF11L900
          MATCH    PRGID,SCPSPID
          GOTO     DF11L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF11L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF11L010 IF NOT EQUAL
.
          CALL     PS11L000 * Display Field
          GOTO     DF11L010
DF11L900
DF11L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Backorder Detail                   
.---------------------------------------------------------
PS11L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS11L101,PS11L102,PS11L103,PS11L104:
                            PS11L105,PS11L106,PS11L107,PS11L108:
                            PS11L109,PS11L110,PS11L111,PS11L999:
                            PS11L999,PS11L112,PS11L113,PS11L114:
                            PS11L115
          GOTO     PS11L999
.
PS11L101
          MOVE      SIBACAT,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L102
          MOVE      SIBAREQ,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L103
          MOVE      SIBAWAR,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L104
          UNPACK    SIBADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L105
          MOVE      SIBAQTY,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L106
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L107
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L108
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L109
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L110
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L111
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L112
          MOVE      SIPCPON,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L113
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L114
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L115
          MOVE      SIBARESI,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
PS11L999
          RETURN
.---------------------------------------------------------
. Selections for : Backorder Detail                   
.---------------------------------------------------------
SF11L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF11L001  BRANCH   ACCEPT,SF11L020
.
SF11L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L101,SF11L006,SF11L006,SF11L006:
                            SF11L006
SF11L006  BEEP
          GOTO     SF11L005
SF11L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF11L090
          MATCH    PRGID,SCSLPID
          GOTO     SF11L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF11L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020
          GOTO     SF11L020
SF11L090  MOVE     ZERO,ACCEPT
          GOTO     SF11L001
.
SF11L101
          MOVE      ZERO,EXIT
          GOTO      SF11L999
SF11L990  MOVE      ONE,EXIT * Exit Char Restart
SF11L999  RETURN
.--------------------------------
. Screen - Commodity Usage for a Period       
.--------------------------------
SC12L000
SC12L100
          MOVE      "12",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC12L200
          CALL      CF12L000 * Clear Fields
SC12L300
          CALL      KY12L000 * Enter Key Fields
          BRANCH    EXIT,SC12L999,SC12L999
SC12L400
          CALL      WP12L000 * Load any WP Details
SC12L500
          CALL      LM12L000 * Load any Batch Details
SC12L600
          CALL      DF12L000 * Display Fields
SC12L700
          CALL      SF12L000 * Select Fields
          BRANCH    EXIT,SC12L100,SC12L100,SC12L200
SC12L800
SC12L900
SC12L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Commodity Usage for a Period       
.-------------------------------------------------------
CF12L000
CF12L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Commodity Usage for a Period       
.--------------------------------------------------------
KY12L000
          MOVE      ZERO,EXIT
          GOTO      KY12L999
.
KY12L900  MOVE      ONE,EXIT
KY12L999  RETURN
.---------------------------------------------------------
. Load WP files for : Commodity Usage for a Period       
.---------------------------------------------------------
WP12L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Commodity Usage for a Period       
.---------------------------------------------------------
LM12L000
.---------------------------------------------------------
. Load for :     1 Commodity Group                    
.---------------------------------------------------------
          UNPACK    SP70,SICECST,SICEDAT,SICECOM
          PACK      KEY17,SICACODE,FINYEAR,FINPERD,SP70
          MOVE      KEY17,SICE1EKY
          STRIP     SICE1SKY
          SETLPTR   SICE1EKY,11
          MOVE      SICE1EKY,SICE1SKY
          CALL      RDSICE1 
          IF        OVRCD=0
            CALL      RPSICE1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP12L000
          MOVE     ZERO,SICE1CNT
          MOVE     ZERO,SICE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP12L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP12L600
          MATCH    PRGID,SCPSPID
          GOTO     DP12L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP12L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP12L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP12L101,DP12L102,DP12L103,DP12L104:
                            DP12L010,DP12L010,DP12L010,DP12L010:
                            DP12L010,DP12L010,DP12L010,DP12L010:
                            DP12L105,DP12L106,DP12L010
          GOTO      DP12L010
.
DP12L101
          IF        SICE1END=0
            CALL      RKSICE1 
            IF        OVRCD=0
              PACK      SICE1MKY,SICECST,SICEDAT,SICECOM                                                        
              MATCH     SICE1EKY,SICE1MKY
              IF        @EQUAL
                MOVE      ZERO,SICE1END
                ADD       ONE,SICE1CNT
                MOVE      SICECOM,VAR      
                CALL      DISPITEM
          CALL      REDCOM00
              ELSE
                MOVE      ONE,SICE1END
              ENDIF
            ELSE
              MOVE      ONE,SICE1END
            ENDIF
          ENDIF
          IF        SICE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP12L010
.
DP12L102
          IF        SICE1END=0
            MOVE      SICEAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP12L010
.
DP12L103
          IF        SICE1END=0
            MOVE      SICEBUD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP12L010
.
DP12L104
          IF        SICE1END=0
            MOVE      SIGADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP12L010
.
DP12L105
          IF        SICE1END=0
            MOVE      VARIANCE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP12L010
.
DP12L106
          IF        SICE1END=0
            MOVE      PVARIANC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP12L010
DP12L600
          MATCH    "SICE1",NAMSSFFI
          GOTO     DP12L605 IF NOT EQUAL
          GOTO     DP12L999
DP12L605
DP12L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP12L000
.
          MATCH    "SICE1",NAMSSFFI
          GOTO     FP12L105 IF NOT EQUAL
          PACK     KEY17,SICE1SKY,SP70
          CALL     RDSICE1  * Start
          IF       OVRCD=0
            CALL     RPSICE1  * Start
          ENDIF
          CALL     DP12L000
          GOTO     FP12L999
FP12L105
FP12L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP12L000
.
          MATCH    "SICE1",NAMSSFFI
          GOTO     LP12L105 IF NOT EQUAL
          PACK     KEY17,SICE1SKY,Z70
          CALL     RSSICE1  * End
          IF       OVRCD=1
            CALL     RPSICE1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICE1SNO
            CALL     RPSICE1 
            IF       OVRCD=1
              MOVE     SICE1SNO,SECTOR
            ENDIF
            PACK     SICE1MKY,SICECST,SICEDAT,SICECOM                                                        
            MATCH    SICE1EKY,SICE1MKY
            IF       !@EQUAL
              MOVE     SICE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP12L000
          GOTO     LP12L999
LP12L105
LP12L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP12L000
.
          MATCH    "SICE1",NAMSSFFI
          GOTO     PP12L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP12L105
          COMPARE  SECTOR,SICE1SNO
          GOTO     PP12L110 IF EQUAL
          CALL     RPSICE1 
          BRANCH   OVRCD,PP12L115
          PACK     SICE1MKY,SICECST,SICEDAT,SICECOM                                                        
          MATCH    SICE1EKY,SICE1MKY
          GOTO     PP12L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP12L105
PP12L110
          MOVE     ZERO,SECTOR
          IF       SICE1CNT=SICE1SNO
            SUB      ONE,SICE1CNT
          ENDIF
          WHILE    SECTOR<=SICE1CNT
            CALL     RPSICE1 
            IF       OVRCD=1
              MOVE     SICE1SNO,SECTOR
            ENDIF
            PACK     SICE1MKY,SICECST,SICEDAT,SICECOM                                                        
            MATCH    SICE1EKY,SICE1MKY
            IF       !@EQUAL
              MOVE     SICE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP12L000
          GOTO     PP12L999
PP12L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICE1SNO
            CALL     RKSICE1 
            IF       OVRCD=1
              MOVE     SICE1SNO,SECTOR
            ENDIF
            PACK     SICE1MKY,SICECST,SICEDAT,SICECOM                                                        
            MATCH    SICE1EKY,SICE1MKY
            IF       !@EQUAL
              MOVE     SICE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP12L999
PP12L120
PP12L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP12L000
          MATCH    "SICE1",NAMSSFFI
          GOTO     NP12L115 IF NOT EQUAL
NP12L105
          CALL     RKSICE1 
          BRANCH   OVRCD,NP12L110
          PACK     SICE1MKY,SICECST,SICEDAT,SICECOM                                                        
          MATCH    SICE1EKY,SICE1MKY
          GOTO     NP12L110 IF NOT EQUAL
          CALL     RPSICE1 
          CALL     DP12L000
          GOTO     NP12L999
NP12L110
          CALL     RPSICE1 
          BEEP
          GOTO     NP12L999
NP12L115
NP12L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT12L000
CT12L105
CT12L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Commodity Usage for a Period       
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Commodity Usage for a Period       
.---------------------------------------------------------
DF12L000
          BRANCH   ACCEPT,DF12L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF12L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF12L900
          MATCH    PRGID,SCPSPID
          GOTO     DF12L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF12L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF12L010 IF NOT EQUAL
.
          CALL     PS12L000 * Display Field
          GOTO     DF12L010
DF12L900
          MOVE      "SICE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP12L000
DF12L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Commodity Usage for a Period       
.---------------------------------------------------------
PS12L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS12L999,PS12L999,PS12L999,PS12L999:
                            PS12L999,PS12L999,PS12L999,PS12L999:
                            PS12L999,PS12L999,PS12L101,PS12L102:
                            PS12L999,PS12L999,PS12L999
          GOTO     PS12L999
.
PS12L101
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L102
          MOVE      FINPERD,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
PS12L999
          RETURN
.---------------------------------------------------------
. Selections for : Commodity Usage for a Period       
.---------------------------------------------------------
SF12L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF12L001  BRANCH   ACCEPT,SF12L020
.
SF12L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L101,SF12L102,SF12L103,SF12L104:
                            SF12L006,SF12L105,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L106
SF12L006  BEEP
          GOTO     SF12L005
SF12L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF12L090
          MATCH    PRGID,SCSLPID
          GOTO     SF12L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF12L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020
          GOTO     SF12L020
SF12L090  MOVE     ZERO,ACCEPT
          MOVE      "SICE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP12L000
          GOTO     SF12L001
.
SF12L101
          MOVE      "SICE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP12L000
          GOTO     SF12L001
.
SF12L102
          MOVE      "SICE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP12L000
          GOTO     SF12L001
.
SF12L103
          MOVE      "SICE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP12L000
          GOTO     SF12L001
.
SF12L104
          MOVE      "SICE1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP12L000
          GOTO     SF12L001
.
SF12L105
          MOVE      ZERO,EXIT
          GOTO      SF12L999
.
SF12L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPER0000
          MOVE      "12",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF12L000
          GOTO      SF12L001
SF12L990  MOVE      ONE,EXIT * Exit Char Restart
SF12L999  RETURN
.--------------------------------
. Screen - Product Group Usage for a Period   
.--------------------------------
SC13L000
SC13L100
          MOVE      "13",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC13L200
          CALL      CF13L000 * Clear Fields
SC13L300
          CALL      KY13L000 * Enter Key Fields
          BRANCH    EXIT,SC13L999,SC13L999
SC13L400
          CALL      WP13L000 * Load any WP Details
SC13L500
          CALL      LM13L000 * Load any Batch Details
SC13L600
          CALL      DF13L000 * Display Fields
SC13L700
          CALL      SF13L000 * Select Fields
          BRANCH    EXIT,SC13L100,SC13L100,SC13L200
SC13L800
SC13L900
SC13L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Product Group Usage for a Period   
.-------------------------------------------------------
CF13L000
CF13L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Product Group Usage for a Period   
.--------------------------------------------------------
KY13L000
          MOVE      ZERO,EXIT
          GOTO      KY13L999
.
KY13L900  MOVE      ONE,EXIT
KY13L999  RETURN
.---------------------------------------------------------
. Load WP files for : Product Group Usage for a Period   
.---------------------------------------------------------
WP13L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Product Group Usage for a Period   
.---------------------------------------------------------
LM13L000
.---------------------------------------------------------
. Load for :     1 Product Group Code                 
.---------------------------------------------------------
          UNPACK    SP70,SICFCST,SICFDAT,SICFSUB
          PACK      KEY16,SICACODE,FINYEAR,FINPERD,SP70
          MOVE      KEY16,SICF1EKY
          STRIP     SICF1SKY
          SETLPTR   SICF1EKY,11
          MOVE      SICF1EKY,SICF1SKY
          CALL      RDSICF1 
          IF        OVRCD=0
            CALL      RPSICF1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP13L000
          MOVE     ZERO,SICF1CNT
          MOVE     ZERO,SICF1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP13L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP13L600
          MATCH    PRGID,SCPSPID
          GOTO     DP13L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP13L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP13L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP13L101,DP13L102,DP13L103,DP13L104:
                            DP13L010,DP13L010,DP13L010,DP13L010:
                            DP13L010,DP13L010,DP13L010,DP13L010:
                            DP13L105,DP13L106,DP13L010
          GOTO      DP13L010
.
DP13L101
          IF        SICF1END=0
            CALL      RKSICF1 
            IF        OVRCD=0
              PACK      SICF1MKY,SICFCST,SICFDAT,SICFSUB                                                        
              MATCH     SICF1EKY,SICF1MKY
              IF        @EQUAL
                MOVE      ZERO,SICF1END
                ADD       ONE,SICF1CNT
                MOVE      SICFSUB,VAR      
                CALL      DISPITEM
          CALL      REDSUB00
              ELSE
                MOVE      ONE,SICF1END
              ENDIF
            ELSE
              MOVE      ONE,SICF1END
            ENDIF
          ENDIF
          IF        SICF1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP13L010
.
DP13L102
          IF        SICF1END=0
            MOVE      SICFAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP13L010
.
DP13L103
          IF        SICF1END=0
            MOVE      SICFBUD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP13L010
.
DP13L104
          IF        SICF1END=0
            MOVE      SISADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP13L010
.
DP13L105
          IF        SICF1END=0
            MOVE      VARIANCE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP13L010
.
DP13L106
          IF        SICF1END=0
            MOVE      PVARIANC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP13L010
DP13L600
          MATCH    "SICF1",NAMSSFFI
          GOTO     DP13L605 IF NOT EQUAL
          GOTO     DP13L999
DP13L605
DP13L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP13L000
.
          MATCH    "SICF1",NAMSSFFI
          GOTO     FP13L105 IF NOT EQUAL
          PACK     KEY16,SICF1SKY,SP70
          CALL     RDSICF1  * Start
          IF       OVRCD=0
            CALL     RPSICF1  * Start
          ENDIF
          CALL     DP13L000
          GOTO     FP13L999
FP13L105
FP13L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP13L000
.
          MATCH    "SICF1",NAMSSFFI
          GOTO     LP13L105 IF NOT EQUAL
          PACK     KEY16,SICF1SKY,Z70
          CALL     RSSICF1  * End
          IF       OVRCD=1
            CALL     RPSICF1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICF1SNO
            CALL     RPSICF1 
            IF       OVRCD=1
              MOVE     SICF1SNO,SECTOR
            ENDIF
            PACK     SICF1MKY,SICFCST,SICFDAT,SICFSUB                                                        
            MATCH    SICF1EKY,SICF1MKY
            IF       !@EQUAL
              MOVE     SICF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP13L000
          GOTO     LP13L999
LP13L105
LP13L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP13L000
.
          MATCH    "SICF1",NAMSSFFI
          GOTO     PP13L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP13L105
          COMPARE  SECTOR,SICF1SNO
          GOTO     PP13L110 IF EQUAL
          CALL     RPSICF1 
          BRANCH   OVRCD,PP13L115
          PACK     SICF1MKY,SICFCST,SICFDAT,SICFSUB                                                        
          MATCH    SICF1EKY,SICF1MKY
          GOTO     PP13L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP13L105
PP13L110
          MOVE     ZERO,SECTOR
          IF       SICF1CNT=SICF1SNO
            SUB      ONE,SICF1CNT
          ENDIF
          WHILE    SECTOR<=SICF1CNT
            CALL     RPSICF1 
            IF       OVRCD=1
              MOVE     SICF1SNO,SECTOR
            ENDIF
            PACK     SICF1MKY,SICFCST,SICFDAT,SICFSUB                                                        
            MATCH    SICF1EKY,SICF1MKY
            IF       !@EQUAL
              MOVE     SICF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP13L000
          GOTO     PP13L999
PP13L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICF1SNO
            CALL     RKSICF1 
            IF       OVRCD=1
              MOVE     SICF1SNO,SECTOR
            ENDIF
            PACK     SICF1MKY,SICFCST,SICFDAT,SICFSUB                                                        
            MATCH    SICF1EKY,SICF1MKY
            IF       !@EQUAL
              MOVE     SICF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP13L999
PP13L120
PP13L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP13L000
          MATCH    "SICF1",NAMSSFFI
          GOTO     NP13L115 IF NOT EQUAL
NP13L105
          CALL     RKSICF1 
          BRANCH   OVRCD,NP13L110
          PACK     SICF1MKY,SICFCST,SICFDAT,SICFSUB                                                        
          MATCH    SICF1EKY,SICF1MKY
          GOTO     NP13L110 IF NOT EQUAL
          CALL     RPSICF1 
          CALL     DP13L000
          GOTO     NP13L999
NP13L110
          CALL     RPSICF1 
          BEEP
          GOTO     NP13L999
NP13L115
NP13L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT13L000
CT13L105
CT13L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Product Group Usage for a Period   
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Product Group Usage for a Period   
.---------------------------------------------------------
DF13L000
          BRANCH   ACCEPT,DF13L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF13L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF13L900
          MATCH    PRGID,SCPSPID
          GOTO     DF13L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF13L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF13L010 IF NOT EQUAL
.
          CALL     PS13L000 * Display Field
          GOTO     DF13L010
DF13L900
          MOVE      "SICF1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP13L000
DF13L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Product Group Usage for a Period   
.---------------------------------------------------------
PS13L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS13L999,PS13L999,PS13L999,PS13L999:
                            PS13L999,PS13L999,PS13L999,PS13L999:
                            PS13L999,PS13L999,PS13L101,PS13L102:
                            PS13L999,PS13L999,PS13L999
          GOTO     PS13L999
.
PS13L101
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
.
PS13L102
          MOVE      FINPERD,VAR      
          CALL      DISPITEM
          GOTO     PS13L999
PS13L999
          RETURN
.---------------------------------------------------------
. Selections for : Product Group Usage for a Period   
.---------------------------------------------------------
SF13L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF13L001  BRANCH   ACCEPT,SF13L020
.
SF13L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF13L006,SF13L006,SF13L006,SF13L006:
                            SF13L101,SF13L102,SF13L103,SF13L104:
                            SF13L006,SF13L105,SF13L006,SF13L006:
                            SF13L006,SF13L006,SF13L106
SF13L006  BEEP
          GOTO     SF13L005
SF13L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF13L090
          MATCH    PRGID,SCSLPID
          GOTO     SF13L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF13L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020,SF13L020:
                            SF13L020,SF13L020,SF13L020
          GOTO     SF13L020
SF13L090  MOVE     ZERO,ACCEPT
          MOVE      "SICF1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP13L000
          GOTO     SF13L001
.
SF13L101
          MOVE      "SICF1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP13L000
          GOTO     SF13L001
.
SF13L102
          MOVE      "SICF1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP13L000
          GOTO     SF13L001
.
SF13L103
          MOVE      "SICF1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP13L000
          GOTO     SF13L001
.
SF13L104
          MOVE      "SICF1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP13L000
          GOTO     SF13L001
.
SF13L105
          MOVE      ZERO,EXIT
          GOTO      SF13L999
.
SF13L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPER0000
          MOVE      "13",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF13L000
          GOTO      SF13L001
SF13L990  MOVE      ONE,EXIT * Exit Char Restart
SF13L999  RETURN
.--------------------------------
. Screen - Purchase Order Details             
.--------------------------------
SC14L000
SC14L100
          MOVE      "14",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC14L200
          CALL      CF14L000 * Clear Fields
SC14L300
          CALL      KY14L000 * Enter Key Fields
          BRANCH    EXIT,SC14L999,SC14L999
SC14L400
          CALL      WP14L000 * Load any WP Details
SC14L500
          CALL      LM14L000 * Load any Batch Details
SC14L600
          CALL      DF14L000 * Display Fields
SC14L700
          CALL      SF14L000 * Select Fields
          BRANCH    EXIT,SC14L100,SC14L100,SC14L200
SC14L800
SC14L900
SC14L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Details             
.-------------------------------------------------------
CF14L000
CF14L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Details             
.--------------------------------------------------------
KY14L000
          MOVE      ZERO,EXIT
          GOTO      KY14L999
.
KY14L900  MOVE      ONE,EXIT
KY14L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Details             
.---------------------------------------------------------
WP14L000
          PREP     TEMPWORD,FILSIPD1
          PACK     KEY13,SIPCPON,SIPCITM,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDSIPD1 
          IF        OVRCD=0
            CALL      RPSIPD1 
          ENDIF
WP14L100
          CALL     RKSIPD1 
          BRANCH   OVRCD,WP14L105
          PACK     KEY13,SIPDPON,SIPDITM,SIPDLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP14L105 IF NOT EQUAL
          PACK     VAR,SIPDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP14L100
WP14L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Details             
.---------------------------------------------------------
LM14L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Details             
.---------------------------------------------------------
DF14L000
          BRANCH   ACCEPT,DF14L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF14L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF14L900
          MATCH    PRGID,SCPSPID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF14L010 IF NOT EQUAL
.
          CALL     PS14L000 * Display Field
          GOTO     DF14L010
DF14L900
DF14L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Details             
.---------------------------------------------------------
PS14L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS14L999,PS14L999,PS14L101,PS14L102:
                            PS14L103,PS14L104,PS14L105,PS14L106:
                            PS14L107,PS14L108,PS14L109,PS14L110:
                            PS14L111,PS14L112,PS14L113,PS14L114:
                            PS14L115,PS14L116,PS14L117,PS14L118:
                            PS14L119,PS14L120,PS14L121,PS14L122:
                            PS14L123,PS14L124,PS14L125,PS14L126:
                            PS14L127,PS14L128,PS14L129,PS14L130:
                            PS14L131,PS14L132,PS14L133,PS14L134:
                            PS14L135,PS14L136,PS14L137,PS14L138:
                            PS14L139,PS14L140,PS14L141,PS14L142:
                            PS14L143,PS14L144,PS14L145,PS14L146:
                            PS14L147,PS14L148,PS14L149,PS14L150:
                            PS14L151,PS14L152,PS14L153,PS14L154:
                            PS14L155,PS14L156
          GOTO     PS14L999
.
PS14L101
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L102
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L103
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L104
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L105
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L106
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L107
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L108
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L109
          UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L110
          UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L111
          UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L112
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L113
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L114
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L115
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L116
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L117
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L120
          MOVE      SIPCITM,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L121
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L122
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L123
          UNPACK    SIPCFDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L124
          MOVE      SIPCWAR,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L125
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L126
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L127
          MOVE      ITEMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L128
          MOVE      SIPCCON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L129
          UNPACK    SIPCCDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L130
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L131
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L132
          MOVE      ORDQTY,VAR       
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L133
          MOVE      SIPCIQT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L134
          MOVE      SIPCRQT,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L135
          MOVE      ITEMCOST,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L136
          MOVE      SIPCTCR,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L137
          MOVE      SIPCTIN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L138
          MOVE      SIPCOQO,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L139
          MOVE      SIPCOOP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L140
          MOVE      SIPCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L141
          MOVE      SIPCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L142
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L143
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L145
          MOVE      SIPCUY2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L146
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L147
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L148
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L149
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L150
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L151
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L152
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L153
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L154
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L155
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L156
          MOVE     FILSIPD1,WORDNAME
          CALL     DISPWORD
          GOTO     PS14L999
PS14L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Details             
.---------------------------------------------------------
SF14L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF14L001  BRANCH   ACCEPT,SF14L020
.
SF14L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L006,SF14L101,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L102
SF14L006  BEEP
          GOTO     SF14L005
SF14L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF14L090
          MATCH    PRGID,SCSLPID
          GOTO     SF14L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF14L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L102
          GOTO     SF14L020
SF14L090  MOVE     ZERO,ACCEPT
          GOTO     SF14L001
.
SF14L101
          MOVE      ZERO,EXIT
          GOTO      SF14L999
.
SF14L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPD1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPD1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF14L001
SF14L990  MOVE      ONE,EXIT * Exit Char Restart
SF14L999  RETURN
.--------------------------------
. Screen - Requisition Details                
.--------------------------------
SC15L000
SC15L100
          MOVE      "15",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC15L200
          CALL      CF15L000 * Clear Fields
SC15L300
          CALL      KY15L000 * Enter Key Fields
          BRANCH    EXIT,SC15L999,SC15L999
SC15L400
          CALL      WP15L000 * Load any WP Details
SC15L500
          CALL      LM15L000 * Load any Batch Details
SC15L600
          CALL      DF15L000 * Display Fields
SC15L700
          CALL      SF15L000 * Select Fields
          BRANCH    EXIT,SC15L100,SC15L100,SC15L200
SC15L800
SC15L900
SC15L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Requisition Details                
.-------------------------------------------------------
CF15L000
CF15L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Requisition Details                
.--------------------------------------------------------
KY15L000
          MOVE      ZERO,EXIT
          GOTO      KY15L999
.
KY15L900  MOVE      ONE,EXIT
KY15L999  RETURN
.---------------------------------------------------------
. Load WP files for : Requisition Details                
.---------------------------------------------------------
WP15L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Requisition Details                
.---------------------------------------------------------
LM15L000
.---------------------------------------------------------
. Load for :    10 Warehouse                          
.---------------------------------------------------------
          UNPACK    SP70,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT
          PACK      KEY20,SIRATYP,SIRAREQ,SP70
          MOVE      KEY20,SIRB1EKY
          STRIP     SIRB1SKY
          SETLPTR   SIRB1EKY,8
          MOVE      SIRB1EKY,SIRB1SKY
          CALL      RDSIRB1 
          IF        OVRCD=0
            CALL      RPSIRB1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP15L000
          MOVE     ZERO,SIRB1CNT
          MOVE     ZERO,SIRB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP15L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP15L600
          MATCH    PRGID,SCPSPID
          GOTO     DP15L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP15L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP15L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP15L010,DP15L010,DP15L010,DP15L010:
                           DP15L010,DP15L010,DP15L010,DP15L010:
                           DP15L010,DP15L101,DP15L010,DP15L010:
                           DP15L102,DP15L103,DP15L104,DP15L105:
                            DP15L106,DP15L010,DP15L010,DP15L010:
                            DP15L010,DP15L010,DP15L010,DP15L010:
                            DP15L010,DP15L010
          GOTO      DP15L010
.
DP15L101
          IF        SIRB1END=0
            CALL      RKSIRB1 
            IF        OVRCD=0
              PACK      SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
              MATCH     SIRB1EKY,SIRB1MKY
              IF        @EQUAL
                MOVE      ZERO,SIRB1END
                ADD       ONE,SIRB1CNT
          CALL      CWAR0000
                MOVE      SIRBWAR,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIRB1END
              ENDIF
            ELSE
              MOVE      ONE,SIRB1END
            ENDIF
          ENDIF
          IF        SIRB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP15L010
.
DP15L102
          IF        SIRB1END=0
            MOVE      SIRBRQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP15L010
.
DP15L103
          IF        SIRB1END=0
            MOVE      SIRBIQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP15L010
.
DP15L104
          IF        SIRB1END=0
            MOVE      SIRBAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP15L010
.
DP15L105
          IF        SIRB1END=0
            UNPACK    SIRBDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP15L010
.
DP15L106
          IF        SIRB1END=0
            MOVE      SIRBCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP15L010
DP15L600
          MATCH    "SIRB1",NAMSSFFI
          GOTO     DP15L605 IF NOT EQUAL
          GOTO     DP15L999
DP15L605
DP15L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP15L000
.
          MATCH    "SIRB1",NAMSSFFI
          GOTO     FP15L105 IF NOT EQUAL
          PACK     KEY20,SIRB1SKY,SP70
          CALL     RDSIRB1  * Start
          IF       OVRCD=0
            CALL     RPSIRB1  * Start
          ENDIF
          CALL     DP15L000
          GOTO     FP15L999
FP15L105
FP15L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP15L000
.
          MATCH    "SIRB1",NAMSSFFI
          GOTO     LP15L105 IF NOT EQUAL
          PACK     KEY20,SIRB1SKY,Z70
          CALL     RSSIRB1  * End
          IF       OVRCD=1
            CALL     RPSIRB1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRB1SNO
            CALL     RPSIRB1 
            IF       OVRCD=1
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
            MATCH    SIRB1EKY,SIRB1MKY
            IF       !@EQUAL
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP15L000
          GOTO     LP15L999
LP15L105
LP15L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP15L000
.
          MATCH    "SIRB1",NAMSSFFI
          GOTO     PP15L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP15L105
          COMPARE  SECTOR,SIRB1SNO
          GOTO     PP15L110 IF EQUAL
          CALL     RPSIRB1 
          BRANCH   OVRCD,PP15L115
          PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
          MATCH    SIRB1EKY,SIRB1MKY
          GOTO     PP15L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP15L105
PP15L110
          MOVE     ZERO,SECTOR
          IF       SIRB1CNT=SIRB1SNO
            SUB      ONE,SIRB1CNT
          ENDIF
          WHILE    SECTOR<=SIRB1CNT
            CALL     RPSIRB1 
            IF       OVRCD=1
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
            MATCH    SIRB1EKY,SIRB1MKY
            IF       !@EQUAL
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP15L000
          GOTO     PP15L999
PP15L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRB1SNO
            CALL     RKSIRB1 
            IF       OVRCD=1
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
            MATCH    SIRB1EKY,SIRB1MKY
            IF       !@EQUAL
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP15L999
PP15L120
PP15L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP15L000
          MATCH    "SIRB1",NAMSSFFI
          GOTO     NP15L115 IF NOT EQUAL
NP15L105
          CALL     RKSIRB1 
          BRANCH   OVRCD,NP15L110
          PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
          MATCH    SIRB1EKY,SIRB1MKY
          GOTO     NP15L110 IF NOT EQUAL
          CALL     RPSIRB1 
          CALL     DP15L000
          GOTO     NP15L999
NP15L110
          CALL     RPSIRB1 
          BEEP
          GOTO     NP15L999
NP15L115
NP15L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT15L000
CT15L105
CT15L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Requisition Details                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Requisition Details                
.---------------------------------------------------------
DF15L000
          BRANCH   ACCEPT,DF15L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF15L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF15L900
          MATCH    PRGID,SCPSPID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF15L010 IF NOT EQUAL
.
          CALL     PS15L000 * Display Field
          GOTO     DF15L010
DF15L900
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP15L000
DF15L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Requisition Details                
.---------------------------------------------------------
PS15L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS15L999,PS15L999,PS15L999,PS15L999:
                           PS15L101,PS15L102,PS15L103,PS15L999:
                           PS15L999,PS15L999,PS15L999,PS15L999:
                           PS15L999,PS15L999,PS15L999,PS15L999:
                            PS15L999,PS15L104,PS15L105,PS15L106:
                            PS15L107,PS15L108,PS15L999,PS15L999:
                            PS15L999,PS15L999
          GOTO     PS15L999
.
PS15L101
          MOVE      SIRATOT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L102
          CALL      REQDET00
          MOVE      SIRATYP,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L103
          MOVE      SIRAREQ,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L104
          UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L105
          MOVE      SIRADEL,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L106
          MOVE      REQINDIC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L107
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L108
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
PS15L999
          RETURN
.---------------------------------------------------------
. Selections for : Requisition Details                
.---------------------------------------------------------
SF15L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF15L001  BRANCH   ACCEPT,SF15L020
.
SF15L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L006,SF15L101,SF15L006,SF15L006:
                           SF15L006,SF15L006,SF15L006,SF15L006:
                           SF15L006,SF15L006,SF15L006,SF15L006:
                           SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L102,SF15L103:
                            SF15L104,SF15L105
SF15L006  BEEP
          GOTO     SF15L005
SF15L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF15L090
          MATCH    PRGID,SCSLPID
          GOTO     SF15L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF15L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L020,SF15L020,SF15L020,SF15L020:
                           SF15L020,SF15L020,SF15L020,SF15L020:
                           SF15L020,SF15L020,SF15L020,SF15L020:
                           SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020
          GOTO     SF15L020
SF15L090  MOVE     ZERO,ACCEPT
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP15L000
          GOTO     SF15L001
.
SF15L101
          MOVE      ZERO,EXIT
          GOTO      SF15L999
.
SF15L102
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP15L000
          GOTO     SF15L001
.
SF15L103
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP15L000
          GOTO     SF15L001
.
SF15L104
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP15L000
          GOTO     SF15L001
.
SF15L105
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP15L000
          GOTO     SF15L001
SF15L990  MOVE      ONE,EXIT * Exit Char Restart
SF15L999  RETURN
.--------------------------------
. Screen - Outstanding Purchase Requisitions  
.--------------------------------
SC16L000
SC16L100
          MOVE      "16",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC16L200
          CALL      CF16L000 * Clear Fields
SC16L300
          CALL      KY16L000 * Enter Key Fields
          BRANCH    EXIT,SC16L999,SC16L999
SC16L400
          CALL      WP16L000 * Load any WP Details
SC16L500
          CALL      LM16L000 * Load any Batch Details
SC16L600
          CALL      DF16L000 * Display Fields
SC16L700
          CALL      SF16L000 * Select Fields
          BRANCH    EXIT,SC16L100,SC16L100,SC16L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC16L800
SC16L900
SC16L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Outstanding Purchase Requisitions  
.-------------------------------------------------------
CF16L000
CF16L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Outstanding Purchase Requisitions  
.--------------------------------------------------------
KY16L000
          MOVE      ZERO,EXIT
          GOTO      KY16L999
.
KY16L900  MOVE      ONE,EXIT
KY16L999  RETURN
.---------------------------------------------------------
. Load WP files for : Outstanding Purchase Requisitions  
.---------------------------------------------------------
WP16L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Outstanding Purchase Requisitions  
.---------------------------------------------------------
LM16L000
.---------------------------------------------------------
. Load for :     3 Purchase Requisition               
.---------------------------------------------------------
          UNPACK    SP70,SIQACST,SIQARID
          PACK      KEY13,SICACODE,Z70
          MOVE      KEY13,SIQA1EKY
          STRIP     SIQA1SKY
          SETLPTR   SIQA1EKY,5
          MOVE      SIQA1EKY,SIQA1SKY
          CALL      RDSIQA1 
          IF        OVRCD=0
            CALL      RPSIQA1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP16L000
          MOVE     ZERO,SIQA1CNT
          MOVE     ZERO,SIQA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP16L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP16L600
          MATCH    PRGID,SCPSPID
          GOTO     DP16L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP16L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP16L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP16L010,DP16L010,DP16L101,DP16L102:
                            DP16L103,DP16L104,DP16L105,DP16L106:
                            DP16L107,DP16L108,DP16L109,DP16L110:
                            DP16L111,DP16L112,DP16L113,DP16L114:
                            DP16L010,DP16L010,DP16L010,DP16L010:
                           DP16L010,DP16L010
          GOTO      DP16L010
.
DP16L101
          PACK      SIQA1MKY,SP70,SP70
          CALL      UPTSIQA1
          IF        SIQA1END=0
            CALL      RPSIQA1 
            IF        OVRCD=0
              PACK      SIQA1MKY,SIQACST,SIQARID                                                                
              MATCH     SIQA1EKY,SIQA1MKY
              IF        @EQUAL
                MOVE      ZERO,SIQA1END
                ADD       ONE,SIQA1CNT
                CALL      UPTSIQA1
                MOVE      SIQARID,VAR      
                CALL      DISPITEM
          CALL      PRQDET00
              ELSE
                MOVE      ONE,SIQA1END
              ENDIF
            ELSE
              MOVE      ONE,SIQA1END
            ENDIF
          ENDIF
          IF        SIQA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L102
          IF        SIQA1END=0
            MOVE      SIQACAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L103
          IF        SIQA1END=0
            MOVE      SIQAUNT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L104
          IF        SIQA1END=0
            MOVE      SIQAPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L105
          IF        SIQA1END=0
            MOVE      SIQAPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L106
          IF        SIQA1END=0
            MOVE      SIQAQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L107
          IF        SIQA1END=0
            MOVE      SIQASTA,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L108
          IF        SIQA1END=0
            MOVE      SIQAUID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L109
          IF        SIQA1END=0
            UNPACK    SIQADAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L110
          IF        SIQA1END=0
            MOVE      SIQATIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L111
          IF        SIQA1END=0
            MOVE      SIQAPOR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L112
          IF        SIQA1END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L113
          IF        SIQA1END=0
            MOVE      SICDDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
.
DP16L114
          IF        SIQA1END=0
            MOVE      SECUSER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP16L010
DP16L600
          MATCH    "SIQA1",NAMSSFFI
          GOTO     DP16L605 IF NOT EQUAL
          GOTO     DP16L999
DP16L605
DP16L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP16L000
.
          MATCH    "SIQA1",NAMSSFFI
          GOTO     FP16L105 IF NOT EQUAL
          PACK     KEY13,SIQA1SKY,Z70
          CALL     RDSIQA1  * Start
          IF       OVRCD=0
            CALL     RPSIQA1  * Start
          ENDIF
          CALL     DP16L000
          GOTO     FP16L999
FP16L105
FP16L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP16L000
.
          MATCH    "SIQA1",NAMSSFFI
          GOTO     LP16L105 IF NOT EQUAL
          PACK     KEY13,SIQA1SKY,SP70
          CALL     RSSIQA1  * End
          IF       OVRCD=1
            CALL     RKSIQA1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIQA1SNO
            CALL     RKSIQA1 
            IF       OVRCD=1
              MOVE     SIQA1SNO,SECTOR
            ENDIF
            PACK     SIQA1MKY,SIQACST,SIQARID                                                                
            MATCH    SIQA1EKY,SIQA1MKY
            IF       !@EQUAL
              MOVE     SIQA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP16L000
          GOTO     LP16L999
LP16L105
LP16L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP16L000
.
          MATCH    "SIQA1",NAMSSFFI
          GOTO     PP16L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP16L105
          CALL      RFTSIQA1
          BRANCH   OVRCD,PP16L115
          MOVE      SIQA1MKY,KEY13 
          CALL      RSSIQA1 
PP16L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIQA1SNO
            CALL     RKSIQA1 
            IF       OVRCD=1
              MOVE     SIQA1SNO,SECTOR
            ENDIF
            PACK     SIQA1MKY,SIQACST,SIQARID                                                                
            MATCH    SIQA1EKY,SIQA1MKY
            IF       !@EQUAL
              MOVE     SIQA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP16L000
          GOTO     PP16L999
PP16L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIQA1SNO
            CALL     RPSIQA1 
            IF       OVRCD=1
              MOVE     SIQA1SNO,SECTOR
            ENDIF
            PACK     SIQA1MKY,SIQACST,SIQARID                                                                
            MATCH    SIQA1EKY,SIQA1MKY
            IF       !@EQUAL
              MOVE     SIQA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP16L999
PP16L120
PP16L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP16L000
          MATCH    "SIQA1",NAMSSFFI
          GOTO     NP16L115 IF NOT EQUAL
NP16L105
          CALL     RPSIQA1 
          BRANCH   OVRCD,NP16L110
          PACK     SIQA1MKY,SIQACST,SIQARID                                                                
          MATCH    SIQA1EKY,SIQA1MKY
          GOTO     NP16L110 IF NOT EQUAL
          CALL     RKSIQA1 
          CALL     DP16L000
          GOTO     NP16L999
NP16L110
          CALL     RKSIQA1 
          BEEP
          GOTO     NP16L999
NP16L115
NP16L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT16L000
CT16L105
CT16L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Outstanding Purchase Requisitions  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Purchase Requisition               
.---------------------------------------------------------
UPTSIQA1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIQA1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIQA1FL1,KEY5;SCPSROW,SCPSCOL,SIQA1MKY
          ELSE
            UPDATE    SIQA1FL1;SCPSROW,SCPSCOL,SIQA1MKY
          ENDIF
          RETURN
RDTSIQA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIQA1FL1,KEY5;SCPSROW,SCPSCOL,SIQA1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIQA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIQA1FL1,KEY5;;
          READKS    SIQA1FL1;SCPSROW,SCPSCOL,SIQA1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIQA1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Outstanding Purchase Requisitions  
.---------------------------------------------------------
DF16L000
          BRANCH   ACCEPT,DF16L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF16L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF16L900
          MATCH    PRGID,SCPSPID
          GOTO     DF16L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF16L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF16L010 IF NOT EQUAL
.
          CALL     PS16L000 * Display Field
          GOTO     DF16L010
DF16L900
          MOVE      "SIQA1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP16L000
DF16L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Outstanding Purchase Requisitions  
.---------------------------------------------------------
PS16L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                            PS16L999,PS16L999,PS16L999,PS16L999:
                           PS16L999,PS16L999
          GOTO     PS16L999
PS16L999
          RETURN
.---------------------------------------------------------
. Selections for : Outstanding Purchase Requisitions  
.---------------------------------------------------------
SF16L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF16L001  BRANCH   ACCEPT,SF16L020
.
SF16L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF16L006,SF16L101,SF16L102,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L103,SF16L104,SF16L006,SF16L006:
                           SF16L105,SF16L106
SF16L006  BEEP
          GOTO     SF16L005
SF16L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF16L090
          MATCH    PRGID,SCSLPID
          GOTO     SF16L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF16L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF16L020,SF16L020,SF16L102,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                           SF16L020,SF16L020
          GOTO     SF16L020
SF16L090  MOVE     ZERO,ACCEPT
          MOVE      "SIQA1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP16L000
          GOTO     SF16L001
.
SF16L101
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE     SP70,SIQAPOR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      SIQAPOR,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF16L999
.
SF16L102
          CALL      SELECTED
          BRANCH    EXIT,SF16L001
          COMPARE   ONE,ACCEPT
          GOTO      SF16L001 IF EQUAL
          CALL      RDTSIQA1
          IF        OVRCD=1
            BEEP
            GOTO      SF16L001
          ENDIF
          MATCH     SP70,SIQA1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF16L001
          ENDIF
          MOVE      SIQA1MKY,KEY13 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELPRQ00
          MOVE      "16",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIQA1
          IF        OVRCD=1
            CALL      FP16L000
          ELSE
            MOVE      SIQA1MKY,KEY13 
            CALL      RSSIQA1 
            CALL      RKSIQA1 
            CALL      DP16L000
          ENDIF
          GOTO     SF16L001
.
SF16L103
          MOVE      "SIQA1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP16L000
          GOTO     SF16L001
.
SF16L104
          MOVE      "SIQA1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP16L000
          GOTO     SF16L001
.
SF16L105
          MOVE      "SIQA1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP16L000
          GOTO     SF16L001
.
SF16L106
          MOVE      "SIQA1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP16L000
          GOTO     SF16L001
SF16L990  MOVE      FOUR,EXIT * Exit Char Exit
SF16L999  RETURN
.--------------------------------
. Screen - Purchase Requisitions History      
.--------------------------------
SC17L000
SC17L100
          MOVE      "17",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC17L200
          CALL      CF17L000 * Clear Fields
SC17L300
          CALL      KY17L000 * Enter Key Fields
          BRANCH    EXIT,SC17L999,SC17L999
SC17L400
          CALL      WP17L000 * Load any WP Details
SC17L500
          CALL      LM17L000 * Load any Batch Details
SC17L600
          CALL      DF17L000 * Display Fields
SC17L700
          CALL      SF17L000 * Select Fields
          BRANCH    EXIT,SC17L100,SC17L100,SC17L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC17L800
SC17L900
SC17L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Requisitions History      
.-------------------------------------------------------
CF17L000
CF17L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Requisitions History      
.--------------------------------------------------------
KY17L000
          MOVE      ZERO,EXIT
          GOTO      KY17L999
.
KY17L900  MOVE      ONE,EXIT
KY17L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Requisitions History      
.---------------------------------------------------------
WP17L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Requisitions History      
.---------------------------------------------------------
LM17L000
.---------------------------------------------------------
. Load for :     3 Purchase Requisition               
.---------------------------------------------------------
          UNPACK    SP70,SIQCCST,SIQCRID
          PACK      KEY13,SICACODE,Z70
          MOVE      KEY13,SIQC1EKY
          STRIP     SIQC1SKY
          SETLPTR   SIQC1EKY,5
          MOVE      SIQC1EKY,SIQC1SKY
          CALL      RDSIQC1 
          IF        OVRCD=0
            CALL      RPSIQC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP17L000
          MOVE     ZERO,SIQC1CNT
          MOVE     ZERO,SIQC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP17L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP17L600
          MATCH    PRGID,SCPSPID
          GOTO     DP17L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP17L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP17L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP17L010,DP17L010,DP17L101,DP17L102:
                            DP17L103,DP17L104,DP17L105,DP17L106:
                            DP17L107,DP17L108,DP17L109,DP17L110:
                            DP17L111,DP17L112,DP17L113,DP17L114:
                            DP17L010,DP17L010,DP17L010,DP17L115:
                            DP17L010,DP17L010,DP17L116,DP17L117:
                            DP17L118,DP17L119,DP17L120,DP17L121:
                            DP17L122,DP17L123,DP17L124,DP17L125:
                            DP17L126,DP17L127,DP17L128,DP17L129:
                            DP17L130,DP17L131,DP17L132,DP17L133:
                            DP17L134,DP17L135,DP17L010,DP17L010:
                            DP17L010,DP17L010,DP17L010,DP17L010
          GOTO      DP17L010
.
DP17L101
          PACK      SIQC1MKY,SP70,SP70
          CALL      UPTSIQC1
          IF        SIQC1END=0
            CALL      RPSIQC1 
            IF        OVRCD=0
              PACK      SIQC1MKY,SIQCCST,SIQCRID                                                                
              MATCH     SIQC1EKY,SIQC1MKY
              IF        @EQUAL
                MOVE      ZERO,SIQC1END
                ADD       ONE,SIQC1CNT
                CALL      UPTSIQC1
                MOVE      SIQCRID,VAR      
                CALL      DISPITEM
          CALL      PRHDET00
              ELSE
                MOVE      ONE,SIQC1END
              ENDIF
            ELSE
              MOVE      ONE,SIQC1END
            ENDIF
          ENDIF
          IF        SIQC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L102
          IF        SIQC1END=0
            MOVE      SIQCCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L103
          IF        SIQC1END=0
            MOVE      SIQCUNT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L104
          IF        SIQC1END=0
            MOVE      SIQCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L105
          IF        SIQC1END=0
            MOVE      SIQCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L106
          IF        SIQC1END=0
            MOVE      SIQCQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L107
          IF        SIQC1END=0
            MOVE      SIQCSTA,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L108
          IF        SIQC1END=0
            MOVE      SIQCUID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L109
          IF        SIQC1END=0
            UNPACK    SIQCDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L110
          IF        SIQC1END=0
            MOVE      SIQCTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L111
          IF        SIQC1END=0
            MOVE      SIQCPOR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L112
          IF        SIQC1END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L113
          IF        SIQC1END=0
            MOVE      SICDDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L114
          IF        SIQC1END=0
            MOVE      SECUSER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L115
          IF        SIQC1END=0
            MOVE      SIQCDAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L116
          IF        SIQC1END=0
            MOVE      SIQCPTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L117
          IF        SIQC1END=0
            MOVE      SIQCPID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L118
          IF        SIQC1END=0
            MOVE      SIQCPPO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L119
          IF        SIQC1END=0
            MOVE      SIQCORI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L120
          IF        SIQC1END=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L121
          IF        SIQC1END=0
            MOVE      SIQCPTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L122
          IF        SIQC1END=0
            MOVE      PTYDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L123
          IF        SIQC1END=0
            MOVE      SIQCPQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L124
          IF        SIQC1END=0
            MOVE      SIQCECT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L125
          IF        SIQC1END=0
            MOVE      SIQCCAN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L126
          IF        SIQC1END=0
            MOVE      SIQCORD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L127
          IF        SIQC1END=0
            MOVE      SIQCREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L128
          IF        SIQC1END=0
            UNPACK    SIQCEDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L129
          IF        SIQC1END=0
            MOVE      SIQCSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L130
          IF        SIQC1END=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L131
          IF        SIQC1END=0
            MOVE      APMASN2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L132
          IF        SIQC1END=0
            MOVE      SIQCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L133
          IF        SIQC1END=0
            MOVE      SIQCPGP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L134
          IF        SIQC1END=0
            MOVE      SISADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
.
DP17L135
          IF        SIQC1END=0
            MOVE      PIDDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP17L010
DP17L600
          MATCH    "SIQC1",NAMSSFFI
          GOTO     DP17L605 IF NOT EQUAL
          GOTO     DP17L999
DP17L605
DP17L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP17L000
.
          MATCH    "SIQC1",NAMSSFFI
          GOTO     FP17L105 IF NOT EQUAL
          PACK     KEY13,SIQC1SKY,Z70
          CALL     RDSIQC1  * Start
          IF       OVRCD=0
            CALL     RPSIQC1  * Start
          ENDIF
          CALL     DP17L000
          GOTO     FP17L999
FP17L105
FP17L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP17L000
.
          MATCH    "SIQC1",NAMSSFFI
          GOTO     LP17L105 IF NOT EQUAL
          PACK     KEY13,SIQC1SKY,SP70
          CALL     RSSIQC1  * End
          IF       OVRCD=1
            CALL     RKSIQC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIQC1SNO
            CALL     RKSIQC1 
            IF       OVRCD=1
              MOVE     SIQC1SNO,SECTOR
            ENDIF
            PACK     SIQC1MKY,SIQCCST,SIQCRID                                                                
            MATCH    SIQC1EKY,SIQC1MKY
            IF       !@EQUAL
              MOVE     SIQC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP17L000
          GOTO     LP17L999
LP17L105
LP17L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP17L000
.
          MATCH    "SIQC1",NAMSSFFI
          GOTO     PP17L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP17L105
          CALL      RFTSIQC1
          BRANCH   OVRCD,PP17L115
          MOVE      SIQC1MKY,KEY13 
          CALL      RSSIQC1 
PP17L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIQC1SNO
            CALL     RKSIQC1 
            IF       OVRCD=1
              MOVE     SIQC1SNO,SECTOR
            ENDIF
            PACK     SIQC1MKY,SIQCCST,SIQCRID                                                                
            MATCH    SIQC1EKY,SIQC1MKY
            IF       !@EQUAL
              MOVE     SIQC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP17L000
          GOTO     PP17L999
PP17L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIQC1SNO
            CALL     RPSIQC1 
            IF       OVRCD=1
              MOVE     SIQC1SNO,SECTOR
            ENDIF
            PACK     SIQC1MKY,SIQCCST,SIQCRID                                                                
            MATCH    SIQC1EKY,SIQC1MKY
            IF       !@EQUAL
              MOVE     SIQC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP17L999
PP17L120
PP17L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP17L000
          MATCH    "SIQC1",NAMSSFFI
          GOTO     NP17L115 IF NOT EQUAL
NP17L105
          CALL     RPSIQC1 
          BRANCH   OVRCD,NP17L110
          PACK     SIQC1MKY,SIQCCST,SIQCRID                                                                
          MATCH    SIQC1EKY,SIQC1MKY
          GOTO     NP17L110 IF NOT EQUAL
          CALL     RKSIQC1 
          CALL     DP17L000
          GOTO     NP17L999
NP17L110
          CALL     RKSIQC1 
          BEEP
          GOTO     NP17L999
NP17L115
NP17L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT17L000
CT17L105
CT17L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Requisitions History      
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Purchase Requisition               
.---------------------------------------------------------
UPTSIQC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIQC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIQC1FL1,KEY5;SCPSROW,SCPSCOL,SIQC1MKY
          ELSE
            UPDATE    SIQC1FL1;SCPSROW,SCPSCOL,SIQC1MKY
          ENDIF
          RETURN
RDTSIQC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIQC1FL1,KEY5;SCPSROW,SCPSCOL,SIQC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIQC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIQC1FL1,KEY5;;
          READKS    SIQC1FL1;SCPSROW,SCPSCOL,SIQC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIQC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Requisitions History      
.---------------------------------------------------------
DF17L000
          BRANCH   ACCEPT,DF17L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF17L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF17L900
          MATCH    PRGID,SCPSPID
          GOTO     DF17L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF17L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF17L010 IF NOT EQUAL
.
          CALL     PS17L000 * Display Field
          GOTO     DF17L010
DF17L900
          MOVE      "SIQC1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP17L000
DF17L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Requisitions History      
.---------------------------------------------------------
PS17L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999:
                            PS17L999,PS17L999,PS17L999,PS17L999
          GOTO     PS17L999
PS17L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Requisitions History      
.---------------------------------------------------------
SF17L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF17L001  BRANCH   ACCEPT,SF17L020
.
SF17L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF17L006,SF17L101,SF17L102,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L006,SF17L006:
                            SF17L006,SF17L006,SF17L103,SF17L104:
                            SF17L006,SF17L006,SF17L105,SF17L106
SF17L006  BEEP
          GOTO     SF17L005
SF17L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF17L090
          MATCH    PRGID,SCSLPID
          GOTO     SF17L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF17L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF17L020,SF17L020,SF17L102,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020:
                            SF17L020,SF17L020,SF17L020,SF17L020
          GOTO     SF17L020
SF17L090  MOVE     ZERO,ACCEPT
          MOVE      "SIQC1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP17L000
          GOTO     SF17L001
.
SF17L101
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE     SP70,SIQCPOR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      SIQCPOR,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF17L999
.
SF17L102
          CALL      SELECTED
          BRANCH    EXIT,SF17L001
          COMPARE   ONE,ACCEPT
          GOTO      SF17L001 IF EQUAL
          CALL      RDTSIQC1
          IF        OVRCD=1
            BEEP
            GOTO      SF17L001
          ENDIF
          MATCH     SP70,SIQC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF17L001
          ENDIF
          MOVE      SIQC1MKY,KEY13 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELPRH00
          MOVE      "17",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIQC1
          IF        OVRCD=1
            CALL      FP17L000
          ELSE
            MOVE      SIQC1MKY,KEY13 
            CALL      RSSIQC1 
            CALL      RKSIQC1 
            CALL      DP17L000
          ENDIF
          GOTO     SF17L001
.
SF17L103
          MOVE      "SIQC1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP17L000
          GOTO     SF17L001
.
SF17L104
          MOVE      "SIQC1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP17L000
          GOTO     SF17L001
.
SF17L105
          MOVE      "SIQC1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP17L000
          GOTO     SF17L001
.
SF17L106
          MOVE      "SIQC1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP17L000
          GOTO     SF17L001
SF17L990  MOVE      FOUR,EXIT * Exit Char Exit
SF17L999  RETURN
.--------------------------------
. Screen - Outstanding Purchase Req Details   
.--------------------------------
SC18L000
SC18L100
          MOVE      "18",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC18L200
          CALL      CF18L000 * Clear Fields
SC18L300
          CALL      KY18L000 * Enter Key Fields
          BRANCH    EXIT,SC18L999,SC18L999
SC18L400
          CALL      WP18L000 * Load any WP Details
SC18L500
          CALL      LM18L000 * Load any Batch Details
SC18L600
          CALL      DF18L000 * Display Fields
SC18L700
          CALL      SF18L000 * Select Fields
          BRANCH    EXIT,SC18L100,SC18L100,SC18L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC18L800
SC18L900
SC18L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Outstanding Purchase Req Details   
.-------------------------------------------------------
CF18L000
CF18L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Outstanding Purchase Req Details   
.--------------------------------------------------------
KY18L000
          MOVE      ZERO,EXIT
          GOTO      KY18L999
.
KY18L900  MOVE      ONE,EXIT
KY18L999  RETURN
.---------------------------------------------------------
. Load WP files for : Outstanding Purchase Req Details   
.---------------------------------------------------------
WP18L000
          PREP     TEMPWORD,FILSIQB1
          PACK     KEY16,SIQACST,SIQARID,SP70
          MOVE     KEY16,SAVKEY80
          SETLPTR  SAVKEY80,13
          CALL      RDSIQB1 
          IF        OVRCD=0
            CALL      RPSIQB1 
          ENDIF
WP18L100
          CALL     RKSIQB1 
          BRANCH   OVRCD,WP18L105
          PACK     KEY16,SIQBCST,SIQBRID,SIQBLIN
          MATCH    SAVKEY80,KEY16   
          GOTO     WP18L105 IF NOT EQUAL
          PACK     VAR,SIQBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIQBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP18L100
WP18L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Outstanding Purchase Req Details   
.---------------------------------------------------------
LM18L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Outstanding Purchase Req Details   
.---------------------------------------------------------
DF18L000
          BRANCH   ACCEPT,DF18L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF18L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF18L900
          MATCH    PRGID,SCPSPID
          GOTO     DF18L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF18L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF18L010 IF NOT EQUAL
.
          CALL     PS18L000 * Display Field
          GOTO     DF18L010
DF18L900
DF18L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Outstanding Purchase Req Details   
.---------------------------------------------------------
PS18L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS18L999,PS18L999,PS18L101,PS18L102:
                            PS18L103,PS18L104,PS18L105,PS18L106:
                            PS18L107,PS18L108,PS18L109,PS18L110:
                            PS18L111,PS18L112,PS18L113,PS18L114:
                            PS18L115
          GOTO     PS18L999
.
PS18L101
          MOVE      SIQARID,VAR      
          CALL      DISPITEM
          CALL      OUTDET00
          GOTO     PS18L999
.
PS18L102
          MOVE      SIQACAT,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L103
          MOVE      SIQAUNT,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L104
          MOVE      SIQAPD,VAR       
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L105
          MOVE      SIQAPN,VAR       
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L106
          MOVE      SIQAQTY,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L107
          MOVE      SIQASTA,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L108
          MOVE      SIQAUID,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L109
          UNPACK    SIQADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L110
          MOVE      SIQATIM,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L111
          MOVE      SIQAPOR,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L112
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L113
          MOVE      SICDDESC,VAR     
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L114
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PS18L999
.
PS18L115
          MOVE     FILSIQB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS18L999
PS18L999
          RETURN
.---------------------------------------------------------
. Selections for : Outstanding Purchase Req Details   
.---------------------------------------------------------
SF18L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF18L001  BRANCH   ACCEPT,SF18L020
.
SF18L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF18L006,SF18L101,SF18L006,SF18L006:
                            SF18L006,SF18L006,SF18L006,SF18L006:
                            SF18L006,SF18L006,SF18L006,SF18L006:
                            SF18L006,SF18L006,SF18L006,SF18L006:
                            SF18L102
SF18L006  BEEP
          GOTO     SF18L005
SF18L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF18L090
          MATCH    PRGID,SCSLPID
          GOTO     SF18L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF18L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF18L020,SF18L020,SF18L020,SF18L020:
                            SF18L020,SF18L020,SF18L020,SF18L020:
                            SF18L020,SF18L020,SF18L020,SF18L020:
                            SF18L020,SF18L020,SF18L020,SF18L020:
                            SF18L102
          GOTO     SF18L020
SF18L090  MOVE     ZERO,ACCEPT
          GOTO     SF18L001
.
SF18L101
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIQAPOR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIQAPOR,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF18L999
.
SF18L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "17",SCPSROW
              MOVE     " 17",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     " 4",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIQB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIQB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF18L001
SF18L990  MOVE      FOUR,EXIT * Exit Char Exit
SF18L999  RETURN
.--------------------------------
. Screen - Purchase Requisition History Detail
.--------------------------------
SC19L000
SC19L100
          MOVE      "19",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC19L200
          CALL      CF19L000 * Clear Fields
SC19L300
          CALL      KY19L000 * Enter Key Fields
          BRANCH    EXIT,SC19L999,SC19L999
SC19L400
          CALL      WP19L000 * Load any WP Details
SC19L500
          CALL      LM19L000 * Load any Batch Details
SC19L600
          CALL      DF19L000 * Display Fields
SC19L700
          CALL      SF19L000 * Select Fields
          BRANCH    EXIT,SC19L100,SC19L100,SC19L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC19L800
SC19L900
SC19L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Requisition History Detail
.-------------------------------------------------------
CF19L000
CF19L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Requisition History Detail
.--------------------------------------------------------
KY19L000
          MOVE      ZERO,EXIT
          GOTO      KY19L999
.
KY19L900  MOVE      ONE,EXIT
KY19L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Requisition History Detail
.---------------------------------------------------------
WP19L000
          PREP     TEMPWORD,FILSIQB1
          PACK     KEY16,SIQCCST,SIQCRID,SP70
          MOVE     KEY16,SAVKEY80
          SETLPTR  SAVKEY80,13
          CALL      RDSIQB1 
          IF        OVRCD=0
            CALL      RPSIQB1 
          ENDIF
WP19L100
          CALL     RKSIQB1 
          BRANCH   OVRCD,WP19L105
          PACK     KEY16,SIQBCST,SIQBRID,SIQBLIN
          MATCH    SAVKEY80,KEY16   
          GOTO     WP19L105 IF NOT EQUAL
          PACK     VAR,SIQBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIQBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP19L100
WP19L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Requisition History Detail
.---------------------------------------------------------
LM19L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Requisition History Detail
.---------------------------------------------------------
DF19L000
          BRANCH   ACCEPT,DF19L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF19L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF19L900
          MATCH    PRGID,SCPSPID
          GOTO     DF19L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF19L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF19L010 IF NOT EQUAL
.
          CALL     PS19L000 * Display Field
          GOTO     DF19L010
DF19L900
DF19L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Requisition History Detail
.---------------------------------------------------------
PS19L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS19L999,PS19L999,PS19L101,PS19L102:
                            PS19L103,PS19L104,PS19L105,PS19L106:
                            PS19L107,PS19L108,PS19L109,PS19L110:
                            PS19L111,PS19L112,PS19L113,PS19L114:
                            PS19L115,PS19L116,PS19L117,PS19L118:
                            PS19L119,PS19L120,PS19L121,PS19L122:
                            PS19L123,PS19L124,PS19L125,PS19L126:
                            PS19L127,PS19L128,PS19L129,PS19L130:
                            PS19L131,PS19L132,PS19L133,PS19L134:
                            PS19L135,PS19L136
          GOTO     PS19L999
.
PS19L101
          MOVE      SIQCRID,VAR      
          CALL      DISPITEM
          CALL      OUTDET00
          GOTO     PS19L999
.
PS19L102
          MOVE      SIQCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L103
          MOVE      SIQCUNT,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L104
          MOVE      SIQCPD,VAR       
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L105
          MOVE      SIQCPN,VAR       
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L106
          MOVE      SIQCQTY,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L107
          MOVE      SIQCSTA,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L108
          MOVE      SIQCUID,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L109
          UNPACK    SIQCDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L110
          MOVE      SIQCTIM,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L111
          MOVE      SIQCPOR,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L112
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L113
          MOVE      SICDDESC,VAR     
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L114
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L115
          MOVE     FILSIQB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS19L999
.
PS19L116
          UNPACK    SIQCPDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L117
          MOVE      SIQCPTM,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L118
          MOVE      SIQCPID,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L119
          MOVE      SIQCPPO,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L120
          MOVE      SIQCORI,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L121
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L122
          MOVE      SIQCPTY,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L123
          MOVE      PTYDESC,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L124
          MOVE      SIQCPQT,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L125
          MOVE      SIQCECT,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L126
          MOVE      SIQCCAN,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L127
          MOVE      SIQCORD,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L128
          MOVE      SIQCREQ,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L129
          UNPACK    SIQCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L130
          MOVE      SIQCSUP,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L131
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L132
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L133
          MOVE      SIQCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L134
          MOVE      SIQCPGP,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L135
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS19L999
.
PS19L136
          MOVE      PIDDESC,VAR      
          CALL      DISPITEM
          GOTO     PS19L999
PS19L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Requisition History Detail
.---------------------------------------------------------
SF19L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF19L001  BRANCH   ACCEPT,SF19L020
.
SF19L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF19L006,SF19L101,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L102,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006,SF19L006,SF19L006:
                            SF19L006,SF19L006
SF19L006  BEEP
          GOTO     SF19L005
SF19L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF19L090
          MATCH    PRGID,SCSLPID
          GOTO     SF19L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF19L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L102,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020,SF19L020,SF19L020:
                            SF19L020,SF19L020
          GOTO     SF19L020
SF19L090  MOVE     ZERO,ACCEPT
          GOTO     SF19L001
.
SF19L101
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIQCPOR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIQCPOR,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF19L999
.
SF19L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "17",SCPSROW
              MOVE     " 17",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     " 4",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIQB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIQB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF19L001
SF19L990  MOVE      FOUR,EXIT * Exit Char Exit
SF19L999  RETURN
.--------------------------------
. Screen - Imprest Details - Sequence Order   
.--------------------------------
SC20L000
SC20L100
          MOVE      "20",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC20L200
          CALL      CF20L000 * Clear Fields
SC20L300
          CALL      KY20L000 * Enter Key Fields
          BRANCH    EXIT,SC20L999,SC20L999
SC20L400
          CALL      WP20L000 * Load any WP Details
SC20L500
          CALL      LM20L000 * Load any Batch Details
SC20L600
          CALL      DF20L000 * Display Fields
SC20L700
          CALL      SF20L000 * Select Fields
          BRANCH    EXIT,SC20L100,SC20L100,SC20L200
SC20L800
SC20L900
SC20L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Imprest Details - Sequence Order   
.-------------------------------------------------------
CF20L000
          MOVE      SP70,SIIMCAT 
          MOVE      SP70,SIIMSEQ 
          MOVE      ZERO,SIIMMAX 
          MOVE      ZERO,SIIMREQ 
          MOVE      ZERO,SIIMQOH 
          MOVE      SP70,SIIMUR1 
          MOVE      SP70,SIIMUR2 
          MOVE      SP70,SIIMUD1 
          MOVE      SP70,SIIMUD2 
          MOVE      SP70,SIIMUC1 
          MOVE      SP70,SIIMUC2 
          MOVE      SP70,SIIMUY1 
          MOVE      SP70,SIIMUY2 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIAISS 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
CF20L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Imprest Details - Sequence Order   
.--------------------------------------------------------
KY20L000
          MOVE      ZERO,EXIT
          GOTO      KY20L999
.
KY20L900  MOVE      ONE,EXIT
KY20L999  RETURN
.---------------------------------------------------------
. Load WP files for : Imprest Details - Sequence Order   
.---------------------------------------------------------
WP20L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Imprest Details - Sequence Order   
.---------------------------------------------------------
LM20L000
.---------------------------------------------------------
. Load for :     1 Catalog                            
.---------------------------------------------------------
          UNPACK    SP70,SIIMCST,SIIMSEQ,SIIMCAT
          PACK      KEY16,SICACODE,SP70
          MOVE      KEY16,SIIM3EKY
          STRIP     SIIM3SKY
          SETLPTR   SIIM3EKY,5
          MOVE      SIIM3EKY,SIIM3SKY
          CALL      RDSIIM3 
          IF        OVRCD=0
            CALL      RPSIIM3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP20L000
          MOVE     ZERO,SIIM3CNT
          MOVE     ZERO,SIIM3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP20L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP20L600
          MATCH    PRGID,SCPSPID
          GOTO     DP20L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP20L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP20L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP20L101,DP20L102,DP20L103,DP20L104:
                            DP20L105,DP20L106,DP20L107,DP20L108:
                            DP20L109,DP20L110,DP20L111,DP20L112:
                            DP20L113,DP20L114,DP20L115,DP20L116:
                            DP20L010,DP20L117,DP20L118,DP20L010:
                            DP20L010,DP20L010,DP20L010,DP20L010
          GOTO      DP20L010
.
DP20L101
          PACK      SIIM3MKY,SP70,SP70
          CALL      UPTSIIM3
          IF        SIIM3END=0
            CALL      RKSIIM3 
            IF        OVRCD=0
              PACK      SIIM3MKY,SIIMCST,SIIMSEQ,SIIMCAT                                                        
              MATCH     SIIM3EKY,SIIM3MKY
              IF        @EQUAL
                MOVE      ZERO,SIIM3END
                ADD       ONE,SIIM3CNT
                CALL      UPTSIIM3
                MOVE      SIIMCAT,VAR      
                CALL      DISPITEM
          CALL      IMPLIN00
              ELSE
                MOVE      ONE,SIIM3END
              ENDIF
            ELSE
              MOVE      ONE,SIIM3END
            ENDIF
          ENDIF
          IF        SIIM3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L102
          IF        SIIM3END=0
            MOVE      SIIMSEQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L103
          IF        SIIM3END=0
            MOVE      SIIMMAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L104
          IF        SIIM3END=0
            MOVE      SIIMREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L105
          IF        SIIM3END=0
            MOVE      SIIMQOH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L106
          IF        SIIM3END=0
            MOVE      SIIMUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L107
          IF        SIIM3END=0
            MOVE      SIIMUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L108
          IF        SIIM3END=0
            UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L109
          IF        SIIM3END=0
            UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L110
          IF        SIIM3END=0
            MOVE      SIIMUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L111
          IF        SIIM3END=0
            MOVE      SIIMUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L112
          IF        SIIM3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIMUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L113
          IF        SIIM3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIMUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L114
          IF        SIIM3END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L115
          IF        SIIM3END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L116
          IF        SIIM3END=0
            MOVE      SIIAAVC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L117
          IF        SIIM3END=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
.
DP20L118
          IF        SIIM3END=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP20L010
DP20L600
          MATCH    "SIIM3",NAMSSFFI
          GOTO     DP20L605 IF NOT EQUAL
          GOTO     DP20L999
DP20L605
DP20L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP20L000
.
          MATCH    "SIIM3",NAMSSFFI
          GOTO     FP20L105 IF NOT EQUAL
          PACK     KEY16,SIIM3SKY,SP70
          CALL     RDSIIM3  * Start
          IF       OVRCD=0
            CALL     RPSIIM3  * Start
          ENDIF
          CALL     DP20L000
          GOTO     FP20L999
FP20L105
FP20L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP20L000
.
          MATCH    "SIIM3",NAMSSFFI
          GOTO     LP20L105 IF NOT EQUAL
          PACK     KEY16,SIIM3SKY,Z70
          CALL     RSSIIM3  * End
          IF       OVRCD=1
            CALL     RPSIIM3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM3SNO
            CALL     RPSIIM3 
            IF       OVRCD=1
              MOVE     SIIM3SNO,SECTOR
            ENDIF
            PACK     SIIM3MKY,SIIMCST,SIIMSEQ,SIIMCAT                                                        
            MATCH    SIIM3EKY,SIIM3MKY
            IF       !@EQUAL
              MOVE     SIIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP20L000
          GOTO     LP20L999
LP20L105
LP20L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP20L000
.
          MATCH    "SIIM3",NAMSSFFI
          GOTO     PP20L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP20L105
          CALL      RFTSIIM3
          BRANCH   OVRCD,PP20L115
          MOVE      SIIM3MKY,KEY16 
          CALL      RSSIIM3 
PP20L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIM3SNO
            CALL     RPSIIM3 
            IF       OVRCD=1
              MOVE     SIIM3SNO,SECTOR
            ENDIF
            PACK     SIIM3MKY,SIIMCST,SIIMSEQ,SIIMCAT                                                        
            MATCH    SIIM3EKY,SIIM3MKY
            IF       !@EQUAL
              MOVE     SIIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP20L000
          GOTO     PP20L999
PP20L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM3SNO
            CALL     RKSIIM3 
            IF       OVRCD=1
              MOVE     SIIM3SNO,SECTOR
            ENDIF
            PACK     SIIM3MKY,SIIMCST,SIIMSEQ,SIIMCAT                                                        
            MATCH    SIIM3EKY,SIIM3MKY
            IF       !@EQUAL
              MOVE     SIIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP20L999
PP20L120
PP20L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP20L000
          MATCH    "SIIM3",NAMSSFFI
          GOTO     NP20L115 IF NOT EQUAL
NP20L105
          CALL     RKSIIM3 
          BRANCH   OVRCD,NP20L110
          PACK     SIIM3MKY,SIIMCST,SIIMSEQ,SIIMCAT                                                        
          MATCH    SIIM3EKY,SIIM3MKY
          GOTO     NP20L110 IF NOT EQUAL
          CALL     RPSIIM3 
          CALL     DP20L000
          GOTO     NP20L999
NP20L110
          CALL     RPSIIM3 
          BEEP
          GOTO     NP20L999
NP20L115
NP20L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT20L000
CT20L105
CT20L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Imprest Details - Sequence Order   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Catalog                            
.---------------------------------------------------------
UPTSIIM3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIM3FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIM3FL1,KEY5;SCPSROW,SCPSCOL,SIIM3MKY
          ELSE
            UPDATE    SIIM3FL1;SCPSROW,SCPSCOL,SIIM3MKY
          ENDIF
          RETURN
RDTSIIM3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIM3FL1,KEY5;SCPSROW,SCPSCOL,SIIM3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIM3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIM3FL1,KEY5;;
          READKS    SIIM3FL1;SCPSROW,SCPSCOL,SIIM3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIM3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Imprest Details - Sequence Order   
.---------------------------------------------------------
DF20L000
          BRANCH   ACCEPT,DF20L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF20L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF20L900
          MATCH    PRGID,SCPSPID
          GOTO     DF20L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF20L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF20L010 IF NOT EQUAL
.
          CALL     PS20L000 * Display Field
          GOTO     DF20L010
DF20L900
          MOVE      "SIIM3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP20L000
DF20L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Imprest Details - Sequence Order   
.---------------------------------------------------------
PS20L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS20L999,PS20L999,PS20L999,PS20L999:
                            PS20L999,PS20L999,PS20L999,PS20L999:
                            PS20L999,PS20L999,PS20L999,PS20L999:
                            PS20L999,PS20L999,PS20L999,PS20L999:
                            PS20L999,PS20L999,PS20L999,PS20L999:
                            PS20L999,PS20L999,PS20L999,PS20L999
          GOTO     PS20L999
PS20L999
          RETURN
.---------------------------------------------------------
. Selections for : Imprest Details - Sequence Order   
.---------------------------------------------------------
SF20L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF20L001  BRANCH   ACCEPT,SF20L020
.
SF20L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF20L101,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L102:
                            SF20L103,SF20L104,SF20L105,SF20L106
SF20L006  BEEP
          GOTO     SF20L005
SF20L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF20L090
          MATCH    PRGID,SCSLPID
          GOTO     SF20L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF20L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF20L101,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020
          GOTO     SF20L020
SF20L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIM3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP20L000
          GOTO     SF20L001
.
SF20L101
          CALL      SELECTED
          BRANCH    EXIT,SF20L001
          COMPARE   ONE,ACCEPT
          GOTO      SF20L001 IF EQUAL
          CALL      RDTSIIM3
          IF        OVRCD=1
            BEEP
            GOTO      SF20L001
          ENDIF
          MATCH     SP70,SIIM3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF20L001
          ENDIF
          MOVE      SIIM3MKY,KEY16 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      IMPDSQ00
          MOVE      "20",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIM3
          IF        OVRCD=1
            CALL      FP20L000
          ELSE
            MOVE      SIIM3MKY,KEY16 
            CALL      RSSIIM3 
            CALL      RPSIIM3 
            CALL      DP20L000
          ENDIF
          GOTO     SF20L001
.
SF20L102
          MOVE      ZERO,EXIT
          GOTO      SF20L999
.
SF20L103
          MOVE      "SIIM3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP20L000
          GOTO     SF20L001
.
SF20L104
          MOVE      "SIIM3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP20L000
          GOTO     SF20L001
.
SF20L105
          MOVE      "SIIM3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP20L000
          GOTO     SF20L001
.
SF20L106
          MOVE      "SIIM3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP20L000
          GOTO     SF20L001
SF20L990  MOVE      ONE,EXIT * Exit Char Restart
SF20L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read controlf file data and open gl files
.----------------------------------------------------------------------
RDCON000  READ      CONTROLF,TWENTY3;*95,HACCNT
          READ      CONTROLF,TWENTY4;*135,HACCDATA
          COMPARE   ONE,HACCNT
          GOTO      RDCON999 IF NOT EQUAL
.
.---- accounting system active ----
.
          CLOSE     CONTROLF           * get gl control file if possible
          MOVE      "controlf.txt",KEY12
          PACK      KEY80,HACCDATA,KEY12
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CONTROLF,KEY80
          TRAPCLR   IO
          IF        OVRCD=1
            OPEN      CONTROLF,"controlf"
          ENDIF
.
          CALL      RDFMCO50           * Read Account Code Parameters
          CALL      RDFMCO51
          CALL      RDFMCO52
          CALL      RDFMCO65
          CLOSE     CONTROLF
          OPEN      CONTROLF,"controlf"
.
          MOVE      "fmsamaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSAMAA1,KEY80
          OPEN      FMSAMAA2,KEY80
          OPEN      FMSAMAA3,KEY80
          OPEN      FMSAMAA4,KEY80
.
          MOVE      "fmsccaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSCCAA1,KEY80
          OPEN      FMSCCAA2,KEY80
.
          MOVE      "fmslmaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMAA1,KEY80
.
RDCON999  RETURN
ECOST000  CALL     KSICS000
          BRANCH   EXIT,ECOST999,ECOST999
          MOVE     SP70,COSTCOMM
.
          CLEAR     KEY6
          APPEND    "ca1",KEY6
          APPEND    SICAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ELSE
            MOVE      SP70,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "ca2",KEY6
          APPEND    SICAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ELSE
            MOVE      SP70,UDC2DESC
          ENDIF
.
          UNPACK   SICAIMPD,IMPSUN,IMPMON,IMPTUE,IMPWED,IMPTHU,IMPFRI,IMPSAT
          UNPACK   SICAGL,FMLALEDG,FMCCCOCE
.
.---- read gl data if interface is on ----
.
          IF       HACCNT=1
            MOVE     SICAGL,KEY2
            CALL     RDFMLA1
            MOVE     SICAGL,KEY14
            CALL     RDFMCC1
........... SRF126772> START
            IF       OVRCD=1
              MOVE     SICAGL,FMCCLEDG       * 1st 2 chars of GL# = Ledger#
            ENDIF
........... SRF126772> END
          ENDIF
.
          PACK     KEY8,SICACODE,SP70
          CALL     RSSICC1
.
ECOST150  CALL     RKSICC1
          BRANCH   OVRCD,ECOST160
          MATCH    SICACODE,SICCCST
          GOTO     ECOST160 IF NOT EQUAL
          MATCH    SP70,SICCCOM
          GOTO     ECOST150 IF EQUAL
          MOVE     "Notes",COSTCOMM
.
ECOST160  MOVE      ZERO,OVRCD
          GOTO      ECOST999
.
ECOST999   RETURN
.----------------------------------------------------------------------
. Keyin SICA (security check)
.----------------------------------------------------------------------
KSICS000  CALL      CSICS000           * check security
.                                      * SICSSEC 0=none 1=1 cc 2=>1 cc 3=all cc
          BRANCH    SICSSEC,KSICS100,KSICS100,KSICS100
          GOTO      KSICS940
.
KSICS100  IF        SICSSEC=1
            DISPLAY   *PCCOL:CVERT,*V2LON,SICACODE;
          ELSE
            IF        SICSSEC=3
              CALL      KSICAA00                 * keyin SICA
              BRANCH    EXIT,KSICS950,KSICS950
            ELSE
              CALL      KSICSA00                 * keyin SICA (with security)
              BRANCH    EXIT,KSICS950,KSICS950
            ENDIF
          ENDIF
.
KSICS900  MOVE      ZERO,EXIT
          GOTO      KSICS999
.
KSICS940  CLEAR     DISPMSG
          APPEND    "You do not have access to any cost centres - ",DISPMSG
          BEEP
          CALL      MESSAGE1
.
          MATCH     "*",ANS
          IF        @EQUAL
            MATCH     "1426",PASSCODE
            IF        @EQUAL
              MOVE      "3",SICSSEC         * default to all cc's
              GOTO      KSICS100
            ENDIF
          ENDIF
          GOTO      KSICS950
.
KSICS950  MOVE      TWO,EXIT
.
KSICS999  RETURN
.----------------------------------------------------------------------
. Check cost centre security
. Returns SICSSEC : 0 = no access to any cost centres
.                   1 = access to one cost centre
.                   2 = access to more than one cost centre
.                   3 = access to all cost centres
.----------------------------------------------------------------------
CSICS000
          MOVE      "3",SICSSEC             * default to all cc's
.
          PACK      KEY9,SP70               * any security set up ???
          CALL      RSSICS1
          CALL      RKSICS1
          BRANCH    OVRCD,CSICS999
.
          PACK      KEY9,PASSCODE,SP70      * check for all cc's
          CALL      RDSICS1
          COMPARE   ZERO,OVRCD
          GOTO      CSICS999 IF EQUAL
.
          MOVE      "0",SICSSEC             * check for no cc's
          CALL      RKSICS1
          BRANCH    OVRCD,CSICS999
          MATCH     SICSUID,PASSCODE
          GOTO      CSICS999 IF NOT EQUAL
.
          PACK      KEY5,SICSCST,SP70       * read data for first cc
          CALL      RDSICA1
          MOVE      "1",SICSSEC
          CALL      RKSICS1                 * check for more than one cc
          BRANCH    OVRCD,CSICS999
          MATCH     SICSUID,PASSCODE
          GOTO      CSICS999 IF NOT EQUAL
.
          MOVE      "2",SICSSEC
.
CSICS999  RETURN
IMPLIN00
          MOVE     SIIMCAT,KEY7
          CALL     RDSIIA1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "im1",KEY6
          APPEND    SIIMUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "im2",KEY6
          APPEND    SIIMUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
          RETURN
IMPDET00   MOVE     SIIM1MKY,KEY12
           CALL     RDSIIM1
           IF       OVRCD=1
             BEEP
             MOVE     "Imprest Record Missing - ",DISPMSG
             CALL     MESSAGE1
             GOTO     IMPDET99
           ENDIF
           MOVE     SIIMCAT,KEY7
           CALL     RDSIIA1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "im1",KEY6
          APPEND    SIIMUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "im2",KEY6
          APPEND    SIIMUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
.
          CALL      SC10L000    * Detail Display Screen
.
IMPDET99  RETURN
BACDET00   MOVE     SIBACAT,KEY7
           CALL     RDSIIA1
           MOVE     SIBAWAR,KEY5
           CALL     RDSIWA1
           RETURN
.------------------------------------------------------------
. Back Order Item Selected
.------------------------------------------------------------
BACSEL00  MOVE     SIBA1MKY,KEY25
          CALL     RDSIBA1
          IF       OVRCD=1
            BEEP
            MOVE     "Backorder Record Missing - ",DISPMSG
            CALL     MESSAGE1
            GOTO     BACSEL99
          ENDIF
.
. check warehouse security access
.
          PACK      KEY9,PASSCODE,SIBAWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,BACSEL90
.
          MOVE     SIBACAT,KEY7
          CALL     RDSIIA1
          MOVE     SIBAWAR,KEY5
          CALL     RDSIWA1
.
          PACK     KEY25,SIIACAT,Z70
          PACK     SAVKEY10,SP70
          CALL     RSSIPC6
BACSEL10  CALL     RPSIPC6
          BRANCH   OVRCD,BACSEL20
          MATCH    SIPCCAT,SIIACAT
          GOTO     BACSEL20 IF NOT EQUAL
          MATCH    SP70,SIPCEDD
          GOTO     BACSEL20 IF EQUAL
          PACK     SAVKEY10,SIPCPON,SIPCITM
          GOTO     BACSEL10
.
BACSEL20  MATCH    SP70,SAVKEY10
          IF       @EQUAL
            CALL     CLRPO000
          ELSE
            MOVE     SAVKEY10,KEY10
            CALL     RDSIPC1
            MOVE     SIPCPON,KEY7
            CALL     RDSIPA1
          ENDIF
.
          CALL     SC11L000    * Detail Display Screen
          GOTO     BACSEL99
.
BACSEL90  CLEAR     DISPMSG
          APPEND    "You have no access for Warehouse ",DISPMSG
          APPEND    SIBAWAR,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      BACSEL99
.
BACSEL99  RETURN
.------------------------------------------------------------
. Clear Purchase Order Information
.------------------------------------------------------------
CLRPO000  MOVE      SP70,SIPAPON
          MOVE      SP70,SIPASUP
          MOVE      SP70,SIPAORI
          MOVE      SP70,SIPAICN
          MOVE      SP70,SIPASCN
          MOVE      SP70,SIPADEL
          MOVE      SP70,SIPAMES
          MOVE      SP70,SIPADIN
          MOVE      SP70,SIPADPR
          MOVE      SP70,SIPADCN
          MOVE      SP70,SIPADCM
          MOVE      SP70,SIPACON
          MOVE      SP70,SIPAIDP
          MOVE      SP70,SIPAUR1
          MOVE      SP70,SIPAUR2
          MOVE      SP70,SIPAUD1
          MOVE      SP70,SIPAUD2
          MOVE      SP70,SIPAUC1
          MOVE      SP70,SIPAUC2
          MOVE      SP70,SIPAUY1
          MOVE      SP70,SIPAUY2
          MOVE      SP70,SIPACST
          MOVE      SP70,SIPAWAR
          MOVE      SP70,SIPAPNT
          MOVE      SP70,SIPASPA
          MOVE      SP70,SIPCPON
          MOVE      SP70,SIPCITM
          MOVE      SP70,SIPCCST
          MOVE      SP70,SIPCPRD
          MOVE      SP70,SIPCDAT
          MOVE      SP70,SIPCWAR
          MOVE      SP70,SIPCCAT
          MOVE      SP70,SIPCPN
          MOVE      SP70,SIPCPD
          MOVE      SP70,SIPCCON
          MOVE      SP70,SIPCCDT
          MOVE      SP70,SIPCSUT
          MOVE      SP70,SIPCEDD
          MOVE      SP70,SIPCFDD
          MOVE      ZERO,SIPCOQT
          MOVE      ZERO,SIPCIQT
          MOVE      ZERO,SIPCRQT
          MOVE      ZERO,SIPCECT
          MOVE      ZERO,SIPCTCR
          MOVE      ZERO,SIPCTIN
          MOVE      ZERO,SIPCOQO
          MOVE      SP70,SIPCOOP
          MOVE      SP70,SIPCUR1
          MOVE      SP70,SIPCUR2
          MOVE      SP70,SIPCUD1
          MOVE      SP70,SIPCUD2
          MOVE      SP70,SIPCUY1
          MOVE      SP70,SIPCUY2
          MOVE      SP70,SIPCSPA
.
          RETURN
.
EYEAR000  CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EYEAR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      EYEAR990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      EYEAR000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
.
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
EYEAR100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EYEAR900
          ENDIF
          PACK      SICBDAT,FINYEAR,F2
          REP       " 0",SICBDAT
          PACK      KEY11,SICACODE,SICBDAT
          CALL      RDSICB1
          IF        OVRCD=1
            MOVE      ZERO,SICBBUD
            MOVE      ZERO,SICBAMT
          ENDIF
.
          STORE     SICBBUD,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SICBAMT,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SICBAMT-SICBBUD,VARPERXX
.
          IF        SICBAMT=0 & SICBBUD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SICBAMT=0 & SICBBUD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SICBAMT<>0 & SICBBUD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SICBBUD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
.
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          STORE     PVAPERXX,F2,PVAPER01,PVAPER02,PVAPER03,PVAPER04:
                               PVAPER05,PVAPER06,PVAPER07,PVAPER08:
                               PVAPER09,PVAPER10,PVAPER11,PVAPER12,PVAPER13
          ADD       SICBBUD,BUDPERXX
          ADD       SICBAMT,ACTPERXX
          GOTO      EYEAR100
.
EYEAR900 ASSIGN    ACTPERXX-BUDPERXX,VARPERXX
          IF        SICBAMT=0 & SICBBUD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SICBAMT=0 & SICBBUD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SICBAMT<>0 & SICBBUD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SICBBUD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
          GOTO      EYEAR999
.
EYEAR990  MOVE      TWO,EXIT
.
EYEAR999  RETURN
GPHU0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPHU1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Actual
          LOAD      SCGPVAL,F3,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  2",SCGPITM * Budget
          LOAD      SCGPVAL,F3,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          COMPARE   SIPENUM,F3
          GOTO      GPHU1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          CLEAR     GPHNAME
          STRIP     SICADESC
          APPEND    SICADESC,GPHNAME
.
          MATCH     "15",SCRID
          IF        @EQUAL
            MOVE      SIIADES,KEY35
            STRIP     KEY35
            APPEND    SP1,GPHNAME
            APPEND    KEY35,GPHNAME
          ENDIF
.
          MATCH     "05",SCRID
          IF        @EQUAL
            STRIP     SIGADES
            APPEND    SP1,GPHNAME
            APPEND    SIGADES,GPHNAME
          ENDIF
.
          MATCH     "06",SCRID
          IF        @EQUAL
            STRIP     SISADESC
            APPEND    SP1,GPHNAME
            APPEND    SISADESC,GPHNAME
          ENDIF
.
          APPEND    " Usage for ",GPHNAME
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Actual    ",GPHLEDG[1]
          MOVE      "Budget     ",GPHLEDG[2]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      TWO,GPHNTYP     * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.
PERANA00  PACK      SIPEDATE,CCC,CYY,CMM,CDD
          REP       " 0",SIPEDATE
          CALL      RSIPE000
          MOVE      SIPEPER,FINPERD
          KEYIN     *P1:24,*EL,"Enter Period for Analysis : ":
                      *V2LON,*RV,*JR,*DE,*ZF,FINPERD
          PACK      KEY6,FINYEAR,FINPERD
          CALL      RDSIPE1
          IF        OVRCD=1
            BEEP
            DISPLAY   *P1:24,*EL,"Invalid Period - ";
            CALL      HITENTER
            GOTO      PERANA00
          ENDIF
.
PERANA10  KEYIN     *P1:24,*EL,*V2LON,"C",*HOFF,"ommodity Group or ":
                               *V2LON,"P",*HOFF,"roduct Group Analysis : ":
                    *V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSP,ANS
          GOTO      PERANA50 IF EQUAL
          MATCH     ANSC,ANS
          GOTO      PERANA10 IF NOT EQUAL
.
          CALL      SC12L000  * Analysis by Commodity
          GOTO      PERANA99
PERANA50  CALL      SC13L000  * Analysis by Product Group
          GOTO      PERANA99
PERANA99  RETURN
ECOMY000  CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      ECOMY990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      ECOMY990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      ECOMY000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
ECOMY100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      ECOMY900
          ENDIF
          PACK      SICEDAT,FINYEAR,F2
          REP       " 0",SICEDAT
          PACK      KEY16,SICACODE,SICEDAT,SIGACOD
          CALL      RDSICE1
          IF        OVRCD=1
            MOVE      ZERO,SICEBUD
            MOVE      ZERO,SICEAMT
          ENDIF
.
          STORE     SICEBUD,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SICEAMT,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SICEAMT-SICEBUD,VARPERXX
.
          IF        SICEAMT=0 & SICEBUD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SICEAMT=0 & SICEBUD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SICEAMT<>0 & SICEBUD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SICEBUD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
.
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          STORE     PVAPERXX,F2,PVAPER01,PVAPER02,PVAPER03,PVAPER04:
                               PVAPER05,PVAPER06,PVAPER07,PVAPER08:
                               PVAPER09,PVAPER10,PVAPER11,PVAPER12,PVAPER13
          ADD       SICEBUD,BUDPERXX
          ADD       SICEAMT,ACTPERXX
          GOTO      ECOMY100
.
ECOMY900 ASSIGN    ACTPERXX-BUDPERXX,VARPERXX
          IF        SICEAMT=0 & SICEBUD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SICEAMT=0 & SICEBUD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SICEAMT<>0 & SICEBUD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SICEBUD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
          GOTO      ECOMY999
.
ECOMY990  MOVE      TWO,EXIT
.
ECOMY999  RETURN
EPRDY000  CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EPRDY990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      EPRDY990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      EPRDY000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
EPRDY100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EPRDY900
          ENDIF
          PACK      SICFDAT,FINYEAR,F2
          REP       " 0",SICFDAT
          PACK      KEY16,SICACODE,SICFDAT,SISACODE
          CALL      RDSICF1
          IF        OVRCD=1
            MOVE      ZERO,SICFBUD
            MOVE      ZERO,SICFAMT
          ENDIF
.
          STORE     SICFBUD,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SICFAMT,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SICFAMT-SICFBUD,VARPERXX
.
          IF        SICFAMT=0 & SICFBUD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SICFAMT=0 & SICFBUD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SICFAMT<>0 & SICFBUD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SICFBUD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
.
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          STORE     PVAPERXX,F2,PVAPER01,PVAPER02,PVAPER03,PVAPER04:
                               PVAPER05,PVAPER06,PVAPER07,PVAPER08:
                               PVAPER09,PVAPER10,PVAPER11,PVAPER12,PVAPER13
          ADD       SICFBUD,BUDPERXX
          ADD       SICFAMT,ACTPERXX
          GOTO      EPRDY100
.
EPRDY900 ASSIGN    ACTPERXX-BUDPERXX,VARPERXX
          IF        SICFAMT=0 & SICFBUD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SICFAMT=0 & SICFBUD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SICFAMT<>0 & SICFBUD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SICFBUD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
          GOTO      EPRDY999
.
EPRDY990  MOVE      TWO,EXIT
.
EPRDY999  RETURN
ORDDET00  MOVE     SIPCPON,KEY7
          CALL     RDSIPA1
          MATCH    SP70,SIPCCAT
          IF       !@EQUAL
            MOVE     SIPCCAT,KEY7
            CALL     RDSIIA1
            IF       OVRCD=0
              MOVE     SIIADES,SIPCPD
            ENDIF
          ENDIF
          UNPACK   SIPCDAT,CCENT,CYEAR,CMON
          PACK     PERUSAGE,CMON,SLASH,CCENT,CYEAR
          RETURN
.----------------------------------------------------------------------
. Selected Order Display
.----------------------------------------------------------------------
SELORD00  MATCH    "07",SCRID
          IF       @EQUAL
            UNPACK   SIPC2MKY,SIPCCST,SIPCDAT,SIPCPON,SIPCITM
          ELSE
            UNPACK   SIPC5MKY,SIPCCST,SIPCEDD,SIPCPON,SIPCITM
          ENDIF
          PACK     KEY10,SIPCPON,SIPCITM
          CALL     RDSIPC1
          IF       OVRCD=1
            BEEP
            MOVE     "Purchase Not Found - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SELORD99
          ENDIF
          MATCH    SP70,SIPCCAT
          IF       @EQUAL
            PACK     ITEMDESC,SIPCPD,SP70
            MOVE     ONE,SIFACTOR
          ELSE
            MOVE     SIPCCAT,KEY7
            CALL     RDSIIA1
            PACK     ITEMDESC,SIIADES
            PACK     KEY30,SIIAISS,SIPCSUT
            CALL     RDSIFA1
            IF       OVRCD=1
              MOVE     ONE,SIFACTOR
            ENDIF
          ENDIF
          ASSIGN   SIPCOQT*SIFACTOR,ORDQTY
          ASSIGN   SIPCECT*SIPCOQT,F12P2
          IF       SIPCECT<0
            MOVE     "      T.B.A,",ITEMCOST
          ELSE
            MOVE     F12P2,F9P2
            MOVE     F9P2,ITEMCOST
          ENDIF
          MOVE     SIPCPON,KEY7
          CALL     RDSIPA1
          MOVE     SIPASUP,KEY5
          CALL     RDAPMA1
.
          CALL     SC14L000
.
SELORD99  RETURN
OUTDET00  MOVE     SIPCPON,KEY7
          CALL     RDSIPA1
.
          MOVE     ONE,SIFACTOR
          MATCH    SP7,SIPCCAT
          IF       !@EQUAL
            PACK     KEY7,SIPCCAT,SP70
            CALL     RDSIIA1
            IF       OVRCD=0
              MOVE     SIIADES,SIPCPD
              PACK     KEY30,SIIAISS,SIPCSUT,SP70
              CALL     RDSIFA1
            ENDIF
          ENDIF
.
          ASSIGN   SIPCOQT-(SIPCRQT/SIFACTOR),OUTQTY
.
          ASSIGN   SIPCECT*OUTQTY,F12P2
          IF       SIPCECT<0
            MOVE     "      T.B.A,",ITEMCOST
          ELSE
            MOVE     F12P2,F9P2
            MOVE     F9P2,ITEMCOST
          ENDIF
          RETURN
.----------------------------------------------------------------------
. delete temp file
.----------------------------------------------------------------------
DTEMP000  CLOSE     NEZTMP0B                     * delete temp file
          CLOSE     SINREAA4
          PACK      FILENAMB,NAMEB,PORT,SP70
          REP       " 0",FILENAMB
          PACK      KILLTMPB,ISERASE,FILENAMB
          EXECUTE   KILLTMPB,TASKID
          OPEN      SINREAA4,"sinreaaf"          * re-open SINREAA4
.
DTEMP999  RETURN
.----------------------------------------------------------------------
. Requisition Detail
.----------------------------------------------------------------------
REQDET00  IF        SIRAIND=1
            MOVE      "Return      ",REQINDIC
          ELSE
            MOVE      "Requisition ",REQINDIC
          ENDIF
.
REQDET99  RETURN
.---------------------------------------------------------------------------
. KYRPD - keyin year/period
.         Returns : EXIT      (0=period entered, 2=no period entered)
.                   SIPEYEAR  (Year)
.                   SIPEPER   (Period)
.                   CURCODE   (Display Year/Period "CCYY/PP")} these variables
.                   DESC1     (Display Date Range)           } are declared
.                   FROMDATE  (First Date in Period)         } in SINTMPDF/INC
.                   TODATE    (Last Date in Period)          }
.---------------------------------------------------------------------------
KYRPD000  CALL      KYEAR000           * keyin year
          COMPARE   "2",EXIT           * exit if no year entered
          GOTO      KYRPD999 IF EQUAL
.
          CALL      KPERD000           * keyin period
          COMPARE   "2",EXIT           * restart if no period entered
          GOTO      KYRPD000 IF EQUAL
.
.---- set up display variables ----
.
          PACK      CURCODE,SIPEYEAR,SLASH,SIPEPER,SP70
.
          PACK      FROMDATE,SIPESDT,SP70
          UNPACK    FROMDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          CLEAR     DESC1
          APPEND    "Starting ",DESC1
          APPEND    CPCDATE,DESC1
.
          PACK      TODATE,SIPEEDT,SP70
          UNPACK    TODATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          APPEND    "  Ending ",DESC1
          APPEND    CPCDATE,DESC1
          APPEND    SP70,DESC1
          RESET     DESC1
.
.---- create temp file                          ----
.---- NOTE : HERE WE SWAP SINREAA4 AND NEZTMP0B ----
.
          PACK      FILENAMB,NAMEB,PORT,SP70     * set up and open temp file
          REP       " 0",FILENAMB
          PACK      MAKETMPB,ISBUILD,FILENAMB,TMP0BDAT
          PACK      KILLTMPB,ISERASE,FILENAMB
          CLOSE     NEZTMP0B
          EXECUTE   KILLTMPB,TASKID
          EXECUTE   MAKETMPB,TASKID
          OPEN      NEZTMP0B,"sinreaaf"
          OPEN      SINREAA4,FILENAMB
.
          PACK      KEY21,SICACODE,FROMDATE,SP70
          CALL      RSNEZB1                      * load data into temp file
.
KYRPD100  CALL      RKNEZB1
          BRANCH    OVRCD,KYRPD999
          MATCH     SIRACST,SICACODE
          GOTO      KYRPD999 IF NOT EQUAL
          MATCH     SIRADAT,TODATE
          GOTO      KYRPD999 IF LESS
.
          PACK      KEY21,SIRACST,SIRADAT,SIRATYP,SIRAREQ
          CALL      RASIRA4                  * Check if it already exists
          IF        OVRCD=1
            CALL      WRSIRA4
          ENDIF
          GOTO      KYRPD100
.
KYRPD999  RETURN
.---------------------------------------------------------------------------
. KYEAR - keyin year
.---------------------------------------------------------------------------
KYEAR000  CALL      RINPECON           * default to current year
          MOVE      SIPECYR,SIPEYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,SIPEYEAR
          PACK      SIPEYEAR,SIPEYEAR,SP70
.
          MATCH     SP70,SIPEYEAR
          GOTO      KYEAR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,SIPEYEAR
          GOTO      KYEAR990 IF EQUAL
.
          TYPE      SIPEYEAR           * valid numeric ?
          GOTO      KYEAR000 IF NOT EQUAL
.
          MOVE      SIPEYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   SIPEYEAR
            MOVE      SIPEYEAR,FORM2
            PACK      SIPEYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",SIPEYEAR
          MOVE      ZERO,EXIT          * year ok
          GOTO      KYEAR999
.
KYEAR990  MOVE      TWO,EXIT           * no year entered
.
KYEAR999  RETURN
.---------------------------------------------------------------------------
. KPERD - keyin period
.---------------------------------------------------------------------------
KPERD000  KEYIN     *PCCOL:CVERT,*V2LON,*DV,SIPEYEAR,*DV,SLASH,*MASK,F2
          COMPARE   ZERO,F2            * no period entered ?
          GOTO      KPERD990 IF EQUAL
.                                      * period greater than total no. of perds
          IF        F2>SIPENUM
            BEEP
            MOVE      "Invalid Period - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KPERD000
          ENDIF
.
          MOVE      F2,SIPEPER         * check if period exists
          REP       " 0",SIPEPER
          PACK      KEY6,SIPEYEAR,SIPEPER,SP70
          REP       " 0",KEY6
          CALL      RDSIPE1
          IF        OVRCD=1
            BEEP
            MOVE      "Period NOT Created - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KPERD000
          ENDIF
.
          MOVE      ZERO,EXIT          * period ok
          GOTO      KPERD999
.
KPERD990  MOVE      TWO,EXIT           * no period entered
          DISPLAY   *PCCOL:CVERT,*V2LON,SIPEYEAR,SP3
.
KPERD999  RETURN
.
. NEZTMP0B
. --------
. Filename     : sin14Bxx.dat
.
RSNEZB1   RESET     KEY21
          READ      NEZTMP0B,KEY21;;
          RETURN
.
RANEZB1   RESET     KEY21
          MOVE      ZERO,OVRCD
          READ      NEZTMP0B,KEY21;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RDNEZB1   RESET     KEY21
          MOVE      ZERO,OVRCD
          READ      NEZTMP0B,KEY21;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      OVERCOND IF OVER
          RETURN
.
RKNEZB1
          MOVE      ZERO,OVRCD
          READKS    NEZTMP0B;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      OVERCOND IF OVER
          RETURN
.
RPNEZB1
          MOVE      ZERO,OVRCD
          READKP    NEZTMP0B;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      OVERCOND IF OVER
          RETURN
.
UPNEZB1
          UPDATE    NEZTMP0B;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      UPDFLOCK IF LOCKED
          RETURN
.
WRNEZB1   RESET     KEY21
          WRITE     NEZTMP0B,KEY21;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          RETURN
.
DENEZB1   RESET     KEY21
          DELETE    NEZTMP0B,KEY21
          RETURN
.
RLNEZB1   RESET     KEY21
          MOVE      ZERO,OVRCD
          READL     NEZTMP0B,KEY21;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
KLNEZB1
          MOVE      ZERO,OVRCD
          READLKS   NEZTMP0B;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
PLNEZB1
          MOVE      ZERO,OVRCD
          READLKP   NEZTMP0B;SIRATYP,SIRAREQ,SIRAIND,SIRACST,SIRADAT:
                        SIRADEL,SIRATOT,SIRASPA
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
UUNEZB1   RESET     KEY21
          UNLOCK    NEZTMP0B
          RETURN
.
.----------------------------------------------------------------------
. Selected Requisition Display
. Verifies for Warehouse Secruity Access being Displayed
.----------------------------------------------------------------------
SELREQ00  MOVE     SIRA4MKY,KEY21
          CALL     RDSIRA4
          BRANCH   OVRCD,SELREQ90
.
          PACK     KEY20,SIRATYP,SIRAREQ,SP70
          CALL     RSSIRB1
SELREQ10  CALL     RKSIRB1
          BRANCH   OVRCD,SELREQ80
.
          MATCH    SIRBTYP,SIRATYP
          GOTO     SELREQ80 IF NOT EQUAL
.
          MATCH    SIRBREQ,SIRAREQ
          GOTO     SELREQ80 IF NOT EQUAL
.
. check warehouse security
.
          MATCH    SP70,SIRBWAR
          GOTO     SELREQ50 IF EQUAL
.
          PACK     KEY9,PASSCODE,SIRBWAR,SP70
          CALL     RDSIWS1
          BRANCH   OVRCD,SELREQ10
.
SELREQ50  CALL     REQDET00
          CALL     SC15L000
.
          GOTO     SELREQ99
.
SELREQ80  BEEP
          MOVE     "You have no Warehouse Access - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SELREQ99
.
SELREQ90  BEEP
          MOVE     "Requisition Not Found - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SELREQ99
.
SELREQ99  RETURN
REDCOM00  MOVE      SICECOM,KEY6                                       *C-59696
          CALL      RDSIGA1
          ASSIGN    SICEBUD-SICEAMT,VARIANCE
          ASSIGN    (VARIANCE/SICEBUD)*100.0,PVARIANC
          RETURN
GPER0000  DISPLAY  *P1:24,*EL,"Loading Graph Details"
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MATCH     "12",SCRID
          CALL      LCOMD000 IF EQUAL
          MATCH     "13",SCRID
          CALL      LPROD000 IF EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          CLEAR     GPHNAME
          STRIP     SICADESC
          APPEND    SICADESC,GPHNAME
.
          MATCH     "12",SCRID
          IF        @EQUAL
            APPEND   " Commodity Usage for ",GPHNAME
          ELSE
            APPEND   " Product Usage for ",GPHNAME
          ENDIF
          MOVE      FINPERD,F2
          LOAD      KEY10,F2,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
.
          STRIP     KEY10
          APPEND    KEY10,GPHNAME
          APPEND    SP1,KEY10
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Actual $",GPHLEDG[1]
          MOVE      "Budget $",GPHLEDG[2]
.
          MOVE      "25",GPHNOCOY    * Width of Y Axis Description Display
          MOVE      TWO,GPHNTYP      * Number of Columns per Period
          MOVE      SIX,GPHNOCOX     * Width of X Axis Description Display
          MOVE      ONE,GPHTYPE      * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH         * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.--------------------------------------------------
. Load Commodity Details
.--------------------------------------------------
LCOMD000  MOVE      ZERO,F3
          MOVE      ZERO,SECTOR
          MOVE      ZERO,F1
          PACK      KEY16,SICACODE,FINYEAR,FINPERD,SP70
          PACK      KEY11,SICACODE,FINYEAR,FINPERD,SP70
          CALL      RSSICE1
.
LCOMD100  CALL      RKSICE1
          BRANCH    OVRCD,LCOMD999
          PACK      KEY16,SICECST,SICEDAT,SICECOM
          MATCH     KEY11,KEY16
          GOTO      LCOMD999 IF NOT EQUAL
.
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      LCOMD190 IF NOT EQUAL
          MOVE      ZERO,SECTOR
          ADD       ONE,F1
LCOMD110
          KEYIN     *P1:24,*EL,*DV,F1,"00 Groups Loaded. Continue (":
                    *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? ":
                    *V2LON,ANS
          REP       UPPLOW,ANS
          MOVE      ONE,OVRCD
          MATCH     ANSN,ANS
          GOTO      LCOMD999 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      LCOMD110 IF NOT EQUAL
LCOMD190
          CLEAR     SCGPDES
          STRIP     SICECOM
          APPEND    SICECOM,SCGPDES
          APPEND    SP1,SCGPDES
          MOVE      SICECOM,KEY6                                       *C-59696
          CALL      RDSIGA1
          IF        OVRCD=0
            APPEND    SIGADES,SCGPDES
          ELSE
            APPEND    "Invalid Code",SCGPDES
          ENDIF
          RESET     SCGPDES
.
          ADD       ONE,F3
          COMPARE   "999",F3
          GOTO      LCOMD999 IF EQUAL
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Actual
          MOVE      SICEAMT,SCGPVAL
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  2",SCGPITM * Budget
          MOVE      SICEBUD,SCGPVAL
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          GOTO      LCOMD100
LCOMD999  RETURN
.
.--------------------------------------------------
. Load product Group Details
.--------------------------------------------------
LPROD000  MOVE      ZERO,F3
          MOVE      ZERO,SECTOR
          MOVE      ZERO,F1
          PACK      KEY16,SICACODE,FINYEAR,FINPERD,SP70
          PACK      KEY11,SICACODE,FINYEAR,FINPERD,SP70
          CALL      RSSICF1
.
LPROD100  CALL      RKSICF1
          BRANCH    OVRCD,LPROD999
          PACK      KEY16,SICFCST,SICFDAT,SICFSUB
          MATCH     KEY11,KEY16
          GOTO      LPROD999 IF NOT EQUAL
.
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      LPROD190 IF NOT EQUAL
          MOVE      ZERO,SECTOR
          ADD       ONE,F1
LPROD110
          KEYIN     *P1:24,*EL,*DV,F1,"00 Groups Loaded. Continue (":
                    *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? ":
                    *V2LON,ANS
          REP       UPPLOW,ANS
          MOVE      ONE,OVRCD
          MATCH     ANSN,ANS
          GOTO      LPROD999 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      LPROD110 IF NOT EQUAL
LPROD190
.
          CLEAR     SCGPDES
          STRIP     SICFSUB
          APPEND    SICFSUB,SCGPDES
          APPEND    SP1,SCGPDES
          MOVE      SICFSUB,KEY5
          CALL      RDSISA1
          IF        OVRCD=0
            APPEND    SISADESC,SCGPDES
          ELSE
            APPEND    "Invalid Code",SCGPDES
          ENDIF
          RESET     SCGPDES
.
          ADD       ONE,F3
          COMPARE   "999",F3
          GOTO      LPROD999 IF EQUAL
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Actual
          MOVE      SICFAMT,SCGPVAL
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  2",SCGPITM * Budget
          MOVE      SICFBUD,SCGPVAL
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          GOTO      LPROD100
LPROD999  RETURN
REDSUB00  MOVE      SICFSUB,KEY5
          CALL      RDSISA1
          ASSIGN    SICFBUD-SICFAMT,VARIANCE
          ASSIGN    (VARIANCE/SICFBUD)*100.0,PVARIANC
          RETURN
. ---------------------------------------------------------
. Check appropriate Warehouse to be displayed
. ---------------------------------------------------------
.
. check warehouse security access
.
CWAR0000  MATCH     SP70,SIRBWAR
          GOTO      CWAR9999 IF EQUAL
.
          PACK      KEY9,PASSCODE,SIRBWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,CWAR0100
          GOTO      CWAR9999
.
CWAR0100  CALL      RKSIRB1
          BRANCH    OVRCD,CWAR9900
.
          MATCH     SIRATYP,SIRBTYP
          GOTO      CWAR9900 IF NOT EQUAL
.
          MATCH     SIRAREQ,SIRBREQ
          GOTO      CWAR9900 IF NOT EQUAL
.
          GOTO      CWAR9999
.
CWAR9900  MOVE      ONE,OVRCD
          MOVE      ONE,SIRB1END
          GOTO      CWAR9999
.
CWAR9999  RETURN
.
PRQDET00
          MOVE      SP70,SIIASUB
          MOVE      SP70,SIIADES
          PACK      KEY7,SIQACAT,SP70
          CALL      RDSIIA1
.
          MOVE      SP70,SICDDESC
          MOVE      "PRC",SICDCATA
          PACK      KEY6,SICDCATA,SIQASTA,SP70
          CALL      RDSICD1
.
          MOVE      SP70,SECUSER
          PACK      KEY4,SIQAUID,SP70
          CALL      RDPASS1
.
          RETURN
.----------------------------------------------------------------------
. Selected Requisition Display
.----------------------------------------------------------------------
SELPRQ00  MOVE     SIQA1MKY,KEY13
          CALL     RDSIQA1
          IF       OVRCD=1
            BEEP
            MOVE     "Purchase Requisition Not Found - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SELPRQ99
          ENDIF
.
          CALL     PRQDET00
          CALL     SC18L000
.
SELPRQ99  RETURN
PRHDET00
          MOVE      SP70,SECUSER
          PACK      KEY4,SIQCPID,SP70
          CALL      RDPASS1
          MOVE      SECUSER,PIDDESC
.
          MOVE      SP70,SIORNAME
          PACK      KEY3,SIQCORI,SP70
          CALL      RDSIOR1
.
          MOVE      SP70,PTYDESC
          IF        SIQCPTY=0
            CLEAR     PTYDESC
            APPEND    "Stock Order ",PTYDESC
            APPEND    SIQCREQ,PTYDESC
            APPEND    " for Cost Centre ",PTYDESC
            APPEND    SIQCCST,PTYDESC
            APPEND    SP70,PTYDESC
            RESET     PTYDESC
          ENDIF
          IF        SIQCPTY=1
            CLEAR     PTYDESC
            APPEND    "Purchase Order ",PTYDESC
            APPEND    SIQCORD,PTYDESC
            APPEND    " for Supplier ",PTYDESC
            APPEND    SIQCSUP,PTYDESC
            APPEND    SP70,PTYDESC
            RESET     PTYDESC
          ENDIF
          IF        SIQCPTY=2
            CLEAR     PTYDESC
            APPEND    "Cancelled by Cost Centre ",PTYDESC
            MATCH     SP70,SIQCCAN
            IF        !@EQUAL
              APPEND    "because ",PTYDESC
              APPEND    SIQCCAN,PTYDESC
            ENDIF
            APPEND    SP70,PTYDESC
            RESET     PTYDESC
          ENDIF
          IF        SIQCPTY=3
            CLEAR     PTYDESC
            APPEND    "Cancelled by Supply ",PTYDESC
            MATCH     SP70,SIQCCAN
            IF        !@EQUAL
              APPEND    "because ",PTYDESC
              APPEND    SIQCCAN,PTYDESC
            ENDIF
            APPEND    SP70,PTYDESC
            RESET     PTYDESC
          ENDIF
.
          MOVE      SP70,APMASN1
          MOVE      SP70,APMASN2
          PACK      KEY5,SIQCSUP,SP70
          CALL      RDAPMA1
.
          MOVE      SP70,SISADESC
          PACK      KEY5,SIQCPGP,SP70
          CALL      RDSISA1
.
          MOVE      SP70,SIIASUB
          MOVE      SP70,SIIADES
          PACK      KEY7,SIQCCAT,SP70
          CALL      RDSIIA1
.
          MOVE      SP70,SICDDESC
          MOVE      "PRC",SICDCATA
          PACK      KEY6,SICDCATA,SIQCSTA,SP70
          CALL      RDSICD1
.
          MOVE      SP70,SECUSER
          PACK      KEY4,SIQCUID,SP70
          CALL      RDPASS1
.
          RETURN
.----------------------------------------------------------------------
. Selected Requisition Display
.----------------------------------------------------------------------
SELPRH00  MOVE     SIQC1MKY,KEY13
          CALL     RDSIQC1
          IF       OVRCD=1
            BEEP
            MOVE     "Purchase Requisition Not Found - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SELPRH99
          ENDIF
.
          CALL     PRHDET00
          CALL     SC19L000
.
SELPRH99  RETURN
IMPDSQ00   MOVE     SIIM3MKY,KEY16
           CALL     RDSIIM3
           IF       OVRCD=1
             BEEP
             MOVE     "Imprest Record Missing - ",DISPMSG
             CALL     MESSAGE1
             GOTO     IMPDET99
           ENDIF
           MOVE     SIIMCAT,KEY7
           CALL     RDSIIA1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "im1",KEY6
          APPEND    SIIMUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "im2",KEY6
          APPEND    SIIMUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
.
          CALL      SC10L000    * Detail Display Screen
.
IMPDSQ99  RETURN

.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSMASIO/INC
          INC       FMSAMAIO/INC
          INC       FMSCCAIO/INC
          INC       FMSCONIO/INC
          INC       FMSLMAIO/INC
          INC       GPHSTDCD    
          INC       IBAPASIO/INC
          INC       SINBACIO/INC
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCCBIO/INC
          INC       SINCCCIO/INC
          INC       SINCCEIO/INC
          INC       SINCCFIO/INC
          INC       SINCGAIO/INC
          INC       SINCGAKY    
          INC       SINCIAIO/INC
          INC       SINCODIO/INC
          INC       SINCSEIO/INC
          INC       SINCSEKY    
          INC       SINFACIO/INC
          INC       SINIMPIO/INC
          INC       SINNATIO/INC
          INC       SINOQAIO/INC
          INC       SINOQBIO/INC
          INC       SINOQCIO/INC
          INC       SINORIIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINREAIO/INC
          INC       SINREBIO/INC
          INC       SINSCDIO/INC
          INC       SINSCFIO/INC
          INC       SINSCMIO/INC
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
.
          INC       STDGENCD
.
