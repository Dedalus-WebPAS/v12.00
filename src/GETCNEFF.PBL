GETCNEFF
. ******************************************************************************
.* System         : Patient Billing                                           *
.* Include Name   : GETCNEFF.PBL                                              *
.* Author         : J.Tan                                                     *
.* Date           : 14/01/2011                                                *
.* Function       : Routine to get the Contract Effective From                *
.* Modification   :                                                           *
.*                  V10.05.01 25/09/2014 J.Tan     CAR 306416                 *
.*                            Mods checking for NZ Private bed fees           *
.*                                                                            *
.* Requires       :                                                           *
.*                  KEY9   - Claim Code                                       *
.*                         - Health Fund                                      *
.*                  ASTAT  - Admission Status                                 *
.*                                                                            *
.* Returns        : CNTRCEFR 0 - As at the Effective date                     *
.*                           1 - For Admission From                           *
.*                           2 - For Discharge From                           *
.*                           3 - Contract Effective Details not valid/found   *
.*                  EXIT     1 - Contract Effective Details not Found         *
. ******************************************************************************
GCEF0000  MOVE      ZERO,EXIT
          MOVE      ZERO,CNTRCEFR
          COMPARE   FIVE,CFEETYP
          GOTO      GCEF9999 IF EQUAL       * NZ Private
          COMPARE   NINE,CFEETYP
          GOTO      GCEF9999 IF EQUAL       * Johns Hopkins
.
          OPEN      PATCFAA1,"patcfaaf"
          OPEN      PATFX1A1,"patfx1af"
.
          UNPACK    KEY9,KEY3,KEY6          * Get Contract eff.date of Claim
          CALL      RDPTCFA1
          BRANCH    OVRCD,GCEF1000
.
          MATCH     "3",PTCFCEFR
          GOTO      GCEF1000 IF EQUAL       * Not in use
.
          MOVE      PTCFCEFR,CNTRCEFR       * Contract Type of Effective from
          GOTO      GCEF8000
.
GCEF1000  MATCH     SP70,KEY6
          GOTO      GCEF9000 IF EQUAL
.
          CALL      RDPTFX11                * Get Contract Eff.date of HF
          BRANCH    OVRCD,GCEF9000
.
          MOVE      PTFXCEFR,CNTRCEFR       * Contract Effective from
.
GCEF8000  MOVE      ZERO,EXIT
          GOTO      GCEF9999
.
GCEF9000  MOVE      THREE,CNTRCEFR          * Invalid
          MOVE      ONE,EXIT
GCEF9999  RETURN
