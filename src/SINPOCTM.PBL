. *----------------------------------------------------------------------
. * Include Name  :   SINPOCTM.PBL
. *
. * Function      :   CGI variable functions for SINPOCFD - sinpocaf.dat
. *
. * Modifications :
. *
. * V9.04.01 22/02/2005 Lina Vo                  CAR 56406
. *          Pack SIPOC007 with spaces
. * V9.04.00 25/01/2005 Lina Vo                  CAR 56406
. *          Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear parameters for the Purchase Order Line item file
.------------------------------------------------------------------------
CPSIPC00  MOVE      Z70,SIPOC001
          MOVE      Z70,SIPOC002
          MOVE      Z70,SIPOC003
          MOVE      Z70,SIPOC004
          MOVE      Z70,SIPOC005
          MOVE      Z70,SIPOC006
          MOVE      Z70,SIPOC007
          MOVE      Z70,SIPOC008
          MOVE      Z70,SIPOC009
          MOVE      Z70,SIPOC010
          MOVE      Z70,SIPOC011
          MOVE      Z70,SIPOC012
          MOVE      Z70,SIPOC013
          MOVE      Z70,SIPOC014
          MOVE      Z70,SIPOC015
          MOVE      Z70,SIPOC016
          MOVE      Z70,SIPOC017
          MOVE      Z70,SIPOC018
          MOVE      Z70,SIPOC019
          MOVE      Z70,SIPOC020
          MOVE      Z70,SIPOC021
          MOVE      Z70,SIPOC022
          MOVE      Z70,SIPOC023
          MOVE      Z70,SIPOC024
          MOVE      Z70,SIPOC025
          MOVE      Z70,SIPOC026
          MOVE      Z70,SIPOC027
          MOVE      Z70,SIPOC028
          MOVE      Z70,SIPOC029
          MOVE      Z70,SIPOC030
          MOVE      Z70,SIPOC031
          MOVE      Z70,SIPOC032
          MOVE      Z70,SIPOC033
.
CPSIPC99  RETURN
.------------------------------------------------------------
. Purchase Order Line item file standard tags
.------------------------------------------------------------
SIPC0000  BRANCH    FLDITMNO,SIPC0010,SIPC0020,SIPC0030,SIPC0040,SIPC0050:
                             SIPC0060,SIPC0070,SIPC0080,SIPC0090,SIPC0100:
                             SIPC0110,SIPC0120,SIPC0130,SIPC0140,SIPC0150:
                             SIPC0160,SIPC0170,SIPC0180,SIPC0190,SIPC0200:
                             SIPC0210,SIPC0220,SIPC0230,SIPC0240,SIPC0250:
                             SIPC0260,SIPC0270,SIPC0280,SIPC0290,SIPC0300:
                             SIPC0310,SIPC0320,SIPC0330
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      SIPC9999
.
SIPC0010  WRITE     HTMLFILE;SIPCPON;
          GOTO      SIPC9999
.
SIPC0020  WRITE     HTMLFILE;SIPCITM;
          GOTO      SIPC9999
.
SIPC0030  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPC0031
          WRITE     HTMLFILE;SIPCCST;
          GOTO      SIPC9999
.
SIPC0031  PACK      KEY5,SIPCCST,SP10
          CALL      RDSICA1
          BRANCH    OVRCD,SIPC9999
.
          WRITE     HTMLFILE;SICADESC;
          GOTO      SIPC9999
.
SIPC0040  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPC0041,SIPC0042
          WRITE     HTMLFILE;SIPCPRD;
          GOTO      SIPC9999
.
SIPC0041  PACK      KEY5,SIPCPRD,SP10
          CALL      RDSISA1
          BRANCH    OVRCD,SIPC9999
.
          WRITE     HTMLFILE;SISADESC;
          GOTO      SIPC9999
.
SIPC0042  PACK      KEY5,SP10
          CALL      RSSISA1
SIPC0043  CALL      RKSISA1
          BRANCH    OVRCD,SIPC9999
.
          PACK      KEY7,QUOTE,SISACODE,QUOTE,SP10
          MATCH     SIPCPRD,SISACODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY7," selected>",SISADESC:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY7,">",SISADESC:
                               "</option>";
          ENDIF
          GOTO      SIPC0043
.
SIPC0050  WRITE     HTMLFILE;SIPCDAT;
          GOTO      SIPC9999
.
SIPC0060  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPC0061
          WRITE     HTMLFILE;SIPCWAR;
          GOTO      SIPC9999
.
SIPC0061  PACK      KEY5,SIPCWAR,SP10
          CALL      RDSIWA1
          BRANCH    OVRCD,SIPC9999
.
          WRITE     HTMLFILE;SIWADES;
          GOTO      SIPC9999
.
SIPC0070  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPC0071
          WRITE     HTMLFILE;SIPCCAT;
          GOTO      SIPC9999
.
SIPC0071  PACK      KEY7,SIPCCAT,SP10
          CALL      RDSIIA1
          BRANCH    OVRCD,SIPC9999
.
          WRITE     HTMLFILE;SIIADES;
          GOTO      SIPC9999
.
SIPC0080  WRITE     HTMLFILE;SIPCPN;
          GOTO      SIPC9999
.
SIPC0090  WRITE     HTMLFILE;SIPCPD;
          GOTO      SIPC9999
.
SIPC0100  WRITE     HTMLFILE;SIPCCON;
          GOTO      SIPC9999
.
SIPC0110  MATCH     SIPCCDT,SP70
          GOTO      SIPC9999 IF EQUAL
.         
          UNPACK    SIPCCDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPC9999
.
SIPC0120  WRITE     HTMLFILE;SIPCSUT;
          GOTO      SIPC9999
.
SIPC0130  MATCH     SIPCEDD,SP70
          GOTO      SIPC9999 IF EQUAL
.         
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPC9999
.
SIPC0140  MATCH     SIPCFDD,SP70
          GOTO      SIPC9999 IF EQUAL
.         
          UNPACK    SIPCFDD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPC9999
.
SIPC0150  MOVE      SIPCOQT,F10
          WRITE     HTMLFILE;F10;
          GOTO      SIPC9999
.
SIPC0160  MOVE      SIPCIQT,F10
          WRITE     HTMLFILE;F10;
          GOTO      SIPC9999
.
SIPC0170  MOVE      SIPCRQT,F10
          WRITE     HTMLFILE;F10;
          GOTO      SIPC9999
.
SIPC0180  WRITE     HTMLFILE;SIPCECT;
          GOTO      SIPC9999
.
SIPC0190  WRITE     HTMLFILE;SIPCGSTA;
          GOTO      SIPC9999
.
SIPC0200  WRITE     HTMLFILE;SIPCTCR;
          GOTO      SIPC9999
.
SIPC0210  WRITE     HTMLFILE;SIPCTGS;
          GOTO      SIPC9999
.
SIPC0220  WRITE     HTMLFILE;SIPCTIN;
          GOTO      SIPC9999
.
SIPC0230  WRITE     HTMLFILE;SIPCIGS;
          GOTO      SIPC9999
.
SIPC0240  WRITE     HTMLFILE;SIPCOQO;
          GOTO      SIPC9999
.
SIPC0250  WRITE     HTMLFILE;SIPCOOP;
          GOTO      SIPC9999
.
SIPC0260  WRITE     HTMLFILE;SIPCOGS;
          GOTO      SIPC9999
.
SIPC0270  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIPC0271,SIPC0272
          WRITE     HTMLFILE;SIPCGST;
          GOTO      SIPC9999
.
SIPC0271  PACK      KEY6,SIPCGST,SP10
          CALL      RDIBGS1
          BRANCH    OVRCD,SIPC9999
.
          WRITE     HTMLFILE;IBGSDESC;
          GOTO      SIPC9999
.
SIPC0272  PACK      KEY6,SP10
          CALL      RSIBGS1
SIPC0273  CALL      RKIBGS1
          BRANCH    OVRCD,SIPC9999
.
          PACK      KEY8,QUOTE,IBGSCODE,QUOTE,SP10
          MATCH     SIPCGST,IBGSCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>",IBGSDESC:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",IBGSDESC:
                               "</option>";
          ENDIF
          GOTO      SIPC0273
.
SIPC0280  WRITE     HTMLFILE;SIPCUR1;
          GOTO      SIPC9999
.
SIPC0290  WRITE     HTMLFILE;SIPCUR2;
          GOTO      SIPC9999
.
SIPC0300  MATCH     SIPCUD1,SP70
          GOTO      SIPC9999 IF EQUAL
.         
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPC9999
.
SIPC0310  MATCH     SIPCUD2,SP70
          GOTO      SIPC9999 IF EQUAL
.         
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIPC9999
.
SIPC0320  WRITE     HTMLFILE;SIPCUY1;
          GOTO      SIPC9999
.
SIPC0330  WRITE     HTMLFILE;SIPCUY2;
          GOTO      SIPC9999
.
SIPC9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for the Purchase Order Line item file
.------------------------------------------------------------
SPSPC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPSPC010,SPSPC020,SPSPC030,SPSPC040,SPSPC050:
                       SPSPC060,SPSPC070,SPSPC080,SPSPC090,SPSPC100:
                       SPSPC110,SPSPC120,SPSPC130,SPSPC140,SPSPC150:
                       SPSPC160,SPSPC170,SPSPC180,SPSPC190,SPSPC200:
                       SPSPC210,SPSPC220,SPSPC230,SPSPC240,SPSPC250:
                       SPSPC260,SPSPC270,SPSPC280,SPSPC290,SPSPC300:
                       SPSPC310,SPSPC320,SPSPC330
.
          MOVE      ONE,EXIT
          GOTO      SPSPC999
.
SPSPC010  MOVE      QRYDATA,SIPOC001
          GOTO      SPSPC999
.
SPSPC020  MOVE      QRYDATA,SIPOC002
          GOTO      SPSPC999
.
SPSPC030  MOVE      QRYDATA,SIPOC003
          GOTO      SPSPC999
.
SPSPC040  MOVE      QRYDATA,SIPOC004
          GOTO      SPSPC999
.
SPSPC050  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOC005,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPC999
.
SPSPC060  MOVE      QRYDATA,SIPOC006
          GOTO      SPSPC999
.
SPSPC070  PACK      SIPOC007,QRYDATA,SP70
          GOTO      SPSPC999
.
SPSPC080  MOVE      QRYDATA,SIPOC008
          GOTO      SPSPC999
.
SPSPC090  MOVE      QRYDATA,SIPOC009
          GOTO      SPSPC999
.
SPSPC100  MOVE      QRYDATA,SIPOC010
          GOTO      SPSPC999
.
SPSPC110  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOC011,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPC999
.
SPSPC120  MOVE      QRYDATA,SIPOC012
          GOTO      SPSPC999
.
SPSPC130  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOC013,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPC999
.
SPSPC140  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIPOC014,CCENT,CYEAR,CMON,CDAY
          GOTO      SPSPC999
.
SPSPC150  MOVE      QRYDATA,SIPOC015
          GOTO      SPSPC999
.
SPSPC160  MOVE      QRYDATA,SIPOC016
          GOTO      SPSPC999
.
SPSPC170  MOVE      QRYDATA,SIPOC017
          GOTO      SPSPC999
.
SPSPC180  MOVE      QRYDATA,SIPOC018
          GOTO      SPSPC999
.
SPSPC190  MOVE      QRYDATA,SIPOC019
          GOTO      SPSPC999
.
SPSPC200  MOVE      QRYDATA,SIPOC020
          GOTO      SPSPC999
.
SPSPC210  MOVE      QRYDATA,SIPOC021
          GOTO      SPSPC999
.
SPSPC220  MOVE      QRYDATA,SIPOC022
          GOTO      SPSPC999
.
SPSPC230  MOVE      QRYDATA,SIPOC023
          GOTO      SPSPC999
.
SPSPC240  MOVE      QRYDATA,SIPOC024
          GOTO      SPSPC999
.
SPSPC250  MOVE      QRYDATA,SIPOC025
          GOTO      SPSPC999
.
SPSPC260  MOVE      QRYDATA,SIPOC026
          GOTO      SPSPC999
.
SPSPC270  MOVE      QRYDATA,SIPOC027
          GOTO      SPSPC999
.
SPSPC280  MOVE      QRYDATA,SIPOC028
          GOTO      SPSPC999
.
SPSPC290  MOVE      QRYDATA,SIPOC029
          GOTO      SPSPC999
.
SPSPC300  MOVE      QRYDATA,SIPOC030
          GOTO      SPSPC999
.
SPSPC310  MOVE      QRYDATA,SIPOC031
          GOTO      SPSPC999
.
SPSPC320  MOVE      QRYDATA,SIPOC032
          GOTO      SPSPC999
.
SPSPC330  MOVE      QRYDATA,SIPOC033
          GOTO      SPSPC999
.
SPSPC999  RETURN
.
.------------------------------------------------------------
.  Update Purchase Order Line item file
.------------------------------------------------------------
MVSIPC00  MATCH     SIPOC001,Z70
          IF        !@EQUAL
            MOVE      SIPOC001,SIPCPON
          ENDIF
.
          MATCH     SIPOC002,Z70
          IF        !@EQUAL
            MOVE      SIPOC002,SIPCITM
          ENDIF
.
          MATCH     SIPOC003,Z70
          IF        !@EQUAL
            MOVE      SIPOC003,SIPCCST
          ENDIF
.
          MATCH     SIPOC004,Z70
          IF        !@EQUAL
            MOVE      SIPOC004,SIPCPRD
          ENDIF
.
          MATCH     SIPOC005,Z70
          IF        !@EQUAL
            MOVE      SIPOC005,SIPCDAT
          ENDIF
.
          MATCH     SIPOC006,Z70
          IF        !@EQUAL
            MOVE      SIPOC006,SIPCWAR
          ENDIF
.
          MATCH     SIPOC007,Z70
          IF        !@EQUAL
            MOVE      SIPOC007,SIPCCAT
          ENDIF
.
          MATCH     SIPOC008,Z70
          IF        !@EQUAL
            MOVE      SIPOC008,SIPCPN
          ENDIF
.
          MATCH     SIPOC009,Z70
          IF        !@EQUAL
            MOVE      SIPOC009,SIPCPD
          ENDIF
.
          MATCH     SIPOC010,Z70
          IF        !@EQUAL
            MOVE      SIPOC010,SIPCCON
          ENDIF
.
          MATCH     SIPOC011,Z70
          IF        !@EQUAL
            MOVE      SIPOC011,SIPCCDT
          ENDIF
.
          MATCH     SIPOC012,Z70
          IF        !@EQUAL
            MOVE      SIPOC012,SIPCSUT
          ENDIF
.
          MATCH     SIPOC013,Z70
          IF        !@EQUAL
            MOVE      SIPOC013,SIPCEDD
          ENDIF
.
          MATCH     SIPOC014,Z70
          IF        !@EQUAL
            MOVE      SIPOC014,SIPCFDD
          ENDIF
.
          MATCH     SIPOC015,Z70
          IF        !@EQUAL
            MOVE      SIPOC015,SIPCOQT
          ENDIF
.
          MATCH     SIPOC016,Z70
          IF        !@EQUAL
            MOVE      SIPOC016,SIPCIQT
          ENDIF
.
          MATCH     SIPOC017,Z70
          IF        !@EQUAL
            MOVE      SIPOC017,SIPCRQT
          ENDIF
.
          MATCH     SIPOC018,Z70
          IF        !@EQUAL
            MOVE      SIPOC018,SIPCECT
          ENDIF
.
          MATCH     SIPOC019,Z70
          IF        !@EQUAL
            MOVE      SIPOC019,SIPCGSTA
          ENDIF
.
          MATCH     SIPOC020,Z70
          IF        !@EQUAL
            MOVE      SIPOC020,SIPCTCR
          ENDIF
.
          MATCH     SIPOC021,Z70
          IF        !@EQUAL
            MOVE      SIPOC021,SIPCTGS
          ENDIF
.
          MATCH     SIPOC022,Z70
          IF        !@EQUAL
            MOVE      SIPOC022,SIPCTIN
          ENDIF
.
          MATCH     SIPOC023,Z70
          IF        !@EQUAL
            MOVE      SIPOC023,SIPCIGS
          ENDIF
.
          MATCH     SIPOC024,Z70
          IF        !@EQUAL
            MOVE      SIPOC024,SIPCOQO
          ENDIF
.
          MATCH     SIPOC025,Z70
          IF        !@EQUAL
            MOVE      SIPOC025,SIPCOOP
          ENDIF
.
          MATCH     SIPOC026,Z70
          IF        !@EQUAL
            MOVE      SIPOC026,SIPCOGS
          ENDIF
.
          MATCH     SIPOC027,Z70
          IF        !@EQUAL
            MOVE      SIPOC027,SIPCGST
          ENDIF
.
          MATCH     SIPOC028,Z70
          IF        !@EQUAL
            MOVE      SIPOC028,SIPCUR1
          ENDIF
.
          MATCH     SIPOC029,Z70
          IF        !@EQUAL
            MOVE      SIPOC029,SIPCUR2
          ENDIF
.
          MATCH     SIPOC030,Z70
          IF        !@EQUAL
            MOVE      SIPOC030,SIPCUD1
          ENDIF
.
          MATCH     SIPOC031,Z70
          IF        !@EQUAL
            MOVE      SIPOC031,SIPCUD2
          ENDIF
.
          MATCH     SIPOC032,Z70
          IF        !@EQUAL
            MOVE      SIPOC032,SIPCUY1
          ENDIF
.
          MATCH     SIPOC033,Z70
          IF        !@EQUAL
            MOVE      SIPOC033,SIPCUY2
          ENDIF
.
MVSIPC99  RETURN
.
.------------------------------------------------------------
.  Clear Purchase Order Line item file
.------------------------------------------------------------
CLRSPC00  MOVE      SP70,SIPCPON 
          MOVE      SP70,SIPCITM 
          MOVE      ZERO,SIPCCST 
          MOVE      SP70,SIPCPRD 
          MOVE      SP70,SIPCDAT 
          MOVE      SP70,SIPCWAR 
          MOVE      SP70,SIPCCAT 
          MOVE      SP70,SIPCPN 
          MOVE      SP70,SIPCPD 
          MOVE      SP70,SIPCCON 
          MOVE      SP70,SIPCCDT 
          MOVE      SP70,SIPCSUT 
          MOVE      SP70,SIPCEDD 
          MOVE      SP70,SIPCFDD 
          MOVE      ZERO,SIPCOQT 
          MOVE      ZERO,SIPCIQT 
          MOVE      ZERO,SIPCRQT 
          MOVE      ZERO,SIPCECT 
          MOVE      ZERO,SIPCGSTA 
          MOVE      ZERO,SIPCTCR 
          MOVE      ZERO,SIPCTGS 
          MOVE      ZERO,SIPCTIN 
          MOVE      ZERO,SIPCIGS 
          MOVE      ZERO,SIPCOQO 
          MOVE      ZERO,SIPCOOP 
          MOVE      ZERO,SIPCOGS 
          MOVE      SP70,SIPCGST 
          MOVE      SP70,SIPCUR1 
          MOVE      SP70,SIPCUR2 
          MOVE      SP70,SIPCUD1 
          MOVE      SP70,SIPCUD2 
          MOVE      SP70,SIPCUY1 
          MOVE      SP70,SIPCUY2 
          MOVE      SP70,SIPCSPA 
.
CLRSPC99  RETURN
