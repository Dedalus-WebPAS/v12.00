.******************************************************************************
.* System    :  PRIVATE PRACTICE                                              *
.* Program   :  IBAPRI20                                                      *
.* Desc      :  Print Invoices                                                *
.******************************************************************************
.* Date      :  27/06/1991                                                    *
.* Author    :  DIG                                                           *
.* Mods      :                                                                *
.*                                                                            *
.******************************************************************************
.* V12.00.03 22/09/2025  J.Tan            TSK 0966921                         *
.*           Mod to remove tempfiles                                          *
.* V12.00.02 27/08/2025  Alina Bhari      TSK 0954453                         *
.*           Recompiled for PRIINVHL - Added Patient Name                     *
.* V12.00.01 16/05/2025  J.Tan          TSK 0955096                           *
.*           Added alpanumeric visit number generation                        *
.* V11.05.01 04/02/2025  Peter Vela       TSK 0939466                         *
.*           Recompiled for PRIINVPR - Added Distance In kms                  *
.*           Eclipse WebServices DVAW                                         *
.* V11.04.01 10/07/2024  J.Tan            TSK 0934944                         *
.*           Mod to check Referral Provider no from a linked Practice         *
.* V11.03.04 08/11/2023  Nikitha B      TSK 0927699c                          *
.*           Read CAPPRVNO and PTCNHABN for Hospital Approval and ABN number. *
.* V11.03.03 04/10/2023  Nikitha B     TSK 0927699                            *
.*           Recomplied for PRIINVHL, PRIINVTL - Stationary variables         *
.* V11.03.02 30/06/2023 J.Tan          TSK 0934506                            *
.*           Fixed I*C pathspaf file                                          *
.* V11.03.01 03/04/2023 J.Tan          TSK 0847250                            *
.*           Recompiled for PRIINVPR - Updating PP Unreconciled invoice       *
.* V11.02.01 11/10/2022  J.Tan            TSK 0908346                         *
.*           Mod checking Clinical Doc.for printing inv.(CHKCLDCP)            *
.* V11.01.03 24/08/2021   Davin           TSK 0897318                         *
.*           Recompiled for PRIINVTL - added field 51 (Adjustment Total)      *
.* V11.01.02 20/07/2021   J.Tan           TSK 0908902                         *
.*           Recompiled for PRIINVPR - printing Insurance for multi pages inv.*
.* V11.01.01 29/04/2021  Tracey Nguyen    TSK 0308555                         *
.*           Added PATIN1FD/IO for PRIINVPR - Added routine PRTAC000 to print *
.*           WorkCover and TAC details on the body of the invoice             *
.*----------------------------------------------------------------------------*
.* V11.00.06 11/11/2020  Peter Vela       TSK 0898361                         *
.*           Recompiled for PRIINVPR                                          *
.* V11.00.05 20/10/2020  Peter Vela       TSK 0898361                         *
.*           Recompiled for PRIINVPR                                          *
.* V11.00.04 24/04/2020  Peter Vela       TSK 0874025                         *
.*           Recompiled for PRIINVPR                                          *
.* V11.00.03 22/04/2020  Peter Vela       TSK 0874025                         *
.*           Recompiled for PRIECTFD                                          *
.* V11.00.02 17/04/2020 Peter Vela      TSK 0874025                           *
.*           Recompiled for PRIECTFD                                          *
.* V11.00.01 15/04/2020 Thanh T         TSK 0879163                           *
.*           Added SEXDSP00                                                   *
.******************************************************************************
.* V10.14.03 20/08/2019  Thanh T.      TSK 0879967                            *
.*           Recompiled for PRIINVPR changes                                  *
.* V10.14.02 23/04/2019  Peter Vela    TSK 0871522                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.14.01 21/11/2018  Peter Vela    TSK 0866770                            *
.*           Recompiled for PRIINVPR                                          *
.******************************************************************************
.* V10.13.03 21/11/2018  Peter Vela    TSK 0866770                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.13.02 02/11/2018  Peter Vela    TSK 0863035                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.13.01 07/08/2018  Richa Phogat  TSK 0848506                            *
.*           Extended keylength for RSPRHT1, RKPRHT1 from KEY58 to KEY62      *
.* V10.12.02 15/05/2018  J.Tan         TSK 0856329                            *
.*           Recompiled for PRIINVPR - Lingard invoice with multple pages     *
.* V10.12.01 26/04/2018  Peter Vela    TSK 0852811                            *
.*           Recompiled for PRIINVTL                                          *
.* V10.11.03 06/09/2017  J.Tan         TSK 0821057                            *
.*           Recompiled for PRIINVHL - mod to variable 76 health fund         *
.* V10.11.02 28/07/2017  Peter Vela    TSK 0837619                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.11.01 28/07/2017  Peter Vela    TSK 0837619                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.10.01 10/05/2017  Tracey Nguyen TSK 0837929                            *
.*           Recompiled for PRIINVHL and PRIINVTL - Fixed I*C error message   *
.*           on PATMESG1                                                      *
.* V10.08.05 22/06/2016  Peter Vela    TSK 0294177                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.08.04 07/09/2016  J.Tan         TSK 0822590                            *
.*           Recompiled for PRIVRDEB                                          *
.* V10.08.03 09/06/2016  Peter Vela    TSK 0820206                            *
.*           Recompiled for PRIINVHL                                          *
.* V10.08.02 18/04/2016  Peter Vela     TSK 0294177                           *
.*           Changed read to prihdb to KEY27                                  *
.* V10.08.01 07/04/2016  Peter Vela    CAR 0294177                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.06.02 15/07/2015  J.Tan         CAR 319450                             *
.*           Recompiled for PRIINVPR - I*C on Invoice Header/Tail error msg   *
.* V10.06.01 15/05/2015  Davin         CAR 310155                             *
.*           Recompiled for PATGBCRN - added MOD10V05 for BPAY                *
.* V10.04.09 16/06/2014  Peter Vela    CAR 302147                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.08 17/04/2014  Peter Vela    CAR 285260                             *
.*           Recompiled for PRIINVPR - Moved Cabrini invoice tail one line    *
.*           down in PRINV230                                                 *
.* V10.04.07 15/04/2014  J.Tan         CAR 261630                             *
.*           Removed port number from temp file name                          *
.* V10.04.06 15/04/2014 Peter Vela     CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.05 14/04/2014 Peter Vela     CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.04 11/04/2014 Peter Vela     CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.03 31/03/2014 Peter Vela     CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.02 05/04/2014  J.Tan         CAR 298195                             *
.*           Replaced PRIINVVR with PRIWEBVR                                  *
.* V10.04.01 16/12/2013 J.Tan          CAR 294414                             *
.*           Recompiled for PRIINVPR - checking type of register              *
.* V10.03.06 09/12/2013  J.Tan         CAR 280726                             *
.*           Recompiled for PRIINVPR - flag for Inpatients from Other hospital*
.* V10.03.05 05/07/2013  J.Tan         CAR 288042                             *
.*           Recompiled for PRIINVPR - Fixed WEBFLAG                          *
.* V10.03.04 05/07/2013  J.Tan         CAR 288042                             *
.*           Mods to set WEBFLAG to one for WEB page                          *
.* V10.03.03 20/06/2013  Davin         CAR 287161                             *
.*           Recompiled for PATGBCRN - right justify ptcnhbpi                 *
.* V10.03.02 18/07/2012  Don Nguyen    CAR 264561                             *
.*           Recompiled for PATGBCRN                                          *
.* V10.03.01 09/05/2012 J.Tan          CAR 222041                             *
.*           Recompiled for PRIINVPR - checking for range of Medical Prac.    *
.* V10.01.01 03/02/2011 Jill Parkinson CAR 233088                             *
.*           Added pmsvx1af                                                   *
.* V10.00.05 14/09/2010  Davin             CAR 229590                         *
.*           Recompiled for PRIINVTL                                          *
.* V10.00.04 26/08/2010  Davin             CAR 226963                         *
.*           Recompiled for PRIINVHL & PRIINVTL                               *
.* V10.00.03 24/08/2010  Peter Vela CAR 221500                                *
.*           Recompiled for PRIINVTL                                          *
.* V10.00.02 22/06/2010 J.Tan         CAR 213683                              *
.*           Recompiled for PRIINVPR - printing SJOG multiple pages of invoice*
.* V10.00.01 23/04/2010 J.Tan         CAR 210750                              *
.*           Recompiled for PRIINVPR - printing SJOG item description         *
.* V9.12.05  11/01/2009 J.Tan         CAR 212904                              *
.*           Recompiled for PRIINVPR - mods PRFA for children                 *
.* V9.12.04  09/12/2009  Mike Laming    CAR 210835                            *
.*           Recompiled for PRIINVPR                                          *
.* V9.12.03  01/10/2009  Peter Vela     CAR 203243                            *
.*           Recompiled for PRIINVHL                                          *
.* V9.12.02  03/09/2009  Peter Vela     CAR 194715                            *
.*           Recompiled for PRIINVHL PRIINVTL                                 *
.* V9.12.01  07/08/2009  Mike Laming    CAR 123419                            *
.*           Recompiled for PRIINVPR - re-write PATHL000, Add PRIHTRaf 4th Indx
.* V9.11.04  23/09/2009  Davin            CAR 178015                          *
.*           Recompiled for PRIINVTL - Added field 33 for BPAY CRN (Generated)*
.*           Added VARGBCRN and PATGBCRN - BPAY Reference Number              *
.* V9.11.03  08/01/2009  Steve Armstrong   CAR 185927                         *
.*           Recompiled for changes to PRIINVPR & PRIINVVR.                   *
.*           08/01/2009 J.Tan      CAR 178415                                 *
.*           Added Medical Practice to prifinsf                               *
.* V9.11.02  01/12/2008  Steve Armstrong   CAR 184702                         *
.*           Recompiled for changes to PRIINVHL & PRIINVTL.                   *
.* V9.11.01  20/10/2008  J.Tan         CAR 178415                             *
.*           Mods checking for Medical practice user access                   *
.******************************************************************************
.* V9.10.01  29/08/2008 J.Tan          CAR 176993                             *
.*           Recompiled for PRIINVPR - Cabrini invoice layout                 *
.******************************************************************************
.* V9.08.02  14/05/2007  Peter Vela    CAR 136586                             *
.*           Recompiled for PRIINVPR - Added SJOG Referral Doctor details     *
.* V9.08.01  28/09/2006  Peter Vela    CAR 118366                             *
.*           Recompiled for PRIINVHL - Added medicare suffix                  *
.******************************************************************************
.* V9.06.01  28/04/2006  Peter Vela    CAR 102393                             *
.*           Recompiled for PRIINVHL - Added PRFA variables PRIINVFD          *
.******************************************************************************
.* V9.05.02  27/03/2006  Peter Vela    CAR 95780                              *
.*           Recompiled for PRIINVHL - Added emg mobile contact numbers       *
.* V9.05.01  27/03/2006  Peter Vela CAR 61299                                 *
.*           Recompiled for PRIINVHL                                          *
.******************************************************************************
.* V9.04.05  06/10/2005  J.Tan    CAR 79018                                   *
.*           Recompiled for PRIINVPR - fixing item amount                     *
.* V9.04.04  03/08/05 J.Tan    CAR 62750                                      *
.*           Removed redefined amount variables                               *
.* V9.04.03  16/06/2005  J.Tan    CAR 56701                                   *
.*           Recompiled for PRIINVPR - HIC item invoice file                  *
.* V9.04.02  24/06/2004  J.Tan    CAR 55893                                   *
.*           Recompiled for PRIINVPR - fixed west wimmera invoice layou       *
.* V9.04.01  30/08/2004  J.Tan    CAR 53825                                   *
.*           Added RCPREGFD                                                   *
.******************************************************************************
.* V9.03.07  29/06/2004  Lina Vo  CAR 50811                                   *
.*           Removed use of RCPTRNFD & IO.                                    *
.* V9.03.06  24/06/2004  J.Tan    CAR 50235                                   *
.*           Recompiled for PRIINVPR - non bank deposit                       *
.* V9.03.05  01/04/2004 J.Tan   CAR 44116                                     *
.*           Recompiled for PRIINVPR - mods for credit note                   *
.* V9.03.04  16/03/2004  Lina Vo    CAR 44110                                 *
.*           Removed Print Inpatient and Outpatient by date range options.    *
.* V9.03.03  03/03/2004  Lina Vo    CAR 47921                                 *
.*           Removed use of PRIDBTFD & IO.                                    *
.* V9.03.02  29/01/2004  J.Tan                                                *
.*           Recompiled for PRIINVPR - removing pridep                        *
.* V9.03.01  29/10/2003 Sandra Barcham   43783                                *
.*           Recompiled for NZHISIIO and NZHISIUP                             *
.******************************************************************************
.*        V9.02.20  13/02/2003  Dean Cramer  CAR 22238                        *
.*                  Recompiled for RCPTRNFD                                   *
.*                  Fix option 3 where I*C crashed process.                   * 
.*                  12/02/2003  Lina Vo       srf 22709                       *
.*                  Removed open and close of outpreaf - not used.            *
.*        V9.02.19  09/11/2002  Dean Cramer   srf 20086                       *
.*                  Recompiled for PRIINVPR - Fix PRAs in multiple options    *
.*        V9.02.18  09/11/2002  Dean Cramer   srf 18508                       *
.*                  Recompiled for PRIINVPR - Include SESC0000 PRAs for nonRCH*
.*                  Recompiled for PRIINVPR - Rework of RESC0000              *
.*                  RCH PRA Hierarchy installed                               *
.*        V9.02.17  06/11/2002  J.Tan                                         *
.*                  Recompiled for PRIKYDEB - merge U/R                       *
.*        V9.02.16  25/10/2002  J.Tan                                         *
.*                  Recompiled for PRIINVPR - fixed displaying o/s amount     *
.*        V9.02.15  21/10/2002  J.Tan                                         *
.*                  Fixed printing debtors by range of medical practices      *
.*        V9.02.14  21/10/2002  J.Tan                                         *
.*                  Recompiled for PRIINVTL - outstanding amount              *
.*        V9.02.13  28/08/2002  J.Tan                                         *
.*                  Recompile for PRIINVPR - outstanding amount with GST      *
.*        V9.02.12  26/07/2002  Dean Cramer                                   *
.*                  Recompile for PRIINVPR for open of PMSPX2A1 and           *
.*                  changed Cash & Journal amount position for RCH.           *
.*        V9.02.11  28/06/2002  Dean Cramer                                   *
.*                  Added FD & IO and recompiled - all for PRIINVPR           *
.*        V9.02.10  19/06/2002  J.Tan                                         *
.*                  Recompiled for PRIINVVR & PRIINVIT                        *
.*        V9.02.09  27/05/2002  J.Tan                                         *
.*                  Recompiled for PRIINVHL - Added patient indicator         *
.*        V9.02.08  13/05/2002  Dean Cramer                                   *
.*                  Alter Medical Practice select - fix return displays       *
.*        V9.02.07  08/05/2002  Dean Cramer                                   *
.*                  Include in option 4 Medical Practice select -space for all*
.*        V9.02.06  08/03/2002  J.Tan                                         *
.*                  Recompiled for PRIINVHL - Added claim code                *
.*        V9.02.05  21/03/2002  J.Tan                                         *
.*                  Recompiled for PRIINVHL - Missing first item description  *
.*        V9.02.04  07/02/2002  J.Tan                                         *
.*                  Recompiled for PRIINVPR - Doctor Income percentage        *
.*        V9.02.03  10/01/2002  J.Tan                                         *
.*                  Recompiled for PRIINVIT - Changed key for tempfile        *
.*        V9.02.02  22/10/2001  Dean Cramer                                   *
.*                  Make changes for web reports and end spool.               *
.*        V9.02.01  02/10/2001  J.Tan                                         *
.*                  Mods to use PMSHCPFD instead of PATDO1FD                  *
.*        V9.00.B01 13/06/2001  Steve Armstrong       Call 10742              *
.*                  Recompiled for changes to PRIKYDEB                        *
.******************************************************************************
.*        V5.10.B01 26/03/2001  Glenn Saunders                                *
.*                  Remove access to PTCNSNDX and associated processing.      *
.*                  Remove all references to PATSUR file (old surname file).  *
.*        V5.08.09  15/09/2000  Davin  SRF 4964                               *
.*                  Recompiled for PRIINVHL - invoice indicator               *
.*        V5.08.08  16/08/2000  Caleb Sharman                                 *
.*                  Changed Health Fund variables to be 8 chars               *
.*        V5.08.07  15/08/2000  Davin  SRF 4106                               *
.*                  Recompiled for PRIINVPR - templated tail for multipage    *
.*        V5.08.06  02/08/2000  J.Tan                                         *
.*                  Recompiled for PRIINVPR - form feed                       *
.*        V5.08.05  03/07/2000  Steve Downing                                 *
.*                  Recompiled for PRIINVPR - interface to Accounts Payable   *
.*        V5.08.04  21/06/2000  Davin                                         *
.*                  Recompiled for PRIINVPR - added invoice templating        *
.*                  29/06/2000  Steve Armstrong                               *
.*                  Recompiled for changes to PRICALFS (PATFIGFD)             *
.*        V5.08.03  17/05/2000  J.Tan                                         *
.*                  Recompiled for PRIINVPR - invoice on landscape            *
.*        V5.08.02  05/05/2000  J.Tan                                         *
.*                  Recompiled for PRIDOCT file                               *
.*        V5.08.B05 14/04/2000  Steve Downing                                 *
.*                  Recompiled for PRIINVPR - Fixed invoice layout            *
.*        V5.08.B04 03/04/2000  J.Tan                                         *
.*                  Recompiled for PRIINVPR - GST mods                        *
.*        V5.08.B02 27/03/2000  J.Tan                                         *
.*                  Mods for GST                                              *
.*        V5.08.B01 25/02/2000  Greg Horvat                                   *
.*                  Removed OUTADJFD OUTADJIO PATMMRFD PATMMRIO & PRIPRADJ    *
.*        V5.07.07  24/11/1999  J.Tan                                         *
.*                  Recompiled for PRIINVPR - set PRDTSERV to one for cash    *
.*        V5.07.06  18/10/1999  Steve Armstrong                               *
.*                  Recompiled for tempfile index changes to PRIINVPR/PRIINVVR*
.*        V5.07.05  15/10/1999  D.Di Paola                                    *
.*                  Recompiled for PRISPTFD and PRIITMFD                      *
.*        V5.07.04  12/10/1999  J Habasque                                    *
.*                  Recompiled for PRIHRTFD & PRIBULFD                        *
.*        V5.07.03  02/07/1999  J.Tan                                         *
.*                  Recompiled for PRIINVPR for private practice receipt no.  *
.*        V5.07.02  22/06/1999  Jill Habasque                                 *
.*                  Recompiled for PRISTAIO                                   *
.*        V5.07.01  09/06/1999  Greg Horvat                                   *
.*                  Recompiled for PRIINVIO - Fixed problem with direct read  *
.*                  Jill Habasque - Recompiled for PRIINVS srf 632328         *
.*       V5.07.B02  22/12/1998  Jim Stathopoulos                              *
.*                  507 Rebound                                               *
.*       V5.07.B01  05/11/1998  Jim Stathopoulos                              *
.*                  507 Changes                                               *
.******************************************************************************
.*        V5.06.01  14/09/98    J.Tan  SRF 627407                             *
.*                  Added opt.to print invoice for all current adms on batch  *
.*        V5.05.03  11/12/1997  Nick   SRF 623274                             *
.*                  Recompiled for PRIINVPR                                   *
.*        V5.05.02  16/10/1997  Nick   Added WImmera Invoice Layout           *
.*        V5.05.01  09/10/1997  Steve Armstrong    WWH Mods                   *
.*                  Removed ARS related code for G/L Interface                *
.******************************************************************************
.*        V5.04.01  14/06/1997  Steve Armstrong                               *
.*                  Fixed bugs in global recompile                            *
.******************************************************************************
.*        V6.00.01  16/03/92  DIG                                             *
.*                  Removed the FLAGBULK parameter.                           *
.*                  Added the new PRIBULFD file for bulk billing.             *
.*                  08/06/92  DIG                                             *
.*                  Changed the PRIINVPR include to print each invoice as it  *
.*                  is completed                                              *
.*        V6.00.02  14/07/92  Peter Eddey                                     *
.*                  Various changes                                           *
.*        V6.00.03  24/07/92  Whirlpool                                       *
.*                  Modified for changes to the tempfile  PRIINVVR            *
.*        V6.00.04  07/08/92  Whirlpool                                       *
.*                  Recompiled  for changes to PRIINVVR                       *
.*        V6.00.05  11/08/92  DIG               SRF 116515                    *
.*                  Recompiled for changes to PRIINVPR                        *
.*        V6.00.06  18/08/92  DIG                                             *
.*                  Recompiled for changes to PRIINVPR                        *
.*        V6.00.07  18/09/92  J.Tan      SRF 116926                           *
.*                  Recompiled for IBAPRINT & PRIINVPR                        *
.*                  07/10/1992  Steve Armstrong                               *
.*                  Modified for alphanumeric debtor number                   *
.*                  09/11/1992  Steve Armstrong                               *
.*                  Recompiled for changes to PRIINVPR                        *
.*        V6.00.08  12/11/92  J.Tan      SRF 118681                           *
.*                  Mods to reduce open files                                 *
.*        V6.00.09  18/11/92  J.Tan      SRF 118749                           *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.00.10  23/11/92  J.Tan                                           *
.*                  Recompiled for PRIINVPR (to print Debtor and Invoice No.) *
.*        V6.00.11  24/11/92  J.Tan      SRF 118951                           *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.00.12  21/12/1992  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.00.13  18/01/1993  i chung           SRF 119877                  *
.*                  Recompiled for PRIINVPR (V6.00.11)                        *
.*        V6.00.14  18/01/93  DIG                                             *
.*                  Recompiled for change to PRIINVPR                         *
.*                  27/01/1993  Steve Armstrong   SRF 120122  Quote 7558      *
.*                  Recompiled for changes and PRIINVPR.                      *
.*                  Mods for change to PRIHTRFD structure.                    *
.*        V6.00.15  29/01/1993  Steve Armstrong   SRF 120122                  *
.*                  Recompiled for further changes to PRIINVPR                *
.*                  01/03/93  DIG               SRF 120122  Quote 7558        *
.*                  Re-Compiled for changes to Bulk Billing and addition of   *
.*                  Cash Deposits.                                            *
.*        V6.00.16  20/05/1993  Gabrielle         SRF 120122  Quote 7583      *
.*                  Recompiled for PRIINVPR; new invoice layout No.5 (Lingard)*
.*        V6.00.17  31/05/1993  Gabrielle                                     *
.*                  SRF 122363 RHC Invoice layout : Fixed description so to   *
.*                             line-up with heading                           *
.*                  SRF 122817 RHC Invoice layout : checked the printing of   *
.*                             the referred doctors if the service doctor is  *
.*                             the same;;they are being printed on the one    *
.*                             invoice                                        * 
.*        V6.00.18  30/05/1993  Gabrielle         SRF 119837  Quote 7583      *
.*                  Recompiled for PRIINVPR; fixed invoice layout No.5 Lingard*
.*        V6.00.19  02/08/1993  i chung           SRF 124286                  *
.*                  Recompiled for PRIINVPR (V6.00.17)                        *
.*        V6.00.20  12/08/1993  Glenn Berry      SRF 122974                   *
.*                  Mods for changes to PRIHTRFD                              *
.*        V6.00.21  31/08/1993  Whirlpool        SRF 124801                   *
.*                  Changes to PRIINVPR for warburton                         *
.*        V6.00.22  07/10/93 J.Tan         SRF 125349                         *
.*                  Changed p.r.a. name to be 40 chars.                       *
.*        V6.00.23  22/10/1993  Steve Armstrong  SRF 125806                   *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.00.24  16/11/1993  Greg Horvat       SRF 126300                  *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.00.25  18/11/1993  Greg Horvat       SRF 124924                  *
.*                  Added invoice layouts in PRIINVPR.PBL                     *
.*        V6.00.26  10/01/1994  Greg Horvat       SRF 127157                  *
.*                  Recomplied for changes to PRIINVPR                        *
.*        V6.01.02  19/01/1994  Greg Horvat      SRF 127350                   *
.*                  Recompiled for changes to PRIINVPR & PRIVRDEB.INC         *
.*        V6.01.03  01/03/1994  Greg Horvat      SRF 127509  Quote 7928       *
.*                  Changed RCH private practice invoice layout - 4           *
.*        V6.01.04  07/03/1994  Greg Horvat      SRF 119837  Quote 7583       *
.*                  Recompiled for changes to PRIINVPR - Lingard layout       *
.*        V6.01.05  07/03/1994  Greg Horvat      SRF 128274                   *
.*                  Recomplied for changes to PRIINVPR - writing to the bulk  *
.*                  billing file with the same key                            *
.*        V6.01.06  11/03/1994  Greg Horvat  SRF 127509  Quote 7928  (rebound)*
.*                  Recompiled for changes in PRIINVPR - RCH invoice layout   *
.*                  not correct                                               *
.*        V6.01.07  06/04/1994  Greg Horvat                                   *
.*                  Close temp files opened for PRIINVPR                      *
.*        V6.01.09  21/04/1994  Greg Horvat      SRF 128835                   *
.*                  Recompiled for PRIINVPR - RCH layout change               *
.*        V6.01.10  05/05/1994  Graeme Williams   SRF 129251                  *
.*                  Recompiled for PRIINVPR, version V6.00.31.                *
.*                  Problem with multiple tests that map to the same MBS code *
.*        V6.01.11  06/05/94 J.Tan     SRF 128897                             *
.*                  Recompiled for PRIINVPR - Initialise doctor provider no.  *
.*        V6.01.12  11/05/1994  Graeme Williams   SRF 129360                  *
.*                  Recompiled for PRIINVPR, version V6.00.34.                *
.*                  Change pathology billing to only print the multiple test  *
.*                  item, not the individual tests.                           *
.*        V6.01.13  15/06/1994  Ian Rutt  SRF 129518                          *
.*                  Recompile for PRIINVPR                                    *
.*        V6.01.14  15/07/1994  Ian Rutt  SRF 130823                          *
.*                  Recompile for PRIINVPR                                    *
.*        V6.01.15  25/07/1994  Greg Horvat      SRF 130947                   *
.*                  Recompiled for PRIINVPR - Fixed problem with multiple     *
.*                  blood gases services on the same day by harding codeing   *
.*                  the change in, a proper fix for more items will be        *
.*                  completed at a later date.                                *
.*        V6.01.16  26/07/1994  Greg Horvat      SRF 131045                   *
.*                  Recomplied for PRIINVPR - writing two records to file when*
.*                  inputting MBS items that are not pathology items          *
.*        V6.01.17  27/07/1994  Greg Horvat      SRF 131056                   *
.*                  Recomplied for PRIINVPR - changes to RCH layout           *
.*        V6.02.01  26/09/1994  Graeme Williams   SRF 132432                  *
.*                  Recompiled for PRIINVPR - AMA blood gas changes           *
.*        V6.02.02  08/09/1994  Gabrielle        SRF 132082                   *
.*                  Recompiled for PRIINVPR (V6.02.02) Removed a line from    *
.*                  the invoice layout, printing too many                     *
.*                  Fixed changes to S4BS exemption rules and Blood Gases     *
.*        V6.02.03  03/10/1994  Graeme Williams   SRF 128854                  *
.*                  Recompiled for PRIINVPR - RCH Invoice Layout changes      *
.*        V6.02.04  10/10/1994  Greg Horvat      SRF 127157  (Rebound)        *
.*                  Recompiled for PRIINVPR - Lingard invoice layout changes  *
.*        V6.02.05  11/10/1994  Greg Horvat      SRF 130982                   *
.*                  Recomplied for PRIINVPR - HRH invoice layout change       *
.*        V6.02.06  11/10/1994  Greg Horvat      SRF 132243                   *
.*                  Recomplied for PRIINVPR - changed to write cash deposits  *
.*                  to the prifinsf file when printing an invoice             *
.*        V5.02.01  14/02/1995  Greg Horvat      SRF 134920 134922 134932     *
.*                  Recompiled for IBAPRINT                                   *
.*        V5.02.02  10/03/1995  Graeme Williams                               *
.*                  Port release 6.03 enhancements to 5.02                    *
.*                  19/04/1995  Steve Armstrong                               *
.*                  Recompiled for changes to RCPTRNFD                        *
.*        V5.02.03  02/05/1995  Gabrielle       Mt Wilga                      *
.*                  Changed description of St Edmunds invoice layout to       *
.*                  Alpha, removed printing the heading description from      *
.*                  either controlf of pripracf file using prcnaddr param.    *
.*        V5.02.04  02/05/1995  Gabrielle   SRF 133213                        *
.*                  Removed "Hit <ENTER>..." message when displaying invoice  *
.*                  layouts that go over a screen                             *
.*        V5.03.01  26/06/1995  Paul Howells     SRF 610111                   *
.*                  Recompiled for PRIINVPR.                                  *
.*        V5.03.02  07/08/1995  Steve Armstrong                               *
.*                  Recompiled for PRIKYDEB                                   *
.*        V5.03.03  14/08/1995  Steve Armstrong                               *
.*                  Recompiled for PRIITMFD                                   *
.*        V5.03.04  06/10/1995  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR                                   *
.*        V5.03.05  18/10/1995  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR                                   *
.*        V5.03.06  28/10/1995  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR                                   *
.*        V5.03.07  06/11/1995  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR                                   *
.******************************************************************************
.
          INC       STD001FD
          INC       TFILEVAR/INC                 * Generate Temp File Name
          INC       WEBERRFD/INC                 * Web Server Error Logging
          INC       CHKCLDCD/INC
.
          INC       PRIWEBVR/INC
          INC       PRIVRDEB/INC
          INC       PRIALSFD/INC                 * Medical Prac.all user access
          INC       PRISECFD/INC                 * Medical Prac.security access
.
          INC       BOKRC1FD/INC
          INC       IBAPRNFD/INC
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
          INC       OUTPREFD/INC
          INC       IBAGEDFD/INC
.
          INC       PATCODFD/INC
          INC       PATCONFD/INC
          INC       PATIN1FD/INC
          INC       PMSHCPFD/INC
          INC       PMSHCLFD/INC
          INC       PATDRGFD/INC
          INC       PATDSCFD/INC
          INC       PATGSRFD/INC
          INC       PATINVFD/INC
          INC       PATMA1FD/INC
          INC       PATMESFD/INC
          INC       PATMI1FD/INC
          INC       PMSVX1FD/INC
          INC       PATPERFD/INC
          INC       PATPR1FD/INC
          INC       PATRE1FD/INC
          INC       PATTRNFD/INC
          INC       PATVISFD/INC
          INC       PMSPX2FD/INC
.
          INC       HICITIFD/INC                 * HIC items invoice file
          INC       PRIAUIFD/INC
          INC       PRIBULFD/INC
          INC       PRICNOFD/INC
          INC       PRICONFD/INC
...          INC       PRIDBTFD/INC
          INC       PRIDOCFD/INC
          INC       PRIDTRFD/INC
          INC       PRIEXCFD/INC                 * exception charges file
          INC       PRIFIGFD/INC
          INC       PRIFINFD/INC
          INC       PRIGRPFD/INC
          INC       PRIHDBFD/INC
          INC       PRIHISFD/INC
          INC       PRIHOLFD/INC
          INC       PRIHREFD/INC
          INC       PRIHTRFD/INC
          INC       PRIITMFD/INC
          INC       PRIINVFD/INC
          INC       PRIMABFD/INC
          INC       PRIMGPFD/INC
          INC       PRIMULFD/INC
          INC       PRIPRAFD/INC
          INC       PRISPTFD/INC                 * spec. path. test file
          INC       PRISTAFD/INC
          INC       PRITESFD/INC
          INC       PRIVAFFD/INC
          INC       PRIWCOFD/INC
          INC       RCPBNKFD/INC
          INC       RCPBDTFD/INC
          INC       RCPREGFD/INC
          INC       RCPDTEFD/INC                 * receipt details file
.
          INC       COMDEPFD/INC                 * common deposit file
          INC       PATCOMM/INC                  * common file
          INC       PATALRFD/INC                 * Alerts & Medical Warnings
          INC       PRIECTFD/INC
          INC       NZHISIFD/INC                 * NZHIS Variables
          INC       NHIMASFD/INC                 * NZHIS Variables
          INC       PATDHEAD/INC                 * PMI Header Details
          INC       PATCALAG/INC                 * PMI Age Calc
          INC       PMIVARS/INC                  * PMI Variables
          INC       SCRPSTFD/INC
          INC       VARGBCRN/INC
.
          INC       PATHSPFD/INC           * Hospital Details for GBCRN000
.
          INC       WEBIMCFD/INC
          INC       WEBB2BFD/INC
.
COUNT     FORM      3
.**********************************************************************
.*                            TEMP FILES                              *
.**********************************************************************
PRITM1XX  IFILE     SQL, FIXED=19, KEY="U1-8"
PRITM1XY  IFILE     SQL, FIXED=19, KEY="U9-16,17-18,1-8"
.
. NAME    TYPE    LENGTH   PHYSICAL  START LOC.   DESCRIPTION
. ----    ----    ------   --------  ----------   -----------
DTEMPUNQ  DIM       8         8         1         Unique Identifier   
TEMPDEB   DIM       8         8         9         Debtor Number
DTEMPSCN  DIM       2         2         17        Scan Flag
.                                                   0 = Debtor
.                                                   1 = PMI
.End of Record                          19
.
. Redefine form fields from key
. -----------------------------
TEMPUNQ   FORM     8
TEMPSCN   FORM     2
+
.**********************************************************************
.*                       GLOBAL VARIABLES                             *
.**********************************************************************
CALCDATE  DATE      8
CATEGORY  DIM       2
CODE      DIM       3
CURDATE   DIM       8
CURRROW   FORM      3
.
DIM3      DIM       3
DIM5      DIM       5
DIM8      DIM       8
DIM10     DIM       10
DIM18     DIM       18
DIM25     DIM       25
DIM27     DIM       27
DIM28     DIM       28
.
ECCLMARR  DIM       50
.
FRSTFLAG  FORM      1
FGSTFLAG  FORM      1
FNAME1    DIM       8
FORM3     FORM      3
FORM8     FORM      8
FROMDATE  DIM       8
FSTAMNT   FORM      12.2
FSTDATE   DIM       8
FSTWORK   FORM      12.2
.
HEADER    DIM       46
HEALTHFD  DIM       6
IBCNABNN  DIM       11
IBCNUGST  FORM      1
IBCNUMCI  DIM       1
INVOICEN  FORM      8
KEYSTARR  DIM       50[99]  * Key Strokes Array
KEYSTCNT  FORM      2       * Key Strokes Counter
MESSCODE  DIM       3                  * for PRIMPDDS
MPDESC    DIM       30                 * for PRIMPDDS
MPRAC     DIM       6                  * medical practice
MPGEFLAG  FORM      1
.
PATNAME   DIM       25
PATADD3   DIM       21
PRNTSTRT  FORM      3
PRANAME   DIM       45                 * name of P.R.A.
PRAADD1   DIM       35                 * address of P.R.A. - line 1
PRAADD2   DIM       35                 *                     line 2
PRAADD3   DIM       35                 *                     line 3
PRAADD4   DIM       35
PRAPOST   DIM       8                  * postcode of P.R.A.
PRAPPHON  DIM       20                 * home phone of P.R.A.
PRABPHON  DIM       20                 * business phone of P.R.A.
PRAMPHON  DIM       20                 * mobile phone of P.R.A.
PRARREL   DIM       10                 * relationship of P.R.A.
.
RACLINDC  DIM       1
.
SAVDEBT   DIM       8
SAVKEY18  DIM       18
SAVSCAN   FORM      2
SOPTION   FORM      1
SCHDDESC  DIM       50
SCHDCOPY  FORM      3       * No of Copies
SCHDPRIN  DIM       1       * Print Report 0=No 1
SCHDPRNT  DIM       6       * Printer No
OPTNFLAG  FORM      1
SETDFRPT  FORM      2
SETDFPRG  DIM       8
SELPRINT  DIM       6
SCHDTIME  DIM       8
SCHDDATE  DIM       8
SCHDPGID  DIM       8
PRHRE028  DIM       3
.
TODATE    DIM       8
VARIABLE  DIM       127
+
.**********************************************************************
.*                             CONSTANTS                              *
.**********************************************************************
HEAD1     INIT      "                 Line-up Print               "
HEAD2     INIT      "                 Single Debtor               "
HEAD3     INIT      "                  All Debtors                "
HEAD4     INIT      "         Debtors in a given date range       "
...HEAD5     INIT      " Inpatients discharged in a given date range "
...HEAD6     INIT      "  Inpatients invoiced in a given date range  "
...HEAD7     INIT      "      Outpatients in a given date range      "
.
SP16      INIT      "                "
SP45      INIT      "                                             "
.
X5        INIT      "XXXXX"
X10       INIT      "XXXXXXXXXX"
Z8        INIT      "ZZZZZZZZ"
.
BJDAY     FORM      3
CJDAY     FORM      3
URDIM8    DIM       8
USERID    DIM       10
.
IBCNMHOS  FORM      1
.
CHKMPRAC  FORM      1
CREDTOT   FORM      8.2
CRDNFLAG  FORM      1
DIM23     DIM       23
EPRAC     DIM       6                  * medical practice
FORM7P2   FORM      7.2
FORM82    FORM      8.2
HTMLFILE  FIFO      ASCII, FIXED=250            *used in PATCATBI
SPRAC     DIM       6                  * medical practice
TEMP8P2   FORM      8.2
WEBFLAG   FORM      1
WBSEUID   DIM       10
.
PRGID     INIT      "IBAPRI20"
PRGNAM    INIT      "Print Invoices"
VERSION   INIT      "V12.00.03"
+
.**********************************************************************
.*                           MAINLINE                                 *
.*                       Controlling Logic                            *
.**********************************************************************
ML0000    CALL      INIT0000                * initialization, open files and
.                                             display header
.------ display main option screen ------
.
ML1000    CALL      OPTN0000                * main option screen
          BRANCH    EXIT,ML9999
.
          CALL      USID0000                * Keyin user id
          BRANCH    OPTION,ML2000,ML3000,ML4000,ML5000
          GOTO      ML1000
.
.------ line-up this invoice ------
.
ML2000    CALL      LINE0000                * do a line-up print
          GOTO      ML8000
.
.------ print invoices for a single debtor ------
.
ML3000    CALL      SING0000                * print for a single debtor
          GOTO      ML8000
.
.------ print invoices for all debtors ------
.
ML4000    CALL      PRAC0000                * Input Medcical Practice
          BRANCH    EXIT,ML1000
.
          CALL      MULT0000                * print for all debtors
          GOTO      ML8000
.
.------ we are printing invoices for either inpatient option, or the ------
.------ outpatient option ------
.
ML5000    CALL      DATE0000                * input date range
          BRANCH    EXIT,ML8000
.
          CALL      PRAC0000                * Input Medcical Practice
          BRANCH    EXIT,ML5000
.       
          CALL      MULT0000                * print for multiple patient options
          GOTO      ML8000
.
ML8000    MATCH     "IBARSH",PGM
          GOTO      ML9999 IF EQUAL
.
          GOTO      ML1000
.
ML9999    CHAIN     PGM
+
.**********************************************************************
.*                           INIT0000                                 *
.*               Open files and display header                        *
.**********************************************************************
INIT0000  CALL      DISPHEAD                * display screen header
.
          DISPLAY   *P56:24,"Opening ibacodef";
          OPEN      IBACODE1,"ibacodef"
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P64:24,"pmshcpaf";
          OPEN      PMSHCPA1,"pmshcpaf"
.
          DISPLAY   *P64:24,"pmshclaf";
          OPEN      PMSHCLA1,"pmshclaf"
.
.         DISPLAY   *P64:24,"patdschf";
.         OPEN      PATDSCH1,"patdschf"
.
          DISPLAY   *P64:24,"patmi1af";
          OPEN      PATMI1A1,"patmi1af"
          OPEN      PMSVX1A1,"pmsvx1af"
.
          DISPLAY   *P64:24,"patvisaf";
          OPEN      PATVISA2,"patvisaf"
.
          DISPLAY   *P64:24,"pribulkf";
          OPEN      PRIBULK1,"pribulkf"
.
...          DISPLAY   *P64:24,"pridebtf";
...          OPEN      PRIDEBT1,"pridebtf"
...          OPEN      PRIDEBT2,"pridebtf"
.
          DISPLAY   *P64:24,"pridoctf";
          OPEN      PRIDOCT1,"pridoctf"
.
          DISPLAY   *P64:24,"pridtraf";
          OPEN      PRIDTRA1,"pridtraf"
          OPEN      PRIDTRA4,"pridtraf"
.
          DISPLAY   *P64:24,"prifinsf";
          OPEN      PRIFINS1,"prifinsf"
          OPEN      PRIFIGA1,"prifigaf"
.
          DISPLAY   *P64:24,"prigrpaf";
          OPEN      PRIGRPA1,"prigrpaf"
.
          DISPLAY   *P64:24,"prihdbtf";
          OPEN      PRIHDBT1,"prihdbtf"
          OPEN      PRIHDBT2,"prihdbtf"
.
          DISPLAY   *P64:24,"prithisf";
          OPEN      PRITHIS1,"prithisf"
.
.         DISPLAY   *P64:24,"priholdf";
.         OPEN      PRIHOLA1,"priholdf"
.
          DISPLAY   *P64:24,"prihreff";
          OPEN      PRIHREF1,"prihreff"
          OPEN      PRIHREF2,"prihreff"
.
          DISPLAY   *P64:24,"prihtraf";
          OPEN      PRIHTRA1,"prihtraf"
          OPEN      PRIHTRA4,"prihtraf"                               *I-123419
.
          DISPLAY   *P64:24,"priinvof";
          OPEN      PRIINVO1,"priinvof"
.
          DISPLAY   *P64:24,"priitemf";
          OPEN      PRIITEM1,"priitemf"
.
          DISPLAY   *P64:24,"primabdf";
          OPEN      PRIMABD1,"primabdf"
.
          DISPLAY   *P64:24,"primgpaf";
          OPEN      PRIMGPA1,"primgpaf"
.
          DISPLAY   *P64:24,"primultf";
          OPEN      PRIMULT1,"primultf"
.
          DISPLAY   *P64:24,"pripracf";
          OPEN      PRIPRAC1,"pripracf"
.
          DISPLAY   *P64:24,"pristatf";
          OPEN      PRISTAT1,"pristatf"
.
          DISPLAY   *P64:24,"pritestf";
          OPEN      PRITEST1,"pritestf"
.
.         DISPLAY   *P64:24,"privafdf";
.         OPEN      PRIVAFD1,"privafdf"
.
.         DISPLAY   *P64:24,"priwcomf";
.         OPEN      PRIWCOM1,"priwcomf"
.
          OPEN      PRIALSA1,"prialsaf"
          OPEN      PRISECA1,"prisecaf"
          OPEN      RCPREGA1,"rcpregaf"
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAME1
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAME2
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAME3
.
          DISPLAY   *P64:24,"controlf";
          OPEN      CONTROLF,"controlf"
.
          READ      CONTROLF,ZERO;*43,IBCNMHOS
.
          READ      CONTROLF,TEN;*79,CAPPRVNO
.
          READ      CONTROLF,THIRTY3;*170,PRCNLAYT:
                                     *200,PRCNRDOC
          READ      CONTROLF,THIRTY4;*199,PRCNAFEE,*205,PRCNCADM:
                                     *206,PRCNPRIH,*212,PRCNPRIT
          READ      CONTROLF,NINTY8;*148,PTCNINVB
          READ      CONTROLF,HUND24;*111,PTCNUIMC
          READ      CONTROLF,HUND29;*61,PTCNWSIN,*73,PTCNIMCW
          READ      CONTROLF,HUND30;*1,PTCNHABN
.
          DISPLAY   *P64:24,"patinvrf";
          OPEN      PATINVR3,"patinvrf"
          OPEN      PATHSPA1,"pathspaf"
.
          MOVE      ONE,WEBFLAG
          MATCH     "IBARSH",PGM
          GOTO      INIT1000 IF EQUAL
.
          CALL      SELPRINT                * select a printer for the invoices
          MOVE      ZERO,WEBFLAG
.
INIT1000  MOVE      ZERO,COPINV
.
INIT9999  RETURN
+
.**********************************************************************
.*                           OPTN0000                                 *
.*                   Display the main option screen                   *
.**********************************************************************
OPTN0000  MOVE      FALSE,EXIT
.
.-------  Not using the patient system -------
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO:
                    *P1:5,ONE:
                    *P1:6,TWO:
                    *P1:7,THREE: 
                    *P1:8,FOUR:
                    *P2:4,*HOFF," = Exit":
                    *P2:5," = Line-up Print":
                    *P2:6," = Print Single Debtor":
                    *P2:7," = Print All Debtors":
                    *P2:8," = Print Debtors in a given date range";
          MOVE      TEN,CVERT
          GOTO      OPTN1000
.
.------ select an option ------
.
OPTN1000  DISPLAY   *P1:CVERT,*EL,"Select Option : ";
          KEYIN     *V2LON,OPTION;
.
          COMPARE   ZERO,OPTION             * see if exit chosen
          GOTO      OPTN9000 IF EQUAL
.
          IF        OPTION < 5
            GOTO      OPTN8000
          ENDIF
.
          BEEP                              * invalid option chosen
          GOTO      OPTN1000
.
.------ a valid option has been chosen ------
.
OPTN8000  LOAD      HEADER,OPTION,HEAD1,HEAD2,HEAD3,HEAD4
          DISPLAY   *P25:3,*EL,*V2LON,HEADER;
          GOTO      OPTN9999
.
.------ Exit option chosen ------
.
OPTN9000  MOVE      TRUE,EXIT
.
OPTN9999  RETURN
+
.**********************************************************************
.*                               LINE0000                             *
.*                    Routine to do a line-up print                   *
.**********************************************************************
LINE0000  MATCH     "IBARSH",PGM
          GOTO      LINE1000 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*HOFF,"Do you want a line-up print (",*V2LON:
                           ANSY,*HOFF,SLASH,*V2LON,ANSN,*HOFF,") ? ";
          KEYIN     *V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     ANSN,ANS                * no line-up print required
          GOTO      LINE9999 IF EQUAL
          MATCH     ANSY,ANS                * we do want a line-up print
          GOTO      LINE1000 IF EQUAL
          BEEP                              * invalid option
          GOTO      LINE0000
.
.------ we want a line-up print ------
.
LINE1000  CALL      SINVH000                * check for template header
          BRANCH    EXIT,LINE9999
          CALL      SINVT000                * check for template tail
          BRANCH    EXIT,LINE9999
.
          CALL      OPNPRINT                * open spool file
          CALL      LINUP000                * print the invoice line-up
          CALL      CLSPRINT                * close the spool file
.
.------ see if a further line-up is required ------
.
LINE1100  MATCH     "IBARSH",PGM
          GOTO      LINE9999 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*HOFF,"Do you want another line-up print (":
                           *V2LON,ANSY,*HOFF,SLASH,*V2LON,ANSN,*HOFF,") ? ";
          KEYIN     *V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     ANSN,ANS                * no line-up print required
          GOTO      LINE9999 IF EQUAL
          MATCH     ANSY,ANS                * we do want a line-up print
          GOTO      LINE1000 IF EQUAL
          BEEP                              * invalid option
          GOTO      LINE1100
.
LINE9999  RETURN
+
.**********************************************************************
.*                                DATE0000                            * 
.*          Input the date range for options 4                        *
.**********************************************************************
DATE0000  MOVE      FALSE,EXIT
          UNPACK    SP20,FROMDATE,TODATE
          PACK      CURDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURDATE
          DISPLAY   *P1:15,*EF,"From Date : ":
                    *P1:16,"To   Date : ";
          UNPACK    SP6,CYEAR,CMON,CDAY
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          MOVE      TEN3,CCOL
          MOVE      TEN5,CVERT
          MOVE      ZERO,CHIGHLT
.
          CALL      KEYDATE                 * keyin the from date
          BRANCH    OVRCD,DATE9900
.
          PACK      FROMDATE,CCENT,CYEAR,CMON,CDAY
.
          MATCH     FROMDATE,CURDATE        * see if future date entered
          GOTO      DATE9000 IF LESS
.
.------ keyin the to date ------
.
DATE1000  UNPACK    SP6,CYEAR,CMON,CDAY
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          MOVE      TEN6,CVERT
.
          CALL      KEYDATE                 * keyin the to date
          BRANCH    OVRCD,DATE0000
.
          PACK      TODATE,CCENT,CYEAR,CMON,CDAY
.
          MATCH     TODATE,CURDATE          * see if future date entered
          GOTO      DATE9000 IF LESS
.
          MATCH     FROMDATE,TODATE         * see if valid range entered
          GOTO      DATE9100 IF LESS
          GOTO      DATE9999
.
.------ future date entered ------
.
DATE9000  DISPLAY   *P1:24,*EL,*B,*V2LON,"Date cannot be in the future.    ";
          CALL      HITENTER
.
          MATCH     SP8,TODATE              * see if we just entered the todate
          GOTO      DATE0000 IF EQUAL
          GOTO      DATE1000
.
.------ invalid date range entered ------
.
DATE9100  DISPLAY   *P1:24,*EL,*B,*V2LON,"Invalid date range.    ";
          CALL      HITENTER
          GOTO      DATE1000
.
.------ no dates entered ------
.
DATE9900  MOVE      TRUE,EXIT
.
DATE9999  RETURN
+
.****************************************************************************
.*                                  PRAC0000           Called by: ML0000    *
.*                     get medical practice code                            *
.*         Returns: EXIT  0 = OK                                            *
.*                        1 = nothing or exitchar entered                   *
.****************************************************************************
PRAC0000  MOVE      SP6,MPRAC
          MOVE      SP6,SPRAC
          MOVE      SP6,EPRAC
          DISPLAY   *P1:20,*EL,"                 To  : ";
          KEYIN     *P1:19,*EL,"Medical Practice From: ",*DV,UNDLN6:
                    *P24:19,*V2LON,MPRAC,*P24:19,*DV,MPRAC;
.
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      CHK0000                 * see what was entered
          BRANCH    EXIT,PRAC1000:          * ? entered
                         PRAC2200:          * valid code
                         PRAC2000:          * nothing entered
                         PRAC9000           * exitchar
          GOTO      PRAC0000                * invalid code
.
PRAC1000  CALL      QUES0000                * question mark option
          BRANCH    EXIT,PRAC2000,PRAC9000
          MOVE      MPRAC,SPRAC
          GOTO      PRAC2200
.
PRAC2000  DISPLAY   *P24:19,"Start";
          MOVE      ZERO,EXIT
          GOTO      PRAC3000
.
PRAC2200  MOVE      PRPRDESC,MPDESC         * save description
          MOVE      MPRAC,SPRAC
          DISPLAY   *P24:19,*V2LON,MPRAC:
                    *P32:19,MPDESC;
          MOVE      ZERO,EXIT
.
.         Enter end of medical practice 
.
PRAC3000  KEYIN     *P24:20,*EL,*DV,UNDLN6:
                    *P24:20,*V2LON,MPRAC,*P24:20,*DV,MPRAC;
.
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      CHK0000                 * see what was entered
          BRANCH    EXIT,PRAC4000:          * ? entered
                         PRAC5200:          * valid code
                         PRAC5000:          * nothing entered
                         PRAC9000           * exitchar
          GOTO      PRAC0000                * invalid code
.
PRAC4000  CALL      QUES0000                * question mark option
          BRANCH    EXIT,PRAC2000,PRAC9000
          MOVE      MPRAC,EPRAC
          GOTO      PRAC5200
.
PRAC5000  DISPLAY   *P24:20,"End";
          MOVE      ZERO,EXIT
          GOTO      PRAC9999
.
PRAC5200  MOVE      PRPRDESC,MPDESC         * save description
          MOVE      MPRAC,EPRAC
          DISPLAY   *P24:20,*V2LON,MPRAC:
                    *P32:20,MPDESC;
.
PRAC6000  MOVE      ZERO,EXIT
          GOTO      PRAC9999
.
PRAC9000  MOVE      ONE,EXIT
PRAC9999  RETURN
+
.***************************************************************************
QUES0000  MOVE      ZERO,EXIT
          CALL      PRIPRADS                * display codes on file
.
QUES1000  KEYIN     *P1:24,*EL,"Medical Practice: ",*DV,UNDLN6:
                    *P19:24,*V2LON,MPRAC,*P19:24,*DV,MPRAC;
.
          CALL      CHK0000                 * see what was entered
          BRANCH    EXIT,QUES0000:          * ? entered
                         QUES2000:          * valid code
                         QUES3000:          * nothing entered
                         QUES4000           * exitchar
.
QUES2000  CALL      PUTSCR00                * restore screen
          MOVE      PRPRDESC,MPDESC         * save description
          MOVE      ZERO,EXIT
          GOTO      QUES9999
.
QUES3000  MOVE      ONE,EXIT                * nothing entered
          GOTO      QUES5000
.
QUES4000  MOVE      TWO,EXIT                * exit
.
QUES5000  CALL      FRESCR00
          CALL      PUTSCR00                * restore screen
QUES9999  RETURN
+
.***************************************************************************
.*                                  CHK0000            Called by: PRAC0000 *
.*                      See what was input                                 *
.*      Returns: EXIT  0 = invalid                                         *
.*                     1 = "?"                                             *
.*                     2 = valid                                           *
.*                     3 = nothing                                         *
.*                     4 = exitchar                                        *
.***************************************************************************
CHK0000   ENDSET    MPRAC                        * pad with blanks
          APPEND    SP6,MPRAC
          RESET     MPRAC
.
          MATCH     SP6,MPRAC                    * anything entered ?
          GOTO      CHK9000 IF EQUAL             * no
.
          CMATCH    EXITCHAR,MPRAC               * exitchar entered ?
          GOTO      CHK7000 IF EQUAL             * yes
.
          CMATCH    QUEST,MPRAC                  * ? entered ?
          GOTO      CHK8000 IF EQUAL             * yes
.
.         Code entered
.
          PACK      KEY6,MPRAC
          CALL      RDPRPR1                      * code on file ?
          BRANCH    OVRCD,CHK6000                * no
.
          COMPARE   PRPRSTAT,ZERO                * practice active ?
          GOTO      CHK5000 IF EQUAL             * yes
.
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "** Medical Practice not active **    ";
          GOTO      CHK6500
.
CHK5000   MOVE      TWO,EXIT                     * code entered
          GOTO      CHK9999
.
CHK6000   DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "** Medical Practice not on file **    ";
CHK6500   CALL      HITENTER
          MOVE      ZERO,EXIT
          GOTO      CHK9999
.
CHK7000   MOVE      FOUR,EXIT
          GOTO      CHK9999
.
CHK8000   MOVE      ONE,EXIT
          GOTO      CHK9999
.
CHK9000   MOVE      THREE,EXIT
.
CHK9999   RETURN
+
.**********************************************************************
.*                              CREA0000                              *
.*                   Create the Indexed Temp File                     *
.**********************************************************************
CREA0000  CALL      KILL0000                * kill existing temp file
.
.------ Build new indexed temp file ------
.
          CLEAR     CMDLINE
          APPEND    "isbuild ",CMDLINE
          APPEND    FNAME1,CMDLINE
          APPEND    " 19 u1-8 u9-16,17-18,1-8",CMDLINE
          APPEND    SP30,CMDLINE
          RESET     CMDLINE
.
          EXECUTE   CMDLINE,TASKID
          OPEN      PRITM1XX,FNAME1
          OPEN      PRITM1XY,FNAME1
.
          CALL      CREATP00                * create the second temp file
.
CREA9999  RETURN
+
.**********************************************************************
.*                              KILL0000                              *
.*                  Kill the Tempfile if it Already Exists            *
.**********************************************************************
KILL0000  CLEAR     CMDLINE
          CLOSE     PRITM1XX
          CLOSE     PRITM1XY
          APPEND    "iserase ",CMDLINE
          APPEND    FNAME1,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          CALL      RMTMP000                     * remove PRIINVPR temp files
KILL9999  RETURN
+
.**********************************************************************
.*                                CHUR000                             *
.*      Routine to see if a U/R number has a current admission        *
.**********************************************************************
CHUR0000  MOVE      FALSE,EXIT
          MOVE      PRHDDEBT,FORM8
          PACK      KEY24,PRHDDEBT,SP16
          CALL      RDSVISA2                * position on the visit file
.
.------ read through the visit file ------
.
CHUR1000  CALL      RDKVISA2
          BRANCH    OVRCD,CHUR9999
.
          MOVE      FORM8,KEY8              * make sure we have the same U/R
          MATCH     KEY8,PVIURNO            * make sure we have the same U/R
          GOTO      CHUR9999 IF NOT EQUAL
.
          MOVE      PVIBILL,KEY8
          CALL      RDMISS1                 * read the admissions file
          BRANCH    OVRCD,CHUR1000
.
          COMPARE   TWO,ASTAT               * see if currently admitted
          GOTO      CHUR1000 IF NOT EQUAL
          MOVE      TRUE,EXIT
.
CHUR9999  RETURN
+
.**********************************************************************
.*                                SING0000                            *
.*          Routine to print an invoice for a single debtor           *
.**********************************************************************
SING0000  CALL      SINVH000                     * check for template header
          BRANCH    EXIT,SING9999
          CALL      SINVT000                     * check for template tail
          BRANCH    EXIT,SING9999
.
          MOVE      ZERO,SOPTION
          MOVE      TRUE,FLAGSING           * set doing single debtor option
.
.------ keyin the debtor number ------
.
SING0100  DISPLAY   *P1:4,*EF,"Debtor Number   : ";
.
          MOVE      FOUR,CVERT
          MOVE      TEN9,CCOL
.
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PATPR1A1,"patpr1af"
          OPEN      PATPX1A1,"patpx1af"
.
          OPEN      PATGSRN1,"patgsrnf"
          OPEN      PATGSRN2,"patgsrnf"          * open Patient Surname file
.
          CALL      PRIKYDEB                * keyin the debtor/UR number
          BRANCH    OVRCD,SING9800
.
          CLOSE     PATMA1A1
          CLOSE     PATMX1A1
          CLOSE     PATPR1A1
          CLOSE     PATPX1A1
.
          CLOSE     PATGSRN1
          CLOSE     PATGSRN2                     * close Patient Surname file
.
          DISPLAY   *P19:4,*EF,*V2LON,VDEBTOR:
                    *P1:6,*HOFF,"Patient Name    : ",*V2LON,VDEBNAME:
                    *P9:7,*HOFF,"Address : ",*V2LON,VDEBADD1:
                    *P19:8,VDEBADD2:
                    *P19:9,VDEBADD3,SP1,VDEBPOST;
.
.------ see if this is the correct debtor ------
.
SING1000  MATCH     "IBARSH",PGM
          GOTO      SING2000 IF EQUAL
. 
          DISPLAY   *P1:24,*EL,"Is this the correct Debtor (",*V2LON,ANSY:
                    *HOFF,SLASH,*V2LON,"N",*HOFF,") ? ";
          KEYIN     *V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     ANSN,ANS                * see if no entered
          GOTO      SING0100 IF EQUAL
          MATCH     ANSY,ANS                * see if yes entered
          GOTO      SING2000 IF EQUAL       
          BEEP
          GOTO      SING1000                * invalid option chosen
.
.------ we have the correct debtor ------
.
SING2000  COMPARE   ZERO,VSCANPMI           * see if we have a debtor number
          GOTO      SING2100 IF EQUAL
.
          MOVE      VDEBTOR,PRHDDEBT
.
          CALL      CHUR0000                * check to see if UR is currently
          COMPARE   ZERO,EXIT                 admitted
          GOTO      SING2100 IF EQUAL
.
          DISPLAY   *P1:22,*EL,*V2LON,*BLINKON,"Patient is currently admitted";
.
          CALL      SOPT0000                * choose option for single debtor
          BRANCH    SOPTION,SING2100,SING2100,SING0100
.
.------ create and load the temp file with the relevant data ------
.
SING2100  DISPLAY   *P1:24,*EL,*V2LON,*BLINKON,"Loading details":
                           *HOFF," - Please Wait";
.
          CALL      CREA0000                * create the temp file
.
          CALL      LOAD0000                * load the temp file with the
          BRANCH    EXIT,SING0100             relevant records for this debtor
.
          CALL      CLRTF000                * clear the temp file
.
          MOVE      TRUE,FLAGFRST           * set we are processing the first
.                                             record flag
          MOVE      TRUE,FLAGHOLD           * set we are holding the account
.                                             flag
          MOVE      SP20,KEY18
          CALL      RSTMPR12                * position on the temp file
.
.------ read through the temp file ------
.
SING2200  CALL      RKTMPR12
          BRANCH    OVRCD,SING3000
.
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PMSPX2A1,"pmspx2af"
.
          CALL      PRIINVLD                * load the data into the temp file
.
          CLOSE     PATMA1A1
          CLOSE     PATMX1A1
          CLOSE     PMSPX2A1                
.
          BRANCH    EXIT,SING2200             for this debtor number
          MOVE      FALSE,FLAGFRST          * reset processing first rec. flag
          GOTO      SING2200
.
.------ we have reached the end of the temp file for this debtor ------
.
SING3000  COMPARE   ZERO,FLAGFRST
          GOTO      SING3100 IF EQUAL
.
          BRANCH    FLAGHOLD,SING9100       * skip if we are holding this
.                                             patients account
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "No transactions on file for this Debtor.    ";
          MATCH     "IBARSH",PGM
          RETURN    IF EQUAL
.
          CALL      HITENTER
          GOTO      SING0100
.
.------ we have found records for this debtor so print the invoices ------
.
SING3100  CALL      PPTMP000                * process the pathology temp file
          CALL      PRIINVPR                * print the invoice/s for this
          GOTO      SING0100                  debtor number
.
.------ debtor is having his account held ------
.
SING9100  DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "Debtor's account is being held.  No invoice printed.   ";
          CALL      HITENTER
          MATCH     "IBARSH",PGM
          GOTO      SING9800 IF EQUAL
.
          GOTO      SING0100
.
SING9800  CALL      KILL0000                * kill existing temp file
SING9999  RETURN
+
.**********************************************************************
.*                               SOPT0000                             *
.*        Choose an option for a single debtor who is currently       *
.*        admitted                                                    *
.**********************************************************************
SOPT0000  DISPLAY   *P1:24,*EL,"(",*V2LON,ANSA,*HOFF,")ll Transactions, (":
                           *V2LON,ANSN,*HOFF,")on-Inpatient Transactions Only":
                           ", (",*V2LON,ANSE,*HOFF,")xit ? ";
          KEYIN     *V2LON,ANS;
.
          TYPE      ANS                     * see if number entered
          GOTO      SOPT0100 IF EQUAL
          REP       UPPLOW,ANS
          REP       "A1N2E3",ANS
.
          TYPE      ANS                     * now we should have a number
          GOTO      SOPT0100 IF NOT EQUAL
          MOVE      ANS,SOPTION
          GOTO      SOPT9999
.
SOPT0100  BEEP                              * invalid option chosen
          GOTO      SOPT0000
.
SOPT9999  RETURN
+
.****************************************************************************
.         Keyin user id
.****************************************************************************
USID0000  KEYIN     *P1:22,*EL,"User Id : ",USERID;
          PACK      USERID,USERID,SP70
          MATCH     SP70,USERID
          GOTO      USID0000 IF EQUAL
USID9999  RETURN
+
.**********************************************************************
.*                               LOAD0000                             *
.*       Load the temp file with the relevant unique identifiers      *
.*       for the debtors that it is possible to print invoices for    *
.**********************************************************************
LOAD0000  MOVE      TRUE,FLAGFRST
.
          CLOSE     PATGSRN1                     * close Patient Surname file
          CLOSE     PATGSRN2                     * close Patient Surname file
          CLOSE     PATVISA2
.
          OPEN      PATGSRN1,"patgsrnf"          * open Patient Surname file
          OPEN      PATGSRN2,"patgsrnf"          * open Patient Surname file
          OPEN      PATVISA2,"patvisaf"
.
          BRANCH    FLAGSING,LOAD5000       * skip if doing single debtor 
.                                             option
          PACK      KEY28,ONE,SP30
          CALL      RSPRHR2                 * position on referral holding
.                                             file
.------ read through referral holding file ------
.
LOAD0100  CALL      RKPRHR2
          BRANCH    OVRCD,LOAD9000
.
          MATCH     SP6,SPRAC
          GOTO      LOAD0105 IF EQUAL
          MATCH     SPRAC,PRHRPRAC
          GOTO      LOAD0100 IF LESS
.
LOAD0105  MATCH     SP6,EPRAC
          GOTO      LOAD0110 IF EQUAL
          MATCH     PRHRPRAC,EPRAC
          GOTO      LOAD0100 IF LESS
.
.         check the medical practice user access
.
LOAD0110  PACK      KEY10,USERID,SP70
          CALL      RDPRALS1
          COMPARE   ZERO,OVRCD
          GOTO      LOAD0112 IF EQUAL       * User has access to all Med.Prac.
.
          PACK      KEY16,PRHRPRAC,USERID,SP70
          CALL      RDPRSEC1
          BRANCH    OVRCD,LOAD0100          * no access
.
LOAD0112  COMPARE   ONE,PRHRPINV            * finished if no more invoices
          GOTO      LOAD9000 IF NOT EQUAL     to print
.
          MOVE      PRHRUNIQ,KEY8
          CALL      RDPRHD2                 * read header file
          BRANCH    OVRCD,LOAD0100
.
          COMPARE   ZERO,PRHDSCAN           * skip if we have a debtor number
          GOTO      LOAD0200 IF EQUAL
.
          CALL      CHKDCI00                . Check Clinical Document 
          BRANCH    EXIT,LOAD0100
.
          COMPARE   TWO,SOPTION             * skip if doing all transactions
          GOTO      LOAD0120 IF NOT EQUAL
.
          MATCH     SP3,PRHRPIND            * see if patient indicator exists
          GOTO      LOAD0100 IF EQUAL
.
          PACK      KEY5,CODEGI,PRHRPIND  
          CALL      RDCODE1                 * read patient codes file
          BRANCH    OVRCD,LOAD0100
.
          MATCH     ANSO,TCINDC1            * skip if we have an outpatient
          GOTO      LOAD0140 IF EQUAL
.
          MATCH     ANSI,TCINDC1            * skip if we have an inpatient
          GOTO      LOAD0150 IF EQUAL
.
.------   Continue if doing all debtors option or debtors in a date range ----
.
LOAD0120  IF        OPTION = 3 | OPTION = 4
            GOTO      LOAD0250 
          ENDIF
          GOTO      LOAD0100
.
.------ we have an outpatient so continue only if doing all debtors ------
.------ option OR outpatient option ------
.
LOAD0140  BRANCH    OPTION,LOAD9999,LOAD9999,LOAD0250,LOAD0250
.
.------ we have an inpatient so continue only if doing all debtors ------
.------ option or either inpatient option ------
.
LOAD0150  BRANCH    OPTION,LOAD9999,LOAD9999,LOAD0170,LOAD0170
.
.------ we have an inpatient so check to see if he/she is currently ------
.------ admitted ------
.
LOAD0170  COMPARE   TWO,SOPTION             * skip if doing all transactions
          GOTO      LOAD0250 IF NOT EQUAL
.
          CALL      CHUR0000                * check to see if patient is 
          BRANCH    EXIT,LOAD0100             currently admitted
          GOTO      LOAD0250
.
.------ we are processing a debtor number so continue only if we are doing ----
.------ all debtors option ------
.
LOAD0200  BRANCH    OPTION,LOAD9999,LOAD9999,LOAD0250,LOAD0250
.
.------ set up the variables for the temp file ------
.
LOAD0250  MOVE      FALSE,FLAGFRST
          MOVE      PRHDDEBT,TEMPDEB
          MOVE      PRHDSCAN,TEMPSCN
          MOVE      PRHDUNIQ,KEY8
          CALL      RATMPR1                 * position on the temp file
          COMPARE   ZERO,OVRCD
          GOTO      LOAD0100 IF EQUAL       * already exists
.
          CALL      WRTMPR1
          GOTO      LOAD0100
.
.------ we are doing the single debtors option ------
.------ position on the header file ------
.
LOAD5000  PACK      KEY27,VDEBTOR,VSCANPMI,SP20
          CALL      RSPRHD1
.
.------ read through the holding header file ------
.
LOAD5100  CALL      RKPRHD1
          BRANCH    OVRCD,LOAD9000
.
          COMPARE   VSCANPMI,PRHDSCAN       * see if the scan flag is the same
          GOTO      LOAD9000 IF NOT EQUAL
.
          MATCH     VDEBTOR,PRHDDEBT        * compare debtors
          GOTO      LOAD9000 IF NOT EQUAL
.
          PACK      KEY28,ONE,PRHDUNIQ,SP30
          CALL      RSPRHR2
.
.------ loop through the referral holding file ------
.
LOAD5300  CALL      RKPRHR2
          BRANCH    OVRCD,LOAD5100
.
          COMPARE   ONE,PRHRPINV            * we have finished if no more
          GOTO      LOAD5100 IF NOT EQUAL     invoices to be printed
.
          COMPARE   PRHRUNIQ,PRHDUNIQ       * compare unique identifiers
          GOTO      LOAD5100 IF NOT EQUAL
.
          CALL      CHKDCI00                . Check Clinical Document 
          BRANCH    EXIT,LOAD5300
.
          COMPARE   TWO,SOPTION             * skip if doing all transactions
          GOTO      LOAD5800 IF NOT EQUAL     
.
          MATCH     SP3,PRHRPIND            * see if patient indicator exists
          GOTO      LOAD5300 IF EQUAL
.
          PACK      KEY5,CODEGI,PRHRPIND
          CALL      RDCODE1                 * read the patient codes file
          BRANCH    OVRCD,LOAD5300
.
          MATCH     ANSI,TCINDC1            * continue only if we have
          GOTO      LOAD5300 IF EQUAL         a non-inpatient
.
.------ set up the variables for the temp file ------
.
LOAD5800  MOVE      FALSE,FLAGFRST
          MOVE      PRHDDEBT,TEMPDEB
          MOVE      PRHDSCAN,TEMPSCN
          MOVE      PRHDUNIQ,KEY8
          CALL      RATMPR1                 * read the temp file
          BRANCH    OVRCD,LOAD5900
          GOTO      LOAD5300
.
.------ write to the temp file ------
.
LOAD5900  CALL      WRTMPR1
          GOTO      LOAD5300
.
.------ we have finished so see if we actually wrote anything to the temp -----
.------ file ------
.
LOAD9000  COMPARE   ZERO,FLAGFRST
          GOTO      LOAD9100 IF NOT EQUAL
          MOVE      FALSE,EXIT
          GOTO      LOAD9999
.
.------ no debtors found to print invoices for ------
.
LOAD9100  DISPLAY   *P1:24,*EL,*B,*V2LON,"***  No transactions found  ***     ";
          CALL      HITENTER
          MOVE      TRUE,EXIT
.
LOAD9999  RETURN
+
.------------------------------------------------------------------------------
. Check Clinical Document Mapping table to determine if Invoice can be raised 
.------------------------------------------------------------------------------
CHKDCI00  MOVE      ZERO,EXIT
          MOVE      SP70,INDMHOSP
          COMPARE   ONE,IBCNMHOS
          GOTO      CHKDCI20 IF NOT EQUAL
.
          PACK      KEY6,PRHRPRAC              * Medical practice
          CALL      RDPRPR1                    * code on file ?
          BRANCH    OVRCD,CHKDCI99
.
          MATCH     SP70,PRPRREGI
          GOTO      CHKDCI99 IF EQUAL
.
          PACK      KEY3,PRPRREGI,SP70     * use Register of Medical Prac.
          CALL      RDREGA1                * to get the hospital id
          BRANCH    OVRCD,CHKDCI99
          MOVE      REGHOSP,INDMHOSP
.
CHKDCI20  MOVE      PRHDCLAM,INDMCLAM
          MOVE      "P",INDMSYST
          MOVE      SP70,INDMCTYP
          MOVE      SP70,INDMILOS
.
          MOVE      PRHDDEBT,INDMURNO
          MOVE      SP70,INDMADNO
          PROC      CHKCLDCP
.
CHKDCI99  RETURN
+
.**********************************************************************
.*                               MULT0000                             *
.*       Routine to print invoices for options 3, 4, 5, 6, and 7      *
.*       which process multiple patients                              *
.**********************************************************************
MULT0000  CALL      SINVH000                     * check for template header
          BRANCH    EXIT,MULT9999
          CALL      SINVT000                     * check for template tail
          BRANCH    EXIT,MULT9999
.
          MOVE      ZERO,SOPTION
          IF        PRCNCADM=1
            CALL      SOPT0000                * choose option
            BRANCH    SOPTION,MULT1000,MULT1000,MULT9999
          ENDIF
.
MULT1000  CALL      CONT0000                * see if O.K. to continue
          BRANCH    EXIT,MULT9999
.
          DISPLAY   *P1:24,*EL,*V2LON,"***  ",*BLINKON,"Loading Debtors",*HOFF:
                    *V2LON,"  ***",*HOFF,"   Please Wait";
.
          CALL      CREA0000                * create the temp file
.
          MOVE      FALSE,FLAGSING
.
          BRANCH    OPTION,MULT9800,MULT9800,MULT1100,MULT1200
....                          ,MULT1300:
....                           MULT1400,MULT1500
.
.------ doing print all debtors option ------
.
MULT1100  CALL      LOAD0000                * get all the possible debtors to 
          BRANCH    EXIT,MULT9800             print invoices for
          GOTO      MULT2000
.
.------ doing debtors in a given date range option ------
.
MULT1200  CALL      LOAD0000                * get all the possible debtors to 
          BRANCH    EXIT,MULT9800             print invoices for
.
          CALL      GETO0000                * get all the debtors 
          BRANCH    EXIT,MULT9800             to print invoices for in the dates
          GOTO      MULT2000
.
.------ doing inpatients discharged in a given date range option ------
.
..MULT1300  CALL      LOAD0000                * get all the possible debtors to 
..          BRANCH    EXIT,MULT9800             print invoices for
.
..          CALL      GETD0000                * get all the discharged debtors 
..          BRANCH    EXIT,MULT9800             to print invoices for
..          GOTO      MULT2000
.
.------ doing inpatients where last invoice was in a given date range ------
.------ option ------
.
..MULT1400  CALL      LOAD0000                * get all the possible debtors to 
..          BRANCH    EXIT,MULT9800             print invoices for
.
..          CALL      GETI0000                * get all the invoiced debtors 
..          BRANCH    EXIT,MULT9800             to print invoices for
..          GOTO      MULT2000
.
.------ doing outpatients in a given date range option ------
.
..MULT1500  CALL      LOAD0000                * get all the possible debtors to 
..          BRANCH    EXIT,MULT9800             print invoices for
.
..          CALL      GETO0000                * get all the outpatient debtors 
..          BRANCH    EXIT,MULT9800             to print invoices for
.
.------ we have got the temp file of debtors, so get the details and ------
.------ print the invoices if appropriate ------
.
MULT2000  DISPLAY   *P1:4,*EF,"Debtor Number   : ":
                    *P1:6,"Patient Name    : ":
                    *P9:7,"Address : ";
.
          CALL      CLRTF000                * clear the temp file
.
          MOVE      TRUE,FLAGFRST
          MOVE      SP8,SAVDEBT
          MOVE      ZERO,SAVSCAN
          MOVE      SP20,KEY18
          CALL      RSTMPR12
.
.------ loop through the debtors temp file ------
.
MULT2100  CALL      RKTMPR12
          BRANCH    OVRCD,MULT9000
.
          MATCH     SP8,SAVDEBT             * see if we have a debtor number
          GOTO      MULT2200 IF EQUAL         saved
.
          MATCH     TEMPDEB,SAVDEBT         * see if the debtor number has
          GOTO      MULT2500 IF NOT EQUAL     changed
.
          COMPARE   TEMPSCN,SAVSCAN         * see if the scan flag has changed
          GOTO      MULT2500 IF NOT EQUAL   
.
.------ get the details for the current debtor ------
.
MULT2200  MOVE      TEMPDEB,VDEBTOR
          MOVE      TEMPSCN,VSCANPMI
.
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          CALL      LDDETAIL                * load the patient details
.
          DISPLAY   *P19:4,*EL,*V2LON,VDEBTOR:
                    *P19:6,*EL,VDEBNAME:
                    *P19:7,*EL,VDEBADD1:
                    *P19:8,*EL,VDEBADD2:
                    *P19:9,*EL,VDEBADD3,SP1,VDEBPOST;
.
          CALL      PRIINVLD                * load the data into the temp file
          BRANCH    EXIT,MULT2100             for this debtor number
.
          MOVE      FALSE,FLAGFRST
          MOVE      TEMPDEB,SAVDEBT
          MOVE      TEMPSCN,SAVSCAN
          GOTO      MULT2100
.
.------ print the invoice/s for the current debtor ------
.
MULT2500  CALL      PPTMP000                * process the pathology temp file
          CALL      PRIINVPR                * print the invoice/s for this
.                                             debtor number
          CALL      CLRTF000                * clear the temp file
.
          MOVE      SP8,SAVDEBT
          MOVE      ZERO,SAVSCAN
          GOTO      MULT2200 
.
.------ see if we found any valid transactions ------
.
MULT9000  COMPARE   ZERO,FLAGFRST
          GOTO      MULT9200 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,*V2LON,"***  No transactions found  ***     ";
          CALL      HITENTER
          GOTO      MULT9800
.
.------ see if we need to print for the last debtor on the temp file ------
.
MULT9200  MATCH     SP8,SAVDEBT
          GOTO      MULT9800 IF EQUAL
          CALL      PPTMP000                * process the pathology temp file
          CALL      PRIINVPR                * print the invoice/s for this
.                                             debtor number
MULT9800  CALL      KILL0000                * kill existing temp file
MULT9999  RETURN
+
.**********************************************************************
.*                               GETD0000                             *
.*    Get all the discharged debtor numbers to print invoices for     *
.**********************************************************************
GETD0000  DISPLAY   *P1:24,*EL,"Scanning Debtor : ";
          MOVE      TRUE,FLAGFRST
          MOVE      FALSE,EXIT
          MOVE      SP8,SAVDEBT
          MOVE      ZERO,SAVSCAN
          MOVE      SP20,KEY18
.
.------ position on the temp file ------
.
GETD0100  CALL      RSTMPR12
.
.------ read through the temp file ------
.
GETD1000  CALL      RKTMPR12
          BRANCH    OVRCD,GETD9000
.
          COMPARE   ZERO,TEMPSCN            * see if we have a debtor number
          GOTO      GETD1000 IF EQUAL
.
          BRANCH    FLAGFRST,GETD1100       * skip if processing first record
.
          MATCH     TEMPDEB,SAVDEBT         * compare debtor numbers
          GOTO      GETD1100 IF NOT EQUAL
.
          COMPARE   TEMPSCN,SAVSCAN         * compare scan flags
          GOTO      GETD1000 IF EQUAL       * same debtor
.
.------ position on the visit file for this U/R ------
.
GETD1100  MOVE      TEMPDEB,SAVDEBT
          MOVE      TEMPSCN,SAVSCAN
          DISPLAY   *P19:24,*V2LON,TEMPDEB;
          MOVE      TEMPDEB,FORM8
          PACK      KEY24,TEMPDEB,SP20
          CALL      RDSVISA2
.
.------ read through the visit file ------
.
GETD1200  CALL      RDKVISA2
          BRANCH    OVRCD,GETD2000
.
          MOVE      FORM8,KEY8              * see if we have the same U/R
          MATCH     PVIURNO,KEY8            * see if we have the same U/R
          GOTO      GETD2000 IF NOT EQUAL
.
          MOVE      PVIBILL,KEY8
          OPEN      PATDSCH1,"patdschf"
          CALL      RDDSCH1                 * read the discharge file
          CLOSE     PATDSCH1
          BRANCH    OVRCD,GETD1200
.
.------ pack the discharge date ------
.
GETD1250  MOVE      DDATE,WORKDATE
.
          MATCH     FROMDATE,WORKDATE       * see if discharge date is < the
          GOTO      GETD1200 IF LESS          from date
.
          MATCH     WORKDATE,TODATE         * see if discharge date is > the
          GOTO      GETD1200 IF LESS          to date
          MOVE      FALSE,FLAGFRST
          GOTO      GETD1000
.
.------ this U/R has no discharges in the given date range so delete ------
.------ from the temp file ------
.
GETD2000  PACK      SAVKEY18,TEMPDEB,TEMPSCN,SP8
.
          CALL      DELD0000                * routine to delete a debtor from
.                                             the temp file
          MOVE      SAVKEY18,KEY18
          GOTO      GETD0100
.
.------ we have reached the end of the temp file so see if we have ------
.------ any debtors to process ------
.
GETD9000  COMPARE   ZERO,FLAGFRST
          GOTO      GETD9999 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,*V2LON,"***  No debtors to process  ***     ";
          CALL      HITENTER
          MOVE      TRUE,EXIT
.
GETD9999  RETURN
+
.**********************************************************************
.*                               GETI0000                             *
.*  Get all the previously invoiced inpatients to print invoices for  *
.**********************************************************************
GETI0000  DISPLAY   *P1:24,*EL,"Scanning Debtor : ";
          MOVE      TRUE,FLAGFRST
          MOVE      FALSE,EXIT
          MOVE      SP8,SAVDEBT
          MOVE      ZERO,SAVSCAN
          MOVE      SP20,KEY18
.
.------ position on the temp file ------
.
GETI0100  CALL      RSTMPR12
.
.------ read through the temp file ------
.
GETI1000  CALL      RKTMPR12
          BRANCH    OVRCD,GETI9000
.
          COMPARE   ZERO,TEMPSCN            * see if we have a debtor number
          GOTO      GETI1000 IF EQUAL
.
          BRANCH    FLAGFRST,GETI1100       * skip if processing the first
.                                             record
          MATCH     TEMPDEB,SAVDEBT         * compare debtor numbers
          GOTO      GETI1100 IF NOT EQUAL
.
          COMPARE   TEMPSCN,SAVSCAN         * compare scan flags
          GOTO      GETI1000 IF EQUAL       * same debtor
.
.------ position on the visit file for this U/R ------
.
GETI1100  MOVE      TEMPDEB,SAVDEBT
          MOVE      TEMPSCN,SAVSCAN
          DISPLAY   *P19:24,*V2LON,TEMPDEB;
          MOVE      TEMPDEB,FORM8
          PACK      KEY24,TEMPDEB,SP20
          CALL      RDSVISA2
.
.------ read through the visit file ------
.
GETI1200  CALL      RDKVISA2
          BRANCH    OVRCD,GETI2000
.
          MOVE      FORM8,KEY8              * see if we have the same U/R
          MATCH     PVIURNO,KEY8            * compare U/R numbers
          GOTO      GETI2000 IF NOT EQUAL
.
          PACK      KEY16,PVIBILL,SP8
          CALL      RDSINV3                 * position on the invoice file
.
.------ read through the invoice file ------
.
GETI1300  CALL      RDKINV3
          BRANCH    OVRCD,GETI1200
.
          MATCH     PVIBILL,PINVADM         * compare admission numbers
          GOTO      GETI1200 IF NOT EQUAL
.
          MOVE      PINVDTE,WORKDATE
.
          MATCH     FROMDATE,WORKDATE       * see if invoice date is < the
          GOTO      GETI1300 IF LESS          from date
.
          MATCH     WORKDATE,TODATE         * see if the invoice date is >
          GOTO      GETI1300 IF LESS          the to date
          MOVE      FALSE,FLAGFRST
          GOTO      GETI1000
.
.------ this U/R has no invoices in the given date range so delete from ------
.------ temp file ------
.
GETI2000  PACK      SAVKEY18,TEMPDEB,TEMPSCN,SP8
          CALL      DELD0000                * routine to delete a debtor from
.                                             the temp file
          MOVE      SAVKEY18,KEY18
          GOTO      GETI0100
.
.------ we have reached the end of the temp file so see if we have any ------
.------ debtors to process ------
.
GETI9000  COMPARE   ZERO,FLAGFRST
          GOTO      GETI9999 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,*V2LON,"***  No debtors to process  ***     ";
          CALL      HITENTER
          MOVE      TRUE,EXIT
.
GETI9999  RETURN
+
.*****************************************************************************
.*                               GETO0000                                    *
.*    Get all the outpatient/debtor numbers to print invoices for in date    *
.*****************************************************************************
GETO0000  DISPLAY   *P1:24,*EL,"Scanning Debtor : ";
          MOVE      TRUE,FLAGFRST
          MOVE      FALSE,EXIT
          MOVE      SP8,SAVDEBT
          MOVE      ZERO,SAVSCAN
          MOVE      SP20,KEY18
.
.------ get the first record on the temp file ------
.
GETO0100  CALL      RSTMPR12
          CALL      RKTMPR12
          BRANCH    OVRCD,GETO9000
          GOTO      GETO1100
.
.------ read through the temp file ------
.
GETO1000  CALL      RKTMPR12
          BRANCH    OVRCD,GETO9000
.
          MATCH     TEMPDEB,SAVDEBT         * compare debtor numbers 
          GOTO      GETO2000 IF NOT EQUAL
.
          COMPARE   TEMPSCN,SAVSCAN         * compare scan flags
          GOTO      GETO2000 IF NOT EQUAL
.
.------ position on the transaction holding file for this unique identifier ---
.
GETO1100  MOVE      TEMPDEB,SAVDEBT
          MOVE      TEMPSCN,SAVSCAN
          DISPLAY   *P19:24,*V2LON,TEMPDEB;
          PACK      KEY62,TEMPUNQ,SPRAC,SP70
          CALL      RSPRHT1
.
.------ loop through the transaction holding file ------
.
GETO1200  CALL      RKPRHT1
          BRANCH    OVRCD,GETO1000
.
          COMPARE   PRHTUNIQ,TEMPUNQ        * compare unique identifiers
          GOTO      GETO1000 IF NOT EQUAL
.
          MATCH     SP6,EPRAC
          IF        !@EQUAL
            MATCH     PRHTPRAC,EPRAC
            GOTO      GETO1000 IF LESS
          ENDIF
.
          MATCH     FROMDATE,PRHTDATE       * see if service date is < the
          GOTO      GETO1200 IF LESS          from date
.
          MATCH     PRHTDATE,TODATE         * see if the service date is >
          GOTO      GETO1200 IF LESS          the to date
          MOVE      FALSE,FLAGFRST
          PACK      KEY18,TEMPDEB,TEMPSCN,Z8
          GOTO      GETO0100
.
.------ no service dates in the date range for this debtor so delete from -----
.------ the temp file ------
.
GETO2000  PACK      SAVKEY18,SAVDEBT,SAVSCAN,SP8
          MOVE      SAVDEBT,TEMPDEB
          MOVE      SAVSCAN,TEMPSCN
.
          CALL      DELD0000                * routine to delete a debtor from
.                                             the temp file
          MOVE      SAVKEY18,KEY18
          GOTO      GETO0100
.
.------ we have reached the end of the temp file so see if we have any ------
.------ debtors to process ------
.
GETO9000  COMPARE   ZERO,FLAGFRST
          GOTO      GETO9999 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,*V2LON,"***  No debtors to process  ***     ";
          CALL      HITENTER
          MOVE      TRUE,EXIT
.
GETO9999  RETURN
+
.**********************************************************************
.*                                DELD0000                            *
.*             Routine to delete a debtor from the temp file          *
.**********************************************************************
DELD0000  MOVE      TEMPDEB,SAVDEBT
          MOVE      TEMPSCN,SAVSCAN
          PACK      KEY18,TEMPDEB,TEMPSCN,SP10
.
.------ get the first record on the temp file ------
.
DELD1000  CALL      RSTMPR12
          CALL      RKTMPR12
          BRANCH    OVRCD,DELD9999
.
          MATCH     SAVDEBT,TEMPDEB         * compare debtor numbers
          GOTO      DELD9999 IF NOT EQUAL
.
          COMPARE   SAVSCAN,TEMPSCN         * compare scan flags
          GOTO      DELD9999 IF NOT EQUAL
.
          PACK      DIM18,TEMPDEB,TEMPSCN,TEMPUNQ
          PACK      KEY18,TEMPDEB,TEMPSCN,TEMPUNQ
.
          CALL      DETMPR12                * delete from the temp file
          MOVE      DIM18,KEY18
          GOTO      DELD1000
.
DELD9999  RETURN
+
.**********************************************************************
.*                                CONT0000                            *
.*         See if O.K. to continue for options 4, 5, 6, and 7         *
.**********************************************************************
CONT0000  MOVE      FALSE,EXIT
          DISPLAY   *P1:24,*EL,"Are you sure you want to continue (":
                           *V2LON,ANSY,*HOFF,SLASH,*V2LON,ANSN,*HOFF,") ? ";
          KEYIN     *V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     ANSN,ANS                * see if No entered
          GOTO      CONT9000 IF EQUAL
          MATCH     ANSY,ANS                * see if Yes entered
          GOTO      CONT9999 IF EQUAL
          BEEP                              * invalid keyin
          GOTO      CONT0000
.
CONT9000  MOVE      TRUE,EXIT               * user does not want to continue
.
CONT9999  RETURN
+
.**********************************************************************
.
GETSVAR   RETURN                       * label needed by surname search routine
+
.**********************************************************************
.
.------ I/O Routines for temp files ------
.
RATMPR1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      PRITM1XX,KEY8;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSTMPR1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      PRITM1XX,KEY8;;
          RETURN
.
RDTMPR1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      PRITM1XX,KEY8;DTEMPUNQ,TEMPDEB,DTEMPSCN
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
RKTMPR1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READKS    PRITM1XX;DTEMPUNQ,TEMPDEB,DTEMPSCN
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
RPTMPR1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READKP    PRITM1XX;DTEMPUNQ,TEMPDEB,DTEMPSCN
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
WRTMPR1   MOVE      TEMPSCN,DTEMPSCN
          MOVE      ZERO,OVRCD
          RESET     KEY8
          WRITE     PRITM1XX,KEY8;KEY8,TEMPDEB,DTEMPSCN
          RETURN
.
UPTMPR1   MOVE      TEMPUNQ,DTEMPUNQ
          MOVE      TEMPSCN,DTEMPSCN
          UPDATE    PRITM1XX;DTEMPUNQ,TEMPDEB,DTEMPSCN
          RETURN
.
DETMPR1   RESET     KEY8
          DELETE    PRITM1XX,KEY8
          RETURN
.  
RATMPR12  MOVE      ZERO,OVRCD
          RESET     KEY18
          READ      PRITM1XY,KEY18;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSTMPR12  MOVE      ZERO,OVRCD
          RESET     KEY18
          READ      PRITM1XY,KEY18;;
          RETURN
.
RDTMPR12  MOVE      ZERO,OVRCD
          RESET     KEY18
          READ      PRITM1XY,KEY18;DTEMPUNQ,TEMPDEB,DTEMPSCN
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
RKTMPR12  MOVE      ZERO,OVRCD
          RESET     KEY18
          READKS    PRITM1XY;DTEMPUNQ,TEMPDEB,DTEMPSCN
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
RPTMPR12  MOVE      ZERO,OVRCD
          RESET     KEY18
          READKP    PRITM1XY;DTEMPUNQ,TEMPDEB,DTEMPSCN
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
DETMPR12  RESET     KEY18
          DELETE    PRITM1XY,KEY18
          RETURN
+
SCHPRO00
SETDEF00
GETCOD00
OPEN0000
CLOS0000  RETURN
.==============================================================================
.
          INC       STD001IO
          INC       IBAPRINT
          INC       PATSNDX
          INC       PATSRCH
          INC       PRICALFS
          INC       PRIINVHL
          INC       PRIINVTL
          INC       PRIINVPR
          INC       CLPRIDTR
          INC       PRIKYDEB
          INC       PRIPRADS
          INC       SEXDSP00
          INC       TFILENAM                * Generate Temp File Name
          INC       CHKCLDCP
.
          INC       WEBERRIO/INC            * Web Server Error Logging
          INC       BOKRC1IO/INC
          INC       IBAPRNIO/INC
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
          INC       OUTPREIO/INC
          INC       IBAGEDIO/INC
.
          INC       PATCODIO/INC
          INC       PATDRGIO/INC
          INC       PATIN1IO/INC
          INC       PMSHCPIO/INC
          INC       PMSHCLIO/INC
          INC       PATDSCIO/INC
          INC       PATGSRIO/INC
          INC       PATINVIO/INC
          INC       PATMA1IO/INC
          INC       PATMESIO/INC
          INC       PATMI1IO/INC
          INC       PMSVX1IO/INC
          INC       PATMWSIO/INC
          INC       PATPERIO/INC
          INC       PATPR1IO/INC
          INC       PATRE1IO/INC
          INC       PATTRNIO/INC
          INC       PATVISIO/INC
          INC       PMSPX2IO/INC
.
          INC       HICITIIO/INC                 * HIC items invoice file
          INC       PRIAUIIO/INC
          INC       PRIBULIO/INC
          INC       PRICNOIO/INC
...          INC       PRIDBTIO/INC
          INC       PRIDOCIO/INC
          INC       PRIDTRIO/INC
          INC       PRIEXCIO/INC                 * execption charges file
          INC       PRIECTIO/INC
          INC       PRIFIGIO/INC
          INC       PRIFINIO/INC
          INC       PRIGRPIO/INC
          INC       PRIHDBIO/INC
          INC       PRIHISIO/INC
          INC       PRIHOLIO/INC
          INC       PRIHREIO/INC
          INC       PRIHTRIO/INC
          INC       PRIITMIO/INC
          INC       PRIINVIT/INC
          INC       PRIINVIO/INC
          INC       PRIMABIO/INC
          INC       PRIMGPIO/INC
          INC       PRIMULIO/INC
          INC       PRIPRAIO/INC
          INC       PRISPTIO/INC                 * spec. path. test file
          INC       PRISTAIO/INC
          INC       PRITESIO/INC
          INC       PRIVAFIO/INC
          INC       PRIWCOIO/INC
          INC       PRIALSIO/INC                 * Medical Prac.all user access
          INC       PRISECIO/INC                 * Medical Prac.security access
.
          INC       RCPBNKIO/INC
          INC       RCPBDTIO/INC
          INC       RCPREGIO/INC
          INC       RCPDTEIO/INC
          INC       COMDEPIO/INC                 * cash file
.
          INC       PATSNX2
          INC       PATGBCRN  
          INC       NZIBSRCH
          INC       NZHISIIO
          INC       CLPATMAS
          INC       CALCAGE
          INC       NHIMASIO/INC                 * NZHIS Variables
.
          INC       PATHSPIO/INC           * Hospital Details for GBCRN000
.
          INC       WEBIMCIO/INC
          INC       WEBB2BIO/INC
