. *----------------------------------------------------------------------------
. * Include Name  :   ALLACTTM.PBL
. *
. * Function      :   CGI variables for ALLACTFD - allactaf.dat
. *
. * Includes Needed :
. *
. * V10.11.01 01/08/2017 Richa Phogat               TSK 0842780
. *           Clear 'allactaf' file variables by moving spaces instead of Z70
. * V10.08.01 27/07/2016 Nicole Torrisi             TSK 0819642
. *           Changed ALAC0170 - ALAC0200 to read HCP file
. * V10.03.01 04/12/2013 Ania P                     CAR 294708
. *           Packed ALAC017-020 with spaces to prevent a null variable
. * V9.01.03  31/05/2006 Sandeep
. *           Changed to use read routines of Index 2 to sort based on DESC
. * V9.01.02  15/12/2001 Ebon Clements
. *           Mods to service selection list 
. *
. *-----------------------------------------------------------------------------
.
.******************************************************************************
.*           Clear Parameters for Non U/R Activity Table                      *
.******************************************************************************
.
CPALCT00  MOVE      Z70,ALACT001
          MOVE      Z70,ALACT002
          MOVE      Z70,ALACT003
          MOVE      Z70,ALACT004
          MOVE      Z70,ALACT005
          MOVE      Z70,ALACT006
          MOVE      ZERO,ALACT007
          MOVE      Z70,ALACT008
          MOVE      Z70,ALACT009
          MOVE      Z70,ALACT010
          MOVE      Z70,ALACT011
          MOVE      Z70,ALACT012
          MOVE      Z70,ALACT013
          MOVE      Z70,ALACT014
          MOVE      Z70,ALACT015
          MOVE      Z70,ALACT016
          MOVE      Z70,ALACT017
          MOVE      Z70,ALACT018
          MOVE      Z70,ALACT019
          MOVE      Z70,ALACT020
          MOVE      Z70,ALACT021
          MOVE      Z70,ALACT022
          MOVE      Z70,ALACT023
          MOVE      Z70,ALACT024
          MOVE      Z70,ALACT025
          MOVE      Z70,ALACT026
          MOVE      Z70,ALACT027
          MOVE      Z70,ALACT028
          MOVE      Z70,ALACT029
          MOVE      Z70,ALACT030
          MOVE      Z70,ALACT031
          MOVE      Z70,ALACT032
          MOVE      Z70,ALACT033
          MOVE      Z70,ALACT034
          MOVE      Z70,ALACT035
          MOVE      Z70,ALACT036
          MOVE      Z70,ALACT037
          MOVE      Z70,ALACT038
          MOVE      Z70,ALACT039
          MOVE      Z70,ALACT040
          MOVE      Z70,ALACT041
          MOVE      Z70,ALACT042
          MOVE      Z70,ALACT043
          MOVE      Z70,ALACT044
          MOVE      Z70,ALACT045
          MOVE      Z70,ALACT046
          MOVE      Z70,ALACT047
          MOVE      Z70,ALACT048
          MOVE      Z70,ALACT049
          MOVE      Z70,ALACT050
          MOVE      ZERO,ALACT051
          MOVE      ZERO,ALACT052
          MOVE      ZERO,ALACT053
          MOVE      ZERO,ALACT054
          MOVE      ZERO,ALACT055
          MOVE      ZERO,ALACT056
          MOVE      ZERO,ALACT057
          MOVE      ZERO,ALACT058
          MOVE      ZERO,ALACT059
          MOVE      ZERO,ALACT060
          MOVE      ZERO,ALACT061
          MOVE      ZERO,ALACT062
          MOVE      Z70,ALACT063
          MOVE      Z70,ALACT064
          MOVE      Z70,ALACT065
          MOVE      Z70,ALACT066
          MOVE      Z70,ALACT067
          MOVE      Z70,ALACT068
          MOVE      Z70,ALACT069
.          MOVE      Z70,ALACT070
.
CLAACT99 RETURN
.
.******************************************************************************
.*                     Clear File Variables                                   *
.******************************************************************************
CLRACT00  MOVE      SP70,ALACDEPT   
          MOVE      SP70,ALACDOCT   
          MOVE      SP70,ALACCODT 
          MOVE      SP70,ALACCOTM 
          MOVE      SP70,ALACLOCA 
          MOVE      SP70,ALACSERV 
          MOVE      ZERO,ALACUNIT 
          MOVE      SP70,ALACSTAT 
          MOVE      SP70,ALACUDT1  
          MOVE      SP70,ALACUTM1  
          MOVE      SP70,ALACUDT2  
          MOVE      SP70,ALACUTM2  
          MOVE      SP70,ALACUDT3  
          MOVE      SP70,ALACUTM3     
          MOVE      SP70,ALACUDT4    
          MOVE      SP70,ALACUTM4   
          MOVE      SP70,ALACUHC1   
          MOVE      SP70,ALACUHC2  
          MOVE      SP70,ALACUHC3   
          MOVE      SP70,ALACUHC4  
          MOVE      SP70,ALACUDI1  
          MOVE      SP70,ALACUDI2      
          MOVE      SP70,ALACUDI3     
          MOVE      SP70,ALACUDI4  
          MOVE      SP70,ALACUDI5   
          MOVE      SP70,ALACUDI6   
          MOVE      SP70,ALACUYN1   
          MOVE      SP70,ALACUYN2  
          MOVE      SP70,ALACUYN3 
          MOVE      SP70,ALACUYN4 
          MOVE      SP70,ALACUYN5     
          MOVE      SP70,ALACUYN6    
          MOVE      SP70,ALACUYN7    
          MOVE      SP70,ALACUYN8    
          MOVE      SP70,ALACUYN9    
          MOVE      SP70,ALACUFF1   
          MOVE      SP70,ALACUFF2   
          MOVE      SP70,ALACUFF3   
          MOVE      SP70,ALACUC01    
          MOVE      SP70,ALACUC02   
          MOVE      SP70,ALACUC03    
          MOVE      SP70,ALACUC04   
          MOVE      SP70,ALACUC05    
          MOVE      SP70,ALACUC06    
          MOVE      SP70,ALACUC07    
          MOVE      SP70,ALACUC08    
          MOVE      SP70,ALACUC09    
          MOVE      SP70,ALACUC10   
          MOVE      SP70,ALACUC11    
          MOVE      SP70,ALACUC12    
          MOVE      ZERO,ALACUF01 
          MOVE      ZERO,ALACUF02 
          MOVE      ZERO,ALACUF03
          MOVE      ZERO,ALACUF04 
          MOVE      ZERO,ALACUF05 
          MOVE      ZERO,ALACUF06
          MOVE      ZERO,ALACUF07  
          MOVE      ZERO,ALACUF08 
          MOVE      ZERO,ALACUF09
          MOVE      ZERO,ALACUF10
          MOVE      ZERO,ALACUF11
          MOVE      ZERO,ALACUF12    
          MOVE      SP70,ALACCOMM   
          MOVE      SP70,ALACCDAT     
          MOVE      SP70,ALACCTIM     
          MOVE      SP70,ALACCUID    
          MOVE      SP70,ALACUDAT    
          MOVE      SP70,ALACUTIM     
          MOVE      SP70,ALACUUID   
          MOVE      SP70,ALACSPAR 
CLRACT99  RETURN  
.
.******************************************************************************
.*                 Add allied health NON U/R Activity Table                   *
.******************************************************************************
.
ALAC0000  BRANCH    FLDITMNO,ALAC0010,ALAC0020,ALAC0030,ALAC0040,ALAC0050:
                             ALAC0060,ALAC0070,ALAC0080,ALAC0090,ALAC0100:
                             ALAC0110,ALAC0120,ALAC0130,ALAC0140,ALAC0150:
                             ALAC0160,ALAC0170,ALAC0180,ALAC0190,ALAC0200:
                             ALAC0210,ALAC0220,ALAC0230,ALAC0240,ALAC0250:
                             ALAC0260,ALAC0270,ALAC0280,ALAC0290,ALAC0300:
                             ALAC0310,ALAC0320,ALAC0330,ALAC0340,ALAC0350:
                             ALAC0360,ALAC0370,ALAC0380,ALAC0390,ALAC0400:
                             ALAC0410,ALAC0420,ALAC0430,ALAC0440,ALAC0450:
                             ALAC0460,ALAC0470,ALAC0480,ALAC0490,ALAC0500:
                             ALAC0510,ALAC0520,ALAC0530,ALAC0540,ALAC0550:
                             ALAC0560,ALAC0570,ALAC0580,ALAC0590,ALAC0600:
                             ALAC0610,ALAC0620,ALAC0630,ALAC0640,ALAC0650:
                             ALAC0660,ALAC0670,ALAC0680,ALAC0690,ALAC0700:
                             ALAC0710
.
ALAC0010  MOVE      "CG",CATEGORY
          MOVE      ALACDEPT,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0020  PACK      KEY10,ALACDOCT,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALAC9500
          MOVE      PMHCTITL,FMTTITLE    
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALAC9999
.
ALAC0030  MATCH     ALACCODT,SP70
          GOTO      ALAC9999 IF EQUAL
          UNPACK    ALACCODT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999 
.
ALAC0040  WRITE     HTMLFILE;ALACCOTM;
          GOTO      ALAC9999
.
ALAC0050  MOVE      "LD",CATEGORY
          MOVE      ALACLOCA,CODE
          CALL      CODITM00
          GOTO      ALAC9999  
.
ALAC0060  MOVE      SP70,KEY1
          UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      TWO,SERVFLAG
          MOVE      KEY1,SERVFLAG 
          PACK      KEY49,ALACDEPT,SP70
          CALL      RSALSER2
ALAC0065  CALL      RKALSER2 
          BRANCH    OVRCD,ALAC9999
.
          MATCH     ALSRDEPT,ALACDEPT
          GOTO      ALAC9999 IF NOT EQUAL
          MATCH     "1",ALSRACTV
          GOTO      ALAC0065 IF NOT EQUAL
.
          IF        SERVFLAG = 0
            MATCH     "1",ALSRNURA
            GOTO      ALAC0065 IF EQUAL
          ENDIF
.
          IF        SERVFLAG = 1
            MATCH     "1",ALSRNURA
            GOTO      ALAC0065 IF NOT EQUAL
          ENDIF
.
          MATCH     ALACSERV,ALSRSERV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option selected value=",ALSRSERV,">":
                              ALSRDESC,"</option>"
          ELSE       
            WRITE     HTMLFILE;"<option value=",ALSRSERV,">":
                               ALSRDESC,"</option>"
          ENDIF      
          GOTO      ALAC0065
.
ALAC0070  WRITE     HTMLFILE;ALACUNIT;
          GOTO      ALAC9999
.
ALAC0080  WRITE     HTMLFILE;ALACSTAT;
          GOTO      ALAC9999
.
ALAC0090  MATCH     ALACUDT1,SP70
          UNPACK    ALACUDT1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999
.
ALAC0100  WRITE     HTMLFILE;ALACUTM1;
          GOTO      ALAC9999
ALAC0110  MATCH     ALACUDT2,SP70
          GOTO      ALAC9999 IF EQUAL
          UNPACK    ALACUDT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999
.
ALAC0120  WRITE     HTMLFILE;ALACUTM2;
          GOTO      ALAC9999
ALAC0130  MATCH     ALACUDT3,SP70
          GOTO      ALAC9999 IF EQUAL
          UNPACK    ALACUDT3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999
.
ALAC0140  WRITE     HTMLFILE;ALACUTM3;
          GOTO      ALAC9999
ALAC0150  MATCH     ALACUDT4,SP70
          GOTO      ALAC9999 IF EQUAL
          UNPACK    ALACUDT4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999
.
ALAC0160  WRITE     HTMLFILE;ALACUTM4;
          GOTO      ALAC9999
.
ALAC0170  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0171
          PACK      KEY10,ALACUHC1,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALAC9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALAC9999
.
ALAC0171  WRITE     HTMLFILE;ALACUHC1;
          GOTO      ALAC9999
.
ALAC0180  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0181
          PACK      KEY10,ALACUHC2,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALAC9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALAC9999
.
ALAC0181  WRITE     HTMLFILE;ALACUHC2;
          GOTO      ALAC9999
.
ALAC0190  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0191
          PACK      KEY10,ALACUHC3,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALAC9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALAC9999
.
ALAC0191  WRITE     HTMLFILE;ALACUHC3;
          GOTO      ALAC9999
.
ALAC0200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0201
          PACK      KEY10,ALACUHC4,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALAC9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALAC9999
.
ALAC0201  WRITE     HTMLFILE;ALACUHC4;
          GOTO      ALAC9999
.
ALAC0210  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0211
          PACK      KEY12,ALACDEPT,ALACUDI1
          CALL      RDALDIA1
          BRANCH    OVRCD,ALAC9999
          WRITE     HTMLFILE;ALDIDESC;
          GOTO      ALAC9999
.
ALAC0211  WRITE     HTMLFILE;ALACUDI1;
          GOTO      ALAC9999
.
ALAC0220  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0221
          PACK      KEY12,ALACDEPT,ALACUDI2
          CALL      RDALDIA1
          BRANCH    OVRCD,ALAC9999
          WRITE     HTMLFILE;ALDIDESC;
          GOTO      ALAC9999
.
ALAC0221  WRITE     HTMLFILE;ALACUDI2;
          GOTO      ALAC9999
.
ALAC0230  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALAC0231
          PACK      KEY12,ALACDEPT,ALACUDI3
          CALL      RDALDIA1
          BRANCH    OVRCD,ALAC9999
          WRITE     HTMLFILE;ALDIDESC;
          GOTO      ALAC9999
.
ALAC0231  WRITE     HTMLFILE;ALACUDI3;
          GOTO      ALAC9999
.
ALAC0240  WRITE     HTMLFILE;ALACUDI4;
          GOTO      ALAC9999
.
ALAC0250  WRITE     HTMLFILE;ALACUDI5;
          GOTO      ALAC9999
.
ALAC0260  WRITE     HTMLFILE;ALACUDI6;
          GOTO      ALAC9999
.
ALAC0270  MOVE      NO,YESNO
          MATCH     "1",ALACUYN1
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0280  MOVE      NO,YESNO
          MATCH     "1",ALACUYN2
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0290  MOVE      NO,YESNO
          MATCH     "1",ALACUYN3
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0300  MOVE      NO,YESNO
          MATCH     "1",ALACUYN4
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
         GOTO      ALAC9999
.
ALAC0310  MOVE      NO,YESNO
          MATCH     "1",ALACUYN5
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0320  MOVE      NO,YESNO
          MATCH     "1",ALACUYN6
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0330  MOVE      NO,YESNO
          MATCH     "1",ALACUYN7
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0340  MOVE      NO,YESNO
          MATCH     "1",ALACUYN8
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0350  MOVE      NO,YESNO
          MATCH     "1",ALACUYN9
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALAC9999
.
ALAC0360   WRITE     HTMLFILE;ALACUFF1;
          GOTO      ALAC9999
.
ALAC0370  WRITE     HTMLFILE;ALACUFF2;
          GOTO      ALAC9999
.
ALAC0380  WRITE     HTMLFILE;ALACUFF3;
          GOTO      ALAC9999
.
ALAC0390  MOVE      "u0",CATEGORY
          MOVE      ALACUC01,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0400 MOVE      "u1",CATEGORY
          MOVE      ALACUC02,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0410  MOVE      "u2",CATEGORY
          MOVE      ALACUC03,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0420  MOVE      "u3",CATEGORY
          MOVE      ALACUC04,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0430  MOVE      "u4",CATEGORY
          MOVE      ALACUC05,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0440  MOVE      "u5",CATEGORY
          MOVE      ALACUC06,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0450  MOVE      "u6",CATEGORY
          MOVE      ALACUC07,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0460  MOVE      "u7",CATEGORY
          MOVE      ALACUC08,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0470  MOVE      "u8",CATEGORY
          MOVE      ALACUC09,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0480  MOVE      "u9",CATEGORY
          MOVE      ALACUC10,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0490  MOVE      "ua",CATEGORY
          MOVE      ALACUC11,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0500  MOVE      "ub",CATEGORY
          MOVE      ALACUC12,CODE
          CALL      CODITM00
          GOTO      ALAC9999
.
ALAC0510  WRITE     HTMLFILE;ALACUF01;
          GOTO      ALAC9999
.
ALAC0520  WRITE     HTMLFILE;ALACUF02;
          GOTO      ALAC9999
.
ALAC0530  WRITE     HTMLFILE;ALACUF03;
          GOTO      ALAC9999
.
ALAC0540  WRITE     HTMLFILE;ALACUF04;
          GOTO      ALAC9999
.
ALAC0550  WRITE     HTMLFILE;ALACUF05;
          GOTO      ALAC9999
.
ALAC0560  WRITE     HTMLFILE;ALACUF06;
          GOTO      ALAC9999
.
ALAC0570  WRITE     HTMLFILE;ALACUF07;
          GOTO      ALAC9999
.
ALAC0580  WRITE     HTMLFILE;ALACUF08;
          GOTO      ALAC9999
.
ALAC0590  WRITE     HTMLFILE;ALACUF09;
          GOTO      ALAC9999
.
ALAC0600  WRITE     HTMLFILE;ALACUF10;
          GOTO      ALAC9999
.
ALAC0610  WRITE     HTMLFILE;ALACUF11;
          GOTO      ALAC9999
.
ALAC0620  WRITE     HTMLFILE;ALACUF12;
          GOTO      ALAC9999
.
ALAC0630  WRITE     HTMLFILE;ALACCOMM;
          GOTO      ALAC9999
.
ALAC0640  MATCH     ALACCDAT,SP70
          GOTO      ALAC9999 IF EQUAL
          UNPACK    ALACCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999
.
ALAC0650  WRITE     HTMLFILE;ALACCTIM;
          GOTO      ALAC9999
.
ALAC0660  MATCH     SP70,ALACCUID
          GOTO      ALAC9999 IF EQUAL
          PACK      KEY10,ALACCUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALACCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      ALAC9999
.
ALAC0670  MATCH     ALACUDAT,SP70
          GOTO      ALAC9999 IF EQUAL
          UNPACK    ALACUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALAC9999
.
ALAC0680  WRITE     HTMLFILE;ALACUTIM;
          GOTO      ALAC9999
.
ALAC0690  MATCH     SP70,ALACUUID
          GOTO      ALAC9999 IF EQUAL
          PACK      KEY10,ALACUUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALACUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      ALAC9999
.
ALAC0700  PACK      KEY10,USERID,SP70
          CALL      RDWBSE1 
          RESET     DOCTNAME
          MATCH     DOCTNAME,SP70
          IF        @EQUAL
             PACK      KEY6,WBSEDOC,SP70
             CALL      RDDOCT1
             MOVE      DTITL,FMTTITLE
             MOVE      DGNAME,FMTGNAME
             MOVE      DSNAME,FMTSNAME
             CALL      DOCNM030
             MOVE      DOCFNAME,DEFDOCNM
             WRITE     HTMLFILE;DOCFNAME;
          ELSE
             PACK      KEY6,DOCTCODE,SP70
             CALL      RDDOCT1
             MOVE      DTITL,FMTTITLE
             MOVE      DGNAME,FMTGNAME
             MOVE      DSNAME,FMTSNAME
             CALL      DOCNM030
             WRITE     HTMLFILE;DOCFNAME 
          ENDIF
          GOTO      ALAC9999
.
ALAC0710  PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          RESET     DOCTNAME
          MATCH     DOCTNAME,SP70
          IF        @EQUAL
             MOVE      WBSEDOC,DOCTCODE
             WRITE     HTMLFILE;DOCTCODE;
          ELSE
             WRITE     HTMLFILE;DOCTCODE;
          ENDIF
          GOTO      ALAC9999
.
ALAC9500  RETURN 
.
ALAC9999  RETURN
.
.******************************************************************************
.*           Set Parameters for the Non U/R Activity Table                    *
.******************************************************************************
.
STACT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STACT001,STACT002,STACT003,STACT004,STACT005:
                       STACT006,STACT007,STACT008,STACT009,STACT010:
                       STACT011,STACT012,STACT013,STACT014,STACT015:
                       STACT016,STACT017,STACT018,STACT019,STACT020:
                       STACT021,STACT022,STACT023,STACT024,STACT025:
                       STACT026,STACT027,STACT028,STACT029,STACT030:
                       STACT031,STACT032,STACT033,STACT034,STACT035:
                       STACT036,STACT037,STACT038,STACT039,STACT040:
                       STACT041,STACT042,STACT043,STACT044,STACT045:
                       STACT046,STACT047,STACT048,STACT049,STACT050:
                       STACT051,STACT052,STACT053,STACT054,STACT055:
                       STACT056,STACT057,STACT058,STACT059,STACT060:
                       STACT061,STACT062,STACT063,STACT064,STACT065:
                       STACT066,STACT067,STACT068,STACT069
.
          MOVE      ONE,EXIT
          GOTO      STACT999
.
STACT001  MOVE      QRYDATA,ALACT001  
          GOTO      STACT999
.
STACT002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,ALACT002
          GOTO      STACT999
.
STACT003  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT003,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT004  MOVE      QRYDATA,ALACT004
          GOTO      STACT999
.
STACT005  MOVE      QRYDATA,ALACT005
          GOTO      STACT999
.
STACT006  MOVE      QRYDATA,ALACT006 *CHECK THIS
          GOTO      STACT999
.
STACT007  MOVE      QRYDATA,ALACT007 
          GOTO      STACT999
.
STACT008  MOVE      QRYDATA,ALACT008           
          GOTO      STACT999
.         
STACT009  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT009,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT010  MOVE      QRYDATA,ALACT010
          GOTO      STACT999
.
STACT011  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT011,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT012  MOVE      QRYDATA,ALACT012
          GOTO      STACT999
.
STACT013  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT013,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT014  MOVE      QRYDATA,ALACT014
          GOTO      STACT999
.
STACT015  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT015,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT016  MOVE      QRYDATA,ALACT016
          GOTO      STACT999
.
STACT017  PACK      ALACT017,QRYDATA,SP70
          GOTO      STACT999
.
STACT018  PACK      ALACT018,QRYDATA,SP70
          GOTO      STACT999
.
STACT019  PACK      ALACT019,QRYDATA,SP70
          GOTO      STACT999
.
STACT020  PACK      ALACT020,QRYDATA,SP70
          GOTO      STACT999
.
STACT021  MOVE      QRYDATA,ALACT021
          GOTO      STACT999
.
STACT022  MOVE      QRYDATA,ALACT022
          GOTO      STACT999
.
STACT023  MOVE      QRYDATA,ALACT023
          GOTO      STACT999
.
STACT024  MOVE      QRYDATA,ALACT024
          GOTO      STACT999
.
STACT025  MOVE      QRYDATA,ALACT025
          GOTO      STACT999
.
STACT026  MOVE      QRYDATA,ALACT026
          GOTO      STACT999
.
STACT027  MOVE      QRYDATA,ALACT027
          GOTO      STACT999
.
STACT028  MOVE      QRYDATA,ALACT028
          GOTO      STACT999
.
STACT029  MOVE      QRYDATA,ALACT029
          GOTO      STACT999
.
STACT030  MOVE      QRYDATA,ALACT030
          GOTO      STACT999
.
STACT031  MOVE      QRYDATA,ALACT031
          GOTO      STACT999
.
STACT032  MOVE      QRYDATA,ALACT032
          GOTO      STACT999
.
STACT033  MOVE      QRYDATA,ALACT033
          GOTO      STACT999
.
STACT034  MOVE      QRYDATA,ALACT034
          GOTO      STACT999
.
STACT035  MOVE      QRYDATA,ALACT035
          GOTO      STACT999
.
STACT036  MOVE      QRYDATA,ALACT036
          GOTO      STACT999
.
STACT037  MOVE      QRYDATA,ALACT037
          GOTO      STACT999
.
STACT038  MOVE      QRYDATA,ALACT038
          GOTO      STACT999
.
STACT039  MOVE      QRYDATA,ALACT039
          GOTO      STACT999
.
STACT040  MOVE      QRYDATA,ALACT040
          GOTO      STACT999
.
STACT041  MOVE      QRYDATA,ALACT041
          GOTO      STACT999
.
STACT042  MOVE      QRYDATA,ALACT042
          GOTO      STACT999
.
STACT043  MOVE      QRYDATA,ALACT043
          GOTO      STACT999
.
STACT044  MOVE      QRYDATA,ALACT044
          GOTO      STACT999
.
STACT045  MOVE      QRYDATA,ALACT045
          GOTO      STACT999
.
STACT046  MOVE      QRYDATA,ALACT046
          GOTO      STACT999
.
STACT047  MOVE      QRYDATA,ALACT047
          GOTO      STACT999
.
STACT048  MOVE      QRYDATA,ALACT048
          GOTO      STACT999
.
STACT049  MOVE      QRYDATA,ALACT049
          GOTO      STACT999
.
STACT050  MOVE      QRYDATA,ALACT050
          GOTO      STACT999
.
STACT051  MOVE      QRYDATA,ALACT051
          GOTO      STACT999
.
STACT052  MOVE      QRYDATA,ALACT052
          GOTO      STACT999
.
STACT053  MOVE      QRYDATA,ALACT053
          GOTO      STACT999
.
STACT054  MOVE      QRYDATA,ALACT054
          GOTO      STACT999
.
STACT055  MOVE      QRYDATA,ALACT055
          GOTO      STACT999
.
STACT056  MOVE      QRYDATA,ALACT056
          GOTO      STACT999
.
STACT057  MOVE      QRYDATA,ALACT057
          GOTO      STACT999
.
STACT058  MOVE      QRYDATA,ALACT058
          GOTO      STACT999
.
STACT059  MOVE      QRYDATA,ALACT059
          GOTO      STACT999
.
STACT060  MOVE      QRYDATA,ALACT060
          GOTO      STACT999
.
STACT061  MOVE      QRYDATA,ALACT061
          GOTO      STACT999
.
STACT062  MOVE      QRYDATA,ALACT062
          GOTO      STACT999
.
STACT063  MOVE      QRYDATA,ALACT063
          GOTO      STACT999
.
STACT064  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT064,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT065  MOVE      QRYDATA,ALACT065
          GOTO      STACT999
.
STACT066  MOVE      QRYDATA,ALACT066
          GOTO      STACT999
.
STACT067  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALACT067,CCENT,CYEAR,CMON,CDAY
          GOTO      STACT999
.
STACT068  MOVE      QRYDATA,ALACT068
          GOTO      STACT999
.
STACT069  MOVE      QRYDATA,ALACT069
          GOTO      STACT999
.
.
STACT999  RETURN
.
.******************************************************************************
.*            moving values from html to file variables                       *
.******************************************************************************
.
SAVACT00  MATCH     ALACT001,Z70
           IF        !@EQUAL
            MOVE      ALACT001,ALACDEPT
           ENDIF
. 
          MATCH     ALACT002,Z70
           IF        !@EQUAL
            MOVE      ALACT002,ALACDOCT
           ENDIF
. 
          MATCH     ALACT003,Z70
           IF        !@EQUAL
            MOVE      ALACT003,ALACCODT
           ENDIF
.
          MATCH     ALACT004,Z70
           IF        !@EQUAL
            MOVE      ALACT004,ALACCOTM
           ENDIF
.
          MATCH     ALACT005,Z70
           IF        !@EQUAL
            MOVE      ALACT005,ALACLOCA
           ENDIF
.
          MATCH     ALACT006,Z70
           IF        !@EQUAL
            MOVE      ALACT006,ALACSERV
           ENDIF
.
          COMPARE   ALACT007,ZERO
           IF        !@EQUAL
            MOVE      ALACT007,ALACUNIT
           ENDIF
.
          MATCH     ALACT008,Z70
           IF        !@EQUAL
            MOVE      ALACT008,ALACSTAT
           ENDIF
.
          MATCH     ALACT009,Z70
           IF        !@EQUAL
            MOVE      ALACT009,ALACUDT1
           ENDIF
.
          MATCH     ALACT010,Z70
           IF        !@EQUAL
            MOVE      ALACT010,ALACUTM1
           ENDIF
.
          MATCH     ALACT011,Z70
           IF        !@EQUAL
            MOVE      ALACT011,ALACUDT2
           ENDIF
.
          MATCH     ALACT012,Z70
           IF        !@EQUAL
            MOVE      ALACT012,ALACUTM2
           ENDIF
.
          MATCH     ALACT013,Z70
           IF        !@EQUAL
            MOVE      ALACT013,ALACUDT3
           ENDIF
.
          MATCH     ALACT014,Z70
           IF        !@EQUAL
            MOVE      ALACT014,ALACUTM3
           ENDIF
.
          MATCH     ALACT015,Z70
           IF        !@EQUAL
            MOVE      ALACT015,ALACUDT4
           ENDIF
.
          MATCH     ALACT016,Z70
           IF        !@EQUAL
            MOVE      ALACT016,ALACUTM4 
           ENDIF
.
          MATCH     ALACT017,Z70
           IF        !@EQUAL
            PACK      ALACUHC1,ALACT017,SP70
           ENDIF
.
          MATCH     ALACT018,Z70
           IF        !@EQUAL
            PACK      ALACUHC2,ALACT018,SP70
           ENDIF
.
          MATCH     ALACT019,Z70
           IF        !@EQUAL
            PACK      ALACUHC3,ALACT019,SP70
           ENDIF
.
          MATCH     ALACT020,Z70
           IF        !@EQUAL
            PACK      ALACUHC4,ALACT020,SP70
           ENDIF
.
          MATCH     ALACT021,Z70
           IF        !@EQUAL
            MOVE      ALACT021,ALACUDI1
           ENDIF
.
          MATCH     ALACT022,Z70
           IF        !@EQUAL
            MOVE      ALACT022,ALACUDI2
           ENDIF
.
          MATCH     ALACT023,Z70
           IF        !@EQUAL
            MOVE      ALACT023,ALACUDI3
           ENDIF
.
          MATCH     ALACT024,Z70
           IF        !@EQUAL
            MOVE      ALACT024,ALACUDI4
           ENDIF
.
          MATCH     ALACT025,Z70
           IF        !@EQUAL
            MOVE      ALACT025,ALACUDI5
           ENDIF
.
          MATCH     ALACT026,Z70
           IF        !@EQUAL
            MOVE      ALACT026,ALACUDI6
           ENDIF
.         
          MATCH     ALACT027,Z70
           IF        !@EQUAL
            MOVE      ALACT027,ALACUYN1
           ELSE
            MOVE      ZERO,ALACUYN1
           ENDIF
.
          MATCH     ALACT028,Z70
           IF        !@EQUAL
            MOVE      ALACT028,ALACUYN2
           ELSE
            MOVE      ZERO,ALACUYN2
           ENDIF
.
	  MATCH     ALACT029,Z70
           IF        !@EQUAL
            MOVE      ALACT029,ALACUYN3
           ELSE
            MOVE      ZERO,ALACUYN3
           ENDIF
.
	  MATCH     ALACT030,Z70
           IF        !@EQUAL
            MOVE      ALACT030,ALACUYN4
           ELSE
            MOVE      ZERO,ALACUYN4
           ENDIF
.
	  MATCH     ALACT031,Z70
           IF        !@EQUAL
            MOVE      ALACT031,ALACUYN5
           ELSE
            MOVE      ZERO,ALACUYN5
           ENDIF
.
	  MATCH     ALACT032,Z70
           IF        !@EQUAL
            MOVE      ALACT032,ALACUYN6
           ELSE
            MOVE      ZERO,ALACUYN6
           ENDIF
.
	  MATCH     ALACT033,Z70
           IF        !@EQUAL
            MOVE      ALACT033,ALACUYN7
           ELSE
            MOVE      ZERO,ALACUYN7
           ENDIF
.
	  MATCH     ALACT034,Z70
           IF        !@EQUAL
            MOVE      ALACT034,ALACUYN8
           ELSE
            MOVE      ZERO,ALACUYN8
           ENDIF
.
	  MATCH     ALACT035,Z70
           IF        !@EQUAL
            MOVE      ALACT035,ALACUYN9
           ELSE
            MOVE      ZERO,ALACUYN9
           ENDIF
.
          MATCH     ALACT036,Z70
           IF        !@EQUAL
            MOVE      ALACT036,ALACUFF1
           ENDIF
.
          MATCH     ALACT037,Z70
           IF        !@EQUAL
            MOVE      ALACT037,ALACUFF2
           ENDIF
.
          MATCH     ALACT038,Z70
           IF        !@EQUAL
            MOVE      ALACT038,ALACUFF3
           ENDIF
.
          MATCH     ALACT039,Z70
           IF        !@EQUAL
            MOVE      ALACT039,ALACUC01
           ENDIF
.
          MATCH     ALACT040,Z70
           IF        !@EQUAL
            MOVE      ALACT040,ALACUC02
           ENDIF
.
          MATCH     ALACT041,Z70
           IF        !@EQUAL
            MOVE      ALACT041,ALACUC03
           ENDIF
.
          MATCH     ALACT042,Z70
           IF        !@EQUAL
            MOVE      ALACT042,ALACUC04
           ENDIF
.
          MATCH     ALACT043,Z70
           IF        !@EQUAL
            MOVE      ALACT043,ALACUC05
           ENDIF
.
          MATCH     ALACT044,Z70
           IF        !@EQUAL
            MOVE      ALACT044,ALACUC06
           ENDIF
.
          MATCH     ALACT045,Z70
           IF        !@EQUAL
            MOVE      ALACT045,ALACUC07
           ENDIF
.
          MATCH     ALACT046,Z70
           IF        !@EQUAL
            MOVE      ALACT046,ALACUC08
           ENDIF
.
          MATCH     ALACT047,Z70
           IF        !@EQUAL
            MOVE      ALACT047,ALACUC09
           ENDIF
.
          MATCH     ALACT048,Z70
           IF        !@EQUAL
            MOVE      ALACT048,ALACUC10
           ENDIF
.
          MATCH     ALACT049,Z70
           IF        !@EQUAL
            MOVE      ALACT049,ALACUC11 
          ENDIF
.
          MATCH     ALACT050,Z70
           IF        !@EQUAL
            MOVE      ALACT039,ALACUC12
           ENDIF
.
          COMPARE   ALACT051,ZERO
           IF        !@EQUAL
            MOVE      ALACT051,ALACUF01
           ENDIF
.
          COMPARE   ALACT052,ZERO
           IF        !@EQUAL
            MOVE     ALACT052,ALACUF02
           ENDIF
.
          COMPARE   ALACT053,ZERO
           IF        !@EQUAL
            MOVE      ALACT053,ALACUF03
           ENDIF
.
          COMPARE   ALACT054,ZERO
           IF        !@EQUAL
            MOVE      ALACT054,ALACUF04
           ENDIF
.
          COMPARE   ALACT055,ZERO
           IF        !@EQUAL
            MOVE      ALACT055,ALACUF05
           ENDIF
.
          COMPARE   ALACT056,ZERO
           IF        !@EQUAL
            MOVE      ALACT056,ALACUF06
           ENDIF
.
          COMPARE   ALACT057,ZERO
           IF        !@EQUAL
            MOVE      ALACT057,ALACUF07
           ENDIF
.
          COMPARE   ALACT058,ZERO
           IF        !@EQUAL
            MOVE      ALACT058,ALACUF08
           ENDIF
.
          COMPARE   ALACT059,ZERO
           IF        !@EQUAL
            MOVE      ALACT059,ALACUF09
           ENDIF
.
          COMPARE   ALACT060,ZERO
           IF        !@EQUAL
            MOVE      ALACT060,ALACUF10
           ENDIF
.
          COMPARE   ALACT061,ZERO
           IF        !@EQUAL
            MOVE      ALACT061,ALACUF11
           ENDIF
.
          COMPARE   ALACT062,ZERO
           IF        !@EQUAL
            MOVE      ALACT062,ALACUF12
           ENDIF
.
          MATCH     ALACT063,Z70
           IF        !@EQUAL
            MOVE      ALACT063,ALACCOMM
           ENDIF
.
          MATCH     ALACT064,Z70
           IF        !@EQUAL
            MOVE      ALACT064,ALACCDAT
           ENDIF
.
          MATCH     ALACT065,Z70
           IF        !@EQUAL
            MOVE      ALACT065,ALACCTIM
           ENDIF
.
          MATCH     ALACT066,Z70
           IF        !@EQUAL
            MOVE      ALACT066,ALACCUID 
           ENDIF
.
          MATCH     ALACT067,Z70
           IF        !@EQUAL
            MOVE      ALACT067,ALACUDAT
           ENDIF
.
          MATCH     ALACT068,Z70
           IF        !@EQUAL
            MOVE      ALACT068,ALACUTIM
           ENDIF
.
          MATCH     ALACT069,Z70
           IF        !@EQUAL
            MOVE      ALACT069,ALACUUID
           ENDIF
.
SAVACT99  RETURN
