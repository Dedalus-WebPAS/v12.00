.----------------------------------------------------------------------
.   Program       : GENERHKI
.   SRF Number    : 7323  
.   Modifications : 
.         V10.11.01 08/08/2017  Tracey Nguyen TSK 0299206
.                   Recompiled for PMSHKIPR - Added Sound-Ex key for
.                   HCP Surname and Given Name
.         V10.07.01 10/03/2016 Peter McMullem CAR 0815423
.                   Use mandatory env var QISNAME to detect Oracle 
.         V10.05.01 25/07/2014  Ebon Clements CAR 295504
.                   Recompiled for PMSHKIPR - Preferred name to keywords
.         V10.03.01 19/09/2012  Davin         CAR 269841
.                   Added isclear of keyword table
.         V9.09.01  07/01/2008  Ebon Clements CAR 146550
.                   Recompiled for PMSHKIPR - HCP code added to keywords
.
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.  data includes
.----------------------------------------------------------------------
.
          INC       STDGENDF
          INC       PMSHCPFD/INC
          INC       PMSHKIFD/INC
.
.----------------------------------------------------------------------
.  local variables
.----------------------------------------------------------------------
.
CMDLINE   DIM       50
.
PRGID     INIT      "GENERHKI"
PRGNAM    INIT      "Fix pmshkiaf"
VERSION   INIT      "V12.00.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
.
.---- initialise screen and confirm desire to execute program ----
.
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P1:10,"This file generate HCP Keyword records."
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
.---- open files ----
.
          OPEN      PMSHCPA1,"pmshcpaf"
          OPEN      PMSHKIA1,"pmshkiaf"
          OPEN      PMSHKIA2,"pmshkiaf"
.
.---- clear out keyword table ----
.
          MOVE      SP70,DIM19
          GETENV    "QISNAME",DIM19
          PACK      DIM19,DIM19,SP70
.
          MATCH     SP70,DIM19
          IF        !@EQUAL
            CLEAR     CMDLINE
            APPEND    "isclear pmshkiaf",CMDLINE
            APPEND    SP70,CMDLINE
            RESET     CMDLINE
            EXECUTE   CMDLINE,TASKID
          ENDIF
.
          MOVE      ZERO,SECTOR
          PACK      KEY10,SP70
ML1000    CALL      RSPMHCP1           * read next record
.
ML1100    CALL      RKPMHCP1
          BRANCH    OVRCD,ML9999
.
          ADD       ONE,SECTOR         * display every 100th record
          IF        SECTOR%1000=1
            DISPLAY   *P1:24,*V2LON,SECTOR," - ",PMHCHCPC,*EF;
          ENDIF
.
          PROC      PMSHKIUP
          GOTO      ML1100
.
.---- exit program ----
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
.  code includes
.----------------------------------------------------------------------
.
          INC       PMSHCPIO/INC
          INC       PMSHKIIO/INC
          INC       PMSHKIPR
          INC       STDGENCD
.
