. *----------------------------------------------------------------------
. * Include Name  :   PMSADJTM.PBL
. *
. * Function      :   CGI variables for PMSADJFD - pmsadjaf.dat
. *
. * Includes Needed : PMSADJFD - ABF Adjustment Table
. *                   PMSADJIO - IO for ABF Adjustment Table
. * Modifications :
. * V11.03.01 23/05/2023 J.Tan      TSK 0923703
. *           Added Adjustment type 028 - COVID19
. * V11.00.01 14/07/2020 J.Tan      TSK 0892319
. *           Added Adjustment type 026 and 027
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for ABF Adjustment Table 
.------------------------------------------------------------------------
.
CLRADJ00  MOVE      Z70,PMADJ001
          MOVE      Z70,PMADJ002
          MOVE      ZERO,PMADJ003
          MOVE      Z70,PMADJ004
          MOVE      Z70,PMADJ005
          MOVE      Z70,PMADJ006
          MOVE      Z70,PMADJ007
          MOVE      Z70,PMADJ008
          MOVE      Z70,PMADJ009

          MOVE      ZERO,PMADJ010
          MOVE      ZERO,PMADJ011
          MOVE      ZERO,PMADJ012
          MOVE      ZERO,PMADJ013
          MOVE      ZERO,PMADJ014
          MOVE      ZERO,PMADJ015
          MOVE      ZERO,PMADJ016
          MOVE      ZERO,PMADJ017
          MOVE      ZERO,PMADJ018
          MOVE      ZERO,PMADJ019
          MOVE      ZERO,PMADJ020
          MOVE      ZERO,PMADJ021
          MOVE      ZERO,PMADJ022
          MOVE      ZERO,PMADJ023
          MOVE      ZERO,PMADJ024
          MOVE      ZERO,PMADJ025
          MOVE      ZERO,PMADJ026
          MOVE      ZERO,PMADJ027
          MOVE      ZERO,PMADJ028
          MOVE      ZERO,PMADJ029
          MOVE      ZERO,PMADJ030
          MOVE      ZERO,PMADJ031
          MOVE      ZERO,PMADJ032
          MOVE      ZERO,PMADJ033
          MOVE      ZERO,PMADJ034
          MOVE      ZERO,PMADJ035
          MOVE      ZERO,PMADJ036
          RETURN
.
.------------------------------------------------------------
. ABF Adjustment Table fields
.-----------------------------------------------------------
PMAJ0000  BRANCH    FLDITMNO,PMAJ0010,PMAJ0020,PMAJ0030,PMAJ0040,PMAJ0050:
                             PMAJ0060,PMAJ0070,PMAJ0080,PMAJ0090
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMAJ9999
.
PMAJ0010  UNPACK    DIM127,D1,KEY1,DIM127        * Contract ID
          MOVE      KEY1,F1
          BRANCH    F1,PMAJ0012
.
          WRITE     HTMLFILE;PMAJCNTR;
          GOTO      PMAJ9999
.
PMAJ0012  PACK      KEY6,PMAJCNTR,SP70
          CALL      RDPMCID1
          BRANCH    OVRCD,PMAJ9999
.
          WRITE     HTMLFILE;PMCIDESC;
          GOTO      PMAJ9999
.
PMAJ0020  WRITE     HTMLFILE;PMAJADJT;
          GOTO      PMAJ9999
.
PMAJ0030  WRITE     HTMLFILE;PMAJADJV;
          GOTO      PMAJ9999
.
PMAJ0040  WRITE     HTMLFILE;PMAJCUID;
          GOTO      PMAJ9999
.
PMAJ0050  MATCH     PMAJCDAT,SP70
          GOTO      PMAJ9999 IF EQUAL
.
          UNPACK    PMAJCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAJ9999
.
PMAJ0060  WRITE     HTMLFILE;PMAJCTIM;
          GOTO      PMAJ9999
.
PMAJ0070  WRITE     HTMLFILE;PMAJUUID;
          GOTO      PMAJ9999
.
PMAJ0080  MATCH     PMAJUDAT,SP70
          GOTO      PMAJ9999 IF EQUAL
.
          UNPACK    PMAJUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR; 
          GOTO      PMAJ9999
.
PMAJ0090  WRITE     HTMLFILE;PMAJUTIM;
          GOTO      PMAJ9999
.
PMAJ9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for ABF Adjustment Table
.------------------------------------------------------------
SPPAJ000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPAJ001,SPPAJ002,SPPAJ003,SPPAJ004,SPPAJ005:
                       SPPAJ006,SPPAJ007,SPPAJ008,SPPAJ009,SPPAJ010:
                       SPPAJ011,SPPAJ012,SPPAJ013,SPPAJ014,SPPAJ015:
                       SPPAJ016,SPPAJ017,SPPAJ018,SPPAJ019,SPPAJ020:
                       SPPAJ021,SPPAJ022,SPPAJ023,SPPAJ024,SPPAJ025:
                       SPPAJ026,SPPAJ027,SPPAJ028,SPPAJ029,SPPAJ030:
                       SPPAJ031,SPPAJ032,SPPAJ033,SPPAJ034,SPPAJ035:
                       SPPAJ036
.
          MOVE      ONE,EXIT
          GOTO      SPPAJ999
.
SPPAJ001  MOVE      QRYDATA,PMADJ001
          PACK      PMADJ001,PMADJ001,SP70
          GOTO      SPPAJ999
.
SPPAJ002  MOVE      QRYDATA,PMADJ002
          PACK      PMADJ002,PMADJ002,SP70
          GOTO      SPPAJ999
.
SPPAJ003  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ003
          GOTO      SPPAJ999
.
SPPAJ004  MOVE      QRYDATA,PMADJ004
          PACK      PMADJ004,PMADJ004,SP70
          GOTO      SPPAJ999
.
SPPAJ005  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMADJ005,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPAJ999
.
SPPAJ006  MOVE      QRYDATA,PMADJ006
          PACK      PMADJ006,PMADJ006,SP70
          GOTO      SPPAJ999
.
SPPAJ007  MOVE      QRYDATA,PMADJ007
          PACK      PMADJ007,PMADJ007,SP70
          GOTO      SPPAJ999
.
SPPAJ008  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMADJ008,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPAJ999
.
SPPAJ009  MOVE      QRYDATA,PMADJ009
          PACK      PMADJ009,PMADJ009,SP70
          GOTO      SPPAJ999
.
SPPAJ010  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ010
          GOTO      SPPAJ999
.
SPPAJ011  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ011
          GOTO      SPPAJ999
.
SPPAJ012  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ012
          GOTO      SPPAJ999
.
SPPAJ013  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ013
          GOTO      SPPAJ999
.
SPPAJ014  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ014
          GOTO      SPPAJ999
.
SPPAJ015  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ015
          GOTO      SPPAJ999
.
SPPAJ016  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ016
          GOTO      SPPAJ999
.
SPPAJ017  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ017
          GOTO      SPPAJ999
.
SPPAJ018  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ018
          GOTO      SPPAJ999
.
SPPAJ019  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ019
          GOTO      SPPAJ999
.
SPPAJ020  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ020
          GOTO      SPPAJ999
.
SPPAJ021  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ021
          GOTO      SPPAJ999
.
SPPAJ022  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ022
          GOTO      SPPAJ999
.
SPPAJ023  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ023
          GOTO      SPPAJ999
.
SPPAJ024  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ024
          GOTO      SPPAJ999
.
SPPAJ025  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ025
          GOTO      SPPAJ999
.
SPPAJ026  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ026
          GOTO      SPPAJ999
.
SPPAJ027  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ027
          GOTO      SPPAJ999
.
SPPAJ028  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ028
          GOTO      SPPAJ999
.
SPPAJ029  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ029
          GOTO      SPPAJ999
.
SPPAJ030  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ030
          GOTO      SPPAJ999
.
SPPAJ031  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ031
          GOTO      SPPAJ999
.
SPPAJ032  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ032
          GOTO      SPPAJ999
.
SPPAJ033  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ033
          GOTO      SPPAJ999
.
SPPAJ034  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ034
          GOTO      SPPAJ999
.
SPPAJ035  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ035
          GOTO      SPPAJ999
.
SPPAJ036  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMADJ036
          GOTO      SPPAJ999
.
SPPAJ999  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to ABF Adjustment Table
.------------------------------------------------------------------------
MVPMAJ00  MATCH     PMADJ001,Z70
          IF        !@EQUAL
            MOVE      PMADJ001,PMAJCNTR
          ENDIF
.
          MATCH     PMADJ002,Z70
          IF        !@EQUAL
            MOVE      PMADJ002,PMAJADJT
          ENDIF
.
          COMPARE   PMADJ003,ZERO
          IF        !@EQUAL
            MOVE      PMADJ003,PMAJADJV
          ENDIF
.
          MATCH     PMADJ004,Z70
          IF        !@EQUAL
            MOVE      PMADJ004,PMAJCUID
          ENDIF
.
          MATCH     PMADJ005,Z70
          IF        !@EQUAL
            MOVE      PMADJ005,PMAJCDAT
          ENDIF
.
          MATCH     PMADJ006,Z70
          IF        !@EQUAL
            MOVE      PMADJ006,PMAJCTIM
          ENDIF
.
          MATCH     PMADJ007,Z70
          IF        !@EQUAL
            MOVE      PMADJ007,PMAJUUID
          ENDIF
.
          MATCH     PMADJ008,Z70
          IF        !@EQUAL
            MOVE      PMADJ008,PMAJUDAT
          ENDIF
.
          MATCH     PMADJ009,Z70
          IF        !@EQUAL
            MOVE      PMADJ009,PMAJUTIM
          ENDIF
.
MVPMAJ99  RETURN
+
