.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRFMAKY
.   Routine   :   KSCFMA00 Keyin Function            
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSCFMA00 TOPIC     "SCFMFID "
          MOVE      SCFMPID,SCFDPID
KSCFMA05  MOVE      SCFDPID,SCFMPID
          MOVE      UNDLN70,SCFMFID 
          KEYIN     *PCCOL:CVERT,*DV,SCFMFID:                                   
                    *PCCOL:CVERT,*V2LON,SCFMFID:                                
                    *PCCOL:CVERT,*DV,SCFMFID 
.
          ENDSET    SCFMFID 
          APPEND    SP70,SCFMFID 
          RESET     SCFMFID 
.
          MATCH     SP70,SCFMFID 
          GOTO      KSCFMA90 IF EQUAL
.
          CMATCH    EXITCHAR,SCFMFID 
          GOTO      KSCFMA95 IF EQUAL
.
          CMATCH    QUEST,SCFMFID 
          GOTO      KSCFMA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSCFMA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SCFMFID 
          APPEND    SP70,SCFMFID 
          RESET     SCFMFID 
.
          MATCH     SP70,SCFMFID 
          GOTO      KSCFMA05 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SCFMFID                                 
KSCFMA10
          PACK      KEY16,SCFMFID,SCFMPID                                       
          CALL      RASCFM1 
          IF        OVRCD=1
            PACK      KEY16,SCFMFID,SP70
            CALL      RASCFM1 
            BRANCH    OVRCD,KSCFMA80
          ENDIF
          BRANCH    CKEYTYP,KSCFMA75
          CALL      RDSCFM1 
KSCFMA70
          MOVE      ZERO,EXIT
          GOTO      KSCFMA99
KSCFMA75
          MOVE      "Function Already Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KSCFMA05
KSCFMA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSCFMA99,KSCFMA99
          MOVE      "Function Does Not Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KSCFMA05
KSCFMA90
          MOVE      ONE,EXIT
          GOTO      KSCFMA99
KSCFMA95
          MOVE      TWO,EXIT
KSCFMA99  TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRFMAKY
.   Routine   :   HSCFMA00 Function            
.   Return    :           
.-------------------------------------------------------------------------------
HSCFMA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HSCFMA04
          CALL      GSCRN000
          BRANCH    EXIT,HSCFMA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Function"           
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 9",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Program"            
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 9",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL03,STDCOL04
          ADD       "36",STDCOL04
HSCFMA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SCFMFID 
          PACK      KEY16,SCFMPID,SP70
          PACK      SAVKEY80,SCFMPID,SCFMFID,SP70                               
          MOVE      ZERO,SCHTST01
          SETLPTR   SAVKEY80,8                                                  
          CALL      RSSCFM2 
HSCFMA10
          CALL      RKSCFM2 
          IF        OVRCD=1
            MOVE      "~~~~~~~~~",SCFMPID
          ENDIF
          PACK      KEY16,SCFMPID,SCFMFID,SP70                                  
.
          MATCH     SP70,SCFMPID
          GOTO      HSCFMA11 IF EQUAL
          MATCH     SAVKEY80,KEY16                                              
          IF        !@EQUAL
            IF        SCHTST01=0
              MOVE      ONE,SCHTST01
              PACK      KEY16,SP70
              CALL      RSSCFM2
              GOTO      HSCFMA10
            ELSE
              GOTO      HSCFMA15
            ENDIF
          ENDIF
HSCFMA11
          BRANCH    CSEARCH,HSCFMA12
          CALL      HSCFMA60
          BRANCH    OVRCD,HSCFMA10
HSCFMA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY16,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SCFMFID 
          DISPLAY   *PSTDCOL02:STDROW,SCFMPID 
          DISPLAY   *PSTDCOL03:STDROW,SCFMDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSCFMA10 IF NOT EQUAL
HSCFMA15
          UNPACK    SAVKEY80,SCFMPID,SCFMFID                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSCFMA20
          CALL      HSCRI000
          BRANCH    EXIT,HSCFMA30,HSCFMA35,HSCFMA40,HSCFMA45,HSCFMA04:
                              HSCFMA91,HSCFMA50
          GOTO      HSCFMA92
HSCFMA30
          CALL      RKSCFM2 
          IF        OVRCD=1
            MOVE      "~~~~~~~~~",SCFMPID
          ENDIF
          MATCH     SP70,SCFMPID
          IF        !@EQUAL
            PACK      KEY16,SCFMPID,SCFMFID,SP70 
            MATCH     SAVKEY80,KEY16            
            IF        !@EQUAL
              IF        SCHTST01=0
                MOVE      ONE,SCHTST01
                PACK      KEY16,SP70
                CALL      RSSCFM2
                CALL      RKSCFM2
               ELSE
                GOTO      HSCFMA85
               ENDIF
            ENDIF
          ENDIF
          CALL      RPSCFM2 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCFMA10
HSCFMA35
          MOVE      ST1,KEY16
          CALL      RDSCFM2 
          CALL      RPSCFM2 
          BRANCH    OVRCD,HSCFMA85
          PACK      KEY16,SCFMPID,SCFMFID,SP70                                  
          MATCH     SP70,SCFMFID                                                
          GOTO      HSCFMA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSCFMA36
          CALL      RPSCFM2 
          BRANCH    OVRCD,HSCFMA37
          PACK      KEY16,SCFMPID,SCFMFID,SP70                                  
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCFMA36 IF NOT EQUAL
HSCFMA37
          MOVE      ZERO,XITEMNO
          GOTO      HSCFMA10
HSCFMA40
          MOVE      ST1,KEY16
          CALL      RDSCFM2 
          CALL      RPSCFM2 
          BRANCH    OVRCD,HSCFMA85
          PACK      KEY16,SCFMPID,SCFMFID,SP70                                  
          UNPACK    SAVKEY80,SCFMPID
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCFMA08
HSCFMA45
          CALL      RKSCFM2 
          BRANCH    OVRCD,HSCFMA85
          PACK      KEY16,SCFMPID,SCFMFID,SP70                                  
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY16,SP8,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSCFM2 
HSCFMA46
          CALL      RPSCFM2 
          BRANCH    OVRCD,HSCFMA47
          PACK      KEY16,SCFMPID,SCFMFID,SP70                                  
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCFMA46 IF NOT EQUAL
HSCFMA47
          MOVE      ZERO,XITEMNO
          GOTO      HSCFMA10
HSCFMA50  COMPARE   ZERO,CSEARCH
          GOTO      HSCFMA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCFMA08
HSCFMA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCFMA08
HSCFMA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSCFMA61 IF EQUAL
          MATCH     SCHFLD01,SCFMFID 
          GOTO      HSCFMA72 IF NOT EQUAL
HSCFMA61
          MATCH     SP70,SCHFLD02
          GOTO      HSCFMA62 IF EQUAL
          MATCH     SCHFLD02,SCFMPID 
          GOTO      HSCFMA72 IF NOT EQUAL
HSCFMA62
          MATCH     SP70,SCHFLD03
          GOTO      HSCFMA63 IF EQUAL
          MATCH     SCHFLD03,SCFMDES 
          GOTO      HSCFMA72 IF NOT EQUAL
HSCFMA63
HSCFMA64
HSCFMA65
HSCFMA66
HSCFMA67
HSCFMA68
HSCFMA69
HSCFMA70
          GOTO      HSCFMA75
HSCFMA72  MOVE      ONE,OVRCD
HSCFMA75  RETURN
HSCFMA85
          LOAD      KEY16,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY16,SCFMPID,SCFMFID                                       
          CALL      RDSCFM2 
HSCFMA90
          UNPACK    SAVKEY80,SCFMPID,SCFMFID                                    
          BEEP
          GOTO      HSCFMA20
HSCFMA91
          MOVE      SP70,SCFMDES 
          MOVE      ZERO,SCFMTYP 
          MOVE      SP70,SCFMSFI 
          MOVE      SP70,SCFMSPA 
          MOVE      SP70,KEY16
          MOVE      SP70,SCFMFID 
          GOTO      HSCFMA96
HSCFMA92
          MOVE      SP70,KEY16
          MOVE      SP70,SCFMFID 
          LOAD      KEY16,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY16,SCFMPID,SCFMFID                                       
HSCFMA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSCFMA99
          RETURN
