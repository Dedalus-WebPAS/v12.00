.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.--------------------------------------------------------------------------
. VF.01.01  08.08.2000 Sandra Barcham
.           Handle 5 character catalog codes
.           srf 4010
.--------------------------------------------------------------------------
. VF.00.02  22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  19.08.1999 Sandra Barcham
.           Accept 6 char catalog codes for barcodes
.           Quote 9468
.--------------------------------------------------------------------------
CCNT      FORM      2
.
EXPORTFL  FILE      ASCII, FIXED=83
COUNTDAT  FORM      1
QTYFORM8  FORM      8
QTYFORM6  FORM      6
FOUNDX    FORM      1
STRCST    DIM       5
ENDCST    DIM       5
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN63
.   Function      :   Imprest Download                        
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCONFD/INC
          INC       SINIMPFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMCST   DIM      45 * Scr 00 Fld     4
TOCST     DIM      45 * Scr 00 Fld     5
DAYWEEK   FORM      1 * Scr 00 Fld     6
DDAYWEEK  DIM      10 * Scr 00 Fld     7
EXPTNAME  DIM      40 * Scr 00 Fld     8
REPTFLAG  FORM      1 * Scr 00 Fld     9
CC01      DIM       5 * Scr 00 Fld    11
CC02      DIM       5 * Scr 00 Fld    12
CC03      DIM       5 * Scr 00 Fld    13
CC04      DIM       5 * Scr 00 Fld    14
CC05      DIM       5 * Scr 00 Fld    15
CC06      DIM       5 * Scr 00 Fld    16
CC07      DIM       5 * Scr 00 Fld    17
CC08      DIM       5 * Scr 00 Fld    18
CC09      DIM       5 * Scr 00 Fld    19
CC10      DIM       5 * Scr 00 Fld    20
CD01      DIM      40 * Scr 00 Fld    21
CD02      DIM      40 * Scr 00 Fld    22
CD03      DIM      40 * Scr 00 Fld    23
CD04      DIM      40 * Scr 00 Fld    24
CD05      DIM      40 * Scr 00 Fld    25
CD06      DIM      40 * Scr 00 Fld    26
CD07      DIM      40 * Scr 00 Fld    27
CD08      DIM      40 * Scr 00 Fld    28
CD09      DIM      40 * Scr 00 Fld    29
CD10      DIM      40 * Scr 00 Fld    30
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN63"
PRGNAM    INIT      "Imprest Download                        "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA1,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA2,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA3,"sinimpaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      DEFPAR00
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMCST 
          MOVE      SP70,TOCST   
          MOVE      ZERO,DAYWEEK 
          MOVE      SP70,DDAYWEEK
          MOVE      SP70,EXPTNAME
          MOVE      ZERO,REPTFLAG
          MOVE      SP70,CC01    
          MOVE      SP70,CC02    
          MOVE      SP70,CC03    
          MOVE      SP70,CC04    
          MOVE      SP70,CC05    
          MOVE      SP70,CC06    
          MOVE      SP70,CC07    
          MOVE      SP70,CC08    
          MOVE      SP70,CC09    
          MOVE      SP70,CC10    
          MOVE      SP70,CD01    
          MOVE      SP70,CD02    
          MOVE      SP70,CD03    
          MOVE      SP70,CD04    
          MOVE      SP70,CD05    
          MOVE      SP70,CD06    
          MOVE      SP70,CD07    
          MOVE      SP70,CD08    
          MOVE      SP70,CD09    
          MOVE      SP70,CD10    
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L999,PS00L107,PS00L108:
                            PS00L109,PS00L110,PS00L111,PS00L112:
                            PS00L113,PS00L114,PS00L115,PS00L116:
                            PS00L117,PS00L118,PS00L119,PS00L120:
                            PS00L121,PS00L122,PS00L123,PS00L124:
                            PS00L125,PS00L126
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TOCST,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      DAYWEEK,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      DDAYWEEK,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      EXPTNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      REPTFLAG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CC01,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CC02,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CC03,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      CC04,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      CC05,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      CC06,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      CC07,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      CC08,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      CC09,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      CC10,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      CD01,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      CD02,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      CD03,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CD04,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      CD05,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      CD06,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      CD07,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      CD08,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      CD09,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      CD10,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L006,SF00L105:
                            SF00L106,SF00L006,SF00L107,SF00L108:
                            SF00L109,SF00L110,SF00L111,SF00L112:
                            SF00L113,SF00L114,SF00L115,SF00L116:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L103:
                            SF00L020,SF00L104,SF00L020,SF00L105:
                            SF00L106,SF00L020,SF00L107,SF00L108:
                            SF00L109,SF00L110,SF00L111,SF00L112:
                            SF00L113,SF00L114,SF00L115,SF00L116:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      REPT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCST   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCST,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DDAYWEEK
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KDAYS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      DAYWEEK,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DDAYWEEK,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          STRIP     EXPTNAME
          SFORMAT   VAR,SCPSLEN
          MOVE      EXPTNAME,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,EXPTNAME
          SFORMAT   VAR,127
          ENDSET    EXPTNAME
          APPEND    SP70,EXPTNAME
          RESET     EXPTNAME
          CMATCH    EXITCHAR,EXPTNAME
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,EXPTNAME
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
          ENDIF
          MOVE      EXPTNAME,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,REPTFLAG
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      REPTFLAG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD01    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC01,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD01,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD02    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC02,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD02,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD03    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC03,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD03,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L110
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD04    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
            BRANCH    EXIT,SF00L110,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC04,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD04,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L111
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD05    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
            BRANCH    EXIT,SF00L111,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC05,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD05,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L112
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD06    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
            BRANCH    EXIT,SF00L112,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC06,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD06,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L113
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD07    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
            BRANCH    EXIT,SF00L113,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC07,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD07,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L114
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD08    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L114
            ENDIF
            BRANCH    EXIT,SF00L114,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC08,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD08,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L115
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD09    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L115
            ENDIF
            BRANCH    EXIT,SF00L115,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC09,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD09,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L116
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CD10    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L116
            ENDIF
            BRANCH    EXIT,SF00L116,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CC10,VAR         
          CALL      DISPITEM
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CD10,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Setup Default Parameters
.------------------------------------------------------------
DEFPAR00  MOVE     SP70,STRCST
          MOVE     Z70,ENDCST
          MOVE     "Start",FROMCST
          MOVE     "Finish",TOCST
          MOVE     SP70,CC01
          MOVE     SP70,CC02
          MOVE     SP70,CC03
          MOVE     SP70,CC04
          MOVE     SP70,CC05
          MOVE     SP70,CC06
          MOVE     SP70,CC07
          MOVE     SP70,CC08
          MOVE     SP70,CC09
          MOVE     SP70,CC10
          MOVE     SP70,CD01
          MOVE     SP70,CD02
          MOVE     SP70,CD03
          MOVE     SP70,CD04
          MOVE     SP70,CD05
          MOVE     SP70,CD06
          MOVE     SP70,CD07
          MOVE     SP70,CD08
          MOVE     SP70,CD09
          MOVE     SP70,CD10
          MOVE     ZERO,REPTFLAG
.
          MOVE     CDD,CDAY
          MOVE     CMM,CMON
          MOVE     CYY,CYEAR
          MOVE     CCC,CCENT
          CALL     TODAY000          * Get the Day of the Week 1=Mon
          ADD      ONE,WEEKDAY       * Convert 1=Sun ie Mon = 2
          IF       WEEKDAY=8
            MOVE     ONE,WEEKDAY     * If Day is 8 must be Sun=1
          ENDIF
.
          ADD      TWO,WEEKDAY    * Add Two Working Days
          IF       WEEKDAY=9
            MOVE     "4",WEEKDAY  * Saturday = Wednesday
          ENDIF
          IF       WEEKDAY=8
            MOVE     "3",WEEKDAY  * Friday   = Tuesday
          ENDIF
          IF       WEEKDAY=7
            MOVE     "2",WEEKDAY  * Thursday = Monday
          ENDIF
.
          MOVE     "All      ",DDAYWEEK
          MOVE     WEEKDAY,DAYWEEK
          LOAD     DDAYWEEK,DAYWEEK,DSUN,DMON,DTUE,DWED,DTHU,DFRI,DSAT
          MOVE     "IMPRST",KEY6
          PACK     EXPTNAME,KEY6,PORT
          REP      " 0",EXPTNAME
          RETURN
.------------------------------------------------------------
. TODAY000  : Convert todays date to a day number : 1 Mon to 7 Sun
. Variables : CDAY,CMON,CYEAR,CCENT
. Returns   : WEEKDAY the day number of the week (1-7)
.------------------------------------------------------------
TODAY000  CALL      GFDAY000                    * get first day of given year
          BRANCH    EXIT,TODAY999
.
.------ First day of year exists ------
.
          MOVE      CDAY,DD
          MOVE      CMON,MM
          MOVE      CYEAR,YY
          MOVE      CCENT,CC
          CALL      DMYCON                      * convert to a julian date
.
.------ Calculate the day of the week ------
.
          MOVE      JULDAY,FSTJULDY
          DIV       SEVEN,FSTJULDY
          MULT      SEVEN,FSTJULDY
.
          SUB       FSTJULDY,JULDAY
.
          MOVE      JULDAY,FSTJULDY
          ADD       FSTDAY,FSTJULDY
          SUB       ONE,FSTJULDY
          MOVE      FSTJULDY,WEEKDAY
.
.------ Change to a number from 1 to 7 ------
.
          COMPARE   ZERO,FSTJULDY
          GOTO      TODAY900 IF EQUAL
.
          COMPARE   EIGHT,FSTJULDY
          GOTO      TODAY999 IF LESS
.
          SUB       SEVEN,FSTJULDY
          MOVE      FSTJULDY,WEEKDAY
          GOTO      TODAY999
.
TODAY900  MOVE      SEVEN,WEEKDAY
.
TODAY999  RETURN
.**********************************************************************
.*                               GFDAY000                             *
.*        Routine to get the starting day of a given Year 1979-2013   *
.**********************************************************************
GFDAY000  PACK      KEY4,CCENT,CYEAR
          REP       " 0",KEY4
          MOVE      KEY4,F4
          MOVE      ZERO,EXIT
          SUB       "1978",F4
          BRANCH    F4,GFDAY100,GFDAY200,GFDAY400,GFDAY500,GFDAY600: * 79-83
                       GFDAY700,GFDAY200,GFDAY300,GFDAY400,GFDAY500: * 84-88
                       GFDAY700,GFDAY100,GFDAY200,GFDAY300,GFDAY500: * 89-93
                       GFDAY600,GFDAY700,GFDAY100,GFDAY300,GFDAY400: * 94-98
                       GFDAY500,GFDAY600,GFDAY100,GFDAY200,GFDAY300: * 99-03
                       GFDAY400,GFDAY600,GFDAY700,GFDAY100,GFDAY200: * 04-08
                       GFDAY400,GFDAY500,GFDAY600,GFDAY700,GFDAY200  * 09-13
          MOVE      ONE,EXIT
          GOTO      GFDAY999
GFDAY100  MOVE      ONE,FSTDAY      * Mon
          GOTO      GFDAY999
GFDAY200  MOVE      TWO,FSTDAY      * Tue
          GOTO      GFDAY999
GFDAY300  MOVE      THREE,FSTDAY    * Wed
          GOTO      GFDAY999
GFDAY400  MOVE      FOUR,FSTDAY     * Thu
          GOTO      GFDAY999
GFDAY500  MOVE      FIVE,FSTDAY     * Fri
          GOTO      GFDAY999
GFDAY600  MOVE      SIX,FSTDAY      * Sat
          GOTO      GFDAY999
GFDAY700  MOVE      SEVEN,FSTDAY    * Sun
GFDAY999  RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.----------------------------------------------------------------------
. Process Download File
.----------------------------------------------------------------------
REPT0000  READ      CONTROLF,SIXTY3;*162,SNCOBSEQ,*233,SNCOCAT6
.
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "999",CLNO                   * init last line number
          MOVE      ONE,CNOUNDLN                 * no underlines
          CALL      OPEN0000                     * Create Download File
          BRANCH    EXIT,REPT9999
          DISPLAY   *P1:24,*EL,"Processing ...";
.
          MOVE      ZERO,FOUNDX
          MOVE      DAYWEEK,COUNTDAT             * start at selected day
          IF        ZERO=DAYWEEK
            MOVE      ONE,COUNTDAT               * start at day 1 for ALL
          ENDIF
.
REPT0100  LOAD      DIM10,COUNTDAT,DSUN,DMON,DTUE,DWED,DTHU,DFRI,DSAT
          PACK      KEY50,CC01,CC02,CC03,CC04,CC05,CC06,CC07,CC08,CC09,CC10,SP70
          MATCH     SP70,KEY50                   * Selected CC Only
          GOTO      REPT2000 IF EQUAL            * NO
.
. Selected Cost Centres Only
.------------------------------------------
          MOVE      ZERO,CCNT
REPT1000  ADD       ONE,CCNT
          COMPARE   "11",CCNT
          GOTO      REPT8000 IF EQUAL
.
          LOAD      KEY5,CCNT,CC01,CC02,CC03,CC04,CC05,CC06,CC07,CC08,CC09,CC10
          MATCH     SP70,KEY5
          GOTO      REPT1000 IF EQUAL
          CALL      RDSICA1                      * Read Cost Centre
          BRANCH    OVRCD,REPT1000
          PACK      SICAIMPD,SICAIMPD,SP70       * Setup Imprest Day Flags
          REP       " 0",SICAIMPD                * Make Sure Blanks are 0
          RESET     SICAIMPD,COUNTDAT            * Set to Day of Week
          CMATCH    "1",SICAIMPD                 * Check Flag on for Day
          GOTO      REPT1000 IF NOT EQUAL        * Loop if Not
.
          DISPLAY   *P20:24,*V2LON,SICACODE,*EL;
.
          CALL      WRIT0000                     * print details
          GOTO      REPT1000
.
. Range of Cost Centres
.------------------------------------------
REPT2000  PACK      KEY5,STRCST,SP70
          CALL      RDSICA1                      * Position at From CC
          IF        OVRCD=0
            CALL      RPSICA1
          ENDIF
REPT3000  CALL      RKSICA1                      * get next record
          BRANCH    OVRCD,REPT8000               * end of file ?
          MATCH     SICACODE,ENDCST              * Last CC
          GOTO      REPT8000 IF LESS
.
          PACK      SICAIMPD,SICAIMPD,SP70       * Setup Imprest Day Flags
          REP       " 0",SICAIMPD                * Make Sure Blanks are 0
          RESET     SICAIMPD,COUNTDAT            * Set to Day of Week
          CMATCH    "1",SICAIMPD                 * Check Flag on for Day
          GOTO      REPT3000 IF NOT EQUAL        * Loop if Not
.
          DISPLAY   *P20:24,*V2LON,SICACODE,*EL;
.
          CALL      WRIT0000                     * print details
.
          GOTO      REPT3000                     * get next record
.
REPT8000  COMPARE   ZERO,DAYWEEK                 * All Days 0=Yes
          GOTO      REPT8100 IF NOT EQUAL
          IF        COUNTDAT<7
            ADD       ONE,COUNTDAT               * Next Day
            GOTO      REPT0100                   * Restart Loop
          ENDIF
.
REPT8100  IF        FOUNDX=0
            BEEP
            DISPLAY   *P1:24,*B,*EF,"ERROR: Nothing to Download - ";
            CALL      HITENTER
            CLOSE    EXPORTFL,DELETE
          ELSE
            CALL      TRAN0000
          ENDIF
.
REPT9999  RETURN
.********************************************************************
. HEAD - print report                               Called by PRNT
.********************************************************************
HEAD0000  CALL      HEAD132                      * print heading
          PRINT     "Cost Centre : ",SICACODE,*24,SICADESC:
                    *74,"Imprest Delivery Day : ",DIM10:
                    *N,"File Name   : ",EXPTNAME:
                    *N,"Catalog",*11,"Catalog",*74,"Unit of Issue":
                    *91,"Imprest",*101,"Counted":
                    *N,"Number",*11,"Description",*74,"Part Number":
                    *91,"Quantity",*101,"Stock",*114,"Comments":
                      *N,"-------",*11,"------------------------------":
                                     "------------------------------":
                    *74,"---------------",*91,"--------",*101,"---------":
                    *114,"-----------------"
          CLOCK     TIME,CTIMEIS
          ADD       FOUR,CLNO
HEAD9999  RETURN
.********************************************************************
. WRIT - print data                                 Called by PRNT
.********************************************************************
WRIT0000  MOVE      "999",CLNO                   * init last line number
          PACK      KEY16,SICACODE,SP70
          CALL      RSSIIM3
WRIT1000  CALL      RKSIIM3
          BRANCH    OVRCD,WRIT9999
          MATCH     SICACODE,SIIMCST
          GOTO      WRIT9999 IF NOT EQUAL
          COMPARE   SIIMMAX,ZERO
          GOTO      WRIT1000 IF EQUAL
.
          MOVE      SP70,SIIADES
          MOVE      SP70,SIIAISS
          PACK      KEY7,SIIMCAT,SP70
          CALL      RDSIIA1
          BRANCH    SIIASUS,WRIT1000,WRIT1500,WRIT1000
.
WRIT1500  PACK      KEY27,SIIMCAT,SIIAPSC,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          BRANCH    OVRCD,WRIT2000
          MATCH     SIIMCAT,SIICCAT
          GOTO      WRIT2000 IF NOT EQUAL
          GOTO      WRIT3000
.
WRIT2000  MOVE      SP70,SIICPNO
.
WRIT3000  MOVE      SIIMMAX,QTYFORM8
          MOVE      SIIMMAX,QTYFORM6
          MOVE      SIICPNO,KEY27
          IF        SNCOBSEQ=1
            IF        SNCOCAT6=1
              SQUEEZE   SIIMCAT
              PACK      DIM7,SIIMCAT,SP7
              WRITE     EXPORTFL,SEQ;SICACODE,SIIMSEQ,DIM7,SIIADES,SIIAISS:
                                     QTYFORM6,SICAUY1
            ELSE
              WRITE     EXPORTFL,SEQ;SICACODE,SIIMSEQ,SIIMCAT,SIIADES,SIIAISS:
                                     QTYFORM6,SICAUY1
            ENDIF
          ELSE
            IF        SNCOCAT6=1
              SQUEEZE   SIIMCAT
              PACK      DIM7,SIIMCAT,SP7
              WRITE     EXPORTFL,SEQ;SICACODE,SIIMSEQ,DIM7,SIIADES,SIIAISS:
                                     QTYFORM6
            ELSE
              WRITE     EXPORTFL,SEQ;SICACODE,SIIMSEQ,SIIMCAT,SIIADES,SIIAISS:
                                     QTYFORM6
            ENDIF
          ENDIF
          MOVE      ONE,FOUNDX
.
          IF        REPTFLAG=1
            COMPARE   "55",CLNO                    * end of page ?
            CALL      HEAD0000 IF NOT LESS         * start new page
            PRINT     *1,SIIMCAT,*11,SIIADES,*74,SIIAISS,*91,QTYFORM8:
                      *101,"!",*109,"!":
                      *N,*74,KEY27,*101,"!",*109,"!"
            ADD       TWO,CLNO           * add one to line number
          ENDIF
          GOTO      WRIT1000
.
WRIT9999  RETURN
.------------------------------------------------------------
. Open/Create Downlaod File
.------------------------------------------------------------
OPEN0000  STRIP     EXPTNAME
          ENDSET    EXPTNAME
          APPEND    SP70,EXPTNAME
          RESET     EXPTNAME
          MATCH     SP70,EXPTNAME
          GOTO      OPEN9000 IF EQUAL
.
          STRIP     EXPTNAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      EXPORTFL,EXPTNAME
          TRAPCLR   IO
          BRANCH    OVRCD,OPEN1000
.
OPEN0100  BEEP
          KEYIN     *P1:24,*EL,"Export File Already Exists. Overwrite (":
                    *V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MOVE      ONE,EXIT
          MATCH     "N",ANS
          GOTO      OPEN9999 IF EQUAL
          MATCH     "Y",ANS
          GOTO      OPEN0100 IF NOT EQUAL
          CLOSE     EXPORTFL,DELETE
.
OPEN1000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          PREP      EXPORTFL,EXPTNAME
          TRAPCLR   IO
          BRANCH    OVRCD,OPEN9100
          MOVE      ZERO,EXIT
          GOTO      OPEN9999
.
OPEN9000  BEEP
          MOVE      "Download File Name MUST be Specified - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      OPEN9999
.
OPEN9100  BEEP
          MOVE      "Unable to Create Export File - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      OPEN9999
.
OPEN9999  RETURN
.--------------------------------------------------------------------------
. Execute Transfer Script eg softerm
.--------------------------------------------------------------------------
TRAN0000
.          MOVE     "pccopy stoclist",KEY40
.          KEYIN    *P1:24,*EL,"Transfer to Execute : ",*V2LON,*RV,KEY40
.          ENDSET   KEY40
.          APPEND   SP70,KEY40
.          RESET    KEY40
.          MATCH    SP70,KEY40
.          GOTO     TRAN0000 IF EQUAL
.          DISPLAY  *P67:24,*EL,"Ok (",*V2LON,"Y",*HOFF,"/":
.                              *V2LON,"N",*HOFF,") ? "
.          MOVE     "24",CVERT
.          MOVE     "78",CCOL
.          MOVE     YES,DEFYESNO
.          CALL     YORN0000
.          COMPARE  ZERO,FYESNO
.          GOTO     TRAN0000 IF EQUAL   *  Not ok
.
          CLEAR    KEY80
          APPEND   "ibasin63.us1 ",KEY80
          APPEND   EXPTNAME,KEY80
          APPEND   ".txt",KEY80
          RESET    KEY80
          MOVE     ZERO,HLEF
          CALL     GETSCR00
.
          EXECUTE  KEY80,TASKID        * Execute Transfer Command
.
          CALL     PUTSCR00
.
.          DISPLAY  *P1:24,*EL,"Transfer Ok (":
.                              *V2LON,"Y",*HOFF,"/":
.                              *V2LON,"N",*HOFF,") ? "
.          MOVE     "24",CVERT
.          MOVE     "21",CCOL
.          MOVE     YES,DEFYESNO
.          CALL     YORN0000
.          COMPARE  ZERO,FYESNO,
.          GOTO     TRAN0000 IF EQUAL   *  Not ok
.
          CLOSE    EXPORTFL,DELETE
.
TRAN9999  RETURN
.
.------------------------------------------------------------
. Input Cost Centre Range
.------------------------------------------------------------
RCOST000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           CALL     KSICAA00
           BRANCH   EXIT,RCOST100,RCOST999
           MOVE     SICACODE,STRCST
           PACK     FROMCST,SICACODE,SP1,SICADESC
           GOTO     RCOST140
.
RCOST100   MOVE     "Start             ",FROMCST
           MOVE     SP70,STRCST
.
RCOST140   MOVE     FROMCST,VAR
           CALL     DISPITEM
.
RCOST150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           CALL     KSICAA00
           BRANCH   EXIT,RCOST200,RCOST999
           MOVE     SICACODE,ENDCST
           PACK     TOCST,SICACODE,SP1,SICADESC
           MATCH    STRCST,ENDCST
           GOTO     RCOST999 IF EQUAL
           GOTO     RCOST999 IF NOT LESS
           BEEP
           MOVE     "To Cost Centre Must Be > From Cost Centre - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCOST000
.
RCOST200   MOVE     "Finish             ",TOCST
           MOVE     "~~",ENDCST
.
RCOST999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN

.----------------------------------------------------------------------
. keyin day of week
.----------------------------------------------------------------------
KDAYS000  PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
          DISPLAY   *P1:24,*V2LON:
                    "1",*HOFF," = Sun, ",*V2LON:
                    "2",*HOFF," = Mon, ",*V2LON:
                    "3",*HOFF," = Tue, ",*V2LON:
                    "4",*HOFF," = Wed, ",*V2LON:
                    "5",*HOFF," = Thu, ",*V2LON:
                    "6",*HOFF," = Fri, ",*V2LON:
                    "7",*HOFF," = Sat";
.
KDAYS100  KEYIN     *PCCOL:CVERT,"_":
                    *PCCOL:CVERT,*V2LON,DAYWEEK
          LOAD      DDAYWEEK,DAYWEEK,DSUN,DMON,DTUE,DWED,DTHU,DFRI,DSAT
          BRANCH    DAYWEEK,KDAYS900,KDAYS900,KDAYS900,KDAYS900,KDAYS900:
                            KDAYS900,KDAYS900
          BEEP
          GOTO      KDAYS100
.
KDAYS900  MOVE      ZERO,EXIT
          GOTO      KDAYS999
.
KDAYS999  CALL      MESSAGE3
          RETURN
.
.------------------------------------------------------------
. Enter Cost Centre 1 to 10
.------------------------------------------------------------
ECOST000  MOVE     SCPSITM,F5
          ASSIGN   F5-10,F2
          STORE    SP70,F2,CC01,CC02,CC03,CC04,CC05:
                           CC06,CC07,CC08,CC09,CC10
          STORE    SP70,F2,CD01,CD02,CD03,CD04,CD05:
                           CD06,CD07,CD08,CD09,CD10
          MOVE     ZERO,CKEYTYP
          CALL     KSICAA00
          BRANCH   EXIT,ECOST999,ECOST999
          MOVE     SCPSITM,F5
          ASSIGN   F5-10,F2
          STORE    SICACODE,F2,CC01,CC02,CC03,CC04,CC05:
                               CC06,CC07,CC08,CC09,CC10
          STORE    SICADESC,F2,CD01,CD02,CD03,CD04,CD05:
                               CD06,CD07,CD08,CD09,CD10
ECOST999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCIAIO/INC
          INC       SINCICIO/INC
          INC       SINIMPIO/INC
.
          INC       STDGENCD
.
