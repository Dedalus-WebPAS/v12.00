.------------------------------------------------------------
. ESIS History Details
.------------------------------------------------------------
WESI0000  BRANCH    FLDITMNO,WESI0100,WESI0200,WESI0300,WESI0400,WESI0500:
                             WESI0600,WESI0700,WESI0800,WESI0900,WESI1000:
                             WESI1100,WESI1200,WESI1300,WESI1400,WESI1500:
                             WESI1600,WESI1700,WESI1800,WESI1900,WESI2000:
                             WESI2100,WESI2200,WESI2300,WESI2400,WESI2500:
                             WESI2600,WESI2700,WESI2800,WESI2900,WESI3000:
                             WESI3100,WESI3200,WESI3300,WESI3400,WESI3500:
                             WESI3600
          WRITE     HTMLFILE;"Invalid Tag";
          GOTO      WESI9999
.
WESI0100  MATCH     SP70,WTEIUNIQ   *   Unique key                         
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIUNIQ;
          GOTO      WESI9999
.
WESI0200  MATCH     SP70,WTEIDATE   *   Date of Extract                    
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI0300  MATCH     SP70,WTEIURNO   *   U/R no                             
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIURNO;
          GOTO      WESI9999
.
WESI0400  MATCH     SP70,WTEIMEDC   *   Medicare number                    
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIMEDC;
          GOTO      WESI9999
.
WESI0500  MATCH     SP70,WTEIMEDS   *   Medicare suffix                    
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIMEDS;
          GOTO      WESI9999
.
WESI0600  MATCH     SP70,WTEIWTNO   *   W/L counter                        
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIWTNO;
          GOTO      WESI9999
.
WESI0700  MATCH     SP70,WTEIDOB    *   DOB (ddmmccyy)                     
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIDOB,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI0800  MATCH     SP70,WTEISEX    *   Sex                                
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEISEX ;
          GOTO      WESI9999
.
WESI0900  MATCH     SP70,WTEIPSTC   *   Postcode                           
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIPSTC;
          GOTO      WESI9999
.
WESI1000  MATCH     SP70,WTEILOCA   *   Locality                           
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEILOCA;
          GOTO      WESI9999
.
WESI1100  MATCH     SP70,WTEIPROC   *   Procedure code indicator           
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIPROC;
          GOTO      WESI9999
.
WESI1200  MATCH     SP70,WTEISRGS   *   Surgical speciality                
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEISRGS;
          GOTO      WESI9999
.
WESI1300  MATCH     SP70,WTEICLCT   *   Clinical urgency category          
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEICLCT;
          GOTO      WESI9999
.
WESI1400  MATCH     SP70,WTEIILOS   *   Intended LOS                       
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIILOS;
          GOTO      WESI9999
.
WESI1500  MATCH     SP70,WTEIDTRG   *   Date of registration (ddmmccyy)    
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIDTRG,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI1600  MATCH     SP70,WTEISRCR   *   Source referral                    
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEISRCR;
          GOTO      WESI9999
.
WESI1700  MATCH     SP70,WTEIREFH   *   Referring hospital                 
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIREFH;
          GOTO      WESI9999
.
WESI1800  MATCH     SP70,WTEICLDT   *   Clinical urgency cat last date (ddm
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEICLDT;
          GOTO      WESI9999
.
WESI1900  MATCH     SP70,WTEIDTIN   *   Date of Last Clinical Urgency Incre
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIDTIN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI2000  MATCH     SP70,WTEICLCD   *   Clinical urgency category last code
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEICLCD;
          GOTO      WESI9999
.
WESI2100  MATCH     SP70,WTEILTST   *   Patient listing status             
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEILTST;
          GOTO      WESI9999
.
WESI2200  MATCH     SP70,WTEIPSDT   *   Patient listing status last date (d
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIPSDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI2300  MATCH     SP70,WTEIRFCS   *   Reason for NRFC Status             
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIRFCS;
          GOTO      WESI9999
.
WESI2400  MATCH     SP70,WTEIBKDT   *   Booking date (ddmmccyy)            
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIBKDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI2500  MATCH     SP70,WTEIBKNO   *   Booking U/R no count               
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIBKNO;
          GOTO      WESI9999
.
WESI2600  MATCH     SP70,WTEIREBK   *   Reason for rebooking               
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIREBK;
          GOTO      WESI9999
.
WESI2700  MATCH     SP70,WTEISCDT   *   Date scheduled for admin (ddmmccyy)
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEISCDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI2800  MATCH     SP70,WTEIDTRM   *   Date of removal (ddmmccyy)         
          GOTO      WESI9999 IF EQUAL
          UNPACK    WTEIDTRM,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      WESI9999
.
WESI2900  MATCH     SP70,WTEIRREM   *   Reason for removal                 
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIRREM;
          GOTO      WESI9999
.
WESI3000  MATCH     SP70,WTEIINSD   *   Insurance declaration              
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIINSD;
          GOTO      WESI9999
.
WESI3100  MATCH     SP70,WTEITRND   *   Transfer Destination               
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEITRND;
          GOTO      WESI9999
.
WESI3200  MATCH     SP70,WTEINRFC   *   Total not ready for care days      
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEINRFC;
          GOTO      WESI9999
.
WESI3300  MATCH     SP70,WTEINRRE   *   Total not ready for care days since
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEINRRE;
          GOTO      WESI9999
.
WESI3400  MATCH     SP70,WTEINRLC   *   Total NRFC days following Last Clin
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEINRLC;
          GOTO      WESI9999
.
WESI3500  MATCH     SP70,WTEIHOSP   *   Hospital initiated postponement    
          GOTO      WESI9999 IF EQUAL
          WRITE     HTMLFILE;WTEIHOSP;
          GOTO      WESI9999
.
WESI3600  CALL      ESITAB00
          GOTO      WESI9999
.
WESI9999  RETURN
.
ESITAB00  MOVE      WTWMUNIQ,F8
          MOVE      F8,SAVKEY8
          REP       " 0",SAVKEY8
          PACK      KEY16,SAVKEY8,SP70
          CALL      RSWTESI1
ESITAB10  CALL      RKWTESI1
          BRANCH    OVRCD,ESITAB99
          MATCH     SAVKEY8,WTEIUNIQ
          GOTO      ESITAB99 IF NOT EQUAL
.
          CLEAR     HTMLLINK
          APPEND    "javascript:LinkTo('",HTMLLINK
          APPEND    WTEIUNIQ,HTMLLINK
          APPEND    WTEIDATE,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
.
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",WTEIUNIQ,"#",":       * 1
                             "#"",WTEIDATE,"#",":       * 2
                             "#"",WTEIMEDC,"#",":       * 3
                             "#"",WTEIMEDS,"#",":       * 4
                             "#"",WTEIWTNO,"#",":       * 5
                             "#"",WTEIDOB,"#",":        * 6
                             "#"",WTEISEX,"#",":        * 7
                             "#"",WTEIPSTC,"#",":       * 8
                             "#"",WTEILOCA,"#",":       * 9
                             "#"",WTEIPROC,"#",":       * 10
                             "#"",WTEISRGS,"#",":       * 11
                             "#"",WTEICLCT,"#",":       * 12
                             "#"",WTEIILOS,"#",":       * 13
                             "#"",WTEIDTRG,"#",":       * 14
                             "#"",WTEISRCR,"#",":       * 15
                             "#"",WTEIREFH,"#",":       * 16
                             "#"",WTEICLDT,"#",":       * 17
                             "#"",WTEIDTIN,"#",":       * 18
                             "#"",WTEICLCD,"#",":       * 19
                             "#"",WTEILTST,"#",":       * 20
                             "#"",WTEIPSDT,"#",":       * 21
                             "#"",WTEIRFCS,"#",":       * 22
                             "#"",WTEIBKDT,"#",":       * 23
                             "#"",WTEIBKNO,"#",":       * 24
                             "#"",WTEIREBK,"#",":       * 25
                             "#"",WTEISCDT,"#",":       * 26
                             "#"",WTEIDTRM,"#",":       * 27
                             "#"",WTEIRREM,"#",":       * 28
                             "#"",WTEIINSD,"#",":       * 29
                             "#"",WTEITRND,"#",":       * 30
                             "#"",WTEINRFC,"#",":       * 31
                             "#"",WTEINRRE,"#",":       * 32
                             "#"",WTEINRLC,"#",":       * 33
                             "#"",WTEIHOSP,"#");"        * 34
          GOTO      ESITAB10
.
ESITAB99  RETURN
