.V5.02.00  11/10/94  Rob Leonard   Check that all ten chars are in use
.
.      Subroutine to check the Medicare No in PMEDI to make sure it was valid
.            OVRCD = 1 indicates that it is not a valid Medicare number
.
CHKMEDI   RESET        PMEDI
          RESET        DIM8
          MOVE         "13791379",DIM8
          MOVE         ZERO,OVRCD
          MOVE         ZERO,CHECK
          MOVE         ZERO,COUNT
.
          TYPE         PMEDI
          GOTO         RETMEDO IF NOT EQUAL
.
MEDILP1   ADD          ONE,COUNT
          COMPARE      NINE,COUNT
          GOTO         ENDMEDI IF NOT LESS
.
          MOVE         PMEDI,DIM1
          MOVE         DIM1,VAR1
          MOVE         VAR1,VAR2
          MOVE         DIM8,DIM1
          MOVE         DIM1,VAR1
          MULTIPLY     VAR1,VAR2
          ADD          VAR2,CHECK
          BUMP         PMEDI
          BUMP         DIM8
          GOTO         MEDILP1
.
ENDMEDI   MOVE         CHECK,CHECKA
          DIV          TEN,CHECKA
          MULTIPLY     TEN,CHECKA
          SUB          CHECKA,CHECK
          MOVE         CHECK,VAR1
          MOVE         VAR1,DIM1
          CMATCH       PMEDI,DIM1
          GOTO         RETMEDI IF EQUAL
RETMEDO   MOVE         ONE,OVRCD
.
RETMEDI   RESET         PMEDI
          RESET         DIM8
          RETURN
