.******************************************************************************
.* EOCACCDS.PBL - display entries in the ACC file.
.******************************************************************************
EOCACCDS  DISPLAY   *P1:4,*EF,*P1:4,*V2LON,*ULON,"ACC Number          ":
                                          *P22:4,"U/R Number":
                                          *P33:4,"Approval":
                                          *P42:4,"Accident Date"
          MOVE      FIVE,CVERT
          MOVE      ONE,CCOL
.
          PACK      KEY20,SP20
          CALL      RSECACC1
DSAC1000  CALL      RKECACC1
          BRANCH    OVRCD,DSAC2000
.
          PACK      KEY33,ECACACCN,SP20,SP20
          CALL      RSECREF3
          CALL      RKECREF3
          BRANCH    OVRCD,DSAC1000
.
          MATCH     ECACACCN,ECRFACCN
          GOTO      DSAC1000 IF NOT EQUAL
. 
          BRANCH    DCLOSEOC,DSAC1100
          BRANCH    ECRFSTAT,DSAC1000
.
DSAC1100  MOVE      DNO,DIM3
          LOAD      DIM3,ECACACCA,DYES
.
          UNPACK    ECACDACC,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          DISPLAY   *P1:CVERT,*V2LON,ECACACCN,*HOFF:
                              *P22:CVERT,ECRFURNO:
                              *P33:CVERT,DIM3:
                              *P42:CVERT,CPCDATE
.
          ADD       ONE,CVERT
          COMPARE   TWENTY4,CVERT
          GOTO      DSAC1000 IF LESS
.
DSAC1300  BRANCH    CNEWDS,DSAC1500
          KEYIN     *P1:24,*EL," (",*V2LON,"E",*HOFF,")xit, (":
                    *V2LON,"F",*HOFF,")irst Screen, (":
                    *V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
.
          REP       UPPLOW,ANS
          CMATCH    ANSE,ANS
          GOTO      DSAC3000 IF EQUAL
.
          CMATCH    ANSF,ANS
          GOTO      EOCACCDS IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      DSAC1400 IF EQUAL
.
          BEEP
          GOTO      DSAC1300
.
DSAC1400  MOVE      FIVE,CVERT
          MOVE      ONE,CCOL
          DISPLAY   *P1:5,*EF
          GOTO      DSAC1000
.
DSAC1500  KEYIN     *P1:24,*EL," (",*V2LON,"C",*HOFF,")ontinue, (":
                    *V2LON,"F",*HOFF,")irst Screen, (":
                    *V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
.
          REP       UPPLOW,ANS
          CMATCH    ANSC,ANS
          GOTO      DSAC3000 IF EQUAL
.
          CMATCH    ANSF,ANS
          GOTO      EOCACCDS IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      DSAC1700 IF EQUAL
.
          BEEP
          GOTO      DSAC1500
.
DSAC1700  MOVE      FIVE,CVERT
          MOVE      ONE,CCOL
          DISPLAY   *P1:5,*EF
          GOTO      DSAC1000
.
.         End of codes
.
DSAC2000  BRANCH    CNEWDS,DSAC3000
          CALL      HITENTER
.
DSAC3000  MOVE      ZERO,OVRCD
          RETURN
.
