VALCONTR
. ******************************************************************************
.* System         : Patient Billing                                           *
.* Include Name   : VALCONTR.PBL                                              *
.* Author         : J.Tan                                                     *
.* Date           : 02/12/2010                                                *
.* Function       : Routine to validate Contract ID                           *
.*                                                                            *
.* Requires       : KEY6     - Contract ID                                    *
.*                  CEFFDATE - Contract Effective Date Calculation            *
.*                                                                            *
.* Returns        : EXIT  - 0 Valid Contract ID                               *
.*                        - 1 Not valid                                       *
. ******************************************************************************
.         Validate Contract ID
. ******************************************************************************
VCTR0000  MOVE      ZERO,EXIT
          COMPARE   NINE,CFEETYP
          GOTO      VCTR9999 IF EQUAL       * Johns Hopkins
.
          OPEN      PMSCIDA1,"pmscidaf"
.
          MATCH     SP70,CEFFDATE
          GOTO      VCTR9000 IF EQUAL       * Effective date must not be blank
.
          CALL      RDPMCID1
          BRANCH    OVRCD,VCTR9000
.
          MATCH     "1",PMCIDELE            * Deleted?
          GOTO      VCTR9000 IF EQUAL
.
          MATCH     PMCIFDAT,CEFFDATE
          GOTO      VCTR9000 IF LESS
.
          MATCH     SP70,PMCITDAT
          IF        !@EQUAL
            MATCH     CEFFDATE,PMCITDAT
            GOTO      VCTR9000 IF LESS
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      VCTR9999
.
VCTR9000  MOVE      ONE,EXIT
VCTR9999  RETURN
+
