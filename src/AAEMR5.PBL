.
.         AAEMR5
.         ------
.
.         THIS INCLUDE PRINTS THE A & E MR-5 DETAILS
.
.        MR-5 VARIABLES
.
.******************************************************************************
.* Mods     :                                                                 *
.*            V11.00.01 02/04/2020  J.Tan             TSK 0868813             *
.*                      Changed PKNAME to DIM80                               *
.*            V5.07     06/10/98  Jim Stathopoulos                            *
.*                      507 Changes                                           *
.******************************************************************************
.                        V5.01 22/05/89 K.Peak
.                              Fix print of MR5s
.                        V5.02 17/07/90 J.Tan
.                              Fixed case notes.  SRF 105640
.                        V5.03 20/05/91 Steve O'Gorman
.                              Fixed Line Up Routine
.
.DIM1       DIM      1         * initial dgname
.DIM11      DIM      11        * dsname
.KEY5       DIM      5         * adainsur
.KEY6       DIM      6         * adadoct
.KEY8       DIM      8         * adanumb  adaurno
..
.AENUMB     FORM     8         *** AAEDETFD.PBL
.AEDATE     DIM      8
.AETIME     DIM      5
.AEURNO     DIM      6         *** Change into FORM 8 when PATMA1FDuses 8 pos
.AEINSUR    DIM      5
.AESRC      DIM      3
.AESIT      DIM      3
.AEMODE     DIM      3
.AEPREV     DIM      10
.AEDOCT     DIM      13
.AESEEN     DIM      5
.AEDESC     DIM      20
..
.QSNAME     DIM      20        *** PATMA1FDPBL
.QGNAME     DIM      20        * 20 instead of 25 because of space for title
.QTITL      DIM      4
.QADD1      DIM      25
.QADD2      DIM      25
.QSUBRB     DIM      15
.QPOST      DIM      4
.QTELEP     DIM      12
.QSEX       DIM      1
.QBDATE     DIM      8
.QSAGE      FORM     3
.QOCCUP     DIM      14
.QMEDI      DIM      10
.
.SRC4       DIM      4          * thcscod for adasrc
.SIT4       DIM      4          * thcscod for adasit
.MODE4      DIM      4          * thcscod for adamode
.HIGH14     DIM      4          * thcscod for phigh1
.HIGH24     DIM      4          * thcscod for phigh2
.HIGH34     DIM      4          * thcscod for phigh3
.
..
LINUPMR5  DISPLAY   *P1:24,*EL,*P40:24,*V2LON,"** Generating Lineup **";
          CALL      OPNPRINT
          PRINT     *N,*N:
                    *N,*9,"XXXXXXXXXXXXXXXXXXXX":
                    *37,"XXXXXXXXXXXXXXXXXXXX",*58,"XXXX",*65,"999":
                    *71,"99999999":
                    *N,*N:
                    *17,"XXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*17,"XXXXXXXXXXXXXXXXXXXXXXXXX",*43,"XXXXXXXXXXXXXXX":
                    *63,"XXXX",*70,"XXXXXXXXXXXX":
                    *N,*N:
                    *9,"XXXXXXXXXXXXXXXXXXXX",*N:
                    *9,"XXXXXXXXXXXXXXXXXXXXXXXXX",*N:       *** pkadd1
                    *9,"XXXXXXXXXXXXXXXXXXXXXXXXX",*27,"XXXXXXXXXXXXXXX":
                    *43,"XXXX",*N,*N:
                    *9,"XXXXXXXXXXXXXXXXXXXX",*40,"XXXXXXXXXXXXXXXXXXXX",*N:
                    *16,"XXXXXXXXXX":          **
                    *35,"XXXXXXXXXXXXXXXXXXXXXXXXX":
                    *67,"XXXXXXXX",*77,"XXXXX",*N,*N: *** adadate adatime
                    *50,"XXXXXXXXXXXXXX",*N,*N,*N: *** poccup
                    *20,"X",*25,"XXXXXX",*35,"99999999",*49,"XXXX",*55,"XXXX":
                    *62,"XXXX",*75,"XXX":
                    *N,*N,*N,*46,"XXXXXXXXXXXXX",*70,"XXXXX":     *** adaseen
                    *N,*14,"XXXX":
                    *N,*9,"XXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*14,"XXXX":
                    *N,*9,"XXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*14,"XXXX":
                    *N,*9,"XXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N;
.
          CALL      CLSPRINT
          RETURN
.
.
SETLMR5   MOVE      SP1,DIM1
          MOVE      SP20,DIM11
.
          MOVE      ADANUMB,KEY8
          CALL      RDDETA1
          BRANCH    OVRCD OF OVERCOND
.
          MOVE      ADANUMB,AENUMB
          MOVE      ADADATE,AEDATE
          MOVE      ADATIME,AETIME
          MOVE      ADASRC,AESRC
          MOVE      ADASIT,AESIT
          MOVE      ADAMODE,AEMODE
.
          MOVE      SP4,SRC4
          MOVE      SP4,SIT4
          MOVE      SP4,MODE4
          MOVE      SP4,HIGH14
          MOVE      SP4,HIGH24
          MOVE      SP4,HIGH34
.
          PACK      KEY5 WITH CODEH1,PHIGH1
          CALL      RDCODE1
          BRANCH    OVRCD OF HIG2
          MOVE      THCSCOD,HIGH14
HIG2      PACK      KEY5 WITH CODEH2,PHIGH2
          CALL      RDCODE1
          BRANCH    OVRCD OF HIG3
          MOVE      THCSCOD,HIGH24
HIG3      PACK      KEY5 WITH CODEH3,PHIGH3
          CALL      RDCODE1
          BRANCH    OVRCD OF SRC
          MOVE      THCSCOD,HIGH34
.
SRC       PACK      KEY5 WITH CODES,ADASRC
          CALL      RDCODE1
          BRANCH    OVRCD OF SIT
          MOVE      THCSCOD,SRC4
SIT       PACK      KEY5 WITH CODEES,ADASIT
          CALL      RDCODE1
          BRANCH    OVRCD OF MODE
          MOVE      THCSCOD,SIT4
.
MODE      PACK      KEY5 WITH CODEEA,ADAMODE
          CALL      RDCODE1
          BRANCH    OVRCD OF PREV
          MOVE      THCSCOD,MODE4
.
PREV      MOVE      SP10,AEPREV
          MATCH     SP3,ADAPREV
          GOTO      TMSEEN IF EQUAL
.
          PACK      KEY5 WITH CODEEP,ADAPREV
          CALL      RDCODE1
          BRANCH    OVRCD OF TMSEEN
.
          MOVE      TDESC,AEPREV
.
TMSEEN    MOVE      ADASEEN,AESEEN
.
          MOVE      ADADOCT,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD OF SPADOC
          MOVE      DGNAME,DIM1
          MOVE      DSNAME,DIM11
          PACK      AEDOCT WITH DIM1,DOT,DIM11
          RESET     AEDOCT
KAEINS    PACK      AEINSUR WITH CODEU1,ADAINSUR
          RESET     AEINSUR
.
          MOVE      AEINSUR,KEY5
          CALL      RDCODE1
          BRANCH    OVRCD OF SPADESC
          MOVE      TDESC,AEDESC
KAEURN    RESET     KEY8
.
          MOVE      ADAURNO,PURNO         *** Change when PATMA1A1 uses 8 pos.
          MOVE      PURNO,KEY8            *** for PURNO instead of 6 posit.
          CALL      RDMAST1
          BRANCH    OVRCD OF SPAPAT
          MOVE      KEY8,AEURNO
          MOVE      PSNAME,QSNAME
          MOVE      PGNAME,QGNAME
          MOVE      PTITL,QTITL
          MOVE      PSAGE,QSAGE
          MOVE      PADD1,QADD1
          MOVE      PADD2,QADD2
          MOVE      PSUBRB,QSUBRB
          MOVE      PPOST,QPOST
          MOVE      PTELEP,QTELEP
          MOVE      PBDATE,QBDATE
          MOVE      PSEX,QSEX
          MOVE      PMEDI,QMEDI
          MOVE      POCCUP,QOCCUP
          MOVE      PLOCDOC,QLOCDOC
          MOVE      SP3,DCASE
          BRANCH    PCASE OF YESCASE
          GOTO      KRESP
.
YESCASE   MOVE      ASK,DCASE
.
KRESP     MOVE      ADANUMB,PKADMN
          MOVE      PKADMN,KEY8
.
          CALL      RDRESP1              *** read patresp  , key8=adaurno
          COMPARE   ONE,OVRCD
          CALL      SPARESP IF EQUAL
.
          MOVE      SP3,WCDESC
          MOVE      SP3,VADESC
.
          UNPACK    SP5 WITH TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
          PACK      KEY5 WITH CODECL,ADACOMP
          CALL      RDCODE1
.
          MOVE      ZERO,FORM2
GETCLL4   ADD       ONE,FORM2
          COMPARE   SIX,FORM2
          GOTO      ENDCLM4 IF NOT LESS
.
          LOAD      ANS USING FORM2 OF TCINDC1,TCINDC2,TCINDC3:
                                       TCINDC4,TCINDC5
.
          CMATCH    ANSW TO ANS
          GOTO      CLWCO4 IF EQUAL
          CMATCH    ANSM TO ANS
          GOTO      CLMAB4 IF EQUAL
.
          GOTO      GETCLL4
.
CLWCO4    MOVE      "WCA",WCDESC
          GOTO      GETCLL4
.
CLMAB4    MOVE      "VA ",VADESC
          GOTO      GETCLL4
.
ENDCLM4   RETURN
.
PRTMR5    CALL      OPNPRINT
.
          UNPACK    PKNAME,KEY60
          PRINT     *N,*N:
                    *N,*9,QSNAME:
                    *37,QGNAME,*58,QTITL,*65,QSAGE,*71,AEURNO,*79,DCASE:
                    *N,*N,*17,QADD1:
                    *N,*17,QADD2,*43,QSUBRB,*63,QPOST,*70,QTELEP,*N,*N:
                    *9,KEY60,*70,VADESC,*74,WCDESC,*N:
                    *9,PKADD1,*N:
                    *9,PKADD2,*35,PKSUBR,*51,PKPOST,*N,*N:
                    *9,AEDESC,*40,ADAEMPL,*N:
                    *16,QMEDI,*40,ADASUBR;
          MOVE      "67",CCOL
          UNPACK    AEDATE INTO CCENT,CYEAR,CMON,CDAY
          CALL      PRTDATE
          PRINT     *77,AETIME,*N,*N:
                    *9,QLOCDOC,*50,QOCCUP,*N,*N:
                    *20,QSEX;
          MOVE      "25",CCOL
          UNPACK    QBDATE INTO CCENT,CYEAR,CMON,CDAY
          CALL      PRTDATE
          PRINT     *35,AENUMB,*49,SRC4,*55,SIT4,*62,MODE4,*75,AEPREV:
                    *N,*N,*N,*46,AEDOCT,*70,AESEEN:
                    *N,*14,HIGH14:
                    *N,*9,DESCH1:
                    *N,*N,*N:
                    *N,*14,HIGH24:
                    *N,*9,DESCH2:
                    *N,*N,*N:
                    *N,*14,HIGH34:
                    *N,*9,DESCH3:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N;
.
          CALL      CLSPRINT
          RETURN
.
SPADOC    PACK      AEDOCT WITH SP10,SP3
          GOTO      KAEINS
.
SPADESC   MOVE      SP20,AEDESC
          GOTO      KAEURN
.
SPAPAT    MOVE      SP8,AEURNO
          MOVE      SP20,QSNAME
          PACK      QGNAME WITH SP20,SP5
          MOVE      ZERO,QSAGE
          PACK      QADD1 WITH SP20,SP5
          PACK      QADD2 WITH SP20,SP5
          PACK      QSUBRB WITH SP10,SP5
          MOVE      SP4,QPOST
          PACK      QTELEP WITH SP6,SP6
          MOVE      SP8,QBDATE
          MOVE      SP1,QSEX
          MOVE      SP10,QMEDI
          PACK      QOCCUP WITH SP10,SP4
          RESET     QOCCUP
          MOVE      SP3,WCDESC
          MOVE      SP3,VADESC
          GOTO      KRESP
.
SPARESP   PACK      PKNAME,SP70,SP20
          MOVE      SP30,PKADD1
          MOVE      SP30,PKADD2
          MOVE      SP30,PKSUBR
          MOVE      SP4,PKPOST
          MOVE      SP12,PKTELEP
          MOVE      SP12,PKTELEB
          MOVE      SP10,PKRELP
.
          MOVE      SP30,WCNAME
          MOVE      "---",VADESC
          MOVE      "---",WCDESC
          RETURN
.
