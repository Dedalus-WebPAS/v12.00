. *----------------------------------------------------------------------
. * Include Name  :   OPRPRFTM.PBL
. *
. * Function      :   CGI variable functions for OPRPRFFD - oprprfaf.dat
. *
. * Modifications :
. *
. * V9.04.00 25/02/2005 Lina Vo                  CAR 56404
. *          Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear parameters for the item details file
.------------------------------------------------------------------------
CPOPRF00  MOVE      Z70,OPPRF001
          MOVE      Z70,OPPRF002
          MOVE      Z70,OPPRF003
          MOVE      Z70,OPPRF004
          MOVE      Z70,OPPRF005
.
CPOPRF99  RETURN
.
.------------------------------------------------------------
. item details file standard tags
.------------------------------------------------------------
OPRF0000  BRANCH    FLDITMNO,OPRF0010,OPRF0020,OPRF0030,OPRF0040,OPRF0050
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OPRF9999
.
OPRF0010  WRITE     HTMLFILE;OPPRUNIQ;  
          GOTO      OPRF9999
.
OPRF0020  WRITE     HTMLFILE;OPPRTEAM;  
          GOTO      OPRF9999
.
OPRF0030  WRITE     HTMLFILE;OPPRPREF;  
          GOTO      OPRF9999
.
OPRF0040  IF        OPCNCLSU=1
            MOVE      OPPRDCOD,DOCTCODE  * Using Doc & OPRWEB05
            CALL      DOCDET00
          ELSE
            MOVE      OPPRDCOD,KEY6      * Using Clinic File for Session
            CALL      RDOPCLI1
            MOVE      OPCLDOCT,DOCTCODE  * Using Clinic Code & OPRWEB05
            CALL      DOCDET00
          ENDIF
          GOTO      OPRF9999
.
OPRF0050  WRITE     HTMLFILE;OPPRPQTY;
          GOTO      OPRF9999
.
OPRF9999  RETURN
.------------------------------------------------------------
.   Set Parameters for the item details file
.------------------------------------------------------------
SPPRF000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPRF010,SPPRF020,SPPRF030,SPPRF040,SPPRF050
.
          MOVE      ONE,EXIT
          GOTO      SPPRF999
.
SPPRF010  MOVE      QRYDATA,OPPRF001
          GOTO      SPPRF999
.
SPPRF020  MOVE      QRYDATA,OPPRF002
          GOTO      SPPRF999
.
SPPRF030  MOVE      QRYDATA,OPPRF003
          GOTO      SPPRF999
.
SPPRF040  MOVE      QRYDATA,OPPRF004
          GOTO      SPPRF999
.
SPPRF050  MOVE      QRYDATA,OPPRF005
          GOTO      SPPRF999
.
SPPRF999  RETURN
.
.------------------------------------------------------------
.  Update item details file
.------------------------------------------------------------
MVOPRF00  MATCH     OPPRF001,Z70
          IF        !@EQUAL
            MOVE      OPPRF001,OPPRUNIQ
          ENDIF
.
          MATCH     OPPRF002,Z70
          IF        !@EQUAL
            MOVE      OPPRF002,OPPRTEAM
          ENDIF
.
          MATCH     OPPRF003,Z70
          IF        !@EQUAL
            MOVE      OPPRF003,OPPRPREF
          ENDIF
.
          MATCH     OPPRF004,Z70
          IF        !@EQUAL
            MOVE      OPPRF004,OPPRDCOD
          ENDIF
.
          MATCH     OPPRF005,Z70
          IF        !@EQUAL
            MOVE      OPPRF005,OPPRPQTY
          ENDIF
.
MVOPRF99  RETURN
.
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLOPRF00  MOVE      SP70,OPPRUNIQ  * Unique id
          MOVE      SP70,OPPRTEAM  * Team Number
          MOVE      SP70,OPPRPREF  * Preference
          MOVE      SP70,OPPRDCOD  * Doctor Code      
          MOVE      ZERO,OPPRPQTY  * Quantity
.
CLOPRF99  RETURN
