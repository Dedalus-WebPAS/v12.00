. *----------------------------------------------------------------------
. * Include Name  :   EMRACCTM.PBL
. *
. * Function      :   CGI Variables for EMRACCFD - emracaaf
. *
. * Mods          :
. *
. *       V11.01.00 31/05/2021 DA Sarkies        TSK 0905306
. *                Created include
. *       V11.01.01 01.09.2021 DA Sarkies        TSK 0905306
. *                Added extra section to obtain value of infinity
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------------------
CPEMAC00  MOVE      Z70,EMACC001
          MOVE      Z70,EMACC002
          MOVE      Z70,EMACC003
          MOVE      Z70,EMACC004
          MOVE      ZERO,EMACC005
          MOVE      ZERO,EMACC006
          MOVE      Z70,EMACC007
          PACK      EMACC007,Z70,Z70
          MOVE      Z70,EMACC008
.
CPEMAC99  RETURN
.
.------------------------------------------------------------
. Set variables for AECC Coefficents for ECDG Complex
.------------------------------------------------------------
SPEMAC00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMAC01,SPEMAC02,SPEMAC03,SPEMAC04,SPEMAC05,SPEMAC06:
                    SPEMAC07,SPEMAC08,SPEMAC09
          GOTO      SPEMAC99
.
SPEMAC01  PACK      EMACC001,QRYDATA,SP70
          GOTO      SPEMAC99
.
SPEMAC02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMACC002,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMAC99
.
SPEMAC03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMACC003,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMAC99
.
SPEMAC04  PACK      EMACC004,QRYDATA,SP70
          GOTO      SPEMAC99
.
SPEMAC05  MOVE      QRYDATA,EMACC005
          GOTO      SPEMAC99
.
SPEMAC06  MOVE      QRYDATA,EMACC006
          GOTO      SPEMAC99
.
SPEMAC07  PACK      EMACC007,QRYDATA,SP70
          GOTO      SPEMAC99
.
SPEMAC08  PACK      EMACC008,QRYDATA,SP70,SP70
          GOTO      SPEMAC99
.
SPEMAC09  PACK      EMACC009,QRYDATA,SP70
          GOTO      SPEMAC99
.
SPEMAC99  RETURN
.
.------------------------------------------------------------
. Tags for AECC Coefficients for ECDG Complex
.------------------------------------------------------------
EMAC0000  BRANCH    FLDITMNO,EMAC0100,EMAC0200,EMAC0300,EMAC0400,EMAC0500:
                    EMAC0600,EMAC0700,EMAC0800,EMAC0900,EMAC1000,EMAC1100:
                    EMAC1200,EMAC1300,EMAC1400,EMAC1500,EMAC1600
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMAC9999
.
EMAC0100  WRITE     HTMLFILE;EMACCODE;
          GOTO      EMAC9999
.
EMAC0200  MATCH     EMACFDAT,SP70             * effective date from
          GOTO      EMAC9999 IF EQUAL
          UNPACK    EMACFDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAC9999
.
EMAC0300  MATCH     EMACTDAT,SP70             * effective date to
          GOTO      EMAC9999 IF EQUAL
          UNPACK    EMACTDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAC9999
.
EMAC0400  WRITE     HTMLFILE;EMACCLAS;
          GOTO      EMAC9999
.
EMAC0500  WRITE     HTMLFILE;EMACDESC;
          GOTO      EMAC9999
.
EMAC0600  WRITE     HTMLFILE;EMACMINS;
          GOTO      EMAC9999
.
EMAC0700  WRITE     HTMLFILE;EMACMAXS;
          GOTO      EMAC9999
.
EMAC0800  WRITE     HTMLFILE;EMACMXSI;
          GOTO      EMAC9999
.
EMAC0900  MATCH     EMACCDAT,SP70             * Date Created     
          GOTO      EMAC9999 IF EQUAL
          UNPACK    EMACCDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAC9999
.
EMAC1000  WRITE     HTMLFILE;EMACCTIM;
          GOTO      EMAC9999
.
EMAC1100  WRITE     HTMLFILE;EMACCUID;
          GOTO      EMAC9999
.
EMAC1200  MATCH     EMACUDAT,SP70             * Date Updated     
          GOTO      EMAC9999 IF EQUAL
          UNPACK    EMACUDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAC9999
.
EMAC1300  WRITE     HTMLFILE;EMACUTIM;
          GOTO      EMAC9999
.
EMAC1400  WRITE     HTMLFILE;EMACUUID;
          GOTO      EMAC9999
.
EMAC1500  WRITE     HTMLFILE;EMACAFLG;
          GOTO      EMAC9999
.
EMAC1600  WRITE     HTMLFILE;EMACMXSI;
          GOTO      EMAC9999
.
EMAC9999  RETURN
.
.------------------------------------------------------------
. Moved cgi variables to file variables
.------------------------------------------------------------
MVEMAC00  MATCH      Z70,EMACC001
          IF         !@EQUAL
            MOVE       EMACC001,EMACCODE
          ENDIF
.
          MATCH      Z70,EMACC002
          IF         !@EQUAL
            MOVE       EMACC002,EMACFDAT
          ENDIF
.
          MATCH      Z70,EMACC003
          IF         !@EQUAL
            MOVE       EMACC003,EMACTDAT
          ENDIF
.
          MATCH      Z70,EMACC004
          IF         !@EQUAL
            MOVE       EMACC004,EMACCLAS
          ENDIF
.
          COMPARE    ZERO,EMACC005
          IF         !@EQUAL
            MOVE       EMACC005,EMACMINS
          ENDIF
.
          COMPARE    ZERO,EMACC006
          IF         !@EQUAL
            MOVE       EMACC006,EMACMAXS
          ENDIF
.
          MATCH      Z70,EMACC007
          IF         !@EQUAL
            MOVE       EMACC007,EMACAFLG
          ENDIF
. 
          MATCH      Z70,EMACC008
          IF         !@EQUAL
            MOVE       EMACC008,EMACDESC
          ENDIF
. 
          MATCH      Z70,EMACC009
          IF         !@EQUAL
            MOVE       EMACC009,EMACMXSI
          ENDIF
.
MVEMAC99  RETURN
