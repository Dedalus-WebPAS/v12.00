. *----------------------------------------------------------------------
. * Include Name  :   PRIWCOTM.PBL
. *
. * Function      :   CGI Variables for PRIWCOFD - priwcomf 
. *
. * Mods          :   
. *                   V10.00.01 25/05/2010  Mike Laming       CAR 169939
. *                            Add test for "Active" (PTINACTV) flag at PRWC0825
. *                   V9.03.01 23/04/2004 Ebon Clements   CAR 49200
. *                            Removed SQUEEZE from PRCOM001
. *                   V9.03.00 18/02/04 J.Tan
. *                            Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for doctor referral
.------------------------------------------------------------------------
CPPRWC00  MOVE      SP70,PRCOM001
          MOVE      SP70,PRCOM002 
          MOVE      SP70,PRCOM003
          MOVE      SP70,PRCOM004
          MOVE      SP70,PRCOM005
          MOVE      SP70,PRCOM006
          MOVE      ZERO,PRCOM007
          MOVE      SP70,PRCOM008
          MOVE      SP70,PRCOM009
          MOVE      SP70,PRCOM010
          MOVE      SP70,PRCOM011
          MOVE      SP70,PRCOM012
.
CPPRWC99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Doctor referral file
.------------------------------------------------------------
SPPRWC00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPRWC01,SPPRWC02,SPPRWC03,SPPRWC04,SPPRWC05:
                       SPPRWC06,SPPRWC07,SPPRWC08,SPPRWC09,SPPRWC10:
                       SPPRWC11,SPPRWC12
.
          MOVE      ONE,EXIT
          GOTO      SPPRWC99
.
SPPRWC01  MOVE      QRYDATA,PRCOM001
          GOTO      SPPRWC99
.
SPPRWC02  MOVE      QRYDATA,PRCOM002
          GOTO      SPPRWC99
.
SPPRWC03  MOVE      QRYDATA,PRCOM003 
          GOTO      SPPRWC99 
.
SPPRWC04  MOVE      QRYDATA,PRCOM004 
          GOTO      SPPRWC99
.
SPPRWC05  MOVE      QRYDATA,PRCOM005 
          GOTO      SPPRWC99
.
SPPRWC06  MOVE      QRYDATA,PRCOM006 
          GOTO      SPPRWC99
.
SPPRWC07  MOVE      QRYDATA,PRCOM007 
          GOTO      SPPRWC99
.
SPPRWC08  MOVE      QRYDATA,PRCOM008
          GOTO      SPPRWC99
.
SPPRWC09  MOVE      QRYDATA,PRCOM009 
          GOTO      SPPRWC99 
.
SPPRWC10  MOVE      QRYDATA,PRCOM010 
          GOTO      SPPRWC99  
.
SPPRWC11  MOVE      QRYDATA,PRCOM011
          GOTO      SPPRWC99
.
SPPRWC12  MOVE      QRYDATA,PRCOM012 
          GOTO      SPPRWC99
.
SPPRWC99  RETURN
.------------------------------------------------------------
. Clear General Variables
.------------------------------------------------------------
CLPRWC00  MOVE      SP70,PRWCNAME     * Employer Name
          MOVE      SP70,PRWCADD1     * Employer Address Line 1
          MOVE      SP70,PRWCADD2     * Employer Address Line 2
          MOVE      SP70,PRWCADD3     * Employer Address Line 3
          MOVE      SP70,PRWCPOST     * Employer Postcode
          MOVE      SP70,PRWCTELE     * Employer Telephone
          MOVE      ZERO,PRWCACCP     * Accepted By Insurance Company
          MOVE      SP70,PRWCICOD     * Insurance Company Code
          MOVE      SP70,PRWCCLMN     * Insurance Claim Number
          MOVE      SP70,PRWCTIME     * Accident time
          MOVE      SP70,PRWCCOM1     * Comments Line 1
          MOVE      SP70,PRWCCOM2     * Comments Line 2
CLPRWC99  RETURN
.------------------------------------------------------------
. Add General  Fields
.------------------------------------------------------------
PRWC0000  BRANCH    FLDITMNO,PRWC0100,PRWC0200,PRWC0300,PRWC0400,PRWC0500:
                             PRWC0600,PRWC0700,PRWC0800,PRWC0900,PRWC1000:
                             PRWC1100,PRWC1200
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PRWC9999
.
PRWC0100  WRITE     HTMLFILE;PRWCNAME; 
          GOTO      PRWC9999
.
PRWC0200  WRITE     HTMLFILE;PRWCADD1; 
          GOTO      PRWC9999
.
PRWC0300  WRITE     HTMLFILE;PRWCADD2; 
          GOTO      PRWC9999 
.
PRWC0400  WRITE     HTMLFILE;PRWCADD3; 
          GOTO      PRWC9999 
.
PRWC0500  WRITE     HTMLFILE;PRWCPOST; 
          GOTO      PRWC9999 
.
PRWC0600  WRITE     HTMLFILE;PRWCTELE; 
          GOTO      PRWC9999 
.
PRWC0700  UNPACK    DIM127,D1,KEY1,DIM127    
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PRWC0710,PRWC0720
          WRITE     HTMLFILE;PRWCACCP;
          GOTO      PRWC9999
.
PRWC0710  COMPARE   "1",PRWCACCP 
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ELSE
            WRITE     HTMLFILE;"Yes";
          ENDIF
          GOTO      PRWC9999
.
PRWC0720  IF        PRWCACCP=1
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "No</option>":
                              "<option value=0>":
                              "Yes</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "Yes</option>":
                              "<option value=1>":
                              "No</option>";
          ENDIF
          GOTO      PRWC9999
.
PRWC0800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PRWC0810,PRWC0820
          WRITE     HTMLFILE;PRWCICOD; 
          GOTO      PRWC9999
.
PRWC0810  PACK      KEY6,PRWCICOD,SP70
          CALL      RDINSR1
          IF        OVRCD=0
            WRITE     HTMLFILE;INAME;
          ELSE
            WRITE     HTMLFILE;PRWCICOD;
          ENDIF
          GOTO      PRWC9999
.
PRWC0820  PACK      KEY6,SP10
          CALL      RDSINSR1
PRWC0825  CALL      RDKINSR1
          BRANCH    OVRCD,PRWC9999
.
          MATCH     "1",PTINACTV            * (1=inactive)            *I-169939
          GOTO      PRWC0825 IF EQUAL                                 *I-169939
.
          PACK      KEY8,QUOTE,ICODE,QUOTE
.
          MATCH     PRWCICOD,ICODE 
          IF        @EQUAL
             WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                       "(",ICODE,") ",INAME,"</option>"
          ELSE
             WRITE     HTMLFILE;"<option value=",KEY8,">":
                       "(",ICODE,") ",INAME,"</option>"
          ENDIF
          GOTO      PRWC0825
.
PRWC0900  WRITE     HTMLFILE;PRWCCLMN; 
          GOTO      PRWC9999
.
PRWC1000  WRITE     HTMLFILE;PRWCTIME; 
          GOTO      PRWC9999
.
PRWC1100  WRITE     HTMLFILE;PRWCCOM1;
          GOTO      PRWC9999 
.
PRWC1200  WRITE     HTMLFILE;PRWCCOM2;
          GOTO      PRWC9999 
.
PRWC9999  RETURN
.------------------------------------------------------------
.  move CGI variable to file variable 
.------------------------------------------------------------
MVPRWC00  
.
          MATCH     PRCOM001,SP70
          IF        !@EQUAL
            MOVE      PRCOM001,PRWCNAME
          ENDIF
.
          MATCH     PRCOM002,SP70
          IF        !@EQUAL
            MOVE      PRCOM002,PRWCADD1
          ENDIF
.
          MATCH     PRCOM003,SP70
          IF        !@EQUAL
            MOVE      PRCOM003,PRWCADD2
          ENDIF
.
          MATCH     PRCOM004,SP70
          IF        !@EQUAL
            MOVE      PRCOM004,PRWCADD3
          ENDIF
.
          MATCH     PRCOM005,SP70
          IF        !@EQUAL
            MOVE      PRCOM005,PRWCPOST
          ENDIF
.
          MATCH     PRCOM006,SP70
          IF        !@EQUAL
            MOVE      PRCOM006,PRWCTELE
          ENDIF
.
          COMPARE   ZERO,PRCOM007
          IF        !@EQUAL
            MOVE      PRCOM007,PRWCACCP
          ELSE
            MOVE      ZERO,PRWCACCP
          ENDIF
.
          MATCH     PRCOM008,SP70
          IF        !@EQUAL
            MOVE      PRCOM008,PRWCICOD
          ENDIF
.
          MATCH     PRCOM009,SP70
          IF        !@EQUAL
            MOVE      PRCOM009,PRWCCLMN
          ENDIF
.
          MATCH     PRCOM010,SP70
          IF        !@EQUAL
            MOVE      PRCOM010,PRWCTIME
          ENDIF
.
          MATCH     PRCOM011,SP70
          IF        !@EQUAL
            MOVE      PRCOM011,PRWCCOM1
          ENDIF
.
          MATCH     PRCOM012,SP70
          IF        !@EQUAL
            MOVE      PRCOM012,PRWCCOM2
          ENDIF
.
MVPRWC99  RETURN
.
