.*****************************************************************************
.* System    :   Billing                                                     *
.* Program   :   IBAHMS19                                                    *
.* Desc      :   WEB Invoice Pending Report                                  *
.*****************************************************************************
.* Date      :   29/05/2003                                                  *
.* Author    :   J.Tan                                                       *
.* Function  :   This program will generate invoice pending                  *
.* Mods      :                                                               *
.*                                                                           *
.*---------------------------------------------------------------------------*
.* V12.00.03 30/09/2025  Thanh T         TSK 0937505                         *
.*           Recompiled for PATINVHL changes                                 *
.* V12.00.02 23/06/2025  J.Tan           TSK 0961623                         *
.*           Recompiled for PATINVS - added DDRGCODE for GETDRG              *
.* V12.00.01 19/05/2025 Thanh T         TSK 0955096                          *
.*           Changed for alphanumeric visit number                           *
.*---------------------------------------------------------------------------*
.*        V11.05.01 04/02/2025 J.Tan           TSK 0952533                   *
.*                  Recompiled for PATCATBI - changes for MV using Vent.file *
.*                  14/02/2025 J.Tan           TSK 0946490                   *
.*                  Recompiled for PATCATBI- Changes for MV CWO payment model*
.*                  14/02/2025 J.Tan           TSK 0955356                   *
.*                  Recompiled for PATCALF - writting to Fin.Summary details *
.*        V11.04.12 07/11/2024 Thanh T           TSK 0946085                 *
.*                  Recompiled for RCPCONFD changes                          *
.*        V11.04.11 25/10/2024 J.Tan             TSK 0951578                 *
.*                  Recompiled for ABFPTINV-Added Min.to roundup ICU Hrs(ABF)*
.*        V11.04.10 18/10/2024  Bella Turco    TSK 0947710                   *
.*                  All Theatre Charges column displays N/A when patient not *
.*                  been to theatre (PRTD0000 DSEQ0000)                      *
.*        V11.04.09 23/09/2024  J.Tan          TSK 0949848                   *
.*                  Recompiled for ABFPTINV - DRG List used in for COVID Adj.*
.*        V11.04.08 23/09/2024 J.Tan           TSK 0950577                   *
.*                  Recompiled for PATIPERH - Fixed Hold Invoice audit issue *
.*        V11.04.07 11/09/2024  J.Tan          TSK 0947315                   *
.*                  Recompiled for ABFPTINV - fixed Total Unqualified        *
.*        V11.04.06 07/08/2024  J.Tan            TSK 0939432                 *
.*                  Recompiled for ISBITEMS - zero Item quantity (PTCNISBZ)  *
.*        V11.04.05 01/08/2024  J.Tan          TSK 0947804                   *
.*                  Recompiled for ABFMHINV -Changes for Disch.after 1/7/2023*
.*        V11.04.04 17/07/2024  J.Tan          TSK 0947315                   *
.*                  Recompiled for ABFPTINV (LOS ICU adjusted & Newborn)     *
.*        V11.04.03 15/03/2024  J.Tan          TSK 0910994                   *
.*                  Recompiled for CMXMATRX                                  *
.*        V11.04.02 29/01/2024  Jacob Jackson  TSK 0919335                   *
.*                  Add HF History includes                                  *
.*        V11.04.01 29/01/2024  Jacob Jackson  TSK 0919335                   *
.*                  Add new local variable and recompile for GETTFEES        *
.*        V11.03.10 17/11/2023  J.Tan          TSK 0940089                   *
.*                  Recompiled for ABFPTINV - checking for blank Disc.DRG    *
.*        V11.03.09 13/11/2023  J.Tan          TSK 0939019                   *
.*                  Recompiled for ABFPTINV - HAC ICD10 Edition 12           *
.*        V11.03.08 08/11/2023  Nikitha B      TSK 0927699c                  *
.*                  Read CAPPRVNO and PTCNHABN for Hospital Approval and     *
.*                  ABN number.                                              *
.*        V11.03.07 04/10/2023  Nikitha B     TSK 0927699                    *
.*                  Recomplied for PATINVHL, PATINVTL - Stationary variables *
.*        V11.03.06 04/10/2023  J.Tan          TASK 0938230                  *
.*                  Recompiled for ABFAECCL - Emergency ABF                  *
.*        V11.03.05 29/08/2023  J.Tan          TSK 0916870                   *
.*                  Recompiled for ABFPTINV - Claim code Multiple NEP value  *
.*        V11.03.04 15/06/2023  Bella Turco    TSK 0931756                   *
.*                  Recompiled for PRTINVBD                                  * 
.*        V11.03.03 15/06/2023  J.Tan          TSK 0923703                   *
.*                  Recompiled for ABF new calculations                      *
.*        V11.03.02 30/05/2023  Davin          TSK 0933052                   *
.*                  Added check for CodeFocus InvoiceOnHold reason (CHLD0000)*
.*        V11.03.01 05/04/2023  Bella Turco    TSK 0911166                   *
.*                  Recompiled for PATIPERH - Hold Invoice Audit             *
.*        V11.02.06 10/10/2022  Peter Vela          0925622                  *
.*                  Recompiled for PATINVS - Removed old Eclipse IHC from    *
.*                  Inpatient Invoicing                                      *
.*        V11.02.05 20/07/2022 J.Tan           TSK 0922228                   *
.*                  Mod Checking for Patient Hold invoice                    *
.*        V11.02.04 15/07/2022 J.Tan           TSK 0922228                   *
.*                  Mod to update/check status of Hold invoice               *
.*        V11.02.03 29/06/2022 J.Tan           TSK 0920712                   *
.*                  Recompiled for ABFAECCL - I*D on emrvcdaf file           *
.*        V11.02.02 03/03/2022  J.Tan           TSK 0902652                  *
.*                  Recompiled for OUTCATBI/AAECATBI - New Pat.Invoice       *
.*        V11.02.01 09/02/2022  Thanh T       TSK 0905641                    *
.*                  Recompiled as OUTMA1FD changes                           *
.*        V11.01.15 17/11/2021  J.Tan          TSK 0913621                   *
.*                  Recompiled for ABFPTINV - Mod for Multiple NEP Values    *
.*        V11.01.14 28/10/2021 J.Tan           TSK 0913056                   *
.*                  Recompiled for ABFAECCL-ADMFLAG & CCAR0000(Clinical Care)*
.*        V11.01.13 13/10/2021 J.Tan           TSK 0905305                   *
.*                  Recompiled for ABFAECCL - Adjustment type 068 & 069      *
.*        V11.01.12 29/09/2021  J.Tan          TSK 0901515                   *
.*                  Recompiled for CMXMATRX - Added Primary Proc.to Matrix   *
.*        V11.01.11 14/09/2021  J.Tan          TSK 0906222                   *
.*                  Recompiled for ABFPTINV - Mod for Multiple NEP Values    *
.*        V11.01.10 14/09/2021  Davin           TSK 0911277                  *
.*                  Recompiled for PRTINVBD                                  *
.*        V11.01.09 10/09/2021  Davin           TSK 0911277                  *
.*                  Recompiled for PATINVTL - Changed field 20 length to 12.2*
.*        V11.01.08 24/08/2021  Davin          TSK 0897318                   *
.*                  Recompiled for PATINVTL - added field 57 Adjustment Total*
.*                  25/08/2021  J.Tan           TSK 0905305                  *
.*                  Recompiled for AAECATBI - AE Care class (ABFAECCL)       *
.*                  31/08/2021  J.Tan           TSK 0910799                  *
.*                  Recompiled for PRTINVBD - printing Referring ADF         *
.*        V11.01.07 03/08/2021  J.Tan           TSK 0909724                  *
.*                  Recompiled for PRTINVBD - SJOG invoice                   *
.*        V11.01.06 07/07/2021  J.Tan           TSK 0908588                  *
.*                  Recompiled for PATCATBI -Exclude Unqualified days for C/P*
.*        V11.01.05 16/06/2021  Peter Vela     TSK 0907637                   *
.*                  Recompiled for IBAHMS19                                  *
.*        V11.01.04 28/04/2021  Thanh T        TSK 0895165                   *
.*                  Recompiled for OPRARDFD changes                          *
.*                  01/04/2021  Peter Vela     TSK 0902857                   *
.*                  Recompiled for WEBIHCFD - Added Index 8                  *
.*                  07/04/2021  Tracey Nguyen   TSK 0901515                  *
.*                  Recompiled for PMSCMTFD - Added new fields               *
.*                  a) 1 File type for ICD procedure (PMCCIPF)               *
.*                  b) 3 new CMBS Field Type (PMCCFTS4/PMCCFT5C/PMCCFT6C)    *
.*                  c) 3 new CMBS Codes From (PMCCPC4F,PMCCSC5F,PMCCTC6F)    *
.*                  d) 3 new CMBS Codes To   (PMCCPC4T/PMCCSC5T,PMCCTC6T)    *
.*                  27/04/2021  J.Tan           TSK 0863287                  *
.*                  Mod for Patient Invoice new functionality                *
.*        V11.01.03 23/03/2021  Peter Vela     TSK 0902857                   *
.*                  Recompiled for PATINVS - WebServices IHCW                *
.*        V11.01.02 10/03/2021  Tracey Nguyen   TSK 0901515                  *
.*                  Recompiled for PMSCMTFD - Added Primary ICD Procedure 1-5*
.*                  (PMCCICP1-5)                                             *
.*        V11.01.01 17/02/2021  Tracey Nguyen  TSK 0888639                   *
.*                  Recompiled for PATMMBFD changes                          *
.*                  22/02/2021  Peter Vela     TSK 0902857                   *
.*                  Recompiled for PATINVS - WebServices IHCW                *
.*****************************************************************************
.*        V11.00.13 19/01/2021  J.Tan          TSK 0883075                   *
.*                  Recompiled for PRTINVBD - mod to print ADF addr.on invoic*
.*        V11.00.12 10/11/2020  J.Tan           TSK 0899562                  *
.*                  Recompiled for CMXMATRX - setup date for reading MBS item*
.*        V11.00.11 14/10/2020  J.Tan          TSK 0894879                   *
.*                  Recompiled for PRTINVBD - Print 30 item desc.for RCH Inv.*
.*        V11.00.10 29/09/2020  J.Tan          TSK 0896829                   *
.*                  Recompiled for CMXMATRX - use National(PTPGNDRG)DRG      *
.*        V11.00.09 22/09/2020  J.Tan           TSK 0895330                  *
.*                  Recompiled for CMXMATRX - reposition read of Matrix table*
.*        V11.00.08 20/07/2020  J.Tan           TSK 0892319                  *
.*                  Recompiled for ABFPTINV - Additional NEP and Psych.Adjus.*
.*        V11.00.07 14/07/2020  J.Tan          TSK 0892902                   *
.*                  Recompiled for PATCATBI - Mod to initialise CASMXKEY     *
.*        V11.00.06 01/07/2020  J.Tan           TSK 0892765                  *
.*                  Recompiled for PATCATBI-Low outlier exc. unqualified days*
.*                  05/07/2020  J.Tan           TSK 0892746                  *
.*                  Recompiled for ABFPTINV - CALCAGE as at Admission date   *
.*        V11.00.05 29/06/2020  J.Tan           TSK 0893767                  *
.*                  Recompiled for ABFPTINV - Changed CALCFLAG to 01/01/2021 *
.*        V11.00.04 20/04/2020 J.Tan           TSK 0890733                   *
.*                  Recompiled for ABFPTINV - ABF new 2020 calculation       *
.*        V11.00.03 07/05/2020  J.Tan            TSK 0891341                 *
.*                  Recompiled for ABFOTINV - added TRAP to write pmsabfaf   *
.*        V11.00.02 08/04/2020 J.Tan           TSK 0868813                   *
.*                  Recompiled for PATINVHL                                  *
.*                  15/04/2020 Thanh T         TSK 0879163                   *
.*                  Added SEXDSP00                                           *
.*        V11.00.01 12/03/2020  J.Tan          TSK 0838262                   *
.*                  Added PATITMRD                                           *
.*        V10.15.02 11/10/2019  Peter Vela       TSK 0882906                 *
.*                  Recompiled for OUTCATBI - Fixed I*C for OUTBB1 ABF       *
.*        V10.15.01 07/10/2019  J.Tan            TSK 0857392                 *
.*                  Mod to clear Disc.record                                 *
.*        V10.14.05 26/09/2019  J.Tan            TSK 0857392                 *
.*                  Recompiled for OUTCATBI - ABF outpatient invoice         *
.*        V10.14.04 24/09/2019  J.Tan           TSK 0881867                  *
.*                  Recompiled for ABF invoice                               *
.*        V10.14.03 09/09/2019  J.Tan           TSK 0857392                  *
.*                  Recompiled for ABF invoice                               *
.*        V10.14.02 05/08/2019  J.Tan           TSK 0857392                  *
.*                  Recompiled for ABF Invoices                              *
.*        V10.14.01 21/05/2019  J.Tan           TSK 0857392                  *
.*                  Recompiled for ABF Invoices                              *
.*        V10.13.03 11/01/2019  Peter Vela     TSK 0867807                   *
.*                  Recompiled for OUTCATBI                                  *
.*        V10.13.02 26/10/2018  Thanh T        TSK 0859743                   *
.*                  Added BULKBILL field and removed OUTHEDFD/OUTHEDIO,      *
.*                  OUTSESFD/OUTSESIO for OUTCATBI changes                   *
.*        V10.13.01 25/10/2018  Thanh T        TSK 0859743                   *
.*                  Added OUTHEDFD/OUTHEDIO, OUTSESFD/OUTSESIO for OUTCATBI  *
.*                  changes                                                  *
.*---------------------------------------------------------------------------*
.*        V10.12.02 18/07/2018  J.Tan          TSK 0859911                   *
.*                  Recompiled for PATCATBI - Fixed No Payday Add on charge  *
.*        V10.12.01 28/02/2018  J.Tan          TSK 0852351                   *
.*                  Recompiled for PATINVHL-fields 226 227(Program Code/Desc)*
.*        V10.11.04 11/09/2017  Thanh T.      TSK 0821710                    *
.*                  Audit Amission/outpatient visit comments.                *
.*                  Removed PATCOMFD/IO                                      *
.*        V10.11.03 07/09/2017  J.Tan         TSK 0837479                    *
.*                  Recompiled for CMXMATRX - Consumption type items         *
.*        V10.11.02 24/08/2017  Thanh T.      TSK 0821710                    *
.*                  Removed PATCMNTS                                         *
.*        V10.11.01 10/08/2017  Peter Vela    TSK 0837619                    *
.*                  Recompiled for PATINVS                                   *
.*---------------------------------------------------------------------------*
.*        V10.10.02 13/06/2017  J.Tan          TSK 0839991                   *
.*                  Recompiled for PATDBTYP (PATCMSTP)                       *
.*        V10.10.01 25/01/2017  J.Tan          TSK 0832407                   *
.*                  Recompiled for PATCATBI-multi bed trans on sameday for MV*
.*                  04/04/2017  J.Tan         TSK 0297904                    *
.*                  Recompiled for PATCMSTP - Non-Accumulative inlier ICU/CCU*
.*        V10.08.09 06/10/2016  J.Tan         TSK 0826824                    *
.*                  Recompiled for CALCMVHR - MV Hours                       *
.*        V10.08.08 21/09/2016  J.Tan         TSK 0826370                    *
.*                  Recompiled for CMXMATRX - Chg MCHGARR MCHGAMT array to F3*
.*        V10.08.07 26/08/2016  Don Nguyen    TSK 0312570                    *
.*                  Recompiled for CMXMATRX - Added check for PTCNDGED=1     *
.*                  Added PMSEDGFD/IO and GETEFDRG                           *
.*        V10.08.06 17/08/2016  J.Tan         TSK 0808745                    *
.*                  Recompiled for PATCATBI - for NPDAYFLG=1                 *
.*        V10.08.05 20/07/2016  J.Tan         TSK 0819914                    *
.*                  Recompiled for PATCATBI - Non ICU MV Hours               *
.*        V10.08.04 15/07/2016  J.Tan         TSK 0819914                    *
.*                  Recompiled for PATCATBI - Calculating non ICU MV hours   *
.*        V10.08.03 20/06/2016  J.Tan         TSK 0820816                    *
.*                  Recompiled for PATCATBI - Fixed No payday for Daycase    *
.*        V10.08.02 02/06/2016  J.Tan         TSK 0816651                    *
.*                  Recompiled for PATCATBI-Continuous Bill.to chk for Matrix*
.*        V10.08.01 02/05/2016  Ebon Clements TSK 0268970                    *
.*                  Change to use OUTCLIFD index 1 instead of index 2        *
.*        V10.07.03 04/03/2016  J.Tan         CAR 290448                     *
.*                  Recompiled for PATCATBI - Mods for Addon with No Pay DAy *
.*        V10.07.02 18/11/2015  J.Tan         CAR 303942                     *
.*                  Added new payment types                                  *
.*        V10.07.01 15/10/2015  J.Tan          CAR 322442                    *
.*                  Recompiled for PATCATBI-Fixed TOTDAYS for Casepay.daycase*
.*        V10.06.07 11/09/2015  J.Tan         CAR 317216                     *
.*                  Added SINVT000 and SINVH0000                             *
.*        V10.06.06 14/08/2015  J.Tan         CAR 320073                     *
.*                  Recompiled for PATCATAI-reprint inv.for unreleased cash  *
.*        V10.06.05 07/08/2015  Davin         CAR 317002                     *
.*                  Recompiled for PRTINVBD - Print pmexname for ADF MO      *
.*        V10.06.04 15/07/2015  J.Tan          CAR 319342                    *
.*                  Recompiled for CMXMATRX - Chg 'Disc.UDF' to 'Care Class' *
.*        V10.06.03 14/07/2015  Peter Vela     CAR 318700                    *
.*                  Recompiled for PRBILCMN - Validate for deleted VISMDT    *
.*                  record                                                   *
.*        V10.06.02 15/05/2015  Davin         CAR 310155                     *
.*                  Recompiled for PATGBCRN - added MOD10V05 for BPAY        *
.*        V10.06.01 02/04/2015  Ania P         CAR 313236                    *
.*                  Recompiled for PRTINVBD                                  *
.*        V10.05.03 12/01/2014  Peter Vela     CAR 310738                    *
.*                  Recompiled for PRTINVBD                                  *
.*        V10.05.02 10/12/2014 Peter Vela      CAR 309840                    *
.*                  Recompiled for PATINVS                                   *
.*        V10.05.01 04/08/2014 J.Tan           CAR 304397                    *
.*                  Mods to check Suggested classification for charging      *
.*        V10.04.09 03/07/2014 J.Tan           CAR 268860                    *
.*                  Recompiled for PATCATBI - ICD10 Suggested Classification *
.*        V10.04.08 19/06/2014 J.Tan           CAR 302452                    *
.*                  Recompiled for PATDINVS - Changed MCHGARR/MCHGAMT        *
.*        V10.04.07 11/06/2014 Sandra Barcham  CAR 301639                    *
.*                  Moved call to TFILENAM to INIT0000                       *
.*        V10.04.06 27/05/2014  J.Tan          CAR 300784                    *
.*                  Recompiled for STEPDOWN - force stepdown prior inv.fromda*
.*        V10.04.05 15/04/2014  J.Tan          CAR 261630                    *
.*                  Removed patauc pataui pataum                             *
.*        V10.04.04 15/04/2014  J.Tan          CAR 261630                    *
.*                  PATCATBI - Removed port number from temp file name       *
.*        V10.04.03 26/02/2014  J.Tan          CAR 275810                    *
.*                  Recompiled for PRTINVBD - to print Defence Force details *
.*        V10.04.02 20/01/2014  J.Tan          CAR 273713                    *
.*                  Recompiled for PRTINVBD -Print payment types of a receipt*
.*        V10.04.01 14/02/2014  J.Tan          CAR 297139                    *
.*                  Mods for Ind.Services Billing to automaticaly update items*
.*        V10.03.14 13/12/2013  J.Tan          CAR 294609                    *
.*                  Recompiled for CMXMATRX - mods for Default Grouper Vers. *
.*        V10.03.13 09/12/2013  Ania P         CAR 294740                    *
.*                  Recompiled for PATINVHL                                  *
.*        V10.03.12 14/11/2013  J.Tan          CAR 285294                    *
.*                  Added option to create Export file                       *
.*        V10.03.11 07/11/2013  J.Tan          CAR 283618                    *
.*                  Recompiled for PATCATBI - mods for Ind.Services Billing  *
.*        V10.03.10 02/10/2013  J.Tan          CAR 291588                    *
.*                  Recompiled for PATCATBI - fixed stepdown return from leave*
.*        V10.03.09 12/09/2013  Peter Vela     CAR 271911                    *
.*                  Recompiled for PATINVTL                                  *
.*        V10.03.08 14/08/2013  J.Tan          CAR 288416                    *
.*                  Recompiled for PATCATBI - fixed Days of Hosps.           *
.*        V10.03.07 05/08/2013  J.Tan          CAR 288060                    *
.*                  Recompiled for CMXMATRX - fixed Primary/Secondary/Tertiar*
.*        V10.03.06 20/06/2013  Davin          CAR 287161                    *
.*                  Recompiled for PATGBCRN - right justify ptcnhbpi         *
.*        V10.03.05 06/05/2013  J.Tan          CAR 284902                    *
.*                  Recompiled for STEPDOWN - force stepdown prior Inv.Fromda*
.*        V10.03.04 10/04/2013  J.Tan    CAR 283743                          *
.*                  Recompiled for PATCATBI -  reset PTTRESPD for NewStepdown*
.*        V10.03.03 05/03/2013  Patrick Adair CAR 281898                     *
.*                  Recompiled for PATCATBI PATCATAI                         *
.*        V10.03.02 21/09/2012  J.Tan          CAR 271474                    *
.*                  Recompiled for CMXMATRX - using index 5 of pmscmtaf      *
.*                  04/12/2012  J.Tan          CAR 262673                    *
.*                  Recompiled for PATCATBI - Casepayment perdiem rate       *
.*        V10.03.01 18/07/2012  Don Nguyen     CAR 264561                    *
.*                  Recompiled for PATGBCRN                                  *
.*        V10.02.01 04/04/2011  Jill Parkinson CAR 239574                    *
.*                  Removed open of ibaprntf                                 *
.*        V10.01.05 28/02/2011  Peter Vela    CAR 233034                     *
.*                  Recompiled for PATINVS                                   *
.*        V10.01.04 23/02/2011  Peter Vela    CAR 233034                     *
.*                  Removed PATBF2FD and PATBF2IO                            *
.*        V10.01.03 13/01/2011  Mike Laming   CAR 233084                     *
.*                  Added include CLPATINV for PATINVS & Recompiled          *
.*        V10.01.02 21/12/2010  Mike Laming   CAR 233046                     *
.*                  Recompiled for PABXBILL - Mods to Misc.Charges PATMCHFD  *
.*        V10.01.01 30/10/2010 J.Tan          CAR 233043                     *
.*                  Recompiled for PATCATBI - mods to Print invoice          *
.*        V10.00.07 17/08/2010 J.Tan         CAR 227873                      *
.*                  Recompiled for CMXMATRX- getting the grouper version     *
.*        V10.00.06 11/08/2010 J.Tan         CAR 227873                      *
.*                  Recompiled for CMXMATRX-searching for next matrix rules  *
.*        V10.00.05 03/08/2010  J.Tan         CAR 227319                     *
.*                  Recompiled for PATCATBI - Mechanical Ventilation         *
.*        V10.00.04 14/07/2010  J.Tan         CAR 226158                     *
.*                  Recompiled for STEPDOWN - bed fees update                *
.*        V10.00.03 16/07/2010 J.Tan         CAR 226322                      *
.*                  Recompiled for CMXMATRX - search for next rule if        *
.*                  Contract is not valid                                    *
.*        V10.00.02 12/07/2010  J.Tan         CAR 225932                     *
.*                  Recompiled for PATCATBI - set TDATE to IDATET per-diem   *
.*        V10.00.01 07/06/2010  Mike Laming   CAR 212864                     *
.*                  Recompiled for PATCATBI - mods at GCDE6500               *
.*        V9.12.15  11/03/2010  J.Tan         CAR 216044                     *
.*                  Mods to include Leave days in stepdown count for TAC     *
.*        V9.12.14  16/02/2010  Peter Vela    CAR 215485                     *
.*                  Recompiled for PATCATBI - Ignore Leave if less than 1    *
.*                  day                                                      *
.*        V9.12.13  05/02/2010  Peter Vela    CAR 215485                     *
.*                  Recompiled for PATCATBI - Ignore Leave if less than 1    *
.*                  day                                                      *
.*        V9.12.12  02/02/2010  Davin         CAR 215234                     *
.*                  Recompiled for CMXMATRX                                  *
.*        V9.12.11  27/01/2010  J.Tan         CAR 214548                     *
.*                  Recompiled for PATCATBI - Stepdown after bed fees updat  *
.*                  27/01/2010  J.Tan         CAR 214877                     *
.*                  Recompiled for CMXMATRX - Checking for range of MBS itm  *
.*        V9.12.10  19/01/2010  J.Tan         CAR 166439                     *
.*                  Recompiled for PATCMSTP - C/P additional charge stepdown *
.*        V9.12.09  04/12/2009  Peter Vela    CAR 202333                     *
.*                  Recompiled for PATINVHL - Changed variable 88 to         *
.*                  surname only                                             *
.*        V9.12.08  24/11/2009  Davin         CAR 210721                     *
.*                  Recompiled for CHKCMXPT - I*C on patcmxaf file           *
.*        V9.12.07  09/10/2009  J.Tan         CAR 203934                     *
.*                  Recompiled for PATCATBI - disp.ICD10 Sugg.Class on Inv.  *
.*        V9.12.06  21/09/2009  J.Tan         CAR 204390                     *
.*                  Recompiled for STEPDOWN - old bed fees file              *
.*        V9.12.05  24/07/2009  J.Tan         CAR 201132 & 202168            *
.*                  Recompiled for CMXMATRX - checking for zero MBS amount   *
.*        V9.12.04  03/07/2009  Peter Vela    CAR 199927                     *
.*                  Recompiled for EMROPOCK - Check if PMMIAMTT = 0          *
.*                  GPRC4000                                                 *
.*        V9.12.03  05/06/2009  J.Tan         CAR 196010                     *
.*                  Recompiled for CMXMATRX - ICD10 Secondary/Tertiary       *
.*        V9.12.02  15/05/2009  WeeLee Koo    CAR 196722                     *
.*                  Recompiled for PATINVS                                   *
.*        V9.12.01  11/05/2009  J.Tan         CAR 125842                     *
.*                  Recompiled for PATCATBI - Recalc.zero amt of Misc.Item   *
.*        V9.11.05  15/04/2009  Steve Armstrong  CAR 194544                  *
.*                  Recompiled for PATINVS                                   *
.*        V9.11.04  23/03/2009  Davin         CAR 178015                     *
.*                  Recompiled for PATINVHL - Changed BPAY CRN to use invno  *
.*        V9.11.03  22/12/2008  Steve Armstrong   CAR 183976                 *
.*                  Recompiled for changes to PATINVS.                       *
.*        V9.11.02  20/11/2008  Steve Armstrong   CAR 181373                 *
.*                  Recompiled for changes to PATCATBI.                      *
.*        V9.11.01  14/10/2008  Peter Vela    CAR 159227                     *
.*                  Recompiled for PATINVHL - Added Emergency Invoice        *
.*                  Arrival Date and Time                                    *
.*****************************************************************************
.*        V9.10.04  25/09/2008  J.Tan         CAR 178209                   *
.*                  Recompiled for PATCATBI - checking for Doct.chg rec.   *
.*                  25/09/2008  J.Tan         CAR 179009                   *
.*                  Recompiled for STEPDOWN - Check 'Exclude Days of Hosp."*
.*        V9.10.03  05/09/2008  J.Tan         CAR 177126                   *
.*                  Recompiled for PATCATBI - Checking matrix parameter    *
.*        V9.10.02  06/08/2008 J.Tan      CAR 175246                       *
.*                  Recompiled for AAECATBI                                *
.*        V9.10.01  08/07/2008 Sandra Barcham CAR 173135                   *
.*                  Recompiled for PATCATBI - Remove close of PATDGWA1     *
.***************************************************************************
.*        V9.09.20  04/03/2008 J.Tan          CAR 157583                   *
.*                  Recompiled for AAECATBI-Invoice tot.with'Out of Pocket'*
.*        V9.09.19  29/02/2008  J.Tan         CAR 162893 & 162609          *
.*                  Recompiled for PATCATBI - Inv.breakdown and Lumpsum amt*
.*        V9.09.18  20/02/2008  Peter Vela       CAR 161535                *
.*                  Recompiled for PATCATBI                                *
.*        V9.09.17  18/01/2008  Ebon Clements    CAR 149252                *
.*                  Fixed page number display                              *
.*        V9.09.16  03/01/2008  J.Tan            CAR 136785                *
.*                  Recompiled for STEPDOWN                                *
.*        V9.09.15  27/12/2007  Peter Vela       CAR 155907                *
.*                  Recompiled for PATINVTL                                *
.*        V9.09.14  28/11/2007  Steve Armstrong  CAR 139300                *
.*                  Mods for option to sort by discharge date.             *
.*        V9.09.13  16/11/2007  Peter Vela    CAR 110766                   *
.*                  Recompiled for PATINVHL                                *
.*        V9.09.12  12/11/2007 J.Tan          CAR 151803                   *
.*                  Recompiled for AAECATBI - Cabrini ED Billing           *
.*        V9.09.11  12/11/2007  Peter Vela     CAR 151199                  *
.*                  Added new Emergency Cancellation status                *
.*        V9.09.10  04/10/2007  Jill Habasque  CAR 150322                  *
.*                  Added use of PTCNHITC                                  *
.*        V9.09.09  24/08/2007  Peter Vela CAR 146143                      *
.*                  Recompiled for PATCATBI                                *
.*        V9.09.08  20/08/2007 J.Tan          CAR 144656                   *
.*                  Recompiled for PATCATBI - for Multiple Procedures      *
.*        V9.09.07  10/08/2007 Peter Vela     CAR 146143                   *
.*                  Recompiled for PATCATAI                                *
.*        V9.09.06  25/07/2007  Peter Vela CAR 144787                      *
.*                  Recompiled for PATCATAI                                *
.*        V9.09.05  17/07/2007  J.Tan     CAR 140282                       *
.*                  Recompiled for NZPCATBI - Revenue breakdown            *
.*        V9.09.04  03/07/2007  Peter Vela CAR 142173                      *
.*                  Recompiled for PATCATAI                                *
.*        V9.09.03  29/06/2007  Peter Vela CAR 142173                      *
.*                  Recompiled for PATCATAI                                *
.*        V9.09.02  25/06/2007 Peter Vela     CAR 142173                   *
.*                  Recompiled for PATCATAI                                *
.*        V9.09.01  07/06/2007 J.Tan             CAR 142173                *
.*                  Mods for Emergency event                               *
.***************************************************************************
.*        V9.08.15  16/04/2007  J.Tan            CAR 138026                *
.*                  Recomp.for PATCATBI - JH Charging for discharged day   *
.*        V9.08.14  19/02/2007  Peter Vela       CAR 135241                *
.*                  Recompiled for PATCATBI - St. John of God invoice layt *
.*        V9.08.13  19/02/2007 Peter Vela     CAR 135241                      *
.*                  Recompiled for PATCATBI - St. John of God invoice layout  *
.*        V9.08.12  26/02/2007  J.Tan         CAR 120014                   *
.*                  Recompiled for NZPCATBI - NZ exploding misc.item       *
.*        V9.08.11  22/02/2007 Mike Laming   CAR 119436
.*                  Add PMSOSDTM (PROC FLAGDEBT) for Outstanding Debt Alert ind.
.*        V9.08.10  02/02/2007  Ebon Clements CAR 120001                   *
.*                  Added nz private billing files                         *
.*        V9.08.09  31/01/2007  Peter Vela    CAR 127930                   *
.*                  Recompiled for EMRSITFD                                *
.*        V9.08.08  18/12/2006 J.Tan          CAR 128578                   *
.*                  Recompiled for OUTCATBI - GST amount for O/P Next inv  *
.*        V9.08.07  13/12/2006  J.Tan         CAR 127625                   *
.*                  Mods to JH HRN                                         *
.*        V9.08.06  27/11/2006  Steve Armstrong   CAR 126039               *
.*                  Recompiled for changes to SGCHKDIG                     *
.*        V9.08.05  17/11/2006  Peter Vela    CAR 124538                   *
.*                  Recompiled for PATCATBI                                *
.*                  Added display of PATITMFD.PTITTCER                     *
.*                  Type of Certificate Type B Type C                      *
.*        V9.08.04  16/11/2006  Steve Armstrong   CAR 124160               *
.*                  Recompiled for PATINVHL (Singapore HRN)                *
.*                  Recompiled for PATINVTL (Singapore HRN)                *
.*        V9.08.03  14/11/2006  Peter Vela    CAR 124547                   *
.*                  Addedreads for PTCNDEES PTCNDDES                       *
.*        V9.08.02  18/10/2006  J.Tan         CAR 120502                   *
.*                  Recompiled for PATCATBI - Ignore Doctor Change record  *
.*        V9.08.01  29/09/2006  Peter Vela    CAR 120319                   *
.*                  Recompiled for PATINVHL                                *
.***************************************************************************
.*        V9.07.07  25/09/2006  Peter Vela    CAR 118940                   *
.*                  Recompiled for PATCATBI                                *
.*        V9.07.06  20/09/2006 J.Tan         CAR 119336                    *
.*                  Added claim code to Suggested classification file      *
.*        V9.07.05  12/09/2006  Jill Habasque CAR 109852                   *
.*                  Added procedure GETALTID                               *
.*        V9.07.04  02/08/2006  Peter Vela    CAR 113658                   *
.*                  Recompiled for PATINV21 - Fixed Date and Cash Payment  *
.*                  display                                                *
.*        V9.07.03  01/08/2006  J.Tan         CAR 103365                   *
.*                  Recompiled for PATCATBI - Johns Hopkins                *
.*        V9.07.02  25/07/2006  Peter Vela    CAR 113658                   *
.*                  Recompiled for PATCATAI - Fixed "Journal Total" display*
.*        V9.07.01  13/07/2006  Mike Laming       CAR 111521               *
.*                  Change Bed Fee & Theatre Fee work areas to FORM 8.2    *
.***************************************************************************
.*        V9.06.02  16/05/2006  Peter Vela    CAR 104103                   *
.*                  Recompiled for PATCATBI - PTCNINVL=12                  *
.*        V9.06.01  24/04/2006  J.Tan        CAR 102287                    *
.*                  Recompiled for PATINVHL - fields for multi hospital det*
.***************************************************************************
.*        V9.05.02  29/03/2006 Peter Vela    CAR 95780                     *
.*                  Recompiled for PATINVHL - Added emg mobile contact numbers
.*        V9.05.01  6/03/2006  Peter Vela    CAR 61299                     *
.*                  Recompiled for PATINVHL                                * 
.***************************************************************************
.*        V9.04.B02 20/12/2005  J.Tan         CAR 89226                    *
.*                  Recompiled for PATCATBI - recalculate theatre fees     *
.*        V9.04.17  17/11/2005  Peter Vela    CAR 84547                    *
.*                  Recompiled for PATINVXX subroutines - Removed CLOSE PATFN1A1
.*        V9.04.16  02/11/2005  Peter Vela        CAR 81394                *
.*                  Recompiled for PATCATBI                                *
.*        V9.04.15  25.10.2005 Sandra Barcham CAR 81362                    *
.*                  Recompiled for PATINVS - Fixed pack of fincode for dep.*
.*        V9.04.14  04/08/2005  J.Tan        CAR 62750                     *
.*                  Mods not to use the redefined amount variables         *
.*                  31/08/2005  J.Tan         CAR 74153                    *
.*                  Recompiled for CMXMATRX - checking for exclusive       *
.*        V9.04.13  14/07/2005  Peter Vela    CAR 62172                    *
.*                  Recompiled for PATINVTL                                *
.*        V9.04.12  16/06/2005  Mike Laming   CAR 61746                    *
.*                  Recompiled for CLPATDTR - add clear PTDTTIME & PTDTCRST*
.*        V9.04.11  01/03/2005  Peter Vela    CAR 57547                    *
.*                  Recompiled for PATVADFD and PATVADIO                   *
.*        V9.04.10  17/02/2005  Mike Laming   CAR 56030                    *
.*                  Re-compile for PATINV25 - fix screen painted tail printing
.*        V9.04.09  13/12/2004  J.Tan    CAR  55649                        *
.*                  Fixed keyin hospital id                                *
.*        V9.04.08  29/11/2004  Mike Laming   CAR 54534                    *
.*                  Re-comple for PATCMSTP - fix Addit.Charge Description  *
.*        V9.04.07  25/11/2004  J.Tan  CAR 54768                           *
.*                  Mods for Pendlebury invoice layout                     *
.*        V9.04.06  22/10/2004  J.Tan  CAR 54506                           *
.*                  Fixed I*C on pmsmtiaf file                             *
.*        V9.04.05  06/10/2004  J.Tan   CAR 53798                          *
.*                  Removed PATMSCDS                                       *
.*        V9.04.04  04/10/2004  Peter Vela CAR 52906                       *
.*                  Recomopiled for PATCATAI                               *
.*                  23/09/2004  Lina Vo  CAR 53660                         *
.*                  Recompiled for PATCATBI - multi hospital theatre fee   *
.*        V9.04.03  08/09/2004  J.Tan    CAR 53292                         *
.*                  Recompiled for STEPDOWN - bed fees not setup           *
.*        V9.04.02  31/08/2004  J.Tan  CAR 53073                           *
.*                  Fixed Multi hospital id variable                       *
.*        V9.04.01  23/08/2004  J.Tan  CAR 52835                           *
.*                  Mods for Multi hospital                                *
.***************************************************************************
.*        V9.03.19  22/06/2004  Lina Vo  CAR 50811                         *
.*                  Removed use of RCPDEPFD & IO - now obselete.           *
.*        V9.03.18  09/06/2004  J.Tan    CAR 50035                         *
.*                  Re-compile for PATCATBI - Mechanical ventilation       *
.*        V9.03.17  22/04/2004  Mike Laming   CAR 46224                    *
.*                  Re-compile for PATCATBI & PATINVS - Theatre DTR seq.   *
.*        V9.03.16  06/04/2004  Peter Vela    CAR 48227                    *
.*                  Added VARGBCRN and PATGBCRN - BPAY Reference Number    *
.*        V9.03.15  16/03/2004  Steve Armstrong  HosClaims Phase 1 (48280) *
.*                  Recompiled for PATINVS                                 *
.*        V9.03.14  23/02/2004  Mike Laming   CAR 47440                    *
.*                  Re-compile for PATCATBI - initialise TPATAMTP          *
.*        V9.03.13  12/02/2004  Henry Son        CAR 47385                 *
.*                  Added PTCNMBSF for checking if we allow more than      *
.*                  Six MBS Items.                                         *
.*        V9.03.12  03/02/2004  J.Tan  CAR 45047                           *
.*                  Recompiled for PATCATAI - Non-banked Cash              *
.*        V9.03.11  18/12/2003  J.Tan  CAR 44093                           *
.*                  Recompiled for new receipting files                    *
.*        V9.03.10  21/11/2003  J.Tan   CAR  44161                         *
.*                  Recompiled for PATCATAI - print credit note            *
.*        ........  18/11/2003  Henry Son   CAR 39291                      *
.*                  Allow more than 7 Theatre stepdown fees.               *
.*                  Recompile PATINVS, PATCATBI.                           *
.*        V9.03.09  07/11/2003  Peter Vela   CAR 44849                     *
.*                  Recompiled for PATINVTL                                *
.*        V9.03.08  03/11/2003  Mike Laming  CAR 43911                     *
.*                  Recompile for PATCATBI - correct GROSSTOT & ACCMTOT    *
.*        V9.03.07  03/11/2003  Peter Vela CAR 44757                       *
.*                  Recompiled for PATINVTL                                *
.*        V9.03.06  17/10/2003  J.Tan  CAR 44176                           *
.*                  Recompiled for PATCATBI.                               *
.*        V9.03.05  15/09/2003  CAR 40497   Lina Vo                        *
.*                  Recompiled for AAECATBI, OUTCATBI, PATCATBI, PATINVS   *
.*                  PATMCHFD & IO and PATINVS.                             *   
.*                  16/09/2003  J.Tan        CAR 36504                     *
.*                  Recompiled for CHNADMTP                                *
.*        V9.03.04  04/09/2003  CAR 42713   Mike Laming                    *
.*                  Recompiled for PATINVTL (correct GST twice in final Total)*
.*        V9.03.03  11/08/2003  CAR 41072   Mike Laming                    *
.*                  Recompile for PATCATBI to correct Lump Sums in BIL19   *
.*        V9.03.02  04/08/2003  CAR 34330/41952   Mike Laming              *
.*                  Recompiled for PATCATBI & PATDINVS - Add second temp   *
.*                  file for Misc.Items to change sequence to Date/DTR seq *
.*        V9.03.01  Lina Vo  CAR 40682                                     *
.*                  Added read of emrvisaf in RREC0000 to get discharge    *
.*                  date, Health Fund and Table.                           *
.***************************************************************************
.*        V9.02.09  12/02/2004  Henry Son        CAR 47385                 *
.*                  Added PTCNMBSF for checking if we allow more than      *
.*                  Six MBS Items.                                         *
.***************************************************************************
.
.
          INC       STD001FD
          INC       STDHLPDF
          INC       STDKWSDF
          INC       RSHWEBDF
          INC       CHKDIGVR/INC
          INC       PATCOMM/INC
          INC       PATDINVS/INC  
          INC       TFILEVAR/INC                 * Generate Temp File Name
          INC       WEBERRFD/INC                 * Web Server Error Logging
.
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
          INC       IBAPRNFD/INC
          INC       IBAPDFFD/INC
          INC       IBACONFD/INC
          INC       PABXVARS/INC
          INC       EMRHISFD/INC
          INC       EMRVISFD/INC
          INC       EMRSITFD/INC
          INC       IBAGEDFD/INC
          INC       IBAGSTFD/INC
          INC       MRTMASFD/INC
.
          INC       APSMASFD/INC
          INC       AAEDTRFD/INC
          INC       AAEDE1FD/INC
          INC       AAECONFD/INC
          INC       BOKRC1FD/INC
          INC       NHIMASFD/INC
          INC       MLTCFNFD/INC
          INC       NZPBFEFD/INC
          INC       NZPCFNFD/INC
          INC       NZPCMTFD/INC
          INC       NZPFIGFD/INC
          INC       NZPFINFD/INC
          INC       NZPIBRFD/INC
          INC       NZPIRNFD/INC
          INC       NZPMCHFD/INC
          INC       NZPMXCFD/INC
          INC       NZPPFEFD/INC
          INC       NZPRBRFD/INC
          INC       NZPRFNFD/INC
          INC       NZPPICFD/INC
          INC       NZPSPRFD/INC
          INC       NZPTFEFD/INC
          INC       NZPIVBFD/INC
          INC       NZPRVBFD/INC
          INC       NZPEXTFD/INC
          INC       NZPRDTFD/INC
          INC       OPRDEAFD/INC
          INC       OPRARDFD/INC
          INC       OPRSESFD/INC
          INC       PATAFEFD/INC
          INC       PATASDFD/INC
          INC       PATBFEFD/INC
          INC       PATELGFD/INC
          INC       PATCFAFD/INC
          INC       PMSABFFD/INC
          INC       PMSPWAFD/INC
          INC       PMSCIDFD/INC
          INC       PMSCCDFD/INC
          INC       PMSTLEFD/INC
          INC       PATCODFD/INC
          INC       PATCMCFD/INC
          INC       PATCMXFD/INC
          INC       PATCONFD/INC
          INC       PATCRAFD/INC
          INC       PATCURFD/INC
          INC       PATALRFD/INC
          INC       PATALWFD/INC
          INC       PATCALAG/INC
          INC       PATCTFFD/INC
          INC       PATDO1FD/INC
          INC       PATDGWFD/INC
          INC       PATDRGFD/INC
          INC       PATDSCFD/INC
          INC       PATDTRFD/INC
          INC       PATECDFD/INC
          INC       PATECHFD/INC
          INC       PATECOFD/INC
          INC       PATEDSFD/INC
          INC       PATEDTFD/INC
          INC       PATFX1FD/INC
          INC       PATFHIFD/INC
          INC       PATGTUFD/INC
          INC       PATHTRFD/INC
          INC       EMRHTRFD/INC
          INC       OUTHTRFD/INC
          INC       PATHDFFD/INC
          INC       PATHLFFD/INC
          INC       PATIBLFD/INC
          INC       PATICDFD/INC
          INC       PATICUFD/INC
          INC       PATIN1FD/INC
          INC       PATINMFD/INC
          INC       PATINLFD/INC
          INC       PATIPEFD/INC
          INC       PATIPRFD/INC
          INC       PATINVFD/INC
          INC       PATIOVFD/INC
          INC       PATIRNFD/INC
          INC       PATITMFD/INC
          INC       PATJRNFD/INC
          INC       PATLDFFD/INC
          INC       PATLSDFD/INC
          INC       PATFACFD/INC
          INC       PATFEEFD/INC
          INC       PATFIGFD/INC
          INC       PATFINFD/INC
          INC       PATFMOFD/INC
          INC       PATFN1FD/INC
          INC       PATFN2FD/INC
          INC       PATHSPFD/INC
          INC       PMSEVTFD/INC
          INC       PMSHCPFD/INC
          INC       PMSHCGFD/INC
          INC       PATMA1FD/INC
          INC       PMSPX2FD/INC
          INC       PMSPX2TD/INC
          INC       PATMCHFD/INC
          INC       PATMI1FD/INC
          INC       PATMMBFD/INC
          INC       PATNZRFD/INC
          INC       PATNHHFD/INC
          INC       PATOVBFD/INC
          INC       PATPR1FD/INC
          INC       PATPGRFD/INC
          INC       PATASFFD/INC
          INC       PATRATFD/INC
          INC       PATRBLFD/INC
          INC       PATRE1FD/INC
          INC       PATRFNFD/INC
          INC       PATRFGFD/INC
          INC       PATSCFFD/INC 
          INC       PATSGCFD/INC
          INC       PATSRBFD/INC
          INC       PATTFEFD/INC
          INC       PATRCAUD/INC
          INC       PATREMFD/INC
          INC       PATTRNFD/INC
          INC       PATVADFD/INC
          INC       PATDADFD/INC
          INC       PATVISFD/INC
          INC       PATVENFD/INC
          INC       PMSHATFD/INC
          INC       PATWR1FD/INC
          INC       PATWLRFD/INC
          INC       PATWC1FD/INC
          INC       PATWMAFD/INC
          INC       PATWVEFD/INC
          INC       PMSSINFD/INC
          INC       PATCMTFD/INC
          INC       PMSCMTFD/INC
          INC       PMSECTFD/INC
          INC       PMSVX1FD/INC
          INC       SCRMASFD/INC
          INC       NHIETHFD/INC
          INC       OPRDECFD/INC
          INC       OPRSRGFD/INC
          INC       OUTDTRFD/INC
          INC       OUTBOAFD/INC
          INC       OUTBB1FD/INC
          INC       OUTCLIFD/INC
          INC       OUTSITFD/INC
          INC       OUTCTYFD/INC
          INC       RCPCONFD/INC
          INC       RESLNKFD/INC
          INC       COMDEPFD/INC
          INC       RCPBNKFD/INC
          INC       RCPDTEFD/INC
          INC       RCPBDTFD/INC
          INC       RCPCRSFD/INC
          INC       VISPAYFD/INC
          INC       PMSIDEFD/INC
          INC       PMSPYRFD/INC
          INC       PMSPBRFD/INC
          INC       PMSIVBFD/INC
          INC       PATRGMFD/INC
          INC       PATONHFD/INC
          INC       PMSREGFD/INC
          INC       PMSHCPTD/INC
          INC       PMSHCGTD/INC
          INC       VARGBCRN/INC           * I-48227
          INC       PMSCNOFD/INC
          INC       PMSFCIFD/INC
          INC       PMSSGAFD/INC
          INC       PMSMTIFD/INC
          INC       PMSMPRFD/INC
          INC       PMSEXTFD/INC
          INC       PMSPRGFD/INC
          INC       PRIITMFD/INC
          INC       WEBCONFD/INC
          INC       WEBSCHFD/INC
          INC       WEBIHCFD/INC
          INC       PATSTAFD/INC
          INC       PATAA1FD/INC
          INC       PMSEDGFD/INC       * Effective DRG Dates
          INC       PATDDHFD/INC
.
.         Temporary File Definition
.         -------------------------
.
.         Filename : hms19axx.dat          (xx = port id)
.
IPETEMP1  IFILE SQL, FIXED=97, KEY="U1-8"
IPETEMP2  IFILE SQL, FIXED=97, KEY="U9-17,1-8"
.
.NAME     TYPE    LENGTH     PHYSICAL     START     DESCRIPTION
.----     ----    ------     --------     -----     -----------
.ADMISSNO DIM       8           8           1       Visit Number
.DDATE    DIM       8           8           9       Discharge Date (ccyymmdd)
.DIM9     DIM       9           9          17       U/R Number
.KEY21    DIM       21          21         26       Formatted Name
FRMADATE  DIM       10          10         47       Formatted Admission Date
.ACLAIM   DIM       3           3          57       Claim Code
FRMHFUND  DIM       13          13         60       Formatted Health Fund/Table
.ATYPE    DIM       3           3          73       Admission Type
.CODED    DIM       3           3          76       Coded (Yes or No)
.CASEPAY  DIM       3           3          79       Casepayment (Yes or No)
.TOTDAYS  FORM      4           3          82       Total Days
FORM7P2A  FORM      7.2         6          85       Gross Total
FORM7P2B  FORM      7.2         6          91       Net Total
.
.End of Record                             97
.
.
.   Work Variables
.
ADMISSNO  DIM       8
ADMNTYPE  DIM       3
ATYDESC   DIM       20
ACCDTE    DIM       10
AADMNOX   DIM       6
ADIAG     DIM       50
ACTION    DIM       1                       * Action for PATAA1FD
ADD       DIM       2                       * Day for PATAA1FD
AMM       DIM       2                       * Month for PATAA1FD
AYY       DIM       2                       * Year for PATAA1FD
ACC       DIM       2                       * Century for PATAA1FD
.
BFAMT     FORM      8.2                                               *C-111521
.
CONS      INIT      "Consolidated Report"
EMR       INIT      "Emergency Report"
INP       INIT      "Inpatient Report"
OUT       INIT      "Outpatient Report"
.
SCHEDNUM  FORM      8
SCHEDDSC  DIM       50
CSTRTYR   DIM       8
CDYSDAYS  FORM      6                       * CALCDAYS number of days
CDYSFDTE  DIM       8                       * CALCDAYS from date
CDYSTDTE  DIM       8                       * CALCDAYS to date
CDYSYEAR  FORM      2                       * CALCDAYS year
CDJULCC   FORM      2
CATEGORY  DIM       2
CODE      DIM       3
CASEPAY   DIM       3
CLAIMTYP  DIM       3
CODED     DIM       3
CLMDESC   DIM       20
CHGFLAG   FORM      1
CALDAYS   FORM      4
CFILEPRE  DIM       3
BULKBILL  DIM       1
CMDLINE   DIM       80
CURSESS   DIM       18
CURRDATE  DIM       8
CODESTAT  DIM       1
CASEPAYM  DIM       1
CERTINDC  FORM      1
.
DAYFORMT  DIM       4
DOCTCODE  DIM       6
DSCHFLAG  FORM      1
DIM1A     DIM       1
DIM2A     DIM       2
DIM3T     DIM       3
DIM4      DIM       4
DIM6U     DIM       6
DIM12     DIM       12
DIM12A    DIM       12
DIM9      DIM       9
DIM11     DIM       11
DIM14     DIM       14
DIM14A    DIM       14
DIM18     DIM       18
DIM18A    DIM       18
DIM24A    DIM       24
DIM30     DIM       30
DIM30A    DIM       30
DIM5A     DIM       5
DNAME     DIM       20
DAYSDIFF  FORM      2
DOCFNAME  DIM       50
DDRGCODE  DIM       4
.
EXPORTFL  FORM      1                  * Create Export File
EMCNGINV  DIM       1
EMCNDPOC  DIM       1
EMCNOPOC  DIM       15
EMRFLAG   FORM      1
ENDDAT    DIM       6
ENDNAM    DIM       6
ENDSEC    FORM      5
.
FHDUDT1   DIM       8
FHDUDT2   DIM       8
FORM3A    FORM      3
FORM5     FORM      5
FORMG     FORM      8
FMTSNAME  DIM       35
FMTGNAME  DIM       35
FMTTITLE  DIM       10
.
GRNDTOT   FORM      7.2
GRNDNET   FORM      7.2
.
FRSTDATE  DIM       8
HOSPID    DIM       3
HOSPNAME  DIM       50
HEALTHFN  DIM       6
HFNDESC   DIM       20
HDUDAY1   FORM      3                       * High Dependency
HDUDAY2   FORM      3
HFHIFUND  FORM      2
.
ITEMCD    FORM      1
JYEAR     FORM      2
KEYFLAG   FORM      1
KEY12A    DIM       12
KEY13A    DIM       13
.
LASTDATE  DIM       8
LNO       FORM      2
LWCHG     FORM      6.2                     * Labour Ward Fee
LWDT      DIM       8
.
MAXSEPDY  FORM      "35"
MBSDESC   DIM       40
MBSLOP    FORM      2
MBSFLAG   FORM      1
MBS1      DIM       9
MBS2      DIM       9
MBS3      DIM       9
MBSDT1    DIM       8
MBSDT2    DIM       8
MBSDT3    DIM       8
MBSCH1    DIM       9
MBSCH2    DIM       9
MBSCH3    DIM       9
MENUTYPE  DIM       2
MINOWE    FORM      6.2
MULTAMT   FORM      6.2
MULTNUM   FORM      3
MINFLD    FORM      2
MAXSCRN   FORM      2
MTHNAM3A  DIM       3
MTHNAM3   DIM       3
.
SAVPAGEN  FORM      3
SYSTEM    DIM       3
STARTKEY  DIM       8                       * Starting Key
.
NOCOPIES  FORM      3
.
.         Web Variables (only the include files use these variables)
.
NJAN      INIT      "January"
NFEB      INIT      "February"
NMAR      INIT      "March"
NAPR      INIT      "April"
NMAY      INIT      "May"
NJUN      INIT      "June"
NJUL      INIT      "July"
NAUG      INIT      "August"
NSEP      INIT      "September"
NOCT      INIT      "October"
NNOV      INIT      "November"
NDEC      INIT      "December"
.
HTMLFILE  FIFO      ASCII, FIXED=250
.
OPCNCONS  DIM       1
OPOCFLAG  FORM      1
ONAME     DIM       30
OPERCODE  DIM       4
OPRDATE   DIM       8
OTCHG1    FORM      6.2
OTCHG2    FORM      6.2
OTCNOTIH  DIM       6
OTCNOTIT  DIM       6
OTCNFTYP  FORM      1
OTCNCFEE  FORM      1
OTDESC1   DIM       15
OTDESC2   DIM       15
OTDT1     DIM       8                       * Other Items
OTDT2     DIM       8
.
PTSTATUS  DIM       1
PCENFLG   FORM      1
PSTROL    FILE      ASCII, FIXED=256
PSAGETYP  DIM       6
PSAGECON  DIM       3
PREVTRID  DIM       24
.
RACLINDC  DIM       1
REGIST8   DIM       2
REPRTSEQ  FORM      1                  * Report sequence flag
REPORTNO  FORM      2
.                                          0 = Invoice Number sequence
.                                          1 = Discharge Date sequence
.
SERVDOCT  DIM       10
SAVAMNT   FORM      12.2
SAVEXTRA  FORM      6.2
SBWINDOW  FORM      1
SCDJULDY  FORM      4
SCDJULYR  FORM      2
SAVCENT   DIM       2
SAVBEND   FORM      3
SAVKEY20  DIM       20
SAVKEY22  DIM       22
SAVALLW   FORM      6.2
SAVDISC   FORM      6.2
SMCHARGE  DIM       9
SMITMTYP  FORM      1
SMMSCGRP  DIM       3
SAVFLAG   FORM      1
SAVADM    DIM       8
SAVDAY    DIM       2
SAVMON    DIM       2
SAVYEAR   DIM       2
SDATE     DIM       8
SEC       FORM      5
SPECCODE  FORM      1
SPLING    FORM      2
STRTDAT   DIM       6
STRTNAM   DIM       6
.
TEMP1     FILE      ASCII,FIXED=70
TEMPAMT   FORM      6.2
TEMPFILE  DIM       8
TFEEIND   FORM      1
THCFLG    FORM      2
THDUDT1   DIM       8
THDUDT2   DIM       8
THEACHG   FORM      6.2                     * Theatre Fee
THEADTE   DIM       8
TFFSAMNT  FORM      12.2
TOTALCNT  FORM      3
.
USERID    DIM       10
URNUMBER  DIM       8
UNIQUE    FORM      8
UNIQUEX   DIM       8
UPADMTYP  DIM       1
.
VAR       DIM       127
.
WBSEUID   DIM       10
WARNINGL  DIM       20
WDATE1    DIM       8
WDATE2    DIM       8
WORK      FILE      ASCII, FIXED=256
.
XDESC     DIM       30
XXCENT    DIM       2
XXADM     DIM       6
XXDAY     DIM       2
XXMON     DIM       2
XXMULT    FORM      3
XXNAM     DIM       22
XXYEAR    DIM       2
XAMT      FORM      4.2
XMBS      FORM      5
XAMTX     DIM       7
XMBSX     DIM       5
.
ZEROINVC  DIM       1
.
. ----- Variables for automatic admission type change / exploding charges -----
.
EFTADMIN  DIM       8                       * Effective admission number
EFTATYPE  DIM       3                       * Effective admission type
EFTDATE   DIM       8                       * Effective date (ccyymmdd)
EFTTIME   DIM       8                       * Effective time
EXPCHCNT  FORM      2                       * Exploding MBS charge counter
SAVKEY12  DIM       12
SAVKEY14  DIM       14
SAVKEY34  DIM       34
.
.
.   Constants
.
CATCR     INIT      "cr"
CODEA     INIT      "A "
CODEBT    INIT      "BT"
CODECL    INIT      "CL"
CODEFA    INIT      "FA"
CODEDP    INIT      "DP"
CODEPY    INIT      "Py"
.
FIRST     FORM      "0"
.
HDUFLG    FORM      "0"
.
LWCODE    INIT      "LW"
.
MBSNUM    FORM      "0"
.
SELFLG    FORM      "0"
SP14      INIT      "              "
SP22      INIT      "                      "
SP27      INIT      "                           "
SURGFLG   FORM      "0"
.
OTCODE    INIT      "OT"
OTFLG     FORM      "0"
OPNFLAG   FORM      "0"                     * Used in stepdown
.
UKEYTMP2  INIT      " 97 U1-8 U9-17,1-8"
.
ZERO4     INIT      "0000"                  * needed by CMGETTHR
.
CFPAYCOD  DIM       3        * 3M Codefinder PAY Code
.
.
.-----------------------------------------------------------------------
PRGID     INIT      "IBAHMS19"
PRGNAM    INIT      "Invoice Pending Report"
VERSION   INIT      "V12.00.03"
.-----------------------------------------------------------------------
+
.**************************************************************************
.*                              ML0000                                    *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
ML0000    CALL      DISPHEAD
          CALL      INIT0000               * initialisation and open files
          CALL      CREA0000               * create temp file
.
          CALL      OPTN0000               * select options
          CALL      CLRT0000               * clear temp file
          CALL      INVP0000               * Invoice pending List 
.
          CALL      KILL0000               * remove temp file
.
ML9999    CHAIN     PGM                    * chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: ML0000    *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
INIT0000  CALL      DISPHEAD                  * display heading
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
.
          OPEN      PATAFEA1,"patafeaf"
          OPEN      PATASDA1,"patasdaf"
          OPEN      PATCODE1,"patcodes" 
          OPEN      PATCODE2,"patcodes" 
          OPEN      PATCMXA1,"patcmxaf"
          OPEN      PATDSCH1,"patdschf"
          OPEN      PATDSCH2,"patdschf"
          OPEN      PATDO1A1,"patdo1af"
          OPEN      PATFN1A1,"patfn1af"
          OPEN      PMSHCPA1,"pmshcpaf"
          OPEN      PATLDFA1,"patldfaf"
          OPEN      PATLSDA1,"patlsdaf"
          OPEN      PATTRAN1,"pattranf"        
          OPEN      PATTRAN2,"pattranf"        
          OPEN      PATDTRA1,"patdtraf"
          OPEN      PATDTRA3,"patdtraf"
          OPEN      PATDRGA1,"patdrgaf"
          OPEN      PATMCHG1,"patmchgf"
          OPEN      PATINVR3,"patinvrf"
          OPEN      PATFEEP1,"patfeepf"
          OPEN      PATDGWA1,"patdgwaf"
          OPEN      PATTFEE1,"pattfeef"
          OPEN      OPRDETC1,"oprdetcf"
          OPEN      OPRARDA1,"oprardaf"
          OPEN      PATCTFA1,"patctfaf"
          OPEN      PATHLFA1,"pathlfaf"
          OPEN      PATHDFA1,"pathdfaf"
          OPEN      PATRE1A1,"patre1af"
          OPEN      PATMI1A1,"patmi1af"
          OPEN      PATMI1A2,"patmi1af"
          OPEN      PATIN1A1,"patin1af"
          OPEN      PATFIGA1,"patfigaf"
          OPEN      PATFINS1,"patfinsf"
          OPEN      PATIPEN1,"patipenf"
          OPEN      PATIRNG1,"patirnge"
          OPEN      PATITEM1,"patitemn"
          OPEN      PATVADA1,"patvadaf"
          OPEN      PATDADA1,"patdadaf"
          OPEN      PATVISA1,"patvisaf"
          OPEN      PATVISA2,"patvisaf"
          OPEN      PMSVX1A1,"pmsvx1af"
          OPEN      PATMMBS1,"patmmbsf"
          OPEN      PATWR1A1,"patwr1af"
          OPEN      PMSPX2A1,"pmspx2af"
          OPEN      SCRMASA1,"scrmasaf"
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PMSMTIA1,"pmsmtiaf"
          OPEN      PMSMTIA2,"pmsmtiaf"
          OPEN      PMSEVTA1,"pmsevtaf"
          OPEN      NZPBFEA1,"nzpbfeaf"
          OPEN      NZPCFNA1,"nzpcfnaf"
          OPEN      NZPCMTA1,"nzpcmtaf"
          OPEN      NZPCMTA2,"nzpcmtaf"
          OPEN      NZPCMTA3,"nzpcmtaf"
          OPEN      NZPFIGA1,"nzpfigaf"
          OPEN      NZPFIGA2,"nzpfigaf"
          OPEN      NZPFINA1,"nzpfinaf"
          OPEN      NZPFINA2,"nzpfinaf"
          OPEN      NZPIBRA1,"nzpibraf"
          OPEN      NZPIRNA1,"nzpirnaf"
          OPEN      NZPMCHA1,"nzpmchaf"
          OPEN      NZPMCHA2,"nzpmchaf"
          OPEN      NZPPICA1,"nzppicaf"
          OPEN      NZPPICA2,"nzppicaf"
          OPEN      NZPRBRA1,"nzprbraf"
          OPEN      NZPRFNA1,"nzprfnaf"
          OPEN      NZPRFNA2,"nzprfnaf"
          OPEN      NZPPFEA1,"nzppfeaf"
          OPEN      NZPSPRA1,"nzpspraf"
          OPEN      NZPSPRA2,"nzpspraf"
          OPEN      NZPTFEA1,"nzptfeaf"
          OPEN      NZPTFEA2,"nzptfeaf"
          OPEN      OPRDETA1,"oprdetaf"
          OPEN      OPRDETA2,"oprdetaf"
          OPEN      OPRSESA1,"oprsesaf"
          OPEN      MLTCFNA1,"mltcfnaf"
          OPEN      MLTCFNA2,"mltcfnaf"
          OPEN      PRIITEM1,"priitemf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      EMRVISA1,"emrvisaf"
          TRAPCLR   IO
          MOVE      OVRCD,EMRFLAG
.
          OPEN      OUTSITA1,"outsitaf"     * Open the site file
          MOVE      "out",CFILEPRE          * Save Current File Prefix
          CALL      OPNOUT00                * Open Outpatient Files 
.
          OPEN      AAEDE1A1,"aaede1af"
          OPEN      AAEDTRE1,"aaedtref"
          OPEN      PATFX1A1,"patfx1af"
          OPEN      PATCFAA1,"patcfaaf"
.
          CALL      RDCNT000                       *Read control file
.
...  used in ABFAECCL
          CALL      TFILENAM                * Get file name calculating Exponent
          MOVE      TFILNAME,FNAMEN
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,TEMPFILE
.
...  used in PATCATBI CRMV0000
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAMEX
.
...  used in PATCATBI PTMP0000
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAMEZ
.
...  used in PATCATBI PT2P0000
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAMEY
.
...  used in PABXBILL
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,PBXFNAME
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,PBXFNAM2
.
          RETURN
.------------------------------------------------------------
.   Open outpatient files
.------------------------------------------------------------
OPNOUT00  PACK      CFNAME,CFILEPRE,FILBOKA1
          OPEN      OUTBOKA1,CFNAME
.
          PACK      CFNAME,CFILEPRE,FILDTRO1
          OPEN      OUTDTRO1,CFNAME
.
          RETURN 
.------------------------------------------------------------
.   Read the control file
.------------------------------------------------------------
RDCNT000  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          READ      CONTROLF,ZERO;*85,IBCNUGST
          READ      CONTROLF,TEN;*32,PTCNUBRD,*66,CINVLAY:
                                 *73,DD,MM,YY,*79,CAPPRVNO,*94,CAGECOFF:
                                 *104,PTCNMBSF,*166,CMEMB:             *C-47385
                                *183,CVIEWIP,*188,CCHKRAT,*192,CACCFEE:
                                *217,CAUDQ
          READ      CONTROLF,TEN3;CHADD1,CHADD2,CHPOST,CHPADD1,CHPADD2,CHPPOST:
                                  CHTELEB,*154,CUSEMBS,*163,BEDTYP:
                             *211,CINV1ST,*245,CHOSTYP
          READ      CONTROLF,TEN4;CNOCLMS,CINMES1,CINMES2:
                             *228,CINVFF,*245,CMAXINV
          READ      CONTROLF,TEN5;*247,CSTDOWN
          READ      CONTROLF,TEN8;*206,CFINAN
          READ      CONTROLF,TEN9;*212,CFEETYP,*216,CINVRIP
          READ      CONTROLF,TWENTY;*193,PTCNDCLM:
                                    *198,PTCNPIOP,PTCNBCUT,PTCNBDOM:
                                    *211,PTCNCNDY,*239,PTCNMXCH
          READ      CONTROLF,TWENTY1;*51,PTCNINVL,*60,PTCNCCRR,PTCNCLOR:
                                    *120,PTCNADDC,*136,PTCNMITM,*138,PTCNNHII:
                                    *174,PTCNDONR,*178,PTCNMPTR:
                                    *190,PTCNPCON,*200,PTCNICRA,*235,PTCNDPL8:
                                    *237,PTCNPAOF
          READ      CONTROLF,THIRTY;*132,HSTANDM,HINVDES
          READ      CONTROLF,TWENTY;*164,PTRESDAY
          READ      CONTROLF,FIFTY9;*1,CDLSTEP,*23,CFUTINV,*25,CFUTCOM:
                                   *66,CGSTPERC,CGSTITEM
          READ      CONTROLF,SEVENTY9;*248,PTCNIPEN
          READ      CONTROLF,SEVENTY7;*214,PTCNBTNM
          READ      CONTROLF,SEVENTY9;*68,PTCNMFEE,PTCNJFEE
          READ      CONTROLF,EIGHTY;*248,PTCNPEFR
          READ      CONTROLF,EIGHTY8;*248,PTCNISBZ
          READ      CONTROLF,NINTY8;*136,PTCNPAIH,*142,PTCNPAIT
          READ      CONTROLF,HUND03;*220,PTCNDEES,*221,PTCNDDES
          READ      CONTROLF,HUND05;*130,PTCNAUAT:    * auto update adm.type
                                         PTCNWSPC:    * Warning for sub-seq item
                                    *177,PTCNTFEE:    * Using theatre fees
                                    *190,PTSGCOPT     * Using suggested class.
          READ      CONTROLF,HUND12;*102,PTCNHITC
          READ      CONTROLF,HUND30;*1,PTCNHABN
.
RDCNT999  RETURN
+
.****************************************************************************
.*                                OPTN0000             Called by: ML0000    *
.*                        get user options or exit                          *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Run clean up                           *
.*                        TRUE  (1)  Exit option selected                   *
.****************************************************************************
.
OPTN0000  CALL      INTV0000
          HLINE     *G37,2,50,80
          DISPLAY   *P1:3,*EF:
                    *P2:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P2:5,*V2LON,ONE,*HOFF," = Invoice Pending Report";
.
OPTN0500  KEYIN     *P1:15,*EL,"Select Option : ":
                    *P17:15,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9500 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9000             * invoice # seq.
.
          BEEP
          GOTO      OPTN0500
.
OPTN9000  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.**************************************************************************
.                    INTV0000                     Called by : OPTN0000    *
.         Initialize all the variables before start                       *
.**************************************************************************
INTV0000  MOVE      SP10,CLAIMTYP
          MOVE      SP10,HEALTHFN
          MOVE      SP10,ADMNTYPE
          MOVE      SP10,CODESTAT
          MOVE      SP10,PTSTATUS         * keyin status
          MOVE      ZERO,CASEPAYM
          MOVE      ZERO,ZEROINVC
          MOVE      ZERO,REPRTSEQ
INTV9999  RETURN
+
.**************************************************************************
.*                               INVP0000              Called by: ML1000  *
.**************************************************************************
INVP0000  DISPLAY   *P50:2,*V2LON,"- Invoice Pending";
          CALL      KEYD0000                 * Keyin details
          CALL      CRTX0000                 * Create Export File for Excel
          CALL      CONTQST                  * Ok to continue ?
          BRANCH    CEXIT,INVP8000,INVP0000,INVP9500
.
INVP8000  CALL      PEND0000                 * Process report
          MOVE      ZERO,EXIT
          GOTO      INVP9999
.
INVP9500  MOVE      ONE,EXIT
.         
INVP9999  RETURN
.
+
.**************************************************************************
.*                            KEYD0000                                    *
.*  Keyin Claim Code, Health Fund, Admission type etc.                    *
.**************************************************************************
.         Keyin Claim Code
.
KEYD0000  MOVE      ZERO,EXIT
          DISPLAY   *P1:4,*EF:
                    *P1:5,"    Financial Class       :";
          MOVE      ONE,CNEWDS
          MOVE      TWENTY9,ECOL
          MOVE      FIVE,EVERT
          MOVE      SP3,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          MOVE      SP10,ACODE
          PACK      CODE,ANSC,ANSL,SP70
          KEYIN     *PECOL:EVERT,*V2LON,ACODE
          PACK      ACODE,ACODE,SP10
          MOVE      ACODE,CLAIMTYP
          MATCH     SP10,CLAIMTYP
          IF        @EQUAL
            MOVE      "All",CLAIMTYP
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      KEYD1200  
.
KEYD1100  DISPLAY   *P29:5,*V2LON,"ALL";
          GOTO      KEYD2000
.
KEYD1200  DISPLAY   *P35:5,TDESC;
.
.         Keyin Health Fund
.
KEYD2000  MOVE      SP8,HEALTHFN
          DISPLAY   *P1:6,"    Health Fund           :";
          MOVE      TWENTY9,ECOL
          MOVE      SIX,EVERT
          MOVE      SP10,HCODE
          MOVE      ZERO,CKYIMODE
          CALL      PATFNDKY
          MOVE      HCODE,HEALTHFN
          MATCH     SP10,HEALTHFN
          IF        @EQUAL
            MOVE      "All",HEALTHFN
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      KEYD3000
.
.         Nothing entered
.
KEYD2005  DISPLAY   *P29:6,*EL,*V2LON,"ALL"
          MOVE      SP8,HEALTHFN
          GOTO      KEYD3000
.
.         Keyin Admission Type/CMBS Class
.
KEYD3000  DISPLAY   *P1:7,"    CMBS Class            :";
.
          MOVE      ONE,CNEWDS
          MOVE      TWENTY9,ECOL
          MOVE      SEVEN,EVERT
          MOVE      SP3,CKYIDEF3
          MOVE      SP10,ACODE
          MOVE      ZERO,CKYIMAND
          MOVE      CODEA,CODE
          KEYIN     *PECOL:EVERT,*V2LON,ACODE
          PACK      ACODE,ACODE,SP10
.
          MOVE      ACODE,ADMNTYPE
          MATCH     SP10,ADMNTYPE
          IF        @EQUAL
            MOVE      "All",ADMNTYPE
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      KEYD3200
.
KEYD3100  DISPLAY   *P29:7,*V2LON,"ALL";
          GOTO      KEYD4000
.
KEYD3200  DISPLAY   *P35:7,TDESC;
.
.         Keyin the other filters
.
KEYD4000  MOVE      SP1,ANS
          KEYIN     *P1:8,"    Coded                 : ",ANS;
          PACK      ANS,ANS,SP1
          MOVE      ANS,CODESTAT
.         
          MOVE      ZERO,FORM1
          KEYIN     *P1:9,"    Casepayment           : ",FORM1;
          MOVE      FORM1,CASEPAYM
.
          MOVE      ZERO,FORM1
          KEYIN     *P1:10,"    Zero Invoice          : ",FORM1;
          MOVE      FORM1,ZEROINVC
.
          MOVE      ZERO,FORM1           * default to consolidated
          KEYIN     *P1:11,"    Status                : ",FORM1;
          IF        FORM1=0
            MOVE      ONE,FORM1          * 0 and 1 for Consolidated
          ENDIF
          MOVE      FORM1,PTSTATUS
.
          MOVE      TEN2,EVERT           * set keyin row
.
.         If this is an Inpatient only report (PTSTATUS = "3"),
.         then see if the user wants to print by invoice number or by
.         discharge date and also if only coded visits will be printed.
.
          MATCH     "3",PTSTATUS                 * inpatient only ?
          GOTO      KEYD4500 IF NOT EQUAL        * no - use invoice # sequence
.
          MOVE      ZERO,FORM1
          KEYIN     *P1:EVERT,"    Report Sequence       : ",FORM1;
          MOVE      FORM1,REPRTSEQ
          ADD       ONE,EVERT                    * increment row
.
KEYD4500  COMPARE   ONE,IBCNMHOS                 * using multi-hospital ?
          GOTO      KEYD6000 IF NOT EQUAL        * no
.
          MOVE      "29",ECOL
          DISPLAY   *P1:EVERT,"    Hospital Id           :"
          MOVE      SP3,CKYIDEF3
          MOVE      ZERO,CKYIMAND           * Not Mandatory
          OPEN      PATHSPA1,"pathspaf"
.
          CALL      PATHSPKY
          BRANCH    EXIT,KEYD5000,KEYD9000
          MOVE      PTHSHOSP,HOSPID
          MOVE      PTHSNAME,HOSPNAME
          GOTO      KEYD6000
.
KEYD5000  MOVE      "All Hospitals",HOSPNAME
          MOVE      SP70,HOSPID
.
KEYD6000  MOVE      ZERO,EXIT
          GOTO      KEYD9999
.
KEYD9000  MOVE      ONE,EXIT
.
KEYD9999  RETURN
+
.****************************************************************************
.*                                CRTX0000             Called by: ML0000    *
.* Create export file for excel                                             *
.****************************************************************************
CRTX0000  MOVE      ZERO,EXIT
          ADD       ONE,EVERT                    * increment row
          MOVE      ZERO,EXPORTFL                  * No to create export file
          DISPLAY   *P1:EVERT,"Create Export file for Excel : "
          KEYIN     *P32:EVERT,*V2LON,*RV,DIM1:
                    *P32:EVERT,*DV,DIM1
          REP       UPPLOW,DIM1
          DISPLAY   *P32:EVERT,*V2LON,DIM1
          MOVE      ONE,EXPORTFL
          MATCH     "Y",DIM1
          GOTO      CRTX9999 IF EQUAL
          MOVE      ZERO,EXPORTFL
.
CRTX9999  RETURN
+
.------------------------------------------------------------
.  Invoice Pending 
.------------------------------------------------------------
PEND0000  MOVE      ONE,WEBFLAG
          MOVE      ONE,PROGFLAG            * Flag to workout tobe invoiced amt
          MOVE      ZERO,GRNDTOT
          MOVE      ZERO,GRNDNET
          MOVE      ZERO,SAVPAGEN
          CALL      IBACLOCK
          IF        REPRTSEQ <> 1
            CALL      PRHD0000              * Print heading
          ENDIF
.
          IF        EXPORTFL=1
            CALL      EHED0000               * Print the heading
            MOVE      ZERO,CLNO
          ENDIF
.
          PACK      KEY8,SP70
          CALL      RDSIPEN1
          IF        OVRCD=0
            CALL      RDPIPEN1
          ENDIF 
.
PEND1000  CALL      RDKIPEN1
          BRANCH    OVRCD,PEND9000
.
          MOVE      IPADMNO,PVIBILL
          MOVE      PVIBILL,KEY8
          CALL      RDVISA1
          BRANCH    OVRCD,PEND1000
          MOVE      PVIBILL,AADMNO
.
          MOVE      PVIURNO,PURNO
          MOVE      PURNO,KEY8
          CALL      RDMAST1
          BRANCH    OVRCD,PEND1000
.
          PACK      KEY8,AADMNO,SP8
          CALL      RDPMVX11
          IF        OVRCD=1
            MOVE      SP70,PMVXATCP
            MOVE      SP70,PMVXMHOS
          ENDIF
.
          IF        IBCNMHOS =1
            MATCH     SP10,HOSPID
            IF        !@EQUAL
              MATCH     PMVXMHOS,HOSPID
              GOTO      PEND1000 IF NOT EQUAL
            ENDIF
          ENDIF
.
          MOVE      SP70,ACLSS
          MOVE      SP10,DDATE
          MOVE      PVIURNO,URNUMBER
          MOVE      PVIBILL,ADMISSNO
          MOVE      SP10,PTMICMXP
          MOVE      SP10,SYSTEM
          MOVE      SP70,ACODDTE
          MOVE      SP70,AFUNDH
.
          MOVE      ZERO,FORM1
          MOVE      PTSTATUS,FORM1
.
          MOVE      ZERO,EXIT
          BRANCH    IPSYSTM,PEND2000,PEND3000,PEND4000,PEND3000
          GOTO      PEND1000
.
PEND2000  IF        FORM1=1 | FORM1=2
            CALL      RREC0000             * emergency record
            BRANCH    EXIT,PEND1000
            MOVE      "EMR",SYSTEM
            GOTO      PEND5000
          ENDIF
          GOTO      PEND1000
.
PEND3000  IF        FORM1=1 | FORM1=4
            CALL      OREC0000             * outpatient record
            BRANCH    EXIT,PEND1000
            MOVE      "OUT",SYSTEM
            GOTO      PEND5000
          ENDIF
          GOTO      PEND1000
.
PEND4000  IF        FORM1=1 | FORM1=3
            CALL      IREC0000             * inpatient record
            BRANCH    EXIT,PEND1000
            MOVE      "INP",SYSTEM
            GOTO      PEND5000
          ENDIF
          GOTO      PEND1000
.
PEND5000  MOVE      PTITL,PACTITLE      * setup patient name
          MOVE      PSNAME,PACSNAME
          MOVE      PGNAME,PACGNAME
          MOVE      TWO,PACFRMT
          CALL      PACNAME
.
.       If the invoice is for zero amount, and zero bed days, then ignore it
.
          MOVE      NETTOT,GROSSTOT
.
          CALL      CHLD0000                      * Check Hold invoice status
.
          COMPARE   ZERO,GROSSTOT
          GOTO      PEND6000 IF NOT EQUAL
          COMPARE   ZERO,TOTDAYS
          GOTO      PEND1000 IF EQUAL
.
.       Check if zero invoice to be included/excluded or print only zero inv.
.
          CMATCH    "1",ZEROINVC
          GOTO      PEND1000 IF EQUAL      * Exclude zero invoice
          GOTO      PEND8000
.
PEND6000  CMATCH    "2",ZEROINVC
          GOTO      PEND1000 IF EQUAL      * Only zero invoice
.
.       Process any pending cash
.
PEND8000  CALL      GETCASH
          SUB       CSAMT,NETTOT
.
          ADD       GROSSTOT,GRNDTOT
          ADD       NETTOT,GRNDNET
          CALL      PRTD0000                * print invoice row
          GOTO      PEND1000
.
.         If we are only printing Inpatients by discharge date sequence,
.         then we have processed all the records and now we only have to
.         print them from the temp file.
.
PEND9000  IF        REPRTSEQ = 1
            CALL      DSEQ0000
          ENDIF
.
          BRANCH    EXPORTFL,PEND9999
.
          PRINT     *114,"---------",*124,"---------":
                    *N,*113,GRNDTOT,*123,GRNDNET
.
PEND9999  RETURN
+
.*******************************************************************************
.           Check Status of Hold invoice
.*******************************************************************************
CHLD0000  MATCH     SP70,PTIPRHLD
          GOTO      CHLD0200 IF EQUAL      * not on hold
.
.         Invoice already on hold, check for Patient hold invoice
.
          MOVE      "rh",KEY2
          PACK      KEY5,KEY2,PTIPRHLD
          CALL      RDCODE1
          BRANCH    OVRCD,CHLD0200
.
          MATCH     "P",TCINDC2
          GOTO      CHLD9999 IF EQUAL             * Patient hold invoice
.
          MATCH     "C",TCINDC4
          GOTO      CHLD9999 IF EQUAL             * CodeFocus hold invoice
.
CHLD0200  UNPACK    SP70,PENDHOSP,PENDDDAT,PENDCLAM,PENDFUND
          IF        IBCNMHOS=1
            MOVE      PMVXMHOS,PENDHOSP            * hospital id
          ENDIF
          MOVE      ZERO,F2
          MOVE      IPSYSTM,F2
          MOVE      F2,PENDSYST                    * system
.
          MOVE      ADATE,PENDADAT               * Admission date
          MOVE      ADATE,PENDSDAT               * as at date
          MOVE      ACLAIM,PENDCLAM              * claim code
          MOVE      AFUNDH,PENDFUND              * health fund
          MOVE      DDATE,PENDDDAT               * discharge date
.
          CALL      IPRH0000
          CALL      UPIPEN1                        * Update Hold Invoice status
.
CHLD9999  RETURN
+
.------------------------------------------------------------
.         Inpatient record
.------------------------------------------------------------
IREC0000  MOVE      ZERO,EXIT
          MOVE      IPADMNO,KEY8
          CALL      RDMISS1
          BRANCH    OVRCD,IREC9000
          BRANCH    ASTAT,IREC9000,IREC1000,IREC1000,IREC1000
          GOTO      IREC9000
.
IREC1000  CALL      VREC0000             * Validate record
          BRANCH    EXIT,IREC9000
.
          CALL      CLPATDSC                * clear discharge record
          COMPARE   THREE TO ASTAT
          GOTO      IREC2500 IF NOT EQUAL        * not discharge
.
          MOVE      AADMNO,KEY8
          CALL      RDDSCH1
          BRANCH    OVRCD,IREC9000
.
.       Inpatient to be invoiced
.
IREC2500  CALL       ISBITEMS               * Update item for Ind.Services Bill?
.
          MOVE      ZERO,DISPROG
          IF        IBCNUGST=2
            MOVE      ZERO,IBCNUGST         * set no GST for pending report
            CALL      CALCTBI
            MOVE      TWO,IBCNUGST
          ELSE
            CALL      CALCTBI
          ENDIF
          GOTO      IREC9999
.
IREC9000  MOVE      ONE,EXIT
IREC9999  RETURN
+
.------------------------------------------------------------
.         Outpatient record
.------------------------------------------------------------
OREC0000  MOVE      ZERO,EXIT
          COMPARE   FOUR,IPSYSTM
          GOTO      OREC3200 IF NOT EQUAL
.
.         Other financial
.
          MOVE      "out",OSTFILE
          MOVE      PVIURNO,PURNO
          MOVE      SP10,OTBBFUND
          MOVE      SP3,OBACOMP
          MOVE      SP3,OBACLASS
          MOVE      SP10,OBADATE
          GOTO      OREC3400
.
.         Outpatient
.
OREC3200  MOVE      SP3,OSTSYST
          MOVE      "out",OSTFILE
          MOVE      PVISITE,KEY6
          CALL      RDSITA1
.
.        Get the finanical booking details
.
          PACK      CFNAME WITH OSTFILE,FILBB1A2
          CLOSE     OUTBB1A2
          CALL      OPOTBB12
.
          CLOSE     OUTDTRO1
          PACK      CFNAME,OSTFILE,FILDTRO1
          OPEN      OUTDTRO1,CFNAME
.
          PACK      KEY16,PVIDATE,PVIBILL
          CALL      RDBOKB2
          BRANCH    OVRCD,OREC9000
.
OREC3400  MOVE      PVISITE,OBASITE
          MOVE      OBADATE,ADATE
          MOVE      OBACOMP,ACLAIM
          MOVE      OBACLASS,ATYPE
          MOVE      OTBBFUND,AFUNDH
          MOVE      OTBBTBLE,AFNDTB
          MOVE      SP10,ACODDTE
          MOVE      SP10,PTMICMXP
          CALL      VREC0000             * Validate record
          BRANCH    EXIT,OREC9000
.
          IF        IBCNUGST=2
            MOVE      ZERO,IBCNUGST         * set no GST for pending report
            CALL      OUTTBI
            MOVE      TWO,IBCNUGST
          ELSE
            CALL      OUTTBI
          ENDIF
          MOVE      ZERO,TOTDAYS
          GOTO      OREC9999
.
OREC9000  MOVE      ONE,EXIT
OREC9999  RETURN
+
.---------------------------------------------------
.        Emergency record
.---------------------------------------------------
RREC0000  MOVE      ZERO,EXIT
          COMPARE   NINE,PVITYPE
          GOTO      RREC2000 IF NOT EQUAL
.
          MOVE      PVIURNO,ADAURNO
          MOVE      PVIBILL,ADANUMB
          MATCH     " 1",PVISYST
          GOTO      RREC2000 IF NOT EQUAL        * Not an event
.
          MOVE      PVIBILL,KEY8
          CALL      RDPMEVT1
          BRANCH    OVRCD,RREC2000
.
          PACK      KEY5,ANSE,ANSV,PMEVEVNT,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,RREC2000
          MATCH     ANSE,TCINDC1
          GOTO      RREC2000 IF NOT EQUAL         * Not Emergency event
.
          MOVE      PMEVADTE,ADATE
          MOVE      PMEVCCOD,ACLAIM
          MOVE      PMEVADMT,ATYPE
          UNPACK    SP70,AFUNDH,AFNDTB,ACODDTE,PTMICMXP
          MOVE      PMEVDDTE,DDATE
          GOTO      RREC8000
.
RREC2000  MOVE      PVIBILL,KEY8
          CALL      RDDETA1
          BRANCH    OVRCD OF RREC9000
.
          UNPACK    ADADATE,ADATE
          MOVE      ADACOMP,ACLAIM
          MOVE      ADACLASS,ATYPE
          MOVE      AEDAFUND,AFUNDH
          MOVE      AEDATBLE,AFNDTB
          MOVE      SP10,ACODDTE
          MOVE      SP10,PTMICMXP
.
          PACK      KEY8,PVIBILL
          CALL      RDEMVIS1
          IF        OVRCD=0
.
            COMPARE   FOUR,EMVISTAT
            GOTO      RREC9000 IF EQUAL
. 
            MOVE      EMVIDDAT,DDATE
            MOVE      EMVIFUND,AFUNDH
            MOVE      EMVITABL,AFNDTB
          ENDIF
.
RREC8000  CALL      VREC0000             * Validate record
          BRANCH    EXIT,RREC9000
.
          IF        IBCNUGST=2
            MOVE      ZERO,IBCNUGST         * set no GST for pending report
            CALL      AAETBI
            MOVE      TWO,IBCNUGST
          ELSE
            CALL      AAETBI
          ENDIF
          MOVE      ZERO,TOTDAYS
          GOTO      RREC9999
.
RREC9000  MOVE      ONE,EXIT
RREC9999  RETURN
+
.------------------------------------------------------------
.         Validate record
.------------------------------------------------------------
VREC0000  MOVE      ZERO,EXIT
          MATCH     SP70,CLAIMTYP
          GOTO      VREC1000 IF EQUAL      * all claim code
          MATCH     "All",CLAIMTYP
          GOTO      VREC1000 IF EQUAL      * all claim code
          MATCH     ACLAIM,CLAIMTYP
          GOTO      VREC9000 IF NOT EQUAL
.
VREC1000  MATCH     SP70,HEALTHFN
          GOTO      VREC2000 IF EQUAL      * all health fund
          MATCH     "All",HEALTHFN
          GOTO      VREC2000 IF EQUAL      * all health fund
          MATCH     AFUNDH,HEALTHFN
          GOTO      VREC9000 IF NOT EQUAL
.
VREC2000  MATCH     SP70,ADMNTYPE
          GOTO      VREC3000 IF EQUAL
          MATCH     "All",ADMNTYPE
          GOTO      VREC3000 IF EQUAL
          MATCH     ATYPE,ADMNTYPE
          GOTO      VREC9000 IF NOT EQUAL
.
VREC3000  MOVE      ZERO,FORM1
          MOVE      CODESTAT,FORM1
.
.         FORM1 = 0 for all, 1 for Coded patient only, 2 for Not coded
.
          BRANCH    FORM1,VREC3100,VREC3200
          GOTO      VREC4000                 * all
.
VREC3100  MATCH     SP10,ACODDTE
          GOTO      VREC9000 IF EQUAL        * not coded
          GOTO      VREC4000
.
VREC3200  MATCH     SP10,ACODDTE
          GOTO      VREC9000 IF NOT EQUAL    * coded
          GOTO      VREC4000
.
VREC4000  MOVE      ZERO,FORM1
          MOVE      CASEPAYM,FORM1            * casepayment
.
.         FORM1 = 0 for all, 1 for C/P patient only, 2 for Not Casepayment
.
          BRANCH    FORM1,VREC4100,VREC4200
          GOTO      VREC9999                 * all
.
VREC4100  MATCH     ANSY,PTMICMXP
          GOTO      VREC9999 IF EQUAL        * casepayment
          GOTO      VREC9000
.
VREC4200  MATCH     ANSY,PTMICMXP
          GOTO      VREC9999 IF NOT EQUAL    * not casepayment
.
VREC9000  MOVE      ONE,EXIT
VREC9999  RETURN
+
.*****************************************************************************
.*                          DSEQ0000               Called by:                *
.*            Print the report in discharge date sequence                    *
.*****************************************************************************
.
DSEQ0000  CALL      IBACLOCK                     * get current date/time
          CALL      PRHD0000                     * print heading
.
          MOVE      SP20,KEY17
          CALL      RSTEMP3                      * position at start of file
DSEQ0500  CALL      RKTEMP3                      * read next record
          BRANCH    OVRCD,DSEQ9999               * eof - finished
.
          COMPARE   FIFTY5,CLNO                  * page full ?
          CALL      PRHD0000 IF NOT LESS         * yes
.
          UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                      * format discharge date
.
          MOVE      "INP",SYSTEM
          IF        EXPORTFL=1
            MOVE      SP70,ACLSS
            MOVE      SP70,ACODDTE
            MOVE      SP70,PMVXATCP
            MOVE      SP70,PMVXMHOS
.
            MOVE      ADMISSNO,KEY8
            CALL      RDMISS1
            CALL      RDPMVX11
.
            MOVE      "N",KEY1
            MATCH     SP70,ACODDTE
            IF        !@EQUAL
              MOVE      "Y",KEY1                * Coding Complete
            ENDIF
.
            MOVE      SP3,DIM3T                 * All theatre charges posted
            MATCH     "1",PMVXATCP              * if Yes
            GOTO      DSEQ6700 IF EQUAL
.
            PACK      KEY31,IPADMNO,SP70
            CALL      RSOPDEA2
DSEQ6000    CALL      RKOPDEA2                  * read oprdetaf Theatre Booking
            BRANCH    OVRCD,DSEQ6500
.
            MATCH     DIPADMNO,OPDAADMN
            GOTO      DSEQ6500 IF NOT EQUAL
.
            MATCH     "3",DOPDASTA              * if booking Cancelled
            GOTO      DSEQ6500 IF EQUAL
.
            MATCH     "2",DOPDASTA              * if booking Admitted
            GOTO      DSEQ6600 IF EQUAL
.
            MATCH     "4",DOPDASTA              * if booking Discharged
            GOTO      DSEQ6600 IF EQUAL
.
            GOTO      DSEQ6000                  * next record
.
DSEQ6500    MOVE      "N/A",DIM3T
            GOTO      DSEQ7000
.
DSEQ6600    MOVE      "N",DIM3T
            GOTO      DSEQ7000
.
DSEQ6700    MOVE      "Y",DIM3T
            GOTO      DSEQ7000
.
DSEQ7000    PRINT     "<tr><td>",ADMISSNO,"</td>":
                      "<td>",AURNO,"</td>":
                      "<td>",KEY21,"</td>":
                      "<td>",FRMADATE,"</td>":
                      "<td>",CPCDATE,"</td>"
.
            PRINT     "<td>",ACLAIM,"</td>":
                      "<td>&nbsp;",FRMHFUND,"</td>":
                      "<td>",ACLSS,"</td>":
                      "<td>",KEY1,"</td>":
                      "<td>",DIM3T,"</td>":
                      "<td>",ATYPE,"</td>":
                      "<td>",TOTDAYS,"</td>":
                      "<td>",FORM7P2A,"</td>":
                      "<td>",FORM7P2B,"</td>":
                      "<td>",PTIPRHLD,"</td>"
.
          IF        IBCNMHOS=1
            PRINT    "<td>&nbsp;",PMVXMHOS,"</td>"
          ENDIF
          PRINT    "</tr>"
.
          ELSE
            PRINT     *1,ADMISSNO,*11,SYSTEM,*16,DIM9,*26,KEY21:
                      *48,FRMADATE,*59,CPCDATE,*70,ACLAIM,*75,FRMHFUND:
                      *89,ATYPE,*94,CODED,*99,CASEPAY,*106,TOTDAYS:
                      *113,FORM7P2A,*123,FORM7P2B
            ADD       ONE,CLNO                     * increment line number
          ENDIF
.
          GOTO      DSEQ0500                     * get next record
.
DSEQ9999  RETURN
+
.------------------------------------------------------------
.  PRTD0000 - Print Invoice pending line
.  If we are printing in invoice number sequence, then this
.  routine formats and prints the details for the current record.
.
.  If we are printing in discharge date sequence, then we simply
.  need to format the data, but instead of printing now, write the
.  data to a temp file so that at the end of processing all
.  the records, we can then loop through the temp file in
.  discharge date sequence and print each record.
.------------------------------------------------------------
PRTD0000  IF        REPRTSEQ <> 1
            COMPARE   "55",CLNO
            CALL      PRHD0000 IF NOT LESS
          ENDIF
.
          MOVE      SP10,CODED
          MOVE      SP10,CASEPAY
          IF        IPSYSTM=3
            MOVE      "No ",CODED             * set coding data
            MATCH     SP10,ACODDTE
            IF        !@EQUAL
              MOVE      "Yes",CODED
            ENDIF
.
            MOVE      "No ",CASEPAY           * set casepayment data
            MATCH     "Y",PTMICMXP
            IF        @EQUAL
              MOVE      "Yes",CASEPAY
            ENDIF
          ENDIF
.
          MOVE      IPADMNO,ADMISSNO
          MOVE      URNUMBER,PURNO
.
          UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,FRMADATE
.
          MOVE      SP70,KEY21
          MOVE      PACFNAME,KEY21
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,HUND10;*249,PTCNDAUR
          PACK      DIM9,URNUMBER,SP70
          MATCH     "1",PTCNDAUR
          IF        @EQUAL
            MOVE      URNUMBER,PURNO
            PACK      KEY20,SP70
            PROC      GETALIDS
            MATCH     SP70,KEY20
            IF        !@EQUAL
              UNPACK    KEY20,DIM11,DIM9
            ENDIF
          ENDIF
.
          PACK      DIM1,SP70
          MATCH     "1",PTCNHITC
          GOTO      PRTD1000 IF NOT EQUAL
.
          PACK      KEY8,ADMISSNO,SP8
          CALL      RDPTVIS1
          BRANCH    OVRCD,PRTD1000
.
          COMPARE   THREE,PVITYPE
          GOTO      PRTD1000 IF NOT EQUAL
.
          MATCH     "1",PMVXATCP
          IF        !@EQUAL
            MOVE      "*",DIM1
          ENDIF
.
PRTD1000  IF        REPRTSEQ <> 1
            IF        EXPORTFL=1
            PRINT     "<tr><td>",ADMISSNO,"</td>":
                      "<td>",DIM9,"</td>":
                      "<td>",KEY21,"</td>":
                      "<td>",CPCDATE,"</td>"
            ELSE
              PRINT     *1,ADMISSNO,*11,SYSTEM,*16,DIM9,*26,KEY21:
                        *48,CPCDATE;
            ENDIF
          ENDIF
.
.         If we are printing by discharge date, make sure that there
.         is a discharge date.  if not, then ignore the record and
.         subtract the corresponding dollar amounts from the grand totals.
.         
          IF        REPRTSEQ <> 1
            MATCH     SP10,DDATE
            IF        !@EQUAL
              UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
              CALL      PACDATE
              IF        EXPORTFL=1
                PRINT     "<td>",CPCDATE,"</td>"
              ELSE
                PRINT     *59,CPCDATE;
              ENDIF
            ELSE
              IF      EXPORTFL=1
                PRINT   "<td>&nbsp;</td>"
              ENDIF
            ENDIF
          ELSE
            MATCH     SP10,DDATE                 * blank discharge date ?
            IF        @EQUAL
              SUB       GROSSTOT,GRNDTOT         * yes - ignore record
              SUB       NETTOT,GRNDNET
              GOTO      PRTD9999
            ENDIF
          ENDIF
.
          MOVE      SP20,FRMHFUND
          MATCH     SP10,AFUNDH
          IF        !@EQUAL
            MOVE      SP10,KEY6
            MOVE      AFNDTB,KEY6
            PACK      FRMHFUND,AFUNDH,SLASH,KEY6
            IF        REPRTSEQ <> 1
              IF         EXPORTFL=1
                PRINT     "<td>",ACLAIM,"</td>":
                          "<td>",FRMHFUND,"</td>"
              ELSE
                PRINT     *70,ACLAIM,*75,AFUNDH,SLASH,KEY6;
              ENDIF
            ENDIF
          ELSE
            IF        REPRTSEQ <> 1
              IF        EXPORTFL=1
                PRINT     "<td>",ACLAIM,"</td>":
                          "<td>&nbsp;</td>"
              ELSE
                PRINT     *70,ACLAIM;
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      GROSSTOT,FORM7P2A
          MOVE      NETTOT,FORM7P2B
          IF        REPRTSEQ <> 1
            IF        EXPORTFL=1
              MOVE      "N",KEY1
              MATCH     SP70,ACODDTE
              IF        !@EQUAL
                MOVE      "Y",KEY1                * Coding Complete
              ENDIF
.
            MOVE      SP3,DIM3T                 * All theatre charges posted
            MATCH     "1",PMVXATCP              * if Yes
            GOTO      PRTD2700 IF EQUAL
.
            PACK      KEY31,IPADMNO,SP70
            CALL      RSOPDEA2
PRTD2000    CALL      RKOPDEA2                  * read oprdetaf Theatre Booking
            BRANCH    OVRCD,PRTD2500
.
            MATCH     DIPADMNO,OPDAADMN
            GOTO      PRTD2500 IF NOT EQUAL
.
            MATCH     "3",DOPDASTA              * if booking Cancelled
            GOTO      PRTD2500 IF EQUAL
.
            MATCH     "2",DOPDASTA              * if booking Admitted
            GOTO      PRTD2600 IF EQUAL
.
            MATCH     "4",DOPDASTA              * if booking Discharged
            GOTO      PRTD2600 IF EQUAL
.
            GOTO      PRTD2000                  * next record
.
PRTD2500    MOVE      "N/A",DIM3T
            GOTO      PRTD3000
.
PRTD2600    MOVE      "N",DIM3T
            GOTO      PRTD3000
.
PRTD2700    MOVE      "Y",DIM3T
            GOTO      PRTD3000
.
PRTD3000      PRINT     "<td>",ACLSS,"</td>":
                        "<td>",KEY1,"</td>":
                        "<td>",DIM3T,"</td>":
                        "<td>",ATYPE,"</td>":
                        "<td>",TOTDAYS,"</td>":
                        "<td>",FORM7P2A,"</td>":
                        "<td>",FORM7P2B,"</td>":
                        "<td>",PTIPRHLD,"</td>"
.
              IF        IBCNMHOS=1
                PRINT    "<td>",PMVXMHOS,"</td>"
              ENDIF
              PRINT    "</tr>"
.
            ELSE
              PRINT     *89,ATYPE:
                        *94,CODED,*99,CASEPAY,*106,TOTDAYS:
                        *113,FORM7P2A,*123,FORM7P2B
            ENDIF
          ENDIF
.
          ADD       ONE,CLNO                     * increment line count
.
.         If this a discharge sequence report, then write the details
.         for the current record to the temp file.
.
          IF        REPRTSEQ = 1
            CALL      WRTEMP2
          ENDIF
.
PRTD9999  RETURN
+
.------------------------------------------------------------
.      Print heading
.------------------------------------------------------------
PRHD0000  BRANCH    EXPORTFL,PRHD9999
.
          MOVE      SAVPAGEN,CPAGENO
          CALL      HEAD132
          MOVE      CPAGENO,SAVPAGEN
.
          IF        IBCNMHOS =1
            PRINT     *40,"Hospital : ",HOSPID,"    ",HOSPNAME
          ENDIF
.
          MOVE      SP70,KEY50
          MOVE      CONS,KEY50
          MOVE      PTSTATUS,FORM1
          LOAD      KEY50,FORM1,CONS,EMR,INP,OUT
          PRINT     *40,KEY50;
.
          MATCH     "All",CLAIMTYP
          IF        !@EQUAL
            PACK      KEY5,ANSC,ANSL,CLAIMTYP
            CALL      RDCODE1
            IF        OVRCD=0
              PRINT     *N,*40,"Financial Class: ",CLAIMTYP,"  ",TDESC;
              GOTO      PRHD2000
            ENDIF
          ENDIF
          PRINT     *N,*40,"Financial Class: ",CLAIMTYP;
.
PRHD2000  MATCH     "All",HEALTHFN
          IF        !@EQUAL
            PACK      KEY14,HEALTHFN,ZERO8,SP70
            CALL      RDFUND1
            IF        OVRCD=0
              PRINT     *N,*40,"Health Fund : ",HEALTHFN,"  ",HFNAME;
              GOTO      PRHD3000
            ENDIF
          ENDIF
          PRINT     *N,*40,"Health Fund : ",HEALTHFN;
.
PRHD3000  MATCH     "All",ADMNTYPE
          IF        !@EQUAL
            PACK      KEY5,ANSA,SP1,ADMNTYPE
            CALL      RDCODE1
            IF        OVRCD=0
              PRINT     *N,*40,"CMBS Class  : ",ADMNTYPE,"  ",TDESC
              GOTO      PRHD4000
            ENDIF
          ENDIF
          PRINT     *N,*40,"CMBS Class  : ",ADMNTYPE
.
PRHD4000  PRINT     *N,*1,"Visit",*11,"Sys.",*16,"U/R":
                    *48,"Adm.",*59,"Disc.":
                    *70,"Fin.",*89,"CMBS":
                    *99,"Case",*104,"Days to":
                    *114,"Amt to be",*124,"Amt less":
                    *N,*1,"Number",*16,"Number":
                    *27,"Patient Name":
                    *48,"Date",*59,"Date":
                    *70,"Clas",*75,"Health Fund",*89,"Clas":
                    *94,"Code",*99,"Paym",*104,"Invoice":
                    *114,"Invoiced",*124,"CashRecvd":
                    *N,*1,"--------",*11,"----",*16,"--------":
                    *26,"---------------------":
                    *48,"----------",*59,"----------":
                    *70,"----",*75,"------------",*89,"----":
                    *94,"----",*99,"----",*104,"-------":
                    *114,"---------",*124,"---------"
.
          MOVE      TEN1,CLNO
          IF        IBCNMHOS=1
            ADD       ONE,CLNO
          ENDIF
.
PRHD9999  RETURN
+
.------------------------------------------------------------------------------
.         Routine to print heading for Export File
.------------------------------------------------------------------------------
EHED0000  PRINT     "<table border=1><tr><td width=10%>Admission No.</td>":
                    "<td>U/R No.</td>":
                    "<td>Patient Name</td>":
                    "<td>Billing Date</td>":
                    "<td>Discharge Date</td>":
                    "<td>Compensation Code</td>":
                    "<td>Health Fund</td>":
                    "<td>Patient Category</td>":
                    "<td>Coding Complete</td>"
.
          PRINT     "<td>All Theatre Charges Posted</td>":
                    "<td>Patient Class</td>":
                    "<td>Days to Invoice</td>":
                    "<td>Amt to be Invoiced</td>":
                    "<td>Amount Less Cash Received</td>":
                    "<td>Reason for Hold</td>"
.
          IF        IBCNMHOS=1
            PRINT    "<td>Hospital Id</td>"
          ENDIF
.
          PRINT    "</tr>"
.
EHED9999  RETURN
+
.
.      These are dummy routine's that need to be defined for
.      PATDSBFE,PATCRATE,PATINVS.
.------------------------------------------------------------
SBDY0000
PROCOUTI
PROCAAEI
PATSTRYR
PROFLD00
SETPAR00
CLRPAR00
WEBERR00
ADDWRN00
DOCNM000
          RETURN
.------------------------------------------------------------
. Procedure to get Doctor Code from Outpatient Clinic ID
. COPTION - 1 Return DOCTCODE
.           2 Output Location
.           3 (N/A)
.           4 Output Menu Type
.           5 Output Unit
.------------------------------------------------------------
          DEFPROC  OUTDET00
.
          INC      OUTPREFD/INC
          INC      OUTCLIFD/INC
          INC      OUTBOAFD/INC
          INC      OUTMA1FD/INC
          INC      OUTBB1FD/INC
.
KEYBOA    DIM      28
KEYCLI    DIM      20
.
          MOVE     SP70,DOCTCODE
          COMPARE  ZERO,PVITYPE
          GOTO     OUTDET50 IF EQUAL
.
          PACK     KEY6,PVISITE,SP70
          CALL     RDSITA1
          BRANCH   OVRCD,OUTDET95
.
          PACK     KEYCLI,PVISITE,PVIDOCT,PVIDATE,SP70
          BRANCH   COPTION,OUTDET60
.
          PACK     KEY8,OSTFILE,FILBOKA1 * Determine Location from Masterfile
          TRAP     OVERCOND IF IO
          OPEN     OUTBOKA1,KEY8         * Master
          TRAPCLR  IO
          BRANCH   OVRCD,OUTDET95
.
          PACK     KEYBOA,PVISITE,PVIDOCT,PVIDATE,SP70
          PACK     KEY28,PVISITE,PVIDOCT,PVIDATE,SP70
          PACK     KEY20,PVISITE,PVIDOCT,PVIDATE,SP70
          CALL     RDSBOKA1
OUTDET10  CALL     RDKBOKA1
          BRANCH   OVRCD,OUTDET95
          PACK     KEYBOA,OBASITE,OBACLIN,OBADATE,OBASTRT,OBASLOT,SP70
          MATCH    KEY20,KEYBOA
          GOTO     OUTDET95 IF NOT EQUAL
          MATCH    OBAOUTNO,PVIBILL         * Set up billing number
          GOTO     OUTDET10 IF NOT EQUAL
          GOTO     OUTDET80
.
OUTDET50  MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     OUTPREA1,"outpreaf"   * Pre Attendance File
          TRAPCLR  IO
          BRANCH   OVRCD,OUTDET95
          MOVE     ADMISSNO,KEY8
          CALL     RDPREA1               * Check for Pre-Attendance
          BRANCH   OVRCD,OUTDET95
.
          PACK     KEY6,OPRSITE,SP70
          CALL     RDSITA1
          BRANCH   OVRCD,OUTDET95
.
          PACK     KEYCLI,OPRSITE,OPRCLIN,OPRDATE,SP70
          PACK     KEYBOA,OPRSITE,OPRCLIN,OPRDATE,OPRSTRT,OPRSLOT
.
          BRANCH   COPTION,OUTDET60,OUTDET70,OUTDET70,OUTDET70
.
OUTDET60  MOVE     ZERO,OVRCD
          PACK     KEY8,OSTFILE,FILCLIA1 * Determine Doctor from Clinic ID
          TRAP     OVERCOND IF IO
          OPEN     OUTCLIA1,KEY8         * Clinic Details
          TRAPCLR  IO
          BRANCH   OVRCD,OUTDET95
.
          PACK     KEY20,KEYCLI,Z70  * Read for Current Effective Clinic
          CALL     RDCLIA1
          COMPARE  ONE,OVRCD
          GOTO     OUTDET65 IF NOT EQUAL
.
          PACK     KEY20,KEYCLI,Z70  * Read for Current Effective Clinic
          CALL     RDSCLIA1
          CALL     RDPCLIA1
          BRANCH   OVRCD,OUTDET95
.
OUTDET65  MOVE     OCADOCT,DOCTCODE
          MATCH    SP70,DOCTCODE
          IF       @EQUAL
            MOVE     OCACCONS,DOCTCODE
          ENDIF
.
          MOVE     ZERO,EXIT
          GOTO     OUTDET99
.
OUTDET70  PACK     KEY8,OSTFILE,FILBOKA1 * Determine Location from Masterfile
          TRAP     OVERCOND IF IO
          OPEN     OUTBOKA1,KEY8         * Master
          TRAPCLR  IO
          BRANCH   OVRCD,OUTDET95
.
          MOVE     KEYBOA,KEY28
          CALL     RDBOKA1
          BRANCH   OVRCD,OUTDET95
.
OUTDET80  IF       COPTION=4
            PACK     MENUTYPE,TWO,OBASTAT * Outpatient Booking
            MOVE     ZERO,EXIT
            GOTO     OUTDET99
          ENDIF
.
          IF       COPTION=5
            PACK     CFNAME,OSTFILE,FILBB1A1
            CALL     OPOTBB11
            MOVE     ADMISSNO,KEY8
            CALL     RDBOKB1
            IF       OVRCD=0
              MATCH    SP6,OTBBDEPT
              GOTO     OUTDET95 IF EQUAL
              MOVE     OTBBDEPT,CODE       * Unit code
              MOVE     ZERO,EXIT
            ENDIF
            GOTO     OUTDET99
          ENDIF
.
          MOVE     ZERO,OVRCD
          PACK     KEY8,OSTFILE,FILMA1A1  * Determine Location from Masterfile
          TRAP     OVERCOND IF IO
          OPEN     OUTMA1A1,KEY8          * Master
          TRAPCLR  IO
          BRANCH   OVRCD,OUTDET95
.
          PACK     KEY18,OBASITE,OBACLIN,OBADAY,OBASTRT
          CALL     RDMASA1
          BRANCH   OVRCD,OUTDET95
.
          WRITE    HTMLFILE;OTMACLOC;
          MOVE     ZERO,EXIT
          GOTO     OUTDET99
.
OUTDET95  MOVE     ONE,EXIT
          GOTO     OUTDET99
.
          INC       OUTCLIIO/INC
          INC      OUTPREIO/INC
          INC       OUTBOAIO/INC
          INC       OUTMA1IO/INC
          INC       IBAOVRIO/INC
          INC       OUTBB1IO/INC
.
OUTDET99  ENDPROC
.------------------------------------------------------------
. Procedure to get Emergency Details
.   COPTION = 1 Return Consultant DOCTCODE
.             2 Output Location
.             3 Output Triage Status
.             4 Output Menu Type
.------------------------------------------------------------
          DEFPROC  EMRCHK00
.
          INC      EMRVISFD/INC
          INC      EMRLOCFD/INC
.
EMRCHK10  MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     EMRVISA1,"emrvisaf"
          TRAPCLR  IO
          BRANCH   OVRCD,EMRCHK90
.
          MOVE     ADMISSNO,KEY8
          CALL     RDEMVIS1
          BRANCH   OVRCD,EMRCHK90
.
          COMPARE  FOUR,EMVISTAT
          GOTO     EMRCHK90 IF EQUAL
.
          MOVE     EMVIDOCT,DOCTCODE
          IF       COPTION=4
            PACK     MENUTYPE,ONE,EMVISTAT
            GOTO     EMRCHK99
          ENDIF
          IF       COPTION=2
            IF       EMVISTAT=1
              OPEN     EMRLOCA1,"emrlocaf"
              MOVE     "Other Departments",EMLODESC
              MOVE     EMVILOCN,KEY3
              CALL     RDEMLOC1
              WRITE    HTMLFILE;"Emergency - ",EMLODESC;
            ELSE
              WRITE    HTMLFILE;"Discharged";
            ENDIF
          ENDIF
          IF       COPTION=3
            WRITE    HTMLFILE;EMVITRIG;
          ENDIF
          GOTO     EMRCHK99
.
EMRCHK90  MOVE     PVIDOCT,DOCTCODE
          IF       COPTION=2
            WRITE    HTMLFILE;"Emergency";
          ENDIF
          GOTO     EMRCHK99
.
          INC      EMRVISIO/INC
          INC      EMRLOCIO/INC
          INC       IBAOVRIO/INC
.
EMRCHK99  ENDPROC
.*****************************************************************************
.*  GETALTID
.*  Procedure to get an alternate ID
.*  Exit=0  No alternate ID
.*       1  Alternate ID's exist
.*****************************************************************************
          DEFPROC   GETALIDS
.
          INC       PMSAIDFD/INC
.
          MOVE      ZERO,EXIT
          PACK      KEY20,SP70
          OPEN      PMSAIDA1,"pmsaidaf"
.
          PACK      KEY31,PURNO,SP70
          CALL      RSPMAID1           * Read alternate id Table
GETALI10  CALL      RKPMAID1
          BRANCH    OVRCD,GETALI99
.
          MATCH     PURNO,PMAIURNO     * Check same UR
          GOTO      GETALI99 IF NOT EQUAL
.
          MATCH     "1",PMAIDISU
          GOTO      GETALI10 IF NOT EQUAL
.
          PACK      KEY20,PMAIALID,SP70
          MOVE      ONE,EXIT
          GOTO      GETALI99
.
          INC       PMSAIDIO/INC
          INC       IBAOVRIO/INC
.
GETALI99  CLOSE     PMSAIDA1
.
          ENDPROC
+
.**************************************************************************
.*                              CREA0000               Called by:         *
.*             Create a new temporary file                                *
.**************************************************************************
.
CREA0000  CALL      KILL0000                     * remove existing file
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ISBUILD,TEMPFILE,UKEYTMP2
          EXECUTE   CMDLINE,TASKID               * create temporary index file
.
          OPEN      IPETEMP1,TEMPFILE            * open temp index files
          OPEN      IPETEMP2,TEMPFILE
.
CREA9999  RETURN
+
.****************************************************************************
.*                              KILL0000               Called by:           *
.*               Close and erase the temporary file                         *
.****************************************************************************
.
KILL0000  CLOSE     IPETEMP1                     * close files
          CLOSE     IPETEMP2
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ERASE,TEMPFILE       * set file erase command
          EXECUTE   CMDLINE,TASKID               * erase temp file
.
KILL9999  RETURN
+
.*****************************************************************************
.*                              CLRT0000           Called by:                *
.*                Clear all records from the temp file                       *
.*****************************************************************************
.
CLRT0000  MOVE      SP20,KEY17
          CALL      RSTEMP2                      * position at start of file
          CALL      RKTEMP2                      * read next record
          BRANCH    OVRCD,CLRT9999               * eof - finished
.
          PACK      KEY17,ADMISSNO,DDATE
          CALL      DETEMP2                      * delete record
          GOTO      CLRT0000
.         
CLRT9999  RETURN
+
.**********************************************************************
.         Update Default Printer File for User
.**********************************************************************
UPDFPT00  MOVE      REPORTNO,F2
          MOVE      F2,KEY2
          REP       " 0",KEY2
          PACK      KEY20,PRGID,KEY2,WBSEUID,SP70
          UNPACK    KEY20,IBPDPID,IBPDREP,IBPDUID
          MOVE      SELPRINT,IBPDPRT
          MOVE      SP70,IBPDSPA
          CALL      RAIBPD1
          IF        OVRCD=0
            CALL      UPIBPD1
          ELSE
            CALL      WRIBPD1
          ENDIF
UPDFPT99  RETURN
.
PRTIPROV  RETURN
+
.****************************************************************************
.*        IO ROUTINES FOR TEMPORARY FILE                                    *
.****************************************************************************
.
.         First Index
.
RSTEMP2   READ      IPETEMP1,KEY17;;
          RETURN
.
RKTEMP2   MOVE      ZERO,OVRCD
          READKS    IPETEMP1;ADMISSNO,DDATE,DIM9,KEY21:
                             FRMADATE,ACLAIM,FRMHFUND,ATYPE,CODED: 
                             CASEPAY,TOTDAYS,FORM7P2A,FORM7P2B
          GOTO      OVERCOND IF OVER
          RETURN
.
WRTEMP2   WRITE     IPETEMP1,KEY17;ADMISSNO,DDATE,DIM9,KEY21:
                                   FRMADATE,ACLAIM,FRMHFUND,ATYPE,CODED:
                                   CASEPAY,TOTDAYS,FORM7P2A,FORM7P2B
          RETURN
.
DETEMP2   DELETE    IPETEMP1,KEY17
          RETURN
.
.         Second Index
.
RSTEMP3   READ      IPETEMP2,KEY17;;
          RETURN
.
RKTEMP3   MOVE      ZERO,OVRCD
          READKS    IPETEMP2;ADMISSNO,DDATE,DIM9,KEY21:
                             FRMADATE,ACLAIM,FRMHFUND,ATYPE,CODED:
                             CASEPAY,TOTDAYS,FORM7P2A,FORM7P2B
          GOTO      OVERCOND IF OVER
          RETURN
+
. =========================================================================
.****************************************************************************
.  SINVH000 - Set up invoice header for stationery templating
.****************************************************************************
SINVH000  OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
.
          MOVE      PTCNPAIH,KEY6
          CALL      RDIBTH1                   * read header detail file
          BRANCH    OVRCD,SINVH900
.
          PACK      KEY12,PTCNPAIH,SP6        * position on details file
          CALL      RSIBDET1
          CALL      RKIBDET1
          BRANCH    OVRCD,SINVH900
.
          MATCH     PTCNPAIH,IBDTSCOD         * match stationery codes
          GOTO      SINVH950 IF EQUAL
.
.------ stationery code not on file ------
.
SINVH900  DISPLAY   *P1:24,*EL,*B:
                    "User Defined Stationery Code not on File. ";
          CALL      HITENTER
          MOVE      ONE,EXIT
          GOTO      SINVH999
.
SINVH950  MOVE      ZERO,EXIT
SINVH999  RETURN
+
.****************************************************************************
.  SINVT000 - Set up invoice tail for stationery templating
.****************************************************************************
SINVT000  OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
.
          READ      CONTROLF,NINTY8;*136,PTCNPAIH,*142,PTCNPAIT
          MOVE      PTCNPAIT,KEY6
          CALL      RDIBTH1                   * read header detail file
          BRANCH    OVRCD,SINVT900
.
          PACK      KEY12,PTCNPAIT,SP6        * position on details file
          CALL      RSIBDET1
          CALL      RKIBDET1
          BRANCH    OVRCD,SINVT900
.
          MATCH     PTCNPAIT,IBDTSCOD         * match stationery codes
          GOTO      SINVT950 IF EQUAL
.
.------ stationery code not on file ------
.
SINVT900  DISPLAY   *P1:24,*EL,*B:
                    "User Defined Stationery Code not on File. ";
          CALL      HITENTER
          MOVE      ONE,EXIT
          GOTO      SINVT999
.
SINVT950  MOVE      ZERO,EXIT
SINVT999  RETURN
+
.******************************************************************************
.
          INC       STD001IO
          INC       IBAGSTKY
          INC       IBAGKIKY
          INC       PATGNCMX
          INC       CMXMATRX
          INC       PABXBILL
          INC       PATFNDKY
          INC       IBAPRINT
          INC       STDHLPCD
          INC       TFILENAM                * Generate Temp File Name
          INC       SEXDSP00
.
          INC       WEBERRIO/INC            * Web Server Error Logging
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
          INC       IBAPRNIO/INC
          INC       IBAPDFIO/INC
          INC       EMRHISIO/INC
          INC       EMRVISIO/INC
          INC       EMRSITIO/INC
          INC       IBAGEDIO/INC
          INC       IBAGSTIO/INC
          INC       AAEDE1IO/INC
          INC       AAEDTRIO/INC
          INC       BOKRC1IO/INC
          INC       NHIMASIO/INC
          INC       NHIETHIO/INC
          INC       MLTCFNIO/INC
          INC       PATRGMIO/INC
          INC       PMSREGIO/INC
          INC       PATAA1IO/INC
          INC       PATSTAIO/INC
.
          INC       NZPBFEIO/INC
          INC       NZPCFNIO/INC
          INC       NZPCMTIO/INC
          INC       NZPFIGIO/INC
          INC       NZPIBRIO/INC
          INC       NZPIRNIO/INC
          INC       NZPMCHIO/INC
          INC       NZPMXCIO/INC
          INC       NZPPFEIO/INC
          INC       NZPPICIO/INC
          INC       NZPRBRIO/INC
          INC       NZPRFNIO/INC
          INC       NZPFINIO/INC
          INC       NZPSPRIO/INC
          INC       NZPTFEIO/INC
          INC       NZPIVBIO/INC
          INC       NZPRVBIO/INC
          INC       NZPEXTIO/INC
          INC       NZPRDTIO/INC
          INC       OPRSESIO/INC
          INC       PATAFEIO/INC
          INC       PATALRIO/INC
          INC       PATASDIO/INC
          INC       PATCFAIO/INC
          INC       PMSABFIO/INC
          INC       PMSPWAIO/INC
          INC       PMSCIDIO/INC
          INC       PMSCCDIO/INC
          INC       PMSTLEIO/INC
          INC       PATCMXIO/INC
          INC       PATCRAIO/INC
          INC       PATCTFIO/INC
          INC       PATDRGIO/INC
          INC       PATDGWIO/INC
          INC       PATEDSIO/INC
          INC       PATEDTIO/INC
          INC       PATFEEIO/INC
          INC       PATFX1IO/INC
          INC       PMSHCPIO/INC
          INC       PMSEVTIO/INC
          INC       PMSHCGIO/INC
          INC       PATINLIO/INC
          INC       PATHDFIO/INC
          INC       PATHLFIO/INC
          INC       PATALWIO/INC
          INC       PATBFEIO/INC
          INC       PATELGIO/INC
          INC       PATCODIO/INC
          INC       PATCMCIO/INC
          INC       PATCURIO/INC
          INC       PATDO1IO/INC
          INC       PATDSCIO/INC
          INC       PATDTRIO/INC
          INC       PATECDIO/INC
          INC       PATECOIO/INC
          INC       PATECHIO/INC
          INC       PATIPEIO/INC
          INC       PATIBLIO/INC
          INC       PATINVIO/INC
          INC       PATIOVIO/INC
          INC       PATIRNIO/INC
          INC       PATITMIO/INC
          INC       PATJRNIO/INC
          INC       PATICDIO/INC
          INC       PATICUIO/INC
          INC       PATIN1IO/INC
          INC       PATINMIO/INC
          INC       PATFACIO/INC
          INC       PATFIGIO/INC
          INC       PATFINIO/INC
          INC       PATFMOIO/INC
          INC       PATFN1IO/INC
          INC       PATFN2IO/INC
          INC       PATFHIIO/INC
          INC       PATGTUIO/INC
          INC       PATHTRIO/INC
          INC       EMRHTRIO/INC
          INC       OUTHTRIO/INC
          INC       PATHSPIO/INC
          INC       PATIPRIO/INC
          INC       PATMA1IO/INC
          INC       PMSPX2IO/INC
          INC       PATMCHIO/INC
          INC       PATMI1IO/INC
          INC       PATMMBIO/INC
          INC       PATPR1IO/INC
          INC       PATPGRIO/INC
          INC       PATASFIO/INC
          INC       PATRATIO/INC
          INC       PATRBLIO/INC
          INC       PATRCAIO/INC
          INC       PATRE1IO/INC
          INC       PATREMIO/INC
          INC       PATTFEIO/INC
          INC       PATTRNIO/INC
          INC       PATVISIO/INC
          INC       PATVENIO/INC
          INC       PMSHATIO/INC
          INC       PATWC1IO/INC
          INC       PATWMAIO/INC
          INC       PATWR1IO/INC
          INC       PATWVEIO/INC
          INC       MRTMASIO/INC
          INC       PATLDFIO/INC
          INC       PATLSDIO/INC
          INC       PATNHHIO/INC
          INC       PATOVBIO/INC
          INC       PATVADIO/INC
          INC       PATDADIO/INC
          INC       PATWLRIO/INC
          INC       PATRFNIO/INC
          INC       PATRFGIO/INC
          INC       PATSCFIO/INC 
          INC       PATSGCIO/INC
          INC       PATSRBIO/INC
          INC       OPRARDIO/INC
          INC       OPRDEAIO/INC
          INC       OPRDECIO/INC
          INC       OPRSRGIO/INC
          INC       OUTDTRIO/INC
          INC       OUTBOAIO/INC
          INC       OUTBB1IO/INC
          INC       OUTSITIO/INC
          INC       OUTCTYIO/INC
          INC       OUTCLIIO/INC
          INC       COMDEPIO/INC
          INC       RCPBNKIO/INC
          INC       RCPDTEIO/INC
          INC       RCPBDTIO/INC
          INC       RCPCRSIO/INC
          INC       VISPAYIO/INC
          INC       PMSIDEIO/INC
          INC       PMSPYRIO/INC
          INC       PMSPBRIO/INC
          INC       PMSIVBIO/INC
          INC       RESLNKIO/INC
          INC       SCRMASIO/INC
          INC       PATNZRIO/INC
          INC       PATONHIO/INC
          INC       PMSSINIO/INC
          INC       PATCMTIO/INC
          INC       PMSCMTIO/INC
          INC       PMSECTIO/INC
          INC       PMSVX1IO/INC
          INC       PMSCNOIO/INC
          INC       PMSFCIIO/INC
          INC       PMSSGAIO/INC
          INC       PMSMTIIO/INC
          INC       PMSMPRIO/INC
          INC       PMSEXTIO/INC
          INC       PMSPRGIO/INC
          INC       PRIITMIO/INC
          INC       WEBSCHIO/INC
          INC       WEBIHCIO/INC
          INC       PMSEDGIO/INC       * Effective DRG Dates
          INC       PATDDHIO/INC
          INC       CMGETTHR
          INC       CHKCMXPT
          INC       CLNZPPIC
          INC       CLPATINV
          INC       PATCALFN 
          INC       PATCMSTP
          INC       PATCOMN3
          INC       STEPDOWN
          INC       CALCAGE
          INC       NHOSPDAY
          INC       PATINVS
          INC       PATINVHL
          INC       PATINVTL
          INC       PRTINVBD
          INC       PATCATAI
          INC       PATCATBI
          INC       PATGBCRN          * I-48227
          INC       OUTCATBI
          INC       AAECATBI
          INC       CLPATDTR
          INC       CLPMSIDE
          INC       CLPATDSC                * Clear Disc.file variables
          INC       CALCDAYS
          INC       PATHSPKY
          INC       GETALTID
          INC       PATMCHRD
          INC       PATITMRD
          INC       GETBFEES
          INC       GETTFEES
          INC       GETCNEFF
          INC       ISBITEMS
          INC       ICDSCLAS
          INC       PATIPERH
.
          INC       PATITMDS
          INC       PATALWDS
          INC       KYPTBANK
          INC       PATCKEXC
          INC       PATIVMES
          INC       CHNADMTP
          INC       PMSOSDTM              * Outstanding Debt alert routine
          INC       VALCMXFN
          INC       RSHWEBCD
          INC       GETEFDRG
.
