.----------------------------------------------------------------------
.   Program       : GENRPPKI
.
.   Modifications :
.   V9.11.01  13.01.2009 Peter Vela        183976
.                        Added write to controlf parameter Last Keyword
.                        Generate Date
.   V9.11.00  22.12.2008 Peter Vela        183976
.                        Created program 
.
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.  data includes
.----------------------------------------------------------------------
.
          INC       STDGENDF
          INC       PATCONFD/INC
          INC       PATPARFD/INC
          INC       PATPKIFD/INC
.
.----------------------------------------------------------------------
.  local variables
.----------------------------------------------------------------------
.
.
PRGID     INIT      "GENRPPKI"
PRGNAM    INIT      "Fix patpkiaf"
VERSION   INIT      "V12.00.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
.
.---- initialise screen and confirm desire to execute program ----
.
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P1:10,"Generate Eclipse Participant Keyword records."
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
.---- open files ----
.
          OPEN      PATPARA1,"patparaf"
          OPEN      PATPKIA1,"patpkiaf"
          OPEN      PATPKIA2,"patpkiaf"
          OPEN      CONTROLF,"controlf"
.
.---- loop through patparaf ----
.
          PACK      KEY9,SP70
          MOVE      ZERO,SECTOR
.
ML1000    CALL      RSPTPAR1           * read next record
.
ML1100    CALL      RKPTPAR1
          BRANCH    OVRCD,ML9000
.
          ADD       ONE,SECTOR         * display every 100th record
          IF        SECTOR%1000=1
            DISPLAY   *P1:24,*V2LON,SECTOR," - ",PTPRCODE,*EF;
          ENDIF
.
          PROC      PATPKIUP
          GOTO      ML1100
.
ML9000    CALL      IBACLOCK
          PACK      PTCNPRKG,CCC,CYY,CMM,CDD
          REP       " 0",PTCNPRKG
.
          WRITAB    CONTROLF,HUND16;*61,PTCNPRKG
.
.---- exit program ----
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
.  code includes
.----------------------------------------------------------------------
.
          INC       PATPARIO/INC
          INC       PATPKIIO/INC
          INC       PATPKIPR
          INC       STDGENCD
.
