.---------------------------------------------------------------------------
.   System    :   Heakth Level 7                     
.   Include   :   HL7TABKY
.   Routine   :   HHLTAA00 HL7 Table ID        
.   Return    :           
.-------------------------------------------------------------------------------
HHLTAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HHLTAA04
          CALL      GSCRN000
          BRANCH    EXIT,HHLTAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"ID"                 
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "40",STDCOL03
HHLTAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,HLTATID 
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          CALL      RSHLTA1 
HHLTAA10
          CALL      RKHLTA1 
          BRANCH    OVRCD,HHLTAA15
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HHLTAA12
          CALL      HHLTAA60
          BRANCH    OVRCD,HHLTAA10
HHLTAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,HLTATID 
          DISPLAY   *PSTDCOL02:STDROW,HLTADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HHLTAA10 IF NOT EQUAL
HHLTAA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HHLTAA20
          CALL      HSCRI000
          BRANCH    EXIT,HHLTAA30,HHLTAA35,HHLTAA40,HHLTAA45,HHLTAA04:
                              HHLTAA91,HHLTAA50
          GOTO      HHLTAA92
HHLTAA30
          CALL      RKHLTA1 
          BRANCH    OVRCD,HHLTAA85
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          CALL      RPHLTA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HHLTAA10
HHLTAA35
          MOVE      ST1,KEY4 
          CALL      RDHLTA1 
          CALL      RPHLTA1 
          BRANCH    OVRCD,HHLTAA85
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HHLTAA36
          CALL      RPHLTA1 
          BRANCH    OVRCD,HHLTAA37
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HHLTAA36 IF NOT EQUAL
HHLTAA37
          MOVE      ZERO,XITEMNO
          GOTO      HHLTAA10
HHLTAA40
          MOVE      ST1,KEY4 
          CALL      RDHLTA1 
          CALL      RPHLTA1 
          BRANCH    OVRCD,HHLTAA85
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HHLTAA08
HHLTAA45
          CALL      RKHLTA1 
          BRANCH    OVRCD,HHLTAA85
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSHLTA1 
HHLTAA46
          CALL      RPHLTA1 
          BRANCH    OVRCD,HHLTAA47
          PACK      KEY4,HLTATID,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HHLTAA46 IF NOT EQUAL
HHLTAA47
          MOVE      ZERO,XITEMNO
          GOTO      HHLTAA10
HHLTAA50  COMPARE   ZERO,CSEARCH
          GOTO      HHLTAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HHLTAA08
HHLTAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HHLTAA08
HHLTAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HHLTAA61 IF EQUAL
          MATCH     SCHFLD01,HLTATID 
          GOTO      HHLTAA72 IF NOT EQUAL
HHLTAA61
          MATCH     SP70,SCHFLD02
          GOTO      HHLTAA62 IF EQUAL
          MATCH     SCHFLD02,HLTADES 
          GOTO      HHLTAA72 IF NOT EQUAL
HHLTAA62
HHLTAA63
HHLTAA64
HHLTAA65
HHLTAA66
HHLTAA67
HHLTAA68
HHLTAA69
HHLTAA70
          GOTO      HHLTAA75
HHLTAA72  MOVE      ONE,OVRCD
HHLTAA75  RETURN
HHLTAA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,HLTATID                                                
          CALL      RDHLTA1 
HHLTAA90
.                                                                               
          BEEP
          GOTO      HHLTAA20
HHLTAA91
          MOVE      SP70,HLTADES 
          MOVE      SP70,HLTASPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,HLTATID 
          GOTO      HHLTAA96
HHLTAA92
          MOVE      SP70,KEY4 
          MOVE      SP70,HLTATID 
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,HLTATID                                                
HHLTAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HHLTAA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Heakth Level 7                     
.   Include   :   HL7TABKY
.   Routine   :   KHLTAA00 Keyin HL7 Table ID        
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KHLTAA00 TOPIC     "HLTATID "
          MOVE      UNDLN70,HLTATID 
          KEYIN     *PCCOL:CVERT,*DV,HLTATID:                                   
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,HLTATID:                        
                    *PCCOL:CVERT,*DV,HLTATID 
.
          ENDSET    HLTATID 
          APPEND    SP70,HLTATID 
          RESET     HLTATID 
.
          MATCH     SP70,HLTATID 
          GOTO      KHLTAA90 IF EQUAL
.
          ENDSET    HLTATID 
          CMATCH    EXITCHAR,HLTATID 
          GOTO      KHLTAA95 IF EQUAL
.
          CMATCH    QUEST,HLTATID 
          GOTO      KHLTAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HHLTAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    HLTATID 
          APPEND    SP70,HLTATID 
          RESET     HLTATID 
.
          MATCH     SP70,HLTATID 
          GOTO      KHLTAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,HLTATID                                 
KHLTAA10
          RESET     HLTATID 
          PACK      KEY4,HLTATID                                                
          CALL      RAHLTA1 
          BRANCH    OVRCD,KHLTAA80
          BRANCH    CKEYTYP,KHLTAA75
          CALL      RDHLTA1 
KHLTAA70
          MOVE      ZERO,EXIT
          GOTO      KHLTAA99
KHLTAA75
          MOVE      "HL7 Table ID Already Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KHLTAA00
KHLTAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KHLTAA99,KHLTAA99
          MOVE      "HL7 Table ID Does Not Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KHLTAA00
KHLTAA90
          MOVE      ONE,EXIT
          GOTO      KHLTAA99
KHLTAA95
          MOVE      TWO,EXIT
KHLTAA99 TOPIC    PRGID
          RETURN
