.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  13.04.2005 Peter Vela CAR 59696
.           Recompiled for SINSUAFD
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 23.11.2000 Charles Handaya
.           Recompiled only (Modification of Warehouse Security)
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
STRDAT    DIM       8
ENDDAT    DIM       8
.
SST1      DIM       67            * SINCIAKY
SST2      DIM       67            * SINCIAKY
SST3      DIM       67            * SINCIAKY
SST4      DIM       67            * SINCIAKY
SST5      DIM       67            * SINCIAKY
SST6      DIM       67            * SINCIAKY
SST7      DIM       67            * SINCIAKY
SST8      DIM       67            * SINCIAKY
SST9      DIM       67            * SINCIAKY
SST10     DIM       67            * SINCIAKY
SST11     DIM       67            * SINCIAKY
SST12     DIM       67            * SINCIAKY
SST13     DIM       67            * SINCIAKY
SST14     DIM       67            * SINCIAKY
SST15     DIM       67            * SINCIAKY
SST16     DIM       67            * SINCIAKY
SST17     DIM       67            * SINCIAKY
.
SHTOP     FORM      2             * SINCIAKY
SHBOT     FORM      2             * SINCIAKY
SHLEF     FORM      3             * SINCIAKY
SHRIG     FORM      3             * SINCIAKY
XTOP      FORM      2             * SINCIAKY
XBOT      FORM      2             * SINCIAKY
XLEF      FORM      3             * SINCIAKY
XRIG      FORM      3             * SINCIAKY
.
CKEYTYPE  FORM      1
CKEYSTCK  DIM       1
HOLDPAY   DIM       3
HOLDINV   DIM       3
HOLDCRD   DIM       3
HOLDORD   DIM       3
SUSPDESC  DIM       25
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN70
.   Function      :   Corporate Update Audit Enquiries        
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCIFFD/INC
          INC       SINCONFD/INC
          INC       SINCUAFD/INC
          INC       SINNATFD/INC
          INC       SINSUAFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld    10
.-------------------------------------------------------
SICU1NAM  INIT      "SICU1"
SICU1END  FORM      1   * End Display
SICU1SNO  FORM      5   * Number of Items on the Screen
SICU1MKY  DIM       127 * Match Key 
SICU1IDX  INIT      " 132 UC1-5"
SICU1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SICU1FNM  DIM       8  * Filename
SICU1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 02 Fld    10
.-------------------------------------------------------
SICU2NAM  INIT      "SICU2"
SICU2END  FORM      1   * End Display
SICU2SNO  FORM      5   * Number of Items on the Screen
SICU2MKY  DIM       127 * Match Key 
SICU2EKY  DIM       127 * End Key
SICU2SKY  DIM       127 * Start Key
SICU2IDX  INIT      " 132 UC1-5"
SICU2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SICU2FNM  DIM       8  * Filename
SICU2CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 03 Fld    10
.-------------------------------------------------------
SICU3NAM  INIT      "SICU3"
SICU3END  FORM      1   * End Display
SICU3SNO  FORM      5   * Number of Items on the Screen
SICU3MKY  DIM       127 * Match Key 
SICU3EKY  DIM       127 * End Key
SICU3SKY  DIM       127 * Start Key
SICU3IDX  INIT      " 132 UC1-5"
SICU3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SICU3FNM  DIM       8  * Filename
SICU3CNT  FORM      3  * Number of Items on Screen
FROMDAT   DIM      10 * Scr 04 Fld     4
TODAT     DIM      10 * Scr 04 Fld     5
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN70"
PRGNAM    INIT      "Corporate Update Audit Enquiries        "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     SICU1FL1,DELETE
.
          CLOSE     SICU2FL1,DELETE
.
          CLOSE     SICU3FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          MOVE      "   24",AUDTSECT
          MOVE      "203",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudia";
            OPEN      SINAUDIA,"sinaudia"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "207",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudic";
            OPEN      SINAUDIC,"sinaudic"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "219",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudsa";
            OPEN      SINAUDSA,"sinaudsa"
          ENDIF
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincuaaf";
          OPEN      SINCUAA1,"sincuaaf"
          DISPLAY   *P56:24,"Opening sincuaaf";
          OPEN      SINCUAA2,"sincuaaf"
          DISPLAY   *P56:24,"Opening sincuaaf";
          OPEN      SINCUAA3,"sincuaaf"
          DISPLAY   *P56:24,"Opening sinnataf";
          OPEN      SINNATA1,"sinnataf"
          DISPLAY   *P56:24,"Opening sinnataf";
          OPEN      SINNATA2,"sinnataf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
.--------------------------------------------------------
. Initialise Batch Screen Date                               
.--------------------------------------------------------
          MOVE     ZERO,SICU1SNO
          MOVE     "01   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SICU1SNO
            ENDIF
          ENDIF
          PACK      SICU1FNM,ANST,SICU1NAM,PORT
          REP       " 0",SICU1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SICU1FL1,SICU1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SICU1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SICU1FNM,SICU1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SICU1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SICU1FL1,SICU1FNM
.--------------------------------------------------------
. Initialise Batch Screen Date                               
.--------------------------------------------------------
          MOVE     ZERO,SICU2SNO
          MOVE     "02   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SICU2SNO
            ENDIF
          ENDIF
          PACK      SICU2FNM,ANST,SICU2NAM,PORT
          REP       " 0",SICU2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SICU2FL1,SICU2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SICU2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SICU2FNM,SICU2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SICU2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SICU2FL1,SICU2FNM
.--------------------------------------------------------
. Initialise Batch Screen Date                               
.--------------------------------------------------------
          MOVE     ZERO,SICU3SNO
          MOVE     "03   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SICU3SNO
            ENDIF
          ENDIF
          PACK      SICU3FNM,ANST,SICU3NAM,PORT
          REP       " 0",SICU3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SICU3FL1,SICU3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SICU3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SICU3FNM,SICU3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SICU3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SICU3FL1,SICU3FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Menu                               
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * List by Date                       
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * List by Catalog                    
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * List by Supplier                   
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Delete Records from Audit          
          ENDIF
          RETURN
.--------------------------------
. Screen - Menu                               
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Menu                               
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Menu                               
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Menu                               
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Menu                               
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Menu                               
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Menu                               
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Menu                               
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - List by Date                       
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : List by Date                       
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SICUDAT 
          MOVE      SP70,SICUTIM 
          MOVE      SP70,SICUSUP 
          MOVE      SP70,SICUCAT 
          MOVE      SP70,SICUSUT 
          MOVE      ZERO,SICUTYP 
          MOVE      SP70,SICUDES1
          MOVE      SP70,SICUDES2
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for List by Date                       
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : List by Date                       
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : List by Date                       
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :    10 Date                               
.---------------------------------------------------------
          UNPACK    SP70,SICUDAT,SICUTIM,SICUUNI
          PACK      KEY18,SP70
          CALL      RDSICU1 
          IF        OVRCD=0
            CALL      RPSICU1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,SICU1CNT
          MOVE     ZERO,SICU1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L101,DP01L102,DP01L103:
                            DP01L104,DP01L105,DP01L106,DP01L107:
                            DP01L108,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          PACK      SICU1MKY,SP70,SP70
          CALL      UPTSICU1
          IF        SICU1END=0
            CALL      RPSICU1 
            IF        OVRCD=0
              PACK      SICU1MKY,SICUDAT,SICUTIM,SICUUNI                                                        
                MOVE      ZERO,SICU1END
                ADD       ONE,SICU1CNT
                CALL      UPTSICU1
                UNPACK    SICUDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
            ELSE
              MOVE      ONE,SICU1END
            ENDIF
          ENDIF
          IF        SICU1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        SICU1END=0
            MOVE      SICUTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        SICU1END=0
            MOVE      SICUSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        SICU1END=0
            MOVE      SICUCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        SICU1END=0
            MOVE      SICUSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L106
          IF        SICU1END=0
            MOVE      SICUTYP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L107
          IF        SICU1END=0
            MOVE      SICUDES1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L108
          IF        SICU1END=0
            MOVE      SICUDES2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "SICU1",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          MATCH    "SICU1",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          PACK     KEY18,Z70
          CALL     RDSICU1  * Start
          IF       OVRCD=0
            CALL     RPSICU1  * Start
          ENDIF
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          MATCH    "SICU1",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY18,SP70
          CALL     RSSICU1  * End
          IF       OVRCD=1
            CALL     RKSICU1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICU1SNO
            CALL     RKSICU1 
            IF       OVRCD=1
              MOVE     SICU1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
          MATCH    "SICU1",NAMSSFFI
          GOTO     PP01L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP01L105
          CALL      RFTSICU1
          BRANCH   OVRCD,PP01L115
          MOVE      SICU1MKY,KEY18 
          CALL      RSSICU1 
PP01L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SICU1SNO
            CALL     RKSICU1 
            IF       OVRCD=1
              MOVE     SICU1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICU1SNO
            CALL     RPSICU1 
            IF       OVRCD=1
              MOVE     SICU1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP01L999
PP01L120
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "SICU1",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          CALL     RPSICU1 
          BRANCH   OVRCD,NP01L110
          CALL     RKSICU1 
          CALL     DP01L000
          GOTO     NP01L999
NP01L110
          CALL     RKSICU1 
          BEEP
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
CT01L105
CT01L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : List by Date                       
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Date                               
.---------------------------------------------------------
UPTSICU1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SICU1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SICU1FL1,KEY5;SCPSROW,SCPSCOL,SICU1MKY
          ELSE
            UPDATE    SICU1FL1;SCPSROW,SCPSCOL,SICU1MKY
          ENDIF
          RETURN
RDTSICU1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SICU1FL1,KEY5;SCPSROW,SCPSCOL,SICU1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSICU1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SICU1FL1,KEY5;;
          READKS    SICU1FL1;SCPSROW,SCPSCOL,SICU1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SICU1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : List by Date                       
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "SICU1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : List by Date                       
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : List by Date                       
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L102,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L103,SF01L104,SF01L006:
                           SF01L006,SF01L105,SF01L106
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L102,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "SICU1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          COMPARE   ONE,ACCEPT
          GOTO      SF01L001 IF EQUAL
          CALL      RDTSICU1
          IF        OVRCD=1
            BEEP
            GOTO      SF01L001
          ENDIF
          MATCH     SP70,SICU1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF01L001
          ENDIF
          MOVE      SICU1MKY,KEY18 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSICU1
          IF        OVRCD=1
            CALL      FP01L000
          ELSE
            MOVE      SICU1MKY,KEY18 
            CALL      RSSICU1 
            CALL      RKSICU1 
            CALL      DP01L000
          ENDIF
          GOTO     SF01L001
.
SF01L103
          MOVE      "SICU1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L104
          MOVE      "SICU1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      "SICU1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "SICU1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - List by Catalog                    
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : List by Catalog                    
.-------------------------------------------------------
CF02L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SICUDAT 
          MOVE      SP70,SICUTIM 
          MOVE      SP70,SICUSUP 
          MOVE      SP70,SICUCAT 
          MOVE      SP70,SICUSUT 
          MOVE      ZERO,SICUTYP 
          MOVE      SP70,SICUDES1
          MOVE      SP70,SICUDES2
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for List by Catalog                    
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIIAA00
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : List by Catalog                    
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : List by Catalog                    
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    10 Date                               
.---------------------------------------------------------
          UNPACK    SP70,SICUCAT,SICUDAT,SICUTIM,SICUUNI
          PACK      KEY25,SIIACAT,SP70
          MOVE      KEY25,SICU2EKY
          STRIP     SICU2SKY
          SETLPTR   SICU2EKY,7
          MOVE      SICU2EKY,SICU2SKY
          CALL      RDSICU2 
          IF        OVRCD=0
            CALL      RPSICU2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SICU2CNT
          MOVE     ZERO,SICU2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L101,DP02L102,DP02L103:
                            DP02L104,DP02L105,DP02L106,DP02L107:
                            DP02L108,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SICU2MKY,SP70,SP70
          CALL      UPTSICU2
          IF        SICU2END=0
            CALL      RPSICU2 
            IF        OVRCD=0
              PACK      SICU2MKY,SICUCAT,SICUDAT,SICUTIM,SICUUNI                                                
              MATCH     SICU2EKY,SICU2MKY
              IF        @EQUAL
                MOVE      ZERO,SICU2END
                ADD       ONE,SICU2CNT
                CALL      UPTSICU2
                UNPACK    SICUDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SICU2END
              ENDIF
            ELSE
              MOVE      ONE,SICU2END
            ENDIF
          ENDIF
          IF        SICU2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SICU2END=0
            MOVE      SICUTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SICU2END=0
            MOVE      SICUSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SICU2END=0
            MOVE      SICUCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SICU2END=0
            MOVE      SICUSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SICU2END=0
            MOVE      SICUTYP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SICU2END=0
            MOVE      SICUDES1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SICU2END=0
            MOVE      SICUDES2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SICU2",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SICU2",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY25,SICU2SKY,Z70
          CALL     RDSICU2  * Start
          IF       OVRCD=0
            CALL     RPSICU2  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SICU2",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY25,SICU2SKY,SP70
          CALL     RSSICU2  * End
          IF       OVRCD=1
            CALL     RKSICU2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICU2SNO
            CALL     RKSICU2 
            IF       OVRCD=1
              MOVE     SICU2SNO,SECTOR
            ENDIF
            PACK     SICU2MKY,SICUCAT,SICUDAT,SICUTIM,SICUUNI                                                
            MATCH    SICU2EKY,SICU2MKY
            IF       !@EQUAL
              MOVE     SICU2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SICU2",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSICU2
          BRANCH   OVRCD,PP02L115
          MOVE      SICU2MKY,KEY25 
          CALL      RSSICU2 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SICU2SNO
            CALL     RKSICU2 
            IF       OVRCD=1
              MOVE     SICU2SNO,SECTOR
            ENDIF
            PACK     SICU2MKY,SICUCAT,SICUDAT,SICUTIM,SICUUNI                                                
            MATCH    SICU2EKY,SICU2MKY
            IF       !@EQUAL
              MOVE     SICU2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICU2SNO
            CALL     RPSICU2 
            IF       OVRCD=1
              MOVE     SICU2SNO,SECTOR
            ENDIF
            PACK     SICU2MKY,SICUCAT,SICUDAT,SICUTIM,SICUUNI                                                
            MATCH    SICU2EKY,SICU2MKY
            IF       !@EQUAL
              MOVE     SICU2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SICU2",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RPSICU2 
          BRANCH   OVRCD,NP02L110
          PACK     SICU2MKY,SICUCAT,SICUDAT,SICUTIM,SICUUNI                                                
          MATCH    SICU2EKY,SICU2MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RKSICU2 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RKSICU2 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : List by Catalog                    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Date                               
.---------------------------------------------------------
UPTSICU2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SICU2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SICU2FL1,KEY5;SCPSROW,SCPSCOL,SICU2MKY
          ELSE
            UPDATE    SICU2FL1;SCPSROW,SCPSCOL,SICU2MKY
          ENDIF
          RETURN
RDTSICU2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SICU2FL1,KEY5;SCPSROW,SCPSCOL,SICU2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSICU2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SICU2FL1,KEY5;;
          READKS    SICU2FL1;SCPSROW,SCPSCOL,SICU2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SICU2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : List by Catalog                    
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SICU2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : List by Catalog                    
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : List by Catalog                    
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L102,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L103,SF02L104,SF02L006:
                           SF02L006,SF02L105,SF02L106
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L102,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SICU2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSICU2
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SICU2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SICU2MKY,KEY25 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSICU2
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SICU2MKY,KEY25 
            CALL      RSSICU2 
            CALL      RKSICU2 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L103
          MOVE      "SICU2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "SICU2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "SICU2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "SICU2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - List by Supplier                   
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : List by Supplier                   
.-------------------------------------------------------
CF03L000
          MOVE      SP70,APMACRD 
          MOVE      SP70,APMASN1 
          MOVE      SP70,SICUDAT 
          MOVE      SP70,SICUTIM 
          MOVE      SP70,SICUSUP 
          MOVE      SP70,SICUCAT 
          MOVE      SP70,SICUSUT 
          MOVE      ZERO,SICUTYP 
          MOVE      SP70,SICUDES1
          MOVE      SP70,SICUDES2
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for List by Supplier                   
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : List by Supplier                   
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : List by Supplier                   
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :    10 Date                               
.---------------------------------------------------------
          UNPACK    SP70,SICUSUP,SICUDAT,SICUTIM,SICUUNI
          PACK      KEY23,APMACRD,SP70
          MOVE      KEY23,SICU3EKY
          STRIP     SICU3SKY
          SETLPTR   SICU3EKY,5
          MOVE      SICU3EKY,SICU3SKY
          CALL      RDSICU3 
          IF        OVRCD=0
            CALL      RPSICU3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,SICU3CNT
          MOVE     ZERO,SICU3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L101,DP03L102,DP03L103:
                            DP03L104,DP03L105,DP03L106,DP03L107:
                            DP03L108,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          PACK      SICU3MKY,SP70,SP70
          CALL      UPTSICU3
          IF        SICU3END=0
            CALL      RPSICU3 
            IF        OVRCD=0
              PACK      SICU3MKY,SICUSUP,SICUDAT,SICUTIM,SICUUNI                                                
              MATCH     SICU3EKY,SICU3MKY
              IF        @EQUAL
                MOVE      ZERO,SICU3END
                ADD       ONE,SICU3CNT
                CALL      UPTSICU3
                UNPACK    SICUDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SICU3END
              ENDIF
            ELSE
              MOVE      ONE,SICU3END
            ENDIF
          ENDIF
          IF        SICU3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        SICU3END=0
            MOVE      SICUTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        SICU3END=0
            MOVE      SICUSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        SICU3END=0
            MOVE      SICUCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        SICU3END=0
            MOVE      SICUSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L106
          IF        SICU3END=0
            MOVE      SICUTYP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L107
          IF        SICU3END=0
            MOVE      SICUDES1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L108
          IF        SICU3END=0
            MOVE      SICUDES2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "SICU3",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "SICU3",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY23,SICU3SKY,Z70
          CALL     RDSICU3  * Start
          IF       OVRCD=0
            CALL     RPSICU3  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "SICU3",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY23,SICU3SKY,SP70
          CALL     RSSICU3  * End
          IF       OVRCD=1
            CALL     RKSICU3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICU3SNO
            CALL     RKSICU3 
            IF       OVRCD=1
              MOVE     SICU3SNO,SECTOR
            ENDIF
            PACK     SICU3MKY,SICUSUP,SICUDAT,SICUTIM,SICUUNI                                                
            MATCH    SICU3EKY,SICU3MKY
            IF       !@EQUAL
              MOVE     SICU3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "SICU3",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          CALL      RFTSICU3
          BRANCH   OVRCD,PP03L115
          MOVE      SICU3MKY,KEY23 
          CALL      RSSICU3 
PP03L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SICU3SNO
            CALL     RKSICU3 
            IF       OVRCD=1
              MOVE     SICU3SNO,SECTOR
            ENDIF
            PACK     SICU3MKY,SICUSUP,SICUDAT,SICUTIM,SICUUNI                                                
            MATCH    SICU3EKY,SICU3MKY
            IF       !@EQUAL
              MOVE     SICU3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SICU3SNO
            CALL     RPSICU3 
            IF       OVRCD=1
              MOVE     SICU3SNO,SECTOR
            ENDIF
            PACK     SICU3MKY,SICUSUP,SICUDAT,SICUTIM,SICUUNI                                                
            MATCH    SICU3EKY,SICU3MKY
            IF       !@EQUAL
              MOVE     SICU3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "SICU3",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RPSICU3 
          BRANCH   OVRCD,NP03L110
          PACK     SICU3MKY,SICUSUP,SICUDAT,SICUTIM,SICUUNI                                                
          MATCH    SICU3EKY,SICU3MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RKSICU3 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RKSICU3 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : List by Supplier                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Date                               
.---------------------------------------------------------
UPTSICU3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SICU3FL1,KEY5;ANS
          IF        @OVER
            WRITE     SICU3FL1,KEY5;SCPSROW,SCPSCOL,SICU3MKY
          ELSE
            UPDATE    SICU3FL1;SCPSROW,SCPSCOL,SICU3MKY
          ENDIF
          RETURN
RDTSICU3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SICU3FL1,KEY5;SCPSROW,SCPSCOL,SICU3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSICU3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SICU3FL1,KEY5;;
          READKS    SICU3FL1;SCPSROW,SCPSCOL,SICU3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SICU3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : List by Supplier                   
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "SICU3",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : List by Supplier                   
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : List by Supplier                   
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L102,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L103,SF03L104,SF03L006:
                           SF03L006,SF03L105,SF03L106
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L102,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "SICU3",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          COMPARE   ONE,ACCEPT
          GOTO      SF03L001 IF EQUAL
          CALL      RDTSICU3
          IF        OVRCD=1
            BEEP
            GOTO      SF03L001
          ENDIF
          MATCH     SP70,SICU3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF03L001
          ENDIF
          MOVE      SICU3MKY,KEY23 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSICU3
          IF        OVRCD=1
            CALL      FP03L000
          ELSE
            MOVE      SICU3MKY,KEY23 
            CALL      RSSICU3 
            CALL      RKSICU3 
            CALL      DP03L000
          ENDIF
          GOTO     SF03L001
.
SF03L103
          MOVE      "SICU3",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "SICU3",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "SICU3",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "SICU3",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Delete Records from Audit          
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      MVACCEPT
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Delete Records from Audit          
.-------------------------------------------------------
CF04L000
          MOVE      SP70,FROMDAT 
          MOVE      SP70,TODAT   
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Delete Records from Audit          
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Delete Records from Audit          
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Delete Records from Audit          
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Delete Records from Audit          
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Delete Records from Audit          
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      TODAT,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Delete Records from Audit          
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PROC0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODAT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDATE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODAT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.--------------------------------------------------
. Selected Item
.--------------------------------------------------
SELITM00  MOVE      SCRID,F2
          BRANCH    F2,SELITM10,SELITM20,SELITM30
SELITM10  CALL      RDSICU1    * Date
          BRANCH    OVRCD,SELITM99
          GOTO      SELITM50
SELITM20  CALL      RDSICU2    * Catalog
          BRANCH    OVRCD,SELITM99
          GOTO      SELITM50
SELITM30  CALL      RDSICU3    * Supplier
          BRANCH    OVRCD,SELITM99
          GOTO      SELITM50
.
SELITM50  CALL      DITEM000   * Display item
.
SELITM99  RETURN
.
DITEM000  DISPLAY   *P1:8,*EF
          HLINE     *G37,8,1,80
          UNPACK    SICUDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          DISPLAY   *P1:11,"Updated on  : ",*V2LON,CPCDATE," at ",SICUTIM
          BRANCH    SICUTYP,DITEM010,DITEM020,DITEM030,DITEM040,DITEM050:
                            DITEM060,DITEM070,DITEM080,DITEM090,DITEM100:
                            DITEM110,DITEM120,DITEM130,DITEM140,DITEM150:
                            DITEM160,DITEM170
          BEEP
          DISPLAY   *P30:14,"Audit Type Error"
          GOTO      DITEM900
DITEM010  DISPLAY   *P30:9,*V2LON,*ULON,"New Creditor/Supplier"
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMACN1
            MOVE      "Error Record Missing",APMACN2
            MOVE      "Error Record Missing",APMASN1
            MOVE      "Error Record Missing",APMASN2
          ENDIF
          DISPLAY   *P1:12,"Supplier    : ",*V2LON,SICUSUP,*HOFF:
                    *P1:13,"Name        : ",*V2LON,APMASN1,APMASN2,*HOFF:
                    *P1:14,"Address     : ",*V2LON,APMASA1,*HOFF:
                    *P1:15,"            : ",*V2LON,APMASA2,*HOFF:
                    *P1:16,"            : ",*V2LON,APMASA3,SP1,APMASPC,*HOFF:
                    *P1:17,"Phone       : ",*V2LON,APMASTEL,*HOFF:
                    *P1:18,"Fax         : ",*V2LON,APMASFAX,*HOFF:
                    *P1:19,"Contact     : ",*V2LON,APMASCON
          GOTO      DITEM900
.
DITEM020  DISPLAY   *P30:9,*V2LON,*ULON,"New Catalog"
          CALL      GETCAT00
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:16,"Pref. Supp. : ",*V2LON,SIIAPSC,SP1,APMASN1,*HOFF:
                    *P1:17,"Product Grp : ",*V2LON,SIIASUB,SP1,SISADESC,*HOFF:
                    *P1:18,"Suspension  : ",*V2LON,SUSPDESC
          GOTO      DITEM900
.
DITEM030  DISPLAY   *P30:9,*V2LON,*ULON,"New Catalog/Supplier"
          CALL      GETCAT00
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
          ENDIF
          PACK      KEY27,SICUCAT,SICUSUP,SICUSUT
          CALL      RDSIIC1
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Supplier    : ",*V2LON,SICUSUP,SP1,APMASN1,*HOFF:
                    *P1:16,"Supply Unit : ",*V2LON,SICUSUT,*HOFF:
                    *P1:17,"Part Number : ",*V2LON,SIICPNO,*HOFF:
                    *P1:18,"Order Desc. : ",*V2LON,SIICPD1,*HOFF:
                    *P1:19,"            : ",*V2LON,SIICPD2,*HOFF:
                    *P1:20,"Last Inv    : ",*V2LON,SIICLCT,*HOFF:
                    *P1:21,"Curr Cost   : ",*V2LON,SIICCCT
          GOTO      DITEM900
.
DITEM040  DISPLAY   *P30:9,*V2LON,*ULON,"Current Cost Changed"
          CALL      GETCAT00
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
          ENDIF
          PACK      KEY27,SICUCAT,SICUSUP,SICUSUT
          CALL      RDSIIC1
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:15,"Supplier    : ",*V2LON,SICUSUP,SP1,APMASN1,*HOFF:
                    *P1:16,"Supply Unit : ",*V2LON,SICUSUT,*HOFF:
                    *P1:17,"Part Number : ",*V2LON,SIICPNO,*HOFF:
                    *P1:18,"Order Desc. : ",*V2LON,SIICPD1,*HOFF:
                    *P1:19,"            : ",*V2LON,SIICPD2,*HOFF:
                    *P10:21,*V2LON,SICUDES2
          GOTO      DITEM900
.
DITEM050  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog Part Number Changed"
          CALL      GETCAT00
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
          ENDIF
          PACK      KEY27,SICUCAT,SICUSUP,SICUSUT
          CALL      RDSIIC1
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:15,"Supplier    : ",*V2LON,SICUSUP,SP1,APMASN1,*HOFF:
                    *P1:16,"Supply Unit : ",*V2LON,SICUSUT,*HOFF:
                    *P1:18,"Old Part    : ",*V2LON,SICUDES2,*HOFF:
                    *P1:19,"New Part    : ",*V2LON,SIICPNO
          GOTO      DITEM900
.
DITEM060  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog Part Description Changed"
          CALL      GETCAT00
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
          ENDIF
          PACK      KEY27,SICUCAT,SICUSUP,SICUSUT
          CALL      RDSIIC1
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:15,"Supplier    : ",*V2LON,SICUSUP,SP1,APMASN1,*HOFF:
                    *P1:16,"Supply Unit : ",*V2LON,SICUSUT,*HOFF:
                    *P1:18,"Old Desc.   : ",*V2LON,SICUDES2,*HOFF:
                    *P1:19,"New Desc.   : ",*V2LON,SIICPD1,*HOFF:
                    *P1:20,"            : ",*V2LON,SIICPD2
          GOTO      DITEM900
.
DITEM070  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog Description Changed"
          CALL      GETCAT00
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:16,"Pref. Supp. : ",*V2LON,SIIAPSC,SP1,APMASN1,*HOFF:
                    *P1:17,"Product Grp : ",*V2LON,SIIASUB,SP1,SISADESC,*HOFF:
                    *P1:18,"Suspension  : ",*V2LON,SUSPDESC,*HOFF:
                    *P1:20,"Old Desc.   : ",*V2LON,SICUDES2,*HOFF:
                    *P1:21,"New Desc.   : ",*V2LON,SIIADES
          GOTO      DITEM900
.
DITEM080  DISPLAY   *P30:9,*V2LON,*ULON,"Supplier Suspended"
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
            MOVE      "Error Record Missing",APMASN2
          ENDIF
          MOVE      NO,HOLDORD
          LOAD      HOLDORD,APMAHOR,YES
          MOVE      NO,HOLDINV
          LOAD      HOLDINV,APMAHIN,YES
          MOVE      NO,HOLDCRD
          LOAD      HOLDCRD,APMAHCR,YES
          MOVE      NO,HOLDPAY
          LOAD      HOLDPAY,APMAHPY,YES
          DISPLAY   *P1:12,"Supplier    : ",*V2LON,SICUSUP,*HOFF:
                    *P1:13,"Name        : ",*V2LON,APMASN1,APMASN2,*HOFF:
                    *P1:14,"Address     : ",*V2LON,APMASA1,*HOFF:
                    *P1:15,"            : ",*V2LON,APMASA2,*HOFF:
                    *P1:16,"            : ",*V2LON,APMASA3,SP1,APMASPC,*HOFF:
                    *P1:17,"Phone       : ",*V2LON,APMASTEL,*HOFF:
                    *P1:18,"Contact     : ",*V2LON,APMASCON,*HOFF:
                    *P1:19,"Hold Orders : ",*V2LON,HOLDORD,*HOFF:
                    *P1:20,"Hold Invoice: ",*V2LON,HOLDINV,*HOFF:
                    *P1:21,"Hold Credits: ",*V2LON,HOLDCRD,*HOFF:
                    *P1:22,"Hold Payment: ",*V2LON,HOLDPAY

          GOTO      DITEM900
.
DITEM090  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog Suspended"
          CALL      GETCAT00
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:16,"Pref. Supp. : ",*V2LON,SIIAPSC,SP1,APMASN1,*HOFF:
                    *P1:17,"Product Grp : ",*V2LON,SIIASUB,SP1,SISADESC,*HOFF:
                    *P1:18,"Suspension  : ",*V2LON,SUSPDESC
          GOTO      DITEM900
.
DITEM100  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog/Supplier Suspended"
          CALL      GETCAT00
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
          ENDIF
          PACK      KEY27,SICUCAT,SICUSUP,SICUSUT
          CALL      RDSIIC1
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Supplier    : ",*V2LON,SICUSUP,SP1,APMASN1,*HOFF:
                    *P1:16,"Supply Unit : ",*V2LON,SICUSUT,*HOFF:
                    *P1:17,"Part Number : ",*V2LON,SIICPNO,*HOFF:
                    *P1:18,"Order Desc. : ",*V2LON,SIICPD1,*HOFF:
                    *P1:19,"            : ",*V2LON,SIICPD2,*HOFF:
                    *P1:20,"Last Inv    : ",*V2LON,SIICLCT,*HOFF:
                    *P1:21,"Curr Cost   : ",*V2LON,SIICCCT
          GOTO      DITEM900
.
DITEM110  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog Deleted"
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SICUDES2,*HOFF
          GOTO      DITEM900
.
DITEM120  DISPLAY   *P30:9,*V2LON,*ULON,"Supplier Deleted"
          DISPLAY   *P1:12,"Supplier    : ",*V2LON,SICUSUP,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SICUDES2,*HOFF
          GOTO      DITEM900
.
DITEM130  DISPLAY   *P30:9,*V2LON,*ULON,"Catalog/Supplier Deleted"
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Supplier    : ",*V2LON,SICUSUP,*HOFF:
                    *P1:13,"Supply Unit : ",*V2LON,SICUSUT,*HOFF:
                    *P1:15,"Name        : ",*V2LON,SICUDES2,*HOFF
          GOTO      DITEM900
.
DITEM140  DISPLAY   *P30:9,*V2LON,*ULON,"Changed Preferred Supplier"
          CALL      GETCAT00
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:16,"Product Grp : ",*V2LON,SIIASUB,SP1,SISADESC,*HOFF:
                    *P1:17,"Suspension  : ",*V2LON,SUSPDESC,*HOFF:
                    *P1:18,"Pref. Supp. : ",*V2LON,SIIAPSC,SP1,APMASN1,*HOFF:
                    *P1:19,"Old Supp.   : ",*V2LON,SICUDES2
          GOTO      DITEM900
.
DITEM150  DISPLAY   *P30:9,*V2LON,*ULON,"Changed Product Group"
          CALL      GETCAT00
          DISPLAY   *P1:12,"Catalog     : ",*V2LON,SICUCAT,*HOFF:
                    *P1:13,"Name        : ",*V2LON,SIIADES,*HOFF:
                    *P1:14,"Issue Unit  : ",*V2LON,SIIAISS,*HOFF:
                    *P1:15,"Average Cst : ",*V2LON,SIIAAVC,*HOFF:
                    *P1:16,"Pref. Supp. : ",*V2LON,SIIAPSC,SP1,APMASN1,*HOFF:
                    *P1:17,"Suspension  : ",*V2LON,SUSPDESC,*HOFF:
                    *P1:18,"Product Grp : ",*V2LON,SIIASUB,SP1,SISADESC,*HOFF:
                    *P1:19,"Old Prod.Grp: ",*V2LON,SICUDES2
          GOTO      DITEM900
.
DITEM160  DISPLAY   *P30:9,*V2LON,*ULON,"Changed Creditor Name"
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMACN1
            MOVE      "Error Record Missing",APMACN2
            MOVE      "Error Record Missing",APMASN1
            MOVE      "Error Record Missing",APMASN2
          ENDIF
          DISPLAY   *P1:12,"Supplier    : ",*V2LON,SICUSUP,*HOFF:
                    *P1:13,"Name        : ",*V2LON,APMASN1,APMASN2,*HOFF:
                    *P1:14,"Address     : ",*V2LON,APMASA1,*HOFF:
                    *P1:15,"            : ",*V2LON,APMASA2,*HOFF:
                    *P1:16,"            : ",*V2LON,APMASA3,SP1,APMASPC,*HOFF:
                    *P1:17,"Phone       : ",*V2LON,APMASTEL,*HOFF:
                    *P1:18,"Fax         : ",*V2LON,APMASFAX,*HOFF:
                    *P1:19,"Contact     : ",*V2LON,APMASCON,*HOFF:
                    *P1:20,"Old Name    : ",*V2LON,SICUDES2
          GOTO      DITEM900
.
DITEM170  DISPLAY   *P30:9,*V2LON,*ULON,"Changed Supplier Name"
          MOVE      SICUSUP,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMACN1
            MOVE      "Error Record Missing",APMACN2
            MOVE      "Error Record Missing",APMASN1
            MOVE      "Error Record Missing",APMASN2
          ENDIF
          DISPLAY   *P1:12,"Supplier    : ",*V2LON,SICUSUP,*HOFF:
                    *P1:13,"Name        : ",*V2LON,APMASN1,APMASN2,*HOFF:
                    *P1:14,"Address     : ",*V2LON,APMASA1,*HOFF:
                    *P1:15,"            : ",*V2LON,APMASA2,*HOFF:
                    *P1:16,"            : ",*V2LON,APMASA3,SP1,APMASPC,*HOFF:
                    *P1:17,"Phone       : ",*V2LON,APMASTEL,*HOFF:
                    *P1:18,"Fax         : ",*V2LON,APMASFAX,*HOFF:
                    *P1:19,"Contact     : ",*V2LON,APMASCON,*HOFF:
                    *P1:20,"Old Name    : ",*V2LON,SICUDES2
          GOTO      DITEM900
.
DITEM900  HLINE     *G37,23,1,80
          MOVE      SP70,DISPMSG
          CALL      MESSAGE1
          RETURN
.------------------------------------------------------------
. Get Catalog Details
.------------------------------------------------------------
GETCAT00  MOVE      SICUCAT,KEY7
          CALL      RDSIIA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",SIIADES
          ENDIF
          MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",APMASN1
          ENDIF
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
          IF        OVRCD=1
            MOVE      "Error Record Missing",SISADESC
          ENDIF
          ADD       ONE,SIIASUS
          BRANCH    SIIASUS,GETCAT10,GETCAT20,GETCAT30,GETCAT40
.
GETCAT10  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      GETCAT90
GETCAT20  MOVE      "Requisitions              ",SUSPDESC
          GOTO      GETCAT90
GETCAT30  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      GETCAT90
GETCAT40  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      GETCAT90
.
GETCAT90  RETURN
.
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.-------------------------------------------------------------
. File : /users/bga/std/auditdel
.
. Audit & Locking Standard Routine to Delete Record.
.
. where   xx = Key Length
.         ss = System 2 Character Code
.         ff = File 2 Character Code
.       yyyy = Key Field IDs
.-------------------------------------------------------------
PROC0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,PROC1000,PROC9000,PROC9100
.
PROC1000  PACK     KEY18,STRDAT,SP70   * Setup Key to File
PROC1100  CALL     RSSICU1             * Read Record
          CALL     RKSICU1             * Read Record
          BRANCH   OVRCD,PROC1900
          MATCH    SICUDAT,ENDDAT
          GOTO     PROC1900 IF LESS
          PACK     KEY18,SICUDAT,SICUTIM,SICUUNI,SP70
          CALL     DESICU1
          GOTO     PROC1100
.
PROC1900  MOVE     ZERO,EXIT           * Restart Screen
          GOTO     PROC9999
PROC9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     PROC9999
PROC9100  MOVE     ZERO,EXIT           * Restart Screen on "Cancel"
          GOTO     PROC9999
PROC9999  RETURN
.----------------------------------------
. Enter Date Range
.  where DAT     = Field ID
.        RDATE   = Call Routine Label
.        "    1" = Screen Item Number for "from" Variable
.        "    2" = Screen Item Number for "to" Variable
.
.  Return Values
.        FROMDAT  Date for Start of Range Formatted in a DIM 10
.        TODAT    Date for End of Range Formatted in a DIM 10
.        STRDAT   Date for Start of Range Format CCYYMMDD
.        ENDDAT   Date for End of Range Format CCYYMMDD
.----------------------------------------
RDATE000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATE100
           MATCH    SP2,CDAY
           GOTO     RDATE100 IF EQUAL
           PACK     STRDAT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRDAT
           CALL     PACDATE
           MOVE     CPCDATE,FROMDAT
           GOTO     RDATE140
RDATE100   MOVE     "Start             ",FROMDAT
           MOVE     SP70,STRDAT
.
RDATE140   MOVE     FROMDAT,VAR
           CALL     DISPITEM
.
RDATE150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATE200
           MATCH    SP2,CDAY
           GOTO     RDATE200 IF EQUAL
           PACK     ENDDAT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDDAT
           CALL     PACDATE
           MOVE     CPCDATE,TODAT
           MATCH    STRDAT,ENDDAT
           GOTO     RDATE999 IF EQUAL
           GOTO     RDATE999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDATE000
.
RDATE200   MOVE     "Finish             ",TODAT
           MOVE     "99999999",ENDDAT
.
RDATE999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCICIO/INC
          INC       SINCIFIO/INC
          INC       SINCUAIO/INC
          INC       SINNATIO/INC
          INC       SINSUAIO/INC
.
          INC       STDGENCD
.
