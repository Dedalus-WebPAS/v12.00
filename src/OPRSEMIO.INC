.
. OPRSEMIO.INC
. ------------
. Filename       :  oprsemaf.dat
. Description    :  Session Master - File I/O Subroutines
. Variables      :  OVRCD     FORM      1
.                   KEY21     DIM      21
.
RAOPSEM1  MOVE      ZERO,OVRCD
          RESET     KEY21
          READ      OPRSEMA1,KEY21;ANS
          GOTO      OVERCOND IF OVER
          RETURN  
.
RSOPSEM1  MOVE      ZERO,OVRCD
          RESET     KEY21
          READ      OPRSEMA1,KEY21;;
          RETURN  
.
RDOPSEM1  MOVE      ZERO,OVRCD
          RESET     KEY21
          READ      OPRSEMA1,KEY21;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                                   OPSMMRFQ,OPSMYRFQ,OPSMDURA:
                                   OPSMTPER,OPSMTYPE,OPSMTHET,OPSMENDT:
                                   OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                                   OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK:
                                   OPSMSTYP,OPSMDGSI,OPSMHOSP,OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN  
.
RKOPSEM1  MOVE      ZERO,OVRCD
          READKS    OPRSEMA1;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                                   OPSMMRFQ,OPSMYRFQ,OPSMDURA:
                                   OPSMTPER,OPSMTYPE,OPSMTHET,OPSMENDT:
                                   OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                                   OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK:
                                   OPSMSTYP,OPSMDGSI,OPSMHOSP,OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN  
.
RPOPSEM1  MOVE      ZERO,OVRCD
          READKP    OPRSEMA1;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                    OPSMMRFQ,OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE,OPSMTHET:
                    OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC,OPSMSTAT:
                    OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP,OPSMDGSI,OPSMHOSP:
                    OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN  
.
UPOPSEM1 
          MOVE      OPSMDAYI,DOPSMDAY
          UPDATE    OPRSEMA1;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                    OPSMMRFQ,OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE,OPSMTHET:
                    OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC,OPSMSTAT:
                    OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP,OPSMDGSI,OPSMHOSP:
                    OPSMSPAR
          RETURN
.
WROPSEM1  RESET     KEY21
          MOVE      OPSMDAYI,DOPSMDAY
          WRITE     OPRSEMA1,KEY21;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                    OPSMMRFQ,OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE,OPSMTHET:
                    OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC,OPSMSTAT:
                    OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP,OPSMDGSI,OPSMHOSP:
                    OPSMSPAR
          RETURN
.
DEOPSEM1  RESET     KEY21
          DELETE    OPRSEMA1,KEY21
          RETURN
+
RAOPSEM2  MOVE      ZERO,OVRCD
          RESET     KEY21
          READ      OPRSEMA2,KEY21;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSOPSEM2  MOVE      ZERO,OVRCD
          RESET     KEY21
          READ      OPRSEMA2,KEY21;;
          RETURN
.
RDOPSEM2  MOVE      ZERO,OVRCD
          RESET     KEY21
          READ      OPRSEMA2,KEY21;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                                   OPSMMRFQ,OPSMYRFQ,OPSMDURA:
                                   OPSMTPER,OPSMTYPE,OPSMTHET,OPSMENDT:
                                   OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                                   OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK:
                                   OPSMSTYP,OPSMDGSI,OPSMHOSP,OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN
.
RKOPSEM2  MOVE      ZERO,OVRCD
          READKS    OPRSEMA2;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                                   OPSMMRFQ,OPSMYRFQ,OPSMDURA:
                                   OPSMTPER,OPSMTYPE,OPSMTHET,OPSMENDT:
                                   OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                                   OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK:
                                   OPSMSTYP,OPSMDGSI,OPSMHOSP,OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN
.
RPOPSEM2  MOVE      ZERO,OVRCD
          READKP    OPRSEMA2;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                    OPSMMRFQ,OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE,OPSMTHET:
                    OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC,OPSMSTAT:
                    OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP,OPSMDGSI,OPSMHOSP:
                    OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN
.
UPOPSEM2
          MOVE      OPSMDAYI,DOPSMDAY
          UPDATE    OPRSEMA2;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                    OPSMMRFQ,OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE,OPSMTHET:
                    OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC,OPSMSTAT:
                    OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP,OPSMDGSI,OPSMHOSP:
                    OPSMSPAR
          RETURN
.
WROPSEM2  RESET     KEY21
          MOVE      OPSMDAYI,DOPSMDAY
          WRITE     OPRSEMA2,KEY21;OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                    OPSMMRFQ,OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE,OPSMTHET:
                    OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC,OPSMSTAT:
                    OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP,OPSMDGSI,OPSMHOSP:
                    OPSMSPAR
          RETURN
.
DEOPSEM2  RESET     KEY21
          DELETE    OPRSEMA2,KEY21
          RETURN
+
.
.******************************************************************************
.
.    Audit IO routines
.
ASOPSEM   MOVE      ZERO,OVRCD
          RESET     KEY19
          READ      OPRAUDSM,KEY19;;
          RETURN  
.
AKOPSEM   MOVE      ZERO,OVRCD
          READKS    OPRAUDSM;OPSMAUDD,OPSMAUDT,OPSMAUDP,OPSMAUDR,OPSMAUDS:
                             OPSMAUDO,OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP:
                             OPSMMRFQ,OPSMYRFQ,OPSMDURA:
                             OPSMTPER,OPSMTYPE,OPSMTHET,OPSMENDT:
                             OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                             OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK:
                             OPSMSTYP,OPSMDGSI,OPSMHOSP,OPSMSPAR
          MOVE      DOPSMDAY,OPSMDAYI
          GOTO      OVERCOND IF OVER
          RETURN  
.
AWOPSEM   RESET     KEY19
          MOVE      OPSMDAYI,DOPSMDAY
          WRITE     OPRAUDSM,KEY19;KEY19,OPSMAUDS,OPSMAUDO:
                    OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP,OPSMMRFQ:
                    OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE:
                    OPSMTHET,OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                    OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP:
                    OPSMDGSI,OPSMHOSP,OPSMSPAR
          RETURN
.
AUOPSEM   MOVE      OPSMDAYI,DOPSMDAY
          UPDATE    OPRAUDSM;OPSMAUDD,OPSMAUDT,OPSMAUDP,OPSMAUDR,OPSMAUDS:
                    OPSMAUDO,OPSMCLIN,DOPSMDAY,OPSMTIME,OPSMFTYP,OPSMMRFQ:
                    OPSMYRFQ,OPSMDURA,OPSMTPER,OPSMTYPE:
                    OPSMTHET,OPSMENDT,OPSMBRKT,OPSMPREP,OPSMANAE,OPSMXDOC:
                    OPSMSTAT,OPSMSPI1,OPSMSPI2,OPSMNDLK,OPSMSTYP:
                    OPSMDGSI,OPSMHOSP,OPSMSPAR
          RETURN
.
ADOPSEM   RESET     KEY19
          DELETE    OPRAUDSM,KEY19
          RETURN
.******************************************************************************
