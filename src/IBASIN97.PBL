.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 24.11.2000 Charles Handaya
.           Recompiled (Modification of Warehouse Security)
.-------------------------------------------------------
. VF.00.01  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
.-------------------------------------------------------
CATDES60  DIM       60
SAVKEY22  DIM       22
KEYWRDNO  FORM      2
KEYWRD00  DIM       60
KEYWRD01  DIM       15
KEYWRD02  DIM       15
KEYWRD03  DIM       15
KEYWRD04  DIM       15
KEYWRD05  DIM       15
KEYWRD06  DIM       15
KEYWRD07  DIM       15
KEYWRD08  DIM       15
KEYWRD09  DIM       15
KEYWRD10  DIM       15
.-----------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN97
.   Function      :   Catalog Keyword Index Generation        
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SINCIAFD/INC
          INC       SINCIFFD/INC
          INC       SINCONFD/INC
          INC       SINKCTFD/INC
          INC       SINKEXFD/INC
          INC       SINNATFD/INC
          INC       SINTMPDF/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld    10
.-------------------------------------------------------
SIKE1NAM  INIT      "SIKE1"
SIKE1LEN  FORM      "56"
SIKE1IDX  INIT      "DC1-5 UC6-20"
SIKE1FNM  DIM       8  * Filename
SIKE1AFL  FORM      1  * End Accept Mode
SIKE1END  FORM      1  * End Display
SIKE1SNO  FORM      5  * Number of Items on the Screen
SIKE1NXT  DIM         20
SIKE1FL1  IFILE     SQL, FIXED=56,  KEY="D1-5"
SIKE1FL2  IFILE     SQL, FIXED=56, KEY="U6-20"
SIKE1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 02 Fld    10
.-------------------------------------------------------
SIIF2NAM  INIT      "SIIF2"
SIIF2END  FORM      1   * End Display
SIIF2SNO  FORM      5   * Number of Items on the Screen
SIIF2MKY  DIM       127 * Match Key 
SIIF2EKY  DIM       127 * End Key
SIIF2SKY  DIM       127 * Start Key
SIIF2IDX  INIT      " 132 UC1-5"
SIIF2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIF2FNM  DIM       8  * Filename
SIIF2CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN97"
PRGNAM    INIT      "Catalog Keyword Index Generation        "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     SIKE1FL2
          CLOSE     SIKE1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   24",AUDTSECT
          MOVE      "203",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudia";
            OPEN      SINAUDIA,"sinaudia"
          ENDIF
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sinkctaf";
          OPEN      SINKCTA1,"sinkctaf"
          DISPLAY   *P56:24,"Opening sinkctaf";
          OPEN      SINKCTA2,"sinkctaf"
          DISPLAY   *P56:24,"Opening sinkexaf";
          OPEN      SINKEXA1,"sinkexaf"
          DISPLAY   *P56:24,"Opening sinnataf";
          OPEN      SINNATA1,"sinnataf"
          DISPLAY   *P56:24,"Opening sinnataf";
          OPEN      SINNATA2,"sinnataf"
.--------------------------------------------------------
. Initialise Batch Screen Excluded Keyword                   
.--------------------------------------------------------
          MOVE     ZERO,SIKE1SNO
          MOVE     "01   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIKE1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Alias Description                  
.--------------------------------------------------------
          MOVE     ZERO,SIIF2SNO
          MOVE     "02   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIF2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Keyword Exclusion List Maintenance 
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Test Keyword Search                
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      GENR0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Keyword Exclusion List Maintenance 
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Keyword Exclusion List Maintenance 
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SIKEKWD 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Keyword Exclusion List Maintenance 
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :    10 Excluded Keyword                   
.---------------------------------------------------------
          UNPACK    SP70,SIKEKWD
          PACK      SIKE1FNM,ANST,SIKE1NAM,PORT
          REP       " 0",SIKE1FNM
          MOVE      ZERO,SIKE1AFL
          CLOSE     SIKE1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIKE1FL1,SIKE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIKE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIKE1FNM,SP1,SIKE1LEN,SP1,SIKE1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      SIKE1FL1,SIKE1FNM
          OPEN      SIKE1FL2,SIKE1FNM
          PACK      KEY15,SP70
          MOVE      KEY15,SAVKEY80
          SETLPTR   SAVKEY80,0 
          CALL      RDSIKE1 
          IF        OVRCD=0
            CALL      RPSIKE1 
          ENDIF
LM01L100
          CALL      RKSIKE1 
          BRANCH    OVRCD,LM01L105
          PACK      KEY15,SIKEKWD
          RESET     KEY15,1
          MOVE      KEY15,KEY15
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TASIKE12
          IF        OVRCD=0
            CALL      TUSIKE12
          ELSE
            CALL      TWSIKE12
          ENDIF
          GOTO     LM01L100
LM01L105
          MOVE     SP70,KEY15  
          CALL     TSSIKE12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
SM01L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM01L010 IF EQUAL
SM01L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L101,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L007
          MATCH     PRGID,SCPSPID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L006 IF NOT EQUAL
          GOTO      SM01L005
SM01L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM01L010
          BRANCH    STDGSFLG,SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L900
          MATCH     PRGID,SCPSPID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
          GOTO      SM01L010
.
SM01L101
          MOVE     ZERO,SIKE1AFL
          CALL      EWORD000
          BRANCH    EXIT,SM01L990,SM01L990
          PACK     KEY15,SIKEKWD                                                                   
          RESET    KEY15,1
          MOVE     KEY15,KEY15
          CALL      TASIKE12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM01L101
          ENDIF
          MOVE      SIKEKWD,VAR      
          CALL      DISPITEM
          GOTO     SM01L010
SM01L900
          MATCH    "SIKE1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY15,SIKEKWD
            RESET    KEY15,1
            MOVE     KEY15,KEY15
            CALL      TASIKE12
            IF        OVRCD=0
              CALL      TUSIKE12
            ELSE
              CALL      TWSIKE12
            ENDIF
            GOTO      SM01L999
          ENDIF
          GOTO      SM01L999
SM01L990
          MATCH    "SIKE1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,SIKE1AFL
          ENDIF
SM01L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,SIKE1CNT
          MOVE     ZERO,SIKE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L101,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        SIKE1END=0
            CALL      TKSIKE12
            IF        OVRCD=1
              MOVE      ONE,SIKE1END
            ELSE
              MOVE      ZERO,SIKE1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUSIKE12
              MOVE      SIKEKWD,VAR      
              CALL      DISPITEM
            ENDIF
          ENDIF
          IF        SIKE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "SIKE1",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          CALL     CT01L000
          MATCH    "SIKE1",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          MOVE     SP70,KEY15  
          CALL     TSSIKE12 * Start
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          CALL     CT01L000
          MATCH    "SIKE1",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY15,Z70
          CALL     TSSIKE12
          IF       OVRCD=1
            CALL     TPSIKE12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIKE1SNO
            CALL     TPSIKE12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
PP01L100
          MATCH    "SIKE1",NAMSSFFI
          GOTO     PP01L115 IF NOT EQUAL
PP01L105
          MOVE     SP70,SIKE1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIKE11
          CALL     TKSIKE11 * First on Page
          MOVE     KEY15,SIKE1NXT
          CALL     TSSIKE12
          CALL     TPSIKE12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
PP01L110
          MOVE     SIKE1NXT,KEY15  
          CALL     TSSIKE12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIKE1SNO
            CALL     TPSIKE12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "SIKE1",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          MOVE     SP70,SIKE1NXT
          PACK     KEY5,Z70
          CALL     TSSIKE11
          CALL     TPSIKE11
          MOVE     KEY15,SIKE1NXT
          CALL     TSSIKE12
          CALL     TKSIKE12
          IF       OVRCD=1
            BEEP
            GOTO      NP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
NP01L110
          MOVE     SIKE1NXT,KEY15  
          CALL     TSSIKE12
          CALL     DP01L000
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
          MATCH    "SIKE1",NAMSSFFI
          GOTO     CT01L115 IF NOT EQUAL
CT01L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIKE11
          CALL     TKSIKE11
          BRANCH   OVRCD,CT01L110
          CALL     TRSIKE12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUSIKE12
          GOTO     CT01L105
CT01L110
          GOTO     CT01L999
CT01L115
CT01L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP01L000
          CALL     CT01L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP01L999
          MATCH    PRGID,SCPSPID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L100,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010
.
CP01L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP01L010
CP01L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD01L000
          CALL      CP01L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD01L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD01L000
          MATCH     PRGID,SCPSPID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD01L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM01L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "SIKE1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,SIKE1AFL
            GOTO      AD01L010 IF EQUAL
            CALL      FP01L000
            GOTO      AD01L999
          ENDIF
AD01L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL01L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL01L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL01L900,DL01L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL01L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "SIKE1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRSIKE11
            IF        OVRCD=0
              CALL      TDSIKE12
            ELSE
              BEEP
              GOTO      DL01L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSSIKE11
            CALL      TKSIKE11
            MOVE     KEY15,SIKE1NXT
            CALL      CT01L000
            MOVE      SIKE1NXT,KEY15  
            CALL      TSSIKE12
            CALL      TPSIKE12
            CALL      DP01L000
            GOTO      DL01L005
          ENDIF
DL01L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL01L005
DL01L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Excluded Keyword                   
.---------------------------------------------------------
TSSIKE11  RESET     KEY5
          READ      SIKE1FL1,KEY5;;
          RETURN
.
TSSIKE12  RESET     KEY15  
          READ      SIKE1FL2,KEY15;;
          RETURN
.
TASIKE12  RESET     KEY15  
          MOVE      ZERO,OVRCD
          READ      SIKE1FL2,KEY15;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDSIKE11  RESET     KEY5
          DELETE    SIKE1FL1,KEY5
          RETURN
.
TDSIKE12  RESET     KEY15
          DELETE    SIKE1FL2,KEY15
          RETURN
.
TKSIKE11  MOVE      ZERO,OVRCD
          READKS    SIKE1FL1;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TKSIKE12  MOVE      ZERO,OVRCD
          READKS    SIKE1FL2;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIKE11  MOVE      ZERO,OVRCD
          READKP    SIKE1FL1;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIKE12  MOVE      ZERO,OVRCD
          READKP    SIKE1FL2;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIKE11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      SIKE1FL1,KEY5;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIKE12  RESET     KEY15  
          MOVE      ZERO,OVRCD
          READ      SIKE1FL2,KEY15;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TUSIKE11  UPDATE    SIKE1FL1;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          RETURN
.
TUSIKE12
          UPDATE    SIKE1FL2;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          RETURN
.
TWSIKE12  RESET     KEY15  
          WRITE     SIKE1FL2,KEY15;SCTMROW,SCTMCOL,KEY15:
                        SIKEKWD,SIKESPA                                         
          RETURN
.---------------------------------------------------------
. Display Fields for : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Keyword Exclusion List Maintenance 
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L103,SF01L104,SF01L105:
                            SF01L106,SF01L107,SF01L108,SF01L109
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L103,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      POST0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          MOVE      "SIKE1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRSIKE11
            BRANCH    OVRCD,SF01L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF01L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF01L001 IF NOT EQUAL
            CALL      SM01L000 * Change Line
          ELSE
            IF        SIKE1AFL=0
              MOVE      "SIKE1",NAMSSFFI
              MOVE     "   10",ITMSSFFI
              CALL      AD01L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L104
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      AD01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      DL01L000
          GOTO     SF01L001
.
SF01L108
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L109
          MOVE      "SIKE1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Test Keyword Search                
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Test Keyword Search                
.-------------------------------------------------------
CF02L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIAISS 
          MOVE      SP70,SIIAPSC 
          MOVE      SP70,SIIFALI 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Test Keyword Search                
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIAISS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIAPSC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIIAA00
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAPSC,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Test Keyword Search                
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Test Keyword Search                
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    10 Alias Description                  
.---------------------------------------------------------
          UNPACK    SP70,SIIFCAT,SIIFALI
          PACK      KEY67,SIIACAT,SP70
          MOVE      KEY67,SIIF2EKY
          STRIP     SIIF2SKY
          SETLPTR   SIIF2EKY,7
          MOVE      SIIF2EKY,SIIF2SKY
          CALL      RDSIIF2 
          IF        OVRCD=0
            CALL      RPSIIF2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIIF2CNT
          MOVE     ZERO,SIIF2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L101,DP02L010,DP02L010:
                            DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          IF        SIIF2END=0
            CALL      RKSIIF2 
            IF        OVRCD=0
              PACK      SIIF2MKY,SIIFCAT,SIIFALI                                                                
              MATCH     SIIF2EKY,SIIF2MKY
              IF        @EQUAL
                MOVE      ZERO,SIIF2END
                ADD       ONE,SIIF2CNT
                MOVE      SIIFALI,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIIF2END
              ENDIF
            ELSE
              MOVE      ONE,SIIF2END
            ENDIF
          ENDIF
          IF        SIIF2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIIF2",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIIF2",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY67,SIIF2SKY,SP70
          CALL     RDSIIF2  * Start
          IF       OVRCD=0
            CALL     RPSIIF2  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIIF2",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY67,SIIF2SKY,Z70
          CALL     RSSIIF2  * End
          IF       OVRCD=1
            CALL     RPSIIF2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIF2SNO
            CALL     RPSIIF2 
            IF       OVRCD=1
              MOVE     SIIF2SNO,SECTOR
            ENDIF
            PACK     SIIF2MKY,SIIFCAT,SIIFALI                                                                
            MATCH    SIIF2EKY,SIIF2MKY
            IF       !@EQUAL
              MOVE     SIIF2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIIF2",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          COMPARE  SECTOR,SIIF2SNO
          GOTO     PP02L110 IF EQUAL
          CALL     RPSIIF2 
          BRANCH   OVRCD,PP02L115
          PACK     SIIF2MKY,SIIFCAT,SIIFALI                                                                
          MATCH    SIIF2EKY,SIIF2MKY
          GOTO     PP02L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP02L105
PP02L110
          MOVE     ZERO,SECTOR
          IF       SIIF2CNT=SIIF2SNO
            SUB      ONE,SIIF2CNT
          ENDIF
          WHILE    SECTOR<=SIIF2CNT
            CALL     RPSIIF2 
            IF       OVRCD=1
              MOVE     SIIF2SNO,SECTOR
            ENDIF
            PACK     SIIF2MKY,SIIFCAT,SIIFALI                                                                
            MATCH    SIIF2EKY,SIIF2MKY
            IF       !@EQUAL
              MOVE     SIIF2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIF2SNO
            CALL     RKSIIF2 
            IF       OVRCD=1
              MOVE     SIIF2SNO,SECTOR
            ENDIF
            PACK     SIIF2MKY,SIIFCAT,SIIFALI                                                                
            MATCH    SIIF2EKY,SIIF2MKY
            IF       !@EQUAL
              MOVE     SIIF2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIIF2",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIIF2 
          BRANCH   OVRCD,NP02L110
          PACK     SIIF2MKY,SIIFCAT,SIIFALI                                                                
          MATCH    SIIF2EKY,SIIF2MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIIF2 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIIF2 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Test Keyword Search                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Test Keyword Search                
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Test Keyword Search                
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L101,PS02L102,PS02L103,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Test Keyword Search                
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L103,SF02L104:
                            SF02L105,SF02L106
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Generate Catalog Word Index
.------------------------------------------------------------
GENR0000  CALL     CLEAR000
          BRANCH   EXIT,GENR9999
.
          CLOCK     TIME,CTIMEIS
          DISPLAY   *P1:24,"Processing ...",CTIMEIS
          MOVE     ZERO,COUNT
          PACK     KEY67,SP70
          CALL     RSSIIF1
GENR1000  CALL     RKSIIF1
          BRANCH   OVRCD,GENR1900
          ADD      ONE,COUNT
          IF       COUNT%1000=0
            CLOCK     TIME,CTIMEIS
            DISPLAY   *P40:24,"Records ",COUNT," at ",CTIMEIS
          ENDIF
.
...          COMPARE  THREE,SIIFATY
...          GOTO     GENR1000 IF EQUAL
.
          MOVE     SIIFALI,CATDES60
          CALL     BWORD000
.
          GOTO     GENR1000
.
GENR1900
.
GENR9999  RETURN
.------------------------------------------------------------
. Recreate File
.------------------------------------------------------------
CLEAR000  CLOSE    SINKCTA2
          CLOSE    SINKCTA1,DELETE
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINKCTA1,"sinkctaf"
          TRAPCLR  IO
          COMPARE  ZERO,OVRCD
          GOTO     CLEAR900 IF EQUAL
.
          MOVE     ZERO,HLEF
          CALL     GETSCR00
          EXECUTE  "isbuild sinkctaf 33 UC1-15,16-22 UC16-22,1-15",TASKID
          CALL     PUTSCR00
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINKCTA1,"sinkctaf"
          TRAPCLR  IO
          BRANCH   OVRCD,CLEAR910
          OPEN     SINKCTA2,"sinkctaf"
          MOVE     ZERO,EXIT
          GOTO     CLEAR999
CLEAR900  BEEP
          MOVE     "Unable to Delete File. ",DISPMSG
          CALL     MESSAGE1
          BEEP
          MOVE     "All Users Must be Off the System. ",DISPMSG
          CALL     MESSAGE1
          MOVE     ONE,EXIT
          GOTO     CLEAR999
.
CLEAR910  BEEP
          MOVE     "Unable to Create File. ",DISPMSG
          CALL     MESSAGE1
          BEEP
          MOVE     "All Users Must be Off the System. ",DISPMSG
          CALL     MESSAGE1
          MOVE     ONE,EXIT
          GOTO     CLEAR999
.
CLEAR999  RETURN
.-------------------------------------------------
. Format Given Names
.-------------------------------------------------
BWORD000  CMATCH    SP1,CATDES60             * Eliminate leading blanks
          IF        @EQUAL
            BUMP      CATDES60
            GOTO      BWORD000 IF NOT EOS
            GOTO      BWORD999               * entire name if blank
          ENDIF
          PACK      KEY60,CATDES60,SP30        * reset form pointer
          MOVE      KEY60,CATDES60
.
          SCAN      SP1,CATDES60               * Locate the first blank
          GOTO      BWORD100 IF NOT EQUAL
          BUMP      CATDES60,-1              * go back 1 to end of name
          MOVEFPTR  CATDES60,CCITEM          * another handly form field
          RESET     CATDES60                 * reset the form pointer
          SETLPTR   CATDES60,CCITEM          * set logical length to end of name
.
.         Save this Word
.
BWORD100
.          MOVE      CATDES60,KEY15           * Ignore Numbers
.          SQUEEZE   KEY15
.          TYPE      KEY15
.          GOTO      BWORD190 IF EQUAL
.
          MOVE      CATDES60,KEY15
          PACK      KEY15,KEY15,SP70
          REP       UPPLOW,KEY15
          CALL      RDSIKE1                  * Check Exclusion
          COMPARE   ZERO,OVRCD
          GOTO      BWORD190 IF EQUAL
.
          PACK      KEY22,KEY15,SIIFCAT
          UNPACK    KEY22,SIKCKWD,SIKCCAT
          CALL      RDSIKC1
          IF        OVRCD=1
            CALL      WRSIKC1
          ENDIF
          GOTO      BWORD190
.
.         Check for any more words
.
BWORD190  SETLPTR   CATDES60,SIXTY         * reset logical length
          ADD       ONE,CCITEM             * position of 1st blank
          RESET     CATDES60,CCITEM        * reset to this point
          PACK      KEY60,CATDES60,SP30    * reset form pointer
          MOVE      KEY60,CATDES60
.
          GOTO      BWORD000
.
BWORD999  RETURN
.
.--------------------------------------------------------
.          Save Batch Screen
.--------------------------------------------------------
.       1. Delete all Related Batch Items
.       2. Loop Through & add Posted Batch Items
.  zzzz   = Match Segment of Key
.  KEY15  = Key to File being Written too
.
.--------------------------------------------------------
POST0000  PACK      KEY15,SP70
          CALL      RSSIKE1
POST0100  CALL      RKSIKE1
          BRANCH    OVRCD,POST0200
          PACK      KEY15,SIKEKWD
          CALL      DESIKE1
          GOTO      POST0100
.
POST0200  MOVE      SP70,KEY5
          CALL      TRSIKE11
          COMPARE   ZERO,OVRCD
          GOTO      POST0310 IF EQUAL
.
POST0300  CALL      TKSIKE11
          BRANCH    OVRCD,POST0999
POST0310  PACK      KEY15,SIKEKWD
          UNPACK    KEY15,SIKEKWD
          MOVE      SP70,SIKESPA
          CALL      RASIKE1
          IF        OVRCD=0
            CALL      UPSIKE1
          ELSE
            CALL      WRSIKE1
          ENDIF
          GOTO      POST0300
.
POST0999  RETURN
.
.------------------------------------------------------------
. Enter Keyword
.------------------------------------------------------------
EWORD000   MOVE     "1",CKEYTYP
           CALL     KSIKEA00
           RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIFIO/INC
          INC       SINKCTIO/INC
          INC       SINKEXIO/INC
          INC       SINKEXKY    
          INC       SINNATIO/INC
.
          INC       STDGENCD
.
