.*******************************************************************************
.* INCLUDE       : IBALABPT                                                    *
.* FUNCTION      : To get the number of labels to print                        *
.*                 and if to print them or not CKLB0000.                       *
.*                 These includes have been written for screen painting labels *
.*                 and are called by the LABELOUT,LABELAAE,LABELPMI,LABELINP   *
.*                 ect procs.                                                  *
.* AUTHOR        : Matt Surridge                                               *
.* DATE          : 20/11/1995                                                  *
.*                                                                             *
.* MODIFICATIONS :                                                             *
.*                                                                             *
.*                                                                             *
.*******************************************************************************
.
.*******  Check if they want to print *******
.*******  Returns Exit 1 = No         *******
.
CKLB0000  MOVE      FALSE,EXIT
          KEYIN     *P1:24,*EL,"Printing ",*DV,*V2LON,NOLABEL,*HOFF:
                    " labels (",*V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? ":
                    *V2LON,ANS;
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      CKLB1000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      CKLB9999 IF EQUAL
          BEEP
          GOTO      CKLB0000
.
CKLB1000  KEYIN     *P1:24,*EL,"Enter the number of labels to be printed : ":
                    *V2LON,FORM3;
          COMPARE   ZERO,FORM3
          GOTO      CKLB9000 IF EQUAL
          GOTO      CKLB9000 IF LESS
.
          MOVE      FORM3,NOLABEL
          DISPLAY   *P1:24,*EL,*P29:24,*V2LON,"** Generating Labels **";
          GOTO      CKLB9999
.
CKLB9000  MOVE      TRUE,EXIT
.
CKLB9999  DISPLAY   *P1:24,*EL;
          RETURN
+
.******************************************************************************
.*        CKSR0000  Check for a labels screen.                                *
.*        Parameters PRGID                                                    *
.*                   SCRID                                                    *
.*        Returns    EXIT  1 = No label, 0 = Label found.                     *
.******************************************************************************
CKSR0000  MOVE      ONE,EXIT                * set as no screen
          PACK      KEY12,PRGID,SCRID,SP20
          CALL      RSSCSB1
.
CKSR1000  CALL      RKSCSB1                 * next read on background file
          BRANCH    OVRCD,CKSR9999          * end of file
.
          MATCH     PRGID,SCSBPID
          GOTO      CKSR9999 IF NOT EQUAL   * different program id
.
          MATCH     SCRID,SCSBSID
          GOTO      CKSR9999 IF NOT EQUAL   * different screen id
.
          MOVE      ZERO,EXIT
.
CKSR9999  RETURN
+
