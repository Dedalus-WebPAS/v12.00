. *----------------------------------------------------------------------
. * Include Name  :   PMSARQTM.PBL
. *
. * Function      :   CGI variables functions for PMSARQFD - pmsarqaf.dat
. *----------------------------------------------------------------------
.  Modifications Done :
.
.------------------------------------------------------------------------
.  V11.00.01  24/07/2020  Thanh T           TSK 0834767
.             Added PMAR0770
.------------------------------------------------------------------------
.  V10.09.01  14/12/2016  Don Nguyen        TSK 0323730
.             Modified value descriptions in PMAR0570 & PMAR0580.
.             Added PMAR0760 & SPMAR064 (PMARQ064).
.  V10.06.01  04/05/2015  Don Nguyen        CAR 316151
.             Modified PMAR0320 and PMAR0330 to output default value of '0'
.  V10.03.04  12/11/2013  Ebon Clements     CAR 291974
.             Added Start/End date validations to PMARHS00
.  V10.03.03  22/10/2013  Ebon Clements     CAR 291974
.             Fixed display of ex fix removal
.  V10.03.02  21/10/2013  Ebon Clements     CAR 291974
.             Changed PMARUDF1 name to preferred language
.  V10.03.01  03/10/2013  Ebon Clements     CAR 275205
.             Added transfer source
.  V10.03.00  29/08/2013  Ebon Clements     CAR 275205
.             Created include
.------------------------------------------------------------------------
.   Clear Parameters for admission request file
.------------------------------------------------------------------------
CPPMAR00  MOVE      Z70,PMARQ001
          MOVE      Z70,PMARQ002
          MOVE      Z70,PMARQ003
          MOVE      Z70,PMARQ004
          MOVE      Z70,PMARQ005
          MOVE      Z70,PMARQ006
          MOVE      Z70,PMARQ007
          MOVE      Z70,PMARQ008
          MOVE      Z70,PMARQ009
          MOVE      Z70,PMARQ010
          MOVE      Z70,PMARQ011
          MOVE      Z70,PMARQ012
          MOVE      Z70,PMARQ013
          MOVE      Z70,PMARQ014
          MOVE      Z70,PMARQ015
          MOVE      Z70,PMARQ016
          MOVE      Z70,PMARQ017
          MOVE      Z70,PMARQ018
          MOVE      Z70,PMARQ019
          MOVE      Z70,PMARQ020
          MOVE      Z70,PMARQ021
          MOVE      Z70,PMARQ022
          MOVE      Z70,PMARQ023
          MOVE      Z70,PMARQ024
          MOVE      Z70,PMARQ025
          MOVE      Z70,PMARQ026
          MOVE      Z70,PMARQ027
          MOVE      Z70,PMARQ028
          MOVE      Z70,PMARQ029
          MOVE      Z70,PMARQ030
          MOVE      Z70,PMARQ031
          MOVE      Z70,PMARQ032
          MOVE      Z70,PMARQ033
          MOVE      Z70,PMARQ034
          MOVE      Z70,PMARQ035
          MOVE      Z70,PMARQ036
          MOVE      Z70,PMARQ037
          MOVE      Z70,PMARQ038
          MOVE      Z70,PMARQ039
          MOVE      Z70,PMARQ040
          MOVE      Z70,PMARQ041
          MOVE      Z70,PMARQ042
          MOVE      Z70,PMARQ043
          MOVE      Z70,PMARQ044
          MOVE      Z70,PMARQ045
          MOVE      Z70,PMARQ046
          MOVE      Z70,PMARQ047
          MOVE      Z70,PMARQ048
          MOVE      Z70,PMARQ049
          MOVE      Z70,PMARQ050
          MOVE      Z70,PMARQ051
          MOVE      Z70,PMARQ052
          MOVE      Z70,PMARQ053
          MOVE      Z70,PMARQ054
          MOVE      Z70,PMARQ055
          MOVE      Z70,PMARQ056
          MOVE      Z70,PMARQ057
          MOVE      Z70,PMARQ058
          MOVE      Z70,PMARQ059
          MOVE      Z70,PMARQ060
          MOVE      Z70,PMARQ061
          MOVE      Z70,PMARQ062
          MOVE      Z70,PMARQ063
          MOVE      Z70,PMARQ064
.
CPPMAR99  RETURN
.
.------------------------------------------------------------
. Tags for admission request file
.------------------------------------------------------------
PMAR0000  BRANCH    FLDITMNO,PMAR0010,PMAR0020,PMAR0030,PMAR0040,PMAR0050:
                             PMAR0060,PMAR0070,PMAR0080,PMAR0090,PMAR0100:
                             PMAR0110,PMAR0120,PMAR0130,PMAR0140,PMAR0150:
                             PMAR0160,PMAR0170,PMAR0180,PMAR0190,PMAR0200:
                             PMAR0210,PMAR0220,PMAR0230,PMAR0240,PMAR0250:
                             PMAR0260,PMAR0270,PMAR0280,PMAR0290,PMAR0300:
                             PMAR0310,PMAR0320,PMAR0330,PMAR0340,PMAR0350:
                             PMAR0360,PMAR0370,PMAR0380,PMAR0390,PMAR0400:
                             PMAR0410,PMAR0420,PMAR0430,PMAR0440,PMAR0450:
                             PMAR0460,PMAR0470,PMAR0480,PMAR0490,PMAR0500:
                             PMAR0510,PMAR0520,PMAR0530,PMAR0540,PMAR0550:
                             PMAR0560,PMAR0570,PMAR0580,PMAR0590,PMAR0600:
                             PMAR0610,PMAR0620,PMAR0630,PMAR0640,PMAR0650:
                             PMAR0660,PMAR0670,PMAR0680,PMAR0690,PMAR0700:
                             PMAR0710,PMAR0720,PMAR0730,PMAR0740,PMAR0750:
                             PMAR0760,PMAR0770
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMAR9999
.
PMAR0010  WRITE     HTMLFILE;PMARREQN;
          GOTO      PMAR9999
.
PMAR0020  WRITE     HTMLFILE;PMARURNO;
          GOTO      PMAR9999
.
PMAR0030  WRITE     HTMLFILE;PMARVISN;
          GOTO      PMAR9999
.
PMAR0040  MATCH     SP70,PMARREQD
          GOTO      PMAR9999 IF EQUAL
.
          UNPACK    PMARREQD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAR9999
.
PMAR0050  WRITE     HTMLFILE;PMARREQT;
          GOTO      PMAR9999
.
PMAR0060  WRITE     HTMLFILE;PMARRTYP;
          GOTO      PMAR9999
.
PMAR0070  MOVE      PMARRESC,DOCTCODE
          CALL      DOCDET00
          GOTO      PMAR9999
.
PMAR0080  MOVE      "WU",CATEGORY
          MOVE      PMARUNIT,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0090  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0091,PMAR0092
.
          PACK      KEY5,PMARTEAM,SP8
          CALL      RDPMTEM1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;PMTMDESC;
          GOTO      PMAR9999
.
PMAR0091  WRITE     HTMLFILE;PMARTEAM;
          GOTO      PMAR9999
.
PMAR0092  PACK      KEY5,SP8
          CALL      RSPMTEM1
PMAR0093  CALL      RKPMTEM1
          BRANCH    OVRCD,PMAR9999
.
          MATCH     "1",PMTMACTV
          GOTO      PMAR0093 IF EQUAL            * don't display inactive codes
.
          MATCH     PMARTEAM,PMTMTEAM
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",PMTMTEAM,"#" selected>":
                               PMTMDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PMTMTEAM,"#">":
                               PMTMDESC,"</option>"
          ENDIF
          GOTO      PMAR0093
.
PMAR0100  MOVE      "ye",CATEGORY
          MOVE      PMARPRTY,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0110  WRITE     HTMLFILE;PMARDIAG;
          GOTO      PMAR9999
.
PMAR0120  UNPACK    DIM127,KEY1,ANS,DIM127
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,PMAR0121
.
          WRITE     HTMLFILE;PMARPROC;
          GOTO      PMAR9999
.
PMAR0121  PACK      KEY9,PMARPROC,SP70
          CALL      RDPROA1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;WPDESC;
          GOTO      PMAR9999
.
PMAR0130  WRITE     HTMLFILE;PMARPROD;
          GOTO      PMAR9999
.
PMAR0140  UNPACK    DIM127,KEY1,ANS,DIM127
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,PMAR0141
.
          WRITE     HTMLFILE;PMARPRO1;
          GOTO      PMAR9999
.
PMAR0141  PACK      KEY9,PMARPRO1,SP70
          CALL      RDPROA1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;WPDESC;
          GOTO      PMAR9999
.
PMAR0150  UNPACK    DIM127,KEY1,ANS,DIM127
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,PMAR0151
.
          WRITE     HTMLFILE;PMARPRO2;
          GOTO      PMAR9999
.
PMAR0151  PACK      KEY9,PMARPRO2,SP70
          CALL      RDPROA1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;WPDESC; 
          GOTO      PMAR9999
.
PMAR0160  MOVE      "yf",CATEGORY
          MOVE      PMARSIDE,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0170  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0171,PMAR0172
.
PMAR0171  MATCH     "0",PMARCONO
          IF        @EQUAL
            WRITE    HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARCONO
          IF        @EQUAL
            WRITE    HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARCONO
          IF        @EQUAL
            WRITE    HTMLFILE;"N/A";
          ENDIF
          GOTO      PMAR9999
.
PMAR0172  MATCH     "0",PMARCONO
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected>No</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>";
          ENDIF  
.
          MATCH     "1",PMARCONO
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected>Yes</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>";
          ENDIF
.
          MATCH     "2",PMARCONO
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected>N/A</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">N/A</option>";
          ENDIF
          GOTO      PMAR9999
.
PMAR0180  MOVE      "yg",CATEGORY
          MOVE      PMARCONF,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0190  MOVE      "yh",CATEGORY
          MOVE      PMARPPBY,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0201,PMAR0202
.
          PACK      KEY10,PMARIHOS,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      PMAR9999
.
PMAR0201  WRITE     HTMLFILE;PMARIHOS;
          GOTO      PMAR9999
.
PMAR0202  MOVE      PMARIHOS,DIM3
          CALL      PMARHS00
          GOTO      PMAR9999
.
PMAR0210  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0211
.
          MATCH     "0",PMARPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0211  MATCH     "0",PMARPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0220  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0221,PMAR0222
.
          PACK      KEY10,PMARPHOS,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      PMAR9999
.
PMAR0221  WRITE     HTMLFILE;PMARPHOS;
          GOTO      PMAR9999
.
PMAR0222  MOVE      PMARPHOS,DIM3
          CALL      PMARHS00
          GOTO      PMAR9999
.
PMAR0230  MATCH     SP70,PMARPPAD
          GOTO      PMAR9999 IF EQUAL
.
          UNPACK    PMARPPAD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAR9999
.
PMAR0240  MOVE      "yj",CATEGORY
          MOVE      PMARBTYP,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0250  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0251
.
          MATCH     "0",PMARANPR
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARANPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARANPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0251  MATCH     "0",PMARANPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARANPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARANPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0260  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0261
.
          MATCH     "0",PMARCCBR
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARCCBR
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARCCBR
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0261  MATCH     "0",PMARCCBR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARCCBR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARCCBR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0270  MOVE      "LA",CATEGORY
          MOVE      PMARUDF1,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0280  MOVE      "OA",CATEGORY
          MOVE      PMARANTY,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0290  MATCH     SP70,PMARODUR
          GOTO      PMAR9999 IF EQUAL
.
          SQUEEZE   PMARODUR
          WRITE     HTMLFILE;PMARODUR;
          RESET     PMARODUR
          GOTO      PMAR9999
.
PMAR0300  MOVE      "ym",CATEGORY
          MOVE      PMARPARC,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0310  MOVE      "yl",CATEGORY
          MOVE      PMARCLTR,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0320  MATCH     SP70,PMARHGHT
          GOTO      PMAR0321 IF EQUAL
.
          SQUEEZE   PMARHGHT
          WRITE     HTMLFILE;PMARHGHT;       * Patient Height
          RESET     PMARHGHT
          GOTO      PMAR9999
.
PMAR0321  WRITE     HTMLFILE;ZERO;
          GOTO      PMAR9999
.
PMAR0330  MATCH     SP70,PMARWGHT
          GOTO      PMAR0331 IF EQUAL
.
          SQUEEZE   PMARWGHT
          MOVE      PMARWGHT,F6P2
          RESET     PMARWGHT
          DIV       "100",F6P2
.
          MOVE      F6P2,KEY9
          SQUEEZE   KEY9
          WRITE     HTMLFILE;KEY9;           * Patient Weight
          RESET     KEY9
          GOTO      PMAR9999
.
PMAR0331  WRITE     HTMLFILE;ZERO;
          GOTO      PMAR9999
.
PMAR0340  MATCH     SP70,PMARCBMI
          GOTO      PMAR9999 IF EQUAL
.
          SQUEEZE   PMARCBMI
          WRITE     HTMLFILE;PMARCBMI;
          RESET     PMARCBMI
          GOTO      PMAR9999
.
PMAR0350  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0351
.
          MATCH     "0",PMARCOAG
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARCOAG
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARCOAG
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0351  MATCH     "0",PMARCOAG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARCOAG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARCOAG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0360  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0361
.
          MATCH     "0",PMARRACG
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARRACG
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARRACG
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0361  MATCH     "0",PMARRACG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARRACG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARRACG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF 
          GOTO      PMAR9999
.
PMAR0370  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0371
.
          MATCH     "0",PMARAPLT
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARAPLT
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARAPLT
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0371  MATCH     "0",PMARAPLT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARAPLT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARAPLT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF

          GOTO      PMAR9999
.
PMAR0380  MOVE      "WH",CATEGORY
          MOVE      PMARITCR,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0390  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0391
.
          MATCH     "0",PMARINTR
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARINTR
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARINTR
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0391  MATCH     "0",PMARINTR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARINTR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARINTR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0400  MOVE      "CL",CATEGORY
          MOVE      PMARCLAM,CODE
          CALL      CODITM00 
          GOTO      PMAR9999
.
PMAR0410  MOVE      "S ",CATEGORY
          MOVE      PMARSRCR,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0420  PACK      GENPCODE,PMARREFC,SP70
          CALL      HCPDET00
          GOTO      PMAR9999
.
PMAR0430  MOVE      ZERO,F2
          MOVE      PMARPCNT,F2
          PACK      KEY10,PMARPRAC,SP70
          PACK      GPPCCODE,KEY10,F2
          CALL      HCGDET00
          GOTO      PMAR9999
.
PMAR0440  WRITE     HTMLFILE;PMARPCNT;
          GOTO      PMAR9999
.
PMAR0450  MOVE      "VL",CATEGORY
          MOVE      PMARLSTS,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0460  MOVE      "VI",CATEGORY
          MOVE      PMARINTS,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0470  MOVE      "WS",CATEGORY
          MOVE      PMARSHTN,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0480  MATCH     SP70,PMARPLOS
          GOTO      PMAR9999 IF EQUAL
.
          SQUEEZE   PMARPLOS
          WRITE     HTMLFILE;PMARPLOS;
          RESET     PMARPLOS
          GOTO      PMAR9999
.
PMAR0490  MOVE      "cw",CATEGORY
          MOVE      PMARNWHC,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0500  MATCH     SP70,PMARPRDT
          GOTO      PMAR9999 IF EQUAL
.
          UNPACK    PMARPRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAR9999
.
PMAR0510  MOVE      "yp",CATEGORY
          MOVE      PMARTHLC,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0520  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0521
.
          MATCH     "0",PMARIMPR
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARIMPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARIMPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0521  MATCH     "0",PMARIMPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARIMPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARIMPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0530  WRITE     HTMLFILE;PMARIMPD;
          GOTO      PMAR9999
.
PMAR0540  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0541
.
          MATCH     "0",PMARIMPO
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARIMPO
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARIMPO
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0541  MATCH     "0",PMARIMPO
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARIMPO
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARIMPO
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF 
          GOTO      PMAR9999
.
PMAR0550  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0551
.
          MATCH     "0",PMARBNGR
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARBNGR
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARBNGR
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0551  MATCH     "0",PMARBNGR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARBNGR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARBNGR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF 
          GOTO      PMAR9999
.
PMAR0560  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0561
.
          MATCH     "0",PMAREXFX
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMAREXFX
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMAREXFX
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0561  MATCH     "0",PMAREXFX
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMAREXFX
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMAREXFX
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF 
          GOTO      PMAR9999
.
PMAR0570  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0571
.
          WRITE     HTMLFILE;PMARSTAT;
          GOTO      PMAR9999
.
PMAR0571  MATCH     "1",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Draft";
          ENDIF
.
          MATCH     "2",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Submitted";
          ENDIF
.
          MATCH     "3",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Returned to Clinician";
          ENDIF
.
          MATCH     "4",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Processed";
          ENDIF
.
          MATCH     "5",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Removed";
          ENDIF
.
          MATCH     "6",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Review";
          ENDIF
.
          MATCH     "7",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Approval Required";
          ENDIF
.
          MATCH     "8",PMARSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Approval Denied";
          ENDIF
.
          GOTO      PMAR9999
.
PMAR0580  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0581
.
          MATCH     "0",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Not Required";
          ENDIF
.
          MATCH     "1",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Approved";
          ENDIF
.
          MATCH     "2",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Approval Required";
          ENDIF
.
          MATCH     "3",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"Approval Denied";
          ENDIF
.
          GOTO      PMAR9999
.
PMAR0581  MATCH     "0",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected>Not Required</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">Not Required</option>"
          ENDIF
.
          MATCH     "1",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected>Approved</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Approved</option>"
          ENDIF
.
          MATCH     "2",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected>Approval Required</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Approval Required</option>"
          ENDIF
.
          MATCH     "3",PMARMAPR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"3#" selected>Approval Denied</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"3#">Approval Denied</option>"
          ENDIF
.
          GOTO      PMAR9999
.
PMAR0590  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0591
.
          MATCH     "0",PMARTHRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARTHRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARTHRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0591  MATCH     "0",PMARTHRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARTHRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARTHRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0601
.
          MATCH     "0",PMARRECC
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMARRECC
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMARRECC
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAR9999
.
PMAR0601  MATCH     "0",PMARRECC
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMARRECC
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMARRECC
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAR9999
.
PMAR0610  MOVE      "yr",CATEGORY
          MOVE      PMARRRCL,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0620  MOVE      "ys",CATEGORY
          MOVE      PMARRREM,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0630  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0631
.
          MATCH     SP70,PMARTSRC
          GOTO      PMAR9999 IF EQUAL
.
          WRITE     HTMLFILE;PMARTSRC;
          GOTO      PMAR9999
.
PMAR0631  MATCH     SP70,PMARTSRC
          GOTO      PMAR9999 IF EQUAL
.
          PACK      KEY5,PMARTSRC,SP70
          CALL      RDPTVAD1
          BRANCH    OVRCD,PMAR9999
.
          WRITE     HTMLFILE;PTVADESC;
          GOTO      PMAR9999
.
PMAR0640 
          GOTO      PMAR9999
.
PMAR0650 
          GOTO      PMAR9999
.
PMAR0660 
          GOTO      PMAR9999
.
PMAR0670 
          GOTO      PMAR9999
.
PMAR0680 
          GOTO      PMAR9999
.
PMAR0690 
          GOTO      PMAR9999
.
PMAR0700  MATCH     PMARCDAT,SP70
          GOTO      PMAR9999 IF EQUAL
.
          UNPACK    PMARCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAR9999
.
PMAR0710  MATCH     SP70,PMARCTIM
          GOTO      PMAR9999 IF EQUAL
.
          WRITE     HTMLFILE;PMARCTIM;
          GOTO      PMAR9999
.
PMAR0720  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0721
.
          MATCH     SP70,PMARCUID
          GOTO      PMAR9999 IF EQUAL
.
          PACK      KEY10,PMARCUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMARCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMAR9999
.
PMAR0721  WRITE     HTMLFILE;PMARCUID;
          GOTO      PMAR9999
.
PMAR0730  MATCH     PMARUDAT,SP70
          GOTO      PMAR9999 IF EQUAL
.
          UNPACK    PMARUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;

          GOTO      PMAR9999
.
PMAR0740  MATCH     SP70,PMARUTIM
          GOTO      PMAR9999 IF EQUAL
.
          WRITE     HTMLFILE;PMARUTIM;
          GOTO      PMAR9999
.
PMAR0750  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAR0751
.
          MATCH     SP70,PMARUUID
          GOTO      PMAR9999 IF EQUAL
.
          PACK      KEY10,PMARUUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMARUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMAR9999
.
PMAR0751  WRITE     HTMLFILE;PMARUUID;
          GOTO      PMAR9999
.
PMAR0760  MOVE      "Ar",CATEGORY
          MOVE      PMARAPRR,CODE
          CALL      CODITM00
          GOTO      PMAR9999
.
PMAR0770  WRITE     HTMLFILE;PMARMAPR;
          GOTO      PMAR9999
.
PMAR9999  RETURN
.
.------------------------------------------------------------
. Set Parameters for the admission request file
.------------------------------------------------------------
SPMAR000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMAR001,SPMAR002,SPMAR003,SPMAR004,SPMAR005:
                       SPMAR006,SPMAR007,SPMAR008,SPMAR009,SPMAR010:
                       SPMAR011,SPMAR012,SPMAR013,SPMAR014,SPMAR015:
                       SPMAR016,SPMAR017,SPMAR018,SPMAR019,SPMAR020:
                       SPMAR021,SPMAR022,SPMAR023,SPMAR024,SPMAR025:
                       SPMAR026,SPMAR027,SPMAR028,SPMAR029,SPMAR030:
                       SPMAR031,SPMAR032,SPMAR033,SPMAR034,SPMAR035:
                       SPMAR036,SPMAR037,SPMAR038,SPMAR039,SPMAR040:
                       SPMAR041,SPMAR042,SPMAR043,SPMAR044,SPMAR045:
                       SPMAR046,SPMAR047,SPMAR048,SPMAR049,SPMAR050:
                       SPMAR051,SPMAR052,SPMAR053,SPMAR054,SPMAR055:
                       SPMAR056,SPMAR057,SPMAR058,SPMAR059,SPMAR060:
                       SPMAR061,SPMAR062,SPMAR063,SPMAR064
.
          MOVE      ONE,EXIT
          GOTO      SPMAR999
.
SPMAR001  PACK      PMARQ001,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR002  PACK      PMARQ002,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR003  PACK      PMARQ003,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR004  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARQ004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAR999
.
SPMAR005  PACK      PMARQ005,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR006  PACK      PMARQ006,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR007  PACK      PMARQ007,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR008  PACK      PMARQ008,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR009  PACK      PMARQ009,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR010  PACK      PMARQ010,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR011  PACK      PMARQ011,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR012  PACK      PMARQ012,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR013  PACK      PMARQ013,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR014  PACK      PMARQ014,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR015  PACK      PMARQ015,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR016  PACK      PMARQ016,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR017  PACK      PMARQ017,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR018  PACK      PMARQ018,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR019  PACK      PMARQ019,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR020  PACK      PMARQ020,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR021  PACK      PMARQ021,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR022  PACK      PMARQ022,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR023  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARQ023,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAR999
.
SPMAR024  PACK      PMARQ024,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR025  PACK      PMARQ025,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR026  PACK      PMARQ026,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR027  PACK      PMARQ027,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR028  PACK      PMARQ028,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR029  PACK      PMARQ029,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR030  PACK      PMARQ030,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR031  PACK      PMARQ031,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR032  PACK      PMARQ032,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR033  PACK      PMARQ033,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR034  PACK      PMARQ034,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR035  PACK      PMARQ035,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR036  PACK      PMARQ036,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR037  PACK      PMARQ037,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR038  PACK      PMARQ038,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR039  PACK      PMARQ039,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR040  PACK      PMARQ040,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR041  PACK      PMARQ041,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR042  PACK      PMARQ042,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR043  PACK      PMARQ043,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR044  PACK      PMARQ044,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR045  PACK      PMARQ045,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR046  PACK      PMARQ046,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR047  PACK      PMARQ047,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR048  PACK      PMARQ048,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR049  PACK      PMARQ049,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR050  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARQ050,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAR999
.
SPMAR051  PACK      PMARQ051,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR052  PACK      PMARQ052,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR053  PACK      PMARQ053,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR054  PACK      PMARQ054,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR055  PACK      PMARQ055,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR056  PACK      PMARQ056,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR057  PACK      PMARQ057,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR058  PACK      PMARQ058,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR059  PACK      PMARQ059,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR060  PACK      PMARQ060,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR061  PACK      PMARQ061,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR062  PACK      PMARQ062,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR063  PACK      PMARQ063,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR064  PACK      PMARQ064,QRYDATA,SP70
          GOTO      SPMAR999
.
SPMAR999  RETURN
.
.------------------------------------------------------------
.  Update admission request file
.------------------------------------------------------------
MVPMAR00  MATCH     PMARQ001,Z70
          IF        !@EQUAL
            MOVE      PMARQ001,PMARREQN
          ENDIF
.
          MATCH     PMARQ002,Z70
          IF        !@EQUAL
            MOVE      PMARQ002,PMARURNO
          ENDIF
.
          MATCH     PMARQ003,Z70
          IF        !@EQUAL
            MOVE      PMARQ003,PMARVISN
          ENDIF
.
          MATCH     PMARQ004,Z70
          IF        !@EQUAL
            MOVE      PMARQ004,PMARREQD
          ENDIF
.
          MATCH     PMARQ005,Z70
          IF        !@EQUAL
            MOVE      PMARQ005,PMARREQT
          ENDIF
.
          MATCH     PMARQ006,Z70
          IF        !@EQUAL
            MOVE      PMARQ006,PMARRTYP
          ENDIF
.
          MATCH     PMARQ007,Z70
          IF        !@EQUAL
            MOVE      PMARQ007,PMARRESC
          ENDIF
.
          MATCH     PMARQ008,Z70
          IF        !@EQUAL
            MOVE      PMARQ008,PMARUNIT
          ENDIF
.
          MATCH     PMARQ009,Z70
          IF        !@EQUAL
            MOVE      PMARQ009,PMARTEAM
          ENDIF
.
          MATCH     PMARQ010,Z70
          IF        !@EQUAL
            MOVE      PMARQ010,PMARPRTY
          ENDIF
.
          MATCH     PMARQ011,Z70
          IF        !@EQUAL
            MOVE      PMARQ011,PMARDIAG
          ENDIF
.
          MATCH     PMARQ012,Z70
          IF        !@EQUAL
            MOVE      PMARQ012,PMARPROC
          ENDIF
.
          MATCH     PMARQ013,Z70
          IF        !@EQUAL
            MOVE      PMARQ013,PMARPROD
          ENDIF
.
          MATCH     PMARQ014,Z70
          IF        !@EQUAL
            MOVE      PMARQ014,PMARPRO1
          ENDIF
.
          MATCH     PMARQ015,Z70
          IF        !@EQUAL
            MOVE      PMARQ015,PMARPRO2
          ENDIF
.
          MATCH     PMARQ016,Z70
          IF        !@EQUAL
            MOVE      PMARQ016,PMARSIDE
          ENDIF
.
          MATCH     PMARQ017,Z70
          IF        !@EQUAL
            MOVE      PMARQ017,PMARCONO
          ENDIF
.
          MATCH     PMARQ018,Z70
          IF        !@EQUAL
            MOVE      PMARQ018,PMARCONF
          ENDIF
.
          MATCH     PMARQ019,Z70
          IF        !@EQUAL
            MOVE      PMARQ019,PMARPPBY
          ENDIF
.
          MATCH     PMARQ020,Z70
          IF        !@EQUAL
            MOVE      PMARQ020,PMARIHOS
          ENDIF
.
          MATCH     PMARQ021,Z70
          IF        !@EQUAL
            MOVE      PMARQ021,PMARPSAH
          ENDIF
.
          MATCH     PMARQ022,Z70
          IF        !@EQUAL
            MOVE      PMARQ022,PMARPHOS
          ENDIF
.
          MATCH     PMARQ023,Z70
          IF        !@EQUAL
            MOVE      PMARQ023,PMARPPAD
          ENDIF
.
          MATCH     PMARQ024,Z70
          IF        !@EQUAL
            MOVE      PMARQ024,PMARBTYP
          ENDIF
.
          MATCH     PMARQ025,Z70
          IF        !@EQUAL
            MOVE      PMARQ025,PMARANPR
          ENDIF
.
          MATCH     PMARQ026,Z70
          IF        !@EQUAL
            MOVE      PMARQ026,PMARCCBR
          ENDIF
.
          MATCH     PMARQ027,Z70
          IF        !@EQUAL
            MOVE      PMARQ027,PMARUDF1
          ENDIF
.
          MATCH     PMARQ028,Z70
          IF        !@EQUAL
            MOVE      PMARQ028,PMARANTY
          ENDIF
.
          MATCH     PMARQ029,Z70
          IF        !@EQUAL
            SQUEEZE   PMARQ029
            MOVE      ZERO,F5
            MOVE      PMARQ029,F5
            MOVE      F5,PMARODUR
            RESET     PMARQ029
          ENDIF
.
          MATCH     PMARQ030,Z70
          IF        !@EQUAL
            MOVE      PMARQ030,PMARPARC
          ENDIF
.
          MATCH     PMARQ031,Z70
          IF        !@EQUAL
            MOVE      PMARQ031,PMARCLTR
          ENDIF
.
          MATCH     PMARQ032,Z70
          IF        !@EQUAL
            SQUEEZE   PMARQ032
            MOVE      ZERO,F6
            MOVE      PMARQ032,F6
            MOVE      F6,PMARHGHT
            RESET     PMARQ032
          ENDIF
.
          MATCH     PMARQ033,Z70
          IF        !@EQUAL
            SQUEEZE   PMARQ033
            MOVE      ZERO,F6P2
            MOVE      PMARQ033,F6P2
            MULT      "100",F6P2
            MOVE      F6P2,PMARWGHT
            RESET     PMARQ033
          ENDIF
.
          MATCH     PMARQ034,Z70
          IF        !@EQUAL
            MOVE      PMARQ034,PMARCBMI
          ENDIF
.
          MATCH     PMARQ035,Z70
          IF        !@EQUAL
            MOVE      PMARQ035,PMARCOAG
          ENDIF
.
          MATCH     PMARQ036,Z70
          IF        !@EQUAL
            MOVE      PMARQ036,PMARRACG
          ENDIF
.
          MATCH     PMARQ037,Z70
          IF        !@EQUAL
            MOVE      PMARQ037,PMARAPLT
          ENDIF
.
          MATCH     PMARQ038,Z70
          IF        !@EQUAL
            MOVE      PMARQ038,PMARITCR
          ENDIF
.
          MATCH     PMARQ039,Z70
          IF        !@EQUAL
            MOVE      PMARQ039,PMARINTR
          ENDIF
.
          MATCH     PMARQ040,Z70
          IF        !@EQUAL
            MOVE      PMARQ040,PMARCLAM
          ENDIF
.
          MATCH     PMARQ041,Z70
          IF        !@EQUAL
            MOVE      PMARQ041,PMARSRCR
          ENDIF
.
          MATCH     PMARQ042,Z70
          IF        !@EQUAL
            MOVE      PMARQ042,PMARREFC
          ENDIF
.
          MATCH     PMARQ043,Z70
          IF        !@EQUAL
            MOVE      PMARQ043,PMARPRAC
          ENDIF
.
          MATCH     PMARQ044,Z70
          IF        !@EQUAL
            MOVE      PMARQ044,PMARPCNT
          ENDIF
.
          MATCH     PMARQ045,Z70
          IF        !@EQUAL
            MOVE      PMARQ045,PMARLSTS
          ENDIF
.
          MATCH     PMARQ046,Z70
          IF        !@EQUAL
            MOVE      PMARQ046,PMARINTS
          ENDIF
.
          MATCH     PMARQ047,Z70
          IF        !@EQUAL
            MOVE      PMARQ047,PMARSHTN
          ENDIF
.
          MATCH     PMARQ048,Z70
          IF        !@EQUAL
            SQUEEZE  PMARQ048
            MOVE     ZERO,F8
            MOVE     PMARQ048,F4
            MOVE     F4,PMARPLOS
            RESET    PMARQ048
          ENDIF
.
          MATCH     PMARQ049,Z70
          IF        !@EQUAL
            MOVE      PMARQ049,PMARNWHC
          ENDIF
.
          MATCH     PMARQ050,Z70
          IF        !@EQUAL
            MOVE      PMARQ050,PMARPRDT
          ENDIF
.
          MATCH     PMARQ051,Z70
          IF        !@EQUAL
            MOVE      PMARQ051,PMARTHLC
          ENDIF
.
          MATCH     PMARQ052,Z70
          IF        !@EQUAL
            MOVE      PMARQ052,PMARIMPR
          ENDIF
.
          MATCH     PMARQ053,Z70
          IF        !@EQUAL
            MOVE      PMARQ053,PMARIMPD
          ENDIF
.
          MATCH     PMARQ054,Z70
          IF        !@EQUAL
            MOVE      PMARQ054,PMARIMPO
          ENDIF
.
          MATCH     PMARQ055,Z70
          IF        !@EQUAL
            MOVE      PMARQ055,PMARBNGR
          ENDIF
.
          MATCH     PMARQ056,Z70
          IF        !@EQUAL
            MOVE      PMARQ056,PMAREXFX
          ENDIF
.
          MATCH     PMARQ057,Z70
          IF        !@EQUAL
            MOVE      PMARQ057,PMARSTAT
          ENDIF
.
          MATCH     PMARQ058,Z70
          IF        !@EQUAL
            MOVE      PMARQ058,PMARMAPR
          ENDIF
.
          MATCH     PMARQ059,Z70
          IF        !@EQUAL
            MOVE      PMARQ059,PMARTHRQ
          ENDIF
.
          MATCH     PMARQ060,Z70
          IF        !@EQUAL
            MOVE      PMARQ060,PMARRECC
          ENDIF
.
          MATCH     PMARQ061,Z70
          IF        !@EQUAL
            MOVE      PMARQ061,PMARRRCL
          ENDIF
.
          MATCH     PMARQ062,Z70
          IF        !@EQUAL
            MOVE      PMARQ062,PMARRREM
          ENDIF
.
          MATCH     PMARQ063,Z70
          IF        !@EQUAL
            MOVE      PMARQ063,PMARTSRC
          ENDIF
.
          MATCH     PMARQ064,Z70
          IF        !@EQUAL
            MOVE      PMARQ064,PMARAPRR
          ENDIF
.
MVPMAR99  RETURN
.
.
.------------------------------------------------------------
. Select list of linked hospital for a HCP
.------------------------------------------------------------
PMARHS00  MATCH     SP70,PMARRESC
          GOTO      PMARHS99 IF EQUAL
.
          MOVE      ZERO,F1                 * Hospital on file not displayed
          CALL      IBACLOCK
          PACK      DIM8,CCC,CYY,CMM,CDD
          REP       " 0",DIM8
.
          PACK      KEY10,PMARRESC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PMARHS99
.
          MATCH     "1",PMHCHOSS            * Hospital Specific HCP
          GOTO      PMARHS50 IF NOT EQUAL
.
          PACK      KEY13,PMARRESC,SP70
          CALL      RSMLHCP2                * positional read
PMARHS10  CALL      RKMLHCP2                * read a record
          BRANCH    OVRCD,PMARHS90
.
          MATCH     MLHCHCPC,PMARRESC
          GOTO      PMARHS90 IF NOT EQUAL
.
          MATCH     "1",MLHCACTV            * skip inactive codes
          GOTO      PMARHS10 IF EQUAL
.
          MATCH     MLHCSDAT,DIM8
          GOTO      PMARHS10 IF LESS
.
          MATCH     SP70,MLHCEDAT
          IF        !@EQUAL & !@EOS
            MATCH     DIM8,MLHCEDAT
            GOTO      PMARHS10 IF LESS
          ENDIF
.
          PACK      KEY3,MLHCHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMARHS10
.
          MATCH     PTHSHOSP,DIM3
          IF        @EQUAL
            MOVE      ONE,F1                * Hospital on file displayed
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                               PTHSNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#">":
                               PTHSNAME,"</option>"
          ENDIF
          GOTO      PMARHS10
.
PMARHS50  PACK      KEY3,SP70
          CALL      RSPTHSP1                * positional read
PMARHS60  CALL      RKPTHSP1                * read a record
          BRANCH    OVRCD,PMARHS90
.
          MATCH     PTHSHOSP,DIM3
          IF        @EQUAL
            MOVE      ONE,F1                * Hospital on file displayed
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                               PTHSNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#">":
                               PTHSNAME,"</option>"
          ENDIF
.
          GOTO      PMARHS60
.
PMARHS90  BRANCH    F1,PMARHS99             * Has hospital on file been listed
.
          PACK      KEY3,DIM3,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMARHS99
.
          WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                             PTHSNAME,"</option>"
.
PMARHS99  RETURN
