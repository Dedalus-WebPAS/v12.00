.*********************************************************************** 
.*                            CALCYRS                                  *
.*               Calculate the Number of Years between 2 dates         *
.*                                                                     *
.*   Parameters : CYRSFDTE  Calc Yrs From Date. (from PMIVARS)         *
.*                CYRSTDTE  Calc Yrs To   Date. (from PMIVARS)         * 
.*                                                                     * 
.*   Returns    : CYRSYEAR  Calc Yrs Number of Years (from PMIVARS)    *
.*                                                                     *
.* Modifications: 
.*                                                                     *
.*********************************************************************** 
.
CALCYRS   MOVE      ZERO,CYRSYEAR             * no of years 
.
.
          UNPACK    CYRSFDTE,XCENT,XYEAR,XMON,XDAY       * fromdate
.
          UNPACK    CYRSTDTE,CCENT,CYEAR,CMON,CDAY       * todate
.
.         Calculate the number of years
.
          MOVE      CCENT,FORM2               * Convert to a form field
          MOVE      FORM2,CYRSYEAR
          MOVE      XCENT,FORM2               * Convert to a form field
          SUB       FORM2,CYRSYEAR
          MULT      "100",CYRSYEAR
.
          MOVE      CYEAR,FORM2               * Convert to a form field
          ADD       FORM2,CYRSYEAR
          MOVE      XYEAR,FORM2               * Convert to a form field
          SUB       FORM2,CYRSYEAR
.
          COMPARE   ZERO,CYRSYEAR
          GOTO      CCYRS999 IF EQUAL
.
.         Check if the to month is < to month
.
          REP       " 0",CMON
          REP       " 0",XMON
          MATCH     XMON,CMON                 
          GOTO      CCYRS200 IF EQUAL
          GOTO      CCYRS999 IF NOT LESS
          SUB       ONE,CYRSYEAR                 * subtract one if it is less
          GOTO      CCYRS999
.
.         Check if the to day is < to day
.
CCYRS200  REP       " 0",CDAY
          REP       " 0",XDAY
          MATCH     XDAY,CDAY
          GOTO      CCYRS999 IF NOT LESS
          SUB       ONE,CYRSYEAR                 * subtract one if it is less
.
CCYRS999   RETURN
