.***************************************************************************
.* System    :   Inpatients                                                *
.* Program   :   IBAPMS40                                                  *
.* Desc      :   NSW EDW Extraction                                        *
.***************************************************************************
.* Date      :   19/01/2018                                                *
.* Author    :   Jill Parkinson                                            *
.* Function  :   This program will create the NSW EDW Extract              *
.* Modifications  :                                                        *
.***************************************************************************
.* V12.00.07  09/09/2025 Ebon Clements  Task 0960807                       *
.*            Recompiled for EDWADMPT - Obj 60 Attribute 01 - Babies       *
.* V12.00.06  25/08/2025 Ebon Clements  Task 0959908 0960807               *
.*            Recompiled for EDWADMPT - Obj 60 Attribute 01 - Babies       *
.* V12.00.05  15/08/2025 Ebon Clements  Task 0959908 0960807               *
.*            Recompiled for EDWADMPT - Obj 60 Attribute 01 - Babies       *
.* V12.00.04  05/08/2025 Ebon Clements  Task 0959930                       *
.*            Recompiled for EDWSERVS - Obj 70                             *
.*            Added GCOL0000 - Get column value for current sent stream    *
.* V12.00.03  30/07/2025 Nikitha B      Task 0952518                       *
.*            Recompiled for EDWADMPT - Obj 114                            *
.* V12.00.02  08/07/2025 Nikitha B      Task 0952518                       *
.*            Added to read PTCNGDX3 - ICED10 ED 12 for Obj  61, 56 & 114  *
.* V12.00.01  03/06/2025 Ebon Clements  Task 0959669                       *
.*            Recompiled for EDWEMERG - Obj 141 - Initial assessor         *
.* V11.05.03  29/04/2025 Ebon Clements  Task 9857524                       *
.*            Recompiled for EDWADMPT - Obj 142 - Bed transfer record id   *
.* V11.05.02  21/03/2025 Ebon Clements  Task 0954909                       *
.*            Recompiled for EDWADMPT - Obj 133 - leave event              *
.* V11.05.01  13/03/2025 Ebon Clements  Task 0957524                       *
.*            Recompiled for EDWADMPT - Obj 142 - Bed transfer             *
.* V11.04.18  29/10/2024 Ebon Clements  Task 0952514                       *
.*            Recompiled for EDWEMERG - Obj 61 diagnosis                   *
.* V11.04.17  22/10/2024 Ebon Clements  Task 0952857                       *
.*            Recompiled for EDWEMERG - Obj 63 initial assessor            *
.* V11.04.16  10/10/2024 Nikitha B      Task 0952518                       *
.*            Added to read PTCNGDX2 - ICED10 ED 12 for object 61 and 56   *
.* V11.04.15  03/10/2024 Ebon Clements  Task 0938123                       *
.*            Recompiled for EDWADMPT - Stat discharge                     *
.* V11.04.14  02/10/2024 Ebon Clements  Task 0951785                       *
.*            Recompiled for EDWNONAD - Obj 63 - service event provider    *
.* V11.04.13  16/09/2024 Ebon Clements  Task 0951071                       *
.*            Recompiled for EDWADMPT - Obj 142 - Bed transfer             *
.* V11.04.12  26/08/2024 Ebon Clements  Task 0941700                       *
.*            Recompiled for EDWCLINT - Trigger 01 object                  *
.* V11.04.11  26/08/2024 Ebon Clements  Task 0950552                       *
.*            Recompiled for EDWADMPT - Obj 112 - Public only              *
.* V11.04.10  09/07/2024 Ebon Clements  Task 0948939                       *
.*            Recompiled for EDWADMPT - Obj 112 - service event end date   *
.* V11.04.09  21/06/2024 Ebon Clements  Task 0947309                       *
.*            Recompiled for EDWCLINT - Obj 10 - Attr 04 MH Legal status   *
.* V11.04.08  27/05/2024 Ebon Clements  Task 0945367                       *
.*            Recompiled for EDWADMPT - Obj 60 - Attr 01, 03 and 09        *
.* V11.04.07  16/05/2024 Ebon Clements  Task 0945463                       *
.*            Recompiled for EDWADMPT - Obj 60 - Attr 09 MH Legal status   *
.* V11.04.06  15/05/2024 Ebon Clements  Task 0945463                       *
.*            Recompiled for EDWADMPT - Obj 60 - Attr 09 MH Legal status   *
.* V11.04.05  14/03/2024 Ebon Clements  Task 0944290                       *
.*            Recompiled for EDWINDSP - Obj 37 - ISP_ALT_ID_TYPE_CODE 041  *
.* V11.04.04  15/02/2024 Ebon Clements  Task 0933826                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.04.03  21/12/2023 Ebon Clements  Task 0888745                       *
.*            Recompiled for EDWEMERG - Obj 142 - NEWMV                    *
.* V11.04.02  14/12/2023 Ebon Clements  Task 0933826                       *
.*            Recompiled for EDWINDSP - Obj 42 and 43                      
.* V11.04.01  07.12.2023 Ebon Clements  Task 0938123                       *
.*            Recompiled for EDWADMPT - Obj 142                            *
.* V11.03.27  17.11.2023 David S        Task 0935552                       *
.*            Added nee DRG code for 11.0                                  *
.* V11.03.26  16/11/2023 Sunny          Task 0916075                       *
.*            Recompiled for EDWINDSP - Obj 37                             *
.* V11.03.25  10/11/2023 Sunny          Task 0916075                       *
.*            Recompiled for EDWINDSP - Obj 37                             *
.* V11.03.24  30/10/2023 Ebon Clements  Task 0888745                       *
.*            Recompiled for EDWEMERG - ED patient locations               *
.* V11.03.23  12/10/2023 Sunny          Task 0916075                       *
.*            Recompiled for EDWINDSP - Added Stafflink ID Changes         *
.* V11.03.22  11/08/2023 Sunny          Task 0916075                       *
.*            Recompiled for EDWINDSP - Obj 37                             *
.* V11.03.21  04/08/2023 Ebon Clements  Task 0925076                       *
.*            Recompiled for EDWSERVS - Obj 65 - WL_RELISTING_DATE         *
.* V11.03.20  26/07/2023 Ebon Clements  Task 0925076                       *
.*            Recompiled for EDWSERVS - Obj 65 - WL_RELISTING_DATE         *
.* V11.03.19  20/07/2023 DA Sarkies     Task 0932383                       *
.*            Recompiled for EDWADMPT - Increased size of PLEVOFFR         *
.* V11.03.18  03/07/2023 Ebon Clements  Task 0931366                       *
.*            Recompiled for EDWCLINT - Birth order details                *
.* V11.03.17  24/05/2023 Nikitha B      Task 0932585                       *
.*            Recompiled for EDWEMERG for EDWARD HEALTH_SERVICE_LOCATION_ID*
.* V11.03.16  25/05/2023 Nikitha B      Task 0932585                       *
.*            Read parameter EMCNHSID in INIT0000 for                      *
.*            EDWARD HEALTH_SERVICE_LOCATION_ID                            *
.* V11.03.15  22/05/2023 Alina Bhari    Task 0926535                       *
.*            Recompiled for EDWEMERG - Obj 02                             *
.* V11.03.14  08/05/2023 DA Sarkies     Task 0924970                       *
.*            Recompiled for EDWEMERG - Obj 141                            *
.* V11.03.13  05/05/2023 Sunny          Task 0924872                       *
.*            Recompiled for EDWEMERG - Obj 141                            *
.* V11.03.12  04/05/2023 Jacob Jackson  Task 0924084                       *
.*            Recompiled for EDWCLINT - Obj 03                             *
.* V11.03.11  31/03/2023 Ebon Clements  Task 0928833                       *
.*            Recompiled for EDWSERVS - Obj 66                             *
.* V11.03.10  28/03/2023 Ebon Clements  Task 0926535                       *
.*            Recompiled for EDWCLINT - Obj 02 Overseas Address            *
.* V11.03.09  17/03/2023 Bella Turco    Task 0924037                       *
.*            Recompiled for EDWEMERG - Obj 63                             *
.* V11.03.08  14/03/2023 Bella Turco    Task 0924037                       *
.*            Recompiled for EDWEMERG - Obj 63                             *
.* V11.03.07  03/03/2023 Bella Turco    Task 0924037                       *
.*            Recompiled for EDWEMERG - Obj 63                             *
.* V11.03.06  13/02/2023 Bella Turco    Task 0927894                       *
.*            Recompiled for EDWADMPT - Obj 131                            *
.*            RELATED_SERVICE_EVENT_TYPE_CODE                              *
.* V11.03.05  13/02/2023 Bella Turco    Task 0926535                       *
.*            Recompiled for EDWCLINT - Obj 02 Overseas Address            *
.* V11.03.04  09/02/2023 Bella Turco    Task 0923869                       *
.*            Recompiled for EDWSERVS - Obj 66 Attr 01 Financial Class     *
.* V11.03.03  15/12/2022 Bella Turco    Task 0923869                       *
.*            Recompiled for EDWSERVS - Obj 66 Attr 01 Financial Class     *
.* V11.03.02  07/12/2022 Bella Turco    Task 0926531                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.03.01  14/11/2022 Bella Turco    Task 0923504                       *
.*            Added CONTROLF read for EMCNSEDR in INIT0000                 *
.* V11.02.15  10/11/2022 Jill Parkinson Task 0899679                       *
.*            Recompiled for EDWADMPT, EDWCLINT, EDWSERVS section 3,4,5    *
.* V11.02.14  08/11/2022 Jill Parkinson Task 0923421                       *
.*            Recompiled for EDWADMPT - blank medicare                     *
.* V11.02.13  03/11/2022 Ebon Clements  Task 0924816                       *
.*            Recompiled for EDWADMPT - Obj 142                            *
.*            HEALTH_SERVICE_LOCATION_TRANSFER_REASON_CODE                 *
.* V11.02.12  18/10/2022 Ebon Clements  Task 0923637                       *
.*            Recompiled for EDWADMPT - Obj 112 after 1 July 2022          *
.*            SERVICE_EVENT_SEPARATION_MODE_NHDD_CODE - SEPRMODE           *
.* V11.02.11  13/10/2022 Ebon Clements  Task 0923424                       *
.*            Recompiled for EDWCLINT - Obj 8 - BIRTH_ORDER_CODE           *
.* V11.02.10  13/10/2022 Ebon Clements  Task 0923658                       *
.*            Recompiled for EDWEMERG - Don't send obj 60 sub event 02     *
.* V11.02.09  04/10/2022 Jill Parkinson Task 0924783                       *
.*            Added DRG100 to map to 456456 for EDWADMPT                   *
.* V11.02.08  05/09/2022 Ebon Clements  Task 0923873                       *
.*            Recompiled for EDWSERVS - Obj 72 - REQUEST_SOURCE_TYPE_CODE  *
.* V11.02.07  30/08/2022 Jill Parkinson Task 0924032                       *
.*            Recompiled for EDWADMPT - mothers adm to find inp only       *
.* V11.02.06  22/08/2022 Ebon Clements  Task 0922786                       *
.*            Recompiled for EDWINDSP - Obj 33 - PAEDIATRIC_SPECIALTY_FLAG *
.* V11.02.05  16/06/2022 Ebon Clements  Task 0915275                       *
.*            Recompiled for EDWEMERG - Obj 141-04 and 141-10              *
.* V11.02.04  31/03/2022 Jill Parkinson Task 0903848                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.02.03  24/03/2022 Jill Parkinson Task 0903848                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.02.02  01/03/2022 Ebon Clements  Task 0915275                       *
.*            Recompiled for EDWEMERG - Obj 141-04 and 141-10              *  
.* V11.02.01  24/01/2022 Jill Parkinson Task 0899679                       *
.*            Recompiled for EDWCLINT and EDWSERVS                         *
.* V11.01.06  06/01/2022 Jill Parkinson Task 0914424                       *
.*            Recompiled for EDWCLINT and EDWADMPT                         *
.* V11.01.05  28/09/2021 Ebon Clements  Task 0899679                       *
.*            Recompiled for EDWINDSP                                      *
.* V11.01.04  21/09/2021 Ebon Clements  Task 0899679                       *
.*            Recompiled for EDWINDSP                                      *
.* V11.01.03  18/08/2021 Ebon Clements  Task 0904255                       *
.*            Recompiled for EDWEMERG - Triage nurse                       *
.* V11.01.02  09/08/2021 Jill Parkinson Task 0893922                       *
.*            Added pension status changes                                 *
.* V11.01.01  18/05/2021 Ebon Clements  Task 0886023                       *
.*            Added PTCNEXED - Collect extra container information         *
.*            Recompiled for EDWNONAD                                      *
.*            Recompiled for EDWEMERG                                      *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.66  24/03/2021 Jill Parkinson Task 0892530                       *
.*            Recompiled for EDWSERVS - obj 68 to resend after priority upd*
.* V11.00.65  09/12/2020 Ebon Clements  Task 0900804                       *
.*            Recompiled for EDWEMERG - ED Obj 141 sub event 10            *
.* V11.00.64  23/11/2020 Jill Parkinson Task 0899677                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.63  01/10/2020 Jill Parkinson Task 0897100                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.62  24/09/2020 Jill Parkinson Task 0897361                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.61  22/09/2020 Ebon Clements  Task 0897131                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.60  16/09/2020 Jill Parkinson Task 0896842                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.59  14/09/2020 Ebon Clements  Task 0897082                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.58  10/09/2020 Ebon Clements  Task 0897079 0897079               *
.*            Recompiled for EDWEMERG and EDWADMPT                         *
.* V11.00.57  10/09/2020 Ebon Clements  Task 0897140 0897090               *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.56  04/09/2020 Jill Parkinson Task 0896270                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.55  03/09/2020 Ebon Clements  Task 0896781                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.54  02/09/2020 Jill Parkinson Task 0896840                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.53  01/09/2020 Ebon Clements  Task 0896519                       *
.*            Recompiled for EDWNONAD                                      *
.* V11.00.52  24/08/2020 Jill Parkinson Task 0896382, 0896270 and 0896174  *
.*            Recompiled for EDWADMPT,EDWCLINT                             *
.* V11.00.51  17/08/2020 Ebon Clements  Task 0895226                       *
.*            Recompiled for EDWINDSP                                      *
.* V11.00.50  17/08/2020 Jill Parkinson Task 0895889                       *
.*            Recompiled for EDWCLINT                                      *
.* V11.00.49  17/08/2020 Ebon Clements  Task 0895226                       *
.*            Recompiled for EDWINDSP                                      *
.* V11.00.48  11/08/2020 Jill Parkinson Task 0895779                       *
.*            Fixed write to comedfaf                                      *
.* V11.00.47  10/08/2020 Ebon Clements  Task 0895226                       *
.*            Recompiled for EDWINDSP                                      *
.* V11.00.46  03/08/2020 Jill Parkinson Task 0895444                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.45  20/07/2020 Ebon Clements  Task 0894556                       *
.*            Recompiled for EDWNONAD                                      *
.* V11.00.44  20/07/2020 Ebon Clements  Task 0894112                       *
.*            Recompiled for EDWNONAD                                      *
.* V11.00.43  19/07/2020 Jill Parkinson Task 0894589, 0894573, 0894600     *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.42  13/07/2020 Ebon Clements  Task 0894112                       *
.*            Recompiled for EDWNONAD                                      *
.* V11.00.41  10/07/2020 Jill Parkinson Task 0894370                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.40  07/07/2020 Jill Parkinson Task 0896141                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.39  06/07/2020 Ebon Clements  Task 0894112                       *
.*            Recompiled for EDWNONAD                                      *
.* V11.00.38  03/07/2020 Jill Parkinson Task 0893720                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.37  02/07/2020 Jill Parkinson Task 0893720                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.36  30/06/2020 Jill Parkinson Task 0893720                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.35  29/06/2020 Jill Parkinson Task 0893853                       *
.*            Recompiled for EDWCLINT and EDWSERVS                         *
.* V11.00.34  28/06/2020 Jill Parkinson Task 0893710                       *
.*            Recompiled for EDWCLINT                                      *
.* V11.00.33  25/06/2020 Jill Parkinson Task 0893710 and 0893720           *
.*            Recompiled for EDWCLINT and EDWSERVS                         *
.* V11.00.32  23/06/2020 Jill Parkinson Task 0893583 and 0893553           *
.*            Recompiled for EDWCLINT and EDWADMPT                         *
.* V11.00.31  23/06/2020 Ebon Clements  Task 0893464                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.30  17/06/2020 Ebon Clements  Task 0888984                       *
.*            Recompiled for EDWEMERG & EDWADMPT                           *
.*            Changed employment status from a dim 1 to a dim 5 - EMPLOYMS *
.* V11.00.29  17/06/2020 Jill Parkinson Task 0892683                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.28  17/06/2020 Ebon Clements  Task 0893191                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.27  15/06/2020 Jill Parkinson Task 0893076                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.26  12/06/2020 Jill Parkinson Task 0892632                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.25  11/06/2020 Jill Parkinson Task 0893076  and 0893079          *
.*            Recompiled for EDWCLINT,EDWSERVS and EDWADMPT                *
.* V11.00.24  09/06/2020 Jill Parkinson Task 0892632 and 0892513           *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.23  03/06/2020 Ebon Clements  Task 0892602                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.22  02/06/2020 Ebon Clements  Task 0892640                       *
.*            Recompiled for EDWNONAD                                      *
.* V11.00.21  01/06/2020 Ebon Clements  Task 0892602                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.20  29/05/2020 Ebon Clements  Task 0892523                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.19  29/05/2020 Jill Parkinson Task 0892513                       *
.*            Cleared OBJECTRT in EDDK0000                                 *
.* V11.00.18  24/05/2020 Jill Parkinson Task 0892120 0892253 0892254       *
.*                       0892255 0892256                                   *
.*            Recompiled for EDWSERVS,EDWADMPT,EDWCLINT                    *
.* V11.00.17  23/05/2020 Jill Parkinson Task 0892120                       *
.*            Recompiled for EDWSERVS                                      *
.* V11.00.16  20/05/2020 Jill Parkinson Task 0892096                       *
.*            Recompiled for EDWCLINT                                      *
.* V11.00.15  19/05/2020 Ebon Clements  Task 0891871                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.14  16/05/2020 Jill Parkinson Task 0891375                       *
.*            Recompiled for EDWCLINT,EDWSERVS and EDWADMPT                *
.* V11.00.13  12/05/2020 Ebon Clements  Task 0891032                       *
.*            Recompiled for EDWEMERG and EDWNONAD                         *
.* V11.00.12  07/05/2020 Jill Parkinson Task 0890966                       *
.*            Added RCOL0000 - returns the last column for an object       *
.* V11.00.11  05/05/2020 Ebon Clements  Task 0891432                       *
.*            Recompiled for EDWEMERG                                      *
.* V11.00.10  06/04/2020 Jill Parkinson Task 0890394                       *
.*            Recompiled for EDWCLINT                                      *
.* V11.00.09  06/04/2020 Jill Parkinson Task 0890394                       *
.*            Recompiled for EDWCLINT                                      *
.* V11.00.08  04/04/2020 Jill Parkinson Task 0890394                       *
.*            Recompiled for EDWCLINT                                      *
.* V11.00.07  02/04/2020 Jill Parkinson Task 0889928                       *
.*            Added end of last 63 OP when discharging                     *
.* V11.00.06  31/03/2020 Jill Parkinson Task 0889928                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.05  27/03/2020 Jill Parkinson Task 0889928 and 0889929           *
.*            Recompiled for EDWADMPT and EDWCLINT                         *
.* V11.00.04  13/03/2020 Jill Parkinson Task 0884272                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.03  11/03/2020 Jill Parkinson Task 0889117                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.02  02/03/2020 Jill Parkinson Task 0889117                       *
.*            Recompiled for EDWADMPT                                      *
.* V11.00.01  26/02/2020 Jill Parkinson Task 0888779 and 0884497           *
.*            Recompiled for EDWADMPT  and EDWSERVS                        *
.* V10.15.32  20/02/2020 Jill Parkinson Task 0884497                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.15.31  18/02/2020 Jill Parkinson Task 0888471 and 0888464           *
.*            Recompiled for EDWCLINT                                      *
.* V10.15.30  14/02/2020 Ebon Clements  Task 0885010                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.15.29  12/02/2020 Ebon Clements  Task 0879283                       *
.*            Recompiled for EDWCLINT - NDIS Obj 5                         *
.* V10.15.28  07/02/2020 Ebon Clements  Task 0879283                       *
.*            Recompiled for EDWCLINT - NDIS Obj 10                        *
.* V10.15.27  05/02/2020 Ebon Clements  Task 0888002                       *
.*            Recompiled for EDWINDSP - Obj 32 end dates                   *
.*            05/02/2020 Jill Parkinson Task 0887253                       *
.*            Recompiled for EDWSERVS - Obj 65,66 72 for DOL changed       *
.* V10.15.26  24/01/2020 Ebon Clements  Task 0879283                       *
.*            Recompiled for EDWCLINT - NDIS Obj 10                        *
.* V10.15.25  23/01/2020 Ebon Clements  Task 0879283                       *
.*            Recompiled for EDWCLINT - NDIS Obj 10                        *
.* V10.15.24  16/01/2020 Jill Parkinson Task 0885455                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.15.23  10/01/2020 Jill Parkinson Task 0885160 and 0885290           *
.*            Recompiled for EDWADMPT                                      *
.* V10.15.22  08/01/2020 Ebon Clements  Task 0886928                       *
.*            Recompiled for EDWEMERG - Obj 62 effective start date        *
.* V10.15.21  06/01/2020 Ebon Clements  Task 0879283                       *
.*            Recompiled for EDWCLINT - NDIS                               *
.* V10.15.20  19/12/2019 Jill Pakrinson Task 0885010 0886383 0886414       *
.*            Recompiled for EDWSERVS and EDWCLINT                         *
.* V10.15.19  12/12/2019 Ebon Clements  Task 0886202                       *
.*            Recompiled for EDWEMERG - obj 63                             *
.* V10.15.18  12/12/2019 Ebon Clements  Task 0886198                       *
.*            Recompiled for EDWNONAD - obj 60                             *
.*            11/12/2019 Jill Parkinson Task 0885452                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.15.17  06/12/2019 Jill Parkinson Task 0885290 0885160               *
.*            Added check to LSOF0000 to ignore deleted records            *
.*            Added check to LSOF0000 to ignore old value if not passed in *
.*            from calling procedure                                       *
.* V10.15.16  28/11/2019 Ebon Clements  Task 0885366                       *
.*            Recompiled for EDWNONAD - Obj 73 cancel booking ECAN0000     *
.* V10.15.15  27/11/2019 Jill Parkinson Task 0885268 0884271 0884280       *
.*            Recompiled for EDWCLINT,EDWSERVS,EDWADMPT                    *
.* V10.15.14  27/11/2019 Ebon Clements  Task 0885257                       *
.*            Recompiled for EDWINDSP - Obj 42 Telephone effective date    *
.* V10.15.13  21/11/2019 Jill Parkinson Task 0885039                       *
.*            Changed CHKFIRST to compare CMEWSCDT to STRTDATE (instead of *
.*            CMEWSDAT -date extract run)                                  *
.* V10.15.12  20/11/2019 Ebon Clements  Task 0884982                       *
.*            Recompiled for EDWINDSP - Source created date Obj 38, 42 & 32*
.* V10.15.11  20/11/2019 Ebon Clements  Task 0885051                       *
.*            Recompiled for EDWNONAD - Referral cancellation date         *
.* V10.15.10  20/11/2019 Ebon Clements  Task 0885033                       *
.*            Recompiled for EDWEMERG - Did not attend diagnosis           *
.* V10.15.09  17/11/2019 Jill Parkinson Task 0884274 0884145 0884140       *
.*            Recompiled for EDWADMPT and EDWCLINT                         *
.* V10.15.08  17/11/2019 Jill Parkinson Task 0884274 0884145 0884140       *
.*            Recompiled for EDWADMPT and EDWCLINT                         *
.* V10.15.07  11/11/2019 Ebon Clements  Task 0883803                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.15.06  11/11/2019 Ebon Clements  Task 0883547                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.15.05  10/11/2019 Jill Parkinson Task 0884121,0884142               *
.*            Recompiled for EDWADMPT                                      *
.* V10.15.04  29/10/2019 Ebon Clements  Task 0883547                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.15.03  25/10/2019 Ebon Clements  Task 0883471                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.15.02  17/10/2019 Jill Parkinson Task 0882763                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.15.01  02/10/2019 Ebon Clements  Task 0882467                       *
.*            Recompiled for EDWEMERG and EDWNONAD - Merge                 *
.*            Added DLOF0000 send a delete record for the last sent object *
.* V10.14.82  01/10/2019 Jill Parkinson Task 0882126                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.81  01/10/2019 Ebon Clements  Task 0882197                       *
.*            Recompiled for EDWEMERG and EDWNONAD - Merge                 *
.* V10.14.80  01/10/2019 Ebon Clements  Task 0882197                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.14.79  01/10/2019 Ebon Clements  Task 0882096                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.78  25/09/2019 Jill Parkinson Task 0881755                       *
.*            Recompiled for EDWSERVS and EDWCLINT                         *
.* V10.14.77  18/09/2019 Ebon Clements  Task 0881751                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.76  18/09/2019 Jill Parkinson Task 0881407                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.75  12/09/2019 Ebon Clements  Task 0881147                       *
.*            Recompiled for EDWINDSP                                      *
.*            Retain source modified time od 00:00:00 for add records      *
.*            in WRCOND00                                                  *
.* V10.14.74  12/09/2019 Ebon Clements  Task 0881147                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.14.73  10/09/2019 Jill Parkinson Task 0881375                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.72  06/09/2019 Ebon Clements  Task 0881147                       *
.*            Recompiled in EDWINDSP                                       *
.* V10.14.71  04/09/2019 Jill Parkisnon Task 0880814 and 0881005           *
.*            Recompiled for EDWCLINT and EDWADMPT                         *
.* V10.14.70  03/09/2019 Ebon Clements  Task 0881006                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.69  30/08/2019 Jill Parkinson Task 0880287                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.68  29/08/2019 Ebon Clements  Task 0880763                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.67  27/08/2019 Jill Parkinson Task 0880389                       *
.*            Fixed move of csv for us1                                    *
.* V10.14.66  23/08/2019 Ebon Clements  Task 0880317                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.65  22/08/2019 Ebon Clements  Task 0880317                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.64  21/08/2019 Jill Parkinson Task 0880280                       *
.*            Fixed squeeze of new ur numbers for merges                   *
.*            Recompiled of EDWCLINT - alias deletes, insurance info       *
.* V10.14.63  21/08/2019 Jill Parkinson Task 0880212                       *
.*            Added extra call to GETMD500 in case us1 script changed txt  *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.62  20/08/2019 Ebon Clements  Task 0879942 0880191               *
.*            Recompiled for EDWEMERG                                      *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.61  16/08/2019 Jill Parkinson Task 0879283                       *
.*            Recompiled for EDWSERVS - corrected skipping cancelled       *
.*            bookings                                                     *
.* V10.14.60  16/08/2019 Jill Parkinson Task 0879417                       *
.*            Recompiled for EDWCLINT -  unpack to SP70 corrected          *
.* V10.14.59  16/08/2019 Ebon Clements  Task 0879942                       *
.*            Recompiled for EDWNONAD - Additional Obj 54 "O" record       *
.* V10.14.58  14/08/2019 Jill Parkinson Task 0878505                       *
.*            Increased TRANSREA from 4 to 5                               *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.57  14/08/2019 Jill Parkinson Task 0879236                       *
.*            Added open of watcataf                                       *
.* V10.14.56  14/08/2019 Jill Parkinson Task 0879236                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.55  08/08/2019 Jill Parkinson Task 0879417                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.54  31/07/2019 Jill Parkinson Task 0878505                       *
.*            Added column 22 heading for admitted 63 objects              *
.*            Recompiled for EDWADMPT                                      *
.*            31/07/2019 Ebon Clements  Task 0878559                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.53  30/07/2019 Ebon Clements  Task 0878556                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.52  22/07/2019 Jill Parkinson Task 0878412                       *
.*            Recompiled for EDWCLINT - Added alias deletes/additions      *
.*            and 04 insurance records                                     *
.* V10.14.51  17/07/2019 Jill Parkinson Task 0877083                       *
.*            Recompiled for EDWCLINT - Object 10 MHLS                     *
.* V10.14.50  17/07/2019 Jill Parkinson Task 0878418                       *
.*            Added bokrx1af                                               *
.* V10.14.49  11/07/2019 Ebon Clements  Task 0878073                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.48  05/07/2019 Ebon Clements  Task 0877753                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.47  01/07/2019 Ebon Clements  Task 0876030                       *
.*            Recompiled for EDWEMERG and EDWNONAD                         *
.* V10.14.46  28/06/2019 Jill Parkinson Task 0876602                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.45  26/06/2019 Ebon Clements  Task 0876932                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.44  25/06/2019 Ebon Clements  Task 0876030                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.43  17/06/2019 Ebon Clements  Task 0876030                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.42  12/06/2019 Ebon Clements  Task 0876029                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.41  07/06/2019 Ebon Clements  Task 0876030                       *
.*            Recompiled for EDWNONAD                                      *
.*            Don't call CHKFIRST for delete record in WRCOND00            *
.* V10.14.40  03/06/2019 Jill Parkinson Task 0873054                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.39  02/06/2019 Jill Parkinson Task 0873054                       *
.*            Added ARRVMODE and recompiled for EDWADMPT                   *
.* V10.14.38  02/06/2019 Jill Parkinson Task 0875107                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.37  21/05/2019 Ebon Clements  Task 0874321                       *
.*            Recompiled for EDWNONAD                                      *
.*            Added CHKFIRST to set add record source modified date/time   *
.* V10.14.36  20/05/2019 Jill Parkinson Task 0873055                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.35  15/05/2019 Ebon Clements  Task 0874075                       *
.*            Recompiled for EDWINDSP                                      *
.*            Changed CSOF0000 and LSOF0000 to include records from        *
.*            the current extract when doing a re run                      *
.* V10.14.34  15/05/2019 Ebon Clements  Task 0874272                       *
.*            Recompiled for EDWEMERG - OBJ 63  record Id                  *
.* V10.14.33  13/05/2019 Ebon Clements  Task 0874272                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.32  07/05/2019 Ebon Clements   Task 0874051                      *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.31  07/05/2019 Jill Parkinson  Task 0874164                      *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.30  07/05/2019 Ebon Clements  Task 0874075                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.14.29  03/05/2019 Jill Parkinson Task 0874143                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.28  30/04/2019 Jill Parkinson Task 0873835                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.27  17/04/2019 Jill Parkinson Task 0873055                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.26  15/04/2019 Jill Parkinson Task 0873055                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.25  15/04/2019 Ebon Clements  Task 0873156                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.14.24  12/04/2019 Jill Parkinson Task 0882286                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.23  10/04/2019 Jill Parkinson Task 0873164                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.22  08/04/2019 Jill Parkinson Task 0872797                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.21  05/04/2019 Ebon Clements  Task 0872815                       *
.*            Recompiled for EDWEMERG                                      *
.*            Changed WRCOND00 to update the source modifield date/time    *
.*            for delete records                                           *
.* V10.14.20  03/04/2019 Ebon Clements  Task 0872690                       *
.*            Recompiled for EDWINDSP                                      *
.*            Added LSOF0000 - Change last sent stream object field        *
.* V10.14.19  01/04/2019 Jill Parkinson Task 0872599                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.18  29/03/2019 Ebon Clements  Task 0872483                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.17  26/03/2019 Jill Parkinson Task 0871784                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.16  24/03/2019 Jill Parkinson Task 0871958 & 0871910             *
.*            Recompiled for EDWCLINT                                      *
.* V10.14.15  20/03/2019 Ebon Clements  Task 0871780 & 0871866             *
.*            Recompiled for EDWINDSP                                      *
.*            19/03/2019 Ebon Clements  Task 0871777 & 0871889             *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.14  14/03/2019 Ebon Clements  Task 0871327                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.13  11/03/2019 Jill Parkinson Task 0871327                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.12  07/03/2019 Ebon Clements  Task 0871473                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.14.11  05/03/2019 Ebon Clements  Task 0871327                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.14.10  04/03/2019 Jill Parkinson Task 0871097                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.09  04/03/2019 Jill Parkinson Task 0871097                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.08  04/03/2019 Jill Parkinson Task 0871097                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.14.07  28/02/2019 Ebon Clements  Task 0871097                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.14.06  25/02/2019 Jill Parkinson Task 0870828                       *
.*            Recompiled for EDWADMPT                                      *
.*            21/02/2019 Ebon Clements  Task 0870899                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.14.05  20/02/2019 Tracey Nguyen  Task 0869882                       *
.*            Added PMSRELFD/IO for EDWCLINT -  Relationship mapping       *
.* V10.14.04  18/02/2019  Ebon Clements Task 0829856                       *
.*            Recompiled for GETEFDRG - Contract from effective date       *
.* V10.14.03  10/02/2019 Jill Parkinson Task 0869604                       *
.*            Recompiled for EDWCLINT - mother baby relationship           *
.*            Recompiled for EDWADMPT - diagnosis key value                *
.* V10.14.02  06/02/2019 Jill Parkinson Task 0870128                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.14.01  01/02/2019 Ebon Clements  Task 0869605                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.13.76  30/01/2019 Jill Parkinson Task 0869604                       *
.*            Recompiled for EDWCLINT - Relationship mapping               *
.* V10.13.75  23/01/2019 Ebon Clements  Task 0869604                       *
.*            Recompiled for EDWEMERG - Source modified date               *
.*            Recompiled for EDWNONAD - Source modified date               *
.*            23/01/2019 Jill Parkinson Task 0869604                       *
.*            Recompiled for EDWCLINT - merge 01 object corrected          *
.* V10.13.74  22/01/2019 Ebon Clements  Task 0868909                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.13.73  18/01/2019 Jill Parkinson Task 0864975                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.72  17/01/2019 Ebon Clements  Task 0868909                       *
.*            Recompiled for EDWINDSP - Doctor unit                        *
.* V10.13.71  17/11/2019 Jill Parkisnon Task 0864976                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.70  14/01/2019 Ebon Clements  Task 0868909                       *
.*            Loop until key changes in CFOS0000 even if change value or   *
.*            column to change is not found                                *
.* V10.13.69  10/01/2019 Ebon Clements  Task 0868909                       *
.*            Added ISP Audit changes - PMSIDWFD                           *
.*            13/01/2019 Jill Parkinson Task 0864976                       *
.*            Recompiled for EDWCLINT,EDWSERVS,EDWADMPT source_modified    *
.* V10.13.68  09/01/2019 Jill Parkinson Task 0864975                       *
.*            Recompiled for EDWCLINT  - HD rebounds                       *
.* V10.13.67  30/12/2018 Jill Parkinson Task 0864976                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.13.66  21/12/2018 Jill Parkisnon Task 0864975                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.65  17/12/2018 Ebon Clements  Task 0867421                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.64  16/12/2018 Jill Parkinson Task 0867308                       *
.*            Recompiled for EDWSERVS - Recycle SIT1 issues                *
.* V10.13.63  14/12/2018 Ebon Clements  Task 0864975                       *
.*            Recompiled for EDWCLINT - 09 purno squeezed                  *
.* V10.13.62  14/12/2018 Ebon Clements  Task 0867421                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.61  12/12/2018 Jill Parkinson Task                               *
.*            Added SRMDDATE/SRMDTIME                                      * 
.*            12/12/2018 Ebon Clements  Task 0867299                       *
.*            Default SRCRDATE/SRCRTIME to extract end date and 23:59:00   *
.*            if not populated                                             *
.* V10.12.60  11/12/2018 Jill Parkinson Task 0864975                       *
.*            Recompiled for EDWCLINT and EDWSERVS rebound doc 1           *
.* V10.13.58  07/12/2018 Ebon Clements  Task 0867299                       *
.*            Recompiled for EDWEMERG - SOURCE_CREATE_DATETIME             *
.* V10.13.57  24/11/2018 Jill Parkinson Task 0864976                       *
.*            Recompiled for EDWADMPT - send alterations                   *
.* V10.13.58  03/12/2018 Jill Parkinson Task 0864975                       *
.*            Recompiled for EDWCLINT - send merge updates                 *
.* V10.13.57  26/11/2018 Ebon Clements  Task 0864975                       *
.*            Added CSOF0000 - Change sent stream object field (Merge)     *
.* V10.13.56  24/11/2018 Jill Parkinson Task 0864976                       *
.*            Recompiled for EDWADMPT - send alterations                   *
.* V10.13.55  21/11/2018 Ebon Clements  Task 0864976                       *
.*            Recompiled for EDWNONAD - Year Last Admitted to Psych        *
.*            Added EDDK0000 - Deletes for stream object and key           *
.*            Recompiled for EDWADMPT - AMBULANCE_INCIDENT_ID              *
.* V10.13.54  29/10/2018 Jill Parkinson Task 0865756                       *
.*            Recompiled for EDWCLINT and added source create date and time*
.* V10.13.53  17/10/2018 Ebon Clements  Task 0865192                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.52  16/10/2018 Ebon Clements  Task 0865192                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.51  11/10/2018 Jill Parkinson Task 0863557                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.50  09/10/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.49  08/10/2018 Jill Parkinson Task 0862355 and 0861709           *
.*            Recompiled for EDWCLINT and EDWSERVS                         *
.* V10.13.48  04/10/2018 Ebon Clements  Task 0861770                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.13.47  03/10/2018 Jill Parkinson Task 0862271                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.46  03/10/2018 Ebon Clements  Task 0861770                       *
.*            Recompiled for EDWEMERG                                      *
.*            30/09/2018 Jill Parkinson Task 0862271                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.13.45  26/09/2018 Jill Parkinson Task 0862271                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.44  26/09/2018 Ebon Clements  Task 0861770                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.13.43  26/09/2018 Jill Parkinson Task 0862272                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.42  21/09/2018 Jill Parkinson Task 0861841                       *
.*            Increased PRIMTREA from dim 1 to 10                          *
.* V10.13.41  21/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.40  20/09/2018 Jill Parkinson Task 0861841                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.13.39  20/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.38  19/09/2018 Ebon Clements  Task 0863501                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.13.37  19/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.36  18/09/2018 Jill Parkinson Task 0861839                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.35  18/09/2018 Ebon Clements  Task 0861770                       *
.*            Added DELETKEY                                               *
.* V10.13.34  18/09/2018 Jill Parkinson Task 0863558                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.33  17/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.*            17/09/2018 Jill Parkinson Task 0862272                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.13.32  16/09/2018 Jill Parkinson Task 0862272                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.13.31  16/09/2018 Jill Parkinson Task 0863557                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.30  14/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.29  14/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.28  12/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.*            14/09/2018 Jill Parkinson Task 0861841                       *
.*            Recompiled for EDWADMPT                                      *
.* V10.13.27  12/09/2018 Jill Parkinson Task 0861841                       *
.*            Recompiled for EDWADMPT - rebound document 1                 *
.*            12/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.26  10/09/2018 Ebon Clements  Task 0862246                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.13.25  07/09/2018 Jill Parkinson Task 0861841                       *
.*            Recompiled for EDWADMPT - cr obj 56,60,63,59,112,115 and 131 *
.*            07/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - birth order                        *
.*            07/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - alternate id delete record         *
.* V10.13.24  07/09/2018 Jill Parkinson Task 0862271                       *
.*            Recompiled for EDWINDSP and EDWSERVS for keys                *
.*            06/09/2018 Jill Parkinson Task 0862271                       *
.*            Recompiled for EDWCLINT - removed urnumber from keys         *
.*            06/09/2018 Jill Parkinson Task 0862271                       *
.*            Recompiled for EDWEMERG - removed visit from keys            *
.*            06/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - alternate id delete                *
.*            06/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - beta document 3                    *
.*            05/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - beta document 3                    *
.*            05/09/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - changed object 09 to 05 for alt id *
.* V10.13.23  04/09/2018 Jill Parkinson Task 0862563                       *
.*            Recompiled for EDWSERVS - fixed key for  previous 66         *
.* V10.13.22  03/09/2018 Jill Parkinson Task 0862563                       *
.*            Recompiled for EDWSERVS - end previous 66                    *
.* V10.13.21  31/08/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT - beta rebounds                      *
.* V10.13.20  24/08/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.13.19  24/08/2018 Jill Parkinson Task 0861770                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.18  23/08/2018 Jill Parkinson Task 0861709                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.17  23/08/2018 Ebon Clements  Task 0861770                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.13.16  23/08/2018 Ebon Clements  Task 0861770                       *
.*            Recompiled for EDWEMERG - Service provider id                *
.* V10.13.15  22/08/2018 Jill Parkinson Task 0862355                       *
.*            Recompiled for EDWCLINT - medicare ref in object key for 05  *
.* V10.13.14  22/08/2018 Jill Parkinson Task 0862355                       *
.*            Recompiled for EDWCLINT - medicare                           *
.* V10.13.13  22/08/2018 Jill Parkinson Task 0861535                       *
.*            Added patmi1a8 and recompiled for EDWCLINT                   *
.* V10.13.12  21/08/2018 Jill Parkinson Task 0854795                       *
.*            Recompiled for EDWSERVS - OBJ 73                             *
.* V10.13.11  21/08/2018 Jill Parkinson Task 0854795                       *
.*            Added open of patgsrnf for alias records                     *
.* V10.13.10  20/08/2018 Jill Parkinson Task 0861709                       *
.*            Added read of PTCNNNEXT                                      *
.* V10.13.09  19/08/2018 Jill Parkinson Task 0854795                       *
.*            Recompiled for EDWCLINT - 06 end previous modifications      *
.* V10.13.08  16/08/2018 Jill Parkinson Task 0861206                       *
.*            Corrected object headers                                     *
.* V10.13.07  13/08/2018 Ebon Clements  Task R0861770                      *
.*            Recompiled for EDWEMERG                                      *
.* V10.13.06  10/08/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWCLINT                                      *
.*            10/08/2018 Jill Parkinson Task 0861535                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.13.05  10/08/2018 Jill Parkinson Task 0861709                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.13.04  08/08/2018 Jill Parkinson Task 0861206                       *
.*            Added object headers                                         *
.* V10.13.03  03/08/2018 Jill Parkinson Task 0846170                       *
.*            Recompiled for EDWSERVS - corrected obj 70 and 73            *
.* V10.13.02  02/08/2018 Jill Parkinson Task 0854795                       *
.*            Recompiled for EDWCLINT - corrected 06 object                *
.* V10.13.01  01/08/2018 Jill Parkinson Task 0861206                       *
.*            Added Client object header rows                              *
.* V10.12.56  01/08/2018 Jill Parkinson Task 0860951                       *
.*            Added URLENC00 to escape ' to allow md5sum to work           *
.* V10.12.55  25/07/2018 Jill Parkinson Task 0860951                       *
.*            Changed time in filename from t00x00x00 to hh'mm'ss          *
.* V10.12.54  16/07/2018 Ebon Clements  Task 0858128                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.12.53  06/07/2018 Jill Parkinson Task 0858752                       *
.*            Recompiled for EDWSERVS                                      *
.* V10.12.52  28/06/2018 Ebon Clements  Task 0858128                       *
.*            Recompiled for EDWNONAD                                      *
.* V10.12.51  28/06/2018 Ebon Clements  Task 0858054                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.12.50  25/06/2018 Ebon Clements  Task 0858128                      *
.*            Recompiled for EDWNONAD                                      *
.* V10.12.49  22/06/2018 Jill Parkinson Task 0854795                       *
.*            Recompiled for EDWCLINT                                      *
.* V10.12.48  22/06/2018 Ebon Clements  Task 0848318                       *
.*            Recompiled for EDWEMERG                                      *
.* V10.12.47  20/06/2018 Ebon Clements  Task 0848318                       *
.*            Recompiled for EDWINDSP - Practice address                   *
.* V10.12.46  20/06/2018 Ebon Clements  Task 0848318                       *
.*            Recompiled for EDWINDSP - Practice address                   *
.* V10.12.45  14/06/2018 Ebon Clements  Task 0848318                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.12.44  28/05/2018 Ebon Clements  Task 0848318                       *
.*            Recompiled for EDWINDSP                                      *
.* V10.12.43  23/05/2018 Jill Parkinson Task 0854795                       *
.*            Recompiled for EDWCLINT                                      *
.*            Added blank object records for each extract type             *
.* V10.12.42  17/05/2018 Thanh T.       TSK 0851528                        *
.*            Added TRANSREA for transfer reason                           *
.* V10.12.41  17/05/2018 Jill Parkinson TSK 0841670                        *
.*            Relisting date                                               *
.* V10.12.40  15/05/2018 Jill Parkinson TSK 0841670                        *
.*            Recompiled for EDWSERVS                                      *
.* V10.12.39  04/05/2018 Jill Parkinson TSK 0841670                        *
.*            Recompiled for EDWSERVS                                      *
.* V10.12.38  02/05/2018 Ebon Clements  Task 0848318                       *
.*            ISP extract Individual Provider Alternate Identifier fixes   *
.* V10.12.37  02/05/2018 Ebon Clements  Task 0846913                       *
.*            Non admitted rebound fixes                                   *
.* V10.12.36  01/05/2018 Ebon Clements  Task 0855317                       *
.*            Fixed emergency extract diagnosis delete records             *
.* V10.12.35  27/04/2018 Ebon Clements  Task 0848318 0855308               *
.*            Created ISP extract                                          *
.*            Fixed emergency service event location                       *
.* V10.12.34  26/04/2018 Jill Parkinson Task 0846170                       *
.*            Recompiled for WL rebounds 26_04_18                          *
.* V10.12.33  26/04/2018 Jill Parkinson Task 0848131                       *
.*            Recompiled for Admitted patient rebounds doc 3 and 4         *
.* V10.12.32  26/04/2018 Jill Parkinson Task 0846170                       *
.*            Recompiled for WL rebounds 200418 and 190418 documents       *
.* V10.12.31  23/04/2018 Jill Parkinson Task 0846170                       *
.*            Recompiled for WL rebounds 200418 and 190418 documents       *
.* V10.12.30  20/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non attended Client Service Event for attended OP      *
.* V10.12.29  19/04/2018 Jill Parkinson Task 0846170                       *
.*            Service scheduling beta rebounds docs 1 and 2                *
.* V10.12.28  19/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non admitted service event end time                    *
.*            18/04/2018 Jill Parkinson Task 0846170                       *
.*            Fixed 00 seconds on file names to be 01                      *
.* V10.12.27  18/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non admitted request received date                     *
.* V10.12.26  18/04/2018 Jill Parkinson Task 0848131                       *
.*            Beta admitted patient rebounds doc 1-3                       *
.* V10.12.25  18/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non admitted service activity sequence number          *
.* V10.12.24  18/04/2018 Jill Parkinson Task 0848131                       *
.*            Increased penscode from dim 1 to dim 2                       *
.*            18/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non admitted object 54 - EFFECTIVE_START_DATETIME      *
.* V10.12.23  17/04/2018 Ebon Clements  Task 0846913                       *
.*            Added DIM1B                                                  *
.* V10.12.22  16/04/2018 Jill Parkinson Task 0854975                       *
.*            Added write of userid to comedwaf                            *
.*            16/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non admitted service event date                        *
.* V10.12.21  16/04/2018 Ebon Clements  Task 0846913                       *
.*            Fixed non admitted service provide source id for organisation*
.* V10.12.20  16/04/2018 Ebon Clements  Task 0846913                       *
.*            Open OUTSESA6                                                *
.* V10.12.19  11/04/2018 Ebon Clements  Task 0854795                       *
.*            Added population of cmedwebc with user id                    *
.* V10.12.18  09/04/2018 Ebon Clements  Task 0855308                       *
.*            Fixed service event location reporting                       *
.* V10.12.17  09/04/2018 Ebon Clements  Task 0855317                       *
.*            Emergency extract - delete procedure/diagnosis               *
.* V10.12.16  06/04/2018 Ebon Clements  Task 0848319                       *
.*            Strip CMEWRTYP in OBJA0000                                   *
.* V10.12.15  05/04/2018 Jill Parkinson Task 0848319                       *
.*            Corrected start date in file names                           *
.*            04/04/2018 Ebon Clements  Task 0848319                       *
.*            Emergency extract                                            *
.* V10.12.13  29/03/2018 Jill Parkisnon Task 0848131                       *
.*            Admitted Patient Extract                                     *
.* V10.12.12  23/03/2018 Ebon Clements  Task 0848319                       *
.*            Emergency extract alterations                                *
.* V10.12.11  20/03/2018 Ebon Clements  Task 0848319                       *
.*            Emergency extract alterations                                *
.* V10.12.10  19/03/2018 Ebon Clements  Task 0848319                       *
.*            Emergency extract                                            *
.* V10.12.09  08/03/2018 Jill Parkisnon Task 0848131                       *
.*            Admitted patient extract                                     *
.* V10.12.08  06/03/2018 Jill Parkisnon Task 0846167                       *
.*            Client rebounds                                              *
.* V10.12.07  06/03/2018 Ebon Clements  Task 0846913                       *
.*            Non admitted extract                                         *
.* V10.12.06  06/03/2018 Ebon Clements  Task 0848319                       *
.*            Added emergency ambulance incident created date/time         *
.* V10.12.05  05/03/2018 Jill Parkinson Task 0841467                       *
.*            BETA test rebounds                                           *
.* V10.12.05  28/02/2018 Jill Parkinson Task 0841467                       *
.*            Corrected OBJATTR record                                     *
.* V10.12.04  26/02/2018 Ebon Clements  Task 0846913                       *
.*            Non admitted extract                                         *
.* V10.12.03  21/02/2018 Jill Parkinson Task 0861670                       *
.*            Added waiting list extract                                   *
.* V10.12.02  09/02/2018 Ebon Clements  Task 0848319                       *
.*            Emergency extract                                            *
.* V10.12.01  08/02/2018 Ebon Clements  Task 0848319                       *
.*            Emergency extract                                            *
.* V10.12.00  19/01/2018 Jill Parkinson Task 0846167                       *
.*            Created program                                              *
.***************************************************************************
.
          INC       STD001FD
.
. FILE DESCRIPTION INCLUDES
. -------------------------
          INC       ALLAUDFD/INC            * referral audit
          INC       ALLITMFD/INC            * AH Items
          INC       ALLLNKFD/INC            * Referral OP link
          INC       ALLCONFD/INC            * AH control file
          INC       ALLENCFD/INC            * AH contacts
          INC       ALLREFFD/INC            * referrals 
          INC       BOKRC1FD/INC            * booking   
          INC       BOKRX1FD/INC            * booking   
          INC       COMEDFFD/INC            * common edw container files
          INC       COMEDWFD/INC            * common edw container header file
          INC       COMEWDFD/INC            * common edw container detail file
          INC       EMRCHAFD/INC            * Emr change history
          INC       EMRCONFD/INC            * Emr control file
          INC       EMRDLAFD/INC            * Emr delete audit
          INC       EMRHISFD/INC            * Emr history
          INC       EMRICDFD/INC            * Emr diagnosis codes
          INC       EMRLOCFD/INC            * Emr locations
          INC       EMRSITFD/INC            * Emr site
          INC       EMRVCDFD/INC            * Emr diagnosis/Procedure
          INC       EMRVISFD/INC            * Emr visits
          INC       IBAPOSFD/INC            * Post codes
          INC       OPRDEAFD/INC            * Theatre
          INC       OUTSITFD/INC            * OP sites
          INC       OUTBITFD/INC            * OP booking items
          INC       OUTBOAFD/INC            * OP booking
          INC       OUTBB1FD/INC            * OP booking extn
          INC       OUTCLIFD/INC            * OP clinics
          INC       OUTCANFD/INC            * OP cancellations
          INC       OUTDIAFD/INC            * OP Diagnosis
          INC       OUTHEDFD/INC            * OP slot template header
          INC       OUTCTYFD/INC            * OP Clinic Types
          INC       OUTPREFD/INC            * OP Pre att
          INC       OUTRSHFD/INC            * OP reschedule
          INC       OUTSESFD/INC            * OP Sessions
          INC       PATCFAFD/INC            * Contract code
          INC       PATCHCFD/INC            * Patient care type
          INC       PATCODFD/INC            * Codes file
          INC       PATCONFD/INC            * Control file
          INC       PATCRDFD/INC            * Cancer file
          INC       PATDADFD/INC            * Patient transfer dest
          INC       PATDSCFD/INC            * Patient discharge
          INC       PMSPHSFD/INC            * Previous hospitalisation
          INC       PATECMFD/INC            * Coding changes
          INC       PATECDFD/INC            * Diagnosis        
          INC       PATECOFD/INC            * Procedures        
          INC       PATFN1FD/INC
          INC       PATFX1FD/INC
          INC       PATICDFD/INC            * ICD procedures
          INC       PATICOFD/INC            * ICD operations
          INC       PATICUFD/INC            * ICU
          INC       PATLINFD/INC            * Patient Link file
          INC       PATGSRFD/INC            * Patient surname file
          INC       PATHSPFD/INC            * Patient surname file
          INC       PATATRFD/INC
          INC       PATMA1FD/INC            * Patient master file
          INC       PATMI1FD/INC            * Patient admission
          INC       PATMRGFD/INC            * Merge file
          INC       PATPA1FD/INC            * Patient previous address
          INC       PATPGRFD/INC
          INC       PATURAFD/INC            * Patient UR alterations
          INC       PATTRNFD/INC            * Patient transfer
          INC       PATUNAFD/INC            * Patient unadmit/undischarge
          INC       PATVADFD/INC            * Transfer Source Code
          INC       PATVISFD/INC            * Visits
          INC       PATWBHFD/INC            * Ward bed history
          INC       PATWR1FD/INC            * Ward bed 
          INC       PMSADWFD/INC            * EDW Visit Alterations
          INC       PMSAIDFD/INC            * Alternate ID       
          INC       PMSBRQFD/INC            * Bed requests
          INC       PMSCCDFD/INC            * Concession cards
          INC       PMSCEXFD/INC            * Extra contacts
          INC       PMSDUNFD/INC            * Dr/Unit
          INC       PMSEDWFD/INC            * EDW alterations
          INC       PMSEDGFD/INC
          INC       PMSHCPFD/INC            * HCP
          INC       PMSHCLFD/INC            * HCP link
          INC       PMSHCGFD/INC            * HCP Practice
          INC       PMSIDWFD/INC
          INC       PMSPX2FD/INC            I PMI Extn 2
          INC       PMSRELFD/INC            * Relationship        
          INC       PMSUHLFD/INC            * Unique HERO Location
          INC       PMSVX1FD/INC            * Visit Extn
          INC       PMSWORFD/INC            * Working diagnosis
          INC       VISCMTFD/INC
          INC       PRIITMFD/INC
          INC       WATCATFD/INC
          INC       WATCHAFD/INC
          INC       WATPROFD/INC            * Waiting List
          INC       WATSUSFD/INC            * Waiting List
          INC       WATHISFD/INC            * Waiting List
          INC       WATTR1FD/INC            * Waiting List
          INC       WATTX1FD/INC            * Waiting List
          INC       WATCONFD/INC            * Waiting list control file
          INC       WEBSECFD/INC
.
. LOCAL VARIABLE DEFINITION
. -------------------------
.
ACCOMTYP  DIM       5
ADDRESFL  DIM       1
ADMNMODE  DIM       1
ALTTYPE   DIM       3
ARRVMODE  DIM       2
ATTRTYPE  DIM       3
ATTRVALU  DIM       100
BEDTYPE1  DIM       2
BEDTYPE2  DIM       1
BDATFLAG  FORM      1
BRSRCAT   DIM       2
BRSRCOD   DIM       3
CANBESTB  DIM       1
CANLATER  DIM       1
CARETYPA  DIM       1
CARETYPE  DIM       5
CCENTE    DIM       2
.
CHANGSTM  DIM       3
CHANGOBJ  DIM       3
CHANGKEY  DIM       90
CHANGPRM  DIM       90
CHANGCOL  FORM      2
CHANGOVL  DIM       8
CHANGNVL  DIM       50
CHANGTXT  DIM       900
CHANGAAA  DIM       900
.
CHECKSIT  DIM       6
CYEARE    DIM       2
CMONE     DIM       2
CDAYE     DIM       2
CCENTC    DIM       2
CYEARC    DIM       2
CMONC     DIM       2
CDAYC     DIM       2
CFILEPRE  DIM       3
CFPAYCOD  DIM       3        * 3M Codefinder PAY Code
CHECKMD5  FILE      ASCII, FIXED=127
CHKMD5FL  DIM       8
CHKSUM    DIM       100
CMDLINE   DIM       220
CODINGST  DIM       1
CONTSTRM  DIM       3
CONTNUMB  FORM      8
CONTTIME  DIM       8
COUNTER   FORM      8
CURDATE   DIM       8
CURTIME   DIM       8
CWEBDNAI  DIM       1
CWEBDNAM  DIM       2
DATEDIM4  DIM       4
DATEDIM6  DIM       6
DATFIELD  DIM       10
DDRGCODE  DIM       4
DMDCCODE  DIM       4
DRGVER    DIM       3
DRGSRCID  DIM       8
DRGRETCD  DIM       8
DELETSTM  DIM       3
DELETOBJ  DIM       3
DELETKEY  DIM       90
DELTFLAG  FORM      1
DETLKEPT  FORM      1
DHOUR     DIM       2
DIAGCNTR  FORM      2
DIAGSEQN  DIM       3
DIAGUNIQ  FORM      3
DIM1A     DIM       1
DIM1B     DIM       1
DIM1P     DIM       1
DIM2A     DIM       2
DIM2B     DIM       2
DIM2C     DIM       2
DIM2D     DIM       2
DIM2E     DIM       2
DIM3      DIM       3
DIM3A     DIM       3
DIM4      DIM       4
DIM5      DIM       5
DIM5A     DIM       5
DIM5B     DIM       5
DIM6      DIM       6
DIM6A     DIM       6
DIM6B     DIM       6
DIM6C     DIM       6
DIM7      DIM       7
DIM8      DIM       8
DIM8A     DIM       8
DIM8AA    DIM       8
DIM8B     DIM       8
DIM8BB    DIM       8
DIM8C     DIM       8
DIM8CC    DIM       8
DIM8E     DIM       8
DIM8G     DIM       8
DIM8H     DIM       8
DIM9      DIM       9
DIM10     DIM       10
DIM10A    DIM       10
DIM10B    DIM       10
DIM10C    DIM       10
DIM10D    DIM       10
DIM10E    DIM       10
DIM10F    DIM       10
DIM10G    DIM       10
DIM10H    DIM       10
DIM12     DIM       12
DIM13     DIM       13
DIM14     DIM       14
DIM14A    DIM       14
DIM15     DIM       15
DIM16     DIM       16
DIM17     DIM       17
DIM18     DIM       18
DIM19A    DIM       19
DIM19B    DIM       19
DIM19C    DIM       19
DIM19D    DIM       19
DIM19E    DIM       19
DIM20     DIM       20
DIM20A    DIM       20
DIM24     DIM       24
DIM24A    DIM       24
DIM30     DIM       30
DIM30A    DIM       30
DIM50     DIM       50
DIM100    DIM       100
DIM250    DIM       250
DIM300    DIM       300
DIM512    DIM       512
DISCMODE  DIM       2
DISINTEN  DIM       1
DISPNAME  DIM       60
DOCFNAME  DIM       100
DRGVERSN  DIM       5
EMPLOYMS  DIM       5
ENCTRNUM  DIM       8
ENDATRD   DIM       8
ENDDATE   DIM       8
ENDNAME   DIM       70
ENDDTIME  DIM       5
ESCTTIME  DIM       10
FMTTITLE  DIM       10
FMTGNAME  DIM       35
FMTSNAME  DIM       35
FOUNDFLG  FORM      1
FORMATDT  DIM       11
FIRSTENC  FORM      1
FILENAME  DIM       80
FILEENAM  DIM       80
HEADCOUN  DIM       3
HOUR      FORM      2
HOURD     DIM       2
HOURTM    DIM       2
IBCNMHOS  FORM      1
INTLOSCD  DIM       1
INSCLFLG  DIM       1
LASTDATE  DIM       8
LASTTIME  DIM       8
LASTDOCT  DIM       8
LASTDTIM  DIM       8
LEGLSTAT  DIM       1
LOOPCNTR  FORM      6
LVFRDATE  DIM       8
LVFRTIME  DIM       8
MAPPEDRL  DIM       3
MECHVENT  DIM       5
MINTIME   DIM       2
MINTIMEF  FORM      2
MOTHADMN  DIM       8
NAME35    DIM       35
NEWTDATE  DIM       8
NEWTTIME  DIM       8
NEWCODE   DIM       3
NEWADOC   DIM       6
NEWWARD   DIM       3
NEWBED    DIM       3
NEWBTYP   DIM       3
MIN       DIM       2
MINUTES   FORM      3
NOUPDATE  FORM      1
OBJECTKY  DIM       100
OBJECTRT  DIM       1
OBJECTTY  DIM       3
OBJECTTX  DIM       900
OBJTYPE   DIM       3
OLDTDATE  DIM       8
OLDTTIME  DIM       8
OLDADOC   DIM       6
OLDWARD   DIM       3
OLDBED    DIM       3
OLDBTYP   DIM       3
PENSCODE  DIM       2
PSETYPEC  DIM       1
PSESOURC  DIM       20
PLEVOFFR  DIM       19
PREVSPEC  DIM       2
PRIMTREA  DIM       10
PREVDATE  DIM       8
PREVTIME  DIM       8
PRIOTIMA  DIM       8
PRIOTIMB  DIM       8
PRIOTIMC  DIM       8
PRIOTIMD  DIM       8
PSYCYEAR  DIM       4
READMITC  DIM       1
RECCOUNT  FORM      8
REQUESTS  DIM       5
RERUNFL   DIM       1
REPORTED  FORM      1
REPTCNTR  FORM      3
REPTARRY  DIM       10[99]             
RESCFLAG  FORM      1
SAVADMN   DIM       8
SAVADOC   DIM       6
SAVWARD   DIM       3
SAVBED    DIM       3
SAVBTYP   DIM       3
SAVCHDAT  DIM       8
SAVCHTIM  DIM       8
SAVFNAM   DIM       80
SAVKEY8   DIM       8 
SAVKEY10  DIM       10
SAVKEY14  DIM       14
SAVKEY22  DIM       22
SAVKEY24  DIM       24
SAVKEY27  DIM       27
SAVKEY30  DIM       30
SAVKEY37  DIM       37
SAVKEY36  DIM       36
SAVKEY41  DIM       41
SAVKEY46  DIM       46
SAVMDATE  DIM       8
SAVMTIME  DIM       8
SVVKEY8   DIM       8
SVVKEY30  DIM       30
SAVOBJRT  DIM       1
SAVPSNAM  DIM       41            * surname
SAVPFGNM  DIM       41            * first given name
SAVPSGNM  DIM       41            * second given name
SAVCNTN   DIM       8
SDATFLAG  FORM      1             * Source created/modified flag
SEC       DIM       2
SENDALT   DIM       1
SRCRDATE  DIM       8
SRCRTIME  DIM       8
SRMDDATE  DIM       8
SRMDTIME  DIM       8
SECTIME   DIM       2
SEPRMODE  DIM       2
STRTDATE  DIM       8
STRTNAME  DIM       70
STRATRD   DIM       8
TESTDATE  DATE      8
TIMEDIM4  DIM       4
TIMEDIM6  DIM       6
TIM8A     DIM       8
THISDATE  DIM       8
THISTIME  DIM       8
TIME      FORM      3
TRANSOSP  DIM       20
TRANSTYP  DIM       1
UNPRETTH  DIM       1
URGENCYC  DIM       1
USERID    DIM       10
URNUMBER  DIM       8
VISITNUM  DIM       8
XDATTIME  DIM       14     * Date/Time (ccyymmddhhmmss)
WEIGHT    DIM       6
WLCOUNT   DIM       2
WLPROC    DIM       9
WLUNIQ    DIM       9
WTDATE    DIM       8
WTTIME    DIM       8
TRANSREA  DIM       5
STRNGINP  DIM       200      * Input string (with occurrences of "'")
STRNGOUT  DIM       600      * Output string (where "'" is replaced with "%60")
STRNGLEN  FORM      3        * String length
CURRCHAR  DIM       1
POSITION  FORM      3        * Current pos of character pointer
XSEC      DIM       2
.
APOSTRPH  INIT      "\'"
CATDD     INIT      "dd"
CATED     INIT      "ed"
CATEE     INIT      "ee"
CATEL     INIT      "el"
CATEM     INIT      "em"
CATEY     INIT      "ey"
CATEZ     INIT      "ez"
CATZN     INIT      "zN"
CATZI     INIT      "zI"
CATZK     INIT      "zK"
CATZL     INIT      "zL"
.
CATW1     INIT      "W1"
CATW2     INIT      "W2"
CATW3     INIT      "W3"
CATW4     INIT      "W4"
CATX5     INIT      "X5"
CATX6     INIT      "X6"
CATX7     INIT      "X7"
CATX8     INIT      "X8"
.
DASH      INIT      "-"
DOWNCASE  INIT      "AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
DTXT      INIT      ".txt"
CONTHEAD  INIT      "CONTHEAD"
OBJHEAD   INIT      "OBJHEAD"
OBJATTR   INIT      "OBJATTR"
COUNTRY   INIT      "1101"
CSV       INIT      ".csv"
DRG50     INIT      "14337"
DRG51     INIT      "14338"
DRG52     INIT      "14339"
DRG60     INIT      "14340"
DRG6X     INIT      "15526"
DRG70     INIT      "15527"
DRG80     INIT      "21378"
DRG90     INIT      "23227"
DRG100    INIT      "45456"
DRG110    INIT      "48349"
ANS035    INIT      "035"
CANCSID   INIT      "9475-001"
LOWC      INIT      "c"
LOWD      INIT      "d"
LOWT      INIT      "t"
LOWX      INIT      "x"
NIL       INIT      "NIL"
QUOTTILD  INIT       "#"~#""
SP900     INIT      "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             ":
                    "                                             "
TILDA     INIT      "~"
TIME001   INIT      "00:00:01"
TIME000   INIT      "00:00:00"
TIME059   INIT      "23:59:59"
TIME058   INIT      "23:58:00"
ZERO6     INIT      "000000"
.
.  *** common object header columns ***
COMCOL1   INIT      "RECORD_SOURCE_SYSTEM_CODE"
COMCOL2   INIT      "CONTAINER_SEQUENCE_NUMBER"
COMCOL3   INIT      "SOURCE_CREATE_DATETIME"
COMCOL4   INIT      "SOURCE_MODIFIED_DATETIME"
COMCOL5   INIT      "ACTION_TYPE"
.
.  *** object 01 header columns ***
OB001C06  INIT      "PRIMARY_CLIENT_ID_TYPE_CODE"
OB001C07  INIT      "PRIMARY_CLIENT_ID_ISSUING_AUTHORITY"
OB001C08  INIT      "PRIMARY_CLIENT_RECORD_ID"
OB001C09  INIT      "MAJOR_CLIENT_RECORD_START_DATETIME"
OB001C10  INIT      "MAJOR_CLIENT_RECORD_END_DATETIME"
OB001C11  INIT      "REPLACED_PRIMARY_CLIENT_ID_TYPE_CODE"
OB001C12  INIT      "REPLACED_PRIMARY_CLIENT_ID_ISSUING_AUTHORITY"
OB001C13  INIT      "REPLACED_PRIMARY_CLIENT_RECORD_ID"
.
.  *** object 02 header columns ***
OB002C09  INIT      "CLIENT_ADDRESS_RECORD_ID"
OB002C10  INIT      "ADDRESS_TYPE_CODE"
OB002C11  INIT      "ORIGINAL_ADDRESS"
OB002C12  INIT      "ORIGINAL_SUBURB_LOCALITY"
OB002C13  INIT      "ORIGINAL_POSTCODE"
OB002C14  INIT      "ORIGINAL_STATE_TERRITORY_ABBREV"
OB002C15  INIT      "ORIGINAL_LATITUDE"
OB002C16  INIT      "ORIGINAL_LONGITUDE"
OB002C17  INIT      "ORIGINAL_DELIVERY_POINT_ID"
OB002C18  INIT      "COUNTRY_OF_ADDRESS_CODE"
OB002C19  INIT      "ADDRESS_RESTRICTION_FLAG"
OB002C20  INIT      "EFFECTIVE_START_DATE"
OB002C21  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 03 header columns ***
OB003C09  INIT      "CLIENT_RELATIONSHIP_RECORD_ID"
OB003C10  INIT      "RELATED_PERSON_ROLE_TO_CLIENT_CODE"
OB003C11  INIT      "RELATED_PERSON_RELATIONSHIP_TO_CLIENT_CODE"
OB003C12  INIT      "RELATED_PERSON_FAMILY_NAME"
OB003C13  INIT      "RELATED_PERSON_GIVEN_NAME"
OB003C14  INIT      "RELATED_PERSON_DATE_OF_BIRTH"
OB003C15  INIT      "RELATED_PRIMARY_CLIENT_ID_TYPE_CODE"
OB003C16  INIT      "RELATED_PRIMARY_CLIENT_ID_ISSUING_AUTHORITY"
OB003C17  INIT      "RELATED_PRIMARY_CLIENT_RECORD_ID"
OB003C18  INIT      "RELATED_ISP_ID_TYPE_CODE"
OB003C19  INIT      "RELATED_ISP_SOURCE_ID"
OB003C20  INIT      "RELATED_ISP_ID"
OB003C21  INIT      "RELATIONSHIP_START_DATE"
OB003C22  INIT      "RELATIONSHIP_END_DATE"
.
.  *** object 04 header columns ***
OB004C09  INIT      "CLIENT_INSURANCE_RECORD_ID"
OB004C10  INIT      "INSURANCE_FUND_CODE"
OB004C11  INIT      "INSURANCE_TYPE_CODE"
OB004C12  INIT      "INSURANCE_FUND_MEMBER_ID"
OB004C13  INIT      "DVA_INSURANCE_COVER_CODE"
OB004C14  INIT      "EFFECTIVE_START_DATE"
OB004C15  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 05 header columns ***
OB005C09  INIT      "EXTERNAL_CLIENT_ID_RECORD_ID"
OB005C10  INIT      "EXTERNAL_CLIENT_ID_TYPE_CODE"
OB005C11  INIT      "EXTERNAL_CLIENT_ID_ISSUING_AUTHORITY"
OB005C12  INIT      "EXTERNAL_CLIENT_ID"
OB005C13  INIT      "EFFECTIVE_START_DATE"
OB005C14  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 06 header columns ***
OB006C09  INIT      "CLIENT_NAME_RECORD_ID"
OB006C10  INIT      "NAME_TYPE_CODE"
OB006C11  INIT      "FAMILY_NAME"
OB006C12  INIT      "GIVEN_NAME"
OB006C13  INIT      "MIDDLE_NAMES"
OB006C14  INIT      "NAME_TITLE"
OB006C15  INIT      "EFFECTIVE_START_DATE"
OB006C16  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 07 header columns ***
OB007C09  INIT      "ONGOING_CONDITIONS_RECORD_ID"
OB007C10  INIT      "ONGOING_CONDITIONS_REF_SOURCE_ID"
OB007C11  INIT      "ONGOING_CONDITIONS_REF_DOMAIN_ID"
OB007C12  INIT      "ONGOING_CONDITIONS_CODE"
OB007C13  INIT      "ONGOING_CONDITIONS_SOURCE_TYPE_CODE"
OB007C14  INIT      "CONFIRMED_DIAGNOSIS_FLAG"
OB007C15  INIT      "EFFECTIVE_START_DATE"
OB007C16  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 08 header columns ***
OB008C09  INIT      "SEX_CODE"
OB008C10  INIT      "DATE_OF_BIRTH"
OB008C11  INIT      "COUNTRY_OF_BIRTH_CODE"
OB008C12  INIT      "DATE_OF_BIRTH_ESTIMATION_FLAG"
OB008C13  INIT      "BIRTH_ORDER_CODE"
OB008C14  INIT      "BIRTH_PLURALITY_CODE"
OB008C15  INIT      "BIRTH_WEIGHT"
OB008C16  INIT      "DATE_OF_DEATH"
OB008C17  INIT      "DATE_OF_DEATH_ESTIMATION_FLAG"
OB008C18  INIT      "DECEASED_FLAG"
.
.  *** object 09 header columns ***
OB009C09  INIT      "CLIENT_ID_RECORD_ID"
OB009C10  INIT      "CLIENT_ID_TYPE_CODE"
OB009C11  INIT      "CLIENT_ID_ISSUING_AUTHORITY"
OB009C12  INIT      "CLIENT_ID"
OB009C13  INIT      "CLIENT_ID_MAJOR_FLAG"
OB009C14  INIT      "EFFECTIVE_START_DATETIME"
OB009C15  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 10 header columns ***
OB010C09  INIT      "CLIENT_PROFILE_RECORD_ID"
OB010C10  INIT      "CLIENT_ATTRIBUTE_TYPE_CODE"
OB010C11  INIT      "CLIENT_ATTRIBUTE_CODE"
OB010C12  INIT      "EFFECTIVE_START_DATE"
OB010C13  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 32 header columns ***
OB320C06  INIT      "ISP_ID_TYPE_CODE"
OB320C07  INIT      "ISP_SOURCE_ID"
OB320C08  INIT      "ISP_ID"
OB320C09  INIT      "SEX_CODE"
OB320C10  INIT      "COUNTRY_OF_BIRTH_CODE"
OB320C11  INIT      "DATE_OF_BIRTH"
OB320C12  INIT      "INDIGENOUS_STATUS_CODE"
OB320C13  INIT      "EFFECTIVE_START_DATE"
OB320C14  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 33 header columns ***
OB330C06  INIT      "ISP_ID_TYPE_CODE"
OB330C07  INIT      "ISP_SOURCE_ID"
OB330C08  INIT      "ISP_ID"
OB330C09  INIT      "ISP_DISC_SPEC_RECORD_ID"
OB330C10  INIT      "ISP_DISC_SPEC_CODE"
OB330C11  INIT      "PAEDIATRIC_SPECIALTY_FLAG"
OB330C12  INIT      "EFFECTIVE_START_DATE"
OB330C13  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 34 header columns ***
OB340C06  INIT      "ISP_ID_TYPE_CODE"
OB340C07  INIT      "ISP_SOURCE_ID"
OB340C08  INIT      "ISP_ID"
OB340C09  INIT      "ISP_SPEC_PRAC_RECORD_ID"
OB340C10  INIT      "ISP_DISC_SPEC_CODE"
OB340C11  INIT      "OSP_SOURCE_ID"
OB340C12  INIT      "OSP_ID"
OB340C13  INIT      "EFFECTIVE_START_DATE"
OB340C14  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 37 header columns ***
OB370C06  INIT      "ISP_ID_TYPE_CODE"
OB370C07  INIT      "ISP_SOURCE_ID"
OB370C08  INIT      "ISP_ID"
OB370C09  INIT      "ISP_ALT_ID_RECORD_ID"
OB370C10  INIT      "ISP_ALT_ID_TYPE_CODE"
OB370C11  INIT      "ISP_ALT_ID_ISSUING_AUTHORITY"
OB370C12  INIT      "ISP_ALT_ID"
OB370C13  INIT      "MEDICARE_SPECIALTY_CODE"
OB370C14  INIT      "EFFECTIVE_START_DATE"
OB370C15  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 38 header columns ***
OB380C06  INIT      "ISP_ID_TYPE_CODE"
OB380C07  INIT      "ISP_SOURCE_ID"
OB380C08  INIT      "ISP_ID"
OB380C09  INIT      "ISP_ADDRESS_RECORD_ID"
OB380C10  INIT      "ADDRESS_TYPE_CODE"
OB380C11  INIT      "ORIGINAL_ADDRESS"
OB380C12  INIT      "ORIGINAL_SUBURB_LOCALITY"
OB380C13  INIT      "ORIGINAL_POSTCODE"
OB380C14  INIT      "ORIGINAL_STATE_TERRITORY_ABBREV"
OB380C15  INIT      "ORIGINAL_LATITUDE"
OB380C16  INIT      "ORIGINAL_LONGITUDE"
OB380C17  INIT      "ORIGINAL_DELIVERY_POINT_ID"
OB380C18  INIT      "COUNTRY_OF_ADDRESS_CODE"
OB380C19  INIT      "ADDRESS_RESTRICTION_FLAG"
OB380C20  INIT      "EFFECTIVE_START_DATE"
OB380C21  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 40 header columns ***
OB400C06  INIT      "ISP_ID_TYPE_CODE"
OB400C07  INIT      "ISP_SOURCE_ID"
OB400C08  INIT      "ISP_ID"
OB400C09  INIT      "ISP_NAME_RECORD_ID"
OB400C10  INIT      "NAME_TYPE_CODE"
OB400C11  INIT      "FAMILY_NAME"
OB400C12  INIT      "GIVEN_NAME"
OB400C13  INIT      "MIDDLE_NAMES"
OB400C14  INIT      "NAME_TITLE"
OB400C15  INIT      "EFFECTIVE_START_DATE"
OB400C16  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 41 header columns ***
OB410C06  INIT      "ISP_ID_TYPE_CODE"
OB410C07  INIT      "ISP_SOURCE_ID"
OB410C08  INIT      "ISP_ID"
OB410C09  INIT      "ISP_ATTRIBUTE_RECORD_ID"
OB410C10  INIT      "ISP_ATTRIBUTE_TYPE_CODE"
OB410C11  INIT      "ISP_ATTRIBUTE_CODE"
OB410C12  INIT      "EFFECTIVE_START_DATE"
OB410C13  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 42 header columns ***
OB420C06  INIT      "ISP_ID_TYPE_CODE"
OB420C07  INIT      "ISP_SOURCE_ID"
OB420C08  INIT      "ISP_ID"
OB420C09  INIT      "ISP_TELECOM_RECORD_ID"
OB420C10  INIT      "ISP_TELECOM_MODE_CODE"
OB420C11  INIT      "ISP_TELECOM_CONTACT_USE_CODE"
OB420C12  INIT      "TELECOM_CONTACT_NOTES"
OB420C13  INIT      "TELECOM_NUMBER_ADDRESS_VALUE"
OB420C14  INIT      "TELECOM_RESTRICTION_FLAG"
OB420C15  INIT      "EFFECTIVE_START_DATE"
OB420C16  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 43 header columns ***
OB430C06  INIT      "ISP_ID_TYPE_CODE"
OB430C07  INIT      "ISP_SOURCE_ID"
OB430C08  INIT      "ISP_ID"
OB430C09  INIT      "ISP_OSP_RECORD_ID"
OB430C10  INIT      "OSP_SOURCE_ID"
OB430C11  INIT      "OSP_ID"
OB430C12  INIT      "EFFECTIVE_START_DATE"
OB430C13  INIT      "EFFECTIVE_END_DATE"
.
.  *** object 54 header columns ***
OB540C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB540C07  INIT      "SERVICE_ACTIVITY_SOURCE_ID"
OB540C08  INIT      "SERVICE_ACTIVITY_RECORD_ID"
OB540C09  INIT      "SERVICE_ACTIVITY_PROVIDER_RECORD_ID"
OB540C10  INIT      "SERVICE_PROVIDER_TYPE_CODE"
OB540C11  INIT      "SERVICE_PROVIDER_ID_TYPE_CODE"
OB540C12  INIT      "SERVICE_PROVIDER_SOURCE_ID"
OB540C13  INIT      "SERVICE_PROVIDER_ID"
OB540C14  INIT      "ISP_DISC_SPEC_CODE"
OB540C15  INIT      "EFFECTIVE_START_DATETIME"
OB540C16  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 55 header columns ***
OB550C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB550C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB550C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB550C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB550C10  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB550C11  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB550C12  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB550C13  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB550C14  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB550C15  INIT      "PLANNED_EVENT_OFFER_SOURCE_ID"
OB550C16  INIT      "PLANNED_EVENT_OFFER_RECORD_ID"
OB550C17  INIT      "SERVICE_CHAPTER_SOURCE_ID"
OB550C18  INIT      "SERVICE_CHAPTER_RECORD_ID"
OB550C19  INIT      "SERVICE_EVENT_START_DATETIME"
OB550C20  INIT      "SERVICE_EVENT_END_DATETIME"
OB550C21  INIT      "COLLABORATIVE_CARE_FLAG"
OB550C22  INIT      "CARE_TYPE_NHDD_CODE"
OB550C23  INIT      "PREV_SPEC_TREATMENT_CODE"
OB550C24  INIT      "YEAR_LAST_ADMIT_TO_PSYC"
OB550C25  INIT      "PRIMARY_TREATMENT_PURPOSE_CODE"
OB550C26  INIT      "WEIGHT_AT_SERVICE_EVENT_START_GRAMS"
OB550C27  INIT      "PRIMARY_PROGRAM_FUNDING_SOURCE_CODE"
OB550C28  INIT      "CLIENT_MODE_OF_ARRIVAL_CODE"
OB550C29  INIT      "CLIENT_ARRIVAL_DATETIME"
OB550C30  INIT      "CLIENT_DEPARTURE_DATETIME"
.
.  *** object 56 header columns ***
OB560C06  INIT      "SERVICE_ACTIVITY_SOURCE_ID"
OB560C07  INIT      "SERVICE_ACTIVITY_RECORD_ID"
OB560C08  INIT      "SERVICE_EVENT_TYPE_CODE"
OB560C09  INIT      "SERVICE_EVENT_SOURCE_ID"
OB560C10  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB560C11  INIT      "SERVICE_EVENT_RECORD_ID"
OB560C12  INIT      "SERVICE_ACTIVITY_SEQUENCE_NUMBER"
OB560C13  INIT      "SERVICE_ACTIVITY_REF_SOURCE_ID"
OB560C14  INIT      "SERVICE_ACTIVITY_REF_DOMAIN_ID"
OB560C15  INIT      "SERVICE_ACTIVITY_CODE"
OB560C16  INIT      "SERVICE_ACTIVITY_SOURCE_CODE"
OB560C17  INIT      "SERVICE_ACTIVITY_TYPE_CODE"
OB560C18  INIT      "SERVICE_ACTIVITY_COMMENTS"
OB560C19  INIT      "SERVICE_ACTIVITY_START_DATETIME"
OB560C20  INIT      "SERVICE_ACTIVITY_END_DATETIME"
.
.  *** object 56 non-admitted header columns ***
OB56NC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB56NC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB56NC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB56NC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB56NC10  INIT      "SERVICE_ACTIVITY_SOURCE_ID"
OB56NC11  INIT      "SERVICE_ACTIVITY_RECORD_ID"
OB56NC12  INIT      "SERVICE_ACTIVITY_SEQUENCE_NUMBER"
OB56NC13  INIT      "SERVICE_ACTIVITY_REF_SOURCE_ID"
OB56NC14  INIT      "SERVICE_ACTIVITY_REF_DOMAIN_ID"
OB56NC15  INIT      "SERVICE_ACTIVITY_CODE"
OB56NC16  INIT      "SERVICE_ACTIVITY_SOURCE_CODE"
OB56NC17  INIT      "SERVICE_ACTIVITY_TYPE_CODE"
OB56NC18  INIT      "SERVICE_ACTIVITY_COMMENTS"
OB56NC19  INIT      "SERVICE_ACTIVITY_DURATION"
OB56NC20  INIT      "SERVICE_ACTIVITY_START_DATETIME"
OB56NC21  INIT      "SERVICE_ACTIVITY_END_DATETIME"
.
.  *** object 56 admitted header columns ***
OB56AC06  INIT      "SERVICE_ACTIVITY_SOURCE_ID"
OB56AC07  INIT      "SERVICE_ACTIVITY_RECORD_ID"
OB56AC08  INIT      "SERVICE_EVENT_TYPE_CODE"
OB56AC09  INIT      "SERVICE_EVENT_SOURCE_ID"
OB56AC10  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB56AC11  INIT      "SERVICE_EVENT_RECORD_ID"
OB56AC12  INIT      "SERVICE_ACTIVITY_SEQUENCE_NUMBER"
OB56AC13  INIT      "SERVICE_ACTIVITY_REF_SOURCE_ID"
OB56AC14  INIT      "SERVICE_ACTIVITY_REF_DOMAIN_ID"
OB56AC15  INIT      "SERVICE_ACTIVITY_CODE"
OB56AC16  INIT      "SERVICE_ACTIVITY_SOURCE_CODE"
OB56AC17  INIT      "SERVICE_ACTIVITY_TYPE_CODE"
OB56AC18  INIT      "SERVICE_ACTIVITY_COMMENTS"
OB56AC19  INIT      "SERVICE_ACTIVITY_PROVIDER_INDICATOR"
OB56AC20  INIT      "SERVICE_ACTIVITY_START_DATETIME"
OB56AC21  INIT      "SERVICE_ACTIVITY_END_DATETIME"
.
.  *** object 57 header columns ***
OB570C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB570C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB570C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB570C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB570C10  INIT      "CLIENT_ID_TYPE_CODE"
OB570C11  INIT      "CLIENT_ID_ISSUING_AUTHORITY"
OB570C12  INIT      "CLIENT_ID"
.
.  *** object 57 non-admitted header columns ***
OB57NC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB57NC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB57NC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB57NC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB57NC10  INIT      "CLIENT_ID_TYPE_CODE"
OB57NC11  INIT      "CLIENT_ID_ISSUING_AUTHORITY"
OB57NC12  INIT      "CLIENT_ID"
.
.  *** object 58 non-admitted header columns ***
OB580C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB580C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB580C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB580C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB580C10  INIT      "APPOINTMENT_TYPE_LOCAL_CODE"
OB580C11  INIT      "INITIAL_OR_SUBSEQUENT_SERVICE_CODE"
OB580C12  INIT      "PRIMARY_SETTING_TYPE_CODE"
OB580C13  INIT      "SERVICE_CONTACT_MODE_CODE"
OB580C14  INIT      "DIRECT_CONTACT_TIME_BAND_CODE"
OB580C15  INIT      "INDIRECT_CONTACT_TIME_BAND_CODE"
OB580C16  INIT      "GROUP_SESSION_FLAG"
OB580C17  INIT      "GROUP_SESSION_ID"
OB580C18  INIT      "GROUP_LOCAL_ID"
OB580C19  INIT      "GROUP_REASON_CODE"
OB580C20  INIT      "GROUP_TARGET_POPULATION_CODE"
OB580C21  INIT      "GROUP_RECIPIENT_TYPE_CODE"
OB580C22  INIT      "CLIENT_PARTICIPATED_FLAG"
OB580C23  INIT      "NAP_SERVICE_TYPE_CODE"
OB580C24  INIT      "CLIENT_CALLED_DATETIME"
OB580C25  INIT      "CLIENT_SEEN_DATETIME"
OB580C26  INIT      "CHOC_EVENT_DISPOSITION_CODE"
.
.  *** object 59 header columns ***
OB590C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB590C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB590C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB590C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB590C10  INIT      "PRESENTING_ISSUE_RECORD_ID"
OB590C11  INIT      "PRESENTING_ISSUE_SOURCE_CODE"
OB590C12  INIT      "PRESENTING_ISSUE_SEQUENCE_NUMBER"
OB590C13  INIT      "PRESENTING_ISSUE_START_DATE"
OB590C14  INIT      "PRESENTING_ISSUE_REF_SOURCE_ID"
OB590C15  INIT      "PRESENTING_ISSUE_REF_DOMAIN_ID"
OB590C16  INIT      "PRESENTING_ISSUE_CODE"
OB590C17  INIT      "PRESENTING_ISSUE_COMMENTS"
.
.  *** object 59 non-admitted header columns ***
OB59NC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB59NC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB59NC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB59NC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB59NC10  INIT      "PRESENTING_ISSUE_RECORD_ID"
OB59NC11  INIT      "PRESENTING_ISSUE_SEQUENCE_NUMBER"
OB59NC12  INIT      "PRESENTING_ISSUE_START_DATE"
OB59NC13  INIT      "PRESENTING_ISSUE_REF_SOURCE_ID"
OB59NC14  INIT      "PRESENTING_ISSUE_REF_DOMAIN_ID"
OB59NC15  INIT      "PRESENTING_ISSUE_CODE"
OB59NC16  INIT      "PRESENTING_ISSUE_COMMENTS"
.
.  *** object 60 header columns ***
OB600C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB600C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB600C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB600C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB600C10  INIT      "SERVICE_EVENT_ATTRIBUTE_RECORD_ID"
OB600C11  INIT      "SERVICE_EVENT_ATTRIBUTE_TYPE_CODE"
OB600C12  INIT      "SERVICE_EVENT_ATTRIBUTE_LOCAL_CODE"
OB600C13  INIT      "SERVICE_EVENT_ATTRIBUTE_CODE"
OB600C14  INIT      "EFFECTIVE_START_DATETIME"
OB600C15  INIT      "EFFECTIVE_END_DATETIME"
.
OB60AC14  INIT      "EFFECTIVE_START_DATETIME"
OB60AC15  INIT      "EFFECTIVE_END_DATETIME"
.  *** object 61 header columns ***
OB610C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB610C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB610C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB610C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB610C10  INIT      "DIAGNOSIS_RECORD_ID"
OB610C11  INIT      "DIAGNOSIS_SOURCE_CODE"
OB610C12  INIT      "DIAGNOSIS_REF_SOURCE_ID"
OB610C13  INIT      "DIAGNOSIS_REF_DOMAIN_ID"
OB610C14  INIT      "DIAGNOSIS_CODE"
OB610C15  INIT      "DIAGNOSIS_SEQUENCE_NUMBER"
OB610C16  INIT      "DIAGNOSIS_CONFIRMATION_STATUS_CODE"
OB610C17  INIT      "DIAGNOSIS_TYPE_CODE"
OB610C18  INIT      "DIAGNOSIS_DATE"
OB610C19  INIT      "DIAGNOSIS_COMMENTS"
.
.  *** object 61 non-admitted header columns ***
OB61NC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB61NC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB61NC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB61NC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB61NC10  INIT      "DIAGNOSIS_RECORD_ID"
OB61NC11  INIT      "DIAGNOSIS_SEQUENCE_NUMBER"
OB61NC12  INIT      "DIAGNOSIS_CONFIRMATION_STATUS_CODE"
OB61NC13  INIT      "DIAGNOSIS_REF_SOURCE_ID"
OB61NC14  INIT      "DIAGNOSIS_REF_DOMAIN_ID"
OB61NC15  INIT      "DIAGNOSIS_CODE"
OB61NC16  INIT      "DIAGNOSIS_DATE"
OB61NC17  INIT      "CONDITION_ONSET_TYPE_CODE"
OB61NC18  INIT      "DIAGNOSIS_COMMENTS"
.
.  *** object 61 admitted header columns ***
OB61AC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB61AC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB61AC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB61AC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB61AC10  INIT      "DIAGNOSIS_SOURCE_CODE"
OB61AC11  INIT      "DIAGNOSIS_RECORD_ID"
OB61AC12  INIT      "DIAGNOSIS_REF_SOURCE_ID"
OB61AC13  INIT      "DIAGNOSIS_REF_DOMAIN_ID"
OB61AC14  INIT      "DIAGNOSIS_CODE"
OB61AC15  INIT      "DIAGNOSIS_SEQUENCE_NUMBER"
OB61AC16  INIT      "DIAGNOSIS_CONFIRMATION_STATUS_CODE"
OB61AC17  INIT      "DIAGNOSIS_DATE"
OB61AC18  INIT      "CONDITION_ONSET_TYPE_CODE"
OB61AC19  INIT      "DIAGNOSIS_COMMENTS"
.
.  *** object 63 ed header columns ***
OB630C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB630C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB630C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB630C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB630C10  INIT      "SERVICE_EVENT_PROVIDER_RECORD_ID"
OB630C11  INIT      "SERVICE_PROVIDER_TYPE_CODE"
OB630C12  INIT      "SERVICE_PROVIDER_ID_TYPE_CODE"
OB630C13  INIT      "SERVICE_PROVIDER_SOURCE_ID"
OB630C14  INIT      "SERVICE_PROVIDER_ID"
OB630C15  INIT      "ISP_DISC_SPEC_CODE"
OB630C16  INIT      "ISP_DISC_SPEC_LOCAL_CODE"
OB630C17  INIT      "OSP_LOCAL_ID"
OB630C18  INIT      "RESPONSIBLE_PROVIDER_FLAG"
OB630C19  INIT      "OSP_CREATED_SERVICE_EVENT_FLAG"
OB630C20  INIT      "EFFECTIVE_START_DATETIME"
OB630C21  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 63 non admitted header columns ***
OB63NC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB63NC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB63NC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB63NC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB63NC10  INIT      "SERVICE_EVENT_PROVIDER_RECORD_ID"
OB63NC11  INIT      "SERVICE_PROVIDER_TYPE_CODE"
OB63NC12  INIT      "SERVICE_PROVIDER_ID_TYPE_CODE"
OB63NC13  INIT      "SERVICE_PROVIDER_SOURCE_ID"
OB63NC14  INIT      "SERVICE_PROVIDER_ID"
OB63NC15  INIT      "ISP_DISC_SPEC_CODE"
OB63NC16  INIT      "OSP_LOCAL_ID"
OB63NC17  INIT      "OSP_CHOC_SESSION_LOCAL_ID"
OB63NC18  INIT      "RESPONSIBLE_PROVIDER_FLAG"
OB63NC19  INIT      "COLLABORATIVE_CARE_ROLE_CODE"
OB63NC20  INIT      "EFFECTIVE_START_DATETIME"
OB63NC21  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 63 admitted header columns ***
OB63AC06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB63AC07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB63AC08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB63AC09  INIT      "SERVICE_EVENT_RECORD_ID"
OB63AC10  INIT      "SERVICE_EVENT_PROVIDER_RECORD_ID"
OB63AC11  INIT      "SERVICE_PROVIDER_TYPE_CODE"
OB63AC12  INIT      "SERVICE_PROVIDER_ID_TYPE_CODE"
OB63AC13  INIT      "SERVICE_PROVIDER_SOURCE_ID"
OB63AC14  INIT      "SERVICE_PROVIDER_ID"
OB63AC15  INIT      "ISP_DISC_SPEC_CODE"
OB63AC16  INIT      "ISP_DISC_SPEC_LOCAL_CODE"
OB63AC17  INIT      "OSP_LOCAL_ID"
OB63AC18  INIT      "RESPONSIBLE_PROVIDER_FLAG"
OB63AC19  INIT      "COLLABORATIVE_CARE_ROLE_CODE"
OB63AC20  INIT      "EFFECTIVE_START_DATETIME"
OB63AC21  INIT      "EFFECTIVE_END_DATETIME"
OB63AC22  INIT      "OSP_CREATED_SERVICE_EVENT_FLAG"
.
.  *** object 64 header columns ***
OB640C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB640C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB640C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB640C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB640C10  INIT      "ONWARD_REFERRAL_RECORD_ID"
OB640C11  INIT      "REFERRAL_TARGET_TYPE_CODE"
OB640C12  INIT      "REFERRAL_TARGET_OSP_ID_TYPE_CODE"
OB640C13  INIT      "REFERRAL_TARGET_OSP_SOURCE_ID"
OB640C14  INIT      "REFERRAL_TARGET_OSP_ID"
OB640C15  INIT      "REFERRAL_TARGET_ISP_ID_TYPE_CODE"
OB640C16  INIT      "REFERRAL_TARGET_ISP_SOURCE_ID"
OB640C17  INIT      "REFERRAL_TARGET_ISP_ID"
OB640C18  INIT      "ONWARD_REFERRAL_ISSUED_DATETIME"
.
.  *** object 65 header columns ***
OB650C06  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB650C07  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB650C08  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB650C09  INIT      "CLIENT_ID_TYPE_CODE"
OB650C10  INIT      "CLIENT_ID_ISSUING_AUTHORITY"
OB650C11  INIT      "CLIENT_ID"
OB650C12  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB650C13  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB650C14  INIT      "WAIT_LIST_LISTING_DATE"
OB650C15  INIT      "WAIT_LIST_RELISTING_DATE"
OB650C16  INIT      "WAIT_LIST_INTENDED_LOS_CODE"
OB650C17  INIT      "WAIT_LIST_INTENDED_LOS_DAYS"
OB650C18  INIT      "POOLED_LIST_ID"
OB650C19  INIT      "POOLED_LIST_DISC_SPEC_CODE"
OB650C20  INIT      "WAIT_LIST_COLLABORATIVE_CARE_FLAG"
OB650C21  INIT      "WAIT_LIST_SHORT_NOTICE_FLAG"
OB650C22  INIT      "WAIT_LIST_REMOVAL_DATETIME"
OB650C23  INIT      "WAIT_LIST_REMOVAL_REASON_LOCAL_CODE"
OB650C24  INIT      "WAIT_LIST_REMOVAL_REASON_CODE"
.
.  *** object 66 header columns ***
OB660C06  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB660C07  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB660C08  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB660C09  INIT      "WAIT_LIST_ATTRIBUTE_RECORD_ID"
OB660C10  INIT      "WAIT_LIST_ATTRIBUTE_TYPE_CODE"
OB660C11  INIT      "WAIT_LIST_ATTRIBUTE_LOCAL_CODE"
OB660C12  INIT      "WAIT_LIST_ATTRIBUTE_CODE"
OB660C13  INIT      "EFFECTIVE_START_DATETIME"
OB660C14  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 67 header columns ***
OB670C06  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB670C07  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB670C08  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB670C09  INIT      "PLANNED_ACTIVITY_RECORD_ID"
OB670C10  INIT      "PLANNED_ACTIVITY_REF_SOURCE_ID"
OB670C11  INIT      "PLANNED_ACTIVITY_REF_DOMAIN_ID"
OB670C12  INIT      "PLANNED_ACTIVITY_CODE"
OB670C13  INIT      "PLANNED_PRIMARY_ACTIVITY_FLAG"
OB670C14  INIT      "PLANNED_ACTIVITY_COMMENTS"
.
.  *** object 68 header columns ***
OB680C06  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB680C07  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB680C08  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB680C09  INIT      "WAIT_LIST_PRIORITY_RECORD_ID"
OB680C10  INIT      "WAIT_LIST_CLINICAL_PRIORITY_LOCAL_CODE"
OB680C11  INIT      "WAIT_LIST_CLINICAL_PRIORITY_CODE"
OB680C12  INIT      "EFFECTIVE_START_DATETIME"
OB680C13  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 69 header columns ***
OB690C06  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB690C07  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB690C08  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB690C09  INIT      "WAIT_LIST_PROVIDER_RECORD_ID"
OB690C10  INIT      "SERVICE_PROVIDER_TYPE_CODE"
OB690C11  INIT      "SERVICE_PROVIDER_ID_TYPE_CODE"
OB690C12  INIT      "SERVICE_PROVIDER_SOURCE_ID"
OB690C13  INIT      "SERVICE_PROVIDER_ID"
OB690C14  INIT      "ISP_DISC_SPEC_CODE"
OB690C15  INIT      "WAIT_LIST_COLLABORATIVE_CARE_ROLE_CODE"
OB690C16  INIT      "EFFECTIVE_START_DATETIME"
OB690C17  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 70 header columns ***
OB700C06  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB700C07  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB700C08  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB700C09  INIT      "NRFC_RECORD_ID"
OB700C10  INIT      "NRFC_REASON_LOCAL_CODE"
OB700C11  INIT      "NRFC_REASON_CODE"
OB700C12  INIT      "NRFC_PERIOD_REVIEW_DATE"
OB700C13  INIT      "NRFC_COMMENTS"
OB700C14  INIT      "EFFECTIVE_START_DATETIME"
OB700C15  INIT      "EFFECTIVE_END_DATETIME"
.
.  *** object 72 header columns ***
OB720C06  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB720C07  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB720C08  INIT      "REQUEST_SERVICE_EVENT_TYPE_CODE"
OB720C09  INIT      "REQUEST_SOURCE_TYPE_CODE"
OB720C10  INIT      "REQUEST_CORRESPONDENCE_DATE"
OB720C11  INIT      "REQUEST_RECEIVED_DATE"
OB720C12  INIT      "REQUEST_EXPIRY_DATE"
OB720C13  INIT      "REQUEST_COMMENTS"
OB720C14  INIT      "REQUEST_ACCEPTANCE_DATE"
OB720C15  INIT      "REQUEST_REJECTION_DATE"
OB720C16  INIT      "CLIENT_ID_TYPE_CODE"
OB720C17  INIT      "CLIENT_ID_ISSUING_AUTHORITY"
OB720C18  INIT      "CLIENT_ID"
OB720C19  INIT      "REQUESTING_OSP_ID_TYPE_CODE"
OB720C20  INIT      "REQUESTING_OSP_SOURCE_ID"
OB720C21  INIT      "REQUESTING_OSP_ID"
OB720C22  INIT      "REQUESTING_ISP_ID_TYPE_CODE"
OB720C23  INIT      "REQUESTING_ISP_SOURCE_ID"
OB720C24  INIT      "REQUESTING_ISP_ID"
.
.  *** object 73 header columns ***
OB730C06  INIT      "PLANNED_SERVICE_EVENT_TYPE_CODE"
OB730C07  INIT      "PLANNED_EVENT_OFFER_SOURCE_ID"
OB730C08  INIT      "PLANNED_EVENT_OFFER_RECORD_ID"
OB730C09  INIT      "OFFER_ISSUED_DATETIME"
OB730C10  INIT      "OFFER_OUTCOME_LOCAL_CODE"
OB730C11  INIT      "OFFER_OUTCOME_CODE"
OB730C12  INIT      "OFFER_OUTCOME_DATETIME"
OB730C13  INIT      "PLANNED_SERVICE_EVENT_START_DATETIME"
OB730C14  INIT      "PLANNED_PRIMARY_INTERVENTION_DATETIME"
OB730C15  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB730C16  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB730C17  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB730C18  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB730C19  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
.
.  *** object 74 header columns ***
OB740C06  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB740C07  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB740C08  INIT      "REQUEST_FOR_SERVICE_PROVIDER_RECORD_ID"
OB740C09  INIT      "SERVICE_PROVIDER_TYPE_CODE"
OB740C10  INIT      "SERVICE_PROVIDER_ID_TYPE_CODE"
OB740C11  INIT      "SERVICE_PROVIDER_SOURCE_ID"
OB740C12  INIT      "SERVICE_PROVIDER_ID"
OB740C13  INIT      "ISP_DISC_SPEC_CODE"
.
.  *** object 112 header columns ***
OB112C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB112C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB112C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB112C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB112C10  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB112C11  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB112C12  INIT      "PLANNED_SERVICE_EVENT_TYPE_CODE"
OB112C13  INIT      "PLANNED_EVENT_OFFER_SOURCE_ID"
OB112C14  INIT      "PLANNED_EVENT_OFFER_RECORD_ID"
OB112C15  INIT      "SERVICE_EVENT_START_DATETIME"
OB112C16  INIT      "SERVICE_EVENT_END_DATETIME"
OB112C17  INIT      "COLLABORATIVE_CARE_FLAG"
OB112C18  INIT      "COLLABORATIVE_CARE_STATUS_CODE"
OB112C19  INIT      "CARE_TYPE_NHDD_CODE"
OB112C20  INIT      "PREV_SPEC_TREATMENT_CODE"
OB112C21  INIT      "YEAR_LAST_ADMIT_TO_PSYC"
OB112C22  INIT      "PRIMARY_TREATMENT_PURPOSE_CODE"
OB112C23  INIT      "CLINICAL_CODING_STATUS_CODE"
OB112C24  INIT      "WEIGHT_AT_SERVICE_EVENT_START_GRAMS"
OB112C25  INIT      "SERVICE_EVENT_ACCOMMODATION_TYPE_CODE"
OB112C26  INIT      "SERVICE_EVENT_START_EMPLOY_STATUS_CODE"
OB112C27  INIT      "SERVICE_EVENT_START_PENSION_STATUS_CODE"
OB112C28  INIT      "AMBULANCE_INCIDENT_ID"
OB112C29  INIT      "AMBULANCE_INCIDENT_CREATE_DATETIME"
OB112C30  INIT      "FORMAL_ADMIT_DATETIME"
OB112C31  INIT      "FORMAL_ADMIT_INTENDED_LOS_DAYS"
OB112C32  INIT      "FORMAL_ADMIT_INTENDED_LOS_CODE"
OB112C33  INIT      "SERVICE_EVENT_SERVICE_CATEGORY_CODE"
OB112C34  INIT      "SERVICE_ENCOUNTER_INSUR_CLAIM_FLAG"
OB112C35  INIT      "SERVICE_ENCOUNTER_NO_INSUR_CLAIM_REASON_CODE"
OB112C36  INIT      "FORMAL_ADMIT_URGENCY_CODE"
OB112C37  INIT      "FORMAL_READMIT_STATUS_CODE"
OB112C38  INIT      "FORMAL_ADMIT_EXPECTED_DISCHARGE_DATE"
OB112C39  INIT      "SERVICE_EVENT_UNPLANNED_RETURN_THEATRE_FLAG"
OB112C40  INIT      "SERVICE_ENCOUNTER_LAST_EXPECTED_DISCHARGE_DATE"
OB112C41  INIT      "FORMAL_DISCHARGE_DATETIME"
OB112C42  INIT      "FORMAL_DISCHARGE_INTENT_TO_READMIT_FLAG"
OB112C43  INIT      "FORMAL_DISCHARGE_MODE_CODE"
OB112C44  INIT      "SERVICE_EVENT_MH_LEGAL_STATUS_NHDD_CODE"
OB112C45  INIT      "SERVICE_EVENT_TOTAL_MECH_VENT_HOURS"
OB112C46  INIT      "AR_DRG_CODE"
OB112C47  INIT      "AR_DRG_REF_DOMAIN_ID"
OB112C48  INIT      "AR_DRG_REF_SOURCE_ID"
OB112C49  INIT      "AR_DRG_MDC_CODE"
OB112C50  INIT      "AR_DRG_PCCL_CODE"
OB112C51  INIT      "AR_DRG_RETURN_CODE"
OB112C52  INIT      "WAIT_LIST_SERVICE_EVENT_TYPE_CODE"
OB112C53  INIT      "WAIT_LIST_BOOKING_SOURCE_ID"
OB112C54  INIT      "WAIT_LIST_BOOKING_RECORD_ID"
OB112C55  INIT      "PRIMARY_PROGRAM_FUNDING_SOURCE_CODE"
OB112C56  INIT      "SERVICE_EVENT_ALT_ENCOUNTER_ID"
OB112C57  INIT      "SERVICE_EVENT_MODEL_OF_CARE_CODE"
OB112C58  INIT      "CLIENT_MODE_OF_ARRIVAL_CODE"
OB112C59  INIT      "SERVICE_EVENT_ADMISSION_MODE_NHDD_CODE"
OB112C60  INIT      "SERVICE_EVENT_SEPARATION_MODE_NHDD_CODE"
OB112C61  INIT      "SERVICE_EVENT_REQUEST_SOURCE_TYPE_CODE"
.
.  *** object 114 header columns ***
OB114C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB114C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB114C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB114C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB114C10  INIT      "SERVICE_EVENT_CANCER_RECORD_ID"
OB114C11  INIT      "DIAGNOSIS_RECORD_ID"
OB114C12  INIT      "CANCER_MORPH_REF_SOURCE_ID"
OB114C13  INIT      "CANCER_MORPH_REF_DOMAIN_ID"
OB114C14  INIT      "CANCER_MORPH_CODE"
OB114C15  INIT      "CANCER_TOPO_REF_SOURCE_ID"
OB114C16  INIT      "CANCER_TOPO_REF_DOMAIN_ID"
OB114C17  INIT      "CANCER_TOPO_CODE"
OB114C18  INIT      "CANCER_FIRST_DIAG_DATE"
OB114C19  INIT      "CANCER_LATERALITY_CODE"
OB114C20  INIT      "CANCER_DIAG_BEST_BASIS_CODE"
OB114C21  INIT      "CANCER_FIRST_DIAG_STATE_RES_CODE"
OB114C22  INIT      "CANCER_DEGREE_OF_SPREAD_CODE"
OB114C23  INIT      "CANCER_WITH_MULTIPLE_PRIMARY_SITES_FLAG"
OB114C24  INIT      "CANCER_PATH_LAB_OSP_ID_TYPE_CODE"
OB114C25  INIT      "CANCER_PATH_LAB_OSP_SOURCE_ID"
OB114C26  INIT      "CANCER_PATH_LAB_OSP_ID"
OB114C27  INIT      "CANCER_STAGE_SCHEME_CODE"
OB114C28  INIT      "CANCER_STAGE_CODE"
OB114C29  INIT      "CANCER_T_STAGE_SCORE"
OB114C30  INIT      "CANCER_N_STAGE_SCORE"
OB114C31  INIT      "CANCER_M_STAGE_SCORE"
OB114C32  INIT      "CANCER_INT_TREATMENT_MODE_CODE"
OB114C33  INIT      "CANCER_INT_RADIOTHERAPY_EVIQ_ID"
OB114C34  INIT      "CANCER_INT_SYS_THERAPY_EVIQ_ID"
OB114C35  INIT      "CANCER_INCID_FIND_AT_PM_FLAG"
OB114C36  INIT      "SERVICE_EVENT_GP_RECORD_ID"
.
.  *** object 115 header columns ***
OB115C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB115C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB115C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB115C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB115C10  INIT      "SERVICE_EVENT_GP_RECORD_ID"
OB115C11  INIT      "GP_ISP_ID_TYPE_CODE"
OB115C12  INIT      "GP_ISP_SOURCE_ID"
OB115C13  INIT      "GP_ISP_ID"
OB115C14  INIT      "GP_FULL_NAME"
OB115C15  INIT      "GP_PRACTICE_OSP_ID_TYPE_CODE"
OB115C16  INIT      "GP_PRACTICE_OSP_SOURCE_ID"
OB115C17  INIT      "GP_PRACTICE_OSP_ID"
OB115C18  INIT      "GP_PRACTICE_ADDRESS"
OB115C19  INIT      "GP_PRACTICE_SUBURB_LOCALITY"
OB115C20  INIT      "GP_PRACTICE_POSTCODE"
OB115C21  INIT      "GP_PRACTICE_STATE_TERRITORY_ABBREV"
OB115C22  INIT      "GP_PRACTICE_COUNTRY_OF_ADDRESS_CODE"
OB115C23  INIT      "GP_PRACTICE_FAX_NUMBER"
OB115C24  INIT      "GP_PRACTICE_PHONE_NUMBER"
.
.  *** object 130 header columns ***
OB130C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB130C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB130C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB130C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB130C10  INIT      "SERVICE_EVENT_TRANSFER_TYPE_CODE"
OB130C11  INIT      "SERVICE_EVENT_TRANSFER_REASON_CODE"
OB130C12  INIT      "SERVICE_EVENT_TRANSFER_OSP_ID_TYPE_CODE"
OB130C13  INIT      "SERVICE_EVENT_TRANSFER_OSP_SOURCE_ID"
OB130C14  INIT      "SERVICE_EVENT_TRANSFER_OSP_ID"
.
.  *** object 131 header columns ***
OB131C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB131C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB131C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB131C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB131C10  INIT      "SERVICE_EVENT_RELATIONSHIP_RECORD_ID"
OB131C11  INIT      "SERVICE_EVENT_RELATIONSHIP_TYPE_CODE"
OB131C12  INIT      "RELATED_SERVICE_EVENT_TYPE_CODE"
OB131C13  INIT      "RELATED_SERVICE_EVENT_SOURCE_ID"
OB131C14  INIT      "RELATED_SERVICE_ENCOUNTER_RECORD_ID"
OB131C15  INIT      "RELATED_SERVICE_EVENT_RECORD_ID"
.
.  *** object 133 header columns ***
OB133C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB133C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB133C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB133C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB133C10  INIT      "SERVICE_EVENT_LEAVE_RECORD_ID"
OB133C11  INIT      "SERVICE_EVENT_LEAVE_TYPE_CODE"
OB133C12  INIT      "SERVICE_EVENT_LEAVE_TYPE_LOCAL_CODE"
OB133C13  INIT      "SERVICE_EVENT_LEAVE_REASON_CODE"
OB133C14  INIT      "SERVICE_EVENT_LEAVE_REASON_LOCAL_CODE"
OB133C15  INIT      "SERVICE_EVENT_LEAVE_START_DATETIME"
OB133C16  INIT      "SERVICE_EVENT_LEAVE_END_DATETIME"
.
.  *** object 134 header columns ***
OB134C06  INIT      "HEALTH_SERVICE_LOCATION_SOURCE_ID"
OB134C07  INIT      "HEALTH_SERVICE_CAMPUS_LOCAL_ID"
OB134C08  INIT      "HEALTH_SERVICE_WARD_LOCAL_ID"
OB134C09  INIT      "SERVICE_LOCATION_SOURCE_ID"
OB134C10  INIT      "HEALTH_SERVICE_WARD_LOCATION_ID"
OB134C11  INIT      "HEALTH_SERVICE_CAMPUS_LOCATION_ID"
OB134C12  INIT      "HEALTH_SERVICE_BUILDING_LOCATION_ID"
OB134C13  INIT      "HEALTH_SERVICE_WARD_NAME"
OB134C14  INIT      "HEALTH_SERVICE_WARD_TYPE_CODE"
OB134C15  INIT      "HEALTH_SERVICE_WARD_FIRST_OPEN_DATETIME"
OB134C16  INIT      "HEALTH_SERVICE_WARD_PERMANENT_CLOSURE_DATETIME"
OB134C17  INIT      "HEALTH_SERVICE_WARD_PRIMARY_BED_TYPE_CODE"
OB134C18  INIT      "HEALTH_SERVICE_WARD_IS_VIRTUAL_FLAG"
OB134C19  INIT      "HEALTH_SERVICE_WARD_ADMIN_OSP_ID_TYPE_CODE"
OB134C20  INIT      "HEALTH_SERVICE_WARD_ADMIN_OSP_SOURCE_ID"
OB134C21  INIT      "HEALTH_SERVICE_WARD_ADMIN_OSP_ID"
.
.  *** object 135 header columns ***
OB135C06  INIT      "HEALTH_SERVICE_LOCATION_SOURCE_ID"
OB135C07  INIT      "HEALTH_SERVICE_CAMPUS_LOCAL_ID"
OB135C08  INIT      "HEALTH_SERVICE_WARD_LOCAL_ID"
OB135C09  INIT      "HEALTH_SERVICE_BED_LOCAL_ID"
OB135C10  INIT      "HEALTH_SERVICE_ROOM_LOCAL_ID"
OB135C11  INIT      "HEALTH_SERVICE_BED_DESC"
OB135C12  INIT      "HEALTH_SERVICE_BED_FIRST_OPEN_DATETIME"
OB135C13  INIT      "HEALTH_SERVICE_BED_PERMANENT_CLOSURE_DATETIME"
.
.  *** object 136 header columns ***
OB136C06  INIT      "HEALTH_SERVICE_LOCATION_SOURCE_ID"
OB136C07  INIT      "HEALTH_SERVICE_CAMPUS_LOCAL_ID"
OB136C08  INIT      "HEALTH_SERVICE_WARD_LOCAL_ID"
OB136C09  INIT      "HEALTH_SERVICE_BED_LOCAL_ID"
OB136C10  INIT      "HEALTH_SERVICE_BED_ATTRIBUTE_RECORD_ID"
OB136C11  INIT      "HEALTH_SERVICE_BED_ATTRIBUTE_START_DATETIME"
OB136C12  INIT      "HEALTH_SERVICE_BED_ATTRIBUTE_END_DATETIME"
OB136C13  INIT      "HEALTH_SERVICE_BED_ATTRIBUTE_TYPE_CODE"
OB136C14  INIT      "HEALTH_SERVICE_BED_ATTRIBUTE_CODE"
.
.  *** object 137 header columns ***
OB137C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB137C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB137C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB137C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB137C10  INIT      "SERVICE_EVENT_DELAY_RECORD_ID"
OB137C11  INIT      "SERVICE_EVENT_DELAY_TYPE_CODE"
OB137C12  INIT      "SERVICE_EVENT_DELAY_REASON_CODE"
OB137C13  INIT      "SERVICE_EVENT_DELAY_COMMENTS"
.
.  *** object 141 header columns ***
OB141C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB141C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB141C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB141C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB141C10  INIT      "SERVICE_EVENT_SUB_EVENT_RECORD_ID"
OB141C11  INIT      "SERVICE_EVENT_SUB_EVENT_TYPE_CODE"
OB141C12  INIT      "SERVICE_EVENT_SUB_EVENT_TYPE_LOCAL_CODE"
OB141C13  INIT      "SERVICE_EVENT_SUB_EVENT_STATUS_CODE"
OB141C14  INIT      "SERVICE_EVENT_SUB_EVENT_ISP_ID_TYPE_CODE"
OB141C15  INIT      "SERVICE_EVENT_SUB_EVENT_ISP_SOURCE_ID"
OB141C16  INIT      "SERVICE_EVENT_SUB_EVENT_ISP_ID"
OB141C17  INIT      "SERVICE_EVENT_SUB_EVENT_EFFECTIVE_DATETIME"
.
.  *** object 142 header columns ***
OB142C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB142C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB142C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB142C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB142C10  INIT      "SERVICE_EVENT_LOCATION_RECORD_ID"
OB142C11  INIT      "HEALTH_SERVICE_LOCATION_SOURCE_ID"
OB142C12  INIT      "HEALTH_SERVICE_CAMPUS_LOCAL_ID"
OB142C13  INIT      "HEALTH_SERVICE_LOCATION_LOCAL_ID"
OB142C14  INIT      "SERVICE_EVENT_LOCATION_START_DATETIME"
OB142C15  INIT      "SERVICE_EVENT_LOCATION_END_DATETIME"
.
.  *** object 142 admitted header columns ***
OB142A06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB142A07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB142A08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB142A09  INIT      "SERVICE_EVENT_RECORD_ID"
OB142A10  INIT      "SERVICE_EVENT_LOCATION_RECORD_ID"
OB142A11  INIT      "HEALTH_SERVICE_LOCATION_SOURCE_ID"
OB142A12  INIT      "HEALTH_SERVICE_CAMPUS_LOCAL_ID"
OB142A13  INIT      "HEALTH_SERVICE_WARD_LOCAL_ID"
OB142A14  INIT      "HEALTH_SERVICE_BED_LOCAL_ID"
OB142A15  INIT      "HEALTH_SERVICE_LOCATION_TRANSFER_REASON_CODE"
OB142A16  INIT      "SERVICE_EVENT_LOCATION_START_DATETIME"
OB142A17  INIT      "SERVICE_EVENT_LOCATION_END_DATETIME"
OB142A18  INIT      "HEALTH_SERVICE_BED_TYPE_CODE"
OB142A19  INIT      "HEALTH_SERVICE_MH_SUB_PROGRAM_CODE"
.

.  *** object 143 header columns ***
OB143C06  INIT      "HEALTH_SERVICE_LOCATION_SOURCE_ID"
OB143C07  INIT      "HEALTH_SERVICE_CAMPUS_LOCAL_ID"
OB143C08  INIT      "HEALTH_SERVICE_LOCATION_LOCAL_ID"
OB143C09  INIT      "HEALTH_SERVICE_BUILDING_LOCATION_LOCAL_ID"
OB143C10  INIT      "SERVICE_LOCATION_SOURCE_ID"
OB143C11  INIT      "HEALTH_SERVICE_CAMPUS_LOCATION_ID"
OB143C12  INIT      "HEALTH_SERVICE_BUILDING_LOCATION_ID"
OB143C13  INIT      "HEALTH_SERVICE_LOCATION_ID"
OB143C14  INIT      "HEALTH_SERVICE_LOCATION_TYPE_CODE"
OB143C15  INIT      "HEALTH_SERVICE_LOCATION_DESC"
OB143C16  INIT      "HEALTH_SERVICE_LOCATION_FIRST_OPEN_DATE"
OB143C17  INIT      "HEALTH_SERVICE_LOCATION_PERMANENT_CLOSURE_DATE"
.
.  *** object 145 header columns ***
OB145C06  INIT      "SERVICE_EVENT_TYPE_CODE"
OB145C07  INIT      "SERVICE_EVENT_SOURCE_ID"
OB145C08  INIT      "SERVICE_ENCOUNTER_RECORD_ID"
OB145C09  INIT      "SERVICE_EVENT_RECORD_ID"
OB145C10  INIT      "SERVICE_EVENT_ALT_ENCOUNTER_ID"
OB145C11  INIT      "SERVICE_EVENT_START_DATETIME"
OB145C12  INIT      "SERVICE_EVENT_END_DATETIME"
OB145C13  INIT      "SERVICE_EVENT_MODEL_OF_CARE_CODE"
OB145C14  INIT      "CLIENT_MODE_OF_ARRIVAL_CODE"
OB145C15  INIT      "CLIENT_ARRIVAL_DATETIME"
OB145C16  INIT      "CLIENT_DEPARTURE_DATETIME"
OB145C17  INIT      "AMBULANCE_INCIDENT_ID"
OB145C18  INIT      "AMBULANCE_INCIDENT_CREATE_DATETIME"
OB145C19  INIT      "SERVICE_EVENT_START_EMPLOY_STATUS_CODE"
OB145C20  INIT      "REQUEST_FOR_SERVICE_SOURCE_ID"
OB145C21  INIT      "REQUEST_FOR_SERVICE_RECORD_ID"
OB145C22  INIT      "ED_TRIAGE_CODE"
OB145C23  INIT      "ED_VISIT_TYPE_CODE"
OB145C24  INIT      "ED_TRIAGE_COMMENTS"
OB145C25  INIT      "ED_SEPARATION_MODE_CODE"
OB145C26  INIT      "ED_DEPARTURE_DESTINATION_CODE"
OB145C27  INIT      "ED_EXTERNAL_CAUSE_INTENT_CODE"
OB145C28  INIT      "ED_ALCOHOL_ILLICIT_DRUG_RELATED_CODE"
OB145C29  INIT      "ED_MENTAL_HEALTH_RELATED_CODE"
OB145C30  INIT      "SERVICE_EVENT_REQUEST_SOURCE_TYPE_CODE"
.
OBJFILE   FILE      ASCII, FIXED=1000
HEADFILE  FILE      ASCII, FIXED=1000
.  
PRGID     INIT      "IBAPMS40"
PRGNAM    INIT      "NSW EDWARD Extract "
VERSION   INIT      "V12.00.07"
+
.**************************************************************************
.*                              ML0000                                    *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
ML0000    CALL      INIT0000               * initialisation and open files
.
ML0100    CALL      OPTN0000               * select options
          BRANCH    EXIT,ML9999            * EXIT = 1 if 0 chosen in menu
          BRANCH    COPTION,ML0500,ML0500,ML0500,ML0500,ML0500,ML0500
.                              * proceed with clean up
          GOTO      ML9999
.
ML0500    CALL      VDAT0000               * get and validate date range
          BRANCH    EXIT,ML9999
          BRANCH    COPTION,ML1000,ML1000,ML1000,ML1000,ML1000,ML1000
.                              * proceed with clean up
          GOTO      ML9999
.
ML1000    KEYIN     *P1:15,*EF,*P1:15,"WEB User ID          : ",*V2LON,USERID
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,ML9999

          CALL      CONTQST                * Ok to continue ?
          BRANCH    CEXIT,ML2000:          * yes
                          ML0100:          * no
                          ML0100           * cancel
.
ML2000    CALL      WRTC0000               * write container record
          CALL      PROC0000               * process data for container
.
ML9999    CHAIN     PGM                    * chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: ML0000    *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
.
INIT0000  CALL      DISPHEAD                  * display heading
.
          MOVE      SP70,SAVFNAM
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P56:24,"Opening allitmaf";
          OPEN      ALLITMA1,"allitmaf"
.
          DISPLAY   *P56:24,"Opening allaudaf";
          OPEN      ALLAUDA3,"allaudaf"
.
          DISPLAY   *P56:24,"Opening alllnkaf";
          OPEN      ALLLNKA1,"alllnkaf"
          OPEN      ALLLNKA2,"alllnkaf"
.
          DISPLAY   *P56:24,"Opening allencaf";
          OPEN      ALLENCA1,"allencaf"
          OPEN      ALLENCA7,"allencaf"
.
          DISPLAY   *P56:24,"Opening allrefaf";
          OPEN      ALLREFA1,"allrefaf"
.
          DISPLAY   *P56:24,"Opening bokrc1af";
          OPEN      BOKRC1A1,"bokrc1af"
.
          DISPLAY   *P56:24,"Opening bokrx1af";
          OPEN      BOKRX1A1,"bokrx1af"
.
          DISPLAY   *P56:24,"Opening comedwaf";
          OPEN      COMEDWA1,"comedwaf"
          OPEN      COMEDWA2,"comedwaf"
.
          DISPLAY   *P56:24,"Opening comewdaf";
          OPEN      COMEWDA1,"comewdaf"
          OPEN      COMEWDA2,"comewdaf"
.
          DISPLAY   *P56:24,"Opening comedfaf";
          OPEN      COMEDFA1,"comedfaf"
.
          DISPLAY   *P56:24,"Opening emrchaaf";
          OPEN      EMRCHAA1,"emrchaaf"
          OPEN      EMRCHAA2,"emrchaaf"
.
          DISPLAY   *P56:24,"Opening emrdlaaf";
          OPEN      EMRDLAA2,"emrdlaaf"
.
          DISPLAY   *P56:24,"Opening emrsitaf";
          OPEN      EMRSITA1,"emrsitaf"
.
          DISPLAY   *P56:24,"Opening emrvcdaf";
          OPEN      EMRVCDA1,"emrvcdaf"
.
          DISPLAY   *P56:24,"Opening emricdaf";
          OPEN      EMRICDA1,"emricdaf"
.
          DISPLAY   *P56:24,"Opening emrvisaf";
          OPEN      EMRVISA1,"emrvisaf"
          OPEN      EMRVISA3,"emrvisaf"
.
          DISPLAY   *P56:24,"Opening emrhisaf";
          OPEN      EMRHISA1,"emrhisaf"
          OPEN      EMRAUDH2,"emraudhi"
.
          DISPLAY   *P56:24,"Opening emrlocaf";
          OPEN      EMRLOCA1,"emrlocaf"
.
          DISPLAY   *P56:24,"Opening ibapostf";
          OPEN      IBAPOST1,"ibapostf"
.
          DISPLAY   *P56:24,"Opening oprdetaf";
          OPEN      OPRDETA2,"oprdetaf"
.
          DISPLAY   *P56:24,"Opening patatraf";
          OPEN      PATATRA3,"patatraf"
          OPEN      PATATRA4,"patatraf"
.
          DISPLAY   *P56:24,"Opening patcodes";
          OPEN      PATCODE1,"patcodes"
          OPEN      PATCODE2,"patcodes"
.
          DISPLAY   *P56:24,"Opening patcrdaf";
          OPEN      PATCRDA3,"patcrdaf"
          OPEN      PATCRDA4,"patcrdaf"
.
          DISPLAY   *P56:24,"Opening patdadaf";
          OPEN      PATDADA1,"patdadaf"
.
          DISPLAY   *P56:24,"Opening patecmaf";
          OPEN      PATECMA2,"patecmaf"
.
          DISPLAY   *P56:24,"Opening patecdaf";
          OPEN      PATECDA1,"patecdaf"
.
          DISPLAY   *P56:24,"Opening patecoaf";
          OPEN      PATECOA1,"patecoaf"
.
          DISPLAY   *P56:24,"Opening paticuaf";
          OPEN      PATICUA1,"paticuaf"
.
          DISPLAY   *P56:24,"Opening patdscaf";
          OPEN      PATDSCH1,"patdschf"
          OPEN      PATDSCH3,"patdschf"
.
          DISPLAY   *P56:24,"Opening pmsphsaf";
          OPEN      PMSPHSA1,"pmsphsaf"
.
          DISPLAY   *P56:24,"Opening patpa1af";
          OPEN      PATPA1A1,"patpa1af"
          OPEN      PATPA1A2,"patpa1af"
.
          DISPLAY   *P56:24,"Opening patlinkf";
          OPEN      PATLINK1,"patlinkf"
          OPEN      PATLINK2,"patlinkf"
.
          DISPLAY   *P56:24,"Opening patgsrnf";
          OPEN      PATGSRN1,"patgsrnf"
.
          DISPLAY   *P56:24,"Opening pathspaf";
          OPEN      PATHSPA1,"pathspaf"
.
          DISPLAY   *P56:24,"Opening patma1af";
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PMSPX2A1,"pmspx2af"
.
          DISPLAY   *P56:24,"Opening patmrgaf";
          OPEN      PATMRGG3,"patmrgaf"
.
          DISPLAY   *P56:24,"Opening paturadf";
          OPEN      PATURAD1,"paturadf"
          OPEN      PATURAD2,"paturadf"
.
          DISPLAY   *P56:24,"Opening patchcof";
          OPEN      PATCHCO1,"patchcof"
          OPEN      PATCHCO3,"patchcof"
.
          DISPLAY   *P56:24,"Opening patmi1af";
          OPEN      PATMI1A1,"patmi1af"
          OPEN      PATMI1A8,"patmi1af"
.
          DISPLAY   *P56:24,"Opening pattranf";
          OPEN      PATTRAN2,"pattranf"
          OPEN      PATTRAN6,"pattranf"
.
          DISPLAY   *P56:24,"Opening patunanf";
          OPEN      PATUNAA3,"patunaaf"
.
          DISPLAY   *P56:24,"Opening patvadaf";
          OPEN      PATVADA1,"patvadaf"
.
          DISPLAY   *P56:24,"Opening patvisaf";
          OPEN      PATVISA1,"patvisaf"
          OPEN      PATVISA2,"patvisaf"
          OPEN      PATVISA4,"patvisaf"
.
          DISPLAY   *P56:24,"Opening patwbhaf";
          OPEN      PATWBHA1,"patwbhaf"
          OPEN      PATWBHA2,"patwbhaf"
.
          DISPLAY   *P56:24,"Opening patwr1af";
          OPEN      PATWR1A1,"patwr1af"
.
          DISPLAY   *P56:24,"Opening pmsadwaf";
          OPEN      PMSADWA1,"pmsadwaf"
.
          DISPLAY   *P56:24,"Opening pmsaidaf";
          OPEN      PMSAIDA1,"pmsaidaf"
.
          DISPLAY   *P56:24,"Opening pmsbrqaf";
          OPEN      PMSBRQA1,"pmsbrqaf"
.
          DISPLAY   *P56:24,"Opening pmsccdaf";
          OPEN      PMSCCDA1,"pmsccdaf"
.
          DISPLAY   *P56:24,"Opening pmscexaf";
          OPEN      PMSCEXA1,"pmscexaf"
.
          DISPLAY   *P56:24,"Opening pmsdunaf";
          OPEN      PMSDUNA1,"pmsdunaf"
.
          DISPLAY   *P56:24,"Opening pmsedwaf";
          OPEN      PMSEDWA1,"pmsedwaf"
          OPEN      PMSEDWA2,"pmsedwaf"
.
          DISPLAY   *P56:24,"Opening pmshcpaf";
          OPEN      PMSHCPA1,"pmshcpaf"
          OPEN      PMSHCPA4,"pmshcpaf"
          OPEN      PMSHCPA5,"pmshcpaf"
          OPEN      PMSHCPA6,"pmshcpaf"
.
          DISPLAY   *P56:24,"Opening pmshcgaf";
          OPEN      PMSHCGA1,"pmshcgaf"
.
          DISPLAY   *P56:24,"Opening pmshclaf";
          OPEN      PMSHCLA1,"pmshclaf"
          OPEN      PMSHCLA2,"pmshclaf"
          OPEN      PMSHCLA4,"pmshclaf"
          OPEN      PMSHCLA5,"pmshclaf"
.
          DISPLAY   *P56:24,"Opening pmsidwaf";
          OPEN      PMSIDWA1,"pmsidwaf"
          OPEN      PMSIDWA2,"pmsidwaf"
.
          DISPLAY   *P56:24,"Opening pmsuhlaf";
          OPEN      PMSUHLA1,"pmsuhlaf"
.
          DISPLAY   *P56:24,"Opening pmsworaf";
          OPEN      PMSWORA1,"pmsworaf"
.
          DISPLAY   *P56:24,"Opening pmsvx1af";
          OPEN      PMSVX1A1,"pmsvx1af"
          OPEN      PMSVX1A4,"pmsvx1af"
.
          DISPLAY   *P56:24,"Opening viscmtaf";
          OPEN      VISCMTA1,"viscmtaf"
.
          DISPLAY   *P56:24,"Opening watchaaf";
          OPEN      WATCHAA1,"watchaaf"
          OPEN      WATCHAA2,"watchaaf"
.
          DISPLAY   *P56:24,"Opening watcataf";
          OPEN      WATCATA1,"watcataf"
          OPEN      WATCATA2,"watcataf"
.
          DISPLAY   *P56:24,"Opening priitemf";
          OPEN      PRIITEM1,"priitemf"
.
          DISPLAY   *P56:24,"Opening watproaf";
          OPEN      WATPROA1,"watproaf"
.
          DISPLAY   *P56:24,"Opening watsusaf";
          OPEN      WATSUSA1,"watsusaf"
.
          DISPLAY   *P56:24,"Opening wattr1af";
          OPEN      WATTR1A1,"wattr1af"
.
          DISPLAY   *P56:24,"Opening wattx1af";
          OPEN      WATTX1A1,"wattx1af"
          OPEN      WATTX1A2,"wattx1af"
.
          DISPLAY   *P56:24,"Opening wathisaf";
          OPEN      WATHISA1,"wathisaf"
.
          DISPLAY   *P56:24,"Opening websecaf";
          OPEN      WEBSECA1,"websecaf"
.
          DISPLAY   *P56:24,"Opening outsitaf";
          OPEN      OUTSITA1,"outsitaf"
          OPEN      OUTPREA1,"outpreaf"
.
          DISPLAY   *P56:24,"Opening pmsrelaf";
          OPEN      PMSRELA1,"pmsrelaf"
.
          MOVE      "out",CFILEPRE          * Save Current File Prefix
          CALL      OPNOUT00                * Open Outpatient Files
.
          CALL      OPICD1             * Open ICD Disease files
          CALL      OPICO1             * Open ICD Operation files
.
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          READ      CONTROLF,HUND25;*93,PTCNNSSI,*113,PTCNNIAI,*133,PTCNNECI:
                                    *154,PTCNSHSD,*184,PTCNNEXT,*204,PTCNNCPP:
                                    *235,PTCNEXED
          READ      CONTROLF,TEN3;*1,CHADD1,CHADD2,CHPOST
          READ      CONTROLF,EIGHTY;*250,PTCNHDPS
          READ      CONTROLF,TEN3;*129,CHTELEB
          READ      CONTROLF,THIRTY7;*236,WTCNBRSR
          READ      CONTROLF,HUND17;*228,PTCNNEBI
          READ      CONTROLF,HUND18;*84,PTCNHFAX
          READ      CONTROLF,EIGHTY8;*116,CHCSDTE
          READ      CONTROLF,HUND17;*220,PTCNGDX1
          READ      CONTROLF,HUND22;*26,EMCNSEDR
          READ      CONTROLF,HUND22;*28,EMCNHSID,*27,EMCNHISA
          READ      CONTROLF,HUND28;*231,PTCNGDX2
          READ      CONTROLF,HUND30;*86,PTCNGDX3
.
          SQUEEZE   PTCNNSSI
          SQUEEZE   PTCNNIAI
          SQUEEZE   PTCNNECI
          SQUEEZE   PTCNNEXT
          SQUEEZE   PTCNNCPP
          SQUEEZE   PTCNNEBI
.
INIT9999  RETURN
+
.****************************************************************************
.*                                OPTN0000             Called by: ML0000    *
.*                        get user options or exit                          *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Run clean up                           *
.*                        TRUE  (1)  Exit option selected                   *
.****************************************************************************
.
OPTN0000  MOVE      ZERO,RERUNFL
          DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF,". Exit":
                    *P1:5,*V2LON,ONE,*HOFF,". Run Client Extract":
                    *P1:6,*V2LON,TWO,*HOFF,". Run ISP Extract":
                    *P1:7,*V2LON,THREE,*HOFF,". Run Emergency Extract":
                    *P1:8,*V2LON,FOUR,*HOFF,". Run Service Scheduling Extract":
                    *P1:9,*V2LON,FIVE,*HOFF,". Run Admitted Patient Extract":
                    *P1:10,*V2LON,SIX,*HOFF,". Run Non Admitted Patient Extract"
.
OPTN0500  KEYIN     *P1:11,*EL,"Select Option : ",*DV,UNDLN1:
                    *P17:11,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9500 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9000,OPTN9000,OPTN9000,OPTN9000,OPTN9000,OPTN9000    * run clean-up
.
          BEEP
          GOTO      OPTN0500
.
OPTN9000  MOVE      ZERO,EXIT
          KEYIN     *P1:12,*EL,"Re-Run Y/N ",RERUNFL
.
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.------------------------------------------------------------
. Open Outpatient Files
.------------------------------------------------------------
OPNOUT00  PACK      CFNAME,CFILEPRE,FILBOKA1
          CLOSE     OUTBOKA1
          OPEN      OUTBOKA1,CFNAME 
.
          PACK      CFNAME,CFILEPRE,FILBOKA3
          CLOSE     OUTBOKA3
          OPEN      OUTBOKA3,CFNAME
.
          PACK      CFNAME,CFILEPRE,FILBOKA6
          CLOSE     OUTBOKA6
          OPEN      OUTBOKA6,CFNAME 
.
          PACK      CFNAME,CFILEPRE,FILBB1A1
          CLOSE     OUTBB1A1
          CALL      OPOTBB11
.
          PACK      CFNAME,CFILEPRE,FILRSHA1
          CLOSE     OUTRSHA1
          OPEN      OUTRSHA1,CFNAME          * Open the rescheduling fil
.
          PACK      CFNAME,CFILEPRE,FILRSHA3
          CLOSE     OUTRSHA3
          OPEN      OUTRSHA3,CFNAME          * Open the rescheduling fil
.
          PACK      CFNAME,CFILEPRE,FILCANA4  * Get the name of the CANA2 file
          CLOSE     OUTCANA4
          OPEN      OUTCANA4,CFNAME          * Open the cancellation log file
.
          PACK      CFNAME,CFILEPRE,FILDIAG1  * Get the name of the DIAG1 file
          CLOSE     OUTDIAG1
          OPEN      OUTDIAG1,CFNAME          * Open the cancellation log file
.
          PACK      CFNAME,CFILEPRE,FILSESA6  * Get the name of the SESA1 file
          CLOSE     OUTSESA1
          OPEN      OUTSESA1,CFNAME           * Open the file
.
          PACK      CFNAME,CFILEPRE,FILSESA6  * Get the name of the SESA6 file
          CLOSE     OUTSESA6
          OPEN      OUTSESA6,CFNAME           * Open the file
.
          PACK      CFNAME,CFILEPRE,FILCLIA1  * Get the name of the CLIA1 file
          CLOSE     OUTCLIA1
          OPEN      OUTCLIA1,CFNAME           * Open the file
.
          PACK      CFNAME,CFILEPRE,FILBITA1  * Get the name of the BITA1 file
          CLOSE     OUTBITA1
          OPEN      OUTBITA1,CFNAME           * Open the file
.
          PACK      CFNAME,CFILEPRE,FILHEDA1  * Get the name of the HEDA1 file
          CLOSE     OUTHEDA1
          OPEN      OUTHEDA1,CFNAME           * Open the file
.
          PACK      CFNAME,CFILEPRE,FILCTYA1  * Get the name of the CTYA1 file
          CLOSE     OUTCTYA1
          OPEN      OUTCTYA1,CFNAME           * Open the file
.
OPNOUT99  RETURN
+
.*******************************************************************************
. COTFIL00 - Check that the correct outpatient site prefix files are open
.            according to the site code. If the site is invalid
.            or blank just open the default site of out.
.*******************************************************************************
COTFIL00  MATCH     SP70,CHECKSIT            * Does the visit have a site
          GOTO      COTFIL50 IF NOT EQUAL
.
COTFIL10  MATCH     "out",CFILEPRE           * Is out currently open
          IF        !@EQUAL
            MOVE      "out",OSTFILE          * open default prefix of out
            MOVE      OSTFILE,CFILEPRE       * Save Current File Prefix
            CALL      OPNOUT00               * Open out Outpatient Files
          ENDIF
.
          GOTO      COTFIL99
.
COTFIL50  MOVE      CHECKSIT,KEY6
          CALL      RDSITA1
          BRANCH    OVRCD,COTFIL10           * error invalid site code
.
          MATCH     OSTFILE,CFILEPRE         * Save Current File Prefix
          IF        !@EQUAL
            MOVE      OSTFILE,CFILEPRE       * Save Current File Prefix
            CALL      OPNOUT00               * Open prefixed Outpatient Files
          ENDIF
.
          GOTO      COTFIL99
.
COTFIL99  RETURN
+
.******************************************************************************
.*                                 VDAT0000               Called by: ML0000   *
.*                         Keyin The date range                               *
.******************************************************************************
VDAT0000  MOVE      ZERO,EXIT
          MOVE      SP70,CONTSTRM
          CALL      IBACLOCK
          PACK      CURDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURDATE
          CLOCK     TIME,CURTIME
          PACK      CONTTIME,CURTIME
          REP       ":'",CONTTIME
          CALL      HEAD80
          UNPACK    CONTTIME,CHOUR,D1,CMIN,D1,D2
          PACK      ESCTTIME,CHOUR,APOSTRPH,CMIN,APOSTRPH,D2
          PACK      SRCRDATE,CURDATE
          PACK      SRCRTIME,CURTIME
          PACK      SRMDDATE,SP70
          PACK      SRMDTIME,SP70
          STRIP     SRMDDATE
          STRIP     SRMDTIME
          MOVE      ZERO,NOUPDATE
.
. ----- Enter Starting Date -----
.
VDAT1000  DISPLAY   *P1:13,*EF,"Starting Date : ":
                    *P1:14,*EL,"Ending Date : ";
          MOVE      "13",CVERT
          MOVE      "27",CCOL
          MOVE      CCC,CCENT
          UNPACK    SP6,CYEAR,CMON,CDAY
          CALL      KEYDATE                 * Keyin the starting date
          BRANCH    OVRCD,VDAT9000
.
          PACK      STRTDATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",STRTDATE
          CALL      PACDATE                 * Pack the starting date
.
.
. ----- Check If Starting Date Is Greater Than Today's Date -----
.
          MATCH     STRTDATE,CURDATE
          IF        @LESS
            DISPLAY   *P1:24,*EL,*B,"Keyed in date is greater than today's ":
                      "date. ";
            CALL      HITENTER
            PRINT     "Start date is greater than today's date"
            GOTO      VDAT9000
          ENDIF
.

. ----- Enter Ending Date -----
.
VDAT2000  MOVE      "14",CVERT
          MOVE      "27",CCOL
          CALL      KEYDATE                 * Keyin the ending date
          BRANCH    OVRCD,VDAT1000
.
          PACK      ENDDATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",ENDDATE
          CALL      PACDATE                 * Pack the starting date
.
. ----- Check If Ending Date Is Greater Than or equal to Today's Date -----
.
          MATCH     CURDATE,ENDDATE
          IF        !@LESS
            DISPLAY   *P1:24,*EL,*B,"End date must be less than today's ":
                      "date. ";
            PRINT     "End date must be less than today's date"
            CALL      HITENTER
            GOTO      VDAT9000
          ENDIF
.
. ----- Check That The Ending Date Is Greater Than The Starting Date -----
.
          MATCH     STRTDATE,ENDDATE
          IF        @LESS
            DISPLAY   *P1:24,*EL,*B,"Ending date must be greater than the ":
                      "starting date. ";
            CALL      HITENTER
            PRINT     "End date must be greater than start date"
            GOTO      VDAT9000
          ENDIF
.
. ----- Get the next container number for this stream -----
.
          IF        COPTION=1
            PACK      CONTSTRM,ONE,SP70    * Client Extract
          ENDIF
          IF        COPTION=2
            PACK      CONTSTRM,THREE,SP70  * ISP Extract
          ENDIF
.
          IF        COPTION=3
            PACK      CONTSTRM,ONE,EIGHT,SP70  * Emergency Extract
          ENDIF
.
          IF        COPTION=4
            PACK      CONTSTRM,SIX,SP70  * Service Scheduling Extract
          ENDIF
.
          IF        COPTION=5
            PACK      CONTSTRM,ONE,SEVEN,SP70  * Admitted Patient Extract
          ENDIF
.
          IF        COPTION=6
            PACK      CONTSTRM,FIVE,SP70  * Non Admitted Patient Extract
          ENDIF
.
          PACK      KEY11,CONTSTRM,Z70
          CALL      RSCMEDW1                * Position on last container
          CALL      RPCMEDW1               
          BRANCH    OVRCD,VDAT3000          * First run, continue
.
          MATCH     CONTSTRM,CMEDDSTR
          GOTO      VDAT3000 IF NOT EQUAL
.
          MOVE      CMEDCNTN,CONTNUMB
          ADD       ONE,CONTNUMB
.
          MATCH     ANSY,RERUNFL          * don't validate dates for re-run
          GOTO      VDAT9999 IF EQUAL
.
.
. ----- Check If Date Range is valid for this container type -----
.
.  now read by index 2 to get last date range 
          PACK      KEY19,CONTSTRM,Z70
          CALL      RSCMEDW2                * Position on last container
          CALL      RPCMEDW2               
          BRANCH    OVRCD,VDAT3000          * First run, continue
.
          MATCH     CONTSTRM,CMEDDSTR
          GOTO      VDAT3000 IF NOT EQUAL
.
.  start date of this extract must be after the previous end date
          MATCH     STRTDATE,CMEDEDAT
          GOTO      VDAT4000 IF NOT LESS
.
.  start date of this extract must the day after the previous end date
          MOVE      CMEDEDAT,TESTDATE
          ADD       ONE,TESTDATE
          MATCH     STRTDATE,TESTDATE
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,"Start date must be the day after the last run";
            CALL      HITENTER
            PRINT     "Start date must be the day after the last run - Container ",CMEDCNTN;
            GOTO      VDAT9000
          ENDIF
          GOTO      VDAT9999
.
VDAT3000  DISPLAY   *P1:24,*EL,*B,"First run for this container ";
          MOVE      ONE,CONTNUMB
          GOTO      VDAT9999
.
VDAT4000  DISPLAY   *P1:24,*EL,*B,"Start date must be after the last run";
          CALL      HITENTER
          PRINT     "Start date must be after the last run - Container ",CMEDCNTN;
          GOTO      VDAT9000
.
VDAT9000  MOVE      ONE,EXIT
VDAT9999  RETURN
+
.**************************************************************************
.*                               PROC0000              Called by: ML0000  *
.*                                                                        *
.**************************************************************************
.
PROC0000  IF        COPTION=1
            MOVE      SP900,OBJECTKY
            MOVE      SP900,OBJECTTX
            MOVE      "01",OBJECTTY
            CALL      HD010000    * write 01 header line
            CALL      WRCOND00
            MOVE      "02",OBJECTTY
            CALL      HD020000    * write 02 header line
            CALL      WRCOND00
            MOVE      "03",OBJECTTY
            CALL      HD030000    * write 03 header line
            CALL      WRCOND00
            MOVE      "04",OBJECTTY
            CALL      HD040000    * write 04 header line
            CALL      WRCOND00
            MOVE      "05",OBJECTTY
            CALL      HD050000    * write 05 header line
            CALL      WRCOND00
            MOVE      "06",OBJECTTY
            CALL      HD060000    * write 06 header line
            CALL      WRCOND00
            MOVE      "07",OBJECTTY
            CALL      HD070000    * write 07 header line
            CALL      WRCOND00
            MOVE      "08",OBJECTTY
            CALL      HD080000    * write 08 header line
            CALL      WRCOND00
            MOVE      "09",OBJECTTY
            CALL      HD090000    * write 09 header line
            CALL      WRCOND00
            MOVE      "10",OBJECTTY
            CALL      HD100000    * write 10 header line
            CALL      WRCOND00
            CALL      EDCL0000    * Run Client extraction
          ENDIF
.
          IF        COPTION=2
            MOVE      "32",OBJECTTY
            CALL      HD320000    * write 32 header line
            CALL      WRCOND00
            MOVE      "33",OBJECTTY
            CALL      HD330000    * write 33 header line
            CALL      WRCOND00
            MOVE      "34",OBJECTTY
            CALL      HD340000    * write 34 header line
            CALL      WRCOND00
            MOVE      "37",OBJECTTY
            CALL      HD370000    * write 35 header line
            CALL      WRCOND00
            MOVE      "38",OBJECTTY
            CALL      HD380000    * write 38 header line
            CALL      WRCOND00
            MOVE      "40",OBJECTTY
            CALL      HD400000    * write 40 header line
            CALL      WRCOND00
            MOVE      "41",OBJECTTY
            CALL      HD410000    * write 41 header line
            CALL      WRCOND00
            MOVE      "42",OBJECTTY
            CALL      HD420000    * write 42 header line
            CALL      WRCOND00
            MOVE      "43",OBJECTTY
            CALL      HD430000    * write 43 header line
            CALL      WRCOND00
            CALL      EDIS0000    * Run ISP extraction
          ENDIF
.
          IF        COPTION=3
            MOVE      "56",OBJECTTY
            CALL      HD560000    * write 56 header line
            CALL      WRCOND00
            MOVE      "57",OBJECTTY
            CALL      HD570000    * write 57 header line
            CALL      WRCOND00
            MOVE      "59",OBJECTTY
            CALL      HD590000    * write 59 header line
            CALL      WRCOND00
            MOVE      "60",OBJECTTY
            CALL      HD600000    * write 60 header line
            CALL      WRCOND00
            MOVE      "61",OBJECTTY
            CALL      HD610000    * write 61 header line
            CALL      WRCOND00
            MOVE      "63",OBJECTTY
            CALL      HD630000    * write 63 header line
            CALL      WRCOND00
            MOVE      "64",OBJECTTY
            CALL      HD640000    * write 64 header line
            CALL      WRCOND00
            MOVE      "115",OBJECTTY
            CALL      HD115000    * write 115 header line
            CALL      WRCOND00
            MOVE      "130",OBJECTTY
            CALL      HD130000    * write 130 header line
            CALL      WRCOND00
            MOVE      "137",OBJECTTY
            CALL      HD137000    * write 137 header line
            CALL      WRCOND00
            MOVE      "141",OBJECTTY
            CALL      HD141000    * write 141 header line
            CALL      WRCOND00
            MOVE      "142",OBJECTTY
            CALL      HD142000    * write 142 header line
            CALL      WRCOND00
            MOVE      "143",OBJECTTY
            CALL      HD143000    * write 143 header line
            CALL      WRCOND00
            MOVE      "145",OBJECTTY
            CALL      HD145000    * write 145 header line
            CALL      WRCOND00
            CALL      EDED0000    * Run Emergency extraction
          ENDIF
.
          IF        COPTION=4
            MOVE      "72",OBJECTTY
            CALL      HD720000    * write 72 header line
            CALL      WRCOND00
            MOVE      "74",OBJECTTY
            CALL      HD740000    * write 74 header line
            CALL      WRCOND00
            MOVE      "65",OBJECTTY
            CALL      HD650000    * write 65 header line
            CALL      WRCOND00
            MOVE      "66",OBJECTTY
            CALL      HD660000    * write 66 header line
            CALL      WRCOND00
            MOVE      "67",OBJECTTY
            CALL      HD670000    * write 67 header line
            CALL      WRCOND00
            MOVE      "68",OBJECTTY
            CALL      HD680000    * write 68 header line
            CALL      WRCOND00
            MOVE      "69",OBJECTTY
            CALL      HD690000    * write 69 header line
            CALL      WRCOND00
            MOVE      "70",OBJECTTY
            CALL      HD700000    * write 70 header line
            CALL      WRCOND00
            MOVE      "73",OBJECTTY
            CALL      HD730000    * write 73 header line
            CALL      WRCOND00
            CALL      EDSS0000    * Run Service Scheduling extraction
          ENDIF
.
          IF        COPTION=5
            MOVE      "56",OBJECTTY
            CALL      HD56A000    * write 56 header line
            CALL      WRCOND00
            MOVE      "57",OBJECTTY
            CALL      HD57N000    * write 57 header line
            CALL      WRCOND00
            MOVE      "59",OBJECTTY
            CALL      HD590000    * write 59 header line
            CALL      WRCOND00
            MOVE      "60",OBJECTTY
            CALL      HD60A000    * write 60 header line
            CALL      WRCOND00
            MOVE      "61",OBJECTTY
            CALL      HD61A000    * write 61 header line
            CALL      WRCOND00
            MOVE      "63",OBJECTTY
            CALL      HD63A000    * write 63 header line
            CALL      WRCOND00
            MOVE      "64",OBJECTTY
            CALL      HD640000    * write 64 header line
            CALL      WRCOND00
            MOVE      "72",OBJECTTY
            CALL      HD720000    * write 72 header line
            CALL      WRCOND00
            MOVE      "112",OBJECTTY
            CALL      WRCOND00
            MOVE      "114",OBJECTTY
            CALL      WRCOND00
            MOVE      "115",OBJECTTY
            CALL      HD115000    * write 115 header line
            CALL      WRCOND00
            MOVE      "130",OBJECTTY
            CALL      HD130000    * write 130 header line
            CALL      WRCOND00
            MOVE      "131",OBJECTTY
            CALL      HD131000    * write 131 header line
            CALL      WRCOND00
            MOVE      "133",OBJECTTY
            CALL      HD133000    * write 133 header line
            CALL      WRCOND00
            MOVE      "134",OBJECTTY
            CALL      HD134000    * write 134 header line
            CALL      WRCOND00
            MOVE      "135",OBJECTTY
            CALL      HD135000    * write 135 header line
            CALL      WRCOND00
            MOVE      "136",OBJECTTY
            CALL      HD136000    * write 136 header line
            CALL      WRCOND00
            MOVE      "137",OBJECTTY
            CALL      HD137000    * write 137 header line
            CALL      WRCOND00
            MOVE      "142",OBJECTTY
            CALL      HD142A00    * write 142 header line
            CALL      WRCOND00
            CALL      EDAP0000    * Run Admitted Patient extraction
          ENDIF
.
          IF        COPTION=6
            MOVE      "54",OBJECTTY
            CALL      HD540000    * write 54 header line
            CALL      WRCOND00
            MOVE      "55",OBJECTTY
            CALL      HD550000    * write 55 header line
            CALL      WRCOND00
            MOVE      "56",OBJECTTY
            CALL      HD56N000    * write 56 header line
            CALL      WRCOND00
            MOVE      "57",OBJECTTY
            CALL      HD57N000    * write 57 header line
            CALL      WRCOND00
            MOVE      "58",OBJECTTY
            CALL      HD580000    * write 58 header line
            CALL      WRCOND00
            MOVE      "59",OBJECTTY
            CALL      HD59N000    * write 59 header line
            CALL      WRCOND00
            MOVE      "60",OBJECTTY
            CALL      HD600000    * write 60 header line
            CALL      WRCOND00
            MOVE      "61",OBJECTTY
            CALL      HD61N000    * write 61 header line
            CALL      WRCOND00
            MOVE      "63",OBJECTTY
            CALL      HD63N000    * write 63 header line
            CALL      WRCOND00
            MOVE      "64",OBJECTTY
            CALL      HD640000    * write 64 header line
            CALL      WRCOND00
            MOVE      "72",OBJECTTY
            CALL      HD720000    * write 72 header line
            CALL      WRCOND00
            MOVE      "73",OBJECTTY
            CALL      HD730000    * write 73 header line
            CALL      WRCOND00
            MOVE      "74",OBJECTTY
            CALL      HD740000    * write 74 header line
            CALL      WRCOND00
            CALL      EDNA0000    * Run Non Admitted extraction
          ENDIF
.
          CALL     OBJA0000      * Create Object Attribute Records
          CALL     CONF0000      * Build Container CSV File

PROC9999  RETURN
+
.**************************************************************************
.*                               HD010000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD010000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB001C09,TILDA:
                             OB001C10,TILDA:
                             OB001C11,TILDA:
                             OB001C12,TILDA:
                             OB001C13
HD019999  RETURN
+
.**************************************************************************
.*                               HD020000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD020000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB002C09,TILDA:
                             OB002C10,TILDA:
                             OB002C11,TILDA:
                             OB002C12,TILDA:
                             OB002C13,TILDA:
                             OB002C14,TILDA:
                             OB002C15,TILDA:
                             OB002C16,TILDA:
                             OB002C17,TILDA:
                             OB002C18,TILDA:
                             OB002C19,TILDA:
                             OB002C20,TILDA:
                             OB002C21
HD029999  RETURN
+
.**************************************************************************
.*                               HD030000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD030000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB003C09,TILDA:
                             OB003C10,TILDA:
                             OB003C11,TILDA:
                             OB003C12,TILDA:
                             OB003C13,TILDA:
                             OB003C14,TILDA:
                             OB003C15,TILDA:
                             OB003C16,TILDA:
                             OB003C17,TILDA:
                             OB003C18,TILDA:
                             OB003C19,TILDA:
                             OB003C20,TILDA:
                             OB003C21,TILDA:
                             OB003C22
HD039999  RETURN
+
.**************************************************************************
.*                               HD040000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD040000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB004C09,TILDA:
                             OB004C10,TILDA:
                             OB004C11,TILDA:
                             OB004C12,TILDA:
                             OB004C13,TILDA:
                             OB004C14,TILDA:
                             OB004C15
HD049999  RETURN
+
.**************************************************************************
.*                               HD050000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD050000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB005C09,TILDA:
                             OB005C10,TILDA:
                             OB005C11,TILDA:
                             OB005C12,TILDA:
                             OB005C13,TILDA:
                             OB005C14
HD059999  RETURN
+
.**************************************************************************
.*                               HD060000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD060000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB006C09,TILDA:
                             OB006C10,TILDA:
                             OB006C11,TILDA:
                             OB006C12,TILDA:
                             OB006C13,TILDA:
                             OB006C14,TILDA:
                             OB006C15,TILDA:
                             OB006C16
HD069999  RETURN
+
.**************************************************************************
.*                               HD070000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD070000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB007C09,TILDA:
                             OB007C10,TILDA:
                             OB007C11,TILDA:
                             OB007C12,TILDA:
                             OB007C13,TILDA:
                             OB007C14,TILDA:
                             OB007C15,TILDA:
                             OB007C16
HD079999  RETURN
+
.**************************************************************************
.*                               HD080000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD080000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB008C09,TILDA:
                             OB008C10,TILDA:
                             OB008C11,TILDA:
                             OB008C12,TILDA:
                             OB008C13,TILDA:
                             OB008C14,TILDA:
                             OB008C15,TILDA:
                             OB008C16,TILDA:
                             OB008C17,TILDA:
                             OB008C18
HD089999  RETURN
+
.**************************************************************************
.*                               HD090000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD090000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB009C09,TILDA:
                             OB009C10,TILDA:
                             OB009C11,TILDA:
                             OB009C12,TILDA:
                             OB009C13,TILDA:
                             OB009C14,TILDA:
                             OB009C15
HD099999  RETURN
+
.**************************************************************************
.*                               HD100000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD100000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB001C06,TILDA:
                             OB001C07,TILDA:
                             OB001C08,TILDA:
                             OB010C09,TILDA:
                             OB010C10,TILDA:
                             OB010C11,TILDA:
                             OB010C12,TILDA:
                             OB010C13
HD109999  RETURN
+
.**************************************************************************
.*                               HD320000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD320000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB320C06,TILDA:
                             OB320C07,TILDA:
                             OB320C08,TILDA:
                             OB320C09,TILDA:
                             OB320C10,TILDA:
                             OB320C11,TILDA:
                             OB320C12,TILDA:
                             OB320C13,TILDA:
                             OB320C14
HD329999  RETURN
+
.**************************************************************************
.*                               HD330000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD330000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB330C06,TILDA:
                             OB330C07,TILDA:
                             OB330C08,TILDA:
                             OB330C09,TILDA:
                             OB330C10,TILDA:
                             OB330C11,TILDA:
                             OB330C12,TILDA:
                             OB330C13
HD339999  RETURN
+
.**************************************************************************
.*                               HD340000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD340000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB340C06,TILDA:
                             OB340C07,TILDA:
                             OB340C08,TILDA:
                             OB340C09,TILDA:
                             OB340C10,TILDA:
                             OB340C11,TILDA:
                             OB340C12,TILDA:
                             OB340C13,TILDA:
                             OB340C14
HD349999  RETURN
+
.**************************************************************************
.*                               HD370000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD370000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB370C06,TILDA:
                             OB370C07,TILDA:
                             OB370C08,TILDA:
                             OB370C09,TILDA:
                             OB370C10,TILDA:
                             OB370C11,TILDA:
                             OB370C12,TILDA:
                             OB370C13,TILDA:
                             OB370C14,TILDA:
                             OB370C15
HD379999  RETURN
+
.**************************************************************************
.*                               HD380000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD380000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB380C06,TILDA:
                             OB380C07,TILDA:
                             OB380C08,TILDA:
                             OB380C09,TILDA:
                             OB380C10,TILDA:
                             OB380C11,TILDA:
                             OB380C12,TILDA:
                             OB380C13,TILDA:
                             OB380C14,TILDA:
                             OB380C15,TILDA:
                             OB380C16,TILDA:
                             OB380C17,TILDA:
                             OB380C18,TILDA:
                             OB380C19,TILDA:
                             OB380C20,TILDA:
                             OB380C21
HD389999  RETURN
+
.**************************************************************************
.*                               HD400000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD400000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB400C06,TILDA:
                             OB400C07,TILDA:
                             OB400C08,TILDA:
                             OB400C09,TILDA:
                             OB400C10,TILDA:
                             OB400C11,TILDA:
                             OB400C12,TILDA:
                             OB400C13,TILDA:
                             OB400C14,TILDA:
                             OB400C15,TILDA:
                             OB400C16
HD409999  RETURN
+
.**************************************************************************
.*                               HD410000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD410000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB410C06,TILDA:
                             OB410C07,TILDA:
                             OB410C08,TILDA:
                             OB410C09,TILDA:
                             OB410C10,TILDA:
                             OB410C11,TILDA:
                             OB410C12,TILDA:
                             OB410C13
HD419999  RETURN
+
.**************************************************************************
.*                               HD420000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD420000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB420C06,TILDA:
                             OB420C07,TILDA:
                             OB420C08,TILDA:
                             OB420C09,TILDA:
                             OB420C10,TILDA:
                             OB420C11,TILDA:
                             OB420C12,TILDA:
                             OB420C13,TILDA:
                             OB420C14,TILDA:
                             OB420C15,TILDA:
                             OB420C16
HD429999  RETURN
+
.**************************************************************************
.*                               HD430000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD430000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB430C06,TILDA:
                             OB430C07,TILDA:
                             OB430C08,TILDA:
                             OB430C09,TILDA:
                             OB430C10,TILDA:
                             OB430C11,TILDA:
                             OB430C12,TILDA:
                             OB430C13
HD439999  RETURN
+
.**************************************************************************
.*                               HD540000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD540000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB540C06,TILDA:
                             OB540C07,TILDA:
                             OB540C08,TILDA:
                             OB540C09,TILDA:
                             OB540C10,TILDA:
                             OB540C11,TILDA:
                             OB540C12,TILDA:
                             OB540C13,TILDA:
                             OB540C14,TILDA:
                             OB540C15,TILDA:
                             OB540C16
HD549999  RETURN
+
.**************************************************************************
.*                               HD550000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD550000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB550C06,TILDA:
                             OB550C07,TILDA:
                             OB550C08,TILDA:
                             OB550C09,TILDA:
                             OB550C10,TILDA:
                             OB550C11,TILDA:
                             OB550C12,TILDA:
                             OB550C13,TILDA:
                             OB550C14,TILDA:
                             OB550C15,TILDA:
                             OB550C16,TILDA:
                             OB550C17,TILDA:
                             OB550C18,TILDA:
                             OB550C19,TILDA:
                             OB550C20,TILDA:
                             OB550C21,TILDA:
                             OB550C22,TILDA:
                             OB550C23,TILDA:
                             OB550C24,TILDA:
                             OB550C25,TILDA:
                             OB550C26,TILDA:
                             OB550C27,TILDA:
                             OB550C28,TILDA:
                             OB550C29,TILDA:
                             OB550C30
HD559999  RETURN
+
.**************************************************************************
.* Non - admitted                HD56N000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD56N000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB56NC06,TILDA:
                             OB56NC07,TILDA:
                             OB56NC08,TILDA:
                             OB56NC09,TILDA:
                             OB56NC10,TILDA:
                             OB56NC11,TILDA:
                             OB56NC12,TILDA:
                             OB56NC13,TILDA:
                             OB56NC14,TILDA:
                             OB56NC15,TILDA:
                             OB56NC16,TILDA:
                             OB56NC17,TILDA:
                             OB56NC18,TILDA:
                             OB56NC19,TILDA:
                             OB56NC20,TILDA:
                             OB56NC21
HD56N999  RETURN
+
.**************************************************************************
.*                               HD560000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD560000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB560C06,TILDA:
                             OB560C07,TILDA:
                             OB560C08,TILDA:
                             OB560C09,TILDA:
                             OB560C10,TILDA:
                             OB560C11,TILDA:
                             OB560C12,TILDA:
                             OB560C13,TILDA:
                             OB560C14,TILDA:
                             OB560C15,TILDA:
                             OB560C16,TILDA:
                             OB560C17,TILDA:
                             OB560C18,TILDA:
                             OB560C19,TILDA:
                             OB560C20
HD569999  RETURN
+
.**************************************************************************
.*       admitted                HD56N000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD56A000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB56AC06,TILDA:
                             OB56AC07,TILDA:
                             OB56AC08,TILDA:
                             OB56AC09,TILDA:
                             OB56AC10,TILDA:
                             OB56AC11,TILDA:
                             OB56AC12,TILDA:
                             OB56AC13,TILDA:
                             OB56AC14,TILDA:
                             OB56AC15,TILDA:
                             OB56AC16,TILDA:
                             OB56AC17,TILDA:
                             OB56AC18,TILDA:
                             OB56AC19,TILDA:
                             OB56AC20,TILDA:
                             OB56AC21
HD56A999  RETURN
+
.**************************************************************************
.*                               HD570000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD570000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB570C06,TILDA:
                             OB570C07,TILDA:
                             OB570C08,TILDA:
                             OB570C09,TILDA:
                             OB570C10,TILDA:
                             OB570C11,TILDA:
                             OB570C12
HD579999  RETURN
+
.**************************************************************************
.*  Non admitted                 HD57N000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD57N000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB57NC06,TILDA:
                             OB57NC07,TILDA:
                             OB57NC08,TILDA:
                             OB57NC09,TILDA:
                             OB57NC10,TILDA:
                             OB57NC11,TILDA:
                             OB57NC12
HD57N999  RETURN
+
.**************************************************************************
.*                               HD570000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD580000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB580C06,TILDA:
                             OB580C07,TILDA:
                             OB580C08,TILDA:
                             OB580C09,TILDA:
                             OB580C10,TILDA:
                             OB580C11,TILDA:
                             OB580C12,TILDA:
                             OB580C13,TILDA:
                             OB580C14,TILDA:
                             OB580C15,TILDA:
                             OB580C16,TILDA:
                             OB580C17,TILDA:
                             OB580C18,TILDA:
                             OB580C19,TILDA:
                             OB580C20,TILDA:
                             OB580C21,TILDA:
                             OB580C22,TILDA:
                             OB580C23,TILDA:
                             OB580C24,TILDA:
                             OB580C25,TILDA:
                             OB580C26
HD589999  RETURN
+
.**************************************************************************
.*                               HD590000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD590000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB590C06,TILDA:
                             OB590C07,TILDA:
                             OB590C08,TILDA:
                             OB590C09,TILDA:
                             OB590C10,TILDA:
                             OB590C11,TILDA:
                             OB590C12,TILDA:
                             OB590C13,TILDA:
                             OB590C14,TILDA:
                             OB590C15,TILDA:
                             OB590C16,TILDA:
                             OB590C17
HD599999  RETURN
+
.**************************************************************************
.*  Non admitted                 HD59N000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD59N000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB59NC06,TILDA:
                             OB59NC07,TILDA:
                             OB59NC08,TILDA:
                             OB59NC09,TILDA:
                             OB59NC10,TILDA:
                             OB59NC11,TILDA:
                             OB59NC12,TILDA:
                             OB59NC13,TILDA:
                             OB59NC14,TILDA:
                             OB59NC15,TILDA:
                             OB59NC16
HD59N999  RETURN
+
.**************************************************************************
.*                               HD600000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD600000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB600C06,TILDA:
                             OB600C07,TILDA:
                             OB600C08,TILDA:
                             OB600C09,TILDA:
                             OB600C10,TILDA:
                             OB600C11,TILDA:
                             OB600C12,TILDA:
                             OB600C13,TILDA:
                             OB600C14,TILDA:
                             OB600C15
HD609999  RETURN
+
.**************************************************************************
.*                               HD60A000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD60A000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB600C06,TILDA:
                             OB600C07,TILDA:
                             OB600C08,TILDA:
                             OB600C09,TILDA:
                             OB600C10,TILDA:
                             OB600C11,TILDA:
                             OB600C12,TILDA:
                             OB600C13,TILDA:
                             OB60AC14,TILDA:
                             OB60AC15
HD60A999  RETURN
+
.**************************************************************************
.*                               HD610000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD610000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB610C06,TILDA:
                             OB610C07,TILDA:
                             OB610C08,TILDA:
                             OB610C09,TILDA:
                             OB610C10,TILDA:
                             OB610C11,TILDA:
                             OB610C12,TILDA:
                             OB610C13,TILDA:
                             OB610C14,TILDA:
                             OB610C15,TILDA:
                             OB610C16,TILDA:
                             OB610C17,TILDA:
                             OB610C18,TILDA:
                             OB610C19
HD619999  RETURN
+
.**************************************************************************
.*      admitted                 HD61A000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD61A000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB61AC06,TILDA:
                             OB61AC07,TILDA:
                             OB61AC08,TILDA:
                             OB61AC09,TILDA:
                             OB61AC10,TILDA:
                             OB61AC11,TILDA:
                             OB61AC12,TILDA:
                             OB61AC13,TILDA:
                             OB61AC14,TILDA:
                             OB61AC15,TILDA:
                             OB61AC16,TILDA:
                             OB61AC17,TILDA:
                             OB61AC18,TILDA:
                             OB61AC19
HD61A999  RETURN
+
.**************************************************************************
.*  Non-admitted                 HD61N000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD61N000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB61NC06,TILDA:
                             OB61NC07,TILDA:
                             OB61NC08,TILDA:
                             OB61NC09,TILDA:
                             OB61NC10,TILDA:
                             OB61NC11,TILDA:
                             OB61NC12,TILDA:
                             OB61NC13,TILDA:
                             OB61NC14,TILDA:
                             OB61NC15,TILDA:
                             OB61NC16,TILDA:
                             OB61NC17,TILDA:
                             OB61NC18
HD61N999  RETURN
+
.**************************************************************************
.*                               HD630000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD630000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB630C06,TILDA:
                             OB630C07,TILDA:
                             OB630C08,TILDA:
                             OB630C09,TILDA:
                             OB630C10,TILDA:
                             OB630C11,TILDA:
                             OB630C12,TILDA:
                             OB630C13,TILDA:
                             OB630C14,TILDA:
                             OB630C15,TILDA:
                             OB630C16,TILDA:
                             OB630C17,TILDA:
                             OB630C18,TILDA:
                             OB630C19,TILDA:
                             OB630C20,TILDA:
                             OB630C21
HD639999  RETURN
+
.**************************************************************************
.*  Admitted                     HD63A000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD63A000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB63AC06,TILDA:
                             OB63AC07,TILDA:
                             OB63AC08,TILDA:
                             OB63AC09,TILDA:
                             OB63AC10,TILDA:
                             OB63AC11,TILDA:
                             OB63AC12,TILDA:
                             OB63AC13,TILDA:
                             OB63AC14,TILDA:
                             OB63AC15,TILDA:
                             OB63AC16,TILDA:
                             OB63AC17,TILDA:
                             OB63AC18,TILDA:
                             OB63AC19,TILDA:
                             OB63AC20,TILDA:
                             OB63AC21,TILDA:
                             OB63AC22
HD63A999  RETURN
+
.**************************************************************************
.*                               HD63N000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD63N000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB63NC06,TILDA:
                             OB63NC07,TILDA:
                             OB63NC08,TILDA:
                             OB63NC09,TILDA:
                             OB63NC10,TILDA:
                             OB63NC11,TILDA:
                             OB63NC12,TILDA:
                             OB63NC13,TILDA:
                             OB63NC14,TILDA:
                             OB63NC15,TILDA:
                             OB63NC16,TILDA:
                             OB63NC17,TILDA:
                             OB63NC18,TILDA:
                             OB63NC19,TILDA:
                             OB63NC20,TILDA:
                             OB63NC21
HD63N999  RETURN
+
.**************************************************************************
.*                               HD640000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD640000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB640C06,TILDA:
                             OB640C07,TILDA:
                             OB640C08,TILDA:
                             OB640C09,TILDA:
                             OB640C10,TILDA:
                             OB640C11,TILDA:
                             OB640C12,TILDA:
                             OB640C13,TILDA:
                             OB640C14,TILDA:
                             OB640C15,TILDA:
                             OB640C16,TILDA:
                             OB640C17,TILDA:
                             OB640C18
HD649999  RETURN
+
.**************************************************************************
.*                               HD650000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD650000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB650C06,TILDA:
                             OB650C07,TILDA:
                             OB650C08,TILDA:
                             OB650C09,TILDA:
                             OB650C10,TILDA:
                             OB650C11,TILDA:
                             OB650C12,TILDA:
                             OB650C13,TILDA:
                             OB650C14,TILDA:
                             OB650C15,TILDA:
                             OB650C16,TILDA:
                             OB650C17,TILDA:
                             OB650C18,TILDA:
                             OB650C19,TILDA:
                             OB650C20,TILDA:
                             OB650C21,TILDA:
                             OB650C22,TILDA:
                             OB650C23,TILDA:
                             OB650C24
HD659999  RETURN
+
.**************************************************************************
.*                               HD660000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD660000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB660C06,TILDA:
                             OB660C07,TILDA:
                             OB660C08,TILDA:
                             OB660C09,TILDA:
                             OB660C10,TILDA:
                             OB660C11,TILDA:
                             OB660C12,TILDA:
                             OB660C13,TILDA:
                             OB660C14
HD669999  RETURN
+
.**************************************************************************
.*                               HD670000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD670000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB670C06,TILDA:
                             OB670C07,TILDA:
                             OB670C08,TILDA:
                             OB670C09,TILDA:
                             OB670C10,TILDA:
                             OB670C11,TILDA:
                             OB670C12,TILDA:
                             OB670C13,TILDA:
                             OB670C14
HD679999  RETURN
+
.**************************************************************************
.*                               HD680000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD680000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB680C06,TILDA:
                             OB680C07,TILDA:
                             OB680C08,TILDA:
                             OB680C09,TILDA:
                             OB680C10,TILDA:
                             OB680C11,TILDA:
                             OB680C12,TILDA:
                             OB680C13
HD689999  RETURN
+
.**************************************************************************
.*                               HD690000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD690000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB690C06,TILDA:
                             OB690C07,TILDA:
                             OB690C08,TILDA:
                             OB690C09,TILDA:
                             OB690C10,TILDA:
                             OB690C11,TILDA:
                             OB690C12,TILDA:
                             OB690C13,TILDA:
                             OB690C14,TILDA:
                             OB690C15,TILDA:
                             OB690C16,TILDA:
                             OB690C17
HD699999  RETURN
+
.**************************************************************************
.*                               HD700000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD700000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB700C06,TILDA:
                             OB700C07,TILDA:
                             OB700C08,TILDA:
                             OB700C09,TILDA:
                             OB700C10,TILDA:
                             OB700C11,TILDA:
                             OB700C12,TILDA:
                             OB700C13,TILDA:
                             OB700C14,TILDA:
                             OB700C15
HD709999  RETURN
+
.**************************************************************************
.*                               HD720000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD720000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB720C06,TILDA:
                             OB720C07,TILDA:
                             OB720C08,TILDA:
                             OB720C09,TILDA:
                             OB720C10,TILDA:
                             OB720C11,TILDA:
                             OB720C12,TILDA:
                             OB720C13,TILDA:
                             OB720C14,TILDA:
                             OB720C15,TILDA:
                             OB720C16,TILDA:
                             OB720C17,TILDA:
                             OB720C18,TILDA:
                             OB720C19,TILDA:
                             OB720C20,TILDA:
                             OB720C21,TILDA:
                             OB720C22,TILDA:
                             OB720C23,TILDA:
                             OB720C24
HD729999  RETURN
+
.**************************************************************************
.*                               HD730000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD730000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB730C06,TILDA:
                             OB730C07,TILDA:
                             OB730C08,TILDA:
                             OB730C09,TILDA:
                             OB730C10,TILDA:
                             OB730C11,TILDA:
                             OB730C12,TILDA:
                             OB730C13,TILDA:
                             OB730C14,TILDA:
                             OB730C15,TILDA:
                             OB730C16,TILDA:
                             OB730C17,TILDA:
                             OB730C18,TILDA:
                             OB730C19
HD739999  RETURN
+
.**************************************************************************
.*                               HD740000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD740000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB740C06,TILDA:
                             OB740C07,TILDA:
                             OB740C08,TILDA:
                             OB740C09,TILDA:
                             OB740C10,TILDA:
                             OB740C11,TILDA:
                             OB740C12,TILDA:
                             OB740C13
HD749999  RETURN
+
.**************************************************************************
.*                               HD112000              Called by: PROC0000*
.*  Write object header line                                              *
. *  too long to store ****************************************************
.**************************************************************************
HD112000  WRITE     OBJFILE,SEQ;*+,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB112C06,TILDA:
                             OB112C07,TILDA:
                             OB112C08,TILDA:
                             OB112C09,TILDA:
                             OB112C10,TILDA:
                             OB112C11,TILDA:
                             OB112C12,TILDA:
                             OB112C13,TILDA:
                             OB112C14,TILDA:
                             OB112C15,TILDA:
                             OB112C16,TILDA:
                             OB112C17,TILDA:
                             OB112C18,TILDA:
                             OB112C19,TILDA:
                             OB112C20,TILDA:
                             OB112C21,TILDA:
                             OB112C22,TILDA:
                             OB112C23,TILDA:
                             OB112C24,TILDA:
                             OB112C25,TILDA:
                             OB112C26,TILDA:
                             OB112C27,TILDA:
                             OB112C28,TILDA:
                             OB112C29,TILDA:
                             OB112C30,TILDA:
                             OB112C31,TILDA:
                             OB112C32,TILDA:
                             OB112C33,TILDA:
                             OB112C34,TILDA:
                             OB112C35,TILDA:
                             OB112C36,TILDA:
                             OB112C37,TILDA:
                             OB112C38,TILDA:
                             OB112C39,TILDA:
                             OB112C40,TILDA:
                             OB112C41,TILDA:
                             OB112C42,TILDA:
                             OB112C43,TILDA:
                             OB112C44,TILDA:
                             OB112C45,TILDA:
                             OB112C46,TILDA:
                             OB112C47,TILDA:
                             OB112C48,TILDA:
                             OB112C49,TILDA:
                             OB112C50,TILDA:
                             OB112C51,TILDA:
                             OB112C52,TILDA:
                             OB112C53,TILDA:
                             OB112C54,TILDA:
                             OB112C55,TILDA:
                             OB112C56,TILDA:
                             OB112C57,TILDA:
                             OB112C58,TILDA:
                             OB112C59,TILDA:
                             OB112C60,TILDA:
                             OB112C61
.
HD112999  RETURN
+
.**************************************************************************
.*                               HD114000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD114000  WRITE     OBJFILE,SEQ;*+,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB114C06,TILDA:
                             OB114C07,TILDA:
                             OB114C08,TILDA:
                             OB114C09,TILDA:
                             OB114C10,TILDA:
                             OB114C11,TILDA:
                             OB114C12,TILDA:
                             OB114C13,TILDA:
                             OB114C14,TILDA:
                             OB114C15,TILDA:
                             OB114C16,TILDA:
                             OB114C17,TILDA:
                             OB114C18,TILDA:
                             OB114C19,TILDA:
                             OB114C20,TILDA:
                             OB114C21,TILDA:
                             OB114C22,TILDA:
                             OB114C23,TILDA:
                             OB114C24,TILDA:
                             OB114C25,TILDA:
                             OB114C26,TILDA:
                             OB114C27,TILDA:
                             OB114C28,TILDA:
                             OB114C29,TILDA:
                             OB114C30,TILDA:
                             OB114C31,TILDA:
                             OB114C32,TILDA:
                             OB114C33,TILDA:
                             OB114C34,TILDA:
                             OB114C35,TILDA:
                             OB114C36
.
OB114999  RETURN
+
.**************************************************************************
.*                               HD115000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD115000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB115C06,TILDA:
                             OB115C07,TILDA:
                             OB115C08,TILDA:
                             OB115C09,TILDA:
                             OB115C10,TILDA:
                             OB115C11,TILDA:
                             OB115C12,TILDA:
                             OB115C13,TILDA:
                             OB115C14,TILDA:
                             OB115C15,TILDA:
                             OB115C16,TILDA:
                             OB115C17,TILDA:
                             OB115C18,TILDA:
                             OB115C19,TILDA:
                             OB115C20,TILDA:
                             OB115C21,TILDA:
                             OB115C22,TILDA:
                             OB115C23,TILDA:
                             OB115C24
HD115999  RETURN
+
.**************************************************************************
.*                               HD130000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD130000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB130C06,TILDA:
                             OB130C07,TILDA:
                             OB130C08,TILDA:
                             OB130C09,TILDA:
                             OB130C10,TILDA:
                             OB130C11,TILDA:
                             OB130C12,TILDA:
                             OB130C13,TILDA:
                             OB130C14
HD130999  RETURN
+
.**************************************************************************
.*                               HD131000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD131000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB131C06,TILDA:
                             OB131C07,TILDA:
                             OB131C08,TILDA:
                             OB131C09,TILDA:
                             OB131C10,TILDA:
                             OB131C11,TILDA:
                             OB131C12,TILDA:
                             OB131C13,TILDA:
                             OB131C14,TILDA:
                             OB131C15
HD131999  RETURN
+
.**************************************************************************
.*                               HD133000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD133000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB133C06,TILDA:
                             OB133C07,TILDA:
                             OB133C08,TILDA:
                             OB133C09,TILDA:
                             OB133C10,TILDA:
                             OB133C11,TILDA:
                             OB133C12,TILDA:
                             OB133C13,TILDA:
                             OB133C14,TILDA:
                             OB133C15,TILDA:
                             OB133C16
HD133999  RETURN
+
.**************************************************************************
.*                               HD134000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD134000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB134C06,TILDA:
                             OB134C07,TILDA:
                             OB134C08,TILDA:
                             OB134C09,TILDA:
                             OB134C10,TILDA:
                             OB134C11,TILDA:
                             OB134C12,TILDA:
                             OB134C13,TILDA:
                             OB134C14,TILDA:
                             OB134C15,TILDA:
                             OB134C16,TILDA:
                             OB134C17,TILDA:
                             OB134C18,TILDA:
                             OB134C19,TILDA:
                             OB134C20,TILDA:
                             OB134C21
HD134999  RETURN
+
.**************************************************************************
.*                               HD135000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD135000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB135C06,TILDA:
                             OB135C07,TILDA:
                             OB135C08,TILDA:
                             OB135C09,TILDA:
                             OB135C10,TILDA:
                             OB135C11,TILDA:
                             OB135C12,TILDA:
                             OB135C13
HD135999  RETURN
+
.**************************************************************************
.*                               HD136000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD136000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB136C06,TILDA:
                             OB136C07,TILDA:
                             OB136C08,TILDA:
                             OB136C09,TILDA:
                             OB136C10,TILDA:
                             OB136C11,TILDA:
                             OB136C12,TILDA:
                             OB136C13,TILDA:
                             OB136C14
HD136999  RETURN
+
.**************************************************************************
.*                               HD137000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD137000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB137C06,TILDA:
                             OB137C07,TILDA:
                             OB137C08,TILDA:
                             OB137C09,TILDA:
                             OB137C10,TILDA:
                             OB137C11,TILDA:
                             OB137C12,TILDA:
                             OB137C13
HD137999  RETURN
+
.**************************************************************************
.*                               HD141000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD141000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB141C06,TILDA:
                             OB141C07,TILDA:
                             OB141C08,TILDA:
                             OB141C09,TILDA:
                             OB141C10,TILDA:
                             OB141C11,TILDA:
                             OB141C12,TILDA:
                             OB141C13,TILDA:
                             OB141C14,TILDA:
                             OB141C15,TILDA:
                             OB141C16,TILDA:
                             OB141C17
HD141999  RETURN
+
.**************************************************************************
.*                               HD142000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD142000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB142C06,TILDA:
                             OB142C07,TILDA:
                             OB142C08,TILDA:
                             OB142C09,TILDA:
                             OB142C10,TILDA:
                             OB142C11,TILDA:
                             OB142C12,TILDA:
                             OB142C13,TILDA:
                             OB142C14,TILDA:
                             OB142C15
HD142999  RETURN
+
.**************************************************************************
.*                               HD142A00              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD142A00  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB142A06,TILDA:
                             OB142A07,TILDA:
                             OB142A08,TILDA:
                             OB142A09,TILDA:
                             OB142A10,TILDA:
                             OB142A11,TILDA:
                             OB142A12,TILDA:
                             OB142A13,TILDA:
                             OB142A14,TILDA:
                             OB142A15,TILDA:
                             OB142A16,TILDA:
                             OB142A17,TILDA:
                             OB142A18,TILDA:
                             OB142A19
HD142A99  RETURN
+
.**************************************************************************
.*                               HD143000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD143000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB143C06,TILDA:
                             OB143C07,TILDA:
                             OB143C08,TILDA:
                             OB143C09,TILDA:
                             OB143C10,TILDA:
                             OB143C11,TILDA:
                             OB143C12,TILDA:
                             OB143C13,TILDA:
                             OB143C14,TILDA:
                             OB143C15,TILDA:
                             OB143C16,TILDA:
                             OB143C17
HD143999  RETURN
+
.**************************************************************************
.*                               HD143000              Called by: PROC0000*
.*  Write object header line                                              *
.**************************************************************************
HD145000  PACK      OBJECTKY,SP70
          PACK      OBJECTTX,COMCOL1,TILDA:
                             COMCOL2,TILDA:
                             COMCOL3,TILDA:
                             COMCOL4,TILDA:
                             COMCOL5,TILDA:
                             OB145C06,TILDA:
                             OB145C07,TILDA:
                             OB145C08,TILDA:
                             OB145C09,TILDA:
                             OB145C10,TILDA:
                             OB145C11,TILDA:
                             OB145C12,TILDA:
                             OB145C13,TILDA:
                             OB145C14,TILDA:
                             OB145C15,TILDA:
                             OB145C16,TILDA:
                             OB145C17,TILDA:
                             OB145C18,TILDA:
                             OB145C19,TILDA:
                             OB145C20,TILDA:
                             OB145C21,TILDA:
                             OB145C22,TILDA:
                             OB145C23,TILDA:
                             OB145C24,TILDA:
                             OB145C25,TILDA:
                             OB145C26,TILDA:
                             OB145C27,TILDA:
                             OB145C28,TILDA:
                             OB145C29,TILDA:
                             OB145C30
HD145999  RETURN
+
.**************************************************************************
.*                               WRTC0000              Called by: PROC0000*
.*  Write Container header information record                             *
.**************************************************************************
.
WRTC0000  PACK      CMEDDSTR,CONTSTRM,SP70
          PACK      CMEDCNTN,CONTNUMB,SP70
          PACK      CMEDSDAT,STRTDATE
          PACK      CMEDEDAT,ENDDATE
.
          PACK      CMEDCUID,WBSEUID,SP70
          CALL      IBACLOCK
          PACK      CMEDCDAT,CCC,CYY,CMM,CDD
          REP       " 0",CMEDCDAT
          CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,CMEDCTIM
.
          PACK      CMEDRDAT,SP70
          PACK      CMEDRTIM,SP70
          PACK      CMEDRUID,SP70
          PACK      CMEDSNTD,SP70
          PACK      CMEDSNTT,SP70
          PACK      CMEDSUID,SP70
          PACK      CMEDRSND,SP70
          PACK      CMEDRSNT,SP70

          PACK      CMEDRSUI,SP70
.
          PACK      KEY11,CMEDDSTR,CMEDCNTN,SP70
          CALL      RACMEDW1
          IF        OVRCD=1
            CALL      WRCMEDW1
          ENDIF
.
WRTC9999  RETURN
+
.**************************************************************************
.*                               WRCOND00              Called by: PROC0000*
.*  Write Container detail record                                         *
.**************************************************************************
.
WRCOND00  PACK      CMEWDSTR,CONTSTRM,SP70
          PACK      CMEWCNTN,CONTNUMB,SP70
          PACK      CMEWOBJT,OBJECTTY,SP70
          PACK      CMEWOKEY,OBJECTKY,SP70
          PACK      CMEWTEXT,OBJECTTX,SP256,SP256,SP256,SP256
          PACK      CMEWRTYP,OBJECTRT
          PACK      CMEWSDAT,STRTDATE
.
          MATCH     SP1,SRCRDATE
          IF        @EQUAL
            PACK      SRCRDATE,ENDDATE
            MOVE      "23:59:00",SRCRTIME
          ENDIF
.
          MATCH     ANSD,OBJECTRT             * delete ?
          IF        !@EQUAL
            PROC      CHKFIRST                * has record been sent before
          ENDIF
.
          MATCH     SP1,SRMDDATE
          IF        @EQUAL
            PACK      SRMDDATE,ENDDATE
            MOVE      "23:59:00",SRMDTIME
          ENDIF
.
. Retain the source modifed time of 00:00:00 if the source created
. time is 00:00:00 (Add records)
.
          MATCH     "00:00:00",SRMDTIME
          IF        @EQUAL
            MATCH     "00:00:00",SRCRTIME
            IF        !@EQUAL
              MOVE      "23:59:00",SRMDTIME
            ENDIF
          ENDIF
.
          MATCH     ANSD,OBJECTRT             * delete ?
          IF        @EQUAL
            PACK      CMEWMDDT,SRMDDATE,SP70  * deletes need to keep source
            PACK      CMEWMDTM,SRMDTIME,SP70  * created date/time
          ELSE
            PACK      CMEWSCDT,SRCRDATE,SP70
            PACK      CMEWSCTM,SRCRTIME,SP70
            PACK      CMEWMDDT,SRMDDATE,SP70
            PACK      CMEWMDTM,SRMDTIME,SP70
          ENDIF
.
          PACK      KEY104,CMEWDSTR,CMEWCNTN,CMEWOBJT,CMEWOKEY,SP70
          CALL      RACMEWD1
          IF        OVRCD=1
            CALL      WRCMEWD1
          ELSE
            IF        NOUPDATE<>1
              CALL      UPCMEWD1
            ENDIF
          ENDIF
          MOVE      SP70,OBJECTRT
          PACK      SRCRDATE,ENDDATE
          MOVE      "23:59:00",SRCRTIME
          PACK      SRMDDATE,ENDDATE
          MOVE      "23:59:00",SRMDTIME
          SQUEEZE   OBJECTRT
          MOVE      ZERO,NOUPDATE
.
WRCOND99  RETURN
+
.*****************************************************************************
.*  CHKFIRST
.*  Check if this object and key has been sent before. If not it must be
.*  an add record. So set the source modified date/time to the source
.*  created date/time
.*****************************************************************************
          DEFPROC   CHKFIRST
.
          INC       COMEWDFD/INC
.
SAVEDSTR  DIM       3       * Data Stream
SAVEOBJT  DIM       3       * Object Type
SAVEOKEY  DIM       90      * Key
.
          OPEN      COMEWDA2,"comewdaf"
.
          PACK      SAVEDSTR,CONTSTRM,SP70
          PACK      SAVEOBJT,OBJECTTY,SP70
          PACK      SAVEOKEY,OBJECTKY,SP70
.
          PACK      KEY112,SAVEDSTR,SAVEOBJT,SAVEOKEY,SP70
          CALL      RSCMEWD2
CHKFIR10  CALL      RKCMEWD2
          BRANCH    OVRCD,CHKFIR90
.
          MATCH     SAVEDSTR,CMEWDSTR       * Stream
          GOTO      CHKFIR90 IF NOT EQUAL
.
          MATCH     SAVEOBJT,CMEWOBJT       * Object type
          GOTO      CHKFIR90 IF NOT EQUAL
.
          MATCH     SAVEOKEY,CMEWOKEY       * Object Key
          GOTO      CHKFIR90 IF NOT EQUAL
.
          MOVE      CMEWCNTN,F8             * Ignore current containers records
          COMPARE   CONTNUMB,F8
          GOTO      CHKFIR10 IF EQUAL
.
          MATCH     ANSY,RERUNFL            * Ignore curreat date range
          IF        @EQUAL
            MOVE      CMEWCNTN,F8           * Include current extract records
            IF        CONTNUMB <> F8
              MATCH     STRTDATE,CMEWSCDT
              GOTO      CHKFIR10 IF NOT LESS
            ENDIF
          ENDIF
          GOTO      CHKFIR99
.
. This record has not been sent before so set the source modified date/time
. to the source created date/time
.
CHKFIR90  MOVE      SRCRDATE,SRMDDATE       * source modified date
          MOVE      SRCRTIME,SRMDTIME       * source created time
.
          GOTO      CHKFIR99
.
          INC       COMEWDIO/INC
          INC       IBAOVRIO/INC
.
CHKFIR99  CLOSE     COMEWDA2
.
          ENDPROC
+
.**************************************************************************
.*                               CONF0000              Called by: PROC0000*
.*  Create csv file containing object attribute lines                    *
.**************************************************************************
CONF0000  MOVE      ONE,HEADCOUN
          MOVE      ONE,F3
          PACK      KEY14,CONTSTRM,CONTNUMB,SP70
          CALL      RSCMEDF1
CONF0100  CALL      RKCMEDF1
          BRANCH    OVRCD,CONF0500
.
          MATCH     CONTSTRM,CMEFDSTR
          GOTO      CONF0500 IF NOT EQUAL
.
          MOVE      CONTNUMB,DIM8
          MATCH     DIM8,CMEFCNTN
          GOTO      CONF0500 IF NOT EQUAL
.
          ADD       TWO,F3  * each object will have two lines in header
          GOTO      CONF0100
.
CONF0500  MOVE      F3,HEADCOUN
          UNPACK    STRTDATE,CCENT,CYEAR,CMON,CDAY
          PACK      FILENAME,PTCNNSSI,UNDLN1,CONTSTRM,UNDLN1,CONTNUMB,UNDLN1,ZERO,ZERO,UNDLN1,CCENT,CYEAR,DASH,CMON,DASH,CDAY,TILDA,CONTTIME,CSV
          SQUEEZE   FILENAME
. 
          PACK      D3,CONTSTRM
          SQUEEZE   D3
          STRIP     D3
          SQUEEZE   HEADCOUN
          PREP      HEADFILE,FILENAME
          MOVE      "00",OBJTYPE
          CALL      WRCNF000   * Write to container files tables
.
          UNPACK    CMEDSDAT,CCENT,CYEAR,CMON,CDAY
          UNPACK    CMEDEDAT,CCENTE,CYEARE,CMONE,CDAYE
          UNPACK    CURDATE,CCENTC,CYEARC,CMONC,CDAYC
          WRITE     HEADFILE,SEQ;*+,CONTHEAD,TILDA,PTCNNIAI,TILDA,PTCNNSSI:
                                   TILDA,D3,TILDA,CONTNUMB,TILDA:
                                   CCENT,CYEAR,DASH,CMON,DASH,CDAY:
                                   SP1,TIME000:
                                   TILDA,CCENTE,CYEARE,DASH,CMONE,DASH,CDAYE:
                                   SP1,TIME059:
                                   TILDA,CCENTC,CYEARC,DASH,CMONC,DASH,CDAYC:
                                   SP1,CURTIME,TILDA,HEADCOUN,TILDA:
                                   ANSY,TILDA,QUOTTILD
.
          PACK      KEY14,CONTSTRM,CONTNUMB,SP70
          CALL      RSCMEDF1
CONF1000  CALL      RKCMEDF1
          BRANCH    OVRCD,CONF9000
.
          MATCH     CONTSTRM,CMEFDSTR
          GOTO      CONF9000 IF NOT EQUAL
.
          MOVE      CONTNUMB,DIM8
          MATCH     DIM8,CMEFCNTN
          GOTO      CONF9000 IF NOT EQUAL
.
          MATCH     "00",CMEFOBJT
          GOTO      CONF1000 IF EQUAL
.
          STRIP     CMEFOBJT
          STRIP     CMEFFNAM
          SQUEEZE   CMEFCNTR
          STRIP     CMEFCNTR
          STRIP     CMEFFNAM
          STRIP     CMEFMD5C
.
.  ** call us1 script for this file
.
CONF8000  CLEAR     CMDLINE
          APPEND    "ibapms40.us1 ",CMDLINE
          PACK      STRNGINP,CMEFFNAM,SP70
          CALL      URLENC00     * escape ' in filename
          PACK      FILEENAM,STRNGOUT,SP70
          SQUEEZE   FILEENAM
          APPEND    FILEENAM,CMDLINE          * Report .txt file
          APPEND    ".txt ",CMDLINE
          APPEND    SP70,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          PACK      SAVFNAM,FILENAME
...  *** recalculate the md5 checksum in case the us1 script changed it
          PACK      FILENAME,CMEFFNAM,SP70
          SQUEEZE   FILENAME
          CALL      GETMD500   * Calculate MD5 checksum
          PACK      CMEFMD5C,CHKSUM,SP70
          CALL      UPCMEDF1
          PACK      FILENAME,SAVFNAM
.
          SQUEEZE   CMEFMD5C
          REP       "~ ",CMEFFNAM
          WRITE     HEADFILE,SEQ;*+,OBJHEAD,TILDA:
                                   CMEFOBJT,TILDA,CMEFFNAM,DTXT:
                                   TILDA,CMEFCNTR,TILDA,CMEFMD5C
.
          WRITE     HEADFILE,SEQ;*+,OBJATTR,TILDA:
                                   CMEFOBJT,TILDA:
                                   ONE,TILDA:
                                   CMEFCNTR
.
          GOTO      CONF1000
.
CONF9000  
.  ** call us1 script for this csv 
          CLEAR     CMDLINE
          APPEND    "ibapms40.us1 ",CMDLINE
.....     APPEND    FILENAME,CMDLINE          * Report .txt file
          PACK      STRNGINP,FILENAME,SP70
          CALL      URLENC00     * escape ' in filename
          PACK      FILEENAM,STRNGOUT,SP70
          SQUEEZE   FILEENAM
          APPEND    FILEENAM,CMDLINE          * Report .txt file
          APPEND    SP70,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
CONF9999  RETURN
+
.**************************************************************************
.*                               OBJA0000              Called by: PROC0000*
.*  Create text file containing object attribute lines                    *
.**************************************************************************
OBJA0000  MOVE      SP70,OBJTYPE    * create one file for each object in 
          MOVE      ZERO,COUNTER    * this container
.
. *   Loop comewdaf for this stream/container
.
          PACK      KEY104,CONTSTRM,CONTNUMB,SP70,SP70
          CALL      RSCMEWD1
OBJA1000  CALL      RKCMEWD1
          BRANCH    OVRCD,OBJA9999
.
          MATCH     CONTSTRM,CMEWDSTR
          GOTO      OBJA9999 IF NOT EQUAL
.
          MOVE      CONTNUMB,DIM8
          MATCH     DIM8,CMEWCNTN
          GOTO      OBJA9999 IF NOT EQUAL
.
          MATCH     OBJTYPE,CMEWOBJT
          IF        !@EQUAL
            MATCH     SP70,OBJTYPE    * update current object counter
            IF        !@EQUAL
              PACK      KEY14,CONTSTRM,CONTNUMB,OBJTYPE,SP70
              CALL      RDCMEDF1
              IF        OVRCD=0
                PACK      FILENAME,CMEFFNAM,SP70
                SQUEEZE   FILENAME
                CALL      GETMD500   * Calculate MD5 checksum
                PACK      CMEFMD5C,CHKSUM,SP70
                MOVE      COUNTER,CMEFCNTR
                CALL      UPCMEDF1
              ENDIF
            ENDIF
.
. *   Build textfile for this object
.
            MOVE      ZERO,COUNTER
            MOVE      CMEWOBJT,OBJTYPE
            UNPACK    CMEWSDAT,CCENT,CYEAR,CMON,CDAY
            PACK      FILENAME,PTCNNSSI,UNDLN1,CONTSTRM,UNDLN1,CONTNUMB,UNDLN1,OBJTYPE,UNDLN1,CCENT,CYEAR,DASH,CMON,DASH,CDAY,TILDA,CONTTIME
            SQUEEZE   FILENAME
            PREP      OBJFILE,FILENAME
            CALL      WRCNF000   * Write to container files tables
          ENDIF
.
. * ignore blank records
          MATCH     SP70,CMEWTEXT
          GOTO      OBJA1000 IF EQUAL
.
          STRIP     CMEWTEXT
          STRIP     CMEWRTYP
.
          UNPACK    CURDATE,CCENTC,CYEARC,CMONC,CDAYC
.
. **** header record has a key of spaces, dont use filename or add to count
          MATCH     SP70,CMEWOKEY
          GOTO      OBJA2000 IF NOT EQUAL * not a header row
.
          MATCH     "17",CMEWDSTR
          IF        @EQUAL
            MATCH     "112",CMEWOBJT
            IF        @EQUAL
              CALL      HD112000   * line too long to store
              GOTO      OBJA1000
            ENDIF
            MATCH     "114",CMEWOBJT
            IF        @EQUAL
              CALL      HD114000   * line too long to store
              GOTO      OBJA1000
            ENDIF
          ENDIF
          WRITE     OBJFILE,SEQ;*+,CMEWTEXT
          GOTO      OBJA1000
.
OBJA2000  UNPACK    CMEWSCDT,CCENTC,CYEARC,CMONC,CDAYC
          PACK      KEY20,SP70
          MATCH     SP70,CMEWMDDT
          IF        !@EQUAL
            UNPACK    CMEWMDDT,CCENT,CYEAR,CMON,CDAY
            PACK      KEY20,CCENT,CYEAR,DASH,CMON,DASH,CDAY,SP1,CMEWMDTM,SP70
          ENDIF
          STRIP     KEY20
          WRITE     OBJFILE,SEQ;*+,PTCNNSSI,TILDA,CONTNUMB,TILDA:
                                   CCENTC,CYEARC,DASH,CMONC,DASH,CDAYC:
                                   SP1,CMEWSCTM,TILDA,KEY20,TILDA:
                                   CMEWRTYP,TILDA,CMEWTEXT
          ADD       ONE,COUNTER
.
          GOTO      OBJA1000
.
OBJA9999  PACK      KEY14,CONTSTRM,CONTNUMB,OBJTYPE,SP70
          CALL      RDCMEDF1
          IF        OVRCD=0
            PACK      FILENAME,CMEFFNAM,SP70
            SQUEEZE   FILENAME
            CALL      GETMD500   * Calculate MD5 checksum
            PACK      CMEFMD5C,CHKSUM,SP70
            MOVE      COUNTER,CMEFCNTR
            CALL      UPCMEDF1
          ENDIF
.
          RETURN 
+
.**************************************************************************
.*                               GETMD500              Called by: OBJA0000*
.*  Calculate MD5 Checksum for this text file                             *
.**************************************************************************
GETMD500  CLEAR     CMDLINE
          PACK      STRNGINP,FILENAME,SP70
          CALL      URLENC00     * escape ' in filename
          PACK      FILEENAM,STRNGOUT,SP70
          SQUEEZE   FILEENAM
          APPEND    "md5sum ",CMDLINE
          APPEND    FILEENAM,CMDLINE
          APPEND    ".txt > ",CMDLINE
          PACK      D8,CONTNUMB
          SQUEEZE   D8
          PACK      CHKMD5FL,CONTSTRM,D8
          SQUEEZE   CHKMD5FL
          APPEND    CHKMD5FL,CMDLINE
          APPEND    ".txt",CMDLINE
          APPEND    SP70,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CHECKMD5,CHKMD5FL
          TRAPCLR   IO
          BRANCH    OVRCD,GETMD599
.
          MOVE      SP256,CHKSUM
          READ      CHECKMD5,SEQ;CHKSUM
.
          SCAN      SP1,CHKSUM              * Locate the first blank
          GOTO      GETMD590 IF NOT EQUAL
.
          BUMP      CHKSUM,-1              * go back 1 to end of name
          MOVEFPTR  CHKSUM,F3              * another handly form field
          RESET     CHKSUM                 * reset the form pointer
          SETLPTR   CHKSUM,F3              * set logical length to end of name
.
GETMD590  CLOSE     CHECKMD5,DELETE
.
GETMD599  RETURN
+
.**************************************************************************
.*                               WRCNF000              Called by: OBJA0000*
.*  Write Container file names  record                                    *
.**************************************************************************
.
WRCNF000  MOVE      ZERO,F3
          PACK      KEY14,CONTSTRM,CONTNUMB,OBJTYPE,SP70
          CALL      RDCMEDF1
          BRANCH    OVRCD,WRCNF100
          GOTO      WRCNF999
.
WRCNF100  PACK      CMEFDSTR,CONTSTRM,SP70
          PACK      CMEFCNTN,CONTNUMB,SP70
          PACK      CMEFOBJT,OBJTYPE,SP70
          PACK      CMEFFNAM,FILENAME,SP70
          PACK      CMEFMD5C,CHKSUM,SP70
          PACK      CMEFCNTR,SP70
.
          PACK      KEY14,CMEFDSTR,CMEFCNTN,CMEFOBJT,SP70
          CALL      RACMEDF1
          IF        OVRCD=1
            CALL      WRCMEDF1
          ENDIF
.
WRCNF999  RETURN
+
.**************************************************************************
. FMTD0000 - Format a date from CCYYMMDD to CCYY-MM-DD
. Input   - DATFIELD - CCYYMMDD
. Returns - FORMATDT - CCYY-MM-DD 
.**************************************************************************
FMTD0000  MOVE      SP70,FORMATDT            * Clear date field
.
          MATCH     SP70,DATFIELD            * No date field provided
          GOTO      FMTD9999 IF EQUAL
.
          UNPACK    DATFIELD,CCENT,CYEAR,CMON,CDAY              * CCYYMMDD
          PACK      FORMATDT,CCENT,CYEAR,DASH,CMON,DASH,CDAY    * CCYY-MM-DD
.
FMTD9999  RETURN
+
.*****************************************************************************
.*                            ASEC0000                                       *
.*               Add one second to date/time                                 *
.* Requires: XDATTIME - Date/time value (ccyymmddhhmmss)                     *
.* Returns : XDATTIME - Date/time value (ccyymmddhhmmss) incremented by 1 sec*
.*****************************************************************************
ASEC0000  UNPACK    XDATTIME,DIM8,HOURTM,MINTIME,SECTIME
          MATCH     "59",SECTIME
          IF        !@EQUAL
            MOVE      SECTIME,FORM2              * just increment seconds
            ADD       ONE,FORM2
            MOVE      FORM2,SECTIME
            REP       " 0",SECTIME
            PACK      XDATTIME,DIM8,HOURTM,MINTIME,SECTIME
            GOTO      ASEC9999
          ENDIF
.
.         The seconds were "59", so reset these to "00" and increment the
.         minutes
.
          MOVE      "00",SECTIME
          MATCH     "59",MINTIME
          IF        !@EQUAL
            MOVE      MINTIME,FORM2              * just increment minutes
            ADD       ONE,FORM2
            MOVE      FORM2,MINTIME
            REP       " 0",MINTIME
            PACK      XDATTIME,DIM8,HOURTM,MINTIME,SECTIME
            GOTO      ASEC9999
          ENDIF
.
.         The minutes were "59", so reset these to "00" and increment the
.         hours
.
          MOVE      "00",SECTIME
          MOVE      "00",MINTIME
          MATCH     "23",HOURTM
          IF        !@EQUAL
            MOVE      HOURTM,FORM2              * just increment hours
            ADD       ONE,FORM2
            MOVE      FORM2,HOURTM
            REP       " 0",HOURTM
            PACK      XDATTIME,DIM8,HOURTM,MINTIME,SECTIME
            GOTO      ASEC9999
          ENDIF
.
.         The hours were "59", so reset these to "00" and increment the
.         date
.
          MOVE      "00",SECTIME
          MOVE      "00",MINTIME
          MOVE      "00",HOURTM
.
.         We need to increment the date by 1 day
.
          UNPACK    DIM8,CCENT,CYEAR,CMON,CDAY
          MOVE      CCENT,CC
          MOVE      CYEAR,YY
          MOVE      CMON,MM
          MOVE      CDAY,DD
          CALL      DMYCON                       * get julian day
          ADD       ONE,JULDAY                   * increment julian day
          MOVE      JULDAY,JWKDAY
          MOVE      JULYR,JWKYER
          MOVE      JULCC,JWKCC
          CALL      JULCON                       * get new date
          PACK      XDATTIME,CC,YY,MM,DD,ZERO6
          REP       " 0",XDATTIME
.
ASEC9999  RETURN
.
.------------------------------------------------------------
.*** format the fileame by changing any ' to \'
.------------------------------------------------------------
URLENC00  CLEAR     STRNGOUT
          RESET     CURRCHAR
          MOVE      ZERO,STRNGLEN
.
          MOVE      ONE,POSITION
          MOVELPTR  STRNGINP,STRNGLEN
.
URLENC10  CMOVE     STRNGINP,CURRCHAR
          CMATCH    "'",CURRCHAR
          IF        @EQUAL
            APPEND    "\'",STRNGOUT
          ELSE
            APPEND    CURRCHAR,STRNGOUT
          ENDIF
.
          BUMP      STRNGINP
          ADD       ONE,POSITION
.
          IF        (POSITION > STRNGLEN)
            GOTO      URLENC90
          ENDIF
.
          GOTO      URLENC10
.
URLENC90  RESET     STRNGOUT
.
URLENC99  RETURN
+
.******************************************************************************
.* EDDK0000 - Send delete records for object and key
.*            Set source modifield date prior to calling this routine
.******************************************************************************
EDDK0000  STRIP     DELETKEY
.
          PACK      KEY112,DELETSTM,DELETOBJ,DELETKEY,SP70
          CALL      RSCMEWD2
EDDK1000  CALL      RKCMEWD2
          BRANCH    OVRCD,EDDK9999
.
          MATCH     DELETSTM,CMEWDSTR            * Stream
          GOTO      EDDK9999 IF NOT EQUAL
.
          MATCH     DELETOBJ,CMEWOBJT            * Correct Object
          GOTO      EDDK9999 IF NOT EQUAL
.
          MATCH     DELETKEY,CMEWOKEY            * Only match to length of
          GOTO      EDDK9999 IF NOT EQUAL        * DELETKEY after strip
.
          MATCH     "D",CMEWRTYP                 * Skip deletes
          GOTO      EDDK1000 IF EQUAL
.
          MOVE      CMEWOBJT,OBJECTTY            * Object
          PACK      OBJECTKY,CMEWOKEY,SP70       * Key
          PACK      OBJECTTX,CMEWTEXT,SP900      * Text
.
          MOVE      ANSD,OBJECTRT
          PACK      SRCRDATE,CMEWSCDT,SP70
          PACK      SRCRTIME,CMEWSCTM,SP70
          MOVE      SRMDDATE,SAVMDATE
          MOVE      SRMDTIME,SAVMTIME
.
          CALL      WRCOND00     * write record to container detail table
          MOVE      SAVMDATE,SRMDDATE
          MOVE      SAVMTIME,SRMDTIME
.
          GOTO      EDDK1000
.
EDDK9999  MOVE      SP70,OBJECTRT
          RETURN
+
.******************************************************************************
.* CSOF0000 - Change sent stream object field
.* Requires: CHANGSTM  * Stream
.*           CHANGOBJ  * Object
.*           CHANGCOL  * Change column number
.*           CHANGOVL  * Change old value        (Used for edit)
.*           CHANGNVL  * Change new value
.*           CHANGKEY  * Change Key
.*           CHANGPRM  * Change Primary Key (Delete record and send new)
.******************************************************************************
CSOF0000  STRIP     CHANGKEY
          SQUEEZE   CHANGOVL
          STRIP     CHANGNVL
.
          SUB       SIX,CHANGCOL
.
          PACK      KEY112,CHANGSTM,CHANGOBJ,CHANGKEY,SP70
          CALL      RSCMEWD2
CSOF1000  CALL      RKCMEWD2                     * Loop sent objects
          BRANCH    OVRCD,CSOF9999
.
          MATCH     CHANGSTM,CMEWDSTR            * Stream
          GOTO      CSOF9999 IF NOT EQUAL
.
          MATCH     CHANGOBJ,CMEWOBJT            * Correct Object
          GOTO      CSOF9999 IF NOT EQUAL
.
          MATCH     CHANGKEY,CMEWOKEY            * Only match to length of
          GOTO      CSOF9999 IF NOT EQUAL        * DELETKEY after strip
.
          MATCH     ANSY,RERUNFL            * Ignore curreat date range
          IF        @EQUAL
            MOVE      CMEWCNTN,F8           * Include current extract records
            IF        CONTNUMB <> F8
              MATCH     STRTDATE,CMEWSDAT
              GOTO      CSOF1000 IF NOT LESS
              MOVE      ONE,NOUPDATE        * Don't update new record written
            ENDIF
          ENDIF
.
          MATCH     SP70,CHANGPRM                * Change in primary key
          IF        !@EQUAL
            MOVE      CMEWRTYP,KEY1                * save record type
            MOVE      CMEWOBJT,OBJECTTY            * Object
            PACK      OBJECTKY,CMEWOKEY,SP70       * Key
            PACK      OBJECTTX,CMEWTEXT,SP900      * Text
            PACK      SRCRDATE,CMEWSCDT,SP70
            PACK      SRCRTIME,CMEWSCTM,SP70
            MOVE      SRMDDATE,SAVMDATE
            MOVE      SRMDTIME,SAVMTIME
            MOVE      ANSD,OBJECTRT
            CALL      WRCOND00     * write record to container detail table
            MOVE      KEY1,CMEWRTYP                * restore record type
            MOVE      SAVMDATE,SRMDDATE
            MOVE      SAVMTIME,SRMDTIME
          ENDIF
.
          PACK      CHANGTXT,SP900               * Clear new object text
          MOVE      ZERO,F2                      * Column counter
          CLEAR     CHANGTXT
          MOVE      SP70,D1
          CLEAR     CHANGAAA
.
CSOF2000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check char and count for ~
          GOTO      CSOF4000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            ADD       ONE,F2                     * Count ~ to find column
          ENDIF
.
          APPEND    D1,CHANGTXT                  * Append to new object text
.
          COMPARE   F2,CHANGCOL                  * Append to new text until
          GOTO      CSOF2000 IF NOT EQUAL        * change column found
.
CSOF4000  COMPARE   CHANGCOL,F2                  * Colum not found
          GOTO      CSOF1000 IF NOT EQUAL
.
          APPEND    CHANGNVL,CHANGTXT            * Append new value to column
.
CSOF5000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check and count for ~
          GOTO      CSOF6000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            APPEND    D1,CHANGTXT                  * Append to new object text
          ELSE
            APPEND    D1,CHANGAAA                * Save old column value
            GOTO      CSOF5000
          ENDIF
.
CSOF6000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check and count for ~
          GOTO      CSOF7000 IF EOS
.
          APPEND    D1,CHANGTXT                  * Append remaing text to
          GOTO      CSOF6000                     * new to new object text
.
CSOF7000  RESET     CHANGAAA
          PACK      CHANGAAA,CHANGAAA,SP70,SP70
          PACK      CHANGOVL,CHANGOVL,SP70,SP70
          MATCH     CHANGOVL,CHANGAAA            * Exit as old column value
          GOTO      CSOF1000 IF NOT EQUAL        * did't match
.
          RESET     CHANGTXT
.
          MATCH     "D",CMEWRTYP                 * delete record
          IF        @EQUAL
            MOVE      ANSD,OBJECTRT
          ENDIF
.
          MOVE      CMEWOBJT,OBJECTTY            * Object
.
          MATCH     SP70,CHANGPRM                * Change in primary key
          IF        !@EQUAL
            PACK      OBJECTKY,CHANGPRM,SP70     * New Primary Key
          ELSE
            PACK      OBJECTKY,CMEWOKEY,SP70     * Key
          ENDIF
          PACK      OBJECTTX,CHANGTXT,SP900      * Text
.
          PACK      SRCRDATE,CMEWSCDT,SP70
          PACK      SRCRTIME,CMEWSCTM,SP70
          MOVE      OBJECTRT,SAVOBJRT
          MOVE      SRMDDATE,SAVMDATE
          MOVE      SRMDTIME,SAVMTIME
          CALL      WRCOND00     * write record to container detail table
          MOVE      SAVOBJRT,OBJECTRT
          MOVE      SAVMDATE,SRMDDATE
          MOVE      SAVMTIME,SRMDTIME
.
          GOTO      CSOF1000
.
CSOF9999  MOVE      SP70,OBJECTRT
          RETURN
.
.******************************************************************************
.* LSOF0000 - Change last sent stream object field for one record only
.* Requires: CHANGSTM  * Stream
.*           CHANGOBJ  * Object
.*           CHANGCOL  * Change column number
.*           CHANGOVL  * Change old value        (Used for edit)
.*           CHANGNVL  * Change new value
.*           CHANGKEY  * Change Key
.*           CHANGPRM  * Change Primary Key (Delete record and send new)
.******************************************************************************
LSOF0000  STRIP     CHANGKEY
          SQUEEZE   CHANGOVL
          STRIP     CHANGNVL
.
          SUB       SIX,CHANGCOL
.
          PACK      KEY112,CHANGSTM,CHANGOBJ,CHANGKEY,Z70
          CALL      RSCMEWD2
LSOF1000  CALL      RPCMEWD2                     * Loop sent objects
          BRANCH    OVRCD,LSOF9999
.
          MATCH     CHANGSTM,CMEWDSTR            * Stream
          GOTO      LSOF9999 IF NOT EQUAL
.
          MATCH     CHANGOBJ,CMEWOBJT            * Correct Object
          GOTO      LSOF9999 IF NOT EQUAL
.
          MATCH     CHANGKEY,CMEWOKEY            * Only match to length of
          GOTO      LSOF9999 IF NOT EQUAL        * DELETKEY after strip
.
          MATCH     ANSD,CMEWRTYP * 0885290      * Don't end deleted record
          GOTO      LSOF1000 IF EQUAL
.
          MATCH     ANSY,RERUNFL            * Ignore curreat date range
          IF        @EQUAL
            MOVE      CMEWCNTN,F8           * Include current extract records
            IF        CONTNUMB <> F8
              MATCH     STRTDATE,CMEWSDAT
              GOTO      LSOF1000 IF NOT LESS
              MOVE      ONE,NOUPDATE        * Don't update new record written
            ENDIF
          ENDIF
.
          MATCH     SP70,CHANGPRM                * Change in primary key
          IF        !@EQUAL
            MOVE      CMEWRTYP,KEY1                * save record type
            MOVE      CMEWOBJT,OBJECTTY            * Object
            PACK      OBJECTKY,CMEWOKEY,SP70       * Key
            PACK      OBJECTTX,CMEWTEXT,SP900      * Text
            PACK      SRCRDATE,CMEWSCDT,SP70
            PACK      SRCRTIME,CMEWSCTM,SP70
            MOVE      SRMDDATE,SAVMDATE
            MOVE      SRMDTIME,SAVMTIME
            MOVE      ANSD,OBJECTRT
            CALL      WRCOND00     * write record to container detail table
            MOVE      KEY1,CMEWRTYP                * restore record type
            MOVE      SAVMDATE,SRMDDATE
            MOVE      SAVMTIME,SRMDTIME
          ENDIF
.
          PACK      CHANGTXT,SP900               * Clear new object text
          MOVE      ZERO,F2                      * Column counter
          CLEAR     CHANGTXT
          MOVE      SP70,D1
          CLEAR     CHANGAAA
.
LSOF2000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check char and count for ~
          GOTO      LSOF4000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            ADD       ONE,F2                     * Count ~ to find column
          ENDIF
.
          APPEND    D1,CHANGTXT                  * Append to new object text
.
          COMPARE   F2,CHANGCOL                  * Append to new text until
          GOTO      LSOF2000 IF NOT EQUAL        * change column found
.
LSOF4000  COMPARE   CHANGCOL,F2                  * Colum not found
          GOTO      LSOF1000 IF NOT EQUAL
.
          APPEND    CHANGNVL,CHANGTXT            * Append new value to column
.
LSOF5000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check and count for ~
          GOTO      LSOF6000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            APPEND    D1,CHANGTXT                  * Append to new object text
          ELSE
            APPEND    D1,CHANGAAA                * Save old column value
            GOTO      LSOF5000
          ENDIF
.
LSOF6000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check and count for ~
          GOTO      LSOF7000 IF EOS
.
          APPEND    D1,CHANGTXT                  * Append remaing text to
          GOTO      LSOF6000                     * new to new object text
.
LSOF7000  RESET     CHANGAAA
          PACK      CHANGAAA,CHANGAAA,SP70,SP70
          PACK      CHANGOVL,CHANGOVL,SP70,SP70
.
          MATCH     SP70,CHANGOVL    * 0885160
          IF        !@EQUAL
            MATCH     CHANGOVL,CHANGAAA            * Exit as old column value
            GOTO      LSOF1000 IF NOT EQUAL        * did't match
          ENDIF
.
          RESET     CHANGTXT
.
          MATCH     "D",CMEWRTYP                 * delete record
          IF        @EQUAL
            MOVE      ANSD,OBJECTRT
          ENDIF
.
          MOVE      CMEWOBJT,OBJECTTY            * Object
.
          MATCH     SP70,CHANGPRM                * Change in primary key
          IF        !@EQUAL
            PACK      OBJECTKY,CHANGPRM,SP70     * New Primary Key
          ELSE
            PACK      OBJECTKY,CMEWOKEY,SP70     * Key
          ENDIF
          PACK      OBJECTTX,CHANGTXT,SP900      * Text
.
          PACK      SRCRDATE,CMEWSCDT,SP70
          PACK      SRCRTIME,CMEWSCTM,SP70
          MOVE      OBJECTRT,SAVOBJRT
          MOVE      SRMDDATE,SAVMDATE
          MOVE      SRMDTIME,SAVMTIME
          CALL      WRCOND00     * write record to container detail table
          MOVE      SAVOBJRT,OBJECTRT
          MOVE      SAVMDATE,SRMDDATE
          MOVE      SAVMTIME,SRMDTIME
.
LSOF9999  MOVE      SP70,OBJECTRT
          RETURN
+
.******************************************************************************
.* GDDL0000 - Send delete records for all objects for this visit
.******************************************************************************
GDDL0000  STRIP     DELETKEY
          PACK      KEY112,DELETSTM,DELETOBJ,DELETKEY,Z70
          CALL      RSCMEWD2
GDDL1000  CALL      RPCMEWD2
          BRANCH    OVRCD,GDDL9999
.
          MATCH     DELETSTM,CMEWDSTR            * 17=Emergency Department
          GOTO      GDDL9999 IF NOT EQUAL
.
          MATCH     DELETOBJ,CMEWOBJT            * Correct Object
          GOTO      GDDL9999 IF NOT EQUAL
.
          MATCH     DELETKEY,CMEWOKEY            * Only match to length of
          GOTO      GDDL9999 IF NOT EQUAL        * DELETKEY after strip
.
          MATCH     ANSY,RERUNFL            * Ignore curreat date range
          IF        @EQUAL
            MOVE      CMEWCNTN,F8           * Include current extract records
            IF        CONTNUMB <> F8
              MATCH     STRTDATE,CMEWSDAT
              GOTO      GDDL1000 IF NOT LESS
            ENDIF
          ENDIF
.
.
. ** don't delete already deleted record **
          MATCH     ANSD,CMEWRTYP
          GOTO      GDDL1000 IF EQUAL
.
          MOVE      CMEWOBJT,OBJECTTY            * Object
          PACK      OBJECTKY,CMEWOKEY,SP70       * Key
          PACK      OBJECTTX,CMEWTEXT,SP900      * Text
.
          PACK      SRCRDATE,CMEWSCDT,SP70
          PACK      SRCRTIME,CMEWSCTM,SP70
.
          MOVE      ANSD,OBJECTRT
          CALL      WRCOND00     * write record to container detail table
.
          GOTO      GDDL1000
.
GDDL9999  RETURN
+
.******************************************************************************
.* DLOF0000 - Send a delete record for the last send object and key
.             if it's not a delete record.
.*            Set source modifield date prior to calling this routine
.******************************************************************************
DLOF0000  STRIP     DELETKEY
.
          PACK      KEY112,DELETSTM,DELETOBJ,DELETKEY,Z70
          CALL      RSCMEWD2
DLOF1000  CALL      RPCMEWD2
          BRANCH    OVRCD,DLOF9999
.
          MATCH     DELETSTM,CMEWDSTR            * Stream
          GOTO      DLOF9999 IF NOT EQUAL
.
          MATCH     DELETOBJ,CMEWOBJT            * Correct Object
          GOTO      DLOF9999 IF NOT EQUAL
.
          MATCH     DELETKEY,CMEWOKEY            * Only match to length of
          GOTO      DLOF9999 IF NOT EQUAL        * DELETKEY after strip
.
          MATCH     ANSY,RERUNFL            * Ignore curreat date range
          IF        @EQUAL
            MOVE      CMEWCNTN,F8           * Include current extract records
            IF        CONTNUMB <> F8
              MATCH     STRTDATE,CMEWSDAT
              GOTO      DLOF1000 IF NOT LESS
            ENDIF
          ENDIF
.
          MATCH     "D",CMEWRTYP                 * Last send object is a delete
          GOTO      DLOF9999 IF EQUAL            * so exit
.
          MOVE      CMEWOBJT,OBJECTTY            * Object
          PACK      OBJECTKY,CMEWOKEY,SP70       * Key
          PACK      OBJECTTX,CMEWTEXT,SP900      * Text
.
          MOVE      ANSD,OBJECTRT
          PACK      SRCRDATE,CMEWSCDT,SP70
          PACK      SRCRTIME,CMEWSCTM,SP70
.
          CALL      WRCOND00     * write record to container detail table
.
DLOF9999  RETURN
.
.******************************************************************************
.* RCOL0000 - Return a column from the  last sent stream object
.* Requires: CHANGSTM  * Stream
.*           CHANGOBJ  * Object
.*           CHANGCOL  * Change column number
.*           CHANGKEY  * Change Key
.******************************************************************************
RCOL0000  STRIP     CHANGKEY
.
          SUB       SIX,CHANGCOL
.
          PACK      KEY112,CHANGSTM,CHANGOBJ,CHANGKEY,Z70
          CALL      RSCMEWD2
RCOL1000  CALL      RPCMEWD2                     * Loop sent objects
          BRANCH    OVRCD,RCOL9999
.
          MATCH     CHANGSTM,CMEWDSTR            * Stream
          GOTO      RCOL9999 IF NOT EQUAL
.
          MATCH     CHANGOBJ,CMEWOBJT            * Correct Object
          GOTO      RCOL9999 IF NOT EQUAL
.
          MATCH     CHANGKEY,CMEWOKEY            * Only match to length of
          GOTO      RCOL9999 IF NOT EQUAL        * DELETKEY after strip
.
          MATCH     ANSD,CMEWRTYP * 0885290      * Don't end deleted record
          GOTO      RCOL1000 IF EQUAL
.
          MATCH     ANSY,RERUNFL            * Ignore curreat date range
          IF        @EQUAL
            MOVE      CMEWCNTN,F8           * Include current extract records
            IF        CONTNUMB <> F8
              MATCH     STRTDATE,CMEWSDAT
              GOTO      RCOL1000 IF NOT LESS
              MOVE      ONE,NOUPDATE        * Don't update new record written
            ENDIF
          ENDIF
.
          PACK      CHANGTXT,SP900               * Clear new object text
          MOVE      ZERO,F2                      * Column counter
          CLEAR     CHANGTXT
          MOVE      SP70,D1
          CLEAR     CHANGAAA
.
RCOL2000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check char and count for ~
          GOTO      RCOL4000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            ADD       ONE,F2                     * Count ~ to find column
          ENDIF
.
          APPEND    D1,CHANGTXT                  * Append to new object text
.
          COMPARE   F2,CHANGCOL                  * Append to new text until
          GOTO      RCOL2000 IF NOT EQUAL        * change column found
.
RCOL4000  COMPARE   CHANGCOL,F2                  * Colum not found
          GOTO      RCOL1000 IF NOT EQUAL
.
          APPEND    CHANGNVL,CHANGTXT            * Append new value to column
.
RCOL5000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check and count for ~
          GOTO      RCOL6000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            APPEND    D1,CHANGTXT                  * Append to new object text
          ELSE
            APPEND    D1,CHANGAAA                * Save old column value
            GOTO      RCOL5000
          ENDIF
.
RCOL6000  UNPACK    CMEWTEXT,D1,CMEWTEXT         * Check and count for ~
          GOTO      RCOL7000 IF EOS
.
          APPEND    D1,CHANGTXT                  * Append remaing text to
          GOTO      RCOL6000                     * new to new object text
.
RCOL7000  RESET     CHANGAAA
          PACK      CHANGAAA,CHANGAAA,SP70,SP70
          RESET     CHANGTXT
.
          PACK      OBJECTTX,CHANGTXT,SP900      * Text
.
RCOL9999  MOVE      SP70,OBJECTRT
          RETURN
+
.******************************************************************************
.* GCOL0000 - Return a column value from the current sent stream object
.* Requires: A sent steam record in context
.*           CHANGCOL  - Column number to get value from
.* Returns : CHANGAAA  - Column value
.******************************************************************************
GCOL0000  MOVE      SP70,CHANGAAA
          RESET     CHANGAAA
          CLEAR     CHANGAAA
          MOVE      ZERO,F2
          MOVE      SP70,D1
          MOVE      CMEWTEXT,CHANGTXT
.
GCOL2000  UNPACK    CHANGTXT,D1,CHANGTXT         * Check char and count for ~
          GOTO      GCOL4000 IF EOS
.
          MATCH     TILDA,D1
          IF        @EQUAL
            ADD       ONE,F2                     * Count ~ to find column
          ENDIF
.
          COMPARE   F2,CHANGCOL                  * Append to new text until
          GOTO      GCOL2000 IF NOT EQUAL        * change column found
.
GCOL4000  COMPARE   CHANGCOL,F2                  * Colum not found
          GOTO      GCOL9999 IF NOT EQUAL
.
GCOL5000  UNPACK    CHANGTXT,D1,CHANGTXT         * Check and count for ~
          GOTO      GCOL6000 IF EOS
.
          MATCH     TILDA,D1
          IF        !@EQUAL
            APPEND    D1,CHANGAAA                * Save old column value
            GOTO      GCOL5000
          ENDIF
.
GCOL6000  UNPACK    CHANGTXT,D1,CHANGTXT         * Check and count for ~
          GOTO      GCOL9000 IF EOS
.
          GOTO      GCOL6000                     * new to new object text
.
GCOL9000  RESET     CHANGAAA
.
GCOL9999  RESET     CHANGTXT
          RETURN
+
. =========================================================================
.         I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       CLALLREF
          INC       CLALLENC
          INC       CLOUTBOA
          INC       CLOUTBB1
          INC       CLPATDSC
          INC       CLWATTX1
          INC       SEXDSCIO
          INC       GETDRG
          INC       GETEFDRG
          INC       EDWCLINT
          INC       EDWINDSP
          INC       EDWEMERG
          INC       EDWSERVS
          INC       EDWADMPT
          INC       EDWNONAD
          INC       CLPATMIS
          INC       CLPMSHCP
          INC       CLPMSHCG
          INC       CLPMSHCL
          INC       NAMSTRCD
          INC       PATDOCCD
          INC       ALLAUDIO/INC
          INC       ALLITMIO/INC
          INC       ALLENCIO/INC
          INC       ALLLNKIO/INC 
          INC       ALLREFIO/INC
          INC       BOKRC1IO/INC
          INC       BOKRX1IO/INC
          INC       COMEDFIO/INC
          INC       COMEDWIO/INC
          INC       COMEWDIO/INC
          INC       EMRCHAIO/INC
          INC       EMRDLAIO/INC 
          INC       EMRLOCIO/INC 
          INC       EMRHISIO/INC
          INC       EMRICDIO/INC
          INC       EMRSITIO/INC
          INC       EMRVCDIO/INC
          INC       EMRVISIO/INC
          INC       IBAPOSIO/INC
          INC       OPRDEAIO/INC
          INC       OUTBOAIO/INC 
          INC       OUTBITIO/INC
          INC       OUTBB1IO/INC
          INC       OUTCANIO/INC
          INC       OUTCLIIO/INC
          INC       OUTHEDIO/INC
          INC       OUTCTYIO/INC
          INC       OUTDIAIO/INC
          INC       OUTPREIO/INC
          INC       OUTRSHIO/INC 
          INC       OUTSITIO/INC
          INC       OUTSESIO/INC
          INC       PATCFAIO/INC
          INC       PATCHCIO/INC
          INC       PATCODIO/INC
          INC       PATCRDIO/INC
          INC       PATDADIO/INC
          INC       PATDSCIO/INC
          INC       PMSPHSIO/INC            * Patient discharge
          INC       PATECMIO/INC
          INC       PATECOIO/INC
          INC       PATECDIO/INC
          INC       PATFN1IO/INC
          INC       PATFX1IO/INC
          INC       PATICDIO/INC
          INC       PATICOIO/INC
          INC       PATICUIO/INC
          INC       PATLINIO/INC
          INC       PATGSRIO/INC
          INC       PATHSPIO/INC
          INC       PATATRIO/INC
          INC       PATMA1IO/INC
          INC       PATMI1IO/INC
          INC       PATPA1IO/INC
          INC       PATPGRIO/INC
          INC       PATMRGIO/INC
          INC       PATUNAIO/INC
          INC       PATURAIO/INC
          INC       PATTRNIO/INC
          INC       PATVADIO/INC
          INC       PATVISIO/INC
          INC       PATWBHIO/INC
          INC       PATWR1IO/INC
          INC       PMSADWIO/INC 
          INC       PMSAIDIO/INC
          INC       PMSBRQIO/INC
          INC       PMSCCDIO/INC
          INC       PMSCEXIO/INC
          INC       PMSDUNIO/INC
          INC       PMSEDWIO/INC
          INC       PMSEDGIO/INC
          INC       PMSHCPIO/INC
          INC       PMSHCLIO/INC
          INC       PMSHCGIO/INC
          INC       PMSIDWIO/INC
          INC       PMSPX2IO/INC
          INC       PMSRELIO/INC            * Relationship        
          INC       PMSUHLIO/INC 
          INC       PMSVX1IO/INC 
          INC       PMSWORIO/INC 
          INC       VISCMTIO/INC
          INC       WEBSECIO/INC
          INC       PRIITMIO/INC
          INC       WATCATIO/INC
          INC       WATCHAIO/INC
          INC       WATPROIO/INC
          INC       WATHISIO/INC
          INC       WATSUSIO/INC
          INC       WATTR1IO/INC
          INC       WATTX1IO/INC
.
