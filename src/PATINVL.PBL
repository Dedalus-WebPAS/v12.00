.******************************************************************************
.
.         PATINVL.PBL  - This include contains the codes that print the heading
.         -----------    and the tail of all the invoice layout (format 0 to 9)
.
.         Subroutines in this include are :
.
.         ENDPRT    : Print the tail section of the invoice with all appropriate
.                     details.
.         HEAD      : Print the heading section of the invoice.
.         TAIL      : Print the tail section of the invoice when going over two
.                     pages.
.         PLINEUP   : Print line up.
.
.------------------------------------------------------------------------------
.
.         VERSION: 
.
.         V12.00.01 28/05/2025  J.Tan          TSK 0955096
.                   Added Alphanumeric visit number changes
.         V11.00.01 02/04/2020  J.Tan             TSK 0868813
.                   Changed PKNAME to DIM80
.         V9.09.01  11/07/2007  Mike Laming   CAR 140395
.                   Added test for Statements at SINVH000 & SINVT000
.         V9.09.01  03/07/2007  Mike Laming   CAR 140395
.                   Change GETPRES to not read "0" AADMNO
.         V9.04.02  08/11/2004 J.Tan   CAR 54569
.                   Fixed checking for O/P and EMR header/tail template
.         V9.04.01  08/09/2004 Ebon Clements  CAR 53280
.                   Removed move "- " to sep in ENDPRT and removed SEP from
.                   ENDPRT1,ENDPRT1A,ENDPRT11,ENDPR11A,ENDPRT15,ENDPR15A
.         V9.03.01  27/06/2003 J.Tan
.                   Mods for WEB Billing 
.         V9.02.01  09/05/2002 J.Tan
.                   Ported from r6.09
.         V6.07.01  12/09/2000  Davin  SRF 3309  
.                   Mods for templating of Deposits/Statements      
.         V6.07.00  23/06/2000  Steve Armstrong
.                   Mods for templating of Deposits/Statements      
.         V6.06.00  30/09/1999  Caleb Sharman
.                   Mods to use CRTDATE instead of CDD,CMM,CCC,CYY
.         V6.04.02  05/08/97 J.Tan     SRF 620857
.                   Fixed I*C on patdoctaf
.         V6.04.01  11/12/1996  Greg Horvat      Holy Spirit Mods
.                   Added new statement layout for Holy Spirit - layout 20
.
.         V6.03.10  02/10/1996  Greg Horvat
.                   Changed layout 6 header to print deposit or statement of
.                   account 1 line higher
.         V6.03.09  21/08/1996  Greg Horvat      SRF 616417
.                   Changed to print only 78 columns on a page
.         V6.03.08  29/05/1996  Greg Horvat      Quote 8623
.                   Added new statement layout for Adelaide Clinic - layout 19
.         V6.03.07  20/03/1996  Greg Horvat      SRF 614578
.                   Fixed the printing of the header when the laser printer
.                   parameter is turned on
.         V6.03.06  27/12/1995  Greg Horvat      Quote 8604
.                   Changed invoice layout 10 to print the attending doctor
.                   name & provider number for A&E patients
.         V6.03.05  17/11/1995  Greg Horvat      SRF 612483
.                   Changed layout 6 tail to print the hospital name in it
.                   depending on the PTCNHPBI parameter
.         V6.03.04  16/11/1995  Greg Horvat      SRF 611839 (Rebound)
.                   Changed layout 18 tail again
.         V6.03.03  03/11/1995  Greg Horvat      SRF 611839
.                   Added new statement layout for Mater - layout 18
.         V6.03.02  08/09/1995  Greg Horvat      SRF 611386 & 611395
.                   Changed layout 10's header to print the PRA at position 12
.                   rather than position 2 and print the word statement 2 lines
.                   higher
.         V6.03.01  24/03/1995  Graeme Williams  SRF 135722
.                   Fixed layout 6 so claim details don't print over
.                   the words "STATEMENT OF ACCOUNT"
.
.******************************************************************************
.
.         Get the name of the patient (Title Given-names Surname)
.
GETPNAM   CLEAR     PNAME
          REP       ", ",PTITL
          REP       ", ",PGNAME
          REP       ", ",PSNAME
          REP       ", ",PTMASNAM
          RESET     PGNAME
.
          PACK      DIM6 WITH PTITL,SP2
.
.         Get the first non-blank character of the title
.
FRSTCH    CMATCH    SP1,DIM6
          GOTO      APGNAM IF NOT EQUAL
          BUMP      DIM6
          GOTO      FRSTCH IF NOT EOS
.
.         No title, name will be Given-names Surname
.
          MOVE      SP1,ANS
          MOVE      PGNAME,ANS
          APPEND    ANS,PNAME
          APPEND    DOT,PNAME
          GOTO      APG3
.
.         Check for last non-blank in title, and append Given names there
.
APGNAM    APPEND    DIM6,PNAME
APG1      CMATCH    SP1,PNAME
          GOTO      APG2 IF NOT EQUAL
          BUMP      PNAME,-1
          GOTO      APG1 IF NOT EOS
.
.         Append given name at this point
.
APG2      APPEND    SP1,PNAME
          MOVE      SP1,ANS
          MOVE      PGNAME,ANS
          APPEND    ANS,PNAME
          APPEND    DOT,PNAME
.
.         Append the second initial
.
APG3      RESET     PGNAME
.
APG4      CMATCH    SP1,PGNAME
          GOTO      APG5 IF EQUAL
.
          CMATCH    DOT,PGNAME
          GOTO      APG5 IF EQUAL
          BUMP      PGNAME,1
          GOTO      APG4 IF NOT EOS
          GOTO      APS1
.
APG5      BUMP      PGNAME,1
          CMATCH    SP1,PGNAME
          GOTO      APS1 IF EQUAL
.
          MOVE      SP1,ANS
          MOVE      PGNAME,ANS
          APPEND    ANS,PNAME
          APPEND    DOT,PNAME
.
.         Search for last non-blank in given names to append surname there
.
APS1      CMATCH    SP1,PNAME
          GOTO      APS2 IF NOT EQUAL
          BUMP      PNAME,-1
          GOTO      APS1 IF NOT EOS
.
.         No given name or title. Name will be just Surname
.
          CLEAR     PNAME
          APPEND    PTMASNAM,PNAME
          GOTO      APSPS
.
.         Append surname at this point
.
APS2      CMATCH    DOT,PNAME
          GOTO      APS3 IF EQUAL
          APPEND    SP1,PNAME
.
APS3      APPEND    PTMASNAM,PNAME
.
.         Append spaces to make sure there are no characters leftover from
.         previous names
.
APSPS     APPEND    SP30,PNAME
          APPEND    SP30,PNAME
          RESET     PNAME
          RETURN
+
.         Set up the Person Responsible for the Account
.
GETPRES   RESET     PGNAME
          MOVE      PGNAME,ANS
          PACK      DIM8 WITH SP1,PTITL,SP1,ANS,DOT
.
FRSTCH2   CMATCH    SP1,DIM8
          GOTO      PCKNAM2 IF NOT EQUAL
          BUMP      DIM8
          GOTO      FRSTCH2 IF NOT EOS
.
PCKNAM2   PACK      PFNAME,DIM8,PTMASNAM
          REP       ", ",PFNAME
          MOVE      PADD1,PKADD1
          MOVE      PADD2,PKADD2
          MOVE      PSUBRB,PKSUBR
          MOVE      PPOST,PKPOST
          MOVE      SP10,PKRELP
          MATCH     ZEROVISN,AADMNO
          GOTO      PCKNAM3 IF EQUAL                                  *I-140395
.
          OPEN      PATRE1A1,"patre1af"
          PACK      KEY8 WITH AADMNO
          CALL      RDRESP1
          CLOSE     PATRE1A1
.
          BRANCH    OVRCD,PCKNAM3
          PACK      PFNAME,PKNAME,SP30
          RETURN
.
PCKNAM3   MOVE      PFNAME,PKNAME
          RETURN
+
.         This subroutine prints the end section of the invoice
.
ENDPRT    MOVE      SP6,DMEMB
.
          COMPARE   "5",CINVLAY
          GOTO      ENDPRT5 IF EQUAL
.
          MOVE      CNAME TO DIM30
          MOVE      CHPADD2 TO DIM20
          MOVE      CHPPOST TO DIM4
.
.         Load up the word MEMBER if this is a member
.
          COMPARE   ONE,CMEMB
          GOTO      BRNEND IF NOT EQUAL
.
          LOAD      DMEMB USING AMEMB OF MEMBER
.
BRNEND    BRANCH    CINVLAY,ENDPRT1,ENDPRT2,ENDPRT3,ENDPRT4,ENDPRT5:
                            ENDPRT6,ENDPRT7,ENDPRT8,ENDPRTA
          GOTO      ENDPRT0
.
ENDPRTA   BRANCH    PTCNINVL,ENDPRT10,ENDPRT11,ENDPRT12,ENDPRT13,ENDPRT14:
                             ENDPRT15,ENDPRT10,ENDPRT17,ENDPRT18,ENDPRT19:
                             ENDPRT20
          GOTO      ENDPRT9
+
.         Format 1
.
ENDPRT0   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 1
.
ENDPRT1   BRANCH    STATFLG,ENDPRT1A         * Printing statement
          PRINT     *N,*N,*N,*N,*72,DMEMB,*N,*2,DIM30,"- ",CHPADD1:
                    *N,*34,DIM20,DIM4,*N,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*N,*2,PURNO,*13,AADMNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT    *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
.
ENDPRT1A  PRINT     *N,*N,*69,TOTBAL,*N,*N,*72,DMEMB,*N,*2,DIM30,"- ",CHPADD1:
                    *N,*34,DIM20,DIM4,*N,*69,TOTBAL,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*N,*2,PURNO,*13,AADMNO,*24,"Statement";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Format 2
.
ENDPRT2   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 3
.
ENDPRT3   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
+
.         Format 4
.
ENDPRT4   BRANCH    STATFLG,ENDPRT4A         * Printing statement
          PRINT     *N,*N,*N,*N,*72,DMEMB,*N,*N,*N,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*N,*13,AADMNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
.
ENDPRT4A  PRINT     *N,*N,*69,TOTBAL,*N,*N,*72,DMEMB:
                    *N,*N,*N,*69,TOTBAL,*N,*N,*2,CDATE:
                    *13,PNAME:
                    *N,*N,*N,*13,AADMNO,*24,"Statement";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Format 5
.
ENDPRT5   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
+
.         Format 6
.
ENDPRT6   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 7
.
ENDPRT7   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
+
.         Format 8
.
ENDPRT8   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 9
.
ENDPRT9   CALL      SINVT000                 * set up tail stationery code
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
+
.         Format 10 & 16
.
ENDPRT10  CALL      SINVT000                 * set up tail stationery code
          PRINT     *N;                      * linefeed needed before template
          MATCH     "IBAHOS20",PRGID
          IF        @EQUAL
            PRINT     *N;
          ENDIF
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
+
.         Format 11
.
ENDPRT11  BRANCH    STATFLG,ENDPR11A
          PRINT     *N,*N,*N,*N,*72,DMEMB,*N,*2,DIM30,"- ",CHPADD1:
                    *N,*15,CHPADD2,DIM4,*N,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*N,*13,AADMNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N;
          ENDIF
          RETURN
.
ENDPR11A  PRINT     *N,*N,*69,TOTBAL,*N,*N,*72,DMEMB,*N,*2,DIM30,"- ",CHPADD1:
                    *N,*15,CHPADD2,DIM4,*N,*69,TOTBAL,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*N,*13,AADMNO,*25,"Statement";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N;
          ENDIF
          RETURN
+
.         Format 12
.
ENDPRT12  CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 13
.
ENDPRT13  IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N;   * leave on line 7
          ENDIF
          RETURN
+
.         Format 14
.
ENDPRT14  BRANCH    STATFLG,ENDPR14A         * Printing statement
          PRINT     *N,*N,*N,*N,*72,DMEMB,*N,*2,PNAME:
                    *N,*N,*N,*2,AADMNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
.
ENDPR14A  PRINT     *N,*N,*69,TOTBAL,*N,*N,*72,DMEMB,*N,*2,PNAME:
                    *N,*N,*N,*2,AADMNO,*N,*N,*69,TOTBAL;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Format 15
.
ENDPRT15  BRANCH    STATFLG,ENDPR15A         * Printing statement
          PRINT     *N,*N,*N,*N,*72,DMEMB,*N,*2,DIM30,"- ",CHPADD1:
                    *N,*15,CHPADD2,DIM4,*N,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*13,AADMNO,*48,PURNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N
          ENDIF
          RETURN
.
ENDPR15A  PRINT     *N,*N,*69,TOTBAL,*N,*N,*72,DMEMB,*N,*2,DIM30,"- ",CHPADD1:
                    *N,*15,CHPADD2,DIM4,*69,TOTBAL,*N,*N:
                    *2,CDATE,*13,PNAME:
                    *N,*N,*N,*13,AADMNO,*24,"Statement",*48,PURNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Format 17
.
ENDPRT17  BRANCH    STATFLG,ENDPR17A
          PRINT     *N,*N,*N,*N:
                    *N,*N,*N,*N,*N:                       
                    *N,*N:
                    *2,CDATE,*13,PNAME,*N,*N:
                    *N:
                    *12,AADMNO,*43,PINVNO,*N;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN

ENDPR17A  PRINT     *N:
                    *69,TOTBAL,*N,*N,*N,*N,*N:
                    *69,TOTBAL,*N,*N:
                    *2,CDATE,*13,PNAME,*N,*N:
                    *69,TOTBAL,*N:
                    *12,AADMNO,*43,PINVNO:
                    *N,*69,"Statement";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Format 18
.
ENDPRT18  CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 19
.
ENDPRT19  CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
+
.         Format 20
.
ENDPRT20  CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ZERO,MPGEFLAG            * indicate single page            
          CALL      PRTINVTL                 * print templated invoice tail
          RETURN
.
.          BRANCH    STATFLG,ENDPR20A         * Printing statement
.          PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N;
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
.            PRINT     *N,*N,*N,*N,*N,*N,*N;
.          ENDIF
.          RETURN
..
.ENDPR20A  PRINT     *N,*N,*N,*N,*N,*N:
.                    *24,"Statement",*70,TOTBAL;
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
.            PRINT     *N,*N,*N,*N,*N,*N,*N;
.          ENDIF
.          RETURN
+
.         This subroutine prints the tail section of the invoice when the
.         invoice goes over two pages
.
TAIL      BRANCH    CINVLAY,TAIL00,TAIL20,TAIL30,TAIL40,TAIL50:
                            TAIL60,TAIL70,TAIL80,TAILA
          GOTO      TAIL00
.
TAILA     BRANCH    PTCNINVL,TAIL100,TAIL110,TAIL120,TAIL130,TAIL140:
                             TAIL150,TAIL100,TAIL170,TAIL180,TAIL190:
                             TAIL200
          GOTO      TAIL90
.
.         Tail for format 0 and 1
.
TAIL00    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.TAIL00    PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**",*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**":
.                    *N,*N,*69,"******.**",*N,*N,*N,*2,PURNO,*13,AADMNO;
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
..
.. ----- Added form feed because CINVFF=1 for these layouts -----
..
.            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*F
.          ENDIF
.          GOTO      BRNHEAD
..
.         Tail for format 2
.
TAIL20    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.TAIL20    PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**",*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**":
.                    *N,*N,*69,"******.**",*N,*N,*N,*13,AADMNO;
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
.            PRINT     *N,*N,*N,*N,*N,*N,*N
.          ENDIF
.          GOTO      BRNHEAD
.
.         Tail for format 3
.
TAIL30    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.TAIL30    PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**",*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**":
.                    *N,*N,*69,"******.**",*N,*N,*N,*2,PURNO,*13,AADMNO;
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
..
.. ----- Added form feed because CINVFF=1 for these layouts -----
..
.            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*F
.          ENDIF
.          GOTO      BRNHEAD
..
.         Tail for format 4
.
TAIL40    PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *10," *****   Statement continued on next page *****":
                    *69,"******.**",*N,*N,*N,*N,*N:
                    *10," *****   Statement continued on next page *****":
                    *69,"******.**":
                    *N,*N,*69,"******.**",*N,*N,*N,*13,AADMNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          GOTO      BRNHEAD
.
.         Tail for format 5
.
TAIL50    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.TAIL50    PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
.                     *1," *****   Statement continued on next page *****":
.                    *69,"******.**",*N,*N,*N:
.                     *1," *****   Statement continued on next page *****":
.                    *N,*N,*N,*2,AADMNO,*N,*69,"******.**"
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ENDIF
.          GOTO      BRNHEAD
..
.         Tail for format 6
.
TAIL60    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.         Tail for format 7
.
TAIL70    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
TAIL80    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
TAIL90    CALL      SINVT000                 * set up tail stationery code
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.         Tail for format 10 & 16
.
TAIL100   CALL      SINVT000                 * set up tail stationery code
          PRINT     *N;                      * linefeed needed before template
          MATCH     "IBAHOS20",PRGID
          IF        @EQUAL
            PRINT     *N;
          ENDIF
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.
TAIL110   PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *10," ***** Statement continued on next page *****":
                    *69,"******.**",*N,*N,*N,*N,*N:
                    *10," ***** Statement continued on next page *****":
                    *69,"******.**":
                    *N,*N,*2,CDATE,*13,PNAME,*69,"******.**":
                    *N,*N,*69,"******.**",*N,*13,AADMNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N;
          ENDIF
          GOTO      BRNHEAD
.
.         Tail for format 12
.
TAIL120   CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
TAIL130   PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *3,"** Statement continued on next page **": * line 46
                    *69,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N;
          ENDIF
          GOTO      BRNHEAD
.
.         Tail for format 14
.
TAIL140   PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*69,"******.**",*N:
                    *10," *****   Statement continued on next page *****":
                    *N,*N,*2,PNAME,*N,*N,*N,*2,AADMNO,*N,*N,*69,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          GOTO      BRNHEAD
.
.         Tail for format 15
.
TAIL150   PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*69,"******.**",*N:
                    *10," *****   Statement continued on next page *****",*N,*N:
                    *10," *****   Statement continued on next page *****":
                    *N,*69,"******.**":
                    *N,*N,*2,CDATE,*13,PNAME:
                    *69,"******.**":
                    *N,*N,*N,*13,AADMNO,*48,PURNO,*69,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N
          ENDIF
          GOTO      BRNHEAD
.
.         Tail for layout 17
.
TAIL170   PRINT     *N,*N,*N,*N,*N,*N:
                    *10," *****  Statement continued on next page *****",*N,*N:
                    *69,"******.**",*N,*N,*N,*N,*N:
                    *69,"******.**",*N,*N:
                    *2,CDATE:
                    *13,PNAME,*69,"******.**",*N,*N:
                    *69,"******.**",*N:
                    *12,AADMNO,*43,PINVNO;
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          GOTO      BRNHEAD
.
.         Tail for format 18
.
TAIL180   CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.         Tail for format 19
.
TAIL190   CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.TAIL190   PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**",*N,*N,*N,*N,*N:
.                    *10," *****   Statement continued on next page *****":
.                    *69,"******.**":
.                    *N,*N,*69,"******.**",*N,*N,*N,*2,PURNO,*13,AADMNO;
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
..
.. ----- Added form feed because CINVFF=1 for these layouts -----
..
.            PRINT     *N,*N,*N,*N,*N,*N,*F
.          ENDIF
.          GOTO      BRNHEAD
..
.         Tail for format 20
.
TAIL200   CALL      SINVT000                 * set up tail stationery code
          MATCH     "IBABIL05",PRGID
          IF        @EQUAL
            PRINT     *N,*N,*N,*N,*N,*N,*N;  * needed to match patient invoice
          ENDIF
          MOVE      ONE,MPGEFLAG             * indicate multipage
          CALL      PRTINVTL                 * print templated invoice tail
          GOTO      BRNHEAD
.
.TAIL200   PRINT    *N,*N,*N,*N,*N,*N,*N,*N:
.                   *10," *****   Statement continued on next page *****":
.                   *N,*N,*N,*N,*N:
.                   *10," *****   Statement continued on next page *****":
.                   *70,"******.**";
.          IF        PTCNLASR=1
.            PRINT     *F;
.          ELSE
.            PRINT     *N,*N,*N,*N,*N,*N,*N;
.          ENDIF
.
.          GOTO      BRNHEAD
..
.         HEADING FOR STATEMENT
.
.         This subroutine prints the heading section of the statement
.
HEAD      MOVE      ZERO,CLMFLAG
          MOVE      SP20,HFNMTB
          MOVE      SP20,IREFNO
.
          MATCH     "0  " TO ACLAIM
          GOTO      BRNHEAD IF EQUAL
          MATCH     SP3 TO ACLAIM
          GOTO      BRNHEAD IF EQUAL
.
          MOVE      SP20 TO TDESC
          MOVE      SP20 TO WCCLMNO
          MOVE      SP20 TO MREFNO
          MOVE      SP20 TO VCLMNO
          UNPACK    SP5 WITH TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
.
          MOVE      "CL" TO TCODE
          PACK      KEY5 WITH TCODE,ACLAIM
          CALL      RDCODE1
          MOVE      AADMNO TO KEY8
.
          MOVE      ZERO,FORM2
CLLP1     ADD       ONE,FORM2
          COMPARE   SIX,FORM2
          GOTO      BRNHEAD IF NOT LESS
.
          LOAD      ANS USING FORM2 OF TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
          MATCH     "W" TO ANS
          GOTO      HWORK IF EQUAL
          MATCH     "M" TO ANS
          GOTO      HMAB IF EQUAL
          MATCH     "V" TO ANS
          GOTO      CLLP1 IF NOT EQUAL
.
HVET      OPEN      PATWVET1,"patwvetf"
          CALL      RDWVET1
          MOVE      VCLMNO TO WCCLMNO
          CLOSE     PATWVET1
          MOVE      ONE,CLMFLAG
.
.         Setup variables for format 4
.
          MOVE      "DVA",HFNMTB
          MOVE      VCLMNO,IREFNO
          GOTO      BRNHEAD
.
HWORK     OPEN      PATWC1A1,"patwc1af"
          CALL      RDWCOM1
          CLOSE     PATWC1A1
          MOVE      ONE,CLMFLAG
.
.         Setup variables for format 4
.
          MOVE      "WCO/",HFNMTB
          RESET     HFNMTB,4
          APPEND    WCICODE,HFNMTB
          RESET     HFNMTB
          MOVE      WCCLMNO,IREFNO
          GOTO      BRNHEAD
.
HMAB      OPEN      PATWMAB1,"patwmabf"
          CALL      RDWMAB1
          MOVE      MREFNO TO WCCLMNO
          CLOSE     PATWMAB1
          MOVE      ONE,CLMFLAG
.
.         Setup variables for format 4
.
          MOVE      "MAB/TAC",HFNMTB
          MOVE      MREFNO,IREFNO
.
BRNHEAD   BRANCH    CINVLAY,HEAD10,HEAD20,HEAD30,HEAD40,HEAD50:
                            HEAD60,HEAD70,HEAD8A,HEADA
          GOTO      HEAD00
.
HEADA     BRANCH    PTCNINVL,HEAD100,HEAD110,HEAD120,HEAD130,HEAD140:
                             HEAD150,HEAD160,HEAD170,HEAD180,HEAD190:
                             HEAD200
          GOTO      HEAD90
.
.         Heading for format 0 invoices
.
HEAD00    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
+
.
.         Heading for format 1 invoices
.
HEAD10    MOVE      CHADD2,DIM15
          MOVE      PNAME,DIM25
          IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT     *43,CNAME,*N,*43,CHADD1,*N,*43,DIM15,CHPOST:
                        SP2,"PH:",CHTELEB:
                    *N,*N,*N,*8,PFNAME,*49,DIM25:
                    *N,*8,PKADD1,*49,PADD1:
                    *N,*8,PKADD2,*49,PADD2:
                    *N,*8,PKSUBR,"     ",PKPOST,*49,PSUBRB,"     ",PPOST:
                    *N,*N,*N,*N:
                       *2,A10DATE,*16,D10DATE,*29,PURNO,*45,AADMNO:
                    *57,CDATE:
                    *N,*N,*N,*2,AFUNDH,"/",AFNDTB,*18,ADIAG1
.
          BRANCH    CLMFLAG OF HEAD1A
          PRINT     *N,*N,*2,CNOCLMS
          GOTO      HEAD1B
.
HEAD1A    PRINT     *N,*N,*2,TDESC,"    REFERENCE - ",WCCLMNO
.
HEAD1B    COMPARE   ONE,STATFLG
          GOTO      HEAD1C IF EQUAL
          PRINT     *N,*30,"D E P O S I T",*N,*N,*N,*N
          GOTO      HEAD1D
.
HEAD1C    PRINT     *N,*20," S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N
.
HEAD1D    MOVE      EIGHT,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
          RETURN
+
.         Heading for format 2 invoices
.
HEAD20    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
+
.         Heading for format 3 invoices
.
HEAD30    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
+
.         Heading for format 4 invoices
.
HEAD40    COMPARE   ONE,CLMFLAG
          GOTO      HDCONT IF EQUAL
.
          PACK      HFNMTB WITH AFUNDH,SLASH,AFNDTB
          MOVE      AFNDMM,IREFNO
.
HDCONT    MOVE      SP30,ADOCNAM
          MATCH     SP6,ADOCTA
          GOTO      HDDSCST IF EQUAL
.
          MOVE      ADOCTA,KEY6
          OPEN      PATDO1A1,"patdo1af"
          CALL      RDDOCT1
          CLOSE     PATDO1A1
          BRANCH    OVRCD OF HDDSCST
.
          MOVE      DGNAME,ANS
          PACK      ADOCNAM WITH ANS,DOT,DSNAME
.
HDDSCST   MOVE      SP10,DIM10
          MATCH     SP3,DSTAT
          GOTO      HDPRT IF EQUAL
.
          MOVE      "D ",TCODE
          PACK      KEY5 WITH TCODE,DSTAT
          CALL      RDCODE1
          BRANCH    OVRCD OF HDPRT
          MOVE      TDESC,DIM10
.
HDPRT     IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT        *2,PFNAME,*43,PNAME:
                    *N,*2,PKADD1,*43,PADD1:
                    *N,*2,PKADD2,*43,PADD2:
                    *N,*2,PKSUBR,"     ",PKPOST,*43,PSUBRB,"     ",PPOST:
                    *N,*N,*N:
                    *N,*2,AADMNO,*16,A10DATE,*29,D10DATE:
                    *43,HFNMTB,*57,IREFNO,*N;
.
          BRANCH    CLMFLAG OF HEAD4A
          PRINT     *2,CNOCLMS;
.
HEAD4A    COMPARE   ONE,STATFLG
          GOTO      HEAD4B IF EQUAL
.
          PRINT     *N,*N,*2,PKRELP,*29,DIM10,*43,ADOCNAM:
                    *70,CDATE:
                    *N,*N,*30,"D E P O S I T",*N,*N,*N,*N
          GOTO      HEAD4C
.
HEAD4B    PRINT     *N,*N,*2,PKRELP,*29,DIM10,*43,ADOCNAM:
                    *70,CDATE:
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N
.
HEAD4C    MOVE      TWO,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
          RETURN
+
.         Heading for format 5 invoices
.
HEAD50    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      SEVEN,COUNT
          RETURN
.
+
.         Heading for format 6 invoices
.
HEAD60    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
.         Heading for format 7 invoices
.
HEAD70    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
.         Heading for invoice layout 8
.
HEAD8A    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
+
.         Heading for invoice layout 9
.
HEAD90    CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
+
.         Heading for invoice layout 10
.
HEAD100   CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      EIGHT,COUNT
          RETURN
.
+
.         Heading for invoice layout 11
.
HEAD110   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N;
          ENDIF
          PRINT     *N,*N,*N,*2,PFNAME,*43,PNAME:
                    *N,*2,PKADD1,*43,PADD1:
                    *N,*2,PKADD2,*43,PADD2:
                    *N,*2,PKSUBR,"     ",PKPOST,*43,PSUBRB,"     ",PPOST:
                    *N,*N,*N,*N,*2,AADMNO,*16,A10DATE,*29,D10DATE:
                                   *43,AFUNDH,"/":
                                   AFNDTB,*57,AFNDMM,*N,*N;
.
          BRANCH    CLMFLAG OF HEAD110A
          PRINT     *N,*N,*2,CNOCLMS
          GOTO      HEAD110B
.
HEAD110A  PRINT     *N,*N,*2,TDESC,"    REFERENCE - ",WCCLMNO
.
HEAD110B  COMPARE   ONE,STATFLG
          GOTO      HEAD110C IF EQUAL
          PRINT     *N,*N,*30,"D E P O S I T",*N,*N,*N
          GOTO      HEAD110D
.
HEAD110C  PRINT     *N,*N,*20," S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N
.
HEAD110D  MOVE      THREE,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
          RETURN
+
.         Heading for invoice layout 12
.
HEAD120   CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
+
.*********************************************************************
.                            HEAD130
.         This subroutine prints the heading section of the invoice
.*********************************************************************
HEAD130   UNPACK    PINVDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TWO;*4,CONAME
          IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          UNPACK    PKNAME,KEY50
          PRINT     *15,OSTDESC:                      * line 7 
                    *N,*15,CONAME:                    * line 8
                    *N,*15,CHADD1:                    * line 9
                    *N,*15,CHADD2,*N:
                    *N,*70,CPDATE:                    * line 12
                    *N,*15,KEY50,*70,PURNO:           * line 13
                    *N,*15,PKADD1:                    * line 14
                    *N,*15,PKADD2:                    * line 15
                    *N,*15,PKSUBR,*43,PKPOST:         * line 16
                    *N,*N,*N,*N,*5,"STATEMENT",*49,"Item":             * line 20
                    *N,*3,"   Date   ",*14,"Description",*49,"Code":
                    *59,"Reference",*69,"Amount":   * line 21
                    *N,*3,"----------",*14,"---------------------------------":
                    *49,"---------",*59,"---------",*69,"---------"  * line 22
          MOVE      "10",COUNT              * set counter
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
.
HEAD139   RETURN
+
.         Heading for invoice layout 14
.
HEAD140   MOVE      AURNO,DIM8
.
         MOVE      "INTERIM   ",DIM10
         COMPARE   THREE,ASTAT
         GOTO      HED14CNT IF NOT EQUAL
.
         MOVE      "DISCHARGE ",DIM10
.
HED14CNT MOVE      PNAME,DIM25
          IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT     *2,AADMNO,*14,A10DATE,*29,D10DATE,*43,AFUNDH,AFNDTB:
                    *57,AFNDMM:
                    *N,*N,*N,*2,DIM8,*36,DIM10,*70,CDATE:
                    *N,*N:
                    *N,*16,PFNAME,*54,DIM25:
                    *N,*16,PKADD1,*54,PADD1:
                    *N,*16,PKADD2,*54,PADD2:
                    *N,*16,PKSUBR,*36,PKPOST:
                    *54,PSUBRB,*74,PPOST,*N,*N;
.
          BRANCH    CLMFLAG,HEAD140A
          PRINT     *2,CNOCLMS
          GOTO      HEAD140B
.
HEAD140A  PRINT     *2,TDESC,"    REFERENCE - ",WCCLMNO
.
HEAD140B  COMPARE   ONE,STATFLG
          GOTO      HEAD140C IF EQUAL
          PRINT     *N,*30,"D E P O S I T",*N,*N,*N
          GOTO      HEAD140D
.
HEAD140C  PRINT     *N,*20,"S T A T E M E N T   O F   A C C O U N T",*N,*N,*N
.
HEAD140D  MOVE      EIGHT,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
          RETURN
+
.         Heading for invoice layout 15
.
HEAD150  MOVE      PNAME,DIM30
.
          IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
         PRINT     *N,*N,*N,*N:
                   *60,CHTELEB,*N,*N,*N,*N:
                   *8,PFNAME,*45,DIM30:
                   *N,*8,PKADD1,*45,PADD1:
                   *N,*8,PKADD2,*45,PADD2:
                   *N,*8,PKSUBR,"     ",PKPOST:
                   *45,PSUBRB,"     ",PPOST:
                   *N,*N,*2,"U/R Number",*N:
                   *N,*2,PURNO,*16,A10DATE,*29,D10DATE,*42,AFUNDH,SLASH,AFNDTB:
                   *58,AFNDMM,*N,*N,*N,*29,"S T A T E M E N T":
                   *70,CDATE,*N:
                   *N,*N,*2,"   On   ",*25,"Description",*51,"Item",*62,"Ref.":
                   *N,*51,"Code",*N,*N;
.
CNTNH15  MOVE      ZERO,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
         RETURN
+
.         Heading for invoice layout 16
.
HEAD160   CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      EIGHT,COUNT
          RETURN
+
.************************************************************************
.                            HEAD170
.         This subroutine prints the heading section of invoice No. 17
.************************************************************************
HEAD170   MOVE      PNAME,DIM25
          IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT        *9,PFNAME,*50,DIM25:
                    *N,*9,PKADD1,*50,PADD1:
                    *N,*9,PKADD2,*50,PADD2:
                    *N,*9,PKSUBR,"     ",PKPOST:
                      *50,PSUBRB,"     ",PPOST:
                    *N,*N:
                    *N,*2,AADMNO,*15,AFUNDH,*28,AFNDMM:
                       *42,PMEDI,*57,CDATE,*70,PINVNO 
.
HEAD17A   BRANCH    STATFLG,HEAD17B
          MOVE      "D E P O S I T    ",DIM20                        
          GOTO      HEAD17C

HEAD17B   MOVE      "S T A T E M E N T",DIM20                        
.
HEAD17C   COMPARE  TWO,PINVSYS
          GOTO     HEAD17D IF NOT EQUAL
.
.         Outpatient. Print the visiting date
.
          PRINT     *N,*N,*2,"ADMISSION DATE : ",A10DATE:
                    *N,*N,*2,DIM20,*N:
                    *N,*2,"FROM",*11,"TO",*20,"DAYS":
                    *25,"DESCRIPTION",*51,"ITEM",*61,"RATE":
                    *N,*N;
          MOVE      ZERO,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
          RETURN
.
.         Non-outpatient. Print Admission and Discharge Date
.
HEAD17D  PRINT      *N,*N,*2,"ADMISSION DATE : ",A10DATE:
                    *42,"DISCHARGE DATE : ",D10DATE:
                    *N,*N,*2,DIM20,*N:
                    *N,*2,"FROM",*11,"TO",*20,"DAYS":
                    *25,"DESCRIPTION",*51,"ITEM",*61,"RATE":
                    *N,*N;
          MOVE      ZERO,COUNT
          IF        PTCNLASR=1
            SUB       PTCNXLBI,COUNT
          ENDIF
          RETURN
+
.         Heading for format 18 statement
.
HEAD180   CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
+
.         Heading for format 19 invoices
.
HEAD190   CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
+
.         Heading for format 20 invoices
.
HEAD200   CALL      SINVH000                * set up header stationery code
          CALL      PRTINVHL                * print templated invoice header
          PRINT     *N;
          MOVE      ZERO,COUNT
          RETURN
.
.         This subroutine prints the line-up print for this invoice layout
.
PLINEUP   BRANCH    CINVLAY,PLINE10,PLINE20,PLINE30,PLINE40,PLINE50:
                            PLINE60,PLINE70,PLINE80,PLINEA
          GOTO      PLINE00
.
PLINEA    BRANCH    PTCNINVL,PLINE100,PLINE110,PLINE120,PLINE130,PLINE140:
                             PLINE150,PLINE160,PLINE170,PLINE180,PLINE190:
                             PLINE200
          GOTO      PLINE90
+
.         Line up 0
.
PLINE00   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT     *N,*12,"**************************":
                       *43,"******************************":
                    *N,*12,"******************************":
                       *43,"******************************":
                    *N,*12,"******************************":
                       *43,"******************************":
                    *N,*12,"****************    ****":
                       *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"******":
                      *43,"**/**/**",*58,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                                "************************************":
                    *20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*N,*2,"******",*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
           RETURN
+
.         Line up 1
.
PLINE10   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT     *43,"******************************":
                    *N,*43,"******************************":
                    *N,*43,"*******************  PH:********":
                    *N,*N:
                    *N,*8,"***************************":
                      *49,"***************************":
                    *N,*8,"***************************":
                      *49,"***************************":
                    *N,*8,"***************************":
                      *49,"***************************":
                    *N,*8,"***************     ****":
                      *49,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                      *29,"******",*45,"******",*57,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                                "************************************":
                    *N,*N,*N,*2,"*************************************":
                                "*************************************":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*N,*2,"******",*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 2
.
PLINE20   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT     *N,*N:
                       *12,"******************************":
                       *53,"*************************":
                    *N,*12,"******************************":
                       *53,"*************************":
                    *N,*12,"******************************":
                       *53,"*************************":
                    *N,*12,"**************     ****":
                       *53,"**************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                      *29,"**/**/**",*43,"******",*69,"******.**":
                    *N,*N,*N,*69,"******.**":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*N,*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 3
.
PLINE30   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N;
          ENDIF
          PRINT        *2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"******":
                    *43,"**/**/**",*57,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                                "************************************":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*69,"******.**":
                    *N,*2,"******",*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 4
.
PLINE40   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT        *2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                    *29,"**/**/**",*43,"******",*69,"******.**":
                    *N,*N,*N,*69,"******.**":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 5
.
PLINE50   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *F,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT        *2,"******",*15,"**/**/**",*29,"**/**/**":
                      *43,"****** ****",*58,"**********":
                    *N,*N,*N,*2,"******",*36,"**********",*69,"******.**":
                    *N,*N:
                    *N,*15,"******************************":
                       *54,"************************":
                    *N,*15,"******************************":
                       *54,"************************":
                    *N,*15,"******************************":
                       *54,"************************":
                    *N,*15,"***************     ****":
                       *54,"***************     ****":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**":
                    *N,*N,*6,"********************************":
                    *N,*N,*N,*N,*2,"******"
          IF        PTCNLASR=1
            PRINT     *F;
          ENDIF
          RETURN
+
.         Line up 6
.
PLINE60   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
.           IF        PTCNHP6I=1
.             PRINT     *N,*N,*N,*N,*N,*N;
.           ELSE
              PRINT     *43,"***********************************",*N:
                        *43,"******************************",*N:
                        *43,"**********************************",*N:
                        *43,"*******************",*N,*N,*N;
.           ENDIF
          ELSE
            PRINT     *N,*N;
          ENDIF
          PRINT        *12,"******************************":
                       *43,"******************************":
                    *N,*12,"******************************":
                       *43,"******************************":
                    *N,*12,"******************************":
                       *43,"******************************":
                    *N,*12,"***************     ****":
                       *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                    *29,"**/**/**",*43,"******",*69,"******.**":
                    *N,*N,*N,*69,"******.**":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N;
.
.         IF        PTCNHB6I=1
.           PRINT     *N;
.         ELSE
            PRINT     *2,"******************************- ":
                      "********************":
                      *N,*15,"**********************************";
.         ENDIF
          PRINT     *N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
.           IF        PTCNHP6I=1
.             PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
.           ELSE
              PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
                        *43,"***********************************",*N:
                        *43,"******************************",*N:
                        *43,"**********************************",*N:
                        *43,"*******************"
.           ENDIF
          ENDIF
          RETURN
+
.         Line up 7
.
PLINE70   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N;
          ENDIF
.
.         BRANCH    PTHCATAL,PLINE70A
.
          PRINT        *2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"******":
                    *43,"**/**/**",*57,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                    "************************************":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*69,"******.**":
                    *N,*N,*N,*N,*N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*N,*2,"******",*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
           RETURN
.
.--------  Using HCA Tail -----
.
PLINE70A  PRINT        *2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"******":
                    *43,"**/**/**",*57,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                    "************************************":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**":
                    *N,*N,*N,*N,*N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*N,*12,"******",*24,"*********",*45,"******";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
           RETURN
+
.         Line up 8
.
PLINE80   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT     *60,"************":
                    *N,*N,*N,*N,*N,*N,*N:
                    *N,*8,"***************************":
                      *45,"***************************":
                    *N,*8,"***************************":
                      *45,"***************************":
                    *N,*8,"***************************":
                      *45,"***************************":
                    *N,*8,"****************     ****":
                      *45,"****************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"**/**/**":
                    *42,"******/****",*57,"**********",*69,"******.**":
                    *N,*N,*N,*29,"***********************************":
                    *69,"******.**":
                    *N,*N,*69,"******.**":
                    *N,*2,"From(On)",*14,"To":
                    *25,"Description",*48,"Ward",*56,"Item",*64,"Rate":
                    *N,*56,"Code":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**":
                    *N,*N,*N,*N,*N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*14,"********************************":
                    *N,*N,*69,"******.**":
                    *N,*14,"******",*25,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 9
.
PLINE90   IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N;
          ENDIF
          PRINT        *13,"******************************":
                       *54,"************************":
                    *N,*13,"******************************":
                       *54,"************************":
                    *N,*13,"******************************":
                       *54,"************************":
                    *N,*13,"***************     ****":
                       *54,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"**/**/**":
                    *43,"**********",*57,"*********",*69,"******.**":
                    *N,*N,*N,*43,"******",*57,"*********",*69,"******.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**":
                    *N,*N,*N,*2,"******************************- ":
                    "********************":
                    *N,*15,"**********************************":
                    *N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*13,"******",*24,"*********":
                    *47,"******",*69,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 10
.
PLINE100  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT     *N,*N,*N,*N:
                    *N,*2,"***************************":
                      *43,"***************************":
                    *N,*2,"***************************":
                      *43,"***************************":
                    *N,*2,"***************************":
                      *43,"***************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"******":
                    *45,"******",*57,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                    "************************************":
                    *N,*N,*N,*2,"*************************************":
                    "*************************************":
                    *N,*N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*N,*2,"******",*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 11
.
PLINE110  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT     *N,*N:
                       *2,"******************************": 
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"**/**/**":
                    *43,"******",*69,"******.**":
                    *N,*N,*N,*69,"******.**":
                    *N,*N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*2,"**/**/**",*11,"**/**/**",*20,"***":
                    *25,"****************************",*51,"*********":
                    *60," *****.**",*69,"******.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*56,"SUB-TOTAL",*69,"******.**":
                    *N,*2,"**/**/**",*11,"**/**/**",*20,"***":
                    *25,"GOVT. BED SUBSIDY",*56," *****.**",*69,"******.**":
                    *N,*N,*56,"INVOICE TOTAL",*69,"******.**":
                    *N,*N,*2,"**/**/**":
                    *25,"PAYMENT RECEIVED WITH THANKS",*69,"******.**":
                    *N,*N,*69,"******.**":
                    *N,*N,*N,*N,*N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*69,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N;
          ENDIF
          RETURN
+
.         Line up 12
. 
PLINE120  
.         BRANCH   PTHCATAL,PLINU12A
          IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N;
          ENDIF
          PRINT       *2,"******************************":
                     *43,"******************************":
                   *N,*2,"******************************":
                     *43,"******************************":
                   *N,*2,"******************************":
                     *43,"******************************":
                   *N,*2,"***************     ****":
                     *43,"***************     ****":
                   *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                   *29,"******",*43,"**/**/**":
                   *57,"**/**/**",*69,"********",*97,"**/**/**":
                   *N,*N,*N,*2,"************":
                   *18,"********************************":
                   "******************************":
                   *N,*N,*N,*N:
                   *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                   *23,"****************************",*49,"*********":
                   *58," *****.**",*69,"******.**":
                   *N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N:
                   *N,*N,*54,"SUB-TOTAL",*69,"******.**":
                   *N,*N,*N,*54,"INVOICE TOTAL",*69,"******.**",*N,*N:
                   *1,"**/**/**":
                   *23,"PAYMENT RECEIVED WITH THANKS",*69,"******.**":
                   *N,*N,*69,"******.**":
                   *N,*N,*N,*N,*N,*N,*N,*69,"******.**":
                   *N,*N,*2,"**/**/**",*12,"********************************":
                   *N,*N,*69,"******.**",*N,*2,"******",*12,"******":
                   *24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
.
.------- Using HCA Tail ----
.
PLINU12A  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N;
          ENDIF
          PRINT       *2,"******************************":
                     *43,"******************************":
                   *N,*2,"******************************":
                     *43,"******************************":
                   *N,*2,"******************************":
                     *43,"******************************":
                   *N,*2,"***************     ****":
                     *43,"***************     ****":
                   *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                   *29,"******",*43,"**/**/**":
                   *57,"**/**/**",*70,"********":
                   *N,*N,*N,*2,"************":
                   *18,"********************************":
                   "******************************":
                   *N,*N,*N,*N:
                   *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                   *23,"****************************",*54,"****":
                   *58," *****.**",*69,"******.**":
                   *N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N:
                   *N,*N,*54,"SUB-TOTAL",*69,"******.**":
                   *N,*N,*N,*54,"INVOICE TOTAL",*69,"******.**",*N,*N:
                   *1,"**/**/**":
                   *23,"PAYMENT RECEIVED WITH THANKS",*69,"******.**":
                   *N,*N,*69,"******.**":
                   *N,*N,*N,*N,*N,*N,*N,*69,"******.**":
                   *N,*N,*2,"**/**/**",*12,"********************************":
                   *N,*N,*69,"******.**",*N,*2,"******":
                   *13,"*********",*25,"******";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
         RETURN
+
.*********************************************************************
.                   PLINE130
.         prints the line-up print for layout 13
.*********************************************************************
PLINE130  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT        *15,"******************************":    * line 7
                    *N,*15,"******************************":
                    *N,*15,"******************************":
                    *N,*15,"******************************",*N:
                    *N,*70,"**/**/**":                          * line 12
                    *N,*15,"******************************":
                       *70,"******":                            * line 13
                    *N,*15,"*************************":         * line 14
                    *N,*15,"*************************":         * line 15
                    *N,*15,"***************     ****":          * line 16
                    *N,*N,*N,*N,*51,"Item":                     * line 20
                    *N,*3,"   Date   ",*14,"Description",*49,"Code":
                    *59,"Reference",*69,"Amount":               * line 21
                    *N,*3,"----------",*14,"---------------------------------":
                    *49,"---------",*59,"---------",*69,"---------": * line 22
                    *N,*3,"**/**/****",*14,"*********************************":
                    *49,"*********",*59,"*********",*69,"******.**"; * line 23
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N;                        * line 7
          ENDIF
          RETURN
+
.         Line up 14
.
PLINE140  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT     *2,"******",*14,"**/**/**":
                   *29,"**/**/**",*43,"**********":
                   *57,"**********",*70,"********",*N,*N,*N:
                   *2,"******",*36,"**********",*70,"**/**/**":
                   *N,*N:
                   *N,*14,"******************************":
                      *54,"************************":
                   *N,*14,"******************************":
                      *54,"************************":
                   *N,*14,"******************************":
                      *54,"************************":
                   *N,*14,"***************     ****":
                      *54,"***************     ****":
                   *N,*N,*30,"S T A T E M E N T   O F   A C C O U N T":
                   *N,*N,*N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                   *23,"****************************",*49,"*********":
                   *58," *****.**",*69,"******.**":
                   *N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N:
                   *N,*N,*54,"SUB-TOTAL",*69,"******.**":
                   *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                   *23,"GOVT. BED SUBSIDY",*54," *****.**",*69,"******.**":
                   *N,*N,*54,"INVOICE TOTAL",*69,"******.**",*N,*N:
                   *1,"**/**/**":
                   *23,"PAYMENT RECEIVED WITH THANKS",*69,"******.**":
                   *N,*N,*69,"******.**":
                   *N,*N,*N,"********************************":
                   *N,*N,*N,*N:
                   *2,"******",*15,"********",*N,*69,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
         RETURN
+
.        Line up 15
.
PLINE150  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT    *N,*N,*N,*N:
                   *60,"************":
                   *N,*N,*N,*N:
                      *8,"***************************":
                     *45,"***************************":
                   *N,*8,"***************************":
                     *45,"***************************":
                   *N,*8,"***************************":
                     *45,"***************************":
                   *N,*8,"***************     ****":
                     *45,"***************     ****":
                   *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                   *29,"**/**/**",*42,"******/****":
                   *57,"**********",*70,"********":
                   *N,*N,*N,*29,"***********************************":
                   *70,"**/**/**":
                   *N,*N,*69,"*********",*N:
                   *2,"From(On)",*14,"To":
                   *25,"Description",*46,"Ward",*51,"Item",*64,"Rate":
                   *N,*51,"Code":
                   *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                   *23,"****************************",*49,"*********":
                   *58," *****.**",*69,"******.**":
                   *N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N:
                   *54,"SUB-TOTAL",*69,"******.**":
                   *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                   *23,"GOVT. BED SUBSIDY",*54," *****.**",*69,"******.**":
                   *N,*N,*54,"INVOICE TOTAL",*69,"******.**",*N,*N:
                   *1,"**/**/**":
                   *23,"PAYMENT RECEIVED WITH THANKS",*69,"******.**":
                   *N,*N,*69,"******.**":
                   *N,*N,*N,*N,*N,*69,"******.**":
                   *N,*N,*2,"**/**/**",*14,"********************************":
                   *N,*N,*69,"******.**",*N:
                   *2,"**",*14,"******",*25,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 16
.
PLINE160  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ENDIF
          PRINT        *43,"******************************":
                    *N,*43,"******************************":
                    *N,*43,"*******************  PH:********":
                    *N,*N:
                    *N,*12,"***************************":
                       *49,"***************************":
                    *N,*12,"***************************":
                       *49,"***************************":
                    *N,*12,"***************************":
                       *49,"***************************":
                    *N,*12,"**************     ****":
                       *49,"**************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**":
                    *29,"******",*45,"******":
                    *57,"**/**/**",*70,"********":
                    *N,*N,*N,*2,"************":
                    *18,"********************************":
                    "******************************":
                    *N,*N,*N,*2,"************":
                    "********************************":
                    "******************************":
                    *N,*N,*N,*51,"ITEM",*N,*51,"CODE":
                    *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                    *23,"****************************",*54,"****":
                    *58," *****.**",*69,"******.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *54,"SUB-TOTAL",*69,"******.**":
                    *N,*1,"**/**/**",*10,"**/**/**",*18,"***":
                    *23,"GOVT. BED SUBSIDY",*54," *****.**",*69,"******.**":
                    *N,*N,*54,"INVOICE TOTAL",*69,"******.**",*N,*N:
                    *1,"**/**/**":
                    *23,"PAYMENT RECEIVED WITH THANKS",*69,"******.**":
                    *N,*N,*69,"******.**":
                    *N,*N,*N,*N,*N,*69,"******.**":
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*69,"******.**",*N,*2,"******",*12,"******":
                    *24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.*********************************************************************
.                   PLINE170
.         prints the line-up print for layout 17 (Lingard)
.*********************************************************************
PLINE170  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT    *N,*N,*N,*N,*N,*N;
          ENDIF
          PRINT       *9,"******************************":
                     *50,"******************************":
                   *N,*9,"******************************":
                     *50,"******************************":
                   *N,*9,"******************************":
                     *50,"******************************":
                   *N,*9,"*******************       ****":
                     *50,"*******************       ****":
                   *N,*N:
                   *N,*2,"********",*15,"******":
                   *27,"**********",*42,"**********":
                   *57,"**/**/**",*71,"********":
                   *N,*N,*N:
                   *2,"ADMISSION DATE : **/**/**":
                   *42,"DISCHARGE DATE : **/**/**":
                   *N,*N,*N:
                   *N,*2,"FROM",*11,"TO",*20,"DAYS":
                   *25,"DESCRIPTION",*51,"ITEM",*61,"RATE",*N,*N:
                   *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                   *N,*N,*N,*N,*N,*N:
                   *71,"******.**",*N,*N,*N,*N,*N:
                   *71,"******.**",*N,*N:
                   *2,"**/**/**",*12,"********************************":
                   *71,"******.**",*N,*N:
                   *71,"******.**",*N:
                   *12,"********",*45,"********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 18
.
PLINE180  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N;
          ENDIF
          PRINT     *12,"******************************":
                    *43,"******************************",*N:
                    *12,"******************************":
                    *43,"******************************",*N:
                    *12,"******************************":
                    *43,"******************************",*N:
                    *12,"**************     ****":
                    *43,"**************     ****",*N,*N,*N,*N:
                    *2,"******",*16,"**/**/**",*29,"**/**/**",*42,"******":
                    *70,"********",*N,*N,*N,*70,"**/**/**":
                    *N,*N,*N,*N,*N:
                    *1,"**/**/**",*10,"**/**/**",*18,"***":
                    *23,"****************************",*49,"*********":
                    *58," *****.**",*69,"******.**":
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *54,"SUB-TOTAL",*69,"******.**",*N,*N:
                    *54,"INVOICE TOTAL",*69,"******.**",*N,*N,*N,*N,*N:
                    *69,"******.**",*N,*N,*N:
                    *2,"*****************************- ********************",*N:
                    *15,"**********************************",*N:
                    *69,"******.**",*N,*N:
                    *2,"**/**/**",*13,"********************************":
                    *N,*N:
                    *69,"******.**",*N,*13,"******",*25,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 19
.
PLINE190  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N;
          ENDIF
          PRINT     *N,*N:
                       *2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"******************************":
                      *43,"******************************":
                    *N,*2,"***************     ****":
                      *43,"***************     ****":
                    *N,*N,*N,*N,*2,"******",*16,"**/**/**",*29,"******":
                    *43,"**/**/**",*57,"**/**/**",*69,"******.**":
                    *N,*N,*N,*2,"************",*18,"**************************":
                                "************************************":
                    *N,*N,*20,"S T A T E M E N T   O F   A C C O U N T":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*69,"******.**",*N,*N,*N,*N,*N:
                    *N,*N,*2,"**/**/**",*12,"********************************":
                    *N,*N,*69,"******.**":
                    *N,*2,"******",*12,"******",*24,"*********";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N
          ENDIF
          RETURN
+
.         Line up 20
.
PLINE200  IF        PTCNLASR=1
            MOVE      ZERO,LINCOUNT
            WHILE     PTCNBLSI>LINCOUNT
              PRINT     *N;
              ADD       ONE,LINCOUNT
            DO
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N,*N;
          ENDIF
.
          PRINT     *48,"ADMIN NO. : ********",*N:
                    *48,"FUND      : ********************",*N:
                    *48,"MRNO      : ********",*N:
                    *N,*N:
                    *14,"*************************":
                    *50,"*************************",*N:
                    *14,"*************************":
                    *50,"*************************",*N:
                    *14,"*************************":
                    *50,"*************************",*N:
                    *14,"***************     ****":
                    *50,"***************     ****",*N:
                    *N,*N,*N:
                    *2,"********************    REFERENCE - ":
                       "********************",*71,"*********":
                    *N,*N,*N,*N:
                    *2,"PAGE **",*13,"********",*26,"***/***",*37,"**/**/****":
                    *50,"**/**/****",*65,"**/**/****":
                    *N,*N,*N,*N,*N:
                    *1,"**/**/**",*10,"**/**/**",*18,"***":
                    *23,"*************************",*49,"*********":
                    *58," *****.**",*70,"******.**",*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *54,"SUB-TOTAL",*70,"******.**",*N:
                    *1,"**/**/**",*10,"**/**/**",*18,"***":
                    *23,"GOVT. BED SUBSIDY",*54," *****.**",*70,"******.**":
                    *N,*N:
                    *54,"INVOICE TOTAL",*70,"******.**":
                    *N,*N:
                    *1,"**/**/**",*23,"PAYMENT RECEIVED WITH THANKS":
                    *70,"******.**":
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *70,"******.**";
          IF        PTCNLASR=1
            PRINT     *F;
          ELSE
            PRINT     *N,*N,*N,*N,*N,*N;
          ENDIF
          RETURN
+
.****************************************************************************
.  SINVH000 - Set up invoice header for stationery templating
.****************************************************************************
SINVH000  OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
.
.                                                                     *I-140395
          IF        STATMENT = 1
            PACK      KEY6,PTCNSMTH,SP10    * setup statements header
          ELSE
            MOVE      SP6,KEY6              * setup invoices header
            LOAD      KEY6,PINVSYS,AECNAEIH,OTCNOTIH,PTCNPAIH,PTCNPAIH
.                                    aae      out      inp      oth
          ENDIF
.
SINVH100  CALL      RDIBTH1                   * read header detail file
          BRANCH    OVRCD,SINVH900
.
          PACK      KEY12,KEY6,SP6        * position on details file
          CALL      RSIBDET1
          CALL      RKIBDET1
          BRANCH    OVRCD,SINVH900
.
          MATCH     KEY6,IBDTSCOD         * match stationery codes
          GOTO      SINVH950 IF EQUAL
.
.------ stationery code not on file ------
.
SINVH900  IF        WEBFLAG=1  
            MOVE      "User Defined Stationery Code not on File. ",WEBTITLE
            CALL      WEBERR00
          ELSE
            DISPLAY   *P1:24,*EL,*B:
                      "User Defined Stationery Code not on File. ";
            CALL      HITENTER
          ENDIF
          MOVE      ONE,EXIT
          GOTO      SINVH999
.
SINVH950  MOVE      ZERO,EXIT
SINVH999  RETURN
+
.****************************************************************************
.  SINVT000 - Set up invoice tail for stationery templating
.****************************************************************************
SINVT000  OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
.
.                                                                     *I-140395
          IF        STATMENT = 1
            PACK      KEY6,PTCNSMTT,SP10    * setup statements tail
          ELSE
            MOVE      SP6,KEY6              * setup invoices tail
            LOAD      KEY6,PINVSYS,AECNAEIT,OTCNOTIT,PTCNPAIT,PTCNPAIT
.                                    aae      out      inp      oth
          ENDIF
.
SINVT100  CALL      RDIBTH1                   * read header detail file
          BRANCH    OVRCD,SINVT900
.
          PACK      KEY12,KEY6,SP6        * position on details file
          CALL      RSIBDET1
          CALL      RKIBDET1
          BRANCH    OVRCD,SINVT900
.
          MATCH     KEY6,IBDTSCOD         * match stationery codes
          GOTO      SINVT950 IF EQUAL
.
.------ stationery code not on file ------
.
SINVT900  IF        WEBFLAG=1  
            MOVE      "User Defined Stationery Code not on File. ",WEBTITLE
            CALL      WEBERR00
          ELSE
            DISPLAY   *P1:24,*EL,*B:
                      "User Defined Stationery Code not on File. ";
            CALL      HITENTER
          ENDIF
          MOVE      ONE,EXIT
          GOTO      SINVT999
.
SINVT950  MOVE      ZERO,EXIT
SINVT999  RETURN
+
