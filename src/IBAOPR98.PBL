.******************************************************************************
.* System   : Operating Room System                                           *
.* Program  : IBAOPR98                                                        *
.* Desc.    : System Parameter Maintenance                                    *
.******************************************************************************
.* Date     : 16/11/89                                                        *
.* Author   : Karin Peak                                                      *
.* Mods.    :                                                                 *
.*        V10.04.01 07/07/2014  J.Tan     CAR 261630                          *
.*                  Removed port number from temp file name                   *
.*        V10.02.01 03/06/2010 J.Tan            CAR 239592                    *
.*                  Renamed PTCDUDF1 to PTCDFELC                              *
.*        V10.00.02 06/07/2010  J.Tan             CAR 200396                  *
.*                  Added new layout 8 for OPCNR66A (IBAOPR66 - Healthscope)  *
.*        V10.00.01 24/03/2010  Steve Armstrong   CAR 218670                  *
.*                  Added new PATCODFD fields to PUDF0000.                    *
.******************************************************************************
.*        V9.09.01  21/08/2007 Peter Vela     CAR 140355                      *
.*                  Added Report Layout for OPCNR66A                          *
.******************************************************************************
.*        V9.08.01 20/02/2007  Jill Habasque  CAR 120004                      *
.*                  Changed OPCNCPOD to allow a value of 2                    *
.******************************************************************************
.*        V9.04.12 01/09/2005  Ebon Clements  CAR 73209                       *
.*                  Removed OPCNFTYP,OPCNFTTM,OPCNTTYP,OPCNTTTM               *
.*                  OPCNDSTR and OPCNDEND as they are not used                *
.******************************************************************************
.*        V9.03.01  05/09/2000  CAR 41899  Mike Laming                        *
.*                  Add OPCNZMIS (Post zero value Misc.Items) to Misc. Screen *
.******************************************************************************
.*        V9.02.07  11/02/03 Tonii  SRS No: 36667                             *
.*                  Added OPCNFTIM - new FROM time for operation duration     *
.*                  Added OPCNTTIM - new TO time for operation duration       *
.*                  Added use of tempfiles                                    *
.*        V9.02.06  02/10/02 J.Tan                                            *
.*                  Added OPCNPTUP - Path name for theatre upload             *
.*                  Added OPCNFTUP - File name for theatre upload             *
.*        V9.02.05  22/07/02 Ebon Clements SRF 19440                          *
.*                  Added OPCNCPOD - Copy operation full description to       *
.*                  surgery details                                           *
.*        V9.02.04  31/01/02 Ashwin                                           *
.*                  Added OPCNSTCT - Staff Category for operating surgeon     *
.*        V9.02.03  20/12/01 J.Tan                                            *
.*                  Added no of pre-op days                                   *
.*        V9.02.02  13/11/01 Greg Horvat                                      *
.*                  Added OPCNMIND - Minutes delayed                          *
.*            V9.02.01  27/09/2001  Mike Laming  2001 RCH                     *
.*                      Add an 'Interface Engine' Option to the IBA Screens   *
.*                      Menu to allow updating of Datagate Flags on 'controlf'*
.*            V5.08.02  29/09/2000  Ebon Clements 509 Mods                    *
.*                      Added option 4 to OPCNWLDS for display defaults.      *
.*            V5.08.01  23/06/2000  Steve Downing                             *
.*                      Fixed display of DOB for OPR43 parameter              *
.******************************************************************************
.*            V5.07.01  21/12/1999 Caleb Sharman  5.08 Mods                   *
.*            Added a 2nd hopital screen                                      *
.*            V5.05.01  22/04/98 J.Tan        SRF  622811                     *
.*                     Added OPCNESIS - Using ESIS from W/L                   *
.*            V5.04.01 20/05/1997  Steve Armstrong         WHL                *
.*                     Added mods for Eltron printer (OPCNBELT)               *
.*            09/01/90  Bill (The Wanker) Dew 
.             Add audits for session and session masters files
.             Maximum duration a operating room can be bookd for in minutes
.             flag to merge overlapping booking by same clinic
.             12/02/90  Bill Dew   ( still wanking )
.             Remove Surgeon anaesthetist and assistant codes these are replaced
.             by indicators on the control file
.             06/03/90 Paul Duncan
.             fixed display of operation usage user def. descriptions
.             03/05/90 Paul Duncan
.             Add operating surgeon code
.             16/05/90 Mill Dew
.             Display user define categorys.  Change user define descriptions
.             to be saved upon POSTING.
.             16/10/90 ROD          
.             Added heaps of new fields. Added sub menu for IBA screens.
.             Added new option 'Operation Time Descriptions'. Thats about it.
.             V5.01.02 22/10/90 Glen Hobby
.                      Added charge codes for implants (OPCNXCHG) and
.                      automatic charging for impants (OPCNXAUT) 
.             V5.01    10/12/90 Graeme Williams
.                      Removed the OPCNBDSF variable
.                      Changed field name for OPCNSUMM
.                      Remove "Maximum Bookings per Session"
.             V5.02    20/12/90 Graeme Williams
.                      Removed maximum value of 100% to session full percentage
.             V5.03    02/01/91 Justin Coates
.                      Added Report Layout screen and OPCNR53A and OPCNANST
.                      03/01/91 ROD        
.                      Added OPCNR59A to Report Layout screen
.                      03/01/91 Justin Coates
.                      Added OPCNR58A, OPCNR60A to Report Layout screen
.             V5.04    07/01/91 Justin Coates
.                      Added OPCNR62A 
.                      09/01/91 Peter Eddey
.                      Added OPCNR66A
.                      09/01/91 Justin Coates
.                      Added OPCNR63A
.                      09/01/91 ROD           
.                      Added OPCNR64A
.            V5.01.03  21/01/91 Justin Coates
.                      Converted back to Version 5.01
.                      14/02/91 ROD
.                      Removed unused parameters. Rearranged parameters.
.                      15/02/91 Graeme Williams
.                      Removed more unused parameters.
.            V5.01.04  06/03/91 J.Tan        SRF 107987
.                      Moved parameters of using operation usage field
.                      6,7,8 to sector 42
.            V5.01.05  03/04/1991 Justin Coates
.                      Added input of OPCNPREC - for Print Operation Records
.            V5.01.06  23/04/1991 Justin Coates  Quote 6883  SRF 107873
.                      Added OPCNWLDS - Op. desc to default to WL desc
.            V5.01.07  09/05/1991 Graeme Williams
.                      Added report layout 4 to OPCNR66A
.            V5.01.08  23/07/91 ROD          SRF 109233  Quote 6995
.                      Added 3 new parameters: OPCNUSAN,OPCNDSAN,OPCNPCOT
.            V5.01.09  09/10/1991 Justin Coates  (User Group Changes)
.                      Added hospital screen 1 
.            V5.01.10  19/11/91 J.Tan             SRF 111659
.                      Added parameter to include part weeks at start of year
.            V5.01.11  30/10/1991 Justin Coates  SRF 111494
.                      Added OPCNCHMB to Misc. screen
.            V5.01.12  24/12/1991 Justin Coates  (User Group Changes)
.                      Added OPCNCBOK to OPCNMM75    
.            V5.01.13  24/02/1992 Justin Coates  SRF 113260
.                      Added OPCNDFCC
.            V5.01.14  13/03/92  ROD                         
.                      Added OPCNCMBD
.            V5.01.15  08/05/92  ROD                         
.                      Added OPCNASLN
.            V5.01.16  03/06/92  ROD                         
.                      Added OPCNPC64
.            V5.01.17  13/10/1992 Steve O'Gorman  SRF 115059
.                      Added OPCNWLTM - Op. time to default to WL time
.            V5.01.18  17/08/92 J.Tan   SRF 116394
.                      Added OPCNWLIT - provisional item to default to W/L proc.
.            V5.01.19  25/10/92 J.Tan   SRF 117585
.                      Added OPCNBKBD
.            V5.01.20  30/10/92 Graeme Williams            Quote 7468
.                      Added option 6 to OPCNR66A
.            V5.01.21  13/01/93 J.Tan  SRF 119861
.                      Moved booking date audit from audit to hospital screen
.            V5.01.22  09/03/1993 Justin Coates  DUDLEY
.                      Added OPCNEALB
.            V5.01.23  07/06/1993  Glenn Berry      SRF 120247
.                      Added Layout 5 to OPCNR62A
.            V5.01.24  16/07/1993  WHIRLPOOL        SRF 440227
.                      Fixed bug with OPCNWLDS in WMSC0000
.            V5.01.25  06/07/1993  Gabrielle        SRF 122899
.
.         V5.01.26  22/11/1993  Glenn Berry      Hawkes Bay Changes
.                   Added OPCNDLVE - Using Doctor Leave feature?
.                   Added OPCNSPET - Using Special Equipment Tracking?
.         V5.01.27  11/04/1994  Rob Leonard      Taranaki Mod (3.2.2)
.                   Added OPCNANTH - Picking sheets by Surgeon/Anaesthetist
.         V5.01.28  06/09/1994  Max White        Taranaki Mods
.                   Added OPCNTREQ - Print Tray contents on Requistions?
.         V5.01.29  08/09/1994  Max White        Hawkes Bay Mods
.                   Added OPCNAPRQ - Using Anaesthetist Preferences in  
.                                    Theatre Requisitions?              
.*        V5.03.01  14/08/1995  Greg Horvat      SRF 135349 & 611042          *
.*                  Changed OPCNWLIT to have the same options as OPCNWLDS     *
.*        V5.03.02  04/01/1996  Greg Horvat                                   *
.*                  Removed the menu program, security key, IBA screen        *
.*                  password & data directory keyins & changed to use a       *
.*                  standard keyin for the IBA screen security password       *
.*        V5.03.03  22.02/1996  Matt                                          *
.*                  Added OPCNLABL - No. of Default Booking Labels            *
.*                                                                            *
.******************************************************************************
.
.$$$$$
.
.  System Parameter Maintenance (IBAOPR98)
.  ---------------------------------------
.
.  - Display Header
.
.  - Open Files
.         CONTROLF
.         PATCODE1
.
.   -Processing Options
.
.       - 0 = Exit
.       - 1 = System Audits
.    
.           - Display audits screen
.           - Process required fields
.
.       - 2 = Summary Breakdowns
.
.           - Display summary breakdown screen 
.           - Read CONTROLF sector 40, position 143 for user breakdown fields
.           - Process required fields
.           - Update CONTROLF sector 40, position 143
.
.       - 3 = Nurse User Define Fields
.
.           - Display screen for user define fields
.           - Read CONTROLF sector 40, position 213 for user define fields
.           - Process required fields
.           - Update CONTROLF sector 40, position 213
.
.       - 4 = Operating Room User Define Fields
.
.           - Display screen for user define fields
.           - Read CONTROLF sector 40, position 203 for user define fields
.           - Process required fields
.           - Update CONTROLF sector 40, position 203
.
.       - 5 = Operating Details User Define Fields
.
.           - Display screen for user define fields
.           - Read CONTROLF sector 40, position 223 for user define fields
.           - Process required fields
.           - Update CONTROLF sector 40, position 223
.
.       - 6 = Operating Team User Define Fields
.
.           - Display screen for user define fields
.           - Read CONTROLF sector 40, position 231 for user define fields
.           - Process required fields
.           - Update CONTROLF sector 40, position 231
.
.       - 7 = Operating Usage User Define Fields
.
.           - Display screen for user define fields
.           - Read CONTROLF sector 40, position 239 for user define fields
.           - Process required fields
.           - Update CONTROLF sector 40, position 239
.
.       - 8 = Operation Time Descriptions
.
.           - Display screen 
.           - Read CONTROLF sector 68, position 1
.           - Process required fields
.           - Update CONTROLF 
.
.       - 9 = Miscellaneous
.
.           - Display miscellaneous screen 
.           - Read CONTROLF sector 40, position 69 
.           - Process required fields
.           - Update CONTROLF sector 40, position 69
.
.       -10 = I.B.A. Controlled Screen 1
.
.           - Enter Password
.           - Display sub menu 
.           - Read CONTROLF sector 40, position 1 & sector 42 various positions
.           - Read CONTROLF sector 42, position 42 (IBA screen 2)
.           - Display chosen I.B.A. screen 
.           - Process required fields
.           - Update CONTROLF sector 40, position 1
.           - Update CONTROLF sector 42 various positions
.
.       -11 = Report Layout screen
.
.   -END
.
.$$$$$
          INC       STD001FD
          INC       IBASEQFD/INC            * Sequential Numbers File
          INC       TFILEVAR/INC            * Generate Temp File Name
          INC       WEBERRFD/INC            * Web Server Error Logging
          INC       IBACONFD/INC
          INC       OPRCONFD/INC
          INC       PATCODFD/INC
+
.**********************************************************************
.*                       VARIABLES                                    *
.**********************************************************************
.
ARTIME    DIM       5               * summary breakdown time
BOXHDR    DIM       80
.
COL       FORM      2
CDESC     DIM       10              * using icd9-cm or mbs description
CDESC0    INIT      "ICD9-CM   "
CDESC1    INIT      "MBS       "
CLSDESC   DIM       10              * using clinic or surgeon
CLSDESC0  INIT      "Clinic    "
CLSDESC1  INIT      "Surgeon   "
.
CMDLINE   DIM       70
.
CODEOA    INIT      "OA"            * operating anaesthetic code
CODEOP    INIT      "OP"            * operating anaesthetic code
CODEOY    INIT      "OY"            * emergency operation type
CODE      DIM       2
.
CODEQ1    INIT      "Q1"            * nurse user define fields
CODEQ2    INIT      "Q2"
CODEQ3    INIT      "Q3"
CODEQ4    INIT      "Q4"
CODEQ5    INIT      "Q5"
CODEQ6    INIT      "Q6"            * operating team user define fields
CODEQ7    INIT      "Q7"
CODEQ8    INIT      "Q8"
CODEQ9    INIT      "Q9"
.
CODEY1    INIT      "Y1"            * operating room user define fields
CODEY2    INIT      "Y2"
CODEY3    INIT      "Y3"
CODEY4    INIT      "Y4"
CODEY5    INIT      "Y5"
CODEY6    INIT      "Y6"            * operating detail user define fields
CODEY7    INIT      "Y7"
CODEY8    INIT      "Y8"
CODEY9    INIT      "Y9"
.
CODEYA    INIT      "YA"            * operating assistant code
CODEYS    INIT      "YS"            * operating surgeon code
.
CODEZ1    INIT      "Z1"            * operating usage user define fields
CODEZ2    INIT      "Z2"
CODEZ3    INIT      "Z3"
CODEZ4    INIT      "Z4"
CODEZ5    INIT      "Z5"
CODEZ6    INIT      "Z6"
CODEZ7    INIT      "Z7"
CODEZ8    INIT      "Z8"
.
COUNT     FORM      4
.
DBOTH     INIT      "Operation & Booking"
DDESC1    DIM       20              * operating detail user define description
DDESC2    DIM       20
DDESC3    DIM       20
DDESC4    DIM       20
DDESC14   DIM       20
DDESC16   DIM       20
DDESC23   DIM       23
DOPB      INIT      "Op, Book & Reason"
DOPR      INIT      "Operation"
DBOK      INIT      "Booking Diagnosis"
DPHN      INIT      "Home Phone No."
DDOB      INIT      "Date of Birth"
DPRO      INIT      "Yes, procedure if blank"
.
DATIME    DIM       5               * summary breakdown time
DANSX     DIM       3
.
DANS1     DIM       3               * nurse user define fields
DANS2     DIM       3
DANS3     DIM       3
DANS4     DIM       3
DANS5     DIM       3
DANS6     DIM       3
DANS7     DIM       3
DANS8     DIM       3
DANS9     DIM       3
DANS10    DIM       3
.
DANS11    DIM       3               * operating room user define fields
DANS12    DIM       3
DANS13    DIM       3
DANS14    DIM       3
DANS15    DIM       3
DANS16    DIM       3
DANS17    DIM       3
DANS18    DIM       3
DANS19    DIM       3
DANS20    DIM       3
.
DANS21    DIM       3               * operating details user define fields
DANS22    DIM       3
DANS23    DIM       3
DANS24    DIM       3
DANS25    DIM       3
DANS26    DIM       3
DANS27    DIM       3
DANS28    DIM       3
.
DANS29    DIM       3               * operating team user define fields
DANS30    DIM       3
DANS31    DIM       3
DANS32    DIM       3
DANS33    DIM       3
DANS34    DIM       3
DANS35    DIM       3
DANS36    DIM       3
.
DANS37    DIM       3               * operating usage user define fields
DANS38    DIM       3
DANS39    DIM       3
DANS40    DIM       3
DANS41    DIM       3
DANS42    DIM       3
DANS43    DIM       3
DANS44    DIM       3
DANS45    DIM       3
DANS46    DIM       3
DANS47    DIM       3
DANS48    DIM       3
DANS49    DIM       3
DANS50    DIM       3
DANS51    DIM       3
DANS52    DIM       3
.
DANS53    DIM       3               * misellaneous screen
DANS54    DIM       3
DANS55    DIM       3
DANS57    DIM       3
DANS58    DIM       3
DANS59    DIM       3
DANS60    DIM       3
DANS61    DIM       3
DANS62    DIM       3
.
DANS56    DIM       3               * i.b.a. screen
DANS70    DIM       3
DANS71    DIM       3
DANS72    DIM       3
DANS73    DIM       3
DANS74    DIM       3
DANS75    DIM       3
.
DIM6      DIM       6
DIM8      DIM       8
DIM20     DIM       20
.
ENDDESC   DIM       25
EOTDESC   DIM       20              * emergency operating type 
.
FORM8     FORM      8
FIELD     FORM      2
FTTMDIM   DIM       1
.
HUNDRED1  FORM      "101"
.
IBAOPT    FORM      1
.
.
NDESC1    DIM       20              * nursing user define description
NDESC2    DIM       20
NDESC3    DIM       20
NDESC4    DIM       20
NDESC5    DIM       20
NUM42     FORM      "42"
.
OSCDESC   DIM       20              * operating surgeon code
OASDESC   DIM       20              * operating assistant code
OANDESC   DIM       20              * operating anaesthetic code
OPPDESC   DIM       20              * operating personnel code
OPSDESC   DIM       20              * Operating surgeon code
.
PASS      DIM       8               * password
PCOTDESC  DIM       20              * Personnel desc for teams
.
RDESC1    DIM       20              * operating room user define description
RDESC2    DIM       20
RDESC3    DIM       20
RDESC4    DIM       20
RDESC5    DIM       20
RDESC6    DIM       20
RDESC7    DIM       20
RDESC8    DIM       20
RDESC9    DIM       20
RDESC10   DIM       20
RDESC11   DIM       20
.
REPDESCA  INIT      "Report Layout 1"
REPDESCB  INIT      "Report Layout 2"
REPDESCC  INIT      "Report Layout 3"
REPDESCD  INIT      "Report Layout 4"
REPDESCE  INIT      "Report Layout 5"
REPDESCF  INIT      "Report Layout 6"
REPDESCG  INIT      "Report Layout 7"
REPDESCH  INIT      "Report Layout 8 HEA"
REPFLAG   FORM      1
.
SOUTHLND  INIT      "Southland"
STRTDESC  DIM       25
.
TIME      DIM       5               * summary breakdown time
TDESC1    DIM       20              * operating team user define description
TDESC2    DIM       20
TDESC3    DIM       20
TDESC4    DIM       20
TTTMDIM   DIM       1
.
UDESC1    DIM       20              * operating usage user define description
UDESC2    DIM       20
UDESC3    DIM       20
UDESC4    DIM       20
UDESC5    DIM       20              
UDESC6    DIM       20
UDESC7    DIM       20
UDESC8    DIM       20
.
VERT      FORM      2
WELLING   INIT      "Wellington"
.
. Description for Operation duration
.
TIMECALL  INIT      "Time Called For          "
TIMEARRV  INIT      "Time Arrived             " 
ANTHPREP  INIT      "Anaesthetic Prep         "
ANTHCOMM  INIT      "Anaesthetic Commenced    " 
PREPSTTM  INIT      "Prep Start Time          " 
SURGSTTM  INIT      "Surgery Start Time       " 
SURGEDTM  INIT      "Surgery End Time         " 
ANTHSEND  INIT      "Anaesthetic End          " 
DRSSTIME  INIT      "Time of Dressing         " 
RECOVRYF  INIT      "Recovery Front           " 
RECOVRYB  INIT      "Recovery Back            " 
RECVRYDY  INIT      "Recovery Day Procedure   " 
RDEPART   INIT      "Ready to Depart          " 
EXITTHTR  INIT      "Exit Theatre Complex     " 
.
TEMPCODE  DIM       8
TEMPDESC  DIM       30
TEMPINDX  INIT      " 39 U1-8 U9-38,1-8"
TEMPNAME  DIM       8
TMPCODE1  IFILE     SQL, FIXED=39, KEY="U1-8"
TMPCODE2  IFILE     SQL, FIXED=39, KEY="U9-38,1-8"
.
PRGID     INIT      "IBAOPR98"
PRGNAM    INIT      "Operating Parameter Maintenance"
VERSION   INIT      "V12.00.00"
+
.**********************************************************************
.*                          MAINLINE                                  *
.**********************************************************************
.
ML0000    CALL      INIT0000           * initialisation
.
ML1000    CALL      SCR0000            * select option  
          BRANCH    EXIT,ML9000
.
          CALL      DOPT0000           * display option selected
          BRANCH    OPTION,ML1500,ML2000,ML2500,ML3000,ML3500:
                           ML4000,ML4500,ML4700,ML5000,ML5500:
                           ML7000,ML8000,ML8100
.
.         Audit Screen
.
ML1500    CALL      DAD0000            * display audits
          CALL      KAD0000            * keyin audits
          BRANCH    EXIT,ML1000
          CALL      WAD0000            * write audits 
          GOTO      ML1000
.
.         Summary Breakdowns
.
ML2000    CALL      SUM0000            * display summary breakdowns
          CALL      USM0000            * update summary breakdowns
          BRANCH    EXIT,ML1000
          CALL      WSM0000            * write summary breakdowns
          GOTO      ML1000
.
.         Nurse Details User Define Fields
.
ML2500    CALL      NUDF0000           * display nurse user define screen
          CALL      UNDF0000           * update nurse user defines
          BRANCH    EXIT,ML1000
          CALL      WNDF0000           * write nurse user defines
          GOTO      ML1000
.
.         Operating Room User Define Fields
.
ML3000    CALL      ORDF0000           * display operating room user defines
          CALL      URDF0000           * update operating room user defines
          BRANCH    EXIT,ML1000
          CALL      WRDF0000           * write operating room user defines
          GOTO      ML1000
.
.         Operating Details User Define Fields
.
ML3500    CALL      ODDF0000           * display operating details user defines
          CALL      UDDF0000           * update operating details user defines
          BRANCH    EXIT,ML1000
          CALL      WDDF0000           * write operating details user defines
          GOTO      ML1000
.
.         Operating Team User Define Fields
.
ML4000    CALL      OTDF0000           * display operating team user defines
          CALL      UTDF0000           * update operating team user defines
          BRANCH    EXIT,ML1000
          CALL      WTDF0000           * write operating team user defines
          GOTO      ML1000
.
.         Operating Usage User Define Fields
.
ML4500    CALL      OUDF0000           * display operating usage user defines
          CALL      UUDF0000           * update operating usage user defines
          BRANCH    EXIT,ML1000
          CALL      WUDF0000           * write operating usage user defines
          GOTO      ML1000
.
.         Operation Time descriptions
.
ML4700    CALL      OTIM0000           * display operation time descriptions
          CALL      UTIM0000           * update operation time descriptions
          BRANCH    EXIT,ML1000
          CALL      WTIM0000           * write operation time descriptions
          GOTO      ML1000
.
.         Miscellaneous Screen                
.
ML5000    CALL      MISC0000           * display miscellaneous screen
          CALL      UMSC0000           * update miscellaneous screen
          BRANCH    EXIT,ML1000        * cancel entered
          CALL      WMSC0000           * write miscellaneous screen
          GOTO      ML1000
.
.         I.B.A. Screens               
.
ML5500    CALL      IBASECUR           * Keyin IBA screen security password
          BRANCH    EXIT,ML1000
.
ML5700    CALL      SUBM0000           * sub menu for Which IBA screen?
          BRANCH    EXIT,ML6000,ML6500,ML6700                          *C-90201
          GOTO      ML1000
.
.         IBA screen 1
.
ML6000    CALL      IBA0000            * display i.b.a. screen 1
          CALL      UIBA0000           * update i.b.a. screen 1
          BRANCH    EXIT,ML5700
          CALL      WIBA0000           * write i.b.a. screen 1
          GOTO      ML5700
.
.         IBA second screen - user defined parameters
.
ML6500    CALL      IUDP0000           * display iba user defined parameters
          CALL      UUDP0000           * ubdate iba screen 2
          BRANCH    EXIT,ML5700
          CALL      WUDP0000           * write iba screen 2
          GOTO      ML5700
.
.         Interface Engine set up                                      *I-90201
.
ML6700    CALL      IDGP0000           * display screen & data         *I-90201
          CALL      UDGP0000           * update parameters             *I-90201
          BRANCH    EXIT,ML5700                                        *I-90201
          CALL      WDGP0000           * write parameters              *I-90201
          GOTO      ML5700                                             *I-90201
.
.         Report Layout screen
.
ML7000    CALL      DRPA0000           * display report screen A
          CALL      URPA0000           * make changes 
          BRANCH    EXIT,ML1000        * cancel chosen
          CALL      WRPA0000           * write values
          GOTO      ML1000
.
.         Hospital screens
.
ML8000    CALL      DHSA0000                * display screen
          CALL      KHSA0000                * keyin details
          BRANCH    EXIT,ML1000             * exit chosen
          CALL      WHSA0000                * write details
          GOTO      ML1000
.
ML8100    CALL      DHSB0000                * display screen
          CALL      KHSB0000                * keyin details
          BRANCH    EXIT,ML1000             * exit chosen
          CALL      WHSB0000                * write details
          GOTO      ML1000
.
.----------------------------------------------------------------------
.                The End...
.----------------------------------------------------------------------
ML9000    CHAIN     PGM
+
.**********************************************************************
.*                        INIT0000                                    *
.*                       Initialisation                               *
.**********************************************************************
.
INIT0000  CALL      DISPHEAD
.
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,TEMPNAME
.
          PACK      BOXHDR,SP30,SP30,SP30
.
INIT9999  RETURN
+
.**********************************************************************
.*                        SCR0000                                     *
.*                       Select Option                                *
.**********************************************************************
.
SCR0000   MOVE      FALSE,EXIT
          MOVE      ZERO,REPFLAG
          HLINE     *G37,2,56,80
          DISPLAY   *P1:3,*EF:
                    *P2:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P2:5,*V2LON,ONE,*HOFF," = Audits":
                    *P2:6,*V2LON,TWO,*HOFF," = Summary Breakdowns":
                    *P2:7,*V2LON,THREE,*HOFF:
                          " = Nurse Details User Defined Fields":
                    *P2:8,*V2LON,FOUR,*HOFF:
                          " = Operating Room User Defined Fields":
                    *P2:9,*V2LON,FIVE,*HOFF:
                          " = Operating Details User Defined Fields":
                    *P2:10,*V2LON,SIX,*HOFF:
                          " = Operating Team User Defined Fields":
                    *P2:11,*V2LON,SEVEN,*HOFF:
                          " = Operating Usage User Defined Fields":
                    *P2:12,*V2LON,EIGHT,*HOFF:
                          " = Operation Time Descriptions":
                    *P2:13,*V2LON,NINE,*HOFF," = Miscellaneous":
                    *P1:14,*V2LON,TEN,*HOFF," = IBA Screens":
                    *P1:15,*V2LON,TEN1,*HOFF," = Report Layouts":
                    *P1:16,*V2LON,TEN2,*HOFF," = Hospital Screens 1":
                    *P1:17,*V2LON,TEN3,*HOFF," = Hospital Screens 2";
.
SCR1000   DISPLAY   *P1:19,*EL,"Option : "
.
          KEYIN     *P10:19,*V2LON,OPTION
.
          BRANCH    OPTION,SCR9999,SCR9999,SCR9999,SCR9999,SCR9999:
                           SCR9999,SCR9999,SCR9999,SCR9999,SCR9999:
                           SCR9999,SCR9999,SCR9999
.
          COMPARE   ZERO,OPTION
          GOTO      SCR9000 IF EQUAL
.
          BEEP
          GOTO      SCR1000
.
SCR9000   MOVE      TRUE,EXIT
.
SCR9999   RETURN
+
.**********************************************************************
.*                        DOPT0000                                    *
.*                   Display Option Selected                          *
.**********************************************************************
.
DOPT0000  BRANCH    OPTION,DOPT1000,DOPT2000,DOPT3000,DOPT4000:
                           DOPT5000,DOPT6000,DOPT7000,DOPT7500:
                           DOPT8000,DOPT9999,DOPT8100,DOPT8200:
                           DOPT8300
.
DOPT1000  DISPLAY   *P56:2,*V2LON,"- Audits "
          GOTO      DOPT9999
.
DOPT2000  DISPLAY   *P56:2,*V2LON,"- Summary Breakdowns "
          GOTO      DOPT9999
.
DOPT3000  DISPLAY   *P56:2,*V2LON,"- Nurse Detail User Def "
          GOTO      DOPT9999
.
DOPT4000  DISPLAY   *P56:2,*V2LON,"- Operating Room User Def "
          GOTO      DOPT9999
.
DOPT5000  DISPLAY   *P56:2,*V2LON,"- Operating Details User Def "
          GOTO      DOPT9999
.
DOPT6000  DISPLAY   *P56:2,*V2LON,"- Operating Team User Def "
          GOTO      DOPT9999
.
DOPT7000  DISPLAY   *P56:2,*V2LON,"- Operating Usage User Def "
          GOTO      DOPT9999
.
DOPT7500  DISPLAY   *P56:2,*V2LON,"- Operation Time Descriptions "
          GOTO      DOPT9999
.
DOPT8000  DISPLAY   *P56:2,*V2LON,"- Miscellaneous "
          GOTO      DOPT9999
.
DOPT8100  DISPLAY   *P56:2,*V2LON,"- Report Layouts "
          GOTO      DOPT9999
.
DOPT8200  DISPLAY   *P56:2,*V2LON,"- Hospital Screens 1"
          GOTO      DOPT9999
.
DOPT8300  DISPLAY   *P56:2,*V2LON,"- Hospital Screens 2"                       
          GOTO      DOPT9999
.
DOPT9999  RETURN
+
.**********************************************************************
.*                           SUBM0000                                 *
.*             sub menu for IBA controlled screens                    *
.**********************************************************************
. -- SUBM0000  DISPLAY   *P56:2,*V2LON,"- IBA Screens ",*P1:4,*EF:      D-90201
SUBM0000  HLINE     *G37,2,56,80                                       *I-90201
          DISPLAY   *P56:2,*V2LON,"- IBA Screens ",*P1:4,*EF:          *I-90201
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = IBA screen 1":
                    *P1:6,*V2LON,TWO,*HOFF," = IBA screen 2":
                    *P1:7,*V2LON,"3",*HOFF," = Interface Engine Set Up":
                    *P1:9,"Option :"
.
SUBM1000  KEYIN     *P10:9,*EL,*V2LON,IBAOPT
.
          COMPARE   ZERO,IBAOPT
          GOTO      SUBM8000 IF EQUAL
          GOTO      SUBM1000 IF LESS
.
          BRANCH    IBAOPT,SUBM4000,SUBM6000,SUBM7000                  *C-90201
          BEEP
          GOTO      SUBM1000
.
SUBM4000  DISPLAY   *P56:2,*V2LON,"- IBA Screen 1 "
          MOVE      ONE,EXIT
          GOTO      SUBM9999
.
SUBM6000  DISPLAY   *P56:2,*V2LON,"- IBA Screen 2 "
          MOVE      TWO,EXIT
          GOTO      SUBM9999
.
SUBM7000  DISPLAY   *P56:2,*V2LON,"- Interface Engine "                *I-90201
          MOVE      THREE,EXIT                                         *I-90201
          GOTO      SUBM9999                                           *I-90201
.
SUBM8000  MOVE      ZERO,EXIT
.
SUBM9999  RETURN
+
.**********************************************************************
.*                           DAD0000                                  *
.*                       Display audits                               *
.**********************************************************************
.
DAD0000   READ      CONTROLF,FORTY;*43,OPCNAUDA,OPCNAUDB,OPCNAUDC:
                                       OPCNAUDD,OPCNAUDE,OPCNAUDF:
                                       OPCNAUDG,OPCNAUDH,OPCNAUDI:
                                       OPCNAUDJ,OPCNAUDK,OPCNAUDL:
                                       OPCNAUDM,OPCNAUDN,OPCNAUDO:
                                       OPCNAUDP,OPCNAUDQ,OPCNAUDR:
                                       OPCNAUDS,OPCNAUDT,OPCNAUDU:
                                       OPCNAUDV,OPCNAUDW,OPCNAUDX:
                                       OPCNAUDY,OPCNAUDZ
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF," Operation averages :":
                    *P1:5,*V2LON," 2.",*HOFF," Operation details  :":
                    *P1:6,*V2LON," 3.",*HOFF," Audit C (Not used) :":
                    *P1:7,*V2LON," 4.",*HOFF," Operating teams    :":
                    *P1:8,*V2LON," 5.",*HOFF," Audit E (Not used) :":
                    *P1:9,*V2LON," 6.",*HOFF," Operation usage    :":
                    *P1:10,*V2LON," 7.",*HOFF," Audit G (Not used) :":
                    *P1:11,*V2LON," 8.",*HOFF," Audit H (Not used) :":
                    *P1:12,*V2LON," 9.",*HOFF," Audit I (Not Used) :":
                    *P1:13,*V2LON,"10.",*HOFF," Audit J (Not used) :":
                    *P1:14,*V2LON,"11.",*HOFF," Audit K (Not used) :":
                    *P1:15,*V2LON,"12.",*HOFF," Audit L (Not used) :":
                    *P1:16,*V2LON,"13.",*HOFF," Session master     :":
                    *P41:4,*V2LON,"14.",*HOFF," Audit N (Not Used) :":
                    *P41:5,*V2LON,"15.",*HOFF," Audit O (Not Used) :":
                    *P41:6,*V2LON,"16.",*HOFF," Preferences ordered:":
                    *P41:7,*V2LON,"17.",*HOFF," Requisitions       :":
                    *P41:8,*V2LON,"18.",*HOFF," Thtre availability :":
                    *P41:9,*V2LON,"19.",*HOFF," Session            :":
                    *P41:10,*V2LON,"20.",*HOFF," Operating rooms    :":
                    *P41:11,*V2LON,"21.",*HOFF," Audit U (Not used) :":
                    *P41:12,*V2LON,"22.",*HOFF," Audit V (Not used) :":
                    *P41:13,*V2LON,"23.",*HOFF," Audit W (Not used) :":
                    *P41:14,*V2LON,"24.",*HOFF," Audit X (Not used) :":
                    *P41:15,*V2LON,"25.",*HOFF," Audit Y (Not used) :":
                    *P41:16,*V2LON,"26.",*HOFF," Audit Z (Not used) :":
                     *P1:18,*V2LON,"27.",*HOFF," No Booking Date    :";
.
          MOVE      ZERO,FORM2
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
.
DAD1000   ADD       ONE,FORM2
          ADD       ONE,CVERT
          COMPARE   "27",FORM2
          GOTO      DAD4000 IF EQUAL
.
          COMPARE   "17",CVERT
          GOTO      DAD2000 IF LESS
.
          MOVE      FOUR,CVERT
          MOVE      "66",CCOL
.
DAD2000   LOAD      FIELD USING FORM2 OF OPCNAUDA,OPCNAUDB,OPCNAUDC:
                                         OPCNAUDD,OPCNAUDE,OPCNAUDF:
                                         OPCNAUDG,OPCNAUDH,OPCNAUDI:
                                         OPCNAUDJ,OPCNAUDK,OPCNAUDL:
                                         OPCNAUDM,OPCNAUDN,OPCNAUDO:
                                         OPCNAUDP,OPCNAUDQ,OPCNAUDR:
                                         OPCNAUDS,OPCNAUDT,OPCNAUDU:
                                         OPCNAUDV,OPCNAUDW,OPCNAUDX:
                                         OPCNAUDY,OPCNAUDZ
          MOVE      DYES,DANSX
          LOAD      DANSX USING FIELD OF DNO
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX;
          GOTO      DAD1000
.
DAD4000   DISPLAY   *P26:18,*V2LON,DANS1;
          RETURN
+
.**********************************************************************
.*                            KAD0000                                 *
.*                         Keyin Audits                               *
.**********************************************************************
.
KAD0000   MOVE      FALSE,EXIT
          CALL      MAINQST            
          COMPARE   ZERO,CCITEM
          GOTO      KAD4000 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      KAD9000 IF EQUAL
          COMPARE   "27",CCITEM
          GOTO      KAD0000 IF NOT LESS
.
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
          ADD       CCITEM,CVERT
          COMPARE   "17",CVERT
          GOTO      KAD1000 IF LESS
.
          MOVE      "66",CCOL
          SUB       "13",CVERT
.
KAD1000   LOAD      FORM1 USING CCITEM OF OPCNAUDA,OPCNAUDB,OPCNAUDC:
                                          OPCNAUDD,OPCNAUDE,OPCNAUDF:
                                          OPCNAUDG,OPCNAUDH,OPCNAUDI:
                                          OPCNAUDJ,OPCNAUDK,OPCNAUDL:
                                          OPCNAUDM,OPCNAUDN,OPCNAUDO:
                                          OPCNAUDP,OPCNAUDQ,OPCNAUDR:
                                          OPCNAUDS,OPCNAUDT,OPCNAUDU:
                                          OPCNAUDV,OPCNAUDW,OPCNAUDX:
                                          OPCNAUDY,OPCNAUDZ
          DISPLAY   *PCCOL:CVERT;
.
          ADD       ONE,FORM1          * set up toggle switch for audits
          LOAD      FORM1,FORM1,ONE,ZERO
          BRANCH    FORM1,KAD2000
          DISPLAY   *V2LON,DYES
          GOTO      KAD3000
KAD2000   DISPLAY   *V2LON,DNO
.
KAD3000   STORE     FORM1 USING CCITEM OF OPCNAUDA,OPCNAUDB,OPCNAUDC:
                                          OPCNAUDD,OPCNAUDE,OPCNAUDF:
                                          OPCNAUDG,OPCNAUDH,OPCNAUDI:
                                          OPCNAUDJ,OPCNAUDK,OPCNAUDL:
                                          OPCNAUDM,OPCNAUDN,OPCNAUDO:
                                          OPCNAUDP,OPCNAUDQ,OPCNAUDR:
                                          OPCNAUDS,OPCNAUDT,OPCNAUDU:
                                          OPCNAUDV,OPCNAUDW,OPCNAUDX:
                                          OPCNAUDY,OPCNAUDZ
          GOTO      KAD0000 
.
KAD4000   MOVE      FALSE,EXIT 
          GOTO      KAD9999
KAD9000   MOVE      TRUE,EXIT
KAD9999   RETURN
+
.**********************************************************************
.*                        WAD0000                                     *
.*                       Write Audits                                 *
.**********************************************************************
.
WAD0000   WRITAB    CONTROLF,FORTY;*43,OPCNAUDA,OPCNAUDB,OPCNAUDC:
                                       OPCNAUDD,OPCNAUDE,OPCNAUDF:
                                       OPCNAUDG,OPCNAUDH,OPCNAUDI:
                                       OPCNAUDJ,OPCNAUDK,OPCNAUDL:
                                       OPCNAUDM,OPCNAUDN,OPCNAUDO:
                                       OPCNAUDP,OPCNAUDQ,OPCNAUDR:
                                       OPCNAUDS,OPCNAUDT,OPCNAUDU:
                                       OPCNAUDV,OPCNAUDW,OPCNAUDX:
                                       OPCNAUDY,OPCNAUDZ
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            SUM0000                                 *
.*                     Display Summary Breakdowns                     *
.**********************************************************************
.
SUM0000   READ      CONTROLF,FORTY;*143,OPCNBRKA,OPCNBRKB,OPCNBRKC:
                                        OPCNBRKD,OPCNBRKE,OPCNBRKF:
                                        OPCNBRKG,OPCNBRKH,OPCNBRKI:
                                        OPCNBRKJ,OPCNBRKK,OPCNBRKL
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Summary Breakdown A                     :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Summary Breakdown B                     :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                  " Summary Breakdown C                     :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Summary Breakdown D                     :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Summary Breakdown E                     :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Summary Breakdown F                     :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                  " Summary Breakdown G                     :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                  " Summary Breakdown H                     :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                  " Summary Breakdown I                     :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                  " Summary Breakdown J                     :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                  " Summary Breakdown K                     :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                  " Summary Breakdown L                     :":
                    *P47:4,*V2LON,OPCNBRKA,*P47:5,OPCNBRKB:
                    *P47:6,OPCNBRKC,*P47:7,OPCNBRKD,*P47:8,OPCNBRKE:
                    *P47:9,OPCNBRKF,*P47:10,OPCNBRKG,*P47:11,OPCNBRKH:
                    *P47:12,OPCNBRKI,*P47:13,OPCNBRKJ,*P47:14,OPCNBRKK:
                    *P47:15,OPCNBRKL
.
          RETURN
+
.**********************************************************************
.*                            USM0000                                 *
.*                     Update Summary Breakdowns                      *
.**********************************************************************
.
USM0000   MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      USM9999 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      USM9000 IF EQUAL
          COMPARE   "13",CCITEM
          GOTO      USM0000 IF NOT LESS
.
          MOVE      CCITEM,FIELD
.
          BRANCH    FIELD,USM1100,USM1200,USM1300,USM1400,USM1500,USM1600:
                          USM1700,USM1800,USM1900,USM2000,USM2100,USM2200
.
          GOTO      USM0000
.
.         Summary Breakdown A
.
USM1100   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:4,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      FOUR,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKA,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKA
          GOTO      USM0000
.
.         Summary Breakdown B
.
USM1200   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:5,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      FIVE,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKB,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKB
          GOTO      USM0000
.
.         Summary Breakdown C
.
USM1300   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:6,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      SIX,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKC,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKC
          GOTO      USM0000
.
.         Summary Breakdown D
.
USM1400   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:7,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      SEVEN,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKD,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKD
          GOTO      USM0000
.
.         Summary Breakdown E
.
USM1500   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:8,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      EIGHT,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKE,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKE
          GOTO      USM0000
.
.         Summary Breakdown F
.
USM1600   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:9,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      NINE,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKF,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKF
          GOTO      USM0000
.
.         Summary Breakdown G
.
USM1700   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:10,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      TEN,CVERT
          CALL      KEYTIME
          PACK      OPCNBRKG,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKG
          GOTO      USM0000
.
.         Summary Breakdown H
.
USM1800   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:11,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      "11",CVERT
          CALL      KEYTIME
          PACK      OPCNBRKH,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKH
          GOTO      USM0000
.
.         Summary Breakdown I
.
USM1900   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:12,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      "12",CVERT
          CALL      KEYTIME
          PACK      OPCNBRKI,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKI
          GOTO      USM0000
.
.         Summary Breakdown J
.
USM2000   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:13,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      "13",CVERT
          CALL      KEYTIME
          PACK      OPCNBRKJ,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKJ
          GOTO      USM0000
.
.         Summary Breakdown K
.
USM2100   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:14,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      "14",CVERT
          CALL      KEYTIME
          PACK      OPCNBRKK,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKK
          GOTO      USM0000
.
.         Summary Breakdown L
.
USM2200   CLOCK     TIME,CTIMEIS
          MOVE      CTIMEIS,DATIME
          DISPLAY   *P47:15,*EL,*V2LON,DATIME
          MOVE      DATIME,ARTIME
          UNPACK    DATIME,CHOUR,ANS,CMIN
          MOVE      "47",CCOL
          MOVE      "15",CVERT
          CALL      KEYTIME
          PACK      OPCNBRKL,CHOUR,COLON,CMIN
          REP       " 0",OPCNBRKL
          GOTO      USM0000
.
USM9000   MOVE      TRUE,EXIT
USM9999   RETURN
+
.**********************************************************************
.*                            WSM0000                                 *
.*                     Write Summary Breakdowns                       *
.**********************************************************************
.
WSM0000   WRITAB    CONTROLF,FORTY;*143,OPCNBRKA,OPCNBRKB,OPCNBRKC:
                                        OPCNBRKD,OPCNBRKE,OPCNBRKF:
                                        OPCNBRKG,OPCNBRKH,OPCNBRKI:
                                        OPCNBRKJ,OPCNBRKK,OPCNBRKL
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            NDUF0000                                *
.*                     Display Nurse User Defines                     *
.**********************************************************************
.
NUDF0000  READ      CONTROLF,FORTY;*213,OPCNUNU1,OPCNUNM1,OPCNUNU2:
                                        OPCNUNM2,OPCNUNU3,OPCNUNM3:
                                        OPCNUNU4,OPCNUNM4,OPCNUNU5:
                                        OPCNUNM5
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OPCNUNU1,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,OPCNUNM1,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,OPCNUNU2,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,OPCNUNM2,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,OPCNUNU3,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,OPCNUNM3,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,OPCNUNU4,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,OPCNUNM4,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,OPCNUNU5,DYES,DNO
.
          MOVE      DNO,DANS10
          LOAD      DANS10,OPCNUNM5,DYES,DNO
.
          PACK      KEY5,CODEQ1,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,NUDF1000
          MOVE      TDESC,NDESC1
.
NUDF1000  PACK      KEY5,CODEQ2,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,NUDF1500
          MOVE      TDESC,NDESC2
.
NUDF1500  PACK      KEY5,CODEQ3,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,NUDF2000
          MOVE      TDESC,NDESC3
.
NUDF2000  PACK      KEY5,CODEQ4,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,NUDF2500
          MOVE      TDESC,NDESC4
.
NUDF2500  PACK      KEY5,CODEQ5,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,NUDF3000
          MOVE      TDESC,NDESC5
.
NUDF3000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Using Nurse Field 1 (Y/N)               :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Cat Q1  Description                     :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Using Nurse Field 2 (Y/N)               :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Cat Q2  Description                     :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                 " Using Nurse Field 3 (Y/N)               :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                 " Cat Q3  Description                     :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                 " Using Nurse Field 4 (Y/N)               :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                 " Cat Q4  Description                     :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:16,*V2LON,"13.",*HOFF:
                                 " Using Nurse Field 5 (Y/N)               :":
                    *P1:17,*V2LON,"14.",*HOFF:
                                 " Cat Q5  Description                     :":
                    *P1:18,*V2LON,"15.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P47:4,*V2LON,DANS1,*P47:5,NDESC1,*P47:6,DANS2:
                    *P47:7,DANS3,*P47:8,NDESC2,*P47:9,DANS4,*P47:10,DANS5:
                    *P47:11,NDESC3,*P47:12,DANS6:
                    *P47:13,DANS7,*P47:14,NDESC4,*P47:15,DANS8,*P47:16,DANS9:
                    *P47:17,NDESC5,*P47:18,DANS10
.
          RETURN
+
.**********************************************************************
.*                            UNDF0000                                *
.*                     Update Nurse User Defines                      *
.**********************************************************************
.
UNDF0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UNDF9000 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      UNDF9990 IF EQUAL
          COMPARE   "16",CCITEM
          GOTO      UNDF0000 IF NOT LESS
.
          MOVE      CCITEM,FIELD
.
          BRANCH    FIELD,UNDF1100,UNDF1200,UNDF1300,UNDF1400,UNDF1500:
                          UNDF1600,UNDF1700,UNDF1800,UNDF1900,UNDF2000:
                          UNDF2100,UNDF2200,UNDF2300,UNDF2400,UNDF2500
.
.         Using Nurse Field 1
.
UNDF1100  KEYIN     *P47:4,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF1120 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF1150 IF EQUAL
          BEEP      
          GOTO      UNDF1100
.
UNDF1120  MOVE      ONE,OPCNUNU1
          GOTO      UNDF1170
.
UNDF1150  MOVE      ZERO,OPCNUNU1
.
UNDF1170  MOVE      DNO,DANS1
          LOAD      DANS1,OPCNUNU1,DYES,DNO
          DISPLAY   *P47:4,*V2LON,DANS1
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Description Nurse Field 1
.
UNDF1200  KEYIN     *P47:5,*EL,*V2LON,NDESC1
          ENDSET    NDESC1
          APPEND    SP20,NDESC1
          RESET     NDESC1
          DISPLAY   *P47:5,*V2LON,NDESC1
          GOTO      UNDF0000
.
.         Mandatory Nurse Field 1
.
UNDF1300  KEYIN     *P47:6,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF1320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF1350 IF EQUAL
          BEEP      
          GOTO      UNDF1300
.
UNDF1320  MOVE      ONE,OPCNUNM1
          GOTO      UNDF1370
.
UNDF1350  MOVE      ZERO,OPCNUNM1
.
UNDF1370  MOVE      DNO,DANS2
          LOAD      DANS2,OPCNUNM1,DYES,DNO
          DISPLAY   *P47:6,*V2LON,DANS2
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Using Nurse Field 2
.
UNDF1400  KEYIN     *P47:7,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF1420 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF1450 IF EQUAL
          BEEP      
          GOTO      UNDF1400
.
UNDF1420  MOVE      ONE,OPCNUNU2
          GOTO      UNDF1470
.
UNDF1450  MOVE      ZERO,OPCNUNU2
.
UNDF1470  MOVE      DNO,DANS3
          LOAD      DANS3,OPCNUNU2,DYES,DNO
          DISPLAY   *P47:7,*V2LON,DANS3
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Description Nurse Field 2
.
UNDF1500  KEYIN     *P47:8,*EL,*V2LON,NDESC2
          ENDSET    NDESC2
          APPEND    SP20,NDESC2
          RESET     NDESC2
          DISPLAY   *P47:8,*V2LON,NDESC2
          GOTO      UNDF0000
.
.         Mandatory Nurse Field 2
.
UNDF1600  KEYIN     *P47:9,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF1620 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF1650 IF EQUAL
          BEEP      
          GOTO      UNDF1600
.
UNDF1620  MOVE      ONE,OPCNUNM2
          GOTO      UNDF1670
.
UNDF1650  MOVE      ZERO,OPCNUNM2
.
UNDF1670  MOVE      DNO,DANS4
          LOAD      DANS4,OPCNUNM2,DYES,DNO
          DISPLAY   *P47:9,*V2LON,DANS4
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Using Nurse Field 3
.
UNDF1700  KEYIN     *P47:10,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF1720 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF1750 IF EQUAL
          BEEP      
          GOTO      UNDF1700
.
UNDF1720  MOVE      ONE,OPCNUNU3
          GOTO      UNDF1770
.
UNDF1750  MOVE      ZERO,OPCNUNU3
.
UNDF1770  MOVE      DNO,DANS5
          LOAD      DANS5,OPCNUNU3,DYES,DNO
          DISPLAY   *P47:10,*V2LON,DANS5
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Description Nurse Field 3
.
UNDF1800  KEYIN     *P47:11,*EL,*V2LON,NDESC3
          ENDSET    NDESC3
          APPEND    SP20,NDESC3
          RESET     NDESC3
          DISPLAY   *P47:11,*V2LON,NDESC3
          GOTO      UNDF0000
.
.         Mandatory Nurse Field 3
.
UNDF1900  KEYIN     *P47:12,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF1920 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF1950 IF EQUAL
          BEEP      
          GOTO      UNDF1900
.
UNDF1920  MOVE      ONE,OPCNUNM3
          GOTO      UNDF1970
.
UNDF1950  MOVE      ZERO,OPCNUNM3
.
UNDF1970  MOVE      DNO,DANS6
          LOAD      DANS6,OPCNUNM3,DYES,DNO
          DISPLAY   *P47:12,*V2LON,DANS6
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Using Nurse Field 4
.
UNDF2000  KEYIN     *P47:13,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF2020 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF2050 IF EQUAL
          BEEP      
          GOTO      UNDF2000
.
UNDF2020  MOVE      ONE,OPCNUNU4
          GOTO      UNDF2070
.
UNDF2050  MOVE      ZERO,OPCNUNU4
.
UNDF2070  MOVE      DNO,DANS7
          LOAD      DANS7,OPCNUNU4,DYES,DNO
          DISPLAY   *P47:13,*V2LON,DANS7
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Description Nurse Field 4
.
UNDF2100  KEYIN     *P47:14,*EL,*V2LON,NDESC4
          ENDSET    NDESC4
          APPEND    SP20,NDESC4
          RESET     NDESC4
          DISPLAY   *P47:14,*V2LON,NDESC4
          GOTO      UNDF0000
.
.         Mandatory Nurse Field 4
.
UNDF2200  KEYIN     *P47:15,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF2220 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF2250 IF EQUAL
          BEEP      
          GOTO      UNDF2200
.
UNDF2220  MOVE      ONE,OPCNUNM4
          GOTO      UNDF2270
.
UNDF2250  MOVE      ZERO,OPCNUNM4
.
UNDF2270  MOVE      DNO,DANS8
          LOAD      DANS8,OPCNUNM4,DYES,DNO
          DISPLAY   *P47:15,*V2LON,DANS8
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Using Nurse Field 5
.
UNDF2300  KEYIN     *P47:16,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF2320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF2350 IF EQUAL
          BEEP      
          GOTO      UNDF2300
.
UNDF2320  MOVE      ONE,OPCNUNU5
          GOTO      UNDF2370
.
UNDF2350  MOVE      ZERO,OPCNUNU5
.
UNDF2370  MOVE      DNO,DANS9
          LOAD      DANS9,OPCNUNU5,DYES,DNO
          DISPLAY   *P47:16,*V2LON,DANS9
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
.         Description Nurse Field 5
.
UNDF2400  KEYIN     *P47:17,*EL,*V2LON,NDESC5
          ENDSET    NDESC5
          APPEND    SP20,NDESC5
          RESET     NDESC5
          DISPLAY   *P47:17,*V2LON,NDESC5
          GOTO      UNDF0000
.
.         Mandatory Nurse Field 5
.
UNDF2500  KEYIN     *P47:18,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UNDF2520 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UNDF2550 IF EQUAL
          BEEP      
          GOTO      UNDF2500
.
UNDF2520  MOVE      ONE,OPCNUNM5
          GOTO      UNDF2570
.
UNDF2550  MOVE      ZERO,OPCNUNM5
.
UNDF2570  MOVE      DNO,DANS10
          LOAD      DANS10,OPCNUNM5,DYES,DNO
          DISPLAY   *P47:18,*V2LON,DANS10
          MOVE      ZERO,OVRCD
          GOTO      UNDF0000
.
UNDF9000  
          MOVE      ZERO,FORM1
UNDF9111
          ADD       ONE,FORM1
          LOAD      TCODE,FORM1,CODEQ1,CODEQ2,CODEQ3,CODEQ4,CODEQ5
          LOAD      DIM20,FORM1,NDESC1,NDESC2,NDESC3,NDESC4,NDESC5
          CALL      PUDF0000
          COMPARE   FIVE,FORM1
          GOTO      UNDF9111 IF NOT EQUAL
          MOVE      ZERO,EXIT
          GOTO      UNDF9999
UNDF9990  MOVE      TRUE,EXIT
UNDF9999  RETURN
+
.**********************************************************************
.*                            WNDF0000                                *
.*                     Write Nurse User Defines                       *
.**********************************************************************
.
WNDF0000  WRITAB    CONTROLF,FORTY;*213,OPCNUNU1,OPCNUNM1,OPCNUNU2:
                                        OPCNUNM2,OPCNUNU3,OPCNUNM3:
                                        OPCNUNU4,OPCNUNM4,OPCNUNU5:
                                        OPCNUNM5
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            ORDF0000                                *
.*                  Display Operating Room User Defines               *
.**********************************************************************
.
ORDF0000  READ      CONTROLF,FORTY;*203,OPCNUOU1,OPCNUOM1,OPCNUOU2:
                                        OPCNUOM2,OPCNUOU3,OPCNUOM3:
                                        OPCNUOU4,OPCNUOM4,OPCNUOU5:
                                        OPCNUOM5
.
          MOVE      DNO,DANS11
          LOAD      DANS11,OPCNUOU1,DYES,DNO
.
          MOVE      DNO,DANS12
          LOAD      DANS12,OPCNUOM1,DYES,DNO
.
          MOVE      DNO,DANS13
          LOAD      DANS13,OPCNUOU2,DYES,DNO
.
          MOVE      DNO,DANS14
          LOAD      DANS14,OPCNUOM2,DYES,DNO
.
          MOVE      DNO,DANS15
          LOAD      DANS15,OPCNUOU3,DYES,DNO
.
          MOVE      DNO,DANS16
          LOAD      DANS16,OPCNUOM3,DYES,DNO
.
          MOVE      DNO,DANS17
          LOAD      DANS17,OPCNUOU4,DYES,DNO
.
          MOVE      DNO,DANS18
          LOAD      DANS18,OPCNUOM4,DYES,DNO
.
          MOVE      DNO,DANS19
          LOAD      DANS19,OPCNUOU5,DYES,DNO
.
          MOVE      DNO,DANS20
          LOAD      DANS20,OPCNUOM5,DYES,DNO
.
          PACK      KEY5,CODEY1,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ORDF1000
          MOVE      TDESC,RDESC1
.
ORDF1000  PACK      KEY5,CODEY2,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ORDF1500
          MOVE      TDESC,RDESC2
.
ORDF1500  PACK      KEY5,CODEY3,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ORDF2000
          MOVE      TDESC,RDESC3
.
ORDF2000  PACK      KEY5,CODEY4,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ORDF2500
          MOVE      TDESC,RDESC4
.
ORDF2500  PACK      KEY5,CODEY5,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ORDF3000
          MOVE      TDESC,RDESC5
.
ORDF3000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Using Operating Room Field 1 (Y/N)     :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Cat Y1  Description                    :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Mandatory (Y/N)                        :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Using Operating Room Field 2 (Y/N)     :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Cat Y2  Description                    :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Mandatory (Y/N)                        :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                 " Using Operating Room Field 3 (Y/N)     :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                 " Cat Y3  Description                    :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                 " Mandatory (Y/N)                        :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                 " Using Operating Room Field 4 (Y/N)     :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                 " Cat Y4  Description                    :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                 " Mandatory (Y/N)                        :":
                    *P1:16,*V2LON,"13.",*HOFF:
                                 " Using Operating Room Field 5 (Y/N)     :":
                    *P1:17,*V2LON,"14.",*HOFF:
                                 " Cat Y5  Description                    :":
                    *P1:18,*V2LON,"15.",*HOFF:
                                 " Mandatory (Y/N)                        :":
                    *P47:4,*V2LON,DANS11,*P47:5,RDESC1,*P47:6,DANS12:
                    *P47:7,DANS13,*P47:8,RDESC2,*P47:9,DANS14:
                    *P47:10,DANS15,*P47:11,RDESC3,*P47:12,DANS16:
                    *P47:13,DANS17,*P47:14,RDESC4,*P47:15,DANS18:
                    *P47:16,DANS19,*P47:17,RDESC5,*P47:18,DANS20
.
          RETURN
+
.******************************************************************************
.                                 PUDF0000
.    Post user define category description  Bill Dew 16/05/90
.    TCODE : set to the category
.    DIM20 : Category description
.    
PUDF0000
.PUDFQQ    DISPLAY   *P1:3,"PUDF> tcode ",TCODE," DIM20 [",DIM20,"]";
.PUDFQQK   KEYIN     ANS
          PACK      KEY5,TCODE,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,PUDF3333
          MOVE      DIM20,TDESC
          CALL      UPCODE1
          GOTO      PUDF9999
PUDF3333  
          MOVE      SP3,ACODE
          MOVE      DIM20,TDESC
          MOVE      SP4,THCSCOD
          MOVE      ZERO,TCFORM6
          MOVE      SP1,TCINDC1
          MOVE      SP1,TCINDC2
          MOVE      SP1,TCINDC3
          MOVE      SP1,TCINDC4
          MOVE      SP1,TCINDC5
          MOVE      SP70,PTCOACTV
          MOVE      SP70,TCINDC6
          MOVE      SP70,TCINDC7
          MOVE      SP70,TCINDC8
          MOVE      SP70,TCINDC9 
          MOVE      SP70,TCINDC10
          MOVE      SP70,TCINDC11
          MOVE      SP70,PTCDDEFT
          MOVE      SP70,PTCDGRPV
          MOVE      SP70,PTCDHOSS
          MOVE      SP70,PTCDDFIC
          MOVE      SP70,TCSPARE
          MOVE      SP70,TCINDC12
          MOVE      SP70,TCINDC13
          MOVE      SP70,TCINDC14
          MOVE      SP70,TCINDC15
          MOVE      SP70,TCINDC16
          MOVE      SP70,TCINDC17
          MOVE      SP70,TCINDC18
          MOVE      SP70,TCINDC19
          MOVE      SP70,TCINDC20
          MOVE      SP70,TCINDC21
          MOVE      SP70,PTCDFELC
          MOVE      SP70,PTCDUDF2
          MOVE      SP70,PTCDUDF3
          MOVE      SP70,PTCDUDF4
          MOVE      SP15,TCSPARE
          CALL      WRCODE1
.
PUDF9999  RETURN
.**********************************************************************
.*                            URDF0000                                *
.*                  Update Operating Room User Defines                *
.**********************************************************************
.
URDF0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      URDF9000 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      URDF9990 IF EQUAL
          COMPARE   "16",CCITEM
          GOTO      URDF0000 IF NOT LESS
.
          MOVE      CCITEM,FIELD
.
          BRANCH    FIELD,URDF1100,URDF1200,URDF1300,URDF1400,URDF1500:
                          URDF1600,URDF1700,URDF1800,URDF1900,URDF2000:
                          URDF2100,URDF2200,URDF2300,URDF2400,URDF2500
.
          GOTO      URDF0000
.
.         Using Operating Room Field 1
.
URDF1100  KEYIN     *P47:4,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF1120 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF1150 IF EQUAL
          BEEP      
          GOTO      URDF1100
.
URDF1120  MOVE      ONE,OPCNUOU1
          GOTO      URDF1170
.
URDF1150  MOVE      ZERO,OPCNUOU1
.
URDF1170  MOVE      DNO,DANS11
          LOAD      DANS11,OPCNUOU1,DYES,DNO
          DISPLAY   *P47:4,*V2LON,DANS11
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Description Operating Room Field 1
.
URDF1200  KEYIN     *P47:5,*EL,*V2LON,RDESC1
          ENDSET    RDESC1
          APPEND    SP20,RDESC1
          RESET     RDESC1
          DISPLAY   *P47:5,*V2LON,RDESC1
          GOTO      URDF0000
.
.         Mandatory Operating Room Field 1
.
URDF1300  KEYIN     *P47:6,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF1320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF1350 IF EQUAL
          BEEP      
          GOTO      URDF1300
.
URDF1320  MOVE      ONE,OPCNUOM1
          GOTO      URDF1370
.
URDF1350  MOVE      ZERO,OPCNUOM1
.
URDF1370  MOVE      DNO,DANS12
          LOAD      DANS12,OPCNUOM1,DYES,DNO
          DISPLAY   *P47:6,*V2LON,DANS12
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Using Operating Room Field 2
.
URDF1400  KEYIN     *P47:7,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF1420 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF1450 IF EQUAL
          BEEP      
          GOTO      URDF1400
.
URDF1420  MOVE      ONE,OPCNUOU2
          GOTO      URDF1470
.
URDF1450  MOVE      ZERO,OPCNUOU2
.
URDF1470  MOVE      DNO,DANS13
          LOAD      DANS13,OPCNUOU2,DYES,DNO
          DISPLAY   *P47:7,*V2LON,DANS13
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Description Operating Room Field 2
.
URDF1500  KEYIN     *P47:8,*EL,*V2LON,RDESC2
          ENDSET    RDESC2
          APPEND    SP20,RDESC2
          RESET     RDESC2
          DISPLAY   *P47:8,*V2LON,RDESC2
          GOTO      URDF0000
.
.         Mandatory Operating Room Field 2
.
URDF1600  KEYIN     *P47:9,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF1620 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF1650 IF EQUAL
          BEEP      
          GOTO      URDF1600
.
URDF1620  MOVE      ONE,OPCNUOM2
          GOTO      URDF1670
.
URDF1650  MOVE      ZERO,OPCNUOM2
.
URDF1670  MOVE      DNO,DANS14
          LOAD      DANS14,OPCNUOM2,DYES,DNO
          DISPLAY   *P47:9,*V2LON,DANS14
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Using Operating Room Field 3
.
URDF1700  KEYIN     *P47:10,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF1720 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF1750 IF EQUAL
          BEEP      
          GOTO      URDF1700
.
URDF1720  MOVE      ONE,OPCNUOU3
          GOTO      URDF1770
.
URDF1750  MOVE      ZERO,OPCNUOU3
.
URDF1770  MOVE      DNO,DANS15
          LOAD      DANS15,OPCNUOU3,DYES,DNO
          DISPLAY   *P47:10,*V2LON,DANS15
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Description Operating Room Field 3
.
URDF1800  KEYIN     *P47:11,*EL,*V2LON,RDESC3
          ENDSET    RDESC3
          APPEND    SP20,RDESC3
          RESET     RDESC3
          DISPLAY   *P47:11,*V2LON,RDESC3
          GOTO      URDF0000
.
.         Mandatory Operating Room Field 3
.
URDF1900  KEYIN     *P47:12,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF1920 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF1950 IF EQUAL
          BEEP      
          GOTO      URDF1900
.
URDF1920  MOVE      ONE,OPCNUOM3
          GOTO      URDF1970
.
URDF1950  MOVE      ZERO,OPCNUOM3
.
URDF1970  MOVE      DNO,DANS16
          LOAD      DANS16,OPCNUOM3,DYES,DNO
          DISPLAY   *P47:12,*V2LON,DANS16
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Using Operating Room Field 4
.
URDF2000  KEYIN     *P47:13,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF2020 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF2050 IF EQUAL
          BEEP      
          GOTO      URDF2000
.
URDF2020  MOVE      ONE,OPCNUOU4
          GOTO      URDF2070
.
URDF2050  MOVE      ZERO,OPCNUOU4
.
URDF2070  MOVE      DNO,DANS17
          LOAD      DANS17,OPCNUOU4,DYES,DNO
          DISPLAY   *P47:13,*V2LON,DANS17
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Description Operating Room Field 4
.
URDF2100  KEYIN     *P47:14,*EL,*V2LON,RDESC4
          ENDSET    RDESC4
          APPEND    SP20,RDESC4
          RESET     RDESC4
          DISPLAY   *P47:14,*V2LON,RDESC4
          GOTO      URDF0000
.
.         Mandatory Operating Room Field 4
.
URDF2200  KEYIN     *P47:15,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF2220 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF2250 IF EQUAL
          BEEP      
          GOTO      URDF2200
.
URDF2220  MOVE      ONE,OPCNUOM4
          GOTO      URDF2270
.
URDF2250  MOVE      ZERO,OPCNUOM4
.
URDF2270  MOVE      DNO,DANS18
          LOAD      DANS18,OPCNUOM4,DYES,DNO
          DISPLAY   *P47:15,*V2LON,DANS18
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Using Operating Room Field 5
.
URDF2300  KEYIN     *P47:16,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF2320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF2350 IF EQUAL
          BEEP      
          GOTO      URDF2300
.
URDF2320  MOVE      ONE,OPCNUOU5
          GOTO      URDF2370
.
URDF2350  MOVE      ZERO,OPCNUOU5
.
URDF2370  MOVE      DNO,DANS19
          LOAD      DANS19,OPCNUOU5,DYES,DNO
          DISPLAY   *P47:16,*V2LON,DANS19
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
.
.         Description Operating Room Field 5
.
URDF2400  KEYIN     *P47:17,*EL,*V2LON,RDESC5
          ENDSET    RDESC5
          APPEND    SP20,RDESC5
          RESET     RDESC5
          DISPLAY   *P47:17,*V2LON,RDESC5
          GOTO      URDF0000
.
.         Mandatory Operating Room Field 5
.
URDF2500  KEYIN     *P47:18,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      URDF2520 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      URDF2550 IF EQUAL
          BEEP      
          GOTO      URDF2500
.
URDF2520  MOVE      ONE,OPCNUOM5
          GOTO      URDF2570
.
URDF2550  MOVE      ZERO,OPCNUOM5
.
URDF2570  MOVE      DNO,DANS20
          LOAD      DANS20,OPCNUOM5,DYES,DNO
          DISPLAY   *P47:18,*V2LON,DANS20
          MOVE      ZERO,OVRCD
          GOTO      URDF0000
URDF9000
          MOVE      ZERO,FORM1
URDF9111
          ADD       ONE,FORM1
          LOAD      TCODE,FORM1,CODEY1,CODEY2,CODEY3,CODEY4,CODEY5
          LOAD      DIM20,FORM1,RDESC1,RDESC2,RDESC3,RDESC4,RDESC5
          CALL      PUDF0000
          COMPARE   FIVE,FORM1
          GOTO      URDF9111 IF NOT EQUAL
          MOVE      ZERO,EXIT
          GOTO      URDF9999
URDF9990  MOVE      TRUE,EXIT
URDF9999  RETURN
+
.**********************************************************************
.*                            WRDF0000                                *
.*                  Write Operating Room User Defines                 *
.**********************************************************************
.
WRDF0000  WRITAB    CONTROLF,FORTY;*203,OPCNUOU1,OPCNUOM1,OPCNUOU2:
                                        OPCNUOM2,OPCNUOU3,OPCNUOM3:
                                        OPCNUOU4,OPCNUOM4,OPCNUOU5:
                                        OPCNUOM5
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.**********************************************************************
.*                            ODDF0000                                *
.*                  Display Operating Details User Defines            *
.**********************************************************************
.
ODDF0000  READ      CONTROLF,FORTY;*224,OPCNUDM1,*226,OPCNUDM2,*228,OPCNUDM3:
                                   *230,OPCNUDM4
.
          MOVE      DNO,DANS22
          LOAD      DANS22,OPCNUDM1,DYES,DNO
.
          MOVE      DNO,DANS24
          LOAD      DANS24,OPCNUDM2,DYES,DNO
.
          MOVE      DNO,DANS26
          LOAD      DANS26,OPCNUDM3,DYES,DNO
.
          MOVE      DNO,DANS28
          LOAD      DANS28,OPCNUDM4,DYES,DNO
.
          PACK      KEY5,CODEY6,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ODDF1000
          MOVE      TDESC,DDESC1
.
ODDF1000  PACK      KEY5,CODEY7,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ODDF1500
          MOVE      TDESC,DDESC2
.
ODDF1500  PACK      KEY5,CODEY8,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ODDF2000
          MOVE      TDESC,DDESC3
.
ODDF2000  PACK      KEY5,CODEY9,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,ODDF2500
          MOVE      TDESC,DDESC4
.
ODDF2500  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Cat Y6  Description                     :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Operating Detail Field 1 Mandatory (Y/N):":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Cat Y7  Description                     :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Operating Detail Field 2 Mandatory (Y/N):":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Cat Y8  Description                     :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Operating Detail Field 3 Mandatory (Y/N):":
                    *P1:10,*V2LON," 7.",*HOFF:
                                 " Cat Y9  Description                     :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                 " Operating Detail Field 4 Mandatory (Y/N):":
                    *P47:4,*V2LON,DDESC1,*P47:5,DANS22:
                    *P47:6,DDESC2,*P47:7,DANS24:
                    *P47:8,DDESC3,*P47:9,DANS26:
                    *P47:10,DDESC4,*P47:11,DANS28
          RETURN
.**********************************************************************
.*                            UDDF0000                                *
.*                  Update Operating Details User Defines             *
.**********************************************************************
.
UDDF0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UDDF9000 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      UDDF9990 IF EQUAL
          COMPARE   "13",CCITEM
          GOTO      UDDF0000 IF NOT LESS
.
          MOVE      CCITEM,FIELD
.
          BRANCH    FIELD,UDDF1200,UDDF1300,UDDF1500:
                          UDDF1600,UDDF1800,UDDF1900:
                          UDDF2100,UDDF2200
.
          GOTO      UDDF0000
.
.         Description Operating Detail Field 1
.
UDDF1200  KEYIN     *P47:4,*EL,*V2LON,DDESC1
          ENDSET    DDESC1
          APPEND    SP20,DDESC1
          RESET     DDESC1
          DISPLAY   *P47:4,*V2LON,DDESC1
          GOTO      UDDF0000
.
.         Mandatory Operating Detail Field 1
.
UDDF1300  KEYIN     *P47:5,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UDDF1320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UDDF1350 IF EQUAL
          BEEP      
          GOTO      UDDF1300
.
UDDF1320  MOVE      ONE,OPCNUDM1
          GOTO      UDDF1370
.
UDDF1350  MOVE      ZERO,OPCNUDM1
.
UDDF1370  MOVE      DNO,DANS22
          LOAD      DANS22,OPCNUDM1,DYES,DNO
          DISPLAY   *P47:5,*V2LON,DANS22
          MOVE      ZERO,OVRCD
          GOTO      UDDF0000
.
.         Description Operating Detail Field 2
.
UDDF1500  KEYIN     *P47:6,*EL,*V2LON,DDESC2
          ENDSET    DDESC2
          APPEND    SP20,DDESC2
          RESET     DDESC2
          DISPLAY   *P47:6,*V2LON,DDESC2
          GOTO      UDDF0000
.
.         Mandatory Operating Detail Field 2
.
UDDF1600  KEYIN     *P47:7,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UDDF1620 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UDDF1650 IF EQUAL
          BEEP      
          GOTO      UDDF1600
.
UDDF1620  MOVE      ONE,OPCNUDM2
          GOTO      UDDF1670
.
UDDF1650  MOVE      ZERO,OPCNUDM2
.
UDDF1670  MOVE      DNO,DANS24
          LOAD      DANS24,OPCNUDM2,DYES,DNO
          DISPLAY   *P47:7,*V2LON,DANS24
          MOVE      ZERO,OVRCD
          GOTO      UDDF0000
.
.         Description Operating Detail Field 3
.
UDDF1800  KEYIN     *P47:8,*EL,*V2LON,DDESC3
          ENDSET    DDESC3
          APPEND    SP20,DDESC3
          RESET     DDESC3
          DISPLAY   *P47:8,*V2LON,DDESC3
          GOTO      UDDF0000
.
.         Mandatory Operating Detail Field 3
.
UDDF1900  KEYIN     *P47:9,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UDDF1920 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UDDF1950 IF EQUAL
          BEEP      
          GOTO      UDDF1900
.
UDDF1920  MOVE      ONE,OPCNUDM3
          GOTO      UDDF1970
.
UDDF1950  MOVE      ZERO,OPCNUDM3
.
UDDF1970  MOVE      DNO,DANS26
          LOAD      DANS26,OPCNUDM3,DYES,DNO
          DISPLAY   *P47:9,*V2LON,DANS26
          MOVE      ZERO,OVRCD
          GOTO      UDDF0000
.
.         Description Operating Detail Field 4
.
UDDF2100  KEYIN     *P47:10,*EL,*V2LON,DDESC4
          ENDSET    DDESC4
          APPEND    SP20,DDESC4
          RESET     DDESC4
          DISPLAY   *P47:10,*V2LON,DDESC4
          GOTO      UDDF0000
.
.         Mandatory Operating Detail Field 4
.
UDDF2200  KEYIN     *P47:11,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UDDF2220 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UDDF2250 IF EQUAL
          BEEP      
          GOTO      UDDF2200
.
UDDF2220  MOVE      ONE,OPCNUDM4
          GOTO      UDDF2270
.
UDDF2250  MOVE      ZERO,OPCNUDM4
.
UDDF2270  MOVE      DNO,DANS28
          LOAD      DANS28,OPCNUDM4,DYES,DNO
          DISPLAY   *P47:11,*V2LON,DANS28
          MOVE      ZERO,OVRCD
          GOTO      UDDF0000
.
UDDF9000
          MOVE      ZERO,FORM1
UDDF9111
          ADD       ONE,FORM1
          LOAD      TCODE,FORM1,CODEY6,CODEY7,CODEY8,CODEY9
          LOAD      DIM20,FORM1,DDESC1,DDESC2,DDESC3,DDESC4
          CALL      PUDF0000
          COMPARE   FOUR,FORM1
          GOTO      UDDF9111 IF NOT EQUAL
          MOVE      ZERO,EXIT
          GOTO      UDDF9999
UDDF9990  MOVE      TRUE,EXIT
UDDF9999  RETURN
+
.**********************************************************************
.*                            WDDF0000                                *
.*                  Write Operating Details User Defines              *
.**********************************************************************
.
WDDF0000  WRITAB    CONTROLF,FORTY;*224,OPCNUDM1,*226,OPCNUDM2,*228,OPCNUDM3:
                                   *230,OPCNUDM4
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            OTDF0000                                *
.*                  Display Operating Team User Defines               *
.**********************************************************************
.
OTDF0000  READ      CONTROLF,FORTY;*231,OPCNUTU1,OPCNUTM1,OPCNUTU2:
                                        OPCNUTM2,OPCNUTU3,OPCNUTM3:
                                        OPCNUTU4,OPCNUTM4
.
          MOVE      DNO,DANS29
          LOAD      DANS29,OPCNUTU1,DYES,DNO
.
          MOVE      DNO,DANS30
          LOAD      DANS30,OPCNUTM1,DYES,DNO
.
          MOVE      DNO,DANS31
          LOAD      DANS31,OPCNUTU2,DYES,DNO
.
          MOVE      DNO,DANS32
          LOAD      DANS32,OPCNUTM2,DYES,DNO
.
          MOVE      DNO,DANS33
          LOAD      DANS33,OPCNUTU3,DYES,DNO
.
          MOVE      DNO,DANS34
          LOAD      DANS34,OPCNUTM3,DYES,DNO
.
          MOVE      DNO,DANS35
          LOAD      DANS35,OPCNUTU4,DYES,DNO
.
          MOVE      DNO,DANS36
          LOAD      DANS36,OPCNUTM4,DYES,DNO
.
          PACK      KEY5,CODEQ6,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,OTDF1000
          MOVE      TDESC,TDESC1
.
OTDF1000  PACK      KEY5,CODEQ7,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,OTDF1500
          MOVE      TDESC,TDESC2
.
OTDF1500  PACK      KEY5,CODEQ8,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,OTDF2000
          MOVE      TDESC,TDESC3
.
OTDF2000  PACK      KEY5,CODEQ9,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,OTDF2500
          MOVE      TDESC,TDESC4
.
OTDF2500  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Using Operating Team Field 1 (Y/N)      :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Cat Q6  Description                     :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Using Operating Team Field 2 (Y/N)      :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Cat Q7  Description                     :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                 " Using Operating Team Field 3 (Y/N)      :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                 " Cat Q8  Description                     :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                 " Using Operating Team Field 4 (Y/N)      :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                 " Cat Q9  Description                     :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                 " Mandatory (Y/N)                         :":
                    *P47:4,*V2LON,DANS29,*P47:5,TDESC1,*P47:6,DANS30:
                    *P47:7,DANS31,*P47:8,TDESC2,*P47:9,DANS32:
                    *P47:10,DANS33,*P47:11,TDESC3,*P47:12,DANS34:
                    *P47:13,DANS35,*P47:14,TDESC4,*P47:15,DANS36
.
          RETURN
+
.**********************************************************************
.*                            UTDF0000                                *
.*                  Update Operating Team User Defines                *
.**********************************************************************
.
UTDF0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UTDF9000 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      UTDF9990 IF EQUAL
          COMPARE   "13",CCITEM
          GOTO      UTDF0000 IF NOT LESS
.
          MOVE      CCITEM,FIELD
.
          BRANCH    FIELD,UTDF1100,UTDF1200,UTDF1300,UTDF1400,UTDF1500:
                          UTDF1600,UTDF1700,UTDF1800,UTDF1900,UTDF2000:
                          UTDF2100,UTDF2200
.
          GOTO      UTDF0000
.
.         Using Operating Team Field 1
.
UTDF1100  KEYIN     *P47:4,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF1120 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF1150 IF EQUAL
          BEEP      
          GOTO      UTDF1100
.
UTDF1120  MOVE      ONE,OPCNUTU1
          GOTO      UTDF1170
.
UTDF1150  MOVE      ZERO,OPCNUTU1
.
UTDF1170  MOVE      DNO,DANS29
          LOAD      DANS29,OPCNUTU1,DYES,DNO
          DISPLAY   *P47:4,*V2LON,DANS29
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Description Operating Team Field 1
.
UTDF1200  KEYIN     *P47:5,*EL,*V2LON,TDESC1
          ENDSET    TDESC1
          APPEND    SP20,TDESC1
          RESET     TDESC1
          DISPLAY   *P47:5,*V2LON,TDESC1
          GOTO      UTDF0000
.
.         Mandatory Operating Team Field 1
.
UTDF1300  KEYIN     *P47:6,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF1320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF1350 IF EQUAL
          BEEP      
          GOTO      UTDF1300
.
UTDF1320  MOVE      ONE,OPCNUTM1
          GOTO      UTDF1370
.
UTDF1350  MOVE      ZERO,OPCNUTM1
.
UTDF1370  MOVE      DNO,DANS30
          LOAD      DANS30,OPCNUTM1,DYES,DNO
          DISPLAY   *P47:6,*V2LON,DANS30
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Using Operating Team Field 2
.
UTDF1400  KEYIN     *P47:7,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF1420 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF1450 IF EQUAL
          BEEP      
          GOTO      UTDF1400
.
UTDF1420  MOVE      ONE,OPCNUTU2
          GOTO      UTDF1470
.
UTDF1450  MOVE      ZERO,OPCNUTU2
.
UTDF1470  MOVE      DNO,DANS31
          LOAD      DANS31,OPCNUTU2,DYES,DNO
          DISPLAY   *P47:7,*V2LON,DANS31
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Description Operating Team Field 2
.
UTDF1500  KEYIN     *P47:8,*EL,*V2LON,TDESC2
          ENDSET    TDESC2
          APPEND    SP20,TDESC2
          RESET     TDESC2
          DISPLAY   *P47:8,*V2LON,TDESC2
          GOTO      UTDF0000
.
.         Mandatory Operating Team Field 2
.
UTDF1600  KEYIN     *P47:9,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF1620 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF1650 IF EQUAL
          BEEP      
          GOTO      UTDF1600
.
UTDF1620  MOVE      ONE,OPCNUTM2
          GOTO      UTDF1670
.
UTDF1650  MOVE      ZERO,OPCNUTM2
.
UTDF1670  MOVE      DNO,DANS32
          LOAD      DANS32,OPCNUTM2,DYES,DNO
          DISPLAY   *P47:9,*V2LON,DANS32
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Using Operating Team Field 3
.
UTDF1700  KEYIN     *P47:10,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF1720 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF1750 IF EQUAL
          BEEP      
          GOTO      UTDF1700
.
UTDF1720  MOVE      ONE,OPCNUTU3
          GOTO      UTDF1770
.
UTDF1750  MOVE      ZERO,OPCNUTU3
.
UTDF1770  MOVE      DNO,DANS33
          LOAD      DANS33,OPCNUTU3,DYES,DNO
          DISPLAY   *P47:10,*V2LON,DANS33
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Description Operating Team Field 3
.
UTDF1800  KEYIN     *P47:11,*EL,*V2LON,TDESC3
          ENDSET    TDESC3
          APPEND    SP20,TDESC3
          RESET     TDESC3
          DISPLAY   *P47:11,*V2LON,TDESC3
          GOTO      UTDF0000
.
.         Mandatory Operating Team Field 3
.
UTDF1900  KEYIN     *P47:12,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF1920 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF1950 IF EQUAL
          BEEP      
          GOTO      UTDF1900
.
UTDF1920  MOVE      ONE,OPCNUTM3
          GOTO      UTDF1970
.
UTDF1950  MOVE      ZERO,OPCNUTM3
.
UTDF1970  MOVE      DNO,DANS34
          LOAD      DANS34,OPCNUTM3,DYES,DNO
          DISPLAY   *P47:12,*V2LON,DANS34
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Using Operating Team Field 4
.
UTDF2000  KEYIN     *P47:13,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF2020 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF2050 IF EQUAL
          BEEP      
          GOTO      UTDF2000
.
UTDF2020  MOVE      ONE,OPCNUTU4
          GOTO      UTDF2070
.
UTDF2050  MOVE      ZERO,OPCNUTU4
.
UTDF2070  MOVE      DNO,DANS35
          LOAD      DANS35,OPCNUTU4,DYES,DNO
          DISPLAY   *P47:13,*V2LON,DANS35
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
.         Description Operating Team Field 4
.
UTDF2100  KEYIN     *P47:14,*EL,*V2LON,TDESC4
          ENDSET    TDESC4
          APPEND    SP20,TDESC4
          RESET     TDESC4
          DISPLAY   *P47:14,*V2LON,TDESC4
          GOTO      UTDF0000
.
.         Mandatory Operating Team Field 4
.
UTDF2200  KEYIN     *P47:15,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UTDF2220 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UTDF2250 IF EQUAL
          BEEP      
          GOTO      UTDF2200
.
UTDF2220  MOVE      ONE,OPCNUTM4
          GOTO      UTDF2270
.
UTDF2250  MOVE      ZERO,OPCNUTM4
.
UTDF2270  MOVE      DNO,DANS36
          LOAD      DANS36,OPCNUTM4,DYES,DNO
          DISPLAY   *P47:15,*V2LON,DANS36
          MOVE      ZERO,OVRCD
          GOTO      UTDF0000
.
UTDF9000
          MOVE      ZERO,FORM1
UTDF9111
          ADD       ONE,FORM1
          LOAD      TCODE,FORM1,CODEQ6,CODEQ7,CODEQ8,CODEQ9
          LOAD      DIM20,FORM1,TDESC1,TDESC2,TDESC3,TDESC4
          CALL      PUDF0000
          COMPARE   FOUR,FORM1
          GOTO      UTDF9111 IF NOT EQUAL
          MOVE      ZERO,EXIT
          GOTO      UTDF9999
UTDF9990  MOVE      TRUE,EXIT
UTDF9999  RETURN
+
.**********************************************************************
.*                            WTDF0000                                *
.*                  Write Operating Team User Defines                 *
.**********************************************************************
.
WTDF0000  WRITAB    CONTROLF,FORTY;*231,OPCNUTU1,OPCNUTM1,OPCNUTU2:
                                        OPCNUTM2,OPCNUTU3,OPCNUTM3:
                                        OPCNUTU4,OPCNUTM4
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            OUDF0000                                *
.*                  Display Operating Usage User Defines              *
.**********************************************************************
.
OUDF0000  READ      CONTROLF,FORTY;*240,OPCNUUM1,*242,OPCNUUM2,*244,OPCNUUM3:
                                   *246,OPCNUUM4,*248,OPCNUUM5
          READ      CONTROLF,FORTY2;*63,OPCNUUM6:
                                    *65,OPCNUUM7,*67,OPCNUUM8
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ1,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC1
.
          MOVE      DNO,DANS38
          LOAD      DANS38,OPCNUUM1,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ2,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC2
.
          MOVE      DNO,DANS40
          LOAD      DANS40,OPCNUUM2,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ3,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC3
.
          MOVE      DNO,DANS42
          LOAD      DANS42,OPCNUUM3,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ4,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC4
.
          MOVE      DNO,DANS44
          LOAD      DANS44,OPCNUUM4,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ5,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC5
.
          MOVE      DNO,DANS46
          LOAD      DANS46,OPCNUUM5,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ6,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC6
.
          MOVE      DNO,DANS48
          LOAD      DANS48,OPCNUUM6,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ7,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC7
.
          MOVE      DNO,DANS50
          LOAD      DANS50,OPCNUUM7,DYES,DNO
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEZ8,SP3
          CALL      RDCODE1
          MOVE      TDESC,UDESC8
.
          MOVE      DNO,DANS52
          LOAD      DANS52,OPCNUUM8,DYES,DNO
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Oper. Usage Field 1 Mandatory (Y/N) :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Cat Z1  Description                 :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Oper. Usage Field 2 Mandatory (Y/N) :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Cat Z2  Description                 :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Oper. Usage Field 3 Mandatory (Y/N) :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Cat Z3  Description                 :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                 " Oper. Usage Field 4 Mandatory (Y/N) :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                  " Cat Z4  Description                 :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                 " Oper. Usage Field 5 Mandatory (Y/N) :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                  " Cat Z5  Description                 :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                 " Oper. Usage Field 6 Mandatory (Y/N) :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                  " Cat Z6  Description                 :":
                    *P1:16,*V2LON,"13.",*HOFF:
                                 " Oper. Usage Field 7 Mandatory (Y/N) :":
                    *P1:17,*V2LON,"14.",*HOFF:
                                  " Cat Z7  Description                 :":
                    *P1:18,*V2LON,"15.",*HOFF:
                                 " Oper. Usage Field 8 Mandatory (Y/N) :":
                    *P1:19,*V2LON,"16.",*HOFF:
                                  " Cat Z8  Description                 :":
                    *P43:4,*V2LON,DANS38,*P43:5,UDESC1:
                    *P43:6,DANS40,*P43:7,UDESC2,*P43:8,DANS42:
                    *P43:9,UDESC3,*P43:10,DANS44,*P43:11,UDESC4:
                    *P43:12,DANS46,*P43:13,UDESC5,*P43:14,DANS48:
                    *P43:15,UDESC6,*P43:16,DANS50,*P43:17,UDESC7:
                    *P43:18,DANS52,*P43:19,UDESC8 
          RETURN
.**********************************************************************
.*                            UUDF0000                                *
.*                  Update Operating Usage User Defines               *
.**********************************************************************
UUDF0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UUDF9000 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      UUDF9990 IF EQUAL
          COMPARE   "25",CCITEM
          GOTO      UUDF0000 IF NOT LESS
.
          MOVE      CCITEM,FIELD
.
          BRANCH    FIELD,UUDF1200,UUDF1300,UUDF1500:
                          UUDF1600,UUDF1800,UUDF1900:
                          UUDF2100,UUDF2200,UUDF2400,UUDF2500:
                          UUDF2700,UUDF2800,UUDF3000:
                          UUDF3100,UUDF3300,UUDF3400
.
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 1
.
UUDF1200  DISPLAY   *P43:4,SP3
          KEYIN     *P43:4,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF1220 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF1250 IF EQUAL
          BEEP      
          GOTO      UUDF1200
.
UUDF1220  MOVE      ONE,OPCNUUM1
          GOTO      UUDF1270
.
UUDF1250  MOVE      ZERO,OPCNUUM1
.
UUDF1270  MOVE      DNO,DANS38
          LOAD      DANS38,OPCNUUM1,DYES,DNO
          DISPLAY   *P43:4,*V2LON,DANS38
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 1
.
UUDF1300  KEYIN     *P43:5,*EL,*V2LON,UDESC1
          ENDSET    UDESC1
          APPEND    SP20,UDESC1
          RESET     UDESC1
          DISPLAY   *P43:5,*V2LON,UDESC1
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 2
.
UUDF1500  DISPLAY   *P43:6,SP3
          KEYIN     *P43:6,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF1520 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF1550 IF EQUAL
          BEEP      
          GOTO      UUDF1500
.
UUDF1520  MOVE      ONE,OPCNUUM2
          GOTO      UUDF1570
.
UUDF1550  MOVE      ZERO,OPCNUUM2
.
UUDF1570  MOVE      DNO,DANS40
          LOAD      DANS40,OPCNUUM2,DYES,DNO
          DISPLAY   *P43:6,*V2LON,DANS40
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 2
.
UUDF1600  KEYIN     *P43:7,*EL,*V2LON,UDESC2
          ENDSET    UDESC2
          APPEND    SP20,UDESC2
          RESET     UDESC2
          DISPLAY   *P43:7,*V2LON,UDESC2
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 3
.
UUDF1800  DISPLAY   *P43:8,SP3
          KEYIN     *P43:8,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF1820 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF1850 IF EQUAL
          BEEP      
          GOTO      UUDF1800
.
UUDF1820  MOVE      ONE,OPCNUUM3
          GOTO      UUDF1870
.
UUDF1850  MOVE      ZERO,OPCNUUM3
.
UUDF1870  MOVE      DNO,DANS42
          LOAD      DANS42,OPCNUUM3,DYES,DNO
          DISPLAY   *P43:8,*V2LON,DANS42
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 3
.
UUDF1900  KEYIN     *P43:9,*EL,*V2LON,UDESC3
          ENDSET    UDESC3
          APPEND    SP20,UDESC3
          RESET     UDESC3
          DISPLAY   *P43:9,*V2LON,UDESC3
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 4
.
UUDF2100  DISPLAY   *P43:10,SP3
          KEYIN     *P43:10,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF2120 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF2150 IF EQUAL
          BEEP      
          GOTO      UUDF2100
.
UUDF2120  MOVE      ONE,OPCNUUM4
          GOTO      UUDF2170
.
UUDF2150  MOVE      ZERO,OPCNUUM4
.
UUDF2170  MOVE      DNO,DANS44
          LOAD      DANS44,OPCNUUM4,DYES,DNO
          DISPLAY   *P43:10,*V2LON,DANS44
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 4
.
UUDF2200  KEYIN     *P43:11,*EL,*V2LON,UDESC4
          ENDSET    UDESC4
          APPEND    SP20,UDESC4
          RESET     UDESC4
          DISPLAY   *P43:11,*V2LON,UDESC4
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 5
.
UUDF2400  DISPLAY   *P43:12,SP3
          KEYIN     *P43:12,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF2420 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF2450 IF EQUAL
          BEEP      
          GOTO      UUDF2400
.
UUDF2420  MOVE      ONE,OPCNUUM5
          GOTO      UUDF2470
.
UUDF2450  MOVE      ZERO,OPCNUUM5
.
UUDF2470  MOVE      DNO,DANS46
          LOAD      DANS46,OPCNUUM5,DYES,DNO
          DISPLAY   *P43:12,*V2LON,DANS46
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 5
.
UUDF2500  KEYIN     *P43:13,*EL,*V2LON,UDESC5
          ENDSET    UDESC5
          APPEND    SP20,UDESC5
          RESET     UDESC5
          DISPLAY   *P43:13,*V2LON,UDESC5
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 6
.
UUDF2700  DISPLAY   *P43:14,SP3
          KEYIN     *P43:14,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF2720 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF2750 IF EQUAL
          BEEP      
          GOTO      UUDF2700
.
UUDF2720  MOVE      ONE,OPCNUUM6
          GOTO      UUDF2770
.
UUDF2750  MOVE      ZERO,OPCNUUM6
.
UUDF2770  MOVE      DNO,DANS48
          LOAD      DANS48,OPCNUUM6,DYES,DNO
          DISPLAY   *P43:14,*V2LON,DANS48
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 6
.
UUDF2800  KEYIN     *P43:15,*EL,*V2LON,UDESC6
          ENDSET    UDESC6
          APPEND    SP20,UDESC6
          RESET     UDESC6
          DISPLAY   *P43:15,*V2LON,UDESC6
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 7
.
UUDF3000  DISPLAY   *P43:16,SP3
          KEYIN     *P43:16,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF3020 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF3050 IF EQUAL
          BEEP      
          GOTO      UUDF3000
.
UUDF3020  MOVE      ONE,OPCNUUM7
          GOTO      UUDF3070
.
UUDF3050  MOVE      ZERO,OPCNUUM7
.
UUDF3070  MOVE      DNO,DANS50
          LOAD      DANS50,OPCNUUM7,DYES,DNO
          DISPLAY   *P43:16,*V2LON,DANS50
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 7
.
UUDF3100  KEYIN     *P43:17,*EL,*V2LON,UDESC7
          ENDSET    UDESC7
          APPEND    SP20,UDESC7
          RESET     UDESC7
          DISPLAY   *P43:17,*V2LON,UDESC7
          GOTO      UUDF0000
.
.         Mandatory Operating Usage Field 8
.
UUDF3300  DISPLAY   *P43:18,SP3
          KEYIN     *P43:18,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDF3320 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDF3350 IF EQUAL
          BEEP      
          GOTO      UUDF3300
.
UUDF3320  MOVE      ONE,OPCNUUM8
          GOTO      UUDF3370
.
UUDF3350  MOVE      ZERO,OPCNUUM8
.
UUDF3370  MOVE      DNO,DANS52
          LOAD      DANS52,OPCNUUM8,DYES,DNO
          DISPLAY   *P43:18,*V2LON,DANS52
          MOVE      ZERO,OVRCD
          GOTO      UUDF0000
.
.         Description Operating Usage Field 8
.
UUDF3400  KEYIN     *P43:19,*EL,*V2LON,UDESC8
          ENDSET    UDESC8
          APPEND    SP20,UDESC8
          RESET     UDESC8
          DISPLAY   *P43:19,*V2LON,UDESC8
          GOTO      UUDF0000
UUDF9000
          MOVE      ZERO,FORM1
UUDF9111
          ADD       ONE,FORM1
          LOAD      TCODE,FORM1,CODEZ1,CODEZ2,CODEZ3,CODEZ4,CODEZ5:
                                CODEZ6,CODEZ7,CODEZ8
          LOAD      DIM20,FORM1,UDESC1,UDESC2,UDESC3,UDESC4,UDESC5:
                                UDESC6,UDESC7,UDESC8
          CALL      PUDF0000
          COMPARE   EIGHT,FORM1
          GOTO      UUDF9111 IF NOT EQUAL
          MOVE      ZERO,EXIT
          GOTO      UUDF9999
UUDF9990  MOVE      TRUE,EXIT
UUDF9999  RETURN
+
.**********************************************************************
.*                            WUDF0000                                *
.*                  Write Operating Usage User Defines                *
.**********************************************************************
.
WUDF0000  WRITAB    CONTROLF,FORTY;*240,OPCNUUM1,*242,OPCNUUM2,*244,OPCNUUM3:
                                   *246,OPCNUUM4,*248,OPCNUUM5
          WRITAB    CONTROLF,FORTY2;*63,OPCNUUM6:
                                    *65,OPCNUUM7,*67,OPCNUUM8
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            MISC0000                                *
.*                  Display Miscellaneous Screen                      *
.**********************************************************************
.
MISC0000  READ      CONTROLF,FORTY;*81,OPCNODSC,OPCNCDSC:
                                   *114,OPCNSESS,*116,OPCNBOOK
          READ      CONTROLF,NUM42;OPCNMDUR,OPCNMERG,*7,OPCNMREC:
                                   OPCNOPSU,*13,OPCNNCOP:
                                   *18,OPCNIDFL,*25,OPCNANAE,OPCNFULL,OPCNSUMM:
                                   *43,OPCNXCHG,OPCNXAUT,*71,OPCNUSAN:
                                   OPCNDSAN,OPCNPCOT,*103,OPCNWKYR:
                                   *239,OPCNZMIS                       *I-90301
.
          MOVE      DNO,DANS53
          LOAD      DANS53,OPCNSESS,DYES,DNO
.
          MOVE      DNO,DANS54
          LOAD      DANS54,OPCNWKYR,DYES
.
          MOVE      DNO,DANS55
          LOAD      DANS55,OPCNBOOK,DYES,DNO
.
          MOVE      DNO,DANS57
          LOAD      DANS57,OPCNMERG,DYES,DNO
.
          MOVE      DNO,DANS58
          LOAD      DANS58,OPCNUSAN,DYES,DNO
.
          MOVE      DYES,DANS59
          LOAD      DANS59,OPCNMREC,DNO,DYES
.
          MOVE      DNO,DANS60                                         *I-90301
          LOAD      DANS60,OPCNZMIS,DYES                               *I-90301
.
          MOVE      DNO,DANS71
          LOAD      DANS71,OPCNIDFL,DYES,DNO
.
          BRANCH    OPCNXCHG,MISC0300
          MOVE      "No ",DANS56
          GOTO      MISC0400
.
MISC0300  MOVE      "Yes",DANS56
.
MISC0400  BRANCH    OPCNXAUT,MISC0500
          MOVE      "No ",DANS70
          GOTO      MISC2000
.
MISC0500  MOVE      "Yes",DANS70
.
MISC2000  MATCH     SP3,OPCNOPSU
          GOTO      MISC2100 IF EQUAL
          PACK      KEY5,CODEOP,OPCNOPSU
          CALL      RDCODE1
          BRANCH    OVRCD,MISC2100
          MOVE      TDESC,OPSDESC
.
MISC2100  MOVE      SP20,PCOTDESC
          MATCH     SP3,OPCNPCOT
          GOTO      MISC2300 IF EQUAL
          PACK      KEY5,CODEOP,OPCNPCOT
          CALL      RDCODE1
          BRANCH    OVRCD,MISC2300
          MOVE      TDESC,PCOTDESC
.
MISC2300  MATCH     SP3,OPCNANAE
          GOTO      MISC2400 IF EQUAL
          PACK      KEY5,CODEOP,OPCNANAE
          CALL      RDCODE1
          BRANCH    OVRCD,MISC2400
          MOVE      TDESC,OPPDESC
.
MISC2400  MOVE      DNO,DANS62
          LOAD      DANS62,OPCNSUMM,DYES,DNO
.
MISC2500  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Oper desc to default to item desc (Y/N) :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Using Session Coordinator         (Y/N) :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Allow Double Bookings of Sessions (Y/N) :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " Display Theatre/Operation description   :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Display Clinic/Surgeon description      :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Maximum session booking duration (mins) :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                  " Merge overlapping records by same clinic:":
                    *P1:11,*V2LON," 8.",*HOFF:
                                  " Post operation codes to med. rec.(Y/N)  :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                  " Operating surgeon code                  :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                  " Operating anaesthetist code             :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                  " Default no. of copies for oper. records :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                  " Sessions 'Full' percentage              :":
                    *P1:16,*V2LON,"13.",*HOFF:
                                  " Session summary without op. desc. (Y/N) :":
                    *P1:17,*V2LON,"14.",*HOFF:
                                  " Charging for implants (Y/N)?            :":
                    *P1:18,*V2LON,"15.",*HOFF:
                                  " Automatic charging for implants (Y/N)?  :":
                    *P1:19,*V2LON,"16.",*HOFF:
                                  " Using second anaesthetist (Y/N)?        :":
                    *P1:20,*V2LON,"17.",*HOFF:
                                  " Description for second anaesthetist     :":
                    *P1:21,*V2LON,"18.",*HOFF:
                                  " Personnel code for teams                :":
                    *P1:22,*V2LON,"19.",*HOFF:
                                  " Include part weeks at start of year(Y/N):":
                    *P1:23,*V2LON,"20.",*HOFF:                         *I-90301
                                  " Post zero value Misc.Items in OPR43(Y/N):":
                    *P47:4,*V2LON,DANS71:
                    *P47:5,DANS53,*P47:6,DANS55,*P47:7,OPCNODSC:
                    *P47:8,OPCNCDSC:
                    *P47:9,OPCNMDUR,*P47:10,DANS57,*P47:11,DANS59:
                    *P47:12,OPCNOPSU,*P52:12,*HOFF,OPSDESC:
                    *P47:13,*V2LON,OPCNANAE,*P52:13,*HOFF,OPPDESC:
                    *P47:14,*V2LON,OPCNNCOP,*P47:15,OPCNFULL:
                    *P47:16,DANS62,*P47:17,DANS56,*P47:18,DANS70:
                    *P47:19,DANS58,*P47:20,OPCNDSAN,*P47:21,OPCNPCOT,*HOFF:
                    *P52:21,PCOTDESC,*P47:22,*V2LON,DANS54:
                    *P47:23,DANS60                                     *I-90301
.
MISC9999  RETURN
+
.**********************************************************************
.*                            UMSC0000                                *
.*                  Update Miscellaneous Screen                       *
.**********************************************************************
.
UMSC0000  CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UMSC9500 IF EQUAL       * Post selected
          COMPARE   "-1",CCITEM
          GOTO      UMSC9000 IF EQUAL       * Cancel selected
.
          MOVE      CCITEM,FIELD
          BRANCH    FIELD,UMSC1400,UMSC1500,UMSC1700,UMSC1800,UMSC1850:
                          UMSC1900,UMSC2000,UMSC3000,UMSC3100,UMSC3500:
                          UMSC5000,UMSC5300,UMSC5600,UMSC5800,UMSC5900:
                          UMSC6600,UMSC6700,UMSC6800,UMSC6900,UMSC7000 *C-90301
          BEEP
          GOTO      UMSC0000
.
. keyin using operation desc to default to item desc
.
UMSC1400  KEYIN     *P47:4,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC1410 IF NOT EQUAL
          MOVE      ONE,OPCNIDFL
          MOVE      DYES,DANS71
          DISPLAY   *P47:4,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC1410  CMATCH    "N",ANS
          GOTO      UMSC1400 IF NOT EQUAL
          MOVE      ZERO,OPCNIDFL
          DISPLAY   *P47:4,*V2LON,"No"
          MOVE      DNO,DANS71
          GOTO      UMSC0000
.
.         Using Session Co-ordinator?
.
UMSC1500  KEYIN     *P47:5,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    ANSY,ANS
          GOTO      UMSC1520 IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      UMSC1550 IF EQUAL
          BEEP      
          GOTO      UMSC1500
UMSC1520  MOVE      ONE,OPCNSESS
          GOTO      UMSC1570
UMSC1550  MOVE      ZERO,OPCNSESS
UMSC1570  MOVE      DNO,DANS53
          LOAD      DANS53,OPCNSESS,DYES,DNO
          DISPLAY   *P47:5,*V2LON,DANS53
          MOVE      ZERO,OVRCD
          GOTO      UMSC0000
.
.      Allow Double Bookings
.
UMSC1700  KEYIN     *P47:6,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    ANSY,ANS
          GOTO      UMSC1720 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UMSC1750 IF EQUAL
          BEEP      
          GOTO      UMSC1700
.
UMSC1720  MOVE      ONE,OPCNBOOK
          GOTO      UMSC1770
.
UMSC1750  MOVE      ZERO,OPCNBOOK
.
UMSC1770  MOVE      DNO,DANS55
          LOAD      DANS55,OPCNBOOK,DYES,DNO
          DISPLAY   *P47:6,*V2LON,DANS55
          MOVE      ZERO,OVRCD
          GOTO      UMSC0000
.
.         Theatre/Operation Description
.
UMSC1800  KEYIN     *P47:7,*EL,*V2LON,OPCNODSC
          DISPLAY   *P47:7,*V2LON,OPCNODSC
          MOVE      ZERO,OVRCD
          GOTO      UMSC0000
.
.         Clinic/Surgeon Description
.
UMSC1850  KEYIN     *P47:8,*EL,*V2LON,OPCNCDSC
          DISPLAY   *P47:8,*V2LON,OPCNCDSC
          MOVE      ZERO,OVRCD
          GOTO      UMSC0000
.
. maximum session booking duration
.
UMSC1900  KEYIN     *P47:9,*EL,*V2LON,OPCNMDUR
          DISPLAY   *P47:9,*V2LON,OPCNMDUR
          GOTO      UMSC0000
.
. merge overlapping records by same clinic 
.
UMSC2000  KEYIN     *P47:10,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC2010 IF NOT EQUAL
          MOVE      ONE,OPCNMERG
          MOVE      DYES,DANS57
          DISPLAY   *P47:10,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC2010  CMATCH    "N",ANS
          GOTO      UMSC2000 IF NOT EQUAL
          MOVE      ZERO,OPCNMERG
          DISPLAY   *P47:10,*V2LON,"No"
          MOVE      DNO,DANS57
          GOTO      UMSC0000
.
. post operation codes to med rec
.
UMSC3000  KEYIN     *P47:11,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC3010 IF NOT EQUAL
          MOVE      ZERO,OPCNMREC
          MOVE      DYES,DANS59
          DISPLAY   *P47:11,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC3010  CMATCH    "N",ANS
          GOTO      UMSC3000 IF NOT EQUAL
          MOVE      ONE,OPCNMREC
          DISPLAY   *P47:11,*V2LON,"No"
          MOVE      DNO,DANS59
          GOTO      UMSC0000
.
. operating surgeon code
.
UMSC3100  KEYIN     *P47:12,*EL,*V2LON,OPCNOPSU
.
          ENDSET    OPCNOPSU
          APPEND    SP3,OPCNOPSU
          RESET     OPCNOPSU
.
          MATCH     SP3,OPCNOPSU
          GOTO      UMSC3150 IF NOT EQUAL
.
          MATCH     QUEST,OPCNOPSU
          GOTO      UMSC3100 IF EQUAL
.
          DISPLAY   *P47:12,*EL
          GOTO      UMSC0000
.
UMSC3150  PACK      KEY5,CODEOP,OPCNOPSU
          CALL      RDCODE1
          BRANCH    OVRCD,UMSC3200
.
          MATCH     "S",TCINDC1
          GOTO      UMSC3300 IF NOT EQUAL
.
          DISPLAY   *P47:12,*V2LON,OPCNOPSU,*P52:12,*HOFF,TDESC
.
          GOTO      UMSC0000
. 
UMSC3200  DISPLAY   *P1:24,*B,*V2LON,"Operating surgeon code not on file. ";
          CALL      HITENTER
          GOTO      UMSC3100
.
UMSC3300  DISPLAY   *P1:24,*B,*V2LON,"Must be an Operating Surgeon code. ";
          CALL      HITENTER
          GOTO      UMSC3100
.
. keyin Operating anaesthetist code
.
UMSC3500  KEYIN     *P47:13,*EL,*V2LON,OPCNANAE
.
          ENDSET    OPCNANAE
          APPEND    SP3,OPCNANAE
          RESET     OPCNANAE
.
          MATCH     SP3,OPCNANAE
          GOTO      UMSC3550 IF NOT EQUAL
.
          MATCH     QUEST,OPCNANAE
          GOTO      UMSC3500 IF EQUAL
.
          DISPLAY   *P47:13,*EL
          GOTO      UMSC0000
.
UMSC3550  PACK      KEY5,CODEOP,OPCNANAE
          CALL      RDCODE1
          BRANCH    OVRCD,UMSC3600
.
          DISPLAY   *P47:13,*V2LON,OPCNANAE,*P52:13,*HOFF,TDESC
.
          GOTO      UMSC0000
. 
UMSC3600  DISPLAY   *P1:24,*B,*V2LON,"Operating Anaesthetist code not on file. ";
          CALL      HITENTER
          GOTO      UMSC3500
.
. default no of copies
.
UMSC5000  KEYIN     *P47:14,*DV,OPCNNCOP,*P47:14,*V2LON,OPCNNCOP,*P47:14,*DV:
                    OPCNNCOP
          COMPARE   OPCNNCOP,ZERO
          GOTO      UMSC5000 IF NOT LESS
          GOTO      UMSC0000
.
. session full percentage
.
UMSC5300  KEYIN     *P47:15,*EL:
                    *P47:15,*V2LON,OPCNFULL:
                    *P47:15,*DV,OPCNFULL
          COMPARE   ZERO,OPCNFULL
          GOTO      UMSC5300 IF LESS
          GOTO      UMSC0000
.
. session summary
.
UMSC5600  KEYIN     *P47:16,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC5700 IF NOT EQUAL
          MOVE      ONE,OPCNSUMM
          MOVE      DYES,DANS62
          DISPLAY   *P47:16,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC5700  CMATCH    "N",ANS
          GOTO      UMSC5600 IF NOT EQUAL
          MOVE      ZERO,OPCNSUMM
          DISPLAY   *P47:16,*V2LON,"No"
          MOVE      DNO,DANS62
          GOTO      UMSC0000
.
. keyin charging for implants?
.
UMSC5800  KEYIN     *P47:17,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC5810 IF NOT EQUAL
          MOVE      ONE,OPCNXCHG
          MOVE      DYES,DANS56
          DISPLAY   *P47:17,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC5810  CMATCH    "N",ANS
          GOTO      UMSC5800 IF NOT EQUAL
          MOVE      ZERO,OPCNXCHG
          DISPLAY   *P47:17,*V2LON,"No"
          MOVE      DNO,DANS56
          GOTO      UMSC0000
.
.         Automatic charging for implants
.
UMSC5900  KEYIN     *P47:18,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC5910 IF NOT EQUAL
          MOVE      ONE,OPCNXAUT
          MOVE      DYES,DANS70
          DISPLAY   *P47:18,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC5910  CMATCH    "N",ANS
          GOTO      UMSC5900 IF NOT EQUAL
          MOVE      ZERO,OPCNXAUT
          DISPLAY   *P47:18,*V2LON,"No"
          MOVE      DNO,DANS70
          GOTO      UMSC0000
.
. enter 'Using second anaesthetist?'
.
UMSC6600  KEYIN     *P47:19,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    "Y",ANS
          GOTO      UMSC6610 IF NOT EQUAL
          MOVE      ONE,OPCNUSAN
          MOVE      DYES,DANS58
          DISPLAY   *P47:19,*V2LON,"Yes"
          GOTO      UMSC0000
UMSC6610  CMATCH    "N",ANS
          GOTO      UMSC6600 IF NOT EQUAL
          MOVE      ZERO,OPCNUSAN
          DISPLAY   *P47:19,*V2LON,"No"
          MOVE      DNO,DANS58
          GOTO      UMSC0000
.
. keyin description for 2nd anaesthetist
.
UMSC6700  KEYIN     *P47:20,*EL,*V2LON,OPCNDSAN
          ENDSET    OPCNDSAN
          APPEND    SP20,OPCNDSAN
          RESET     OPCNDSAN
          GOTO      UMSC0000
.
. keyin Personnel code for teams
.
UMSC6800  KEYIN     *P47:21,*EL,*V2LON,OPCNPCOT
.
          ENDSET    OPCNPCOT
          APPEND    SP3,OPCNPCOT
          RESET     OPCNPCOT
.
          MATCH     SP3,OPCNPCOT
          GOTO      UMSC6850 IF NOT EQUAL
.
          MATCH     QUEST,OPCNPCOT
          GOTO      UMSC6800 IF EQUAL
.
          DISPLAY   *P47:21,*EL
          GOTO      UMSC0000
.
UMSC6850  PACK      KEY5,CODEOP,OPCNPCOT
          CALL      RDCODE1
          BRANCH    OVRCD,UMSC6860
.
          DISPLAY   *P47:21,*V2LON,OPCNPCOT,*P52:21,*HOFF,TDESC
.
          GOTO      UMSC0000
. 
UMSC6860  DISPLAY   *P1:24,*B,*EL,*V2LON,"Invalid code.  ";
          CALL      HITENTER
          GOTO      UMSC6800
.
.         Include part week at start of year ?
.
UMSC6900  KEYIN     *P47:22,*DV,UNDLN1,*EL:
                    *P47:22,*V2LON,ANS
          REP       UPPLOW,ANS
.
          MATCH     ANSN,ANS
          GOTO      UMSC6910 IF EQUAL       * No entered
.
          MATCH     ANSY,ANS
          GOTO      UMSC6920 IF EQUAL       * Yes entered
.
          BEEP
          GOTO      UMSC6900
.
.         No entered
.
UMSC6910  MOVE      ZERO,OPCNWKYR           * set to zero
          DISPLAY   *P47:22,*V2LON,"No",*EL;
          GOTO      UMSC0000
.
.         Yes entered
.
UMSC6920  MOVE      ONE,OPCNWKYR            * set to one
          DISPLAY   *P47:22,*V2LON,"Yes",*EL;
          GOTO      UMSC0000
.
.* ***************************************** Start of Addition         *I-90301
. post zero value misc. items in IBAOPR43
.
UMSC7000  KEYIN     *P47:23,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    ANSY,ANS
          GOTO      UMSC7010 IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      UMSC7010 IF EQUAL
          GOTO      UMSC7000
.
UMSC7010  REP       "N0Y1",ANS
          MOVE      ANS,OPCNZMIS
          MOVE      DNO,DANS60
          LOAD      DANS60,OPCNZMIS,DYES
          DISPLAY   *P47:23,*V2LON,DANS60
          GOTO      UMSC0000
.* ***************************************** End of Addition           *I-90301
.
UMSC9000  MOVE      TRUE,EXIT               * Cancel entered
          GOTO      UMSC9999
.
UMSC9500  MOVE      FALSE,EXIT              * Post entered
.
UMSC9999  RETURN
+
.**********************************************************************
.*                            WMSC0000                                *
.*                  Write Miscellaneous Screen                        *
.**********************************************************************
.
WMSC0000  WRITAB    CONTROLF,FORTY;*81,OPCNODSC,OPCNCDSC:
                                   *114,OPCNSESS,*116,OPCNBOOK
          WRITAB    CONTROLF,NUM42;OPCNMDUR,OPCNMERG,*7,OPCNMREC:
                                   OPCNOPSU,*13,OPCNNCOP:
                                   *18,OPCNIDFL,*25,OPCNANAE,OPCNFULL,OPCNSUMM:
                                   *43,OPCNXCHG,OPCNXAUT,*71,OPCNUSAN:
                                   OPCNDSAN,OPCNPCOT,*103,OPCNWKYR:
                                   *239,OPCNZMIS                       *I-90301
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            IBA0000                                 *
.*                     Display I.B.A. Screen 1                        *
.**********************************************************************
.
IBA0000   READ      CONTROLF,FORTY;*111,OPCNCLSU,OPCNCODE,OPCNRUSI
          READ      CONTROLF,NUM42;*19,OPCNFOTM,OPCNTOTM:
                                   *32,OPCNUNIQ,*68,OPCNPREC:
                    *107,OPCNOTSU,OPCNCTSU,*113,OPCNMM65,*116,OPCNMM75
.
          MOVE      DNO,DANS56
          LOAD      DANS56,OPCNRUSI,DYES,DNO
.
          MOVE      CDESC0,CDESC
          LOAD      CDESC,OPCNCODE,CDESC1
.
          MOVE      CLSDESC0,CLSDESC
          LOAD      CLSDESC,OPCNCLSU,CLSDESC1
.
          MOVE      WELLING,DIM20           * default to wellington
          LOAD      DIM20,OPCNPREC,SOUTHLND 
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OPCNMM65,DYES
          MOVE      DNO,DANS2
          LOAD      DANS2,OPCNMM75,DYES
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " (No longer used)                        :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " (No longer used)                        :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " (No longer used)                        :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                 " (No longer used)                        :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                 " Using MBS/ICD9 Codes                    :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                 " Using RUS Interface (Y/N)               :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                 " Using Clinic or Surgeon                 :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                 " From time for operation duration (1-3)  :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                 " To time for operation duration (2-4)    :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                 "                                         :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                 "                                         :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                 " Next Unique Id Number                   :":
                    *P1:16,*V2LON,"13.",*HOFF:
                                 " Format for Print Operation Records      :":
                    *P1:17,*V2LON,"14.",*HOFF:
                                 "                                         :":
                    *P1:18,*V2LON,"15.",*HOFF:
                                 "                                         :":
                    *P1:19,*V2LON,"16.",*HOFF:
                                 " Which User Defined field is in OPROTSFD :":
                    *P1:20,*V2LON,"17.",*HOFF:
                                 " Which User Defined field is in OPRCTSFD :":
                    *P1:21,*V2LON,"18.",*HOFF:
                                 " Change Descs. to major/minor in OPR65 ? :":
                    *P1:22,*V2LON,"19.",*HOFF:
                                 " Change Descs. to major/minor in OPR75 ? :":
                    *P47:8,*V2LON,OPCNCODE,*P47:9,DANS56:
                    *P47:10,OPCNCLSU,*P50:10,*HOFF,CLSDESC,*V2LON:
                    *P47:11,OPCNFOTM,*P47:12,OPCNTOTM:
                    *P47:15,OPCNUNIQ,*P47:16,OPCNPREC,*HOFF,SP2,DIM20:
                    *P47:19,OPCNOTSU,*P47:20,OPCNCTSU,*P47:21,DANS1:
                    *P47:22,DANS2
.
IBA9999   RETURN
+
.**********************************************************************
.*                            UIBA0000                                *
.*                      Update I.B.A. Screen 1                        *
.**********************************************************************
.
UIBA0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UIBA9999 IF EQUAL       * Post selected
          GOTO      UIBA9000 IF LESS        * Cancel selected
.
          MOVE      CCITEM,FIELD
          BRANCH    FIELD,UIBA1100,UIBA1200,UIBA1300,UIBA1400,UIBA1700:
                          UIBA1800,UIBA2100,UIBA4000,UIBA4300,UIBA0000:
                          UIBA0000,UIBA5200,UIBA5500,UIBA0000,UIBA0000:
                          UIBA7000,UIBA7500,UIBA8000,UIBA8500
.
          BEEP
          GOTO      UIBA0000
.
UIBA1100  MOVE      ZERO,OVRCD
          GOTO      UIBA0000
.
UIBA1200  MOVE      ZERO,OVRCD
          GOTO      UIBA0000
.
UIBA1300  MOVE      ZERO,OVRCD
          GOTO      UIBA0000
.
UIBA1400  MOVE      ZERO,OVRCD
          GOTO      UIBA0000
.
.         Using ICD9-CM or MBS
.
UIBA1700  DISPLAY   *P1:23,*EL,"0 = ICD9-CM, 1 = MBS",*P47:8,SP3
          KEYIN     *P47:8,*V2LON,FORM2
          ADD       ONE,FORM2
          BRANCH    FORM2,UIBA1750,UIBA1750
          BEEP  
          GOTO      UIBA1700
.
UIBA1750  SUB       ONE,FORM2
          MOVE      FORM2,OPCNCODE
          MOVE      CDESC0,CDESC
          LOAD      CDESC,OPCNCODE,CDESC1
          DISPLAY   *P47:8,*EL,*V2LON,OPCNCODE,*P50:8,CDESC:
                    *P1:23,*EL
          GOTO      UIBA0000
.
.         Using RUS Interface
.
UIBA1800  KEYIN     *P47:9,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    ANSY,ANS
          GOTO      UIBA1820 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UIBA1850 IF EQUAL
          BEEP      
          GOTO      UIBA1800
.
UIBA1820  MOVE      ONE,OPCNRUSI
          GOTO      UIBA1870
.
UIBA1850  MOVE      ZERO,OPCNRUSI
.
UIBA1870  MOVE      DNO,DANS56
          LOAD      DANS56,OPCNRUSI,DYES,DNO
          DISPLAY   *P47:9,*V2LON,DANS56
          MOVE      ZERO,OVRCD
          GOTO      UIBA0000
.
.         Using Clinic or Surgeon
.
UIBA2100  DISPLAY   *P1:23,*EL,"0 = Clinic, 1 = Surgeon",*P47:10,SP3
          KEYIN     *P47:10,*EL,*V2LON,FORM1
          ADD       ONE,FORM1
          BRANCH    FORM1,UIBA2150,UIBA2150
          BEEP  
          GOTO      UIBA2100
.
UIBA2150  SUB       ONE,FORM1
          MOVE      FORM1,OPCNCLSU
          MOVE      CLSDESC0,CLSDESC
          LOAD      CLSDESC,OPCNCLSU,CLSDESC1
          DISPLAY   *P47:10,*EL,*V2LON,OPCNCLSU,*P50:10,CLSDESC:
                    *P1:23,*EL
          GOTO      UIBA0000
.
.         from time oper duration
.
UIBA4000  KEYIN     *P47:11,*V2LON,*EL,OPCNFOTM
          COMPARE   ONE,OPCNFOTM
          GOTO      UIBA4000 IF LESS
          COMPARE   FOUR,OPCNFOTM
          GOTO      UIBA0000 IF LESS
          GOTO      UIBA4000
.
.         to time oper duration
.
UIBA4300  KEYIN     *P47:12,*V2LON,*EL,OPCNTOTM
          COMPARE   TWO,OPCNTOTM
          GOTO      UIBA4300 IF LESS
          COMPARE   FIVE,OPCNTOTM
          GOTO      UIBA0000 IF LESS
          GOTO      UIBA4300
.
.         keyin unique id 
.
UIBA5200  KEYIN     *P47:15,*V2LON,*EL,OPCNUNIQ
          COMPARE   ONE,OPCNUNIQ
          GOTO      UIBA5200 IF LESS
          GOTO      UIBA0000 
.
.         Keyin Print Operation Records Format
.
UIBA5500  DISPLAY   *P1:24,*V2LON,ZERO,*HOFF,"=Wellington, ",*V2LON,ONE,*HOFF:
                    "=Southland",*EL;
          KEYIN     *P47:16,*DV,UNDLN2,*EL:
                    *P47:16,*V2LON,OPCNPREC:
                    *P47:16,*DV,OPCNPREC
.
          COMPARE   ZERO,OPCNPREC
          GOTO      UIBA5505 IF EQUAL       * want wellington
.
          BRANCH    OPCNPREC,UIBA5510
.
          BEEP
          GOTO      UIBA5500                * invalid selection
.
UIBA5505  MOVE      WELLING,DIM20           * set to Wellington
          DISPLAY   *P51:16,DIM20          
          GOTO      UIBA0000
.
UIBA5510  MOVE      SOUTHLND,DIM20          * set to Southland
          DISPLAY   *P51:16,DIM20          
          GOTO      UIBA0000
.
.         keyin User defined field for OPROTSFD
.
UIBA7000  DISPLAY   *P1:24,"0=blank, 1-8=OPDCUSR1-8, 9-12=OPDAUSR1-4",*EL;
          KEYIN     *P47:19,*DV,UNDLN2:
                    *P47:19,*V2LON,OPCNOTSU:
                    *P47:19,*DV,OPCNOTSU
.
          COMPARE   "13",OPCNOTSU
          GOTO      UIBA7100 IF NOT LESS    * too high
          COMPARE   ZERO,OPCNOTSU
          GOTO      UIBA7100 IF LESS        * too low
          GOTO      UIBA0000
.
UIBA7100  BEEP
          GOTO      UIBA7000
.
.         keyin User defined field for OPRCTSFD
.
UIBA7500  DISPLAY   *P1:24,"0=blank, 1-8=OPDCUSR1-8, 9-12=OPDAUSR1-4",*EL;
          KEYIN     *P47:20,*DV,UNDLN2:
                    *P47:20,*V2LON,OPCNCTSU:
                    *P47:20,*DV,OPCNCTSU
.
          COMPARE   "13",OPCNCTSU
          GOTO      UIBA7600 IF NOT LESS    * too high
          COMPARE   ZERO,OPCNCTSU
          GOTO      UIBA7600 IF LESS        * too low
          GOTO      UIBA0000
.
UIBA7600  BEEP
          GOTO      UIBA7500
.
.         change descs to major/minor in OPR65 ?
.
UIBA8000  KEYIN     *P47:21,*DV,UNDLN1,*EL:
                    *P47:21,*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      UIBA8010 IF EQUAL       * Yes
          MATCH     ANSN,ANS
          GOTO      UIBA8020 IF EQUAL       * No
          BEEP
          GOTO      UIBA8000
.
UIBA8010  MOVE      ONE,OPCNMM65            * set to yes
          MOVE      DYES,DANS1
          GOTO      UIBA8090
.
UIBA8020  MOVE      ZERO,OPCNMM65           * set to no 
          MOVE      DNO,DANS1
.
UIBA8090  DISPLAY   *P47:21,*V2LON,DANS1
          GOTO      UIBA0000
.
.         change descs to major/minor in OPR75 ?
.
UIBA8500  KEYIN     *P47:22,*DV,UNDLN1,*EL:
                    *P47:22,*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      UIBA8510 IF EQUAL       * Yes
          MATCH     ANSN,ANS
          GOTO      UIBA8520 IF EQUAL       * No
          BEEP
          GOTO      UIBA8500
.
UIBA8510  MOVE      ONE,OPCNMM75            * set to yes
          MOVE      DYES,DANS2
          GOTO      UIBA8590
.
UIBA8520  MOVE      ZERO,OPCNMM75           * set to no 
          MOVE      DNO,DANS2
.
UIBA8590  DISPLAY   *P47:22,*V2LON,DANS2
          GOTO      UIBA0000
.
.         set exit flag
.
UIBA9000  MOVE      TRUE,EXIT               * cancel entered
.
UIBA9999  RETURN
+
.**********************************************************************
.*                            WIBA0000                                *
.*                      Write I.B.A. Screen 1                         *
.**********************************************************************
.
WIBA0000  WRITAB    CONTROLF,FORTY;*111,OPCNCLSU,OPCNCODE,OPCNRUSI
          WRITAB    CONTROLF,NUM42;*19,OPCNFOTM,OPCNTOTM:
                                   *32,OPCNUNIQ,*68,OPCNPREC:
                    *107,OPCNOTSU,OPCNCTSU,*113,OPCNMM65,*116,OPCNMM75
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WIBA9999  RETURN
+
.**********************************************************************
.*                            OTIM0000                                *
.*                  Display Operation time descriptions               *
.**********************************************************************
.
OTIM0000  READ      CONTROLF,SIXTY8;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                    OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                    OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                    OPCNDPS4
.
OTIM2500  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                                 " Description for pre-op time 1           :":
                    *P1:5,*V2LON," 2.",*HOFF:
                                 " Description for pre-op time 2           :":
                    *P1:6,*V2LON," 3.",*HOFF:
                                 " Description for pre-op time 3           :":
                    *P1:7,*V2LON," 4.",*HOFF:
                                  " Description for pre-op time 4           :":
                    *P1:8,*V2LON," 5.",*HOFF:
                                  " Description for pre-op time 5           :":
                    *P1:9,*V2LON," 6.",*HOFF:
                                  " Description for operation time 1        :":
                    *P1:10,*V2LON," 7.",*HOFF:
                                  " Description for operation time 2        :":
                    *P1:11,*V2LON," 8.",*HOFF:
                                  " Description for operation time 3        :":
                    *P1:12,*V2LON," 9.",*HOFF:
                                  " Description for operation time 4        :":
                    *P1:13,*V2LON,"10.",*HOFF:
                                  " Description for post-op time 1          :":
                    *P1:14,*V2LON,"11.",*HOFF:
                                  " Description for post-op time 2          :":
                    *P1:15,*V2LON,"12.",*HOFF:
                                  " Description for post-op time 3          :":
                    *P1:16,*V2LON,"13.",*HOFF:
                                  " Description for post-op time 4          :":
                    *P47:4,*V2LON,OPCNDPR1,*P47:5,OPCNDPR2,*P47:6,OPCNDPR3:
                    *P47:7,OPCNDPR4,*P47:8,OPCNDPR5:
                    *P47:9,OPCNDOP1,*P47:10,OPCNDOP2,*P47:11,OPCNDOP3:
                    *P47:12,OPCNDOP4,*P47:13,OPCNDPS1:
                    *P47:14,OPCNDPS2,*P47:15,OPCNDPS3,*P47:16,OPCNDPS4
.
OTIM9999  RETURN
.**********************************************************************
.*                            UTIM0000                                *
.*                  Update Operation time descriptions                *
.**********************************************************************
.
UTIM0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UMSC9999 IF EQUAL
          COMPARE   "-1",CCITEM
          GOTO      UMSC9000 IF EQUAL
.
          MOVE      CCITEM,FIELD
          BRANCH    FIELD,UTIM1000,UTIM1100:
                          UTIM1200,UTIM1300,UTIM1400,UTIM1500,UTIM1600:
                          UTIM1700,UTIM1800,UTIM1900,UTIM2000,UTIM2100,UTIM2200
          BEEP
          GOTO      UTIM0000
.
.         Description for pre-op time 1
.
UTIM1000  KEYIN     *P47:4,*EL,*V2LON,OPCNDPR1
          ENDSET    OPCNDPR1
          APPEND    SP30,OPCNDPR1
          RESET     OPCNDPR1
          GOTO      UTIM0000
.
.         Description for pre-op time 2
.
UTIM1100  KEYIN     *P47:5,*EL,*V2LON,OPCNDPR2
          ENDSET    OPCNDPR2
          APPEND    SP30,OPCNDPR2
          RESET     OPCNDPR2
          GOTO      UTIM0000
.
.         Description for pre-op time 3
.
UTIM1200  KEYIN     *P47:6,*EL,*V2LON,OPCNDPR3
          ENDSET    OPCNDPR3
          APPEND    SP30,OPCNDPR3
          RESET     OPCNDPR3
          GOTO      UTIM0000
.
.         Description for pre-op time 4
.
UTIM1300  KEYIN     *P47:7,*EL,*V2LON,OPCNDPR4
          ENDSET    OPCNDPR4
          APPEND    SP30,OPCNDPR4
          RESET     OPCNDPR4
          GOTO      UTIM0000
.
.         Description for pre-op time 5
.
UTIM1400  KEYIN     *P47:8,*EL,*V2LON,OPCNDPR5
          ENDSET    OPCNDPR5
          APPEND    SP30,OPCNDPR5
          RESET     OPCNDPR5
          GOTO      UTIM0000
.
.         Description for operation time 1
.
UTIM1500  KEYIN     *P47:9,*EL,*V2LON,OPCNDOP1
          ENDSET    OPCNDOP1
          APPEND    SP30,OPCNDOP1
          RESET     OPCNDOP1
          GOTO      UTIM0000
.
.         Description for operation time 2
.
UTIM1600  KEYIN     *P47:10,*EL,*V2LON,OPCNDOP2
          ENDSET    OPCNDOP2
          APPEND    SP30,OPCNDOP2
          RESET     OPCNDOP2
          GOTO      UTIM0000
.
.         Description for operation time 3
.
UTIM1700  KEYIN     *P47:11,*EL,*V2LON,OPCNDOP3
          ENDSET    OPCNDOP3
          APPEND    SP30,OPCNDOP3
          RESET     OPCNDOP3
          GOTO      UTIM0000
.
.         Description for operation time 4
.
UTIM1800  KEYIN     *P47:12,*EL,*V2LON,OPCNDOP4
          ENDSET    OPCNDOP4
          APPEND    SP30,OPCNDOP4
          RESET     OPCNDOP4
          GOTO      UTIM0000
.
.         Description for post-op time 1
.
UTIM1900  KEYIN     *P47:13,*EL,*V2LON,OPCNDPS1
          ENDSET    OPCNDPS1
          APPEND    SP30,OPCNDPS1
          RESET     OPCNDPS1
          GOTO      UTIM0000
.
.         Description for post-op time 2
.
UTIM2000  KEYIN     *P47:14,*EL,*V2LON,OPCNDPS2
          ENDSET    OPCNDPS2
          APPEND    SP30,OPCNDPS2
          RESET     OPCNDPS2
          GOTO      UTIM0000
.
.         Description for post-op time 3
.
UTIM2100  KEYIN     *P47:15,*EL,*V2LON,OPCNDPS3
          ENDSET    OPCNDPS3
          APPEND    SP30,OPCNDPS3
          RESET     OPCNDPS3
          GOTO      UTIM0000
.
.         Description for post-op time 4
.
UTIM2200  KEYIN     *P47:16,*EL,*V2LON,OPCNDPS4
          ENDSET    OPCNDPS4
          APPEND    SP30,OPCNDPS4
          RESET     OPCNDPS4
          GOTO      UTIM0000
.
UTIM9000  MOVE      TRUE,EXIT
UTIM9999  RETURN
+
.**********************************************************************
.*                            WTIM0000                                *
.*                  Write Operation time Descriptions                 *
.**********************************************************************
.
WTIM0000  WRITAB    CONTROLF,SIXTY8;*1,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                   OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                   OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3,OPCNDPS4
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
.**********************************************************************
.*                            IUDP0000                                *
.*                     Display I.B.A. Screen 2                        *
.**********************************************************************
.
IUDP0000  READ      CONTROLF,FORTY;*115,OPCNNOOP
          READ      CONTROLF,FORTY2;*16,OPCNNPRV,OPCNUDSC,*47,OPCNANST:
                                    *124,OPCNEALB:
                                    *125,OPCNDLVE,*126,OPCNSPET,*127,OPCNANTH:
                                    *129,OPCNAPRQ,OPCNLABL,*132,OPCNANED:
                                    *235,OPCNFTIM,*237,OPCNTTIM
.
          MOVE      DNO,DANS54
          LOAD      DANS54,OPCNNOOP,DYES,DNO
.
          MOVE      DNO,DANS72
          LOAD      DANS72,OPCNUDSC,DYES,DNO
.
          MOVE      DNO,DANS5 
          LOAD      DANS5,OPCNEALB,DYES,DNO
.
          MOVE      DNO,DANS6 
          LOAD      DANS6,OPCNDLVE,DYES,DNO
.
          MOVE      DNO,DANS7 
          LOAD      DANS7,OPCNSPET,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,OPCNANTH,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,OPCNAPRQ,DYES,DNO
.
          PACK      STRTDESC,SP30,SP30
          LOAD      STRTDESC,OPCNFTIM,TIMECALL,TIMEARRV,ANTHPREP,ANTHCOMM:
                                      PREPSTTM,SURGSTTM,SURGEDTM,ANTHSEND:
                                      DRSSTIME,RECOVRYF,RECOVRYB,RECVRYDY:
                                      RDEPART,EXITTHTR
.
          PACK      ENDDESC,SP30,SP30
          LOAD      ENDDESC,OPCNTTIM,TIMECALL,TIMEARRV,ANTHPREP,ANTHCOMM:
                                     PREPSTTM,SURGSTTM,SURGEDTM,ANTHSEND:
                                     DRSSTIME,RECOVRYF,RECOVRYB,RECVRYDY:
                                     RDEPART,EXITTHTR
.
IUDP7000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1.",*HOFF:
                    " Which pre-op time is anaesthetic start?                :":
                    *P1:5,*V2LON," 2.",*HOFF:
                    " Using No. of Operations (Y/N)?                         :":
                    *P1:6,*V2LON," 3.",*HOFF:
                    " No. of provisional items being used                    :":
                    *P1:7,*V2LON," 4.",*HOFF:
                    " Using operation description (Y/N)?                     :":
                    *P1:8,*V2LON," 5.",*HOFF:
                    " View all types of bookings in OPR21                    :":
                    *P1:9,*V2LON," 6.",*HOFF:
                    " Using Doctor Leave feature (Y/N)?                      :":
                    *P1:10,*V2LON," 7.",*HOFF:
                    " Using Special Equipment Tracking (Y/N)?                :":
                    *P1:11,*V2LON," 8.",*HOFF:
                    " Picking sheets by Surgeon/Anaesthetist?                :":
                    *P1:12,*V2LON," 9.",*HOFF:
                    " Using Anaesthetist Preferences in Requisitions (Y/N )? :":
                    *P1:13,*V2LON,"10.",*HOFF:
                    " Default Number of Labels (0 = Not Using Booking Labs)  :":
                    *P1:14,*V2LON,"11.",*HOFF:
                    " Which pre-op time is anaesthetic end?                  :":
                    *P1:15,*V2LON,"12.",*HOFF:
                    " New FROM time for operation duration            :":
                    *P1:16,*V2LON,"13.",*HOFF:
                    " New TO time for operation duration              :":
                    *P62:4,*V2LON,OPCNANST,*P62:5,DANS54:
                    *P62:6,OPCNNPRV,*P62:7,*P62:7,DANS72,*P62:8,DANS5:
                    *P62:9,DANS6:
                    *P62:10,DANS7,*P62:11,DANS8,*P62:12,DANS9:
                    *P62:13,OPCNLABL,*P62:14,OPCNANED:
                    *P55:15,STRTDESC:
                    *P55:16,ENDDESC
              
.
          RETURN
+
.**********************************************************************
.*                            UUDP0000                                *
.*                      Update I.B.A. Screen 2
.**********************************************************************
UUDP0000  MOVE      FALSE,EXIT
.
          CALL      MAINQST            * post cancel or select item
          COMPARE   ZERO,CCITEM
          GOTO      UUDP9999 IF EQUAL
.
          COMPARE   "-1",CCITEM
          GOTO      UUDP9000 IF EQUAL
.
          MOVE      CCITEM,FIELD
          BRANCH    FIELD,UUDP1100,UUDP1200,UUDP1300,UUDP1400,UUDP1500:
                          UUDP1600,UUDP1700,UUDP1800,UUDP1900,UUDP2000:
                          UUDP2100,UUDP2200,UUDP2300
.
          BEEP
          GOTO      UUDP0000
.
.         which pre-op time is anaesthetic start time
.
UUDP1100  KEYIN     *P62:4,*DV,UNDLN1:
                    *P62:4,*V2LON,OPCNANST
.
          BRANCH    OPCNANST,UUDP0000,UUDP0000,UUDP0000,UUDP0000,UUDP0000
.
          BEEP
          GOTO      UUDP1100
.
.         Using No. of Operations
.
UUDP1200  KEYIN     *P62:5,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
          CMATCH    ANSY,ANS
          GOTO      UUDP1220 IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      UUDP1250 IF EQUAL
          BEEP      
          GOTO      UUDP1200
.
UUDP1220  MOVE      ONE,OPCNNOOP
          GOTO      UUDP1270
.
UUDP1250  MOVE      ZERO,OPCNNOOP
.
UUDP1270  MOVE      DNO,DANS54
          LOAD      DANS54,OPCNNOOP,DYES,DNO
          DISPLAY   *P62:5,*V2LON,DANS54
          MOVE      ZERO,OVRCD
          GOTO      UUDP0000
.
. no. of provisional items
.
UUDP1300  KEYIN     *P62:6,*EL:
                    *P62:6,*V2LON,OPCNNPRV
          COMPARE   ZERO,OPCNNPRV
          GOTO      UUDP1300 IF LESS
          COMPARE   FOUR,OPCNNPRV
          GOTO      UUDP0000 IF LESS
          GOTO      UUDP1300
.
.         Using Operation description
.
UUDP1400  MOVE      "62",CCOL
          MOVE      "7",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNUDSC
          GOTO      UUDP0000
.
.         View all types of bookings in OPR21
.
UUDP1500  MOVE      "62",CCOL
          MOVE      "8",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNEALB
          GOTO      UUDP0000
.
UUDP1600  MOVE      "62",CCOL
          MOVE      "9",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNDLVE
          GOTO      UUDP0000
.
UUDP1700  MOVE      "62",CCOL
          MOVE      "10",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNSPET
          GOTO      UUDP0000
.
UUDP1800  MOVE      "62",CCOL
          MOVE      "11",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNANTH
          GOTO      UUDP0000
.
UUDP1900  MOVE      "62",CCOL
          MOVE      "12",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNAPRQ
          GOTO      UUDP0000
.
UUDP2000  KEYIN     *P62:13,*V2LON,*RV,OPCNLABL
          GOTO      UUDP0000
.
.         which pre-op time is anaesthetic end time
.
UUDP2100  KEYIN     *P62:14,*DV,UNDLN1:
                    *P62:14,*V2LON,OPCNANED
.
          BRANCH    OPCNANED,UUDP0000,UUDP0000,UUDP0000,UUDP0000,UUDP0000
.
          BEEP
          GOTO      UUDP2100
.
.         which from time to use for operation duration
.
UUDP2200  MOVE      "15",CVERT
          MOVE      "Time for Operation duration",BOXHDR
          CALL      LDOPD000            * Load operation duration options 
          MOVE      "55",CCOL
          PROC      GENCODKY
          IF        EXIT=1
            DISPLAY   *P55:15,*EL
            GOTO     UUDP0000
          ENDIF
.
          MOVE      TEMPCODE,OPCNFTIM
          MOVE      TEMPDESC,STRTDESC
          CALL      KILL0000                
.
          DISPLAY   *P55:15,*EL,*V2LON,STRTDESC
          GOTO      UUDP0000
.
.         which end time to use for operation duration
.
UUDP2300  MOVE      "16",CVERT
          MOVE      "Time for Operation duration",BOXHDR
          CALL      LDOPD000            * Load operation duration options
          MOVE      "55",CCOL
          PROC      GENCODKY
          IF        EXIT=1
            DISPLAY   *P55:16,*EL
            GOTO     UUDP0000
          ENDIF
.
          MOVE      TEMPCODE,OPCNTTIM
          MOVE      TEMPDESC,ENDDESC
          CALL      KILL0000                
.
          DISPLAY   *P55:16,*EL,*V2LON,ENDDESC 
          GOTO      UUDP0000
.
UUDP9000  MOVE      TRUE,EXIT
.
UUDP9999  RETURN
+
.**********************************************************************
.*                            WUDP0000                                *
.*                      Write I.B.A. Screen 2                         *
.**********************************************************************
.
WUDP0000  WRITAB    CONTROLF,FORTY;*115,OPCNNOOP
          WRITAB    CONTROLF,FORTY2;*16,OPCNNPRV,OPCNUDSC,*47,OPCNANST:
                                    *124,OPCNEALB:
                                    *125,OPCNDLVE,*126,OPCNSPET,OPCNANTH:
                                    *129,OPCNAPRQ,OPCNLABL,*132,OPCNANED:
                                    *235,OPCNFTIM,*237,OPCNTTIM
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
. ----------------------------------------- Start of additional code    I-90201
.**********************************************************************
.*                            IDGP0000                                *
.*                     Display Interface Engine screen                *
.**********************************************************************
.
IDGP0000  READ      CONTROLF,SIXTY8;*239,OPCNDGUB,*240,OPCNDGCB
.
          MOVE      DNO,DANS73
          LOAD      DANS73,OPCNDGUB,DYES,DNO
.
          MOVE      DNO,DANS74
          LOAD      DANS74,OPCNDGCB,DYES,DNO
.
          DISPLAY   *P56:2,*V2LON,"- Interface Engine ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Send message CUB after a Booking Pre-admission ?":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Send message CCB after a Booking Cancellation ?":
                    *P57:04,": ",*V2LON,DANS73,*HOFF:
                    *P57:05,": ",*V2LON,DANS74,*HOFF
.
IDGP9999  RETURN
+
.***********************************************************************
.*  UDGP0000  :  Status Adjustment Fields
.***********************************************************************
UDGP0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      UDGP9999 IF EQUAL
          GOTO      UDGP9000 IF LESS
.
          MOVE      "59",CCOL
          BRANCH    CCITEM,UDGP0100,UDGP0200
.
          BEEP
          GOTO      UDGP0000
.
. Write subsidary system after Booking Pre-admission?
.
UDGP0100  MOVE      "4",CVERT
          MOVE      OPCNDGUB,ANS
          CALL      KYNO0000
          MOVE      EXIT,OPCNDGUB
          GOTO      UDGP0000
.
. Write subsidary system after Booking Cancellation ?
.
UDGP0200  MOVE      "5",CVERT
          MOVE      OPCNDGCB,ANS
          CALL      KYNO0000
          MOVE      EXIT,OPCNDGCB
          GOTO      UDGP0000
.
UDGP9000  MOVE      TRUE,EXIT
.
UDGP9999  RETURN
+
.**********************************************************************
.*                            WDGP0000                                *
.*                      Write Interface Engine set uP                 *
.**********************************************************************
.
WDGP0000  WRITAB    CONTROLF,SIXTY8;*239,OPCNDGUB,*240,OPCNDGCB
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
. ----------------------------------------- End of additional code      I-90201
+
.********************************************************************* 
.*                  DRPA0000                    Called by : ML7000   *
.*        Display the screen for Report layouts                      *
.*********************************************************************
DRPA0000  READ      CONTROLF,NUM42;*45,OPCNR53A,*48,OPCNR59A,*50,OPCNR58A:
                    *52,OPCNR60A,*54,OPCNR62A,*56,OPCNR66A,*58,OPCNR63A:
                    *60,OPCNR64A,*105,OPCNR74A,*111,OPCNR65A,*114,OPCNR75A
.
          MOVE      SP20,RDESC1
          LOAD      RDESC1,OPCNR53A,REPDESCA,REPDESCB
.
          MOVE      SP20,RDESC2
          LOAD      RDESC2,OPCNR58A,REPDESCA
.
          MOVE      SP20,RDESC3
          LOAD      RDESC3,OPCNR59A,REPDESCA,REPDESCB
.
          MOVE      SP20,RDESC4
          LOAD      RDESC4,OPCNR60A,REPDESCA,REPDESCB,REPDESCC
.
          MOVE      SP20,RDESC5
          LOAD      RDESC5,OPCNR62A,REPDESCA,REPDESCB,REPDESCC,REPDESCD,REPDESCE
.
          MOVE      SP20,RDESC6
          LOAD      RDESC6,OPCNR63A,REPDESCA,REPDESCB,REPDESCC,REPDESCD
.
          MOVE      SP20,RDESC7
          LOAD      RDESC7,OPCNR64A,REPDESCA,REPDESCB
.
          MOVE      SP20,RDESC8 
          LOAD      RDESC8,OPCNR65A,REPDESCA,REPDESCB
.
          MOVE      SP20,RDESC9
          LOAD      RDESC9,OPCNR66A,REPDESCA,REPDESCB,REPDESCC,REPDESCD:
                                    REPDESCE,REPDESCF,REPDESCG,REPDESCH
.
          MOVE      SP20,RDESC10
          LOAD      RDESC10,OPCNR74A,REPDESCA
.
          MOVE      SP20,RDESC11
          LOAD      RDESC11,OPCNR75A,REPDESCA,REPDESCB
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1",*HOFF,". Report layout for IBAOPR53 : ":
                    *P34:4,*V2LON,OPCNR53A,*HOFF,*P40:4,RDESC1:
                    *P1:5,*V2LON," 2",*HOFF,". Report layout for IBAOPR58 : ":
                    *P34:5,*V2LON,OPCNR58A,*HOFF,*P40:5,RDESC2:
                    *P1:6,*V2LON," 3",*HOFF,". Report layout for IBAOPR59 : ":
                    *P34:6,*V2LON,OPCNR59A,*HOFF,*P40:6,RDESC3:
                    *P1:7,*V2LON," 4",*HOFF,". Report layout for IBAOPR60 : ":
                    *P34:7,*V2LON,OPCNR60A,*HOFF,*P40:7,RDESC4:
                    *P1:8,*V2LON," 5",*HOFF,". Report layout for IBAOPR62 : ":
                    *P34:8,*V2LON,OPCNR62A,*HOFF,*P40:8,RDESC5: 
                    *P1:9,*V2LON," 6",*HOFF,". Report layout for IBAOPR63 : ":
                    *P34:9,*V2LON,OPCNR63A,*HOFF,*P40:9,RDESC6:
                    *P1:10,*V2LON," 7",*HOFF,". Report layout for IBAOPR64 : ":
                    *P34:10,*V2LON,OPCNR64A,*HOFF,*P40:10,RDESC7:
                    *P1:11,*V2LON," 8",*HOFF,". Report layout for IBAOPR65 : ":
                    *P34:11,*V2LON,OPCNR65A,*HOFF,*P40:11,RDESC8:
                    *P1:12,*V2LON," 9",*HOFF,". Report layout for IBAOPR66 : ":
                    *P34:12,*V2LON,OPCNR66A,*HOFF,*P40:12,RDESC9:
                    *P1:13,*V2LON,"10",*HOFF,". Report layout for IBAOPR74 : ":
                    *P34:13,*V2LON,OPCNR74A,*HOFF,*P40:13,RDESC10:
                    *P1:14,*V2LON,"11",*HOFF,". Report layout for IBAOPR75 : ":
                    *P34:14,*V2LON,OPCNR75A,*HOFF,*P40:14,RDESC11
.
DRPA9999  RETURN
+
.*********************************************************************
.*                  URPA0000                    Called by : ML7000   *
.*        Change the values of items for Report Layout screen        *
.*        Returns : EXIT = 1      cancel selected                    * 
.*********************************************************************
URPA0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      URPA9800 IF EQUAL       * Post selected
          GOTO      URPA9900 IF LESS        * Cancel selected
.
          BRANCH    CCITEM,URPA1000,URPA1500,URPA2000,URPA2500,URPA3000:
                           URPA3500,URPA4000,URPA4500,URPA5000,URPA5500:
                           URPA6000
.
          BEEP
          GOTO      URPA0000
.
.         change report layout for IBAOPR53
.
URPA1000  KEYIN     *P34:4,*DV,UNDLN2,*EL:
                    *P34:4,*V2LON,OPCNR53A:
                    *P34:4,*DV,OPCNR53A
.
          BRANCH    OPCNR53A,URPA1100,URPA1100   * valid values
.
          BEEP
          GOTO      URPA1000                * invalid answer
.
URPA1100  LOAD      RDESC1,OPCNR53A,REPDESCA,REPDESCB
          DISPLAY   *P40:4,RDESC1
          GOTO      URPA0000
.
.         change report layout for IBAOPR58
.
URPA1500  KEYIN     *P34:5,*DV,UNDLN2,*EL:
                    *P34:5,*V2LON,OPCNR58A:
                    *P34:5,*DV,OPCNR58A
.
          BRANCH    OPCNR58A,URPA1600            * valid values
.
          BEEP
          GOTO      URPA1500                * invalid answer
.
URPA1600  LOAD      RDESC2,OPCNR58A,REPDESCA
          DISPLAY   *P40:5,RDESC2
          GOTO      URPA0000
.
.         change report layout for IBAOPR59
.
URPA2000  KEYIN     *P34:6,*DV,UNDLN2,*EL:
                    *P34:6,*V2LON,OPCNR59A:
                    *P34:6,*DV,OPCNR59A
.
          BRANCH    OPCNR59A,URPA2100,URPA2100   * valid values
.
          BEEP
          GOTO      URPA2000                * invalid answer
.
URPA2100  LOAD      RDESC3,OPCNR59A,REPDESCA,REPDESCB
          DISPLAY   *P40:6,RDESC3
          GOTO      URPA0000
.
.         change report layout for IBAOPR60
.
URPA2500  KEYIN     *P34:7,*DV,UNDLN2,*EL:
                    *P34:7,*V2LON,OPCNR60A:
                    *P34:7,*DV,OPCNR60A
.
          BRANCH    OPCNR60A,URPA2600,URPA2600,URPA2600
.
          BEEP
          GOTO      URPA2500                * invalid answer
.
URPA2600  LOAD      RDESC4,OPCNR60A,REPDESCA,REPDESCB,REPDESCC
          DISPLAY   *P40:7,RDESC4
          GOTO      URPA0000
.
.         change report layout for IBAOPR62
.
URPA3000  KEYIN     *P34:8,*DV,UNDLN2,*EL:
                    *P34:8,*V2LON,OPCNR62A:
                    *P34:8,*DV,OPCNR62A
.
          BRANCH    OPCNR62A,URPA3100,URPA3100,URPA3100,URPA3100,URPA3100
.
          BEEP
          GOTO      URPA3000                * invalid answer
.
URPA3100  LOAD      RDESC5,OPCNR62A,REPDESCA,REPDESCB,REPDESCC,REPDESCD,REPDESCE
          DISPLAY   *P40:8,RDESC5
          GOTO      URPA0000
.
.         change report layout for IBAOPR63
.
URPA3500  KEYIN     *P34:9,*DV,UNDLN2,*EL:
                    *P34:9,*V2LON,OPCNR63A:
                    *P34:9,*DV,OPCNR63A
.
          BRANCH    OPCNR63A,URPA3600,URPA3600,URPA3600,URPA3600
.
          BEEP
          GOTO      URPA3500                * invalid answer
.
URPA3600  LOAD      RDESC6,OPCNR63A,REPDESCA,REPDESCB,REPDESCC,REPDESCD
          DISPLAY   *P40:9,RDESC6
          GOTO      URPA0000
.
.         change report layout for IBAOPR64
.
URPA4000  KEYIN     *P34:10,*DV,UNDLN2,*EL:
                    *P34:10,*V2LON,OPCNR64A:
                    *P34:10,*DV,OPCNR64A
.
          BRANCH    OPCNR64A,URPA4100,URPA4100
.
          BEEP
          GOTO      URPA4000                * invalid answer
.
URPA4100  LOAD      RDESC7,OPCNR64A,REPDESCA,REPDESCB
          DISPLAY   *P40:10,RDESC7
          GOTO      URPA0000
.
.         change report layout for IBAOPR65
.
URPA4500  KEYIN     *P34:11,*DV,UNDLN2,*EL:
                    *P34:11,*V2LON,OPCNR65A:
                    *P34:11,*DV,OPCNR65A
.
          BRANCH    OPCNR65A,URPA4600,URPA4600
.
          BEEP
          GOTO      URPA4500                * invalid answer
.
URPA4600  LOAD      RDESC8,OPCNR65A,REPDESCA,REPDESCB
          DISPLAY   *P40:11,RDESC8
          GOTO      URPA0000
.
.         change report layout for IBAOPR66
.
URPA5000  KEYIN     *P34:12,*DV,UNDLN2,*EL:
                    *P34:12,*V2LON,OPCNR66A:
                    *P34:12,*DV,OPCNR66A
.
          BRANCH    OPCNR66A,URPA5100,URPA5100,URPA5100,URPA5100,URPA5100:
                             URPA5100,URPA5100,URPA5100
.
          BEEP
          GOTO      URPA5000                * invalid answer
.
URPA5100  LOAD      RDESC9,OPCNR66A,REPDESCA,REPDESCB,REPDESCC,REPDESCD:
                                    REPDESCE,REPDESCF,REPDESCG,REPDESCH
          DISPLAY   *P40:12,RDESC9
          GOTO      URPA0000
.
.         change report layout for IBAOPR74
.
URPA5500  KEYIN     *P34:13,*DV,UNDLN2,*EL:
                    *P34:13,*V2LON,OPCNR74A:
                    *P34:13,*DV,OPCNR74A
.
          BRANCH    OPCNR74A,URPA5600
.
          BEEP
          GOTO      URPA5500                * invalid answer
.
URPA5600  LOAD      RDESC10,OPCNR74A,REPDESCA
          DISPLAY   *P40:13,RDESC10
          GOTO      URPA0000
.
.         change report layout for IBAOPR75
.
URPA6000  KEYIN     *P34:14,*DV,UNDLN2,*EL:
                    *P34:14,*V2LON,OPCNR75A:
                    *P34:14,*DV,OPCNR75A
.
          BRANCH    OPCNR75A,URPA6100,URPA6100
.
          BEEP
          GOTO      URPA6000                * invalid answer
.
URPA6100  LOAD      RDESC11,OPCNR75A,REPDESCA,REPDESCB
          DISPLAY   *P40:14,RDESC11
          GOTO      URPA0000
.
.         set exit flags
.
URPA9800  MOVE      FALSE,EXIT              * Post selected
          GOTO      URPA9999
.
URPA9900  MOVE      TRUE,EXIT               * cancel selected
.
URPA9999  RETURN
+
.*********************************************************************
.*                  WRPA0000                    Called by : ML7000   *
.*        Write new Report Layout values                             *
.*********************************************************************
WRPA0000  DISPLAY   *P60:24,*V2LON,"*** POSTING ***";
          WRITAB    CONTROLF,NUM42;*45,OPCNR53A,*48,OPCNR59A,*50,OPCNR58A:
                    *52,OPCNR60A,*54,OPCNR62A,*56,OPCNR66A,*58,OPCNR63A:
                    *60,OPCNR64A,*105,OPCNR74A,*111,OPCNR65A,*114,OPCNR75A
.
WRPA9999  RETURN
+
.*********************************************************************
.*                  DHSA0000                    Called by : ML8000   *
.*        Display Hospital screen One                                *
.*********************************************************************
DHSA0000  READ      CONTROLF,FORTY;*72,OPCNBKBD
          READ      CONTROLF,FORTY2;*70,OPCNWLDS:
                             *90,OPCNASTD,OPCNPCOM,OPCNDFAD,OPCNCLSH:
                             *100,OPCNUSGE,OPCNSGCL,OPCNCHMB,*104,OPCNCBOK:
                             *117,OPCNDFCC,OPCNCMBD,OPCNASLN,OPCNPC64,OPCNPAMT:
                                  OPCNWLTM,OPCNWLIT:
                             *128,OPCNTREQ
          READ      CONTROLF,SIXTY8;*235,OPCNBELT,OPCNESIS
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OPCNASTD,DYES
          MOVE      DNO,DANS2
          LOAD      DANS2,OPCNPCOM,DYES
          MOVE      DNO,DANS3
          LOAD      DANS3,OPCNDFAD,DYES
          MOVE      DNO,DANS4
          LOAD      DANS4,OPCNCLSH,DYES
          MOVE      DNO,DANS5
          LOAD      DANS5,OPCNUSGE,DYES
          MOVE      DNO,DANS6
          LOAD      DANS6,OPCNSGCL,DYES
          MOVE      DNO,DANS7
          LOAD      DANS7,OPCNCHMB,DYES
          MOVE      DNO,DANS8
          LOAD      DANS8,OPCNCBOK,DYES
          MOVE      DNO,DANS9
          LOAD      DANS9,OPCNDFCC,DYES
          MOVE      DNO,DANS10
          LOAD      DANS10,OPCNCMBD,DYES
          MOVE      DNO,DANS11
          LOAD      DANS11,OPCNASLN,DYES
          MOVE      DNO,DANS12
          LOAD      DANS12,OPCNPC64,DYES
          MOVE      DNO,DANS13
          LOAD      DANS13,OPCNPAMT,DYES
          MOVE      DNO,DDESC14
          LOAD      DDESC14,OPCNWLDS,DOPR,DBOK,DBOTH,DOPB
          MOVE      DNO,DANS15
          LOAD      DANS15,OPCNWLTM,DYES
          MOVE      DNO,DANS16
          LOAD      DDESC16,OPCNWLIT,DOPR,DBOK,DBOTH
          MOVE      DNO,DANS17
          LOAD      DANS17,OPCNBKBD,DYES
          MOVE      DNO,DANS18
          LOAD      DANS18,OPCNTREQ,DYES
          MOVE      DNO,DANS19
          LOAD      DANS19,OPCNBELT,DYES
          MOVE      DNO,DANS20
          LOAD      DANS20,OPCNESIS,DYES
.
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1",*HOFF:
                    ". Update session start time and duration for first case ":
                    "change : ",*V2LON,DANS1:
                    *P1:5,*V2LON," 2",*HOFF:
                    ". Enter Patient comments at time of booking ?           ":
                    "       : ",*V2LON,DANS2:
                    *P1:6,*V2LON," 3",*HOFF:
                    ". Default Attending Doctor to surgeon in charge of sessi":
                    "on     : ",*V2LON,DANS3:
                    *P1:7,*V2LON," 4",*HOFF:
                    ". Check for clashes when creating a new session         ":
                    "       : ",*V2LON,DANS4:
                    *P1:8,*V2LON," 5",*HOFF:
                    ". Input usage details for Non-Inpatients                ":
                    "       : ",*V2LON,DANS5:
                    *P1:9,*V2LON," 6",*HOFF:
                    ". Default Admission type to sugg. class. of Provisional ":
                    "Item   : ",*V2LON,DANS6:
                    *P1:10,*V2LON," 7",*HOFF:
                    ". Bill for MBS Items (Y/N)                              ":
                    "       : ",*V2LON,DANS7:
                    *P1:11,*V2LON," 8",*HOFF:
                    ". Cancellations to appear in IBAOPR22 (Y/N)             ":
                    "       : ",*V2LON,DANS8:
                    *P1:12,*V2LON," 9",*HOFF:
                    ". Count Correct default value                           ":
                    "       : ",*V2LON,DANS9:
                    *P1:13,*V2LON,"10",*HOFF:
                    ". Copy 1st MBS item & 2 descs to Booking Diagnosis (Y/N)":
                    "?      : ",*V2LON,DANS10:
                    *P1:14,*V2LON,"11",*HOFF:
                    ". Update session start time and end time for first case ":
                    "change : ",*V2LON,DANS11:
                    *P1:15,*V2LON,"12",*HOFF:
                    ". Print cancelled sessions in Operating Records Report  ":
                    "(Y/N)? : ",*V2LON,DANS12:
                    *P1:16,*V2LON,"13",*HOFF:
                    ". Post an Anaesthetic for Multiple teams in IBAOPR57  (Y":
                    "/N)?   : ",*V2LON,DANS13:
                    *P1:17,*V2LON,"14",*HOFF:
                    ". Descripton to Default from W/L Description            ":
                    "       : ",*V2LON,DDESC14:
                    *P1:18,*V2LON,"15",*HOFF:
                    ". Operation Time to Default from W/L Time               ":
                    "       : ",*V2LON,DANS15:
                    *P1:19,*V2LON,"16",*HOFF:
                    ". Provisional item to Default from W/L Procedure Code   ":
                    "       : ",*V2LON,DDESC16:
                    *P1:20,*V2LON,"17",*HOFF:
                    ". Using Booking Date Audit (Y/N) ?                      ":
                    "       : ",*V2LON,DANS17:
                    *P1:21,*V2LON,"18",*HOFF:
                    ". Print Tray Contents on Requisitions (Y/N) ?           ":
                    "       : ",*V2LON,DANS18:
                    *P1:22,*V2LON,"19",*HOFF:
                    ". Using Eltron Printer for Booking Labels (Y/N) ?       ":
                    "       : ",*V2LON,DANS19:
                    *P1:23,*V2LON,"20",*HOFF:
                    ". Using ESIS from W/L for operation description (Y/N) ? ":
                    "       : ",*V2LON,DANS20
.
DHSA9999  RETURN
+
.*********************************************************************
.*                  KHSA0000                    Called by : ML8000   *
.*        Keyin details for Hospital screen 1                        *
.*********************************************************************
KHSA0000  CALL      MAINQST
          BRANCH    CCITEM,KHSA0100,KHSA0200,KHSA0300,KHSA0400,KHSA0500:
                           KHSA0600,KHSA0700,KHSA0800,KHSA0900,KHSA1000:
                           KHSA1100,KHSA1200,KHSA1300,KHSA1400,KHSA1500:
                           KHSA1600,KHSA1700,KHSA1800,KHSA1900,KHSA2000
.
          COMPARE   ZERO,CCITEM
          GOTO      KHSA9900 IF EQUAL       * Post
          GOTO      KHSA9910 IF LESS        * Cancel
.
          BEEP
          GOTO      KHSA0000
.
. ------- OPCNASTD - update session start time and duration -------
.
KHSA0100  MOVE      "68",CCOL
          MOVE      "4",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNASTD           * set value
          GOTO      KHSA0000
.
. ------- OPCNPCOM - Enter patient comments when booking ? -------
.
KHSA0200  MOVE      "68",CCOL
          MOVE      "5",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNPCOM           * set value
          GOTO      KHSA0000
.
. ------- OPCNDFAD - Default attending doctor if not entered ? -------
.
KHSA0300  MOVE      "68",CCOL
          MOVE      "6",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNDFAD           * set value
          GOTO      KHSA0000
.
. ------- OPCNCLSH - Check for clash for a new session ? -------
.
KHSA0400  MOVE      "68",CCOL
          MOVE      "7",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNCLSH           * set value
          GOTO      KHSA0000
.
. ------- OPCNUSGE - Allow usage for Non-Inpatients ? -------
.
KHSA0500  MOVE      "68",CCOL
          MOVE      "8",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNUSGE           * set value
          GOTO      KHSA0000
.
. ------- OPCNSGCL - Default Admission type to suggested classification ------
.
KHSA0600  MOVE      "68",CCOL
          MOVE      "9",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNSGCL           * set value
          GOTO      KHSA0000
.
. ------- OPCNCHMB - enter Bill for MBS Billing ?? -------
.
KHSA0700  MOVE      "68",CCOL
          MOVE      "10",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNCHMB           * set value
          GOTO      KHSA0000
.
. ------- OPCNCBOK - cancellations to appear in OPR22 ? -------
.
KHSA0800  MOVE      "68",CCOL
          MOVE      "11",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNCBOK           * set value
          GOTO      KHSA0000
.
. ------- OPCNDFCC - Count Correct default -------
.
KHSA0900  MOVE      "68",CCOL
          MOVE      "12",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNDFCC           * set value
          GOTO      KHSA0000
.
. ------- OPCNCMBD - Copy MBS item/descs to Booking Diagnosis? ------
.
KHSA1000  MOVE      "68",CCOL
          MOVE      "13",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNCMBD           * set value
          GOTO      KHSA0000
.
. ------- OPCNASLN - Alter Start time & end time of session  ? ------
.
KHSA1100  MOVE      "68",CCOL
          MOVE      "14",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNASLN           * set value
          GOTO      KHSA0000
.
. ------- OPCNPC64 - Print cancelled sessions in Operating Records Report ? ---
.
KHSA1200  MOVE      "68",CCOL
          MOVE      "15",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNPC64           * set value
          GOTO      KHSA0000
.
. ------- OPCNPAMT - Post anaesthetic for multiple teams in OPR57 ? ----
.
KHSA1300  MOVE      "68",CCOL
          MOVE      "16",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNPAMT           * set value
          GOTO      KHSA0000
.
. ------- OPCNWLDS - Default Operation Desc from W/L Desc           ----
.
KHSA1400  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF,"=No, ":
                               *V2LON,"1",*HOFF,"=Operation, ":
                               *V2LON,"2",*HOFF,"=Booking Diagnosis, ":
                               *V2LON,"3",*HOFF,"=Operation & Booking, ":
                               *V2LON,"4",*HOFF,"=Op,Book & Reason"
KHSA1410  MOVE      "68",CCOL
          MOVE      "17",CVERT
          KEYIN     *PCCOL:CVERT,*DV,UNDLN1,*EL:
                    *PCCOL:CVERT,*V2LON,EXIT
          BRANCH    EXIT,KHSA1420,KHSA1420,KHSA1420,KHSA1420
.                          Oper.  Booking   Both    Op Book & Reason
          COMPARE   ZERO,EXIT
          GOTO      KHSA1420 IF EQUAL
          BEEP                               * Error
          GOTO      KHSA1410                 * Re-enter Number
.
KHSA1420  MOVE      EXIT,OPCNWLDS 
          MOVE      DNO,DDESC14
          LOAD      DDESC14,EXIT,DOPR,DBOK,DBOTH,DOPB
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,DDESC14
          GOTO      KHSA0000
.
. ------- OPCNWLTM - Default Operation Time from W/L Time           ----
.
KHSA1500  MOVE      "68",CCOL
          MOVE      "18",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNWLTM           * set value
          GOTO      KHSA0000
.
. ------- OPCNWLIT - Default Provisional item From W/L Procedure code ----
.
KHSA1600  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF,"=No, ":
                               *V2LON,"1",*HOFF,"=Operation, ":
                               *V2LON,"2",*HOFF,"=Booking Diagnosis, ":
                               *V2LON,"3",*HOFF,"=Operation & Booking"
KHSA1610  MOVE      "68",CCOL
          MOVE      "19",CVERT
          KEYIN     *PCCOL:CVERT,*DV,UNDLN1,*EL:
                    *PCCOL:CVERT,*V2LON,EXIT
          BRANCH    EXIT,KHSA1620,KHSA1620,KHSA1620
.                          Oper.  Booking   Both
          COMPARE   ZERO,EXIT
          GOTO      KHSA1620 IF EQUAL
          BEEP                               * Error
          GOTO      KHSA1610                 * Re-enter Number
.
KHSA1620  MOVE      EXIT,OPCNWLIT 
          MOVE      DNO,DDESC16
          LOAD      DDESC16,EXIT,DOPR,DBOK,DBOTH
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,DDESC16
          GOTO      KHSA0000
.
. ------- OPCNBKBD - Using booking date audit ----
.
KHSA1700  MOVE      "68",CCOL
          MOVE      "20",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNBKBD           * set value
          GOTO      KHSA0000
.
. ------- OPCNTREQ - Print Tray Contents on Requisitions ----
.
KHSA1800  MOVE      "68",CCOL
          MOVE      "21",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNTREQ           * set value
          GOTO      KHSA0000
.
. ------- OPCNBELT - Using Eltron printer for BOK labels ----
.
KHSA1900  MOVE      "68",CCOL
          MOVE      "22",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNBELT           * set value
          GOTO      KHSA0000
.
. ------- OPCNESIS - Using ESIS from W/L ----
.
KHSA2000  MOVE      "68",CCOL
          MOVE      "23",CVERT
          CALL      KYNO0000
          MOVE      EXIT,OPCNESIS           * set value
          GOTO      KHSA0000
.
. ------- set exit flags -------
.
KHSA9900  CALL      VPST00000               * fields valid to post
          BRANCH    EXIT,KHSA0000
          MOVE      ZERO,EXIT               * post
          GOTO      KHSA9999
.
KHSA9910  MOVE      ONE,EXIT                * cancel
.
KHSA9999  RETURN
+
.*********************************************************************
.*                  WHSA0000                    Called by : ML8000   *
.*        Write details for hospital screen 1                        *
.*********************************************************************
WHSA0000  DISPLAY   *P60:24,*V2LON,"*** POSTING ***";
          WRITAB    CONTROLF,FORTY;*72,OPCNBKBD
          WRITAB    CONTROLF,FORTY2;*70,OPCNWLDS:
                             *90,OPCNASTD,OPCNPCOM,OPCNDFAD,OPCNCLSH:
                             *100,OPCNUSGE,OPCNSGCL,OPCNCHMB,*104,OPCNCBOK:
                             *117,OPCNDFCC,OPCNCMBD,OPCNASLN,OPCNPC64,OPCNPAMT:
                                  OPCNWLTM,OPCNWLIT:
                             *128,OPCNTREQ
          WRITAB    CONTROLF,SIXTY8;*235,OPCNBELT,OPCNESIS
WHSA9999  RETURN
+
.*********************************************************************
.*                  DHSB0000                    Called by : ML8000   *
.*        Display Hospital screen One                                *
.*********************************************************************
DHSB0000  READ      CONTROLF,FORTY2;*133,OPCNMIND,OPCNPODY:
                                    *140,OPCNPTUP,OPCNFTUP,OPCNBRUP
          READ      CONTROLF,SIXTY8;*237,OPCNPHDB,*241,OPCNSTCT,*244,OPCNCPOD
.
          MOVE      OPCNPHDB,FORM1
          ADD       ONE,FORM1
          LOAD      DDESC1,FORM1,DPHN,DDOB
.
          MOVE      DNO,DDESC23
          LOAD      DDESC23,OPCNCPOD,DYES,DPRO
.
          PACK      KEY5,CODEOP,OPCNSTCT
          CALL      RDCODE1
          BRANCH    OVRCD,DHSB1000
.
DHSB1000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 1",*HOFF:
                    ". Use home phone or date of birth in IBAOPR43":
                    "     : ",*V2LON,*P55:4,OPCNPHDB,*P65:4,DDESC1:
                    *P1:5,*V2LON," 2",*HOFF:
                    ". Minutes Delayed                            ":
                    "     : ",*V2LON,*P55:5,OPCNMIND:
                    *P1:6,*V2LON," 3",*HOFF:
                    ". No of Pre-Op days                          ":
                    "     : ",*V2LON,*P55:6,OPCNPODY:
                    *P1:7,*V2LON," 4",*HOFF:
                    ". Staff Category for Operating Surgeon       ":
                    "     : ",*V2LON,*P55:7,OPCNSTCT,*P60:7,*HOFF,TDESC:
                    *P1:8,*V2LON," 5",*HOFF:
                    ". Copy Booking Full Operation Desc to Surgery":
                    "     : ",*V2LON,*P55:8,DDESC23:
                    *P1:9,*V2LON," 6",*HOFF:
                    ". Path for Theatre Upload file ":
                    "    : ",*V2LON,*P40:9,OPCNPTUP:
                    *P1:10,*V2LON," 7",*HOFF:
                    ". File name for Theatre Upload ":
                    "    : ",*V2LON,*P40:10,OPCNFTUP:
                    *P1:11,*V2LON," 8",*HOFF:
                    ". Window Dir.mapped Upload Path":
                    "    : ",*V2LON,*P40:11,OPCNBRUP;
.  
DHSB9999  RETURN
+
.*********************************************************************
.*                  KHSB0000                    Called by : ML8000   *
.*        Keyin details for Hospital screen 1                        *
.*********************************************************************
KHSB0000  CALL      MAINQST
          BRANCH    CCITEM,KHSB0100,KHSB0200,KHSB0300,KHSB0400,KHSB0500:
                           KHSB0600,KHSB0700,KHSB0800
.
          COMPARE   ZERO,CCITEM
          GOTO      KHSB9900 IF EQUAL       * Post
          GOTO      KHSB9910 IF LESS        * Cancel
.
          BEEP
          GOTO      KHSB0000
.
. ----- OPCNASTD - Use home phone or date of birth in IBAOPR43 -----
.
KHSB0100  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = Home Phone, ":
                               *V2LON,"1",*HOFF," = Date of Birth, " 
KHSB0110  MOVE      OPCNPHDB,FORM1
          MOVE      "55",CCOL
          MOVE      "4",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,*RV,FORM1
.
          BRANCH    FORM1,KHSB0120
          COMPARE   ZERO,FORM1
          GOTO      KHSB0120 IF EQUAL
          BEEP                               * Error
          GOTO      KHSB0110                 * Re-enter Number
.
KHSB0120  MOVE      FORM1,OPCNPHDB
.         MOVE      DNO,DDESC1 
          ADD       ONE,FORM1
          LOAD      DDESC1,FORM1,DPHN,DDOB
          DISPLAY   *P65:4,*EL,*V2LON,DDESC1
          GOTO      KHSB0000
.
. ----- OPCNMIND - Minutes Delayed -----
.
KHSB0200  MOVE      "55",CCOL
          MOVE      "5",CVERT
KHSB0210  MOVE      OPCNMIND,F5
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,*RV,F5;
          COMPARE   ZERO,F5
          GOTO      KHSB0220 IF NOT LESS    * Minutes >= 0
.
          DISPLAY   *P1:24,*EL,*B,"Minutes must not be negative.  ";
          CALL      HITENTER
          GOTO      KHSB0210
.
KHSB0220  MOVE      F5,OPCNMIND
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,OPCNMIND;
          GOTO      KHSB0000
.
. ----- OPCNPODY - Pre-Op days-----
.
KHSB0300  MOVE      "55",CCOL
          MOVE      "6",CVERT
KHSB0310  MOVE      OPCNPODY,F2
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,*RV,F2;
          COMPARE   ZERO,F2
          GOTO      KHSB0320 IF NOT LESS    * Minutes >= 0
.
          DISPLAY   *P1:24,*EL,*B,"Must not be negative.  ";
          CALL      HITENTER
          GOTO      KHSB0310
.
KHSB0320  MOVE      F2,OPCNPODY
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,OPCNPODY;
          GOTO      KHSB0000
.
. ----- OPCNSTCT - Staff Category for Operating Surgeon-----
.
KHSB0400  KEYIN     *P55:7,*EL,*V2LON,OPCNSTCT
          MOVE      CODEOP,CODE
.
          ENDSET    OPCNSTCT
          APPEND    SP3,OPCNSTCT
          RESET     OPCNSTCT
.
          MATCH     SP3,OPCNSTCT
          GOTO      KHSB0000 IF EQUAL       * nothing entered
.
          CMATCH    QUEST,OPCNSTCT
          GOTO      KHSB0410 IF NOT EQUAL   
.
.         ? entered
.
          CALL      PATCODDS                * ? routine
          DISPLAY   *P1:24,"Staff Category : ",*EL;
          KEYIN     *P20:24,*EL,*V2LON,OPCNSTCT
.
KHSB0410  PACK      KEY5,CODEOP,OPCNSTCT      * key of entered value
          CALL      RDCODE1                 * read code file
          BRANCH    OVRCD,KHSB0490          * invalid input
          MOVE      OPCNSTCT,KEY3
          MOVE      TDESC,KEY20
.
          CALL      DHSB0000
          MOVE      KEY3,OPCNSTCT
          DISPLAY   *P55:7,*V2LON,OPCNSTCT,*P60:7,*HOFF,KEY20
          GOTO      KHSB0000                * valid input
.
.         ERROR: invalid code entered
.
KHSB0490  DISPLAY   *P1:24,*EL,*B,*V2LON,"** Invalid Operation Type **    ";
          CALL      HITENTER
          DISPLAY   *P1:24,"Staff Category : ",*EL;
          KEYIN     *P20:24,*EL,*V2LON,OPCNSTCT
          GOTO      KHSB0410
.
. ------- OPCNCPOD - Copy booking full description to surgical details ----
.
KHSB0500  MOVE      "55",CCOL
          MOVE      "8",CVERT
          CALL      KYDE0000
          GOTO      KHSB0000
.
KHSB0600  KEYIN     *P40:9,*EL,*V2LON,OPCNPTUP
          ENDSET    OPCNPTUP
          APPEND    SP70,OPCNPTUP
          RESET     OPCNPTUP
          DISPLAY   *P40:9,*V2LON,OPCNPTUP
          GOTO      KHSB0000
.
KHSB0700  KEYIN     *P40:10,*EL,*V2LON,OPCNFTUP
          ENDSET    OPCNFTUP
          APPEND    SP30,OPCNFTUP
          RESET     OPCNFTUP
          DISPLAY   *P40:10,*V2LON,OPCNFTUP
          GOTO      KHSB0000
.
KHSB0800  KEYIN     *P40:11,*EL,*V2LON,OPCNBRUP
          ENDSET    OPCNBRUP
          APPEND    SP30,OPCNBRUP
          RESET     OPCNBRUP
          DISPLAY   *P40:11,*V2LON,OPCNBRUP
          GOTO      KHSB0000
.
. ------- set exit flags -------
.
KHSB9900  CALL      VPST0000                * fields valid to post
          BRANCH    EXIT,KHSB0000
          MOVE      ZERO,EXIT               * post
          GOTO      KHSB9999
.
KHSB9910  MOVE      ONE,EXIT                * cancel
.
KHSB9999  RETURN
+
.*********************************************************************
.*                  WHSB0000                    Called by : ML8100   *
.*        Write details for hospital screen 2                        *
.*********************************************************************
WHSB0000  DISPLAY   *P60:24,*V2LON,"*** Posting ***";
          WRITAB    CONTROLF,FORTY2;*133,OPCNMIND,OPCNPODY:
                                    *140,OPCNPTUP,OPCNFTUP,OPCNBRUP
          WRITAB    CONTROLF,SIXTY8;*237,OPCNPHDB,*241,OPCNSTCT,*244,OPCNCPOD
WHSB9999  RETURN
+
.*********************************************************************
.*  VPST0000  :  Check if data is valid to post                      *
.*********************************************************************
VPST0000  MOVE     ZERO,EXIT
.
          COMPARE  ZERO,OPCNASTD
          GOTO     VPST9999 IF EQUAL
.
          COMPARE  ZERO,OPCNASLN
          GOTO     VPST9999 IF EQUAL
.
          DISPLAY  *P1:24,*B,"Fields 1 and 11 cannot both be 'Yes'.  ";
          CALL     HITENTER
          MOVE     ONE,EXIT
.
VPST9999  RETURN
.
.*********************************************************************
.*                  KYNO0000                    Called by : xxxx0000 *
.*        Enter a yes/no question                                    *
.*        Para's  : CCOL & CVERT                                     *
.*        Returns : EXIT = 1      Yes entered                        *
.*                  EXIT = 0      No  entered                        *
.*********************************************************************
KYNO0000  KEYIN     *PCCOL:CVERT,*DV,UNDLN1,*EL:
                    *PCCOL:CVERT,*V2LON,ANS
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KYNO1000 IF EQUAL       * Yes
.
          MATCH     "N",ANS
          GOTO      KYNO2000 IF EQUAL       * No
.
          BEEP
          GOTO      KYNO0000
.
KYNO1000  MOVE      "1",EXIT                * set to yes
          MOVE      DYES,ACODE
          GOTO      KYNO9000
.
KYNO2000  MOVE      DNO,ACODE               * set to no 
          MOVE      "0",EXIT                * set to no 
.
KYNO9000  DISPLAY   *PCCOL:CVERT,*V2LON,ACODE
.
KYNO9999  RETURN
+
KYDE0000 
. ----- OPCNCPOD - Default full description to surgery details -----
.
KYDE0100  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = No, ":
                               *V2LON,"1",*HOFF," = Yes, ":
                    *V2LON,"2",*HOFF," = Yes,if blank use procedure description"
KYDE0110  MOVE      OPCNCPOD,FORM1
          MOVE      "55",CCOL
          MOVE      "8",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,*RV,FORM1
.
          BRANCH    FORM1,KYDE0120,KYDE0120
          COMPARE   ZERO,FORM1
          GOTO      KYDE0120 IF EQUAL
          BEEP                               * Error
          GOTO      KYDE0110                 * Re-enter Number
.
KYDE0120  MOVE      FORM1,OPCNCPOD
.         MOVE      DNO,DDESC23
          ADD       ONE,FORM1
          LOAD      DDESC23,FORM1,DYES,DPRO
          DISPLAY   *P55:8,*EL,*V2LON,DDESC23
          GOTO      KYDE9999
.
KYDE9999  RETURN
+
.*********************************************************************
.*                      LDOPD000               called by: UUDP2200   *
.*       Load options for operation duration              UUDP2300   *
.*********************************************************************
LDOPD000  CALL      BUILD000         * build new tempfile
.
          MOVE      ZERO,COUNT
          WHILE     COUNT < 14
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,TIMECALL,TIMEARRV,ANTHPREP,ANTHCOMM:
                                      PREPSTTM,SURGSTTM,SURGEDTM,ANTHSEND:
                                      DRSSTIME,RECOVRYF,RECOVRYB,RECVRYDY:
                                      RDEPART,EXITTHTR
.
            MOVE      COUNT,TEMPCODE 
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
LDOPD999  RETURN
.********************************************************************
.*                    BUILD000 - Build a New Temp File              *
.********************************************************************
.
BUILD000  CALL      KILL0000                
.
          PACK      CMDLINE,SP70
          CLEAR     CMDLINE
          APPEND    "isbuild ",CMDLINE
          APPEND    TEMPNAME,CMDLINE
          APPEND    TEMPINDX,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      TMPCODE1,TEMPNAME
          OPEN      TMPCODE2,TEMPNAME
BUILD999  RETURN
+
.********************************************************************
.*                    KILL0000 - Kills the Old Temp File            *
.********************************************************************
.
KILL0000  CLOSE     TMPCODE1
          PACK      CMDLINE,SP70
          CLEAR     CMDLINE
          APPEND    "iserase ",CMDLINE
          APPEND    TEMPNAME,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          RETURN
.
.********************************************************************
.*                    Temp File I/O Routines                        *
.********************************************************************
.
WRTEMP1   RESET     KEY8
          WRITE     TMPCODE1,KEY8;TEMPCODE,TEMPDESC
          RETURN
.
RDATEMP1  RESET     KEY8
          READ      TMPCODE1,KEY8;ANS
          RETURN
.
RDSTEMP1  RESET     KEY8
          READ      TMPCODE1,KEY8;;
          RETURN
.
RDTEMP1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      TMPCODE1,KEY8;TEMPCODE,TEMPDESC
          GOTO      OVERCOND IF OVER
          RETURN
.
RDKTEMP1  MOVE      ZERO,OVRCD
          READKS    TMPCODE1;TEMPCODE,TEMPDESC
          GOTO      OVERCOND IF OVER
          RETURN
.
RDPTEMP1  MOVE      ZERO,OVRCD
          READKP    TMPCODE1;TEMPCODE,TEMPDESC
          GOTO      OVERCOND IF OVER
          RETURN
.
RDATEMP2 RESET     KEY38
         READ      TMPCODE2,KEY38;ANS
         RETURN     
.
RDSTEMP2 RESET     KEY38
         READ      TMPCODE2,KEY38;;
         RETURN     
.
RDTEMP2  MOVE      ZERO,OVRCD
         RESET     KEY38
         READ      TMPCODE2,KEY38;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDKTEMP2 MOVE      ZERO,OVRCD
         READKS    TMPCODE2;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDPTEMP2 MOVE      ZERO,OVRCD
         READKP    TMPCODE2;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
.------------------------------------------------------------------------------
+
.
. ------- I/O ROUTINES -------
.
          INCLUDE   STD001IO
          INC       TFILENAM                * Generate Temp File Name
          INC       IBASEQIO/INC            * Sequential Numbers File
          INC       WEBERRIO/INC            * Web Server Error Logging
.
          INC       IBASECUR                * Keyin IBA screen security passwd
          INC       GENCODKY
          INC       PATCODIO/INC
          INC       PATCODDS
................................................................................
