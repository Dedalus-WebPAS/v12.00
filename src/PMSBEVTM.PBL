. *----------------------------------------------------------------------
. * Include Name  :   PMSBEVTM.PBL
. *
. * Function      :   CGI variables for PMSBEVFD - pmsbevaf
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.00.00  27/07/2010  Jill Parkinson CAR 222551
.             Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for birth event table
.------------------------------------------------------------------------
CPPMBV00  MOVE      Z70,PMBEV001
          MOVE      Z70,PMBEV002 
          MOVE      Z70,PMBEV003
          MOVE      Z70,PMBEV004
          MOVE      Z70,PMBEV005
          MOVE      Z70,PMBEV006
          MOVE      Z70,PMBEV007
          MOVE      Z70,PMBEV008
          MOVE      Z70,PMBEV009
.
CPPMBV99  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Birth Event table
.------------------------------------------------------------
SPMBV000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMBV001,SPMBV002,SPMBV003,SPMBV004,SPMBV005:
                       SPMBV006,SPMBV007,SPMBV008,SPMBV009
.
          MOVE      ONE,EXIT
          GOTO      SPMBV999
.
SPMBV001  PACK      PMBEV001,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV002  PACK      PMBEV002,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV003  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMBEV003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMBV999
.
SPMBV004  PACK      PMBEV004,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV005  PACK      PMBEV005,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV006  PACK      PMBEV006,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV007  PACK      PMBEV007,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV008  PACK      PMBEV008,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV009  PACK      PMBEV009,QRYDATA,SP70
          GOTO      SPMBV999
.
SPMBV999 RETURN
+
.------------------------------------------------------------
. Output birth event details
.------------------------------------------------------------
PMBV0000  BRANCH    FLDITMNO,PMBV0010,PMBV0020,PMBV0030,PMBV0040,PMBV0050:
                             PMBV0060,PMBV0070,PMBV0080,PMBV0090,PMBV0100:
                             PMBV0110,PMBV0120,PMBV0130,PMBV0140,PMBV0150:
                             PMBV0160,PMBV0170,PMBV0180,PMBV0190,PMBV0200:
                             PMBV0210
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMBV9999
.
PMBV0010  WRITE     HTMLFILE;PMBEUNIQ;      * Pregnancy Unique Id
          GOTO      PMBV9999
.
PMBV0020  WRITE     HTMLFILE;PMBEBUNQ;      * Birth Unique ID
          GOTO      PMBV9999
.
PMBV0030  MATCH     PMBEEDAT,SP70           * Compication/treatment date
          GOTO      PMBV9999 IF EQUAL
          UNPACK    PMBEEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMBV9999
.
PMBV0040  WRITE     HTMLFILE;PMBEETIM;      * Time
          GOTO      PMBV9999
.
PMBV0050  WRITE     HTMLFILE;PMBETYPE;      * Record Type
          GOTO      PMBV9999
.
PMBV0060  MOVE      "ND",CATEGORY           * Event Type
          MOVE      PMBEETYP,CODE
          CALL      CODITM00
          GOTO      PMBV9999
.
PMBV0070  MOVE      "NE",CATEGORY           * Event Status
          MOVE      PMBEESTA,CODE
          CALL      CODITM00
          GOTO      PMBV9999
.
PMBV0080  WRITE     HTMLFILE;PMBEDES1;      * Description 1
          GOTO      PMBV9999
.
PMBV0090  WRITE     HTMLFILE;PMBEDES2;      * Description 2
          GOTO      PMBV9999
.
PMBV0100  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. creator
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMBV0105
          WRITE     HTMLFILE;PMBEWEBC;
          GOTO      PMBV9999
PMBV0105  PACK      KEY10,PMBEWEBC,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,PMBV9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMBV9999
.
PMBV0110  MATCH     PMBEDATC,SP70             * Date Record Created
          GOTO      PMBV9999 IF EQUAL
          UNPACK    PMBEDATC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMBV9999
.
PMBV0120  MATCH     PMBETIMC,SP70             * Time Record Created
          GOTO      PMBV9999 IF EQUAL
          WRITE     HTMLFILE;PMBETIMC;
          GOTO      PMRG9999
.
PMBV0130  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. updated
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMBV0135
          WRITE     HTMLFILE;PMBEWEBU;
          GOTO      PMBV9999
PMBV0135  PACK      KEY10,PMBEWEBU,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,PMBV9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMBV9999
.
PMBV0140  MATCH     PMBEDATU,SP70             * Date Record Updated
          GOTO      PMBV9999 IF EQUAL
          UNPACK    PMBEDATU,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMBV9999
.
PMBV0150  MATCH     PMBETIMU,SP70             * Time Record Created
          GOTO      PMBV9999 IF EQUAL
          WRITE     HTMLFILE;PMBETIMU;
          GOTO      PMBV9999
.
PMBV0160  WRITE     HTMLFILE;PMBERECS;
          GOTO      PMBV9999
.
PMBV0170  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. deleted
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMBV0175
          WRITE     HTMLFILE;PMBEWEBD;
          GOTO      PMBV9999
PMBV0175  PACK      KEY10,PMBEWEBD,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,PMBV9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMBV9999
.
PMBV0180  MATCH     PMBEDATD,SP70             * Date Record Deleted
          GOTO      PMBV9999 IF EQUAL
          UNPACK    PMBEDATD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMBV9999
.
PMBV0190  MATCH     PMBETIMD,SP70             * Time Record Deleted
          GOTO      PMBV9999 IF EQUAL
          WRITE     HTMLFILE;PMBETIMD;
          GOTO      PMRG9999
.
PMBV0200  CALL      BEVE0000                  * Birth Event  List
          GOTO      PMBV9999
.
PMBV0210  WRITE     HTMLFILE;BRTHUNIQ;
          GOTO      PMBV9999
.
PMBV9999  RETURN
+
.------------------------------------------------------------
.  Update birth event file
.------------------------------------------------------------
MVPMBV00  MATCH     PMBEV001,Z70
          IF        !@EQUAL
            MOVE      PMBEV001,PMBEUNIQ
          ENDIF
.
          MATCH     PMBEV002,Z70
          IF        !@EQUAL
            MOVE      PMBEV002,PMBEBUNQ
          ENDIF
.
          MATCH     PMBEV003,Z70
          IF        !@EQUAL
            MOVE      PMBEV003,PMBEEDAT
          ENDIF
.
          MATCH     PMBEV004,Z70
          IF        !@EQUAL
            MOVE      PMBEV004,PMBEETIM
          ENDIF
.
          MATCH     PMBEV005,Z70
          IF        !@EQUAL
            MOVE      PMBEV005,PMBETYPE
          ENDIF
.
          MATCH     PMBEV006,Z70
          IF        !@EQUAL
            MOVE      PMBEV006,PMBEETYP
          ENDIF
.
          MATCH     PMBEV007,Z70
          IF        !@EQUAL
            MOVE      PMBEV007,PMBEESTA
          ENDIF
.
          MATCH     PMBEV008,Z70
          IF        !@EQUAL
            MOVE      PMBEV008,PMBEDES1
          ENDIF
.
          MATCH     PMBEV009,Z70
          IF        !@EQUAL
            MOVE      PMBEV009,PMBEDES2
          ENDIF
.
MVPMBV99  RETURN
+
.------------------------------------------------------------
.  Clear complications file variables
.------------------------------------------------------------
CLPMBV00  PACK      PMBEUNIQ,SP70
          PACK      PMBEBUNQ,SP70
          PACK      PMBEEDAT,SP70
          PACK      PMBEETIM,SP70
          PACK      PMBETYPE,SP70
          PACK      PMBEETYP,SP70
          PACK      PMBEESTA,SP70
          PACK      PMBEDES1,SP70
          PACK      PMBEDES2,SP70
          PACK      PMBEWEBC,SP70
          PACK      PMBEDATC,SP70
          PACK      PMBETIMC,SP70
          PACK      PMBEWEBU,SP70
          PACK      PMBEDATU,SP70
          PACK      PMBETIMU,SP70
          PACK      PMBERECS,SP70
          PACK      PMBEWEBD,SP70
          PACK      PMBEDATD,SP70
          PACK      PMBETIMD,SP70
          PACK      PMBESPAR,SP70
.
          RETURN
+
.------------------------------------------------------------
.   List of records on pmsbevaf for a birth
.------------------------------------------------------------
BEVE0000  MATCH     Z70,PREGUNIQ
          GOTO      BEVE9999 IF EQUAL
.
          MATCH     Z70,BRTHUNIQ
          GOTO      BEVE9999 IF EQUAL
.
          PACK      KEY42,PREGUNIQ,BRTHUNIQ,Z70
          CALL      RSPMBEV1
BEVE0100  CALL      RPPMBEV1
          BRANCH    OVRCD,BEVE9999
.
          MATCH     PREGUNIQ,PMBEUNIQ
          GOTO      BEVE9999 IF NOT EQUAL
.
          MATCH     BRTHUNIQ,PMBEBUNQ
          GOTO      BEVE9999 IF NOT EQUAL
.
          CLEAR     HTMLLINK
          APPEND    "javascript:ViewDetails('",HTMLLINK
          APPEND    URNUMBER,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMBEUNIQ,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMBEBUNQ,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMBEEDAT,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMBEETIM,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMBETYPE,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMBEETYP,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
          PACK      RECODESC,SP70
          MATCH     "001",PMBETYPE
          IF        @EQUAL
            PACK      RECODESC,RESUSITN,SP70
          ENDIF
          MATCH     "002",PMBETYPE
          IF        @EQUAL
            PACK      RECODESC,CONGENTL,SP70
          ENDIF
          MATCH     "003",PMBETYPE
          IF        @EQUAL
            PACK      RECODESC,LABOUREV,SP70
          ENDIF
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",PMBEUNIQ,"#",":
                             "#"",PMBEBUNQ,"#",":
                             "#"",PMBEEDAT,"#",":
                             "#"",PMBEETIM,"#",":
                             "#"",PMBETYPE,"#",":
                             "#"",PMBEETYP,"#",":
                             "#"",PMBEESTA,"#",":
                             "#"",PMBEDES1,"#",":
                             "#"",PMBEDES2,"#",":
                             "#"",PMBEWEBC,"#",":
                             "#"",PMBEDATC,"#",":
                             "#"",PMBETIMC,"#",":
                             "#"",PMBEWEBU,"#",":
                             "#"",PMBEDATU,"#",":
                             "#"",PMBETIMU,"#",":
                             "#"",RECODESC,"#");"
.
          GOTO      BEVE0100
.
BEVE9999  RETURN
+




