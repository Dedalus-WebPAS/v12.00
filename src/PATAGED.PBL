.
.       Calculate the current patients age at a given date (ASDATE)
.
.       The following variables need to be defined in the program 
.******************************************************************************
. MODS:
.                   08/10/1998  Glenn Berry      5.07 changes
.******************************************************************************
.
.SRBDAY    DIM          4              * MMDD
.SRYEAR    FORM         4              * CCYY
.ASDATE    DIM          8
.
.
PATAGED UNPACK          ASDATE,XCENT,XYEAR,XMON,XDAY
.
        UNPACK          PBDATE,CCENT,CYEAR,CMON,CDAY   * Unpack the birthdate
        PACK            DIM4,CCENT,CYEAR        * Pack up the full birth year
        REP             " 0",DIM4
        MOVE            DIM4,SRYEAR              * Birth year as numeric
.
        PACK            SRBDAY,CMON,CDAY         * Pack up the annual birthdate
        REP             " 0",SRBDAY           
.
        PACK            DIM4,XCENT,XYEAR         * Pack up the full current year
        REP             " 0",DIM4
        MOVE            DIM4,FORM4               * Current year as a numeric
.
.       Calculate the number of years since birth
.
        SUB             SRYEAR,FORM4
        MOVE            FORM4,PSAGE               * Save the number years
.
.       Check if the day and month born is less than the current date
.
        PACK             DIM4,XMON,XDAY
        REP              " 0",DIM4
.
        MATCH            SRBDAY,DIM4               * Has the birthday past yet?
        GOTO             PAGED10 IF NOT LESS       * Yes.
.
        SUB              ONE,PSAGE                 * Haven't reached the 
.                                                  * birthday yet
PAGED10 RETURN
.
.
