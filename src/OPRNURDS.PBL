.******************************************************************************
.                                 OPRNURDS
.                       Nurse codes      
.
. Description : Display Nurse Codes in surname order from the oprnuraf
.               file using the 2nd index.
.
. Requirements: This routine requires OPRNURFD and OPRNURIO.INC and KEY6
.               and KEY66
.
.             OPRNURDS was written by Monika Ohleiter on the 29/12/1989
.                        I.B.A. Development Department
.                             D. Jones supervisor
.
.   Modifications :   V5.01.01 05/03/91 J.Tan      SRF 108013
.                     Fixed displaying second screen of nursing codes
.                     V5.01.02 19/08/92 J.Tan     SRF 116653
.                     Mods to exlude inactive nurses
.                     V5.04.01 14/01/1997  Steve Armstrong
.                     Removed TRAP statements for TBC 7
.
.******************************************************************************
OPRNURDS 
.
          DISPLAY    *P1:4,*EF,*P34:4,*V2LON,*ULON,"NURSE CODES"
          MOVE       FIVE,CVERT
          MOVE       ONE,CCOL
.
          PACK       KEY66,SP30,SP30,SP6
          CALL       RSOPNUR2
NURDS222  
          CALL       RKOPNUR2
          BRANCH     OVRCD,NURDS990
.
          COMPARE    ONE,OPNRSTAT
          GOTO       NURDS222 IF EQUAL  * Non-active
.
          DISPLAY    *PCCOL:CVERT,*V2LON,OPNRCODE,SP2,*HOFF,OPNRSNAM,SP2:
                                         OPNRGNAM
          ADD        ONE,CVERT
          COMPARE    TWENTY3,CVERT
          GOTO       NURDS222 IF LESS
.
.         MOVE       FIVE,CVERT
.         ADD        "40",CCOL
.         COMPARE    "70",CCOL
.         GOTO       NURDS222 IF LESS
.
.         Check for old or new standards question
.
          BRANCH    CNEWDS,NURDS200
.
          KEYIN     *P1:24,*EL," (",*V2LON,"E",*HOFF,")xit, (":
                    *V2LON,"F",*HOFF,")irst Screen, (":
                    *V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
          CMATCH    ANSF,ANS
          GOTO      OPRNURDS IF EQUAL
          CMATCH    ANSE,ANS
          GOTO      NURDS999 IF EQUAL
          GOTO      NURDS400
.
.         New standards question
.
NURDS200  KEYIN     *P1:24,*EL," (",*V2LON,"C",*HOFF,")ontinue, ":
                    "(",*V2LON,"F",*HOFF,")irst Screen, ":
                    "(",*V2LON,"N",*HOFF,")ext Screen : ",*V2LON,ANS;
          CMATCH    ANSC,ANS
          GOTO      NURDS999 IF EQUAL
          CMATCH    ANSF,ANS
          GOTO      OPRNURDS IF EQUAL
.
.         Clear the screen
.
NURDS400  MOVE      FIVE,CVERT
          MOVE      ONE,CCOL
          DISPLAY   *P1:CVERT,*EF
.
          GOTO      NURDS222
.
NURDS990  BRANCH    CNEWDS,NURDS999
          DISPLAY   *P1:24,*EL;
          CALL      HITENTER
NURDS999  RETURN
