. ************************************************************
. *                P R O G R A M  S U M M A R Y              *
. *                - - - - - - -  - - - - - - -              *
. *                                                          *
. *     PROGRAM NAME:          CREASEC0                      *
. *                                                          *
. *     FUNCTION:              CREATE ZERO FILLED SECTOR FILE*
. *                                                          *
. *     AUTHOR:                SOMEONE FROM THE PAST         *
. *                                                          *
. *     MODIFICATIONS:                                       *
. *       C2.00.01  Greg Horvat                              *
. *                 Changed to create sectors for S files    *
. *                            W2.00 M.HAYSE (I.B.A)         *
. *                            NEW HIGHLIGHTING AND UNDERLINE*
. *                                                          *
. *                                                          *
. *                  * A T T E N T I O N *                   *
. *                  - - - - - - - - - - -                   *
. *            THIS PROGRAM IS THE PROPERTY OF               *
. *            INFORMATION BUILDERS (AUSTRALIA) PTY LTD      *
. *            AND MUST NOT BE UTILISED MODIFIED OR          *
. *            COPIED IN ANY MANNER WHATSOEVER WITHOUT       *
. *            THE EXPRESS WRITTEN PERMISSION OF             *
. *            INFORMATION BUILDERS (AUSTRALIA) PTY LTD.     *
. *                                                          *
. ************************************************************
.
         INC       COMMON/INC
         INC       IBACOMM/INC  ***** IBA VARIABLES
.
.
. THIS PROGRAM WILL CREATE A SECTOR ZERO RECORD FOR A NOMINATED FILE AND/OR
. CREATE ZERO FILLED RECORDS IN A USER SPECIFIED RANGE.
.
.
 IFGE     $$VER,7
OUT       SFILE     ASCII,FIXED=256
 XIF
 IFEQ     $$VER,6
OUT       FILE      ASCII,FIXED=256
 XIF
.
SEC    FORM    6
.
FNAME  DIM     8
.
CONTENT DIM     20
FIL50  INIT    "00000000000000000000000000000000000000000000000000"
FIL48  INIT    "000000000000000000000000000000000000000000000000"
.
STARTS FORM    6
ENDS   FORM    6
PROG   DIM     8
.
VERSION   INIT      "V12.00.00"
.
. CONFIRM USER REQUIREMENTS
.
START  DISPLAY *ES,*P1:1,"*** INFORMATION BUILDERS AUSTRALIA":
                         *V2LON," CREASEC0 ",*HOFF:
                                "CREATE SECTORS ",VERSION," ***"
.
       DISPLAY     *P1:3,*V2LON," 0 ",*HOFF,"= CHAIN ANSWER":
                   *P1:4,*V2LON," 1 ",*HOFF,"= CREATE SECTOR ZERO":
                   *P1:5,*V2LON," 2 ",*HOFF,"= CREATE ZERO FILLED SECTORS":
                   *P1:6,*V2LON," 3 ",*HOFF,"= CHAIN DISPLAY":
                   *P1:7,*V2LON," 4 ",*HOFF,"= CHAIN ISAMFIX":
                   *P1:8,*V2LON," 5 ",*HOFF,"= CHAIN TEXTFIX":
                   *P1:9,*V2LON," 6 ",*HOFF,"= CHAIN LIST":
                  *P1:10,*V2LON," 7 ",*HOFF,"= CHAIN TO ANOTHER PROGRAM":
                  *P1:11,*V2LON," 8 ",*HOFF,"= EXIT"
.
REKEY   KEYIN     *P1:12,"OPTION : ",*V2LON,OPTION
         COMPARE   ZERO,OPTION
         GOTO      CHIBA IF EQUAL
.
         BRANCH    OPTION OF OPTA,OPTA,CHDSP:
                   CHISM,CHTXT,CHLST,ELSEWHER,CHOUT
         BEEP
         GOTO      REKEY
.
CHDSP    CHAIN     "DISPLAY"
.
CHIBA    CHAIN     "ANSWER"
.
CHTXT    CHAIN     "TEXTFIX"
.
CHISM    CHAIN     "ISAMFIX"
.
CHLST    CHAIN     "LIST"
.
CHOUT    SHUTDOWN   ""
.
.
.
OPTA   MOVE    "0",SEC
       KEYIN   *P1:3,*EF,*P5:4,"FILE TO BE CREATED? (ENTER IF NO MORE) ",FNAME
       RESET   FNAME
       GOTO    START IF EOS
.
       BRANCH  OPTION OF OPT1,OPT2
.
. CREATE SECTOR ZERO OF A FILE AND WRITE EOF IN SECTOR ONE
.
OPT1   KEYIN   *P5:7,"CONTENTS OF SECTOR ZERO - ....................":
               *P31:7,CONTENT
       RESET   CONTENT
       GOTO    START IF EOS
       PREPARE OUT,FNAME
       WRITE   OUT,SEC;CONTENT
       ADD     "1",SEC
       WEOF    OUT,SEC
       CLOSE   OUT
       GOTO    OPTA
.
. CREATE ZERO FILLED SECTORS
.
OPT2   KEYIN   *P5:7,*EF:
               *P5:7,"START SECTOR NUMBER - ",STARTS:
               *P43:7,"OK? Y",*P47:7,ANS
       RESET   ANS
       GOTO    OPT201 IF EOS
       MATCH   "N",ANS
       GOTO    OPT2 IF EQUAL
.
OPT201 KEYIN   *P5:8,"  END SECTOR NUMBER - ",ENDS:
               *P43:8,"OK? Y",*P47:8,ANS
       RESET   ANS
       GOTO    OPT210  IF EOS
       MATCH   "N",ANS
       GOTO    OPT201 IF EQUAL
.
       KEYIN   *P5:10,"ALL OK TO CONTINUE? (Yes/No/eXit) Y",*P39:10,ANS
OPT210 RESET   ANS
       GOTO    OPT220 IF EOS
       MATCH   "Y",ANS
       GOTO    OPT220 IF EQUAL
       MATCH   "N",ANS
       GOTO    OPT2 IF EQUAL
       MATCH   "X",ANS
       GOTO    OPTA IF EQUAL
.
OPT220 TRAP    CHKPREP IF IO
       OPEN    OUT,FNAME
       TRAPCLR IO
OPT225 DISPLAY *P5:12,"NOW WRITING SECTOR "
       DISPLAY *P24:12,STARTS
       WRITE   OUT,STARTS;FIL50,FIL50,FIL50,FIL50,FIL48
       ADD     ONE,STARTS
       COMPARE ENDS,STARTS
       GOTO    OPT225 IF LESS
       GOTO    OPT225 IF EQUAL
       KEYIN   *P5:14,"WRITE END-OF-FILE RECORD? (Y/N) Y",*P37:14,ANS
       RESET   ANS
       GOTO    OPT240 IF EOS
       CMATCH  "N",ANS
       GOTO    OPT240 IF EQUAL
       DISPLAY *P5:16,"WRITING END-OF-FILE IN SECTOR ",STARTS
       WEOF    OUT,STARTS
OPT240 CLOSE   OUT
       GOTO    START
.
CHKPREP        KEYIN   *P5:12,"FILE NOT FOUND - CREATE IT? (Y/N) Y",*P39:12,ANS
       TRAPCLR IO
       RESET   ANS
       GOTO    OKPREP IF EOS
       MATCH   "N",ANS
       GOTO    START IF EQUAL
OKPREP PREPARE OUT,FNAME
       DISPLAY *P5:12,*EF
       GOTO    OPT225
.
.
ELSEWHER   KEYIN   *P1:12,"Program name? ",*V2LON,PROG
       RESET   PROG
       GOTO    START IF EOS
       TRAP    NOPROG IF CFAIL
       CHAIN   PROG
.
NOPROG BEEP
       TRAPCLR CFAIL
       DISPLAY *P1:14,"*** NO SUCH PROGRAM ***",*W
       DISPLAY *P1:12,*EF
       GOTO    ELSEWHER
