.*****************************************************************************
.* System    :   Hospital Management                                         *
.* Program   :   IBAHMS70                                                    *
.* Desc      :   Wins & Losses Report                                        *
.*****************************************************************************
.* Date      :   09/07/2002                                                  *
.*                                                                           *
.* Author    :   Mike Laming                                                 *
.*                                                                           *
.* Function  :   This program reads all Casemix Invoices between the         *
.*               selected dates and compares the Invoice total against       *
.*               what the total would have been if it was not a Casemix.     *
.*               The program uses PATCATBI to re-calculate the Invoice as    *
.*               a PAT CAT invoice.                                          *
.*                                                                           *
.* Mods      :                                                               *
.*                                                                           *
.*---------------------------------------------------------------------------*
.* V11.05.01 14/02/2025 J.Tan           TSK 0946490                          *
.*           Recompiled for PATCATBI - Changes for MV CWO Payment Model      *
.* V11.04.07 23/09/2024  J.Tan          TSK 0949848                          *
.*           Recompiled for ABFPTINV - DRG List used in for COVID Adjustor   *
.* V11.04.06 11/09/2024  J.Tan          TSK 0947315                          *
.*           Recompiled for ABFPTINV - fixed Total Unqualified               *
.* V11.04.05 01/08/2024  J.Tan          TSK 0947804                          *
.*           Recompiled for ABFMHINV - Changes for Discharges after 1/7/2023 *
.* V11.04.04 17/07/2024  J.Tan          TSK 0947315                          *
.*           Recompiled for ABFPTINV (LOS ICU adjusted & Newborn)            *
.* V11.04.03 15/03/2024  J.Tan          TSK 0910994                          *
.*           Recompiled for CMXMATRX                                         *
.* V11.04.02 29/01/2024  Jacob Jackson  TSK 0919335                          *
.*           Add HF History includes                                         *
.* V11.04.01 29/01/2024  Jacob Jackson  TSK 0919335                          *
.*           Add new local variable and recompile for GETTFEES               *
.* V11.03.04 17/11/2023  J.Tan          TSK 0940089                          *
.*           Recompiled for ABFPTINV - checking for blank Disc.DRG           *
.* V11.03.03 13/11/2023  J.Tan          TSK 0939019                          *
.*           Recompiled for ABFPTINV - HAC ICD10 Edition 12                  *
.* V11.03.02 29/08/2023  J.Tan          TSK 0916870                          *
.*           Recompiled for ABFPTINV - Claim code Cat CL Multiple NEP value  *
.* V11.03.01 15/06/2023  J.Tan          TSK 0923703                          *
.*           Recompiled for ABF new calculations                             *
.* V11.01.06 17/11/2021  J.Tan          TSK 0913621                          *
.*           Recompiled for ABFPTINV - Mod for Multiple NEP Values           *
.* V11.01.05 29/09/2021  J.Tan          TSK 0901515                          *
.*           Recompiled for CMXMATRX - Added Primary Proc.to Matrix          *
.* V11.01.04 14/09/2021  J.Tan          TSK 0906222                          *
.*           Recompiled for ABFPTINV - Mod for Multiple NEP Values           *
.* V11.01.03 07/07/2021  J.Tan           TSK 0908588                         *
.*           Recompiled for PATCATBI-Exclude Unqualified days for Casepayment*
.* V11.01.02 28/04/2021  Thanh T         TSK 0895165                         *
.*           Recompiled for OPRARDFD changes                                 *
.*           07/04/2021  Tracey Nguyen   TSK 0901515                         *
.*           Recompiled for PMSCMTFD - Added new fields                      *
.*           a) 1 File type for ICD procedure (PMCCIPF)                      *
.*           b) 3 new CMBS Field Type (PMCCFTS4/PMCCFT5C/PMCCFT6C)           *
.*           c) 3 new CMBS Codes From (PMCCPC4F,PMCCSC5F,PMCCTC6F)           *
.*           d) 3 new CMBS Codes To   (PMCCPC4T/PMCCSC5T,PMCCTC6T)           *
.*           27/04/2021  J.Tan           TSK 0863287                          *
.*           Mod for Patient Invoice new functionality                        *
.* V11.01.01 10/03/2021  Tracey Nguyen   TSK 0901515                         *
.*           Recompiled for PMSCMTFD - Added Primary ICD Procedure 1-5       *
.*           (PMCCICP1-5)                                                    *
.*---------------------------------------------------------------------------*
.*        V11.00.06 10/11/2020  J.Tan           TSK 0899562                  *
.*                  Recompiled for CMXMATRX - setup date for reading MBS item*
.*        V11.00.05 29/09/2020  J.Tan          TSK 0896829                   *
.*                  Recompiled for CMXMATRX - use National(PTPGNDRG)DRG      *
.*        V11.00.04 22/09/2020  J.Tan           TSK 0895330                  *
.*                  Recompiled for CMXMATRX - reposition read of Matrix table*
.*        V11.00.03 14/07/2020  J.Tan          TSK 0892902                   *
.*                  Recompiled for PATCATBI - Mod to initialise CASMXKEY     *
.*        V11.00.02 01/07/2020  J.Tan           TSK 0892765                  *
.*                  Recompiled for PATCATBI-Low outlier exc. unqualified days*
.*                  05/07/2020  J.Tan           TSK 0892746                  *
.*                  Recompiled for ABFPTINV - CALCAGE as at Admission date   *
.*        V11.00.01 24/02/2020  J.Tan          TSK 0838262                   *
.*                  Added Effective from and to date to MBS Item file        *
.*        V10.14.01 09/09/2019  J.Tan           TSK 0857392                  *
.*                  Recompiled for ABF invoice                               *
.*        V10.12.01 18/07/2018  J.Tan          TSK 0859911                   *
.*                  Recompiled for PATCATBI - Fixed No Payday Add on charge  *
.*        V10.11.01 07/09/2017  J.Tan         TSK 0837479                    *
.*                  Recompiled for CMXMATRX - Consumption typ items          *
.*        V10.10.04 13/06/2017  J.Tan          TSK 0839991                   *
.*                  Recompiled for PATDBTYP (PATCMSTP)                       *
.*        V10.10.03 16/05/2017  J.Tan          TSK 0833067                   *
.*                  Recompiled for PATCATBI - Eff.date for perdiem thea fees *
.*        V10.10.02 10/04/2017  J.Tan          TSK 0833067                   *
.*                  Fixed calculating Pat Cat Accom.& Thea fees(ICD10 Sug.)  *
.*        V10.10.01 25/01/2017  J.Tan          TSK 0832407                   *
.*                  Recompiled for PATCATBI-multi bed trans on sameday for MV*
.*                  04/04/2017  J.Tan         TSK 0297904                    *
.*                  Recompiled for PATCMSTP - Non-Accumulative inlier ICU/CCU*
.*        V10.08.08 06/10/2016  J.Tan         TSK 0826824                    *
.*                  Recompiled for CALCMVHR - MV Hours                       *
.*        V10.08.07 21/09/2016  J.Tan         TSK 0826370                    *
.*                  Recompiled for CMXMATRX - Chg MCHGARR MCHGAMT array to F3*
.*        V10.08.06 26/08/2016  Don Nguyen    TSK 0312570                    *
.*                  Recompiled for CMXMATRX - Added check for PTCNDGED=1     *
.*                  Added PMSEDGFD/IO and GETEFDRG                           *
.*        V10.08.05 17/08/2016  J.Tan         TSK 0808745                    *
.*                  Recompiled for PATCATBI - for NPDAYFLG=1                 *
.*        V10.08.04 20/07/2016  J.Tan         TSK 0819914                    *
.*                  Recompiled for PATCATBI - Non ICU MV Hours               *
.*        V10.08.03 15/07/2016  J.Tan         TSK 0819914                    *
.*                  Recompiled for PATCATBI - Calculating non ICU MV hours   *
.*        V10.08.02 20/06/2016  J.Tan         TSK 0820816                    *
.*                  Recompiled for PATCATBI - Fixed No payday for Daycase    *
.*        V10.08.01 02/06/2016  J.Tan         TSK 0816651                    *
.*                  Recompiled for PATCATBI-Continuous Bill.to chk for Matrix*
.*        V10.07.02 04/03/2016  J.Tan         CAR 290448                     *
.*                  Recompiled for PATCATBI - Mods for Addon with No Pay DAy *
.*        V10.07.01 18/11/2015  J.Tan         CAR 303942                     *
.*                  Added new payment types                                  *
.*        V10.06.01 15/07/2015  J.Tan          CAR 319342                    *
.*                  Recompiled for CMXMATRX - Chg 'Disc.UDF' to 'Care Class' *
.*        V10.05.01 04/08/2014 J.Tan           CAR 304397                    *
.*                  Mods to check Suggested classification for charging      *
.*        V10.04.05 03/07/2014 J.Tan           CAR 268860                    *
.*                  Recompiled for PATCATBI - ICD10 Suggested Classification *
.*        V10.04.04 19/06/2014 J.Tan           CAR 302452                    *
.*                  Recompiled for PATDINVS - Changed MCHGARR/MCHGAMT        *
.*        V10.04.03 13/06/2014 Steve Armstrong CAR 301639                    *
.*                  Moved call to TFILENAM for TEMPFILE to INIT0000          *
.*        V10.04.02 11/06/2014 Sandra Barcham  CAR 301639                    *
.*                  Moved call to TFILENAM to INIT0000                       *
.*        V10.04.01 27/05/2014  J.Tan          CAR 300784                    *
.*                  Recompiled for STEPDOWN -force stepdown prior inv.fromdat*
.*****************************************************************************
.*        V10.03.11 13/12/2013  J.Tan          CAR 294609                    *
.*                  Recompiled for CMXMATRX - mods for Default Grouper Vers. *
.*        V10.03.10 07/11/2013  J.Tan          CAR 283618                    *
.*                  Recompiled for PATCATBI - mods for Ind.Services Billing  *
.*        V10.03.09 02/10/2013  J.Tan          CAR 291588                    *
.*                  Recompiled for PATCATBI - fixed stepdown return from leave*
.*        V10.03.08 14/08/2013  J.Tan          CAR 288416                    *
.*                  Recompiled for PATCATBI - fixed Days of Hosps.           *
.*        V10.03.07 05/08/2013  J.Tan          CAR 288060                    *
.*                  Recompiled for CMXMATRX -fixed Primary/Secondary/Tertiary*
.*        V10.03.06 06/05/2013  J.Tan          CAR 284902                    *
.*                  Recompiled for STEPDOWN - force stepdown prior Inv.Fromda*
.*        V10.03.05 10/04/2013  J.Tan    CAR 283743                          *
.*                  Recompiled for PATCATBI -  reset PTTRESPD for NewStepdown*
.*        V10.03.04 05/03/2013  Patrick Adair CAR 281898                     *
.*                  Recompiled for PATCATBI PATCATAI                         *
.*        V10.03.03 24/12/2012 Patrick Adair  CAR 261630                     *
.*                  Removed port number from temp file name                  *
.*        V10.03.02 21/09/2012  J.Tan          CAR 271474                    *
.*                  Recompiled for CMXMATRX - using index 5 of pmscmtaf      *
.*                  04/12/2012  J.Tan          CAR 262673                    *
.*                  Recompiled for PATCATBI - Casepayment perdiem rate       *
.*        V10.03.01 03/05/2012  J.Tan          CAR 264684                    *
.*                  Fixed I*C on patmchgf                                    *
.*        V10.01.03 23/02/2011  Peter Vela   CAR 233034                      *
.*                  Removed PATBF2FD and PATBF2IO                            *
.*        V10.01.02 12/01/2011  Mike Laming  CAR 236533                      *
.*                  Fix length of CMIXTO for "MATCH" at PINV2000, moved      *
.*                  load of TMPINVDT from PINVDTE before CALCTBI resets it   *
.*        V10.01.01 20/12/2010  Mike Laming   CAR 233046                     *
.*                  Recompiled for PABXBILL - Mods to Misc.Charges PATMCHFD  *
.*        V10.00.08 17/08/2010 J.Tan         CAR 227873                      *
.*                  Recompiled for CMXMATRX- getting the grouper version     *
.*        V10.00.07 11/08/2010 J.Tan         CAR 227873                      *
.*                  Recompiled for CMXMATRX-searching for next matrix rules  *
.*        V10.00.06 03/08/2010  J.Tan         CAR 227319                     *
.*                  Recompiled for PATCATBI - Mechanical Ventilation         *
.*        V10.00.05 14/07/2010  J.Tan         CAR 226158                     *
.*                  Recompiled for STEPDOWN - bed fees update                *
.*        V10.00.04 16/07/2010 J.Tan         CAR 226322                      *
.*                  Recompiled for CMXMATRX - search for next rule if        *
.*                  Contract is not valid                                    *
.*        V10.00.03 12/07/2010  J.Tan         CAR 225932                     *
.*                  Recompiled for PATCATBI - set TDATE to IDATET per-diem   *
.*        V10.00.02 07/06/2010  Mike Laming   CAR 212864                     *
.*                  Recompiled for PATCATBI - mods at GCDE6500               *
.*        V10.00.01 02/06/2010  J.Tan         CAR 223030                     *
.*                  Mods to check for fully credit noted invoice             *
.*        V9.12.11  11/03/2010  J.Tan         CAR 216044                     *
.*                  Mods to include Leave days in stepdown count for TAC     *
.*        V9.12.10  16/02/2010  Peter Vela    CAR 215485                     *
.*                  Recompiled for PATCATBI - Ignore Leave if less than 1    *
.*                  day                                                      *
.*        V9.12.09  05/02/2010  Peter Vela    CAR 215485                     *
.*                  Recompiled for PATCATBI - Ignore Leave if less than 1    *
.*                  day                                                      *
.*        V9.12.08  02/02/2010  Davin         CAR 215234                     *
.*                  Recompiled for CMXMATRX                                  *
.*        V9.12.07  27/01/2010  J.Tan         CAR 214548                     *
.*                  Recompiled for PATCATBI - Stepdown after bed fees updat  *
.*                  27/01/2010  J.Tan         CAR 214877                     *
.*                  Recompiled for CMXMATRX - Checking for range of MBS itm  *
.*        V9.12.06  19/01/2010  J.Tan         CAR 166439                     *
.*                  Recompiled for PATCMSTP - C/P additional charge stepdow  *
.*        V9.12.05  24/11/2009  Davin         CAR 210721                     *
.*                  Recompiled for CHKCMXPT - I*C on patcmxaf file           *
.*        V9.12.04  09/10/2009  J.Tan         CAR 203934                     *
.*                  Recompiled for PATCATBI - disp.ICD10 Sugg.Class on Inv.  *
.*        V9.12.03  21/09/2009  J.Tan         CAR 204390                     *
.*                  Recompiled for STEPDOWN - mods to old bed fees file      *
.*        V9.12.02  24/07/2009  J.Tan         CAR 201132 & 202168            *
.*                  Recompiled for CMXMATRX - checking for zero MBS amount   *
.*        V9.12.01  05/06/2009  J.Tan         CAR 196010                     *
.*                  Recompiled for CMXMATRX - ICD10 Secondary/Tertiary       *
.*        V9.11.03  16/03/2009  J.Tan         CAR 188205                     *
.*                  Recompiled for PATCATBI - Mods to Non-banked Deposits    *
.*        V9.11.02  20/11/2008  Steve Armstrong   CAR 181373                 *
.*                  Recompiled for changes to PATCATBI.                      *
.*        V9.11.01  30/10/2008 J.Tan      CAR 181263                         *
.*                  Recompiled for PATCATAI - printing Disch.Billing Stat.   *
.*****************************************************************************
.*        V9.10.03  25/09/2008  J.Tan         CAR 178209                   *
.*                  Recompiled for PATCATBI - checking for Doct.chg rec.   *
.*                  25/09/2008  J.Tan         CAR 179009                   *
.*                  Recompiled for STEPDOWN - Check 'Exclude Days of Hosp."*
.*        V9.10.02  05/09/2008  J.Tan         CAR 177126                   *
.*                  Recompiled for PATCATBI - Checking matrix parameter    *
.*        V9.10.01  08/07/2008 Sandra Barcham CAR 173135                   *
.*                  Recompiled for PATCATBI - Remove close of PATDGWA1     *
.***************************************************************************
.*        V9.09.06  29/02/2008  J.Tan         CAR 162893 & 162609          *
.*                  Recompiled for PATCATBI - Inv.breakdown and Lumpsum amt*
.*        V9.09.05  20/02/2008  Peter Vela CAR 161535                      *
.*                  Recompiled for PATCATBI                                *
.*        V9.09.04  24/08/2007  Peter Vela CAR 146143                      *
.*                  Recompiled for PATCATBI                                *
.*        V9.09.03  20/08/2007 J.Tan          CAR 144656                   *
.*                  Recompiled for PATCATBI - for Multiple Procedures      *
.*        V9.09.02  10/08/2007  Peter Vela CAR 146143                      *
.*                  Recompiled for PATCATBI                                *
.*        V9.09.01  17/07/2007  J.Tan     CAR 140282                          *
.*                  Recompiled for NZPCATBI - Revenue breakdown               *
.***************************************************************************
.*        V9.08.06  08/05/2007  Mike Laming  CAR 137125 HDP 2007 DRG 5.2      *
.*                  Mods to PATDGWDS - Added PTDWDRGV to PATDGWFD             *
.*        V9.08.05  19/02/2007 Peter Vela     CAR 135241                      *
.*                  Recompiled for PATCATBI - St. John of God invoice layout  *
.*        V9.08.04  26/02/2007  J.Tan         CAR 120014                      *
.*                  Recompiled for NZPCATBI - NZ exploding misc.item          *
.*        V9.08.03  02/02/2007  Ebon Clements CAR 120001                      *
.*                  Added nz private billing files                            *
.*        V9.08.02  17/11/2006  Peter Vela    CAR 124538                      *
.*                  Recompiled for PATCATBI                                   *
.*                  Added display of PATITMFD.PTITTCER                        *
.*                  Type of Certificate Type B Type C                         *
.*        V9.08.01  18/10/2006  J.Tan         CAR 120502                      *
.*                  Recompiled for PATCATBI - Ignore Doctor Change record     *
.***************************************************************************
.*        V9.07.02  25/09/2006  Peter Vela    CAR 118940                      *
.*                  Recompiled for PATCATBI                                   *
.*        V9.07.01  23/08/2006  Peter Vela    CAR 114790                      *
.*                  Re-initialised EXIT to 0 GDAT2600                         *
.***************************************************************************
.*        V9.06.01  16/05/2006  Peter Vela    CAR 104103                      *
.*                  Recompiled for PATCATBI - PTCNINVL=12                     *
.***************************************************************************
.*        V9.04.B01 20/12/2005  J.Tan         CAR 89226                       *
.*                  Recompiled for PATCATBI - recalculate theatre fees        *
.*        V9.04.07  02/11/2005  Peter Vela        CAR 81394                   *
.*                  Recompiled for PATCATBI                                   *
.*        V9.04.06  04/08/2005  J.Tan        CAR 62750                        *
.*                  Mods not to use the redefined amount variables            *
.*                  31/08/2005  J.Tan         CAR 74153                       *
.*                  Recompiled for CMXMATRX - checking for exclusive          *
.*        V9.04.05  16/06/2005  Mike Laming   CAR 61746                       *
.*                  Recompiled for CLPATDTR - add clear PTDTTIME & PTDTCRST   *
.*        V9.04.04  29/11/2004  Mike Laming   CAR 54534                       *
.*                  Re-comple for PATCMSTP - fix Addit.Charge Description     *
.*        V9.04.03  23/09/2004  Lina Vo        CAR 53660                   *
.*                  Recompiled for PATCATBI - multi hospital theatre fee      *
.*        V9.04.02  06/09/2004  Ebon Clemsnts  CAR 53147                   *
.*                  Added multi hospital processing                        *
.*        V9.04.01  27/08/2004  J.Tan    CAR 52835                            *
.*                  Recompiled for PATCATBI - multi hospital                  *
.***************************************************************************
.*        V9.03.12  09/06/2004  J.Tan    CAR 50035                            *
.*                  Re-compile for PATCATBI - Mechanical ventilation          *
.*        V9.03.11  22/04/2004  Mike Laming   CAR 46224                       *
.*                  Re-compile for PATCATBI - Theatre DTR sequences           *
.*        V9.03.10  12/02/2004  Henry Son        CAR 47385                    *
.*                  Added PTCNMBSF for checking if we allow more than         *
.*                  Six MBS Items.                                            *
.*        V9.03.09  23/02/2004  Mike Laming   CAR 47440                       *
.*                  Re-compile for PATCATBI - initialise TPATAMTP             *
.*        V9.03.08  19/12/2003 J.Tan   CAR 44093                              *
.*                  Replaced patcashf with comdepaf                           *
.*        V9.03.07  18/11/2003  Henry Son   CAR 39291                         *
.*                  Allow more than 7 Theatre stepdown fees.                  *
.*                  Recompile PATCATBI.                                       *
.*        V9.03.06  03/11/2003  Mike Laming  CAR 43911                        *
.*                  Recompile for PATCATBI - correct GROSSTOT & ACCMTOT       *
.*        V9.03.05  17/10/2003  J.Tan  CAR 44176                              *
.*                  Recompiled for PATCATBI.                                  *
.*        V9.03.04  18/09/2003 Lina Vo    CAR 40497                           *
.*                  Recompile for PATCATBI, PATDINVS, CMXMATRX.               *
.*        V9.03.03  17/09/2003 J.Tan  CAR 36504                               *
.*                  Recompile for PATGNCMX - Web billing changes              *
.*        V9.03.02  11/08/2003  CAR 41072   Mike Laming                    *
.*                  Recompile for PATCATBI to correct Lump Sums in BIL19   *
.*        V9.03.01  04/08/2003  CAR 34330/41952   Mike Laming              *
.*                  Recompiled for PATCATBI & PATDINVS - Add second temp   *
.*                  file for Misc.Items to change sequence to Date/DTR seq *
.***************************************************************************
.*       V9.02.04   12/03/2003  Mike Laming  CAR 37244 (ne 14894)          *
.*                  Recompile for PATCATBI - HMS70 bypass re-read Admission*
.*       V9.02.03   26/11/2002  Mike Laming  SRF 22475                     *
.*                  Add edits to the 3 selection ranges                    *
.*       V9.02.02   30/10/2002  J.Tan                                      *
.*                  Recompiled for CMXMATRX                                *
.*       V9.02.01 - 25/09/2002 Peter Vela SRF 22475                        *
.*                          Changed column widths to display properly on   *
.*                          WEBPAS front end                               *
.***************************************************************************
.
          INC       STD001FD
          INC       PATDHEAD/INC
          INC       IBAPASFD/INC
.
          INC       IBASEQFD/INC                 * Sequential Numbers File
          INC       IBATMHFD/INC
          INC       COMDEPFD/INC
          INC       IBAGSTFD/INC
          INC       MLTCFNFD/INC
          INC       NZPEXTFD/INC
          INC       NZPRDTFD/INC
          INC       NZPBFEFD/INC
          INC       NZPCFNFD/INC
          INC       NZPCMTFD/INC
          INC       NZPFIGFD/INC
          INC       NZPFINFD/INC
          INC       NZPIBRFD/INC
          INC       NZPMCHFD/INC
          INC       NZPMXCFD/INC
          INC       NZPPFEFD/INC
          INC       NZPRBRFD/INC
          INC       NZPRFNFD/INC
          INC       NZPPICFD/INC
          INC       NZPSPRFD/INC
          INC       NZPTFEFD/INC
          INC       NZPIVBFD/INC
          INC       NZPRVBFD/INC
          INC       OPRDEAFD/INC
          INC       OPRARDFD/INC
          INC       OPRSESFD/INC
          INC       PATDINVS/INC            * Invoicing variables
          INC       PATCMXVR/INC            * Casemix code Keyin variables
.
          INC       PATCMCFD/INC            * Casemix Codes Table
          INC       PATCFAFD/INC
          INC       PMSCIDFD/INC
          INC       PMSCCDFD/INC
          INC       PATICUFD/INC
          INC       PATITMFD/INC            * Patient Item     
          INC       PATMA1FD/INC            * Patient Master
          INC       PATMI1FD/INC            * Patient Admissions
          INC       PATDSCFD/INC            * Patient Discharge Details
          INC       PATDTRFD/INC            * Patient Debtors Transactions
          INC       PATTRNFD/INC            * Patient Transfers 
          INC       PATINVFD/INC            * Patient Invoice Details
          INC       PATSTAFD/INC
          INC       PATAA1FD/INC
.
          INC       PATCODFD/INC
          INC       PATCONFD/INC
          INC       PATFX1FD/INC
          INC       PATFN1FD/INC            * Patient Health Fund Table
          INC       PATFN2FD/INC
          INC       PATRFNFD/INC
.
.                                           * All the FDs for PATCATBI
          INC       PATELGFD/INC
          INC       PATAFEFD/INC
          INC       PATASDFD/INC
          INC       PATBFEFD/INC
          INC       PATCMXFD/INC
          INC       PATCTFFD/INC
          INC       PATDO1FD/INC            * Doctors 
          INC       PATDRGFD/INC
          INC       PATDGWFD/INC            * DRG Descriptions         
.....     INC       PATECOFD/INC                                        D-90203
          INC       PATECDFD/INC                                       *I-90203
          INC       PATECOFD/INC                                       *I-90203
          INC       PATFINFD/INC
          INC       PATFMOFD/INC
          INC       PATHDFFD/INC
          INC       PATHLFFD/INC
          INC       PATHSPFD/INC
          INC       PATHTRFD/INC
          INC       PATIBLFD/INC
          INC       PATIOVFD/INC
          INC       PATLDFFD/INC
          INC       PATLSDFD/INC
          INC       PATMCHFD/INC
          INC       PATOVBFD/INC
          INC       PATPGRFD/INC
          INC       PATRATFD/INC
          INC       PATRBLFD/INC
          INC       PATRCAUD/INC
          INC       PATSRBFD/INC
          INC       PATTFEFD/INC            * Bed Fee Table
          INC       PATVENFD/INC
          INC       PATVISFD/INC
          INC       PMSCNOFD/INC
          INC       PMSHATFD/INC
          INC       PMSMPRFD/INC
          INC       PMSVX1FD/INC
          INC       PATWR1FD/INC
          INC       PATCMTFD/INC
          INC       PMSCMTFD/INC
          INC       PMSSINFD/INC
          INC       PMSSGAFD/INC
          INC       PMSMTIFD/INC
          INC       OUTPREFD/INC
          INC       IBAGEDFD/INC
          INC       PABXVARS/INC
          INC       SCRSLTFD/INC
          INC       PATCOMM/INC
          INC       PMSPBRFD/INC
          INC       PMSIDEFD/INC
.
          INC       RCPBNKFD/INC
          INC       RCPDTEFD/INC
          INC       RCPBDTFD/INC
          INC       TFILEVAR/INC                 * Generate Temp File Name
          INC       WEBERRFD/INC                 * Web Server Error Logging
          INC       PMSEDGFD/INC       * Effective DRG Dates
          INC       PATDDHFD/INC
.
.         Web Variables (only the include files use these variables)
.
DAYFORMT  DIM       4
NJAN      INIT      "January"
NFEB      INIT      "February"
NMAR      INIT      "March"
NAPR      INIT      "April"
NMAY      INIT      "May"
NJUN      INIT      "June"
NJUL      INIT      "July"
NAUG      INIT      "August"
NSEP      INIT      "September"
NOCT      INIT      "October"
NNOV      INIT      "November"
NDEC      INIT      "December"
HOSPNAME  DIM       50
HOSPCODE  DIM       3
.
HTMLFILE  FIFO      ASCII, FIXED=250
MTHNAM3   DIM       3
MTHNAM3A  DIM       3
.
.
.         Temporary File Definition
.         -------------------------
.
.         Filename : hms70axx.dat          (xx = port id)
.
SEQTEMP1  IFILE SQL, FIXED=100, KEY="U1-8,9-16"                  *(KEY16)
SEQTEMP2  IFILE SQL, FIXED=100, KEY="U25-30,31-39,17-24,9-16"    *(KEY31)
.
.NAME     TYPE    LENGTH     PHYSICAL     START     DESCRIPTION
.----     ----    ------     --------     -----     -----------
TMPADMNO  DIM       8           8           1       Patient Admission No.
TMPINVNO  DIM       8           8           9       Invoice No.     
TMPINVDT  DIM       8           8          17       Invoice Date
TMPHFUND  DIM       6           6          25       Health Fund (from PFUNDH)
TMPCMXCD  DIM       9           9          31       Casemix Code (from Inv)
TMPINVTO  FORM      12.2        8          40       Invoice Total Amount
TMPACLOS  FORM      4           3          48       Actual LOS
TMPCMLOS  FORM      4           3          51       Casemix LOS
TMPPCTHE  FORM      12.2        8          54       PAT CAT Theatre
TMPPCACC  FORM      12.2        8          62       PAT CAT Accommodation
TMPPCMIS  FORM      12.2        8          70       PAT CAT Misc.         
TMPPCTOT  FORM      12.2        8          78       PAT CAT Total            
TMPSPARE  FORM      14          14         86       Spare
.
.End of Record                            100
.
. LOCAL VARIABLE DEFINITION
. -------------------------
.
ACTLOS    FORM      4
ACTION    DIM       1                       * Action for PATAA1FD
ADD       DIM       2                       * Day for PATAA1FD
AMM       DIM       2                       * Month for PATAA1FD
AYY       DIM       2                       * Year for PATAA1FD
ACC       DIM       2                       * Century for PATAA1FD
CMDLINE   DIM       80
CURRDATE  DIM       8
.
CALLPOSN  FORM      1
CALDAYS   FORM      4
CERTINDC  FORM      1
CMIXFR    DIM       6
CMIXFRD   DIM       6
CMIXFRX   DIM       30
CMIXTO    DIM       6
CMIXTOD   DIM       6
CMIXTOX   DIM       30
CMXTYFR   DIM       1                                                  *I-90203
CODE      DIM       5
CDYSDAYS  FORM      1
CDYSFDTE  DIM       8
CDYSTDTE  DIM       8
CDYSYEAR  FORM      2
CURSESS   DIM       18
CSTRTYR   DIM       8
.
DATEFROM  DIM       8
DATETO    DIM       8
DATEWORK  DATE      8
DIM1A     DIM       1 
DIM4      DIM       4
DIM4A     DIM       4
DIM4B     DIM       4
DIM5A     DIM       5
.DIM6A     DIM       6
DIM6B     DIM       6
DIM9      DIM       9
DIM10A    DIM       10
DIM10B    DIM       10
DIM12A    DIM       12
DIM12B    DIM       12
DIM12C    DIM       12
DIM12D    DIM       12
DIM12E    DIM       12
DIM12F    DIM       12
DIM14     DIM       14
.DIM15     DIM       15
DIM18     DIM       18
DIM18A    DIM       18
DIM24A    DIM       24
DIM30     DIM       30
DRGVERZ   DIM       3                                                 *I-137125
DV1       DIM       1                                                 *I-137125
DV2       DIM       1                                                 *I-137125
.
EFTDATE   DIM       8         * Effective date (ccyymmdd)
.ENDFLAG   FORM      "0"
ENDTOT    FORM      1
FIRST     FORM      1
FORM3A    FORM      3
FORM5     FORM      5
FUNDFR    DIM       6
FUNDFRD   DIM       6
FUNDFRX   DIM       30
FUNDTO    DIM       6
FUNDTOD   DIM       6
FUNDTOX   DIM       30
HFHIFUND  FORM      2
IBCNMHOS  FORM      1
IBCNUGST  FORM      1
IBCNPBXI  DIM       9
.
KEY13A    DIM       13
MBSFLAG   FORM      1
NEWPAGE   FORM      1
NUMB      FORM      1
OPCNCONS  DIM       1
OPNFLAG   FORM      "0"
OPERCODE  DIM       4                       * Operator code for PATAA1FD
PKEY15    DIM       15
RANGE     FORM      1
SAVDISC   FORM      8.3
SAVBEND   FORM      3
SAVALLW   FORM      8.2
TEMPFILE  DIM       8
TFEEIND   FORM      1
TIMES     FORM      1
THCFLG    FORM      2
UPADMTYP  DIM       1
.
WARNINGL  DIM       20
WBSEUID   DIM       10
WINLOSS   FORM      12.2
WDATE1    DIM       8
WDATE2    DIM       8
WSIGN     DIM       1
.
W1TOTACL  FORM      4[3]
W1TOTCML  FORM      4[3]
W1TOTINV  FORM      12.2[3]
W1TOTTHE  FORM      12.2[3]
W1TOTACC  FORM      12.2[3]
W1TOTMIS  FORM      12.2[3]
W1TOTPAT  FORM      12.2[3]
W1TOTWIN  FORM      12.2[3]
.
CFPAYCOD  DIM       3        * 3M Codefinder PAY Code
.
.
. PROGRAM CONSTANTS
. -----------------
.
CATCR     INIT      "cr"
CODEA     INIT      "A "
CODEBT    INIT      "BT"
CODECL    INIT      "CL"
CODEPY    INIT      "Py"
.ERASE     INIT      "iserase "
.ISBUILD   INIT      "isbuild "
UKEY2     INIT      " 100 U1-8,9-16 U25-30,31-39,17-24,9-16"
SP14      INIT      "              "
SLSH      INIT      "/"
.ZERO8     INIT      "0000    "
ZED14     INIT      "zzzzzzzzzzzzzz"
.
PRGID     INIT      "IBAHMS70"
PRGNAM    INIT      "WINS AND LOSSES REPORT"
VERSION   INIT      "V12.00.00"
+
.**************************************************************************
.*                              ML0000                                    *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
ML0000    CALL      INIT0000               * initialisation and open files
.
ML1000    CALL      DSPL0000               * display the input screen
.
ML2000    CALL      GDAT0000               * get date & Codes ranges
          BRANCH    EXIT,ML9000            * nothing entered or exitchar entered
.
          CALL      CREA0000               * create temp. work file   
.
ML3000    CALL      PINV0000               * process the Invoice file
.
          CALL      PRNT0000               * print the report
.
ML9000    CALL      KILL0000               * delete temporary file
.
ML9999    CHAIN     PGM                    * chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: ML0000    *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
.
INIT0000  CALL      DISPHEAD                     * display heading
          CALL      DSPL0000                     * display the input screen
.
          DISPLAY   *P56:24,*EL,"Opening ":
                    *P64:24,"patma1af";
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
.
          DISPLAY   *P64:24,"patmi1af";
          OPEN      PATMI1A1,"patmi1af"
.
          DISPLAY   *P64:24,"pattranf";
          OPEN      PATTRAN2,"pattranf"
.
          DISPLAY   *P64:24,"patcmcaf";
          OPEN      PATCMCA1,"patcmcaf"
.
          DISPLAY   *P64:24,"patdschf";
          OPEN      PATDSCH1,"patdschf"
.
          DISPLAY   *P64:24,"patinvrf";
          OPEN      PATINVR2,"patinvrf"
.
          DISPLAY   *P64:24,"patfn1af";
          OPEN      PATFN1A1,"patfn1af"
.
          DISPLAY   *P64:24,"patdawaf";
          OPEN      PATDGWA1,"patdgwaf"
.
          DISPLAY   *P64:24,"ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
.                                           * Used for PATCATBI
          DISPLAY   *P64:24,"patitemn";
          OPEN      PATITEM1,"patitemn"
.                                           * Used for PATCATBI
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P64:24,"patdtraf";
          OPEN      PATDTRA1,"patdtraf"
          OPEN      PATDTRA3,"patdtraf"
.
          DISPLAY   *P64:24,"pmsmtiaf";
          OPEN      PMSMTIA1,"pmsmtiaf"
.
          DISPLAY   *P64:24,"patwr1af";
          OPEN      PATWR1A1,"patwr1af"
.
          DISPLAY   *P64:24,"pmsvx1af";
          OPEN      PMSVX1A1,"pmsvx1af"
.
          DISPLAY   *P64:24,"patmchgf"
          OPEN      PATMCHG1,"patmchgf"
.
          DISPLAY   *P64:24,"nzpbfeaf";
          OPEN      NZPBFEA1,"nzpbfeaf"
.
          DISPLAY   *P64:24,"nzpcfnaf"
          OPEN      NZPCFNA1,"nzpcfnaf"
.
          DISPLAY   *P64:24,"nzpcmtaf"
          OPEN      NZPCMTA1,"nzpcmtaf"
          OPEN      NZPCMTA2,"nzpcmtaf"
          OPEN      NZPCMTA3,"nzpcmtaf"
.
          DISPLAY   *P64:24,"nzpfigaf"
          OPEN      NZPFIGA1,"nzpfigaf"
          OPEN      NZPFIGA2,"nzpfigaf"
.
          DISPLAY   *P64:24,"nzpfinaf"
          OPEN      NZPFINA1,"nzpfinaf"
          OPEN      NZPFINA2,"nzpfinaf"
.
          DISPLAY   *P64:24,"nzpibraf"
          OPEN      NZPIBRA1,"nzpibraf"
.
          DISPLAY   *P64:24,"nzpmchaf"
          OPEN      NZPMCHA1,"nzpmchaf"
          OPEN      NZPMCHA2,"nzpmchaf"
.
          DISPLAY   *P64:24,"nzppicaf"
          OPEN      NZPPICA1,"nzppicaf"
          OPEN      NZPPICA2,"nzppicaf"
.
          DISPLAY   *P64:24,"nzprbraf"
          OPEN      NZPRBRA1,"nzprbraf"
.
          DISPLAY   *P64:24,"nzprfnaf"
          OPEN      NZPRFNA1,"nzprfnaf"
          OPEN      NZPRFNA2,"nzprfnaf"
.
          DISPLAY   *P64:24,"nzppfeaf"
          OPEN      NZPPFEA1,"nzppfeaf"
.
          DISPLAY   *P64:24,"nzpspraf"
          OPEN      NZPSPRA1,"nzpspraf"
          OPEN      NZPSPRA2,"nzpspraf"
.
          DISPLAY   *P64:24,"nzptfeaf"
          OPEN      NZPTFEA1,"nzptfeaf"
          OPEN      NZPTFEA2,"nzptfeaf"
.
          DISPLAY   *P64:24,"oprardaf";
          OPEN      OPRARDA1,"oprardaf"
.
          DISPLAY   *P64:24,"oprdetaf"
          OPEN      OPRDETA1,"oprdetaf"
.
          DISPLAY   *P64:24,"oprdetaf"
          OPEN      OPRDETA2,"oprdetaf"
.
          DISPLAY   *P64:24,"oprsesaf"
          OPEN      OPRSESA1,"oprsesaf"
.
          OPEN      MLTCFNA1,"mltcfnaf"
          OPEN      MLTCFNA2,"mltcfnaf"
.
          DISPLAY   *P64:24,"controlf";
          OPEN      CONTROLF,"controlf"
.
          READ      CONTROLF,TEN;*104,PTCNMBSF                         *I-47385
          READ      CONTROLF,TEN5;*247,CSTDOWN
          READ      CONTROLF,ZERO;*43,IBCNMHOS
.
...  used in PATCATBI CRMV0000
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAMEX
.
...  used in PATCATBI PTMP0000
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAMEZ
.
...  used in PATCATBI PT2P0000
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAMEY
.
...  used in PABXBILL
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,PBXFNAME
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,PBXFNAM2
.
          CALL      TFILENAM                     * Generate temporary file name
          MOVE      TFILNAME,TEMPFILE
.
.                                           * Set up default selection dates
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      "01",CDAY
          PACK      DATEFROM,CCC,CYY,CMM,CDAY        * from 1st of the month
          PACK      DATETO,CCC,CYY,CMM,CDD           * today' date
.
.                                           * If today is in the first 5 days
.                                           * of the month, use last month
          COMPARE   FIVE,CDD
          IF        @LESS
            PACK      DATEWORK,CCC,CYY,CMM,CDAY
            REP       " 0",DATEWORK
            SUB       ONE,DATEWORK
            UNPACK    DATEWORK,CCENT,CYEAR,CMON,CDAY
            PACK      DATETO,CCENT,CYEAR,CMON,CDAY
            MOVE      "01",CDAY
            PACK      DATEFROM,CCENT,CYEAR,CMON,CDAY
          ENDIF
.
          REP       " 0",DATEFROM
          REP       " 0",DATETO
.
          DISPLAY   *P1:24,*EL
.
INIT9999  RETURN
+
.**************************************************************************
.*                              DSPL0000               Called by: INIT0000*
.*                      display the input screen                          *
.**************************************************************************
.
DSPL0000  MOVE      ZERO,EXIT
          UNPACK    DATEFROM,CCENT,CYEAR,CMON,CDAY
          PACK      DIM10A,CDAY,SLSH,CMON,SLSH,CCENT,CYEAR
          UNPACK    DATETO,CCENT,CYEAR,CMON,CDAY
          PACK      DIM10B,CDAY,SLSH,CMON,SLSH,CCENT,CYEAR
.
          DISPLAY   *P1:4,*EF,"Start Date   : ",DIM10A:
                    *P1:5,*EL,"Finish Date  : ",DIM10B:
                    *P1:7,*EL,"Health Fund  - From : ":
                    *P1:8,*EL,"               To   : ":
                    *P1:10,*EL,"Casemix Code - From : ":
                    *P1:11,*EL,"               To   : ";
.
DSPL9999  RETURN
+
.**************************************************************************
.*                              GDAT0000               Called by: ML0000  *
.*                 get date range & other range fields                    *
.**************************************************************************
.
GDAT0000  MOVE      SP8,KEY8
          UNPACK    SP30,FUNDFRD,FUNDTOD,CMIXFRD,CMIXTOD
.
.                                           * Get the Date Range
          MOVE      FOUR,CVERT
          MOVE      TEN6,CCOL
          UNPACK    DATEFROM,CCENT,CYEAR,CMON,CDAY
          MOVE      ZERO,CHIGHLT
.
          CALL      KEYDATE                 * keyin the "From Date"
          BRANCH    OVRCD,GDAT9000
.
          PACK      DATEFROM,CCENT,CYEAR,CMON,CDAY
.
GDAT0500  MOVE      FIVE,CVERT
          MOVE      TEN6,CCOL
          UNPACK    DATETO,CCENT,CYEAR,CMON,CDAY
          MOVE      ZERO,CHIGHLT
.
          CALL      KEYDATE                 * keyin the "To Date"
          BRANCH    OVRCD,GDAT9000
.
          PACK      DATETO,CCENT,CYEAR,CMON,CDAY
.
. ******************************************* Start of Addition        *I-90203
          REP       " 0",DATEFROM
          REP       " 0",DATETO
          MATCH     DATEFROM,DATETO
          GOTO      GDAT1000 IF NOT LESS
. 
          DISPLAY   *P1:23,*EL,*B,"Finish Date is less than Start Date":
                    *P1:24,"Press <",*V2LON,"ENTER",*HOFF,"> to continue  ";
          KEYIN     ANS;
          DISPLAY   *P1:23,*EF
          GOTO      GDAT0500
. ******************************************* End of Addition          *I-90203
.
.
.                                           * Get Health Fund Range
.
GDAT1000  MOVE      SP6,FUNDFR
          MOVE      "Start",FUNDFRD
          MOVE      SP30,FUNDFRX
          MOVE      "23",ECOL
          MOVE      "7",EVERT 
          MOVE      SP6,CKYIDEF6
          MOVE      ZERO,CKYIMAND
          MOVE      ZERO,CKYIMODE
          CALL      PATFNDKY
          BRANCH    EXIT,GDAT1500:          * 1 = nothing input
                         GDAT9000:          * 2 = EXIT character
                         GDAT1500           * 3 = spaces
.                                             0 = OK
          MOVE      HCODE,FUNDFR
          MOVE      HCODE,FUNDFRD
          MOVE      HFNAME,FUNDFRX
.
GDAT1500  DISPLAY   *P1:7,*EL,"Health Fund  - From : ":
                    FUNDFRD,"    ",FUNDFRX
.
          MOVE      "~~~~~~",FUNDTO
          MOVE      "Finish",FUNDTOD
          MOVE      SP30,FUNDTOX
          MOVE      "23",ECOL
          MOVE      "8",EVERT 
          CALL      PATFNDKY
          BRANCH    EXIT,GDAT1600:          * 1 = nothing input
                         GDAT9000:          * 2 = EXIT character
                         GDAT1600           * 3 = spaces
.                                             0 = OK
          MOVE      HCODE,FUNDTO
          MOVE      HCODE,FUNDTOD
          MOVE      HFNAME,FUNDTOX
.
. ******************************************* Start of Addition        *I-90203
          MATCH     FUNDFR,FUNDTO  
          GOTO      GDAT1600 IF NOT LESS
. 
          DISPLAY   *P1:23,*EL,*B,"To Fund is less than From Fund":
                    *P1:24,"Press <",*V2LON,"ENTER",*HOFF,"> to continue  ";
          KEYIN     ANS;
          DISPLAY   *P1:23,*EF
          GOTO      GDAT1500 
. ******************************************* End of Addition          *I-90203
.
GDAT1600  DISPLAY   *P1:8,*EL,"               To   : ":
                    FUNDTOD,"    ",FUNDTOX
.
.                                           * Get Casemix Code Range
.
GDAT2000  DISPLAY   *P1:10,*EL,"Casemix Code - From : ":               *I-90203
                    *P1:11,*EL,"               To   : ";               *I-90203
          MOVE      SP6,CMIXFR
          MOVE      SP1,CMXTYFR                                        *I-90203
          MOVE      "Start",CMIXFRD
          MOVE      SP30,CMIXFRX
          MOVE      "23",ECOL
          MOVE      "35",ECOL1
          MOVE      "10",EVERT 
          CALL      PATCMXKY
          BRANCH    EXIT,GDAT2500:          * 1 = nothing input
                         GDAT9000:          * 2 = EXIT character
                         GDAT2500           * 3 = spaces
.                                             0 = OK
          MOVE      CMXCODE,CMIXFR
          MOVE      CMXCODE,CMIXFRD
          MOVE      CMXDESC,CMIXFRX
          MOVE      DIM1,CMXTYFR                                       *I-90203
.         
GDAT2500  DISPLAY   *P1:10,*EL,"Casemix Code - From : ":
                    CMIXFRD,"    ",CMIXFRX
.
          MOVE      ZED14,CMIXTO
          MOVE      "Finish",CMIXTOD
          MOVE      SP30,CMIXTOX
          MOVE      "23",ECOL
          MOVE      "35",ECOL1
          MOVE      "11",EVERT
          CALL      PATCMXKY
          BRANCH    EXIT,GDAT2600:          * 1 = nothing input
                         GDAT9000:          * 2 = EXIT character
                         GDAT2600           * 3 = spaces
.                                             0 = OK
          MOVE      CMXCODE,CMIXTO
          MOVE      CMXCODE,CMIXTOD
          MOVE      CMXDESC,CMIXTOX
.
. ******************************************* Start of Addition        *I-90203
          MATCH     CMXTYFR,DIM1            * Test if both DRG or both MBS
          GOTO      GDAT2575 IF EQUAL   
. 
          DISPLAY   *P1:23,*EL,*B,"Select only DRG or only MBS":
                    *P1:24,"Press <",*V2LON,"ENTER",*HOFF,"> to continue  ";
          KEYIN     ANS;
          DISPLAY   *P1:23,*EF
          GOTO      GDAT2000
.
GDAT2575  MATCH     CMIXFR,CMIXTO
          GOTO      GDAT2600 IF NOT LESS
. 
          DISPLAY   *P1:23,*EL,*B,"To Code is less than From Code":
                    *P1:24,"Press <",*V2LON,"ENTER",*HOFF,"> to continue  ";
          KEYIN     ANS;
          DISPLAY   *P1:23,*EF
          GOTO      GDAT2500
. ******************************************* End of Addition          *I-90203
.
GDAT2600  DISPLAY   *P1:11,*EL,"               To   : ":
                    CMIXTOD,"    ",CMIXTOX
.
          MOVE      ZERO,EXIT
.
          CALL      KHOS0000               * get hospital code
          BRANCH    EXIT,GDAT2500
.
          MOVE      ZERO,EXIT
.                                           Check if Report is to continue
GDAT3000  CALL      CONTQST
          BRANCH    CEXIT,GDAT9999:         * 1=Yes
                          GDAT8000:         * 2=No
                          GDAT9000          * 3=Cancel
          GOTO      GDAT3000
.
.
.
GDAT8000  UNPACK    SP30,FUNDFRD,FUNDTOD,CMIXFRD,CMIXTOD
          CALL      DSPL0000
	  GOTO      GDAT0000
.
GDAT9000  MOVE      ONE,EXIT
.
GDAT9999
          RETURN
+
.**************************************************************************
.*                              CREA0000               Called by: ML0000  *
.*                     create a new temporary file                        *
.**************************************************************************
.
CREA0000  CALL      KILL0000                     * remove existing file
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ISBUILD,TEMPFILE,UKEY2
          EXECUTE   CMDLINE,TASKID               * create temporary index file
.
          OPEN      SEQTEMP1,TEMPFILE            * open temp index file
          OPEN      SEQTEMP2,TEMPFILE            * open temp index file
.
CREA9999  RETURN
+
.****************************************************************************
.*                              KILL0000               Called by: CREA0000  *
.*               close and erase the temporary file               ML0000    *
.****************************************************************************
.
KILL0000  CLOSE     SEQTEMP1                     * close file
          CLOSE     SEQTEMP2                     * close file
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ERASE,TEMPFILE       * set file erase command
          EXECUTE   CMDLINE,TASKID               * erase temp file
.
KILL9999 RETURN
+
.****************************************************************************
.*                              PINV0000               Called by: ML0000    *
.*                      process the Invoice file                            *
.****************************************************************************
.
PINV0000  MOVE      ZERO,EXIT       
          PACK      KEY16,DATEFROM,SP20
          CALL      RDSINV2                 * Position on first Invoice
.
PINV1000  CALL      RDKINV2                 * read next Invoice
          BRANCH    OVRCD,PINV9999          * check for e-o-f
.
          MATCH     PINVDTE,DATETO
          GOTO      PINV9999 IF LESS        * reached end-of-date range
.
          MATCH     "1",PTINCRST            * Fully credit noted?
          GOTO      PINV1000 IF EQUAL       * yes
.
          COMPARE   ONE,PTINCMIX
          GOTO      PINV1000 IF NOT EQUAL   * not Casemix
.
          COMPARE   ONE,IBCNMHOS            * Using multi hospital
          GOTO      PINV2000 IF NOT EQUAL
.
          MATCH     SP70,HOSPCODE           * All Hospitals
          GOTO      PINV2000 IF EQUAL
.
          PACK      KEY8,PINVADM,SP70
          CALL      RDPMVX11
          BRANCH    OVRCD,PINV1000
.
          MATCH     PMVXMHOS,HOSPCODE       * Correct hospital
          GOTO      PINV1000 IF NOT EQUAL
.                                           * Check Casemix Code range
PINV2000  MATCH     CMIXFR,PTINCMCD
          GOTO      PINV1000 IF LESS        * below range               
          PACK      KEY9,CMIXTO,SP9         * fix length of CMIXTO    *I-236533
          MATCH     PTINCMCD,KEY9                                     *C-236533
          GOTO      PINV1000 IF LESS        * above range               
.
          CALL      RDMS0000                * read associated master files
          COMPARE   ONE,EXIT
          GOTO      PINV1000 IF EQUAL       * Not in Health Fund Range
.
.
. ****** Now re-calculate the Invoice as a Pat Cat (not as Casemix)
.                                           * OK -
          MOVE      ZERO,PTINCMIX           * turn off Casemix flag *******
          MOVE      ONE,PTCNNWCM            * turn on Casepayment matrix to
.                                           * force Theatre fees to recalculate
          MOVE      ANSN,PTMICMXP           * turn off casemix in the Admission
          MOVE      ZERO,AINVPRT            * turn off Invoice printed flag
          MOVE      ZERO,ADSCHI             * turn off Discharge/Inv flag.
          MOVE      ADATE,ALACDTE           * set accomodation start date
.
          CALL      CICD0000                * Check ICD10 Suggested Class.
.
          MOVE      PINVDTE,TMPINVDT        * save now - CALCTBI resets PINVDTE
.
          MOVE      ONE,PROGFLAG            * calculate - no display
          CALL      CALCTBI                 * recalculate the invoice - PATCATBI
.
.                                           * Set up and write to temp file
.
          MOVE      PINVADM,TMPADMNO
          MOVE      PINVNO,TMPINVNO
....      MOVE      PINVDTE,TMPINVDT                                  *D-236533
          MOVE      PFUNDH,TMPHFUND
          MOVE      PTINCMCD,TMPCMXCD
          MOVE      PINVAMT,TMPINVTO
          MOVE      ACTLOS,TMPACLOS         * from NHOSPDAY
          MOVE      PTCAELOS,TMPCMLOS       * from Casemix Codes table
.
          MOVE      TOTACCM,TMPPCACC
          MOVE      TOTMISC,TMPPCMIS
          MOVE      TOTTHEA,TMPPCTHE
          SUB       TOTOTHR,GROSSTOT
          MOVE      GROSSTOT,TMPPCTOT
          MOVE      SP20,TMPSPARE
.
          PACK      KEY16,TMPADMNO,TMPINVNO,SP20
          CALL      WRTEMX1
          GOTO      PINV1000
.
PINV9999  MOVE      ZERO,EXIT
          RETURN
+
.****************************************************************************
.              * Check ICD10 Suggested Class.
.****************************************************************************
CICD0000  MATCH     SP3,ATYPE
          GOTO      CICD9000 IF EQUAL       * Blank admission type
.
          PACK      KEY5,ANSA,SP1,ATYPE
          CALL      RDCODE1                 * Read the codes file
          BRANCH    OVRCD,CICD9000
.
          MATCH     ANSX,TCINDC7
          GOTO      CICD9000 IF EQUAL       * Exclude this admission type
.
          COMPARE   SIX,TCFORM6
          GOTO      CICD9000 IF NOT EQUAL
.
.         No ICD10 Suggested Classification, if there is an MBS Item charge
.
          CALL      CHKI0000                * Check MBS items
          BRANCH    EXIT,CICD9000           * found Theatre item record
.
          MATCH     SP70,ACODDTE            * Coding is incomplete?
          GOTO      CICD9000 IF EQUAL
.
          CALL      GDIA0000                * Get the primary diagnosis
          BRANCH    EXIT,CICD9000           * no primary diagnosis
.
          CALL      CHSG0000                * Check Suggested Class.file
          MOVE      PMSGCLSS,ATYPE
          GOTO      CICD9999
.
CICD9000  MOVE      SP70,PMSGCLSS
CICD9999  RETURN
+
.****************************************************************************
.*                              RDMS0000               Called by: PINV0000  *
.*                     Read associated master files                         *
.****************************************************************************
.
RDMS0000  MOVE      ZERO,EXIT
          MOVE      PINVUR,KEY8             * Read Master 
          CALL      RDMAST1
          BRANCH    OVRCD,RDMS9000          * Bypass Invoice if no Master
.
.                                           * Check if Health Fund in range
          MATCH     FUNDFR,PFUNDH   
          GOTO      RDMS9000 IF LESS        * below range - bypass Invoice
          MATCH     PFUNDH,FUNDTO
          GOTO      RDMS9000 IF LESS        * above range - bypass Invoice
.
.                                           * Read the Admission record
          MOVE      DPINVADM,KEY8
          CALL      RDMISS1
          BRANCH    OVRCD,RDMS9000          * Bypass Invoice if no Admission
.
.                                           * Read the Discharge record
          CALL      RDDSCH1
.
.
. ******************************************* Get LOS (length of Stay) figures
.
          MOVE      PTINCMCD,KEY9
          CALL      RDPTCMC1                * Read Casemix Codes table
          IF        OVRCD = 1
            MOVE      ZERO,PTCAELOS         * just in case
            MOVE      SP30,PTCADES1
          ENDIF
.
.                   Calculate the actual LOS using NHOSPDAY
.
          MOVE      ZERO,NBRDAYS
          MOVE      ADATE,FROMDATE
          MOVE      DDATE,TODATE            * discharge date 
          CALL      NHOSPDAY                * bed day calculating routine
          MOVE      NBRDAYS,ACTLOS
.
          GOTO      RDMS9999
.
RDMS9000  MOVE      ONE,EXIT
.
RDMS9999  DISPLAY   *P1:24,"Processing Invoice ",PINVNO;
          RETURN
+
.****************************************************************************
.*                              PRNT0000               Called by: ML0000    *
.*                    print the wins & losses report                        *
.****************************************************************************
.
PRNT0000  MOVE      "99",CLNO                    * Force page overflow
          MOVE      ONE,FIRST
.
          DISPLAY   *P1:23,*EL:
                    *P1:24,*EL,"Printing Report"
.
          MOVE      ZERO,NUMB 
          REPEAT                                 * Clear total areas
            ADD       ONE,NUMB
            MOVE      ZERO,W1TOTACL[NUMB]
            MOVE      ZERO,W1TOTCML[NUMB]
            MOVE      ZERO,W1TOTINV[NUMB]
            MOVE      ZERO,W1TOTTHE[NUMB]
            MOVE      ZERO,W1TOTACC[NUMB]
            MOVE      ZERO,W1TOTMIS[NUMB]
            MOVE      ZERO,W1TOTPAT[NUMB]
            MOVE      ZERO,W1TOTWIN[NUMB]
          UNTIL     NUMB = 3
.
          MOVE      SP30,PKEY15
          MOVE      SP30,KEY31
          CALL      RSTEMX2                      * position on first record
.
PRNT1000  CALL      RKTEMX2
          BRANCH    OVRCD,PRNT9000               * end of file
.
          PACK      KEY15,TMPHFUND,TMPCMXCD,SP30
          COMPARE   ONE,FIRST
          GOTO      PRNT2000 IF EQUAL            * Bypass totals on 1st pass
.
          MATCH     KEY15,PKEY15                 * check for Key change
          CALL      PEND0000 IF NOT EQUAL        * print totals
.
PRNT2000  MOVE      KEY15,PKEY15                 * reset Previous Key
.
          COMPARE   FIFTY9,CLNO                  * check for new page
          CALL      HEAD0000 IF NOT LESS
          MOVE      ZERO,NEWPAGE
.
.                                                * set up next print line
          UNPACK    TMPINVDT,CCENT,CYEAR,CMON,CDAY
          PACK      DIM10,CDAY,SLSH,CMON,SLSH,CCENT,CYEAR
          MOVE      TMPACLOS,DIM4A
          MOVE      TMPCMLOS,DIM4B
          MOVE      TMPINVTO,DIM15 
          UNPACK    DIM15,DIM3,DIM12A
          MOVE      TMPPCTHE,DIM15 
          UNPACK    DIM15,DIM3,DIM12B
          MOVE      TMPPCACC,DIM15 
          UNPACK    DIM15,DIM3,DIM12C
          MOVE      TMPPCMIS,DIM15 
          UNPACK    DIM15,DIM3,DIM12D
          MOVE      TMPPCTOT,DIM15 
          UNPACK    DIM15,DIM3,DIM12E
          MOVE      TMPINVTO,WINLOSS
          SUB       TMPPCTOT,WINLOSS
          COMPARE   ZERO,WINLOSS
          IF        @LESS
            MOVE      "-",WSIGN
          ELSE
            MOVE      "+",WSIGN
          ENDIF
          MOVE      WINLOSS,DIM15
          UNPACK    DIM15,DIM3,DIM12F
.
.                                           * print the line
          PRINT     *1,TMPHFUND,*8,TMPCMXCD,*18,DIM10,*28,TMPINVNO:
                    *36,TMPADMNO,*46,DIM4A,*51,DIM4B,*55,DIM12A:
                    *67,DIM12B,*80,DIM12C,*92,DIM12D,*104,DIM12E:
                    *116,DIM12F,*131,WSIGN
          ADD       ONE,CLNO
.
.                                           * Add the totals
          MOVE      ZERO,NUMB 
          REPEAT
            ADD       ONE,NUMB
            ADD       TMPACLOS,W1TOTACL[NUMB]
            ADD       TMPCMLOS,W1TOTCML[NUMB]
            ADD       TMPINVTO,W1TOTINV[NUMB]
            ADD       TMPPCTHE,W1TOTTHE[NUMB]
            ADD       TMPPCACC,W1TOTACC[NUMB]
            ADD       TMPPCMIS,W1TOTMIS[NUMB]
            ADD       TMPPCTOT,W1TOTPAT[NUMB]
            ADD       WINLOSS,W1TOTWIN[NUMB]
          UNTIL     NUMB = 3
.
          GOTO PRNT1000
.
PRNT9000  MOVE      ZERO,EXIT
          MOVE      ONE,ENDTOT
          CALL      PEND0000                * print totals for last page
          PRINT     *N,*1,"*** End of Report ***"
.
.                                           Pause at end of report
PRNT9500  DISPLAY   *P1:24,"END OF REPORT     ";
          CALL      HITENTER
. 
PRNT9999  RETURN
+
.****************************************************************************
.*                              PEND0000               Called by: PRNT0000  *
.*                           print totals                         ML0000    *
.****************************************************************************
.
PEND0000  MOVE      ZERO,NEWPAGE
.
          MOVE      THREE,TIMES
          COMPARE   ONE,ENDTOT              * set to 3 if end-of-job
          GOTO      PEND1000 IF EQUAL
.
          MOVE      ONE,TIMES               * default for sub totals only
.
          UNPACK    PKEY15,DIM6A,DIM9
          UNPACK    KEY15,DIM6B,DIM9
          MATCH     DIM6A,DIM6B             * check for change of Fund
          GOTO      PEND1000 IF EQUAL
          MOVE      TWO,TIMES
.
PEND1000  COMPARE   FIFTY7,CLNO
          CALL      HEAD0000 IF NOT LESS
.
          IF        NEWPAGE = 0
            PRINT     *1," "                * skip a line
            ADD       ONE,CLNO
          ENDIF
          MOVE      ZERO,NEWPAGE
.
          MOVE      ZERO,NUMB
          REPEAT
            ADD       ONE,NUMB
            MOVE      W1TOTACL[NUMB],DIM4A
            MOVE      W1TOTCML[NUMB],DIM4B
            MOVE      W1TOTINV[NUMB],DIM15
            UNPACK    DIM15,DIM3,DIM12A
            MOVE      W1TOTTHE[NUMB],DIM15
            UNPACK    DIM15,DIM3,DIM12B
            MOVE      W1TOTACC[NUMB],DIM15
            UNPACK    DIM15,DIM3,DIM12C
            MOVE      W1TOTMIS[NUMB],DIM15
            UNPACK    DIM15,DIM3,DIM12D
            MOVE      W1TOTPAT[NUMB],DIM15
            UNPACK    DIM15,DIM3,DIM12E
            MOVE      W1TOTWIN[NUMB],DIM15
            UNPACK    DIM15,DIM3,DIM12F
            COMPARE   ZERO,W1TOTWIN[NUMB]
            IF        @LESS
              MOVE      "-",WSIGN
            ELSE
              MOVE      "+",WSIGN
            ENDIF
.
            UNPACK    PKEY15,DIM6,DIM9
.
            IF        NUMB = 1
              PRINT     *1,DIM6,*8,DIM9,*18,"CASEMIX SUB TOTAL";
            ENDIF
.
            IF        NUMB = 2
              PRINT     *1,DIM6,*18,"HEALTHFUND TOTAL";
            ENDIF
.
            IF        NUMB = 3
              PRINT     *1," ",*N:
                        *1,"GRAND TOTAL  ";
              ADD       ONE,CLNO
            ENDIF
.
            PRINT     *46,DIM4A,*51,DIM4B,*55,DIM12A:
                      *67,DIM12B,*80,DIM12C,*92,DIM12D,*104,DIM12E:
                      *116,DIM12F,*131,WSIGN
            ADD       ONE,CLNO
.
            MOVE      ZERO,W1TOTACL[NUMB]
            MOVE      ZERO,W1TOTCML[NUMB]
            MOVE      ZERO,W1TOTINV[NUMB]
            MOVE      ZERO,W1TOTTHE[NUMB]
            MOVE      ZERO,W1TOTACC[NUMB]
            MOVE      ZERO,W1TOTMIS[NUMB]
            MOVE      ZERO,W1TOTPAT[NUMB]
            MOVE      ZERO,W1TOTWIN[NUMB]
          UNTIL     NUMB = TIMES
.
          PRINT     *1," "
          ADD       ONE,CLNO
.
PEND9999  RETURN
+
.****************************************************************************
.*                              HEAD0000               Called by: PRNT0000  *
.*                      print the report headings                 ML0000    *
.****************************************************************************
.
HEAD0000  CALL      HEAD132                 * print the page header
          MOVE      ZERO,FIRST
.
          UNPACK    DATEFROM,CCENT,CYEAR,CMON,CDAY
          PACK      DIM10A,CDAY,SLSH,CMON,SLSH,CCENT,CYEAR
          UNPACK    DATETO,CCENT,CYEAR,CMON,CDAY
          PACK      DIM10B,CDAY,SLSH,CMON,SLSH,CCENT,CYEAR
.
          IF        IBCNMHOS=1
            PRINT     *1,"From Date : ",DIM10A," to ",DIM10B:
                      *45,"Health Fund  : ",FUNDFRD,"  to ",FUNDTOD,*N:
                      *45,"Casemix Code : ",CMIXFRD,"  to ",CMIXTOD,*N:
                      *45,"Hospital     : ",HOSPNAME,*N
          ELSE
            PRINT     *1,"From Date : ",DIM10A," to ",DIM10B:
                      *45,"Health Fund  : ",FUNDFRD,"  to ",FUNDTOD,*N:
                      *45,"Casemix Code : ",CMIXFRD,"  to ",CMIXTOD,*N
          ENDIF
.
          PRINT     *129,"Win/",*N:
.                       ....*....1....*....2....*....3....*....4....*....5
                    *1,"Health Casemix   Invoice    Invoice  Adm.     Act ":
.                    ....*....6....*....7....*....8....*....9....*....0
                    "CMix     Invoice     Pat Cat      Pat Cat    Pat C":
.                    ....*....1....*....2....*....3..
                    "at     Pat Cat   Difference Loss",*N:
                    *1,"Fund   Code      Date       Number   Number   LOS ":
                    " LOS       Total     Theatre       Accom.      Mis":
                    "c.       Total              Flag",*N:
                    *1," "
.
          IF        IBCNMHOS=1
            MOVE      TEN1,CLNO
          ELSE
            MOVE      TEN,CLNO
          ENDIF
.
HEAD9999  RETURN
.
.******************************************************************************
.*                                  KHOS0000              Called by: ML0000   *
.*                            Enter The hospital                              *
.******************************************************************************
KHOS0000  COMPARE   ONE,IBCNMHOS
          GOTO      KHOS9999 IF NOT EQUAL
.
          MOVE      SP70,HOSPNAME
          MOVE      SP70,HOSPCODE
.
          DISPLAY   *P1:13,*EL,"Hospital Id : ";
          MOVE      TEN5,ECOL
          MOVE      TEN3,EVERT
          MOVE      SP3,CKYIDEF3
          MOVE      ZERO,CKYIMAND           * Not Mandatory
          OPEN      PATHSPA1,"pathspaf"
.
          CALL      PATHSPKY
          BRANCH    EXIT,KHOS2000,KHOS9500
.
          MOVE      PTHSHOSP,HOSPCODE
          MOVE      PTHSNAME,HOSPNAME
.
          GOTO      KHOS3000
.
KHOS2000  MOVE      "All Hospitals",HOSPNAME
          MOVE      SP10,HOSPCODE
          MOVE      ZERO,EXIT
.
KHOS3000  CLOSE     PATHSPA1
.
          DISPLAY   *P20:13,*V2LON,HOSPNAME;
          GOTO      KHOS9999
.
KHOS9500  MOVE      ONE,EXIT
KHOS9999  RETURN
+
.****************************************************************************
.*      I/O ROUTINES FOR TEMPORARY FILE                                    *
.****************************************************************************
.
.         Index 1 Routines
.
RATEMX1   MOVE      ZERO,OVRCD
          READ      SEQTEMP1,KEY16;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSTEMX1   READ      SEQTEMP1,KEY16;;
          RETURN
.
RDTEMX1   MOVE      ZERO,OVRCD
          READ      SEQTEMP1,KEY16;TMPADMNO,TMPINVNO,TMPINVDT,TMPHFUND:
                                   TMPCMXCD,TMPINVTO,TMPACLOS,TMPCMLOS:
                                   TMPPCTHE,TMPPCACC,TMPPCMIS,TMPPCTOT:
                                   TMPSPARE
          GOTO      OVERCOND IF OVER
          RETURN
.
RKTEMX1   MOVE      ZERO,OVRCD
          READKS    SEQTEMP1;TMPADMNO,TMPINVNO,TMPINVDT,TMPHFUND:
                                   TMPCMXCD,TMPINVTO,TMPACLOS,TMPCMLOS:
                                   TMPPCTHE,TMPPCACC,TMPPCMIS,TMPPCTOT:
                                   TMPSPARE
          GOTO      OVERCOND IF OVER
          RETURN
.
RPTEMX1   MOVE      ZERO,OVRCD
          READKP    SEQTEMP1;TMPADMNO,TMPINVNO,TMPINVDT,TMPHFUND:
                                   TMPCMXCD,TMPINVTO,TMPACLOS,TMPCMLOS:
                                   TMPPCTHE,TMPPCACC,TMPPCMIS,TMPPCTOT:
                                   TMPSPARE
          GOTO      OVERCOND IF OVER
          RETURN
.
WRTEMX1   WRITE     SEQTEMP1,KEY16;TMPADMNO,TMPINVNO,TMPINVDT,TMPHFUND:
                                   TMPCMXCD,TMPINVTO,TMPACLOS,TMPCMLOS:
                                   TMPPCTHE,TMPPCACC,TMPPCMIS,TMPPCTOT:
                                   TMPSPARE
          RETURN
.
DETEMX1   DELETE    SEQTEMP1,KEY16
          RETURN
.
.         Index 2 Routines
.
RSTEMX2   READ      SEQTEMP2,KEY31;;
          RETURN
.
RKTEMX2   MOVE      ZERO,OVRCD
          READKS    SEQTEMP2;TMPADMNO,TMPINVNO,TMPINVDT,TMPHFUND:
                                   TMPCMXCD,TMPINVTO,TMPACLOS,TMPCMLOS:
                                   TMPPCTHE,TMPPCACC,TMPPCMIS,TMPPCTOT:
                                   TMPSPARE
          GOTO      OVERCOND IF OVER
          RETURN
.
RPTEMX2   MOVE      ZERO,OVRCD
          READKP    SEQTEMP2;TMPADMNO,TMPINVNO,TMPINVDT,TMPHFUND:
                                   TMPCMXCD,TMPINVTO,TMPACLOS,TMPCMLOS:
                                   TMPPCTHE,TMPPCACC,TMPPCMIS,TMPPCTOT:
                                   TMPSPARE
          GOTO      OVERCOND IF OVER
          RETURN
+
. =========================================================================
SBDY0000
PATSTRYR
ADDWRN00
.
GETMSC
GETTHR
HL7BMTTR
INITIVAR
PATCALF
PATIVMES
PROCMISC
PRTCLMS
PRTINVTL
SINVT000
PEOL0000
PRLN0000
THL7BM00
TAIL
NXTTRAN1
WEBERR00
CKTL0000
PROACC00
ENDPRT00
PRTIPROV
WRITETRN  RETURN
+
. =========================================================================
.         I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       CLNZPPIC
          INC       PATFNDKY                * Keyin for Health Funds
          INC       PATCMXKY                * Keyin for Casemix Codes
          INC       PATCATBI                * Invoice calculations
          INC       STEPDOWN
          INC       PATCMSTP
.....     INC       PATDBTYP
          INC       CMGETTHR
          INC       NHOSPDAY
          INC       CMXMATRX
          INC       PATCOMN3
          INC       CALCDAYS
          INC       PATGNCMX
          INC       PABXBILL
          INC       CHKCMXPT
          INC       CLPATDTR
          INC       PATHSPKY
          INC       PATMCHRD                * Miscellaneous Charges read routine
          INC       GETBFEES
          INC       GETTFEES
          INC       GETCNEFF
          INC       PATITMRD
          INC       TFILENAM                     * Generate Temp File Name
.
          INC       COMDEPIO/INC
          INC       IBAGSTIO/INC
          INC       IBASEQIO/INC                 * Sequential Numbers File
          INC       MLTCFNIO/INC
          INC       NZPEXTIO/INC
          INC       NZPRDTIO/INC
          INC       NZPBFEIO/INC
          INC       NZPCFNIO/INC
          INC       NZPCMTIO/INC
          INC       NZPFIGIO/INC
          INC       NZPIBRIO/INC
          INC       NZPMCHIO/INC
          INC       NZPMXCIO/INC
          INC       NZPPFEIO/INC
          INC       NZPPICIO/INC
          INC       NZPRBRIO/INC
          INC       NZPRFNIO/INC
          INC       NZPFINIO/INC
          INC       NZPSPRIO/INC
          INC       NZPTFEIO/INC
          INC       NZPIVBIO/INC
          INC       NZPRVBIO/INC
          INC       OPRDEAIO/INC
          INC       OPRSESIO/INC
          INC       PATCMCIO/INC            * Casemix Codes table
          INC       PMSCIDIO/INC
          INC       PMSCCDIO/INC
          INC       PATCFAIO/INC
          INC       PATTRNIO/INC            * Transfer file 
          INC       PATMA1IO/INC            * Patient Master
          INC       PATMI1IO/INC            * Patient Admissions
          INC       PATDSCIO/INC            * Patient Discharge Details
          INC       PATDTRIO/INC            * Patient Debtors Transactions
          INC       PATICUIO/INC
          INC       PATINVIO/INC            * Patient Invoice Details
          INC       PATCODIO/INC
          INC       PATITMIO/INC            * Patient Item table       
          INC       PATFX1IO/INC            * Patient Health Fund Table
          INC       PATFN1IO/INC            * Patient Health Fund Table
          INC       PATFN2IO/INC
          INC       PATRFNIO/INC
.
.                                           * All the IOs for PATCATBI
          INC       PATELGIO/INC
          INC       PATAFEIO/INC
          INC       PATASDIO/INC
          INC       PATBFEIO/INC
          INC       PATCMXIO/INC
          INC       PATCTFIO/INC
          INC       PATDO1IO/INC
          INC       PATDGWIO/INC            * DRG Descriptions         
          INC       PATDRGIO/INC
.....     INC       PATECOIO/INC                                        D-90203
          INC       PATECDIO/INC                                       *I-90203
          INC       PATECOIO/INC                                       *I-90203
          INC       PATFINIO/INC
          INC       PATFMOIO/INC
          INC       PATHDFIO/INC
          INC       PATHLFIO/INC
          INC       PATHSPIO/INC
          INC       PATHTRIO/INC
          INC       PATIBLIO/INC
          INC       PATIOVIO/INC
          INC       PATRCAIO/INC
          INC       PATLDFIO/INC
          INC       PATLSDIO/INC
          INC       PATMCHIO/INC
          INC       PATOVBIO/INC
          INC       PATPGRIO/INC
          INC       PATRATIO/INC
          INC       PATRBLIO/INC
          INC       PATSRBIO/INC
          INC       PATTFEIO/INC            * Bed Fee Table
	  INC       PATVENIO/INC
	  INC       PATVISIO/INC
          INC       PMSCNOIO/INC
          INC       PMSHATIO/INC
          INC       PMSMPRIO/INC
          INC       PMSVX1IO/INC
          INC       PATWR1IO/INC
          INC       PATCMTIO/INC
          INC       PMSCMTIO/INC
          INC       PMSSINIO/INC
          INC       PMSSGAIO/INC
          INC       PMSMTIIO/INC
          INC       OUTPREIO/INC
          INC       OPRARDIO/INC
          INC       IBAGEDIO/INC
          INC       PMSPBRIO/INC
          INC       PMSIDEIO/INC
          INC       PATAA1IO/INC
          INC       PATSTAIO/INC
          INC       CLPMSIDE
          INC       ICDSCLAS
          INC       VALCMXFN
          INC       GETEFDRG
.
          INC       RCPBNKIO/INC
          INC       RCPDTEIO/INC
          INC       RCPBDTIO/INC
          INC       WEBERRIO/INC                 * Web Server Error Logging
          INC       PMSEDGIO/INC       * Effective DRG Dates
          INC       PATDDHIO/INC
