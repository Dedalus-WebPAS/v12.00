.----------------------------------------------------------------------
. Modifications
.
. V10.10.02  30/05/2017  Peter Vela    TSK 0837660
.            Added new fields - Jessie Mac Theatre Enhancement
. V10.10.01  16/03/2017  Peter Vela    TSK 0824042
.            Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for Theatre Attributes Table
.------------------------------------------------------------------------
CLROTR00  MOVE      SP70,OTATR001
          MOVE      SP70,OTATR002
          MOVE      SP70,OTATR003
          MOVE      SP70,OTATR004
          MOVE      SP70,OTATR005
          MOVE      SP70,OTATR006
          MOVE      SP70,OTATR007
          MOVE      SP70,OTATR008
          MOVE      SP70,OTATR009
          MOVE      SP70,OTATR010
          MOVE      SP70,OTATR011
          MOVE      SP70,OTATR012
          MOVE      SP70,OTATR013
          MOVE      SP70,OTATR014
          MOVE      SP70,OTATR015
          MOVE      SP70,OTATR016
          MOVE      SP70,OTATR017
          MOVE      SP70,OTATR018
          MOVE      SP70,OTATR019
          MOVE      SP70,OTATR020
          MOVE      SP70,OTATR021
          MOVE      SP70,OTATR022
          MOVE      SP70,OTATR023
          MOVE      SP70,OTATR024
          MOVE      SP70,OTATR025
          MOVE      SP70,OTATR026
          MOVE      SP70,OTATR027
          MOVE      SP70,OTATR028
          MOVE      SP70,OTATR029
          MOVE      SP70,OTATR030
          MOVE      SP70,OTATR031
          MOVE      SP70,OTATR032
          MOVE      SP70,OTATR033
          MOVE      SP70,OTATR034
          MOVE      SP70,OTATR035
          MOVE      SP70,OTATR036
          MOVE      SP70,OTATR037
          MOVE      SP70,OTATR038
.
CLROTR99  RETURN
+
.------------------------------------------------------------
. Output Theatre Attribute Field
.------------------------------------------------------------
OTAT0000  BRANCH    FLDITMNO,OTAT0100,OTAT0200,OTAT0300,OTAT0400,OTAT0500:
                             OTAT0600,OTAT0700,OTAT0800,OTAT0900,OTAT1000:
                             OTAT1100,OTAT1200,OTAT1300,OTAT1400,OTAT1500:
                             OTAT1600,OTAT1700,OTAT1800,OTAT1900,OTAT2000:
                             OTAT2100,OTAT2200,OTAT2300,OTAT2400,OTAT2500:
                             OTAT2600,OTAT2700,OTAT2800,OTAT2900,OTAT3000:
                             OTAT3100,OTAT3200,OTAT3300,OTAT3400,OTAT3500:
                             OTAT3600,OTAT3700,OTAT3800
.
OTAT0100  WRITE     HTMLFILE;OPABUNIQ;
          GOTO      OTAT9999
.
OTAT0200  WRITE     HTMLFILE;OPABTYPE;
          GOTO      OTAT9999
.
OTAT0300  WRITE     HTMLFILE;OPABVAL1;
          GOTO      OTAT9999
.
OTAT0400  WRITE     HTMLFILE;OPABVAL2;
          GOTO      OTAT9999
.
OTAT0500  WRITE     HTMLFILE;OPABVAL3;
          GOTO      OTAT9999
.
OTAT0600  WRITE     HTMLFILE;OPABVAL4;
          GOTO      OTAT9999
.
OTAT0700  WRITE     HTMLFILE;OPABCOD1;
          GOTO      OTAT9999
.
OTAT0800  WRITE     HTMLFILE;OPABCOD2;
          GOTO      OTAT9999
.
OTAT0900  WRITE     HTMLFILE;OPABCOD3;
          GOTO      OTAT9999
.
OTAT1000  WRITE     HTMLFILE;OPABCOD4;
          GOTO      OTAT9999
.
OTAT1100  WRITE     HTMLFILE;OPABTXT1;
          GOTO      OTAT9999
.
OTAT1200  WRITE     HTMLFILE;OPABTXT2;
          GOTO      OTAT9999
.
OTAT1300  WRITE     HTMLFILE;OPABTXT3;
          GOTO      OTAT9999
.
OTAT1400  WRITE     HTMLFILE;OPABTXT4;
          GOTO      OTAT9999
.
OTAT1500  WRITE     HTMLFILE;OPABYN01;
          GOTO      OTAT9999
.
OTAT1600  WRITE     HTMLFILE;OPABYN02;
          GOTO      OTAT9999
.
OTAT1700  WRITE     HTMLFILE;OPABYN03;
          GOTO      OTAT9999
.
OTAT1800  WRITE     HTMLFILE;OPABYN04;
          GOTO      OTAT9999
.
OTAT1900  WRITE     HTMLFILE;OPABDELT;
          GOTO      OTAT9999
.
OTAT2000  WRITE     HTMLFILE;OPABCUID;
          GOTO      OTAT9999
.
OTAT2100  MATCH     SP70,OPABCDAT
          GOTO      OTAT9999 IF EQUAL
          UNPACK    OPABCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OTAT9999
.
OTAT2200  WRITE     HTMLFILE;OPABCTIM;
          GOTO      OTAT9999
.
OTAT2300  WRITE     HTMLFILE;OPABUUID;
          GOTO      OTAT9999
.
OTAT2400  MATCH     SP70,OPABUDAT
          GOTO      OTAT9999 IF EQUAL
          UNPACK    OPABUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OTAT9999
.
OTAT2500  WRITE     HTMLFILE;OPABUTIM;
          GOTO      OTAT9999
.
OTAT2600  WRITE     HTMLFILE;OPABFUID;
          GOTO      OTAT9999
.
OTAT2700  MATCH     SP70,OPABFDAT
          GOTO      OTAT9999 IF EQUAL
          UNPACK    OPABFDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OTAT9999
.
OTAT2800  WRITE     HTMLFILE;OPABFTIM;
          GOTO      OTAT9999
.
OTAT2900  WRITE     HTMLFILE;OPABCOD5;
          GOTO      OTAT9999
.
OTAT3000  WRITE     HTMLFILE;OPABCOD6;
          GOTO      OTAT9999
.
OTAT3100  WRITE     HTMLFILE;OPABYN05;
          GOTO      OTAT9999
.
OTAT3200  WRITE     HTMLFILE;OPABYN06;
          GOTO      OTAT9999
.
OTAT3300  WRITE     HTMLFILE;OPABYN07;
          GOTO      OTAT9999
.
OTAT3400  WRITE     HTMLFILE;OPABYN08;
          GOTO      OTAT9999
.
OTAT3500  WRITE     HTMLFILE;OPABYN09;
          GOTO      OTAT9999
.
OTAT3600  WRITE     HTMLFILE;OPABYN10;
          GOTO      OTAT9999
.
OTAT3700  MATCH     SP70,OPABUDD1
          GOTO      OTAT9999 IF EQUAL
          UNPACK    OPABUDD1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OTAT9999
.
OTAT3800  WRITE     HTMLFILE;OPABUDT1;
          GOTO      OTAT9999
.
OTAT9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for theatre attributes table
.------------------------------------------------------------
SOTATR00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SOTATR01,SOTATR02,SOTATR03,SOTATR04,SOTATR05:
                       SOTATR06,SOTATR07,SOTATR08,SOTATR09,SOTATR10:
                       SOTATR11,SOTATR12,SOTATR13,SOTATR14,SOTATR15:
                       SOTATR16,SOTATR17,SOTATR18,SOTATR19,SOTATR20:
                       SOTATR21,SOTATR22,SOTATR23,SOTATR24,SOTATR25:
                       SOTATR26,SOTATR27,SOTATR28,SOTATR29,SOTATR30:
                       SOTATR31,SOTATR32,SOTATR33,SOTATR34,SOTATR35:
                       SOTATR36,SOTATR37,SOTATR38
.
          MOVE      ONE,EXIT
          GOTO      SOTATR99
.
SOTATR01  MOVE      QRYDATA,OTATR001
          GOTO      SOTATR99
.
SOTATR02  MOVE      QRYDATA,OTATR002
          GOTO      SOTATR99
.
SOTATR03  MOVE      QRYDATA,OTATR003
          GOTO      SOTATR99
.
SOTATR04  MOVE      QRYDATA,OTATR004
          GOTO      SOTATR99
.
SOTATR05  MOVE      QRYDATA,OTATR005
          GOTO      SOTATR99
.
SOTATR06  MOVE      QRYDATA,OTATR006
          GOTO      SOTATR99
.
SOTATR07  MOVE      QRYDATA,OTATR007
          GOTO      SOTATR99
.
SOTATR08  MOVE      QRYDATA,OTATR008
          GOTO      SOTATR99
.
SOTATR09  MOVE      QRYDATA,OTATR009
          GOTO      SOTATR99
.
SOTATR10  MOVE      QRYDATA,OTATR010
          GOTO      SOTATR99
.
SOTATR11  MOVE      QRYDATA,OTATR011
          GOTO      SOTATR99
.
SOTATR12  MOVE      QRYDATA,OTATR012
          GOTO      SOTATR99
.
SOTATR13  MOVE      QRYDATA,OTATR013
          GOTO      SOTATR99
.
SOTATR14  MOVE      QRYDATA,OTATR014
          GOTO      SOTATR99
.
SOTATR15  MOVE      QRYDATA,OTATR015
          GOTO      SOTATR99
.
SOTATR16  MOVE      QRYDATA,OTATR016 
          GOTO      SOTATR99
.
SOTATR17  MOVE      QRYDATA,OTATR017
          GOTO      SOTATR99
.
SOTATR18  MOVE      QRYDATA,OTATR018
          GOTO      SOTATR99
.
SOTATR19  MOVE      QRYDATA,OTATR019
          GOTO      SOTATR99
.
SOTATR20  MOVE      QRYDATA,OTATR020
          GOTO      SOTATR99
.
SOTATR21  MATCH     SP70,QRYDATA
          GOTO      SOTATR99 IF EQUAL
          GOTO      SOTATR99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTATR021,CCENT,CYEAR,CMON,CDAY
          GOTO      SOTATR99
.
SOTATR22  MOVE      QRYDATA,OTATR022
          GOTO      SOTATR99
.
SOTATR23  MOVE      QRYDATA,OTATR023
          GOTO      SOTATR99
.
SOTATR24  MATCH     SP70,QRYDATA
          GOTO      SOTATR99 IF EQUAL
          GOTO      SOTATR99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTATR024,CCENT,CYEAR,CMON,CDAY
          GOTO      SOTATR99
.
SOTATR25  MOVE      QRYDATA,OTATR025
          GOTO      SOTATR99
.
SOTATR26  MOVE      QRYDATA,OTATR026
          GOTO      SOTATR99
.
SOTATR27  MATCH     SP70,QRYDATA
          GOTO      SOTATR99 IF EQUAL
          GOTO      SOTATR99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTATR027,CCENT,CYEAR,CMON,CDAY
          GOTO      SOTATR99
.
SOTATR28  MOVE      QRYDATA,OTATR028
          GOTO      SOTATR99
.
SOTATR29  MOVE      QRYDATA,OTATR029
          GOTO      SOTATR99
.
SOTATR30  MOVE      QRYDATA,OTATR030
          GOTO      SOTATR99
.
SOTATR31  MOVE      QRYDATA,OTATR031
          GOTO      SOTATR99
.
SOTATR32  MOVE      QRYDATA,OTATR032
          GOTO      SOTATR99
.
SOTATR33  MOVE      QRYDATA,OTATR033
          GOTO      SOTATR99
.
SOTATR34  MOVE      QRYDATA,OTATR034
          GOTO      SOTATR99
.
SOTATR35  MOVE      QRYDATA,OTATR035
          GOTO      SOTATR99
.
SOTATR36  MOVE      QRYDATA,OTATR036
          GOTO      SOTATR99
.
SOTATR37  MATCH     SP70,QRYDATA
          GOTO      SOTATR99 IF EQUAL
          GOTO      SOTATR99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTATR037,CCENT,CYEAR,CMON,CDAY
          GOTO      SOTATR99
.
SOTATR38  MOVE      QRYDATA,OTATR038
          GOTO      SOTATR99
.
SOTATR99  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to theatre attributes file variables
.------------------------------------------------------------------------
MVOTTATR  PACK      OPABUNIQ,OTATR001,SP70
          PACK      OPABTYPE,OTATR002,SP70
          PACK      OPABVAL1,OTATR003,SP70
          PACK      OPABVAL2,OTATR004,SP70
          PACK      OPABVAL3,OTATR005,SP70
          PACK      OPABVAL4,OTATR006,SP70
          PACK      OPABCOD1,OTATR007,SP70
          PACK      OPABCOD2,OTATR008,SP70
          PACK      OPABCOD3,OTATR009,SP70
          PACK      OPABCOD4,OTATR010,SP70
          PACK      OPABTXT1,OTATR011,SP70,SP70
          PACK      OPABTXT2,OTATR012,SP70,SP70
          PACK      OPABTXT3,OTATR013,SP70,SP70
          PACK      OPABTXT4,OTATR014,SP70,SP70
          PACK      OPABYN01,OTATR015,SP70
          PACK      OPABYN02,OTATR016,SP70
          PACK      OPABYN03,OTATR017,SP70
          PACK      OPABYN04,OTATR018,SP70
          PACK      OPABDELT,OTATR019,SP70
          PACK      OPABCUID,OTATR020,SP70
          PACK      OPABCDAT,OTATR021,SP70
          PACK      OPABCTIM,OTATR022,SP70
          PACK      OPABUUID,OTATR023,SP70
          PACK      OPABUDAT,OTATR024,SP70
          PACK      OPABUTIM,OTATR025,SP70
          PACK      OPABFUID,OTATR026,SP70
          PACK      OPABFDAT,OTATR027,SP70
          PACK      OPABFTIM,OTATR028,SP70
          PACK      OPABCOD5,OTATR029,SP70
          PACK      OPABCOD6,OTATR030,SP70
          PACK      OPABYN05,OTATR031,SP70
          PACK      OPABYN06,OTATR032,SP70
          PACK      OPABYN07,OTATR033,SP70
          PACK      OPABYN08,OTATR034,SP70
          PACK      OPABYN09,OTATR035,SP70
          PACK      OPABYN10,OTATR036,SP70
          PACK      OPABUDD1,OTATR037,SP70
          PACK      OPABUDT1,OTATR038,SP70
.
          RETURN
+
.------------------------------------------------------------
.         Get the Coded Field (1-6) value for the specified 
.         Attribute Type (1-26).
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTTYPIND  Attribute Type index (1-26)
.           OTCODIND  Coded Field index (1-6)
.
.         Return:
.           OTCODVAL  Coded Field Value (DIM3)
.------------------------------------------------------------
GETOCV00  MOVE      SP70,OTCODVAL
          MOVE      SP70,OTATR002
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,GETOCV91
.
          LOAD      OTCODVAL,OTCODIND,OPABCOD1,OPABCOD2,OPABCOD3,OPABCOD4:
                             OPABCOD5,OPABCOD6
          GOTO      GETOCV90
.
.          BRANCH    OTCODIND,GETOCV21,GETOCV22,GETOCV23,GETOCV24,GETOCV25:
.                             GETOCV26
.          GOTO      GETACV91
.
.GETOCV21  MOVE      OPABCOD1,OTCODVAL
.          GOTO      GETOCV90
.
.GETOCV22  MOVE      OPABCOD2,OTCODVAL
.          GOTO      GETOCV90
.
.GETOCV23  MOVE      OPABCOD3,OTCODVAL
.          GOTO      GETOCV90
.
.GETOCV24  MOVE      OPABCOD4,OTCODVAL
.          GOTO      GETOCV90
.
.GETOCV25  MOVE      OPABCOD5,OTCODVAL
.          GOTO      GETOCV90
.
.GETOCV26  MOVE      OPABCOD6,OTCODVAL
.          GOTO      GETOCV90
.
GETOCV90  MOVE      ZERO,EXIT
          GOTO      GETOCV99
.
GETOCV91  MOVE      ONE,EXIT
GETOCV99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Coded Field (1-6) value for the specified 
.         Attribute Type (1-26).
.         If a record does not exist for the specified attribute type, a new 
.         record will be written to file.
.
.         Parameters:
.           OTATR001  U/R Number
.           OTATR002  Visit Number
.           OTTYPIND  Attribute Type index (1-26)
.           OTCODIND  Coded Field index (1-6)
.           OTCODVAL  Coded Field value (DIM3)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDOCV00  MOVE      SP70,OTATR002
          CALL      IBACLOCK
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
.         RJUSTIFY  OTCODVAL
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,UPDOCV91
.
          STORE     OTCODVAL,OTCODIND,OPABCOD1,OPABCOD2,OPABCOD3,OPABCOD4:
                             OPABCOD5,OPABCOD6
          GOTO      UPDOCV90
.
.          BRANCH    OTCODIND,UPDOCV21,UPDOCV22,UPDOCV23,UPDOCV24,UPDOCV25:
.                             UPDOCV26
.          GOTO      UPDOCV90
.
.UPDOCV21  MOVE      OTCODVAL,OPABCOD1
.          GOTO      UPDOCV90
.
.UPDOCV22  MOVE      OTCODVAL,OPABCOD2
.          GOTO      UPDOCV90
.
.UPDOCV23  MOVE      OTCODVAL,OPABCOD3
.          GOTO      UPDOCV90
.
.UPDOCV24  MOVE      OTCODVAL,OPABCOD4
.          GOTO      UPDOCV90
.
.UPDOCV25  MOVE      OTCODVAL,OPABCOD5
.          GOTO      UPDOCV90
.
.UPDOCV26  MOVE      OTCODVAL,OPABCOD6
.          GOTO      UPDOCV90
.
UPDOCV90  MOVE      USERID,OPABUUID
          PACK      OPABUDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABUDAT
          MOVE      CTIMEIS,OPABUTIM
          CALL      UPOPATR1
          MOVE      ZERO,EXIT
          GOTO      UPDOCV99
.
UPDOCV91  CALL      CLOPRATR
          MOVE      OTATR001,OPABUNIQ
          MOVE      OTATR002,OPABTYPE
          STORE     OTCODVAL,OTCODIND,OPABCOD1,OPABCOD2,OPABCOD3,OPABCOD4:
                                      OPABCOD5,OPABCOD6
          MOVE      USERID,OPABCUID
          PACK      OPABCDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABCDAT
          MOVE      CTIMEIS,OPABCTIM
.
          PACK      KEY13,OPABUNIQ,OPABTYPE,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WROPATR1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDOCV99
.
UPDOCV99  RETURN
+
.------------------------------------------------------------------------------
.         Get the Text Field (1-4) value for the specified Attribute Type (1-26)
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTTXTIND  Text Field index (1-4)
.
.         Return:
.           OTTXTVAL  Text Field Value (DIM80)
.------------------------------------------------------------------------------
GETTFO00  PACK      OTTXTVAL,SP70,SP70
          MOVE      SP70,OTATR002
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,GETTFO91
.
          LOAD      OTTXTVAL,OTTXTIND,OPABTXT1,OPABTXT2,OPABTXT3,OPABTXT4
          GOTO      GETTFO90
.
.          BRANCH    OTTXTIND,GETTFO21,GETTFO22,GETTFO23,GETTFO24
.          GOTO      GETTFO91
.
.GETTFO21  MOVE      OPABTXT1,OTTXTVAL
.          GOTO      GETTFO90
.
.GETTFO22  MOVE      OPABTXT2,OTTXTVAL
.          GOTO      GETTFO90
.
.GETTFO23  MOVE      OPABTXT3,OTTXTVAL
.          GOTO      GETTFO90
.
.GETTFO24  MOVE      OPABTXT4,OTTXTVAL
.          GOTO      GETTFO90
.
GETTFO90  MOVE      ZERO,EXIT
          GOTO      GETTFO99
.
GETTFO91  MOVE      ONE,EXIT
GETTFO99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Text Field (1-4) value for the specified 
.         Attribute Type (1-26); 
.         If a record does not exist for the specified attribute type, a new 
.         record will be written to file.
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTTXTIND  Text Field index (1-4)
.           OTTXTVAL  Text Field value (DIM80)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDOTV00  MOVE      SP70,OTATR002
          CALL      IBACLOCK
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,UPDOTV91
.
          STORE     OTTXTVAL,OTTXTIND,OPABTXT1,OPABTXT2,OPABTXT3,OPABTXT4
          GOTO      UPDOTV90
.
.          BRANCH    OTTXTIND,UPDOTV21,UPDOTV22,UPDOTV23,UPDOTV24
.          GOTO      UPDOTV90
.
.UPDOTV21  MOVE      OTTXTVAL,OPABTXT1
.          GOTO      UPDOTV90
.
.UPDOTV22  MOVE      OTTXTVAL,OPABTXT2
.          GOTO      UPDOTV90
.
.UPDOTV23  MOVE      OTTXTVAL,OPABTXT3
.          GOTO      UPDOTV90
.
.UPDOTV24  MOVE      OTTXTVAL,OPABTXT4
.          GOTO      UPDOTV90
.
UPDOTV90  MOVE      USERID,OPABUUID
          PACK      OPABUDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABUDAT
          MOVE      CTIMEIS,OPABUTIM
          CALL      UPOPATR1
          MOVE      ZERO,EXIT
          GOTO      UPDOTV99
.
UPDOTV91  CALL      CLOPRATR
          MOVE      OTATR001,OPABUNIQ
          MOVE      OTATR002,OPABTYPE
          STORE     OTTXTVAL,OTTXTIND,OPABTXT1,OPABTXT2,OPABTXT3,OPABTXT4
          PACK      OPABCDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABCDAT
          MOVE      CTIMEIS,OPABCTIM
          MOVE      USERID,OPABCUID
.
          PACK      KEY13,OPABUNIQ,OPABTYPE,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WROPATR1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDOTV99
.
UPDOTV99  RETURN
+
.------------------------------------------------------------
.         Get the Value Field (1-4) value for the specified
.         Attribute Type (1-26).
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTVALIND  Value Field index (1-4)
.
.         Return:
.           OTVALVAL  Value Field Value (DIM6)
.------------------------------------------------------------
GETOVV00  MOVE      SP70,OTVALVAL
          MOVE      SP70,OTATR002
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,GETOVV91
.
          LOAD      OTVALVAL,OTVALIND,OPABVAL1,OPABVAL2,OPABVAL3,OPABVAL4
          GOTO      GETOVV90
.
.          BRANCH    OTVALIND,GETOVV21,GETOVV22,GETOVV23,GETOVV24
.          GOTO      GETOVV91
.
.GETOVV21  MOVE      OPABVAL1,OTVALVAL
.          GOTO      GETOVV90
.
.GETOVV22  MOVE      OPABVAL2,OTVALVAL
.          GOTO      GETOVV90
.
.GETOVV23  MOVE      OPABVAL3,OTVALVAL
.          GOTO      GETOVV90
.
.GETOVV24  MOVE      OPABVAL4,OTVALVAL
.          GOTO      GETOVV90
.
GETOVV90  MOVE      ZERO,EXIT
          GOTO      GETOVV99
.
GETOVV91  MOVE      ONE,EXIT
GETOVV99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Value Field (1-4) value for the specified
.         Attribute Type (1-26); 
.         If a record does not exist for the specified attribute type, a new
.         record will be written to file.
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTVALIND  Coded Field index (1-4)
.           OTVALVAL  Coded Field value (DIM6)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDOVV00  MOVE      SP70,OTATR002
          CALL      IBACLOCK
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
.         RJUSTIFY  OTVALVAL
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,UPDOVV91
.
          STORE     OTVALVAL,OTVALIND,OPABVAL1,OPABVAL2,OPABVAL3,OPABVAL4
          GOTO      UPDOVV90
.
.          BRANCH    OTVALIND,UPDOVV21,UPDOVV22,UPDOVV23,UPDOVV24
.          GOTO      UPDOVV90
.
.UPDOVV21  MOVE      OTVALVAL,OPABVAL1
.          GOTO      UPDOVV90
.
.UPDOVV22  MOVE      OTVALVAL,OPABVAL2
.          GOTO      UPDOVV90
.
.UPDOVV23  MOVE      OTVALVAL,OPABVAL3
.          GOTO      UPDOVV90
.
.UPDOVV24  MOVE      OTVALVAL,OPABVAL4
.          GOTO      UPDOVV90
.
UPDOVV90  MOVE      USERID,OPABUUID
          PACK      OPABUDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABUDAT
          MOVE      CTIMEIS,OPABUTIM
          CALL      UPOPATR1
          MOVE      ZERO,EXIT
          GOTO      UPDOVV99
.
UPDOVV91  CALL      CLOPRATR
          MOVE      OTATR001,OPABUNIQ
          MOVE      OTATR002,OPABTYPE
          STORE     OTVALVAL,OTVALIND,OPABVAL1,OPABVAL2,OPABVAL3,OPABVAL4
          PACK      OPABCDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABCDAT
          MOVE      CTIMEIS,OPABCTIM
          MOVE      USERID,OPABCUID
.
          PACK      KEY13,OPABUNIQ,OPABTYPE,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WROPATR1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDOVV99
.
UPDOVV99  RETURN
+
.------------------------------------------------------------
.         Get the Yes No Field (1-10) value for the specified
.         Attribute Type (1-26).
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTYENIND  Value Field index (1-10)
.
.         Return:
.           OTYENVAL  Yesy No Field Value (DIM1)
.------------------------------------------------------------
GETOYN00  MOVE      SP70,OTYENVAL
          MOVE      SP70,OTATR002
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,GETOYN91
.
          LOAD      OTYENVAL,OTYENIND,OPABYN01,OPABYN02,OPABYN03,OPABYN04:
                                      OPABYN05,OPABYN06,OPABYN07,OPABYN08:
                                      OPABYN09,OPABYN10
          GOTO      GETOYN90
.
.          BRANCH    OTYENIND,GETOYN21,GETOYN22,GETOYN23,GETOYN24,GETOYN25:
.                             GETOYN26,GETOYN27,GETOYN28,GETOYN29,GETOYN30
.          GOTO      GETOYN91
.
.GETOYN21  MOVE      OPABYN01,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN22  MOVE      OPABYN02,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN23  MOVE      OPABYN03,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN24  MOVE      OPABYN04,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN25  MOVE      OPABYN05,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN26  MOVE      OPABYN06,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN27  MOVE      OPABYN07,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN28  MOVE      OPABYN08,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN29  MOVE      OPABYN09,OTYENVAL
.          GOTO      GETOYN90
.
.GETOYN30  MOVE      OPABYN10,OTYENVAL
.          GOTO      GETOYN90
.
GETOYN90  MOVE      ZERO,EXIT
          GOTO      GETOYN99
.
GETOYN91  MOVE      ONE,EXIT
GETOYN99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the Yes No Field (1-10) value for the specified
.         Attribute Type (1-26);
.         If a record does not exist for the specified attribute type, a new
.         record will be written to file.
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTYENIND  Coded Field index (1-10)
.           OTYENVAL  Coded Field value (DIM1)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDOYN00  MOVE      SP70,OTATR002
          CALL      IBACLOCK
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
.         RJUSTIFY  OTYENVAL
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,UPDOYN91
.
          STORE     OTYENVAL,OTYENIND,OPABYN01,OPABYN02,OPABYN03,OPABYN04:
                                      OPABYN05,OPABYN06,OPABYN07,OPABYN08:
                                      OPABYN09,OPABYN10
          GOTO      UPDOYN90
.
.          BRANCH    OTYENIND,UPDOYN21,UPDOYN22,UPDOYN23,UPDOYN24,UPDOYN25:
.                             UPDOYN26,UPDOYN27,UPDOYN28,UPDOYN29,UPDOYN30
.          GOTO      UPDOYN90
.
.UPDOYN21  MOVE      OTYENVAL,OPABYN01
.          GOTO      UPDOYN90
.
.UPDOYN22  MOVE      OTYENVAL,OPABYN02
.          GOTO      UPDOYN90
.
.UPDOYN23  MOVE      OTYENVAL,OPABYN03
.          GOTO      UPDOYN90
.
.UPDOYN24  MOVE      OTYENVAL,OPABYN04
.          GOTO      UPDOYN90
.
.UPDOYN25  MOVE      OTYENVAL,OPABYN05
.          GOTO      UPDOYN90
.
.UPDOYN26  MOVE      OTYENVAL,OPABYN06
.          GOTO      UPDOYN90
.
.UPDOYN27  MOVE      OTYENVAL,OPABYN07
.          GOTO      UPDOYN90
.
.UPDOYN28  MOVE      OTYENVAL,OPABYN08
.          GOTO      UPDOYN90
.
.UPDOYN29  MOVE      OTYENVAL,OPABYN09
.          GOTO      UPDOYN90
.
.UPDOYN30  MOVE      OTYENVAL,OPABYN10
.          GOTO      UPDOYN90
.
UPDOYN90  MOVE      USERID,OPABUUID
          PACK      OPABUDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABUDAT
          MOVE      CTIMEIS,OPABUTIM
          CALL      UPOPATR1
          MOVE      ZERO,EXIT
          GOTO      UPDOYN99
.
UPDOYN91  CALL      CLOPRATR
          MOVE      OTATR001,OPABUNIQ
          MOVE      OTATR002,OPABTYPE
          STORE     OTYENVAL,OTYENIND,OPABYN01,OPABYN02,OPABYN03,OPABYN04:
                                      OPABYN05,OPABYN06,OPABYN07,OPABYN08:
                                      OPABYN09,OPABYN10
          PACK      OPABCDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABCDAT
          MOVE      CTIMEIS,OPABCTIM
          MOVE      USERID,OPABCUID
.
          PACK      KEY13,OPABUNIQ,OPABTYPE,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WROPATR1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDOYN99
.
UPDOYN99  RETURN
+
.------------------------------------------------------------
.         Get the User Define Date Field (1) value for the specified
.         Attribute Type (1-26).
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTDATIND  User Defined Date index (1)
.
.         Return:
.           OTDATVAL  User Defined Field Value (DIM8)
.------------------------------------------------------------
GETODT00  MOVE      SP70,OTDATVAL
          MOVE      SP70,OTATR002
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,GETODT91
.
          LOAD      OTDATVAL,OTDATIND,OPABUDD1
          GOTO      GETODT90
.
.          BRANCH    OTDATIND,GETODT21
.          GOTO      GETODT91
.
.GETODT21  MOVE      OPABUDD1,OTDATVAL
.          GOTO      GETODT90
.
GETODT90  MOVE      ZERO,EXIT
          GOTO      GETODT99
.
GETODT91  MOVE      ONE,EXIT
GETODT99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the User Defined Date Field (1) value for the specified
.         Attribute Type (1-26);
.         If a record does not exist for the specified attribute type, a new
.         record will be written to file.
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTDATIND  User Defined Date Field index (1)
.           OTDATVAL  User Defined Date Field value (DIM8)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDODT00  MOVE      SP70,OTATR002
          CALL      IBACLOCK
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
.         RJUSTIFY  OTDATVAL
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,UPDODT91
.
          STORE     OTDATVAL,OTDATIND,OPABUDD1
          GOTO      UPDODT90
.
.          BRANCH    OTDATIND,UPDODT21
.          GOTO      UPDODT90
.
.UPDODT21  MOVE      OTDATVAL,OPABUDD1
.          GOTO      UPDODT90
.
UPDODT90  MOVE      USERID,OPABUUID
          PACK      OPABUDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABUDAT
          MOVE      CTIMEIS,OPABUTIM
          CALL      UPOPATR1
          MOVE      ZERO,EXIT
          GOTO      UPDODT99
.
UPDODT91  CALL      CLOPRATR
          MOVE      OTATR001,OPABUNIQ
          MOVE      OTATR002,OPABTYPE
          STORE     OTDATVAL,OTDATIND,OPABUDD1
          PACK      OPABCDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABCDAT
          MOVE      CTIMEIS,OPABCTIM
          MOVE      USERID,OPABCUID
.
          PACK      KEY13,OPABUNIQ,OPABTYPE,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WROPATR1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDODT99
.
UPDODT99  RETURN
+
.------------------------------------------------------------
.         Get the User Define Time Field (1) value for the specified
.         Attribute Type (1-26).
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTTIMIND  User Defined Time index (1)
.
.         Return:
.           OTTIMVAL  User Defined Time Field Value (DIM8)
.------------------------------------------------------------
GETOTM00  MOVE      SP70,OTTIMVAL
          MOVE      SP70,OTATR002
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,GETOTM91
.
          LOAD       OTTIMVAL,OTTIMIND,OPABUDT1
          GOTO       GETOTM90
.
.          BRANCH    OTTIMIND,GETOTM21
.          GOTO      GETOTM91
.
.GETOTM21  MOVE      OPABUDT1,OTTIMVAL
.          GOTO      GETOTM90
.
GETOTM90  MOVE      ZERO,EXIT
          GOTO      GETOTM99
.
GETOTM91  MOVE      ONE,EXIT
GETOTM99  RETURN
+
.------------------------------------------------------------------------------
.         Updates the User Defined Time Field (1) value for the specified
.         Attribute Type (1-26);
.         If a record does not exist for the specified attribute type, a new
.         record will be written to file.
.
.         Parameters:
.           OTATR001  Theatre Unique ID
.           OTATR002  Type of Attribute
.           OTTYPIND  Attribute Type index (1-26)
.           OTTIMIND  User Defined Time Field index (1)
.           OTTIMVAL  User Defined Time Field value (DIM8)
.
.         Return:
.           EXIT      0-Updated, 1-Added
.------------------------------------------------------------------------------
UPDOTM00  MOVE      SP70,OTATR002
          CALL      IBACLOCK
.
          LOAD      OTATR002,OTTYPIND,OTYPE001,OTYPE002,OTYPE003,OTYPE004:
                                      OTYPE005,OTYPE006,OTYPE007,OTYPE008:
                                      OTYPE009,OTYPE010,OTYPE011,OTYPE012:
                                      OTYPE013,OTYPE014,OTYPE015,OTYPE016:
                                      OTYPE017,OTYPE018,OTYPE019,OTYPE020:
                                      OTYPE021,OTYPE022,OTYPE023,OTYPE024:
                                      OTYPE025,OTYPE026
.
.         RJUSTIFY  OTTIMVAL
.
          PACK      KEY13,OTATR001,OTATR002,SP70
          CALL      RDOPATR1
          BRANCH    OVRCD,UPDOTM91
.
          STORE     OTTIMVAL,OTTIMIND,OPABUDT1
.
.          BRANCH    OTTIMIND,UPDOTM21
.          GOTO      UPDOTM90
.
.UPDOTM21  MOVE      OTTIMVAL,OPABUDT1
.          GOTO      UPDOTM90
.
UPDOTM90  MOVE      USERID,OPABUUID
          PACK      OPABUDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABUDAT
          MOVE      CTIMEIS,OPABUTIM
          CALL      UPOPATR1
          MOVE      ZERO,EXIT
          GOTO      UPDOTM99
.
UPDOTM91  CALL      CLOPRATR
          MOVE      OTATR001,OPABUNIQ
          MOVE      OTATR002,OPABTYPE
          STORE     OTTIMVAL,OTTIMIND,OPABUDT1
          PACK      OPABCDAT,CCC,CYY,CMM,CDD
          REP       " 0",OPABCDAT
          MOVE      CTIMEIS,OPABCTIM
          MOVE      USERID,OPABCUID
.
          PACK      KEY13,OPABUNIQ,OPABTYPE,SP70
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WROPATR1
          TRAPCLR   IO
          MOVE      ONE,EXIT
          GOTO      UPDOTM99
.
UPDOTM99  RETURN
+

