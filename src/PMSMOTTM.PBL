. *-----------------------------------------------------------------------------
. * Include Name  :  PMSMOTTM.PBL
. *
. * Function      :  CGI Variables for PMSMOTFD - pmsmotaf
. *
. * Mods          :  V10.03.00 15/03/2012 Patrick Adair     CAR 257776
. *                            Created include
. *-----------------------------------------------------------------------------
.-------------------------------------------------------------------------------
. Clear Motor Assessment Scale Parameters
.-------------------------------------------------------------------------------
CPPMMA00  MOVE      Z70,PMMOT001
          MOVE      Z70,PMMOT002
          MOVE      Z70,PMMOT003
          MOVE      Z70,PMMOT004
          MOVE      Z70,PMMOT005
          MOVE      Z70,PMMOT006
          MOVE      Z70,PMMOT007
          MOVE      Z70,PMMOT008
          MOVE      Z70,PMMOT009
          MOVE      Z70,PMMOT010
          MOVE      Z70,PMMOT011
.
CPPMMA99  RETURN
.
.-------------------------------------------------------------------------------
. Set Motor Assessment Scale Parameters
.-------------------------------------------------------------------------------
SPPMMA00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMMA01,SPPMMA02,SPPMMA03,SPPMMA04,SPPMMA05:
                       SPPMMA06,SPPMMA07,SPPMMA08,SPPMMA09,SPPMMA10:
                       SPPMMA11
          GOTO      SPPMMA99
.
SPPMMA01  PACK      PMMOT001,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMMOT002,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMMA99
.
SPPMMA03  PACK      PMMOT003,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA04  PACK      PMMOT004,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA05  PACK      PMMOT005,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA06  PACK      PMMOT006,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA07  PACK      PMMOT007,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA08  PACK      PMMOT008,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA09  PACK      PMMOT009,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA10  PACK      PMMOT010,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA11  PACK      PMMOT011,QRYDATA,SP70
          GOTO      SPPMMA99
.
SPPMMA99  RETURN
.
.-------------------------------------------------------------------------------
. Output Motor Assessment Scale tags
.-------------------------------------------------------------------------------
PMMA0000  BRANCH    FLDITMNO,PMMA0100,PMMA0200,PMMA0300,PMMA0400,PMMA0500:
                             PMMA0600,PMMA0700,PMMA0800,PMMA0900,PMMA1000:
                             PMMA1100,PMMA1200,PMMA1300,PMMA1400
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMMA9999
.
PMMA0100  WRITE     HTMLFILE;PMMAVISN;
          GOTO      PMMA9999
.
PMMA0200  MATCH     PMMAADAT,SP70
          GOTO      PMMA9999 IF EQUAL
          UNPACK    PMMAADAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMMA9999
.
PMMA0300  WRITE     HTMLFILE;PMMAATIM;
          GOTO      PMMA9999
.
PMMA0400  WRITE     HTMLFILE;PMMASUSL;
          GOTO      PMMA9999
.
PMMA0500  WRITE     HTMLFILE;PMMASUSI;
          GOTO      PMMA9999
.
PMMA0600  WRITE     HTMLFILE;PMMABASI;
          GOTO      PMMA9999
.
PMMA0700  WRITE     HTMLFILE;PMMASIST;
          GOTO      PMMA9999
.
PMMA0800  WRITE     HTMLFILE;PMMAWALK;
          GOTO      PMMA9999
.
PMMA0900  WRITE     HTMLFILE;PMMAUARM;
          GOTO      PMMA9999
.
PMMA1000  WRITE     HTMLFILE;PMMAHMOV;
          GOTO      PMMA9999
.
PMMA1100  WRITE     HTMLFILE;PMMAAHAN;
          GOTO      PMMA9999
.
PMMA1200  WRITE     HTMLFILE;VISITDTE;
          GOTO      PMMA9999
.
PMMA1300  WRITE     HTMLFILE;VISITTME;
          GOTO      PMMA9999
.
PMMA1400  CALL      ACMHTM00
          GOTO      PMMA9999
.
PMMA9999  RETURN
.
.-------------------------------------------------------------------------------
. Move Motor Assessment Scale cgi variables to file variables
.-------------------------------------------------------------------------------
MVPMMA00  MATCH     Z70,ADMISSNO
          IF        !@EQUAL
            MOVE      ADMISSNO,PMMAVISN
          ENDIF
.
          MATCH     Z70,PMMOT002
          IF        !@EQUAL
            MOVE      PMMOT002,PMMAADAT
          ENDIF
.
          MATCH     Z70,PMMOT003
          IF        !@EQUAL
            MOVE      PMMOT003,PMMAATIM
          ENDIF
.
          MATCH     Z70,PMMOT004
          IF        !@EQUAL
            MOVE      PMMOT004,PMMASUSL
          ENDIF
.
          MATCH     Z70,PMMOT005
          IF        !@EQUAL
            MOVE      PMMOT005,PMMASUSI
          ENDIF
.
          MATCH     Z70,PMMOT006
          IF        !@EQUAL
            MOVE      PMMOT006,PMMABASI
          ENDIF
.
          MATCH     Z70,PMMOT007
          IF        !@EQUAL
            MOVE      PMMOT007,PMMASIST
          ENDIF
.
          MATCH     Z70,PMMOT008
          IF        !@EQUAL
            MOVE      PMMOT008,PMMAWALK
          ENDIF
.
          MATCH     Z70,PMMOT009
          IF        !@EQUAL
            MOVE      PMMOT009,PMMAUARM
          ENDIF
.
          MATCH     Z70,PMMOT010
          IF        !@EQUAL
            MOVE      PMMOT010,PMMAHMOV
          ENDIF
.
          MATCH     Z70,PMMOT011
          IF        !@EQUAL
            MOVE      PMMOT011,PMMAAHAN
          ENDIF
.
MVPMMA99  RETURN
.
.-------------------------------------------------------------------------------
. Clear Motor Assessment Scale file variables
.-------------------------------------------------------------------------------
CLPMMA00  MOVE      SP70,PMMAVISN
          MOVE      SP70,PMMAADAT
          MOVE      SP70,PMMAATIM
          MOVE      SP70,PMMASUSL
          MOVE      SP70,PMMASUSI
          MOVE      SP70,PMMABASI
          MOVE      SP70,PMMASIST
          MOVE      SP70,PMMAWALK
          MOVE      SP70,PMMAUARM
          MOVE      SP70,PMMAHMOV
          MOVE      SP70,PMMAAHAN
          MOVE      SP70,PMMACDAT
          MOVE      SP70,PMMACTIM
          MOVE      SP70,PMMACUID
          MOVE      SP70,PMMAUDAT
          MOVE      SP70,PMMAUTIM
          MOVE      SP70,PMMAUUID
.
CLPMMA99  RETURN
