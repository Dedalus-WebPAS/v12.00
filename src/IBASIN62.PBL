.--------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.--------------------------------------------------------------------------
. V9.04.01  19/09/2005  Mike Laming   CAR 68672
.           Add Datamax E-class Barcode Printer - controlled by SNCOBCPN
. V9.02.01  19.03.2003 Tonii Tang SRF 12580 (Rebound)
.           Re-added the below changes via Program Generator
.--------------------------------------------------------------------------
. VF.09.03  11.04.2002 Tonii Tang SRF 12580 (Rebound)
.           Fixed check on START to FINISH print confirmation
. VF.09.02  14.02.2002 Tonii Tang SRF 12580 (Quote No: 10239-01)
.           Include new parameter SNCOSFYN - Confirm START to FINISH print
.           Checked new parameter, display appropriate message if applicable
. VF.09.B01 23.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.02  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
. VF.01.01  12.10.2000 Sandra Barcham
.           Removed IBABATFD & IBABATIO as not required
.--------------------------------------------------------------------------
. VF.00.05  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.04  16.11.1999 Sandra Barcham
.           Fix rack & shelf range and warehouse
. VF.00.03  03.11.1999 Sandra Barcham
.           Change locked message to use X
. VF.00.02  06.07.1999 Sandra Barcham
.           Recompiled for version change
. VF.00.01  06.07.1999 Sandra Barcham
.           Use file to translate barcode codes
.--------------------------------------------------------------------------
$BON3     DIM       15            * octal variables
$BON4     DIM       15
$BON5     DIM       15
$BOFF1    DIM       3
RET       INIT      015
STX       INIT      02
.
LABID     DIM       17
LABLINE1  DIM       40
LABLINE2  DIM       40
.
STRRAS    DIM       8
ENDRAS    DIM       8
STRCAT    DIM       7
ENDCAT    DIM       7
STRCST    DIM       5
ENDCST    DIM       5
STRIMP    DIM       4
ENDIMP    DIM       4
.
CALFORM7  FORM      7
CKEYTYPE  FORM      1
CKEYSTCK  DIM       1
SHTOP     FORM      2
SHBOT     FORM      2
SHLEF     FORM      3
SHRIG     FORM      3
SST1      DIM       67
SST2      DIM       67
SST3      DIM       67
SST4      DIM       67
SST5      DIM       67
SST6      DIM       67
SST7      DIM       67
SST8      DIM       67
SST9      DIM       67
SST10     DIM       67
SST11     DIM       67
SST12     DIM       67
SST13     DIM       67
SST14     DIM       67
SST15     DIM       67
SST16     DIM       67
SST17     DIM       67
XTOP      FORM      2
XBOT      FORM      2
XLEF      FORM      3
XRIG      FORM      3
DIM30A    DIM       30
DIM30B    DIM       30
START     INIT      "Start"
FINISH    INIT      "Finish"
.                                           * Datamax E-class variables
BARFMAT   DIM       7
DMAXSET   FORM      1
LABNUM    DIM       3
TXTFMAT   DIM       7
.
ISBUILD   INIT      "isbuild "
SITMKEY   INIT      " 21 UC1-5,6-13,14-20"
SINTMPA1  IFILE     SQL, FIXED=21, KEY="U1-5,6-13,14-20"
SITMWAR   DIM       5      1
SITMRAS   DIM       8      6
SITMCAT   DIM       7      14
.                          21
.--------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN62
.   Function      :   Supply & Inventory Barcode Labels       
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       IBAPRNFD/INC
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIEFD/INC
          INC       SINCIFFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINIMPFD/INC
          INC       SINNATFD/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMCST   DIM      45 * Scr 01 Fld     4
TOCST     DIM      45 * Scr 01 Fld     5
NOLABELS  FORM      2 * Scr 01 Fld     6
IMPONLY   FORM      1 * Scr 01 Fld     7
LABELFMT  FORM      3 * Scr 01 Fld     8
DESCFMT   DIM      30 * Scr 01 Fld     9
FROMCAT   DIM      45 * Scr 02 Fld     7
TOCAT     DIM      45 * Scr 02 Fld     8
FROMIMP   DIM      10 * Scr 02 Fld     9
TOIMP     DIM      10 * Scr 02 Fld    10
INCLTYPE  FORM      1 * Scr 03 Fld    11
INCLDESC  DIM      30 * Scr 03 Fld    12
IGSUSP    FORM      1 * Scr 03 Fld    13
REPTSEQ   FORM      1 * Scr 03 Fld    14
SEQDESC   DIM      20 * Scr 03 Fld    15
FROMRAS   DIM       8 * Scr 03 Fld    18
TORAS     DIM       8 * Scr 03 Fld    19
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN62"
PRGNAM    INIT      "Supply & Inventory Barcode Labels       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA1,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA2,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA3,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Menu                               
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Cost Centre Labels                 
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Catalog Imprest Labels             
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Catalog Labels                     
          ENDIF
          RETURN
.--------------------------------
. Screen - Menu                               
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Menu                               
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Menu                               
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Menu                               
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Menu                               
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Menu                               
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Menu                               
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Menu                               
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      LINUP000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Cost Centre Labels                 
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      DEFPAR00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Centre Labels                 
.-------------------------------------------------------
CF01L000
          MOVE      SP70,FROMCST 
          MOVE      SP70,TOCST   
          MOVE      ZERO,NOLABELS
          MOVE      ZERO,IMPONLY 
          MOVE      ZERO,LABELFMT
          MOVE      SP70,DESCFMT 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Centre Labels                 
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Centre Labels                 
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Centre Labels                 
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Centre Labels                 
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Centre Labels                 
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104,PS01L105:
                            PS01L106
          GOTO     PS01L999
.
PS01L101
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      TOCST,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      NOLABELS,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPONLY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      LABELFMT,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Centre Labels                 
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L104,SF01L105,SF01L106:
                            SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020,SF01L104,SF01L105,SF01L106:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      LABA0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCST   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCST,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,NOLABELS
          IF        SCPSMAN=1
            COMPARE   ZERO,NOLABELS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
          ENDIF
          MOVE      NOLABELS,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPONLY 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPONLY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELABF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      LABELFMT,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Catalog Imprest Labels             
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      DEFPAR00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog Imprest Labels             
.-------------------------------------------------------
CF02L000
          MOVE      SP70,FROMCST 
          MOVE      SP70,TOCST   
          MOVE      ZERO,NOLABELS
          MOVE      SP70,FROMCAT 
          MOVE      SP70,TOCAT   
          MOVE      SP70,FROMIMP 
          MOVE      SP70,TOIMP   
          MOVE      ZERO,LABELFMT
          MOVE      SP70,DESCFMT 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog Imprest Labels             
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog Imprest Labels             
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog Imprest Labels             
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog Imprest Labels             
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog Imprest Labels             
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104,PS02L105:
                            PS02L106,PS02L107,PS02L108,PS02L109
          GOTO     PS02L999
.
PS02L101
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      TOCST,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      NOLABELS,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      FROMCAT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      TOCAT,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      FROMIMP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      TOIMP,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      LABELFMT,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog Imprest Labels             
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L104,SF02L105,SF02L006:
                            SF02L106,SF02L006,SF02L107,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L020,SF02L104,SF02L105,SF02L020:
                            SF02L106,SF02L020,SF02L107,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      LABB0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCST   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCST,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,NOLABELS
          IF        SCPSMAN=1
            COMPARE   ZERO,NOLABELS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
          ENDIF
          MOVE      NOLABELS,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCAT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCATA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMCAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCAT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L106
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOIMP   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RISEQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
            BRANCH    EXIT,SF02L106,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMIMP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOIMP,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L107
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELABF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L107
            ENDIF
            BRANCH    EXIT,SF02L107,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      LABELFMT,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Catalog Labels                     
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      DEFPAR00
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog Labels                     
.-------------------------------------------------------
CF03L000
          MOVE      ZERO,NOLABELS
          MOVE      SP70,FROMCAT 
          MOVE      SP70,TOCAT   
          MOVE      SP70,SIWAWAR 
          MOVE      SP70,SIWADES 
          MOVE      ZERO,INCLTYPE
          MOVE      SP70,INCLDESC
          MOVE      ZERO,IGSUSP  
          MOVE      ZERO,REPTSEQ 
          MOVE      SP70,SEQDESC 
          MOVE      ZERO,LABELFMT
          MOVE      SP70,DESCFMT 
          MOVE      SP70,FROMRAS 
          MOVE      SP70,TORAS   
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog Labels                     
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog Labels                     
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog Labels                     
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog Labels                     
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog Labels                     
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L101,PS03L102,PS03L103:
                            PS03L104,PS03L105,PS03L106,PS03L107:
                            PS03L108,PS03L109,PS03L110,PS03L111:
                            PS03L112,PS03L113,PS03L114
          GOTO     PS03L999
.
PS03L101
          MOVE      NOLABELS,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      FROMCAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      TOCAT,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SIWAWAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      INCLTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      INCLDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IGSUSP,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      SEQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      LABELFMT,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      FROMRAS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      TORAS,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog Labels                     
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L006:
                           SF03L006,SF03L103,SF03L104,SF03L006:
                            SF03L105,SF03L006,SF03L106,SF03L006:
                            SF03L107,SF03L108,SF03L006,SF03L109:
                            SF03L006,SF03L110,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L103,SF03L104,SF03L020:
                            SF03L105,SF03L020,SF03L106,SF03L020:
                            SF03L107,SF03L108,SF03L020,SF03L109:
                            SF03L020,SF03L110,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      LABC0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,NOLABELS
          IF        SCPSMAN=1
            COMPARE   ZERO,NOLABELS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
          ENDIF
          MOVE      NOLABELS,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCAT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCATA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMCAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCAT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L105
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIWSA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
            BRANCH    EXIT,SF03L105,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIWAWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,INCLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EINCL000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L106
            ENDIF
            BRANCH    EXIT,SF03L106,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      INCLTYPE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      INCLDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L107
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IGSUSP  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IGSUSP,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SEQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRSEQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L108
            ENDIF
            BRANCH    EXIT,SF03L108,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SEQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L109
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELABF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
            BRANCH    EXIT,SF03L109,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      LABELFMT,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L110
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TORAS   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RRAS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L110
            ENDIF
            BRANCH    EXIT,SF03L110,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMRAS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TORAS,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.------------------------------------------------------------
. Print Label Line Up Print
.------------------------------------------------------------
LINUP000
LINUP999   RETURN
.------------------------------------------------------------
. Setup Default Parameters
.------------------------------------------------------------
DEFPAR00  MOVE     "Start",FROMCST
          MOVE     "Start",FROMCAT
          MOVE     "Start",FROMIMP
          MOVE     "Start",FROMRAS
          MOVE     "Finish",TOIMP
          MOVE     "Finish",TOCST
          MOVE     "Finish",TOCAT
          MOVE     "Finish",TORAS
          MOVE     "1",NOLABELS
          MOVE     "1",IMPONLY
          MOVE     SP70,STRIMP
          MOVE     SP70,STRCAT
          MOVE     SP70,STRCST
          MOVE     SP70,STRRAS
          MOVE     Z70,ENDIMP
          MOVE     Z70,ENDCAT
          MOVE     Z70,ENDCST
          MOVE     Z70,ENDRAS
          MOVE     ZERO,ACCEPT
          MOVE     SP70,SIWAWAR
          MOVE     "All",SIWADES,STRCST
          MOVE     ONE,IGSUSP
          MOVE     ZERO,INCLTYPE
          MOVE     "All Catalogs",INCLDESC
          MOVE     "1",REPTSEQ
          MOVE     "Catalog Code",SEQDESC
          MOVE      ONE,LABELFMT
          MOVE      "114mm X 16mm",DESCFMT
.
.******************************************** start of addition        *I-68672
          MOVE      ZERO,DMAXSET
          READ      CONTROLF,SIXTY3;*243,SNCOBCPN
          COMPARE   ZERO,SNCOBCPN
          GOTO      DEFPAR99 IF EQUAL
          MOVE      ONE,LABELFMT
          MOVE      "Datamax E-Class",DESCFMT
.******************************************** start of addition        *I-68672
.
DEFPAR99  RETURN
.
.******************************************** start of addition        *I-68672
.******************************************************************************
.*                              DMAX0000
.*                     Datamax Barcode Printer initialisation
.*
.*        initilize the bar code characteristics for Datamax E-class (Std)
.*        the string is made up of the following characters :-
.*        <STX>L  - (Ctrl-B)L - Begin Label
.*        D11     - Label header record - set width & dot multipliers (1 & 1)
.*        PK      - set print speed (152 dots/sec)
.*        pE      - set backfeed speed
.*        SK      - set slew speed  (152 dots/sec default)
.*        A2      - set format attribute  (2=Transparent mode)
.*        <STX>ySW1 - set font symbol set "W1" (doesn't seem to do much)
.*        Qnnnn   - set no. of labels where "nnnn" to be zero filled
.*        E       - terminate record
.*
.*    For actual print lines, see further below for BARFMAT & TXTFMAT as set
.*    for the following sample "PRINT" statements -
.*                             __________________* Vert. (Inch/100 from bot.Left
.*                            |       ___________* Horiz.(Inch/100 from bot.left
.*                            |      |
.*        PRINT     BARFMAT,"0120","0020",BARSTRNG    * print Barcode
.*        PRINT     TXTFMAT,"0095","0020",LBLLEFT1,*N:
.*                  TXTFMAT,"0095","0190",LBLLEFT2,*N:
.*
.*        NOTE - each command to be terminated with <CR> (or "PRINT *N")
.******************************************************************************
DMAX0000  MOVE      ZERO,EXIT
          PACK      BARFMAT,ONE:                      * set rotation
                            ANSA:                     * set font (A=Barcode)
                            SEVEN:                    * set width multiplier
                            TWO:                      * set height multiplier
                            ZERO,FIVE,ZERO            * set  barcode height
.
          PACK      TXTFMAT,ONE:                      * set rotation
                            THREE:                    * set font (3=Courier New)
                            ONE:                      * set width multiplier
                            ONE:                      * set height multiplier
                            ZERO,ZERO,ZERO            * set scalable font
.
          MOVE      ONE,DMAXSET
.
DMAX9999  RETURN
.********************************************   end of addition        *I-68672
.------------------------------------------------------------
. Print Cost Centre Labels
.------------------------------------------------------------
LABA0000  DISPLAY   *P1:24,*EL,"Printing ...";
          MOVE      ZERO,CPAGENO          * reset page no.
          CLOCK     TIME,CTIMEIS          * get current time
          MOVE      "99",CLNO             * init last line number
          MOVE      ZERO,SECTOR           * Counter
.
          PACK      KEY5,STRCST,SP70
          CALL      RDSICA1
          IF        OVRCD=0
            CALL      RPSICA1
          ENDIF
LABA1000  CALL      RKSICA1
          BRANCH    OVRCD,LABA9000
          MATCH     SICACODE,ENDCST
          GOTO      LABA9000 IF LESS
          COMPARE   ONE,IMPONLY           * Print Imprest CC Only 1=Yes
          GOTO      LABA1100 IF NOT EQUAL
          MATCH     "0000000",SICAIMPD    * Must have Imprest on at least 1 day
          GOTO      LABA1000 IF EQUAL
.
LABA1100  ADD       ONE,SECTOR
          IF        (SECTOR%50=0)
            DISPLAY   *P20:24,*V2LON,SECTOR,"/",SICACODE
          ENDIF
          MOVE      ZERO,CLNO
          REPEAT
            ADD       ONE,CLNO
            CALL      PLINE000      * Print Label
          UNTIL     NOLABELS=CLNO
          GOTO      LABA1000
.
LABA9000  CLEAR     KEY80
          APPEND    "ibasin62.us1 ",KEY80
          APPEND    SPLFILE,KEY80
          RESET     KEY80
          MOVE      ZERO,HLEF
          CALL      GETSCR00
.
          EXECUTE   KEY80,TASKID
.
          CALL      PUTSCR00
.
LABA9999  RETURN
.------------------------------------------------------------
. Print Bar Code
. Cost Centre    : SICACODE
. Description    : SICADESC
.------------------------------------------------------------
PLINE000  MOVE      ONE,EXIT
          BRANCH    SNCOBCPN,PLINE100      * printer is Datamax
          BRANCH    LABELFMT,PLINE010,PLINE020,PLINE030
.
. 114mm X 16mm
PLINE010  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
.
          PRINT     "^FO1,20";             * Field Origins
          PRINT     "^BCR,75,N,,";         * Bar Code Type 128 Height 90
          PRINT     "^FD",SICACODE,"^FS"   * Field Data for Bar Code
.
          PRINT     "^FO0,220";            * Field Origins Relative to Home
          PRINT     "^A0R,40,20";          * Field Origins Relative to Home
          PRINT     "^FD",SICADESC,"^FS"   * Field Data (Description)
.
          PRINT     "^FO35,220";           * Field Origins Relative to Home
          PRINT     "^A0R,40,20";          * Field Origins Relative to Home
          PRINT     "^FDC/C : ",SICACODE,"^FS"   * Data (Code)
          PRINT     "^XZ"                  * End of Label Format
.
          GOTO      PLINE999
.
. 23mm X 85mm
.
PLINE020  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
.
          PRINT     "^FO10,20";            * Field Origins
          PRINT     "^BCN,120,Y,,";        * Bar Code Type 128 Height 90
          PRINT     "^FD",SICACODE,"^FS"   * Field Data for Bar Code
.
          PRINT     "^FO205,20";           * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",SICADESC,"^FS"   * Field Data (Description)
.
          PRINT     "^FO205,70";           * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FDC/C : ",SICACODE,"^FS"   * Data (Code)
          PRINT     "^XZ"                  * End of Label Format
.
          GOTO      PLINE999
.
. 16mm X 114mm
.
PLINE030  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
.
          PRINT     "^FO1,20";             * Field Origins
          PRINT     "^BCN,75,N,,";         * Bar Code Type 128 Height 90
          PRINT     "^FD",SICACODE,"^FS"   * Field Data for Bar Code
.
          PRINT     "^FO0,220";            * Field Origins Relative to Home
          PRINT     "^A0N,40,20";          * Field Origins Relative to Home
          PRINT     "^FD",SICADESC,"^FS"   * Field Data (Description)
.
          PRINT     "^FO35,220";           * Field Origins Relative to Home
          PRINT     "^A0N,40,20";          * Field Origins Relative to Home
          PRINT     "^FDC/C : ",SICACODE,"^FS"   * Data (Code)
          PRINT     "^XZ"                  * End of Label Format
.
          GOTO      PLINE999
.
.******************************************* start of addition         *I-68672
PLINE100  BRANCH    DMAXSET,PLINE110
          CALL      DMAX0000               * Start Datamax labels
          MOVE      ONE,DMAXSET
.
PLINE110  MOVE      ZERO,EXIT
          PRINT     STX,ANSL,*N:                      * Start
                    "D11",*N:                         * Set width & dot size
                    "PK",*N:                          * Set print speed
                    "pE",*N:                          * set backfeed speed
                    "SK",*N:                          * Set slew speed
                    "A2"                              * set format attribute
.
.                              __________________* Vert. (Inch/100 from bot.Left
.                             |       ___________* Horiz.(Inch/100 from bot.left
.                             |      |
          PRINT     BARFMAT,"0120","0020",SICACODE    * print Catalogue Barcode
.
.                                                     * Line 1
.                              __________________* Vert. (Inch/100 from bot.Left
.                             |       ___________* Horiz.(Inch/100 from bot.left
.                             |      |
          PRINT     TXTFMAT,"0095","0020",SICADESC
.                                                     * Line 2
          PRINT     TXTFMAT,"0065","0020","C/C : ",SICADESC
.                                                     * Line 3
.
.                                                     * Line 4
.
          MOVE      NOLABELS,CLNO           * force loop end
          MOVE      CLNO,LABNUM
          REP       " 0",LABNUM
          PRINT     "Q0",LABNUM,*N:                   * set no. of labels
                    ANSE                              * terminate record
.
          GOTO      PLINE999
.*******************************************   end of addition         *I-68672
.
PLINE999  RETURN
.
.------------------------------------------------------------
. Input Cost Centre Range
.------------------------------------------------------------
RCOST000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           CALL     KSICAA00
           BRANCH   EXIT,RCOST100,RCOST999
           MOVE     SICACODE,STRCST
           PACK     FROMCST,SICACODE,SP1,SICADESC
           GOTO     RCOST140
.
RCOST100   MOVE     "Start             ",FROMCST
           MOVE     SP70,STRCST
.
RCOST140   MOVE     FROMCST,VAR
           CALL     DISPITEM
.
RCOST150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           CALL     KSICAA00
           BRANCH   EXIT,RCOST200,RCOST999
           MOVE     SICACODE,ENDCST
           PACK     TOCST,SICACODE,SP1,SICADESC
           MATCH    STRCST,ENDCST
           GOTO     RCOST999 IF EQUAL
           GOTO     RCOST999 IF NOT LESS
           BEEP
           MOVE     "To Cost Centre Must Be > From Cost Centre - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCOST000
.
RCOST200   MOVE     "Finish             ",TOCST
           MOVE     "~~",ENDCST
.
RCOST999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Enter Label Format
.------------------------------------------------------------
ELABF000   CALL      DLABF000
           MOVE      ZERO,LABELFMT
.
           BRANCH    SNCOBCPN,ELABF100
.
ELABF001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,LABELFMT
           BRANCH    LABELFMT,ELABF010,ELABF020,ELABF030
           BEEP
           GOTO      ELABF001
.
ELABF010   MOVE      "114mm X 16mm",DESCFMT
           GOTO      ELABF999
.
ELABF020   MOVE      "23mm X 85mm",DESCFMT
           GOTO      ELABF999
.
ELABF030   MOVE      "16mm X 114mm",DESCFMT
           GOTO      ELABF999
.
.
.
ELABF100   KEYIN     *PCCOL:CVERT,*V2LON,*RV,LABELFMT
           BRANCH    LABELFMT,ELABF110
           BEEP
           GOTO      ELABF100
.
ELABF110   MOVE      "Datamax E-class",DESCFMT
           GOTO      ELABF999
.
ELABF999   CALL      PUTSCR00
           RETURN
.------------------------------------------------------------
. Display Levels Available
.------------------------------------------------------------
DLABF000   MOVE      "19",HTOP
           MOVE      "55",HLEF
           MOVE      "24",HBOT
           MOVE      "80",HRIG
           CALL      GETSCR00
.
           BRANCH    SNCOBCPN,DLABF050                                 *I-68672
.
           BOXCLR    HLEF,HTOP,HRIG,HBOT
           BOX       16,HLEF,HTOP,HRIG,HBOT
           DISPLAY   *P60:20,*V2LON,*ULON,"Label Format",*HOFF:
                     *P57:21,*V2LON,"1. ",*HOFF,"114mm X 16mm":
                     *P57:22,*V2LON,"2. ",*HOFF,"23mm X 85mm":
                     *P57:23,*V2LON,"3. ",*HOFF,"16mm X 114mm"
           GOTO      DLABF999
.
.
DLABF050
           BOXCLR    HLEF,HTOP,HRIG,HBOT
           BOX       16,HLEF,HTOP,HRIG,HBOT
           DISPLAY   *P60:20,*V2LON,*ULON,"Label Format",*HOFF:
                     *P57:21,*V2LON,"1. ",*HOFF,"Datamax E-class"
.
DLABF999   RETURN
.
.------------------------------------------------------------
. Print Imprest Shelf Labels
.------------------------------------------------------------
LABB0000  READ      CONTROLF,HUND07;*81,SNCOSFYN
          IF        SNCOSFYN = 1
            MATCH     START,FROMCST
            GOTO      LABB0500 IF NOT EQUAL
.
            MATCH     FINISH,TOCST
            GOTO      LABB0500 IF NOT EQUAL
.
            MATCH     START,FROMCAT
            GOTO      LABB0500 IF NOT EQUAL
.
            MATCH     FINISH,TOCAT
            GOTO      LABB0500 IF NOT EQUAL
.
            MATCH     START,FROMIMP
            GOTO      LABB0500 IF NOT EQUAL
.
            MATCH     FINISH,TOIMP
            GOTO      LABB0500 IF NOT EQUAL
.
            GETVAR    LINE24,ATTR24,1,24
            GOTO      LABB8000
          ENDIF
.
LABB0500  DISPLAY   *P1:24,*EL,"Printing ...";
          MOVE      ZERO,CPAGENO          * reset page no.
          CLOCK     TIME,CTIMEIS          * get current time
          MOVE      "99",CLNO             * init last line number
          MOVE      ZERO,SECTOR           * Counter
.
          PACK      KEY5,STRCST,SP70
          CALL      RDSICA1
          IF        OVRCD=0
            CALL      RPSICA1
          ENDIF
LABB1000  CALL      RKSICA1
          BRANCH    OVRCD,LABB9000
          MATCH     SICACODE,ENDCST
          GOTO      LABB9000 IF LESS
          MATCH     "0000000",SICAIMPD   * Must have imprest on at least 1 Day
          GOTO      LABB1000 IF EQUAL
.
          PACK      KEY16,SICACODE,SP70
          CALL      RDSIIM3
          IF        OVRCD=0
            CALL      RPSIIM3
          ENDIF
LABB1100  CALL      RKSIIM3
          BRANCH    OVRCD,LABB1000
          MATCH     SICACODE,SIIMCST
          GOTO      LABB1000 IF NOT EQUAL
          MATCH     STRCAT,SIIMCAT
          GOTO      LABB1100 IF LESS
          MATCH     SIIMCAT,ENDCAT
          GOTO      LABB1100 IF LESS
          COMPARE   SIIMMAX,ZERO
          GOTO      LABB1100 IF EQUAL
.
          MATCH     STRIMP,SIIMSEQ
          GOTO      LABB1100 IF LESS
          MATCH     SIIMSEQ,ENDIMP
          GOTO      LABB1100 IF LESS
.
          PACK      KEY7,SIIMCAT,SP70
          CALL      RDSIIA1
          BRANCH    OVRCD,LABB1100
          BRANCH    SIIASUS,LABB1100,LABB1200,LABB1100
.
LABB1200  ADD       ONE,SECTOR
          IF        (SECTOR%50=0)
            DISPLAY   *P20:24,*V2LON,SECTOR,"/",SICACODE,"/",SIIMCAT
          ENDIF
.
          MOVE      ZERO,CLNO
          REPEAT
            ADD       ONE,CLNO
            CALL      PLINB000      * Print Label
          UNTIL     NOLABELS=CLNO
          GOTO      LABB1100
.
LABB8000  MOVE      ANSN,ANS
          KEYIN     *P1:24,*EL,*V2LON,*RV:
                           "Continue with START to FINISH print (Y/N)? ",ANS
          MATCH     ANSY,ANS
          GOTO      LABB0500 IF EQUAL
.
          MATCH     ANSN,ANS
          GOTO      LABB8000 IF NOT EQUAL
.
          PUTVAR    LINE24,ATTR24,1,24
.
LABB9000  CLEAR     KEY80
          APPEND    "ibasin62.us1 ",KEY80
          APPEND    SPLFILE,KEY80
          RESET     KEY80
          MOVE      ZERO,HLEF
          CALL      GETSCR00
.
          EXECUTE   KEY80,TASKID
.
          CALL      PUTSCR00
.
LABB9999  RETURN
.------------------------------------------------------------
. Print Bar Code
. Catalog Code   : SIIACAT
. Description    : SIIADES
.------------------------------------------------------------
PLINB000  UNPACK    SIIADES,DIM30A,DIM30B
          BRANCH    SNCOBCPN,PLINB100      * printer is Datamax
          BRANCH    LABELFMT,PLINB010,PLINB020,PLINB030
.
PLINB010  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
          PRINT     "^FO20,20";            * Field Origins Relative to Home
          PRINT     "^BCR,55,Y,,";         * Bar Code Type 128 Height 90
          PRINT     "^FD",SIIACAT,"^FS"    * Field Data for Bar Code
.
          PRINT     "^FO35,260";           * Field Origins Relative to Home
          PRINT     "^A0R,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30A,"^FS"     * Field Data (Description)
.
          PRINT     "^FO,260";             * Field Origins Relative to Home
          PRINT     "^A0R,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30B,SP1,SIIMSEQ,"^FS"   * Field Data (Description)
.
          PRINT     "^XZ"                  * End of Label Format
          GOTO      PLINB999
.
PLINB020  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
.
          PRINT     "^FO10,20";            * Field Origins
          PRINT     "^BCN,110,Y,,";        * Bar Code Type 128 Height 90
          PRINT     "^FD",SIIACAT,"^FS"    * Field Data for Bar Code
.
          PRINT     "^FO250,20";           * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30A,"^FS"     * Field Data (Description)
.
          PRINT     "^FO250,70";           * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30B,"^FS"     * Field Data (Description)
.
          PRINT     "^FO250,120";          * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",SIIMSEQ,SP10,SIIAISS,"^FS"  * Field Data (Description)
.
          PRINT     "^XZ"                  * End of Label Format
.
          GOTO      PLINB999
.
PLINB030  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
          PRINT     "^FO20,20";            * Field Origins Relative to Home
          PRINT     "^BCN,55,Y,,";         * Bar Code Type 128 Height 90
          PRINT     "^FD",SIIACAT,"^FS"    * Field Data for Bar Code
.
          PRINT     "^FO260,35";           * Field Origins Relative to Home
          PRINT     "^A0N,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30A,SP1,"(",SIIMSEQ,")","^FS"   * Field Data (Descr
.
          PRINT     "^FO260,70";             * Field Origins Relative to Home
          PRINT     "^A0N,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30B,"(",SIIAISS,")","^FS"   * Field Data (Descripti
.
          PRINT     "^XZ"                  * End of Label Format
          GOTO      PLINB999
.
.******************************************* start of addition         *I-68672
PLINB100  BRANCH    DMAXSET,PLINB110
          CALL      DMAX0000               * Start Datamax labels
          MOVE      ONE,DMAXSET
.
PLINB110  MOVE      ZERO,EXIT
          PRINT     STX,ANSL,*N:                      * Start
                    "D11",*N:                         * Set width & dot size
                    "PK",*N:                          * Set print speed
                    "pE",*N:                          * set backfeed speed
                    "SK",*N:                          * Set slew speed
                    "A2"                              * set format attribute
.
.                              __________________* Vert. (Inch/100 from bot.Left
.                             |       ___________* Horiz.(Inch/100 from bot.left
.                             |      |
          PRINT     BARFMAT,"0120","0020",SIIACAT     * print Catalogue Barcode
.
.                                                     * Line 1
.                              __________________* Vert. (Inch/100 from bot.Left
.                             |       ___________* Horiz.(Inch/100 from bot.left
.                             |      |
          PRINT     TXTFMAT,"0095","0020",DIM30A
.                                                     * Line 2
          PRINT     TXTFMAT,"0065","0020",DIM30B
.                                                     * Line 3
          PRINT     TXTFMAT,"0035","0020",SIIMSEQ,*N:
                    TXTFMAT,"0035","0190",SIIAISS
.                                                     * Line 4
.
          MOVE      NOLABELS,CLNO           * force loop end
          MOVE      CLNO,LABNUM
          REP       " 0",LABNUM
          PRINT     "Q0",LABNUM,*N:                   * set no. of labels
                    ANSE                              * terminate record
.
          GOTO      PLINB999
.*******************************************   end of addition         *I-68672
.
PLINB999  RETURN
.
.------------------------------------------------------------
. Enter Catalog Range
.------------------------------------------------------------
RCATA000   MOVE     "    7",FLDID
           CALL     GETPOSIT
           CALL     KSIIAA00
           BRANCH   EXIT,RCATA100,RCATA999
           MOVE     SIIACAT,STRCAT
           PACK     FROMCAT,SIIACAT,SP1,SIIADES
           GOTO     RCATA140
.
RCATA100   MOVE     "Start             ",FROMCAT
           MOVE     SP70,STRCAT
.
RCATA140   MOVE     FROMCAT,VAR
           CALL     DISPITEM
.
RCATA150   MOVE     "    8",FLDID
           CALL     GETPOSIT
           CALL     KSIIAA00
           BRANCH   EXIT,RCATA200,RCATA999
           MOVE     SIIACAT,ENDCAT
           PACK     TOCAT,SIIACAT,SP1,SIIADES
           MATCH    STRCAT,ENDCAT
           GOTO     RCATA999 IF EQUAL
           GOTO     RCATA999 IF NOT LESS
           BEEP
           MOVE     "To Catalog Must Be > From Catalog - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCATA000
.
RCATA200   MOVE     "Finish             ",TOCAT
           MOVE     "~~",ENDCAT
.
RCATA999   MOVE     "    7",FLDID
           CALL     GETPOSIT
           RETURN
.--------------------------------------------------
. Enter Range
.  where ssff    = System & File for Keyin Routines
.        IMP     = Field ID
.        RISEQ   = Call Routine Label
.        "    1" = Screen Item Number for "from" Variable
.        "    2" = Screen Item Number for "to" Variable
.        yyyyy.. = Description of Variable
.
.  Return Values
.        FROMIMP  Code & Description for Start of Range
.        TOIMP    Code & Description for End of Range
.        STRIMP   Code for Start of Range
.        ENDIMP   Code for End of Range
.--------------------------------------------------
RISEQ000   MOVE     "    9",FLDID
           CALL     GETPOSIT
           KEYIN    *PCCOL:CVERT,*V2LON,*NOMASK,*RV,*JR,*ZF,KEY4
           MATCH    "0000",KEY4
           GOTO     RISEQ100 IF EQUAL
           MOVE     KEY4,STRIMP
           PACK     FROMIMP,KEY4,SP70
           GOTO     RISEQ140
RISEQ100   MOVE     "Start    ",FROMIMP
           MOVE     SP70,STRIMP
.
RISEQ140   MOVE     FROMIMP,VAR
           CALL     DISPITEM
.
RISEQ150   MOVE     "   10",FLDID
           CALL     GETPOSIT
           KEYIN    *PCCOL:CVERT,*V2LON,*NOMASK,*RV,*JR,*ZF,KEY4
           MATCH    "0000",KEY4
           GOTO     RISEQ200 IF EQUAL
           MOVE     KEY4,ENDIMP
           PACK     TOIMP,KEY4,SP70
           MATCH    STRIMP,ENDIMP
           GOTO     RISEQ999 IF EQUAL
           GOTO     RISEQ999 IF NOT LESS
           BEEP
           MOVE     "To Sequence Must Be > From Sequence - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RISEQ000
.
RISEQ200   MOVE     "Finish             ",TOIMP
           MOVE     Z70,ENDIMP
.
RISEQ999   MOVE     "    9",FLDID
           CALL     GETPOSIT
           RETURN
.
.------------------------------------------------------------
. Print Catalog Labels
.------------------------------------------------------------
LABC0000  DISPLAY   *P1:24,*EL,"Prcessing...";
          MOVE      ZERO,CPAGENO          * reset page no.
          CLOCK     TIME,CTIMEIS          * get current time
          MOVE      "99",CLNO             * init last line number
          MOVE      ZERO,SECTOR           * Counter
          BRANCH    REPTSEQ,LABC1000,LABC2000
.
LABC1000  CALL      SEQA0000
          GOTO      LABC9000
.
LABC2000  CALL      SEQB0000
          GOTO      LABC9000
.
LABC9000  CLEAR     KEY80
          APPEND    "ibasin62.us1 ",KEY80
          APPEND    SPLFILE,KEY80
          RESET     KEY80
          MOVE      ZERO,HLEF
          CALL      GETSCR00
.
          EXECUTE   KEY80,TASKID
.
          CALL      PUTSCR00
.
LABC9999  RETURN
.------------------------------------------------------------
. Print Bar Code
. Catalog Code   : SIIACAT
. Description    : SIIADES
.------------------------------------------------------------
PLINC000  UNPACK    SIIADES,DIM30A,DIM30B
          BRANCH    SNCOBCPN,PLINC100      * printer is Datamax
          BRANCH    LABELFMT,PLINC010,PLINC020,PLINC030
.
PLINC010  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
          PRINT     "^FO20,20";            * Field Origins Relative to Home
          PRINT     "^BCR,55,Y,,";         * Bar Code Type 128 Height 90
          PRINT     "^FD",SIIACAT,"^FS"    * Field Data for Bar Code
.
          PRINT     "^FO35,260";           * Field Origins Relative to Home
          PRINT     "^A0R,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30A,"^FS"     * Field Data (Description)
.
          PRINT     "^FO,260";             * Field Origins Relative to Home
          PRINT     "^A0R,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30B,SP1,SIIERAS,"^FS" * Field Data (Description)
.
          PRINT     "^XZ"                  * End of Label Format
          GOTO      PLINC999
.
PLINC020  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
          PRINT     "^FO10,20";            * Field Origins
          PRINT     "^BCN,110,Y,,";        * Bar Code Type 128 Height 90
          PRINT     "^FD",SIIACAT,"^FS"    * Field Data for Bar Code
.
          PRINT     "^FO250,20";           * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30A,"^FS"     * Field Data (Description)
.
          PRINT     "^FO250,70";           * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30B,"^FS"     * Field Data (Description)
.
          PRINT     "^FO250,120";          * Field Origins Relative to Home
          PRINT     "^A0N,40,25";          * Field Origins Relative to Home
          PRINT     "^FD",SIIERAS,SP10,SIIAISS,"^FS" * Field Data (Description)
.
          PRINT     "^XZ"                  * End of Label Format
.
          GOTO      PLINC999
.
PLINC030  PRINT     "^XA"                  * Start of Label Format
          PRINT     "^LH1,1"               * Label Home Position 20 dot Right
.                                          * 20 dots Down
          PRINT     "^FO20,20";            * Field Origins Relative to Home
          PRINT     "^BCN,55,Y,,";         * Bar Code Type 128 Height 90
          PRINT     "^FD",SIIACAT,"^FS"    * Field Data for Bar Code
.
          PRINT     "^FO35,260";           * Field Origins Relative to Home
          PRINT     "^A0N,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30A,"^FS"     * Field Data (Description)
.
          PRINT     "^FO,260";             * Field Origins Relative to Home
          PRINT     "^A0N,35,22";          * Field Origins Relative to Home
          PRINT     "^FD",DIM30B,SP1,SIIERAS,"^FS" * Field Data (Description)
.
          PRINT     "^XZ"                  * End of Label Format
          GOTO      PLINC999
.
.******************************************* start of addition         *I-68672
PLINC100  BRANCH    DMAXSET,PLINC110
          CALL      DMAX0000               * Start Datamax labels
          MOVE      ONE,DMAXSET
.
PLINC110  MOVE      ZERO,EXIT
          PRINT     STX,ANSL,*N:                      * Start
                    "D11",*N:                         * Set width & dot size
                    "PK",*N:                          * Set print speed
                    "pE",*N:                          * set backfeed speed
                    "SK",*N:                          * Set slew speed
                    "A2"                              * set format attribute
.
.                              __________________* Vert. (Inch/100 from bot.Left
.                             |       ___________* Horiz.(Inch/100 from bot.left
.                             |      |
          PRINT     BARFMAT,"0120","0020",SIIACAT     * print Catalogue Barcode
.
.                                                     * Line 1
.                              __________________* Vert. (Inch/100 from bot.Left
.                             |       ___________* Horiz.(Inch/100 from bot.left
.                             |      |
          PRINT     TXTFMAT,"0095","0020",DIM30A
.                                                     * Line 2
          PRINT     TXTFMAT,"0065","0020",DIM30B
.                                                     * Line 3
          PRINT     TXTFMAT,"0035","0020",SIIERAS,*N:
                    TXTFMAT,"0035","0190",SIIAISS
.                                                     * Line 4
.
          MOVE      NOLABELS,CLNO           * force loop end
          MOVE      CLNO,LABNUM
          REP       " 0",LABNUM
          PRINT     "Q0",LABNUM,*N:                   * set no. of labels
                    ANSE                              * terminate record
.
          GOTO      PLINC999
.*******************************************   end of addition         *I-68672
.
PLINC999  RETURN
.
.------------------------------------------------------------
. Print in Catalog Code Sequence
.------------------------------------------------------------
SEQA0000  PACK      KEY7,STRCAT,SP70
          CALL      RDSIIA1
          IF        OVRCD=0
            CALL      RPSIIA1
          ENDIF
SEQA1000  CALL      RKSIIA1
          BRANCH    OVRCD,SEQA9999
          MATCH     SIIACAT,ENDCAT
          GOTO      SEQA9999 IF LESS
          ADD       ONE,SECTOR
          IF        (SECTOR%50=0)
            DISPLAY   *P20:24,*V2LON,SECTOR,"/",SIIACAT
          ENDIF
          IF        SIIASUS<>0 & IGSUSP=1
            GOTO      SEQA1000
          ENDIF
.
          PACK      KEY12,SIIACAT,SIWAWAR,SP70
          CALL      RDSIIE1
          IF        OVRCD=0
            CALL      RPSIIE1
          ENDIF
SEQA1100  CALL      RKSIIE1
          BRANCH    OVRCD,SEQA1000
          MATCH     SIIACAT,SIIECAT
          GOTO      SEQA1000 IF NOT EQUAL
          IF        SIIESUS<>0 & IGSUSP=1
            GOTO      SEQA1100
          ENDIF
.
          PACK      KEY9,PASSCODE,SIIEWAR,SP70   * check warehouse security
          CALL      RDSIWS1
          BRANCH    OVRCD,SEQA1100
.
          MATCH     SP70,SIWAWAR
          GOTO      SEQA1200 IF EQUAL
          MATCH     SIIEWAR,SIWAWAR
          GOTO      SEQA1000 IF NOT EQUAL
.
          CALL      RANGE000
          BRANCH    EXIT,SEQA1000
          MOVE      ZERO,CLNO
          REPEAT
            ADD       ONE,CLNO
            CALL      PLINC000      * Print Label
          UNTIL     NOLABELS=CLNO
          GOTO      SEQA1000      * Only a Single Warehouse Selected
.
SEQA1200  CALL      RANGE000
          BRANCH    EXIT,SEQA1100
          MOVE      ZERO,CLNO
          REPEAT
            ADD       ONE,CLNO
            CALL      PLINC000      * Print Label
          UNTIL     NOLABELS=CLNO
          GOTO      SEQA1100      * Check Next Warehouse
.
SEQA9999  RETURN
.--------------------------------------------------
. Print Catalog Shelf Label
.--------------------------------------------------
RANGE000  MOVE      ONE,EXIT
          MATCH     STRRAS,SIIERAS
          GOTO      RANGE999 IF LESS
          MATCH     SIIERAS,ENDRAS
          GOTO      RANGE999 IF LESS
          BRANCH    INCLTYPE,RANGE010,RANGE020,RANGE030,RANGE030,RANGE030:
                             RANGE030,RANGE030,RANGE030
          GOTO      RANGE900
.
. SIIANON   FORM      1      Non-Stock Item 0=No
.------------------------------------------------
RANGE010  COMPARE   ONE,SIIANON
          GOTO      RANGE999 IF EQUAL   * Stock Only
          GOTO      RANGE900
.
RANGE020  COMPARE   ZERO,SIIANON
          GOTO      RANGE999 IF EQUAL   * Non-Stock Only
          GOTO      RANGE900
.
RANGE030  ASSIGN    INCLTYPE-2,F2
          MATCH     SP70,SIIESID
          IF        @EQUAL
            RESET     SIIASTI,F2
            CMATCH    "1",SIIASTI
            GOTO      RANGE999 IF NOT EQUAL
          ELSE
            RESET     SIIESID,F2
            CMATCH    "1",SIIESID
            GOTO      RANGE999 IF NOT EQUAL
          ENDIF
.
RANGE900  MOVE      ZERO,EXIT
.
RANGE999  RETURN
.
.------------------------------------------------------------
. Print in Catalog Code Sequence
.------------------------------------------------------------
SEQB0000  CALL      MAKTMP00       * Create Sort File
          BRANCH    EXIT,SEQB9999
.
          PACK      KEY7,STRCAT,SP70
          CALL      RDSIIA1
          IF        OVRCD=0
            CALL      RPSIIA1
          ENDIF
SEQB1000  CALL      RKSIIA1
          BRANCH    OVRCD,SEQB2000
          MATCH     SIIACAT,ENDCAT
          GOTO      SEQB2000 IF LESS
          ADD       ONE,SECTOR
          IF        (SECTOR%50=0)
            DISPLAY   *P20:24,*V2LON,SECTOR,"/",SIIACAT
          ENDIF
          IF        SIIASUS<>0 & IGSUSP=1
            GOTO      SEQB1000
          ENDIF
.
          PACK      KEY12,SIIACAT,SIWAWAR
          CALL      RDSIIE1
          IF        OVRCD=0
            CALL      RPSIIE1
          ENDIF
SEQB1100  CALL      RKSIIE1
          BRANCH    OVRCD,SEQB1000
          MATCH     SIIACAT,SIIECAT
          GOTO      SEQB1000 IF NOT EQUAL
          IF        SIIESUS<>0 & IGSUSP=1
            GOTO      SEQB1100
          ENDIF
.
          PACK      KEY9,PASSCODE,SIIEWAR,SP70   * check warehouse security
          CALL      RDSIWS1
          BRANCH    OVRCD,SEQB1100
.
          MATCH     SP70,SIWAWAR
          GOTO      SEQB1200 IF EQUAL
          MATCH     SIIEWAR,SIWAWAR
          GOTO      SEQB1000 IF NOT EQUAL
.
          CALL      RANGE000
          BRANCH    EXIT,SEQB1000
          CALL      WRTTMP00      * Write Temp File
          GOTO      SEQB1000      * Only a Single Warehouse Selected
.
SEQB1200  CALL      RANGE000
          BRANCH    EXIT,SEQB1100
          CALL      WRTTMP00      * Write Temp File
          GOTO      SEQB1100      * Check Next Warehouse
.
SEQB2000  PACK      KEY20,SP70
          CALL      RSSITM1
SEQB2100  CALL      RKSITM1
          BRANCH    OVRCD,SEQB9000
          PACK      KEY7,SITMCAT
          CALL      RDSIIA1
          PACK      KEY12,SITMCAT,SITMWAR
          CALL      RDSIIE1
          MOVE      ZERO,CLNO
          REPEAT
            ADD       ONE,CLNO
            CALL      PLINC000      * Print Label
          UNTIL     NOLABELS=CLNO
          GOTO      SEQB2100
.
SEQB9000  CLOSE     SINTMPA1,DELETE
.
SEQB9999  RETURN
.------------------------------------------------------------
. Create Temporary File
.------------------------------------------------------------
MAKTMP00  MOVE      "sin621",KEY6
          PACK      FILENAME,KEY6,PORT
          REP       " 0",FILENAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SINTMPA1,FILENAME
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SINTMPA1,DELETE
          ENDIF
          PACK      KEY80,ISBUILD,FILENAME,SITMKEY,SP70
          EXECUTE   KEY80,TASKID
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SINTMPA1,FILENAME
          TRAPCLR   IO
          MOVE      ZERO,EXIT
          IF        OVRCD=1
            MOVE      "Can't Create Temp. File - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
          RETURN
.
WRTTMP00  PACK      KEY20,SIIEWAR,SIIERAS,SIIECAT
          UNPACK    KEY20,SITMWAR,SITMRAS,SITMCAT
          READ      SINTMPA1,KEY20;ANS
          GOTO      WRTTMP99 IF NOT OVER
          WRITE     SINTMPA1,KEY20;SITMWAR,SITMRAS,SITMCAT
WRTTMP99  RETURN
.
RSSITM1   RESET     KEY20
          READ      SINTMPA1,KEY20;;
          RETURN
.
RKSITM1   MOVE      ZERO,OVRCD
          READKS    SINTMPA1;SITMWAR,SITMRAS,SITMCAT
          GOTO      OVERCOND IF OVER
          RETURN
.
.------------------------------------------------------------
. Enter Include Type
.------------------------------------------------------------
EINCL000  CALL      DCODE000
.
EINCL010  MOVE      ZERO,INCLTYPE
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,INCLTYPE
          COMPARE   ZERO,INCLTYPE
          GOTO      EINCL900 IF EQUAL
          BRANCH    INCLTYPE,EINCL100,EINCL200
          ASSIGN    INCLTYPE-2,F1
          PACK      KEY6,ANSC,ANSA,ANST,F1,SP70
          CALL      RDSICD1
          IF        OVRCD=1
            BEEP
            GOTO    EINCL010
          ENDIF
          MOVE      SICDDESC,INCLDESC
          GOTO      EINCL999
.
EINCL100  MOVE      "Stocked Catalogs",INCLDESC
          GOTO      EINCL999
.
EINCL200  MOVE      "Non-Stocked Catalogs",INCLDESC
          GOTO      EINCL999
.
EINCL900  MOVE      "All Catalogs",INCLDESC
          GOTO      EINCL999
.
EINCL999  CALL      PUTSCR00
          RETURN
.
DCODE000  MOVE      "13",HTOP
          MOVE      "44",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P52:14,*V2LON,*ULON,"Include Options",*HOFF:
                    *P46:15,*V2LON,"0. ",*HOFF,"All Catalogs":
                    *P46:16,*V2LON,"1. ",*HOFF,"Stocked Only":
                    *P46:17,*V2LON,"2. ",*HOFF,"Non-Stocked Only"
          MOVE      ONE,F1
DCODE100  PACK      KEY6,ANSC,ANSA,ANST,F1,SP70
          CALL      RDSICD1
          IF        OVRCD=1
            MOVE      "No Description on Code",SICDDESC
          ENDIF
          ASSIGN    F1+17,F2
          ADD       "2",F1
          DISPLAY   *P46:F2,*V2LON,F1,". ",*HOFF,SICDDESC
          SUB       "2",F1
          ADD       ONE,F1
          COMPARE   SEVEN,F1
          GOTO      DCODE100 IF NOT EQUAL
          RETURN
.
.------------------------------------------------------------
. Enter Report Sequence
.------------------------------------------------------------
KRSEQ000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          DISPLAY  *P1:24,*EL,"Report Sequence : ":
                   *V2LON,"1.",*HOFF,"Catalog Code, ":
                   *V2LON,"2.",*HOFF,"Rack & Shelf"
.
KRSEQ100  KEYIN    *PCCOL:CVERT,*RV,*V2LON,REPTSEQ
          BRANCH   REPTSEQ,KRSEQ110,KRSEQ120
          BEEP
          GOTO     KRSEQ100
.
KRSEQ110  MOVE     "Catalog Code",SEQDESC
          GOTO     KRSEQ900
.
KRSEQ120  MOVE     "Rack & Shelf",SEQDESC
          GOTO     KRSEQ900
.
KRSEQ900  CALL     MESSAGE3
          RETURN
.--------------------------------------------------
. Enter Range
.  where ssff    = System & File for Keyin Routines
.        RAS     = Field ID
.        RRAS0   = Call Routine Label
.        "    1" = Screen Item Number for "from" Variable
.        "    2" = Screen Item Number for "to" Variable
.        yyyyy.. = Description of Variable
.
.  Return Values
.        FROMRAS  Code & Description for Start of Range
.        TORAS    Code & Description for End of Range
.        STRRAS   Code for Start of Range
.        ENDRAS   Code for End of Range
.--------------------------------------------------
RRAS0000   MOVE     "   18",FLDID
           CALL     GETPOSIT
           KEYIN    *PCCOL:CVERT,*V2LON,*MASK,*RV,STRRAS
           ENDSET   STRRAS
           APPEND   SP70,STRRAS
           RESET    STRRAS
           MATCH    SP70,STRRAS
           GOTO     RRAS0100 IF EQUAL
           MATCH    EXITCHAR,STRRAS
           GOTO     RRAS0999 IF EQUAL
           PACK     FROMRAS,STRRAS,SP70
           GOTO     RRAS0140
RRAS0100   MOVE     "Start             ",FROMRAS
           MOVE     SP70,STRRAS
.
RRAS0140   MOVE     FROMRAS,VAR
           CALL     DISPITEM
.
RRAS0150   MOVE     "   19",FLDID
           CALL     GETPOSIT
           KEYIN    *PCCOL:CVERT,*V2LON,*MASK,*RV,ENDRAS
           ENDSET   ENDRAS
           APPEND   SP70,ENDRAS
           RESET    ENDRAS
           MATCH    SP70,ENDRAS
           GOTO     RRAS0200 IF EQUAL
           MATCH    EXITCHAR,ENDRAS
           GOTO     RRAS0999 IF EQUAL
           PACK     TORAS,ENDRAS,SP70
           MATCH    STRRAS,ENDRAS
           GOTO     RRAS0999 IF EQUAL
           GOTO     RRAS0999 IF NOT LESS
           BEEP
           MOVE     "To Rack & Shelf Must Be > From Rack & Shelf - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RRAS0000
.
RRAS0200   MOVE     "Finish             ",TORAS
           MOVE     Z70,ENDRAS
.
RRAS0999   MOVE     "   18",FLDID
           CALL     GETPOSIT
           RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIEIO/INC
          INC       SINCIFIO/INC
          INC       SINCODIO/INC
          INC       SINIMPIO/INC
          INC       SINNATIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
