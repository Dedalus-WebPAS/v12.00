.------------------------------------------------------------
. V9.04.01 11.04.2005 Peter Vela CAR 59696
.          Changed commodity groupd from DIM 5 to DIM 6
. VF.00.00 05.11.1998 Sandra Barcham
.          Year 2000 compliance
.------------------------------------------------------------
.  Include  file - SINRECUS.PBL Update Receival Usage Files
.
.  Usage File Update
.  -----------------
.  SINCGBFD   Commodity Usage
.  SINCIHFD   Catalog Usage Usage
.  SINSUAFD   Product Group Masterfile
.  SINSUBFD   Product Group Usage
.---------------------------------------------------
.  Required Input
.  --------------
.  Record Read from the SINCIA file (Catalog)
.  Record Read from the SINCIE file (Catalog/Warehouse)
.  Current Period in SIPEYEAR and SIPEPER
.  Amount   of Usage Adjustment SIUSCST
.  Quantity of Usage Adjustment SIUSQTY
.
.  Files Required to be Open
.  ------------------------- 
.  SINCCBA1
.  SINCCEA1
.  SINCCFA1
.  SINCGBA1
.  SINCIHA1
.  SINSUAA1
.  SINSUBA1
.
.  Field Used Update
.  -----------------
.  SIIASUB  - Product Group
.  SISACOMM - Commodity Group
.  SIIACAT  - Catalog
.  SIIEWAR  - Warehouse
.  SICACODE - Cost Centre
.  SIPEYEAR - Year
.  SIPEPER  - Period
.
.---------------------------------------------------
SINRECUS   PACK     KEY5,SIIASUB
           CALL     RDSISA1
           IF       OVRCD=1
             MOVE     SP70,SISACOMM
           ENDIF
           PACK     KEY6,SIPEYEAR,SIPEPER
           REP      " 0",KEY6
.
. Commodity
.
SINRUS10   PACK     KEY12,SISACOMM,KEY6                                *C-59696
           UNPACK   KEY12,SIGBCOM,SIGBDAT                              *C-59696
           CALL     RLSIGB1
           BRANCH   OVRCD,SINRUS15,SINRUS10
           ADD      SIUSCST,SIGBRAM
           CALL     UPSIGB1
           CALL     UUSIGB1
           GOTO     SINRUS20
.
SINRUS15   MOVE     SIUSCST,SIGBRAM
           MOVE     ZERO,SIGBUBD
           MOVE     ZERO,SIGBUAM
           MOVE     ZERO,SIGBPBD
           MOVE     ZERO,SIGBPAM
           MOVE     ZERO,SIGBRBD
           MOVE     SP70,SIGBSPA
           CALL     WRSIGB1
.
. Product Group
.
SINRUS20   PACK     KEY11,SIIASUB,KEY6
           UNPACK   KEY11,SISBSUB,SISBDAT
           CALL     RLSISB1
           BRANCH   OVRCD,SINRUS25,SINRUS20
           ADD      SIUSCST,SISBRAM
           CALL     UPSISB1
           CALL     UUSISB1
           GOTO     SINRUS30
SINRUS25   MOVE     SIUSCST,SISBRAM
           MOVE     ZERO,SISBUBD
           MOVE     ZERO,SISBUAM
           MOVE     ZERO,SISBPBD
           MOVE     ZERO,SISBPAM
           MOVE     ZERO,SISBRBD
           MOVE     SP70,SISBSPA
           CALL     WRSISB1
.
. Catalog/Warehouse Usage
.
SINRUS30   PACK     KEY18,SIIACAT,SIIEWAR,KEY6
           UNPACK   KEY18,SIIHCAT,SIIHWAR,SIIHDAT
           CALL     RLSIIH1
           BRANCH   OVRCD,SINRUS35,SINRUS30
           ADD      SIUSCST,SIIHRAM
           ADD      SIUSQTY,SIIHRQT
           CALL     UPSIIH1
           CALL     UUSIIH1
           GOTO     SINRUS40
SINRUS35
           MOVE     SIUSCST,SIIHRAM
           MOVE     SIUSQTY,SIIHRQT
           MOVE     ZERO,SIIHUQT
           MOVE     ZERO,SIIHUAM
           MOVE     ZERO,SIIHPQT
           MOVE     ZERO,SIIHPAM
           MOVE     SP70,SIIHSPA
           CALL     WRSIIH1
.
. Supplier 
.
SINRUS40   MATCH    SP70,SIPASUP
           GOTO     SINRUS50 IF EQUAL
.
           PACK     KEY11,SIPASUP,KEY6
           UNPACK   KEY11,APSBSUP,APSBDAT
           CALL     RLAPSB1
           BRANCH   OVRCD,SINRUS45,SINRUS40
           ADD      SIUSCST,APSBRAM
           CALL     UPAPSB1
           CALL     UUAPSB1
           GOTO     SINRUS50
.
SINRUS45   MOVE     SIUSCST,APSBRAM
           MOVE     ZERO,APSBIBD
           MOVE     ZERO,APSBIAM
           MOVE     ZERO,APSBPBD
           MOVE     ZERO,APSBPAM
           MOVE     ZERO,APSBRBD
           MOVE     SP70,APSBSPA
           CALL     WRAPSB1
.
SINRUS50   RETURN
