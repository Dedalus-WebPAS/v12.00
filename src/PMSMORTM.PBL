. *----------------------------------------------------------------------
. * Include Name  :   PMSMORTM.INC
. *
. * Function      :   CGI variables for PMSMORFD - pmsmoraf.dat
. *
. *  V9.11.01  23/09/2008 Ebon Clements   CAR 174048
. *                       Added PMSMR014
. *  V9.09.01  02/10/2007 Peter Vela     CAR 151949
. *                       Created TM
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for morgue details file
.------------------------------------------------------------------------
.
CPMORG00  MOVE      Z70,PMSMR001
          MOVE      Z70,PMSMR002
          MOVE      Z70,PMSMR003
          MOVE      Z70,PMSMR004
          MOVE      Z70,PMSMR005
          MOVE      Z70,PMSMR006
          MOVE      Z70,PMSMR007
          MOVE      Z70,PMSMR008
          MOVE      Z70,PMSMR009
          MOVE      Z70,PMSMR010
          MOVE      Z70,PMSMR011
          MOVE      Z70,PMSMR012
          MOVE      Z70,PMSMR013
          MOVE      Z70,PMSMR014
.
CPMORG99  RETURN
.------------------------------------------------------------
. Add Morgue Fields
.------------------------------------------------------------
PMMR0000  BRANCH    FLDITMNO,PMMR0100,PMMR0200,PMMR0300,PMMR0400,PMMR0500:
                             PMMR0600,PMMR0700,PMMR0800,PMMR0900,PMMR1000:
                             PMMR1100,PMMR1200,PMMR1300,PMMR1400,PMMR1500
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMMR9999
.
PMMR0100  WRITE     HTMLFILE;PMMRURNO;
          GOTO      PMMR9999
.
PMMR0200  WRITE     HTMLFILE;PMMRADMN;
          GOTO      PMMR9999
.
PMMR0300  MATCH     PMMRARDT,SP70
          GOTO      PMMR9999 IF EQUAL
          UNPACK    PMMRARDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMMR9999
.
PMMR0400  WRITE     HTMLFILE;PMMRARTM;
          GOTO      PMMR9999
.
PMMR0500  MOVE      "mu",CATEGORY
          MOVE      PMMRLOCA,CODE
          CALL      CODITM00
          GOTO      PMMR9999
.
PMMR0600  MOVE      "cy",CATEGORY
          MOVE      PMMRECBY,CODE
          CALL      CODITM00
          GOTO      PMMR9999
.
PMMR0700  MATCH     PMMRECDT,SP70
          GOTO      PMMR9999 IF EQUAL
          UNPACK    PMMRECDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMMR9999
.
PMMR0800  WRITE     HTMLFILE;PMMRECTM;
          GOTO      PMMR9999
.
PMMR0900  WRITE     HTMLFILE;PMMRECCM;
          GOTO      PMMR9999
.
PMMR1000  MOVE      "ac",CATEGORY
          MOVE      PMMRACBY,CODE
          CALL      CODITM00
          GOTO      PMMR9999
.
PMMR1100  MATCH     PMMRACDT,SP70
          GOTO      PMMR9999 IF EQUAL
          UNPACK    PMMRACDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMMR9999
.
PMMR1200  WRITE     HTMLFILE;PMMRACTM;
          GOTO      PMMR9999
.
PMMR1300  WRITE     HTMLFILE;PMMRACCM;
          GOTO      PMMR9999
.
PMMR1400  MOVE      PMMRURNO,URNUMBER
          MOVE      PMMRADMN,ADMISSNO
          CALL      GETPAT00
          CALL      PATLN000
          WRITE     HTMLFILE;FORMATNM;
.
PMMR1500  WRITE     HTMLFILE;PMMRHOSP;
          GOTO      PMMR9999
.
PMMR9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for morgue file
.------------------------------------------------------------
SPMORG00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMORG01,SPMORG02,SPMORG03,SPMORG04,SPMORG05:
                       SPMORG06,SPMORG07,SPMORG08,SPMORG09,SPMORG10:
                       SPMORG11,SPMORG12,SPMORG13,SPMORG14
.
          MOVE      ONE,EXIT
          GOTO      SPMORG99
.
SPMORG01  MOVE      QRYDATA,PMSMR001
          GOTO      SPMORG99
.
SPMORG02  MOVE      QRYDATA,PMSMR002
          GOTO      SPMORG99
.
SPMORG03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSMR003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMORG99
.
SPMORG04  MOVE      QRYDATA,PMSMR004
          GOTO      SPMORG99
.
SPMORG05  MOVE      QRYDATA,PMSMR005
          GOTO      SPMORG99
.
SPMORG06  MOVE      QRYDATA,PMSMR006
          GOTO      SPMORG99
.
SPMORG07  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSMR007,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMORG99
.
SPMORG08  MOVE      QRYDATA,PMSMR008
          GOTO      SPMORG99
.
SPMORG09  MOVE      QRYDATA,PMSMR009
          GOTO      SPMORG99
.
SPMORG10  MOVE      QRYDATA,PMSMR010
          GOTO      SPMORG99
.
SPMORG11  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSMR011,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMORG99
.
SPMORG12  MOVE      QRYDATA,PMSMR012
          GOTO      SPMORG99
.
SPMORG13  MOVE      QRYDATA,PMSMR013
          GOTO      SPMORG99
.
SPMORG14  MOVE      QRYDATA,PMSMR014
          GOTO      SPMORG99
.
SPMORG99  RETURN
.
.------------------------------------------------------------
.  Update morgue file
.------------------------------------------------------------
MVMORG00  MATCH     PMSMR001,Z70
          IF        !@EQUAL
            MOVE      PMSMR001,PMMRURNO
          ENDIF
.
          MATCH     PMSMR002,Z70
          IF        !@EQUAL
            MOVE      PMSMR002,PMMRADMN
          ENDIF
.
          MATCH     PMSMR003,Z70
          IF        !@EQUAL
            MOVE      PMSMR003,PMMRARDT
          ENDIF
.
          MATCH     PMSMR004,Z70
          IF        !@EQUAL
            MOVE      PMSMR004,PMMRARTM
          ENDIF
.
          MATCH     PMSMR005,Z70
          IF        !@EQUAL
            MOVE      PMSMR005,PMMRLOCA
          ENDIF
.
          MATCH     PMSMR006,Z70
          IF        !@EQUAL
            MOVE      PMSMR006,PMMRECBY
          ENDIF
.
          MATCH     PMSMR007,Z70
          IF        !@EQUAL
            MOVE      PMSMR007,PMMRECDT
          ENDIF
.
          MATCH     PMSMR008,Z70
          IF        !@EQUAL
            MOVE      PMSMR008,PMMRECTM
          ENDIF
.
          MATCH     PMSMR009,Z70
          IF        !@EQUAL
            MOVE      PMSMR009,PMMRECCM
          ENDIF
.
          MATCH     PMSMR010,Z70
          IF        !@EQUAL
            MOVE      PMSMR010,PMMRACBY
          ENDIF
.
          MATCH     PMSMR011,Z70
          IF        !@EQUAL
            MOVE      PMSMR011,PMMRACDT
          ENDIF
.
          MATCH     PMSMR012,Z70
          IF        !@EQUAL
            MOVE      PMSMR012,PMMRACTM
          ENDIF
.
          MATCH     PMSMR013,Z70
          IF        !@EQUAL
            MOVE      PMSMR013,PMMRACCM
          ENDIF
.
          MATCH     PMSMR014,Z70
          IF        !@EQUAL
            MOVE      PMSMR014,PMMRHOSP
          ENDIF
.
MVMORG99  RETURN
