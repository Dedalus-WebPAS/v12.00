.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINWARKY
.   Routine   :   HSIWAA00 Warehouse           
.   Return    :           
.-------------------------------------------------------------------------------
HSIWAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIWAA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIWAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Warehouse"          
.
          MOVE      STDCOL02,STDCOL03
          ADD       "30",STDCOL03
HSIWAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIWAWAR 
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          CALL      RSSIWA1 
HSIWAA10
          CALL      RKSIWA1 
          BRANCH    OVRCD,HSIWAA15
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSIWAA12
          CALL      HSIWAA60
          BRANCH    OVRCD,HSIWAA10
HSIWAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIWAWAR 
          DISPLAY   *PSTDCOL02:STDROW,SIWADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIWAA10 IF NOT EQUAL
HSIWAA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIWAA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIWAA30,HSIWAA35,HSIWAA40,HSIWAA45,HSIWAA04:
                              HSIWAA91,HSIWAA50
          GOTO      HSIWAA92
HSIWAA30
          CALL      RKSIWA1 
          BRANCH    OVRCD,HSIWAA85
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          CALL      RPSIWA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWAA10
HSIWAA35
          MOVE      ST1,KEY5 
          CALL      RDSIWA1 
          CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWAA85
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIWAA36
          CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWAA37
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIWAA36 IF NOT EQUAL
HSIWAA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIWAA10
HSIWAA40
          MOVE      ST1,KEY5 
          CALL      RDSIWA1 
          CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWAA85
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWAA08
HSIWAA45
          CALL      RKSIWA1 
          BRANCH    OVRCD,HSIWAA85
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY5,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIWA1 
HSIWAA46
          CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWAA47
          PACK      KEY5,SIWAWAR,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIWAA46 IF NOT EQUAL
HSIWAA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIWAA10
HSIWAA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIWAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWAA08
HSIWAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWAA08
HSIWAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIWAA61 IF EQUAL
          MATCH     SCHFLD01,SIWAWAR 
          GOTO      HSIWAA72 IF NOT EQUAL
HSIWAA61
          MATCH     SP70,SCHFLD02
          GOTO      HSIWAA62 IF EQUAL
          MATCH     SCHFLD02,SIWADES 
          GOTO      HSIWAA72 IF NOT EQUAL
HSIWAA62
HSIWAA63
HSIWAA64
HSIWAA65
HSIWAA66
HSIWAA67
HSIWAA68
HSIWAA69
HSIWAA70
          GOTO      HSIWAA75
HSIWAA72  MOVE      ONE,OVRCD
HSIWAA75  RETURN
HSIWAA85
          LOAD      KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SIWAWAR                                                
          CALL      RDSIWA1 
HSIWAA90
.                                                                               
          BEEP
          GOTO      HSIWAA20
HSIWAA91
          MOVE      SP70,SIWADES 
          MOVE      ZERO,SIWATYP 
          MOVE      ZERO,SIWACTY 
          MOVE      ZERO,SIWAPTY 
          MOVE      SP70,SIWALED 
          MOVE      SP70,SIWAIACC
          MOVE      SP70,SIWAPACC
          MOVE      SP70,SIWADISS
          MOVE      SP70,SIWARESP
          MOVE      SP70,SIWAUR1 
          MOVE      SP70,SIWAUR2 
          MOVE      SP70,SIWAMUAC
          MOVE      SP70,SIWAUD1 
          MOVE      SP70,SIWAUD2 
          MOVE      SP70,SIWAUC1 
          MOVE      SP70,SIWAUC2 
          MOVE      SP70,SIWAUY1 
          MOVE      SP70,SIWAUY2 
          MOVE      ZERO,SIWAPIC 
          MOVE      ZERO,SIWAPA1 
          MOVE      ZERO,SIWAPA2 
          MOVE      ZERO,SIWAPA3 
          MOVE      ZERO,SIWAPA4 
          MOVE      SP70,SIWANPO 
          MOVE      SP70,KEY5 
          MOVE      SP70,SIWAWAR 
          GOTO      HSIWAA96
HSIWAA92
          MOVE      SP70,KEY5 
          MOVE      SP70,SIWAWAR 
          LOAD      KEY5,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SIWAWAR                                                
HSIWAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIWAA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINWARKY
.   Routine   :   KSIWAA00 Keyin Warehouse           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIWAA00 TOPIC     "SIWAWAR "
          MATCH     SIWAWAR,SP20
          IF        @EQUAL
            MOVE      UNDLN70,SIWAWAR 
            KEYIN     *PCCOL:CVERT,*DV,SIWAWAR: 
                      *PCCOL:CVERT,*V2LON,SIWAWAR:
                      *PCCOL:CVERT,*DV,SIWAWAR 
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,SIWAWAR:
                      *PCCOL:CVERT,*DV,SIWAWAR 
          ENDIF
.
          ENDSET    SIWAWAR 
          APPEND    SP70,SIWAWAR 
          RESET     SIWAWAR 
.
          MATCH     SP70,SIWAWAR 
          GOTO      KSIWAA90 IF EQUAL
.
          CMATCH    EXITCHAR,SIWAWAR 
          GOTO      KSIWAA95 IF EQUAL
.
          CMATCH    QUEST,SIWAWAR 
          GOTO      KSIWAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSIWAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIWAWAR 
          APPEND    SP70,SIWAWAR 
          RESET     SIWAWAR 
.
          MATCH     SP70,SIWAWAR 
          GOTO      KSIWAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIWAWAR                                 
KSIWAA10
          PACK      KEY5,SIWAWAR                                                
          CALL      RASIWA1 
          BRANCH    OVRCD,KSIWAA80
          BRANCH    CKEYTYP,KSIWAA75
          CALL      RDSIWA1 
KSIWAA70
          MOVE      ZERO,EXIT
          GOTO      KSIWAA99
KSIWAA75
          MOVE      "Warehouse Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KSIWAA00
KSIWAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIWAA99,KSIWAA99
          MOVE      "Warehouse Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KSIWAA00
KSIWAA90
          MOVE      ONE,EXIT
          GOTO      KSIWAA99
KSIWAA95
          MOVE      TWO,EXIT
KSIWAA99 TOPIC    PRGID
          RETURN
