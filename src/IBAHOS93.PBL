.******************************************************************************
.*                                                                            *
.*                        P R O G R A M   S U M M A R Y                       *
.*                        -------------   -------------                       *
.*                                                                            *
.*     PROGRAM NAME:     IBAHOS93                                             *
.*                                                                            *
.*     FUNCTION:         MEDICAL RECORDS PARAMETER MAINTENANCE                *
.*                                                                            *
.*     DATE WRITTEN:     14/06/1988                                           *
.*                                                                            *
.*     AUTHOR :          KARIN PEAK                                           *
.*                                                                            *
.*     MODIFICATIONS:                                                         *
.*        V9.03.01  30/12/2003  Sylvek Litewka  CAR 20222                     *
.*                  Modified section HS4K0800 to use RDPTICD1 IO routine when *
.*                  checking for existance of a given ICD Disease code.       *
.*        V9.02.01  12/10/2001  Pat Dirito                                    *
.*                  Added CMDISM,PTCNDCRM                                     *
.*        V5.08.01  26/02/2001  Steve Armstrong                               *
.*                  Added PTCNUDRN                                            *
.******************************************************************************
.*        V5.07.01  29/01/1999  Davin                                         *
.*                  Added PTCNDCRP,PTCNDCRS,PTCNDCRC,PTCNDCRA,PTCNDCRD,       *
.*                        PTCNDCRO,PTCNDCRL (disease prefix descriptions)     *
.******************************************************************************
.*        V5.05.01  09/09/1997  Steve Armstrong   SRF 621792 (WGH)            *
.*                  Added PTCNTHAL                                            *
.******************************************************************************
.*                       W2.01  25/07/88 Graeme Williams                      *
.*                              Added CURDEL - U/R Delete Audit flag.         *
.*                              Added CURCHG - U/R # Change Audit flag.       *
.*                       V5.01  28/4/89 J.Tan             SRF 100320          *
.*                              Fixed mandatoty to mandatory                  *
.*                    V5.01.01  31/07/89 Graeme Williams                      *
.*                              Allow for New Zealand U/R numbers             *
.*                              11/08/89 Graeme Williams                      *
.*                              Added CMDISP,CMDISS,CMDISC,CMDISA             *
.*                              16/08/89 Graeme Williams                      *
.*                              Added CSRCHDRG, CSRCHYRG                      *
.*                              17/08/89 Graeme Williams                      *
.*                              Added CFFMORB                                 *
.*                    V5.01.02  02/03/90 DIG                                  *
.*                              Added Medical Record Request Parameters -     *
.*                              PTCNURCF, PTCNRQCF, PTCNDPCF, PTCNRLAY,       *
.*                              PTCNUCOD, PTCNMRPN                            *
.*                    V5.01.03  04/12/90 i chung          SRF 106942          *
.*                              Added Option 16 in User Controlled Screen 2 - *
.*                              parameter CPMS59                              *
.*                    V5.01.04  21/05/91 Steve O'Gorman                       *
.*                              Fixed errors from New Compiler                *
.*                    V5.01.05  12/09/91 J.Tan            SRF 110542          *
.*                              Fixed displaying U/R change audit             *
.*                    V5.01.06  08/11/91 J.Tan            SRF 110421          *
.*                              Added parameter for checking 'E' code in PAT06*
.*                    V5.01.07  17/08/92 Graeme Williams                      *
.*                              Added "D" and "T" disease types               *
.*                    V5.01.08  21/08/92 ROD                                  *
.*                              Added Extra Disease type                      *
.*                    V5.01.09  01/09/92 i chung          SRF 117045          *
.*                              Removed Extra Disease type and convert "T"    *
.*                              disease type to operation Post-Surgical type  *
.*        V5.01.10  22/07/1993  Glenn Berry                                   *
.*                  Increased Version Number                                  *
.*        V5.01.11  22/07/1993  Glenn Berry      SRF 123878                   *
.*                  Added CMDISL - Disease responsible for Length of Stay     *
.*        V5.01.12  06/06/1994  Matt Surridge                                 *
.*                  Added MAINQST.                                            *
.*        V5.03.01  05/01/1996  Greg Horvat                                   *
.*                  Changed to use a standard keyin for the IBA screen        *
.*                  security password                                         *
.*                                                                            *
.*                                                                            *
.******************************************************************************
+
          INC       STD001FD
.
          INC       IBACONFD/INC
          INC       IBAPRTFD/INC
          INC       IBATMHFD/INC
.
          INC       PATCODFD/INC
          INC       PATCONFD/INC
          INC       PATICDFD/INC
          INC       PATIN1FD/INC
+
.
.         VARIABLES
.
FIELD     FORM      2
.
HANS1     DIM       3
HANS2     DIM       3
HANS3     DIM       3
HANS4     DIM       3
HANS5     DIM       3
HANS6     DIM       3
HANS7     DIM       3
HANS8     DIM       3
HANS9     DIM       3
HANS10    DIM       3
HANS11    DIM       3
HANS12    DIM       3
HANS13    DIM       3
HANS14    DIM       3
HANS15    DIM       3
HANS16    DIM       3
HUNDRED5  FORM      "105"
FORM8     FORM      8
INDEX     FORM      2
.
.
LAYOUT    DIM       20
.
NADMNO    FORM      6
PMS59DSC  DIM       17
.
PASS      DIM       8
REPFLAG   FORM      1
SEC       FORM      5
.
XDAY1     DIM       2
XDAY2     DIM       2
XDAY3     DIM       2
XDAY4     DIM       2
XMON1     DIM       2
XMON2     DIM       2
XMON3     DIM       2
XMON4     DIM       2
XYEAR1    DIM       2
XYEAR2    DIM       2
XYEAR3    DIM       2
XYEAR4    DIM       2
.
.         CONSTANTS
.
LAYOUT0   INIT      "User Defined"
PMS59D1   INIT      "Southland"
PMS59D2   INIT      "Wellington/Others"
.
PRGID     INIT      "IBAHOS93"
PRGNAM    INIT      "Medical Record Parameter Maintenance"
VERSION   INIT      "V12.00.00"
+
.
.         START OF PROGRAM
.
          CALL      DISPHEAD
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P64:24,"paticddf";
          CALL      OPICD1
.
          DISPLAY   *P64:24,"ibaprtaf";
          OPEN      IBAPRTA1,"ibaprtaf"
.
          DISPLAY   *P64:24,"ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P64:24,"patin1af";
          OPEN      PATIN1A1,"patin1af"
.
START     MOVE      ZERO,OVRCD
          MOVE      ZERO,REPFLAG
.
          HLINE     *G37,2,58,80
          DISPLAY   *P1:3,*EF:
                    *P2:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P2:5,*V2LON,ONE,*HOFF," = User Controlled Screen 1":
                    *P2:6,*V2LON,TWO,*HOFF," = User Controlled Screen 2":
                    *P2:7,*V2LON,THREE,*HOFF," = User Controlled Screen 3":
                    *P2:8,*V2LON,FOUR,*HOFF," = User Controlled Screen 4":
                    *P2:9,*V2LON,FIVE,*HOFF," = IBA Controlled Screen 1":
                    *P1:11,"Select Option : ";
.
REKEY1    KEYIN     *P17:11,*EL,*DV,UNDLN1,*P17:11,*V2LON,OPTION;
          COMPARE   ZERO,OPTION
          GOTO      ENDIT IF EQUAL
.
          BRANCH    OPTION OF DOHOSPC1,DOHOSPC2,DOHOSPC3,DOHOSPC4,DOIBA1
          BEEP
          GOTO      REKEY1
.
. Do the I.B.A. Controlled Screen 1
.
DOIBA1    CALL      IBASECUR                * Keyin IBA screen security passwd
          BRANCH    EXIT,START
          CALL      DISPIBA1
          MOVE      ONE,OVRCD
          CALL      UPIBA1
          BRANCH    OVRCD,START
          CALL      WRIBA1
          GOTO      START
.
. Display IBA screen 1
.
DISPIBA1  READ      CONTROLF,TWENTY1;*5,PTCNNCRG
.
          DISPLAY   *P58:2,*V2LON,"- IBA Screen 1 ",*P1:3,*EF,*HOFF:
               *P1:4,*V2LON," 1",*HOFF,". Next Cancer Registration Number  :":
               *V2LON,*P40:4,PTCNNCRG
          RETURN
.
UPIBA1    CALL      MAINQST
          MOVE      CCITEM,FIELD
          COMPARE   ZERO,FIELD
          GOTO      POST IF EQUAL
          GOTO      OVERCOND IF LESS
.
          BRANCH    FIELD,KIBA1000
          BEEP
          GOTO      UPIBA1
.
KIBA1000  KEYIN     *P40:4,*EL,*V2LON,PTCNNCRG;
          DISPLAY   *P40:4,*EL,*V2LON,PTCNNCRG;
          MOVE      ZERO,OVRCD
          GOTO      UPIBA1
.
.     Do the U/R Number Ranges Screen
.
DOHOSPC1  CALL      DISPHOS1
          MOVE      ONE,OVRCD
          CALL      UPHOS1
          BRANCH    OVRCD OF START
          CALL      WRHOS1
          GOTO      START
.
.         Subroutine to display screens
.
DISPHOS1  READ      CONTROLF,TEN9;*1,CSURG1,*10,CMURG1,*18,CSURG2:
                                 *27,CMURG2,*35,CSURG3,*44,CMURG3,*52,CSURG4:
                                 *61,CMURG4,*69,CIPRG,*70,COPRG,CAERG,CNBRG
.
          DISPLAY   *P58:2,*V2LON,"- Screen 1 ",*P1:3,*EF,*HOFF:
                *P1:4,*V2LON," 1",*HOFF,". Range 1 - Next U/R Number        :":
                *P1:5,*V2LON," 2",*HOFF,".         - Maximum  U/R Number    :":
                *P1:7,*V2LON," 3",*HOFF,". Range 2 - Next U/R Number        :":
                *P1:8,*V2LON," 4",*HOFF,".         - Maximum  U/R Number    :":
                *P1:10,*V2LON," 5",*HOFF,". Range 3 - Next U/R Number        :":
                *P1:11,*V2LON," 6",*HOFF,".         - Maximum  U/R Number    :":
                *P1:13,*V2LON," 7",*HOFF,". Range 4 - Next U/R Number        :":
                *P1:14,*V2LON," 8",*HOFF,".         - Maximum  U/R Number    :":
                *P1:16,*V2LON," 9",*HOFF,". In-Patient System using Range    :":
                *P1:17,*V2LON,"10",*HOFF,". Out-Patient System using Range   :":
                *P1:18,*V2LON,"11",*HOFF,". A & E System using Range         :":
                *P1:19,*V2LON,"12",*HOFF,". New Born System using Range      :":
                *P40:4,*V2LON,CSURG1,*P41:5,CMURG1,*P40:7,CSURG2:
                *P41:8,CMURG2:
                *P40:10,CSURG3,*P41:11,CMURG3,*P40:13,CSURG4:
                *P41:14,CMURG4,*P40:16,CIPRG,*P40:17,COPRG:
                *P40:18,CAERG,*P40:19,CNBRG
          RETURN
+
.
UPHOS1    CALL      MAINQST
          MOVE      CCITEM,FIELD 
          COMPARE   ZERO,FIELD
          GOTO      POST IF EQUAL
          GOTO      OVERCOND IF LESS
.
          BRANCH    FIELD,KHOS1,KHOS2,KHOS3,KHOS4,KHOS5,KHOS6,KHOS7,KHOS8,KHOS9:
                          KHOS10,KHOS11,KHOS12
          BEEP
          GOTO      UPHOS1
.
KHOS1     KEYIN     *P40:4,*EL,*V2LON,*JR,CSURG1;
          DISPLAY   *P40:4,*EL,*V2LON,CSURG1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS2     KEYIN     *P41:5,*EL,*V2LON,*JR,CMURG1;
          DISPLAY   *P41:5,*EL,*V2LON,CMURG1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS3     KEYIN     *P40:7,*EL,*V2LON,*JR,CSURG2;
          DISPLAY   *P40:7,*EL,*V2LON,CSURG2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS4     KEYIN     *P41:8,*EL,*V2LON,*JR,CMURG2;
          DISPLAY   *P41:8,*EL,*V2LON,CMURG2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS5     KEYIN     *P40:10,*EL,*V2LON,*JR,CSURG3;
          DISPLAY   *P40:10,*EL,*V2LON,CSURG3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS6     KEYIN     *P41:11,*EL,*V2LON,*JR,CMURG3;
          DISPLAY   *P41:11,*EL,*V2LON,CMURG3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS7     KEYIN     *P40:13,*EL,*V2LON,*JR,CSURG4;
          DISPLAY   *P40:13,*EL,*V2LON,CSURG4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS8     KEYIN     *P41:14,*EL,*V2LON,*JR,CMURG4;
          DISPLAY   *P41:14,*EL,*V2LON,CMURG4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
KHOS9     KEYIN     *P40:16,*DV,SP1,*P40:16,*V2LON,CIPRG;
          COMPARE   FIVE,CIPRG
          GOTO      INVRNG9 IF NOT LESS
          DISPLAY   *P40:16,*EL,*V2LON,CIPRG;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
INVRNG9   DISPLAY   *P1:24,*EL,*B,"Invalid Range. ";
          CALL      HITENTER          
          GOTO      KHOS9
.
KHOS10    KEYIN     *P40:17,*DV,SP1,*P40:17,*V2LON,COPRG;
          COMPARE   FIVE,COPRG
          GOTO      INVRNG10 IF NOT LESS
          DISPLAY   *P40:17,*EL,*V2LON,COPRG;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
INVRNG10  DISPLAY   *P1:24,*EL,*B,"Invalid Range. ";
          CALL      HITENTER
          GOTO      KHOS10
.
KHOS11    KEYIN     *P40:18,*DV,SP1,*P40:18,*V2LON,CAERG;
          COMPARE   FIVE,CAERG
          GOTO      INVRNG11 IF NOT LESS
          DISPLAY   *P40:18,*EL,*V2LON,CAERG;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
INVRNG11  DISPLAY   *P1:24,*EL,*B,"Invalid Range. ";
          CALL      HITENTER
          GOTO      KHOS11
.
KHOS12    KEYIN     *P40:19,*DV,SP1,*P40:19,*V2LON,CNBRG;
          COMPARE   FIVE,CNBRG
          GOTO      INVRNG12 IF NOT LESS
          DISPLAY   *P40:19,*EL,*V2LON,CNBRG;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS1
.
INVRNG12  DISPLAY   *P50:19,*EL,*B,*V2LON,"Invalid Range. ";
          CALL      HITENTER
          GOTO      KHOS12
.
DOHOSPC2  CALL      DISPHO2
          MOVE      ONE,OVRCD
          CALL      UPHOS2
          BRANCH    OVRCD OF START
          CALL      WRHOS2
          GOTO      START
.
DISPHO2   READ      CONTROLF,TEN;*246,CSRCHDRG,CSRCHYRG
          READ      CONTROLF,TEN4;*248,CURDEL,CURCHG
          READ      CONTROLF,TEN9;*73,CPUSR,CSUSR,CCNOTES,*208,CPMIAD:
                                 *250,CPMS59
          READ      CONTROLF,FIFTY9;*63,CFFMORB,*192,PTCNURCF,PTCNRQCF,PTCNDPCF:
                                        PTCNRLAY,PTCNUCOD,PTCNMRPN
          READ      CONTROLF,HUND05;*100,PTCNUDRN
.
          MOVE      DNO,HANS1
          LOAD      HANS1 USING CPUSR OF DYES,DNO
.
          MOVE      DNO,HANS2
          LOAD      HANS2 USING CSUSR OF DYES,DNO
.
          MOVE      DNO,HANS3
          LOAD      HANS3 USING CPMIAD OF DYES,DNO
.
          MOVE      DNO,HANS4
          LOAD      HANS4 USING CURDEL OF DYES,DNO
.
          MOVE      DNO,HANS5
          LOAD      HANS5 USING CURCHG OF DYES,DNO
.
          MOVE      DNO,HANS6
          LOAD      HANS6 USING CFFMORB OF DYES,DNO
.
          MOVE      DNO,HANS13
          LOAD      HANS13 USING PTCNURCF OF DYES,DNO
.
          MOVE      DNO,HANS14
          LOAD      HANS14 USING PTCNRQCF OF DYES,DNO
.
          MOVE      DNO,HANS15
          LOAD      HANS15 USING PTCNDPCF OF DYES,DNO
.
          MOVE      DNO,HANS16
          LOAD      HANS16,PTCNUDRN,DYES
.
          MOVE      LAYOUT0,LAYOUT
.
          MOVE      SP20,PRTDESC
          MOVE      PTCNMRPN,KEY3
          CALL      RDPRTA1
.
          PACK      IBTHDESC,SP20,SP10
          MOVE      PTCNUCOD,KEY6
          CALL      RDIBTH1
.
          MOVE      SP20,PMS59DSC
          LOAD      PMS59DSC,CPMS59,PMS59D1,PMS59D2
.
          DISPLAY   *P58:2,*V2LON,"- Screen 2 ",*P1:3,*EF,*HOFF:
                *P1:4,*V2LON," 1",*HOFF,". One Primary Disease only ? (Y/N):":
                *P1:5,*V2LON," 2",*HOFF,". One Sequela Disease only ? (Y/N):":
                *P1:6,*V2LON," 3",*HOFF,". Case Notes Symbol               :":
                *P1:7,*V2LON," 4",*HOFF,". Using PMI Change Audit ?   (Y/N):":
                *P1:8,*V2LON," 5",*HOFF,". Using PMI Deletion Audit ? (Y/N):":
                *P1:9,*V2LON," 6",*HOFF,". Using U/R No. Change Audit?(Y/N):":
                *P1:10,*V2LON," 7",*HOFF,". Day range for DOB in searches   :":
                *P1:11,*V2LON," 8",*HOFF,". Year range for DOB in searches  :":
                *P1:12,*V2LON," 9",*HOFF,". Change desc. in Morbidity ?(Y/N):":
                *P1:13,*V2LON,"10",*HOFF,". Free Format for Urgency ?  (Y/N):":
                *P1:14,*V2LON,"11",*HOFF,". Free Format for Requested ?(Y/N):":
                *P1:15,*V2LON,"12",*HOFF,". Free Format for Department?(Y/N):":
                *P1:16,*V2LON,"13",*HOFF,". Medical Rec. Request Form Layout:":
                *P1:17,*V2LON,"14",*HOFF,". User Defined Stationary Code    :":
                *P1:18,*V2LON,"15",*HOFF,". Printer for Med. Rec. Request   :":
                *P1:19,*V2LON,"16",*HOFF,". Dsch Diag Data Rpt format(PMS59):":
                *P1:20,*V2LON,"17",*HOFF,". Using ranges for DOB searches   :":
                *P39:4,*V2LON,HANS1,*P39:5,HANS2,*P39:6,CCNOTES:
                *P39:7,HANS3,*P39:8,HANS4,*P39:9,HANS5:
                *P39:10,CSRCHDRG:
                *P39:11,CSRCHYRG:
                *P39:12,HANS6:
                *P39:13,HANS13:
                *P39:14,HANS14:
                *P39:15,HANS15:
                *P39:16,PTCNRLAY,*P50:16,*HOFF,LAYOUT:
                *P39:17,*V2LON,PTCNUCOD,*P50:17,*HOFF,IBTHDESC:
                *P39:18,*V2LON,PTCNMRPN,*P50:18,*HOFF,PRTDESC:
                *P39:19,*V2LON,CPMS59,*P50:19,*HOFF,PMS59DSC:
                *P39:20,*V2LON,HANS16;
          RETURN
+
.
UPHOS2    CALL      MAINQST
          MOVE      CCITEM,FIELD 
          COMPARE   ZERO,FIELD
          GOTO      POST IF EQUAL
          GOTO      OVERCOND IF LESS
.
          BRANCH    FIELD,KPOS1,KPOS2,KPOS3,KPOS4,KPOS5,KPOS6,KPOS7,KPOS8,KPOS9:
                          KPOS10,KPOS11,KPOS12,KPOS13,KPOS14,KPOS15,KPOS16:
                          KPOS17
          BEEP
          GOTO      UPHOS2
.
KPOS1     KEYIN     *P39:4,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY1 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN1 IF EQUAL
          BEEP
          GOTO      KPOS1
.
KPOSY1    MOVE      ONE,CPUSR
          GOTO      KPOS1S
.
KPOSN1    MOVE      ZERO,CPUSR
.
KPOS1S    MOVE      DNO,HANS1
          LOAD      HANS1 USING CPUSR OF DYES,DNO
          DISPLAY   *P39:4,*EL,*V2LON,HANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS2     KEYIN     *P39:5,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY2 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN2 IF EQUAL
          BEEP
          GOTO      KPOS2
.
KPOSY2    MOVE      ONE,CSUSR
          GOTO      KPOS2S
.
KPOSN2    MOVE      ZERO,CSUSR
.
KPOS2S    MOVE      DNO,HANS2
          LOAD      HANS2 USING CSUSR OF DYES,DNO
          DISPLAY   *P39:5,*EL,*V2LON,HANS2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS3     KEYIN     *P39:6,*EL,*V2LON,CCNOTES;
          DISPLAY   *P39:6,*EL,*V2LON,CCNOTES;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS4     KEYIN     *P39:7,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY4 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN4 IF EQUAL
          BEEP
          GOTO      KPOS4
.
KPOSY4    MOVE      ONE,CPMIAD
          GOTO      KPOS4S
.
KPOSN4    MOVE      ZERO,CPMIAD
.
KPOS4S    MOVE      DNO,HANS3
          LOAD      HANS3 USING CPMIAD OF DYES,DNO
          DISPLAY   *P39:7,*EL,*V2LON,HANS3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS5     KEYIN     *P39:8,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY5 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN5 IF EQUAL
          BEEP
          GOTO      KPOS5
.
KPOSY5    MOVE      ONE,CURDEL
          GOTO      KPOS5S
.
KPOSN5    MOVE      ZERO,CURDEL
.
KPOS5S    MOVE      DNO,HANS4
          LOAD      HANS4 USING CURDEL OF DYES,DNO
          DISPLAY   *P39:8,*EL,*V2LON,HANS4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS6     KEYIN     *P39:9,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY6 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN6 IF EQUAL
          BEEP
          GOTO      KPOS6
.
KPOSY6    MOVE      ONE,CURCHG
          GOTO      KPOS6S
.
KPOSN6    MOVE      ZERO,CURCHG
.
KPOS6S    MOVE      DNO,HANS5
          LOAD      HANS5 USING CURCHG OF DYES,DNO
          DISPLAY   *P39:9,*EL,*V2LON,HANS5;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS7     KEYIN     *P39:10,*EL,*V2LON,CSRCHDRG;
          DISPLAY   *P39:10,*EL,*V2LON,CSRCHDRG;
          COMPARE   ZERO,CSRCHDRG
          GOTO      KPOS11 IF LESS
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS8     KEYIN     *P39:11,*EL,*V2LON,CSRCHYRG;
          DISPLAY   *P39:11,*EL,*V2LON,CSRCHYRG;
          COMPARE   ZERO,CSRCHYRG
          GOTO      KPOS12 IF LESS
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS9     KEYIN     *P39:12,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY9 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN9 IF EQUAL
          BEEP
          GOTO      KPOS9
.
KPOSY9    MOVE      ONE,CFFMORB
          GOTO      KPOS9S
.
KPOSN9    MOVE      ZERO,CFFMORB
.
KPOS9S    MOVE      DNO,HANS6
          LOAD      HANS6 USING CFFMORB OF DYES,DNO
          DISPLAY   *P39:12,*EL,*V2LON,HANS6;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS10    KEYIN     *P39:13,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY10 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN10 IF EQUAL
          BEEP
          GOTO      KPOS10
.
KPOSY10   MOVE      ONE,PTCNURCF
          GOTO      KPOS10S
.
KPOSN10   MOVE      ZERO,PTCNURCF
.
KPOS10S   MOVE      DNO,HANS13
          LOAD      HANS13 USING PTCNURCF OF DYES,DNO
          DISPLAY   *P39:13,*EL,*V2LON,HANS13;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS11    KEYIN     *P39:14,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY11 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN11 IF EQUAL
          BEEP
          GOTO      KPOS11
.
KPOSY11   MOVE      ONE,PTCNRQCF
          GOTO      KPOS11S
.
KPOSN11   MOVE      ZERO,PTCNRQCF
.
KPOS11S   MOVE      DNO,HANS14
          LOAD      HANS14 USING PTCNRQCF OF DYES,DNO
          DISPLAY   *P39:14,*EL,*V2LON,HANS14;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS12    KEYIN     *P39:15,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY12 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN12 IF EQUAL
          BEEP
          GOTO      KPOS12
.
KPOSY12   MOVE      ONE,PTCNDPCF
          GOTO      KPOS12S
.
KPOSN12   MOVE      ZERO,PTCNDPCF
.
KPOS12S   MOVE      DNO,HANS15
          LOAD      HANS15 USING PTCNDPCF OF DYES,DNO
          DISPLAY   *P39:15,*EL,*V2LON,HANS15;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS13    MOVE      SP20,LAYOUT
          DISPLAY   *P39:16,*EL:
                    *P1:24,*EL,*V2LON,ZERO,*HOFF," = User Defined";
          KEYIN     *P39:16,*V2LON,PTCNRLAY;
          DISPLAY   *P39:16,*V2LON,PTCNRLAY;
.
          COMPARE   ZERO,PTCNRLAY
          GOTO      KPOS13Y IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,"Invalid Layout. ";
          CALL      HITENTER
          GOTO      KPOS13
.
KPOS13Y   MOVE      LAYOUT0,LAYOUT
          MOVE      ZERO,OVRCD
          DISPLAY   *P50:16,LAYOUT:
                    *P1:24,*EL;
          GOTO      UPHOS2
.
KPOS14    PACK      IBTHDESC,SP20,SP10
          DISPLAY   *P39:17,*EL;
          KEYIN     *P39:17,*V2LON,PTCNUCOD;
          DISPLAY   *P39:17,*V2LON,PTCNUCOD;
.
          ENDSET    PTCNUCOD
          APPEND    SP6,PTCNUCOD
          RESET     PTCNUCOD
.
          MATCH     SP6,PTCNUCOD
          GOTO      KPOS14Y IF EQUAL
.
          MOVE      PTCNUCOD,KEY6
          CALL      RDIBTH1
          BRANCH    OVRCD,KPOS14N
.
          COMPARE   FOUR,IBTHSTFM
          GOTO      KPOS14Y IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B:
                    "Stationary Code Is An Invalid Type. ";
          CALL      HITENTER
          GOTO      KPOS14
.
KPOS14N   DISPLAY   *P1:24,*EL,*B:
                    "Stationary Code Not On File. ";
          CALL      HITENTER
          GOTO      KPOS14
.
KPOS14Y   DISPLAY   *P50:17,IBTHDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS15    MOVE      SP20,PRTDESC
          MOVE      SP3,PTCNMRPN
          DISPLAY   *P39:18,*EL;
          KEYIN     *P39:18,*V2LON,*RV,*JR,PTCNMRPN;
          DISPLAY   *P39:18,*V2LON,PTCNMRPN;
.
          MATCH     SP3,PTCNMRPN
          GOTO      KPOS15Y IF EQUAL
.
          MOVE      PTCNMRPN,KEY3
          CALL      RDPRTA1
          BRANCH    OVRCD,KPOS15N
.
          COMPARE   ZERO,PRTAVAL
          GOTO      KPOS15Y IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,"Printer Not Available. ";
          CALL      HITENTER
          GOTO      KPOS15
.
KPOS15Y   DISPLAY   *P50:18,PRTDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS15N   DISPLAY   *P1:24,*EL,*B,"Printer Code Not On File. ";
          CALL      HITENTER
          GOTO      KPOS15
.
KPOS16    DISPLAY   *P1:24,*EL,*V2LON,ONE,*HOFF," = ",*+,PMS59D1,SP2:
                               *V2LON,TWO,*HOFF," = ",PMS59D2;
.
          KEYIN     *P39:19,*EL,*DV,UNDLN1,*P39:19,*V2LON,CPMS59;
          BRANCH    CPMS59,KPOS16C,KPOS16C
          BEEP
          GOTO      KPOS16
.
KPOS16C   LOAD      PMS59DSC,CPMS59,PMS59D1,PMS59D2
          DISPLAY   *P39:19,*V2LON,CPMS59,*HOFF,*P50:19,PMS59DSC,*P1:24,*EL;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KPOS17    KEYIN     *P39:20,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KPOSY17 IF EQUAL
          MATCH     "N",ANS
          GOTO      KPOSN17 IF EQUAL
          BEEP
          GOTO      KPOS17
.
KPOSY17   MOVE      ONE,PTCNUDRN
          GOTO      KPOS17S
.
KPOSN17   MOVE      ZERO,PTCNUDRN
.
KPOS17S   MOVE      DNO,HANS16
          LOAD      HANS16,PTCNUDRN,DYES
          DISPLAY   *P39:20,*EL,*V2LON,HANS16;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
DOHOSPC3  CALL      DISPHO3
          MOVE      ONE,OVRCD
          CALL      UPHOS3
          BRANCH    OVRCD OF START
          CALL      WRHOS3
          GOTO      START
.
DISPHO3   READ      CONTROLF,TEN9;*76,CRUSR1,CRDESC1,*97,CRMAN1,CRUSR2,CRDESC2:
                                 *119,CRMAN2,*120,CRUSR3,CRDESC3,*141,CRMAN3:
                                      CHUSR1,CHDESC1,*163,CHMAN1,CHUSR2,CHDESC2:
                                 *185,CHMAN2,CHUSR3,CHDESC3,*207,CHMAN3
          READ      CONTROLF,TWENTY;*191,PTCECODE
.
          MOVE      DNO,HANS1
          LOAD      HANS1 USING CRUSR1 OF DYES,DNO
.
          MOVE      DNO,HANS2
          LOAD      HANS2 USING CRMAN1 OF DYES,DNO
.
          MOVE      DNO,HANS3
          LOAD      HANS3 USING CRUSR2 OF DYES,DNO
.
          MOVE      DNO,HANS4
          LOAD      HANS4 USING CRMAN2 OF DYES,DNO
.
          MOVE      DNO,HANS5
          LOAD      HANS5 USING CRUSR3 OF DYES,DNO
.
          MOVE      DNO,HANS6
          LOAD      HANS6 USING CRMAN3 OF DYES,DNO
.
          MOVE      DNO,HANS7
          LOAD      HANS7 USING CHUSR1 OF DYES,DNO
.
          MOVE      DNO,HANS8
          LOAD      HANS8 USING CHMAN1 OF DYES,DNO
.
          MOVE      DNO,HANS9
          LOAD      HANS9 USING CHUSR2 OF DYES,DNO
.
          MOVE      DNO,HANS10
          LOAD      HANS10 USING CHMAN2 OF DYES,DNO
.
          MOVE      DNO,HANS11
          LOAD      HANS11 USING CHUSR3 OF DYES,DNO
.
          MOVE      DNO,HANS12
          LOAD      HANS12 USING CHMAN3 OF DYES,DNO
.
          MOVE      DNO,HANS13
          LOAD      HANS13 USING PTCECODE OF DYES,DNO
.
          DISPLAY   *P58:2,*V2LON,"- Screen 3 ",*P1:3,*EF,*HOFF:
               *P1:4,*V2LON," 1",*HOFF,". Using User Defined Field 1 ?(Y/N) :":
               *P1:5,*V2LON," 2",*HOFF,".                  Description      :":
               *P1:6,*V2LON," 3",*HOFF,".                  Mandatory ?(Y/N) :":
               *P1:7,*V2LON," 4",*HOFF,". Using User Defined Field 2 ?(Y/N) :":
               *P1:8,*V2LON," 5",*HOFF,".                 Description       :":
               *P1:9,*V2LON," 6",*HOFF,".                 Mandatory  ?(Y/N) :":
               *P1:10,*V2LON," 7",*HOFF,". Using User Defined Field 3 ?(Y/N) :":
               *P1:11,*V2LON," 8",*HOFF,".                 Description       :":
               *P1:12,*V2LON," 9",*HOFF,".                 Mandatory  ?(Y/N) :":
               *P1:14,*V2LON,"10",*HOFF,". Using Highlight Code 1 ?    (Y/N) :":
               *P1:15,*V2LON,"11",*HOFF,".       Description                 :":
               *P1:16,*V2LON,"12",*HOFF,".       Mandatory ?           (Y/N) :":
               *P1:17,*V2LON,"13",*HOFF,". Using Highlight Code 2 ?    (Y/N) :":
               *P1:18,*V2LON,"14",*HOFF,".       Description                 :":
               *P1:19,*V2LON,"15",*HOFF,".       Mandatory ?           (Y/N) :":
               *P1:20,*V2LON,"16",*HOFF,". Using Highlight Code 3 ?    (Y/N) :":
               *P1:21,*V2LON,"17",*HOFF,".       Description                 :":
               *P1:22,*V2LON,"18",*HOFF,".       Mandatory ?           (Y/N) :":
               *P1:23,*V2LON,"19",*HOFF,". Mandatory 'E' Code Check ?  (Y/N) :":
               *P41:4,*V2LON,HANS1,*P41:5,CRDESC1,*P41:6,HANS2:
               *P41:7,HANS3,*P41:8,CRDESC2,*P41:9,HANS4:
               *P41:10,HANS5,*P41:11,CRDESC3,*P41:12,HANS6:
               *P41:14,HANS7,*P41:15,CHDESC1,*P41:16,HANS8:
               *P41:17,HANS9,*P41:18,CHDESC2,*P41:19,HANS10:
               *P41:20,HANS11,*P41:21,CHDESC3,*P41:22,HANS12:
               *P41:23,HANS13;
          RETURN

.
UPHOS3    CALL      MAINQST 
          MOVE      CCITEM,FIELD
          COMPARE   ZERO,FIELD
          GOTO      POST IF EQUAL
          GOTO      OVERCOND IF LESS
.
          BRANCH    FIELD,KDES1,KDES2,KDES3,KDES4,KDES5,KDES6,KDES7,KDES8,KDES9:
                          KDES10,KDES11,KDES12,KDES13,KDES14,KDES15,KDES16:
                          KDES17,KDES18,KDES19
          BEEP
          GOTO      UPHOS3
.
KDES1     KEYIN     *P41:4,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY1 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN1 IF EQUAL
          BEEP
          GOTO      KDES1
.
KDESY1    MOVE      ONE,CRUSR1
          GOTO      KDES1S
.
KDESN1    MOVE      ZERO,CRUSR1
.
KDES1S    MOVE      DNO,HANS1
          LOAD      HANS1 USING CRUSR1 OF DYES,DNO
          DISPLAY   *P41:4,*EL,*V2LON,HANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES2     MOVE      SP20,CRDESC1
          KEYIN     *P41:5,*EL,*V2LON,CRDESC1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES3     KEYIN     *P41:6,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY3 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN3 IF EQUAL
          BEEP
          GOTO      KDES3
.
KDESY3    MOVE      ONE,CRMAN1
          GOTO      KDES3S
.
KDESN3    MOVE      ZERO,CRMAN1
.
KDES3S    MOVE      DNO,HANS2
          LOAD      HANS2 USING CRMAN1 OF DYES,DNO
          DISPLAY   *P41:6,*EL,*V2LON,HANS2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES4     KEYIN     *P41:7,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY4 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN4 IF EQUAL
          BEEP
          GOTO      KDES4
.
KDESY4    MOVE      ONE,CRUSR2
          GOTO      KDES4S
.
KDESN4    MOVE      ZERO,CRUSR2
.
KDES4S    MOVE      DNO,HANS3
          LOAD      HANS3 USING CRUSR2 OF DYES,DNO
          DISPLAY   *P41:7,*EL,*V2LON,HANS3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES5     MOVE      SP20,CRDESC2
          KEYIN     *P41:8,*EL,*V2LON,CRDESC2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES6     KEYIN     *P41:9,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY6 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN6 IF EQUAL
          BEEP
          GOTO      KDES6
.
KDESY6    MOVE      ONE,CRMAN2
          GOTO      KDES6S
.
KDESN6    MOVE      ZERO,CRMAN2
.
KDES6S    MOVE      DNO,HANS4
          LOAD      HANS4 USING CRMAN2 OF DYES,DNO
          DISPLAY   *P41:9,*EL,*V2LON,HANS4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES7     KEYIN     *P41:10,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY7 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN7 IF EQUAL
          BEEP
          GOTO      KDES7
.
KDESY7    MOVE      ONE,CRUSR3
          GOTO      KDES7S
.
KDESN7    MOVE      ZERO,CRUSR3
.
KDES7S    MOVE      DNO,HANS5
          LOAD      HANS5 USING CRUSR3 OF DYES,DNO
          DISPLAY   *P41:10,*EL,*V2LON,HANS5;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES8     MOVE      SP20,CRDESC3
          KEYIN     *P41:11,*EL,*V2LON,CRDESC3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES9     KEYIN     *P41:12,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY9 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN9 IF EQUAL
          BEEP
          GOTO      KDES9
.
KDESY9    MOVE      ONE,CRMAN3
          GOTO      KDES9S
.
KDESN9    MOVE      ZERO,CRMAN3
.
KDES9S    MOVE      DNO,HANS6
          LOAD      HANS6 USING CRMAN3 OF DYES,DNO
          DISPLAY   *P41:12,*EL,*V2LON,HANS6;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES10    KEYIN     *P41:14,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY10 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN10 IF EQUAL
          BEEP
          GOTO      KDES10
.
KDESY10   MOVE      ONE,CHUSR1
          GOTO      KDES10S
.
KDESN10   MOVE      ZERO,CHUSR1
.
KDES10S   MOVE      DNO,HANS7
          LOAD      HANS7 USING CHUSR1 OF DYES,DNO
          DISPLAY   *P41:14,*EL,*V2LON,HANS7;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES11    MOVE      SP20,CHDESC1
          KEYIN     *P41:15,*EL,*V2LON,CHDESC1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES12    KEYIN     *P41:16,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY12 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN12 IF EQUAL
          BEEP
          GOTO      KDES12
.
KDESY12   MOVE      ONE,CHMAN1
          GOTO      KDES12S
.
KDESN12   MOVE      ZERO,CHMAN1
.
KDES12S   MOVE      DNO,HANS8
          LOAD      HANS8 USING CHMAN1 OF DYES,DNO
          DISPLAY   *P41:16,*EL,*V2LON,HANS8;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES13    KEYIN     *P41:17,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY13 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN13 IF EQUAL
          BEEP
          GOTO      KDES13
.
KDESY13   MOVE      ONE,CHUSR2
          GOTO      KDES13S
.
KDESN13   MOVE      ZERO,CHUSR2
.
KDES13S   MOVE      DNO,HANS9
          LOAD      HANS9 USING CHUSR2 OF DYES,DNO
          DISPLAY   *P41:17,*EL,*V2LON,HANS9;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES14    MOVE      SP20,CHDESC2
          KEYIN     *P41:18,*EL,*V2LON,CHDESC2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES15    KEYIN     *P41:19,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY15 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN15 IF EQUAL
          BEEP
          GOTO      KDES15
.
KDESY15   MOVE      ONE,CHMAN2
          GOTO      KDES15S
.
KDESN15   MOVE      ZERO,CHMAN2
.
KDES15S   MOVE      DNO,HANS10
          LOAD      HANS10 USING CHMAN2 OF DYES,DNO
          DISPLAY   *P41:19,*EL,*V2LON,HANS10;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES16    KEYIN     *P41:20,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY16 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN16 IF EQUAL
          BEEP
          GOTO      KDES16
.
KDESY16   MOVE      ONE,CHUSR3
          GOTO      KDES16S
.
KDESN16   MOVE      ZERO,CHUSR3
.
KDES16S   MOVE      DNO,HANS11
          LOAD      HANS11 USING CHUSR3 OF DYES,DNO
          DISPLAY   *P41:20,*EL,*V2LON,HANS11;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES17    MOVE      SP20,CHDESC3
          KEYIN     *P41:21,*EL,*V2LON,CHDESC3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES18    KEYIN     *P41:22,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDESY18 IF EQUAL
          MATCH     "N",ANS
          GOTO      KDESN18 IF EQUAL
          BEEP
          GOTO      KDES18
.
KDESY18   MOVE      ONE,CHMAN3
          GOTO      KDES18S
.
KDESN18   MOVE      ZERO,CHMAN3
.
KDES18S   MOVE      DNO,HANS12
          LOAD      HANS12 USING CHMAN3 OF DYES,DNO
          DISPLAY   *P41:22,*EL,*V2LON,HANS12;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KDES19    KEYIN     *P41:23,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KDES19Y IF EQUAL
          MATCH     "N",ANS
          GOTO      KDES19N IF EQUAL
          BEEP
          GOTO      KDES19
.
KDES19Y   MOVE      ONE,PTCECODE
          GOTO      KDES19S
.
KDES19N   MOVE      ZERO,PTCECODE
.
KDES19S   MOVE      DNO,HANS13
          LOAD      HANS13 USING PTCECODE OF DYES,DNO
          DISPLAY   *P41:23,*EL,*V2LON,HANS13;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
DOHOSPC4  CALL      DISPHO4
          MOVE      ONE,OVRCD
          CALL      UPHOS4
          BRANCH    OVRCD OF START
          CALL      WRHOS4
          GOTO      START
.
DISPHO4   READ      CONTROLF,TEN;*36,CMDISD,CMOPRT:
                                *235,CMDISP,CMDISS,CMDISC,CMDISA
          READ      CONTROLF,TWENTY1;*217,CMDISL
          READ      CONTROLF,EIGHTY8;*44,PTCNTHAL
          READ      CONTROLF,NINTY8;*1,PTCNDCRP,PTCNDCRS,PTCNDCRC,PTCNDCRA:
                                   *41,PTCNDCRD,PTCNDCRO,PTCNDCRL
          READ      CONTROLF,HUNDRED5;*147,CMDISM,PTCNDCRM
.
          DISPLAY   *P58:2,*V2LON,"- Screen 4 ",*P1:3,*EF,*HOFF:
              *P1:04,*V2LON," 1",*HOFF,". Prefix for Primary Diseases             :":
              *P1:05,*V2LON," 2",*HOFF,". Prefix for Sequela Diseases             :":
              *P1:06,*V2LON," 3",*HOFF,". Prefix for Complications                :":
              *P1:07,*V2LON," 4",*HOFF,". Prefix for Associated Diseases          :":
              *P1:08,*V2LON," 5",*HOFF,". Prefix for Disability Dis. Codes        :":
              *P1:09,*V2LON," 6",*HOFF,". Prefix for Post-Surgical Op. Codes      :":
              *P1:10,*V2LON," 7",*HOFF,". Prefix for Length of Stay Disease       :":
              *P1:11,*V2LON," 8",*HOFF,". Thalassaemia Disease code for INP07     :":
              *P1:12,*V2LON," 9",*HOFF,". Description for Primary Diseases":
                                       "        : ":
              *P1:13,*V2LON,"10",*HOFF,". Description for Sequela Diseases":
                                       "        : ":
              *P1:14,*V2LON,"11",*HOFF,". Description for Complications":
                                        "           : ":
              *P1:15,*V2LON,"12",*HOFF,". Description for Associated":
                                        " Diseases     : ":
              *P1:16,*V2LON,"13",*HOFF,". Description for Disability":
                                        " Dis. Codes   : ":
              *P1:17,*V2LON,"14",*HOFF,". Description for Post-Surgical":
                                        " Op. Codes : ":
              *P1:18,*V2LON,"15",*HOFF,". Description for Length of Stay":
                                        " Disease  : ":
              *P1:19,*V2LON,"16",*HOFF,". Prefix for Morphology Disease           :":
              *P1:20,*V2LON,"17",*HOFF,". Description for Morphology":
                                        " Disease      : ":
              *P47:4,*V2LON,CMDISP:
              *P47:5,CMDISS:
              *P47:6,CMDISC:
              *P47:7,CMDISA:
              *P47:8,CMDISD:
              *P47:9,CMOPRT:
              *P47:10,CMDISL:
              *P47:11,PTCNTHAL:
              *P47:12,PTCNDCRP:
              *P47:13,PTCNDCRS:
              *P47:14,PTCNDCRC:
              *P47:15,PTCNDCRA:
              *P47:16,PTCNDCRD:
              *P47:17,PTCNDCRO:
              *P47:18,PTCNDCRL:
              *P47:19,CMDISM:
              *P47:20,PTCNDCRM;
          RETURN
+
.
UPHOS4    CALL      MAINQST
          MOVE      CCITEM,FIELD
          COMPARE   ZERO,FIELD
          GOTO      POST IF EQUAL
          GOTO      OVERCOND IF LESS
.
          BRANCH    FIELD,HS4K0100,HS4K0200,HS4K0300,HS4K0400,HS4K0500,HS4K0600:
                          HS4K0700,HS4K0800,HS4K0900,HS4K1000,HS4K1100,HS4K1200:
                          HS4K1300,HS4K1400,HS4K1500,HS4K1600,HS4K1700
          BEEP
          GOTO      UPHOS4
.
HS4K0100  KEYIN     *P47:4,*EL,*V2LON,CMDISP;
          DISPLAY   *P47:4,*EL,*V2LON,CMDISP;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0200  KEYIN     *P47:5,*EL,*V2LON,CMDISS;
          DISPLAY   *P47:5,*EL,*V2LON,CMDISS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0300  KEYIN     *P47:6,*EL,*V2LON,CMDISC;
          DISPLAY   *P47:6,*EL,*V2LON,CMDISC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0400  KEYIN     *P47:7,*EL,*V2LON,CMDISA;
          DISPLAY   *P47:7,*EL,*V2LON,CMDISA;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0500  KEYIN     *P47:8,*EL,*V2LON,CMDISD;
          DISPLAY   *P47:8,*EL,*V2LON,CMDISD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0600  KEYIN     *P47:9,*EL,*V2LON,CMOPRT;
          DISPLAY   *P47:9,*EL,*V2LON,CMOPRT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0700  KEYIN     *P47:10,*EL,*V2LON,CMDISL;
          DISPLAY   *P47:10,*EL,*V2LON,CMDISL;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
.         Get the thalassaemia disease code for INP07
.
HS4K0800  KEYIN     *P47:11,*EL,*V2LON,PTCNTHAL:
                    *P47:11,*DV,PTCNTHAL
.
          MOVE      PTCNTHAL,KEY9
          CALL      RDPTICD1
          IF        OVRCD=1 & ICDRDVER>1
            CALL      RD10T9D1
          ENDIF
          IF        OVRCD = 1
            DISPLAY   *P1:24,*EL,*B,"Disease code not on file.  ";
            CALL      HITENTER
            GOTO      HS4K0800
          ENDIF
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K0900  KEYIN     *P47:12,*EL,*V2LON,PTCNDCRP;
          DISPLAY   *P47:12,*EL,*V2LON,PTCNDCRP;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1000  KEYIN     *P47:13,*EL,*V2LON,PTCNDCRS;
          DISPLAY   *P47:13,*EL,*V2LON,PTCNDCRS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1100  KEYIN     *P47:14,*EL,*V2LON,PTCNDCRC;
          DISPLAY   *P47:14,*EL,*V2LON,PTCNDCRC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1200  KEYIN     *P47:15,*EL,*V2LON,PTCNDCRA;
          DISPLAY   *P47:15,*EL,*V2LON,PTCNDCRA;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1300  KEYIN     *P47:16,*EL,*V2LON,PTCNDCRD;
          DISPLAY   *P47:16,*EL,*V2LON,PTCNDCRD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1400  KEYIN     *P47:17,*EL,*V2LON,PTCNDCRO;
          DISPLAY   *P47:17,*EL,*V2LON,PTCNDCRO;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1500  KEYIN     *P47:18,*EL,*V2LON,PTCNDCRL;
          DISPLAY   *P47:18,*EL,*V2LON,PTCNDCRL;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1600  KEYIN     *P47:19,*EL,*V2LON,CMDISM;
          DISPLAY   *P47:19,*EL,*V2LON,CMDISM;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
HS4K1700  KEYIN     *P47:20,*EL,*V2LON,PTCNDCRM;
          DISPLAY   *P47:20,*EL,*V2LON,PTCNDCRM;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
POST      RETURN 
.
.
.         Subroutines to update the control file with the new values
.
WRHOS1    WRITAB    CONTROLF,TEN9;*1,CSURG1,*10,CMURG1,*18,CSURG2,*27,CMURG2:
                                 *35,CSURG3,*44,CMURG3,*52,CSURG4,*61,CMURG4:
                                 *69,CIPRG,COPRG,CAERG,CNBRG
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
WRHOS2    WRITAB    CONTROLF,TEN;*246,CSRCHDRG,CSRCHYRG
          WRITAB    CONTROLF,TEN4;*248,CURDEL,CURCHG
          WRITAB    CONTROLF,TEN9;*73,CPUSR,CSUSR,CCNOTES,*208,CPMIAD:
                                 *250,CPMS59
          WRITAB    CONTROLF,FIFTY9;*63,CFFMORB,*192,PTCNURCF,PTCNRQCF,PTCNDPCF:
                                        PTCNRLAY,PTCNUCOD,PTCNMRPN
          WRITAB    CONTROLF,HUND05;*100,PTCNUDRN
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
WRHOS3    WRITAB    CONTROLF,TEN9;*76,CRUSR1,CRDESC1,*97,CRMAN1,CRUSR2,CRDESC2:
                                 *119,CRMAN2,*120,CRUSR3,CRDESC3,*141,CRMAN3:
                                      CHUSR1,CHDESC1,*163,CHMAN1,CHUSR2,CHDESC2:
                                 *185,CHMAN2,CHUSR3,CHDESC3,*207,CHMAN3
          WRITAB    CONTROLF,TWENTY;*191,PTCECODE
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
WRHOS4    WRITAB    CONTROLF,TEN;*36,CMDISD,CMOPRT:
                                *235,CMDISP,CMDISS,CMDISC,CMDISA
          WRITAB    CONTROLF,TWENTY1;*217,CMDISL
          WRITAB    CONTROLF,EIGHTY8;*44,PTCNTHAL
          WRITAB    CONTROLF,NINTY8;*1,PTCNDCRP,PTCNDCRS,PTCNDCRC,PTCNDCRA:
                                   *41,PTCNDCRD,PTCNDCRO,PTCNDCRL
          WRITAB    CONTROLF,HUNDRED5;*147,CMDISM,PTCNDCRM
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
WRIBA1    WRITAB    CONTROLF,TWENTY1;*5,PTCNNCRG
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
ENDIT     CHAIN     PGM
          STOP
+
.==============================================================================
.
          INCLUDE   STD001IO
          INC       IBASECUR                * Keyin IBA screen security passwd
          INCLUDE   IBAPRTIO/INC
          INCLUDE   IBATMHIO/INC
          INC       PATCODIO/INC
          INC       PATICDIO/INC
          INC       PATIN1IO/INC
+
