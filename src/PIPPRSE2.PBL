          INC       STD001FD
.
TEMP1     FILE      ASCII, FIXED=240
TEMP2     FILE      ASCII, FIXED=240
.
.Name     Type   Length  Physical  Start  Description
.----     ----   ------  --------  -----  -----------
E2        DIM       2        2       1    Transaction type - E2
UNIQKEY   DIM       6        6       3    Unique key - episode no / admin no
EPIURNO   DIM       8        8       9    U/R number
EPISITID  DIM       1        1       17   Site id
EPIMEDI   DIM      11       11       18   Medicare number
EPIMCSFX  DIM       3        3       29   Medicare suffix
EPISEX    DIM       1        1       32   Sex
EPIMSTAT  DIM       1        1       33   Marital status
EPIBDATE  DIM       8        8       34   Date of birth (ddmmccyy)
EPIPOST   DIM       4        4       42   Postcode
EPISUBRB  DIM      22       22       46   Suburb/Locality
EPIADATR  DIM       8        8       68   Admission date (ddmmyy)
EPIATIME  DIM       4        4       76   Admission time
EPIATYPE  DIM       1        1       80   Admission type
EPIASRCE  DIM       1        1       81   Admission source
EPITSRCE  DIM       4        4       82   Transfer source code
.
EPILVMTD  DIM       2        2       86   Month to date leave days
EPILVTOT  DIM       3        3       88   Year to date leave days
EPILVYTD  DIM       3        3       91   Total leave days
.
EPIACST1  DIM       2        2       94   1st episode account status
EPIATYP1  DIM       1        1       96   1st episode Accommodation type
EPIQTYP1  DIM       1        1       97   1st episode qualification status
EPIABDP1  DIM       2        2       98   1st episode period to date bed days
EPIABDY1  DIM       3        3      100   1st episode year to date bed days
EPIABDA1  DIM       4        4      103   1st episode total bed days
.
EPIACST2  DIM       2        2      107   2nd episode account status
EPIATYP2  DIM       1        1      109   2nd episode Accommodation type
EPIQTYP2  DIM       1        1      110   2nd episode qualification status
EPIABDP2  DIM       2        2      111   2nd episode period to date bed days
EPIABDY2  DIM       3        3      113   2nd episode year to date bed days
EPIABDA2  DIM       4        4      116   2nd episode total bed days
.
EPIACST3  DIM       2        2      120   3rd episode account status
EPIATYP3  DIM       1        1      122   3rd episode Accommodation type
EPIQTYP3  DIM       1        1      123   3rd episode qualification status
EPIABDP3  DIM       2        2      124   3rd episode period to date bed days
EPIABDY3  DIM       3        3      126   3rd episode year to date bed days
EPIABDA3  DIM       4        4      129   3rd episode total bed days
.
EPIACST4  DIM       2        2      133   4th episode account status
EPIATYP4  DIM       1        1      135   4th episode Accommodation type
EPIQTYP4  DIM       1        1      136   4th episode qualification status
EPIABDP4  DIM       2        2      137   4th episode period to date bed days
EPIABDY4  DIM       3        3      139   4th episode year to date bed days
EPIABDA4  DIM       4        4      142   4th episode total bed days
.
EPIACST5  DIM       2        2      146   5th episode account status
EPIATYP5  DIM       1        1      148   5th episode Accommodation type
EPIQTYP5  DIM       1        1      149   5th episode qualification status
EPIABDP5  DIM       2        2      150   5th episode period to date bed days
EPIABDY5  DIM       3        3      152   5th episode year to date bed days
EPIABDA5  DIM       4        4      155   5th episode total bed days
.
EPIACST6  DIM       2        2      159   6th episode account status
EPIATYP6  DIM       1        1      161   6th episode Accommodation type
EPIQTYP6  DIM       1        1      162   6th episode qualification status
EPIABDP6  DIM       2        2      163   6th episode period to date bed days
EPIABDY6  DIM       3        3      165   6th episode year to date bed days
EPIABDA6  DIM       4        4      168   6th episode total bed days
.
EPIACST7  DIM       2        2      172   7th episode account status
EPIATYP7  DIM       1        1      174   7th episode Accommodation type
EPIQTYP7  DIM       1        1      175   7th episode qualification status
EPIABDP7  DIM       2        2      176   7th episode period to date bed days
EPIABDY7  DIM       3        3      178   7th episode year to date bed days
EPIABDA7  DIM       4        4      181   7th episode total bed days
.
EPISDATE  DIM       8        8      185   Separation date (ddmmccyy)
EPISTIME  DIM       4        4      193   Separation time
EPISTYPE  DIM       1        1      197   Separation type
EPISTRFR  DIM       4        4      198   Separation transfer/trans. destinatn
EPISREFL  DIM       4        4      202   Separation referral
EPICAVAL  DIM       1        1      206   Carer Availability
EPISACST  DIM       2        2      207   Separation account status/class
EPISATYP  DIM       1        1      209   Separation Accommodation type
EPISCTYP  DIM       1        1      210   Care type
EPNEWCOB  DIM       4        4      211   Country of birth code
EPABRGNL  DIM       1        1      215   Aboriginality
EPADCRTN  DIM       1        1      216   Criterion for admission
EPIINLOS  DIM       1        1      217   Intended LOS
EPHLTHFD  DIM       3        3      218   Health insurance fund
EPILINSR  DIM       1        1      221   Level of Insurance
EPIMNTLS  DIM       1        1      222   Mental health legal status
EPIPRGFS  DIM       1        1      223   Program funding source
EPISPFDA  DIM       1        1      224   Funding arrangement
EPICTTYP  DIM       1        1      225   Contract Type
EPICTROL  DIM       1        1      226   Contract Role
EPICTRID  DIM       4        4      227   Contract/Spoke Identifier
EPIPDCLD  DIM       2        2      231   Contract leave days (MTD)
EPIYDCLD  DIM       2        2      233   Contract leave days (YTD)
EPITLCLD  DIM       2        2      235   Total contract leave days
EPIUSERF  DIM       1        1      237   User flag
.SP3      DIM       3        3      338   3 spaces
.
.End of Record                      241
.
FILENAME  DIM       8
FORM6     FORM      6
PIPE      INIT      "|"
RECCNT    FORM      5
.
PRGID     INIT      "PIPPRSE2"
PRGNAM    INIT      "Pipe PRS/2 E2 Record"
VERSION   INIT      "V12.00.00"
.
ML0000    CALL      DISPHEAD
          MOVE      ZERO,RECCNT
          DISPLAY   *P1:4,*EF,"PRS/2 Filename : ";
ML1000    KEYIN     *P18:4,*EL,*V2LON,FILENAME;
.
          PACK      FILENAME,FILENAME,SP8
          MATCH     SP8,FILENAME
          GOTO      ML9999 IF EQUAL
.
          STRIP     FILENAME
          MOVE      "/XMT",KEY4
          PACK      KEY12,FILENAME,KEY4
          DISPLAY   *P18:4,*EL,*V2LON,*+,FILENAME,".XMT";
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMP1,KEY12
          TRAPCLR   IO
          IF        OVRCD=1
            DISPLAY   *P1:24,*EL,*B,"Filename not found.  "
            CALL      HITENTER
            GOTO      ML1000
          ENDIF
.
          DISPLAY   *P1:23,*V2LON,*BLINKON,"Loading Tempfile ...":
                    *P1:24,*HOFF,"Loading : ";
.
          PREP      TEMP2,"pipprse2"
.
ML2000    READ      TEMP1,SEQ;E2,UNIQKEY,EPIURNO,EPISITID,EPIMEDI:
                              EPIMCSFX,EPISEX,EPIMSTAT,EPIBDATE,EPIPOST:
                              EPISUBRB,EPIADATR,EPIATIME,EPIATYPE,EPIASRCE:
                              EPITSRCE,EPILVMTD,EPILVTOT,EPILVYTD,EPIACST1:
                              EPIATYP1,EPIQTYP1,EPIABDP1,EPIABDY1,EPIABDA1:
                              EPIACST2,EPIATYP2,EPIQTYP2,EPIABDP2,EPIABDY2:
                              EPIABDA2,EPIACST3,EPIATYP3,EPIQTYP3,EPIABDP3:
                              EPIABDY3,EPIABDA3,EPIACST4,EPIATYP4,EPIQTYP4:
                              EPIABDP4,EPIABDY4,EPIABDA4,EPIACST5,EPIATYP5:
                              EPIQTYP5,EPIABDP5,EPIABDY5,EPIABDA5,EPIACST6:
                              EPIATYP6,EPIQTYP6,EPIABDP6,EPIABDY6,EPIABDA6:
                              EPIACST7,EPIATYP7,EPIQTYP7,EPIABDP7,EPIABDY7:
                              EPIABDA7,EPISDATE,EPISTIME,EPISTYPE,EPISTRFR:
                              EPISREFL,EPICAVAL,EPISACST,EPISATYP,EPISCTYP:
                              EPNEWCOB,EPABRGNL,EPADCRTN,EPIINLOS,EPHLTHFD:
                              EPILINSR,EPIMNTLS,EPIPRGFS,EPISPFDA,EPICTTYP:
                              EPICTROL,EPICTRID,EPIPDCLD,EPIYDCLD,EPITLCLD:
                              EPIUSERF,SP3
          GOTO      ML3000 IF OVER
.
          MATCH     "E2",E2
          GOTO      ML2000 IF NOT EQUAL
.
          ADD       ONE,RECCNT
          IF        RECCNT%10=1
            DISPLAY   *P11:24,*V2LON,RECCNT;
          ENDIF
.
          WRITE     TEMP2,SEQ;E2,PIPE,UNIQKEY,PIPE,EPIURNO:
                              PIPE,EPISITID,PIPE,EPIMEDI,PIPE:
                              EPIMCSFX,PIPE,EPISEX,PIPE,EPIMSTAT:
                              PIPE,EPIBDATE,PIPE,EPIPOST,PIPE:
                              EPISUBRB,PIPE,EPIADATR,PIPE,EPIATIME:
                              PIPE,EPIATYPE,PIPE,EPIASRCE,PIPE:
                              EPITSRCE,PIPE,EPILVMTD,PIPE,EPILVTOT:
                              PIPE,EPILVYTD,PIPE,EPIACST1,PIPE:
                              EPIATYP1,PIPE,EPIQTYP1,PIPE,EPIABDP1:
                              PIPE,EPIABDY1,PIPE,EPIABDA1,PIPE:
                              EPIACST2,PIPE,EPIATYP2,PIPE,EPIQTYP2:
                              PIPE,EPIABDP2,PIPE,EPIABDY2,PIPE:
                              EPIABDA2,PIPE,EPIACST3,PIPE,EPIATYP3:
                              PIPE,EPIQTYP3,PIPE,EPIABDP3,PIPE:
                              EPIABDY3,PIPE,EPIABDA3,PIPE,EPIACST4:
                              PIPE,EPIATYP4,PIPE,EPIQTYP4,PIPE:
                              EPIABDP4,PIPE,EPIABDY4,PIPE,EPIABDA4:
                              PIPE,EPIACST5,PIPE,EPIATYP5,PIPE:
                              EPIQTYP5,PIPE,EPIABDP5,PIPE,EPIABDY5:
                              PIPE,EPIABDA5,PIPE,EPIACST6,PIPE:
                              EPIATYP6,PIPE,EPIQTYP6,PIPE,EPIABDP6:
                              PIPE,EPIABDY6,PIPE,EPIABDA6,PIPE:
                              EPIACST7,PIPE,EPIATYP7,PIPE,EPIQTYP7:
                              PIPE,EPIABDP7,PIPE,EPIABDY7,PIPE:
                              EPIABDA7,PIPE,EPISDATE,PIPE,EPISTIME:
                              PIPE,EPISTYPE,PIPE,EPISTRFR,PIPE:
                              EPISREFL,PIPE,EPICAVAL,PIPE,EPISACST:
                              PIPE,EPISATYP,PIPE,EPISCTYP,PIPE:
                              EPNEWCOB,PIPE,EPABRGNL,PIPE,EPADCRTN:
                              PIPE,EPIINLOS,PIPE,EPHLTHFD,PIPE:
                              EPILINSR,PIPE,EPIMNTLS,PIPE,EPIPRGFS:
                              PIPE,EPISPFDA,PIPE,EPICTTYP,PIPE:
                              EPICTROL,PIPE,EPICTRID,PIPE,EPIPDCLD:
                              PIPE,EPIYDCLD,PIPE,EPITLCLD,PIPE:
                              EPIUSERF,PIPE,SP3,PIPE
          GOTO      ML2000
.
ML3000    DISPLAY   *P1:22,*EF,*B:
                    *P1:23,"File created   : pipprse2.txt":
                    *P1:24,"Records loaded : ",*V2LON,RECCNT,".  ";
          CALL      HITEXIT
.
ML9999    CHAIN     PGM
.
          INC       STD001IO
+
.

