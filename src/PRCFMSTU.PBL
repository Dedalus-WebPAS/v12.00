.******************************************************************************
.* System    :   Accounting System                                            *
.* Procedure :   PRCFMSTU                                                     *
.* Desc      :   Actual for cash and accrual Total Account Update             *
.******************************************************************************
.* Date      :   11.10.90                                                     *
.* Author    :   B.G.Ackland (IBA)                                            *
.* Mods      :   29/10/1990  Neeriem Dye  Fixed to Accomodate Stat Accounts   *
.*                                                                            *
.*               26.08.91  Neeriem Dye (IBA)                                  *
.*                         Modified to move zero to a var divided by zero     *
.*                                                                            *
.*               18.11.91  Neeriem Dye (IBA)                                  *
.*                         Stopped data changing if update run more than once *
.*                         srf 111774                                         *
.*                                                                            *
.*               01.04.92 Neeriem Dye (IBA)                                   *
.*                     Fix update to not grab mysterious figures from nowhere *
.*                     srf undesirable                                        *
.*                                                                            *
.*                     21.10.93 Neeriem "I Hate Support" Dye (I.B.A.)         *
.*                     Modified for new committed expenditure field           *
.*                     srf HWK                                                *
.*                                                                            *
.******************************************************************************
.$$$$$$
.Update Procedure - DEFPROC
.----------------
.INCLUDE NAME - PRCFMSTU.PBL
.
.For the Financial Year passed to this procedure perform the following.
.
.1. OPEN Actuals by Period     - fmspYYYY   where YYYY = Financial Year
.   OPEN Account Master File   - fmsamaaf
.   OPEN Report Calculation    - fmstcfaf
.   OPEN Ledger Master File    - fmslmaaf
.
.2. Pass 1 Clear Totals
.   if program id = IBAFMS90 Display "Clearing : " on line 24
.   Loop through the account master file by index 4 by account type report level
.   FMSAMAA4  IFILE  SQL, FIXED=345, KEY="U53-53,310-312,1-2,3-14" * Calculation
.     for all account of Type 6 and 9. ( ie Total Accounts  and Stats Totals)
.     if program id = IBAFMS90 Display Each Account on line 24
.     Read Actuals file
.        If no record exists
.             Continue Loop
.        if record exists
.             Move Zero to All Values and Update Record
.             Continue Loop
.        
.
.3. Pass 2 Accumulate Total Accounts
.   if program id = IBAFMS90 Display "Accumulating : " on line 24
.   Loop through the account reporting sequence file by index 3
.   FMSARSA3  IFILE  SQL, FIXED=71, KEY="U3-4,27-29,15-26,1-2"  * Total Calc 
.   if program id = IBAFMS90 Display Each Account on line 24
.   Read Actuals Record
.       If no record exists
.            Continue Loop
.       If record exists
.            Move period values to save values
.            Read Actuals record for Addto Ledger/Account
.                 If no record exists
.                    Write new record with saved period values
.                    Continue loop
.                 If record exists
.                    Add period values 
.                    Update Total Record
.                    Continue Loop
.
.$$$$$$
.
.==============================================================================
.FILE DESCRIPTION INCLUDES
.-------------------------
          DEFPROC   FMSTU000
          INC       FMSAMAFD/INC      * Account Master file
          INC       FMSCONFD/INC      * Control File
          INC       FMSFPSFD/INC      * Financial Summary File
          INC       FMSLMAFD/INC      * Ledger Master File
          INC       FMSSMAFD/INC      * Stats Summary
          INC       FMSTCFFD/INC      * Total Calculation
.
.==============================================================================
.LOCAL VARIABLE DEFINITION
.-------------------------
ACTFILE   DIM       8
F12P6     FORM      12.6
SAVACCT   DIM       14
SAVLEVEL  DIM       3
.
SAV01A    FORM      12.6
SAV02A    FORM      12.6
SAV03A    FORM      12.6
SAV04A    FORM      12.6
SAV05A    FORM      12.6
SAV06A    FORM      12.6
SAV07A    FORM      12.6
SAV08A    FORM      12.6
SAV09A    FORM      12.6
SAV10A    FORM      12.6
SAV11A    FORM      12.6
SAV12A    FORM      12.6
SAV13A    FORM      12.6
.
SAV01C    FORM      12.6
SAV02C    FORM      12.6
SAV03C    FORM      12.6
SAV04C    FORM      12.6
SAV05C    FORM      12.6
SAV06C    FORM      12.6
SAV07C    FORM      12.6
SAV08C    FORM      12.6
SAV09C    FORM      12.6
SAV10C    FORM      12.6
SAV11C    FORM      12.6
SAV12C    FORM      12.6
SAV13C    FORM      12.6
.
SAVCBF    FORM      12.2
SAVC01    FORM      12.2
SAVC02    FORM      12.2
SAVC03    FORM      12.2
SAVC04    FORM      12.2
SAVC05    FORM      12.2
SAVC06    FORM      12.2
SAVC07    FORM      12.2
SAVC08    FORM      12.2
SAVC09    FORM      12.2
SAVC10    FORM      12.2
SAVC11    FORM      12.2
SAVC12    FORM      12.2
SAVC13    FORM      12.2
.
SAVCBFD   FORM      12
SAVC01D   FORM      12
SAVC02D   FORM      12
SAVC03D   FORM      12
SAVC04D   FORM      12
SAVC05D   FORM      12
SAVC06D   FORM      12
SAVC07D   FORM      12
SAVC08D   FORM      12
SAVC09D   FORM      12
SAVC10D   FORM      12
SAVC11D   FORM      12
SAVC12D   FORM      12
SAVC13D   FORM      12
.
SAVCBFT   FORM      9
SAVC01T   FORM      9
SAVC02T   FORM      9
SAVC03T   FORM      9
SAVC04T   FORM      9
SAVC05T   FORM      9
SAVC06T   FORM      9
SAVC07T   FORM      9
SAVC08T   FORM      9
SAVC09T   FORM      9
SAVC10T   FORM      9
SAVC11T   FORM      9
SAVC12T   FORM      9
SAVC13T   FORM      9
.
SAVABF    FORM      12.2
SAVA01    FORM      12.2
SAVA02    FORM      12.2
SAVA03    FORM      12.2
SAVA04    FORM      12.2
SAVA05    FORM      12.2
SAVA06    FORM      12.2
SAVA07    FORM      12.2
SAVA08    FORM      12.2
SAVA09    FORM      12.2
SAVA10    FORM      12.2
SAVA11    FORM      12.2
SAVA12    FORM      12.2
SAVA13    FORM      12.2
.
SAVABFD   FORM      12
SAVA01D   FORM      12
SAVA02D   FORM      12
SAVA03D   FORM      12
SAVA04D   FORM      12
SAVA05D   FORM      12
SAVA06D   FORM      12
SAVA07D   FORM      12
SAVA08D   FORM      12
SAVA09D   FORM      12
SAVA10D   FORM      12
SAVA11D   FORM      12
SAVA12D   FORM      12
SAVA13D   FORM      12
.
SAVABFT   FORM      9
SAVA01T   FORM      9
SAVA02T   FORM      9
SAVA03T   FORM      9
SAVA04T   FORM      9
SAVA05T   FORM      9
SAVA06T   FORM      9
SAVA07T   FORM      9
SAVA08T   FORM      9
SAVA09T   FORM      9
SAVA10T   FORM      9
SAVA11T   FORM      9
SAVA12T   FORM      9
SAVA13T   FORM      9
.
SAVCOM    FORM      12.2
SAVCOM2   FORM      12.2
SAVCOMD   FORM      12
SAVCOMT   FORM      9
STATFILE  DIM       8
SAVKEY18  DIM       18
RECCOUNT  FORM      8
.
.******************************************************************************
.*  MAINLINE - Controlling Logic                                              *
.******************************************************************************
ML0000    CALL      INIT0000           * display heading and open files
          BRANCH    EXIT,ML9999
.
ML0100    CALL      CALC0000           * Clear Total and Stats Total Records
.
ML9999    GOTO      FMSTU999
.
.******************************************************************************
.* INIT - Open Files                             Called by ML0000             *
.******************************************************************************
INIT0000  CLEAR     ACTFILE
          APPEND    "fmsp",ACTFILE
          APPEND    FINYEAR,ACTFILE
          RESET     ACTFILE
          REP       " 0",ACTFILE
.
          CLEAR     STATFILE
          APPEND    "fmss",STATFILE
          APPEND    FINYEAR,STATFILE
          RESET     STATFILE
          REP       " 0",STATFILE
.
          MATCH     "IBAFMS90",PRGID
          GOTO      INIT1000 IF NOT EQUAL
.
          DISPLAY   *P50:24,"Opening fmsamaa1";
          OPEN      FMSAMAA1,"fmsamaaf"
.
          DISPLAY   *P58:24,"fmsamaa2";
          OPEN      FMSAMAA2,"fmsamaaf"
.
          DISPLAY   *P58:24,"fmsamaa4";
          OPEN      FMSAMAA4,"fmsamaaf"
.
          DISPLAY   *P58:24,"fmstcfa1";
          OPEN      FMSTCFA1,"fmstcfaf"
.
          DISPLAY   *P58:24,"fmslmaa1";
          OPEN      FMSLMAA1,"fmslmaaf"
.
          DISPLAY   *P58:24,"controlf"
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P58:24,ACTFILE
          GOTO      INIT2000
.
INIT1000  OPEN      FMSAMAA1,"fmsamaaf"
          OPEN      FMSAMAA2,"fmsamaaf"
          OPEN      FMSAMAA4,"fmsamaaf"
          OPEN      FMSTCFA1,"fmsarsaf"
          OPEN      FMSLMAA1,"fmslmaaf"
          OPEN      CONTROLF,"controlf"
          CALL      RDFMCO52
.
INIT2000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMSSMAA1,STATFILE
          TRAPCLR   IO
          MOVE      ZERO,EXIT
          COMPARE   ZERO,OVRCD
          GOTO      INIT3000 IF EQUAL  * stat file not found ?
          MOVE      SP70,STATFILE
.
INIT3000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMSFPSA1,ACTFILE
          TRAPCLR   IO
          MOVE      ZERO,EXIT
          COMPARE   ZERO,OVRCD
          GOTO      INIT9999 IF EQUAL
.
          MOVE      ONE,EXIT     * No file for this Financial Year
          MATCH     "IBAFMS90",PRGID
          GOTO      INIT9999 IF NOT EQUAL
          DISPLAY   *P1:24,*EL,"Actuals file ",ACTFILE," does not exist - ";
          CALL      HITENTER
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.******************************************************************************
.* CALC - Calculate totals                       Called by ML0000             *
.******************************************************************************
CALC0000  MATCH     "IBAFMS90",PRGID
          IF        @EQUAL
            CLOCK     TIME,CTIMEIS
            MOVE      ZERO,RECCOUNT
            DISPLAY   *P1:20,*EL,"Financial Totals Started - ",CTIMEIS
            DISPLAY   *P1:24,*EL,"Financial Totals - "
          ENDIF
          PACK      KEY18,SIX,SP70
          CALL      RSFMAM4
CALC1000  CALL      RKFMAM4
          BRANCH    OVRCD,CALC2000
          MATCH     "6",FMAMTYPE
          GOTO      CALC2000 IF NOT EQUAL
.
          MATCH     "IBAFMS90",PRGID
          IF        @EQUAL 
            ADD       ONE,RECCOUNT
            IF        RECCOUNT%500=0
              CLOCK     TIME,CTIMEIS
              DISPLAY   *P25:24,*V2LON,RECCOUNT,SP1,KEY18,SP1,CTIMEIS
            ENDIF
          ENDIF
.
          CALL      MZTS0000       * Move Zero to Save Variables
.
          PACK      SAVLEVEL,FMAMCLEV,SP70
          PACK      SAVACCT,FMAMLEDG,FMAMACCT,SP70
          CALL      CALF0000       * Calculate Financial Total
.
          PACK      KEY14,SAVACCT,SP70
          UNPACK    KEY14,FMFPCULD,FMFPCUAC
          CALL      RDFMFP1
          BRANCH    OVRCD,CALC1200
.
          CALL      MSTA0000       * Move Save to File Variables
          CALL      UPFMFP1
          GOTO      CALC1000
.
CALC1200  
          MOVE      SP70,FMFPSPAR
          CALL      MSTA0000       * Move Save to File Variables
          CALL      WRFMFP1
          GOTO      CALC1000
.
. Statistical Calculations
.
CALC2000  MATCH     SP70,STATFILE
          GOTO      CALC9999 IF EQUAL  * no stat file ?
          PACK      KEY18,NINE,SP70
          MATCH     "IBAFMS90",PRGID
          IF        @EQUAL 
            CLOCK     TIME,CTIMEIS
            MOVE      ZERO,RECCOUNT
            DISPLAY   *P1:21,*EL,"Statistical Totals Started - ",CTIMEIS
            DISPLAY   *P1:24,*EL,"Statistical Totals - ";
          ENDIF
.
CALC3000  CALL      RSFMAM4
          CALL      RKFMAM4
          BRANCH    OVRCD,CALC9999
          MATCH     "9",FMAMTYPE
          GOTO      CALC9999 IF NOT EQUAL
.
          PACK      SAVKEY18,FMAMTYPE,FMAMCLEV,FMAMLEDG,FMAMACCT
          MATCH     "IBAFMS90",PRGID
          IF        @EQUAL 
            ADD       ONE,RECCOUNT
            IF        RECCOUNT%500=0
              CLOCK     TIME,CTIMEIS
              DISPLAY   *P25:24,*V2LON,RECCOUNT,SP1,KEY18,SP1,CTIMEIS
            ENDIF
          ENDIF
.
          CALL      MZSS0000       * Move Zeros to Saved Amounts
.
          PACK      SAVLEVEL,FMAMCLEV,SP70
          PACK      SAVACCT,FMAMLEDG,FMAMACCT,SP70
          CALL      CALS0000       * Calculate Statistical Totals
.
          PACK      KEY14,SAVACCT,SP70
          UNPACK    KEY14,FMSSLEDG,FMSSACCT
          CALL      RDFMSS1
          BRANCH    OVRCD,CALC3200
.
          CALL      MSTF0000       * Move Saved Amounts to FIle Totals
          CALL      UPFMSS1
          GOTO      CALC4000
.
CALC3200  
          CALL      MSTF0000       * Move Saved Amounts to FIle Totals
          CALL      WRFMSS1
.
CALC4000  MOVE      SAVKEY18,KEY18
          GOTO      CALC3000
.
CALC9999  MATCH     "IBAFMS90",PRGID
          IF        @EQUAL 
            CLOCK     TIME,CTIMEIS
            DISPLAY   *P1:22,*EL,"Statistical Totals Finished- ",CTIMEIS
            DISPLAY   *P1:24,*EL;
            CALL      HITENTER
          ENDIF
          RETURN
.**********************************************************************
.* Calculate Financial Total Account
.**********************************************************************
CALF0000  PACK      KEY33,FMAMLEDG,FMAMACCT
          CALL      RSFMTC1
.
CALF1000  CALL      RKFMTC1
          BRANCH    OVRCD,CALF9999
.
          UNPACK    SAVACCT,FMAMLEDG,FMAMACCT
.
          MATCH     FMAMLEDG,FMTCTLED
          GOTO      CALF9999 IF NOT EQUAL
.
          MATCH     FMAMACCT,FMTCTACC
          GOTO      CALF9999 IF NOT EQUAL
.
          CALL      CLEV0000           * check if level ok
          BRANCH    EXIT,CALF1000
.
          PACK      KEY14,FMTCSLED,FMTCSACC
          CALL      RDFMFP1            * Get Summary Details
          BRANCH    OVRCD,CALF1000
.
          CALL      ADDF0000           * Add Sub total to Saved Totals
.
          GOTO      CALF1000
.
CALF9999  RETURN
.**********************************************************************
.* Calculate Statistical Total Account
.**********************************************************************
CALS0000  PACK      KEY33,FMAMLEDG,FMAMACCT
          PACK      SAVACCT,FMAMLEDG,FMAMACCT
          CALL      RSFMTC1
.
CALS1000  CALL      RKFMTC1
          BRANCH    OVRCD,CALS9000
.
          UNPACK    SAVACCT,FMAMLEDG,FMAMACCT
.
          MATCH     FMAMLEDG,FMTCTLED
          GOTO      CALS9000 IF NOT EQUAL
.
          MATCH     FMAMACCT,FMTCTACC
          GOTO      CALS9000 IF NOT EQUAL
.
          CALL      CLEV0000           * check if level ok
          BRANCH    EXIT,CALS1000
.
          MATCH     "7",FMAMTYPE
          GOTO      CALS2000 IF NOT LESS   * stat record
.
          CALL      RDFMFP1
          BRANCH    OVRCD,CALS1000     * get data from nornal sub-account
.
          MOVE      FMFPABF,FMSSA1
          MOVE      FMFPCBF,FMSSC1
          ADD       FMFPA01,FMSSA1
          ADD       FMFPC01,FMSSC1
          MOVE      FMFPA02,FMSSA2
          MOVE      FMFPC02,FMSSC2
          MOVE      FMFPA03,FMSSA3
          MOVE      FMFPC03,FMSSC3
          MOVE      FMFPA04,FMSSA4
          MOVE      FMFPC04,FMSSC4
          MOVE      FMFPA05,FMSSA5
          MOVE      FMFPC05,FMSSC5
          MOVE      FMFPA06,FMSSA6
          MOVE      FMFPC06,FMSSC6
          MOVE      FMFPA07,FMSSA7
          MOVE      FMFPC07,FMSSC7
          MOVE      FMFPA08,FMSSA8
          MOVE      FMFPC08,FMSSC8
          MOVE      FMFPA09,FMSSA9
          MOVE      FMFPC09,FMSSC9
          MOVE      FMFPA10,FMSSA10
          MOVE      FMFPC10,FMSSC10
          MOVE      FMFPA11,FMSSA11
          MOVE      FMFPC11,FMSSC11
          MOVE      FMFPA12,FMSSA12
          MOVE      FMFPC12,FMSSC12
          MOVE      FMFPA13,FMSSA13
          MOVE      FMFPC13,FMSSC13
          GOTO      CALS3000
.
CALS2000  CALL      RDFMSS1
          BRANCH    OVRCD,CALS1000     * get data from stat sub-account
.
CALS3000  CALL      ADDS0000           * Add Sub total to Saved Totals (stats)
.
          GOTO      CALS1000
.
CALS9000  MOVE      SAVACCT,KEY14      * Read back masterfile record and 
          CALL      RDFMAM1            * mult/div by constants
          BRANCH    OVRCD,CALS9999
          CALL      MAMT0000
.
CALS9999  RETURN
.**********************************************************************
.  CLEV - Check add to levels                          Called By lots
.        Requires - SAVLEVEL (total account level)
.        Returns  - EXIT     (1=level or account invalid)
.**********************************************************************
CLEV0000  PACK      KEY14,FMTCSLED,FMTCSACC,SP70
          CALL      RDFMAM1
          BRANCH    OVRCD,CLEV9500          * account not found ?
.
          MATCH     SAVLEVEL,FMAMCLEV
          GOTO      CLEV9500 IF NOT LESS    * level less than add to account ?
.
CLEV9000  MOVE      ZERO,EXIT          * continue
          GOTO      CLEV9999
.
CLEV9500  MOVE      ONE,EXIT           * quit
.
CLEV9999  RETURN
.**********************************************************************
.* Mult Amounts by Constant                                           *
.**********************************************************************
MAMT0000  MOVE      FMAMMULT,F12P6     * get constant
          MOVE      FMAMDIV,CDIV1
          MOVE      F12P6,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,F12P6
.
          MULT      F12P6,SAV01A
          MULT      F12P6,SAV02A
          MULT      F12P6,SAV03A
          MULT      F12P6,SAV04A
          MULT      F12P6,SAV05A
          MULT      F12P6,SAV06A
          MULT      F12P6,SAV07A
          MULT      F12P6,SAV08A
          MULT      F12P6,SAV09A
          MULT      F12P6,SAV10A
          MULT      F12P6,SAV11A
          MULT      F12P6,SAV12A
          MULT      F12P6,SAV13A
.
          MULT      F12P6,SAV01C
          MULT      F12P6,SAV02C
          MULT      F12P6,SAV03C
          MULT      F12P6,SAV04C
          MULT      F12P6,SAV05C
          MULT      F12P6,SAV06C
          MULT      F12P6,SAV07C
          MULT      F12P6,SAV08C
          MULT      F12P6,SAV09C
          MULT      F12P6,SAV10C
          MULT      F12P6,SAV11C
          MULT      F12P6,SAV12C
          MULT      F12P6,SAV13C
.
MAMT9999  RETURN
.**********************************************************************
.* Add stats records to temps
.**********************************************************************
ADDS0000  MOVE      FMTCADDT,F1
          BRANCH    F1,ADDS2000,ADDS3000,ADDS4000 * 0=add,1=sub,2=div,3=mult
.
. add
.
ADDS1000  
          ADD       FMSSA1,SAV01A
          ADD       FMSSA2,SAV02A
          ADD       FMSSA3,SAV03A
          ADD       FMSSA4,SAV04A
          ADD       FMSSA5,SAV05A
          ADD       FMSSA6,SAV06A
          ADD       FMSSA7,SAV07A
          ADD       FMSSA8,SAV08A
          ADD       FMSSA9,SAV09A
          ADD       FMSSA10,SAV10A
          ADD       FMSSA11,SAV11A
          ADD       FMSSA12,SAV12A
          ADD       FMSSA13,SAV13A
.
          ADD       FMSSC1,SAV01C
          ADD       FMSSC2,SAV02C
          ADD       FMSSC3,SAV03C
          ADD       FMSSC4,SAV04C
          ADD       FMSSC5,SAV05C
          ADD       FMSSC6,SAV06C
          ADD       FMSSC7,SAV07C
          ADD       FMSSC8,SAV08C
          ADD       FMSSC9,SAV09C
          ADD       FMSSC10,SAV10C
          ADD       FMSSC11,SAV11C
          ADD       FMSSC12,SAV12C
          ADD       FMSSC13,SAV13C
.
          GOTO      ADDS9999
.
. sub
.
ADDS2000  
          SUB       FMSSA1,SAV01A
          SUB       FMSSA2,SAV02A
          SUB       FMSSA3,SAV03A
          SUB       FMSSA4,SAV04A
          SUB       FMSSA5,SAV05A
          SUB       FMSSA6,SAV06A
          SUB       FMSSA7,SAV07A
          SUB       FMSSA8,SAV08A
          SUB       FMSSA9,SAV09A
          SUB       FMSSA10,SAV10A
          SUB       FMSSA11,SAV11A
          SUB       FMSSA12,SAV12A
          SUB       FMSSA13,SAV13A
.
          SUB       FMSSC1,SAV01C
          SUB       FMSSC2,SAV02C
          SUB       FMSSC3,SAV03C
          SUB       FMSSC4,SAV04C
          SUB       FMSSC5,SAV05C
          SUB       FMSSC6,SAV06C
          SUB       FMSSC7,SAV07C
          SUB       FMSSC8,SAV08C
          SUB       FMSSC9,SAV09C
          SUB       FMSSC10,SAV10C
          SUB       FMSSC11,SAV11C
          SUB       FMSSC12,SAV12C
          SUB       FMSSC13,SAV13C
.
          GOTO      ADDS9999
.
. div
.
ADDS3000  
          MOVE      FMSSA1,CDIV1
          MOVE      SAV01A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV01A
.
          MOVE      FMSSA2,CDIV1
          MOVE      SAV02A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV02A
.
          MOVE      FMSSA3,CDIV1
          MOVE      SAV03A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV03A
.
          MOVE      FMSSA4,CDIV1
          MOVE      SAV04A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV04A
.
          MOVE      FMSSA5,CDIV1
          MOVE      SAV05A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV05A
.
          MOVE      FMSSA6,CDIV1
          MOVE      SAV06A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV06A
.
          MOVE      FMSSA7,CDIV1
          MOVE      SAV07A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV07A
.
          MOVE      FMSSA8,CDIV1
          MOVE      SAV08A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV08A
.
          MOVE      FMSSA9,CDIV1
          MOVE      SAV09A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV09A
.
          MOVE      FMSSA10,CDIV1
          MOVE      SAV10A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV10A
.
          MOVE      FMSSA11,CDIV1
          MOVE      SAV11A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV11A
.
          MOVE      FMSSA12,CDIV1
          MOVE      SAV12A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV12A
.
          MOVE      FMSSA13,CDIV1
          MOVE      SAV13A,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV13A
.
.
          MOVE      FMSSC1,CDIV1
          MOVE      SAV01C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV01C
.
          MOVE      FMSSC2,CDIV1
          MOVE      SAV02C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV02C
.
          MOVE      FMSSC3,CDIV1
          MOVE      SAV03C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV03C
.
          MOVE      FMSSC4,CDIV1
          MOVE      SAV04C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV04C
.
          MOVE      FMSSC5,CDIV1
          MOVE      SAV05C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV05C
.
          MOVE      FMSSC6,CDIV1
          MOVE      SAV06C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV06C
.
          MOVE      FMSSC7,CDIV1
          MOVE      SAV07C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV07C
.
          MOVE      FMSSC8,CDIV1
          MOVE      SAV08C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV08C
.
          MOVE      FMSSC9,CDIV1
          MOVE      SAV09C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV09C
.
          MOVE      FMSSC10,CDIV1
          MOVE      SAV10C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV10C
.
          MOVE      FMSSC11,CDIV1
          MOVE      SAV11C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV11C
.
          MOVE      FMSSC12,CDIV1
          MOVE      SAV12C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV12C
.
          MOVE      FMSSC13,CDIV1
          MOVE      SAV13C,CDIV2
          CALL      CDIV0000
          MOVE      CDIV2,SAV13C
.
.
          GOTO      ADDS9999
.
. mult
.
ADDS4000  
          MULT      FMSSA1,SAV01A
          MULT      FMSSA2,SAV02A
          MULT      FMSSA3,SAV03A
          MULT      FMSSA4,SAV04A
          MULT      FMSSA5,SAV05A
          MULT      FMSSA6,SAV06A
          MULT      FMSSA7,SAV07A
          MULT      FMSSA8,SAV08A
          MULT      FMSSA9,SAV09A
          MULT      FMSSA10,SAV10A
          MULT      FMSSA11,SAV11A
          MULT      FMSSA12,SAV12A
          MULT      FMSSA13,SAV13A
.
          MULT      FMSSC1,SAV01C
          MULT      FMSSC2,SAV02C
          MULT      FMSSC3,SAV03C
          MULT      FMSSC4,SAV04C
          MULT      FMSSC5,SAV05C
          MULT      FMSSC6,SAV06C
          MULT      FMSSC7,SAV07C
          MULT      FMSSC8,SAV08C
          MULT      FMSSC9,SAV09C
          MULT      FMSSC10,SAV10C
          MULT      FMSSC11,SAV11C
          MULT      FMSSC12,SAV12C
          MULT      FMSSC13,SAV13C
.
          GOTO      ADDS9999
.
ADDS9999  RETURN
.**********************************************************************
. Move Zero to all stats Saved Amounts
.**********************************************************************
MZSS0000  
          MOVE      ZERO,SAV01A
          MOVE      ZERO,SAV02A
          MOVE      ZERO,SAV03A
          MOVE      ZERO,SAV04A
          MOVE      ZERO,SAV05A
          MOVE      ZERO,SAV06A
          MOVE      ZERO,SAV07A
          MOVE      ZERO,SAV08A
          MOVE      ZERO,SAV09A
          MOVE      ZERO,SAV10A
          MOVE      ZERO,SAV11A
          MOVE      ZERO,SAV12A
          MOVE      ZERO,SAV13A
.
          MOVE      ZERO,SAV01C
          MOVE      ZERO,SAV02C
          MOVE      ZERO,SAV03C
          MOVE      ZERO,SAV04C
          MOVE      ZERO,SAV05C
          MOVE      ZERO,SAV06C
          MOVE      ZERO,SAV07C
          MOVE      ZERO,SAV08C
          MOVE      ZERO,SAV09C
          MOVE      ZERO,SAV10C
          MOVE      ZERO,SAV11C
          MOVE      ZERO,SAV12C
          MOVE      ZERO,SAV13C
.
          RETURN
.**********************************************************************
. Move Save Stats to File
.**********************************************************************
MSTF0000  MOVE      SP70,FMSSSPAR
          MOVE      SAV01A,FMSSA1
          MOVE      SAV02A,FMSSA2
          MOVE      SAV03A,FMSSA3
          MOVE      SAV04A,FMSSA4
          MOVE      SAV05A,FMSSA5
          MOVE      SAV06A,FMSSA6
          MOVE      SAV07A,FMSSA7
          MOVE      SAV08A,FMSSA8
          MOVE      SAV09A,FMSSA9
          MOVE      SAV10A,FMSSA10
          MOVE      SAV11A,FMSSA11
          MOVE      SAV12A,FMSSA12
          MOVE      SAV13A,FMSSA13
.
          MOVE      SAV01C,FMSSC1
          MOVE      SAV02C,FMSSC2
          MOVE      SAV03C,FMSSC3
          MOVE      SAV04C,FMSSC4
          MOVE      SAV05C,FMSSC5
          MOVE      SAV06C,FMSSC6
          MOVE      SAV07C,FMSSC7
          MOVE      SAV08C,FMSSC8
          MOVE      SAV09C,FMSSC9
          MOVE      SAV10C,FMSSC10
          MOVE      SAV11C,FMSSC11
          MOVE      SAV12C,FMSSC12
          MOVE      SAV13C,FMSSC13
.
          RETURN
.**********************************************************************
. Move Zero to sav variables for calculation
.**********************************************************************
MZTS0000  MOVE      ZERO,SAVCBF
          MOVE      ZERO,SAVC01
          MOVE      ZERO,SAVC02
          MOVE      ZERO,SAVC03
          MOVE      ZERO,SAVC04
          MOVE      ZERO,SAVC05
          MOVE      ZERO,SAVC06
          MOVE      ZERO,SAVC07
          MOVE      ZERO,SAVC08
          MOVE      ZERO,SAVC09
          MOVE      ZERO,SAVC10
          MOVE      ZERO,SAVC11
          MOVE      ZERO,SAVC12
          MOVE      ZERO,SAVC13
          MOVE      ZERO,SAVABF
          MOVE      ZERO,SAVA01
          MOVE      ZERO,SAVA02
          MOVE      ZERO,SAVA03
          MOVE      ZERO,SAVA04
          MOVE      ZERO,SAVA05
          MOVE      ZERO,SAVA06
          MOVE      ZERO,SAVA07
          MOVE      ZERO,SAVA08
          MOVE      ZERO,SAVA09
          MOVE      ZERO,SAVA10
          MOVE      ZERO,SAVA11
          MOVE      ZERO,SAVA12
          MOVE      ZERO,SAVA13
          MOVE      ZERO,SAVCOM
          MOVE      ZERO,SAVCOM2
.
          MOVE      ZERO,SAVCBFD
          MOVE      ZERO,SAVC01D
          MOVE      ZERO,SAVC02D
          MOVE      ZERO,SAVC03D
          MOVE      ZERO,SAVC04D
          MOVE      ZERO,SAVC05D
          MOVE      ZERO,SAVC06D
          MOVE      ZERO,SAVC07D
          MOVE      ZERO,SAVC08D
          MOVE      ZERO,SAVC09D
          MOVE      ZERO,SAVC10D
          MOVE      ZERO,SAVC11D
          MOVE      ZERO,SAVC12D
          MOVE      ZERO,SAVC13D
          MOVE      ZERO,SAVABFD
          MOVE      ZERO,SAVA01D
          MOVE      ZERO,SAVA02D
          MOVE      ZERO,SAVA03D
          MOVE      ZERO,SAVA04D
          MOVE      ZERO,SAVA05D
          MOVE      ZERO,SAVA06D
          MOVE      ZERO,SAVA07D
          MOVE      ZERO,SAVA08D
          MOVE      ZERO,SAVA09D
          MOVE      ZERO,SAVA10D
          MOVE      ZERO,SAVA11D
          MOVE      ZERO,SAVA12D
          MOVE      ZERO,SAVA13D
          MOVE      ZERO,SAVCOMD
.
          MOVE      ZERO,SAVCBFT
          MOVE      ZERO,SAVC01T
          MOVE      ZERO,SAVC02T
          MOVE      ZERO,SAVC03T
          MOVE      ZERO,SAVC04T
          MOVE      ZERO,SAVC05T
          MOVE      ZERO,SAVC06T
          MOVE      ZERO,SAVC07T
          MOVE      ZERO,SAVC08T
          MOVE      ZERO,SAVC09T
          MOVE      ZERO,SAVC10T
          MOVE      ZERO,SAVC11T
          MOVE      ZERO,SAVC12T
          MOVE      ZERO,SAVC13T
          MOVE      ZERO,SAVABFT
          MOVE      ZERO,SAVA01T
          MOVE      ZERO,SAVA02T
          MOVE      ZERO,SAVA03T
          MOVE      ZERO,SAVA04T
          MOVE      ZERO,SAVA05T
          MOVE      ZERO,SAVA06T
          MOVE      ZERO,SAVA07T
          MOVE      ZERO,SAVA08T
          MOVE      ZERO,SAVA09T
          MOVE      ZERO,SAVA10T
          MOVE      ZERO,SAVA11T
          MOVE      ZERO,SAVA12T
          MOVE      ZERO,SAVA13T
          MOVE      ZERO,SAVCOMT
.
          RETURN
.
.**********************************************************************
. Move Save Totals to File Totals for Update
.**********************************************************************
MSTA0000  MOVE      SAVCBF,FMFPCBF
          MOVE      SAVC01,FMFPC01
          MOVE      SAVC02,FMFPC02
          MOVE      SAVC03,FMFPC03
          MOVE      SAVC04,FMFPC04
          MOVE      SAVC05,FMFPC05
          MOVE      SAVC06,FMFPC06
          MOVE      SAVC07,FMFPC07
          MOVE      SAVC08,FMFPC08
          MOVE      SAVC09,FMFPC09
          MOVE      SAVC10,FMFPC10
          MOVE      SAVC11,FMFPC11
          MOVE      SAVC12,FMFPC12
          MOVE      SAVC13,FMFPC13
          MOVE      SAVABF,FMFPABF
          MOVE      SAVA01,FMFPA01
          MOVE      SAVA02,FMFPA02
          MOVE      SAVA03,FMFPA03
          MOVE      SAVA04,FMFPA04
          MOVE      SAVA05,FMFPA05
          MOVE      SAVA06,FMFPA06
          MOVE      SAVA07,FMFPA07
          MOVE      SAVA08,FMFPA08
          MOVE      SAVA09,FMFPA09
          MOVE      SAVA10,FMFPA10
          MOVE      SAVA11,FMFPA11
          MOVE      SAVA12,FMFPA12
          MOVE      SAVA13,FMFPA13
          MOVE      SAVCOM,FMFPCOM
          MOVE      SAVCOM2,FMFPCOM2
.
. Move Dollar & Cents fields to dollar and thousand 
.
          MOVE      FMFPCBF,FMFPCBFD
          MOVE      FMFPC01,FMFPC01D
          MOVE      FMFPC02,FMFPC02D
          MOVE      FMFPC03,FMFPC03D
          MOVE      FMFPC04,FMFPC04D
          MOVE      FMFPC05,FMFPC05D
          MOVE      FMFPC06,FMFPC06D
          MOVE      FMFPC07,FMFPC07D
          MOVE      FMFPC08,FMFPC08D
          MOVE      FMFPC09,FMFPC09D
          MOVE      FMFPC10,FMFPC10D
          MOVE      FMFPC11,FMFPC11D
          MOVE      FMFPC12,FMFPC12D
          MOVE      FMFPC13,FMFPC13D
          MOVE      FMFPABF,FMFPABFD
          MOVE      FMFPA01,FMFPA01D
          MOVE      FMFPA02,FMFPA02D
          MOVE      FMFPA03,FMFPA03D
          MOVE      FMFPA04,FMFPA04D
          MOVE      FMFPA05,FMFPA05D
          MOVE      FMFPA06,FMFPA06D
          MOVE      FMFPA07,FMFPA07D
          MOVE      FMFPA08,FMFPA08D
          MOVE      FMFPA09,FMFPA09D
          MOVE      FMFPA10,FMFPA10D
          MOVE      FMFPA11,FMFPA11D
          MOVE      FMFPA12,FMFPA12D
          MOVE      FMFPA13,FMFPA13D
          MOVE      FMFPCOM,FMFPCOMD
.
          MOVE      FMFPCBF,FMFPCBFT
          MOVE      FMFPC01,FMFPC01T
          MOVE      FMFPC02,FMFPC02T
          MOVE      FMFPC03,FMFPC03T
          MOVE      FMFPC04,FMFPC04T
          MOVE      FMFPC05,FMFPC05T
          MOVE      FMFPC06,FMFPC06T
          MOVE      FMFPC07,FMFPC07T
          MOVE      FMFPC08,FMFPC08T
          MOVE      FMFPC09,FMFPC09T
          MOVE      FMFPC10,FMFPC10T
          MOVE      FMFPC11,FMFPC11T
          MOVE      FMFPC12,FMFPC12T
          MOVE      FMFPC13,FMFPC13T
          MOVE      FMFPABF,FMFPABFT
          MOVE      FMFPA01,FMFPA01T
          MOVE      FMFPA02,FMFPA02T
          MOVE      FMFPA03,FMFPA03T
          MOVE      FMFPA04,FMFPA04T
          MOVE      FMFPA05,FMFPA05T
          MOVE      FMFPA06,FMFPA06T
          MOVE      FMFPA07,FMFPA07T
          MOVE      FMFPA08,FMFPA08T
          MOVE      FMFPA09,FMFPA09T
          MOVE      FMFPA10,FMFPA10T
          MOVE      FMFPA11,FMFPA11T
          MOVE      FMFPA12,FMFPA12T
          MOVE      FMFPA13,FMFPA13T
          MOVE      FMFPCOM,FMFPCOMT
.
          DIV       "1000",FMFPCBFT
          DIV       "1000",FMFPC01T
          DIV       "1000",FMFPC02T
          DIV       "1000",FMFPC03T
          DIV       "1000",FMFPC04T
          DIV       "1000",FMFPC05T
          DIV       "1000",FMFPC06T
          DIV       "1000",FMFPC07T
          DIV       "1000",FMFPC08T
          DIV       "1000",FMFPC09T
          DIV       "1000",FMFPC10T
          DIV       "1000",FMFPC11T
          DIV       "1000",FMFPC12T
          DIV       "1000",FMFPC13T
          DIV       "1000",FMFPABFT
          DIV       "1000",FMFPA01T
          DIV       "1000",FMFPA02T
          DIV       "1000",FMFPA03T
          DIV       "1000",FMFPA04T
          DIV       "1000",FMFPA05T
          DIV       "1000",FMFPA06T
          DIV       "1000",FMFPA07T
          DIV       "1000",FMFPA08T
          DIV       "1000",FMFPA09T
          DIV       "1000",FMFPA10T
          DIV       "1000",FMFPA11T
          DIV       "1000",FMFPA12T
          DIV       "1000",FMFPA13T
          DIV       "1000",FMFPCOMT
          RETURN
.**********************************************************************
. Add Totals to Save Totals for Update
.**********************************************************************
ADDF0000  ADD       FMFPCBF,SAVCBF
          ADD       FMFPC01,SAVC01
          ADD       FMFPC02,SAVC02
          ADD       FMFPC03,SAVC03
          ADD       FMFPC04,SAVC04
          ADD       FMFPC05,SAVC05
          ADD       FMFPC06,SAVC06
          ADD       FMFPC07,SAVC07
          ADD       FMFPC08,SAVC08
          ADD       FMFPC09,SAVC09
          ADD       FMFPC10,SAVC10
          ADD       FMFPC11,SAVC11
          ADD       FMFPC12,SAVC12
          ADD       FMFPC13,SAVC13
          ADD       FMFPABF,SAVABF
          ADD       FMFPA01,SAVA01
          ADD       FMFPA02,SAVA02
          ADD       FMFPA03,SAVA03
          ADD       FMFPA04,SAVA04
          ADD       FMFPA05,SAVA05
          ADD       FMFPA06,SAVA06
          ADD       FMFPA07,SAVA07
          ADD       FMFPA08,SAVA08
          ADD       FMFPA09,SAVA09
          ADD       FMFPA10,SAVA10
          ADD       FMFPA11,SAVA11
          ADD       FMFPA12,SAVA12
          ADD       FMFPA13,SAVA13
          ADD       FMFPCOM,SAVCOM
          ADD       FMFPCOM2,SAVCOM2
.
          RETURN
.******************************************************************************
.* INCLUDES                                                                   *
.******************************************************************************
.
          INC       FMSAMAIO/INC
          INC       FMSTCFIO/INC
          INC       FMSCONIO/INC
          INC       FMSFPSIO/INC
          INC       FMSLMAIO/INC
          INC       FMSSMAIO/INC
          INC       IBAOVRIO/INC
.
FMSTU999  ENDPROC
