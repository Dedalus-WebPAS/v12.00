.**************************************************************************
.*                  KEYCLAIM INCLUDE                                      *
.*                                                                        *
.*  Used by : IBAPRI01, IBAPRI07                                          *
.*                                                                        *
.*  Purpose : Screen displays for compensation claims and person          *
.*            responsible for account and input routines for each field   *
.*                                                                        *
.*  Written : Steve Armstrong 1/7/91                                      *
.*                                                                        *
.*  Modifications : 28/07/1995  Steve Armstrong                           *
.*                  Fixed Line 2 header displays                          *
.**************************************************************************
.
.**************************************************************************
.*                                  SCR0000                               *
.*              display screen format for initial key fields              *
.**************************************************************************
.
SCR0000   DISPLAY   *P1:3,*EF:
                    *P5:4,"Medical Practice",*P32:4,COLON:
                    *P5:5,"Service Doctor",*P32:5,COLON:
                    *P5:6,"Debtor Number",*P32:6,COLON:
                    *P5:7,"Claim Code",*P32:7,COLON:
                    *P5:8,"Accident Date",*P32:8,COLON
.
SCR9999   RETURN
+
.**************************************************************************
.*                                 SCRA0000                               *
.*             display screen format for workers comp                     *
.**************************************************************************
.
SCRA0000  MATCH     "IBAPRI01",PRGID
          GOTO      SCRA1000 IF EQUAL
.
          BRANCH    COPTION,SCRA2000             * change claim code
.
          DISPLAY   *P48:2,*EL,*V2LON,"Workers Compensation"
          GOTO      SCRA2000
.
SCRA1000  DISPLAY   *P51:2,*EL,*V2LON,"- Workers Compensation"
          HLINE     *G37,2,74,80
.
SCRA2000  DISPLAY   *P1:9,*EF:
                    *P2:10,*V2LON,ONE,*HOFF,". Accident Time",*P32:10,COLON:
                    *P2:11,*V2LON,TWO,*HOFF,". Employer",*P32:11,COLON:
                    *P2:12,*V2LON,THREE,*HOFF,". Employer Address",*P32:12:
                    COLON:
                    *P2:13,*V2LON,FOUR,*HOFF,*P32:13,COLON:
                    *P2:14,*V2LON,FIVE,*HOFF,*P32:14,COLON:
                    *P2:15,*V2LON,SIX,*HOFF,". Postcode",*P32:15,COLON:
                    *P2:16,*V2LON,SEVEN,*HOFF,". Telephone",*P32:16,COLON:
                    *P2:18,*V2LON,EIGHT,*HOFF,". Claim accepted by Ins.":
                    *P32:18,COLON:
                    *P2:19,*V2LON,NINE,*HOFF,". Insurance Company Code":
                    *P32:19,COLON:
                    *P1:20,*V2LON,TEN,*HOFF,". Insurance Claim Number":
                    *P32:20,COLON:
                    *P1:21,*V2LON,TEN1,*HOFF,". Comments",*P32:21,COLON:
                    *P1:22,*V2LON,TEN2,*HOFF,*P32:22,COLON
.
SCRA9999  RETURN
+
.*************************************************************************
.*                                  SCRB0000                             *
.*                  display screen for T.A.C. claim                      *
.*************************************************************************
.
SCRB0000  MATCH     "IBAPRI01",PRGID
          GOTO      SCRB0500 IF EQUAL
.
          BRANCH    COPTION,SCRB0700             * change claim code
.
          DISPLAY   *P48:2,*EL,*V2LON,"Transport Accident Comm."
          GOTO      SCRB0700
.
SCRB0500  DISPLAY   *P51:2,*EL,*V2LON,"- Transport Accident Comm."
          HLINE     *G37,2,78,80
.
SCRB0700  DISPLAY   *P1:9,*EF:
                    *P2:9,*V2LON,ONE,*HOFF,". T.A.C. Reference Number":
                    *P32:9,COLON:
                    *P2:10,*V2LON,TWO,*HOFF,". Accident Location",*P32:10:
                    COLON:
                    *P2:11,*V2LON,THREE,*HOFF,". Reported at Police Station":
                    *P32:11,COLON:
                    *P2:12,*V2LON,FOUR,*HOFF,". Car Registrations Involved":
                    *P32:12,COLON:
                    *P2:13,*V2LON,FIVE,*HOFF,". Other Driver(s) Details":
                    *P32:13,COLON:
                    *P2:14,*V2LON,SIX,*HOFF,*P32:14,COLON:
                    *P2:15,*V2LON,SEVEN,*HOFF,*P32:15,COLON
.
          PACK      KEY5,CODEMO,SP5
          CALL      RDCODE1
          COMPARE   ZERO,OVRCD                   * category found ?
          GOTO      SCRB1000 IF EQUAL            * yes
.         
          MOVE      "Category not found",TDESC
.
SCRB1000  DISPLAY   *P2:16,*V2LON,EIGHT,*HOFF,". ",TDESC,*P32:16,COLON
.
          PACK      KEY5,CODEMP,SP5
          CALL      RDCODE1
          COMPARE   ZERO,OVRCD                   * category found ?
          GOTO      SCRB2000 IF EQUAL            * yes
.
          MOVE      "Category not found",TDESC
.
SCRB2000  DISPLAY   *P2:17,*V2LON,NINE,*HOFF,". ",TDESC,*P32:17,COLON:
                    *P1:18,*V2LON,TEN,*HOFF,". While Engaged In",*P32:18,COLON:
                    *P1:19,*V2LON,TEN1,*HOFF,". Patient Injured When",*P32:19:
                    COLON:
                    *P1:20,*V2LON,TEN2,*HOFF,". Mech. of Severist Injury":
                    *P32:20,COLON:
                    *P1:21,*V2LON,TEN3,*HOFF,". Region of Severist Injury":
                    *P32:21,COLON:
                    *P1:22,*V2LON,TEN4,*HOFF,". Solicitor",*P32:22,COLON:
                    *P1:23,*V2LON,TEN5,*HOFF,". Solicitor Telephone":
                    *P32:23,COLON
.
SCRB9999  RETURN
+
.*************************************************************************
.*                                  SCRC0000                             *
.*                  display screen for Veteran affairs                   *
.*************************************************************************
.
SCRC0000  MATCH     "IBAPRI01",PRGID
          GOTO      SCRC1000 IF EQUAL
.
          BRANCH    COPTION,SCRC2000             * change claim code
.
          DISPLAY   *P49:2,*EL,*V2LON,"- Veterans Affairs"
          HLINE     *G37,2,68,80
          GOTO      SCRC2000
.
SCRC1000  DISPLAY   *P51:2,*EL,*V2LON,"- Veterans Affairs"
          HLINE     *G37,2,70,80
.
SCRC2000  DISPLAY   *P1:9,*EF:
                    *P1:10,*V2LON,ONE,*HOFF,". Veterans Claim No",*P32:10,COLON
.
SCRC9999  RETURN
+
.****************************************************************************
.*                                  SCRD0000                                *
.*                display screen for P.R.A. maintenance                     *
.****************************************************************************
.
SCRD0000  MATCH     "IBAPRI01",PRGID
          GOTO      SCRD1000 IF EQUAL
.
          DISPLAY   *P49:2,*EL,*V2LON,"- Change A/C Responsibility"
          HLINE     *G37,2,77,80
          GOTO      SCRD2000
.
SCRD1000  DISPLAY   *P51:2,*EL,*V2LON,"- A/C Responsibility"
          HLINE     *G37,2,72,80
.
SCRD2000  DISPLAY   *P1:9,*EF:
                    *P4:10,*V2LON,*ULON,"Person Responsible for A/C",*HOFF:
                    *P1:12,*V2LON,ONE,*HOFF,". Name",*P18:12,COLON:
                    *P1:13,*V2LON,TWO,*HOFF,". Address",*P18:13,COLON:
                    *P1:14,*V2LON,THREE,*HOFF,".",*P18:14,COLON:
                    *P1:15,*V2LON,FOUR,*HOFF,".",*P18:15,COLON:
                    *P1:16,*V2LON,FIVE,*HOFF,". Postcode",*P18:16,COLON: 
                    *P1:17,*V2LON,SIX,*HOFF,". Phone (Pri)",*P18:17,COLON:
                    *P1:18,*V2LON,SEVEN,*HOFF,". Phone (Bus)",*P18:18,COLON:
                    *P1:19,*V2LON,EIGHT,*HOFF,". Relationship",*P18:19,COLON
.
SCRD9999  RETURN
+
.**************************************************************************
.*                              WCOM0000                                  *
.*                  get workers comp details                              *
.**************************************************************************
.
WCOM0000  CALL      TIME0000                     * time of accident
.
          CALL      ENAM0000                     * employer name
.
          CALL      ADDA0000                     * employer address line 1
.
          CALL      ADDB0000                     * employer address line 2
.
          CALL      ADDC0000                     * employer address line 3
.
          CALL      PCOD0000                     * employer postcode
.
          CALL      PHON0000                     * employer phone no.
.
          CALL      CLOK0000                     * claim accepted by insur. co.
.
          CALL      INSR0000                     * insurance company code
.
          CALL      CLNO0000                     * insurance claim number
.
          CALL      COMA0000                     * comments line 1
.
          CALL      COMB0000                     * comments line 2
.
          MOVE      ZERO,EXIT
.
WCOM9999  RETURN
+
.**************************************************************************
.*                              TACD0000                                  *
.*                 get transport accident commission details              *
.**************************************************************************
.
TACD0000  CALL      REFN0000                     * T.A.C. reference no.
.
          CALL      LOCN0000                     * accident location
.
          CALL      POLI0000                     * police station reported at
.
          CALL      REGN0000                     * car registrations involved
.
          CALL      DRVA0000                     * other driver details line 1
.
          CALL      DRVB0000                     * other driver details line 2
.
          CALL      DRVC0000                     * other driver details line 3
.
. ******* Currently these user defined fields are mandatory ********
.
          CALL      UDFA0000                     * user defined field A
.
          CALL      UDFB0000                     * user defined field B
.
          CALL      ENGD0000                     * activity engaged in
.
          CALL      INJD0000                     * injured when
.
          CALL      MECH0000                     * mechanism of injury
.
          CALL      REGI0000                     * region of injury
.
          CALL      SOLI0000                     * solicitor name
.
          CALL      STEL0000                     * solicitor telephone no.
.
          MOVE      ZERO,EXIT
.
TACD9999  RETURN
+
.**************************************************************************
.*                              VAFF0000                                  *
.*                get veterans affairs details                            *
.**************************************************************************
.
VAFF0000  CALL      VNUM0000                     * veterans claim number
.
          MOVE      ZERO,EXIT
.
VAFF9999  RETURN
+
.****************************************************************************
.*                                  TIME0000           Called by: WCOM0000  *
.*                         get the accident time                  SELA0000  *
.****************************************************************************
.
TIME0000  MOVE      THIRTY4,CCOL
          MOVE      TEN,CVERT
          MOVE      SP2,CHOUR
          MOVE      SP2,CMIN
.
          CALL      KEYTIME                      * get time
          BRANCH    OVRCD,TIME9999               * nothing input
.
          PACK      ACCTIME,CHOUR,COLON,CMIN
.
TIME9999  RETURN
+
.****************************************************************************
.*                                  ENAM0000           Called by: SELA0000  *
.*                      get the employer's name                   WCOM0000  *
.****************************************************************************
.
ENAM0000  KEYIN     *P34:11,*DV,UNDLN30:
                    *P34:11,*V2LON,EMPNAME:
                    *P34:11,*DV,EMPNAME
.
          ENDSET    EMPNAME
          APPEND    SP70,EMPNAME
          RESET     EMPNAME
.
ENAM9999  RETURN
+
.****************************************************************************
.*                                  ADDA0000           Called by: WCOM0000  *
.*                      get address line 1                        SELA0000  *
.****************************************************************************
.
ADDA0000  KEYIN     *P34:12,*DV,UNDLN20,*DV,UNDLN5:
                    *P34:12,*V2LON,EADD1:
                    *P34:12,*DV,EADD1
.
          ENDSET    EADD1
          APPEND    SP70,EADD1
          RESET     EADD1
.
ADDA9999  RETURN
+
.****************************************************************************
.*                                  ADDB0000           Called by: WCOM0000  *
.*                      get address line 2                        SELA0000  *
.****************************************************************************
.
ADDB0000  KEYIN     *P34:13,*DV,UNDLN20,*DV,UNDLN5:
                    *P34:13,*V2LON,EADD2:
                    *P34:13,*DV,EADD2
.
          ENDSET    EADD2
          APPEND    SP70,EADD2
          RESET     EADD2
.
ADDB9999  RETURN
+
.****************************************************************************
.*                                  ADDC0000           Called by: WCOM0000  *
.*                      get address line 3                        SELA0000  *
.****************************************************************************
.
ADDC0000  KEYIN     *P34:14,*DV,UNDLN20,*DV,UNDLN5:
                    *P34:14,*V2LON,EADD3:
                    *P34:14,*DV,EADD3
.
          ENDSET    EADD3
          APPEND    SP70,EADD3
          RESET     EADD3
.
ADDC9999  RETURN
+
.****************************************************************************
.*                                  PCOD0000           Called by: WCOM0000  *
.*                        get employer postcode                   SELA0000  *
.****************************************************************************
.
PCOD0000  KEYIN     *P34:15,*DV,UNDLN4:
                    *P34:15,*V2LON,EPCODE:
                    *P34:15,*DV,EPCODE
.
          ENDSET    EPCODE
          APPEND    SP70,EPCODE
          RESET     EPCODE
.
PCOD9999  RETURN
+
.****************************************************************************
.*                                  PHON0000           Called by: WCOM0000  *
.*                       get employer's phone number              SELA0000  *
.****************************************************************************
.
PHON0000  KEYIN     *P34:16,*DV,UNDLN10,*DV,UNDLN2:
                    *P34:16,*V2LON,EPHONE:
                    *P34:16,*DV,EPHONE
.
          ENDSET    EPHONE
          APPEND    SP70,EPHONE
          RESET     EPHONE
.
PHON9999  RETURN
+
.****************************************************************************
.*                                  CLOK0000           Called by: WCOM0000  *
.*             see if claim accepted by insurance company         SELA0000  *
.*       Returns ACCEPT: 0 = Yes                                            *
.*                       1 = No                                             *
.****************************************************************************
.
CLOK0000  KEYIN     *P34:18,*EL,*DV,ANSN:
                    *P34:18,*V2LON,ANS
.
          ENDSET    ANS                          * pad with blanks
          APPEND    SP1,ANS
          RESET     ANS
          REP       UPPLOW,ANS
.
          MATCH     SP1,ANS                      * anything entered ?
          GOTO      CLOK5000 IF EQUAL            * no
.
          MATCH     ANSN,ANS                     * no entered ?
          GOTO      CLOK5000 IF EQUAL            * yes
.
          MATCH     ANSY,ANS                     * yes entered ?
          GOTO      CLOK6000 IF EQUAL            * yes
.
          BEEP
          GOTO      CLOK0000                     * invalid entry
.
CLOK5000  DISPLAY   *P34:18,*V2LON,"No "
          MOVE      ONE,ACCEPT
          GOTO      CLOK9999
.
CLOK6000  DISPLAY   *P34:18,*V2LON,"Yes"
          MOVE      ZERO,ACCEPT
.
CLOK9999  RETURN
+
.****************************************************************************
.*                                  INSR0000           Called by: WCOM0000  *
.*                     get insurance company code                 SELA0000  *
.*            Returns: EXIT 0 = OK                                          *
.*                          1 = exitchar entered                            *
.****************************************************************************
.
INSR0000  MATCH     SP70,PRCNWCOM                * default insurance co ?
          GOTO      INSR0500 IF NOT EQUAL        * no
.
          KEYIN     *P34:19,*EL,*DV,UNDLN6:      * get code
                    *P34:19,*V2LON,INSCODE:
                    *P34:19,*DV,INSCODE
          GOTO      INSR0800
.
INSR0500  KEYIN     *P34:19,*EL,*DV,PRCNWCOM:    * get code
                    *P34:19,*V2LON,INSCODE:
                    *P34:19,*DV,INSCODE
.
          RESET     INSCODE
          GOTO      INSR0800 IF NOT EOS
.
          MOVE      PRCNWCOM,INSCODE
.
INSR0800  CALL      CHKI0000                     * see what was entered
          BRANCH    EXIT,INSR1000:               * ? entered
                         INSR7500:               * valid code
                         INSR8500:               * nothing entered
                         INSR9500                * exitchar
.
          GOTO      INSR0000                     * invalid code
.
INSR1000  MOVE      ZERO,HLEF
          CALL      GETSCR00
INSR1200  CALL      PATINSDS                     * list codes on file
.
INSR1500  MATCH     SP70,PRCNWCOM
          GOTO      INSR2000 IF NOT EQUAL
. 
          KEYIN     *P1:24,*EL,"Insurance company: ",*DV,UNDLN6:
                    *P20:24,*V2LON,INSCODE:
                    *P20:24,*DV,INSCODE
          GOTO      INSR3000
. 
INSR2000  KEYIN     *P1:24,*EL,"Insurance company: ",*DV,PRCNWCOM:
                    *P20:24,*V2LON,INSCODE:
                    *P20:24,*DV,INSCODE
.
          RESET     INSCODE
          GOTO      INSR3000 IF NOT EOS
.
          MOVE      PRCNWCOM,INSCODE
.
INSR3000  CALL      CHKI0000                     * see what was entered
          BRANCH    EXIT,INSR1200:               * ? entered
                         INSR7000:               * valid code
                         INSR8000:               * nothing entered
                         INSR9000                * exitchar
.
          GOTO      INSR1500 
.
INSR7000  CALL      PUTSCR00
INSR7500  DISPLAY   *P34:19,*V2LON,INSCODE
          MOVE      INAME,IDESC                  * display insurance name
          DISPLAY   *P44:19,IDESC
          MOVE      ZERO,EXIT
          GOTO      INSR9999
.
INSR8000  CALL      PUTSCR00
          DISPLAY   *P34:19,*EL
INSR8500  MOVE      ZERO,EXIT
          GOTO      INSR9999
.
INSR9000  CALL      FRESCR00
INSR9500  MOVE      ONE,EXIT
.
INSR9999  RETURN
+
.***************************************************************************
.*                                 CHKI0000            Called by: INSR0000 *
.*                      See what was input                                 *
.*         Returns: EXIT  0 = invalid                                      *
.*                        1 = "?"                                          *
.*                        2 = valid                                        *
.*                        3 = nothing                                      *
.*                        4 = exitchar                                     *
.***************************************************************************
.
CHKI0000  ENDSET    INSCODE
          APPEND    SP70,INSCODE
          RESET     INSCODE
.
          MATCH     SP70,INSCODE                  * anything entered ?
          GOTO      CHKI9000 IF EQUAL            * no
.
          MATCH     EXITCHAR,INSCODE             * exitchar entered ?
          GOTO      CHKI7000 IF EQUAL            * yes
.
          MATCH     QUEST,INSCODE                * ? entered ?
          GOTO      CHKI8000 IF EQUAL            * yes
.  
.         Code entered
.
          PACK      KEY6,INSCODE
          CALL      RDINSR1                      * code on file ?
          BRANCH    OVRCD,CHKI6000               * no
.
          MOVE      TWO,EXIT
          GOTO      CHKI9999
.
CHKI6000  DISPLAY   *P1:24,*EL,*B,"Insurance company not on file. ";
          CALL      HITENTER
          MOVE      ZERO,EXIT                    * code entered
          GOTO      CHKI9999
.
CHKI7000  MOVE      FOUR,EXIT
          GOTO      CHKI9999
.
CHKI8000  MOVE      ONE,EXIT
          GOTO      CHKI9999
.
CHKI9000  MOVE      THREE,EXIT
.
CHKI9999  RETURN
+
.****************************************************************************
.*                                  CLNO0000           Called by: WCOM0000  *
.*                         get insurance claim number             SELA0000  *
.****************************************************************************
.
CLNO0000  KEYIN     *P34:20,*DV,UNDLN20:
                    *P34:20,*V2LON,CLAIMNO:
                    *P34:20,*DV,CLAIMNO
.
          ENDSET    CLAIMNO
          APPEND    SP70,CLAIMNO
          RESET     CLAIMNO
.
CLNO9999  RETURN
+
.****************************************************************************
.*                                  COMA0000           Called by: WCOM0000  *
.*                        get comments line 1                     SELA0000  *
.****************************************************************************
.
COMA0000  KEYIN     *P34:21,*DV,UNDLN20,*DV,UNDLN20:
                    *P34:21,*V2LON,COMLIN1:
                    *P34:21,*DV,COMLIN1
.
          ENDSET    COMLIN1
          APPEND    SP70,COMLIN1
          RESET     COMLIN1
.
COMA9999  RETURN
+
.****************************************************************************
.*                                  COMB0000           Called by: WCOM0000  *
.*                        get comments line 2                     SELA0000  *
.****************************************************************************
.
COMB0000  KEYIN     *P34:22,*DV,UNDLN20,*DV,UNDLN20:
                    *P34:22,*V2LON,COMLIN2:
                    *P34:22,*DV,COMLIN2
.
          ENDSET    COMLIN2
          APPEND    SP70,COMLIN2
          RESET     COMLIN2
.
COMB9999  RETURN
+
.****************************************************************************
.*                                  REFN0000           Called by: TACD0000  *
.*                      get TAC reference number                  SELB0000  *
.****************************************************************************
.
REFN0000  KEYIN     *P34:9,*DV,UNDLN20:
                    *P34:9,*V2LON,REFNUM:
                    *P34:9,*DV,REFNUM
.
          ENDSET    REFNUM
          APPEND    SP70,REFNUM
          RESET     REFNUM
.
REFN9999  RETURN
+
.****************************************************************************
.*                                  LOCN0000           Called by: TACD0000  *
.*                        get accident location                   SELB0000  *
.****************************************************************************
.
LOCN0000  KEYIN     *P34:10,*DV,UNDLN20,*DV,UNDLN20:
                    *P34:10,*V2LON,ACCLOCN:
                    *P34:10,*DV,ACCLOCN
.
          ENDSET    ACCLOCN
          APPEND    SP70,ACCLOCN
          RESET     ACCLOCN
.
LOCN9999  RETURN
+
.****************************************************************************
.*                                  POLI0000           Called by: TACD0000  *
.*                  get police station accident was reported at   SELB0000  *
.****************************************************************************
.
POLI0000  KEYIN     *P34:11,*DV,UNDLN20:
                    *P34:11,*V2LON,STATION:
                    *P34:11,*DV,STATION
.
          ENDSET    STATION
          APPEND    SP70,STATION
          RESET     STATION
.
POLI9999  RETURN
+
.****************************************************************************
.*                                  REGN0000           Called by: TACD0000  *
.*                           get car registrations involved       SELB0000  *
.****************************************************************************
.
REGN0000  KEYIN     *P34:12,*DV,UNDLN30,*DV,UNDLN6:
                    *P34:12,*V2LON,REGNUM:
                    *P34:12,*DV,REGNUM
.
          ENDSET    REGNUM
          APPEND    SP70,REGNUM
          RESET     REGNUM
.
REGN9999  RETURN
+
.****************************************************************************
.*                                  DRVA0000           Called by: TACD0000  *
.*                    get other driver details - line 1           SELB0000  *
.****************************************************************************
.
DRVA0000  KEYIN     *P34:13,*DV,UNDLN30:
                    *P34:13,*V2LON,DRIVER1:
                    *P34:13,*DV,DRIVER1
.
          ENDSET    DRIVER1
          APPEND    SP70,DRIVER1
          RESET     DRIVER1
.
DRVA9999  RETURN
+
.****************************************************************************
.*                                  DRVB0000           Called by: TACD0000  *
.*                    get other driver details - line 2           SELB0000  *
.****************************************************************************
.
DRVB0000  KEYIN     *P34:14,*DV,UNDLN30:
                    *P34:14,*V2LON,DRIVER2:
                    *P34:14,*DV,DRIVER2
.
          ENDSET    DRIVER2
          APPEND    SP70,DRIVER2
          RESET     DRIVER2
.
DRVB9999  RETURN
+
.****************************************************************************
.*                                  DRVC0000           Called by: TACD0000  *
.*                    get other driver details - line 3           SELB0000  *
.****************************************************************************
.
DRVC0000  KEYIN     *P34:15,*DV,UNDLN30:
                    *P34:15,*V2LON,DRIVER3:
                    *P34:15,*DV,DRIVER3
.
          ENDSET    DRIVER3
          APPEND    SP70,DRIVER3
          RESET     DRIVER3
.
DRVC9999  RETURN
+
.****************************************************************************
.*                                  UDFA0000           Called by: TACD0000  *
.*      get first user defined field - mode of transport          SELB0000  *
.*    RETURNS:    EXIT  0 = valid code                                      *
.*                      1 = nothing entered                                 *
.*                      2 = exitchar                                        *
.****************************************************************************
.
UDFA0000  MOVE      SP70,CKYIDEF3
          MOVE      PRCNMANA,CKYIMAND
          MOVE      THIRTY4,ECOL
          MOVE      TEN6,EVERT
          MOVE      CODEMO,CODE
          DISPLAY   *P34:16,*EL
          CALL      PATCODKY
.
          COMPARE   TWO,EXIT                     * exitchar entered ?
          GOTO      UDFA9999 IF EQUAL            * yes
.
          MOVE      ACODE,UDFA
          DISPLAY   *P34:EVERT,*V2LON,ACODE,*HOFF,*P40:16,TDESC
.
UDFA9999  RETURN
+
.****************************************************************************
.*                                  UDFB0000           Called by: TACD0000  *
.*                                                                SELB0000  *
.*      get first user defined field - status of patient (driver /passenger)*
.*    RETURNS:    EXIT  0 = valid code                                      *
.*                      1 = nothing entered                                 *
.*                      2 = exitchar                                        *
.****************************************************************************
.
UDFB0000  MOVE      SP70,CKYIDEF3
          MOVE      PRCNMANB,CKYIMAND
          MOVE      THIRTY4,ECOL
          MOVE      TEN7,EVERT
          MOVE      CODEMP,CODE
          DISPLAY   *P34:17,*EL
          CALL      PATCODKY
.
          COMPARE   TWO,EXIT                     * exitchar entered ?
          GOTO      UDFA9999 IF EQUAL            * yes
.
          MOVE      ACODE,UDFB
          DISPLAY   *P34:EVERT,*V2LON,ACODE,*HOFF,*P40:17,TDESC
.
UDFB9999  RETURN
+
.****************************************************************************
.*                                  ENGD0000           Called by: TACD0000  *
.*                      get "while engaged in" details            SELB0000  *
.****************************************************************************
.
ENGD0000  KEYIN     *P34:18,*DV,UNDLN20:
                    *P34:18,*V2LON,ENGAGED:
                    *P34:18,*DV,ENGAGED
.
          ENDSET    ENGAGED
          APPEND    SP70,ENGAGED
          RESET     ENGAGED
.
ENGD9999  RETURN
+
.****************************************************************************
.*                                  INJD0000           Called by: TACD0000  *
.*                       get reason for patient's injury          SELB0000  *
.****************************************************************************
.
INJD0000  KEYIN     *P34:19,*DV,UNDLN30:
                    *P34:19,*V2LON,INJURED:
                    *P34:19,*DV,INJURED
.
          ENDSET    INJURED
          APPEND    SP70,INJURED
          RESET     INJURED
.
INJD9999  RETURN
+
.****************************************************************************
.*                                  MECH0000           Called by: TACD0000  *
.*                     get mechanism of severist injury           SELB0000  *
.****************************************************************************
.
MECH0000  KEYIN     *P34:20,*DV,UNDLN30:
                    *P34:20,*V2LON,MECHANISM:
                    *P34:20,*DV,MECHANISM
.
          ENDSET    MECHANISM
          APPEND    SP70,MECHANISM
          RESET     MECHANISM
.
MECH9999  RETURN
+
.****************************************************************************
.*                                  REGI0000           Called by: TACD0000  *
.*                   get region of severist injury                SELB0000  *
.****************************************************************************
.
REGI0000  KEYIN     *P34:21,*DV,UNDLN20:
                    *P34:21,*V2LON,REGION:
                    *P34:21,*DV,REGION
.
          ENDSET    REGION
          APPEND    SP70,REGION
          RESET     REGION
.
REGI9999  RETURN
+
.****************************************************************************
.*                                  SOLI0000           Called by: TACD0000  *
.*                        get solicitor's name                    SELB0000  *
.****************************************************************************
.
SOLI0000  KEYIN     *P34:22,*DV,UNDLN30:
                    *P34:22,*V2LON,SOLICITOR:
                    *P34:22,*DV,SOLICITOR
.
          ENDSET    SOLICITOR
          APPEND    SP70,SOLICITOR
          RESET     SOLICITOR
.
SOLI9999  RETURN
+
.****************************************************************************
.*                                  STEL0000           Called by: TACD0000  *
.*                       get solicitor's telephone number         SELB0000  *
.****************************************************************************
.
STEL0000  KEYIN     *P34:23,*DV,UNDLN10,*DV,UNDLN2:
                    *P34:23,*V2LON,SPHONE:
                    *P34:23,*DV,SPHONE
.
          ENDSET    SPHONE
          APPEND    SP70,SPHONE
          RESET     SPHONE
.
STEL9999  RETURN
+
.****************************************************************************
.*                                  VNUM0000           Called by: VAFF0000  *
.*                      get the veterans affairs claim number     SELC0000  *
.****************************************************************************
.
VNUM0000  KEYIN     *P34:10,*DV,UNDLN20:
                    *P34:10,*V2LON,VCLAIM:
                    *P34:10,*DV,VCLAIM
.
          ENDSET    VCLAIM
          APPEND    SP70,VCLAIM
          RESET     VCLAIM
.
VNUM9999  RETURN
+
.****************************************************************************
.*                                   RNAM0000          Called by: SELD0000  *
.*                  get name of person responsible for A/C                  *
.****************************************************************************
.
RNAM0000  KEYIN     *P20:12,*DV,UNDLN30,*DV,UNDLN15:
                    *P20:12,*V2LON,PRANAME:
                    *P20:12,*DV,PRANAME
.
          ENDSET    PRANAME
          APPEND    SP70,PRANAME
          RESET     PRANAME
.
RNAM9999  RETURN
+
.****************************************************************************
.*                                   RADA0000          Called by: SELD0000  *
.*                   get address line 1 for P.R.A.                          *
.****************************************************************************
.
RADA0000  KEYIN     *P20:13,*DV,UNDLN20,*DV,UNDLN5:
                    *P20:13,*V2LON,PRAADD1:
                    *P20:13,*DV,PRAADD1
.
          ENDSET    PRAADD1
          APPEND    SP70,PRAADD1
          RESET     PRAADD1
.
RADA9999  RETURN
+
.****************************************************************************
.*                                   RADB0000          Called by: SELD0000  *
.*                   get address line 2 for P.R.A.                          *
.****************************************************************************
.
RADB0000  KEYIN     *P20:14,*DV,UNDLN20,*DV,UNDLN5:
                    *P20:14,*V2LON,PRAADD2:
                    *P20:14,*DV,PRAADD2
.
          ENDSET    PRAADD2
          APPEND    SP70,PRAADD2
          RESET     PRAADD2
.
RADB9999  RETURN
+
.****************************************************************************
.*                                   RADC0000          Called by: SELD0000  *
.*                   get address line 3 for P.R.A.                          *
.****************************************************************************
.
RADC0000  KEYIN     *P20:15,*DV,UNDLN20,*DV,UNDLN5:
                    *P20:15,*V2LON,PRAADD3:
                    *P20:15,*DV,PRAADD3
.
          ENDSET    PRAADD3
          APPEND    SP70,PRAADD3
          RESET     PRAADD3
.
RADC9999  RETURN
+
.****************************************************************************
.*                                   RPST0000          Called by: SELD0000  *
.*                    get the P.R.A. postcode                               *
.****************************************************************************
.
RPST0000  KEYIN     *P20:16,*DV,UNDLN4:
                    *P20:16,*V2LON,PRAPOST:
                    *P20:16,*DV,PRAPOST
.
          ENDSET    PRAPOST
          APPEND    SP70,PRAPOST
          RESET     PRAPOST
.
RPST9999  RETURN
+
.****************************************************************************
.*                                   RPTP0000          Called by: SELD0000  *
.*               get P.R.A. private telephone number                        *
.****************************************************************************
.
RPTP0000  KEYIN     *P20:17,*DV,UNDLN10,*DV,UNDLN2:
                    *P20:17,*V2LON,PRAPPHON:
                    *P20:17,*DV,PRAPPHON
.
          ENDSET    PRAPPHON
          APPEND    SP70,PRAPPHON
          RESET     PRAPPHON
.
RPTP9999  RETURN
+
.****************************************************************************
.*                                   RBTP0000          Called by: SELD0000  *
.*                    get P.R.A. business telephone number                  *
.****************************************************************************
.
RBTP0000  KEYIN     *P20:18,*DV,UNDLN10,*DV,UNDLN2:
                    *P20:18,*V2LON,PRABPHON:
                    *P20:18,*DV,PRABPHON
.
          ENDSET    PRABPHON
          APPEND    SP70,PRABPHON
          RESET     PRABPHON
.
RBTP9999  RETURN
+
.****************************************************************************
.*                                   RREL0000          Called by: SELD0000  *
.*                  get P.R.A. relationship to patient                      *
.****************************************************************************
.
RREL0000  KEYIN     *P20:19,*DV,UNDLN10:
                    *P20:19,*V2LON,PRARREL:
                    *P20:19,*DV,PRARREL
.
          ENDSET    PRARREL
          APPEND    SP70,PRARREL
          RESET     PRARREL
.
RREL9999  RETURN
+
.****************************************************************************
.*                                   SELA0000                               *
.*        select field to modify or post - workers comp.                    *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Post was selected.                     *
.*                        TRUE  (1)  Cancel was selected.                   *
.****************************************************************************
.
SELA0000  CALL      MAINQST                  * Ask for an item, post or cancel
.
          COMPARE   ZERO,CCITEM              * What was entered ?
          GOTO      SELA8000 IF EQUAL        * Post was selected
          GOTO      SELA9000 IF LESS         * Cancel was selected
.
          BRANCH    CCITEM,SELA1000:         * accident time
                           SELA1500:         * employer name
                           SELA2000:         * employer address line 1
                           SELA2500:         *                  line 2
                           SELA3000:         *                  line 3
                           SELA3500:         * postcode
                           SELA4000:         * telephone #
                           SELA4500:         * claim accepted by ins. ?
                           SELA5000:         * insurance co. code
                           SELA5500:         * ins. claim number
                           SELA6000:         * comments line 1
                           SELA6500          *          line 2
.
          BEEP
          GOTO      SELA0000                 * invalid selection
.
SELA1000  CALL      TIME0000
          GOTO      SELA0000
.
SELA1500  CALL      ENAM0000
          GOTO      SELA0000
.
SELA2000  CALL      ADDA0000
          GOTO      SELA0000
.
SELA2500  CALL      ADDB0000
          GOTO      SELA0000
.
SELA3000  CALL      ADDC0000
          GOTO      SELA0000
.
SELA3500  CALL      PCOD0000
          GOTO      SELA0000
.
SELA4000  CALL      PHON0000
          GOTO      SELA0000
.
SELA4500  CALL      CLOK0000
          GOTO      SELA0000
.
SELA5000  CALL      INSR0000
          BRANCH    EXIT,SELA9999                * exitchar selected
          GOTO      SELA0000
.
SELA5500  CALL      CLNO0000
          GOTO      SELA0000
.
SELA6000  CALL      COMA0000
          GOTO      SELA0000
.
SELA6500  CALL      COMB0000
          GOTO      SELA0000
.
.         Post was selected. Set the exit flag to tell the calling routine.
.
SELA8000  MOVE      ZERO,EXIT                * Post was selected
          GOTO      SELA9999
.
.         Cancel was selected. Set the exit flag to tell the calling routine.
.
SELA9000  MOVE      ONE,EXIT                 * Cancel was selected
.
SELA9999  RETURN
+
.****************************************************************************
.*                                   SELB0000                               *
.*           select field to modify or post - motor accident                *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Post was selected.                     *
.*                        TRUE  (1)  Cancel was selected.                   *
.****************************************************************************
.
SELB0000  CALL      MAINQST                  * Ask for an item, post or cancel
.
          COMPARE   ZERO,CCITEM              * What was entered ?
          GOTO      SELB8000 IF EQUAL        * Post was selected
          GOTO      SELB9000 IF LESS         * Cancel was selected
.
          BRANCH    CCITEM,SELB0500:         * TAC ref. number
                           SELB1000:         * accident location
                           SELB1500:         * police station reported at
                           SELB2000:         * car registrations involved
                           SELB2500:         * other drivers details line 1
                           SELB3000:         *                       line 2
                           SELB3500:         *                       line 3
                           SELB4000:         * user defined field 1
                           SELB4500:         * user defined field 2
                           SELB5000:         * while engaged in
                           SELB5500:         * patient injured when
                           SELB6000:         * mechanism of severist injury
                           SELB6500:         * region of severist injury
                           SELB7000:         * solicitor's name
                           SELB7500          * solicitor's telephone #
.
          BEEP
          GOTO      SELB0000                 * invalid selection
.
SELB0500  CALL      REFN0000
          GOTO      SELB0000
.
SELB1000  CALL      LOCN0000
          GOTO      SELB0000
.
SELB1500  CALL      POLI0000
          GOTO      SELB0000
.
SELB2000  CALL      REGN0000
          GOTO      SELB0000
.
SELB2500  CALL      DRVA0000
          GOTO      SELB0000
.
SELB3000  CALL      DRVB0000
          GOTO      SELB0000
.
SELB3500  CALL      DRVC0000
          GOTO      SELB0000
.
SELB4000  CALL      UDFA0000
.
          COMPARE   TWO,EXIT                     * exitchar entered ?
          GOTO      SELB9000 IF EQUAL            * yes
          GOTO      SELB0000
.
SELB4500  CALL      UDFB0000
.
          COMPARE   TWO,EXIT                     * exitchar entered ?
          GOTO      SELB9000 IF EQUAL            * yes
          GOTO      SELB0000
.
SELB5000  CALL      ENGD0000
          GOTO      SELB0000
.
SELB5500  CALL      INJD0000
          GOTO      SELB0000
.
SELB6000  CALL      MECH0000
          GOTO      SELB0000
.
SELB6500  CALL      REGI0000
          GOTO      SELB0000
.
SELB7000  CALL      SOLI0000
          GOTO      SELB0000
.
SELB7500  CALL      STEL0000
          GOTO      SELB0000
.
.         Post was selected. Set the exit flag to tell the calling routine.
.
SELB8000  MOVE      ZERO,EXIT                * Post was selected
          GOTO      SELB9999
.
.         Cancel was selected. Set the exit flag to tell the calling routine.
.
SELB9000  MOVE      ONE,EXIT                 * Cancel was selected
.
SELB9999  RETURN
+
.****************************************************************************
.*                                   SELC0000                               *
.*           select field to modify or post - veteran's affairs             *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Post was selected.                     *
.*                        TRUE  (1)  Cancel was selected.                   *
.****************************************************************************
.
SELC0000  CALL      MAINQST                  * Ask for an item, post or cancel
.
          COMPARE   ZERO,CCITEM              * What was entered ?
          GOTO      SELC8000 IF EQUAL        * Post was selected
          GOTO      SELC9000 IF LESS         * Cancel was selected
.
          BRANCH    CCITEM,SELC1000          * veterans affairs claim #
.
          BEEP
          GOTO      SELC0000                 * invalid selection
.
SELC1000  CALL      VNUM0000
          GOTO      SELC0000
.
.         Post was selected. Set the exit flag to tell the calling routine.
.
SELC8000  MOVE      ZERO,EXIT                * Post was selected
          GOTO      SELC9999
.
.         Cancel was selected. Set the exit flag to tell the calling routine.
.
SELC9000  MOVE      ONE,EXIT                 * Cancel was selected
.
SELC9999  RETURN
+
.****************************************************************************
.*                                   SELD0000                               *
.*           select field to modify or post - P.R.A.                        *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Post was selected.                     *
.*                        TRUE  (1)  Cancel was selected.                   *
.****************************************************************************
.
SELD0000  CALL      MAINQST                  * Ask for an item, post or cancel
.
          COMPARE   ZERO,CCITEM              * What was entered ?
          GOTO      SELD8000 IF EQUAL        * Post was selected
          GOTO      SELD9000 IF LESS         * Cancel was selected
.
          BRANCH    CCITEM,SELD1000:         * name of P.R.A.
                           SELD1500:         * P.R.A. address line 1
                           SELD2000:         * P.R.A. address line 2
                           SELD2500:         * P.R.A. address line 3
                           SELD3000:         * P.R.A. postcode
                           SELD3500:         * P.R.A. home phone #
                           SELD4000:         * P.R.A. bus. phone #
                           SELD4500          * P.R.A relationship
.
          BEEP
          GOTO      SELD0000
.
SELD1000  CALL      RNAM0000
          GOTO      SELD0000
.
SELD1500  CALL      RADA0000
          GOTO      SELD0000
.
SELD2000  CALL      RADB0000
          GOTO      SELD0000
.
SELD2500  CALL      RADC0000
          GOTO      SELD0000
.
SELD3000  CALL      RPST0000
          GOTO      SELD0000
.
SELD3500  CALL      RPTP0000
          GOTO      SELD0000
.
SELD4000  CALL      RBTP0000
          GOTO      SELD0000
.
SELD4500  CALL      RREL0000
          GOTO      SELD0000
.
.         Post was selected. Set the exit flag to tell the calling routine.
.
SELD8000  MOVE      ZERO,EXIT                * Post was selected
          GOTO      SELD9999
.
.         Cancel was selected. Set the exit flag to tell the calling routine.
.
SELD9000  MOVE      ONE,EXIT                 * Cancel was selected
.
SELD9999  RETURN
+
.****************************************************************************
.*                                  CLRW0000                                *
.*                      clear workers compensation variables                *
.****************************************************************************
.
CLRW0000  MOVE      SP70,ACCTIME
          MOVE      SP70,EMPNAME
          MOVE      SP70,EADD1
          MOVE      SP70,EADD2
          MOVE      SP70,EADD3
          MOVE      SP70,EPCODE
          MOVE      SP70,EPHONE
          MOVE      ZERO,ACCEPT
          MOVE      SP70,INSCODE
          MOVE      SP70,CLAIMNO
          MOVE      SP70,COMLIN1
          MOVE      SP70,COMLIN2
CLRW9999  RETURN
.****************************************************************************
.*                                  CLRM0000                                *
.*                     clear transport accident variables                   *
.****************************************************************************
CLRM0000  MOVE      SP70,REFNUM
          MOVE      SP70,ACCLOCN
          MOVE      SP70,STATION
          MOVE      SP70,REGNUM
          MOVE      SP70,DRIVER1
          MOVE      SP70,DRIVER2
          MOVE      SP70,DRIVER3
          MOVE      SP70,UDFA
          MOVE      SP70,UDFB
          MOVE      SP70,ENGAGED
          MOVE      SP70,INJURED
          MOVE      SP70,MECHANISM
          MOVE      SP70,REGION
          MOVE      SP70,SOLICITOR
          MOVE      SP70,SPHONE
CLRM9999  RETURN
.****************************************************************************
.*                                  CLRV0000                                *
.*                    clear veteran affairs variables                       *
.****************************************************************************
CLRV0000  MOVE      SP70,VCLAIM
CLRV9999  RETURN
.***************************************************************************
.*                                  CLRP0000                               *
.*                       clear P.R.A. variables                            *
.***************************************************************************
CLRP0000  MOVE      SP70,PRANAME
          MOVE      SP70,PRAADD1
          MOVE      SP70,PRAADD2
          MOVE      SP70,PRAADD3
          MOVE      SP70,PRAPOST
          MOVE      SP70,PRAPPHON
          MOVE      SP70,PRABPHON
          MOVE      SP70,PRARREL
CLRP9999  RETURN
.***************************************************************************
.*                              DISD0000                                   *
.*                 display details of the P.R.A.                           *
.***************************************************************************
.
DISD0000  DISPLAY   *P20:12,*V2LON,PRANAME:
                    *P20:13,PRAADD1:
                    *P20:14,PRAADD2:
                    *P20:15,PRAADD3:
                    *P20:16,PRAPOST:
                    *P20:17,PRAPPHON:
                    *P20:18,PRABPHON:
                    *P20:19,PRARREL
.
DISD9999  RETURN
+
