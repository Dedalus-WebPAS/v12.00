.*****************************************************************************
.* System    :   Patient Management System                                   *
.* Program   :   EXTRXHCP                                                    *
.* Desc      :   External HCP Details Data Extraction Program                *
.*****************************************************************************
.* Date      :   27/02/2014                                                  *
.* Author    :   Steve Armstrong                                             *
.* Function  :   This program will extract the external HCP details into a   *
.*               pipe delimited file in a format that will feed into         *
.*               CONVXHCP.                                                   *
.* Mods:                                                                     *
.*        V10.12.01  16/01/2018  Steve Armstrong   TSK 0825792               *
.*                   Added values 14 & 15 for EXGPHCST                       *
.*****************************************************************************
.*        V10.06.01  13/07/2015  Steve Armstrong   CAR 319178                *
.*                   Mods to add new field for start date (EXGPSDAT)         *
.*****************************************************************************
.*        V10.04.00 27/02/2014  Steve Armstrong  CAR 296128                  *
.*                  Created program.                                         *
.*****************************************************************************
.
          INC       STD001FD
.
. FILE DESCRIPTION INCLUDES
. -------------------------
          INC       PMSHCGFD/INC
          INC       PMSHCLFD/INC
          INC       PMSHCPFD/INC
.
.
EXHCPEXT  FILE      ASCII,FIXED=4096
.
.         External HCP upload file layout - convhcpc.txt
.         (as per CONVXHCP.PBL)
.
.Name     Type    Length Description
.----     ----    ------ -----------
EXGPHCPC  DIM       10   HCP Code                            (pmhchcpc)
EXGPHCPT  DIM       2    Type of HCP                         (pmhchcpt)
.                            G = GP
.                            D = Dentist
EXGPTITL  DIM       10   HCP Title                           (pmhctitl)
EXGPGNM1  DIM       40   HCP First Given Name                (pmhcgnam)
EXGPGNM2  DIM       40   HCP Second Given Name               (pmhcgnam)
EXGPSNAM  DIM       35   HCP Surname                         (pmhcsnam)
EXGPINIT  DIM       5    HCP Initials                        (pmhcinit)
EXGPGNDR  DIM       1    HCP Gender                          (pmhcgndr)
.                            M = Male
.                            F = Female
.                            U = Unknown
EXGPDTOB  DIM       8    HCP Date of Birth (ccyymmdd)        (pmhcdtob)
EXGPSPC1  DIM       3    HCP Speciality 1 (Cat DT)           (pmhcspc1)
EXGPSPD1  DIM       8    HCP Speciality Date 1 (ccyymmdd)    (pmhcspd1)
EXGPSPC2  DIM       3    HCP Speciality 2 (Cat DT)           (pmhcspc2)
EXGPSPD2  DIM       8    HCP Speciality Date 2 (ccyymmdd)    (pmhcspd2)
EXGPSPC3  DIM       3    HCP Speciality 3 (Cat DT)           (pmhcspc3)
EXGPSPD3  DIM       8    HCP Speciality Date 3 (ccyymmdd)    (pmhcspd3)
EXGPSPC4  DIM       3    HCP Speciality 4 (Cat DT)           (pmhcspc4)
EXGPSPD4  DIM       8    HCP Speciality Date 4 (ccyymmdd)    (pmhcspd4)
EXGPSPC5  DIM       3    HCP Speciality 5 (Cat DT)           (pmhcspc5)
EXGPSPD5  DIM       8    HCP Speciality Date 5 (ccyymmdd)    (pmhcspd5)
EXGPRCPT  DIM       25   HCP Receptionist's Name             (pmhcrcpt)
EXGPADR1  DIM       60   HCP Surgery Address Line 1          (pmhcadr1)
EXGPADR2  DIM       60   HCP Surgery Address Line 2          (pmhcadr2)
EXGPADR3  DIM       60   HCP Surgery Address Line 3          (pmhcadr3)
EXGPADR4  DIM       60   HCP Surgery Address Line 4          (pmhcadr4)
EXGPADR5  DIM       60   HCP Surgery Address Line 5          (pmhcadr5)
EXGPADR6  DIM       60   HCP Surgery Address Line 6          (pmhcadr6)
EXGPPOST  DIM       8    HCP Surgery PostCode                (pmhcpost)
EXGPSTAT  DIM       4    HCP State                           (pmhcstat)
EXGPSEML  DIM       80   HCP Surgery Email Address           (pmhcseml)
EXGPSTEL  DIM       20   Surgery Telephone                   (pmhcstel)
EXGPPAGR  DIM       20   HCP Pager Telephone                 (pmhcpagr)
EXGPPAGN  DIM       20   HCP Pager Number                    (pmhcpagn)
EXGPAHP1  DIM       25   Associated HCP 1                    (pmhcahp1)
EXGPAHP2  DIM       25   Associated HCP 2                    (pmhcahp2)
EXGPAHP3  DIM       25   Associated HCP 3                    (pmhcahp3)
EXGPAHP4  DIM       25   Associated HCP 4                    (pmhcahp4)
EXGPAHP5  DIM       25   Associated HCP 5                    (pmhcahp5)
EXGPPRV1  DIM       10   Provider Number 1 - Reg. No. NZ     (pmhcprv1)
EXGPPRV2  DIM       10   Provider Number 2 - Prev Reg. No NZ (pmhcprv2)
EXGPPRV3  DIM       10   Provider Number 3                   (pmhcprv3)
EXGPPRV4  DIM       10   Provider Number 4                   (pmhcprv4)
EXGPPRV5  DIM       10   Provider Number 5                   (pmhcprv5)
EXGPHTEL  DIM       20   HCP Home Telephone                  (pmhchtel)
EXGPHAD1  DIM       60   HCP Home Address Line 1             (pmhchad1)
EXGPHAD2  DIM       60   HCP Home Address Line 2             (pmhchad2)
EXGPHAD3  DIM       60   HCP Home Address Line 3             (pmhchad3)
EXGPHAD4  DIM       60   HCP Home Address Line 4             (pmhchad4)
EXGPHAD5  DIM       60   HCP Home Address Line 5             (pmhchad5)
EXGPHAD6  DIM       60   HCP Home Address Line 6             (pmhchad6)
EXGPHPCD  DIM       8    HCP Home Post Code                  (pmhchpcd)
EXGPHEML  DIM       80   HCP Home Email Address              (pmhcheml)
.                          NZ - Healthlink Mailbox
EXGPDFAC  DIM       8    Date of First Accred. (ccyymmdd)    (pmhcdfac)
EXGPDLAC  DIM       8    Date of Last Accred. (ccyymmdd)     (pmhcdlac)
EXGPYACC  DIM       2    Years Of Accreditation              (pmhcyacc)
EXGPATYP  DIM       3    Accreditation Type (Cat AT)         (pmhcatyp)
EXGPHHCP  DIM       3    H.C.S. HCP Code                     (pmhchhcp)
EXGPOSLV  DIM       3    Operating Supervision Level (Cat DL)(pmhcoslv)
EXGPHCST  DIM       2    HCP Status                          (pmhchcst)
.                          0 = Attending Doctor
.                          1 = Referring Doctor
.                          2 = Attending & Referring Doctor
.                          3 = GP
.                          4 = Attending Doctor & GP
.                          5 = Referring Doctor & GP
.                          6 = Attending, Referring & GP
.                          7 = Other
.                          8 = Other Attending
.                          9 = Other Referring
.                          10 = Other Attending & Referring
.                          11 - Attending, GP & Other
.                          12 - Referring, GP & Other
.                          13 - Attending, Referring, GP & Other
.                          14 - Nurse
.                          15 - Nurse & Other
EXGPHCSD  DIM       8    HCP Status Date (ccyymmdd)          (pmhchcsd)
EXGPFAXN  DIM       20   HCP's Fax Number                    (pmhcfaxn)
EXGPHFXN  DIM       20   HCP's Home Fax Number               (pmhchfxn)
EXGPMOBN  DIM       20   HCP's Mobile Phone Number           (pmhcmobn)
EXGPCRDC  DIM       5    Creditor Code (apsmasaf)            (pmhccrdc)
EXGPWAHC  DIM       10   WA HDP HCP Code                     (pmhcwahc)
EXGPMRBN  DIM       10   Medical Registration Board Number   (pmhcmrbn)
EXGPNHSN  DIM       10   N.H.S. Proscriber Number            (pmhcnhsn)
EXGPUDF1  DIM       3    User Defined Field 1 (Cat R5)       (pmhcudf1)
EXGPUDF2  DIM       3    User Defined Field 2 (Cat R6)       (pmhcudf2)
EXGPUDF3  DIM       3    User Defined Field 3 (Cat R7)       (pmhcudf3)
EXGPUDF4  DIM       3    User Defined Field 4 (Cat R8)       (pmhcudf4)
EXGPUDF5  DIM       3    User Defined Field 5 (Cat R9)       (pmhcudf5)
EXGPUYN1  DIM       1    User def. Y/N field 1               (pmhcuyn1)
.                            Blank or 0 = No
.                                     1 = Yes
EXGPUYN2  DIM       1    User def. Y/N field 2               (pmhcuyn2)
.                            Blank or 0 = No
.                                     1 = Yes
EXGPUYN3  DIM       1    User def. Y/N field 3               (pmhcuyn3)
.                            Blank or 0 = No
.                                     1 = Yes
EXGPUYN4  DIM       1    User def. Y/N field 4               (pmhcuyn4)
.                            Blank or 0 = No
.                                     1 = Yes
EXGPUYN5  DIM       1    User def. Y/N field 5               (pmhcuyn5)
.                            Blank or 0 = No
.                                     1 = Yes
EXGPINSC  DIM       6    Insurance Code (patin1af)           (pmhcinsc)
EXGPIPLN  DIM       20   Insurance Policy Number             (pmhcipln)
EXGPIDTF  DIM       8    Insurance Date From (ccyymmdd)      (pmhcidtf)
EXGPIDTT  DIM       8    Insurance Date To (ccyymmdd)        (pmhcidtt)
EXGPMPGN  DIM       20   MPG Certificate Number              (pmhcmpgn)
EXGPAPCI  DIM       1    APC - NZ                            (pmhcapci)
.                            Blank or 0 = No
.                                     1 = Yes
EXGPREGT  DIM       3    Registration Type (Cat HR) - NZ     (pmhcregt)
EXGPRGDF  DIM       8    Reg. Date From - Gen Reg Date (NZ)  (pmhcrgdf)
.                           (ccyymmdd)
EXGPRGDT  DIM       8    Reg. Date To - Gen Reg Date (NZ)    (pmhcrgdt)
.                           (ccyymmdd)
EXGPPRDF  DIM       8    Probation. Reg. Date From (ccyymmdd)(pmhcprdf)
EXGPPRDT  DIM       8    Probation. Reg. Date To (ccyymmdd)  (pmhcprdt)
EXGPTSDF  DIM       8    Temp. Start Date From (ccyymmdd)    (pmhctsdf)
EXGPTFDT  DIM       8    Temp. Finish Date To (ccyymmdd)     (pmhctfdt)
EXGPVISD  DIM       8    Visa Date (ccyymmdd)                (pmhcvisd)
EXGPPRFC  DIM       3    HCP's Preferd Communication (Cat CZ)(pmhcprfc)
EXGPPRFN  DIM       30   HCP's Preferred Name                (pmhcprfn)
EXGPABNN  DIM       11   ABN Number                          (pmhcabnn)
EXGPUPDF  DIM       1    Update Flag                         (pmhcupdf)
.                              M = Manual
.                              A = Automatic
EXGPPRMK  DIM       1    Processed Record Marker             (pmhcprmk)
.                            Blank or 0 = Not Processed
.                                     1 = Processed
EXGPSTTS  DIM       1    HCP rec status                      (pmhcstts)
.                               Blank or 0 = Active
.                                        1 = Inactive
EXGPDLMI  DIM       8    Date Last Made Inactive (ccyymmdd)  (pmhcdlmi)
EXGPDLMA  DIM       8    Date Last Made Active (ccyymmdd)    (pmhcdlma)
EXGPCDTE  DIM       8    Date Record Created (ccyymmdd)      (pmhccdte)
EXGPCTIM  DIM       8    Time Record Created (hh:mm:ss)      (pmhcctim)
EXGPWEBC  DIM       10   WEB User Id creator (websecaf)      (pmhcwebc)
EXGPLUPD  DIM       8    Last Update Date (ccyymmdd)         (pmhclupd)
EXGPLUPT  DIM       8    Last Update Time (hh:mm:ss)         (pmhclupt)
EXGPWEBU  DIM       10   WEB User Id updated (websecaf)      (pmhcwebu)
EXGPSLGP  DIM       1    Show Local GP on PMI (plocdoc)      (pmhcslgp)
.                              Blank or 0 = No
.                                       1 = Yes
EXGPHOSS  DIM       1    Hospital Specific HCP (mlthcpaf)    (pmhchoss)
.                              Blank or 0 = No
.                                       1 = Yes
EXGPPTYP  DIM       3    Provider Type (nzpptyaf Cat pt)     (pmhcptyp)
EXGPEXML  DIM       1    Exclude from Mailing List           (pmhcexml)
.                              Blank or 0 = No
.                                       1 = Yes
EXGPDEAC  DIM       8    Accred. Expiry Date (ccyymmdd)      (pmhcdeac)
EXGPCPER  DIM       6    Common Person Number or HPN CPN     (pmhccper)
EXGPAHC1  DIM       3    AH Pref Contact Method 1 (Cat CZ)   (pmhcahc1)
EXGPAHC2  DIM       3    AH Pref Contact Method 2 (Cat CZ)   (pmhcahc2)
EXGPAHC3  DIM       3    AH Pref Contact Method 3 (Cat CZ)   (pmhcahc3)
EXGPSDAT  DIM       8    Start Date (ccyymmdd)               (pmhcsdat)
.
.
.
EXPRAEXT  FILE      ASCII,FIXED=4096
.
.         External HCP Practice upload file layout - convhcpp.txt
.         (as per CONVXHCP.PBL)
.
.Name     Type    Length Description
.----     ----    ------ -----------
EXPRPRAC  DIM       10   HCP Practice Code                     (pmhgprac)
EXPRTYPE  DIM       2    Type of HCP Practice                  (pmhgtype)
EXPRSPCD  DIM       10   Senior Partner HCP Code (pmshcpaf)    (pmhgspcd)
EXPRPNAM  DIM       80   HCP Practice Name                     (pmhgpnam)
EXPRADD1  DIM       60   HCP Practice Address 1                (pmhgadd1)
EXPRADD2  DIM       60   HCP Practice Address 2                (pmhgadd2)
EXPRADD3  DIM       60   HCP Practice Address 3                (pmhgadd3)
EXPRADD4  DIM       60   HCP Practice Address 4                (pmhgadd4)
EXPRADD5  DIM       60   HCP Practice Address 5                (pmhgadd5)
EXPRADD6  DIM       60   HPC Practice Address 6                (pmhgadd6)
EXPRPOST  DIM       8    HCP Practice Post Code                (pmhgpost)
EXPRSTAT  DIM       4    HCP Practice State                    (pmhgstat)
EXPRPEML  DIM       80   HCP Practice Email Address            (pmhgpeml)
EXPRPTEL  DIM       20   HCP Practice Telephone Number         (pmhgptel)
EXPRPFAX  DIM       20   HCP Practice Fax Number               (pmhgpfax)
EXPRPSTT  DIM       30   HCP Practice Status                   (pmhgpstt)
EXPRPPCN  DIM       30   HCP Practice Preferred Contact        (pmhgppcn)
.                             NZ - Healthlink Mailbox
EXPRPPNO  DIM       10   HCP Practice Provider Number          (pmhgppno)
EXPRFMDT  DIM       8    Formation Date of Practice (ccyymmdd) (pmhgfmdt)
EXPRDSDT  DIM       8    Dissolve Date of Practice (ccyymmdd)  (pmhgdsdt)
EXPRGPFH  DIM       5    GP Fundholder Code                    (pmhggpfh)
EXPRDTFA  DIM       8    Date GP Fund Holder Amended (ccyymmdd)(pmhgdtfa)
EXPRDTFE  DIM       8    GP Fund Holder End Date (ccyymmdd)    (pmhgdtfe)
EXPRGPPI  DIM       1    GPFH Extract GP Prac Inc              (pmhggppi)
.                            Blank or 0 = Included
.                                     1 = Excluded
EXPRUPFL  DIM       1    Update Flag                           (pmhgupfl)
.                            M = Manual
.                            A = Automatic
EXPRSTTS  DIM       1    Status                                (pmhgstts)
.                            Blank or 0 = Active
.                                     1 = Inactive
EXPRPCGC  DIM       5    Primary Care Group Code (cmscomaf)    (pmhgpcgc)
EXPRPRMK  DIM       1    Processed Record Marker               (pmhgprmk)
.                            Blank or 0 = Not Processed
.                                     1 = Processed
EXPRCDTE  DIM       8    Date Record Created (ccyymmdd)        (pmhgcdte)
EXPRCTIM  DIM       8    Time Record Created (hh:mm:ss)        (pmhgctim)
EXPRWEBC  DIM       10   WEB User Id creator (websecaf)        (pmhgwebc)
EXPRLUPD  DIM       8    Date Record Last Updated (ccyymmdd)   (pmhglupd)
EXPRLUPT  DIM       8    Time Record Last Updated (hh:mm:ss)   (pmhglupt)
EXPRWEBU  DIM       10   WEB User Id updated (websecaf)        (pmhgwebu)
.
.
.
EXLINEXT  FILE      ASCII,FIXED=4096
.
.         External HCP Linked HCP upload file layout - convhcpl.txt
.         (as per CONVXHCP.PBL)
.
.Name     Type    Length Description
.----     ----    ------ -----------
EXLNHCPC  DIM       10   HCP Code (pmshcpaf)                   (pmhlhcpc)
EXLNHCPR  DIM       10   HCP Practice (pmshcgaf)               (pmhlhcpr)
EXLNTYPE  DIM       1    HCP Record Type                       (pmhltype)
EXLNJPDT  DIM       8    Date HCP Joined Practice (ccyymmdd)   (pmhljpdt)
EXLNLPDT  DIM       8    Date HCP Left Practice (ccyymmdd)     (pmhllpdt)
EXLNPRMK  DIM       1    Processed Rec. Marker                 (pmhlprmk)
.                           Blank or 0 = Not Processed
.                                    1 = Processed
EXLNPRV1  DIM       10   Provider Number 1                     (pmhlprv1)
EXLNPRV2  DIM       10   Provider Number 2                     (pmhlprv2)
EXLNPRV3  DIM       10   Provider Number 3                     (pmhlprv3)
EXLNPRV4  DIM       10   Provider Number 4                     (pmhlprv4)
EXLNPRV5  DIM       10   Provider Number 5                     (pmhlprv5)
EXLNSTAT  DIM       1    Status                                (pmhlstat)
.                           Blank or 0 = Active
.                                    1 = Inactive
EXLNCDTE  DIM       8    Date Record Created (ccyymmdd)        (pmhlcdte)
EXLNCTIM  DIM       8    Time Record Created (hh:mm:ss)        (pmhlctim)
EXLNWEBC  DIM       10   WEB User Id creator (websecaf)        (pmhlwebc)
EXLNLUPD  DIM       8    Last Update Date (ccyymmdd)           (pmhllupd)
EXLNLUPT  DIM       8    Last Update Time (hh:mm:ss)           (pmhllupt)
EXLNWEBU  DIM       10   WEB user Id updated (websecaf)        (pmhlwebu)
.
.
. LOCAL VARIABLE DEFINITION
. -------------------------
ERRCOUNT  FORM      10
EXTCOUNT  FORM      10
FRSTGNAM  DIM       40
FULLGNAM  DIM       80
RECCOUNT  FORM      10
SCNDGNAM  DIM       40
.
.
. PROGRAM CONSTANTS
. -----------------
PIPE      INIT      "|"
.
PRGID     INIT      "EXTRXHCP"
PRGNAM    INIT      "External HCP Details Extraction"
VERSION   INIT      "V12.00.00"
+
.*****************************************************************************
.*                              MAIN0000                                     *
.*                      Controlling Logic (Mainline code)                    *
.*****************************************************************************
.
MAIN0000  CALL      INIT0000               * initialisation and open files
.
MAIN0100  CALL      OPTN0000               * select options
          BRANCH    EXIT,MAIN9999          * EXIT = 1 if 0 chosen in menu
          BRANCH    COPTION,MAIN1000:      * HCP extract
                            MAIN1000:      * HCP Practice extract
                            MAIN1000       * Linked HCP extract
.
MAIN1000  CALL      CONTQST                * Ok to continue ?
          BRANCH    CEXIT,MAIN5000:        * yes
                          MAIN0100:        * no
                          MAIN0100         * cancel
.
MAIN5000  CALL      CFIL0000               * create file
          BRANCH    EXIT,MAIN0100          * file exists
.
          CALL      PROC0000               * process
          GOTO      MAIN0100
.
MAIN9999  CHAIN     PGM                    * chain back to program
+
.*****************************************************************************
.*                                INIT0000             Called by: MAIN0000   *
.*                             initialisation                                *
.*  The initialisation routine is used to display headings and open files.   *
.*****************************************************************************
.
INIT0000  CALL      DISPHEAD                  * display heading
.
          DISPLAY   *P56:24,*EL,"Opening ":
                    *P64:24,"pmshcgaf";
          OPEN      PMSHCGA1,"pmshcgaf"
.
          DISPLAY   *P64:24,"pmshclaf";
          OPEN      PMSHCLA1,"pmshclaf"
.
          DISPLAY   *P64:24,"pmshcpaf";
          OPEN      PMSHCPA1,"pmshcpaf"
.
INIT9999  RETURN
+
.*****************************************************************************
.*                                OPTN0000             Called by: MAIN0000   *
.*                        get user options or exit                           *
.*    Returns:  EXIT    = FALSE (0)  Run data extraction                     *
.*                        TRUE  (1)  Exit option selected                    *
.*****************************************************************************
.
OPTN0000  DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF,". Exit":
                    *P1:5,*V2LON,ONE,*HOFF,". HCP Data Extraction":
                    *P1:6,*V2LON,TWO,*HOFF,". Practice Data Extraction":
                    *P1:7,*V2LON,THREE,*HOFF,". Linked HCP Data Extraction"
.
OPTN0500  KEYIN     *P1:9,*EL,"Select Option : ":
                    *P17:9,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9500 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9000:            * run hcp extraction
                            OPTN9000:            * run practice extraction
                            OPTN9000             * run linked hcp extraction
.
          BEEP
          GOTO      OPTN0500
.
OPTN9000  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.*****************************************************************************
.*                                  CFIL0000       Called by: MAIN0000       *
.*                         Create the extract file                           *
.*****************************************************************************
.
CFIL0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          IF        COPTION = 1
            OPEN      EXHCPEXT,"convhcpc"        * extract file exists ?
          ELSE
            IF        COPTION = 2
              OPEN      EXPRAEXT,"convhcpp"
            ELSE
              OPEN      EXLINEXT,"convhcpl"
            ENDIF
          ENDIF
          TRAPCLR   IO
          BRANCH    OVRCD,CFIL5000               * no - create it
.
CFIL1000  DISPLAY   *P1:23,*B,*EF,"The extract file ";
          IF        COPTION = 1
            DISPLAY   "convhcpc";
          ELSE
            IF        COPTION = 2
              DISPLAY   "convhcpp";
            ELSE
              DISPLAY   "convhcpl";
            ENDIF
          ENDIF
          KEYIN     ".txt already exists.":
                    *P1:24,"Overwrite it (",*V2LON,*DV,ANSY,*HOFF,"/":
                    *V2LON,*DV,ANSN,*HOFF,")?":
                    *P21:24,*V2LON,ANS
.
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS                * "Y" entered ?
          GOTO      CFIL2000 IF EQUAL       * yes - continue
.
          MATCH     ANSN,ANS                * "N" entered ?
          GOTO      CFIL9100 IF EQUAL       * no
.
          BEEP
          GOTO      CFIL1000
.
.         Delete the existing file
.
CFIL2000  IF        COPTION = 1
            CLOSE     EXHCPEXT,DELETE
          ELSE
            IF        COPTION = 2
              CLOSE     EXPRAEXT,DELETE
            ELSE
              CLOSE     EXLINEXT,DELETE
            ENDIF
          ENDIF
.
.         Create a new extract file
.
CFIL5000  IF        COPTION = 1
            PREP      EXHCPEXT,"convhcpc"
          ELSE
            IF        COPTION = 2
              PREP      EXPRAEXT,"convhcpp"
            ELSE
              PREP      EXLINEXT,"convhcpl"
            ENDIF
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      CFIL9999
.
CFIL9100  MOVE      ONE,EXIT
.
CFIL9999  RETURN
+
.*****************************************************************************
.*                               PROC0000              Called by: MAIN0000   *
.*        Loop through the Doctor's file and extract each record             *
.*****************************************************************************
.
PROC0000  MOVE      ZERO,RECCOUNT                * initialise record count
          MOVE      ZERO,EXTCOUNT                * initialise extract count
          MOVE      ZERO,ERRCOUNT                * initialise error count
          DISPLAY   *P1:24,*EL,"Processing:";
.
          BRANCH    COPTION,PROC1000:            * extract HCP data
                            PROC2000:            * extract Practice data
                            PROC3000             * extract Linked HCP data
.
PROC1000  MOVE      SP10,KEY10
          CALL      RSPMHCP1                     * position at start of file
PROC1500  CALL      RKPMHCP1                     * read next record
          BRANCH    OVRCD,PROC9000               * eof - finished
.
          MATCH     SP6,PMHCLDOC                 * local doctor from patdo1af ?
          IF        !@EQUAL
            ADD       ONE,ERRCOUNT               * yes - increment error count
            GOTO      PROC1500                   * ignore record
          ENDIF
.
          ADD       ONE,RECCOUNT                 * increment record counter
.
          DISPLAY   *P13:24,*V2LON,RECCOUNT
.
          MOVE      PMHCHCPC,EXGPHCPC
          SQUEEZE   EXGPHCPC
          MOVE      PMHCHCPT,EXGPHCPT
          SQUEEZE   EXGPHCPT
          MOVE      PMHCTITL,EXGPTITL
          SQUEEZE   EXGPTITL
          MOVE      PMHCGNAM,FULLGNAM
          CALL      SEPRNAME
          MOVE      FRSTGNAM,EXGPGNM1
          STRIP     EXGPGNM1
          MOVE      SCNDGNAM,EXGPGNM2
          STRIP     EXGPGNM2
          MOVE      PMHCSNAM,EXGPSNAM
          STRIP     EXGPSNAM
          MOVE      PMHCINIT,EXGPINIT
          STRIP     EXGPINIT
          MOVE      PMHCGNDR,EXGPGNDR
          STRIP     EXGPGNDR
          MOVE      PMHCDTOB,EXGPDTOB
          SQUEEZE   EXGPDTOB
          MOVE      PMHCSPC1,EXGPSPC1
          SQUEEZE   EXGPSPC1
          MOVE      PMHCSPD1,EXGPSPD1
          SQUEEZE   EXGPSPD1
          MOVE      PMHCSPC2,EXGPSPC2
          SQUEEZE   EXGPSPC2
          MOVE      PMHCSPD2,EXGPSPD2
          SQUEEZE   EXGPSPD2
          MOVE      PMHCSPC3,EXGPSPC3
          SQUEEZE   EXGPSPC3
          MOVE      PMHCSPD3,EXGPSPD3
          SQUEEZE   EXGPSPD3
          MOVE      PMHCSPC4,EXGPSPC4
          SQUEEZE   EXGPSPC4
          MOVE      PMHCSPD4,EXGPSPD4
          SQUEEZE   EXGPSPD4
          MOVE      PMHCSPC5,EXGPSPC5
          SQUEEZE   EXGPSPC5
          MOVE      PMHCSPD5,EXGPSPD5
          SQUEEZE   EXGPSPD5
          MOVE      PMHCRCPT,EXGPRCPT
          STRIP     EXGPRCPT
          MOVE      PMHCADR1,EXGPADR1
          STRIP     EXGPADR1
          MOVE      PMHCADR2,EXGPADR2
          STRIP     EXGPADR2
          MOVE      PMHCADR3,EXGPADR3
          STRIP     EXGPADR3
          MOVE      PMHCADR4,EXGPADR4
          STRIP     EXGPADR4
          MOVE      PMHCADR5,EXGPADR5
          STRIP     EXGPADR5
          MOVE      PMHCADR6,EXGPADR6
          STRIP     EXGPADR6
          MOVE      PMHCPOST,EXGPPOST
          SQUEEZE   EXGPPOST
          MOVE      PMHCSTAT,EXGPSTAT
          SQUEEZE   EXGPSTAT
          MOVE      PMHCSEML,EXGPSEML
          SQUEEZE   EXGPSEML
          MOVE      PMHCSTEL,EXGPSTEL
          STRIP     EXGPSTEL
          MOVE      PMHCPAGR,EXGPPAGR
          STRIP     EXGPPAGR
          MOVE      PMHCPAGN,EXGPPAGN
          STRIP     EXGPPAGN
          MOVE      PMHCAHP1,EXGPAHP1
          STRIP     EXGPAHP1
          MOVE      PMHCAHP2,EXGPAHP2
          STRIP     EXGPAHP2
          MOVE      PMHCAHP3,EXGPAHP3
          STRIP     EXGPAHP3
          MOVE      PMHCAHP4,EXGPAHP4
          STRIP     EXGPAHP4
          MOVE      PMHCAHP5,EXGPAHP5
          STRIP     EXGPAHP5
          MOVE      PMHCPRV1,EXGPPRV1
          STRIP     EXGPPRV1
          MOVE      PMHCPRV2,EXGPPRV2
          STRIP     EXGPPRV2
          MOVE      PMHCPRV3,EXGPPRV3
          STRIP     EXGPPRV3
          MOVE      PMHCPRV4,EXGPPRV4
          STRIP     EXGPPRV4
          MOVE      PMHCPRV5,EXGPPRV5
          STRIP     EXGPPRV5
          MOVE      PMHCHTEL,EXGPHTEL
          STRIP     EXGPHTEL
          MOVE      PMHCHAD1,EXGPHAD1
          STRIP     EXGPHAD1
          MOVE      PMHCHAD2,EXGPHAD2
          STRIP     EXGPHAD2
          MOVE      PMHCHAD3,EXGPHAD3
          STRIP     EXGPHAD3
          MOVE      PMHCHAD4,EXGPHAD4
          STRIP     EXGPHAD4
          MOVE      PMHCHAD5,EXGPHAD5
          STRIP     EXGPHAD5
          MOVE      PMHCHAD6,EXGPHAD6
          STRIP     EXGPHAD6
          MOVE      PMHCHPCD,EXGPHPCD
          SQUEEZE   EXGPHPCD
          MOVE      PMHCHEML,EXGPHEML
          SQUEEZE   EXGPHEML
          MOVE      PMHCDFAC,EXGPDFAC
          SQUEEZE   EXGPDFAC
          MOVE      PMHCDLAC,EXGPDLAC
          SQUEEZE   EXGPDLAC
          MOVE      PMHCYACC,EXGPYACC
          SQUEEZE   EXGPYACC
          MOVE      PMHCATYP,EXGPATYP
          SQUEEZE   EXGPATYP
          MOVE      PMHCHHCP,EXGPHHCP
          SQUEEZE   EXGPHHCP
          MOVE      PMHCOSLV,EXGPOSLV
          SQUEEZE   EXGPOSLV
          MOVE      PMHCHCST,EXGPHCST
          SQUEEZE   EXGPHCST
          MOVE      PMHCHCSD,EXGPHCSD
          SQUEEZE   EXGPHCSD
          MOVE      PMHCFAXN,EXGPFAXN
          STRIP     EXGPFAXN
          MOVE      PMHCHFXN,EXGPHFXN
          STRIP     EXGPHFXN
          MOVE      PMHCMOBN,EXGPMOBN
          STRIP     EXGPMOBN
          MOVE      PMHCCRDC,EXGPCRDC
          SQUEEZE   EXGPCRDC
          MOVE      PMHCWAHC,EXGPWAHC
          STRIP     EXGPWAHC
          MOVE      PMHCMRBN,EXGPMRBN
          STRIP     EXGPMRBN
          MOVE      PMHCNHSN,EXGPNHSN
          STRIP     EXGPNHSN
          MOVE      PMHCUDF1,EXGPUDF1
          SQUEEZE   EXGPUDF1
          MOVE      PMHCUDF2,EXGPUDF2
          SQUEEZE   EXGPUDF2
          MOVE      PMHCUDF3,EXGPUDF3
          SQUEEZE   EXGPUDF3
          MOVE      PMHCUDF4,EXGPUDF4
          SQUEEZE   EXGPUDF4
          MOVE      PMHCUDF5,EXGPUDF5
          SQUEEZE   EXGPUDF5
          MOVE      PMHCUYN1,EXGPUYN1
          STRIP     EXGPUYN1
          MOVE      PMHCUYN2,EXGPUYN2
          STRIP     EXGPUYN2
          MOVE      PMHCUYN3,EXGPUYN3
          STRIP     EXGPUYN3
          MOVE      PMHCUYN4,EXGPUYN4
          STRIP     EXGPUYN4
          MOVE      PMHCUYN5,EXGPUYN5
          STRIP     EXGPUYN5
          MOVE      PMHCINSC,EXGPINSC
          SQUEEZE   EXGPINSC
          MOVE      PMHCIPLN,EXGPIPLN
          STRIP     EXGPIPLN
          MOVE      PMHCIDTF,EXGPIDTF
          SQUEEZE   EXGPIDTF
          MOVE      PMHCIDTT,EXGPIDTT
          SQUEEZE   EXGPIDTT
          MOVE      PMHCMPGN,EXGPMPGN
          STRIP     EXGPMPGN
          MOVE      PMHCAPCI,EXGPAPCI
          STRIP     EXGPAPCI
          MOVE      PMHCREGT,EXGPREGT
          SQUEEZE   EXGPREGT
          MOVE      PMHCRGDF,EXGPRGDF
          SQUEEZE   EXGPRGDF
          MOVE      PMHCRGDT,EXGPRGDT
          SQUEEZE   EXGPRGDT
          MOVE      PMHCPRDF,EXGPPRDF
          SQUEEZE   EXGPPRDF
          MOVE      PMHCPRDT,EXGPPRDT
          SQUEEZE   EXGPPRDT
          MOVE      PMHCTSDF,EXGPTSDF
          SQUEEZE   EXGPTSDF
          MOVE      PMHCTFDT,EXGPTFDT
          SQUEEZE   EXGPTFDT
          MOVE      PMHCVISD,EXGPVISD
          SQUEEZE   EXGPVISD
          MOVE      PMHCPRFC,EXGPPRFC
          SQUEEZE   EXGPPRFC
          MOVE      PMHCPRFN,EXGPPRFN
          STRIP     EXGPPRFN
          MOVE      PMHCABNN,EXGPABNN
          STRIP     EXGPABNN
          MOVE      PMHCUPDF,EXGPUPDF
          STRIP     EXGPUPDF
          MOVE      PMHCPRMK,EXGPPRMK
          STRIP     EXGPPRMK
          MOVE      PMHCSTTS,EXGPSTTS
          STRIP     EXGPSTTS
          MOVE      PMHCDLMI,EXGPDLMI
          SQUEEZE   EXGPDLMI
          MOVE      PMHCDLMA,EXGPDLMA
          SQUEEZE   EXGPDLMA
          MOVE      PMHCCDTE,EXGPCDTE
          SQUEEZE   EXGPCDTE
          MOVE      PMHCCTIM,EXGPCTIM
          SQUEEZE   EXGPCTIM
          MOVE      PMHCWEBC,EXGPWEBC
          SQUEEZE   EXGPWEBC
          MOVE      PMHCLUPD,EXGPLUPD
          SQUEEZE   EXGPLUPD
          MOVE      PMHCLUPT,EXGPLUPT
          SQUEEZE   EXGPLUPT
          MOVE      PMHCWEBU,EXGPWEBU
          SQUEEZE   EXGPWEBU
          MOVE      PMHCSLGP,EXGPSLGP
          STRIP     EXGPSLGP
          MOVE      PMHCHOSS,EXGPHOSS
          STRIP     EXGPHOSS
          MOVE      PMHCPTYP,EXGPPTYP
          SQUEEZE   EXGPPTYP
          MOVE      PMHCEXML,EXGPEXML
          STRIP     EXGPEXML
          MOVE      PMHCDEAC,EXGPDEAC
          SQUEEZE   EXGPDEAC
          MOVE      PMHCCPER,EXGPCPER
          STRIP     EXGPCPER
          MOVE      PMHCAHC1,EXGPAHC1
          SQUEEZE   EXGPAHC1
          MOVE      PMHCAHC2,EXGPAHC2
          SQUEEZE   EXGPAHC2
          MOVE      PMHCAHC3,EXGPAHC3
          SQUEEZE   EXGPAHC3
          MOVE      PMHCSDAT,EXGPSDAT
          SQUEEZE   EXGPSDAT
.
          WRITE     EXHCPEXT,SEQ;*+,EXGPHCPC,PIPE,EXGPHCPT,PIPE,EXGPTITL,PIPE:
                                    EXGPGNM1,PIPE,EXGPGNM2,PIPE,EXGPSNAM,PIPE:
                                    EXGPINIT,PIPE,EXGPGNDR,PIPE,EXGPDTOB,PIPE:
                                    EXGPSPC1,PIPE,EXGPSPD1,PIPE,EXGPSPC2,PIPE:
                                    EXGPSPD2,PIPE,EXGPSPC3,PIPE,EXGPSPD3,PIPE:
                                    EXGPSPC4,PIPE,EXGPSPD4,PIPE,EXGPSPC5,PIPE:
                                    EXGPSPD5,PIPE,EXGPRCPT,PIPE,EXGPADR1,PIPE:
                                    EXGPADR2,PIPE,EXGPADR3,PIPE,EXGPADR4,PIPE:
                                    EXGPADR5,PIPE,EXGPADR6,PIPE,EXGPPOST,PIPE:
                                    EXGPSTAT,PIPE,EXGPSEML,PIPE,EXGPSTEL,PIPE:
                                    EXGPPAGR,PIPE,EXGPPAGN,PIPE,EXGPAHP1,PIPE:
                                    EXGPAHP2,PIPE,EXGPAHP3,PIPE,EXGPAHP4,PIPE:
                                    EXGPAHP5,PIPE,EXGPPRV1,PIPE,EXGPPRV2,PIPE:
                                    EXGPPRV3,PIPE,EXGPPRV4,PIPE,EXGPPRV5,PIPE:
                                    EXGPHTEL,PIPE,EXGPHAD1,PIPE,EXGPHAD2,PIPE:
                                    EXGPHAD3,PIPE,EXGPHAD4,PIPE,EXGPHAD5,PIPE:
                                    EXGPHAD6,PIPE,EXGPHPCD,PIPE,EXGPHEML,PIPE:
                                    EXGPDFAC,PIPE,EXGPDLAC,PIPE,EXGPYACC,PIPE:
                                    EXGPATYP,PIPE,EXGPHHCP,PIPE,EXGPOSLV,PIPE:
                                    EXGPHCST,PIPE,EXGPHCSD,PIPE,EXGPFAXN,PIPE:
                                    EXGPHFXN,PIPE,EXGPMOBN,PIPE,EXGPCRDC,PIPE:
                                    EXGPWAHC,PIPE,EXGPMRBN,PIPE,EXGPNHSN,PIPE:
                                    EXGPUDF1,PIPE,EXGPUDF2,PIPE,EXGPUDF3,PIPE:
                                    EXGPUDF4,PIPE,EXGPUDF5,PIPE,EXGPUYN1,PIPE:
                                    EXGPUYN2,PIPE,EXGPUYN3,PIPE,EXGPUYN4,PIPE:
                                    EXGPUYN5,PIPE,EXGPINSC,PIPE,EXGPIPLN,PIPE:
                                    EXGPIDTF,PIPE,EXGPIDTT,PIPE,EXGPMPGN,PIPE:
                                    EXGPAPCI,PIPE,EXGPREGT,PIPE,EXGPRGDF,PIPE:
                                    EXGPRGDT,PIPE,EXGPPRDF,PIPE,EXGPPRDT,PIPE:
                                    EXGPTSDF,PIPE,EXGPTFDT,PIPE,EXGPVISD,PIPE:
                                    EXGPPRFC,PIPE,EXGPPRFN,PIPE,EXGPABNN,PIPE:
                                    EXGPUPDF,PIPE,EXGPPRMK,PIPE,EXGPSTTS,PIPE:
                                    EXGPDLMI,PIPE,EXGPDLMA,PIPE,EXGPCDTE,PIPE:
                                    EXGPCTIM,PIPE,EXGPWEBC,PIPE,EXGPLUPD,PIPE:
                                    EXGPLUPT,PIPE,EXGPWEBU,PIPE,EXGPSLGP,PIPE:
                                    EXGPHOSS,PIPE,EXGPPTYP,PIPE,EXGPEXML,PIPE:
                                    EXGPDEAC,PIPE,EXGPCPER,PIPE,EXGPAHC1,PIPE:
                                    EXGPAHC2,PIPE,EXGPAHC3,PIPE,EXGPSDAT,*-
.
          ADD       ONE,EXTCOUNT                 * increment extract count
          GOTO      PROC1500                     * get next record
.
.         Process Practice data
.
PROC2000  MOVE      SP20,KEY12
          CALL      RSPMHCG1                     * position at start of file
PROC2500  CALL      RKPMHCG1                     * read next record
          BRANCH    OVRCD,PROC9000               * eof - finished
.
          ADD       ONE,RECCOUNT                 * increment record counter
.
          DISPLAY   *P13:24,*V2LON,RECCOUNT
.
          MOVE      PMHGPRAC,EXPRPRAC
          SQUEEZE   EXPRPRAC
          MOVE      PMHGTYPE,EXPRTYPE
          SQUEEZE   EXPRTYPE
          MOVE      PMHGSPCD,EXPRSPCD
          SQUEEZE   EXPRSPCD
          MOVE      PMHGPNAM,EXPRPNAM
          STRIP     EXPRPNAM
          MOVE      PMHGADD1,EXPRADD1
          STRIP     EXPRADD1
          MOVE      PMHGADD2,EXPRADD2
          STRIP     EXPRADD2
          MOVE      PMHGADD3,EXPRADD3
          STRIP     EXPRADD3
          MOVE      PMHGADD4,EXPRADD4
          STRIP     EXPRADD4
          MOVE      PMHGADD5,EXPRADD5
          STRIP     EXPRADD5
          MOVE      PMHGADD6,EXPRADD6
          STRIP     EXPRADD6
          MOVE      PMHGPOST,EXPRPOST
          SQUEEZE   EXPRPOST
          MOVE      PMHGSTAT,EXPRSTAT
          STRIP     EXPRSTAT
          MOVE      PMHGPEML,EXPRPEML
          SQUEEZE   EXPRPEML
          MOVE      PMHGPTEL,EXPRPTEL
          STRIP     EXPRPTEL
          MOVE      PMHGPFAX,EXPRPFAX
          STRIP     EXPRPFAX
          MOVE      PMHGPSTT,EXPRPSTT
          STRIP     EXPRPSTT
          MOVE      PMHGPPCN,EXPRPPCN
          STRIP     EXPRPPCN
          MOVE      PMHGPPNO,EXPRPPNO
          STRIP     EXPRPPNO
          MOVE      PMHGFMDT,EXPRFMDT
          SQUEEZE   EXPRFMDT
          MOVE      PMHGDSDT,EXPRDSDT
          SQUEEZE   EXPRDSDT
          MOVE      PMHGGPFH,EXPRGPFH
          STRIP     EXPRGPFH
          MOVE      PMHGDTFA,EXPRDTFA
          SQUEEZE   EXPRDTFA
          MOVE      PMHGDTFE,EXPRDTFE
          SQUEEZE   EXPRDTFE
          MOVE      PMHGGPPI,EXPRGPPI
          STRIP     EXPRGPPI
          MOVE      PMHGUPFL,EXPRUPFL
          STRIP     EXPRUPFL
          MOVE      PMHGSTTS,EXPRSTTS
          STRIP     EXPRSTTS
          MOVE      PMHGPCGC,EXPRPCGC
          SQUEEZE   EXPRPCGC
          MOVE      PMHGPRMK,EXPRPRMK
          STRIP     EXPRPRMK
          MOVE      PMHGCDTE,EXPRCDTE
          SQUEEZE   EXPRCDTE
          MOVE      PMHGCTIM,EXPRCTIM
          SQUEEZE   EXPRCTIM
          MOVE      PMHGWEBC,EXPRWEBC
          SQUEEZE   EXPRWEBC
          MOVE      PMHGLUPD,EXPRLUPD
          SQUEEZE   EXPRLUPD
          MOVE      PMHGLUPT,EXPRLUPT
          SQUEEZE   EXPRLUPT
          MOVE      PMHGWEBU,EXPRWEBU
          SQUEEZE   EXPRWEBU
.
          WRITE     EXPRAEXT,SEQ;*+,EXPRPRAC,PIPE,EXPRTYPE,PIPE,EXPRSPCD,PIPE:
                                    EXPRPNAM,PIPE,EXPRADD1,PIPE,EXPRADD2,PIPE:
                                    EXPRADD3,PIPE,EXPRADD4,PIPE,EXPRADD5,PIPE:
                                    EXPRADD6,PIPE,EXPRPOST,PIPE,EXPRSTAT,PIPE:
                                    EXPRPEML,PIPE,EXPRPTEL,PIPE,EXPRPFAX,PIPE:
                                    EXPRPSTT,PIPE,EXPRPPCN,PIPE,EXPRPPNO,PIPE:
                                    EXPRFMDT,PIPE,EXPRDSDT,PIPE,EXPRGPFH,PIPE:
                                    EXPRDTFA,PIPE,EXPRDTFE,PIPE,EXPRGPPI,PIPE:
                                    EXPRUPFL,PIPE,EXPRSTTS,PIPE,EXPRPCGC,PIPE:
                                    EXPRPRMK,PIPE,EXPRCDTE,PIPE,EXPRCTIM,PIPE:
                                    EXPRWEBC,PIPE,EXPRLUPD,PIPE,EXPRLUPT,PIPE:
                                    EXPRWEBU,*-
.
          ADD       ONE,EXTCOUNT                 * increment extract count
          GOTO      PROC2500                     * get next record
.
.         Process Linked HCP data
.
PROC3000  MOVE      SP20,KEY20
          CALL      RSPMHCL1                     * position at start of file
PROC3500  CALL      RKPMHCL1                     * read next record
          BRANCH    OVRCD,PROC9000               * eof - finished
.
          ADD       ONE,RECCOUNT                 * increment record counter
.
          DISPLAY   *P13:24,*V2LON,RECCOUNT
.
          MOVE      PMHLHCPC,EXLNHCPC
          SQUEEZE   EXLNHCPC
          MOVE      PMHLHCPR,EXLNHCPR
          SQUEEZE   EXLNHCPR
          MOVE      PMHLTYPE,EXLNTYPE
          STRIP     EXLNTYPE
          MOVE      PMHLJPDT,EXLNJPDT
          SQUEEZE   EXLNJPDT
          MOVE      PMHLLPDT,EXLNLPDT
          SQUEEZE   EXLNLPDT
          MOVE      PMHLPRMK,EXLNPRMK
          STRIP     EXLNPRMK
          MOVE      PMHLPRV1,EXLNPRV1
          STRIP     EXLNPRV1
          MOVE      PMHLPRV2,EXLNPRV2
          STRIP     EXLNPRV2
          MOVE      PMHLPRV3,EXLNPRV3
          STRIP     EXLNPRV3
          MOVE      PMHLPRV4,EXLNPRV4
          STRIP     EXLNPRV4
          MOVE      PMHLPRV5,EXLNPRV5
          STRIP     EXLNPRV5
          MOVE      PMHLSTAT,EXLNSTAT
          STRIP     EXLNSTAT
          MOVE      PMHLCDTE,EXLNCDTE
          SQUEEZE   EXLNCDTE
          MOVE      PMHLCTIM,EXLNCTIM
          SQUEEZE   EXLNCTIM
          MOVE      PMHLWEBC,EXLNWEBC
          SQUEEZE   EXLNWEBC
          MOVE      PMHLLUPD,EXLNLUPD
          SQUEEZE   EXLNLUPD
          MOVE      PMHLLUPT,EXLNLUPT
          SQUEEZE   EXLNLUPT
          MOVE      PMHLWEBU,EXLNWEBU
          SQUEEZE   EXLNWEBU
.
          WRITE     EXLINEXT,SEQ;*+,EXLNHCPC,PIPE,EXLNHCPR,PIPE,EXLNTYPE,PIPE:
                                    EXLNJPDT,PIPE,EXLNLPDT,PIPE,EXLNPRMK,PIPE:
                                    EXLNPRV1,PIPE,EXLNPRV2,PIPE,EXLNPRV3,PIPE:
                                    EXLNPRV4,PIPE,EXLNPRV5,PIPE,EXLNSTAT,PIPE:
                                    EXLNCDTE,PIPE,EXLNCTIM,PIPE,EXLNWEBC,PIPE:
                                    EXLNLUPD,PIPE,EXLNLUPT,PIPE,EXLNWEBU,*-
.
          ADD       ONE,EXTCOUNT                 * increment extract count
          GOTO      PROC3500                     * get next record
.
PROC9000  DISPLAY   *P1:22,*EF,"Extraction complete."
          IF        COPTION = 1
            DISPLAY   *P1:23,*V2LON,ERRCOUNT,*HOFF," local doctor records.  "
          ENDIF
          DISPLAY   *P1:24,*V2LON,EXTCOUNT,*HOFF," records extracted.  ";
          CALL      HITENTER
.
PROC9999  RETURN
+
. =========================================================================
.         I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       SEPRNAME
.
          INC       PMSHCGIO/INC
          INC       PMSHCLIO/INC
          INC       PMSHCPIO/INC
