.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINREAKY
.   Routine   :   QSIRAA00 Requisition Number  
.   Return    :           
.-------------------------------------------------------------------------------
QSIRAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
QSIRAA04
          CALL      GSCRN000
          BRANCH    EXIT,QSIRAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Req. No."           
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Date"               
.
          MOVE      STDCOL02,STDCOL03
          ADD       "11",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Cost Centre"        
.
          MOVE      STDCOL03,STDCOL04
          ADD       "12",STDCOL04
QSIRAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      Z70,SIRAREQ 
          PACK      KEY8,SIRATYP,SIRAREQ,Z70                                   
          PACK      SAVKEY80,SIRATYP,SIRAREQ,Z70                               
          SETLPTR   SAVKEY80,1                                                  
          CALL      RSSIRA1 
QSIRAA10
          CALL      RPSIRA1 
          BRANCH    OVRCD,QSIRAA15
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,QSIRAA12
          CALL      QSIRAA60
          BRANCH    OVRCD,QSIRAA10
QSIRAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIRAREQ 
          UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          DISPLAY   *PSTDCOL02:STDROW,CPCDATE 
          DISPLAY   *PSTDCOL03:STDROW,SIRACST 
          COMPARE   MAXITEM,XITEMNO
          GOTO      QSIRAA10 IF NOT EQUAL
QSIRAA15
          UNPACK    SAVKEY80,SIRATYP,SIRAREQ                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
QSIRAA20
          CALL      HSCRI000
          BRANCH    EXIT,QSIRAA30,QSIRAA35,QSIRAA40,QSIRAA45,QSIRAA04:
                              QSIRAA91,QSIRAA50
          GOTO      QSIRAA92
QSIRAA30
          CALL      RPSIRA1 
          BRANCH    OVRCD,QSIRAA85
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA85 IF NOT EQUAL                                       
          CALL      RKSIRA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      QSIRAA10
QSIRAA35
          MOVE      ST1,KEY8 
          CALL      RDSIRA1 
          CALL      RKSIRA1 
          BRANCH    OVRCD,QSIRAA85
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA85 IF NOT EQUAL                                       
          MATCH     SP70,SIRAREQ                                                
          GOTO      QSIRAA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
QSIRAA36
          CALL      RKSIRA1 
          BRANCH    OVRCD,QSIRAA37
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      QSIRAA36 IF NOT EQUAL
QSIRAA37
          MOVE      ZERO,XITEMNO
          GOTO      QSIRAA10
QSIRAA40
          MOVE      ST1,KEY8 
          CALL      RDSIRA1 
          CALL      RKSIRA1 
          BRANCH    OVRCD,QSIRAA85
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      QSIRAA08
QSIRAA45
          CALL      RPSIRA1 
          BRANCH    OVRCD,QSIRAA85
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,SAVKEY80,SP70
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIRA1 
QSIRAA46
          CALL      RKSIRA1 
          BRANCH    OVRCD,QSIRAA47
          PACK      KEY8,SIRATYP,SIRAREQ,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      QSIRAA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      QSIRAA46 IF NOT EQUAL
QSIRAA47
          MOVE      ZERO,XITEMNO
          GOTO      QSIRAA10
QSIRAA50  COMPARE   ZERO,CSEARCH
          GOTO      QSIRAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      QSIRAA08
QSIRAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      QSIRAA08
QSIRAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      QSIRAA61 IF EQUAL
          MATCH     SCHFLD01,SIRAREQ 
          GOTO      QSIRAA72 IF NOT EQUAL
QSIRAA61
          UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MATCH     SP70,SCHFLD02
          GOTO      QSIRAA62 IF EQUAL
          MATCH     SCHFLD02,CPCDATE 
          GOTO      QSIRAA72 IF NOT EQUAL
QSIRAA62
          MATCH     SP70,SCHFLD03
          GOTO      QSIRAA63 IF EQUAL
          MATCH     SCHFLD03,SIRACST 
          GOTO      QSIRAA72 IF NOT EQUAL
QSIRAA63
QSIRAA64
QSIRAA65
QSIRAA66
QSIRAA67
QSIRAA68
QSIRAA69
QSIRAA70
          GOTO      QSIRAA75
QSIRAA72  MOVE      ONE,OVRCD
QSIRAA75  RETURN
QSIRAA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,SIRATYP,SIRAREQ                                        
          CALL      RDSIRA1 
QSIRAA90
          UNPACK    SAVKEY80,SIRATYP,SIRAREQ                                    
          BEEP
          GOTO      QSIRAA20
QSIRAA91
          MOVE      ZERO,SIRAIND 
          MOVE      SP70,SIRACST 
          MOVE      SP70,SIRADAT 
          MOVE      SP70,SIRADEL 
          MOVE      ZERO,SIRATOT 
          MOVE      SP70,SIRASPA 
          MOVE      SP70,KEY8 
          MOVE      SP70,SIRAREQ 
          GOTO      QSIRAA96
QSIRAA92
          MOVE      SP70,KEY8 
          MOVE      SP70,SIRAREQ 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,SIRATYP,SIRAREQ                                        
QSIRAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
QSIRAA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINREAKY
.   Routine   :   KSIRAA00 Keyin Requisition Number  
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIRAA00 TOPIC     "SIRAREQ "
          MOVE      UNDLN70,SIRAREQ 
          KEYIN     *PCCOL:CVERT,*DV,SIRAREQ:                                   
                    *PCCOL:CVERT,*V2LON,*JR,SIRAREQ:                            
                    *PCCOL:CVERT,*DV,SIRAREQ 
.
          ENDSET    SIRAREQ 
          APPEND    SP70,SIRAREQ 
          RESET     SIRAREQ 
.
          MATCH     SP70,SIRAREQ 
          GOTO      KSIRAA90 IF EQUAL
.
          ENDSET    SIRAREQ 
          CMATCH    EXITCHAR,SIRAREQ 
          GOTO      KSIRAA95 IF EQUAL
.
          CMATCH    QUEST,SIRAREQ 
          GOTO      KSIRAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      QSIRAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIRAREQ 
          APPEND    SP70,SIRAREQ 
          RESET     SIRAREQ 
.
          MATCH     SP70,SIRAREQ 
          GOTO      KSIRAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIRAREQ                                 
KSIRAA10
          RESET     SIRAREQ 
          PACK      KEY8,SIRATYP,SIRAREQ                                        
          CALL      RASIRA1 
          BRANCH    OVRCD,KSIRAA80
          BRANCH    CKEYTYP,KSIRAA75
          CALL      RDSIRA1 
KSIRAA70
          MOVE      ZERO,EXIT
          GOTO      KSIRAA99
KSIRAA75
          MOVE      "Requisition Number Already Exist - ",DISPMSG                                    
          CALL      MESSAGE1
          GOTO      KSIRAA00
KSIRAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIRAA99,KSIRAA99
          MOVE      "Requisition Number Does Not Exist - ",DISPMSG                                   
          CALL      MESSAGE1
          GOTO      KSIRAA00
KSIRAA90
          MOVE      ONE,EXIT
          GOTO      KSIRAA99
KSIRAA95
          MOVE      TWO,EXIT
KSIRAA99 TOPIC    PRGID
          RETURN
