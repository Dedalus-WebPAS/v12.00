.
. BOKRC1IO.INC
. ------------
. Filename        : bokrc1af.dat
. Description     : Booking Master file (rewrite for new theatre system)
. Variables       : KEY8  KEY16  KEY19  KEY22  KEY24  KEY28
.
. Modifications   : 25/06/1999    Nicole Harrington
.                   Added 7th index
.                   21/01/1991    The Phantom
.                   Added BKREEBED, the expected bed
.                   10/07/1991    Justin Coates  (Vic Health Dept Changes)
.                   Added BKRECLSS, BKREATYP, BKREDEPT, BKRETDOC
.                   10/10/1991    Justin Coates
.                   Added BKRECLMT
.                   16/03/1993    Graeme Williams
.                   Added BKREECRA - ECR approval number
.                   Increased spare variable
.                   18/03/1993    Graeme Williams
.                   Changed BKRECNT to DBKRECNT
.                   28/10/1993    Justin Coates  QUOTE 440017  SRF 440204 
.                   added BKREGPPT
.                   07/03/1994    Justin Coates  SRF 440719
.                   added BKREDOFR
.                   13/10/1995   Howellsy         suht  
.                   added bkreoper  
.                   31/10/1995    Justin Coates  (SUHT mods)
.                   added bkreelos
.
. -- I/O routines for 1st Index --
.
RABKREC1  MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      BOKRC1A1,KEY8;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC1  RESET     KEY8
          READ      BOKRC1A1,KEY8;;
          RETURN
.
RDBKREC1  MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      BOKRC1A1,KEY8;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RLBKREC1  MOVE      ZERO,OVRCD
          RESET     KEY8
          READL     BOKRC1A1,KEY8;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UUBKREC1  UNLOCK    BOKRC1A1
          RETURN
.
RKBKREC1  MOVE      ZERO,OVRCD
          READKS    BOKRC1A1;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC1  MOVE      ZERO,OVRCD
          READKP    BOKRC1A1;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC1  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A1;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC1  RESET     KEY8
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A1,KEY8;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC1  RESET     KEY8
          DELETE    BOKRC1A1,KEY8
          RETURN
.
. -- I/O routine for 2nd Index --
.
RABKREC2  MOVE      ZERO,OVRCD
          RESET     KEY28
          READ      BOKRC1A2,KEY28;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC2  RESET     KEY28
          READ      BOKRC1A2,KEY28;;
          RETURN
.
RDBKREC2  MOVE      ZERO,OVRCD
          RESET     KEY28
          READ      BOKRC1A2,KEY28;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RKBKREC2  MOVE      ZERO,OVRCD
          READKS    BOKRC1A2;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC2  MOVE      ZERO,OVRCD
          READKP    BOKRC1A2;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC2  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A2;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC2  RESET     KEY28
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A2,KEY28;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC2  RESET     KEY28
          DELETE    BOKRC1A2,KEY28
          RETURN
.
. -- I/O routine for 3nd Index --
.
RABKREC3  MOVE      ZERO,OVRCD
          RESET     KEY22
          READ      BOKRC1A3,KEY22;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC3  RESET     KEY22
          READ      BOKRC1A3,KEY22;;
          RETURN
.
RDBKREC3  MOVE      ZERO,OVRCD
          RESET     KEY22
          READ      BOKRC1A3,KEY22;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RKBKREC3  MOVE      ZERO,OVRCD
          READKS    BOKRC1A3;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC3  MOVE      ZERO,OVRCD
          READKP    BOKRC1A3;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC3  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A3;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC3  RESET     KEY22
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A3,KEY22;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC3  RESET     KEY22
          DELETE    BOKRC1A3,KEY22
          RETURN
.
. -- I/O routine for 4th Index --
.
RABKREC4  MOVE      ZERO,OVRCD
          RESET     KEY16
          READ      BOKRC1A4,KEY16;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC4  RESET     KEY16
          READ      BOKRC1A4,KEY16;;
          RETURN
.
RDBKREC4  MOVE      ZERO,OVRCD
          RESET     KEY16
          READ      BOKRC1A4,KEY16;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RKBKREC4  MOVE      ZERO,OVRCD
          READKS    BOKRC1A4;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC4  MOVE      ZERO,OVRCD
          READKP    BOKRC1A4;DBKREBOO,BKREURNO,BKRESNAM:
                            BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                            BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                            BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                            DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                            BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                            BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                            BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                            BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC4  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A4;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC4  RESET     KEY16
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A4,KEY16;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC4  RESET     KEY16
          DELETE    BOKRC1A4,KEY16
          RETURN
.
. -- I/O routine for 5th Index --
.
RABKREC5  MOVE      ZERO,OVRCD
          RESET     KEY24
          READ      BOKRC1A5,KEY24;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC5  RESET     KEY24
          READ      BOKRC1A5,KEY24;;
          RETURN
.
RDBKREC5  MOVE      ZERO,OVRCD
          RESET     KEY24
          READ      BOKRC1A5,KEY24;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RKBKREC5  MOVE      ZERO,OVRCD
          READKS    BOKRC1A5;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC5  MOVE      ZERO,OVRCD
          READKP    BOKRC1A5;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC5  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A5;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC5  RESET     KEY24
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A5,KEY24;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC5  RESET     KEY24
          DELETE    BOKRC1A5,KEY24
          RETURN
.
. -- I/O routine for 6th Index --
.
RABKREC6  MOVE      ZERO,OVRCD
          RESET     KEY16
          READ      BOKRC1A6,KEY16;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC6  RESET     KEY16
          READ      BOKRC1A6,KEY16;;
          RETURN
.
RDBKREC6  MOVE      ZERO,OVRCD
          RESET     KEY16
          READ      BOKRC1A6,KEY16;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RKBKREC6  MOVE      ZERO,OVRCD
          READKS    BOKRC1A6;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC6  MOVE      ZERO,OVRCD
          READKP    BOKRC1A6;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC6  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A6;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC6  RESET     KEY16
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A6,KEY16;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC6  RESET     KEY16
          DELETE    BOKRC1A6,KEY16
          RETURN
.
. -- I/O routine for 7th Index --
.
RABKREC7  MOVE      ZERO,OVRCD
          RESET     KEY19
          READ      BOKRC1A7,KEY19;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSBKREC7  RESET     KEY19
          READ      BOKRC1A7,KEY19;;
          RETURN
.
RDBKREC7  MOVE      ZERO,OVRCD
          RESET     KEY19
          READ      BOKRC1A7,KEY19;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RKBKREC7  MOVE      ZERO,OVRCD
          READKS    BOKRC1A7;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
RPBKREC7  MOVE      ZERO,OVRCD
          READKP    BOKRC1A7;DBKREBOO,BKREURNO,BKRESNAM:
                          BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                          BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                          BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                          DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                          BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                          BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                          BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                          BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
UPBKREC7  MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKRC1A7;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
WRBKREC7  RESET     KEY19
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKRC1A7,KEY19;DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
DEBKREC7  RESET     KEY19
          DELETE    BOKRC1A7,KEY19
          RETURN
.
.
. -- I/O for Audit file --
.
ASBKREC   MOVE      ZERO,OVRCD
          RESET     KEY19
          READ      BOKAUDR1,KEY19;;
          RETURN
.
AKBKREC   MOVE      ZERO,OVRCD
          READKS    BOKAUDR1;BKREAUDD,BKREAUDT,BKREAUDP,BKREAUDR:
                                BKREAUDS,BKREAUDO,DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          GOTO      OVERCOND IF OVER
          MOVE      DBKREBOO,BKREBOOK
          MOVE      DBKRECNT,BKRECNT
          MOVE      DBKREELO,BKREELOS
          RETURN
.
AWBKREC   RESET     KEY19
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          MOVE      PASSCODE,BKREOPER
          WRITE     BOKAUDR1,KEY19;BKREAUDD,BKREAUDT,BKREAUDP,BKREAUDR:
                                BKREAUDS,BKREAUDO,DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
AUBKREC   RESET     KEY19
          MOVE      BKREBOOK,DBKREBOO
          MOVE      BKRECNT,DBKRECNT
          MOVE      BKREELOS,DBKREELO
          UPDATE    BOKAUDR1;BKREAUDD,BKREAUDT,BKREAUDP,BKREAUDR:
                                BKREAUDS,BKREAUDO,DBKREBOO,BKREURNO,BKRESNAM:
                                BKRELOCK,BKREADOC,BKRESDOC,BKREEDAT,BKREATIM:
                                BKREPDAT,BKREPTIM,BKREADAT,BKRETYPE,BKRECANC:
                                BKRESTAT,BKREOMEM,BKREPREV,BKREACCM,BKREPROC:
                                DBKRECNT,BKREWARD,BKREADMN,BKREPREA,BKREEBED:
                                BKRECLSS,BKREATYP,BKREDEPT,BKRETDOC,BKRECLMT:
                                BKRERFGP,BKREGPPC,BKREGPFA,BKRERESI:
                                BKREEATY,BKREECRA,BKREGPPT,BKREDOFR:
                                BKREOPER,DBKREELO,BKREBKDT,BKREINDC,BKRESPAR
          RETURN
.
ADBKREC   RESET     KEY19
          DELETE    BOKAUDR1,KEY19
          RETURN
+
.

