.******************************************************************************
.*                                                                            *
.*  PATSHT6 - MR10 Layout 6 (User Defined Stationery)                         *
.*                                                                            *
.* &&&&& Make sure the file ibavaraf is updated with the new variables &&&&&  *
.*                                                                            *
.* Modifications  :                                                           *
.****************************************************************************** 
.* V12.00.02  08/09/2025 Thanh T           TSK 0949457                        *
.*            Added PRT12470 to PRT12560                                      *
.* V12.00.01  22/05/2025  Alina Bhari   TSK 0955096                           *
.*            Added alpanumeric visit number generation                       *
.*            -NXTRN6,PR6I2416,PR6I2417,PR6I2418,PR6I3160,PR6I3161,GETMBS10   *
.****************************************************************************** 
.* V11.05.05  07/04/2025  PJ Le Febour     TSK 0949428b                       *
.*            updated PRT12460 pmsvx1af.PMVXUDF7 if 1 Variable YES if 0 NO    * 
.* V11.05.04  19/03/2025  PJ Le Febour     TSK 0949428a                       *
.*            amended PRT12460 - rewrote logic to remove redundant coding     *
.* V11.05.03  22/02/2025  PJ Le Febour     TSK 0949428                        *
.*            added PRT12460 retrieve pmsvx1af.PMVXUDF7(upload to MyHR)       *
.* V11.05.02  30/01/2025  Thanh T          TSK 0956569                        *
.*            Changed PRT12340, PRT12360, PRT12380 and PRT12400 to fix issue  *
.*            with Ethnicity and Lang Spoken At Home description not printing *
.*            correct                                                         *
.* V11.05.01  30/01/2025  Thanh T          TSK 0956569                        *
.*            Changed PRT12420 and PRT12440 to fix issue with NOK main        *
.*            language description not printing correct                       *
.* V11.04.03  24/05/2024  Thanh T          TSK 0941543                        *
.*            Moved GPMCEX00 to INC file                                      * 
.* V11.04.02  10/05/2024  Thanh T          TSK 0941543                        *
.*            Added PRT12330-PRT12440 for Ethnicity and Main Language Spoken  *
.*            at home variables (1233-1244)                                   * 
.*            14/05/2024  J.Tan            TSK 0935689                        *
.*            Added PRT12450-PTELTOOP for Total Out of Pocket $               *
.* V11.04.01  23/11/2023  Peter Vela      TSK 0935874                         *
.*            Added validation for PTCNUNET = 3 at PR6I3117                   *
.*            NIHC IHI functionality                                          *
.* V11.03.02  22/11/2023  Thanh T         TSK 0914124                         *
.*            Changed PALRT200 to print out blank when reaction code is       *
.*            not entered                                                     *
.* V11.03.01  11/09/2023  Thanh T         TSK 0914124                         *
.*            Changed PALRT200 to save WBSEUID                                * 
.* V11.02.04  29/08/2022  Thanh T         TSK 0914124                         *
.*            Changed PALRT000 to write out requestd by id                    *
.* V11.02.03  02/08/2022  Thanh T         TSK 0914124                         *
.*            Added PRT12230-PRT12320 for patient alerts & notes variable     *
.*            1223-1232                                                       * 
.* V11.02.02  13/04/2022  Thanh T          TSK 0903453                        *
.*            Added PR6I3217 to PR6I3222 for Identifying gender/pronoun and   *
.*            free text fields                                                *
.* V11.02.01  21/01/2022  Jacob Jackson    TSK 0864505                        *
.*            Added preferred name field options -                            *
.*            PR6I3212, PR6I3213, PR6I3214, PR6I3215, PR6I3216                *
.* V11.01.03  24/11/2021  Sunny            TSK 0900631                        *
.*            Added PR6I3210 to PR6I3211                                      *
.* V11.01.02  24/08/2021  Sunny            TSK 0893817                        *
.*            Added PR6I3206 to PR6I3209                                      *
.* V11.01.01  22/02/2021  J.Tan            TSK 0888639                        *
.*            Changed patmmbs counter record to DIM3                          *
.* V11.00.06  17/11/2020  Thanh T         TSK 0878747                         *
.*            Added PR6I3205 for multiple birth details                       * 
.* V11.00.05  12/11/2020  Ebon Clements   TSK 0898748                         *
.*            Fixed new contacts var 383 - Emergency contact address line 4   *
.*            Added address line 4 to PAC6ADDR                                *
.* V11.00.04  10/09/2020  Peter Vela      TSK 0895969                         *
.*            Added WebServices OECW                                          *
.* V11.00.03  07/04/2020  Ebon Clements   TSK 0887745                         *
.*            Added var 1204 - Discharge date dd/mm/ccyy - PR6I3204           *
.* V11.00.02  02/04/2020  Thanh T         TSK 0879163                         *
.*            Changed PR6ID456,PR6I1076,PR6I1432 for Sex category             *
.*            changes.                                                        *
.*            Added PR6I3203 for sex long description (var=1203)              * 
.*            02/04/2020  J.Tan             TSK 0868813                       *
.*            Changed PKNAME to DIM80                                         *
.* V11.00.01  10/03/2020  J.Tan          TSK 0838262                          *
.*             Added Effective from and to date to MBS Item file              *
.****************************************************************************** 
.*       V10.14.01  19/02/2019  Ebon Clements   TSK 0867703                   *
.*                  Changed NHI ethnicity file reads to use KEY5              *
.****************************************************************************** 
.*       V10.13.08  13/12/2018  Thanh T         TSK 0865690                   *
.*                  Changed ADCMNT00 to show the comments in ascending order  *
.*                  of creation date/time without header                      *
.*       V10.13.07  13/12/2018  Thanh T         TSK 0865690                   *
.*                  Changed ADCMNT00 to save the current user id WBSEUID      *
.*                  who print the form                                        *
.*       V10.13.06  19/11/2018  Ken Bell        TSK 0862405                   *
.*                  Added 1201,PTELPCCU and 1202,PTELPCUT                     *
.*       V10.13.05  05/11/2018  Thanh T         TSK 0865690                   *
.*                  Changed ADCOM000 to ADCMNT00 to show all the active visit *
*                  comment header and text                                   *
.*       V10.13.04  16/10/2018  Ebon Clements   TSK 0863467                   *
.*                  Added save and restore of ibalpcaf fields instead         *
.*                  re reads - SLPC0000 and RLPC0000                          *
.*       V10.13.03  04/09/2018  Ken Bell        TSK 0862168                   *
.*                  Added 1200 variable for Medicare Safety Net Number on     *
.*                  Patient demographics form still used for some clients     *
.*                  to the Stationary Type FSHEET (Stationary Template 3)     *
.*       V10.13.02  22/08/2018  Thanh T         TSK 0860668                   *
.*                  Clear VARIABLE field at the start of label                *
.*                  PR6I2263/PR6I2270/PR6I2273/PR6I2331                       *
.*       V10.13.01  08/08/2018  Thanh T         TSK 0860668                   *
.*                  Changed PMI HCP Practice Address details variables        *
.*                  (263-268,365-371) for (PR6I2329-PR6I2335) to use          *
.*                  HCP details from pmshcpaf if no practice exists           *
.*       V10.11.02  24/10/2017  Davin           TSK 0837347                   *
.*                  Changed HCP Practice Address variables (270-275) to use   *
.*                  HCP details from pmshcpaf if no practice exists (PR6I2270)*
.*       V10.11.01  18/07/2017  Steve Armstrong TSK 0842330                   *
.*                  Removed CLOSE on PATWC1A1, PMSWX1A1 & PATIN1A1 to fix     *
.*                  I * C.                                                    *
.*                  14/07/2017  Thanh T.       TSK 0821710                    *
.*                  Audit Amission/outpatient visit comments. PATMISTM change *
.****************************************************************************** 
.*       V10.10.01  17/03/2017  Thanh T.        TSK 0832066                   *
.*                  Changed DVA PREPAT/PMPXDVAC fields to use the new         *
.*                  concession card PMCDCNUM/PMCDDVAC fields                  *
.****************************************************************************** 
.*       V10.09.02  03/02/2017  Ken Bell        TSK 0831808                   *
.*                  (PR6I2270) Should obtain the Inpatient Visit Practice     *
.*       V10.09.01  07/12/2016  Jill Parkinson  TSK 0822329                   *
.*                  Added var 1199 ACC Purchase Order Number                  *
.****************************************************************************** 
.*       V10.08.05  07/09/2016  Peter Vela       TSK 0821597                  *
.*                  Added var 1198                                            *
.*       V10.08.04  10/08/2016  Davin            TSK 0321234                  *
.*                  Added vars 1168 - 1197 (PR6I3168)                         *
.*                  Added PRTALCPW for Alert Care Pathway Fields              *
.*       V10.08.03  10/08/2016  Ebon Clements    TSK 0821162                  *
.*                  Print relationship description not code vars 231          *
.*       V10.08.02  15/07/2016  Davin            TSK 0315393                  *
.*                  Added var 1166 (PR6I3166) - PMPXRPER Retention Period     *
.*                  Added var 1167 (PR6I3167) - PMPXRDAT Retention Date       *
.*       V10.08.01  03/05/2016  Peter Vela       TSK 0321530                  *
.*                  Added var 1163 (PR6I3163) - ADOCTA Provider Number        *
.*                  Added var 1164 (PR6I3164) - PMVXEDC1 Provider Number      *
.*                  Added var 1165 (PR6I3165) - PMVXRHC1 Provider Number      *
.*       V10.07.04  23/02/2016  Don Nguyen       TSK 0323914                  *
.*                  Added var 1162 (PR6I3162) - Fund Excess for Same day      *
.*       V10.07.03  02/02/2016  Peter Vela       TSK 0322116                  *
.*                  Added Admission Ward and Discharge Ward from pattranf     *
.*       V10.07.02  29/01/2016  Peter Vela       TSK 0809567                  *
.*                  Added ADIET - PR6I3154                                    *
.*                  Added PMVXPACC - PR6I3156                                 *
.*                  Added PTMIUSR9 - PR6I3158                                 *
.*       V10.07.01  19/10/2015  Don Nguyen       CAR 316625                   *
.*                  Added 1152 and 1153 (PR6I3152 & PR6I3153) - Case Team     *
.*       V10.06.05  14/09/2016  Peter Vela       CAR 320950                   *
.*                  Added Multiple Card Type Number PR6I3151                  * 
.*       V10.06.04  27/08/2015  Don Nguyen       CAR 308621                   *
.*                  Added 1148-1150 (PR6I3148-PR6I3150) - Referring Doctor    *
.*       V10.06.03  13/08/2015  Don Nguyen       CAR 308621                   *
.*                  Added 1138-1147 (PR6I3138-PR6I3147) - MBS Item Desc/Date  *
.*                  Added 1137 (PR6I3137) - Referring Doctor Fax              *
.*       V10.06.02  28/05/2015  Peter Vela       CAR 312552                   *
.*                  Added Planned length of stay ASTAY                        *
.*       V10.06.01  15/04/2015  J.Tan            CAR 314503                   *
.*                  Added var 1135 (PR6I3135) - Casemix code                  *
.*       V10.05.04  23/01/2015  Peter Vela       CAR 310793                   *
.*                  Added var 1133 (PR6I3133) - Preassessment Date            *
.*                  Added var 1134 (PR6I3134) - Preassessment Date            *
.*       V10.05.03  09/01/2015  Don Nguyen       CAR 296120                   *
.*                  Added var 1132 (PR6I3132) - TAC Date of Accident          *
.*       V10.05.02  31/10/2014  J.Tan            CAR 304310                   *
.*                  Added var 1131 (PR6I3131) - DVA Visit                     *
.*       V10.05.01  30/10/2014  Don Nguyen       CAR 307680                   *
.*                  Added var 1130 (PR6I3130) - Admitting Point               *
.*       V10.04.04  02/07/2014  Don Nguyen       CAR 292599                   *
.*                  Added vars 1120 - 1129 (PR6I3120 - PR6I3129)              *
.*                  Added PRHCP000, PRHCG000, CASE0000                        *
.*       V10.04.03  09/05/2014  J.Tan            CAR 285504                   *
.*                  Fixed PR6I3118 (var 1118) and PR6I3119 (var 1119)         *
.*       V10.04.02  17/02/2014  Don Nguyen       CAR 291879                   *
.*                  Added PR6I3117 (var 1117) - IHI Number                    *
.*                  24/02/2014  J.Tan            CAR 285504                   *
.*                  Added PR6I3118 (var 1118) - First name in sentence case   *
.*                  Added PR6I3119 (var 1119) - Second name in sentence case  *
.*       V10.04.01  09/01/2014  Don Nguyen       CAR 295501                   *
.*                  Added PR6I3116 (var 1116) - Formatted Patient Name        *
.*       V10.03.12  26/08/2013  Davin            CAR 284840                   *
.*                  Added PR6I3114 - Attending Doctor name  (PACFRMT = 1)     *
.*                  Added PR6I3115 - Referring Doctor name  (PACFRMT = 1)     *
.*       V10.03.11  18/07/2013  Don Nguyen       CAR 288603                   *
.*                  Added PR6I3113 - Patient Type Description                 *
.*       V10.03.10  23/04/2013  Don Nguyen       CAR 283575                   *
.*                  Added PR6I3111 & PR6I3112 (Health Purchaser code/desc)    *
.*       V10.03.09  18/04/2013  J.Tan            CAR 281636                   *
.*                  Mods checking for "UNK" AVISIT                            *
.*       V10.03.08  17/04/2013  Don Nguyen       CAR 282342                   *
.*                  Corrected pos read for PTCNURBP                           *
.*       V10.03.07  09/04/2013  Don Nguyen       CAR 282342                   *
.*                  Mods to use UR for BPAYINVN (if PTCNURBP=1)               *
.*       V10.03.06  18/01/2013   Saroeun Soeur   CAR 273569                   *
.*                  Added Pension Status - PR6I3110                           *
.*       V10.03.05  18/07/2012  Don Nguyen       CAR 264561                   *
.*                  Read in Hospital ID before calling GBCRN000               *
.*       V10.03.04  20/02/2012  J.Tan         CAR 247672                      *
.*                  Fixed variable 300 - Hospital Approval No for multi.Hosp. *
.*       V10.03.03  06/02/2012  Ebon Clements    CAR 259219                   *
.*                  Print relationship description not code vars 33 and 1097  *
.*       V10.03.02  31/01/2012  J.Tan         CAR 247090                      *
.*                  Added new variables for Multiple Card Type                *
.*       V10.03.01 10/11/2011  Ebon Clements     CAR 248529                   *
.*                  Added multiple contacts of the same type functionality    *
.*       V10.02.08  18/10/2011  Davin            CAR 253080                   *
.*                  Added new vars 1105-1106                                  *
.*       V10.02.07  14/10/2011  Davin            CAR 252759                   *
.*                  Added new vars 1103-1104                                  *
.*       V10.02.06  14/09/2011  Davin            CAR 248749                   *
.*                  Added new vars 1076-1102                                  *
.*       V10.02.05  29/06/2011  Peter Vela       CAR 239594                   *
.*                  Added WAHealth Variables                                  *
.*       V10.02.04  11/06/2011  Ebon Clements    CAR 239530                   *
.*                  Added print extra contact functionality                   *
.*       V10.02.03  25/05/2011  Saroeun Soeur    CAR 242008                   *
.*                  DSPVR149 - DSPVR150                                       *
.*       V10.02.02  12/05/2011  Saroeun Soeur CAR 242008                      *
.*                  Added Health fund Group Name code and descrip.  FDHL0000  * 
.*       V10.02.01  11/04/2011  Peter Vela CAR 239759                         *
.*                  Added Hospital ID                                         *
.*       V10.01.02  13/01/2011  Jill Parkinson CAR 236279                     *
.*                  Changed to use PTMASNAM                                   *
.*       V10.01.01  06/01/2011  Jill Parkinson CAR 230088                     *
.*                  Changed to use PMVXFNDM instead of AFNDMM                 *
.*       V10.00.03  14/12/2010  Mike Laming   CAR 233046                      *
.*                  Mods to "patmchgf" - replaced read logic with PATMCHRD    *
.*       V10.00.02  30/04/2010  J.Tan     CAR 220887                          *
.*                  Mods checking for Active/Inactive of Misc.charge          *
.*       V10.00.01  31/03/2010  Davin           CAR 208120                    *
.*                  Added var 874 - first Alternate ID (from pmsaidaf)        *
.*        V9.12.06  07/01/2010  Ebon Clements   CAR 212367                    *
.*                  Added var 873 - PLOCDOC local doctor free format          *
.*        V9.12.05  22/12/2009  Ebon Clements   CAR 205439                    *
.*                  Changed concession card print order to use cat ct ind 3   *
.*                  GCCSJG00                                                  *
.*        V9.12.04  10/11/2009  Peter Vela      CAR 199757                    *
.*                  Added Next Stationery Code Variable                       *
.*        V9.12.03  12/10/2009  Davin           CAR 205174                    *
.*                  If bkrxudd1 is blank, don't print day of week (field 681) *
.*        V9.12.02  15/09/2009  Mike Laming   CAR 201977                      *
.*                  Correct PTMXECRE to use PMSRELFD.PMRLDESC for Description *
.*        V9.12.01  14/07/2009  Peter Vela       CAR 197776                   *
.                   Recompiled for PATSHT6 - Added Referring GP Code and Desc *
.*        V9.11.08  29/04/2009  Saroeun Soeur   CAR 191476                    *
.*                  Added fields PTELMAMT and PTELMDES                        *
.*        V9.11.07  23/04/2009  Saroeun Soeur CAR 194935                      *
.*                  Added fields KM - PMVXREAD code and description           * 
.*        V9.11.06  15/04/2009  Davin           CAR 182901                    *
.*                  Added fields 858-861 (bkrxuff1-4)                         *
.*        V9.11.05  01/04/2009  Peter Vela      CAR 189217                    *
.*                  Added CAT KN - PMSVX1FD.PMVXUDIN code and description     *
.*                  variables                                                 *
.*        V9.11.04  20/03/2009  Davin           CAR 178015                    *
.*                  BPAY CRN now uses invoice number, so display as blank for *
.*                  ID sheets.                                                *
.*        V9.11.03  04/03/2009  Jill Habasque   CAR 134681                    *
.*                  Added IWI fields (851-853) and Language 2 and 3 (854-855) *
.*        V9.11.02  10/02/2009  Peter Vela      CAR 183976                    *
.*                  Added Eclipse OEC Eligibility Check variables             *
.*        V9.11.01  04/12/2008  Peter Vela      CAR 179104                    *
.*                  Fixed deceased PRFA indicator variable 89                 *
.*        V9.10.09  25/09/2008  Peter Vela      CAR 179076                    *
.*                  Added Attending Doctor (ADOCTA) PACNAME functionality     *
.*        V9.10.08  23/09/2008  Peter Vela      CAR 179104                    *
.*                  Added deceased PRFA indicator to variable                 *
.*        V9.10.07  16/09/2008  Peter Vela      CAR 170506                    *
.*                  Added 694 Cat KO pmvxurea code                            *
.*                        695 Cat KO pmvxurea description                     *
.*                        696 Attending Doctor fax number                     *
.*        V9.10.06  08/09/2008  Ebon Clements   CAR 175728                    *
.*                  Added vars 691 to 693 - Compensable vars and pmi address  *
.*        V9.10.05  04/09/2008  Ebon Clements   CAR 177643                    *
.*                  Added PMPXUSR7, PMPXUSR8 & PMPXUSR9                       *
.*        V9.10.04  19/08/2008  Ebon Clements   CAR 176281                    *
.*                  Added fee information - Physician Consultation Amount     *
.*        V9.10.03  20/05/2008  Ebon Clements   CAR 166566                    *
.*                  Added Yes/No <= 180 days old - 672                        *
.*        V9.10.02  19/05/2008  Ebon Clements   CAR 167936                    *
.*                  Added eligibility co payment hospital - 671               *
.*        V9.10.01  13/05/2008  Ebon Clements   CAR 166566                    *
.*                  Added current time and referring doctors vars             *
.*        V9.09.09  28/03/2008  Ebon Clements   CAR 164282                    *
.*                  Added variable 633-637 Treating Doctor                    *
.*        V9.09.08  28/02/2008  Peter Vela      CAR 162654                    *
.*                  Added Inform GP PMVXINGP.PMSVX1FD                         *
.*        V9.09.07  08/02/2008  Davin           CAR 153384                    *
.*                  Added fields 618-631 (pmsvx1af/oprdetaf/pmsworaf)         *
.*        V9.09.06  25/01/2008  Davin           CAR 153384                    *
.*                  Added fields 553-617 (fees information - pmsfidaf)        *
.*        V9.09.05  25/01/2008  Jill Habasque   CAR 100278                    *
.*                  Added check for IBCNMHOS at PR6ID620                      *
.*        V9.09.04  12/12/2007  Ebon Clements   CAR 157081                    *
.*                  Added patient e-mail address                              *
.*        V9.09.03  03/12/2007  Peter Vela      CAR 147233                    *
.*                  Added PATELGFD variables                                  *
.*        V9.09.02  15/08/2007  Mike Laming     CAR 131722                    *
.*                  Added Suburb field to Address line for field nos. 34, 38, *
.*                  183, 184 and 188                                          *
.*        V9.09.01  18/07/2007  Peter Vela      CAR 142913                    *
.*                  Added PMSCCD Concession Card variables                    *
.*                  Card Type (Code and Desc) Card Number and                 *
.*                  Card Expiry Date                                          *
.*        V9.08.07  08/06/2007  Mike Laming    CAR 125736                     *
.*                  Changes to PATDO1af Address lines - add DSADD4 variables  *
.*                  as Items 515 - 518                                        *
.*        V9.08.06  20/04/2007  Peter Vela      CAR 129314                    *
.*                  Added Ward Description (WBDESC from Ward record)          *
.*        V9.08.05  06/02/2007  Neelkamal Pyla   CAR 120594                   *
.*                  Added NOK Relation Desc and Title Desc                    *
.*        V9.08.04  13/12/2006  J.Tan            CAR 127625                   *
.*                  Mods to Singapore HRN                                     *
.*        V9.08.03  13/12/2006  Jill Habasque    CAR 127698                   *
.*                  Added NZ private approval number and claim number         *
.*        V9.08.02  15/11/2006  Steve Armstrong  CAR 124160                   *
.*                  Added Singapore HRN                                       *
.*        V9.08.01  23/10/2006  Peter Vela    CAR 120622                      *
.*                  Fixed HCP Communication Type                              *
.******************************************************************************
.*        V9.07.01  25/08/2006  Peter Vela    CAR 105060                      *
.*                  Added aboriginality code                                  *
.******************************************************************************
.*        V9.05.01  27/03/2006  Peter Vela    CAR 61299                       *
.*                  Increased field no size from DIM3 to DIM5                 *
.******************************************************************************
.*        V9.04.06  03/11/2005  Peter Vela    CAR 79842                       *
.*                  Added Next of Kin Mobile number                           *
.*                  Added Next of Kin Email Address                           *
.*                  Added Emergency Contact Mobile number                     *
.*                  Added Emergency Contact Email Address                     *
.*                  Added Nearest Relative Mobile Number                      *
.*                  Added Nearest Relative Email Address                      *
.*        V9.04.05  03/10/2005  Peter Vela    CAR 60396                       *
.*                  Added variables from PATWC1FD Workers Compensation        *
.*                  Claim Details and PMSWX1FD WC Extension Details           *
.*        V9.04.04  18/08/2005  Peter Vela         CAR 69456                  *
.*                  Added Local GP Firstname                                  *
.*                  Added Local GP Surname                                    *
.*                  Added Local GP Title and Full Name                        *
.*        V9.04.03  08/08/2005  Peter Vela         CAR 67204                  *
.*                  Added HCP Practice Provider Number                        *
.*                  Added HCP Practice Fax Number                             *
.*                  01/08/2005  Peter Vela         CAR 67204                  *
.*                  Added HCP Practice Address Details PMI Based              *
.*        V9.04.02  27/07/2005  Steve Armstrong    CAR 66545                  *
.*                  Added Local GP Preferred Contact Code (462) and           *
.*                  Description (463).                                        *
.*        V9.04.01  19/07/2005  Peter Vela    CAR 63023                       *
.*                  Added Local GP Email Address                              *
.******************************************************************************
.*        V9.03.03  11/06/2004  Mike Laming   CAR 49016  July 2004 PRS/2      *
.*                  - Add Sex Description routine SEXDSC00 with Code "R" -    *
.*                  "Intersex" added                                          *
.*        V9.03.02  27/05/2004  Peter Vela    CAR 48227                       *
.*                  Added BPAY Reference Number                               *
.*        V9.03.01  04/06/2003  Jill Habasque SRF 38102                       *
.*                  Added not stated for pmpxintr                             *
.*        V9.02.03  10/02/2002  Jill Habasque                                 *
.*                  Changed PMSPX2 fields to use GTCOD000                     *
.*        V9.02.02  02/02/2002  Tonii                                         *
.*                  Mods to use PMPXRHC1 for local GP, and values from        *
.*                  pmshcpaf for GP details                                   *
.*                  Fixed display of baptised field                           *
.*                  Added new fields 451 (Facility name), 452 (MBS item No),  *
.*                  453 (Theatre time start) & 454 (Theatre time end)         *
.*        V9.02.01  19/01/2002  Jill Habasque                                 *
.*                  Added provisional ICD                                     *
.*        V9.00.B05 19/12/2001  Ebon Clements                                 *
.*                  Added Head of Unit Doctor                                 *
.*        V9.00.B04 09/11/2001  Bronko Sosic                                  *
.*                  Added death and date of death                             *
.*        V9.00.B03 14/10/2001  Bronko Sosic                                  *
.*                  Added var from PMSPX2FD PMSVX1FD                          *
.*        V9.00.B02 13/09/2001  Bronko Sosic                                  *
.*                  Added SAVFIL8 to save the spool file name                 *
.*        V9.00.B01 15.07/2001  Sandra Barcham                                *
.*                  Replace GP with HCP                                       *
.*        V5.08.04  04/09/2000  Tonii                                         *
.*                  Mods to accept Unknown and Indeterminate as valid patient *
.*                  sex description                                           *
.*        V5.08.03  06/06/2000  Jill Habasque                                 *
.*                  Changed from key10 to key14 for the health fund file      *
.*        V5.08.02  08/05/2000  Steve Armstrong    srf 635265                 *
.*                  Removed reference to PATAXEFD variables                   *
.*        V5.08.B01 17/01/2000  Caleb Sharman  SRF 634574                     *
.*                  Mods to allow selection of 'Admission Weight' and         *
.*                  'Medicare Ref. Code' fields                               *
.******************************************************************************
.*        V5.07.03  21/01/1999  Nicole Harrington  507 rebound 122            *
.*                  Mods to unpack PBDATE correctly                           *
.*        V5.07.02  11/11/1998  Steve Armstrong                               *
.*                  Mods to use FIFTY9 instead of FIVE9                       *
.*        V5.07.01  08/10/1998  Glenn Berry      5.07 changes                 *
.******************************************************************************
.*        V5.06.01  11/06/1998  Glenn Berry     SRF 644634                    *
.*                  Print Expected Ward if Pre-admitted                       *
.******************************************************************************
.*        V5.05.02  09/04/1998  Davin  506                                    *
.*                  Added PTMIPANO & PTMIPADT                                 *
.*        V5.05.01  13/01/1998  Nick     SRF 643695                           *
.*                  Added PNKADD4,PKADD4,PADD4,PTMXECA4,PTMXNRA4              *
.******************************************************************************
.*        V5.04.05  26/05/1997  Steve Armstrong                               *
.*                  Items 141 to 176 not calling correct label.               *
.*        V5.04.04  24/05/1997  Howellsy                                      *
.*                  Added PTMXCHNM                                            *
.*        V5.04.03  08/04/1997  Howellsy                                      *
.*                  Added PTMXCELL,PTMXADD1-4,PTMXPOST,NHMAETH1-3,NHMARES     *
.*        V5.04.02  19/02/1997  Howellsy                                      *
.*                  Added AVISIT,PTMIADOC,PTMIREGS,PTMIUYN1,PTMIUYN2          *
.*        V5.04.01  09/07/1996    Paul Howells   SRF 641708                   *
.*                  Fixed Visit card expiry date                              *
.*        V5.03.01  26/10/1995    Justin Coates  (SUHT mods)                  *
.*                  added alerts                                              *
.*        V5.03.B0  01/06/1995  Paul Howells   quote 9379 & SRF 640081        *
.*                  Added NMPI number.                                        *
.******************************************************************************
.
.******************************************************************************
.*        Lineup Print                                                        *
.******************************************************************************
.
LINUPID6  CALL      OPNPRINT                 * open spool file
          MOVE      ONE,CURRROW              * Initialise current row counter
.
LN6ID000  COMPARE   CURRROW,IBDTROW          * Current row up to required row ?
          GOTO      LN6ID200 IF EQUAL        * Yes - print data
          PRINT     *N;                      * Else print 1 extra line
          ADD       ONE,CURRROW              * Increment counter
          GOTO      LN6ID000                 * Check counter again
.
. ------- Read through the details file -------
.
LN6ID100  CALL      RKIBDET1                 * Read next detail record
          BRANCH    OVRCD,LN6ID900           * No more records - pad out form
.
          MATCH     CPIDCOD,IBDTSCOD         * Same form ?
          GOTO      LN6ID900 IF NOT EQUAL    * No - pad out rest of form
.
LN6ID110  COMPARE   CURRROW,IBDTROW          * Are we at required row ?
          GOTO      LN6ID200 IF EQUAL        * Yes - print data
          PRINT     *N;                      * Else pad out form to req row
          ADD       ONE,CURRROW              * One more row printed
          GOTO      LN6ID110                 * Check row count
.
. ------- Print actual data lines -------
.
LN6ID200  BRANCH    IBDTINDC,LN6ID300:       * Text field
                             LN6ID400        * Data field
.
. ------- Print text field -------
.
LN6ID300  PRINT     *IBDTCOL,IBDTTXFL;       * Print data
          MOVE      IBDTROW,CURRROW          * Row printed is current row
          GOTO      LN6ID100                 * Read next record
.
. ------- Print data field -------
.
LN6ID400  MOVE      IBDTTXFL,DIM5            * Data number 1st 3 chars of field
          MOVE      DIM5,FORM5               * Move to a FORM field for BRANCH
.
          BRANCH    FORM5,LN6ID500,LN6ID450,LN6ID450,LN6ID450,LN6ID460:
                          LN6ID450,LN6ID470,LN6ID450,LN6ID450,LN6ID450:    10
                          LN6ID450,LN6ID450,LN6ID450,LN6ID480,LN6ID430:
                          LN6ID470,LN6ID450,LN6ID450,LN6ID450,LN6ID450:    20
                          LN6ID450,LN6ID450,LN6ID450,LN6ID480,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID490:    30
                          LN6ID490,LN6ID450,LN6ID450,LN6ID520,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID520,LN6ID450,LN6ID450:    40
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID470:
                          LN6ID460,LN6ID450,LN6ID450,LN6ID450,LN6ID530:    50
                          LN6ID450,LN6ID540,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:    60
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:    70
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID530,LN6ID450,LN6ID450,LN6ID450,LN6ID450:    80
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:    90
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   100
                          LN6ID530,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   110
                          LN6ID450,LN6ID450,LN6ID430,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   120
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   130
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   140
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   150
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   160
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID430,LN6ID450:   170
                          LN6ID430,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID470,LN6ID450,LN6ID450:   180
                          LN6ID450,LN6ID450,LN6ID520,LN6ID520,LN6ID450:
                          LN6ID470,LN6ID450,LN6ID520,LN6ID450,LN6ID470:   190
                          LN6ID470,LN6ID470,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID470,LN6ID450,LN6ID450,LN6ID450:   200
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID470,LN6ID450,LN6ID450,LN6ID450,LN6ID475:   210
                          LN6ID475,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   220
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   230
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   240
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   250
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   260
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   270
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   280
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   290
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   300
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   310
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   320
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   330
                          LN6ID450,LN6ID450,LN6ID450,LN6ID490,LN6ID450:      
                          LN6ID490,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   340
                          LN6ID450,LN6ID450,LN6ID450,LN6ID490,LN6ID450:      
                          LN6ID450,LN6ID450,LN6ID450,LN6ID490,LN6ID450:   350
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:      
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   360 
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:      
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   370 
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:      
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   380 
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450,LN6ID450:   390
                          LN6ID450,LN6ID450,LN6ID500,LN6ID500,LN6ID450:
                          LN6ID450,LN6ID450,LN6ID450,LN6ID450
      
.
LN6ID430  MOVE      "999",VARIABLE           * Age
          GOTO      LN6ID600
.
LN6ID450  PACK      VARIABLE,X10,X10,X10,X10,X10,X10,X10,X10,X10,X10,X10,X10,X10,X10,X10
          GOTO      LN6ID600
.
LN6ID460  MOVE      "99:99:99",VARIABLE      * Time variables
          GOTO      LN6ID600
.
LN6ID470  MOVE      "99/99/99",VARIABLE      * Date variables
          GOTO      LN6ID600
.
LN6ID475  MOVE      "99/99/9999",VARIABLE    * Date with century variables
          GOTO      LN6ID600
.
LN6ID480  MOVE      "9",VARIABLE             * Indicators
          GOTO      LN6ID600
.
LN6ID490  PACK      VARIABLE,ANSX,DOT,X10,X10      * Doctor's name
          GOTO      LN6ID600
.
LN6ID500  MOVE      "99999999",VARIABLE      * Admission number
          GOTO      LN6ID600
.
LN6ID520  CLEAR     VARIABLE                 * Address
          APPEND    X10,VARIABLE
          APPEND    X10,VARIABLE
          APPEND    X5,VARIABLE
          APPEND    COMMA,VARIABLE
          APPEND    X10,VARIABLE
          APPEND    X10,VARIABLE
          APPEND    X5,VARIABLE
          APPEND    COMMA,VARIABLE
          APPEND    " 9999",VARIABLE
          RESET     VARIABLE
          GOTO      LN6ID600
.
LN6ID530  MOVE      "99",VARIABLE            * Year
          GOTO      LN6ID600
.
LN6ID540  MOVE      "999999.99",VARIABLE     * Daily rate
          GOTO      LN6ID600
.
. ------- Actual data print routine -------
.
LN6ID600  RESET     VARIABLE,IBDTPLEN        * Reset pointer to required length
          LENSET    VARIABLE                 * Push logical length there
          RESET     VARIABLE                 * Reset form pointer to start
          PRINT     *IBDTCOL,*+,VARIABLE;    * Only print data between FP & LL
          MOVE      IBDTROW,CURRROW          * Move row number to one printed
          GOTO      LN6ID100                 * Read next record
.
. ------- Finished all data for this form - pad out rest of form -------
.
LN6ID900  COMPARE   CURRROW,IBTHLENG         * End of form ?
          GOTO      LN6ID999 IF EQUAL        * Yes - exit
          PRINT     *N;                      * Otherwise pad out 1 more line
          ADD       ONE,CURRROW              * 1 more line printed
          GOTO      LN6ID900                 * Test again
.
LN6ID999  MOVE      FALSE,EXIT               * Set exit flag
          PACK      SAVFIL8,SPLFILE,SP70
          CALL      CLSPRINT                 * close the spool file
          RETURN                             * Finished
.
.------ pack the address ------
.
PAC6ADDR  PACK      ADDRLN WITH SP30,SP30
          MOVE      PKADD1,ADDRLN
          CALL      FENDSHT6                    * skip blanks
.
          MATCH     SP35,PKADD2
          IF        !@EQUAL
            APPEND    COMMA,ADDRLN
            APPEND    PKADD2,ADDRLN
            CALL      FENDSHT6                  * skip blanks
          ENDIF
.
.                                                                     *I-131722
          MATCH     SP35,PKSUBR
          IF        !@EQUAL
            APPEND    COMMA,ADDRLN
            APPEND    PKSUBR,ADDRLN
            CALL      FENDSHT6                  * skip blanks
          ENDIF
.
          MATCH     SP35,PKADD4
          IF        !@EQUAL
            APPEND    COMMA,ADDRLN
            APPEND    PKADD4,ADDRLN
            CALL      FENDSHT6                  * skip blanks
          ENDIF
.
          APPEND    SP1,ADDRLN
          APPEND    PKPOST,ADDRLN
          RESET     ADDRLN
          RETURN
.
.------ set at end of field ------
.
FENDSHT6  RESET     ADDRLN,57
.
.------ skip over blanks ------
.
FSHT6LP1  CMATCH    SP1,ADDRLN
          RETURN    IF NOT EQUAL
          BUMP      ADDRLN,-1
          GOTO      FSHT6LP1 IF NOT EOS
.
          RESET     ADDRLN
          RETURN
.
.------ get the day rate ------
.
GETDRTE   MOVE      ZERO,FORM62
          MOVE      ZERO,FORM62A
          MOVE      ZERO,STEXTRA
          MOVE      ZERO,HFPORT
          MOVE      ZERO,MAXDISC
.
.------ open the pattranf file and position on the file ------
.
          OPEN      PATTRAN2,"pattranf"
          PACK      KEY30 WITH AADMNO,SP30
          CALL      RDSTRAN2
.
.------ get the last record for this patient ------
.
NXTRN6    CALL      RDKTRAN2
          BRANCH    OVRCD OF CALNET6
.
          MATCH     AADMNO,TADMN               * compare admission numbers
          GOTO      CALNET6 IF NOT EQUAL
.
          MOVE      TRATEF,FORM62
          MOVE      TRATEH,HFPORT
          MOVE      TDISC,MAXDISC
          MOVE      TALLW,FORM62A
          MOVE      TEXTRA,STEXTRA
          GOTO      NXTRN6
.
.------ close the pattranf file and calculate the day rate ------
.
CALNET6   CLOSE     PATTRAN2
          MOVE      FORM62,NETTOT
          ADD       HFPORT,NETTOT
          ADD       STEXTRA,NETTOT
          SUB       MAXDISC,NETTOT
          SUB       FORM62A,NETTOT
          RETURN
.
.------ Get claim details if any -------
.
GETCLM6   PACK      CLMDET1 WITH SP30,SP30
          PACK      CLMDET2 WITH SP30,SP30
.
          UNPACK    SP5 WITH TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
          MOVE      "CL" TO TCODE
          PACK      KEY5 WITH TCODE,ACLAIM
          CALL      RDCODE1                      * read the patient codes file
.
          MOVE      ZERO,FORM2
.
.------ see what type of claim we have if any exists ------
.
GETCLLP6  ADD       ONE,FORM2
          COMPARE   SIX,FORM2
          GOTO      ENDCLM6 IF NOT LESS
.
          LOAD      ANS USING FORM2 OF TCINDC1,TCINDC2,TCINDC3:
                    TCINDC4,TCINDC5
.
          CMATCH    "W" TO ANS                * test for workers comp.
          GOTO      WCO6 IF EQUAL
.
          CMATCH    "M" TO ANS                * test for motor accident board
          GOTO      MAB6 IF EQUAL
.
          CMATCH    "V" TO ANS                * test for veterans affairs
          GOTO      VET6 IF EQUAL
.
          GOTO      GETCLLP6
.
.------ claim is a workers comp. claim ------
.
WCO6      MOVE      AADMNO,KEY8
          OPEN      PATWC1A1,"patwc1af"
          CALL      RDWCOM1                   * read the workers comp. file
          BRANCH    OVRCD OF ENDCLM6
.
          MOVE      SP30,INAME
          MOVE      WCICODE,KEY6
          OPEN      PATIN1A1,"patin1af"
          CALL      RDINSR1                   * read the insurance file
.
.------ set up claim details ------

          CLEAR     CLMDET1
          APPEND    "W/COMP CLAIM: EMPLOYER: ",CLMDET1
          APPEND    WCENAME,CLMDET1
          APPEND    SP30,CLMDET1
          RESET     CLMDET1
.
          CLEAR     CLMDET2
          APPEND    "INS CO: ",CLMDET2
          APPEND    INAME,CLMDET2
          RESET     CLMDET2,27
          APPEND    " CLM NO: ",CLMDET2
          APPEND    WCCLMNO,CLMDET2
          APPEND    SP30,CLMDET2
          RESET     CLMDET2
          GOTO      ENDCLM6
.
.------ claim is a motor accidents board claim ------
.
MAB6      MOVE      AADMNO,KEY8
          OPEN      PATWMAB1,"patwmabf"
          CALL      RDWMAB1              * read the motor accidents board file
          CLOSE     PATWMAB1
          BRANCH    OVRCD OF ENDCLM6
.
.------ set up claim details ------
.
          CLEAR     CLMDET1
          APPEND    "M.A.B. CLAIM NO.: ",CLMDET1
          APPEND    MREFNO,CLMDET1
          APPEND    SP30,CLMDET1
          RESET     CLMDET1
.
          PACK      CLMDET2 WITH SP30,SP20
          GOTO      ENDCLM6
.
.------ claim is a veterans affairs claim ------
.
VET6      MOVE      AADMNO,KEY8
          OPEN      PATWVET1,"patwvetf"
          CALL      RDWVET1                    * read the veteran affairs file
          CLOSE     PATWVET1
          BRANCH    OVRCD OF ENDCLM6
.
.------ set up claim details ------
.
          CLEAR     CLMDET1
          APPEND    "VETERAN AFFAIRS NO.: ",CLMDET1
          APPEND    VCLMNO,CLMDET1
          APPEND    SP30,CLMDET1
          RESET     CLMDET1
          PACK      CLMDET2 WITH SP30,SP20
.
ENDCLM6   RETURN
.
.------- Get a codes file record -------
.
GTCOD000  MOVE      SP20,TDESC               * Initialise description
          UNPACK    SP20,THCSCOD,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
          MOVE      ZERO,TCFORM6
.
.         Is the code blank ?
.
          MATCH     SP3,ACODE
          GOTO      GTCOD999 IF EQUAL
.
.         Get the code file record
.
          PACK      KEY5,TCODE,ACODE
          CALL      RDCODE1
.
GTCOD999  RETURN
.
.*******************************************************************************
.*        Actual Print Routine for MR10                                        *
.*******************************************************************************
.
PRTSHT6   CALL      OPNPRINT                 * open spool file
          MOVE      ONE,CURRROW              * Initialise current row counter
.
PR6ID000  COMPARE   CURRROW,IBDTROW          * Current row up to required row ?
          GOTO      PR6ID200 IF EQUAL        * Yes - print data
          PRINT     *N;                      * Else print 1 extra line
          ADD       ONE,CURRROW              * Increment counter
          GOTO      PR6ID000                 * Check counter again
.
. ------- Read through the details file -------
.
PR6ID100  CALL      RKIBDET1                 * Read next detail record
          BRANCH    OVRCD,PR6I8000           * No more records - pad out form
.
          MATCH     CPIDCOD,IBDTSCOD         * Same form ?
          GOTO      PR6I8000 IF NOT EQUAL    * No - pad out rest of form
.
PR6ID110  COMPARE   CURRROW,IBDTROW          * Are we at the required row ?
          GOTO      PR6ID200 IF EQUAL        * Yes - print data
          PRINT     *N;                      * Else pad out to required row
          ADD       ONE,CURRROW              * One more row printed
          GOTO      PR6ID110                 * Check row count
.
. ------- Print actual data lines -------
.
PR6ID200  BRANCH    IBDTINDC,PR6ID300:       * Text field
                             PR6ID400        * Data field
.
. ------- Print text field -------
.
PR6ID300  RESET     IBDTTXFL,IBDTPLEN
          LENSET    IBDTTXFL
          RESET     IBDTTXFL
          PRINT     *IBDTCOL,*+,IBDTTXFL;    * Print data
          MOVE      IBDTROW,CURRROW          * Row printed is current row
          GOTO      PR6ID100                 * Read next record
.
. ------- Print data field -------
.
PR6ID400  MOVE      ZERO,MULTILIN
          MOVE      IBDTTXFL,DIM5            * Data number 1st 3 chars of field
          MOVE      DIM5,FORM5               * Move to a FORM field for BRANCH
.
          PACK      VARIABLE,SP30,SP30,SP30,SP30,SP10  * Initialise variable
          BRANCH    FORM5,PR6ID404,PR6ID408,PR6ID412,PR6ID416,PR6ID420:
                          PR6ID424,PR6ID428,PR6ID432,PR6ID436,PR6ID440:    10
                          PR6ID444,PR6ID448,PR6ID452,PR6ID456,PR6ID460:
                          PR6ID464,PR6ID468,PR6ID472,PR6ID476,PR6ID480:    20
                          PR6ID484,PR6ID488,PR6ID492,PR6ID496,PR6ID500:
                          PR6ID504,PR6ID508,PR6ID512,PR6ID516,PR6ID520:    30
                          PR6ID524,PR6ID528,PR6ID532,PR6ID536,PR6ID540:
                          PR6ID544,PR6ID548,PR6ID552,PR6ID556,PR6ID560:    40
                          PR6ID564,PR6ID568,PR6ID572,PR6ID576,PR6ID580:
                          PR6ID584,PR6ID588,PR6ID592,PR6ID596,PR6ID600:    50
                          PR6ID604,PR6ID608,PR6ID612,PR6ID616,PR6ID620:
                          PR6ID624,PR6ID628,PR6ID632,PR6ID636,PR6ID640:    60
                          PR6ID644,PR6ID648,PR6ID652,PR6ID656,PR6ID660:
                          PR6ID664,PR6ID668,PR6ID672,PR6ID676,PR6ID680:    70
                          PR6ID684,PR6ID688,PR6ID692,PR6ID696,PR6ID700:
                          PR6ID704,PR6ID708,PR6ID712,PR6ID716,PR6ID720:    80
                          PR6ID724,PR6ID728,PR6ID732,PR6ID736,PR6I1356:
                          PR6ID744,PR6ID748,PR6ID752,PR6ID756,PR6ID760:    90
                          PR6ID764,PR6ID768,PR6ID772,PR6ID776,PR6ID780:
                          PR6ID784,PR6ID788,PR6ID792,PR6ID796,PR6ID800:   100
                          PR6ID804,PR6ID808,PR6ID812,PR6ID816,PR6ID820:
                          PR6ID824,PR6ID828,PR6ID832,PR6ID836,PR6ID840:   110
                          PR6ID844,PR6ID848,PR6ID852,PR6ID856,PR6ID860:
                          PR6ID864,PR6ID868,PR6ID872,PR6ID876,PR6ID880:   120
                          PR6ID884,PR6ID888,PR6ID892,PR6ID896,PR6ID900:
                          PR6ID904,PR6ID908,PR6ID912,PR6ID916,PR6ID920:   130
                          PR6ID924,PR6ID928,PR6ID932,PR6ID936,PR6ID940:
                          PR6ID944,PR6ID948,PR6ID952,PR6ID956,PR6ID960:   140
                          PR6ID964,PR6ID968,PR6ID972,PR6ID976,PR6ID980:
                          PR6ID984,PR6ID988,PR6ID992,PR6ID996,PR6I1000:   150
                          PR6I1004,PR6I1008,PR6I1012,PR6I1016,PR6I1020:
                          PR6I1024,PR6I1028,PR6I1032,PR6I1036,PR6I1040:   160
                          PR6I1044,PR6I1048,PR6I1052,PR6I1056,PR6I1060:
                          PR6I1064,PR6I1068,PR6I1072,PR6I1076,PR6I1080:   170
                          PR6I1084,PR6I1088,PR6I1092,PR6I1096,PR6I1100:
                          PR6I1104,PR6I1108,PR6I1112,PR6I1116,PR6I1120:   180
                          PR6I1124,PR6I1128,PR6I1132,PR6I1136,PR6I1140:
                          PR6I1144,PR6I1148,PR6I1152,PR6I1156,PR6I1160:   190
                          PR6I1164,PR6I1168,PR6I1172,PR6I1176,PR6I1180:
                          PR6I1184,PR6I1188,PR6I1192,PR6I1196,PR6I1200:   200
                          PR6I1204,PR6I1208,PR6I1212,PR6I1216,PR6I1220:
                          PR6I1224,PR6I1228,PR6I1232,PR6I1236,PR6I1240:   210
                          PR6I1244,PR6I1248,PR6I1252,PR6I1256,PR6I1260:
                          PR6I1264,PR6I1268,PR6I1272,PR6I1276,PR6I1280:   220
                          PR6I1284,PR6I1288,PR6I1292,PR6I1296,PR6I1300:
                          PR6I1304,PR6I1308,PR6I1312,PR6I1316,PR6I1320:   230
                          PR6I1324,PR6I1328,PR6I1332,PR6I1336,PR6I1340:
                          PR6I1344,PR6I1348,PR6I1352,PR6I1356,PR6I1360:   240
                          PR6I1364,PR6I1368,PR6I1372,PR6I1376,PR6I1380:
                          PR6I1384,PR6I1388,PR6I1392,PR6I1396,PR6I1400:   250
                          PR6I1404,PR6I1408,PR6I1412,PR6I1416,PR6I1420:
                          PR6I1424,PR6I1428,PR6I1432,PR6I1436,PR6I1440:   260
                          PR6I1444,PR6I1448,PR6I2329,PR6I2329,PR6I2329:
                          PR6I2329,PR6I2329,PR6I2329,PR6I2266,PR6I2270:   270
                          PR6I2270,PR6I2270,PR6I2270,PR6I2270,PR6I2270:
                          PR6I2271,PR6I2284,PR6I2285,PR6I2274,PR6I2272:   280
                          PR6I2273,PR6I2273,PR6I2273,PR6I2273,PR6I2275:
                          PR6I2276,PR6I2277,PR6I2278,PR6I2279,PR6I2280:   290
                          PR6I2280,PR6I2280,PR6I2280,PR6I2281,PR6I2282:
                          PR6I2282,PR6I2282,PR6I2282,PR6I2283,PR6I2288:   300
                          PR6I2292,PR6I2295,PR6I2295,PR6I2295,PR6I2295:
                          PR6I2295,PR6I2295,PR6I2295,PR6I2295,PR6I2295:   310
                          PR6I2295,PR6I2295,PR6I2295,PR6I2295,PR6I2295:
                          PR6I2295,PR6I2295,PR6I2295,PR6I2295,PR6I2295:   320
                          PR6I2295,PR6I2295,PR6I2295,PR6I2295,PR6I2295:
                          PR6I2295,PR6I2295,PR6I2295,PR6I2295,PR6I2295:   330
                          PR6I2295,PR6I2296,PR6I2297,PR6I2298,PR6I2299:      
                          PR6I2300,PR6I2301,PR6I2302,PR6I2303,PR6I2304:   340
                          PR6I2305,PR6I2306,PR6I2307,PR6I2308,PR6I2309:      
                          PR6I2310,PR6I2311,PR6I2312,PR6I2313,PR6I2314:   350
                          PR6I2315,PR6I2316,PR6I2317,PR6I2318,PR6I2319:      
                          PR6I2320,PR6I2321,PR6I2322,PR6I2323,PR6I2324:   360 
                          PR6I2325,PR6I2326,PR6I2327,PR6I2328,PR6I2330:
                          PR6I2330,PR6I2330,PR6I2330,PR6I2330,PR6I2330:   370 
                          PR6I2330,PR6I2336,PR6I2337,PR6I2338,PR6I2339:
                          PR6I2340,PR6I2341,PR6I2342,PR6I2343,PR6I2344:   380 
                          PR6I2345,PR6I2346,PR6I2347,PR6I2348,PR6I2349:
                          PR6I2350,PR6I2351,PR6I2352,PR6I2353,PR6I2354:   390 
                          PR6I2355,PR6I2356,PR6I2357,PR6I2358,PR6I2359:  
                          PR6I2360,PR6I2361,PR6I2362,PR6I2363,PR6I2364:   400   
                          PR6I2365,PR6I2366,PR6I2367,PR6I2368,PR6I2369:      
                          PR6I2370,PR6I2371,PR6I2372,PR6I2373,PR6I2374:   410
                          PR6I2375,PR6I2376,PR6I2377,PR6I2378,PR6I2379:  
                          PR6I2380,PR6I2381,PR6I2382,PR6I2383,PR6I2384:   420  
                          PR6I2385,PR6I2386,PR6I2387,PR6I2388,PR6I2389:     
                          PR6I2390,PR6I2391,PR6I2392,PR6I2393,PR6I2394:   430
                          PR6I2395,PR6I2396,PR6I2397,PR6I2398,PR6I2399:
                          PR6I2400,PR6I2401,PR6I2402,PR6I2403,PR6I2404:   440
                          PR6I2405,PR6I2406,PR6I2407,PR6I2408,PR6I2409:
                          PR6I2410,PR6I2411,PR6I2412,PR6I2413,PR6I2414:   450
                          PR6I2415,PR6I2416,PR6I2417,PR6I2418,PR6I2419:
                          PR6I2420,PR6I2421,PR6I2422,PR6I2423,PR6I2424:   460
                          PR6I2425,PR6I2426,PR6I2427,PR6I2263,PR6I2263:
                          PR6I2263,PR6I2263,PR6I2263,PR6I2263,PR6I2263:   470
                          PR6I2263,PR6I2428,PR6I2429,PR6I2430,PR6I2431:
                          PR6I2431,PR6I2431,PR6I2431,PR6I2431,PR6I2431:   480
                          PR6I2431,PR6I2431,PR6I2431,PR6I2431,PR6I2431:
                          PR6I2431,PR6I2431,PR6I2431,PR6I2431,PR6I2431:   490
                          PR6I2431,PR6I2431,PR6I2431,PR6I2431,PR6I2431:
                          PR6I2431,PR6I2431,PR6I2431,PR6I2431,PR6I2431:   500
                          PR6I2431,PR6I2432,PR6I2433,PR6I2434,PR6I2435:
                          PR6I2436,PR6I2437,PR6I2438,PR6I2439,PR6I2440:   510
                          PR6I2441,PR6I2442,PR6I2443,PR6I2444,PR6I2515:
                          PR6I2516,PR6I2517,PR6I2518,PR6I2519,PR6I2520:   520
                          PR6I2521,PR6I2522,PR6I2523,PR6I2524,PR6I2525:
                          PR6I2526,PR6I2527,PR6I2528,PR6I2529,PR6I2530:   530
                          PR6I2531,PR6I2532,PR6I2533,PR6I2534,PR6I2535:
                          PR6I2536,PR6I2537,PR6I2538,PR6I2539,PR6I2540:   540
                          PR6I2541,PR6I2542,PR6I2543,PR6I2544,PR6I2545:
                          PR6I2546,PR6I2547,PR6I2548,PR6I2549,PR6I2550:   550
                          PR6I2551,PR6I2552,PR6I2553,PR6I2554,PR6I2555:
                          PR6I2556,PR6I2557,PR6I2558,PR6I2559,PR6I2560:   560
                          PR6I2561,PR6I2562,PR6I2563,PR6I2564,PR6I2565:
                          PR6I2566,PR6I2567,PR6I2568,PR6I2569,PR6I2570:   570
                          PR6I2571,PR6I2572,PR6I2573,PR6I2574,PR6I2575:
                          PR6I2576,PR6I2577,PR6I2578,PR6I2579,PR6I2580:   580
                          PR6I2581,PR6I2582,PR6I2583,PR6I2584,PR6I2585:
                          PR6I2586,PR6I2587,PR6I2588,PR6I2589,PR6I2590:   590
                          PR6I2591,PR6I2592,PR6I2593,PR6I2594,PR6I2595:
                          PR6I2596,PR6I2597,PR6I2598,PR6I2599,PR6I2600:   600
                          PR6I2601,PR6I2602,PR6I2603,PR6I2604,PR6I2605:
                          PR6I2606,PR6I2607,PR6I2608,PR6I2609,PR6I2610:   610
                          PR6I2611,PR6I2612,PR6I2613,PR6I2614,PR6I2615:
                          PR6I2616,PR6I2617,PR6I2618,PR6I2619,PR6I2620:   620
                          PR6I2621,PR6I2622,PR6I2623,PR6I2624,PR6I2625:
                          PR6I2626,PR6I2627,PR6I2628,PR6I2629,PR6I2630:   630
                          PR6I2631,PR6I2632,PR6I2633,PR6I2634,PR6I2635:
                          PR6I2636,PR6I2637,PR6I2638,PR6I2639,PR6I2640:   640
                          PR6I2641,PR6I2642,PR6I2643,PR6I2644,PR6I2645:
                          PR6I2646,PR6I2647,PR6I2648,PR6I2649,PR6I2650:   650
                          PR6I2651,PR6I2652,PR6I2653,PR6I2654,PR6I2655:       
                          PR6I2656,PR6I2657,PR6I2658,PR6I2659,PR6I2660:   660
                          PR6I2661,PR6I2662,PR6I2663,PR6I2664,PR6I2665:
                          PR6I2666,PR6I2667,PR6I2668,PR6I2669,PR6I2670:   670
                          PR6I2671,PR6I2672,PR6I2673,PR6I2674,PR6I2675:   
                          PR6I2676,PR6I2677,PR6I2678,PR6I2679,PR6I2680:   680
                          PR6I2681,PR6I2682,PR6I2683,PR6I2684,PR6I2685:
                          PR6I2686,PR6I2687,PR6I2688,PR6I2689,PR6I2690:   690
                          PR6I2691,PR6I2692,PR6I2693,PR6I2694,PR6I2695:
                          PR6I2696,PR6I2697,PR6I2698,PR6I2699,PR6I2700:   700
                          PR6I2701,PR6I2702,PR6I2703,PR6I2704,PR6I2705:
                          PR6I2706,PR6I2707,PR6I2708,PR6I2709,PR6I2710:   710
                          PR6I2711,PR6I2712,PR6I2713,PR6I2714,PR6I2715:
                          PR6I2716,PR6I2717,PR6I2718,PR6I2719,PR6I2720:   720
                          PR6I2721,PR6I2722,PR6I2723,PR6I2724,PR6I2725:
                          PR6I2726,PR6I2727,PR6I2728,PR6I2729,PR6I2730:   730
                          PR6I2731,PR6I2732,PR6I2733,PR6I2734,PR6I2735:
                          PR6I2736,PR6I2737,PR6I2738,PR6I2739,PR6I2740:   740
                          PR6I2741,PR6I2742,PR6I2743,PR6I2744,PR6I2745:
                          PR6I2746,PR6I2747,PR6I2748,PR6I2749,PR6I2750:   750
                          PR6I2751,PR6I2752,PR6I2753,PR6I2754,PR6I2755:
                          PR6I2756,PR6I2757,PR6I2758,PR6I2759,PR6I2760:   760
                          PR6I2761,PR6I2762,PR6I2763,PR6I2764,PR6I2765:
                          PR6I2766,PR6I2767,PR6I2768,PR6I2769,PR6I2770:   770
                          PR6I2771,PR6I2772,PR6I2773,PR6I2774,PR6I2775:
                          PR6I2776,PR6I2777,PR6I2778,PR6I2779,PR6I2780:   780
                          PR6I2781,PR6I2782,PR6I2783,PR6I2784,PR6I2785:
                          PR6I2786,PR6I2787,PR6I2788,PR6I2789,PR6I2790:   790
                          PR6I2791,PR6I2792,PR6I2793,PR6I2794,PR6I2795:
                          PR6I2796,PR6I2797,PR6I2798,PR6I2799,PR6I2800:   800
                          PR6I2801,PR6I2802,PR6I2803,PR6I2804,PR6I2805:
                          PR6I2806,PR6I2807,PR6I2808,PR6I2809,PR6I2810:   810
                          PR6I2811,PR6I2812,PR6I2813,PR6I2814,PR6I2815:
                          PR6I2816,PR6I2817,PR6I2818,PR6I2819,PR6I2820:   820
                          PR6I2821,PR6I2822,PR6I2823,PR6I2824,PR6I2825:
                          PR6I2826,PR6I2827,PR6I2828,PR6I2829,PR6I2830:   830
                          PR6I2831,PR6I2832,PR6I2833,PR6I2834,PR6I2835:
                          PR6I2836,PR6I2837,PR6I2838,PR6I2839,PR6I2840:   840
                          PR6I2841,PR6I2842,PR6I2843,PR6I2844,PR6I2845:
                          PR6I2846,PR6I2847,PR6I2848,PR6I2849,PR6I2850:   850
                          PR6I2851,PR6I2852,PR6I2853,PR6I2854,PR6I2855:
                          PR6I2856,PR6I2857,PR6I2858,PR6I2859,PR6I2860:   860
                          PR6I2861,PR6I2862,PR6I2863,PR6I2864,PR6I2865:
                          PR6I9999,PR6I9999,PR6I2868,PR6I2869,PR6I2870:   870
                          PR6I2871,PR6I2872,PR6I2873,PR6I2874,PR6I2875:
                          PR6I2876,PR6I2877,PR6I2878,PR6I2879,PR6I2880:   880
                          PR6I2881,PR6I2882,PR6I2883,PR6I2884,PR6I2885:
                          PR6I2886,PR6I2887,PR6I2888,PR6I2889,PR6I2890:   890
                          PR6I2891,PR6I2892,PR6I2893,PR6I2894,PR6I2895:
                          PR6I2896,PR6I2897,PR6I2898,PR6I2899,PR6I2900:   900
                          PR6I2901,PR6I2902,PR6I2903,PR6I2904,PR6I2905:
                          PR6I2906,PR6I2907,PR6I2908,PR6I2909,PR6I2910:   910
                          PR6I2911,PR6I2912,PR6I2913,PR6I2914,PR6I2915:
                          PR6I2916,PR6I2917,PR6I2918,PR6I2919,PR6I2920:   920
                          PR6I2921,PR6I2922,PR6I2923,PR6I2924,PR6I2925:
                          PR6I2926,PR6I2927,PR6I2928,PR6I2929,PR6I2930:   930
                          PR6I2931,PR6I2932,PR6I2933,PR6I2934,PR6I2935:
                          PR6I2936,PR6I2937,PR6I2938,PR6I2939,PR6I2940:   940
                          PR6I2941,PR6I2942,PR6I2943,PR6I2944,PR6I2945:
                          PR6I2946,PR6I2947,PR6I2948,PR6I2949,PR6I2950:   950
                          PR6I2951,PR6I2952,PR6I2953,PR6I2954,PR6I2955:
                          PR6I2956,PR6I2957,PR6I2958,PR6I2959,PR6I2960:   960
                          PR6I2961,PR6I2962,PR6I2963,PR6I2964,PR6I2965:
                          PR6I2966,PR6I2967,PR6I2968,PR6I2969,PR6I2970:   970
                          PR6I2971,PR6I2972,PR6I2973,PR6I2974,PR6I2975:
                          PR6I2976,PR6I2977,PR6I2978,PR6I2979,PR6I2980:   980
                          PR6I2981,PR6I2982,PR6I2983,PR6I2984,PR6I2985:
                          PR6I2986,PR6I2987,PR6I2988,PR6I2989,PR6I2990:   990
                          PR6I2991,PR6I2992,PR6I2993,PR6I2994,PR6I2995:
                          PR6I2996,PR6I2997,PR6I2998,PR6I2999,PR6I3000:  1000
                          PR6I3001,PR6I3002,PR6I3003,PR6I3004,PR6I3005:
                          PR6I3006,PR6I3007,PR6I3008,PR6I3009,PR6I3010:  1010
                          PR6I3011,PR6I3012,PR6I3013,PR6I3014,PR6I3015:
                          PR6I3016,PR6I3017,PR6I3018,PR6I3019,PR6I3020:  1020
                          PR6I3021,PR6I3022,PR6I3023,PR6I3024,PR6I3025:
                          PR6I3026,PR6I3027,PR6I3028,PR6I3029,PR6I3030:  1030
                          PR6I3031,PR6I3032,PR6I3033,PR6I3034,PR6I3035:
                          PR6I3036,PR6I3037,PR6I3038,PR6I3039,PR6I3040:  1040
                          PR6I3041,PR6I3042,PR6I3043,PR6I3044,PR6I3045:
                          PR6I3046,PR6I3047,PR6I3048,PR6I3049,PR6I3050:  1050
                          PR6I3051,PR6I3052,PR6I3053,PR6I3054,PR6I3055:
                          PR6I3056,PR6I3057,PR6I3058,PR6I3059,PR6I3060:  1060
                          PR6I3061,PR6I3062,PR6I3063,PR6I3064,PR6I3065:
                          PR6I3066,PR6I3067,PR6I3068,PR6I3069,PR6I3070:  1070
                          PR6I3071,PR6I3072,PR6I3073,PR6I3074,PR6I3075:
                          PR6I3076,PR6I3077,PR6I3078,PR6I3079,PR6I3080:  1080
                          PR6I3081,PR6I3082,PR6I3083,PR6I3084,PR6I3085:
                          PR6I3086,PR6I3087,PR6I3088,PR6I3089,PR6I3090:  1090
                          PR6I3091,PR6I3092,PR6I3093,PR6I3094,PR6I3095:
                          PR6I3096,PR6I3097,PR6I3098,PR6I3099,PR6I3100:  1100
                          PR6I3101,PR6I3102,PR6I3103,PR6I3104,PR6I3105:
                          PR6I3106,PR6I3107,PR6I3108,PR6I3109,PR6I3110:  1110
                          PR6I3111,PR6I3112,PR6I3113,PR6I3114,PR6I3115:
                          PR6I3116,PR6I3117,PR6I3118,PR6I3119,PR6I3120:  1120
                          PR6I3121,PR6I3122,PR6I3123,PR6I3124,PR6I3125:
                          PR6I3126,PR6I3127,PR6I3128,PR6I3129,PR6I3130:  1130
                          PR6I3131,PR6I3132,PR6I3133,PR6I3134,PR6I3135:
                          PR6I3136,PR6I3137,PR6I3138,PR6I3139,PR6I3140:  1140
                          PR6I3141,PR6I3142,PR6I3143,PR6I3144,PR6I3145:
                          PR6I3146,PR6I3147,PR6I3148,PR6I3149,PR6I3150:  1150
                          PR6I3151,PR6I3152,PR6I3153,PR6I3154,PR6I3155:
                          PR6I3156,PR6I3157,PR6I3158,PR6I3159,PR6I3160:  1160
                          PR6I3161,PR6I3162,PR6I3163,PR6I3164,PR6I3165:
                          PR6I3166,PR6I3167,PR6I3168,PR6I3168,PR6I3168:  1170
                          PR6I3168,PR6I3168,PR6I3168,PR6I3168,PR6I3168:
                          PR6I3168,PR6I3168,PR6I3168,PR6I3168,PR6I3168:  1180
                          PR6I3168,PR6I3168,PR6I3168,PR6I3168,PR6I3168:
                          PR6I3168,PR6I3168,PR6I3168,PR6I3168,PR6I3168:  1190
                          PR6I3168,PR6I3168,PR6I3168,PR6I3168,PR6I3168:
                          PR6I3168,PR6I3168,PR6I3198,PR6I3199,PR6I3200:  1200
                          PR6I3201,PR6I3202,PR6I3203,PR6I3204,PR6I3205:
                          PR6I3206,PR6I3207,PR6I3208,PR6I3209,PR6I3210:  1210
                          PR6I3211,PR6I3212,PR6I3213,PR6I3214,PR6I3215:
                          PR6I3216,PR6I3217,PR6I3218,PR6I3219,PR6I3220:  1220
                          PR6I3221,PR6I3222,PRT12230,PRT12240,PRT12250:
                          PRT12260,PRT12270,PRT12280,PRT12290,PRT12300:  1230
                          PRT12310,PRT12320,PRT12330,PRT12340,PRT12350:
                          PRT12360,PRT12370,PRT12380,PRT12390,PRT12400:  1240
                          PRT12410,PRT12420,PRT12430,PRT12440,PRT12450:
                          PRT12460,PRT12470,PRT12480,PRT12490,PRT12500:  1250
                          PRT12510,PRT12520,PRT12530,PRT12540,PRT12550:
                          PRT12560
.
          GOTO      PR6ID100

PR6ID404  MOVE      AADMNO,VARIABLE          * Admission number
          MOVE      EIGHT,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
PR6ID408  MOVE      AURNO,VARIABLE           * U/R number
          MOVE      EIGHT,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
PR6ID412  MOVE      PMEDI,VARIABLE           * Medicare number
          GOTO      PR6I5000
.
PR6ID416  MATCH     SP70,PTMASNAM
          IF        !@EQUAL
            MOVE      PTMASNAM,VARIABLE        * Surname
          ELSE
            MOVE      PSNAME,VARIABLE          * Surname
          ENDIF
          GOTO      PR6I5000
.
PR6ID420  MOVE      ATIME,VARIABLE           * Admission time
          GOTO      PR6I5000
.
PR6ID424  MOVE      ACLSS,VARIABLE           * Admission class
          GOTO      PR6I5000
.
PR6ID428  UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY    * Admission date
          CALL      PACDATE
          MOVE      CPDATE,VARIABLE
          GOTO      PR6I5000
.
PR6ID432  MOVE      PGNAME,VARIABLE          * Given name
          GOTO      PR6I5000
.
PR6ID436  MOVE      PADD1,VARIABLE           * Address line 1
          GOTO      PR6I5000
.
PR6ID440  MOVE      PADD2,VARIABLE           * Address line 2
          GOTO      PR6I5000
.
PR6ID444  MOVE      PSUBRB,VARIABLE          * Suburb
          GOTO      PR6I5000
.
PR6ID448  MOVE      PTELEP,VARIABLE          * Private telephone
          GOTO      PR6I5000
.
PR6ID452  MOVE      PPOST,VARIABLE           * Postcode
          GOTO      PR6I5000
.
PR6ID456  MOVE      ZERO,ANS                 * Sex
          MOVE      PSEX,DSEXCHAR
          CALL      SEXDSP00                
          MOVE      DSEXIND1,VARIABLE
          GOTO      PR6I5000
.
PR6ID460  CALL      LABELAGE 
          MOVE      XAGE,VARIABLE           * Age
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
PR6ID464  UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY   * Birth date
          CALL      PACDATE
          MOVE      CPDATE,VARIABLE
          GOTO      PR6I5000
.
PR6ID468  MOVE      PCONT,VARIABLE           * Country
          GOTO      PR6I5000
.
PR6ID472  COMPARE   ONE,ASTAT                * Ward - check for pre-adm
          GOTO      PR6ID474 IF NOT EQUAL
	  MOVE      PTMIXWRD,VARIABLE        * Use Expected Ward for Pre-Adm.
	  GOTO      PR6I5000
.
PR6ID474  MOVE      AWARD,VARIABLE           * Ward - not Pre-adm
          GOTO      PR6I5000
.
PR6ID476  MOVE      ABED,VARIABLE            * Bed
          GOTO      PR6I5000
.
PR6ID480  MOVE      PMSTAT,VARIABLE          * Marital status
          GOTO      PR6I5000
.
PR6ID484  MOVE      CODER,TCODE              * Religion
          PACK      ACODE,PREG,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6ID488  MOVE      POCCUP,VARIABLE          * Occupation
          GOTO      PR6I5000
.
PR6ID492  MOVE      PTYPE,VARIABLE           * Patient Type
          GOTO      PR6I5000
.
PR6ID496  MOVE      TWO,ANS                  * Claim code
          CMATCH    "0",ACLAIM
          GOTO      PR6ID498 IF EQUAL
          MOVE      ONE,ANS
.
PR6ID498  MOVE      ANS,VARIABLE
          GOTO      PR6I5000
.
PR6ID500  MOVE      SP30,HFNAME              * Health fund
          MATCH     SP6,AFUNDH
          GOTO      PR6ID502 IF EQUAL
          PACK      KEY14,AFUNDH,ZERO4,SP10
          CALL      RDFUND1
.
PR6ID502  MOVE      HFNAME,VARIABLE
          GOTO      PR6I5000
.
PR6ID504  MOVE      SP30,HFNAME              * Health Fund table
          MATCH     SP8,AFNDTB
          GOTO      PR6ID506 IF EQUAL
          PACK      KEY14,AFUNDH,AFNDTB,SP10
          CALL      RDFUND1
.
PR6ID506  MOVE      HFNAME,VARIABLE
          GOTO      PR6I5000
.
PR6ID508  MOVE      PPENNO,VARIABLE          * Pension number
          GOTO      PR6I5000
.
PR6ID512  MOVE      AUSR1,VARIABLE           * User defined 1
          GOTO      PR6I5000
.
PR6ID516  MOVE      CODEU2,TCODE             * User defined 1
          PACK      ACODE,AUSR2,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6ID520  BRANCH    CRDRTYP,PR6ID522         * Referring Doctor
          MOVE      SP30,ARDRNAM
          MATCH     SP6,ADOCTR
          GOTO      PR6ID522 IF EQUAL
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD,PR6ID522
          MOVE      DGNAME,ANS
          PACK      ARDRNAM,ANS,DOT,DSNAME
.
PR6ID522  MOVE      ARDRNAM,VARIABLE
          GOTO      PR6I5000
.
PR6ID524  MOVE      SP30,ADOCDESC            * Attending Doctor
          MATCH     SP6,ADOCTA
          GOTO      PR6ID526 IF EQUAL
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD,PR6ID526
          MOVE      DGNAME,ANS
          PACK      ADOCDESC,ANS,DOT,DSNAME
.
PR6ID526  MOVE      ADOCDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the next of kin name ------
.
PR6ID528  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,PACSNAME
            MOVE      PMCEGNAM,PACGNAME
            MOVE      PMCETITL,PACTITLE
            MOVE      "1",PACFRMT
            CALL      PACNAME
            MOVE      PACFNAME,VARIABLE
          ELSE
            MOVE      PNKNAME,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the next of kin relationship ------
.
PR6ID532  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            PACK      KEY10,PMCERELP,SP70
          ELSE
            PACK      KEY10,PNKRELP,SP70
          ENDIF
          CALL      RDPMREL1
          IF        OVRCD=1
            MOVE      KEY10,PMRLDESC
          ENDIF
          MOVE      PMRLDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the next of kin address ------
.
PR6ID536  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,PKADD1
            MOVE      PMCEADD2,PKADD2
            MOVE      PMCEADD3,PKSUBR 
            MOVE      PMCEADD4,PKADD4
            MOVE      PMCEPOST,PKPOST
          ELSE
            MOVE      PNKADD1,PKADD1
            MOVE      PNKADD2,PKADD2
            MOVE      PNKSUBR,PKSUBR                                  *I-131722
            MOVE      PNKADD4,PKADD4
            MOVE      PNKPOST,PKPOST
          ENDIF
.
          CALL      PAC6ADDR               * pack the address
          PACK      VARIABLE,ADDRLN,SP30,SP30
          GOTO      PR6I5000
.
.------ format the next of kin private telephone number ------
.
PR6ID540  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELP,VARIABLE
          ELSE
            MOVE      PNKTELP,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the next of kin business telephone number ------
.
PR6ID544  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELB,VARIABLE
          ELSE
            MOVE      PNKTELB,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the financially responsible relationship ------
.
PR6ID548  MOVE      "SELF",PKRELP
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          PACK      VARIABLE,PKRELP,SP10
          GOTO      PR6I5000
.
.------ format the financially responsible address ------
.
PR6ID552  MOVE      PADD1,PKADD1
          MOVE      PADD2,PKADD2
          MOVE      PSUBRB,PKSUBR                                     *I-131722
          MOVE      PADD4,PKADD4
          MOVE      PPOST,PKPOST
.
          MOVE      AADMNO,KEY8
          CALL      RDRESP1            * read the responsible for account file
.
          CALL      PAC6ADDR           * pack the address
.
          PACK      VARIABLE,ADDRLN,SP30,SP30
          GOTO      PR6I5000
.
.------ format the attending doctors surgury telephone number ------
.
PR6ID556  MOVE      SP20,DTELES
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DTELES,VARIABLE
          GOTO      PR6I5000
.
.------ format the attending doctors private telephone number ------
.
PR6ID560  MOVE      SP20,DTELEH
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DTELEH,VARIABLE
          GOTO      PR6I5000
.
.------ format the next of kin address line 1------
.
PR6ID564  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,VARIABLE
          ELSE
            MOVE      PNKADD1,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the next of kin address line 2------
.
PR6ID568  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD2,VARIABLE
          ELSE
            MOVE      PNKADD2,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the next of kin suburb ------
.
PR6ID572  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD3,VARIABLE
          ELSE
            MOVE      PNKSUBR,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the next of kin post code ------
.
PR6ID576  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEPOST,VARIABLE
          ELSE
            MOVE      PNKPOST,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the discharge date ------
.
PR6ID580  MOVE      SP8,CPDATE
          COMPARE   THREE,ASTAT               * patient must be discharged
          GOTO      PR6ID582 IF NOT EQUAL
.
          UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
PR6ID582  MOVE      CPDATE,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharge time ------
.
PR6ID584  COMPARE   THREE,ASTAT               * patient must be discharged
          GOTO      PR6ID586 IF NOT EQUAL
.
          MATCH     SP8,DDATE                 * test date for spaces
          GOTO      PR6ID586 IF EQUAL
.
          GOTO      PR6ID587
.
PR6ID586  MOVE      SP8,DTIME
.
PR6ID587  MOVE      DTIME,VARIABLE
          GOTO      PR6I5000
.
.------ format the patients sex ------
.
PR6ID588  MOVE      PSEX,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharge destination ------
.
PR6ID592  MOVE      DDEST,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission diagnosis ------
.
PR6ID596  MOVE      ADIAG1,VARIABLE
          GOTO      PR6I5000
.
.------ format the last year of discharge ------
.
PR6ID600  UNPACK    PLDDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CYEAR,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient fund membership number ------
.
PR6ID604  MOVE      PMVXFNDM,VARIABLE
          GOTO      PR6I5000
.
.------ format the daily rate ------
.
PR6ID608  CALL      GETDRTE                * get the daily rate
          MOVE      NETTOT,VARIABLE
          MOVE      NINE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
.------ format the claim details number 1 ------
.
PR6ID612  CALL      GETCLM6
          MOVE      CLMDET1,VARIABLE
          GOTO      PR6I5000
.
.------ format the claim details number 2 ------
.
PR6ID616  CALL      GETCLM6
          MOVE      CLMDET2,VARIABLE
          GOTO      PR6I5000
.
.------ format the hospital name ------
.
PR6ID620  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          IF        IBCNMHOS<>1
            MOVE      CNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL
            PACK      KEY3,PMVXMHOS,SP70
            CALL      RDPTHSP1
            MOVE      PTHSNAME,VARIABLE
          ELSE
            MOVE      CNAME,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the marital status description ------
.
PR6ID624  MOVE      CODEM,TCODE
          PACK      ACODE,PMSTAT,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the allergies indicator ------
.
PR6ID628  MOVE      "UNKNOWN",DALERG
          LOAD      DALERG,AALERG,DYES,DNO
          MOVE      DALERG,VARIABLE
          GOTO      PR6I5000
.
.------ format the smoker indicator ------
.
PR6ID632  MOVE      "UNKNOWN",DSMOKE
          LOAD      DSMOKE,PSMOK,DYES,DNO
          MOVE      DSMOKE,VARIABLE
          GOTO      PR6I5000
.
.------ format the repatriation number ------
.
PR6ID636  MOVE      THREE,DIM1
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
.------ format the country of birth description ------
.
PR6ID640  MOVE      CODEC,TCODE
          PACK      ACODE,PCONT,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient claim code description ------
.
PR6ID644  MOVE      CODECL,TCODE
          PACK      ACODE,ACLAIM,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the attending doctor address line 1 ------
.
PR6ID648  MOVE      SP30,DSADD1
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DSADD1,VARIABLE
          GOTO      PR6I5000
.
.------ format the attending doctor address line 2 ------
.
PR6ID652  MOVE      SP30,DSADD2
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DSADD2,VARIABLE
          GOTO      PR6I5000
.
.------ format the attending doctor address line 3 ------
.
PR6ID656  MOVE      SP30,DSADD3
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DSADD3,VARIABLE
          GOTO      PR6I5000
.
.------ format the attending doctors post code ------
.
PR6ID660  MOVE      SP30,DSPOST
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DSPOST,VARIABLE
          GOTO      PR6I5000
.
.------ format the referring doctors surgury phone ------
.
PR6ID664  MOVE      SP20,DTELES
          BRANCH    CRDRTYP,PR6ID666
.
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1
.
PR6ID666  MOVE      DTELES,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission source description ------
.
PR6ID668  MOVE      CODES,TCODE
          PACK      ACODE,ASRCE,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions diagnosis number 2 ------
.
PR6ID672  MOVE      ADIAG2,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharge destination description ------
.
PR6ID676  MOVE      CODEDD,TCODE
          PACK      ACODE,DDEST,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharge status description ------
.
PR6ID680  MOVE      CODED,TCODE
          PACK      ACODE,DSTAT,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the hospital code ------
.
PR6ID684  MOVE      CHCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 6 ------
.
PR6ID688  MOVE      AUSR6,VARIABLE           * User defined 1
          GOTO      PR6I5000
.
.------ format the case notes indicator ------
.
PR6ID692  MOVE      SP1,ANS
          LOAD      ANS,PCASE,CCNOTES
          MOVE      ANS,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions type special indicator number 1 ------
.
PR6ID696  MOVE      CODEA,TCODE
          PACK      ACODE,ATYPE,SP3
          CALL      GTCOD000
          PACK      VARIABLE,SP30,SP30     * Initialiased variable
          MOVE      TCINDC1,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 2 HDP Eq. ------
.
PR6ID700  MOVE      CODEU2,TCODE           * User defined 1
          PACK      ACODE,AUSR2,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient birth year ------
.
PR6ID704  UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          PACK      VARIABLE,XCENT,XYEAR
          GOTO      PR6I5000
.
.------ format the country of birth HDP Eq. ------
.
PR6ID708  MOVE      CODEC,TCODE
          PACK      ACODE,PCONT,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient user defined field number 1 HDP Eq. ------
.
PR6ID712  MOVE      CODEP1,TCODE           * User defined 1
          PACK      ACODE,PUSR1,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the marital status HDP Eq. ------
.
PR6ID716  MOVE      CODEM,TCODE
          PACK      ACODE,PMSTAT,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient religion HDP Eq. ------
.
PR6ID720  MOVE      CODER,TCODE
          PACK      ACODE,PREG,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission class HDP Eq. ------
.
PR6ID724  MOVE      CODEP,TCODE
          PACK      ACODE,ACLSS,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient care class HDP Eq. ------
.
PR6ID728  MOVE      CODECC,TCODE
          PACK      ACODE,ACARE,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission source HDP Eq. ------
.
PR6ID732  MOVE      CODES,TCODE
          PACK      ACODE,ASRCE,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 1 HDP Eq. ------
.
PR6ID736  MOVE      CODEU1,TCODE           * User defined 1
          PACK      ACODE,AUSR1,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the local doctor ------
.
PR6ID740  MOVE      ADOCTL,VARIABLE
          GOTO      PR6I5000
.
.------ format the referring doctors code ------
.
PR6ID744  MOVE      ADOCTR,VARIABLE
          GOTO      PR6I5000
.
.------ format the attending doctors code ------
.
PR6ID748  MOVE      ADOCTA,VARIABLE
          GOTO      PR6I5000
.
.------ format the ward/bed ------
.
PR6ID752  COMPARE   ONE,ASTAT                     * check for pre-adm
          GOTO      PR6ID753 IF NOT EQUAL
	  PACK      VARIABLE,PTMIXWRD,SLASH,SP10  * Use Expected Ward
	  GOTO      PR6I5000
.
PR6ID753  MATCH     SP3,ABED
          GOTO      PR6ID755 IF EQUAL
.
          PACK      VARIABLE,AWARD,SLASH,ABED
          GOTO      PR6I5000
.
PR6ID755  PACK      VARIABLE,AWARD,SP10
          GOTO      PR6I5000
.
.------ format the person financially responsible name ------
.
PR6ID756  MOVE      SP70,KEY80
          PACK      PKNAME,SP70,SP20
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
.
          MATCH     "1",PTCNDEES
          GOTO      PR6ID758 IF NOT EQUAL
.
          CMATCH    "$",PKNAME
          IF        @EQUAL
            STRIP     PTCNDDES
            MOVE      PTCNDDES,KEY80
            UNPACK    PKNAME,DIM2,KEY78
            PACK      KEY80,KEY80,SP1,KEY78,SP70
            MOVE      KEY80,VARIABLE
            GOTO      PR6I5000
          ENDIF
.
PR6ID758  MOVE      PKNAME,VARIABLE
          GOTO      PR6I5000
.
.------ format the person financially responsible private telephone no. ------
.
PR6ID760  MOVE      SP20,PKTELEP
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PKTELEP,VARIABLE
          GOTO      PR6I5000
.
.------ format the person financially responsible address line 1 ------
.
PR6ID764  MOVE      SP30,PKADD1
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PKADD1,VARIABLE
          GOTO      PR6I5000
.
.------ format the person financially responsible address line 2 ------
.
PR6ID768  MOVE      SP30,PKADD2
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PKADD2,VARIABLE
          GOTO      PR6I5000
.
.------ format the person financially responsible suburb ------
.
PR6ID772  MOVE      SP20,PKSUBR
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PKSUBR,VARIABLE
          GOTO      PR6I5000
.
.------ format the person financially responsible post code ------
.
PR6ID776  MOVE      SP4,PKPOST
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PKPOST,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 3 ------
.
PR6ID780  MOVE      AUSR3,VARIABLE           * User defined 1
          GOTO      PR6I5000
.
.------ format the person financially responsible business telephone no. ------
.
PR6ID784  MOVE      SP20,PKTELEB
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PKTELEB,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 4 ------
.
PR6ID788  MOVE      AUSR4,VARIABLE           * User defined 1
          GOTO      PR6I5000
.
.------ format the estimated fund rebate description ------
.
PR6ID792  MOVE      SP20,TDESC
          PACK      KEY6,AWARD,WBED
          CALL      RDWARD1                * read the ward file
          BRANCH    OVRCD,PR6ID794
.
          MOVE      CODEBT,TCODE
          PACK      ACODE,WEFRBT,SP3
          CALL      GTCOD000
.
PR6ID794  MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the patient care class description ------
.
PR6ID796  MOVE      CODECC,TCODE
          PACK      ACODE,ACARE,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 5 ------
.
PR6ID800  MOVE      AUSR5,VARIABLE           * User defined 1
          GOTO      PR6I5000
.
.------ format the number of years resident ------
.
PR6ID804  MOVE      PYRRES,VARIABLE
          MOVE      TWO,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
.------ format the business telephone number ------
.
PR6ID808  MOVE      PTELEB,VARIABLE
          GOTO      PR6I5000
.
.------ format the master user defined field 3 HDP ------
.
PR6ID812  MOVE      CODEP3,TCODE           * User defined 3
          PACK      ACODE,PUSR3,SP3
          CALL      GTCOD000
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the master user defined field 3 description ------
.
PR6ID816  MOVE      CODEP3,TCODE
          PACK      ACODE,PUSR3,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission class description ------
.
PR6ID820  MOVE      CODEP,TCODE
          PACK      ACODE,ACLSS,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission type ------
.
PR6ID824  MOVE      ATYPE,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission type HDP Eq. ------
.
PR6ID828  MOVE      CODEA,TCODE
          PACK      ACODE,ATYPE,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format the admission type description ------
.
PR6ID832  MOVE      CODEA,TCODE
          PACK      ACODE,ATYPE,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharge destination HDP Eq. ------
.
PR6ID836  MOVE      CODEDD,TCODE
          PACK      ACODE,DDEST,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format discharge status code ------
.
PR6ID840  MOVE      DSTAT,VARIABLE
          GOTO      PR6I5000
.
.------ format discharge status HDP Eq. ------
.
PR6ID844  MOVE      CODED,TCODE
          PACK      ACODE,DSTAT,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format care class code ------
.
PR6ID848  MOVE      ACARE,VARIABLE
          GOTO      PR6I5000
.
.------ format HCS attending doctor code -------
.
PR6ID852  MOVE      ZERO,DHCSCOD
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1                  * read doctors file
.
          MOVE      DHCSCOD,VARIABLE
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
.------ format religion ------
.
PR6ID856  MOVE      PREG,VARIABLE
          GOTO      PR6I5000
.
.------ format fund table code ------
.
PR6ID860  MOVE      AFNDTB,VARIABLE
          GOTO      PR6I5000
.
.------ format fund table HDP Eq.------
.
PR6ID864  MOVE      SP4,HFHDPE               * Health Fund table HDP
          MATCH     SP8,AFNDTB               * see if health fund table exists
          GOTO      PR6ID866 IF EQUAL
.
          PACK      KEY14,AFUNDH,AFNDTB,SP10
          CALL      RDFUND1                  * read health fund file
.
PR6ID866  MOVE      HFHDPE,VARIABLE
          GOTO      PR6I5000
.
.------ format claim code ------
.
PR6ID868  MOVE      ACLAIM,VARIABLE
          GOTO      PR6I5000
.
.------ format claim code HDP Eq. ------
.
PR6ID872  MOVE      CODECL,TCODE
          PACK      ACODE,ACLAIM,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 1 code ------
.
PR6ID876  MOVE      PUSR1,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 1 description ------
.
PR6ID880  MOVE      CODEP1,TCODE           * User defined 1
          PACK      ACODE,PUSR1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 2 code ------
.
PR6ID884  MOVE      PUSR2,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 2 description ------
.
PR6ID888  MOVE      CODEP2,TCODE           * User defined 2
          PACK      ACODE,PUSR2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 2 HDP Eq. ------
.
PR6ID892  MOVE      CODEP2,TCODE           * User defined 2
          PACK      ACODE,PUSR2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 3 code ------
.
PR6ID896  MOVE      PUSR3,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 3 description ------
.
PR6ID900  MOVE      CODEP3,TCODE           * User defined 3
          PACK      ACODE,PUSR3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 3 HDP Eq. ------
.
PR6ID904  MOVE      CODEP3,TCODE           * User defined 3
          PACK      ACODE,PUSR3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 4 code ------
.
PR6ID908  MOVE      PUSR4,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 4 description ------
.
PR6ID912  MOVE      CODEP4,TCODE           * User defined 4
          PACK      ACODE,PUSR4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 4 HDP Eq. ------
.
PR6ID916  MOVE      CODEP4,TCODE           * User defined 4
          PACK      ACODE,PUSR4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 5 code ------
.
PR6ID920  MOVE      PUSR5,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 5 description ------
.
PR6ID924  MOVE      CODEP5,TCODE           * User defined 5
          PACK      ACODE,PUSR5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 5 HDP Eq. ------
.
PR6ID928  MOVE      CODEP5,TCODE           * User defined 5
          PACK      ACODE,PUSR5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 6 code ------
.
PR6ID932  MOVE      PUSR6,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 6 description ------
.
PR6ID936  MOVE      CODEP6,TCODE           * User defined 6
          PACK      ACODE,PUSR6,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined field 6 HDP Eq. ------
.
PR6ID940  MOVE      CODEP6,TCODE           * User defined 6
          PACK      ACODE,PUSR6,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined Y/N field 1 -----
.
PR6ID944  MOVE      DNO,DIM3
          LOAD      DIM3,PUYN1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined Y/N field 2 -----
.
PR6ID948  MOVE      DNO,DIM3
          LOAD      DIM3,PUYN2,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined Y/N field 3 -----
.
PR6ID952  MOVE      DNO,DIM3
          LOAD      DIM3,PUYN3,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 1 description ------
.
PR6ID956  MOVE      CODEU1,TCODE             * User defined 1
          PACK      ACODE,AUSR1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format user defined 2 code ------
.
PR6ID960  MOVE      AUSR2,VARIABLE           * User defined 2
          GOTO      PR6I5000
.
.------ format user defined 2 description ------
.
PR6ID964  MOVE      CODEU2,TCODE             * User defined 2
          PACK      ACODE,AUSR2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 3 description ------
.
PR6ID968  MOVE      CODEU3,TCODE             * User defined 3
          PACK      ACODE,AUSR3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 3 HDP Eq. ------
.
PR6ID972  MOVE      CODEU3,TCODE             * User defined 3
          PACK      ACODE,AUSR3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format admission user defined 4 code description ------
.
PR6ID976  MOVE      CODEU4,TCODE             * User defined 4
          PACK      ACODE,AUSR4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 4 HDP Eq. ------
.
PR6ID980  MOVE      CODEU4,TCODE             * User defined 4
          PACK      ACODE,AUSR4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format admission user defined 5 code description ------
.
PR6ID984  MOVE      CODEU5,TCODE             * User defined 5
          PACK      ACODE,AUSR5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 5 HDP Eq. ------
.
PR6ID988  MOVE      CODEU5,TCODE             * User defined 5
          PACK      ACODE,AUSR5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format admission user defined 6 code description ------
.
PR6ID992  MOVE      CODEU6,TCODE             * User defined 6
          PACK      ACODE,AUSR6,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 6 HDP Eq. ------
.
PR6ID996  MOVE      CODEU6,TCODE             * User defined 6
          PACK      ACODE,AUSR6,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format admission user defined 7 code ------
.
PR6I1000  MOVE      AUSR7,VARIABLE
          GOTO      PR6I5000
.
.------ format admission user defined 7 code description ------
.
PR6I1004  MOVE      CODEU7,TCODE             * User defined 7
          PACK      ACODE,AUSR7,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 7 HDP Eq. ------
.
PR6I1008  MOVE      CODEU7,TCODE             * User defined 7
          PACK      ACODE,AUSR7,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 1 code ------
.
PR6I1012  MOVE      DUSD1,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 1 code description ------
.
PR6I1016  MOVE      CODED1,TCODE             * User defined 1
          PACK      ACODE,DUSD1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharged user defined field number 1 HDP Eq. ------
.
PR6I1020  MOVE      CODED1,TCODE             * User defined 1
          PACK      ACODE,DUSD1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 2 code ------
.
PR6I1024  MOVE      DUSD2,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 2 code description ------
.
PR6I1028  MOVE      CODED2,TCODE             * User defined 2
          PACK      ACODE,DUSD2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharged user defined field number 2 HDP Eq. ------
.
PR6I1032  MOVE      CODED2,TCODE             * User defined 2
          PACK      ACODE,DUSD2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 3 code ------
.
PR6I1036  MOVE      DUSD3,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 3 code description ------
.
PR6I1040  MOVE      CODED3,TCODE             * User defined 3
          PACK      ACODE,DUSD3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharged user defined field number 3 HDP Eq. ------
.
PR6I1044  MOVE      CODED3,TCODE             * User defined 3
          PACK      ACODE,DUSD3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 4 code ------
.
PR6I1048  MOVE      DUSD4,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 4 code description ------
.
PR6I1052  MOVE      CODED4,TCODE             * User defined 4
          PACK      ACODE,DUSD4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharged user defined field number 4 HDP Eq. ------
.
PR6I1056  MOVE      CODED4,TCODE             * User defined 4
          PACK      ACODE,DUSD4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 5 code ------
.
PR6I1060  MOVE      DUSD5,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged user defined 5 code description ------
.
PR6I1064  MOVE      CODED5,TCODE             * User defined 5
          PACK      ACODE,DUSD5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the discharged user defined field number 5 HDP Eq. ------
.
PR6I1068  MOVE      CODED5,TCODE             * User defined 5
          PACK      ACODE,DUSD5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      THCSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ format pension number expiry date ------
.
PR6I1072  REP       " 0",PPNDTE
          UNPACK    PPNDTE,XCENT,XYEAR,XMON
          PACK      VARIABLE,XMON,SLASH,XYEAR
          GOTO      PR6I5000
.
.------ format sex description ------
.
PR6I1076  MOVE      SP8,VARIABLE            * Sex
          MOVE      PSEX,DSEXCHAR
          CALL      SEXDSP00                * get sex description
          MOVE      DSEXASC1,VARIABLE
          GOTO      PR6I5000
.
.------ format referral doctor HCS code ------
.
PR6I1080  MOVE      ZERO,DHCSCOD
          MATCH     SP6,ADOCTR
          GOTO      PR6I1081 IF EQUAL
.
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1                  * read doctors file
.
PR6I1081  MOVE      DHCSCOD,VARIABLE
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
.------ format years of membership ------
.
PR6I1084  MOVE      AFNDYY,VARIABLE
          GOTO      PR6I5000
.
.----- format day of hospitalization ------
.
PR6I1088  MOVE      ADYHOSP,VARIABLE
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PR6I6000
.
.----- format discharged diagnosis description ------
.
PR6I1092  BRANCH    CKMBS OF PR6I1093,PR6I1094
          PACK      VARIABLE,DDIAG,DDIAG2      * Free format
          GOTO      PR6I5000
.
.       Check for a valid ICD code
.
PR6I1093  MATCH     SP9,DFMBS
          GOTO      PR6I5000 IF EQUAL
.
          OPEN      PATICDD1,"paticddf"
          OPEN      PATI10D1,"pati10df"
          PACK      DDESC,SP20,SP20,SP20,SP20
          MOVE      DFMBS,KEY9
            CALL      RD10T9D1
            IF        OVRCD=1
                CALL     RDPT10D1
            ENDIF
          CLOSE     PATICDD1
          CLOSE     PATI10D1
          MOVE      DDESC,VARIABLE
          GOTO      PR6I5000
.
.       Check for a valid MBS code
.
PR6I1094  PACK      IDESC,SP20,SP20
          MATCH     SP9,DFMBS
          GOTO      PR6I1095 IF EQUAL
.
          OPEN      PATITEM1,"patitemn"
          PACK      IDESC,SP20,SP20
          MOVE      DFMBS,KEY9
          PACK      KEY17,KEY9,SP70
          CALL      PATITMRD
          CLOSE     PATITEM1
.
PR6I1095  MOVE      IDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format discharged diagnosis code ------
.
PR6I1096  MOVE      DFMBS,VARIABLE
          GOTO      PR6I5000
.
.------ format admission source ------
.
PR6I1100  MOVE      ASRCE,VARIABLE
          GOTO      PR6I5000
.
.------ format patient title ------
.
PR6I1104  MOVE      PTITL,VARIABLE
          GOTO      PR6I5000
.
. ------- Format the Current Legal Status Description ------ variable 177
.
PR6I1108  MOVE      "LS",TCODE
          PACK      ACODE,PTMXLS,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Date of Legal Status -------
.
PR6I1112  UNPACK    PTMXLSDT,CCENT,CYEAR,CMON,CDAY 
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Familial history of mental disorder -------
.
PR6I1116  MOVE      "No ",ACODE
          MOVE      PTMXFHMD,FORM1
          LOAD      ACODE,FORM1,DYES
          MOVE      ACODE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MH User Defined Field 1 -------
.
PR6I1120  MOVE      "V6",TCODE
          PACK      ACODE,PTMXMHU1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MH User Defined Field 2 -------
.
PR6I1124  MOVE      "V7",TCODE
          PACK      ACODE,PTMXMHU2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MH User Defined Field 3 -------
.
PR6I1128  MOVE      "V8",TCODE
          PACK      ACODE,PTMXMHU3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Emergency contact address -------
.
PR6I1132  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,PKADD1
            MOVE      PMCEADD2,PKADD2
            MOVE      PMCEADD3,PKSUBR 
            MOVE      PMCEADD4,PKADD4
            MOVE      PMCEPOST,PKPOST
          ELSE
            MOVE      PTMXECA1,PKADD1
            MOVE      PTMXECA2,PKADD2
            MOVE      PTMXECA3,PKSUBR                                 *I-131722
            MOVE      PTMXECA4,PKADD4
            MOVE      PTMXECPC,PKPOST
          ENDIF
          CALL      PAC6ADDR           * pack the address
          PACK      VARIABLE,ADDRLN,SP30,SP30
          GOTO      PR6I5000
.
. ------- Format Nearest Relative address -------
.
PR6I1136  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative  
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,PKADD1
            MOVE      PMCEADD2,PKADD2
            MOVE      PMCEADD3,PKSUBR
            MOVE      PMCEADD4,PKADD4
            MOVE      PMCEPOST,PKPOST
          ELSE
            MOVE      PTMXNRA1,PKADD1
            MOVE      PTMXNRA2,PKADD2
            MOVE      PTMXNRA3,PKSUBR                                 *I-131722
            MOVE      PTMXNRA4,PKADD4
            MOVE      PTMXNRPC,PKPOST
          ENDIF
          CALL      PAC6ADDR           * pack the address
          PACK      VARIABLE,ADDRLN,SP30,SP30
          GOTO      PR6I5000
.
. ------- Format Current Visit Status -------
.
PR6I1140  MOVE      "Pre-Admitted",TDESC
          LOAD      TDESC,MHVISTAT,STAT6,STAT7,STAT8,STAT9,STAT10,STAT11
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Next Legal Status Review Date -------
.
PR6I1144  UNPACK    MHVILSRV,CCENT,CYEAR,CMON,CDAY 
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Therapist -------
.
PR6I1148  MOVE      MHVITHER,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Address Admitted from -------
.
PR6I1152  MOVE      MHVIADD1,PKADD1
          MOVE      MHVIADD2,PKADD2
          MOVE      MHVISUBR,PKSUBR                                   *I-131722
          MOVE      MHVIADD4,PKADD4
          MOVE      MHVIPOST,PKPOST
          CALL      PAC6ADDR           * pack the address
          PACK      VARIABLE,ADDRLN,SP30,SP30
          GOTO      PR6I5000
.
. ------- Format Accommodation Type -------
.
PR6I1156  MOVE      "AY",TCODE
          PACK      ACODE,MHVIACTY,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Referral Date -------
.
PR6I1160  UNPACK    MHVIRFDT,CCENT,CYEAR,CMON,CDAY 
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format First Contact Date -------
.
PR6I1164  UNPACK    MHVIFCDT,CCENT,CYEAR,CMON,CDAY 
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Reception order date -------
.
PR6I1168  MATCH     MHVIRODT,SP70
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    MHVIRODT,CCENT,CYEAR,CMON,CDAY 
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Visits Restricted -------
.
PR6I1172  MOVE      "No ",ACODE
          LOAD      ACODE,MHVIVISI,DYES
          MOVE      ACODE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Benefit Type -------
.
PR6I1176  MOVE      "BY",TCODE
          PACK      ACODE,MHVIBENE,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Benefit paid to -------
.
PR6I1180  MOVE      MHVIBEPD,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Maximised Benefit -------
.
PR6I1184  MOVE      "No ",ACODE
          LOAD      ACODE,MHVIMXBE,DYES
          MOVE      ACODE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Maximised date -------
.
PR6I1188  UNPACK    MHVIMXDT,CCENT,CYEAR,CMON,CDAY 
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Supported by a Benefit -------
.
PR6I1192  MOVE      "No ",ACODE
          LOAD      ACODE,MHVISUPP,DYES
          MOVE      ACODE,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MEH User defined field 1 -------
.
PR6I1196  MOVE      "V1",TCODE
          PACK      ACODE,MHVIUSR1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MEH User defined field 2 -------
.
PR6I1200  MOVE      "V2",TCODE
          PACK      ACODE,MHVIUSR2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MEH User defined field 3 -------
.
PR6I1204  MOVE      "V3",TCODE
          PACK      ACODE,MHVIUSR3,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MEH User defined field 4 -------
.
PR6I1208  MOVE      "V4",TCODE
          PACK      ACODE,MHVIUSR4,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format MEH User defined field 5 -------
.
PR6I1212  MOVE      "V5",TCODE
          PACK      ACODE,MHVIUSR5,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Comp. Elig. from visit card information -------
.
PR6I1216  MOVE      PTVKCOMP,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Card Number -------
.
PR6I1220  MOVE      PTVKCARD,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Exp. date -------
.
PR6I1224  UNPACK    PTVKCEXP,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN = 10
            PACK      VARIABLE,CPCDATE,SP30,SP30,SP30
          ELSE
            PACK      VARIABLE,CPDATE,SP30,SP30,SP30
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Exemption Type code -------
.
PR6I1228  MOVE      PTVKCXMP,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Exemption Type description -------
.
PR6I1232  MOVE      "XM",TCODE
          PACK      ACODE,PTVKCXMP,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Comp. Elig. from visit card information -------
.
PR6I1236  MOVE      "CL",TCODE
          PACK      ACODE,PTVKCOMP,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Birth date with century ------
.
PR6I1240  UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ format Admission date with century ------
.
PR6I1244  UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY    * Admission Date
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ format address 1 of referring doctor ------
.
PR6I1248  PACK      DSADD1,SP20,SP20
          BRANCH    CRDRTYP,PR6I1250
.
          MATCH     SP6,ADOCTR
          GOTO      PR6I1250 IF EQUAL
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1               * Read doctors file
.
PR6I1250  MOVE      DSADD1,VARIABLE
          GOTO      PR6I5000
.
.------ format address 2 of referring doctor ------
.
PR6I1252  PACK      DSADD2,SP20,SP20
          BRANCH    CRDRTYP,PR6I1254
.
          MATCH     SP6,ADOCTR
          GOTO      PR6I1254 IF EQUAL
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1               * Read doctors file
.
PR6I1254  MOVE      DSADD2,VARIABLE
          GOTO      PR6I5000
.
.------ format address 3 of referring doctor ------
.
PR6I1256  PACK      DSADD3,SP20,SP20
          BRANCH    CRDRTYP,PR6I1258
.
          MATCH     SP6,ADOCTR
          GOTO      PR6I1258 IF EQUAL
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1               * Read doctors file
.
PR6I1258  MOVE      DSADD3,VARIABLE
          GOTO      PR6I5000
.
.------ format postcode of referring doctor ------
.
PR6I1260  PACK      DSPOST,SP20,SP20
          BRANCH    CRDRTYP,PR6I1262
.
          MATCH     SP6,ADOCTR
          GOTO      PR6I1262 IF EQUAL
          MOVE      ADOCTR,KEY6
          CALL      RDDOCT1               * Read doctors file
.
PR6I1262  MOVE      DSPOST,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Emergency contact name -------
.
PR6I1264  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,PACSNAME
            MOVE      PMCEGNAM,PACGNAME
            MOVE      PMCETITL,PACTITLE
            MOVE      "1",PACFRMT
            CALL      PACNAME
            MOVE      PACFNAME,VARIABLE
          ELSE 
            MOVE      PTMXECNM,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact address 1 -------
.
PR6I1268  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,VARIABLE
          ELSE
            MOVE      PTMXECA1,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact address 2 -------
.
PR6I1272  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD2,VARIABLE
          ELSE
            MOVE      PTMXECA2,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact address 3 -------
.
PR6I1276  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD3,VARIABLE
          ELSE 
            MOVE      PTMXECA3,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact postcode -------
.
PR6I1280  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEPOST,VARIABLE
          ELSE
            MOVE      PTMXECPC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact private phone -------
.
PR6I1284  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELP,VARIABLE
          ELSE
            MOVE      PTMXECPP,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact business phone -------
.
PR6I1288   MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELB,VARIABLE
          ELSE
            MOVE      PTMXECBP,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Emergency contact relationship -------
.
PR6I1292  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            PACK      KEY10,PMCERELP,SP70
          ELSE
            PACK      KEY10,PTMXECRE,SP10                             *C-201977
          ENDIF
          CALL      RDPMREL1
          IF        OVRCD=1
            MOVE      KEY10,PMRLDESC
          ENDIF
          MOVE      PMRLDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- Format Nearest relative name -------
.
PR6I1296  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,PACSNAME
            MOVE      PMCEGNAM,PACGNAME
            MOVE      PMCETITL,PACTITLE
            MOVE      "1",PACFRMT
            CALL      PACNAME
            MOVE      PACFNAME,VARIABLE
          ELSE
            MOVE      PTMXNRNM,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative address 1 -------
.
PR6I1300  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,VARIABLE
          ELSE
            MOVE      PTMXNRA1,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative address 2 -------
.
PR6I1304  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD2,VARIABLE
          ELSE
            MOVE      PTMXNRA2,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative address 3 -------
.
PR6I1308  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD3,VARIABLE
          ELSE
            MOVE      PTMXNRA3,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative postcode -------
.
PR6I1312  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEPOST,VARIABLE
          ELSE
            MOVE      PTMXNRPC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative private phone -------
.
PR6I1316  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELP,VARIABLE
          ELSE
            MOVE      PTMXNRPP,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative business phone -------
.
PR6I1320  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELB,VARIABLE
          ELSE
            MOVE      PTMXNRBP,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- Format Nearest relative relationship -------
.
PR6I1324  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            PACK      KEY10,PMCERELP,SP70
          ELSE
            PACK      KEY10,PTMXNRRE,SP10
          ENDIF
          CALL      RDPMREL1
          IF        OVRCD=1
            MOVE      KEY10,PMRLDESC
          ENDIF
          MOVE      PMRLDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format admission transfer source code ------
.
PR6I1328  COMPARE   ONE,PTCNUADT          * parameter on ?
          GOTO      PR6I5000 IF NOT EQUAL * no.
.
          MATCH     SP5,PTDAADTS
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PTDAADTS,VARIABLE
          GOTO      PR6I5000
.
.------ format admission transfer source code description ------
.
PR6I1332  COMPARE   ONE,PTCNUADT          * parameter on ?
          GOTO      PR6I5000 IF NOT EQUAL * no.
.
          MATCH     SP5,PTDAADTS
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PTDAADTS,KEY5
          CALL      RDPTVAD1
          BRANCH    OVRCD,PR6I5000
          MOVE      PTVADESC,VARIABLE
          GOTO      PR6I5000
.
.------ format discharge transfer source code ------
.
PR6I1336  COMPARE   ONE,PTCNUADT          * parameter on ?
          GOTO      PR6I5000 IF NOT EQUAL * no.
.
          MATCH     SP5,PTDADCTS
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PTDADCTS,VARIABLE
          GOTO      PR6I5000
.
.------ format admission transfer source code description ------
.
PR6I1340  COMPARE   ONE,PTCNUADT          * parameter on ?
          GOTO      PR6I5000 IF NOT EQUAL * no.
.
          MATCH     SP5,PTDADCTS
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PTDADCTS,KEY5
          CALL      RDPTVAD1
          BRANCH    OVRCD,PR6I5000
          MOVE      PTVADESC,VARIABLE
          GOTO      PR6I5000
.
.------ format District of Residence code ------
.
PR6I1344  MOVE      PTMXDOFR,VARIABLE
          GOTO      PR6I5000
.
.------ format District of Residence description ------
.
PR6I1348  MOVE      "DA",TCODE
          PACK      ACODE,PTMXDOFR,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Registered HCP. code (PMI Based) ------
.
PR6I1352  MOVE      PMPXRHC1,VARIABLE
          GOTO      PR6I5000
.
.------ format Registered HCP. description (PMI Based) ------
.
PR6I1356  PACK      PACFNAME,SP30,SP30,SP20
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      TWO,PACFRMT
            CALL      PACNAME
          ENDIF
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------ format HCP practice code (PMI Based) ------
.
PR6I1360  MOVE      "-",ANS
          MATCH     SP2,PMPXR1GC
          IF        @EQUAL
            MOVE      SP1,ANS
          ENDIF
          PACK      VARIABLE,PMPXRH1G,ANS,PMPXR1GC,SP30
          GOTO      PR6I5000
.
.------ format HCP practice description (PMI Based) ------
.
PR6I1364  PACK      PMHGPNAM,SP30
          PACK      KEY10,PMPXRH1G,SP70
          PACK      KEY12,KEY10,PMPXR1GC,SP70
          CALL      RDPMHCG1
          MOVE      PMHGPNAM,VARIABLE
          GOTO      PR6I5000
.
.------ format supplementary Id ------
.
PR6I1368  MOVE      PTMXSPID,VARIABLE
          GOTO      PR6I5000
.
.------ format Registered HCP. code (Admission based) ------
.
PR6I1372  MOVE      PMVXRHC1,VARIABLE
          GOTO      PR6I5000
.
.------ format Registered HCP. description (Admission Based) ------
.
PR6I1376  PACK      PACFNAME,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      TWO,PACFRMT
            CALL      PACNAME
          ENDIF
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------ format HCP practice code (Admission Based) ------
.
PR6I1380  MOVE      "-",ANS
          MATCH     SP2,PMVXRH1C
          IF        @EQUAL
            MOVE      SP1,ANS
          ENDIF
          PACK      VARIABLE,PMVXRH1G,ANS,PMVXRH1C,SP30
          GOTO      PR6I5000
.
.------ format HCP practice description (Admission Based) ------
.
PR6I1384  PACK      PMHGPNAM,SP30
          PACK      KEY10,PMVXRH1G,SP70
          PACK      KEY12,KEY10,PMVXRH1C,SP70
          CALL      RDPMHCG1
          MOVE      PMHGPNAM,VARIABLE
          GOTO      PR6I5000
.
.----- format GPRH Approval number ------
.
PR6I1388  MOVE      PTMSFHAN,VARIABLE
          GOTO      PR6I5000
.
.----- format ECR Approval number ------
.
PR6I1392  MOVE      PTMSECRA,VARIABLE
          GOTO      PR6I5000
.
.----- format Management Intent code ------
.
PR6I1396  MOVE      PTMSMGIN,VARIABLE
          GOTO      PR6I5000
.
.----- format Management Intent desc ------
.
PR6I1400  MOVE      "MI",TCODE
          PACK      ACODE,PTMSMGIN,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.----- format Hospital Unit Number code------
.
PR6I1404  MOVE      PTWDHOSN,VARIABLE
          GOTO      PR6I5000
.
.----- format Hospital Unit Number desc------
.
PR6I1408  MOVE      SP30,PTHSNAME
          PACK      KEY3,PTWDHOSN
          CALL      RDPTHSP1
          MOVE      PTHSNAME,VARIABLE
          GOTO      PR6I5000
.
.----- format Day/Night Indicator ------
.
PR6I1412  MOVE      "Day Only",VARIABLE
          IF        PTWDDNIN=1
            MOVE      "Day & Night",VARIABLE
          ENDIF
          IF        PTWDDNIN=2
            MOVE      "Night Only",VARIABLE
          ENDIF
          GOTO      PR6I5000
.         
.----- format Intended Age Group ------
.
PR6I1416  MOVE      PTWDIAGE,VARIABLE
          GOTO      PR6I5000
.         
.----- format Intended Age Group description------
.
PR6I1420  MOVE      "IA",TCODE
          PACK      ACODE,PTWDIAGE,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.         
.----- format Intended Care Intensity code ------
.
PR6I1424  MOVE      PTWDICRE,VARIABLE
          GOTO      PR6I5000
.         
.----- format Intended Care Intensity desc ------
.
PR6I1428  MOVE      "IC",TCODE
          PACK      ACODE,PTWDICRE,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.         
.----- format Intended Sex of Patient ------
.
PR6I1432  MOVE      PTWDSEX,DSEXCHAR
          CALL      SEXDSP00                * get sex description
          MOVE      DSEXASC1,VARIABLE
          GOTO      PR6I5000
.
. --- format doctor title ----
.
PR6I1436  MOVE      SP10,DTITL
          MATCH     SP6,ADOCTA
          GOTO      PR6I1437 IF EQUAL
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
PR6I1437  MOVE      DTITL,VARIABLE
          GOTO      PR6I5000
.         
.----- format Admission Class code ------
.
PR6I1440  MOVE      ACLSS,VARIABLE
          GOTO      PR6I5000
.         
.----- format Admission Class desc ------
.
PR6I1444  MOVE      "P ",TCODE
          PACK      ACODE,ACLSS,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.         
.----- format Microfilm Address ------
.
PR6I1448  MOVE      PMICRO,VARIABLE
          GOTO      PR6I5000
.
. ------- HCP Practice Address details * PMI based -------
.
PR6I2263  PACK      VARIABLE,SP70,SP70
          PACK      KEY10,PMPXRH1G,SP70
          PACK      KEY12,KEY10,PMPXR1GC,SP70
          CALL      RDPMHCG1
          BRANCH    OVRCD,PR6I5000
.
          SUB       "463",FORM5
          LOAD      VARIABLE,FORM5,PMHGADD1,PMHGADD2,PMHGADD3:
                                   PMHGADD4,PMHGPOST,PMHGPTEL:
                                   PMHGPPNO,PMHGPFAX
          GOTO      PR6I5000
.
. ------- ward description -------
.
PR6I2266  COMPARE   ONE,ASTAT                * Ward - check for pre-adm
          GOTO      PR6I2267 IF NOT EQUAL
	  PACK      KEY6,PTMIXWRD,SP6        * Use Expected Ward for Pre-Adm.
	  GOTO      PR6I2268
.
PR6I2267  PACK      KEY6,AWARD,ABED
PR6I2268  CALL      RDWARD1
          BRANCH    OVRCD,PR6I5000
          PACK      VARIABLE,WBDESC,SP30,SP30,SP30
          GOTO      PR6I5000
.
.
. ------- HCP Practice Address details * Admission based -------
.
PR6I2270  PACK      VARIABLE,SP70,SP70
          PACK      KEY10,PMVXRH1G,SP70      * Fix for 0831808
          MATCH     KEY10,SP70               * practice exists on pmsvx1af?
          IF        @EQUAL
            PACK      KEY10,PMVXRHC1,SP70    * no practice so use hcp details
            MATCH     KEY10,SP70
            GOTO      PR6I5000 IF EQUAL
.
            CALL      RDPMHCP1
            BRANCH    OVRCD,PR6I5000
.
            SUB       "269",FORM5
            LOAD      VARIABLE,FORM5,PMHCADR1,PMHCADR2,PMHCADR3:
                                     PMHCADR4,PMHCPOST,PMHCSTEL
          ELSE
            PACK      KEY12,KEY10,PMVXRH1C,SP70  * use practice details
            CALL      RDPMHCG1
            BRANCH    OVRCD,PR6I5000
.
            SUB       "269",FORM5
            LOAD      VARIABLE,FORM5,PMHGADD1,PMHGADD2,PMHGADD3:
                                     PMHGADD4,PMHGPOST,PMHGPTEL
          ENDIF
          GOTO      PR6I5000
.
.-------- Occurence Screening Alert --------
.
PR6I2271  PACK       KEY5,ANSP,FOUR,PUSR4,SP10
          CALL       RDCODE1
          BRANCH     OVRCD,PR6I5000
.
          MATCH      "1",TCINDC1
          GOTO       PR6I5000 IF NOT EQUAL 
.       
          MOVE       PTCNOCSC,VARIABLE
          GOTO       PR6I5000
.
.-------- Employer Name --------------------- 
.
PR6I2272  PACK      KEY6,PTMAEMPC,SP10
          CALL      RDGOVR1
          BRANCH    OVRCD,PR6I5000
.
          MOVE      GNAME,VARIABLE 
.
          GOTO      PR6I5000
.
.-------- Employer Address ----------------- 
.
PR6I2273  PACK      VARIABLE,SP70,SP70
          PACK      KEY6,PTMAEMPC,SP10
          CALL      RDGOVR1
          BRANCH    OVRCD,PR6I5000
.
          SUB       "280",FORM5
          LOAD      VARIABLE,FORM5,GADD1,GADD2,GADD3,GADD4 
.
          GOTO      PR6I5000
.
.-------- Patient National Number --------------- 
.
PR6I2274  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TWENTY1;*138,PTCNNHII
          READ      CONTROLF,FIFTY9;*234,PTCNNMPI
.
          IF        PTCNNHII = 1
.
. ------- using NHI Link - get National Number from nhimasaf
.
            PACK      KEY8,PURNO,SP10
            OPEN      NHIMASA2,"nhimasaf"
            CALL      RDNHMAS2
            IF        OVRCD = 1
              MOVE      SP20,VARIABLE
            ELSE
              MOVE      NHMANMPI,VARIABLE
            ENDIF
            MOVE      TWENTY,PRNTSTRT
            SUB       IBDTPLEN,PRNTSTRT
          ELSE
            IF        PTCNNMPI = 0
.
. ------- NOT using national numbers
.
              MOVE      SP20,VARIABLE
            ELSE
.
. ------- NOT using NHI Link - get National Number from patnidaf
.
              PACK      KEY10,CHOSINDX,PURNO,SP10 
              OPEN      PATNIDA1,"patnidaf"
              CALL      RDPTNID1
              IF        OVRCD = 1
                MOVE      SP20,VARIABLE
              ELSE
                MOVE      PTNINMPI,VARIABLE
              ENDIF
            ENDIF
            MOVE      TWENTY,PRNTSTRT
            SUB       IBDTPLEN,PRNTSTRT
          ENDIF
.
          GOTO      PR6I6000
.
.-------- Next Of Kin Occupation --------------- 
.
PR6I2275  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      SP70,VARIABLE 
          ELSE
            MOVE      PTMANOKO,VARIABLE 
          ENDIF
          GOTO      PR6I5000
.
.-------- Garantor I/C Number --------------- 
.
PR6I2276  
.         PACK      KEY8,AADMNO,SP10
.         CALL      RDPTAXE1
.
.         BRANCH    OVRCD,PR6I5000
. 
.         MOVE      PTAXGUIN,VARIABLE 
          GOTO      PR6I5000
.
.-------- Garantor Name --------------- 
.
PR6I2277  
.         PACK      KEY8,AADMNO,SP10
.         CALL      RDPTAXE1
.
.         BRANCH    OVRCD,PR6I5000
. 
.         MOVE      PTAXGUNM,VARIABLE 
          GOTO      PR6I5000
.
.-------- Guarantor Relationship ----------------- 
.
PR6I2278  
.         PACK      KEY8,AADMNO,SP10
.         CALL      RDPTAXE1
.         BRANCH    OVRCD,PR6I5000
.
.         MOVE      PTAXGURL,VARIABLE
          GOTO      PR6I5000
.
.-------- Guarantor Occupation ----------------- 
.
PR6I2279  
.         PACK      KEY8,AADMNO,SP10
.         CALL      RDPTAXE1
.         BRANCH    OVRCD,PR6I5000
.
.         MOVE      PTAXGUOC,VARIABLE
          GOTO      PR6I5000
.
.-------- Guarantor Address ----------------- 
.
PR6I2280  
.         PACK      KEY8,AADMNO,SP10
.         CALL      RDPTAXE1
.         BRANCH    OVRCD,PR6I5000
.
.         SUB       "289",FORM5
.         LOAD      VARIABLE,FORM5,PTAXGUA1,PTAXGUA2,PTAXGUA3,PTAXGUA4
.
          GOTO      PR6I5000
.
.-------- Guarantor Employer Name --------------------- 
.
PR6I2281  
.         PACK      KEY6,PTAXGUEC,SP10
.         CALL      RDGOVR1
.         BRANCH    OVRCD,PR6I5000
.
.         MOVE      GNAME,VARIABLE 
.
          GOTO      PR6I5000
.
.-------- Guarantor Employer Address ----------------- 
.
PR6I2282  
.         PACK      KEY6,PTAXGUEC,SP10
.         CALL      RDGOVR1
.         BRANCH    OVRCD,PR6I5000
.
.         SUB       "294",FORM5
.         LOAD      VARIABLE,FORM5,GADD1,GADD2,GADD3,GADD4 
.
          GOTO      PR6I5000
.
.-------- Guarantor Employer Phone ----------------- 
.
PR6I2283  
.         PACK      KEY6,PTAXGUEC,SP10
.         CALL      RDGOVR1
.         BRANCH    OVRCD,PR6I5000
.         MOVE      GTELEB,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 1 description ------
.
PR6I2284  MOVE      "P1",TCODE             * User defined 1
          PACK      ACODE,PUSR1,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the admissions user defined field number 2 description ------
.
PR6I2285  MOVE      "P2",TCODE             * User defined 2
          PACK      ACODE,PUSR2,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ----- Get Hospital Approval Number -----
.
PR6I2288  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          IF        IBCNMHOS<>1
            MOVE      CAPPRVNO,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL
            PACK      KEY3,PMVXMHOS,SP70
            CALL      RDPTHSP1
            PACK      VARIABLE,PTHSAPPR,SP70
          ELSE
            MOVE      CAPPRVNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ----- Get Hospital File Number -----
.
PR6I2292  MOVE      CFILENO,VARIABLE
          GOTO      PR6I5000
.
. ------- print the alerts -------
.
PR6I2295  SUB       "301",FORM5             * get so first item is number 1
          PROC      PATPAOFS                * print alerts on front sheets
          GOTO      PR6I5000
.
. Display Religion Y/N
.
PR6I2296  MOVE      DNO,DIM3
          LOAD      DIM3,AVISIT,DYES,DNO
          IF        AVISIT=3
            MOVE      "UNK",DIM3
          ENDIF
          MOVE      DIM3,VARIABLE                        
          GOTO      PR6I5000
.
.------ format the associated doctors code ------
.
PR6I2297  MOVE      PTMIADOC,VARIABLE
          GOTO      PR6I5000
.
PR6I2298  MOVE      SP30,ADOCDESC            
          MATCH     SP6,PTMIADOC
          IF        !@EQUAL
            MOVE      PTMIADOC,KEY6
            CALL      RDDOCT1
            IF        OVRCD=0
              MOVE      DGNAME,ANS
              PACK      ADOCDESC,ANS,DOT,DSNAME
            ENDIF
          ENDIF
          MOVE      ADOCDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrars doctors code ------
.
PR6I2299  MOVE      PTMIREGS,VARIABLE
          GOTO      PR6I5000
.
PR6I2300  MOVE      SP30,ADOCDESC            
          MATCH     SP6,PTMIREGS
          IF        !@EQUAL
            MOVE      PTMIREGS,KEY6
            CALL      RDDOCT1
            IF        OVRCD=0
              MOVE      DGNAME,ANS
              PACK      ADOCDESC,ANS,DOT,DSNAME
            ENDIF
          ENDIF
          MOVE      ADOCDESC,VARIABLE
          GOTO      PR6I5000
.
. Display User Defined Y/N field 1
.
PR6I2301  MOVE      DNO,DIM3
          LOAD      DIM3,AVISIT,DYES,DNO
          MOVE      DIM3,VARIABLE                        
          GOTO      PR6I5000
.
. Display User Defined Y/N field 2
.
PR6I2302  MOVE      DNO,DIM3
          LOAD      DIM3,AVISIT,DYES,DNO
          MOVE      DIM3,VARIABLE                        
          GOTO      PR6I5000
.
.------ format the assoc. doctors surgury telephone number ------
.
PR6I2303  MOVE      SP20,DTELES
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DTELES,VARIABLE
          GOTO      PR6I5000
.
.------ format the assoc. doctors private telephone number ------
.
PR6I2304  MOVE      SP20,DTELEH
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DTELEH,VARIABLE
          GOTO      PR6I5000
.
.------ format the assoc. doctor address line 1 ------
.
PR6I2305  MOVE      SP30,DSADD1
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DSADD1,VARIABLE
          GOTO      PR6I5000
.
.------ format the assoc. doctor address line 2 ------
.
PR6I2306  MOVE      SP30,DSADD2
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DSADD2,VARIABLE
          GOTO      PR6I5000
.
.------ format the assoc doctor address line 3 ------
.
PR6I2307  MOVE      SP30,DSADD3
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DSADD3,VARIABLE
          GOTO      PR6I5000
.
.------ format the assoc doctors post code ------
.
PR6I2308  MOVE      SP30,DSPOST
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DSPOST,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctors surgury telephone number ------
.
PR6I2309  MOVE      SP20,DTELES
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DTELES,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctors private telephone number ------
.
PR6I2310  MOVE      SP20,DTELEH
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DTELEH,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctor address line 1 ------
.
PR6I2311  MOVE      SP30,DSADD1
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DSADD1,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctor address line 2 ------
.
PR6I2312  MOVE      SP30,DSADD2
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DSADD2,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctor address line 3 ------
.
PR6I2313  MOVE      SP30,DSADD3
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DSADD3,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctors post code ------
.
PR6I2314  MOVE      SP30,DSPOST
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DSPOST,VARIABLE
          GOTO      PR6I5000
.
PR6I2315  MOVE      PTMXCELL,VARIABLE          * cellular telephone
          GOTO      PR6I5000
.
PR6I2316  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "2",CONTTYPE          * Postal Address
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,VARIABLE          * Postal Address line 1
          ELSE
            MOVE      PTMXADD1,VARIABLE          * Postal Address line 1
          ENDIF
          GOTO      PR6I5000
.
PR6I2317  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "2",CONTTYPE          * Postal Address
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD2,VARIABLE          * Postal Address line 1
          ELSE
            MOVE      PTMXADD2,VARIABLE          * Postal Address line 2
          ENDIF
          GOTO      PR6I5000
.
PR6I2318  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "2",CONTTYPE          * Postal Address
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD3,VARIABLE          * Postal Address line 1
          ELSE
            MOVE      PTMXADD3,VARIABLE          * Postal Address line 3
          ENDIF
          GOTO      PR6I5000
.
PR6I2319  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "2",CONTTYPE          * Postal Address
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD4,VARIABLE          * Postal Address line 1
          ELSE
            MOVE      PTMXADD4,VARIABLE          * Postal Address line 4
          ENDIF
          GOTO      PR6I5000
.
PR6I2320  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "2",CONTTYPE          * Postal Address
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEPOST,VARIABLE          * Postal Address line 1
          ELSE
            MOVE      PTMXPOST,VARIABLE             * Postcode
          ENDIF
          GOTO      PR6I5000
.
PR6I2321  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP5,NHMAETH
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
          PACK      VARIABLE,NHMAETH,SP70,SP70     * Ethnicity code (NHI only)
          GOTO      PR6I5000
.
PR6I2322  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP5,NHMAETH
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
.
          MATCH     SP5,NHMAETH                   * Ethnicity desc (NHI only)
          IF        @EQUAL
            PACK      VARIABLE,SP70,SP70
            GOTO      PR6I5000
          ENDIF
.
          OPEN      NHIETHA1,"nhiethaf"
          MOVE      SP30,NHETDES
          PACK      KEY5,NHMAETH
          CALL      RDNHETH1
          PACK      VARIABLE,NHETDES,SP70,SP70
          GOTO      PR6I5000
.
PR6I2323  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP5,NHMAETH2
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
          PACK      VARIABLE,NHMAETH2,SP70,SP70     * Ethnicity code (NHI only)
          GOTO      PR6I5000
.
PR6I2324  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP5,NHMAETH2
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
.
          MATCH     SP5,NHMAETH2                  * Ethnicity desc (NHI only)
          IF        @EQUAL
            PACK      VARIABLE,SP70,SP70
            GOTO      PR6I5000
          ENDIF
.
          OPEN      NHIETHA1,"nhiethaf"
          MOVE      SP30,NHETDES
          PACK      KEY5,NHMAETH2
          CALL      RDNHETH1
          PACK      VARIABLE,NHETDES,SP70,SP70
          GOTO      PR6I5000
.
PR6I2325  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP5,NHMAETH3
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
          PACK      VARIABLE,NHMAETH3,SP70,SP70     * Ethnicity code (NHI only)
          GOTO      PR6I5000
.
PR6I2326  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP5,NHMAETH3
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
.
          MATCH     SP5,NHMAETH3                  * Ethnicity desc (NHI only)
          IF        @EQUAL
            PACK      VARIABLE,SP70,SP70
            GOTO      PR6I5000
          ENDIF
.
          OPEN      NHIETHA1,"nhiethaf"
          MOVE      SP30,NHETDES
          PACK      KEY5,NHMAETH3
          CALL      RDNHETH1
          PACK      VARIABLE,NHETDES,SP70,SP70
          GOTO      PR6I5000
.
PR6I2327  COMPARE   ONE,PTCNNHII                  * make sure NHI is ON
          GOTO      PR6ID100 IF NOT EQUAL
.
          MOVE      SP1,NHMARES
          OPEN      NHIMASA2,"nhimasaf"
          MOVE      PURNO,KEY8
          CALL      RDNHMAS2
.
          PACK      VARIABLE,SP70,SP70            * Resident Status (NHI only)
          MATCH     "Y",NHMARES
          IF        @EQUAL
            PACK      VARIABLE,DYES,SP70,SP70
          ENDIF
.
          MATCH     "N",NHMARES
          IF        @EQUAL
            PACK      VARIABLE,DNO,SP70,SP70
          ENDIF
          GOTO      PR6I5000
.
PR6I2328  MOVE      PTMXCHNM,VARIABLE          * chinese name       
          GOTO      PR6I5000
.
. ------- PMI HCP Practice Address details -------
.
PR6I2329  MOVE      "262",FORM3
          GOTO      PR6I2331
.
PR6I2330  MOVE      "364",FORM3
          GOTO      PR6I2331
.
PR6I2331  PACK      VARIABLE,SP70,SP70
          PACK      KEY10,PMPXRH1G,SP70
          MATCH     KEY10,SP70               * practice exists on pmspx2af?
          IF        @EQUAL
            PACK      KEY10,PMPXRHC1,SP70    * no practice so use hcp details
            MATCH     KEY10,SP70
            GOTO      PR6I5000 IF EQUAL
.
            CALL      RDPMHCP1
            BRANCH    OVRCD,PR6I5000
.
            SUB       FORM3,FORM5
            LOAD      VARIABLE,FORM5,PMHCADR1,PMHCADR2,PMHCADR3:
                                     PMHCADR4,PMHCPOST,PMHCSTEL:
                                     PMHCFAXN
          ELSE
            PACK      KEY12,KEY10,PMPXR1GC,SP70  * use practice details
            CALL      RDPMHCG1
            BRANCH    OVRCD,PR6I5000
.
            SUB       FORM3,FORM5
            LOAD      VARIABLE,FORM5,PMHGADD1,PMHGADD2,PMHGADD3:
                                     PMHGADD4,PMHGPOST,PMHGPTEL:
                                     PMHGPFAX
          ENDIF
          GOTO      PR6I5000
.
.------ format Referring HCP. address 1 (ADM Based) ------
.
PR6I2336  PACK      PMHCADR1,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR1,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. address 2 (ADM Based) ------
.
PR6I2337  PACK      PMHCADR2,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70 
          CALL      RDPMHCP1
          MOVE      PMHCADR2,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. address 3 (ADM Based) ------
.
PR6I2338  PACK      PMHCADR3,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR3,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. address 4 (ADM Based) ------
.
PR6I2339  PACK      PMHCADR4,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR4,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. postcode  (ADM Based) ------
.
PR6I2340  PACK      PMHCPOST,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCPOST,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. phone     (ADM Based) ------
.
PR6I2341  PACK      PMHCSTEL,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCSTEL,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. fax number(ADM Based) ------
.
PR6I2342  PACK      PMHCFAXN,SP30,SP30,SP20
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCFAXN,VARIABLE
          GOTO      PR6I5000
.
.-------- format previous surname --------------
.
PR6I2343  MOVE      PPSNAME,VARIABLE
          GOTO      PR6I5000
.
.-------- format NOK address 4 --------------
.
PR6I2344  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            PACK      VARIABLE,SP70,SP70
            MOVE      PMCEADD4,VARIABLE
          ELSE
            PACK      VARIABLE,SP70,SP70
            MOVE      PNKADD4,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.-------- format NOK address 4 --------------
.
PR6I2345  PACK      VARIABLE,SP70,SP70
          MOVE      PADD4,VARIABLE
          GOTO      PR6I5000
.
.-------- format PRA address 4 --------------
.
PR6I2346  PACK      VARIABLE,SP70,SP70
          MOVE      PKADD4,VARIABLE
          GOTO      PR6I5000
.
.-------- format Emergency Contact address 4 --------------
.
PR6I2347  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            PACK      VARIABLE,SP70,SP70
            MOVE      PMCEADD4,VARIABLE
          ELSE
            PACK      VARIABLE,SP70,SP70
            MOVE      PTMXECA4,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.-------- format Nearest Relative address 4 --------------
.
PR6I2348  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relatiave
            CALL      XCON0000              * Get extra contact details
            PACK      VARIABLE,SP70,SP70
            MOVE      PMCEADD4,VARIABLE
          ELSE
            PACK      VARIABLE,SP70,SP70
            MOVE      PTMXNRA4,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.-------- format Previous Admission Number --------------
.
PR6I2349  PACK      VARIABLE,SP70,SP70
          MOVE      PTMIPANO,VARIABLE
          GOTO      PR6I5000
.
.-------- format Previous Admission Date --------------
.
PR6I2350  PACK      VARIABLE,SP70,SP70
          UNPACK    PTMIPADT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          REP       " 0",CPCDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.---------format Admission Weight ----------------------
.
PR6I2351  PACK      VARIABLE,SP70,SP70
          MOVE      ABWGHT,VARIABLE  
          GOTO      PR6I5000
.
.-------- format Medicare Reference Number -------------
.
PR6I2352  PACK      VARIABLE,SP70,SP70
          MOVE      PTMXMCCD,VARIABLE
          GOTO      PR6I5000
.
.------ format Mothers FULL Name ---------
.
PR6I2353  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,PACSNAME 
            MOVE      PMCEGNAM,PACGNAME
            MOVE      PMCETITL,PACTITLE
          ELSE
            MOVE      PMPXMSNA,PACSNAME              * Mothers Details
            MOVE      PMPXMGNA,PACGNAME
            MOVE      PMPXMTLE,PACTITLE
          ENDIF
          MOVE      "1",PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------ format Mothers Surname  ---------
.
PR6I2354  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,VARIABLE
          ELSE
            MOVE      PMPXMSNA,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers First name  ---------
.
PR6I2355  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEGNAM,VARIABLE
          ELSE
            MOVE      PMPXMGNA,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Title  ---------
.
PR6I2356  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETITL,VARIABLE
          ELSE
            MOVE      PMPXMTLE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Address Line 1 ---------
.
PR6I2357  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,VARIABLE
          ELSE
            MOVE      PMPXMAD1,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Address Line 2 ---------
.
PR6I2358  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD2,VARIABLE
          ELSE
            MOVE      PMPXMAD2,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Address Line 3 ---------
.
PR6I2359  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD3,VARIABLE
          ELSE
            MOVE      PMPXMAD3,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Address Line 4 ---------
.
PR6I2360  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD4,VARIABLE
          ELSE
            MOVE      PMPXMAD4,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Post Code ---------
.
PR6I2361  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEPOST,VARIABLE
          ELSE
            MOVE      PMPXMPOS,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Privite Number ---------
.
PR6I2362  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELP,VARIABLE
          ELSE
            MOVE      PMPXMPNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Business Number ---------
.
PR6I2363  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELB,VARIABLE
          ELSE
            MOVE      PMPXMBNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Mobile Number ---------
.
PR6I2364  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELM,VARIABLE
          ELSE
            MOVE      PMPXMMNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers E-Mail ---------
.
PR6I2365  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEEMAI,VARIABLE
          ELSE
            MOVE      PMPXMEML,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Country of Birth ---------
.
PR6I2366  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            PACK      ACODE,PMCECONT,SP70
          ELSE
            PACK      ACODE,PMPXMCNT,SP70
          ENDIF
          PACK      TCODE,ANSC,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Mothers Correspondence ---------
.
PR6I2367  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MATCH     "1",PMCESLET
            IF        @EQUAL
              MOVE     DYES,VARIABLE
            ELSE
              MOVE     DNO,VARIABLE
            ENDIF
          ELSE
            MATCH     "1",PMPXMCRP
            IF        @EQUAL
              MOVE     DYES,VARIABLE
            ELSE
              MOVE     DNO,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Mothers Name on Labels ---------
.
PR6I2368  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE     SP70,VARIABLE
          ELSE
            MATCH     "1",PMPXMLAB
            IF        @EQUAL
              MOVE     DYES,VARIABLE
            ELSE
              MOVE     DNO,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Relationship to Patient  --------
.
PR6I2369  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "4",CONTTYPE          * Mother
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCERELP,VARIABLE
          ELSE
            MOVE      PMPXMREL,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers FULL Name  --------
.
PR6I2370  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,PACSNAME
            MOVE      PMCEGNAM,PACGNAME
            MOVE      PMCETITL,PACTITLE
          ELSE
            MOVE      PMPXFSNA,PACSNAME              * Fathers Details
            MOVE      PMPXFGNA,PACGNAME
            MOVE      PMPXFTLE,PACTITLE
          ENDIF
          MOVE      "1",PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------ format Fathers Surname  --------
.
PR6I2371  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCESNAM,VARIABLE
          ELSE
            MOVE      PMPXFSNA,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers First Name  --------
.
PR6I2372  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEGNAM,VARIABLE
          ELSE
            MOVE      PMPXFGNA,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Title  --------
.
PR6I2373  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETITL,VARIABLE
          ELSE
            MOVE      PMPXFTLE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Adress Line 1  --------
.
PR6I2374  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD1,VARIABLE
          ELSE
            MOVE      PMPXFAD1,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Adress Line 2  --------
.
PR6I2375  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD2,VARIABLE
          ELSE
            MOVE      PMPXFAD2,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Adress Line 3  --------
.
PR6I2376  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD3,VARIABLE
          ELSE
            MOVE      PMPXFAD3,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Adress Line 4  --------
.
PR6I2377  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEADD4,VARIABLE
          ELSE
            MOVE      PMPXFAD4,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Post Code  --------
.
PR6I2378  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEPOST,VARIABLE
          ELSE
            MOVE      PMPXFPOS,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Privite Number  --------
.
PR6I2379  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELP,VARIABLE
          ELSE
            MOVE      PMPXFPNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Busines Number  --------
.
PR6I2380  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELB,VARIABLE
          ELSE
            MOVE      PMPXFBNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Mobile Number  --------
.
PR6I2381  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELM,VARIABLE
          ELSE
            MOVE      PMPXFMNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers E-Mail  --------
.
PR6I2382  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEEMAI,VARIABLE
          ELSE
            MOVE      PMPXFEML,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Country of birth  --------
.
PR6I2383  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            PACK      ACODE,PMCECONT,SP70
          ELSE
            PACK      ACODE,PMPXFCNT,SP70
          ENDIF
          PACK      TCODE,ANSC,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Fathers Correspondence  --------
.
PR6I2384  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MATCH     "1",PMCESLET
            IF        @EQUAL
              MOVE     DYES,VARIABLE
            ELSE
              MOVE     DNO,VARIABLE
            ENDIF
          ELSE
            MATCH     "1",PMPXFCRP
            IF        @EQUAL
              MOVE     DYES,VARIABLE
            ELSE
              MOVE     DNO,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Name on labels  --------
.
PR6I2385  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      SP70,VARIABLE
          ELSE
            MATCH     "1",PMPXFLAB
            IF        @EQUAL
              MOVE     DYES,VARIABLE
            ELSE
              MOVE     DNO,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Fathers Relationship to Patient  --------
.
PR6I2386  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "5",CONTTYPE          * Father
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCERELP,VARIABLE
          ELSE
            MOVE      PMPXFREL,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format DVA Card Colour (DX)  --------
.
PR6I2387  MOVE      THREE,DIM1
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDDVAC
          IF        !@EQUAL & !@EOS
            PACK      KEY5,ANSD,ANSX,PMCDDVAC,SP10
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF 
          GOTO      PR6I5000
.
.------ format Aboriginality (VA)  --------
.
PR6I2388  PACK      TCODE,ANSV,ANSA,SP70
          PACK      ACODE,PMPXABRG,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Privacy (PV)  --------
.
PR6I2389  PACK      TCODE,ANSP,ANSV,SP70
          PACK      ACODE,PMPXPRVI,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Aboriginality (VA) PRS/2  --------
.
PR6I2390  PACK      TCODE,ANSV,ANSA,SP70
          PACK      ACODE,PMPXABRG,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Admission Criteria PRS/2  --------
.
PR6I2391  PACK      TCODE,ANSV,ANSB,SP70
          PACK      ACODE,PMVXCADM,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Intention to readmit PRS/2  --------
.
PR6I2392  PACK      TCODE,ANSV,ANSR,SP70
          PACK      ACODE,PMVXIRAD,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Intended stay duration PRS/2  --------
.
PR6I2393  PACK      TCODE,ANSV,ANSI,SP70
          PACK      ACODE,PMVXIDUS,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Carer Availability PRS/2  --------
.
PR6I2394  PACK      TCODE,ANSV,ANSK,SP70
          PACK      ACODE,PMVXCRAV,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Crit care Xref PRS/2  --------
.
PR6I2395  PACK      TCODE,ANSV,ANSJ,SP70
          PACK      ACODE,PMVXRCCT,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Admitting point ward   --------
.
PR6I2396  MATCH     SP70,PMVXAPWD
          IF        @EQUAL
            MOVE      SP70,VARIABLE
            GOTO      PR6I5000
          ENDIF
.
          PACK      KEY6,PMVXAPWD,PMVXAPBD
          CALL      RDWARD1
          IF        OVRCD = 0
            MOVE     WBDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Admitting point bed   --------
.
PR6I2397  MOVE      PMVXAPBD,VARIABLE
          GOTO      PR6I5000
.
.------ format Current Date  --------
.
PR6I2398  CALL      IBACLOCK
          MOVE      CCC,CCENT
          MOVE      CYY,CYEAR
          MOVE      CMM,CMON
          MOVE      CDD,CDAY
          CALL      PACDATE
          MOVE      CPDATE,VARIABLE
          GOTO      PR6I5000
.
.------ format Web user ID --------
.
PR6I2399  MOVE      IBLPRUID,VARIABLE
          GOTO      PR6I5000
.
.------ format baptised --------
.
PR6I2400  MOVE      DNO,DIM3
          LOAD      DIM3,PUYN1,DYES
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
.------ format Account Classification --------
.
PR6I2401  MOVE      "      ",VARIABLE
          GOTO      PR6I5000
.
.------ format Insurance Level --------
.
PR6I2402  MOVE      AFNDTB,VARIABLE
          GOTO      PR6I5000
.
.------ format Medicare Suffix --------
.
PR6I2403  MOVE      "      ",VARIABLE
          GOTO      PR6I5000
.
.------ format Medicare Expiry Date  --------
.
PR6I2404  UNPACK    PMPXMEDC,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPDATE,VARIABLE
          GOTO      PR6I5000
.
.------ format Consent Release of Info --------
.
PR6I2405  MATCH     "1",PMPXCRIN
          IF        @EQUAL
            MOVE      "YES",VARIABLE
          ELSE
            MOVE      "NO",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Prefered Language (LA)  --------
.
PR6I2406  PACK      TCODE,ANSL,ANSA,SP70
          PACK      ACODE,PMPXLNG1,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format UNIT (AC)  --------
.
PR6I2407  PACK      TCODE,ANSA,ANSC,SP70
          PACK      ACODE,ACLSSFT,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Interpreter Required  --------
.
PR6I2408  MATCH     "1",PMPXINTR
          IF        @EQUAL
            MOVE      "YES",VARIABLE
          ELSE
            MATCH     "0",PMPXINTR
            IF        @EQUAL
              MOVE      "NO",VARIABLE
            ELSE
              MOVE      "NOT STATED",VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Admitting Proc (MBS) --------
.
PR6I2409  MOVE      AMBS,VARIABLE
          GOTO      PR6I5000
.
.------ format Admitting Proc Description (MBS) --------
.
PR6I2410  PACK      KEY17,AMBS,SP70
          CALL      PATITMRD
          IF        OVRCD = 1
            MOVE      SP70,VARIABLE
            GOTO      PR6I5000 
          ENDIF 
          MOVE      IDESC,VARIABLE
          GOTO      PR6I5000

.
.------ format Death --------
.
PR6I2411  COMPARE   "1",PCEASE
          IF        @EQUAL
            MOVE      "YES",VARIABLE
          ELSE
            MOVE      "NO ",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Date of Death ------
.
PR6I2412  PACK      VARIABLE,SP70
          MATCH     SP70,PDECDTE
          GOTO      PR6I1000 IF EQUAL
          UNPACK    PDECDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Doctor Head of Unit ------
.
PR6I2413  PACK      VARIABLE,SP70
          MOVE      SP30,HDOCDESC            * Attending Doctor
.
          PACK      KEY10,ACLSSFT,ONE,SP70
          CALL      RSPMDUN2
          CALL      RKPMDUN2
          BRANCH    OVRCD,PR6I5000
. 
          MATCH     ACLSSFT,PMDUUNIT
          GOTO      PR6I5000 IF NOT EQUAL
.
          MATCH     "1",PMDUHEAD
          GOTO      PR6I5000 IF NOT EQUAL
.
          PACK      KEY6,PMDUDOCT,SP70
          CALL      RDDOCT1
          BRANCH    OVRCD,PR6I5000
.
          MOVE      DGNAME,ANS
          PACK      HDOCDESC,ANS,DOT,DSNAME
          MOVE      HDOCDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Provisional Diagnosis ------
.
PR6I2414  PACK      VARIABLE,SP70
.
          MATCH     SP70,PMVXPICD
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PMVXPICD,KEY9
          CALL      RDICD1
          BRANCH    OVRCD,PR6I5000
          PACK      VARIABLE,LBRACK,PMVXPICD,RBRACK,DDESC
          GOTO      PR6I5000
.
.------- Facility Name ------------
.
PR6I2415  PACK      VARIABLE,SP70
          MOVE      CHADD1,VARIABLE
          GOTO      PR6I5000
.
.------- MBS item Number ----------
.
PR6I2416  PACK      KEY11,AADMNO,SP10
          CALL      RDSMMBS1
          CALL      RDKMMBS1
.
          MATCH     AADMNO,MMADMN
          GOTO      PR6I5000 IF NOT EQUAL
          PACK      VARIABLE,MMCODE,SP70
          GOTO      PR6I5000
.
.------- Theatre Time Start -------
.
PR6I2417  PACK      KEY11,AADMNO,SP10
          CALL      RDSMMBS1
          CALL      RDKMMBS1
.
          MATCH     AADMNO,MMADMN
          GOTO      PR6I5000 IF NOT EQUAL
.
          PACK      VARIABLE,MMSTIM,SP70
          GOTO      PR6I5000
.
.------- Theatre Time END -------
.
PR6I2418  PACK      KEY11,AADMNO,SP10
          CALL      RDSMMBS1
          CALL      RDKMMBS1
.
          MATCH     AADMNO,MMADMN
          GOTO      PR6I5000 IF NOT EQUAL
.
          PACK      VARIABLE,MMETIM,SP70
          GOTO      PR6I5000

.
.------ format Web user ID Name --------
.
PR6I2419  MOVE      SP70,WBSENAM
          MOVE      IBLPRUID,KEY10
          CALL      RDWBSE1

          MOVE      WBSENAM,VARIABLE
          GOTO      PR6I5000
.
.------ format Doctors Title --------
.
PR6I2420  MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DTITL,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ format Doctors Given Name --------
.
PR6I2421  MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DGNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ format Doctors Surname Name --------
.
PR6I2422  MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DSNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ format Ward --------
.
PR6I2423  MOVE      AWARD,VARIABLE           * Ward - not Pre-adm
          GOTO      PR6I5000
.
.------ BPAY Reference Number--------                                   *I-48227
.
PR6I2424  MOVE      SP70,BPAYINVN            * display blank for id sheets
.
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS   * Multi Hospital
          IF        IBCNMHOS=1
            PACK      KEY8,AADMNO,SP70
            OPEN      PMSVX1A1,"pmsvx1af"
            CALL      RDPMVX11
            IF        OVRCD=0
              MOVE      PMVXMHOS,BPAYHOSP
            ENDIF
          ENDIF
.
          READ      CONTROLF,HUND18;*249,PTCNURBP  * Use UR number as BPAYINVN?
          MATCH     "1",PTCNURBP
          IF        @EQUAL
            MOVE      PURNO,BPAYINVN        * use UR number
          ENDIF
.
          CALL      GBCRN000
          MOVE      BPAYREFN,VARIABLE
          GOTO      PR6I5000
.
.------ Local GP Practice Email Address
.
PR6I2425  PACK      PMHCSEML,SP70,SP70
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCSEML,VARIABLE
          GOTO      PR6I5000
.
.------ Local GP Preferred Method of Contact code (Cat CZ)
.
PR6I2426  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXRHC1
          IF        !@EQUAL
            PACK      KEY10,PMPXRHC1,SP70
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCPRFC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.-------- Local GP Preferred Method of Contact description (Cat CZ)
.
PR6I2427  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXRHC1
          IF        !@EQUAL
            PACK      KEY10,PMPXRHC1,SP70
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MATCH     SP70,PMHCPRFC
              IF        !@EQUAL & !@EOS
                PACK      KEY5,ANSC,ANSZ,PMHCPRFC,SP10
                CALL      RDCODE1
                IF        OVRCD = 0
                  MOVE      TDESC,VARIABLE
                ENDIF
              ENDIF
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.-------- Local GP First Name --------
.
PR6I2428  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXRHC1
          IF        !@EQUAL
            PACK      KEY10,PMPXRHC1,SP70
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCGNAM,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.-------- Local GP Surname --------
.
PR6I2429  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXRHC1
          IF        !@EQUAL
            PACK      KEY10,PMPXRHC1,SP70
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCSNAM,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Registered HCP. Title Given Name Surname(PMI Based) ------
.
PR6I2430  PACK      PACFNAME,SP30,SP30,SP20
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      ONE,PACFRMT
            CALL      PACNAME
          ENDIF
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------- Workers Compensation Details-------
.
PR6I2431  CALL      GPWC1000
          BRANCH    EXIT,PR6I6000
          GOTO      PR6I5000
.
.------- Next of Kin Mobile Number-------
.
PR6I2432  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELM,VARIABLE
          ELSE
            MOVE      PMPXKMOB,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------- Next of Kin Email Address-------
.
PR6I2433  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEEMAI,VARIABLE
          ELSE
            MOVE      PMPXKEML,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------- Emergency Contact Mobile Number-------
.
PR6I2434  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELM,VARIABLE
          ELSE
            MOVE      PMPXCMOB,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------- Emergency Contact Email Address-------
.
PR6I2435  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "3",CONTTYPE          * Emergency Contact
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEEMAI,VARIABLE
          ELSE
            MOVE      PMPXCEML,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------- Nearest Relative Mobile Number-------
.
PR6I2436  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative 
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCETELM,VARIABLE
          ELSE
            MOVE      PMPXRMOB,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------- Nearest Relative Email Address-------
.
PR6I2437  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "8",CONTTYPE          * Nearest Relative
            CALL      XCON0000              * Get extra contact details
            MOVE      PMCEEMAI,VARIABLE
          ELSE
            MOVE      PMPXREML,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------- Aboriginality Code -------
.
PR6I2438  MOVE      PMPXABRG,VARIABLE
          GOTO      PR6I5000
.
.------- Singapore HRN -------
.
PR6I2439  PACK      D8,SP70
          PROC      GETALTID
          GOTO      PR6I5000
.
.------- NZ private approval number -------
.
PR6I2440  CALL      GETNZP00
          MOVE      NZSPAPRV,VARIABLE
          GOTO      PR6I5000
.
.------- NZ private claim number -------
.
PR6I2441  CALL      GETNZP00
          MOVE      NZSPCLNO,VARIABLE
          GOTO      PR6I5000
.
.------- Next of Kin Relation Description -------
.
PR6I2442  MATCH     "1",PTCNNEWC
          IF        @EQUAL
            MOVE      "1",CONTTYPE          * Next of Kin
            CALL      XCON0000              * Get extra contact details
            PACK      KEY10,PMCERELP,SP10
          ELSE
            PACK      KEY10,PNKRELP,SP10
          ENDIF
          CALL      RDPMREL1
          IF        OVRCD=1
            MOVE      KEY10,PMRLDESC
          ENDIF
          MOVE      PMRLDESC,VARIABLE
          GOTO      PR6I5000
.
.------- Title Description -------
.
PR6I2443  PACK      KEY4,PTITL,SP10
          CALL      RDPMTLE1
          IF        OVRCD=1
            MOVE      PTITL,PMTLDESC
          ENDIF
          MOVE      PMTLDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- ward description -------
.
PR6I2444  COMPARE   ONE,ASTAT                * Ward - check for pre-adm
          GOTO      PR6I2445 IF NOT EQUAL
          PACK      KEY6,PTMIXWRD,SP6        * Use Expected Ward for Pre-Adm.
          GOTO      PR6I2446
.
PR6I2445  PACK      KEY6,AWARD,SP70
PR6I2446  CALL      RDWARD1
          BRANCH    OVRCD,PR6I5000
          PACK      VARIABLE,WBDESC,SP30,SP30,SP30
          GOTO      PR6I5000
.
.------ format the attending doctor address line 4 ------             *I-125736
.
PR6I2515  MOVE      SP35,DSADD4
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          MOVE      DSADD4,VARIABLE
          GOTO      PR6I5000
.
.------ format address 4 of referring doctor ------                   *I-125736
.
PR6I2516  PACK      DSADD4,SP20,SP20
          IF        CRDRTYP <> 1
            MOVE      ADOCTR,KEY6
            CALL      RDDOCT1               * Read doctors file
          ENDIF
          MOVE      DSADD4,VARIABLE
          GOTO      PR6I5000
.
.------ format the assoc. doctor address line 4 ------                *I-125736
.
PR6I2517  MOVE      SP30,DSADD4
          MOVE      PTMIADOC,KEY6
          CALL      RDDOCT1
          MOVE      DSADD4,VARIABLE
          GOTO      PR6I5000
.
.------ format the registrar doctor address line 4 ------             *I-125736
.
PR6I2518  MOVE      SP30,DSADD4
          MOVE      PTMIREGS,KEY6
          CALL      RDDOCT1
          MOVE      DSADD4,VARIABLE
          GOTO      PR6I5000
.
PR6I2519  CALL      GCCSJG00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      PR6I5000
.
PR6I2520  CALL      GCCSJG00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PR6I2521  CALL      GCCSJG00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
PR6I2522  CALL      GCCSJG00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2523  MOVE      CODEEG,TCODE
          PACK      ACODE,PTELCDON,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.           
PR6I2524  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELCMPL,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
.PR6I2525  UNPACK    PTELRDAT,CCENT,CYEAR,CMON,CDAY
.          CALL      PACDATE
.          MOVE      CPCDATE,VARIABLE
.          GOTO      PR6I5000
.
PR6I2525  MATCH     PTELRDAT,SP70
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
          UNPACK    PTELRDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      ZERO,F2
          MOVE      CMON,F2
          MOVE      SP70,MTHNAM3
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      VARIABLE,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PR6I5000
.
PR6I2526  MOVE      PTELHFRN,VARIABLE
          GOTO      PR6I5000
.
PR6I2527  MOVE      PTELPTHF,VARIABLE
          GOTO      PR6I5000
.
.PR6I2528  UNPACK    AFNDCG,CCENT,CYEAR,CMON
.          MOVE      "01",CDAY
.          CALL      PACDATE
.          MOVE      CPCDATE,VARIABLE
.          GOTO      PR6I5000
.
PR6I2528  MATCH     AFNDCG,SP70
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
          UNPACK    AFNDCG,CCENT,CYEAR,CMON
          MATCH     CMON,SP70
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
          MOVE      ZERO,F2
          MOVE      CMON,F2
          MOVE      SP70,MTHNAM3
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      VARIABLE,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PR6I5000
.
PR6I2529  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELSPEA,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2530  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELXCLS,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2531  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELFINC,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2532  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELCOVR,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2533  MOVE      PTELPPRI,VARIABLE
          GOTO      PR6I5000
.
PR6I2534  MOVE      PTELPPUT,VARIABLE
          GOTO      PR6I5000
.
PR6I2535  MOVE      PTELPSHA,VARIABLE
          GOTO      PR6I5000
.
PR6I2536  MOVE      PTELPSUT,VARIABLE
          GOTO      PR6I5000
.
PR6I2537  MOVE      PTELPTHE,VARIABLE
          GOTO      PR6I5000
.
PR6I2538  MOVE      PTELPTUT,VARIABLE
          GOTO      PR6I5000
.
PR6I2539  MOVE      PTELXCSS,VARIABLE
          GOTO      PR6I5000
.
PR6I2540  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELQEXS,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2541  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELQACC,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2542  MOVE      PTELECMN,VARIABLE
          GOTO      PR6I5000
.
PR6I2543  MOVE      PTELXCMN,VARIABLE
          GOTO      PR6I5000
.
PR6I2544  MOVE      SP70,PMAEQUOT
          PACK      KEY20,ADMISSNO,SP70
          CALL      RSPMAEL1
          CALL      RKPMAEL1
          BRANCH    OVRCD,PR6I5000
.
          MATCH     ADMISSNO,PMAEVISN
          GOTO      PR6I5000 IF NOT EQUAL
.
          MOVE      PMAEQUOT,VARIABLE
          GOTO      PR6I5000
.
PR6I2545  MOVE      PTELHSTM,VARIABLE
          GOTO      PR6I5000 
.
PR6I2546  MOVE      PTELHFPN,VARIABLE
          GOTO      PR6I5000
.
PR6I2547  MOVE      PTELPSDY,VARIABLE
          GOTO      PR6I5000
.
PR6I2548  MOVE      PTELPSDU,VARIABLE
          GOTO      PR6I5000
.
PR6I2549  MOVE      PTELPHSU,VARIABLE
          GOTO      PR6I5000
.
PR6I2550  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELAFRM,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2551  MOVE      DNO,DIM3
          MOVE      ZERO,FORM1
          MOVE      PTELQLPS,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      DIM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2552  MOVE      PMPXPEML,VARIABLE
          GOTO      PR6I5000
.
PR6I2553  MOVE      PMFIFINO,VARIABLE
          GOTO      PR6I5000
.
PR6I2554  MOVE      PMFIUNIQ,VARIABLE
          GOTO      PR6I5000
.
PR6I2555  MOVE      PMFIURNO,VARIABLE
          GOTO      PR6I5000
.
PR6I2556  MOVE      PMFIADMN,VARIABLE
          GOTO      PR6I5000
.
PR6I2557  UNPACK    PMFIADAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2558  MOVE      PMFISTAY,VARIABLE
          GOTO      PR6I5000
.
PR6I2559  UNPACK    PMFIEDDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE  
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2560  MOVE      CODECL,TCODE
          PACK      ACODE,PMFICLTY,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6I2561  MOVE      SP30,HFNAME              * Health fund
          MATCH     SP6,PMFIHFND
          IF        !@EQUAL
            PACK      KEY14,PMFIHFND,ZERO4,SP10
            CALL      RDFUND1
          ENDIF
          MOVE      HFNAME,VARIABLE
          GOTO      PR6I5000
.
PR6I2562  MOVE      SP30,HFNAME              * Health Fund table
          MATCH     SP8,PMFIHFTB
          IF        !@EQUAL
            PACK      KEY14,PMFIHFND,PMFIHFTB,SP10
            CALL      RDFUND1
          ENDIF
          MOVE      HFNAME,VARIABLE
          GOTO      PR6I5000
.
PR6I2563  MOVE      PMFISGAM,VARIABLE
          GOTO      PR6I5000
.
PR6I2564  MOVE      PMFIAGAM,VARIABLE
          GOTO      PR6I5000
.
PR6I2565  MOVE      PMFIANGA,VARIABLE
          GOTO      PR6I5000
.
PR6I2566  MOVE      PMFIPHYI,VARIABLE
          GOTO      PR6I5000
.
PR6I2567  MOVE      PMFIPHYS,VARIABLE
          GOTO      PR6I5000
.
PR6I2568  MOVE      PMFIXRAY,VARIABLE
          GOTO      PR6I5000
.
PR6I2569  MOVE      PMFISPLB,VARIABLE
          GOTO      PR6I5000
.
PR6I2570  MOVE      PMFIMISC,VARIABLE
          GOTO      PR6I5000
.
PR6I2571  MOVE      PMFIPHAR,VARIABLE
          GOTO      PR6I5000
.
PR6I2572  MOVE      PMFIPROS,VARIABLE
          GOTO      PR6I5000
.
PR6I2573  MOVE      PMFIHEXC,VARIABLE
          GOTO      PR6I5000
.
PR6I2574  MOVE      PMFIFAST,VARIABLE
          GOTO      PR6I5000
.
PR6I2575  MOVE      PMFIDEDT,VARIABLE
          GOTO      PR6I5000
.
PR6I2576  PACK      PMHGPNAM,SP30
          PACK      KEY12,PMFIEANP,SP1,ONE
          CALL      RDPMHCG1
          MOVE      PMHGPNAM,VARIABLE
          GOTO      PR6I5000
.
PR6I2577  PACK      IDESC,SP70
          PACK      KEY17,PMFITHF1,SP70
          CALL      PATITMRD
          IF        OVRCD<>1
            MOVE      IDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2578  PACK      IDESC,SP70
          PACK      KEY17,PMFITHF2,SP70
          CALL      PATITMRD     
          IF        OVRCD<>1
            MOVE      IDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2579  PACK      IDESC,SP70
          PACK      KEY17,PMFITHF3,SP70
          CALL      PATITMRD
          IF        OVRCD<>1
            MOVE      IDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2580  PACK      IDESC,SP70
          PACK      KEY17,PMFITHF4,SP70
          CALL      PATITMRD
          IF        OVRCD<>1
            MOVE      IDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2581  PACK      IDESC,SP70
          PACK      KEY17,PMFITHF5,SP70
          CALL      PATITMRD
          IF        OVRCD<>1
            MOVE      IDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2582  PACK      IDESC,SP70
          PACK      KEY17,PMFITHF6,SP70
          CALL      PATITMRD
          IF        OVRCD<>1
            MOVE      IDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2583  PACK      MDESC,SP70
          MOVE      PTCNDCLM,MCLMCOD
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY29,MCLMCOD,SP6,SP3,PMFIMCC1,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          COMPARE   ZERO,EXIT
          IF        @EQUAL
            MOVE      MDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2584  PACK      MDESC,SP70
          MOVE      PTCNDCLM,MCLMCOD
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY29,MCLMCOD,SP6,SP3,PMFIMCC2,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          COMPARE   ZERO,EXIT
          IF        @EQUAL
            MOVE      MDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2585  PACK      MDESC,SP70
          MOVE      PTCNDCLM,MCLMCOD
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY29,MCLMCOD,SP6,SP3,PMFIMCC2,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          COMPARE   ZERO,EXIT
          IF        @EQUAL
            MOVE      MDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2586  MOVE      CODEBT,TCODE
          PACK      ACODE,PMFIBTYP,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6I2587  MOVE      CODEA,TCODE
          PACK      ACODE,PMFIATYP,SP3
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6I2588  MATCH     "1",PMFIAGST
          IF        @EQUAL
            MOVE      YES,VARIABLE
          ELSE
            MOVE      NO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2589  MOVE      PMFIECOS,VARIABLE
          GOTO      PR6I5000
.
PR6I2590  MOVE      PMFITPOA,VARIABLE
          GOTO      PR6I5000
.
PR6I2591  MOVE      PMFIEACP,VARIABLE
          GOTO      PR6I5000
.
PR6I2592  MOVE      PMFIEACH,VARIABLE
          GOTO      PR6I5000
.
PR6I2593  MOVE      PMFIETCP,VARIABLE
          GOTO      PR6I5000
.
PR6I2594  MOVE      PMFIETCH,VARIABLE
          GOTO      PR6I5000
.
PR6I2595  MOVE      PMFIEMCP,VARIABLE
          GOTO      PR6I5000
.
PR6I2596  MOVE      PMFIEMCH,VARIABLE
          GOTO      PR6I5000
.
PR6I2597  MOVE      PMFIQUA1,VARIABLE
          GOTO      PR6I5000
.
PR6I2598  MOVE      PMFIQUA2,VARIABLE
          GOTO      PR6I5000
.
PR6I2599  MOVE      PMFIQUA3,VARIABLE
          GOTO      PR6I5000
.
PR6I2600  MOVE      PMFITHQ1,VARIABLE
          GOTO      PR6I5000
.
PR6I2601  MOVE      PMFITHQ2,VARIABLE
          GOTO      PR6I5000
.
PR6I2602  MOVE      PMFITHQ3,VARIABLE
          GOTO      PR6I5000
.
PR6I2603  MOVE      PMFITHQ4,VARIABLE
          GOTO      PR6I5000
.
PR6I2604  MOVE      PMFITHQ5,VARIABLE
          GOTO      PR6I5000
.
PR6I2605  MOVE      PMFITHQ6,VARIABLE
          GOTO      PR6I5000
.
PR6I2606  MOVE      PMFIITG1,VARIABLE
          GOTO      PR6I5000
.
PR6I2607  MOVE      PMFIITG2,VARIABLE
          GOTO      PR6I5000
.
PR6I2608  MOVE      PMFIITG3,VARIABLE
          GOTO      PR6I5000
.
PR6I2609  MOVE      PMFITHG1,VARIABLE
          GOTO      PR6I5000
.
PR6I2610  MOVE      PMFITHG2,VARIABLE
          GOTO      PR6I5000
.
PR6I2611  MOVE      PMFITHG3,VARIABLE
          GOTO      PR6I5000
.
PR6I2612  MOVE      PMFITHG4,VARIABLE
          GOTO      PR6I5000
.
PR6I2613  MOVE      PMFITHG5,VARIABLE
          GOTO      PR6I5000
.
PR6I2614  MOVE      PMFITHG6,VARIABLE
          GOTO      PR6I5000
.
PR6I2615  UNPACK    PMFICDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2616  MOVE      PMFICTIM,VARIABLE
          GOTO      PR6I5000
.
PR6I2617  PACK      WBSENAM,SP70
          MOVE      PMFICUID,KEY10
          CALL      RDWBSE1
          IF        OVRCD<>1
            MOVE      WBSENAM,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2618  MOVE      PMVXUDF1,VARIABLE
          GOTO      PR6I5000
.
PR6I2619  MOVE      PMVXUDF2,VARIABLE
          GOTO      PR6I5000
.
PR6I2620  MOVE      PMVXUDF3,VARIABLE
          GOTO      PR6I5000
.
PR6I2621  MOVE      PMVXUDF4,VARIABLE
          GOTO      PR6I5000
.
PR6I2622  UNPACK    PMVXUDT1,CCENT,CYEAR,CMON,CDAY,DIM5
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP1,DIM5,SP70
          GOTO      PR6I5000
.
PR6I2623  UNPACK    PMVXUDT2,CCENT,CYEAR,CMON,CDAY,DIM5
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP1,DIM5,SP70
          GOTO      PR6I5000
.
PR6I2624  UNPACK    PMVXUDT3,CCENT,CYEAR,CMON,CDAY,DIM5
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP1,DIM5,SP70
          GOTO      PR6I5000
.
PR6I2625  UNPACK    PMVXUDT4,CCENT,CYEAR,CMON,CDAY,DIM5
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP1,DIM5,SP70
          GOTO      PR6I5000
.
PR6I2626  UNPACK    PMVXUDT5,CCENT,CYEAR,CMON,CDAY,DIM5
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP1,DIM5,SP70
          GOTO      PR6I5000
.
PR6I2627  UNPACK    PMVXUDT6,CCENT,CYEAR,CMON,CDAY,DIM5
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP1,DIM5,SP70
          GOTO      PR6I5000
.
PR6I2628  PACK      OPDADATE,SP70
          PACK      KEY31,ADMISSNO,SP70
          CALL      RSOPDEA2
          CALL      RKOPDEA2
          BRANCH    OVRCD,PR6I5000
.
          MATCH     ADMISSNO,OPDAADMN
          GOTO      PR6I5000 IF NOT EQUAL
.
          UNPACK    OPDADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP70
          GOTO      PR6I5000
.
PR6I2629  PACK      OPDATIME,SP70
          PACK      KEY31,ADMISSNO,SP70
          CALL      RSOPDEA2
          CALL      RKOPDEA2
          BRANCH    OVRCD,PR6I5000
.
          MATCH     ADMISSNO,OPDAADMN
          GOTO      PR6I5000 IF NOT EQUAL
.
          PACK      VARIABLE,OPDATIME,SP70
          GOTO      PR6I5000
.
PR6I2630  PACK      PMWOEDAT,SP70
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDPMWOR1
          BRANCH    OVRCD,PR6I5000
.
          UNPACK    PMWOEDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP70
          GOTO      PR6I5000
.
PR6I2631  PACK      PMWOEDTM,SP70
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDPMWOR1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PMWOEDTM,SP70
          GOTO      PR6I5000
.
PR6I2632  MATCH     "1",PMVXINGP                * Inform GP Yes / No
          IF        @EQUAL
            MOVE     DYES,VARIABLE
          ELSE
            MOVE     DNO,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2633  MOVE      ADOCTT,VARIABLE              * Treating Doctor Code 
          GOTO      PR6I5000
.
PR6I2634  PACK      KEY6,ADOCTT,SP70             * Treating Doctor Title
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DTITL,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
PR6I2635  PACK      KEY6,ADOCTT,SP70             * Treating Doctor Given Name
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DGNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
PR6I2636  PACK      KEY6,ADOCTT,SP70             * Treating Doctor Surname
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DSNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
PR6I2637  PACK      KEY6,ADOCTT,SP70             * Treating Doctor Formatted
          CALL      RDDOCT1                      * Name
          IF        OVRCD=0
            MOVE      DGNAME,ANS
            PACK      VARIABLE,ANS,DOT,DSNAME
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
PR6I2638  CLOCK      TIME,VARIABLE               * Current Time
          GOTO       PR6I5000
.
.------ format Doctors Title --------
.
PR6I2639  MOVE      ADOCTR,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DTITL,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ format Doctors Given Name --------
.
PR6I2640  MOVE      ADOCTR,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DGNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ format Doctors Surname Name --------
.
PR6I2641  MOVE      ADOCTR,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DSNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ Health Fund Code --------
.
PR6I2642  MOVE       AFUNDH,VARIABLE
          GOTO       PR6I5000
.
.------ Secondary Doctor Code --------
.
PR6I2643  MOVE       PMVXEDC1,VARIABLE
          GOTO       PR6I5000
.
.------ Secondary Doctor Title --------
.
PR6I2644  MOVE      PMVXEDC1,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DTITL,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE 
          GOTO       PR6I5000
.
.------ Secondary Doctor Given Name --------
.
PR6I2645  MOVE      PMVXEDC1,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DGNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ Secondary Doctor Surname --------
.
PR6I2646  MOVE      PMVXEDC1,KEY6
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DSNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE       SP70,VARIABLE
          GOTO       PR6I5000
.
.------ Secondary Doctor Formatted Name --------
.
PR6I2647  MATCH     SP6,PMVXEDC1             * Secondary Doctor
          IF        @EQUAL
            MOVE       SP70,VARIABLE
            GOTO       PR6I5000
          ENDIF
          PACK      KEY6,PMVXEDC1,SP70
          CALL      RDDOCT1
          IF        OVRCD=1
            MOVE       SP70,VARIABLE
            GOTO       PR6I5000
          ENDIF
          MOVE      DGNAME,ANS
          PACK      ADOCDESC,ANS,DOT,DSNAME
.
          MOVE      ADOCDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Secondary Doctor Unit --------
.
PR6I2648  PACK      TCODE,ANSA,ANSC,SP70
          PACK      ACODE,PMVXEDU1,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Secondary Doctor Work Phone --------
.
PR6I2649  PACK      KEY6,PMVXEDC1,SP70
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DTELES,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE      SP70,VARIABLE
          GOTO      PR6I5000
.
.------ Secondary Doctor Home Phone -------- 
.         
PR6I2650  PACK      KEY6,PMVXEDC1,SP70
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DTELEH,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MOVE      SP70,VARIABLE
          GOTO      PR6I5000
.
.------ Concession Card Type Code -------- 
.
PR6I2651  MOVE      ONE,DIM1
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      PR6I5000
.
.------ Concession Card Type Description -------- 
.
PR6I2652  MOVE      ONE,DIM1 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ Concession Card Number -------- 
.
PR6I2653  MOVE      ONE,DIM1
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
.------ Concession Card Expiry Date -------- 
.
PR6I2654  MOVE      ONE,DIM1
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Safety Net Card Type Code --------
.
PR6I2655  MOVE      TWO,DIM1
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      PR6I5000
.
.------ Safety Net Card Type Description --------
.
PR6I2656  MOVE      TWO,DIM1 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ Safert Net Card Number --------
.
PR6I2657  MOVE      TWO,DIM1
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
.------ Safety Net Card Expiry Date --------
.
PR6I2658  MOVE      TWO,DIM1
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ DVA Card Type Code --------
.
PR6I2659  MOVE      THREE,DIM1
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      PR6I5000
.
.------ DVA Card Type Description --------
.
PR6I2660  MOVE      THREE,DIM1 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ DVA Card Number --------
.
PR6I2661  MOVE      THREE,DIM1
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
.------ DVA Card Expiry Date --------
.
PR6I2662  MOVE      THREE,DIM1
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Pension Card Type Code --------
.
PR6I2663  MOVE      FOUR,DIM1
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      PR6I5000
.
.------ Pension Card Type Description --------
.
PR6I2664  MOVE      FOUR,DIM1 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ Pension Card Number --------
.
PR6I2665  MOVE      FOUR,DIM1
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
.------ Pension Card Expiry Date --------
.
PR6I2666  MOVE      FOUR,DIM1
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------  X if Discharged --------
.
PR6I2667  IF        ASTAT=3
            MOVE      ANSX,VARIABLE
          ELSE
            MOVE      SP70,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------  X if Transfer to Another Hospital --------
.
PR6I2668  MOVE      CODEDD,TCODE
          PACK      ACODE,DDEST,SP3
          CALL      GTCOD000
          MATCH     "1",TCINDC2
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ELSE
            MOVE      SP70,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------  X if Deceased --------
.
PR6I2669  IF        PCEASE=1
            MOVE      ANSX,VARIABLE
          ELSE
            MOVE      SP70,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------  X if Discharged Home --------
.
PR6I2670  MOVE      CODEDD,TCODE
          PACK      ACODE,DDEST,SP3
          CALL      GTCOD000
          MATCH     ANSZ,TCINDC1
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ELSE
            MOVE      SP70,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2671  MOVE      PTELPHSP,VARIABLE
          GOTO      PR6I5000
.
PR6I2672  MOVE      ZERO,F8                   * Yes/No patient is <= 180
          DAYSEP    PBDATE,ADATE,F8           * days old
          IF        F8 > 180
            PACK      VARIABLE,DNO,SP70               * > 180 days old
          ELSE
            PACK      VARIABLE,DYES,SP70              * <= 180 days old
          ENDIF
          GOTO      PR6I5000
.
PR6I2673  MOVE      SP70,VARIABLE
          PACK      KEY10,IBLPRUID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,PR6I5000
.
          MOVE      WBSEFDEP,VARIABLE
          GOTO      PR6I5000
.
PR6I2674  MOVE      SP70,VARIABLE
          PACK      KEY10,IBLPRUID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,PR6I5000
.
          MATCH     SP70,WBSEOCG
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY5,CATW0,WBSEOCG,SP70
          CALL      RDCODE1
          IF        OVRCD=0
            MOVE      PTCDLDES,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
PR6I2675  MOVE      PMFIPHCA,VARIABLE
          GOTO      PR6I5000
.
PR6I2676  MOVE      PMFIEDVA,VARIABLE
          GOTO      PR6I5000
.
PR6I2677  UNPACK    BKRXUDD1,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
PR6I2678  UNPACK    BKRXUDD2,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
PR6I2679  MOVE      BKRXUDT1,VARIABLE
          GOTO      PR6I5000
.
PR6I2680  MOVE      BKRXUDT2,VARIABLE
          GOTO      PR6I5000
.
PR6I2681  MATCH     SP70,BKRXUDD1
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    BKRXUDD1,CCENT,CYEAR,CMON,CDAY
          CALL      DAYOFWEK
          LOAD      DAYNAM3,WEEKDAY,MON,TUE,WED,THU,FRI,SAT,SUN
          MOVE      DAYNAM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2682  MATCH     SP70,BKRXUDD2
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    BKRXUDD2,CCENT,CYEAR,CMON,CDAY
          CALL      DAYOFWEK
          LOAD      DAYNAM3,WEEKDAY,MON,TUE,WED,THU,FRI,SAT,SUN
          MOVE      DAYNAM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2683  UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
          CALL      DAYOFWEK
          LOAD      DAYNAM3,WEEKDAY,MON,TUE,WED,THU,FRI,SAT,SUN
          MOVE      DAYNAM3,VARIABLE
          GOTO      PR6I5000
.
PR6I2684  PACK      OPDADATE,SP70
          PACK      KEY31,ADMISSNO,SP70
          CALL      RSOPDEA2
          CALL      RKOPDEA2
          BRANCH    OVRCD,PR6I5000
.
          MATCH     ADMISSNO,OPDAADMN
          GOTO      PR6I5000 IF NOT EQUAL
.
          UNPACK    OPDADATE,CCENT,CYEAR,CMON,CDAY
          CALL      DAYOFWEK
          LOAD      DAYNAM3,WEEKDAY,MON,TUE,WED,THU,FRI,SAT,SUN
          MOVE      DAYNAM3,VARIABLE
          GOTO      PR6I5000
.
.------ format PMI user defined field 7 code ------
.
PR6I2685  MOVE      PMPXUSR7,VARIABLE
          GOTO      PR6I5000
.
.------ format PMI user defined field 7 description ------
.
PR6I2686  PACK      TCODE,ANSP,SEVEN         * User defined 7
          PACK      ACODE,PMPXUSR7,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format PMI user defined field 8 code ------
.
PR6I2687  MOVE      PMPXUSR8,VARIABLE
          GOTO      PR6I5000
.
.------ format PMI user defined field 8 description ------
.
PR6I2688  PACK      TCODE,ANSP,EIGHT         * User defined 8
          PACK      ACODE,PMPXUSR8,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format PMI user defined field 9 code ------
.
PR6I2689  MOVE      PMPXUSR9,VARIABLE
          GOTO      PR6I5000
.
.------ format PMI user defined field 9 description ------
.
PR6I2690  PACK      TCODE,ANSP,NINE          * User defined 9
          PACK      ACODE,PMPXUSR9,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Compensable/Heath Fund Name  ------
.
PR6I2691  MOVE      ACLAIM,CLAIMCOD
          CALL      CMPH0000
          MOVE      CLMDET1,VARIABLE
          GOTO      PR6I5000
.
.------ Compensable/Heath Fund Number  ------
.
PR6I2692  MOVE      ACLAIM,CLAIMCOD
          CALL      CMPH0000
          MOVE      CLMDET2,VARIABLE
          GOTO      PR6I5000
.
.------ format patient address ------
.
PR6I2693  CALL      PACADDRS 
          PACK      VARIABLE,PACADDRS,SP70,SP10
          GOTO      PR6I5000
.
.------ unplanned readmission code ------
.
PR6I2694  MOVE      PMVXUREA,VARIABLE
          GOTO      PR6I5000
.
.------ unplanned readmission description ------
.
PR6I2695  PACK      TCODE,ANSK,ANSO,SP70
          PACK      ACODE,PMVXUREA,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Attending Doctor Fax Number ------
.
PR6I2696  MOVE      SP70,PTDOFAXN
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD,PR6I5000
          MOVE      PTDOFAXN,VARIABLE
          GOTO      PR6I5000
.
.------ Attending Doctor PACFNAME ------
.
PR6I2697  PACK       PACFNAME,SP70,SP70
          MOVE       ADOCTA,KEY6
          MATCH      SP70,KEY6
          IF         !@EQUAL
            CALL       RDDOCT1
            IF         OVRCD <> 1
              MOVE       DSNAME,PACSNAME
              MOVE       DGNAME,PACGNAME
              MOVE       DTITL,PACTITLE
              MOVE       TWO,PACFRMT
              CALL       PACNAME
              MOVE       PACFNAME,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ Eclipse OEC Account Reference ID (pmseehaf) ------
.
PR6I2698  MOVE      PMHEARID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Report Counter (pmseehaf) ------
.         
PR6I2699  MOVE      PMHERPTC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Claim Transaction ID (pmseehaf) ------
.
PR6I2700  MOVE      PMHECTID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Benefit Limitations Indicator (pmseehaf) ------
.
PR6I2701  MATCH     "1",PMHEBENL
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Eclipse OEC Claim Fund Assessment Code (pmseehaf) ------
.
PR6I2702  MOVE      PMHECFAC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC CoPayment Amount (pmseehaf) ------
. 
PR6I2703  MATCH     SP70,PMHECPAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMHECPAM
          UNPACK    PMHECPAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC CoPayment Days Remaining (pmseehaf) ------
. 
PR6I2704  MOVE      PMHECPDR,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC CoPayment Description Indicator (pmseehaf) ------
.
PR6I2705  MATCH     "1",PMHECPDI
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Eclipse OEC Excess Amount (pmseehaf) ------
.
PR6I2706  MATCH     SP70,PMHEEXAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMHEEXAM
          UNPACK    PMHEEXAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Excess Amount Description Indicator (pmseehaf) ------
.
PR6I2707  MATCH     "1",PMHEEADI
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Eclipse OEC Excess Bonus Amount (pmseehaf) ------
.
PR6I2708  MATCH     SP70,PMHEEXBA
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMHEEXBA
          UNPACK    PMHEEXBA,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Exclusion Description Indicator (pmseehaf) ------
. 
PR6I2709  MATCH     "1",PMHEEXDI
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Eclipse OEC Financial Status (pmseehaf) ------
. 
PR6I2710  MOVE      PMHEFSTA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Fund Reference ID (pmseehaf) ------
.
PR6I2711  MOVE      PMHEFRID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Fund Status Code (pmseehaf) ------
.
PR6I2712  MOVE      PMHEFSCD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC PEA Potential Indicator (pmseehaf) ------
.
PR6I2713  MOVE      PMHEPEAI,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Process Status Code (pmseehaf) ------
.
PR6I2714  MOVE      PMHEPSCD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Table Name (pmseehaf) ------
.
PR6I2715  MOVE      PMHETNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Table Description Indicator (pmseehaf) ------
.
PR6I2716  MATCH     "1",PMHETBDI
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Eclipse OEC Table Scale (pmseehaf) ------
. 
PR6I2717  MOVE      PMHETBSC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Date Updated (pmseehaf) ------
. 
PR6I2718  MATCH     SP70,PMHEUDTE
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMHEUDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Time Updated (pmseehaf) ------
.
PR6I2719  MOVE      PMHEUTIM,VARIABLE
          GOTO      PR6I5000
.
.------ format the hospital name ------
.
PR6I2720  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          IF        IBCNMHOS<>1
            MOVE      CNAME,VARIABLE
            GOTO      PR6I5000
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL
            PACK      KEY3,PMVXMHOS,SP70
            CALL      RDPTHSP1
            MOVE      PTHSHOSP,VARIABLE
          ELSE
            MOVE      CNAME,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format the hospital Eclipse Location ID ------
.         
PR6I2721  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS 
          IF        IBCNMHOS<>1
            MOVE      PTCNCLID,VARIABLE 
            GOTO      PR6I5000
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL
            PACK      KEY3,PMVXMHOS,SP70   
            CALL      RDPTHSP1
            MOVE      PTHSLOCN,VARIABLE
          ELSE
            MOVE      PTCNCLID,VARIABLE
          ENDIF     
          GOTO      PR6I5000
.
.------ Eclipse OEC Claim Fund Explanation code (pmseedaf) ------
.
PR6I2722  MOVE      "  1",DIM3
          CALL      GTPMED00
          MOVE      PMDECFEC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Explanation code counter (pmseedaf) ------
.
PR6I2723  MOVE      "  1",DIM3
          CALL      GTPMED00
          MOVE      PMDEEXPC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Claim Fund Explanation text (pmseedaf) ------
.
PR6I2724  MOVE      "  1",DIM3
          CALL      GTPMED00
          MOVE      PMDECFET,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Claim Fund Explanation ID (pmseedaf) ------
.
PR6I2725  MOVE      "  1",DIM3
          CALL      GTPMED00
          MOVE      PMDECTID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Service Code (pmssesaf) ------
.
PR6I2726  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Service Counter (pmssesaf) ------
.
PR6I2727  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESSRVC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Service Code Type Code (pmssesaf) ------
.
PR6I2728  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCTC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Service ID (pmssesaf) ------
.
PR6I2729  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESSVID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Charge Amount (pmssesaf) ------
.
PR6I2730  MOVE      "  1",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESCAMT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESCAMT
          UNPACK    PMESCAMT,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Service Date (pmssesaf) ------
.
PR6I2731  MOVE      "  1",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSDTE
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMESSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Fund Benefit Amount (pmssesaf) ------
.
PR6I2732  MOVE      "  1",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESFBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESFBAM
          UNPACK    PMESFBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Item Number (pmssesaf) ------
.
PR6I2733  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESITEM,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Medicare Benefit Amount (pmssesaf) ------
.
PR6I2734  MOVE      "  1",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESMBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESMBAM
          UNPACK    PMESMBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Medicare Exp Code (pmssesaf) ------
.
PR6I2735  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESMEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Ser Fund Asses Code (pmssesaf) ------
.
PR6I2736  MOVE      "  1",DIM3
          CALL      GTPMSE00
          MOVE      PMESSFAC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Header Schedule Fee (pmssesaf) ------
.
PR6I2737  MOVE      "  1",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSFEE
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESSFEE
          UNPACK    PMESSFEE,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Service Code (pmssesaf) ------
.
PR6I2738  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Service Counter (pmssesaf) ------
.
PR6I2739  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESSRVC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Service Code Type Code (pmssesaf) ------
.
PR6I2740  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCTC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Service ID (pmssesaf) ------
.
PR6I2741  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESSVID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Charge Amount (pmssesaf) ------
.
PR6I2742  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESCAMT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESCAMT
          UNPACK    PMESCAMT,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Service Date (pmssesaf) ------
.
PR6I2743  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSDTE
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMESSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Fund Benefit Amount (pmssesaf) ------
.
PR6I2744  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESFBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESFBAM
          UNPACK    PMESFBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Item Number (pmssesaf) ------
.
PR6I2745  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESITEM,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Medicare Benefit Amount (pmssesaf) ------
.
PR6I2746  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESMBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESMBAM
          UNPACK    PMESMBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Medicare Exp Code (pmssesaf) ------
.
PR6I2747  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESMEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Ser Fund Asses Code (pmssesaf) ------
.
PR6I2748  MOVE      "  2",DIM3
          CALL      GTPMSE00
          MOVE      PMESSFAC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Header Schedule Fee (pmssesaf) ------
.
PR6I2749  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSFEE
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESSFEE
          UNPACK    PMESSFEE,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Service Code (pmssesaf) ------
.
PR6I2750  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Service Counter (pmssesaf) ------
.
PR6I2751  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESSRVC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Service Code Type Code (pmssesaf) ------
.
PR6I2752  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCTC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Service ID (pmssesaf) ------
.
PR6I2753  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESSVID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Charge Amount (pmssesaf) ------
.
PR6I2754  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESCAMT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESCAMT
          UNPACK    PMESCAMT,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Service Date (pmssesaf) ------
.
PR6I2755  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSDTE
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMESSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Fund Benefit Amount (pmssesaf) ------
.
PR6I2756  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESFBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESFBAM
          UNPACK    PMESFBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Item Number (pmssesaf) ------
.
PR6I2757  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESITEM,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Medicare Benefit Amount (pmssesaf) ------
.
PR6I2758  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESMBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESMBAM
          UNPACK    PMESMBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Medicare Exp Code (pmssesaf) ------
.
PR6I2759  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESMEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Ser Fund Asses Code (pmssesaf) ------
.
PR6I2760  MOVE      "  3",DIM3
          CALL      GTPMSE00
          MOVE      PMESSFAC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Header Schedule Fee (pmssesaf) ------
.
PR6I2761  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSFEE
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESSFEE
          UNPACK    PMESSFEE,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Service Code (pmssesaf) ------
.
PR6I2762  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Service Counter (pmssesaf) ------
.
PR6I2763  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESSRVC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Service Code Type Code (pmssesaf) ------
.
PR6I2764  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCTC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Service ID (pmssesaf) ------
.
PR6I2765  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESSVID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Charge Amount (pmssesaf) ------
.
PR6I2766  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESCAMT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESCAMT
          UNPACK    PMESCAMT,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Service Date (pmssesaf) ------
.
PR6I2767  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSDTE
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMESSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Fund Benefit Amount (pmssesaf) ------
.
PR6I2768  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESFBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESFBAM
          UNPACK    PMESFBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Item Number (pmssesaf) ------
.
PR6I2769  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESITEM,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Medicare Benefit Amount (pmssesaf) ------
.
PR6I2770  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESMBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESMBAM
          UNPACK    PMESMBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Medicare Exp Code (pmssesaf) ------
.
PR6I2771  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESMEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Ser Fund Asses Code (pmssesaf) ------
.
PR6I2772  MOVE      "  4",DIM3
          CALL      GTPMSE00
          MOVE      PMESSFAC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Header Schedule Fee (pmssesaf) ------
.
PR6I2773  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSFEE
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESSFEE
          UNPACK    PMESSFEE,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Service Code (pmssesaf) ------
.
PR6I2774  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCOD,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Service Counter (pmssesaf) ------
.
PR6I2775  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESSRVC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Service Code Type Code (pmssesaf) ------
.
PR6I2776  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESSCTC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Service ID (pmssesaf) ------
.
PR6I2777  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESSVID,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Charge Amount (pmssesaf) ------
.
PR6I2778  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESCAMT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESCAMT
          UNPACK    PMESCAMT,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Service Date (pmssesaf) ------
.
PR6I2779  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSDTE
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMESSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Fund Benefit Amount (pmssesaf) ------
.
PR6I2780  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESFBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESFBAM
          UNPACK    PMESFBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Item Number (pmssesaf) ------
.
PR6I2781  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESITEM,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Medicare Benefit Amount (pmseehaf) ------
.
PR6I2782  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESMBAM
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESMBAM
          UNPACK    PMESMBAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Medicare Exp Code (pmssesaf) ------
.
PR6I2783  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESMEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Ser Fund Asses Code (pmssesaf) ------
.
PR6I2784  MOVE      "  5",DIM3
          CALL      GTPMSE00
          MOVE      PMESSFAC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Header Schedule Fee (pmssesaf) ------
.
PR6I2785  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MATCH     SP70,PMESSFEE
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          RJUSTIFY  PMESSFEE
          UNPACK    PMESSFEE,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
          MOVE      DIM10,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Detail Service Fund Ex Code (pmssedaf) ------
.
PR6I2786  MOVE      "  1",DIM3
          CALL      GTPMSE00
. 
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFEC,VARIABLE           
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Detail Service Ex Code counter (pmssedaf) ------
.
PR6I2787  MOVE      "  1",DIM3
          CALL      GTPMSE00
. 
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 1st Service Detail Service Ex text (pmssedaf) ------
.
PR6I2788  MOVE      "  1",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFET,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Detail Service Fund Ex Code (pmssedaf) ------
.
PR6I2789  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFEC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Detail Service Ex Code counter (pmssedaf) ------
.
PR6I2790  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 2nd Service Detail Service Ex text (pmssedaf) ------
.
PR6I2791  MOVE      "  2",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFET,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Detail Service Fund Ex Code (pmssedaf) ------
.
PR6I2792  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFEC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Detail Service Ex Code counter (pmssedaf) ------
.
PR6I2793  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 3rd Service Detail Service Ex text (pmssedaf) ------
.
PR6I2794  MOVE      "  3",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFET,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Detail Service Fund Ex Code (pmssedaf) ------
.
PR6I2795  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFEC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Detail Service Ex Code counter (pmssedaf) ------
.
PR6I2796  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 4th Service Detail Service Ex text (pmssedaf) ------
.
PR6I2797  MOVE      "  4",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFET,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Detail Service Fund Ex Code (pmssedaf) ------
.
PR6I2798  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFEC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Detail Service Ex Code counter (pmssedaf) ------
.
PR6I2799  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESEXC,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC 5th Service Detail Service Ex text (pmssedaf) ------
.
PR6I2800  MOVE      "  5",DIM3
          CALL      GTPMSE00
.
          MOVE      "  1",DIM3
          CALL      GTPMSD00
.
          MOVE      PMSESFET,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 1 (pmsercaf) ------
.
PR6I2801  MOVE      "001",DIM3
          MOVE      "  1",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 2 (pmsercaf) ------
.
PR6I2802  MOVE      "001",DIM3
          MOVE      "  2",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 3 (pmsercaf) ------
.
PR6I2803  MOVE      "001",DIM3
          MOVE      "  3",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 4 (pmsercaf) ------
.
PR6I2804  MOVE      "001",DIM3
          MOVE      "  4",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 5 (pmsercaf) ------
.
PR6I2805  MOVE      "001",DIM3
          MOVE      "  5",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 6 (pmsercaf) ------
.
PR6I2806  MOVE      "001",DIM3
          MOVE      "  6",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 7 (pmsercaf) ------
.
PR6I2807  MOVE      "001",DIM3
          MOVE      "  7",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 8 (pmsercaf) ------
.
PR6I2808  MOVE      "001",DIM3
          MOVE      "  8",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 9 (pmsercaf) ------
.
PR6I2809  MOVE      "001",DIM3
          MOVE      "  9",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Benefit Lim Line 10 (pmsercaf) ------
.
PR6I2810  MOVE      "001",DIM3
          MOVE      " 10",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 1 (pmsercaf) ------
.
PR6I2811  MOVE      "002",DIM3
          MOVE      "  1",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 2 (pmsercaf) ------
.                                                       
PR6I2812  MOVE      "002",DIM3
          MOVE      "  2",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 3 (pmsercaf) ------
.
PR6I2813  MOVE      "002",DIM3
          MOVE      "  3",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 4 (pmsercaf) ------
.
PR6I2814  MOVE      "002",DIM3
          MOVE      "  4",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 5 (pmsercaf) ------
.
PR6I2815  MOVE      "002",DIM3
          MOVE      "  5",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 6 (pmsercaf) ------
.
PR6I2816  MOVE      "002",DIM3
          MOVE      "  6",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 7 (pmsercaf) ------
.
PR6I2817  MOVE      "002",DIM3
          MOVE      "  7",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 8 (pmsercaf) ------
.
PR6I2818  MOVE      "002",DIM3
          MOVE      "  8",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 9 (pmsercaf) ------
.
PR6I2819  MOVE      "002",DIM3
          MOVE      "  9",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments CoPayment Desc Line 10 (pmsercaf) ------
.
PR6I2820  MOVE      "002",DIM3
          MOVE      " 10",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 1 (pmsercaf) ------
.
PR6I2821  MOVE      "003",DIM3
          MOVE      "  1",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 2 (pmsercaf) ------
.                                                       
PR6I2822  MOVE      "003",DIM3
          MOVE      "  2",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 3 (pmsercaf) ------
.
PR6I2823  MOVE      "003",DIM3
          MOVE      "  3",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 4 (pmsercaf) ------
.
PR6I2824  MOVE      "003",DIM3
          MOVE      "  4",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 5 (pmsercaf) ------
.
PR6I2825  MOVE      "003",DIM3
          MOVE      "  5",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 6 (pmsercaf) ------
.
PR6I2826  MOVE      "003",DIM3
          MOVE      "  6",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 7 (pmsercaf) ------
.
PR6I2827  MOVE      "003",DIM3
          MOVE      "  7",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 8 (pmsercaf) ------
.
PR6I2828  MOVE      "003",DIM3
          MOVE      "  8",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 9 (pmsercaf) ------
.
PR6I2829  MOVE      "003",DIM3
          MOVE      "  9",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Excess Amount Desc 10 (pmsercaf) ------
.
PR6I2830  MOVE      "003",DIM3
          MOVE      " 10",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 1 (pmsercaf) ------
.
PR6I2831  MOVE      "004",DIM3
          MOVE      "  1",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 2 (pmsercaf) ------
.                                                       
PR6I2832  MOVE      "004",DIM3
          MOVE      "  2",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 3 (pmsercaf) ------
.
PR6I2833  MOVE      "004",DIM3
          MOVE      "  3",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 4 (pmsercaf) ------
.
PR6I2834  MOVE      "004",DIM3
          MOVE      "  4",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 5 (pmsercaf) ------
.
PR6I2835  MOVE      "004",DIM3
          MOVE      "  5",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 6 (pmsercaf) ------
.
PR6I2836  MOVE      "004",DIM3
          MOVE      "  6",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 7 (pmsercaf) ------
.
PR6I2837  MOVE      "004",DIM3
          MOVE      "  7",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 8 (pmsercaf) ------
.
PR6I2838  MOVE      "004",DIM3
          MOVE      "  8",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 9 (pmsercaf) ------
.
PR6I2839  MOVE      "004",DIM3
          MOVE      "  9",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Exclusion Desc Line 10 (pmsercaf) ------
.
PR6I2840  MOVE      "004",DIM3
          MOVE      " 10",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 1 (pmsercaf) ------
.
PR6I2841  MOVE      "005",DIM3
          MOVE      "  1",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 2 (pmsercaf) ------
.                                                       
PR6I2842  MOVE      "005",DIM3
          MOVE      "  2",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 3 (pmsercaf) ------
.
PR6I2843  MOVE      "005",DIM3
          MOVE      "  3",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 4 (pmsercaf) ------
.
PR6I2844  MOVE      "005",DIM3
          MOVE      "  4",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 5 (pmsercaf) ------
.
PR6I2845  MOVE      "005",DIM3
          MOVE      "  5",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 6 (pmsercaf) ------
.
PR6I2846  MOVE      "005",DIM3
          MOVE      "  6",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 7 (pmsercaf) ------
.
PR6I2847  MOVE      "005",DIM3
          MOVE      "  7",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 8 (pmsercaf) ------
.
PR6I2848  MOVE      "005",DIM3
          MOVE      "  8",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 9 (pmsercaf) ------
.
PR6I2849  MOVE      "005",DIM3
          MOVE      "  9",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.------ Eclipse OEC Response Comments Table Description Line 10 (pmsercaf) -----
.
PR6I2850  MOVE      "005",DIM3
          MOVE      " 10",DIM3A
          CALL      GTPMER00
.
          MOVE      PMRCDATA,VARIABLE
          GOTO      PR6I5000
.
.-------- Iwi 1
.
PR6I2851  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXIWI1
          IF        !@EQUAL
            PACK      KEY5,ANSLI,ANSLW,PMPXIWI1,SP10
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.-------- Iwi 2
.
PR6I2852  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXIWI2
          IF        !@EQUAL
            PACK      KEY5,ANSLI,ANSLW,PMPXIWI2,SP10
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.-------- Iwi 3
.
PR6I2853  MOVE      SP70,VARIABLE
          MATCH     SP10,PMPXIWI3
          IF        !@EQUAL
            PACK      KEY5,ANSLI,ANSLW,PMPXIWI3,SP10
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ format Prefered Language 2(LA)  --------
.
PR6I2854  PACK      TCODE,ANSL,ANSA,SP70
          PACK      ACODE,PMPXLNG2,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Prefered Language 3(LA)  --------
.
PR6I2855  PACK      TCODE,ANSL,ANSA,SP70
          PACK      ACODE,PMPXLNG3,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Discharge Intention CAT KN code ------
.
PR6I2856  MOVE      PMVXUDIN,VARIABLE
          GOTO      PR6I5000
.
.------ Discharge Intention CAT KN description ------
.
PR6I2857  PACK      TCODE,ANSK,ANSN,SP70
          PACK      ACODE,PMVXUDIN,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Booking Extension Procedure Description 1 ------
.
PR6I2858  MOVE      BKRXUFF1,VARIABLE
          GOTO      PR6I5000
.
.------ Booking Extension Procedure Description 2 ------
.
PR6I2859  MOVE      BKRXUFF2,VARIABLE
          GOTO      PR6I5000
.
.------ Booking Extension Procedure Description 3 ------
.
PR6I2860  MOVE      BKRXUFF3,VARIABLE
          GOTO      PR6I5000
.
.------ Booking Extension User Defined Free Format 4 ------
.
PR6I2861  MOVE      BKRXUFF4,VARIABLE
          GOTO      PR6I5000

.
.--- Re-Admission 28 Days Code (KM) ------------------
.
PR6I2862  MOVE      PMVXREAD,VARIABLE
          GOTO      PR6I5000

.
.--- Re-Admission 28 Days Description ----------------
PR6I2863  MOVE      "KM",TCODE
          PACK      ACODE,PMVXREAD,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000

.
.--- Miscellaneous Amount ----------------------------
.
PR6I2864  OPEN      PATELGA1,"patelgaf"
          PACK      KEY8,AADMNO,SP70
          CALL      RDPTELG1
          IF        OVRCD=1
            MOVE      "N/A",VARIABLE
          ELSE
            PACK      VARIABLE,PTELMAMT
            LJUSTIFY  VARIABLE
            STRIP     VARIABLE
          ENDIF
          CLOSE     PATELGA1
          GOTO      PR6I5000
.
.--- Miscellaneous Description -----------------------
.
PR6I2865  OPEN      PATELGA1,"patelgaf"
          PACK      KEY8,AADMNO,SP70
          CALL      RDPTELG1
          IF        OVRCD=1
            MOVE      "N/A",VARIABLE
          ELSE
            MOVE      PTELMDES,VARIABLE
          ENDIF
          CLOSE     PATELGA1
          GOTO      PR6I5000
.
.------ format Referring HCP. code (patmi1af Based) ------
.
PR6I2868  MOVE      PTMSRFGP,VARIABLE
          GOTO      PR6I5000
.
.------ format Referring HCP. description (patmi1af Based) ------
.
PR6I2869  PACK      PACFNAME,SP30,SP30,SP20
          PACK      KEY10,PTMSRFGP,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      TWO,PACFRMT
            CALL      PACNAME
          ENDIF
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------ format the person financially responsible mobile telephone no. ------
.
PR6I2870  MOVE      SP20,PTREMOBL
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          MOVE      PTREMOBL,VARIABLE
          GOTO      PR6I5000
.
.------ format the financially responsible relationship description------
.
PR6I2871  MOVE      "SELF",PKRELP
          MOVE      AADMNO,KEY8
          CALL      RDRESP1
          IF        OVRCD=1
            MOVE      PKRELP,PMRLDESC
          ELSE
            PACK      KEY10,PKRELP,SP10
            CALL      RDPMREL1
            IF        OVRCD=1
              MOVE      PKRELP,PMRLDESC
            ENDIF
          ENDIF
          MOVE      PMRLDESC,VARIABLE
.
          GOTO      PR6I5000
.
.------ Next Stationery Code Type 3------
.
PR6I2872  CALL      SLPC0000           * Save ibalpcaf file variables
.
          UNPACK    IBDTTXFL,DIM8,DIM6
          MOVE      IBLPURNO,URNUMBER
          MOVE      IBLPVISN,ADMISSNO
          MOVE      IBLPSKEY,SUBSYSKY
          MOVE      IBLPPRNT,SCHDPRNT
          MOVE      IBLPCOPY,SCHDCOPY
          MOVE      STATNCOD,SVSTNCOD
          MOVE      DIM6,STATNCOD
          PACK      LABELTYP,IBLPLAPR,IBLPLASC
          MOVE      IBLPFRE1,FREETXT1
          MOVE      IBLPFRE2,FREETXT2
          MOVE      IBLPFRE3,FREETXT3
          MOVE      IBLPFRE4,FREETXT4
          MOVE      IBLPFRE5,FREETXT5
          MOVE      IBLPFRE6,FREETXT6
          MOVE      IBLPFRE7,FREETXT7
.
          CALL      ADDPRN00
.
          CALL      RLPC0000           * Restore ibalpcaf file variables
.
          MOVE      SVSTNCOD,STATNCOD
.
          GOTO      PR6I5000
.
.------ Local doctor free format ------
.
PR6I2873  MOVE      PLOCDOC,VARIABLE
          GOTO      PR6I5000
.
.------- First Alternate ID -------
.                         
PR6I2874  MOVE      "FIRSTALT",D8
          PROC      GETALTID
          GOTO      PR6I5000
.
.------ format the hospital name ------
.
PR6I2875  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          IF        IBCNMHOS<>1
            GOTO      PR6I5000
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL
            PACK      KEY3,PMVXMHOS,SP70
            CALL      RDPTHSP1
            MOVE      PTHSHOSP,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.----- Health Fund Group Name Code --------
.
PR6I2876  MOVE      SP70,VARIABLE
          PACK      PTHFHGRP,SP70
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDMISS1
          IF        OVRCD=1
            GOTO      PR6I5000
          ENDIF
.
          CALL      FDHL0000
          MATCH     SP70,PTHFHGRP
          IF        @EQUAL
            MOVE      PTHFHGRP,VARIABLE
          ENDIF
.
          GOTO      PR6I5000
.
.----- Health Fund Group Name Description --------
.
PR6I2877  MOVE      SP70,VARIABLE
          PACK      PTHFHGRP,SP70
          PACK      PTHGDESC,SP70
.
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDMISS1
          IF        OVRCD=1
            MOVE      SP70,VARIABLE
            GOTO      PR6I5000
          ENDIF
.
          CALL    FDHL0000
          PACK    KEY6,PTHFHGRP,SP70
          CALL    RDPAHGP1
          IF      OVRCD=1
            MOVE    SP70,VARIABLE
          ELSE
            MOVE  PTHGDESC,VARIABLE
          ENDIF
.
          GOTO      PR6I5000
.
.------ format the person financially responsible surname or Contact name  ---
.
PR6I2878  MOVE      SP70,PTRESNAM
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDRESP1
          MOVE      PTRESNAM,VARIABLE
.
          GOTO      PR6I5000
.
.------ format the person financially responsible Given Name ------- 
.
PR6I2879  MOVE      SP70,PTREGNAM
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDRESP1
          MOVE      PTREGNAM,VARIABLE
.
          GOTO      PR6I5000
.
.------ format the tran file registrar -------
.
PR6I2880  MOVE      SP70,PTTRRSTR
          CALL      GETDRTE
          MOVE      PTTRRSTR,VARIABLE
.
          GOTO      PR6I5000
.
.------ format the tran file Resident -------
.
PR6I2881  MOVE      SP70,PTTRRESI
          CALL      GETDRTE
          MOVE      PTTRRESI,VARIABLE
.
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Name ------
.
PR6I2882  MOVE      PMEXNAME,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Address Line 1 ------
.
PR6I2883  MOVE      PMEXADD1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Address Line 2 ------
.
PR6I2884  MOVE      PMEXADD2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Address Line 3 ------
.
PR6I2885  MOVE      PMEXADD3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Address Line 4 ------
.
PR6I2886  MOVE      PMEXADD4,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Post Code ------
.
PR6I2887  MOVE      PMEXPOST,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Telephone ------
.
PR6I2888  MOVE      PMEXTELE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Date of Accident ------
.
PR6I2889  MATCH     SP70,PMEXADAT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXADAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Accepted by Ins Comp ------
.
PR6I2890  MATCH     "1",PMEXABIC
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXABIC
          IF        @EQUAL 
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Insurance Company Code ------
.
PR6I2891  MOVE      PMEXICOD,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Insurance Claim Number ------
.
PR6I2892  MOVE      PMEXCLMN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Insurance Contact Name ------
.
PR6I2893  MOVE      PMEXICON,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Insurance Comment 1 ------
.
PR6I2894  MOVE      PMEXCOM1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Insurance Comment 2 ------
.
PR6I2895  MOVE      PMEXCOM2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details U/R Number ------
.
PR6I2896  MOVE      PMEXURNO,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Visit Date ------
.
PR6I2897  MATCH     SP70,PMEXVDAT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXVDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Off Duty Injury ------
.
PR6I2898  MATCH     "2",PMEXODIN
          IF        @EQUAL
            MOVE      "N/A",VARIABLE
          ENDIF
.
          MATCH     "1",PMEXODIN
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXODIN
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Service Code ------
.
PR6I2899  MOVE      PMEXSERV,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Service Desc  ----------------
.
PR6I2900  MOVE      "Ve",TCODE
          PACK      ACODE,PMEXSERV,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Rank ------
.
PR6I2901  MOVE      PMEXRANK,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Service Number ------
.
PR6I2902  MOVE      PMEXSNUM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Barracks / Bases ------
.
PR6I2903  MOVE      PMEXBASE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Military Compensation Code ---
.
PR6I2904  MOVE      PMEXMCOM,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Military Compensation Desc  -----
.
PR6I2905  MOVE      "Vf",TCODE
          PACK      ACODE,PMEXMCOM,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Military Comments ---
.
PR6I2906  MOVE      PMEXMCNM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Social Security Number ---
.
PR6I2907  MOVE      PMEXSSNM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Country Code ---
.
PR6I2908  MOVE      PMEXCONT,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Country Description  -----
.
PR6I2909  MOVE      "C ",TCODE
          PACK      ACODE,PMEXCONT,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Contact Telephone ---
.
PR6I2910  MOVE      PMEXCTEL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Contact Telephone ---
.
PR6I2911  MOVE      PMEXUNIT,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details O/S Membership ---
.
PR6I2912  MOVE      PMEXOMEM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Insurance Expiry Date ------
.
PR6I2913  MATCH     SP70,PMEXIEDT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXIEDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Send Bill to Local Address ---
.
PR6I2914  MATCH     "1",PMEXSBIL
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXSBIL
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Travel Insurance ---
.
PR6I2915  MATCH     "1",PMEXTINS
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXTINS
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Travel Insurance Policy Number 
.
PR6I2916  MOVE      PMEXIPOL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Policy Number Expiry Date -----
.
PR6I2917  MATCH     SP70,PMEXIEXD
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXIEXD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Ships Name ------
.
PR6I2918  MOVE      PMEXSNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Ships Agents Name ------
.
PR6I2919  MOVE      PMEXSAGN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Contact Name ------
.
PR6I2920  MOVE      PMEXSCON,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Date 1  -----
.
PR6I2921  MATCH     SP70,PMEXDAT1
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXDAT1,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Date 2  -----
.
PR6I2922  MATCH     SP70,PMEXDAT2
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXDAT2,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Date 3  -----
.
PR6I2923  MATCH     SP70,PMEXDAT3
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXDAT3,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Date 4  -----
.
PR6I2924  MATCH     SP70,PMEXDAT4
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXDAT4,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Date 5  -----
.
PR6I2925  MATCH     SP70,PMEXDAT5
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXDAT5,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Time 1 ------
.
PR6I2926  MOVE      PMEXTIM1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Time 2 ------
.
PR6I2927  MOVE      PMEXTIM2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Time 3 ------
.
PR6I2928  MOVE      PMEXTIM3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Time 4 ------
.
PR6I2929  MOVE      PMEXTIM4,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Time 5 ------
.
PR6I2930  MOVE      PMEXTIM5,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Y/N 1 ---
.
PR6I2931  MATCH     "1",PMEXUYN1
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXUYN1
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Y/N 2 ---
.
PR6I2932  MATCH     "1",PMEXUYN2
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXUYN2
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Y/N 3 ---
.
PR6I2933  MATCH     "1",PMEXUYN3
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXUYN3
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Y/N 4 ---
.
PR6I2934  MATCH     "1",PMEXUYN4
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXUYN4
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Y/N 5 ---
.
PR6I2935  MATCH     "1",PMEXUYN5
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXUYN5
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Cat 1 (Vg) ------
.
PR6I2936  MOVE      PMEXCAT1,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details User Defined Cat 1 (Vg) Desc -----
.
PR6I2937  MOVE      "Vg",TCODE
          PACK      ACODE,PMEXCAT1,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Cat 2 (Vh) ------
.
PR6I2938  MOVE      PMEXCAT2,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details User Defined Cat 2 (Vh) Desc -----
.
PR6I2939  MOVE      "Vh",TCODE
          PACK      ACODE,PMEXCAT2,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Cat 3 (Vi) ------
.
PR6I2940  MOVE      PMEXCAT3,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details User Defined Cat 3 (Vi) Desc -----
.
PR6I2941  MOVE      "Vi",TCODE
          PACK      ACODE,PMEXCAT3,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Cat 4 (Vj) ------
.
PR6I2942  MOVE      PMEXCAT4,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details User Defined Cat 4 (Vj) Desc -----
.
PR6I2943  MOVE      "Vj",TCODE
          PACK      ACODE,PMEXCAT4,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Cat 5 (Vk) ------
.
PR6I2944  MOVE      PMEXCAT5,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details User Defined Cat 5 (Vk) Desc -----
.
PR6I2945  MOVE      "Vk",TCODE
          PACK      ACODE,PMEXCAT5,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Comments 1 ------
.
PR6I2946  MOVE      PMEXUCM1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Comments 2 ------
.
PR6I2947  MOVE      PMEXUCM2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Comments 3 ------
.
PR6I2948  MOVE      PMEXUCM3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Comments 4 ------
.
PR6I2949  MOVE      PMEXUCM4,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details User Defined Comments 5 ------
.
PR6I2950  MOVE      PMEXUCM5,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Name ------
.
PR6I2951  MOVE      PMEXSLNM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Address Line 1 ------
.
PR6I2952  MOVE      PMEXSAD1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Address Line 2 ------
.
PR6I2953  MOVE      PMEXSAD2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Address Line 3 ------
.
PR6I2954  MOVE      PMEXSAD3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Address Line 4 ------
.
PR6I2955  MOVE      PMEXSAD4,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Post Code ------
.
PR6I2956  MOVE      PMEXSPOS,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Telephone ------
.
PR6I2957  MOVE      PMEXSTEL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Solicitor Contact Name ------
.
PR6I2958  MOVE      PMEXSCNM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Visa Type (Cat vt) ------
.
PR6I2959  MOVE      PMEXVTYP,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Visa Type (Cat vt) Desc -----
.
PR6I2960  MOVE      "vt",TCODE
          PACK      ACODE,PMEXVTYP,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Visa Expiry Date -----
.
PR6I2961  MATCH     SP70,PMEXVEXP
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXVEXP,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Passport Number ------
.
PR6I2962  MOVE      PMEXPASN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Passport Country (Cat C) -----
.
PR6I2963  MOVE      PMEXPASC,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Passport Country (Cat C) Desc ----
.
PR6I2964  MOVE      "C ",TCODE
          PACK      ACODE,PMEXPASC,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Overseas Visitor Status Cat Vl
.
PR6I2965  MOVE      PMEXOSVS,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Overseas Visitor Stat Cat Vl Desc
.
PR6I2966  MOVE      "Vl",TCODE
          PACK      ACODE,PMEXOSVS,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Base Code Car Br
.
PR6I2967  MOVE      PMEXBASC,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Base Code Car Br Desc
.
PR6I2968  MOVE      "Br",TCODE
          PACK      ACODE,PMEXBASC,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Contact Name
.
PR6I2969  MOVE      PMEXECON,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employer Contact Phone
.
PR6I2970  MOVE      PMEXEPHN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Address Line 1
.
PR6I2971  MOVE      PMEXCAD1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Address Line 2
.
PR6I2972  MOVE      PMEXCAD2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Address Line 3
.
PR6I2973  MOVE      PMEXCAD3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Address Line 4
.
PR6I2974  MOVE      PMEXCAD4,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Postcode
.
PR6I2975  MOVE      PMEXCPCD,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Contact Name
.
PR6I2976  MOVE      PMEXCNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Free Format Contact Phone
.
PR6I2977  MOVE      PMEXCPHN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Cause of Injury (Cat IK)
.
PR6I2978  MOVE      PMEXCINJ,VARIABLE
          GOTO      PR6I5000
.
.--- Patient System Extra Compensable Details Cause of Injury Car IK Desc
.
PR6I2979  MOVE      "IK",TCODE
          PACK      ACODE,PMEXCINJ,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Injury Code (Cat IJ)
.
PR6I2980  MOVE      PMEXINCD,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Injury Code (Cat IJ) Desc
.
PR6I2981  MOVE      "IJ",TCODE
          PACK      ACODE,PMEXINCD,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Work Related (Cat IQ)
.
PR6I2982  MOVE      PMEXACCF,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Work Related (Cat IQ) Desc
.
PR6I2983  MOVE      "IQ",TCODE
          PACK      ACODE,PMEXACCF,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Place Injury Occured (Cat IP)
.
PR6I2984  MOVE      PMEXPLIN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Place Injury Occured Desc    
.
PR6I2985  MOVE      "IP",TCODE
          PACK      ACODE,PMEXPLIN,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Activity when injured (Cat IO)
.
PR6I2986  MOVE      PMEXACTI,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Activity when injured Desc
.
PR6I2987  MOVE      "IO",TCODE
          PACK      ACODE,PMEXACTI,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details ACC Decline Date -----
.
PR6I2988  MATCH     SP70,PMEXADTE
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXADTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Accident Time
.
PR6I2989  MOVE      PMEXATME,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Accident Location (Cat IM)
.
PR6I2990  MOVE      PMEXACLC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Accident Location Description
.
PR6I2991  MOVE      "IM",TCODE
          PACK      ACODE,PMEXACLC,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Accident Location
.
PR6I2992  MOVE      PMEXALOC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Accident in NZ Y/N ---
.
PR6I2993  MATCH     "1",PMEXAINZ
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXAINZ
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Moving Vehicle Y/N ---
.
PR6I2994  MATCH     "1",PMEXMOVV
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXMOVV
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Sporting Injury Y/N
.
PR6I2995  MATCH     "1",PMEXSPTI
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXSPTI
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Sporting Name (Cat IB)
.
PR6I2996  MOVE      PMEXSPRT,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Sporting Name Description
.
PR6I2997  MOVE      "IB",TCODE
          PACK      ACODE,PMEXSPRT,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Recurring Injury Indicator
.
PR6I2998  MATCH     "1",PMEXRECI
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXRECI
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Treatment Injury Claim Y/N
.
PR6I2999  MATCH     "1",PMEXTRIC
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXTRIC
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employment Status (Cat IF)
.
PR6I3000  MOVE      PMEXESTA,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Employment Status Desc
.
PR6I3001  MOVE      "IF",TCODE
          PACK      ACODE,PMEXESTA,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Patient Declaration Date
.
PR6I3002  MATCH     SP70,PMEXPDDT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXPDDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Detailsuthorized Representative Giv Nm1
.
PR6I3003  MOVE      PMEXARG1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Detailsuthorized Representative Giv Nm2
.
PR6I3004  MOVE      PMEXARG2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Detailsuthorized Representative Surname
.
PR6I3005  MOVE      PMEXARSN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Detailsuthorized Representative Title
.
PR6I3006  MOVE      PMEXARTL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Detailsuthorized Representative Rel
.
PR6I3007  MOVE      PMEXARRP,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Assistance is Required Y/N
.
PR6I3008  MATCH     "1",PMEXASST
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXASST
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Need to call HP Y/N
.
PR6I3009  MATCH     "1",PMEXNEED
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXNEED
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Continue Normal Hours of Work
.
PR6I3010  MATCH     "1",PMEXCNOR
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXCNOR
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Alternative Work Indicator
.
PR6I3011  MATCH     "1",PMEXALTW
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXALTW
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Type of Alternative Work Cat IH
.
PR6I3012  MOVE      PMEXTYPA,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Type of Alternative Work Desc
.
PR6I3013  MOVE      "IH",TCODE
          PACK      ACODE,PMEXTYPA,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Start Date of Alternative Wrk 
.
PR6I3014  MATCH     SP70,PMEXSALT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXSALT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Hours per Day Alt Work
.
PR6I3015  MOVE      PMEXHPDA,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Unfit for Work For Duration 
.
PR6I3016  MOVE      PMEXUNFD,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Unfit for Work for Type Cat UI
.
PR6I3017  MOVE      PMEXUNFT,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Unfit for Work Cat UI Desc
.
PR6I3018  MOVE      "UI",TCODE
          PACK      ACODE,PMEXUNFT,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Full Incapacity Start Date
.
PR6I3019  MATCH     SP70,PMEXFISD
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXFISD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Return to Normal Work Date
.
PR6I3020  MATCH     SP70,PMEXRNWD
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXRNWD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Claim Status
.
PR6I3021  MATCH     "2",PMEXCSTA
          IF        @EQUAL
            MOVE      "Completed",VARIABLE
          ENDIF
.
          MATCH     "1",PMEXCSTA
          IF        @EQUAL
            MOVE      "Parked",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXCSTA
          IF        @EQUAL
            MOVE      "Existing",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Type of Work (Cat IX)
.
PR6I3022  MOVE      PMEXTWRK,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Type of Work Desc
.
PR6I3023  MOVE      "IX",TCODE
          PACK      ACODE,PMEXTWRK,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Other Employment Status
.
PR6I3024  MOVE      PMEXOEST,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details HCP Treatment Provider
.
PR6I3025  MOVE      PMEXTPRO,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Authorisation Number
.
PR6I3026  MOVE      PMEXAUTH,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Authorisation Date 
.
PR6I3027  MATCH     SP70,PMEXAUDA
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXAUDA,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details MAB Reference Number
.
PR6I3028  MOVE      PMEXREFN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Police Station Accident rep to
.
PR6I3029  MOVE      PMEXPOLI,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Car Reg No Involved
.
PR6I3030  MOVE      PMEXREGO,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details 1-Driver 2=Passenger
.
PR6I3031  MATCH     "2",PMEXDRPS
          IF        @EQUAL
            MOVE      "Passenger",VARIABLE
          ENDIF
.
          MATCH     "1",PMEXDRPS
          IF        @EQUAL
            MOVE      "Driver",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details While Eng. in-free format entry
.
PR6I3032  MOVE      PMEXENGD,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Patient Injured When
.
PR6I3033  MOVE      PMEXINJR,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Mode of Transport
.
PR6I3034  MOVE      PMEXMTRN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Mechanism of Severist Injury
.
PR6I3035  MOVE      PMEXMSEV,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Region of severist injury
.
PR6I3036  MOVE      PMEXRSEV,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Other Driver Details Line 1
.
PR6I3037  MOVE      PMEXODD1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Other Driver Details Line 2
.
PR6I3038  MOVE      PMEXODD2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Other Driver Details Line 3
.
PR6I3039  MOVE      PMEXODD3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details TAC Clm Form completed/Settle
.
PR6I3040  MATCH     "1",PMEXTCLM
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXTCLM
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Role In Accident (Cat RA)
.
PR6I3041  MOVE      PMEXMTYP,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Role In Accident Desc
.
PR6I3042  MOVE      "RA",TCODE
          PACK      ACODE,PMEXMTYP,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Alternate Selection (Cat CL)
.
PR6I3043  MOVE      PMEXALEL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Alternate Selection Desc
.
PR6I3044  MOVE      "CL",TCODE
          PACK      ACODE,PMEXALEL,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Police Officer 1=Yes 0=No
.
PR6I3045  MATCH     "1",PMEXPOLC
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PMEXPOLC
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details ID Number
.
PR6I3046  MOVE      PMEXIDNO,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Name of School
.
PR6I3047  MOVE      PMEXSCHL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Web User ID Created 
.
PR6I3048  MOVE      PMEXCUID,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Date Record Created
.
PR6I3049  MATCH     SP70,PMEXCDAT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXCDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Time Record Created
.
PR6I3050  MOVE      PMEXCTIM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Web User ID Updated
.
PR6I3051  MOVE      PMEXUUID,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Date Record Updated
.
PR6I3052  MATCH     SP70,PMEXUDAT
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          UNPACK    PMEXUDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient System Extra Compensable Details Time Record Updated
.
PR6I3053  MOVE      PMEXUTIM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Number
.
PR6I3054  MOVE      ICODE,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Name
.
PR6I3055  MOVE      INAME,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Address Line 1
.
PR6I3056  MOVE      IADD1,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Address Line 2
.
PR6I3057  MOVE      IADD2,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Address Line 3
.
PR6I3058  MOVE      IADD3,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Address Line 4
.
PR6I3059  MOVE      IADD4,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Postcode
.
PR6I3060  MOVE      IPOST,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Contact
.
PR6I3061  MOVE      ICONT,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Telephone Business
.
PR6I3062  MOVE      ITELEB,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Amount to be Billed
.
PR6I3063  MOVE      IBILL,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Amount Outstanding
.
PR6I3064  MOVE      IAOUT,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Sort Key
.
PR6I3065  MOVE      ISORT,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Eclipse Sender Contact Email
.
PR6I3066  MOVE      PTINSCEM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Eclipse Sender Contact Name
.
PR6I3067  MOVE      PTINSCPN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Eclipse Sender Contact Phone
.
PR6I3068  MOVE      PTINSCPP,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Active Flag
.
PR6I3069  MATCH     "1",PTINACTV
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
.
          MATCH     "0",PTINACTV
          IF        @EQUAL
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Fax Number
.
PR6I3070  MOVE      PTINFAXN,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Insurance Email Address
.
PR6I3071  MOVE      PTINEMAI,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Service Code (Cat Ve)
.
PR6I3072  MOVE      PTINSERV,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Service Code Desc
.
PR6I3073  MOVE      "Ve",TCODE
          PACK      ACODE,PTINSERV,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Claim Code (Cat CL)
.
PR6I3074  MOVE      PTINCLAI,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Insurance Details Claim Code Desc
.
PR6I3075  MOVE      "CL",TCODE
          PACK      ACODE,PTINCLAI,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Patient First Name
.
PR6I3076  MOVE      PMPXFNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Second Name
.
PR6I3077  MOVE      PMPXSNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Admission Comments (multiline)
.
PR6I3078  CALL      ADCMNT00
          GOTO      PR6I5000
.
.------ Team Description
.
PR6I3079  MOVE      SP70,PMTMDESC
          MATCH     SP70,PMVXTEAM
          IF        !@EQUAL
            PACK      KEY5,PMVXTEAM,SP70
            CALL      RDPMTEM1
          ENDIF
          MOVE      PMTMDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Mental Health Reception Order Time
.
PR6I3080  MOVE      MHVIROTM,VARIABLE
          GOTO      PR6I5000
.
.------ Division
.
PR6I3081  MOVE      SP70,TDESC
          CALL      GDIVN000                * get division
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
. ------- ward/bed short description -------
.
PR6I3082  COMPARE   ONE,ASTAT                * Ward - check for pre-adm
          IF        @EQUAL
            PACK      KEY6,PTMIXWRD,SP6      * Use Expected Ward for Pre-Adm.
          ELSE
            PACK      KEY6,AWARD,ABED
          ENDIF
          CALL      RDWARD1
          BRANCH    OVRCD,PR6I5000
          PACK      VARIABLE,PTWDSDES,SP30,SP30,SP30
          GOTO      PR6I5000
.
.------ Admitting point ward/bed short description  --------
.
PR6I3083  MATCH     SP70,PMVXAPWD
          IF        @EQUAL
            MOVE      SP70,VARIABLE
            GOTO      PR6I5000
          ENDIF
          PACK      KEY6,PMVXAPWD,PMVXAPBD
          CALL      RDWARD1
          IF        OVRCD = 0
            MOVE     PTWDSDES,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
. ------- ward only short description -------
.
PR6I3084  COMPARE   ONE,ASTAT                * Ward - check for pre-adm
          IF        @EQUAL
            PACK      KEY6,PTMIXWRD,SP6      * Use Expected Ward for Pre-Adm.
          ELSE
            PACK      KEY6,AWARD,SP70
          ENDIF
          CALL      RDWARD1
          BRANCH    OVRCD,PR6I5000
          PACK      VARIABLE,PTWDSDES,SP30,SP30,SP30
          GOTO      PR6I5000
.
.------ DVA Card Colour --------
.
PR6I3085  MOVE      THREE,DIM1
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDDVAC
          IF        !@EQUAL & !@EOS
            MOVE      "DX",DIM2
            PACK      KEY5,DIM2,PMCDDVAC,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
.------ Alternate Contact Type (pmscexaf) ------
.
PR6I3086  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCETYPE,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Title (pmscexaf) ------
.
PR6I3087  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCETITL,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Surname (pmscexaf) ------
.
PR6I3088  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCESNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Given Name 1 (pmscexaf) ------
.
PR6I3089  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEGNAM,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Given Name 2 (pmscexaf) ------
.
PR6I3090  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEGNM2,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Formatted Name (pmscexaf) ------
.
PR6I3091  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCESNAM,PACSNAME
          MOVE      PMCEGNAM,PACGNAME
          MOVE      PMCETITL,PACTITLE
          MOVE      "1",PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Address Line 1 (pmscexaf) ------
.
PR6I3092  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEADD1,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Address Line 2 (pmscexaf) ------
.
PR6I3093  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEADD2,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Address Line 3 (pmscexaf) ------
.
PR6I3094  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEADD3,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Address Line 4 (pmscexaf) ------
.
PR6I3095  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEADD4,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Post Code (pmscexaf) ------
.
PR6I3096  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEPOST,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Relationship (pmscexaf) ------
.
PR6I3097  CALL      ALTC0000                * Get alternate contact details
          PACK      KEY10,PMCERELP,SP70     
          CALL      RDPMREL1
          IF        OVRCD=1
            MOVE      KEY10,PMRLDESC
          ENDIF
          MOVE      PMRLDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Home Phone (pmscexaf) ------
.
PR6I3098  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCETELP,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Work Phone (pmscexaf) ------
.
PR6I3099  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCETELB,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Mobile Phone (pmscexaf) ------
.
PR6I3100  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCETELM,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Email Address (pmscexaf) ------
.
PR6I3101  CALL      ALTC0000                * Get alternate contact details
          MOVE      PMCEEMAI,VARIABLE
          GOTO      PR6I5000
.
.------ Alternate Contact Send Letter Flag (pmscexaf) ------
.
PR6I3102  CALL      ALTC0000                * Get alternate contact details
          MATCH     "1",PMCESLET
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ Provisional Diagnosis Code ------
.
PR6I3103  PACK      VARIABLE,SP70
.
          MATCH     SP70,PMVXPICD
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PMVXPICD,KEY9
          CALL      RDPTICD1                * read appropriate table
          BRANCH    OVRCD,PR6I5000
          MOVE      PMVXPICD,VARIABLE
          GOTO      PR6I5000
.
.------ Provisional Diagnosis Desc ------
.
PR6I3104  PACK      VARIABLE,SP70
.
          MATCH     SP70,PMVXPICD
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      PMVXPICD,KEY9
          CALL      RDPTICD1                * read appropriate table
          BRANCH    OVRCD,PR6I5000
          MOVE      DDESC,VARIABLE
          GOTO      PR6I5000
.
.------ Mental Health Legal Status Code at Admission ------
.
PR6I3105  PACK      VARIABLE,SP70
          CALL      GMHDLS00                * Mental Health Legal Status
          GOTO      PR6I5000
.
.------ Mental Health Legal Status Desc at Admission ------
.
PR6I3106  PACK      TDESC,SP70
          CALL      GMHDLS00                * Mental Health Legal Status
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6I3107  CALL      GMCARD00                 * Multiple Card Type Code
          MOVE      PMCDCTYP,VARIABLE
          GOTO      PR6I5000
.
PR6I3108  CALL      GMCARD00                 * Multiple Card Type Description
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
PR6I3109  CALL      GMCARD00                 * Multiple Card Type Expiry date
          MATCH     PMCDEXDT,SP70
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
PR6I3110  PACK      KEY8,ADMISSNO,SP70
          CALL      RDPTQMH1
          IF        OVRCD = 1 
            MOVE      SP70,VARIABLE
          ELSE
            MATCH   "1",PTQMPSNS
            IF      @EQUAL
              MOVE    "Age",VARIABLE
            ENDIF
.
            MATCH   "2",PTQMPSNS
            IF      @EQUAL
              MOVE    "Repatriation",VARIABLE
            ENDIF
.
            MATCH   "3",PTQMPSNS
            IF      @EQUAL
              MOVE    "Invalid",VARIABLE
            ENDIF
.
            MATCH   "4",PTQMPSNS
            IF      @EQUAL
              MOVE    "Unemployment Benefit",VARIABLE
            ENDIF
.
            MATCH   "5",PTQMPSNS
            IF      @EQUAL
              MOVE    "Sickness Benefit",VARIABLE
            ENDIF
.
            MATCH   "7",PTQMPSNS
            IF      @EQUAL
              MOVE    "Other",VARIABLE
            ENDIF
.
            MATCH   "8",PTQMPSNS
            IF      @EQUAL
              MOVE    "No Pension/Benefit",VARIABLE
            ENDIF
          ENDIF 
          GOTO      PR6I5000
.
PR6I3111  MOVE      PTMIPHPU,VARIABLE       * Health Purchaser Code (CAT HP)
          GOTO      PR6I5000
.
PR6I3112  PACK      TCODE,ANSH,ANSP,SP70
          PACK      ACODE,PTMIPHPU,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE          * Health Purchaser Description
          GOTO      PR6I5000
.
PR6I3113  PACK      TCODE,ANST,SP70
          PACK      ACODE,PTYPE,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE          * Patient Type Description
          GOTO      PR6I5000
.
PR6I3114  PACK      PACFNAME,SP70,SP70
          MOVE      ADOCTA,KEY6
          MATCH     SP70,KEY6
          IF        !@EQUAL
            CALL      RDDOCT1
            IF        OVRCD <> 1
              MOVE      DSNAME,PACSNAME
              MOVE      DGNAME,PACGNAME
              MOVE      DTITL,PACTITLE
              MOVE      ONE,PACFRMT
              CALL      PACNAME
            ENDIF
          ENDIF
          MOVE      PACFNAME,VARIABLE       * Attending Doctor format 1
          GOTO      PR6I5000
.
PR6I3115  PACK      PACFNAME,SP70,SP70
          PACK      KEY10,PMVXRHC1,SP70
          MATCH     SP70,KEY10
          IF        !@EQUAL
            CALL      RDPMHCP1
            IF        OVRCD <> 1
              MOVE      PMHCSNAM,PACSNAME
              MOVE      PMHCGNAM,PACGNAME
              MOVE      PMHCTITL,PACTITLE
              MOVE      ONE,PACFRMT
              CALL      PACNAME
            ENDIF
          ENDIF
          MOVE      PACFNAME,VARIABLE       * Referring Doctor format 1
          GOTO      PR6I5000
.
PR6I3116  CLEAR     DISPNAME
          PACK      NAME35,PTITL,SP70
          CALL      NAMSTR00
          PACK      NAME35,PGNAME,SP70
          CALL      NAMSTR00
          PACK      NAME35,PSNAME,SP70
          CALL      NAMSTR00
          RESET     DISPNAME
          MOVE      DISPNAME,VARIABLE       * Formatted Patient Name (full)
          GOTO      PR6I5000
.
PR6I3117  PACK      VARIABLE,SP70
.
          MATCH     "1",PTCNUNET
          IF        !@EQUAL
            MATCH     "3",PTCNUNET
            IF        !@EQUAL
              GOTO      PR6I5000
            ENDIF
          ENDIF
.
          CALL      GTIHINUM
          LJUSTIFY  IHINUMBR
          UNPACK    IHINUMBR,DIM4,DIM4A,DIM4B,DIM4C
          PACK      VARIABLE,DIM4,SP1,DIM4A,SP1,DIM4B,SP1,DIM4C
          GOTO      PR6I5000
.
.------ Patient First Name in sentence case
.
PR6I3118  UNPACK    PMPXFNAM,ANS,KEY39
          REP       UPPLOW,ANS                       * Convert to Uppercase
          REP       DOWNCASE,KEY39                   * Convert to lowercase
          PACK      KEY40,ANS,KEY39,SP70
          MOVE      KEY40,VARIABLE
          GOTO      PR6I5000
.
.------ Patient Second Name in sentence case
.
PR6I3119  UNPACK    PMPXSNAM,ANS,KEY39
          REP       UPPLOW,ANS                         * Convert to Uppercase
          REP       DOWNCASE,KEY39                     * Convert to lowercase
          PACK      KEY40,ANS,KEY39,SP70
          MOVE      KEY40,VARIABLE
          GOTO      PR6I5000
.
.------ Local HCP Name (pmi based) - default to HCP Practice Name if empty
.
PR6I3120  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      TWO,F2             * Local GP Formatted Full Name
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format full name
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Address Line 1 (pmi based)
.
PR6I3121  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      THREE,F2           * HCP Practice Address Line 1
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format value
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Address Line 2 (pmi based)
.
PR6I3122  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      FOUR,F2            * HCP Practice Address Line 2
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format value
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Address Line 3 (pmi based)
.
PR6I3123  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      FIVE,F2            * HCP Practice Address Line 3
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format value
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Address Line 4 (pmi based)
.
PR6I3124  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      SIX,F2             * HCP Practice Address Line 4
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format value
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Address Line 5 (pmi based)
.
PR6I3125  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      SEVEN,F2           * HCP Practice Address Line 5
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format value
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Address Line 6 (pmi based)
.
PR6I3126  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      EIGHT,F2           * HCP Practice Address Line 6
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          MOVE      VARIABLE,LINE80
          CALL      CASE0000           * Format value
          PACK      VARIABLE,LINE80,SP70,SP70
          GOTO      PR6I5000
.
.------ Local HCP Practice Post Code (pmi based)
.
PR6I3127  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      NINE,F2            * HCP Practice Post Code
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          GOTO      PR6I5000
.
.------ Local HCP Practice Telephone (pmi based)
.
PR6I3128  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      TEN,F2             * HCP Practice Telephone
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          GOTO      PR6I5000
.
.------ Local HCP Practice Fax Number (pmi based)
.
PR6I3129  PACK      VARIABLE,SP70,SP70
          PACK      PMHCSNAM,SP70
          MOVE      TEN1,F2            * HCP Practice Fax Number
          CALL      PRHCP000
.
          MATCH     SP70,PMHCSNAM      * blank Local GP name?
          IF        @EQUAL
            CALL      PRHCG000         * use Practice
          ENDIF
.
          GOTO      PR6I5000
.
.------ Admitting Point (Cat "ap")
.
PR6I3130  PACK      VARIABLE,SP70,SP70
          MATCH     SP70,PMVXAPWD
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY5,CATap,PMVXAPWD
          CALL      RDCODE1
          IF        OVRCD=0
            MOVE      TDESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.-------- DVA Visit Yes or No
.
PR6I3131  PACK      VARIABLE,SP70,SP70
          MOVE      "No",VARIABLE
          MATCH     "1",PMVXRDVA
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.-------  Date Of Accident (TAC) ------
.
PR6I3132  PACK      VARIABLE,SP70,SP70
          MOVE      ACLAIM,CLAIMCOD
          CALL      CMPH0000
          MATCH     SP70,MACDAT
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    MACDAT,CCENT,CYEAR,CMON,CDAY    * Date of Accident
          CALL      PACDATE
          MOVE      CPDATE,VARIABLE
          GOTO      PR6I5000
.
.-------  Pre assessment Date -------
.
PR6I3133  PACK      VARIABLE,SP70,SP70
          MATCH     SP70,BKREPDAT
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    BKREPDAT,CCENT,CYEAR,CMON,CDAY *Expected due date (CCYYMMDD)
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP70
          GOTO      PR6I5000
.
.-------  Pre assessment Time -------
.
PR6I3134  PACK      VARIABLE,SP70,SP70
          MOVE      BKREPTIM,VARIABLE           * Pre-assessment time
          GOTO      PR6I5000
.
.-------  Casemix Code -------
.
PR6I3135  PACK      VARIABLE,SP70,SP70
          MOVE      PTMIPCMX,VARIABLE           * Casemix Code
          GOTO      PR6I5000
.
.-------  Planned Length of Stay -------
.
PR6I3136  PACK      VARIABLE,SP70,SP70
          MOVE      ASTAY,VARIABLE              * Planned Length of Stay
          GOTO      PR6I5000
.
.-------  Referring Doctor Fax -------
.
PR6I3137  PACK      VARIABLE,SP70,SP70
          CALL      RDOCFX00                    * Referring Doctor Fax
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 1 -------
.
PR6I3138  PACK      VARIABLE,SP70,SP70
          MOVE      ONE,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 2 -------
.
PR6I3139  PACK      VARIABLE,SP70,SP70
          MOVE      TWO,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 3 -------
.
PR6I3140  PACK      VARIABLE,SP70,SP70
          MOVE      THREE,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 4 -------
.
PR6I3141  PACK      VARIABLE,SP70,SP70
          MOVE      FOUR,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 5 -------
.
PR6I3142  PACK      VARIABLE,SP70,SP70
          MOVE      FIVE,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 6 -------
.
PR6I3143  PACK      VARIABLE,SP70,SP70
          MOVE      SIX,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 7 -------
.
PR6I3144  PACK      VARIABLE,SP70,SP70
          MOVE      SEVEN,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 8 -------
.
PR6I3145  PACK      VARIABLE,SP70,SP70
          MOVE      EIGHT,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 9 -------
.
PR6I3146  PACK      VARIABLE,SP70,SP70
          MOVE      NINE,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Theatre Procedure MBS Description & Date 10 -------
.
PR6I3147  PACK      VARIABLE,SP70,SP70
          MOVE      TEN,FORM3                   * Get 1st MBS Item Desc/Date
          CALL      GETMBS00
          GOTO      PR6I5000
.
.-------  Referring Doctor Title (use ADOCTR if not blank) -------
.
PR6I3148  MOVE      SP70,VARIABLE
          MATCH     SP70,ADOCTR
          GOTO      PR6I2639 IF NOT EQUAL
.
          MATCH     SP70,PMVXRHC1
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      ONE,FORM2
          PACK      KEY10,PMVXRHC1,SP70
          CALL      GETHCP00
          GOTO      PR6I5000
.
.-------  Referring Doctor First Name (use ADOCTR if not blank) -------
.
PR6I3149  MOVE      SP70,VARIABLE
          MATCH     SP70,ADOCTR
          GOTO      PR6I2640 IF NOT EQUAL
.
          MATCH     SP70,PMVXRHC1
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      TWO,FORM2
          PACK      KEY10,PMVXRHC1,SP70
          CALL      GETHCP00
          GOTO      PR6I5000
.
.-------  Referring Doctor Surname (use ADOCTR if not blank) -------
.
PR6I3150  MOVE      SP70,VARIABLE
          MATCH     SP70,ADOCTR
          GOTO      PR6I2641 IF NOT EQUAL
.
          MATCH     SP70,PMVXRHC1
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      THREE,FORM2
          PACK      KEY10,PMVXRHC1,SP70
          CALL      GETHCP00
          GOTO      PR6I5000
.
.-------  Multiple Card Type Number -------
.
PR6I3151  CALL      GMCARD00                 * Multiple Card Type Number
          MOVE      PMCDCNUM,VARIABLE
          GOTO      PR6I5000
.
.-------  Case Team Code (visit based) -------
.
PR6I3152  MOVE      PMVXCASE,VARIABLE
          GOTO      PR6I5000
.
.-------  Case Team Description (visit based) -------
.
PR6I3153  MOVE      SP70,VARIABLE
          MATCH     SP70,PMVXCASE
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY10,PMVXCASE,SP70
          CALL      RDALCAS1
          IF        OVRCD=0
            MOVE      ALCADESC,VARIABLE
          ENDIF
          GOTO      PR6I5000
.
.------ format Admission Diet code ------
.
PR6I3154  MOVE      ADIET,VARIABLE
          GOTO      PR6I5000
.
.------ format Admission Diet description ------
.
PR6I3155  MOVE      "DC",TCODE
          PACK      ACODE,ADIET,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format Preferred Accommodation code ------
.
PR6I3156  MOVE      PMVXPACC,VARIABLE
          GOTO      PR6I5000
.
.------ format Preferred Accommodation description ------
.
PR6I3157  MOVE      "BP",TCODE
          PACK      ACODE,PMVXPACC,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ format User Defined Code 9 code ------
.
PR6I3158  MOVE      PTMIUSR9,VARIABLE
          GOTO      PR6I5000
.
.------ format User Defined code 9 description ------
.
PR6I3159  MOVE      "U9",TCODE
          PACK      ACODE,PTMIUSR9,SP3
          CALL      GTCOD000                 * Read the patient codes file
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ admission ward from transfer table ------
.
PR6I3160  OPEN      PATTRAN2,"pattranf"
.
          PACK      KEY30 WITH AADMNO,SP70
          CALL      RDSTRAN2
          CALL      RDKTRAN2
          BRANCH    OVRCD,PR6I316A
.
          MATCH     AADMNO,TADMN
          GOTO      PR6I316A IF NOT EQUAL
.
          MATCH     "A",TMOVE
          GOTO      PR6I316A IF NOT EQUAL
.
          PACK      VARIABLE,TWARD,SP70,SP70,SP70
.
          MATCH     SP70,TWARD
          IF        !@EQUAL
            PACK      KEY6,TWARD,SP70
            CALL      RDWARD1
            BRANCH    OVRCD,PR6I316A
.
            PACK      VARIABLE,WBDESC,SP70,SP70,SP70
          ENDIF
.
PR6I316A  CLOSE     PATTRAN2
          GOTO      PR6I5000
.
.------ discharge ward from transfer table ------
.
PR6I3161  OPEN      PATTRAN2,"pattranf"
.
          PACK      KEY30 WITH AADMNO,Z70
          CALL      RDSTRAN2
          CALL      RDPTRAN2
          BRANCH    OVRCD,PR6I316B
.
          MATCH     AADMNO,TADMN
          GOTO      PR6I316B IF NOT EQUAL
.
          MATCH     "D",TMOVE
          GOTO      PR6I316B IF NOT EQUAL
.
          PACK      VARIABLE,TWARD,SP70,SP70,SP70
.
          MATCH     SP70,TWARD
          IF        !@EQUAL
            PACK      KEY6,TWARD,SP70
            CALL      RDWARD1
            BRANCH    OVRCD,PR6I316B
.
            PACK      VARIABLE,WBDESC,SP70,SP70,SP70
          ENDIF
.
PR6I316B  CLOSE     PATTRAN2
          GOTO      PR6I5000
.
.------ Fund Excess for Same Day (Eligibility) ------
.
PR6I3162  MOVE      PTELXCSD,VARIABLE
          GOTO      PR6I5000
.
.------ ADOCTA Provider Number ------
.
PR6I3163  PACK      VARIABLE,SP70,SP70
.
          MATCH     SP70,ADOCTA
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY16,ADOCTA,SP70
          CALL      RSPMHCP4
          CALL      RKPMHCP4
          BRANCH    OVRCD,PR6I5000
.
          MATCH     ADOCTA,PMHCLDOC
          GOTO      PR6I5000 IF NOT EQUAL
.
          MOVE      PMHCPRV1,VARIABLE
          GOTO      PR6I5000
.
.------ PMVXEDC1 Provider Number ------
.
PR6I3164  PACK      VARIABLE,SP70,SP70
.
          MATCH     SP70,PMVXEDC1
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY10,PMVXEDC1,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PR6I5000
.
          PACK      KEY24,ADMISSNO,SP70
          CALL      RSPMDTC1
PR6I364A  CALL      RKPMDTC1
          BRANCH    OVRCD,PR6I364Z
.
          MATCH     ADMISSNO,PMDTVISN
          GOTO      PR6I364Z IF NOT EQUAL
.
          MATCH     PMVXEDC1,PMDTDOCT
          GOTO      PR6I364A IF NOT EQUAL
.
          MATCH     PMVXEDU1,PMDTUNIT
          GOTO      PR6I364A IF NOT EQUAL
.
          MATCH     SP70,PMDTEDAT
          GOTO      PR6I364Z IF EQUAL
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          CLOCK     TIME,CTIMEIS   
.
          MATCH     CURRDATE,PMDTEDAT
          GOTO      PR6I5000 IF LESS
          GOTO      PR6I364Z IF NOT EQUAL
.
          MATCH     CTIMEIS,PMDTETIM
          GOTO      PR6I5000 IF LESS
.
PR6I364Z  MOVE      PMHCPRV1,VARIABLE
          GOTO      PR6I5000
.
.------ PMVXRHC1 Provider Number ------
.
PR6I3165  PACK      VARIABLE,SP70,SP70
.
          MATCH     SP70,PMVXRHC1
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PR6I5000
.
          MOVE      PMHCPRV1,VARIABLE
          GOTO      PR6I5000
.
.------ PMPXRPER Record Retention Period Description (Cat rt) ------
.
PR6I3166  PACK      VARIABLE,SP70,SP70
.
          MATCH     SP70,PMPXRPER
          GOTO      PR6I5000 IF EQUAL
.
          PACK      KEY5,ANSR,ANST,SP70
          REP       LOWUPP,KEY5
          STRIP     KEY5
          ENDSET    KEY5
          APPEND    PMPXRPER,KEY5
          APPEND    SP70,KEY5
          RESET     KEY5
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          MOVE      TDESC,VARIABLE
          GOTO      PR6I5000
.
.------ PMPXRDAT Record Retention Date ------
.
PR6I3167  PACK      VARIABLE,SP70,SP70
.
          MATCH     SP70,PMPXRDAT
          GOTO      PR6I5000 IF EQUAL
.
          UNPACK    PMPXRDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      VARIABLE,CPCDATE,SP70
.
          GOTO      PR6I5000
.
. ------- print alert care pathway fields -------
.
PR6I3168  SUB       "1167",FORM5            * get so first item is number 1
          PROC      PRTALCPW                * print alert care pathway fields
          GOTO      PR6I5000
.
. ------- Medical Records Alert Description -------
.
PR6I3198  MATCH     SP70,PTMXSIN1
          GOTO      PR6I5000 IF EQUAL
          GOTO      PR6I5000 IF EOS
.
          MATCH     "3",PTMXSIN1
          GOTO      PR6I5000 IF EQUAL
.
          CLEAR     VARIABLE
          APPEND    "WARNING ",VARIABLE
          SQUEEZE   CALRDESC
          APPEND    CALRDESC,VARIABLE
          APPEND    "'s exist for this patient",VARIABLE
          RESET     VARIABLE          
.
          PACK      VARIABLE,VARIABLE,SP70
. 
          GOTO      PR6I5000
.
PR6I3199  MOVE      AADMNO,KEY8
          CALL      RDPMWX11
          IF        OVRCD<>1
            PACK      VARIABLE,PMWXPORD,SP70
          ENDIF
.  
          GOTO      PR6I5000
.
PR6I3200  MOVE      PMPXMSNO,VARIABLE
          GOTO      PR6I5000
.
PR6I3201  OPEN      PATELGA1,"patelgaf"
          PACK      KEY8,AADMNO,SP70
          CALL      RDPTELG1
          IF        OVRCD=1
            MOVE      "N/A",VARIABLE
          ELSE
            PACK      VARIABLE,PTELPCCU
            LJUSTIFY  VARIABLE
            STRIP     VARIABLE
          ENDIF
          CLOSE     PATELGA1
          GOTO      PR6I5000
.
PR6I3202  OPEN      PATELGA1,"patelgaf"
          PACK      KEY8,AADMNO,SP70
          CALL      RDPTELG1
          IF        OVRCD=1
            MOVE      "N/A",VARIABLE
          ELSE
            PACK      VARIABLE,PTELPCUT
            LJUSTIFY  VARIABLE
            STRIP     VARIABLE
          ENDIF
          CLOSE     PATELGA1
          GOTO      PR6I5000
.         
.----- format patient sex long description ------
.
PR6I3203  MOVE      PSEX,DSEXCHAR
          CALL      SEXDSP00                
          MOVE      DSEXLDES,VARIABLE        * Get sex long description  
          GOTO      PR6I5000
.
.------ format the discharge date dd/mm/ccyy ------
.
PR6I3204  MOVE      SP8,CPCDATE
          COMPARE   THREE,ASTAT              * patient must be discharged
          IF        @EQUAL
            UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
.
          MOVE      CPCDATE,VARIABLE
          GOTO      PR6I5000
.
PR6I3205  MOVE      AURNO,MBIRURNO
          CALL      MULBIR00                 * Get multlple birth details
          MOVE      MBIRTYOR,VARIABLE
          GOTO      PR6I5000
.
PR6I3206  MOVE      PTCNSTYP,VARIABLE        * Get System Letter Type
          GOTO      PR6I5000
.
PR6I3207  PACK      KEY8,URNUMBER,SP8        * Get PCEHR Flag MHR
          CALL      RDPMPX21  
          MOVE      PMPXSN10,VARIABLE       
          GOTO      PR6I5000 
.
PR6I3208  PACK      KEY8,URNUMBER,SP8        * Get MyHR Consent Flag
          CALL      RDPMPX21
          MOVE      PMPXSN16,VARIABLE
          GOTO      PR6I5000
.
PR6I3209  PACK      KEY8,URNUMBER,SP8        * Get Scanned Medical Record - SMR
          CALL      RDPMPX21
          MOVE      PMPXSN17,VARIABLE
          GOTO      PR6I5000
.
PR6I3210  CLEAR     DISPNAME
          PACK      NAME35,PMPXFNAM,SP70     * Convert 1st Given Name in 
          CALL      NAMSTR00                 * Propercase format
          APPEND    SP70,DISPNAME
          RESET     DISPNAME
          MOVE      DISPNAME,VARIABLE
          STRIP     VARIABLE
          GOTO      PR6I5000
.
PR6I3211  CLEAR     DISPNAME
          PACK      NAME35,PMPXSNAM,SP70     * Convert 2nd Given Name in
          CALL      NAMSTR00                 * Propercase format 
          APPEND    SP70,DISPNAME
          RESET     DISPNAME
          MOVE      DISPNAME,VARIABLE
          STRIP     VARIABLE 
          GOTO      PR6I5000
.
PR6I3212  PACK      VARIABLE,PMPXPFSN,SP70   * Preferred Surname
          GOTO      PR6I5000
.
PR6I3213  PACK      VARIABLE,PMPXPFGN,SP70   * Preferred Given Name
          GOTO      PR6I5000
.
PR6I3214  PACK      VARIABLE,PSNAME,SP70     * Pref Surname instead of Actual SN
          MATCH     "1",PTCNPFSN
          IF        @EQUAL
            MATCH     SP70,PMPXPFSN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFSN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PR6I3215  PACK      VARIABLE,PGNAME,SP70     * Pref GN instead of Actual GN
          MATCH     "1",PTCNPFGN
          IF        @EQUAL
            MATCH     SP70,PMPXPFGN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFGN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PR6I3216  PACK      VARIABLE,PTMASNAM,SP70   * Pref Surname instead of 40char SN
          MATCH     "1",PTCNPFSN
          IF        @EQUAL
            MATCH     SP70,PMPXPFSN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFSN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PR6I3217  PACK      VARIABLE,PMPXUCC4,SP70       * Identify gender
          GOTO      PR6I5000
.
PR6I3218  PACK      VARIABLE,SP70                * Identify gender long desc
          MOVE      SP70,PTCDLDES
          MATCH     SP70,PMPXUCC4
          IF        !@EQUAL
            MOVE      "Gi",DIM2
            PACK      KEY5,DIM2,PMPXUCC4,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF 
          ENDIF
          GOTO      PR6I5000
.
PR6I3219  PACK      VARIABLE,PMPXATF1,SP70,SP70  * Identify gender Free Text
          GOTO      PR6I5000
.
PR6I3220  PACK      VARIABLE,PMPXUCC5,SP70       * Identify pronoun
          GOTO      PR6I5000
.
PR6I3221  PACK      VARIABLE,SP70                * Identif pronoun long desc
          MOVE      SP70,PTCDLDES
          MATCH     SP70,PMPXUCC5
          IF        !@EQUAL
            MOVE      "Gp",DIM2
            PACK      KEY5,DIM2,PMPXUCC5,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PR6I3222  PACK      VARIABLE,PMPXATF2,SP70,SP70  * Identify Pronoun Free Text
          GOTO      PR6I5000
.
PRT12230  CALL      ALRALL00                 * Print Pat Alert - All Category 
          GOTO      PR6I5000 
.
PRT12240  MOVE      "H1",WORKCATG            * Print Patient Alert - H1
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12250  MOVE      "H2",WORKCATG            * Print Patient Alert - H2
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12260  MOVE      "H3",WORKCATG            * Print Patient Alert - H3
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12270  MOVE      "H4",WORKCATG            * Print Patient Alert - H4
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12280  MOVE      "H5",WORKCATG            * Print Patient Alert - H5
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12290  MOVE      "H6",WORKCATG            * Print Patient Alert - H6
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12300  MOVE      "H7",WORKCATG            * Print Patient Alert - H7
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12310  MOVE      "H8",WORKCATG            * Print Patient Alert - H8
          CALL      ALRALC00                 
          GOTO      PR6I5000
.
PRT12320  MOVE      "H9",WORKCATG            * Print Patient Alert - H9
          CALL      ALRALC00                
          GOTO      PR6I5000
.
PRT12330  PACK      VARIABLE,PMPXETH1,SP70   * Ethnicity 1 Code
          GOTO      PR6I5000
.
PRT12340  MATCH     SP70,PMPXETH1
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      "EN",DIM2
          PACK      KEY5,DIM2,PMPXETH1,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PTCDLDES,SP70   * Ethnicity 1 Long Desc
          GOTO      PR6I5000
.
PRT12350  PACK      VARIABLE,PMPXETH2,SP70   * Ethnicity 2 Code
          GOTO      PR6I5000
.
PRT12360  MATCH     SP70,PMPXETH2
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      "EN",DIM2
          PACK      KEY5,DIM2,PMPXETH2,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PTCDLDES,SP70   * Ethnicity 2 Long Desc
          GOTO      PR6I5000
.
PRT12370  PACK      VARIABLE,PMPXLAN1,SP70   * Lang Spoken At Home 1 Code
          GOTO      PR6I5000
.
PRT12380  MATCH     SP70,PMPXLAN1
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      "l1",DIM2
          PACK      KEY5,DIM2,PMPXLAN1,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PTCDLDES,SP70   * Lang Spoken At Home 1 Long Desc
          GOTO      PR6I5000
.
PRT12390  PACK      VARIABLE,PMPXLAN2,SP70   * Lang Spoken At Home 1 Code
          GOTO      PR6I5000
.
PRT12400  MATCH     SP70,PMPXLAN2
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      "l1",DIM2
          PACK      KEY5,DIM2,PMPXLAN2,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PTCDLDES,SP70   * Lang Spoken At Home 1 Long Desc
          GOTO      PR6I5000
.
PRT12410  CALL      GPMCEX00
          BRANCH    EXIT,PR6I5000
.   
          PACK      VARIABLE,PMCELAN1,SP70   * Lang Spoken At Home 1 Code
.                                            * Extra Contact
          GOTO      PR6I5000
.
PRT12420  CALL      GPMCEX00
          BRANCH    EXIT,PR6I5000
.
          MATCH     SP70,PMCELAN1
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      "l1",DIM2
          PACK      KEY5,DIM2,PMCELAN1,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PTCDLDES,SP70   * Lang Spoken At Home 1 Long Desc
.                                            * Extra Contact
          GOTO      PR6I5000
.
PRT12430  CALL      GPMCEX00
          BRANCH    EXIT,PR6I5000
.
          PACK      VARIABLE,PMCELAN2,SP70   * Lang Spoken At Home 2 Code
.                                            * Extra Contact
          GOTO      PR6I5000
.
PRT12440  CALL      GPMCEX00
          BRANCH    EXIT,PR6I5000
.
          MATCH     SP70,PMCELAN2
          GOTO      PR6I5000 IF EQUAL
.
          MOVE      "l1",DIM2
          PACK      KEY5,DIM2,PMCELAN2,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PR6I5000
.
          PACK      VARIABLE,PTCDLDES,SP70   * Lang Spoken At Home 2 Long Desc
.                                            * Extra Contact
          GOTO      PR6I5000
.
PRT12450  MOVE      PTELTOOP,VARIABLE        * Total Out of Pocket $
          GOTO      PR6I5000
.
PRT12460  PACK      VARIABLE,SP70
          PACK      KEY8,AADMNO,SP70
.
          CALL      RDPMVX11
          BRANCH    OVRCD,PR6I5000
          MATCH     "1",PMVXUDF7
          IF        @EQUAL
            PACK    VARIABLE,DYES,SP70       * upload to MyHealth Record
            GOTO      PR6I5000
          ENDIF
          MATCH     "0",PMVXUDF7
          IF        @EQUAL
            PACK    VARIABLE,DNO,SP70       
            GOTO    PR6I5000
          ENDIF
.
          GOTO      PR6I5000
.
PRT12470  PACK      VARIABLE,SP70            * PMI UDF 1 Long Description
          MATCH     SP70,PUSR1
          IF        !@EQUAL
            MOVE      "P1",DIM2
            PACK      KEY5,DIM2,PUSR1,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12480  PACK      VARIABLE,SP70            * PMI UDF 2 Long Description
          MATCH     SP70,PUSR2
          IF        !@EQUAL
            MOVE      "P2",DIM2
            PACK      KEY5,DIM2,PUSR2,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12490  PACK      VARIABLE,SP70            * PMI UDF 3 Long Description
          MATCH     SP70,PUSR3
          IF        !@EQUAL
            MOVE      "P3",DIM2
            PACK      KEY5,DIM2,PUSR3,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12500  PACK      VARIABLE,SP70            * PMI UDF 4 Long Description
          MATCH     SP70,PUSR4
          IF        !@EQUAL
            MOVE      "P4",DIM2
            PACK      KEY5,DIM2,PUSR4,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12510  PACK      VARIABLE,SP70            * PMI UDF 5 Long Description
          MATCH     SP70,PUSR5
          IF        !@EQUAL
            MOVE      "P5",DIM2
            PACK      KEY5,DIM2,PUSR5,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12520  PACK      VARIABLE,SP70            * PMI UDF 6 Long Description
          MATCH     SP70,PUSR6
          IF        !@EQUAL
            MOVE      "P6",DIM2
            PACK      KEY5,DIM2,PUSR6,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12530  PACK      VARIABLE,SP70            * PMI UDF 7 Long Description
          MATCH     SP70,PMPXUSR7
          IF        !@EQUAL
            MOVE      "P7",DIM2
            PACK      KEY5,DIM2,PMPXUSR7,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12540  PACK      VARIABLE,SP70            * PMI UDF 8 Long Description
          MATCH     SP70,PMPXUSR8
          IF        !@EQUAL
            MOVE      "P8",DIM2
            PACK      KEY5,DIM2,PMPXUSR8,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12550  PACK      VARIABLE,SP70            * PMI UDF 9 Long Description
          MATCH     SP70,PMPXUSR9
          IF        !@EQUAL
            MOVE      "P9",DIM2
            PACK      KEY5,DIM2,PMPXUSR9,SP70
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      PTCDLDES,VARIABLE
            ENDIF
          ENDIF
          GOTO      PR6I5000
.
PRT12560  MOVE      PMPXSN21,VARIABLE        * Email Validation Flag
          GOTO      PR6I5000
.
.
. ------- Format the variable -------
.
PR6I5000  BRANCH    MULTILIN,PR6ID100
          RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
          PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      PR6ID100                 * Read next record
.
. ------- Formatting for Form fields and right justified variables -------
.
PR6I6000  COMPARE   ZERO,PRNTSTRT          * Don't bump if printing full length
          GOTO      PR6I7000 IF EQUAL
.
          BUMP      VARIABLE,PRNTSTRT      * bump to starting position
.
. ------- Print the variable -------
.
PR6I7000  PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      PR6ID100                 * Read next record
.
.------ end of MR10 reached ------
.
PR6I8000  MOVE      FALSE,EXIT
.
.------ print new-lines until the end of page is reached ------
.
PR6I9000  COMPARE   CURRROW,IBTHLENG          * test page length
          GOTO      PR6I9999 IF EQUAL
.
          PRINT     *N;
          ADD       ONE,CURRROW
          GOTO      PR6I9000
.
PR6I9999  MOVE      FALSE,EXIT               * Set exit flag
          PACK      SAVFIL8,SPLFILE,SP70     * Used to save the spool file
          CALL      CLSPRINT                 * close the spool file
          RETURN                             * Finished
.
.----------------------------------------------------------------------------
. Get patient alert for an UR - All Categories
.----------------------------------------------------------------------------
ALRALL00  PACK      KEY16,PURNO,SP70
          CALL      RSPTALR1
ALRALL20  CALL      RKPTALR1
          BRANCH    OVRCD,ALRALL99
. 
          MATCH     PURNO,PTALURNO
          GOTO      ALRALL99 IF NOT EQUAL   * Patient not match
.
          PACK      KEY5,PTALCATG,PTALCODE
          CALL      RDCODE1
          BRANCH    OVRCD,ALRALL20          * Invalid alert code
.
          MATCH     ANSP,TCINDC3
          GOTO      ALRALL50 IF EQUAL       * Printable alert
.
          MATCH     ANSA,TCINDC3            * Check active alert
          GOTO      ALRALL20 IF NOT EQUAL
.                                          
. Check active alert
.
          MATCH     SP70,PTALEDAT
          GOTO      ALRALL30 IF EQUAL        * no alert inactive date
.
          MATCH     PTALEDAT,CURRDATE
          GOTO      ALRALL20 IF NOT LESS     * alert end date passed ?
.
ALRALL30  MATCH     SP70,PTALDTIN
          GOTO      ALRALL50 IF EQUAL        * no alert inactive date
.
          MATCH     PTALDTIN,CURRDATE
          GOTO      ALRALL20 IF NOT LESS     * alert inactive date passed ?
.
ALRALL50  MOVE      TDESC,ALRTDESC 
          CALL      PALRT000
.
          GOTO      ALRALL20
.
ALRALL99  RETURN
.
.----------------------------------------------------------------------------
. Get the patient alert for an UR - one category code
.----------------------------------------------------------------------------
ALRALC00  PACK      KEY16,PURNO,WORKCATG,SP70
          CALL      RSPTALR1
ALRALC20  CALL      RKPTALR1
          BRANCH    OVRCD,ALRALC99
.
          MATCH     PURNO,PTALURNO
          GOTO      ALRALC99 IF NOT EQUAL    * Patient not match
.
          MATCH     WORKCATG,PTALCATG
          GOTO      ALRALC99 IF NOT EQUAL    * Code not match
.
          PACK      KEY5,PTALCATG,PTALCODE
          CALL      RDCODE1
          BRANCH    OVRCD,ALRALC20           * Invalid alert code
.
          MATCH     ANSP,TCINDC3
          GOTO      ALRALC50 IF EQUAL        * Printable alert
.
          MATCH     ANSA,TCINDC3             * Check active alert
          GOTO      ALRALC20 IF NOT EQUAL
.
. Check active alert
.
          MATCH     SP70,PTALEDAT
          GOTO      ALRALC30 IF EQUAL        * no alert inactive date
.
          MATCH     PTALEDAT,CURRDATE
          GOTO      ALRALC20 IF NOT LESS     * alert end date passed ?
.
ALRALC30  MATCH     SP70,PTALDTIN
          GOTO      ALRALC50 IF EQUAL        * no alert inactive date
.
          MATCH     PTALDTIN,CURRDATE
          GOTO      ALRALC20 IF NOT LESS     * alert inactive date passed ?
.
ALRALC50  MOVE      TDESC,ALRTDESC
          CALL      PALRT000
.
          GOTO      ALRALC20
.
ALRALC99  RETURN
.
.----------------------------------------------------------------------------
. Print One alert code details - Multiple lines
.----------------------------------------------------------------------------
PALRT000  MOVE      PTALCATG,WORKVAR
          CALL      PALRTL00
.  
          PACK      KEY5,PTALCATG,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      PTALCATG,TDESC
          ENDIF
          MOVE      TDESC,WORKVAR
          CALL      PALRTL10
.  
          MOVE      ALRTDESC,WORKVAR
          CALL      PALRTL10
.
          MOVE      PTALRQBY,WORKVAR
          CALL      PALRTL10
.  
          MOVE      SP70,DOCFNAME
          PACK      KEY10,PTALRQBY,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCTITL,FMTTITLE
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000                   * formatted into DOCFNAME
          ELSE
            MOVE      PTALRQBY,DOCFNAME
          ENDIF
.
          MOVE      DOCFNAME,WORKVAR
          CALL      PALRTL10
.
PALRT200  MOVE      PTALDATE,WRKDTE8
          CALL      CNVDTE00
          MOVE      WRKDTE10,WORKVAR
          CALL      PALRTL10
. 
          MOVE      PTALRDTE,WRKDTE8
          CALL      CNVDTE00
          MOVE      WRKDTE10,WORKVAR
          CALL      PALRTL10
.
          MOVE      PTALEDAT,WRKDTE8
          CALL      CNVDTE00
          MOVE      WRKDTE10,WORKVAR
          CALL      PALRTL10
.  
          MOVE      PTALREAC,WORKVAR
          CALL      PALRTL10
.  
          MOVE      SP70,TDESC 
          MATCH     SP70,PTALREAC
          IF        !@EQUAL & !@EOS
            MOVE      "wn",KEY2
            PACK      KEY5,KEY2,PTALREAC,SP70
            CALL      RDCODE1
            IF        OVRCD=1
              MOVE      PTALREAC,TDESC
            ENDIF
          ENDIF
          MOVE      TDESC,WORKVAR
          CALL      PALRTL10
.
          MOVE      PTALRCOM,WORKVAR
          CALL      PALRTL10
.  
          MOVE      PTALLSEV,WORKVAR
          CALL      PALRTL10
.
          MOVE      PTALUSID,WORKVAR
          CALL      PALRTL10
. 
          MOVE      WBSEUID,SAVKEY10               * Save Web user id 
          PACK      KEY10,PTALUSID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PTALUSID,WBSENAM
          ENDIF
          MOVE      WBSENAM,WORKVAR
.
          PACK      KEY10,SAVKEY10,SP70            * read back websecaf 
          CALL      RDWBSE1
.
          CALL      PALRTL10
.
          CALL      ALRNOT00
.
PALRT999  RETURN
.
.----------------------------------------------------------------------------
. Print first alert detail line. This prints the data at a current position
.----------------------------------------------------------------------------
PALRTL00  STRIP     WORKVAR
          MOVELPTR  WORKVAR,LENGTH
.
          COMPARE   LENGTH,ZERO
          IF        @EQUAL
            MOVE      ONE,LENGTH
          ENDIF
.
          RESET     WORKVAR,IBDTPLEN	
          LENSET    WORKVAR	
          RESET     WORKVAR	
          PRINT     *IBDTCOL,*+,WORKVAR;   
.
          PACK      WORKVAR,SP70,SP70 
.
PALRTL09  RETURN
.
.----------------------------------------------------------------------------
. Print next alert detail line. This prints the data with a new line
.----------------------------------------------------------------------------
PALRTL10  STRIP     WORKVAR
          MOVELPTR  WORKVAR,LENGTH
.
          COMPARE   LENGTH,ZERO
          IF        @EQUAL
            MOVE      ONE,LENGTH
          ENDIF
.
          SFORMAT   VAR,LENGTH
          MOVE      WORKVAR,VAR
          PRINT     *N,VAR;
          SFORMAT   VAR,70
.
          PACK      WORKVAR,SP70,SP70
.
PALRTL19  RETURN
.
.----------------------------------------------------------------------------
. Convert date 8 (ccyymmdd) to date 10 (dd/mm/ccyy)
.----------------------------------------------------------------------------
CNVDTE00  MOVE      SP70,WRKDTE10
          MATCH     SP70,WRKDTE8
          GOTO      CNVDTE99 IF EQUAL
.
          UNPACK    WRKDTE8,CCENT,CYEAR,CMON,CDAY
          PACK      WRKDTE10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR,SP70
.
CNVDTE99  RETURN
.
.----------------------------------------------------------------------------
. Print alert notes 
.----------------------------------------------------------------------------
ALRNOT00  PACK      KEY19,PTALURNO,PTALCATG,PTALCODE,SP70
          CALL      RSPMALN1
ALRNOT20  CALL      RKPMALN1
          BRANCH    OVRCD,ALRNOT99
.
          MATCH     PTALURNO,PMANURNO          * same U/R Number?
          GOTO      ALRNOT99 IF NOT EQUAL
.
          MATCH     PTALCATG,PMANACAT
          GOTO      ALRNOT99 IF NOT EQUAL
.
          MATCH     PTALCODE,PMANACOD
          GOTO      ALRNOT99 IF NOT EQUAL
.
          MOVE      PMANCOMM,WORKVAR
          CALL      PALRTL10
.
          GOTO      ALRNOT20 
.
ALRNOT99  RETURN
+
.******************************************************************************
.*        Get HCP Details                                                     *
.*                                                                            *
.*        Parameters:                                                         *
.*          KEY10 - HCP code                                                  *
.*          FORM2 - Item number (HCP Detail)                                  *
.******************************************************************************
GETHCP00  MOVE      SP70,VARIABLE
          MATCH     SP70,KEY10
          GOTO      GETHCP99 IF EQUAL
.
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETHCP99
.
          BRANCH    FORM2,GETHCP10,GETHCP20,GETHCP30
          GOTO      GETHCP99
.
GETHCP10  MOVE      PMHCTITL,VARIABLE
          GOTO      GETHCP99
.
GETHCP20  MOVE      PMHCGNAM,VARIABLE
          GOTO      GETHCP99
.
GETHCP30  MOVE      PMHCSNAM,VARIABLE
          GOTO      GETHCP99
.
GETHCP99  RETURN
+
.******************************************************************************
.*        Get Referring Doctor Fax                                            *
.******************************************************************************
RDOCFX00  PACK      KEY10,PMVXRHC1,SP10
          CALL      RDPMHCP1
          BRANCH    OVRCD,RDOCFX99
.
          MATCH     "0",PMHCSTTS            * Active HCP?
          GOTO      RDOCFX99 IF NOT EQUAL   * Output blank Fax if Inactive
.
          MATCH     SP70,PMHCFAXN           * No fax number?
          GOTO      RDOCFX10 IF EQUAL
.
          MOVE      PMHCFAXN,VARIABLE       * use HCP Fax
          GOTO      RDOCFX99
.
RDOCFX10  MATCH     SP70,PMVXRH1G           * Referring Practice exists?
          GOTO      RDOCFX99 IF EQUAL
.
          PACK      KEY12,PMVXRH1G,PMVXRH1C,SP20
          CALL      RDPMHCG1
          BRANCH    OVRCD,RDOCFX99
.
          MATCH     "0",PMHGSTTS            * Active Practice?
          GOTO      RDOCFX99 IF NOT EQUAL   * Output blank Fax if Inactive
.
          MATCH     SP70,PMHGPFAX           * No Practice Fax?
          GOTO      RDOCFX99 IF EQUAL
.
          MOVE      PMHGPFAX,VARIABLE       * Use Practice Fax
.
RDOCFX99  RETURN
+
.******************************************************************************
.*        Get Theatre Procedure MBS Description & Date                        *
.******************************************************************************
GETMBS00  PACK      KEY11,AADMNO,SP10
          CALL      RDSMMBS1
GETMBS10  CALL      RDKMMBS1
          BRANCH    OVRCD,GETMBS91
.
          MATCH     AADMNO,MMADMN
          GOTO      GETMBS91 IF NOT EQUAL
.
          COMPARE   FORM3,MMRECN
          GOTO      GETMBS10 IF NOT EQUAL   * Different record number
.
          STRIP     PTMMDESC
          UNPACK    MMDATE,CCENT,CYEAR,CMON,CDAY
          PACK      DIM10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
.
          CLEAR     VARIABLE
          APPEND    PTMMDESC,VARIABLE
          APPEND    TABOCTAL,VARIABLE
          APPEND    DIM10,VARIABLE
          RESET     VARIABLE
.
GETMBS90  MOVE      ZERO,EXIT
          GOTO      GETMBS99
.
GETMBS91  MOVE      ONE,EXIT
GETMBS99  RETURN
+
.******************************************************************************
.*  Get NZ Procedure details if required                                      *
.******************************************************************************
GETNZP00  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TEN9;*212,CFEETYP
          COMPARE   FIVE,CFEETYP            * NZ Private only
          GOTO      GETNZP90 IF NOT EQUAL
.
          PACK      KEY11,ADMISSNO,SP70
          CALL      RSNZSPR1
GETNZP10  CALL      RKNZSPR1
          BRANCH    OVRCD,GETNZP90
.
          MATCH     ADMISSNO,NZSPADMN
          GOTO      GETNZP90 IF NOT EQUAL
.
          COMPARE   "1",NZSPPRIM
          GOTO      GETNZP10 IF NOT EQUAL
          GOTO      GETNZP999
.
GETNZP90  CALL      CLNZSP00
.
GETNZP99  RETURN
+
.------------------------------------------------------------
. Clear file variables for NZPSPRFD
.------------------------------------------------------------
CLNZSP00  MOVE      SP70,NZSPADMN
          MOVE      SP70,NZSPCLMN
          MOVE      SP70,NZSPSURG
          MOVE      SP70,NZSPPROC
          MOVE      SP70,NZSPUNIQ
          MOVE      SP70,NZSPCNTR
          MOVE      SP70,NZSPCPRC
          MOVE      ZERO,NZSPPRIM
          MOVE      SP70,NZSPANAE
          MOVE      SP70,NZSPPDES
          MOVE      ZERO,NZSPICAP
          MOVE      ZERO,NZSPPIND
          MOVE      ZERO,NZSPPINS
          MOVE      SP70,NZSPINSR
          MOVE      SP70,NZSPAPRV
          MOVE      ZERO,NZSPAPSI
          MOVE      SP70,NZSPCLNO
          MOVE      SP70,NZSPAPNT
          MOVE      SP70,NZSPCMNT
          MOVE      ZERO,NZSPTDUR
          MOVE      ZERO,NZSPTFEE
          MOVE      SP70,NZSPUDF1
          MOVE      SP70,NZSPUDF2
          MOVE      SP70,NZSPCDAT
          MOVE      SP70,NZSPCTIM
          MOVE      SP70,NZSPCUID
          MOVE      SP70,NZSPUDAT
          MOVE      SP70,NZSPUTIM
          MOVE      SP70,NZSPUUID
          MOVE      SP70,NZSPADTE
          MOVE      ZERO,NZSPHPAY
          MOVE      ZERO,NZSPCPAY
          MOVE      ZERO,NZSPINVD
          MOVE      SP70,NZSPSPAR
.
CLNZSP99  RETURN
.
.*******************************************************************************
.*        Routine for Workers Compensation Claim Details                       *
.*******************************************************************************
GPWC1000  MOVE      FALSE,EXIT
          MOVE      SP70,VARIABLE
.
          MOVE      AADMNO,KEY8
          OPEN      PATWC1A1,"patwc1af"
          CALL      RDWCOM1
          BRANCH    OVRCD,GPWC1999
.
          MOVE      AADMNO,KEY8
          OPEN      PMSWX1A1,"pmswx1af"
          CALL      RDPMWX11
.
          MOVE      SP30,INAME
          MOVE      WCICODE,KEY6
          OPEN      PATIN1A1,"patin1af"
          CALL      RDINSR1
.
          SUB       "474",FORM5
.
          BRANCH    FORM5,GPWC1101,GPWC1102,GPWC1103,GPWC1104,GPWC1105,GPWC1106:
                          GPWC1107,GPWC1108,GPWC1109,GPWC1110,GPWC1111,GPWC1112:
                          GPWC1113,GPWC1114,GPWC1115,GPWC1116,GPWC1117,GPWC1118:
                          GPWC1119,GPWC1120,GPWC1121,GPWC1122,GPWC1123,GPWC1124:
                          GPWC1125,GPWC1126,GPWC1127
.
          GOTO      GPWC1999
.
GPWC1101  MOVE      WCENAME,VARIABLE            * Employer Name
          GOTO      GPWC1999
.
GPWC1102  MOVE      WCEADD1,VARIABLE            * Employer Address Line 1
          GOTO      GPWC1999
.
GPWC1103  MOVE      WCEADD2,VARIABLE            * Employer Address Line 2
          GOTO      GPWC1999
.
GPWC1104  MOVE      WCEADD3,VARIABLE            * Employer Address Line 3
          GOTO      GPWC1999
.
GPWC1105  MOVE      WCEADD4,VARIABLE            * Employer Address Line 4
          GOTO      GPWC1999
.
GPWC1106  MOVE      WCEPOST,VARIABLE            * Employer Postcode
          GOTO      GPWC1999
.
GPWC1107  MOVE      WCETELE,VARIABLE            * Employer Telephone
          GOTO      GPWC1999
.
GPWC1108  MATCH     SP70,WCACDAT                * Date of Accident
          GOTO      GPWC1999 IF EQUAL
          UNPACK    WCACDAT,CCENT,CYEAR,CMON,CDAY
          PACK      VARIABLE,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          GOTO      GPWC1999
.
GPWC1109  IF        WCACCPT=1
            MOVE      "Yes",VARIABLE            * Accepted by Insurance Company
          ELSE
            MOVE      "No",VARIABLE             * 1=Yes 0=No
          ENDIF
          MOVE      TRUE,EXIT
          GOTO      GPWC1999
.
GPWC1110  MOVE      WCICODE,VARIABLE            *Insurance Company Code
          GOTO      GPWC1999
.
GPWC1111  MOVE      WCCLMNO,VARIABLE            *Insurance Company Claim Number
          GOTO      GPWC1999
.
GPWC1112  MOVE      WCCOMN1,VARIABLE            *Comments Line 1
          GOTO      GPWC1999
.
GPWC1113  MOVE      WCCOMN2,VARIABLE            *Comments Line 2
          GOTO      GPWC1999
.
GPWC1114  MOVE      INAME,VARIABLE              *Insurance Company Name
          GOTO      GPWC1999
.
GPWC1115  MOVE      PMWXALOC,VARIABLE           * Accident Location
          GOTO      GPWC1999
.
GPWC1116  MOVE      PMWXCINJ,VARIABLE           * Cause of Injury Code
          GOTO      GPWC1999
.
GPWC1117  MOVE      CODEIK,TCODE                * Cause of Injury Description
          PACK      ACODE,PMWXCINJ,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      GPWC1999
.
GPWC1118  MOVE      PMWXICOD,VARIABLE           * Injury Code
          GOTO      GPWC1999
.
GPWC1119  MOVE      CODEIJ,TCODE                * Injury Description
          PACK      ACODE,PMWXICOD,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      GPWC1999
.
GPWC1120  MOVE      PMWXCNAM,VARIABLE           * Contact Name
          GOTO      GPWC1999
.
GPWC1121  MOVE      PMWXACCF,VARIABLE           * Work Related Code
          GOTO      GPWC1999
.
GPWC1122  MOVE      CODEIQ,TCODE                * Work Related Description
          PACK      ACODE,PMWXACCF,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      GPWC1999
.
GPWC1123  MOVE      PMWXPLIN,VARIABLE           * Place Injury Occurred Code
          GOTO      GPWC1999
.
GPWC1124  MOVE      CODEIP,TCODE                * Place Injury Occurred Desc
          PACK      ACODE,PMWXPLIN,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      GPWC1999
.
GPWC1125  MOVE      PMWXACTI,VARIABLE           * Activity when Injured Code
          GOTO      GPWC1999
.
GPWC1126  MOVE      CODEIO,TCODE                * Activity when Injured Desc
          PACK      ACODE,PMWXACTI,SP70
          CALL      GTCOD000
          MOVE      TDESC,VARIABLE
          GOTO      GPWC1999
.
GPWC1127  MATCH     SP70,PMWXADTE               * ACC Decline Date
          GOTO      GPWC1999 IF EQUAL
          UNPACK    PMWXADTE,CCENT,CYEAR,CMON,CDAY
          PACK      VARIABLE,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          GOTO      GPWC1999
.
GPWC1999  RETURN
+
.--------------------------------------------------------------------
. Get concession card details 
. DIM1 = 1 - Concession Card 
.        2 - Safety Net Card
.        3 - DVA Card
.        4 - Pension Card
.--------------------------------------------------------------------
GCCARD00  MOVE      "ct",DIM2
          PACK      KEY19,PURNO,SP70
          CALL      RSPMCCD1
GCCARD20  CALL      RKPMCCD1
          BRANCH    OVRCD,GCCARD80
.
          MATCH     PURNO,PMCDURNO
          GOTO      GCCARD80 IF NOT EQUAL
.
          PACK      KEY5,DIM2,PMCDCTYP
          CALL      RDCODE1
          BRANCH    OVRCD,GCCARD20
.
          MATCH     DIM1,TCINDC1
          GOTO      GCCARD99 IF EQUAL
.
          GOTO      GCCARD20
.
GCCARD80  MOVE      SP70,PMCDCNUM
          MOVE      SP70,PMCDCTYP
          MOVE      SP70,PMCDEXDT
          MOVE      SP70,PMCDDVAC
          GOTO      GCCARD99
.
GCCARD99  RETURN
.
.--------------------------------------------------------------------
.         Get Multiple Card Type
.--------------------------------------------------------------------
GMCARD00  MOVE      "ct",DIM2
          PACK      KEY19,PURNO,SP70
          CALL      RSPMCCD1
GMCARD20  CALL      RKPMCCD1
          BRANCH    OVRCD,GMCARD80
.
          MATCH     PURNO,PMCDURNO
          GOTO      GMCARD80 IF NOT EQUAL
.
          PACK      KEY5,DIM2,PMCDCTYP
          CALL      RDCODE1
          BRANCH    OVRCD,GMCARD20
.
          MATCH     TCINDC6,IBDTPIND             * Check Print Indicator
          GOTO      GMCARD20 IF NOT EQUAL
.
          GOTO      GMCARD99
.
GMCARD80  MOVE      SP70,PMCDCNUM
          MOVE      SP70,PMCDCTYP
          MOVE      SP70,PMCDEXDT
          MOVE      SP70,TDESC
          GOTO      GMCARD99
.
GMCARD99  RETURN
.
.--------------------------------------------------------------------
. Get concession card details for sjog
. Print order will be determined by Cat ct Ind 3 
.--------------------------------------------------------------------
GCCSJG00  MOVE      "ct",DIM2
          MOVE      ONE,F1
.
GCCSJG10  LOAD      DIM1,F1,ONE,TWO,THREE,FOUR,FIVE
.
          PACK      KEY19,PURNO,SP70
          CALL      RSPMCCD1
GCCSJG20  CALL      RKPMCCD1
          BRANCH    OVRCD,GCCSJG70
.
          MATCH     PURNO,PMCDURNO
          GOTO      GCCSJG70 IF NOT EQUAL
.
          PACK      KEY5,DIM2,PMCDCTYP
          CALL      RDCODE1
          BRANCH    OVRCD,GCCSJG20
.
          MATCH     DIM1,TCINDC3
          GOTO      GCCSJG99 IF EQUAL
.
          GOTO      GCCSJG20
.
GCCSJG70  COMPARE   F1,FIVE
          IF        !@EQUAL
            ADD       ONE,F1
            GOTO      GCCSJG10
          ENDIF
          GOTO      GCCSJG80
.
GCCSJG80  MOVE      SP70,PMCDCNUM
          MOVE      SP70,PMCDCTYP
          MOVE      SP70,PMCDEXDT
          GOTO      GCCSJG99
.
GCCSJG99  RETURN
.
.--------------------------------------------------------------------
. Get EOC Eligibility Claim Details record (pmseedaf) input DIM3 Ex Code Counter
.--------------------------------------------------------------------
GTPMED00  MATCH     "1",PTCNWSIN
          GOTO      GTPMED50 IF NOT EQUAL
.
          MATCH     "1",PTCNOECW
          GOTO      GTPMED50 IF NOT EQUAL
.
          COMPARE   ONE,OECWINDC
          GOTO      GTPMED50 IF NOT EQUAL
.
          PACK      KEY30,WBEHARID,WBEHRPTC,SP70
          CALL      RSWBEED1
GTPMED10  CALL      RKWBEED1
          BRANCH    OVRCD,GTPMED40
.
          MATCH     WBEHARID,WBEDARID
          GOTO      GTPMED40 IF NOT EQUAL
.
          MATCH     WBEHRPTC,WBEDRPTC
          GOTO      GTPMED40 IF NOT EQUAL
.
          MATCH     DIM3,WBEDEXPC
          GOTO      GTPMED10 IF NOT EQUAL
.
          CALL      MVEED000
.
          GOTO      GTPMED99
.
GTPMED40  CALL      CLWEBEED
.
          CALL      MVEED000
.
          GOTO      GTPMED99
.
GTPMED50  MATCH     "1",PTCNOECE
          GOTO      GTPMED90 IF EQUAL
.
          PACK      KEY30,PMHEARID,PMHERPTC,SP70
          CALL      RSPMEED1
GTPMED60  CALL      RKPMEED1
          BRANCH    OVRCD,GTPMED90
.
          MATCH     PMHEARID,PMDEARID
          GOTO      GTPMED90 IF NOT EQUAL
.
          MATCH     PMHERPTC,PMDERPTC
          GOTO      GTPMED90 IF NOT EQUAL
.
          MATCH     DIM3,PMDEEXPC
          GOTO      GTPMED60 IF NOT EQUAL
.
          GOTO      GTPMED99
.
GTPMED90  CALL      CLPMSEED
.
GTPMED99  RETURN
.
.--------------------------------------------------------------------
. Get EOC Eligibility Service Header record (pmssesaf) input DIM3 Service Countr
.--------------------------------------------------------------------
GTPMSE00  MATCH     "1",PTCNWSIN
          GOTO      GTPMSE50 IF NOT EQUAL
.
          MATCH     "1",PTCNOECW
          GOTO      GTPMSE50 IF NOT EQUAL
.
          COMPARE   ONE,OECWINDC
          GOTO      GTPMSE50 IF NOT EQUAL
.
          PACK      KEY37,WBEHARID,WBEHRPTC,SP70
          CALL      RSWBSES1
GTPMSE10  CALL      RKWBSES1
          BRANCH    OVRCD,GTPMSE40
.
          MATCH     WBEHARID,WBSSARID
          GOTO      GTPMSE40 IF NOT EQUAL
.
          MATCH     WBEHRPTC,WBSSRPTC
          GOTO      GTPMSE40 IF NOT EQUAL
.
          MATCH     DIM3,WBSSSRVC
          GOTO      GTPMSE10 IF NOT EQUAL
.
          CALL      MVSES000
.
          GOTO      GTPMSE99
.
GTPMSE40  CALL      CLWEBSES
.
          CALL      MVSES000
.
          GOTO      GTPMSE99
.
GTPMSE50  MATCH     "1",PTCNOECE
          GOTO      GTPMSE90 IF EQUAL
.
          PACK      KEY37,PMHEARID,PMHERPTC,SP70
          CALL      RSPMSES1
GTPMSE60  CALL      RKPMSES1
          BRANCH    OVRCD,GTPMSE90
.
          MATCH     PMHEARID,PMESARID
          GOTO      GTPMSE90 IF NOT EQUAL
.
          MATCH     PMHERPTC,PMESRPTC
          GOTO      GTPMSE90 IF NOT EQUAL
.
          MATCH     DIM3,PMESSRVC
          GOTO      GTPMSE60 IF NOT EQUAL
.
          GOTO      GTPMSE99
.
GTPMSE90  CALL      CLPMSSES
.
GTPMSE99  RETURN
.
.--------------------------------------------------------------------
. Get EOC Eligibility Service Detail record (pmssedaf) input DIM3 Ser Ex Counter
.--------------------------------------------------------------------
GTPMSD00  MATCH     "1",PTCNWSIN
          GOTO      GTPMSD50 IF NOT EQUAL
.
          MATCH     "1",PTCNOECW
          GOTO      GTPMSD50 IF NOT EQUAL
.
          COMPARE   ONE,OECWINDC
          GOTO      GTPMSD50 IF NOT EQUAL
.
          PACK      KEY44,WBEHARID,WBEHRPTC,WBSSSCOD,WBSSSRVC,SP70
          CALL      RSWBSED1
GTPMSD10  CALL      RKWBSED1
          BRANCH    OVRCD,GTPMSD40
.
          MATCH     WBEHARID,WBSDARID
          GOTO      GTPMSD40 IF NOT EQUAL
.
          MATCH     WBEHRPTC,WBSDRPTC
          GOTO      GTPMSD40 IF NOT EQUAL
.
          MATCH     WBSSSCOD,WBSDSCOD
          GOTO      GTPMSD40 IF NOT EQUAL
.
          MATCH     WBSSSRVC,WBSDSRVC
          GOTO      GTPMSD40 IF NOT EQUAL
.
          MATCH     DIM3,WBSDSEXC
          GOTO      GTPMSD10 IF NOT EQUAL
.
          CALL      MVSED000
.
          GOTO      GTPMSD99
.
GTPMSD40  CALL      CLWEBSED
.
          CALL      MVSED000
.
          GOTO      GTPMSD99 
.
GTPMSD50  MATCH     "1",PTCNOECE
          GOTO      GTPMSD90 IF EQUAL
.
          PACK      KEY44,PMHEARID,PMHERPTC,PMESSCOD,PMESSRVC,SP70
          CALL      RSPMSED1
GTPMSD60  CALL      RKPMSED1
          BRANCH    OVRCD,GTPMSD90
.         
          MATCH     PMHEARID,PMSEARID
          GOTO      GTPMSD90 IF NOT EQUAL
.         
          MATCH     PMHERPTC,PMSERPTC
          GOTO      GTPMSD90 IF NOT EQUAL
.
          MATCH     PMESSCOD,PMSESCOD
          GOTO      GTPMSD90 IF NOT EQUAL 
.
          MATCH     PMESSRVC,PMSESRVC
          GOTO      GTPMSD90 IF NOT EQUAL
.         
          MATCH     DIM3,PMSESEXC
          GOTO      GTPMSD60 IF NOT EQUAL
.
          GOTO      GTPMSD99
.
GTPMSD90  CALL      CLPMSSED
.
GTPMSD99  RETURN
+
.--------------------------------------------------------------------
.         Find Health Fund Group
.--------------------------------------------------------------------
.
FDHL0000  MOVE      SP70,VARIABLE
          MOVE      "0000    ",DIM8
          PACK      KEY14,AFUNDH,DIM8,SP70
          CALL      RDFUND1
          IF        OVRCD<>1
            MATCH     HCODE,AFUNDH
            GOTO      FDHL9999 IF NOT EQUAL
.
            MATCH     SP70,PTHFHGRP
            IF        @EQUAL
              MOVE      SP70,VARIABLE
            ELSE
              MOVE    PTHFHGRP,VARIABLE
            ENDIF
          ENDIF
.
FDHL9999  RETURN
+
.
.--------------------------------------------------------------------
. Get EOC Eligibility Resp Comm record (pmsercaf) input DIM3 Comment Type
.                                                       DIM3A Line No
.--------------------------------------------------------------------
GTPMER00  MATCH     "1",PTCNWSIN
          GOTO      GTPMER50 IF NOT EQUAL
.
          MATCH     "1",PTCNOECW
          GOTO      GTPMER50 IF NOT EQUAL
.
          COMPARE   ONE,OECWINDC
          GOTO      GTPMER50 IF NOT EQUAL
.
          PACK      KEY29,WBEHARID,WBEHRPTC,DIM3,SP70
          CALL      RSWBERC1
GTPMER10  CALL      RKWBERC1
          BRANCH    OVRCD,GTPMER40
.
          MATCH     WBEHARID,WBECARID
          GOTO      GTPMER40 IF NOT EQUAL
.
          MATCH     WBEHRPTC,WBECRPTC
          GOTO      GTPMER40 IF NOT EQUAL
.
          MATCH     DIM3,WBECTYPE
          GOTO      GTPMER40 IF NOT EQUAL
.
          MATCH     DIM3A,WBECLINE
          GOTO      GTPMER10 IF NOT EQUAL
.
          CALL      MVERC000 
.
          GOTO      GTPMSE99
.
GTPMER40  CALL      CLWEBERC
.
          CALL      MVERC000
.
          GOTO      GTPMSE99
.
GTPMER50  MATCH     "1",PTCNOECE
          GOTO      GTPMER90 IF EQUAL
.
          PACK      KEY29,PMHEARID,PMHERPTC,DIM3,SP70
          CALL      RSPMERC1
GTPMER60  CALL      RKPMERC1
          BRANCH    OVRCD,GTPMER90
.
          MATCH     PMHEARID,PMRCARID
          GOTO      GTPMER90 IF NOT EQUAL
.         
          MATCH     PMHERPTC,PMRCRPTC
          GOTO      GTPMER90 IF NOT EQUAL
.
          MATCH     DIM3,PMRCTYPE
          GOTO      GTPMER90 IF NOT EQUAL
.
          MATCH     DIM3A,PMRCLINE
          GOTO      GTPMER60 IF NOT EQUAL
.
          GOTO      GTPMSE99
.
GTPMER90  CALL      CLPMSERC
.
GTPMER99  RETURN
.
.--------------------------------------------------------------------
. Get Division
.--------------------------------------------------------------------
GDIVN000  MATCH     SP70,PMVXMHOS
          GOTO      GDIVN999 IF EQUAL
.
          PACK      KEY14,PMVXMHOS,ACLSSFT,PMVXTEAM,SP70
          CALL      RSPMDIV2
          CALL      RKPMDIV2
          BRANCH    OVRCD,GDIVN999
.
          MATCH     PMVXMHOS,PMDIHOSP
          GOTO      GDIVN999 IF NOT EQUAL
.
          MATCH     ACLSSFT,PMDIUNIT
          GOTO      GDIVN999 IF NOT EQUAL
.
          MATCH     PMVXTEAM,PMDITEAM
          GOTO      GDIVN999 IF NOT EQUAL
.
          PACK      KEY5,CATdv,PMDIDIVN,SP70
          CALL      RDCODE1
.
GDIVN999  RETURN
+
.--------------------------------------------------------------------
. Get Mental Health Legal Status at Admission (mehdlsaf)
.--------------------------------------------------------------------
GMHDLS00  MATCH     SP70,ADATE
          GOTO      GMHDLS99 IF EQUAL
          GOTO      GMHDLS99 IF EOS
.
          PACK      KEY16,ADATE,ATIME,SP70
          PACK      KEY32,AURNO,SP70
          CALL      RSMHDLS1
GMHDLS10  CALL      RKMHDLS1
          BRANCH    OVRCD,GMHDLS99
.
          MATCH     AURNO,MHDLURNO
          GOTO      GMHDLS99 IF NOT EQUAL
.
          MATCH     "1",MHDLACTV
          GOTO      GMHDLS10 IF EQUAL            * inactive
.
          PACK      DIM16,MHDLSDAT,MHDLSTIM,SP70
          MATCH     DIM16,KEY16
          GOTO      GMHDLS10 IF LESS             * adm date is before LS start
.
          PACK      DIM16,MHDLEDAT,MHDLETIM,SP70
          MATCH     SP70,MHDLEDAT
          IF        !@EQUAL
            MATCH     DIM16,KEY16
            GOTO      GMHDLS10 IF NOT LESS       * adm date is after LS end
          ENDIF
.
          PACK      KEY5,CATLS,MHDLSCOD,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      SP70,TDESC
          ELSE
            MOVE      MHDLSCOD,VARIABLE
          ENDIF
GMHDLS99  RETURN
+
.-----------------------------------------------------------------------
. Output all comments from vismtxaf details excuding deleted comments
.-----------------------------------------------------------------------
ADCMNT00  PACK      KEY17,ADMISSNO,VSCMTTYP,SP70
          CALL      RSVSMDT1
ADCMNT10  CALL      RKVSMDT1
          BRANCH    OVRCD,ADCMNT99
.
          MATCH     ADMISSNO,VSMDVISN
          GOTO      ADCMNT99 IF NOT EQUAL
.
          MATCH     VSCMTTYP,VSMDTYPE
          GOTO      ADCMNT99 IF NOT EQUAL
.
          MATCH     "1",VSMDDELT          * is comment deleted
          GOTO      ADCMNT10 IF EQUAL
.
          CALL      ADCMTX00
.
          GOTO      ADCMNT10
.
ADCMNT99  MOVE      ONE,MULTILIN
          RETURN
.
.---------------------------------------------------------------------
. Retrieve comment text details
.---------------------------------------------------------------------
.
ADCMTX00  PACK      KEY20,VSMDVISN,VSMDTYPE,VSMDNOTE,SP70
          CALL      RSVSMTX1
ADCMTX20  CALL      RKVSMTX1
          BRANCH    OVRCD,ADCMTX99
.
          MATCH     VSMDVISN,VSMTVISN
          GOTO      ADCMTX99 IF NOT EQUAL
.
          MATCH     VSMDTYPE,VSMTTYPE
          GOTO      ADCMTX99 IF NOT EQUAL
.
          MATCH     VSMDNOTE,VSMTNOTE
          GOTO      ADCMTX99 IF NOT EQUAL
.
          STRIP     VSMTCMNT
          MOVELPTR  VSMTCMNT,LENGTH
.
          COMPARE   LENGTH,ZERO
          IF        @EQUAL
            MOVE      ONE,LENGTH
          ENDIF
.
          SFORMAT   VAR,LENGTH
          MOVE      VSMTCMNT,VAR
          PRINT     *N,VAR;
          SFORMAT   VAR,70
.
          GOTO      ADCMTX20
.
ADCMTX99  RETURN
+
.******************************************************************************
.*                                  ALTC0000                                  *
.*                        Get Alternate Contact Details                       *
.* Based on category tc, indc2 (order 1-9) - determine which contact to print *
.******************************************************************************
ALTC0000  MOVE      ZERO,CONTTYP2
ALTC0500  ADD       ONE,CONTTYP2                 * contact type priority order
          IF        CONTTYP2=9
            GOTO      ALTC5000                   * no contacts to print
          ENDIF
          PACK      KEY5,CATTC,SP70
          CALL      RDSCODE1
ALTC1000  CALL      RDKCODE1
          BRANCH    OVRCD,ALTC0500               * try next priority
.
          MATCH     CATTC,TCODE
          GOTO      ALTC0500 IF NOT EQUAL        * try next priority
.
          MATCH     "I",PTCOACTV
          GOTO      ALTC1000 IF EQUAL            * code inactive
.
          MOVE      ZERO,F1
          MOVE      TCINDC2,F1
          COMPARE   CONTTYP2,F1
          GOTO      ALTC1000 IF NOT EQUAL        * incorrect priority

ALTC2000  PACK      KEY14,PURNO,ACODE,SP70
          CALL      RSPMCEX1
ALTC3000  CALL      RKPMCEX1
          BRANCH    OVRCD,ALTC0500               * contact type does not exist
.
          MATCH     PURNO,PMCEURNO               * correct U/R
          GOTO      ALTC0500 IF NOT EQUAL
.
          MATCH     ACODE,PMCETYPE               * correct contact type
          GOTO      ALTC0500 IF NOT EQUAL
.
          MATCH     "1",PMCEACTV                 * skip if inctive
          GOTO      ALTC3000 IF EQUAL
          GOTO      ALTC9999
.
ALTC5000  CALL      CLPMSCEX                * Clear extra contact file vars
.
ALTC9999  RETURN
+
.------------------------------------------------------------
.  HCP Details (pmi based) PMPXRHC1
.  Parameters: F2 (PMSHCP variable)
.------------------------------------------------------------
PRHCP000  PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PRHCP999
.
          BRANCH    F2,PRHCP010,PRHCP020,PRHCP030,PRHCP040,PRHCP050:
                       PRHCP060,PRHCP070,PRHCP080,PRHCP090,PRHCP100:
                       PRHCP110
.
          GOTO      PRHCP999
.
PRHCP010  MOVE      PMHCHCPC,VARIABLE
          GOTO      PRHCP999
.
PRHCP020  MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      PRHCP999
.
PRHCP030  MOVE      PMHCADR1,VARIABLE
          GOTO      PRHCP999
.
PRHCP040  MOVE      PMHCADR2,VARIABLE
          GOTO      PRHCP999
.
PRHCP050  MOVE      PMHCADR3,VARIABLE
          GOTO      PRHCP999
.
PRHCP060  MOVE      PMHCADR4,VARIABLE
          GOTO      PRHCP999
.
PRHCP070  MOVE      PMHCADR5,VARIABLE
          GOTO      PRHCP999
.
PRHCP080  MOVE      PMHCADR6,VARIABLE
          GOTO      PRHCP999
.
PRHCP090  MOVE      PMHCPOST,VARIABLE
          GOTO      PRHCP999
.
PRHCP100  MOVE      PMHCSTEL,VARIABLE
          GOTO      PRHCP999
.
PRHCP110  MOVE      PMHCFAXN,VARIABLE
          GOTO      PRHCP999
.
PRHCP999  RETURN
+
.------------------------------------------------------------
.  HCP Practice Details (pmi based) PMPXRH1G
.  Parameters: F2 (PMSHCG variable)
.------------------------------------------------------------
PRHCG000  PACK      KEY10,PMPXRH1G,SP70
          PACK      KEY12,KEY10,PMPXR1GC,SP70
          CALL      RDPMHCG1
          BRANCH    OVRCD,PRHCG999
.
          BRANCH    F2,PRHCG010,PRHCG020,PRHCG030,PRHCG040,PRHCG050:
                       PRHCG060,PRHCG070,PRHCG080,PRHCG090,PRHCG100:
                       PRHCG110
.
          GOTO      PRHCG9999
.
PRHCG010  MOVE      PMHGPRAC,VARIABLE
          GOTO      PRHCG999
.
PRHCG020  MOVE      PMHGPNAM,VARIABLE
          GOTO      PRHCG999
.
PRHCG030  MOVE      PMHGADD1,VARIABLE
          GOTO      PRHCG999
.
PRHCG040  MOVE      PMHGADD2,VARIABLE
          GOTO      PRHCG999
.
PRHCG050  MOVE      PMHGADD3,VARIABLE
          GOTO      PRHCG999
.
PRHCG060  MOVE      PMHGADD4,VARIABLE
          GOTO      PRHCG999
.
PRHCG070  MOVE      PMHGADD5,VARIABLE
          GOTO      PRHCG999
.
PRHCG080  MOVE      PMHGADD6,VARIABLE
          GOTO      PRHCG999
.
PRHCG090  MOVE      PMHGPOST,VARIABLE
          GOTO      PRHCG999
.
PRHCG100  MOVE      PMHGPTEL,VARIABLE
          GOTO      PRHCG999
.
PRHCG110  MOVE      PMHGPFAX,VARIABLE
          GOTO      PRHCG999
.
PRHCG999  RETURN
+
.*******************************************************************************
.*                             CASE0000                                        *
.*  Routine to convert all except first character of each word to lower case.  *
.*  Parameters: LINE80 (80 char string to be formatted)                        *
.*                                                                             *
.*******************************************************************************
CASE0000  MOVE      ONE,FIRSTCH
          RESET     LINE80
.
CASE1000  CMATCH    SP1,LINE80
          GOTO      CASE5000 IF EQUAL       * match char to space
          BRANCH    FIRSTCH,CASE2000
          MOVE      LINE80,ANS
          RESET     UPPLOW
          SCAN      ANS,UPPLOW              * test to see if char is a letter
          GOTO      CASE1100 IF EQUAL
          MOVE      ONE,FIRSTCH
          GOTO      CASE3000                * any char but a letter found
.
CASE1100  OR        040,LINE80              * actual conversion to lower case
          RESET     UPPLOW                  * (believe it or not!)
.
CASE2000  MOVE      ZERO,FIRSTCH            * not on first char any more
.
CASE3000  BUMP      LINE80
          GOTO      CASE1000 IF NOT EOS     * move to next char
          RESET     LINE80                  * end of line reached
          GOTO      CASE9999
.
CASE5000  MOVE      ONE,FIRSTCH             * first char was a space
          GOTO      CASE3000
.
CASE9999  RETURN
+
.----------------------------------------------------------------------------
. MVEED000 - Move webeedaf data to pmseedaf. For template variables
.----------------------------------------------------------------------------
MVEED000  MOVE      WBEDARID,PMDEARID
          MOVE      WBEDRPTC,PMDERPTC
          MOVE      WBEDCFEC,PMDECFEC
          MOVE      WBEDEXPC,PMDEEXPC
          MOVE      WBEDCFET,PMDECFET
          MOVE      WBEDCTID,PMDECTID
.
MVEED999  RETURN
+
.----------------------------------------------------------------------------
. MVERC000 - Move webercaf data to pmsercaf. For template variables
.----------------------------------------------------------------------------
MVERC000  MOVE      WBECARID,PMRCARID
          MOVE      WBECRPTC,PMRCRPTC
          MOVE      WBECTYPE,PMRCTYPE
          MOVE      WBECLINE,PMRCLINE
          MOVE      WBECDATA,PMRCDATA
          MOVE      WBECUDAT,PMRCUDAT
          MOVE      WBECUTIM,PMRCUTIM
.
MVERC999  RETURN
+
.----------------------------------------------------------------------------
. MVSES000 - Move websesaf data to pmssesaf. For template variables
.----------------------------------------------------------------------------
MVSES000  MOVE      WBSSARID,PMESARID
          MOVE      WBSSRPTC,PMESRPTC
          MOVE      WBSSSCOD,PMESSCOD
          MOVE      WBSSSRVC,PMESSRVC
          MOVE      WBSSSCTC,PMESSCTC
          MOVE      WBSSSVID,PMESSVID
          MOVE      WBSSCAMT,PMESCAMT
          MOVE      WBSSSDTE,PMESSDTE
          MOVE      WBSSFBAM,PMESFBAM
          MOVE      WBSSITEM,PMESITEM
          MOVE      WBSSMBAM,PMESMBAM
          MOVE      WBSSMEXC,PMESMEXC
          MOVE      WBSSSFAC,PMESSFAC
          MOVE      WBSSSFEE,PMESSFEE
.
MVSES999  RETURN
+
.----------------------------------------------------------------------------
. MVSED000 - Move websedaf data to pmssedaf. For template variables
.----------------------------------------------------------------------------
MVSED000  MOVE      WBSDARID,PMSEARID
          MOVE      WBSDRPTC,PMSERPTC
          MOVE      WBSDSCOD,PMSESCOD
          MOVE      WBSDSRVC,PMSESRVC
          MOVE      WBSDSFEC,PMSESFEC
          MOVE      WBSDSEXC,PMSESEXC
          MOVE      WBSDSFET,PMSESFET
.
MVSED999  RETURN
+
          INC       GPMCEX00 
          INC       PATPAOFS                * print alerts on front sheets
          INC       PRTALCPW                * print alert care pathway fields
...............................................................................
