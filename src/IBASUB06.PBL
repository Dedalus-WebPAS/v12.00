.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.02.01 19.05.2011 Sandra Barcham   239574
.           New printer/department table mods
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 24.11.2000 Charles Handaya
.           Recompiled (Modification of Warehouse Security)
.-------------------------------------------------------
. VF.01.01  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           29.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
FCONT     DIM       10
FCRED     DIM       5
TCONT     DIM       10
TCRED     DIM       5
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASUB06
.   Function      :   Contract Maintenance                    
.   Generated  On :   19/05/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       IBAPRNFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCIFFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINSCDFD/INC
          INC       SINSCFFD/INC
          INC       SINSCMFD/INC
          INC       SINSECFD/INC
          INC       SINTMPDF/INC
.=========================
.Local Variable Definition
.-------------------------
PRICEFLG  FORM      1 * Scr 00 Fld     5
.
.Word Processor File * Scr 01 Fld    13
.
NAMSISE1  INIT      "Wsise1"
FILSISE1  DIM       8
.
.
.    Multi Item Key Fields Scr 02 Fld    22
.-------------------------------------------------------
SISD1NAM  INIT      "SISD1"
SISD1END  FORM      1   * End Display
SISD1SNO  FORM      5   * Number of Items on the Screen
SISD1MKY  DIM       127 * Match Key 
SISD1EKY  DIM       127 * End Key
SISD1SKY  DIM       127 * Start Key
SISD1IDX  INIT      " 132 UC1-5"
SISD1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SISD1FNM  DIM       8  * Filename
SISD1CNT  FORM      3  * Number of Items on Screen
WHBKQTY1  FORM     12 * Scr 03 Fld     8
WHBKQTY2  FORM     12 * Scr 03 Fld     9
WHBKQTY3  FORM     12 * Scr 03 Fld    10
WHMINQTY  FORM     12 * Scr 03 Fld    11
WHESTQTY  FORM     12 * Scr 03 Fld    28
FROMCRED  DIM       5 * Scr 04 Fld     4
FCDESC    DIM      40 * Scr 04 Fld     5
TOCRED    DIM       5 * Scr 04 Fld     6
TCDESC    DIM      40 * Scr 04 Fld     7
FROMCONT  DIM      10 * Scr 05 Fld     4
TOCONT    DIM      10 * Scr 05 Fld     6
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASUB06"
PRGNAM    INIT      "Contract Maintenance                    "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSISE1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SISD1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          MOVE      "   24",AUDTSECT
          MOVE      "207",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudic";
            OPEN      SINAUDIC,"sinaudic"
          ENDIF
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA4,"sincicaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscfaf";
          OPEN      SINSCFA1,"sinscfaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsecaf";
          OPEN      SINSECA1,"sinsecaf"
.--------------------------------------------------------
. Initialise Wp Filename for Contract Notes                     
.--------------------------------------------------------
          PACK      FILSISE1,NAMSISE1,PORT
          REP       " 0",FILSISE1
          DISPLAY   *P56:24,"Create & Open ",FILSISE1;
          PREP      TEMPWORD,FILSISE1
.
.--------------------------------------------------------
. Initialise Batch Screen Catalog Code                       
.--------------------------------------------------------
          MOVE     ZERO,SISD1SNO
          MOVE     "02   22",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SISD1SNO
            ENDIF
          ENDIF
          PACK      SISD1FNM,ANST,SISD1NAM,PORT
          REP       " 0",SISD1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SISD1FL1,SISD1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SISD1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SISD1FNM,SISD1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SISD1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SISD1FL1,SISD1FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Contract Maintenance Options       
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Contract Master Maintenance        
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Contract Detail Maintenance        
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Contract Detail Item               
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Display Suppliers                  
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Contract Report                    
          ENDIF
          RETURN
.--------------------------------
. Screen - Contract Maintenance Options       
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Maintenance Options       
.-------------------------------------------------------
CF00L000
          MOVE      ZERO,PRICEFLG
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Maintenance Options       
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Maintenance Options       
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Maintenance Options       
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Maintenance Options       
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Maintenance Options       
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L101,PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      PRICEFLG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Maintenance Options       
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Contract Master Maintenance        
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Master Maintenance        
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SISCCON 
          MOVE      SP70,SISCDES 
          MOVE      SP70,SISCSDT 
          MOVE      SP70,SISCEDT 
          MOVE      SP70,SISCUR1 
          MOVE      SP70,SISCUR2 
          MOVE      SP70,SISCUD1 
          MOVE      SP70,SISCUD2 
          MOVE      SP70,SISCUC1 
          MOVE      SP70,SISCUC2 
          MOVE      SP70,SISCUY1 
          MOVE      SP70,SISCUY2 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Master Maintenance        
.--------------------------------------------------------
KY01L000
.
KY01L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KSISCA00
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      OVRCD,ACCEPT
          MOVE      SISCCON,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Master Maintenance        
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILSISE1
          PACK     KEY13,SISCCON,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDSISE1 
          IF        OVRCD=0
            CALL      RPSISE1 
          ENDIF
WP01L100
          CALL     RKSISE1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY13,SISECON,SISELIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,SISECOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SISECOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Master Maintenance        
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Master Maintenance        
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Master Maintenance        
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L101,PS01L102,PS01L103:
                            PS01L104,PS01L105,PS01L106,PS01L107:
                            PS01L108,PS01L109,PS01L110,PS01L111:
                            PS01L112,PS01L999,PS01L999,PS01L999:
                            PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      SISCDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SISCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SISCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          UNPACK    SISCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          UNPACK    SISCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SISCUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      SISCUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE     FILSISE1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Master Maintenance        
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L006,SF01L113,SF01L114:
                            SF01L115
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L020,SF01L020,SF01L020:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          STRIP     SISCDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISCDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISCDES 
          SFORMAT   VAR,127
          ENDSET    SISCDES 
          APPEND    SP70,SISCDES 
          RESET     SISCDES 
          CMATCH    EXITCHAR,SISCDES 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISCDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
          ENDIF
          MOVE      SISCDES,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L102
          CALL      DEFSDT00
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISCSDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L103
          CALL      DEFEDT00
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISCEDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          STRIP     SISCUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISCUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISCUR1 
          SFORMAT   VAR,127
          ENDSET    SISCUR1 
          APPEND    SP70,SISCUR1 
          RESET     SISCUR1 
          CMATCH    EXITCHAR,SISCUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISCUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
          ENDIF
          MOVE      SISCUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          STRIP     SISCUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISCUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISCUR2 
          SFORMAT   VAR,127
          ENDSET    SISCUR2 
          APPEND    SP70,SISCUR2 
          RESET     SISCUR2 
          CMATCH    EXITCHAR,SISCUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISCUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
          ENDIF
          MOVE      SISCUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISCUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISCUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
          CALL     SELECTED
          STRIP     SISCUC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISCUC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISCUC1 
          SFORMAT   VAR,127
          ENDSET    SISCUC1 
          APPEND    SP70,SISCUC1 
          RESET     SISCUC1 
          CMATCH    EXITCHAR,SISCUC1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISCUC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
          ENDIF
          MOVE      SISCUC1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L109
          CALL     SELECTED
          STRIP     SISCUC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISCUC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISCUC2 
          SFORMAT   VAR,127
          ENDSET    SISCUC2 
          APPEND    SP70,SISCUC2 
          RESET     SISCUC2 
          CMATCH    EXITCHAR,SISCUC2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISCUC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L109
            ENDIF
          ENDIF
          MOVE      SISCUC2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SISCUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SISCUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSISE1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSISE1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF01L001
.
SF01L113
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L114
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DEL10000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L115
          CALL      POS10000
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Contract Detail Maintenance        
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Detail Maintenance        
.-------------------------------------------------------
CF02L000
          MOVE      SP70,SISCCON 
          MOVE      SP70,SISCSDT 
          MOVE      SP70,SISCEDT 
          MOVE      SP70,SISCUR1 
          MOVE      SP70,SISCUR2 
          MOVE      SP70,SISCUD1 
          MOVE      SP70,SISCUD2 
          MOVE      SP70,SISCDES 
          MOVE      SP70,SISCUY1 
          MOVE      SP70,SISCUY2 
          MOVE      SP70,APMACRD 
          MOVE      SP70,APMASN1 
          MOVE      SP70,APMASN2 
          MOVE      SP70,APMASA1 
          MOVE      SP70,APMASA2 
          MOVE      SP70,APMASA3 
          MOVE      SP70,APMASPC 
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASCON
          MOVE      ZERO,APMADIS 
          MOVE      SP70,SISDCAT 
          MOVE      SP70,SISDSDT 
          MOVE      SP70,SISDSUT 
          MOVE      ZERO,SISDUC1 
          MOVE      ZERO,SISDUC2 
          MOVE      ZERO,SISDUC3 
          MOVE      ZERO,SISDUC4 
          MOVE      ZERO,SISDBQ1 
          MOVE      ZERO,SISDBQ2 
          MOVE      ZERO,SISDBQ3 
          MOVE      ZERO,SISDMQT 
          MOVE      SP70,SISDPO1 
          MOVE      SP70,SISDUR1 
          MOVE      SP70,SISDUR2 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIAISS 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,SIIANAT 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Detail Maintenance        
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCSDT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCEDT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCUR1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCUR2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCUY1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISCUY2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSISCA00
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      SISCCON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISCUR1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISCUR2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISCDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SISCUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SISCUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ENDIF
.
KY02L120
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Detail Maintenance        
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Detail Maintenance        
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    22 Catalog Code                       
.---------------------------------------------------------
          UNPACK    SP70,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT
          PACK      KEY45,SISCCON,APMACRD,SP70
          MOVE      KEY45,SISD1EKY
          STRIP     SISD1SKY
          SETLPTR   SISD1EKY,15
          MOVE      SISD1EKY,SISD1SKY
          CALL      RDSISD1 
          IF        OVRCD=0
            CALL      RPSISD1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SISD1CNT
          MOVE     ZERO,SISD1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L101,DP02L102,DP02L103:
                            DP02L104,DP02L105,DP02L106,DP02L107:
                            DP02L108,DP02L109,DP02L110,DP02L111:
                            DP02L112,DP02L113,DP02L114,DP02L115:
                            DP02L116,DP02L117,DP02L118,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SISD1MKY,SP70,SP70
          CALL      UPTSISD1
          IF        SISD1END=0
            CALL      RKSISD1 
            IF        OVRCD=0
              PACK      SISD1MKY,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT                                        
              MATCH     SISD1EKY,SISD1MKY
              IF        @EQUAL
                MOVE      ZERO,SISD1END
                ADD       ONE,SISD1CNT
                CALL      UPTSISD1
                MOVE      SISDCAT,VAR      
                CALL      DISPITEM
          CALL      CONDET00
              ELSE
                MOVE      ONE,SISD1END
              ENDIF
            ELSE
              MOVE      ONE,SISD1END
            ENDIF
          ENDIF
          IF        SISD1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SISD1END=0
            UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SISD1END=0
            UNPACK    SISDSUT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SISD1END=0
            MOVE      SISDUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SISD1END=0
            MOVE      SISDUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SISD1END=0
            MOVE      SISDUC3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SISD1END=0
            MOVE      SISDUC4,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SISD1END=0
            MOVE      SISDBQ1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SISD1END=0
            MOVE      SISDBQ2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SISD1END=0
            MOVE      SISDBQ3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        SISD1END=0
            MOVE      SISDMQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        SISD1END=0
            MOVE      SISDPO1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        SISD1END=0
            MOVE      SISDUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        SISD1END=0
            MOVE      SISDUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        SISD1END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        SISD1END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        SISD1END=0
            MOVE      SIIAAVC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        SISD1END=0
            MOVE      SIIANAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SISD1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SISD1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY45,SISD1SKY,SP70
          CALL     RDSISD1  * Start
          IF       OVRCD=0
            CALL     RPSISD1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SISD1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY45,SISD1SKY,Z70
          CALL     RSSISD1  * End
          IF       OVRCD=1
            CALL     RPSISD1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SISD1SNO
            CALL     RPSISD1 
            IF       OVRCD=1
              MOVE     SISD1SNO,SECTOR
            ENDIF
            PACK     SISD1MKY,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT                                        
            MATCH    SISD1EKY,SISD1MKY
            IF       !@EQUAL
              MOVE     SISD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SISD1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSISD1
          BRANCH   OVRCD,PP02L115
          MOVE      SISD1MKY,KEY45 
          CALL      RSSISD1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SISD1SNO
            CALL     RPSISD1 
            IF       OVRCD=1
              MOVE     SISD1SNO,SECTOR
            ENDIF
            PACK     SISD1MKY,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT                                        
            MATCH    SISD1EKY,SISD1MKY
            IF       !@EQUAL
              MOVE     SISD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SISD1SNO
            CALL     RKSISD1 
            IF       OVRCD=1
              MOVE     SISD1SNO,SECTOR
            ENDIF
            PACK     SISD1MKY,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT                                        
            MATCH    SISD1EKY,SISD1MKY
            IF       !@EQUAL
              MOVE     SISD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SISD1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSISD1 
          BRANCH   OVRCD,NP02L110
          PACK     SISD1MKY,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT                                        
          MATCH    SISD1EKY,SISD1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSISD1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSISD1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Contract Detail Maintenance        
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    22 Catalog Code                       
.---------------------------------------------------------
UPTSISD1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SISD1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SISD1FL1,KEY5;SCPSROW,SCPSCOL,SISD1MKY
          ELSE
            UPDATE    SISD1FL1;SCPSROW,SCPSCOL,SISD1MKY
          ENDIF
          RETURN
RDTSISD1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SISD1FL1,KEY5;SCPSROW,SCPSCOL,SISD1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSISD1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SISD1FL1,KEY5;;
          READKS    SISD1FL1;SCPSROW,SCPSCOL,SISD1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SISD1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Detail Maintenance        
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SISD1",NAMSSFFI
          MOVE      "   22",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Detail Maintenance        
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L103:
                            PS02L104,PS02L105,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L999,PS02L110:
                            PS02L111,PS02L112,PS02L113,PS02L114:
                            PS02L115,PS02L116,PS02L117,PS02L118:
                            PS02L119,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      SISCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SISCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          UNPACK    SISCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          UNPACK    SISCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      SISCDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Detail Maintenance        
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L102:
                            SF02L103,SF02L006,SF02L104,SF02L105:
                            SF02L106,SF02L107,SF02L108
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L101,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SISD1",NAMSSFFI
          MOVE      "   22",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSISD1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SISD1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SISD1MKY,KEY45 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODITM00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSISD1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SISD1MKY,KEY45 
            CALL      RSSISD1 
            CALL      RPSISD1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L104
          MOVE      "SISD1",NAMSSFFI
          MOVE      "   22",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "SISD1",NAMSSFFI
          MOVE      "   22",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "SISD1",NAMSSFFI
          MOVE      "   22",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L107
          MOVE      "SISD1",NAMSSFFI
          MOVE      "   22",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDCON00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Contract Detail Item               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Detail Item               
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Detail Item               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Detail Item               
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Detail Item               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Detail Item               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Detail Item               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L106,PS03L107,PS03L108:
                            PS03L109,PS03L110,PS03L111,PS03L112:
                            PS03L113,PS03L114,PS03L115,PS03L116:
                            PS03L117,PS03L118,PS03L119,PS03L120:
                            PS03L121,PS03L122,PS03L123,PS03L999:
                            PS03L999,PS03L124,PS03L125,PS03L126:
                            PS03L127,PS03L128,PS03L129,PS03L130:
                            PS03L131,PS03L132,PS03L133,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L134,PS03L135:
                            PS03L136,PS03L137,PS03L138,PS03L139:
                            PS03L140,PS03L141
          GOTO     PS03L999
.
PS03L101
          MOVE      SISDCAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SISDSUT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SISDUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SISDUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      SISDUC3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      SISDUC4,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      WHBKQTY1,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      WHBKQTY2,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      WHBKQTY3,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      WHMINQTY,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      SISDPO1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      SISDPO2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      SISDUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      SISDUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          UNPACK    SISDUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          UNPACK    SISDUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISDUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISDUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      SISFAQT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      SISFAPC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      WHESTQTY,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      SISFECT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      SISFUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      SISFUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          UNPACK    SISFUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          UNPACK    SISFUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISFUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISFUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L134
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L135
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L136
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L137
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L138
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L139
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L140
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L141
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Detail Item               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L101:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107,SF03L108,SF03L109:
                            SF03L110,SF03L111,SF03L112,SF03L113:
                            SF03L114,SF03L115,SF03L116,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L117:
                            SF03L006,SF03L006,SF03L006,SF03L118:
                            SF03L119,SF03L120,SF03L121,SF03L122:
                            SF03L123,SF03L124,SF03L125,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L126:
                            SF03L127,SF03L128,SF03L129,SF03L130:
                            SF03L131,SF03L132,SF03L133,SF03L134:
                            SF03L135,SF03L136
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L101:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107,SF03L108,SF03L109:
                            SF03L110,SF03L111,SF03L112,SF03L113:
                            SF03L114,SF03L115,SF03L116,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L118:
                            SF03L119,SF03L120,SF03L121,SF03L122:
                            SF03L123,SF03L124,SF03L125,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L129,SF03L130:
                            SF03L131,SF03L132,SF03L133,SF03L134:
                            SF03L135,SF03L136
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SISDUC1 
          IF        SCPSMAN=1
            COMPARE   ZERO,SISDUC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
          ENDIF
          MOVE      SISDUC1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBUC2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L102
            ENDIF
            BRANCH    EXIT,SF03L102,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SISDUC2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBUC3000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SISDUC3,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBUC4000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SISDUC4,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPBQ1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
            BRANCH    EXIT,SF03L105,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      WHBKQTY1,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPBQ2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L106
            ENDIF
            BRANCH    EXIT,SF03L106,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      WHBKQTY2,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPBQ3000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L107
            ENDIF
            BRANCH    EXIT,SF03L107,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      WHBKQTY3,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMINQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L108
            ENDIF
            BRANCH    EXIT,SF03L108,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      WHMINQTY,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L109
          CALL     SELECTED
          STRIP     SISDPO1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISDPO1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISDPO1 
          SFORMAT   VAR,127
          ENDSET    SISDPO1 
          APPEND    SP70,SISDPO1 
          RESET     SISDPO1 
          CMATCH    EXITCHAR,SISDPO1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISDPO1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
          ENDIF
          MOVE      SISDPO1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L110
          CALL     SELECTED
          STRIP     SISDPO2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISDPO2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISDPO2 
          SFORMAT   VAR,127
          ENDSET    SISDPO2 
          APPEND    SP70,SISDPO2 
          RESET     SISDPO2 
          CMATCH    EXITCHAR,SISDPO2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISDPO2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L110
            ENDIF
          ENDIF
          MOVE      SISDPO2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L111
          CALL     SELECTED
          STRIP     SISDUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISDUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISDUR1 
          SFORMAT   VAR,127
          ENDSET    SISDUR1 
          APPEND    SP70,SISDUR1 
          RESET     SISDUR1 
          CMATCH    EXITCHAR,SISDUR1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISDUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L111
            ENDIF
          ENDIF
          MOVE      SISDUR1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L112
          CALL     SELECTED
          STRIP     SISDUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISDUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISDUR2 
          SFORMAT   VAR,127
          ENDSET    SISDUR2 
          APPEND    SP70,SISDUR2 
          RESET     SISDUR2 
          CMATCH    EXITCHAR,SISDUR2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISDUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L112
            ENDIF
          ENDIF
          MOVE      SISDUR2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISDUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISDUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISDUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISDUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SISDUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISDUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SISDUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISDUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L117
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L118
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EESTQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L118
            ENDIF
            BRANCH    EXIT,SF03L118,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      WHESTQTY,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L119
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SISFECT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SISFECT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L119
            ENDIF
          ENDIF
          MOVE      SISFECT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L120
          CALL     SELECTED
          STRIP     SISFUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISFUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISFUR1 
          SFORMAT   VAR,127
          ENDSET    SISFUR1 
          APPEND    SP70,SISFUR1 
          RESET     SISFUR1 
          CMATCH    EXITCHAR,SISFUR1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISFUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L120
            ENDIF
          ENDIF
          MOVE      SISFUR1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L121
          CALL     SELECTED
          STRIP     SISFUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SISFUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SISFUR2 
          SFORMAT   VAR,127
          ENDSET    SISFUR2 
          APPEND    SP70,SISFUR2 
          RESET     SISFUR2 
          CMATCH    EXITCHAR,SISFUR2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SISFUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L121
            ENDIF
          ENDIF
          MOVE      SISFUR2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L122
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISFUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISFUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L123
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SISFUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SISFUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L124
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SISFUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISFUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L125
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SISFUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISFUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L126
          CALL      POS30000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L127
          CALL      CAN30000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L128
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DEL30000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L129
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICCCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICCCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L129
            ENDIF
          ENDIF
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L130
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICLCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICLCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L130
            ENDIF
          ENDIF
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L131
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICLTM 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICLTM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L131
            ENDIF
          ENDIF
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L132
          CALL     SELECTED
          STRIP     SIICPNO 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPNO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPNO 
          SFORMAT   VAR,127
          ENDSET    SIICPNO 
          APPEND    SP70,SIICPNO 
          RESET     SIICPNO 
          CMATCH    EXITCHAR,SIICPNO 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPNO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L132
            ENDIF
          ENDIF
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L133
          CALL     SELECTED
          STRIP     SIICPD1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPD1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPD1 
          SFORMAT   VAR,127
          ENDSET    SIICPD1 
          APPEND    SP70,SIICPD1 
          RESET     SIICPD1 
          CMATCH    EXITCHAR,SIICPD1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPD1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L133
            ENDIF
          ENDIF
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L134
          CALL     SELECTED
          STRIP     SIICPD2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPD2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPD2 
          SFORMAT   VAR,127
          ENDSET    SIICPD2 
          APPEND    SP70,SIICPD2 
          RESET     SIICPD2 
          CMATCH    EXITCHAR,SIICPD2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPD2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L134
            ENDIF
          ENDIF
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L135
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICMAN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L136
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICAPO 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Display Suppliers                  
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      SETSCR04
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Display Suppliers                  
.-------------------------------------------------------
CF04L000
          MOVE      SP70,FROMCRED
          MOVE      SP70,TOCRED  
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Display Suppliers                  
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Display Suppliers                  
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Display Suppliers                  
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Display Suppliers                  
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Display Suppliers                  
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L103,PS04L104
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMCRED,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      FCDESC,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      TOCRED,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      TCDESC,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Display Suppliers                  
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006,SF04L104,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L020,SF04L104,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNA0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FCDESC  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCRDF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMCRED,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FCDESC,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TCDESC  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCRDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      TOCRED,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TCDESC,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Contract Report                    
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      SETSCR05
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Contract Report                    
.-------------------------------------------------------
CF05L000
          MOVE      SP70,FROMCONT
          MOVE      SP70,TOCONT  
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Report                    
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Contract Report                    
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Contract Report                    
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Contract Report                    
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Contract Report                    
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L101:
                            PS05L102,PS05L103,PS05L104
          GOTO     PS05L999
.
PS05L101
          MOVE      FROMCONT,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      FCDESC,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      TOCONT,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      TCDESC,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Contract Report                    
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L103:
                            SF05L006,SF05L104,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L103:
                            SF05L020,SF05L104,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNB0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF05L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF05L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF05L999
          ENDIF
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF05L000
          ENDIF
          GOTO      SF05L001
.
SF05L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FCDESC  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMCONT,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FCDESC,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TCDESC  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCONT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
            BRANCH    EXIT,SF05L104,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      TOCONT,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TCDESC,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
DEFSDT00  IF    ACCEPT=1
            PACK    SISCSDT,CCC,CYY,CMM,CDD
            REP     " 0",SISCSDT
            UNPACK  SISCSDT,CCENT,CYEAR,CMON,CDAY
          ENDIF
          RETURN
DEFEDT00  IF    ACCEPT=1
            MOVE    SISCSDT,SISCEDT
            REP     " 0",SISCEDT
            UNPACK  SISCEDT,CCENT,CYEAR,CMON,CDAY
          ENDIF
          RETURN
DEL10000
          PACK     KEY47,SISCCON,SP70
          CALL     RSSISD1
          CALL     RKSISD1
          BRANCH   OVRCD,DEL10500
          MATCH    SISDCON,SISCCON
          GOTO     DEL10500 IF NOT EQUAL
          MOVE     "Items Still on file for that Contract - ",DISPMSG
          CALL     MESSAGE1
          GOTO     DEL19000
.
DEL10500  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DEL11000,DEL19000,DEL19100
.
DEL11000  PACK     KEY10,SISCCON
          CALL     RASISC1
          IF       OVRCD=0
            CALL     DESISC1
          ENDIF
.
DEL11100  PACK     KEY13,SISCCON,SP70
          CALL     RSSISE1
          CALL     RKSISE1
          BRANCH   OVRCD,DEL11900
          MATCH    SISECON,SISCCON
          GOTO     DEL11900 IF NOT EQUAL
          PACK     KEY13,SISECON,SISELIN
          CALL     DESISE1
          GOTO     DEL11100

DEL11900  MOVE     TWO,EXIT
          GOTO     DEL19999
DEL19000  MOVE     ONE,EXIT
          GOTO     DEL19999
DEL19100  MOVE     TWO,EXIT
          GOTO     DEL19999
DEL19999  RETURN

POS10000  PACK     KEY10,SISCCON
          CALL     RASISC1
          IF       OVRCD=0
            CALL     UPSISC1
          ELSE
            CALL     WRSISC1
          ENDIF
.
          PACK      KEY13,SISCCON,SP70
          CALL      RSSISE1
POS11000  CALL      RKSISE1
          BRANCH    OVRCD,POS11100
          MATCH     SISCCON,SISECON
          GOTO      POS11100 IF NOT EQUAL
          PACK      KEY13,SISECON,SISELIN
          CALL      DESISE1
          GOTO      POS11000
.
POS11100  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSISE1
          TRAPCLR   IO
          BRANCH    OVRCD,POS12100
          MOVE      ZERO,F3
POS12000  READ      TEMPWORD,SEQ;SISECOM
          GOTO      POS12100 IF OVER
          MOVE      F3,SISELIN
          PACK      KEY21,SISCCON,SISELIN
          UNPACK    KEY21,SISECON,SISELIN
          CALL      WRSISE1
          ADD       ONE,F3
          GOTO      POS12000
POS12100
POS19999  RETURN
CONDET00  MOVE     SISDCAT,KEY7
          CALL     RDSIIA1
          RETURN
MODITM00
          MOVE      SISD1MKY,KEY45
          CALL      RDSISD1
          IF        OVRCD=1
            MOVE      "Contract Item Missing - ",DISPMSG
            CALL      MESSAGE1
            GOTO      MDITM999
          ENDIF
.
          MOVE      SISDBQ1,WHBKQTY1
          MOVE      SISDBQ2,WHBKQTY2
          MOVE      SISDBQ3,WHBKQTY3
          MOVE      SISDMQT,WHMINQTY
.
          PACK      KEY27,SISDCAT,SISDSUP,SISDSUT
          CALL      RDSIIC1
          IF        OVRCD=1
            UNPACK    KEY27,SIICSUP,SIICCAT,SIICSUT
            MOVE      ZERO,SIICCCT
            MOVE      ZERO,SIICLCT
            MOVE      ZERO,SIICLTM
            MOVE      SP70,SIICPNO
            MOVE      SP70,SIICPD1
            MOVE      SP70,SIICPD2
            MOVE      ZERO,SIICMAN
            MOVE      ONE,SIICAPO
            MOVE      SP70,SIICUR1
            MOVE      SP70,SIICUR2
            MOVE      SP70,SIICUD1
            MOVE      SP70,SIICUD2
            MOVE      SP70,SIICUC1
            MOVE      SP70,SIICUC2
            MOVE      SP70,SIICUY1
            MOVE      SP70,SIICUY2
            MOVE      SP70,SIICSPA
          ELSE
            MOVE      TWO,AUDTTYPE
            CALL      WASIIC00
          ENDIF
.
          PACK      KEY37,SISDCON,SISDSUP,SISDCAT,SISDSUT
          CALL      RDSISF1
          IF        OVRCD=1
            UNPACK    KEY37,SISFCON,SISFSUP,SISFCAT,SISFSUT
            MOVE      ZERO,SISFAQT
            MOVE      ZERO,SISFAPC
            MOVE      ZERO,SISFEQT
            MOVE      ZERO,SISFECT
            MOVE      SP70,SISFUR1
            MOVE      SP70,SISFUR2
            MOVE      SP70,SISFUD1
            MOVE      SP70,SISFUD2
            MOVE      SP70,SISFUY1
            MOVE      SP70,SISFUY2
          ENDIF
.
          MOVE      SISFEQT,WHESTQTY
          MOVE      SISDCAT,KEY7
          CALL      RDSIIA1
          PACK      KEY30,SIIAISS,SISDSUT
          CALL      RDSIFA1
MDITM100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
MDITM200
          MOVE      ZERO,ACCEPT
          CALL      WP03L000 * Load any WP Details
          CALL      LM03L000 * Load any Batch Details
          CALL      DF03L000 * Display Fields
          CALL      SF03L000 * Select Fields
MDITM999  RETURN
ADDCON00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
          CALL      ADCLR000   * Clear Fields
          CALL      ADKEY000   * Enter Key Fields
          BRANCH    EXIT,ADCON999,ADCON999
          CALL      ADCLR100   * Clear Fields
          MOVE      ONE,ACCEPT * Add Mode
          CALL      DF03L000   * Display Fields
          CALL      SF03L000   * Select Fields
          GOTO      ADDCON00
.
ADCON999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Contract Detail Item
.--------------------------------------------------------
ADKEY000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIIAA00
          MOVE      SIIACAT,SISDCAT
          BRANCH    EXIT,ADKEY900,ADKEY900
.
          CALL      CHKCAT00
.
          MOVE      ZERO,ACCEPT
          MOVE      SISDCAT,VAR
          CALL      DISPITEM
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAAVC,VAR
            CALL      DISPITEM
          ENDIF
.
ADKEY120  MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SIIAISS,SIFAISSU
          CALL      KSIFAB00
          BRANCH    EXIT,ADKEY000,ADKEY900
          MOVE      SIFASUPP,SISDSUT
          MOVE      SISDSUT,VAR
          CALL      DISPITEM
.
ADKEY130  MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          BRANCH    OVRCD,ADKEY900
          PACK      SISDSDT,CCENT,CYEAR,CMON,CDAY
          MOVE      ZERO,ACCEPT
          UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
          PACK      KEY45,SISCCON,APMACRD,SIIACAT,SISDSDT,SISDSUT
          UNPACK    KEY45,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT
          CALL      RDSISD1
          IF        OVRCD=0
            MOVE      "Catalog Already on File for that Date - ",DISPMSG
            CALL      MESSAGE1
            GOTO      ADKEY000
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      ADKEY999
.
ADKEY900  MOVE      ONE,EXIT
ADKEY999  RETURN
.
ADCLR000  MOVE      SP70,SISDCAT
          MOVE      SP70,SISDSDT
          MOVE      SP70,SISDSUT
ADCLR100  MOVE      ZERO,SISDUC1
          MOVE      ZERO,SISDUC2
          MOVE      ZERO,SISDUC3
          MOVE      ZERO,SISDUC4
          MOVE      ZERO,SISDBQ1
          MOVE      ZERO,SISDBQ2
          MOVE      ZERO,SISDBQ3
          MOVE      ZERO,SISDMQT
          MOVE      SP70,SISDPO1
          MOVE      SP70,SISDPO2
          MOVE      SP70,SISDUR1
          MOVE      SP70,SISDUR2
          PACK      SISDUD1,CCC,CYY,CMM,CDD
          PACK      SISDUD2,CCC,CYY,CMM,CDD
          MOVE      ZERO,SISDUY1
          MOVE      ZERO,SISDUY2
.
          PACK      KEY37,SISDCON,SISDSUP,SISDCAT,SISDSUT
          CALL      RDSISF1
          IF        OVRCD=1
            UNPACK    KEY37,SISFCON,SISFSUP,SISFCAT,SISFSUT
            MOVE      ZERO,SISFAQT
            MOVE      ZERO,SISFAPC
            MOVE      ZERO,SISFEQT
            MOVE      ZERO,SISFECT
            MOVE      SP70,SISFUR1
            MOVE      SP70,SISFUR2
            MOVE      SP70,SISFUD1
            MOVE      SP70,SISFUD2
            MOVE      SP70,SISFUY1
            MOVE      SP70,SISFUY2
          ENDIF
.
          PACK      KEY27,SISDCAT,SISDSUP,SISDSUT
          CALL      RDSIIC1
          IF        OVRCD=1
            UNPACK    KEY27,SIICCAT,SIICSUP,SIICSUT
            MOVE      ZERO,SIICCCT
            MOVE      ZERO,SIICLCT
            MOVE      ZERO,SIICLTM
            MOVE      SP70,SIICPNO
            MOVE      SP70,SIICPD1
            MOVE      SP70,SIICPD2
            MOVE      ZERO,SIICMAN
            MOVE      ONE,SIICAPO
            MOVE      SP70,SIICUR1
            MOVE      SP70,SIICUR2
            MOVE      SP70,SIICUD1
            MOVE      SP70,SIICUD2
            MOVE      SP70,SIICUC1
            MOVE      SP70,SIICUC2
            MOVE      SP70,SIICUY1
            MOVE      SP70,SIICUY2
            MOVE      SP70,SIICSPA
          ENDIF
          RETURN
.
CHKCAT00  MOVE     SISCCON,KEY50
          PACK     KEY7,SISDCAT,SP70
          PACK     KEY45,SISDCAT,SP70
          CALL     RSSISD2
CHKCAT10
          CALL     RKSISD2
          BRANCH   OVRCD,CHKCAT80
          MATCH    KEY7,SISDCAT
          GOTO     CHKCAT80 IF NOT EQUAL
          MOVE     SISDCON,KEY10
          CALL     RDSISC1
          BRANCH   OVRCD,CHKCAT10
          PACK     KEY8,CCC,CYY,CMM,CDD
          REP      " 0",KEY8
          REP      " 0",SISCEDT
          MATCH    KEY8,SISCEDT
          GOTO     CHKCAT10 IF LESS
.
          MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          BEEP
          DISPLAY  *P1:24,*EL,"Catalog On Current Contract Ref : ",*V2LON:
                   SISCCON,*HOFF;
          CALL     HITENTER
          CALL     MESSAGE3
.
CHKCAT80  MOVE     KEY7,SISDCAT
          MOVE     KEY50,KEY10
          CALL     RDSISC1
.
. Get default supply unit
.
          PACK     SIFASUPP,SP70
          PACK     KEY27,SISDCAT,APMACRD,SP70
          CALL     RSSIIC1
          CALL     RKSIIC1
          BRANCH   OVRCD,CHKCAT99
          MATCH    APMACRD,SIICSUP
          GOTO     CHKCAT99 IF NOT EQUAL
          MATCH    SISDCAT,SIICCAT
          GOTO     CHKCAT99 IF NOT EQUAL
.
          PACK     SIFASUPP,SIICSUT,SP70
.
CHKCAT99  RETURN
EBUC2000  IF        ACCEPT=1
            MOVE      ZERO,SISDUC2
            IF        PRICEFLG=1
              GOTO      EBUC2999
            ENDIF
          ENDIF
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SISDUC2:
                    *PCCOL:CVERT
EBUC2999  RETURN
EBUC3000  IF        ACCEPT=1
            MOVE      ZERO,SISDUC3
            IF        PRICEFLG=1
              GOTO      EBUC3999
            ENDIF
          ENDIF
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SISDUC3:
                    *PCCOL:CVERT
EBUC3999  RETURN
EBUC4000  IF        ACCEPT=1
            MOVE      ZERO,SISDUC4
            IF        PRICEFLG=1
              GOTO      EBUC4999
            ENDIF
          ENDIF
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SISDUC4:
                    *PCCOL:CVERT
EBUC4999  RETURN
EPBQ1000  MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      SISDBQ1,WHBKQTY1
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHBKQTY1:
                    *PCCOL:CVERT
.
          IF        WHBKQTY1<0
            MOVE      "Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EPBQ1000
          ENDIF
.
          MOVE      WHBKQTY1,SISDBQ1
.
          MOVE      ZERO,PRICEFLG
          IF        SISDBQ1=0
            MOVE      ONE,PRICEFLG
          ENDIF
          RETURN
EPBQ2000  IF        ACCEPT=1
            MOVE      ZERO,SISDBQ2
            IF        PRICEFLG=1
              GOTO      EPBQ2999
            ENDIF
          ENDIF
          MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      SISDBQ2,WHBKQTY2
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHBKQTY2:
                    *PCCOL:CVERT
.
          IF        WHBKQTY2<0
            MOVE      "Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EPBQ2000
          ENDIF
.
          MOVE      WHBKQTY2,SISDBQ2
.
          IF        SISDBQ2=0
            MOVE      ONE,PRICEFLG
          ENDIF
EPBQ2999  RETURN
EPBQ3000  IF        ACCEPT=1
            MOVE      ZERO,SISDBQ3
            IF        PRICEFLG=1
              GOTO      EPBQ3999
            ENDIF
          ENDIF
          MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      SISDBQ3,WHBKQTY3
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHBKQTY3:
                    *PCCOL:CVERT
.
          IF        WHBKQTY3<0
            MOVE      "Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EPBQ3000
          ENDIF
.
          MOVE      WHBKQTY3,SISDBQ3
.
          IF        SISDBQ3=0
            MOVE      ONE,PRICEFLG
          ENDIF
.
EPBQ3999  RETURN
EMINQ000
          MOVE      SISDMQT,WHMINQTY
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHMINQTY:
                    *PCCOL:CVERT
.
          IF        WHMINQTY<0
            MOVE      "Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EMINQ000
          ENDIF
.
          MOVE      WHMINQTY,SISDMQT
.
EMINQ999  RETURN
EESTQ000
          MOVE      SISFEQT,WHESTQTY
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHESTQTY:
                    *PCCOL:CVERT
.
          IF        WHESTQTY<0
            MOVE      "Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EESTQ000
          ENDIF
.
          MOVE      WHESTQTY,SISFEQT
.
.
EESTQ999  RETURN
POS30000  PACK      KEY45,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT
          CALL      RASISD1
          IF        OVRCD=0
            CALL      UPSISD1
          ELSE
            CALL      WRSISD1
          ENDIF
.
          PACK      KEY37,SISDCON,SISDSUP,SISDCAT,SISDSUT
          UNPACK    KEY37,SISFCON,SISFSUP,SISFCAT,SISFSUT
          CALL      RASISF1
          IF        OVRCD=0
            CALL      UPSISF1
          ELSE
            CALL      WRSISF1
          ENDIF
.
          PACK      KEY27,SISDCAT,SISDSUP,SISDSUT
          UNPACK    KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL      RASIIC1
          IF        OVRCD=0
            CALL      UPSIIC1
            MOVE      THREE,AUDTTYPE
            CALL      WASIIC00                 * Audit Change
          ELSE
            CALL      WRSIIC1
            MOVE      ONE,AUDTTYPE
            CALL      WASIIC00                 * Audit Add
          ENDIF
.
          CALL      PALIA000
          RETURN
.------------------------------------------------------------
. Post Alias
.------------------------------------------------------------
PALIA000  PACK      KEY67,SIIACAT,SP70
          CALL      RSSIIF2
PALIA100  CALL      RKSIIF2
          BRANCH    OVRCD,PALIA200
          MATCH     SIIFCAT,SIIACAT
          GOTO      PALIA200 IF NOT EQUAL
          COMPARE   ZERO,SIIFATY
          GOTO      PALIA100 IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      DESIIF2
          GOTO      PALIA100
.
PALIA200
          MOVE      SIIACAT,SIIFCAT
          MOVE      SIIADES,SIIFALI
          MOVE      ONE,SIIFATY
          CALL      POSTALIA
.
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
PALIA300  CALL      RKSIIC1
          BRANCH    OVRCD,PALIA400
          MATCH     SIICCAT,SIIACAT
          GOTO      PALIA400 IF NOT EQUAL
.
          PACK      SIIFALI,SIICPD1,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPD2,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPNO,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      THREE,SIIFATY
          CALL      POSTALIA
          GOTO      PALIA300
PALIA400  PROC      WRKCT000        * Update Keyword Index
          RETURN
.
POSTALIA  MATCH     SP70,SIIFALI
          RETURN    IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      RASIIF2
          IF        OVRCD=1
            CALL      WRSIIF2
          ENDIF
          RETURN
CAN30000  CALL      DASIIC00
          RETURN
DEL30000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DEL31000,DEL39000,DEL39100
.
DEL31000
          PACK      KEY37,SISDCON,SISDSUP,SISDCAT,SISDSUT
          PACK      KEY45,SISDCON,SISDSUP,SISDCAT,SISDSDT,SISDSUT
          CALL      RASISD1
          IF        OVRCD=0
            CALL      DESISD1
          ENDIF
          PACK      KEY45,SISDCON,SISDSUP,SISDCAT,SP70
          PACK      KEY22,SISDCON,SISDSUP,SISDCAT,SP70
          CALL      RSSISD1
DEL34000
          CALL      RKSISD1
          BRANCH    OVRCD,DEL37000
          PACK      KEY45,SISDCON,SISDSUP,SISDCAT,SISDSUT,SP70
          MATCH     KEY22,KEY45
          GOTO      DEL37000 IF NOT EQUAL
          MATCH     KEY37,KEY45
          GOTO      DEL34000 IF NOT EQUAL
          GOTO      DEL38000

.
DEL37000  CALL      RASISF1
          IF        OVRCD=1
            CALL      RASISF1
          ENDIF
DEL38000
          MOVE     TWO,EXIT
          GOTO     DEL39999
DEL39000  MOVE     ONE,EXIT
          GOTO     DEL39999
DEL39100  MOVE     TWO,EXIT
          GOTO     DEL39999
DEL39999  RETURN
.----------------------------------------------------------------------
. Set up screen 04
.----------------------------------------------------------------------
SETSCR04
          MOVE      ONE,ACCEPT              * set accept mode
.
          CALL      DCRD0000                * default creditor range
.
          RETURN
.----------------------------------------------------------------------
. Default range
.----------------------------------------------------------------------
DCRD0000
          PACK      FROMCRED,START,SP70
          PACK      FCRED,SP70
          PACK      FCDESC,SP70
.
          PACK      TOCRED,END,SP70
          PACK      TCRED,Z70
          PACK      TCDESC,SP70
          RETURN
.**********************************************************************
. PRNA - print routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
PRNA0000
          PACK      DISPMSG,SP70,SP70       * save line 24
          CALL      MESSAGE2
.
          OPEN      IBACODE1,"ibacodef"     * open files
.         OPEN      IBAPRNT1,"ibaprntf"
.
          CLOSE     SCRSBGA1                * close files to stop "S*O 024"
          CLOSE     SCRPSTA1
.
          CALL      OPNPRINT                * open spool file
.
          OPEN      SCRSBGA1,"scrsbgaf"     * re-open files
          OPEN      SCRPSTA1,"scrpstaf"
.
          CALL      REPA0000                * print routine
          BRANCH    EXIT,PRNA9000           * check if anything to print
.
          IF        CPAGENO>0
            CALL      SELPRINT
          ELSE
            DISPLAY   *P1:24,*EL,"Nothing to Print !! - ";
            CALL      HITENTER
          ENDIF
          MOVE      ZERO,EXIT               * 0=printed ok
.
PRNA9000  CALL      CLSPRINT                * close spool file
          CLOSE     IBACODE1                * close files
.         CLOSE     IBAPRNT1
          CALL      MESSAGE3                * restore line 24
.
PRNA9999  RETURN
.********************************************************************
. REPA - print report for SISC                      Called by ML
.         Returns  : EXIT            (1=illegal range entered)
.********************************************************************
REPA0000
          MATCH     FCRED,TCRED                  * check Supplier range
          IF        @LESS
            DISPLAY   *P1:24,*B,*EF,"Illegal Supplier Range - ";
            CALL      HITENTER
            GOTO      REPA9500
          ENDIF
.
          DISPLAY   *P1:24,"Printing :   ";
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "90",CLNO                   * init last line number
          MOVE      SP70,APMACRD
.
          CALL      FILA0000                     * go to correct posit in file
.
REPA1000  CALL      NREA0000                     * get next record
          BRANCH    OVRCD,REPA8000               * end of file ?
.
          DISPLAY   *P12:24,*V2LON,SISDSUP,*EL;
.
          CALL      WRIA0000                     * print details
          GOTO      REPA1000                     * get next record
.
REPA8000  COMPARE   ZERO,CPAGENO
          CALL      HEAA0000 IF EQUAL            * print head if nothing printed
          CALL      UND132                       * print line
          PRINT     "****   End of Report   ****"
.
.
REPA9000  MOVE      ZERO,EXIT                    * exit screen
          GOTO      REPA9999
.
REPA9500  MOVE      ONE,EXIT                     * continue
.
REPA9999  RETURN
.**********************************************************************
.  FILA - Set file pointer                             Called By REPA
.**********************************************************************
FILA0000  BRANCH    OPTIONA,FILA0100,FILA9999,FILA9999,FILA9999:
                            FILA9999,FILA9999,FILA9999,FILA9999
.
.---- print by type 1 ----
.
FILA0100  PACK      KEY45,FCRED,SP70
          CALL      RSSISD3
          CALL      RPSISD3
          GOTO      FILA9999
.
FILA9999  RETURN
.**********************************************************************
.  NREA - Get next record                              Called By REPA
.**********************************************************************
NREA0000  BRANCH    OPTIONA,NREA0100,NREA9999,NREA9999,NREA9999:
                            NREA9999,NREA9999,NREA9999,NREA9999
.
.---- print by type 1 ----
.
NREA0100  CALL      RKSISD3
          BRANCH    OVRCD,NREA9500
.
          MATCH     SISDSUP,TCRED
          GOTO      NREA9500 IF LESS             * out of range ?
          GOTO      NREA9000
.
NREA9000  MOVE      ZERO,OVRCD         * continue
          GOTO      NREA9999
.
NREA9500  MOVE      ONE,OVRCD          * quit
.
NREA9999  RETURN
.********************************************************************
. HEAA - print report                               Called by REPA
.********************************************************************
HEAA0000  MOVE      "Supplier Report",CPHDROPT
.
          CALL      HEAD132                      * print heading
.
          PRINT     *1,"From : ",FROMCRED,SP2,FCDESC:
                    *N,*1,"To   : ",TOCRED,SP2,TCDESC
          CALL      UND132                       * print line
          PRINT     "| Supplier    Contract   Catalog     From Date   ":
                    "Price Breaks":
                    *132,"|",*N:
                    "|             Supply Unit        Min Order Qty         ":
                    *132,"|"
          CALL      UND132                       * print line
          ADD       "4",CLNO
.
HEAA9999  RETURN
.********************************************************************
. WRIA - print data line                            Called by REPA
.********************************************************************
WRIA0000
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      KEY10,CPCDATE
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAA0000 IF NOT LESS         * start new page
.
          MATCH     APMACRD,SISDSUP
          IF        !@EQUAL
            MOVE      SISDSUP,APMACRD
            MOVE      SP70,APMASN1
            MOVE      SP70,APMASN2
            PACK      KEY5,APMACRD,SP70
            CALL      RDAPMA1
            STRIP     APMASN1
            STRIP     APMASN2
            PRINT     *+,"| ",*132,"|",*N:
                      "| ",SISDSUP,SP2,APMASN1,SP1,APMASN2:
                      *132,"|"
            ADD       "2",CLNO           * add one to line number
          ENDIF
.
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAA0000 IF NOT LESS         * start new page
.
          UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      "999,999,999.99",KEY15
          MOVE      "999,999,999.99",KEY16
          MOVE      "999,999,999.99",KEY17
          MOVE      "999,999,999.99",KEY18
          MOVE      "999,999,999.9999",KEY19
          MOVE      "999,999,999.9999",KEY20
          MOVE      "999,999,999.9999",KEY21
          MOVE      "999,999,999.9999",KEY22
          FEDIT     SISDMQT,KEY15
          MATCH     "**",KEY15
          IF        @EQUAL
            MOVE      SISDMQT,KEY15
          ENDIF
          FEDIT     SISDBQ1,KEY16
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDBQ1,KEY16
          ENDIF
          FEDIT     SISDBQ2,KEY17
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDBQ2,KEY17
          ENDIF
          FEDIT     SISDBQ3,KEY18
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDBQ3,KEY18
          ENDIF
          FEDIT     SISDUC1,KEY19
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC1,KEY19
          ENDIF
          FEDIT     SISDUC2,KEY20
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC2,KEY20
          ENDIF
          FEDIT     SISDUC3,KEY21
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC3,KEY21
          ENDIF
          FEDIT     SISDUC4,KEY22
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC4,KEY22
          ENDIF
          SQUEEZE   KEY16
          SQUEEZE   KEY17
          SQUEEZE   KEY18
          SQUEEZE   KEY19
          SQUEEZE   KEY20
          SQUEEZE   KEY21
          SQUEEZE   KEY22
.
          PRINT     "| ",*132,"|",*N:
                    *+,"| ",SP10,SP2,SISDCON,SP1,SISDCAT,SP4,CPCDATE:
                    *50,"0.00 to ",KEY16," = $",KEY19,SP5:
                    *90,KEY16," to ",KEY17," = $",KEY20,SP5:
                    *132,"|",*N:
                    "| ",SP10,SP2:
                    SISDSUT,SP2,KEY15:
                    *50,KEY17," to ",KEY18," = $",KEY21,SP5:
                    *90,"over ",KEY18," = $",KEY22,SP5:
                    *132,"|"
          ADD       "3",CLNO           * add one to line number
.
WRIA9999  RETURN
.----------------------------------------------------------------------
. Keyin from code (APMA)
.----------------------------------------------------------------------
KCRDF000
          CALL      KAPMAA00                     * keyin APMA
          BRANCH    EXIT,KCRDF100,KCRDF950
.
          PACK      FROMCRED,APMACRD,SP70        * item entered
          PACK      FCRED,APMACRD,SP70
          PACK      FCDESC,APMASN1,SP70
          GOTO      KCRDF900
.
KCRDF100  PACK      FROMCRED,START,SP70          * nothing entered
          PACK      FCRED,SP70
          PACK      FCDESC,SP70
          GOTO      KCRDF900
.
KCRDF900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KCRDF999
.
KCRDF950  MOVE      TWO,EXIT                     * quit screen
.
KCRDF999  RETURN
.----------------------------------------------------------------------
. Keyin to code (APMA)
.----------------------------------------------------------------------
KCRDT000
          CALL      KAPMAA00                     * keyin APMA
          BRANCH    EXIT,KCRDT100,KCRDT950
.
          PACK      TOCRED,APMACRD,SP70          * item entered
          PACK      TCRED,APMACRD,SP70
          PACK      TCDESC,APMASN1,SP70
          GOTO      KCRDT900
.
KCRDT100  PACK      TOCRED,END,SP70              * nothing entered
          PACK      TCRED,Z70
          PACK      TCDESC,SP70
          GOTO      KCRDT900
.
KCRDT900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KCRDT999
.
KCRDT950  MOVE      TWO,EXIT                     * quit screen
.
KCRDT999  RETURN
.----------------------------------------------------------------------
. Set up screen 05
.----------------------------------------------------------------------
SETSCR05
          MOVE      ONE,ACCEPT              * set accept mode
.
          CALL      DCON0000                * default contract range
.
          RETURN
.----------------------------------------------------------------------
. Default range
.----------------------------------------------------------------------
DCON0000
          PACK      FROMCONT,START,SP70
          PACK      FCONT,SP70
          PACK      FCDESC,SP70
.
          PACK      TOCONT,END,SP70
          PACK      TCONT,Z70
          PACK      TCDESC,SP70
          RETURN
.**********************************************************************
. PRNB - print routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
PRNB0000
          PACK      DISPMSG,SP70,SP70       * save line 24
          CALL      MESSAGE2
.
          OPEN      IBACODE1,"ibacodef"     * open files
.         OPEN      IBAPRNT1,"ibaprntf"
.
          CLOSE     SCRSBGA1                * close files to stop "S*O 024"
          CLOSE     SCRPSTA1
.
          CALL      OPNPRINT                * open spool file
.
          OPEN      SCRSBGA1,"scrsbgaf"     * re-open files
          OPEN      SCRPSTA1,"scrpstaf"
.
          CALL      REPB0000                * print routine
          BRANCH    EXIT,PRNB9000           * check if anything to print
.
          IF        CPAGENO>0
            CALL      SELPRINT
          ELSE
            DISPLAY   *P1:24,*EL,"Nothing to Print !! - ";
            CALL      HITENTER
          ENDIF
          MOVE      ZERO,EXIT               * 0=printed ok
.
PRNB9000  CALL      CLSPRINT                * close spool file
          CLOSE     IBACODE1                * close files
.         CLOSE     IBAPRNT1
          CALL      MESSAGE3                * restore line 24
.
PRNB9999  RETURN
.********************************************************************
. REPB - print report for SISC                      Called by ML
.         Returns  : EXIT            (1=illegal range entered)
.********************************************************************
REPB0000
          MATCH     FCONT,TCONT                  * check Contract range
          IF        @LESS
            DISPLAY   *P1:24,*B,*EF,"Illegal Contract Range - ";
            CALL      HITENTER
            GOTO      REPB9500
          ENDIF
.
          DISPLAY   *P1:24,"Printing :   ";
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "60",CLNO                   * init last line number
.
          CALL      FILB0000                     * go to correct posit in file
.
REPB1000  CALL      NREB0000                     * get next record
          BRANCH    OVRCD,REPB8000               * end of file ?
.
          DISPLAY   *P12:24,*V2LON,SISCCON,*EL;
.
          CALL      WRIB0000                     * print details
          GOTO      REPB1000                     * get next record
.
REPB8000  COMPARE   ZERO,CPAGENO
          CALL      HEAB0000 IF EQUAL            * print head if nothing printed
          CALL      UND132                       * print line
          PRINT     "****   End of Report   ****"
.
.
REPB9000  MOVE      ZERO,EXIT                    * exit screen
          GOTO      REPB9999
.
REPB9500  MOVE      ONE,EXIT                     * continue
.
REPB9999  RETURN
.**********************************************************************
.  FILB - Set file pointer                             Called By REPB
.**********************************************************************
FILB0000  BRANCH    OPTIONA,FILB0100,FILB9999,FILB9999,FILB9999:
                            FILB9999,FILB9999,FILB9999,FILB9999
.
.---- print by type 1 ----
.
FILB0100  PACK      KEY10,FCONT,SP70
          CALL      RSSISC1
          CALL      RPSISC1
          GOTO      FILB9999
.
FILB9999  RETURN
.**********************************************************************
.  NREB - Get next record                              Called By REPB
.**********************************************************************
NREB0000  BRANCH    OPTIONA,NREB0100,NREB9999,NREB9999,NREB9999:
                            NREB9999,NREB9999,NREB9999,NREB9999
.
.---- print by type 1 ----
.
NREB0100  CALL      RKSISC1
          BRANCH    OVRCD,NREB9500
.
          MATCH     SISCCON,TCONT
          GOTO      NREB9500 IF LESS             * out of range ?
          GOTO      NREB9000
.
NREB9000  MOVE      ZERO,OVRCD         * continue
          GOTO      NREB9999
.
NREB9500  MOVE      ONE,OVRCD          * quit
.
NREB9999  RETURN
.********************************************************************
. HEAB - print report                               Called by REPB
.********************************************************************
HEAB0000  MOVE      "Contract Report",CPHDROPT
.
          CALL      HEAD132                      * print heading
.
          PRINT     *1,"From : ",FROMCONT,SP2,FCDESC:
                    *N,*1,"To   : ",TOCONT,SP2,TCDESC
          CALL      UND132                       * print line
          PRINT     "| Contract                                             ":
                    *90,"From Date      To Date":
                    *132,"|",*N:
                    "|             Supplier   Catalog     From Date   ":
                    "Price Breaks":
                    *132,"|",*N:
                    "|             Supply Unit        Min Order Qty         ":
                    *132,"|"
          CALL      UND132                       * print line
          ADD       "5",CLNO
.
HEAB9999  RETURN
.********************************************************************
. WRIB - print data line                            Called by REPB
.********************************************************************
WRIB0000
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      KEY10,CPCDATE
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAB0000 IF NOT LESS         * start new page
.
          PRINT     "| ",SISCCON,SP2,SISCDES,*90,KEY10,SP5,CPCDATE:
                    *132,"|"
          ADD       "1",CLNO           * add one to line number
.
          PACK      KEY13,SISCCON,SP70
          CALL      RSSISE1
.
WRIB1000
          CALL      RKSISE1
          BRANCH    OVRCD,WRIB2000
          MATCH     SISCCON,SISECON
          GOTO      WRIB2000 IF NOT EQUAL
.
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAB0000 IF NOT LESS         * start new page
.
          PRINT     "| ",SP10,SP2,SISECOM,*132,"|"
          ADD       "1",CLNO           * add one to line number
          GOTO      WRIB1000
.
WRIB2000
          PACK      KEY45,SISCCON,SP70
          CALL      RSSISD1
.
WRIB3000
          CALL      RKSISD1
          BRANCH    OVRCD,WRIB4000
          MATCH     SISCCON,SISDCON
          GOTO      WRIB4000 IF NOT EQUAL
.
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAB0000 IF NOT LESS         * start new page
.
          UNPACK    SISDSDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      "999,999,999.99",KEY15
          MOVE      "999,999,999.99",KEY16
          MOVE      "999,999,999.99",KEY17
          MOVE      "999,999,999.99",KEY18
          MOVE      "999,999,999.9999",KEY19
          MOVE      "999,999,999.9999",KEY20
          MOVE      "999,999,999.9999",KEY21
          MOVE      "999,999,999.9999",KEY22
          FEDIT     SISDMQT,KEY15
          MATCH     "**",KEY15
          IF        @EQUAL
            MOVE      SISDMQT,KEY15
          ENDIF
          FEDIT     SISDBQ1,KEY16
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDBQ1,KEY16
          ENDIF
          FEDIT     SISDBQ2,KEY17
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDBQ2,KEY17
          ENDIF
          FEDIT     SISDBQ3,KEY18
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDBQ3,KEY18
          ENDIF
          FEDIT     SISDUC1,KEY19
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC1,KEY19
          ENDIF
          FEDIT     SISDUC2,KEY20
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC2,KEY20
          ENDIF
          FEDIT     SISDUC3,KEY21
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC3,KEY21
          ENDIF
          FEDIT     SISDUC4,KEY22
          MATCH     "**",KEY16
          IF        @EQUAL
            MOVE      SISDUC4,KEY22
          ENDIF
          SQUEEZE   KEY16
          SQUEEZE   KEY17
          SQUEEZE   KEY18
          SQUEEZE   KEY19
          SQUEEZE   KEY20
          SQUEEZE   KEY21
          SQUEEZE   KEY22
.
          PRINT     "| ",*132,"|",*N:
                    *+,"| ",SP10,SP2,SISDSUP,SP6,SISDCAT,SP4,CPCDATE:
                    *50,"0.00 to ",KEY16," = $",KEY19,SP5:
                    *90,KEY16," to ",KEY17," = $",KEY20,SP5:
                    *132,"|",*N:
                    "| ",SP10,SP2:
                    SISDSUT,SP2,KEY15:
                    *50,KEY17," to ",KEY18," = $",KEY21,SP5:
                    *90,"over ",KEY18," = $",KEY22,SP5:
                    *132,"|"
          ADD       "3",CLNO           * add one to line number
          GOTO      WRIB3000
.
WRIB4000
          PRINT     "| ",*132,"|"
          ADD       "1",CLNO           * add one to line number
.
WRIB9999  RETURN
.----------------------------------------------------------------------
. Keyin from code (SISC)
.----------------------------------------------------------------------
KCONF000
          CALL      KSISCA00                     * keyin SISC
          BRANCH    EXIT,KCONF100,KCONF950
.
          PACK      FROMCONT,SISCCON,SP70        * item entered
          PACK      FCONT,SISCCON,SP70
          PACK      FCDESC,SISCDES,SP70
          GOTO      KCONF900
.
KCONF100  PACK      FROMCONT,START,SP70          * nothing entered
          PACK      FCONT,SP70
          PACK      FCDESC,SP70
          GOTO      KCONF900
.
KCONF900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KCONF999
.
KCONF950  MOVE      TWO,EXIT                     * quit screen
.
KCONF999  RETURN
.----------------------------------------------------------------------
. Keyin to code (SISC)
.----------------------------------------------------------------------
KCONT000
          CALL      KSISCA00                     * keyin SISC
          BRANCH    EXIT,KCONT100,KCONT950
.
          PACK      TOCONT,SISCCON,SP70          * item entered
          PACK      TCONT,SISCCON,SP70
          PACK      TCDESC,SISCDES,SP70
          GOTO      KCONT900
.
KCONT100  PACK      TOCONT,END,SP70              * nothing entered
          PACK      TCONT,Z70
          PACK      TCDESC,SP70
          GOTO      KCONT900
.
KCONT900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KCONT999
.
KCONT950  MOVE      TWO,EXIT                     * quit screen
.
KCONT999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCICIO/INC
          INC       SINCIFIO/INC
          INC       SINFACIO/INC
          INC       SINFACKY    
          INC       SINKCTPR    
          INC       SINNATIO/INC
          INC       SINSCDIO/INC
          INC       SINSCFIO/INC
          INC       SINSCMIO/INC
          INC       SINSCMKY    
          INC       SINSECIO/INC
.
          INC       STDGENCD
.
