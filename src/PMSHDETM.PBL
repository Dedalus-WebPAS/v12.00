. *----------------------------------------------------------------------
. * Include Name  :   PMSHDETM.PBL
. *
. * Function      :   CGI variables for PMSHDEFD - pmshdeaf.dat
. *
. * Includes Needed : PMSHDEFD - ABF HAC Detail Complexity Table
. *                   PMSHDEIO - IO for ABF HAC Detail Complexity Table
. * Modifications :
. * V10.14.02 10/07/2019 Peter Vela TSK 0857392
. *           Added Ventilation, Unknown
. * V10.14.01 02/07/2019 Peter Vela TSK 0857392
. *           Added Age 095 - 099
. *           Added MDC Mental Diseases & Disorders, Alcohol/Drug Use&Induced
. *           Organic Mental Disorder
. *
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for ABF HAC Detail Complexity Table
.------------------------------------------------------------------------
.
CLRHDE00  MOVE      Z70,PMHDE001
          MOVE      Z70,PMHDE002
          MOVE      Z70,PMHDE003
          MOVE      Z70,PMHDE004
          MOVE      ZERO,PMHDE005
          MOVE      Z70,PMHDE006
          MOVE      Z70,PMHDE007
          MOVE      Z70,PMHDE008
          MOVE      Z70,PMHDE009
          MOVE      Z70,PMHDE010
          MOVE      Z70,PMHDE011
.
          MOVE      ZERO,PMHDE012
          MOVE      ZERO,PMHDE013
          MOVE      ZERO,PMHDE014
          MOVE      ZERO,PMHDE015
          MOVE      ZERO,PMHDE016
          MOVE      ZERO,PMHDE017
          MOVE      ZERO,PMHDE018
          MOVE      ZERO,PMHDE019
          MOVE      ZERO,PMHDE020
          MOVE      ZERO,PMHDE021
          MOVE      ZERO,PMHDE022
          MOVE      ZERO,PMHDE023
          MOVE      ZERO,PMHDE024
          MOVE      ZERO,PMHDE025
          MOVE      ZERO,PMHDE026
          MOVE      ZERO,PMHDE027
          MOVE      ZERO,PMHDE028
          MOVE      ZERO,PMHDE029
          MOVE      ZERO,PMHDE030
          MOVE      ZERO,PMHDE031
          MOVE      ZERO,PMHDE032
          MOVE      ZERO,PMHDE033
          MOVE      ZERO,PMHDE034
          MOVE      ZERO,PMHDE035 
          MOVE      ZERO,PMHDE036
          MOVE      ZERO,PMHDE037
          MOVE      ZERO,PMHDE038
          MOVE      ZERO,PMHDE039
          MOVE      ZERO,PMHDE040
          MOVE      ZERO,PMHDE041
          MOVE      ZERO,PMHDE042
          MOVE      ZERO,PMHDE043
          MOVE      ZERO,PMHDE044
          MOVE      ZERO,PMHDE045
          MOVE      ZERO,PMHDE046
          MOVE      ZERO,PMHDE047
          MOVE      ZERO,PMHDE048
          MOVE      ZERO,PMHDE049
          MOVE      ZERO,PMHDE050
          MOVE      ZERO,PMHDE051
          MOVE      ZERO,PMHDE052
          MOVE      ZERO,PMHDE053
          MOVE      ZERO,PMHDE054
          MOVE      ZERO,PMHDE055
          MOVE      ZERO,PMHDE056
          MOVE      ZERO,PMHDE057
          MOVE      ZERO,PMHDE058
          MOVE      ZERO,PMHDE059
          MOVE      ZERO,PMHDE060
          MOVE      ZERO,PMHDE061
          MOVE      ZERO,PMHDE062
          MOVE      ZERO,PMHDE063
          MOVE      ZERO,PMHDE064
          MOVE      ZERO,PMHDE065
          MOVE      ZERO,PMHDE066
          MOVE      ZERO,PMHDE067
          MOVE      ZERO,PMHDE068
          MOVE      ZERO,PMHDE069
          MOVE      ZERO,PMHDE070
          MOVE      ZERO,PMHDE071
          MOVE      ZERO,PMHDE072
          RETURN
.
.------------------------------------------------------------
. ABF HAC Detail Complexity Table
.-----------------------------------------------------------
PMHE0000  BRANCH    FLDITMNO,PMHE0010,PMHE0020,PMHE0030,PMHE0040,PMHE0050:
                             PMHE0060,PMHE0070,PMHE0080,PMHE0090,PMHE0100:
                             PMHE0110
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMHE9999
.
PMHE0010  UNPACK    DIM127,D1,KEY1,DIM127        * Contract ID
          MOVE      KEY1,F1
          BRANCH    F1,PMHE0012
.
          WRITE     HTMLFILE;PMHECNTR;
          GOTO      PMHE9999
.
PMHE0012  PACK      KEY6,PMHECNTR,SP70
          CALL      RDPMCID1
          BRANCH    OVRCD,PMHE9999
.
          WRITE     HTMLFILE;PMCIDESC;
          GOTO      PMHE9999
.
PMHE0020  MOVE      "Ha",CATEGORY
          MOVE      PMHEHACG,CODE
          CALL      CODITM00
          GOTO      PMHE9999
.
PMHE0030  WRITE     HTMLFILE;PMHEHACT;
          GOTO      PMHE9999
.
PMHE0040  WRITE     HTMLFILE;PMHEHACF;
          GOTO      PMHE9999
.
PMHE0050  WRITE     HTMLFILE;PMHECOMV;
          GOTO      PMHE9999
.
PMHE0060  MATCH     PMHECDAT,SP70
          GOTO      PMHE9999 IF EQUAL
.
          UNPACK    PMHECDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMHE9999
.
PMHE0070  WRITE     HTMLFILE;PMHECTIM;
          GOTO      PMHE9999
.
PMHE0080  WRITE     HTMLFILE;PMHECUID;
          GOTO      PMHE9999
.
PMHE0090  MATCH     PMHEUDAT,SP70
          GOTO      PMHE9999 IF EQUAL
.
          UNPACK    PMHEUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR; 
          GOTO      PMHE9999
.
PMHE0100  WRITE     HTMLFILE;PMHEUTIM;
          GOTO      PMHE9999
.
PMHE0110  WRITE     HTMLFILE;PMHEUUID;
          GOTO      PMHE9999
.
PMHE9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for ABF HAC Detail Complexity Table
.------------------------------------------------------------
SPPHE000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPHE001,SPPHE002,SPPHE003,SPPHE004,SPPHE005:
                       SPPHE006,SPPHE007,SPPHE008,SPPHE009,SPPHE010:
                       SPPHE011,SPPHE012,SPPHE013,SPPHE014,SPPHE015:
                       SPPHE016,SPPHE017,SPPHE018,SPPHE019,SPPHE020:
                       SPPHE021,SPPHE022,SPPHE023,SPPHE024,SPPHE025:
                       SPPHE026,SPPHE027,SPPHE028,SPPHE029,SPPHE030:
                       SPPHE031,SPPHE032,SPPHE033,SPPHE034,SPPHE035:
                       SPPHE036,SPPHE037,SPPHE038,SPPHE039,SPPHE040:
                       SPPHE041,SPPHE042,SPPHE043,SPPHE044,SPPHE045:
                       SPPHE046,SPPHE047,SPPHE048,SPPHE049,SPPHE050:
                       SPPHE051,SPPHE052,SPPHE053,SPPHE054,SPPHE055:
                       SPPHE056,SPPHE057,SPPHE058,SPPHE059,SPPHE060:
                       SPPHE061,SPPHE062,SPPHE063,SPPHE064,SPPHE065:
                       SPPHE066,SPPHE067,SPPHE068,SPPHE069,SPPHE070: 
                       SPPHE071,SPPHE072
.
          MOVE      ONE,EXIT
          GOTO      SPPHE999
.
SPPHE001  MOVE      QRYDATA,PMHDE001
          PACK      PMHDE001,PMHDE001,SP70
          GOTO      SPPHE999
.
SPPHE002  MOVE      QRYDATA,PMHDE002
          PACK      PMHDE002,PMHDE002,SP70
          GOTO      SPPHE999
.
SPPHE003  MOVE      QRYDATA,PMHDE003
          PACK      PMHDE003,PMHDE003,SP70
          GOTO      SPPHE999 
.
SPPHE004  MOVE      QRYDATA,PMHDE004
          PACK      PMHDE004,PMHDE004,SP70
          GOTO      SPPHE999
.
SPPHE005  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE005
          GOTO      SPPHE999
.
SPPHE006  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMHDE006,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPHE999
.
SPPHE007  MOVE      QRYDATA,PMHDE007
          PACK      PMHDE007,PMHDE007,SP70
          GOTO      SPPHE999
.
SPPHE008  MOVE      QRYDATA,PMHDE008
          PACK      PMHDE008,PMHDE008,SP70
          GOTO      SPPHE999
.
SPPHE009  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMHDE009,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPHE999
.
SPPHE010  MOVE      QRYDATA,PMHDE010
          PACK      PMHDE010,PMHDE010,SP70
          GOTO      SPPHE999
.
SPPHE011  MOVE      QRYDATA,PMHDE011
          PACK      PMHDE011,PMHDE011,SP70
          GOTO      SPPHE999
.
SPPHE012  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE012
          GOTO      SPPHE999
.
SPPHE013  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE013
          GOTO      SPPHE999
.
SPPHE014  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE014
          GOTO      SPPHE999
.
SPPHE015  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE015
          GOTO      SPPHE999
.
SPPHE016  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE016
          GOTO      SPPHE999
.
SPPHE017  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE017
          GOTO      SPPHE999
.
SPPHE018  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE018
          GOTO      SPPHE999
.
SPPHE019  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE019
          GOTO      SPPHE999
.
SPPHE020  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE020
          GOTO      SPPHE999
.
SPPHE021  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE021
          GOTO      SPPHE999
.
SPPHE022  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE022
          GOTO      SPPHE999
.
SPPHE023  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE023
          GOTO      SPPHE999
.
SPPHE024  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE024
          GOTO      SPPHE999
.
SPPHE025  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE025
          GOTO      SPPHE999
.
SPPHE026  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE026
          GOTO      SPPHE999
.
SPPHE027  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE027
          GOTO      SPPHE999
.
SPPHE028  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE028
          GOTO      SPPHE999
.
SPPHE029  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE029
          GOTO      SPPHE999
.
SPPHE030  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE030
          GOTO      SPPHE999
.
SPPHE031  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE031
          GOTO      SPPHE999
.
SPPHE032  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE032
          GOTO      SPPHE999
.
SPPHE033  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE033
          GOTO      SPPHE999
.
SPPHE034  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE034
          GOTO      SPPHE999
.
SPPHE035  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE035
          GOTO      SPPHE999
.
SPPHE036  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE036
          GOTO      SPPHE999
.
SPPHE037  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE037
          GOTO      SPPHE999
.
SPPHE038  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE038
          GOTO      SPPHE999
.
SPPHE039  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE039
          GOTO      SPPHE999
.
SPPHE040  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE040
          GOTO      SPPHE999
.
SPPHE041  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE041
          GOTO      SPPHE999
.
SPPHE042  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE042
          GOTO      SPPHE999
.
SPPHE043  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE043
          GOTO      SPPHE999
.
SPPHE044  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE044
          GOTO      SPPHE999
.
SPPHE045  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE045
          GOTO      SPPHE999
.
SPPHE046  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE046
          GOTO      SPPHE999
.
SPPHE047  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE047
          GOTO      SPPHE999
.
SPPHE048  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE048
          GOTO      SPPHE999
.
SPPHE049  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE049
          GOTO      SPPHE999
.
SPPHE050  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE050
          GOTO      SPPHE999
.
SPPHE051  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE051
          GOTO      SPPHE999
.
SPPHE052  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE052
          GOTO      SPPHE999
.
SPPHE053  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE053
          GOTO      SPPHE999
.
SPPHE054  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE054
          GOTO      SPPHE999
.
SPPHE055  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE055
          GOTO      SPPHE999
.
SPPHE056  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE056
          GOTO      SPPHE999
.
SPPHE057  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE057
          GOTO      SPPHE999
.
SPPHE058  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE058
          GOTO      SPPHE999
.
SPPHE059  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE059
          GOTO      SPPHE999
.
SPPHE060  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE060
          GOTO      SPPHE999
.
SPPHE061  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE061
          GOTO      SPPHE999
.
SPPHE062  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE062
          GOTO      SPPHE999
.
SPPHE063  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE063
          GOTO      SPPHE999
.
SPPHE064  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE064
          GOTO      SPPHE999
.
SPPHE065  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE065
          GOTO      SPPHE999
.
SPPHE066  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE066
          GOTO      SPPHE999
.
SPPHE067  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE067
          GOTO      SPPHE999
.
SPPHE068  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE068
          GOTO      SPPHE999
.
SPPHE069  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE069
          GOTO      SPPHE999
.
SPPHE070  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE070
          GOTO      SPPHE999
.
SPPHE071  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE071
          GOTO      SPPHE999
.
SPPHE072  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMHDE072
          GOTO      SPPHE999
.
SPPHE999  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to ABF HAC Detail Complexity Table
.------------------------------------------------------------------------
MVPMHE00  MATCH     PMHDE001,Z70
          IF        !@EQUAL
            MOVE      PMHDE001,PMHECNTR
          ENDIF
.
          MATCH     PMHDE002,Z70
          IF        !@EQUAL
            MOVE      PMHDE002,PMHEHACG
          ENDIF
.
          MATCH     PMHDE003,Z70
          IF        !@EQUAL
            MOVE      PMHDE003,PMHEHACT
          ENDIF
.
          MATCH     PMHDE004,Z70
          IF        !@EQUAL
            MOVE      PMHDE004,PMHEHACF
          ENDIF
.
          COMPARE   PMHDE005,ZERO
          IF        !@EQUAL
            MOVE      PMHDE005,PMHECOMV
          ENDIF
.
          MATCH     PMHDE006,Z70
          IF        !@EQUAL
            MOVE      PMHDE006,PMHECDAT
          ENDIF
.
          MATCH     PMHDE007,Z70
          IF        !@EQUAL
            MOVE      PMHDE007,PMHECTIM
          ENDIF
.
          MATCH     PMHDE008,Z70
          IF        !@EQUAL
            MOVE      PMHDE008,PMHECUID
          ENDIF
.
          MATCH     PMHDE009,Z70
          IF        !@EQUAL
            MOVE      PMHDE009,PMHEUDAT
          ENDIF
.
          MATCH     PMHDE010,Z70
          IF        !@EQUAL
            MOVE      PMHDE010,PMHEUTIM
          ENDIF
.
          MATCH     PMHDE011,Z70
          IF        !@EQUAL
            MOVE      PMHDE011,PMHEUUID
          ENDIF
.
MVPMHE99  RETURN
+
