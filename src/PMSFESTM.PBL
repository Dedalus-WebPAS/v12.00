. Module      PMSFESTM.PBL
.
.             Fees Estimate module
.
. Modifications
.  V12.00.01 12/05/2025 J.Tan           TSK 0960349
.            Fixed GST amount for HEA Fees Estimate
.  V11.05.04 09/04/2025 J.Tan           TSK 0953687
.            Mod SJOG IFC - set GST of MBS item for uninsured to patient portion
.  V11.05.03 19/02/2025 J.Tan           TSK 0953687
.            Mod SJOG IFC to print Total GST for Patient and Rebate portion
.  V11.05.02 26/11/2024 J.Tan           TSK 0953687
.            Mod SJOG IFC to print Total GST for Patient and Rebate portion
.  V11.05.01 15/10/2024 J.Tan           TSK 0951331
.            Added Misc.item field to HEA IFC Eligibility Check page
.  V11.04.03 21/08/2024 J.Tan           TSK 0942917
.            Fixed SJOG IFC MBS items with quantity
.  V11.04.02 30/07/2024 J.Tan           TSK 0942917
.            Mod for SJOG Fees Est.Private Bed rounding before multiplied by LOS
.  V11.04.01 25/06/2024 J.Tan           TSK 0942917
.            Mod for SJOG IFC from ELigibility Check to store items to pmseliaf
.  V11.03.04 04/07/2023 J.Tan    TSK 0934653
.            Fixed Usebasic variable for SJOG IFC (PMFT9999)
.  V11.03.03 06/02/2023 J.Tan    TSK 0926482
.            Fixed restoring Using basic cover variable for HEA Fees Estimate
.  V11.03.02 12/12/2022 J.Tan    TSK 0926482
.            Fixed Use basic cover for HEA Fees Estimate
.  V11.03.01 06/12/2022 J.Tan    TSK 0926482
.            Fixed HEA Fees Estimate Use basic cover rate
.  V11.02.09 21/11/2022 J.Tan    TSK 0900069
.            Fixed Use basic cover for HEA Fees Estimate (HCHR0000)
.  V11.02.08 07/11/2022 J.Tan    TSK 0925716
.            Mod VDVA0000 to use claim code from pmfsclty (not to read patmisaf)
.  V11.02.07 30/09/2022 J.Tan           TSK 0900069
.            Mod HEA Fees Estimate to print quantity of Misc./Theatre fee items
.            (PMFT5130 and PMFT5420)
.  V11.02.06 16/09/2022 Jill Parkinson Task 0924737
.            Removed the use of post op or exp ward to determine the bed type
.            in BTEX0000 for sjog 
.            It will now always use the default bed type for private    
.  V11.02.05 14/09/2022 Jill Parkinson Task 0924680
.            Added clear of pmsaelaf in GQTE000 to stop using last person
.  V11.02.04 05/09/2022 J.Tan    TSK 0924085
.            Mod GTGST00 for SJOG Fees Estimate
.  V11.02.03 13/07/2022 J.Tan           TSK 0900069
.            Mod HEA Fees Estimate for using Default Cover Rate
.  V11.02.02 01/07/2022 J.Tan           TSK 0921502
.            Mod for SJOG IFC rounding for Accom. for Patient Cost (column 4,5)
.  V11.02.01 11/02/2022 J.Tan           TSK 0910723
.            Mod for SJOG IFC
.  V11.01.12 01/02/2022  J.Tan          Task 0915997
.            Daycase NOT to print Funder column for other bedtypes
.  V11.01.11 24/11/2021  J.Tan          Task 0912367
.            Mod to include Consumables  to Out of pocket (FLDITMNO=507)
.  V11.01.10 07/09/2021  J.Tan          Task 0910723
.            Mod SJOG Casemix accommodation NOT to do Rounding to nearest dollar
.  V11.01.09 01/07/2021  J.Tan          Task 0885959
.            Mod for Fees Estimate Standard format
.  V11.01.08 04/06/2021  J.Tan          TSK 0896226
.            Mod for SJOG IFC/Fees Estimate layout
.  V11.01.01 02/03/2021  Jill Parkinson Task 0892480
.            Corrected sameday/overnight for hea preferred bed type
.  V11.00.03 01/09/2020  Jill Parkinson Task 0892480
.            Added Hea functionality to BTEX0000.  Hea will use preferred 
.            accommodation if entered to calculate maximum charge
.  V11.00.02 20/05/2020  J.Tan          TSK 0891011
.            Fixed printing SJOG IFC daycase Maximum (column5)
.  V11.00.01 04/03/2020  J.Tan          TSK 0838262
.            Added Effective from and to date to MBS Item file
.  V10.15.01 22/01/2020  J.Tan          TSK 0826834
.            Mod for SJOG IFC/Fees Estimate
.  V10.14.01 15/11/2019  J.Tan          TSK 0826834
.            Mod for SJOG IFC/Fees Estimate
.  V10.12.01 10/07/2018  Ebon Clements  TSK 0859180
.            Fixed consumables file read - CONF0000
.            Fixed reads and checked quoto number on all pmsfesaf reads
.  V10.11.01 20/12/2017  J.Tan          TSK 0844301
.            Added Consumables to Fees Estimates and Extra MBS
.  V10.08.05 28/09/2016  J.Tan          TSK 0826492
.            Fixed Fees Estimate links with Eligibility check
.  V10.08.04 29/08/2016  J.Tan          TSK 0823330
.            Fixed Fees Estimate links with Eligibility check
.  V10.08.03 18/08/2016  J.Tan          TSK 0823330
.            Mods checking for Blank ADMISSNO for Free format name Fees Est.
.  V10.08.02 28/07/2016  J.Tan          TSK 0823330
.            Fixed calculate Fees Estimate for using HEA and SJOG IFC format
.  V10.08.01 16/03/2016  J.Tan        CAR 313842
.            Fixed printing SJOG IFC
.  V10.06.02 09/07/2015  J.Tan        CAR 316980
.            Mods changes for HEA IFC
.  V10.06.01 17/04/2015  Davin          CAR 314005 HEA IFC Spec V3
.            Display long description for cat.BT (HCHR1000)
.            Don't output zero amounts to htmlfile (HCHR0000/HTHE0000)
.            30/04/2015  J.Tan        CAR 314005
.            Mods further update for HEA IFC
.  V10.05.05 23/09/2014  J.Tan        CAR 310816
.            Mods to use PTCDNHCP=2 for Shared bed type
.  V10.05.04  03/02/2015  Davin           CAR 310816
.             Changed tags output from 'Sameday' to 'Same Day'
.  V10.05.03  24/10/2014  J.Tan           CAR 253233
.             Fixed Theatre/Procedure Charges for HEA Layout
.  V10.05.02  01/10/2014  J.Tan           CAR 253233
.             Mods Quote no to be Adm.no (with leading 9s) for HEA IFC layout 
.  V10.05.01  12/09/2014  J.Tan           CAR 253233
.             Mods for Healthscope IFC layout
.  V10.03.01  20/04/2012  J.Tan           LanDesk 500543
.             Added record type 7 to pmsfesaf for Other fees
.  V10.01.01  03/12/2010  Mike Laming     CAR 233046
.             Mods to "patmchgf" - replaced read logic with PATMCHRD in GETMSC00
.  V10.00.02  13/08/2010  Davin           CAR 221046
.             Added output of misc charge fee pmfstheh (ftmx2060)
.  V10.00.01  30/04/2010  J.Tan           CAR 220887
.             Mods checking for Active/Inactive of Misc.charge
.   V9.10.04  13/08/2008  Davin           CAR 175768
.             Fixed calculation in gst total tag (GTGST000) 
.   V9.10.03  15/07/2008  Ebon Clements   CAR 160213
.             Added PMFSGSTP and PMFSGSTC
.   V9.10.02  14/05/2008  J.Tan           CAR 164036
.             Fixed daycase patient cost for the selected bed type
.   V9.10.01  07/05/2008  Davin           CAR 164036
.             Fixed displaying daycase daily charge (bed type desc.)
.   V9.09.01  06/12/2007  Davin           CAR 151898
.             Added new tags for Cabrini Fees Estimate Form (bfbr0000)
.
.------------------------------------------------------------
. Add PMI Extension Field
.------------------------------------------------------------
PMFS0000  BRANCH    FLDITMNO,PMFS0100,PMFS0200,PMFS0300,PMFS0400,PMFS0500:
                             PMFS0600,PMFS0700,PMFS0800,PMFS0900,PMFS1000:
                             PMFS1100,PMFS1200,PMFS1300,PMFS1400,PMFS1500:
                             PMFS1600,PMFS1700,PMFS1800,PMFS1900,PMFS2000:
                             PMFS2100,PMFS2200,PMFS2300,PMFS2400,PMFS2500:
                             PMFS2600,PMFS2700,PMFS2800,PMFS2900,PMFS3000:
                             PMFS3100,PMFS3200,PMFS3300,PMFS3400,PMFS3500:
                             PMFS3600,PMFS3700,PMFS3800,PMFS3900,PMFS4000:
                             PMFS4100,PMFS4200,PMFS4300,PMFS4400,PMFS4500:
                             PMFS4600,PMFS4700,PMFS4800,PMFS4900,PMFS5000:
                             PMFS5100,PMFS5200,PMFS5300,PMFS5400,PMFS5500:
                             PMFS5600,PMFS5700,PMFS5800,PMFS5900,PMFS6000:
                             PMFS6100,PMFS6200,PMFS6300,PMFS6400,PMFS6500:
                             PMFS6600,PMFS6700,PMFS6800,PMFS6900,PMFS7000:
                             PMFS7100,PMFS7200,PMFS7300,PMFS7400,PMFS7500:
                             PMFS7600,PMFS7700,PMFS7800,PMFS7900,PMFS8000:
                             PMFS8100,PMFS8200,PMFS8300,PMFS8400,PMFS8500:
                             PMFS8600,PMFS8700,PMFS8800,PMFS8900,PMFS9000:
                             PMFS9100,PMFS9200,PMFS9300,PMFS9400,PMFS9500:
                             PMFS9600,PMFS9700,PMFS9800,PMFS9900
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMFS9999
.
PMFS0100  WRITE     HTMLFILE;PMFSQUOT;
          GOTO      PMFS9999
.
PMFS0200  WRITE     HTMLFILE;DPMFSUNI;
          GOTO      PMFS9999
.
PMFS0300  MATCH     SP70,PMFSURNO
          GOTO      PMFS9999 IF EQUAL
          WRITE     HTMLFILE;PMFSURNO;
          GOTO      PMFS9999
.
PMFS0400  WRITE     HTMLFILE;PMFSRTYP;
          GOTO      PMFS9999
.
PMFS0500  WRITE     HTMLFILE;PMFSLUMH;
          GOTO      PMFS9999
.
PMFS0600  WRITE     HTMLFILE;PMFSLUMF;
          GOTO      PMFS9999
.
PMFS0700  WRITE     HTMLFILE;PMFSDAFR;
          GOTO      PMFS9999
.
PMFS0800  WRITE     HTMLFILE;PMFSDAYT;
          GOTO      PMFS9999
.
PMFS0900  WRITE     HTMLFILE;PMFSDAYH;
          GOTO      PMFS9999
.
PMFS1000  WRITE     HTMLFILE;PMFSDAHF;
          GOTO      PMFS9999
.
PMFS1100  WRITE     HTMLFILE;PMFSTHIT;
          GOTO      PMFS9999
.
PMFS1200  WRITE     HTMLFILE;PMFSTHEH;
          GOTO      PMFS9999
.
PMFS1300  WRITE     HTMLFILE;PMFSTHEF;
          GOTO      PMFS9999
.
PMFS1400  MOVE      THREE,FORM1A
          MOVE      ONE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS1500  MOVE      THREE,FORM1A
          MOVE      TWO,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS1600  MOVE      THREE,FORM1A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS1700  MOVE      THREE,FORM1A
          MOVE      FOUR,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS1800  MOVE      THREE,FORM1A
          MOVE      FIVE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS1900  MOVE      THREE,FORM1A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS2000  MOVE      THREE,FORM1A
          MOVE      ONE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.         
PMFS2100  MOVE      THREE,FORM1A
          MOVE      TWO,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.         
PMFS2200  MOVE      THREE,FORM1A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.         
PMFS2300  MOVE      THREE,FORM1A
          MOVE      FOUR,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS2400  MOVE      THREE,FORM1A
          MOVE      FIVE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS2500  MOVE      THREE,FORM1A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS2600  MOVE      SIX,FORM1A
          MOVE      ONE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.         
PMFS2700  MOVE      SIX,FORM1A
          MOVE      TWO,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS2800  MOVE      SIX,FORM1A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS2900  MOVE      SIX,FORM1A
          MOVE      FOUR,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3000  MOVE      SIX,FORM1A
          MOVE      FIVE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3100  MOVE      SIX,FORM1A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3200  MOVE      SIX,FORM1A
          MOVE      ONE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3300  MOVE      SIX,FORM1A
          MOVE      TWO,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3400  MOVE      SIX,FORM1A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3500  MOVE      SIX,FORM1A
          MOVE      FOUR,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3600  MOVE      SIX,FORM1A
          MOVE      FIVE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3700  MOVE      SIX,FORM1A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTMC0000
          GOTO      PMFS9999
.
PMFS3800  MOVE      "1",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS3900  MOVE      "2",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4000  MOVE      "3",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4100  MOVE      "4",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4200  MOVE      "5",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4300  MOVE      "6",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4400  MOVE      "7",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4500  MOVE      "8",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4600  MOVE      "9",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4700  MOVE      "10",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS4800  MOVE      "11",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS4900  MOVE      "12",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS5000  MOVE      "13",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS5100  MOVE      "14",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS5200  MOVE      "15",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS5300  MOVE      "16",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS5400  MOVE      "17",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS5500  MOVE      "18",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS5600  MOVE      "19",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS5700  MOVE      "20",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS5800  MOVE      "21",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS5900  MOVE      "22",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS6000  MOVE      "23",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS6100  MOVE      "24",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.         
PMFS6200  MOVE      "25",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS6300  MOVE      "26",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS6400  MOVE      "27",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS6500  MOVE      "28",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS6600  MOVE      "29",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS6700  MOVE      "30",FORM2A
          MOVE      "1",FORM1A
          CALL      FBFE0000
          GOTO      PMFS9999
.
PMFS6800  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS6900  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7000  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7100  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7200  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7300  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7400  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7500  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7600  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7700  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7800  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS7900  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8000  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8100  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8200  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8300  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8400  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8500  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8600  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8700  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8800  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS8900  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9000  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9100  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9200  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9300  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9400  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9500  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9600  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9700  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
            CALL      IDES0000            * Check for SJOG  Item desc. tag
          ENDIF
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9800  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      THREE,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTFE0000
          GOTO      PMFS9999
.
PMFS9900  UNPACK    DIM127,D1,KEY3,DIM127
          MOVE      KEY3,FLDITMNO
          CALL      PMFT0000
          GOTO      PMFS9999
.
PMFS9999  RETURN
.
.------------------------------------------------------------
. Check for SJOG Item description tag
.------------------------------------------------------------
IDES0000  MOVE      SP70,DIM1A
          MATCH     "1",PTCNIFCL
          GOTO      IDES2000 IF EQUAL         * HEA IFC has one Misc.item
.
          MATCH     "2",PTCNIFCL
          GOTO      IDES9999 IF NOT EQUAL
.
IDES2000  UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          GOTO      IDES9999 IF NOT EQUAL
.
          UNPACK    DIM127,KEY1,D1,DIM127
          MATCH     "X",D1
          GOTO      IDES8000 IF EQUAL
          MATCH     "Y",D1
          GOTO      IDES9999 IF NOT EQUAL
.
IDES8000  MOVE      D1,DIM1A
          GOTO      IDES9999
IDES9999  RETURN
+
.------------------------------------------------------------
. PMSFESFD Fields
.------------------------------------------------------------
PMFT0000  REP       " 0",PTCNIFCL
.
.         Calculate Out of Pocket for Uninsured Fees Estimate, for SJOG & HEA,
.         Use Quote number instead of Admission no.
.
.         Consumables amount, FLDITMN=507 (HEA) - Fees Est. on Eligibility Check
.
          MATCH     "0",PTCNIFCL
          IF        !@EQUAL
            IF        FLDITMNO<452 | FLDITMNO=507
              MOVE      PMFDQUOT,QUOTEEST
              MATCH     "PATWEB76",PRGID
              IF        !@EQUAL
                PACK      ADMISSNO,ADMISSNO,SP70
                MATCH     SP70,ADMISSNO
                IF        !@EQUAL
                  CALL      GQTE0000        * Use Quote number to get Fees Est.
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          BRANCH    FLDITMNO,PMFT0010,PMFT0020,PMFT0030,PMFT0040,PMFT0050:
                             PMFT0060,PMFT0070,PMFT0080,PMFT0090,PMFT0100:
                             PMFT0110,PMFT0120,PMFT0130,PMFT0140,PMFT0150:
                             PMFT0160,PMFT0170,PMFT0180,PMFT0190,PMFT0200:
                             PMFT0210,PMFT0220,PMFT0230,PMFT0240,PMFT0250:
                             PMFT0260,PMFT0270,PMFT0280,PMFT0290,PMFT0300:
                             PMFT0310,PMFT0320,PMFT0330,PMFT0340,PMFT0350:
                             PMFT0360,PMFT0370,PMFT0380,PMFT0390,PMFT0400:
                             PMFT0410,PMFT0420,PMFT0430,PMFT0440,PMFT0450:
                             PMFT0460,PMFT0470,PMFT0480,PMFT0490,PMFT0500:
                             PMFT0510,PMFT0520,PMFT0530,PMFT0540,PMFT0550:
                             PMFT0560,PMFT0570,PMFT0580,PMFT0590,PMFT0600:
                             PMFT0610,PMFT0620,PMFT0630,PMFT0640,PMFT0650:
                             PMFT0660,PMFT0670,PMFT0680,PMFT0690,PMFT0700:
                             PMFT0710,PMFT0720,PMFT0730,PMFT0740,PMFT0750:
                             PMFT0760,PMFT0770,PMFT0780,PMFT0790,PMFT0800:
                             PMFT0810,PMFT0820,PMFT0830,PMFT0840,PMFT0850:
                             PMFT0860,PMFT0870,PMFT0880,PMFT0890,PMFT0900:
                             PMFT0910,PMFT0920,PMFT0930,PMFT0940,PMFT0950:
                             PMFT0960,PMFT0970,PMFT0980,PMFT0990,PMFT1000:
                             PMFT1010,PMFT1020,PMFT1030,PMFT1040,PMFT1050:
                             PMFT1060,PMFT1070,PMFT1080,PMFT1090,PMFT1100:
                             PMFT1110,PMFT1120,PMFT1130,PMFT1140,PMFT1150:
                             PMFT1160,PMFT1170,PMFT1180,PMFT1190,PMFT1200:
                             PMFT1210,PMFT1220,PMFT1230,PMFT1240,PMFT1250:
                             PMFT1260,PMFT1270,PMFT1280,PMFT1290,PMFT1300:
                             PMFT1310,PMFT1320,PMFT1330,PMFT1340,PMFT1350:
                             PMFT1360,PMFT1370,PMFT1380,PMFT1390,PMFT1400:
                             PMFT1410,PMFT1420,PMFT1430,PMFT1440,PMFT1450:
                             PMFT1460,PMFT1470,PMFT1480,PMFT1490,PMFT1500:
                             PMFT1510,PMFT1520,PMFT1530,PMFT1540,PMFT1550:
                             PMFT1560,PMFT1570,PMFT1580,PMFT1590,PMFT1600:
                             PMFT1610,PMFT1620,PMFT1630,PMFT1640,PMFT1650:
                             PMFT1660,PMFT1670,PMFT1680,PMFT1690,PMFT1700:
                             PMFT1710,PMFT1720,PMFT1730,PMFT1740,PMFT1750:
                             PMFT1760,PMFT1770,PMFT1780,PMFT1790,PMFT1800:
                             PMFT1810,PMFT1820,PMFT1830,PMFT1840,PMFT1850:
                             PMFT1860,PMFT1870,PMFT1880,PMFT1890,PMFT1900:
                             PMFT1910,PMFT1920,PMFT1930,PMFT1940,PMFT1950:
                             PMFT1960,PMFT1970,PMFT1980,PMFT1990,PMFT2000:
                             PMFT2010,PMFT2020,PMFT2030,PMFT2040,PMFT2050:
                             PMFT2060,PMFT2070,PMFT2080,PMFT2090,PMFT2100:
                             PMFT2110,PMFT2120,PMFT2130,PMFT2140,PMFT2150:
                             PMFT2160,PMFT2170,PMFT2180,PMFT2190,PMFT2200:
                             PMFT2210,PMFT2220,PMFT2230,PMFT2240,PMFT2250:
                             PMFT2260,PMFT2270,PMFT2280,PMFT2290,PMFT2300:
                             PMFT2310,PMFT2320,PMFT2330,PMFT2340,PMFT2350:
                             PMFT2360,PMFT2370,PMFT2380,PMFT2390,PMFT2400:
                             PMFT2410,PMFT2420,PMFT2430,PMFT2440,PMFT2450:
                             PMFT2460,PMFT2470,PMFT2480,PMFT2490,PMFT2500:
                             PMFT2510,PMFT2520,PMFT2530,PMFT2540,PMFT2550:
                             PMFT2560,PMFT2570,PMFT2580,PMFT2590,PMFT2600:
                             PMFT2610,PMFT2620,PMFT2630,PMFT2640,PMFT2650:
                             PMFT2660,PMFT2670,PMFT2680,PMFT2690,PMFT2700:
                             PMFT2710,PMFT2720,PMFT2730,PMFT2740,PMFT2750:
                             PMFT2760,PMFT2770,PMFT2780,PMFT2790,PMFT2800:
                             PMFT2810,PMFT2820,PMFT2830,PMFT2840,PMFT2850:
                             PMFT2860,PMFT2870,PMFT2880,PMFT2890,PMFT2900:
                             PMFT2910,PMFT2920,PMFT2930,PMFT2940,PMFT2950:
                             PMFT2960,PMFT2970,PMFT2980,PMFT2990,PMFT3000:
                             PMFT3010,PMFT3020,PMFT3030,PMFT3040,PMFT3050:
                             PMFT3060,PMFT3070,PMFT3080,PMFT3090,PMFT3100:
                             PMFT3110,PMFT3120,PMFT3130,PMFT3140,PMFT3150:
                             PMFT3160,PMFT3170,PMFT3180,PMFT3190,PMFT3200:
                             PMFT3210,PMFT3220,PMFT3230,PMFT3240,PMFT3250:
                             PMFT3260,PMFT3270,PMFT3280,PMFT3290,PMFT3300:
                             PMFT3310,PMFT3320,PMFT3330,PMFT3340,PMFT3350:
                             PMFT3360,PMFT3370,PMFT3380,PMFT3390,PMFT3400:
                             PMFT3410,PMFT3420,PMFT3430,PMFT3440,PMFT3450:
                             PMFT3460,PMFT3470,PMFT3480,PMFT3490,PMFT3500:
                             PMFT3510,PMFT3520,PMFT3530,PMFT3540,PMFT3550:
                             PMFT3560,PMFT3570,PMFT3580,PMFT3590,PMFT3600:
                             PMFT3610,PMFT3620,PMFT3630,PMFT3640,PMFT3650:
                             PMFT3660,PMFT3670,PMFT3680,PMFT3690,PMFT3700:
                             PMFT3710,PMFT3720,PMFT3730,PMFT3740,PMFT3750:
                             PMFT3760,PMFT3770,PMFT3780,PMFT3790,PMFT3800:
                             PMFT3810,PMFT3820,PMFT3830,PMFT3840,PMFT3850:
                             PMFT3860,PMFT3870,PMFT3880,PMFT3890,PMFT3900:
                             PMFT3910,PMFT3920,PMFT3930,PMFT3940,PMFT3950:
                             PMFT3960,PMFT3970,PMFT3980,PMFT3990,PMFT4000:
                             PMFT4010,PMFT4020,PMFT4030,PMFT4040,PMFT4050:
                             PMFT4060,PMFT4070,PMFT4080,PMFT4090,PMFT4100:
                             PMFT4110,PMFT4120,PMFT4130,PMFT4140,PMFT4150:
                             PMFT4160,PMFT4170,PMFT4180,PMFT4190,PMFT4200:
                             PMFT4210,PMFT4220,PMFT4230,PMFT4240,PMFT4250:
                             PMFT4260,PMFT4270,PMFT4280,PMFT4290,PMFT4300:
                             PMFT4310,PMFT4320,PMFT4330,PMFT4340,PMFT4350:
                             PMFT4360,PMFT4370,PMFT4380,PMFT4390,PMFT4400:
                             PMFT4410,PMFT4420,PMFT4430,PMFT4440,PMFT4450:
                             PMFT4460,PMFT4470,PMFT4480,PMFT4490,PMFT4500:  *450
                             PMFT4510,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *455
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *460
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *465
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *470
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *475
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *480
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *485
                             PMFT4560,PMFT4520,PMFT4530,PMFT4540,PMFT4550:  *490
                             PMFT4560,PMFT4920,PMFT4920,PMFT4920,PMFT4920:  *495
                             PMFT4920,PMFT4970,PMFT4970,PMFT4970,PMFT4970:  *500
                             PMFT4970,PMFT5020,PMFT5020,PMFT5020,PMFT5020:  *505
                             PMFT5020,PMFT5070,PMFT5080,PMFT5090,PMFT5100:  *510
                             PMFT5110,PMFT5120,PMFT5130,PMFT5130,PMFT5130:  *515
                             PMFT5130,PMFT5130,PMFT5130,PMFT5130,PMFT5130:  *520
                             PMFT5130,PMFT5130,PMFT5130,PMFT5130,PMFT5130:  *525
                             PMFT5130,PMFT5130,PMFT5130,PMFT5130,PMFT5130:  *530
                             PMFT5130,PMFT5130,PMFT5130,PMFT5130,PMFT5130:  *535
                             PMFT5130,PMFT5130,PMFT5130,PMFT5130,PMFT5130:  *540
                             PMFT5130,PMFT5130,PMFT5420,PMFT5420,PMFT5420:  *545
                             PMFT5420,PMFT5420,PMFT5420,PMFT5420,PMFT5420:  *550
                             PMFT5420,PMFT5420,PMFT5420,PMFT5420,PMFT5420:  *555
                             PMFT5420,PMFT5420,PMFT5420,PMFT5420,PMFT5420:  *560
                             PMFT5420,PMFT5420,PMFT5420,PMFT5420,PMFT5420:  *565
                             PMFT5420,PMFT5420,PMFT5420,PMFT5420,PMFT5420:  *570
                             PMFT5420,PMFT5420,PMFT5730
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMFT9999
.
PMFT0010  MOVE      "1",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0020  MOVE      "2",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0030  MOVE      "3",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0040  MOVE      "4",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0050  MOVE      "5",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0060  MOVE      "6",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0070  MOVE      "7",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0080  MOVE      "8",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0090  MOVE      "9",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0100  MOVE      "10",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0110  MOVE      "11",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0120  MOVE      "12",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0130  MOVE      "13",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0140  MOVE      "14",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0150  MOVE      "15",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0160  MOVE      "16",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0170  MOVE      "17",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0180  MOVE      "18",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0190  MOVE      "19",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0200  MOVE      "20",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0210  MOVE      "21",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0220  MOVE      "22",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0230  MOVE      "23",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0240  MOVE      "24",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0250  MOVE      "25",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0260  MOVE      "26",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0270  MOVE      "27",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0280  MOVE      "28",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0290  MOVE      "29",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0300  MOVE      "30",FORM2A
          MOVE      ONE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT0310  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0320  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0330  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0340  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0350  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0360  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0370  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0380  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0390  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0400  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0410  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0420  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0430  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0440  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0450  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0460  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0470  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0480  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0490  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0500  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0510  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0520  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0530  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0540  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0550  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0560  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0570  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0580  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0590  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      IDES0000            * Check for SJOG  Item desc. tag
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0600  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
            CALL      IDES0000            * Check for SJOG  Item desc. tag
          ENDIF
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0610  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      SIX,FORM1B
          MOVE      ONE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT0620  MOVE      "1",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.         
PMFT0630  MOVE      "2",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0640  MOVE      "3",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0650  MOVE      "4",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0660  MOVE      "5",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0670  MOVE      "6",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0680  MOVE      "7",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0690  MOVE      "8",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0700  MOVE      "9",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0710  MOVE      "10",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0720  MOVE      "11",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0730  MOVE      "12",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0740  MOVE      "13",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0750  MOVE      "14",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0760  MOVE      "15",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0770  MOVE      "16",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0780  MOVE      "17",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0790  MOVE      "18",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0800  MOVE      "19",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0810  MOVE      "20",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0820  MOVE      "21",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0830  MOVE      "22",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0840  MOVE      "23",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0850  MOVE      "24",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0860  MOVE      "25",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0870  MOVE      "26",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0880  MOVE      "27",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0890  MOVE      "28",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0900  MOVE      "29",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0910  MOVE      "30",FORM2A
          MOVE      "2",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0920  MOVE      "1",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0930  MOVE      "2",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0940  MOVE      "3",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0950  MOVE      "4",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0960  MOVE      "5",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0970  MOVE      "6",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0980  MOVE      "7",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT0990  MOVE      "8",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1000  MOVE      "9",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1010  MOVE      "10",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1020  MOVE      "11",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1030  MOVE      "12",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1040  MOVE      "13",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1050  MOVE      "14",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1060  MOVE      "15",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1070  MOVE      "16",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1080  MOVE      "17",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1090  MOVE      "18",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1100  MOVE      "19",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1110  MOVE      "20",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1120  MOVE      "21",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1130  MOVE      "22",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1140  MOVE      "23",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1150  MOVE      "24",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1160  MOVE      "25",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1170  MOVE      "26",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1180  MOVE      "27",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1190  MOVE      "28",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1200  MOVE      "29",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1210  MOVE      "30",FORM2A
          MOVE      "3",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1220  MOVE      "1",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.         
PMFT1230  MOVE      "2",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1240  MOVE      "3",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1250  MOVE      "4",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1260  MOVE      "5",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1270  MOVE      "6",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1280  MOVE      "7",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1290  MOVE      "8",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1300  MOVE      "9",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1310  MOVE      "10",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1320  MOVE      "11",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1330  MOVE      "12",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1340  MOVE      "13",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1350  MOVE      "14",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1360  MOVE      "15",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1370  MOVE      "16",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1380  MOVE      "17",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1390  MOVE      "18",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1400  MOVE      "19",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1410  MOVE      "20",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1420  MOVE      "21",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1430  MOVE      "22",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1440  MOVE      "23",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1450  MOVE      "24",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1460  MOVE      "25",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1470  MOVE      "26",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1480  MOVE      "27",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1490  MOVE      "28",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1500  MOVE      "29",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1510  MOVE      "30",FORM2A
          MOVE      "4",FORM1A
          CALL      FBFE0000
          GOTO      PMFT9999
.
PMFT1520  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1530  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1540  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1550  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1560  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1570  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1580  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1590  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1600  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1610  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1620  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1630  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1640  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1650  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1660  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1670  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1680  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1690  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1700  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1710  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1720  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1730  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1740  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1750  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1760  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1770  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1780  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1790  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1800  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1810  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
          ENDIF
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1820  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      THREE,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1830  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1840  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1850  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1860  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1870  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1880  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1890  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1900  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1910  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1920  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1930  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1940  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1950  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1960  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1970  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1980  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT1990  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2000  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2010  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2020  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2030  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2040  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2050  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2060  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2070  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2080  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2090  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2100  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2110  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2120  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
          ENDIF
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2130  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      THREE,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2140  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2150  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2160  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2170  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2180  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2190  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2200  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2210  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2220  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2230  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2240  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2250  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2260  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2270  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2280  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2290  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2300  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2310  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2320  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2330  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2340  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2350  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2360  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2370  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2380  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2390  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2400  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2410  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2420  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2430  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
          ENDIF
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2440  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      THREE,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT2450  MOVE      "1",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000 
          GOTO      PMFT9999 
.                            
PMFT2460  MOVE      "2",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000 
          GOTO      PMFT9999 
.
PMFT2470  MOVE      "3",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2480  MOVE      "4",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2490  MOVE      "5",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2500  MOVE      "6",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2510  MOVE      "7",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2520  MOVE      "8",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2530  MOVE      "9",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2540  MOVE      "10",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2550  MOVE      "11",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2560  MOVE      "12",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2570  MOVE      "13",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2580  MOVE      "14",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2590  MOVE      "15",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2600  MOVE      "16",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2610  MOVE      "17",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2620  MOVE      "18",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2630  MOVE      "19",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2640  MOVE      "20",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2650  MOVE      "21",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2660  MOVE      "22",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2670  MOVE      "23",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2680  MOVE      "24",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2690  MOVE      "25",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2700  MOVE      "26",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2710  MOVE      "27",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2720  MOVE      "28",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2730  MOVE      "29",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2740  MOVE      "30",FORM2A
          MOVE      TWO,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2750  MOVE      "1",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000 
          GOTO      PMFT9999
.                           
PMFT2760  MOVE      "2",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000 
          GOTO      PMFT9999
.
PMFT2770  MOVE      "3",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2780  MOVE      "4",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2790  MOVE      "5",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2800  MOVE      "6",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2810  MOVE      "7",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2820  MOVE      "8",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2830  MOVE      "9",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2840  MOVE      "10",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2850  MOVE      "11",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2860  MOVE      "12",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2870  MOVE      "13",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2880  MOVE      "14",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2890  MOVE      "15",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2900  MOVE      "16",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2910  MOVE      "17",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2920  MOVE      "18",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2930  MOVE      "19",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2940  MOVE      "20",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2950  MOVE      "21",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2960  MOVE      "22",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2970  MOVE      "23",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2980  MOVE      "24",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT2990  MOVE      "25",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3000  MOVE      "26",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3010  MOVE      "27",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3020  MOVE      "28",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3030  MOVE      "29",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3040  MOVE      "30",FORM2A
          MOVE      THREE,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3050  MOVE      "1",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000 
          GOTO      PMFT9999
.                           
PMFT3060  MOVE      "2",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000 
          GOTO      PMFT9999
.
PMFT3070  MOVE      "3",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3080  MOVE      "4",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3090  MOVE      "5",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3100  MOVE      "6",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3110  MOVE      "7",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3120  MOVE      "8",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3130  MOVE      "9",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3140  MOVE      "10",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3150  MOVE      "11",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3160  MOVE      "12",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3170  MOVE      "13",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3180  MOVE      "14",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3190  MOVE      "15",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3200  MOVE      "16",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3210  MOVE      "17",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3220  MOVE      "18",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3230  MOVE      "19",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3240  MOVE      "20",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3250  MOVE      "21",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3260  MOVE      "22",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3270  MOVE      "23",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3280  MOVE      "24",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3290  MOVE      "25",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3300  MOVE      "26",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3310  MOVE      "27",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3320  MOVE      "28",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3330  MOVE      "29",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3340  MOVE      "30",FORM2A
          MOVE      FOUR,FORM1A
          CALL      FOFE0000
          GOTO      PMFT9999
.
PMFT3350  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3360  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3370  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3380  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3390  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3400  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3410  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3420  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3430  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3440  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3450  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3460  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3470  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3480  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3490  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3500  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3510  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3520  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3530  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3540  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3550  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3560  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3570  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3580  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3590  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3600  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3610  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3620  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3630  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3640  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F1<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
          ENDIF
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3650  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      SIX,FORM1B
          MOVE      TWO,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3660  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3670  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3680  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3690  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3700  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3710  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3720  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3730  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3740  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3750  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3760  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3770  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3780  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3790  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3800  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3810  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3820  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3830  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3840  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3850  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3860  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3870  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3880  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3890  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3900  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3910  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3920  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3930  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3940  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3950  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
          ENDIF
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3960  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      SIX,FORM1B
          MOVE      THREE,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3970  MOVE      ZERO,FORM1A
          MOVE      "1",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3980  MOVE      ZERO,FORM1A
          MOVE      "2",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT3990  MOVE      ZERO,FORM1A
          MOVE      "3",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4000  MOVE      ZERO,FORM1A
          MOVE      "4",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4010  MOVE      ZERO,FORM1A
          MOVE      "5",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4020  MOVE      ZERO,FORM1A
          MOVE      "6",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4030  MOVE      ZERO,FORM1A
          MOVE      "7",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4040  MOVE      ZERO,FORM1A
          MOVE      "8",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4050  MOVE      ZERO,FORM1A
          MOVE      "9",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4060  MOVE      ZERO,FORM1A
          MOVE      "10",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4070  MOVE      ZERO,FORM1A
          MOVE      "11",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4080  MOVE      ZERO,FORM1A
          MOVE      "12",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4090  MOVE      ZERO,FORM1A
          MOVE      "13",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4100  MOVE      ZERO,FORM1A
          MOVE      "14",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4110  MOVE      ZERO,FORM1A
          MOVE      "15",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4120  MOVE      ZERO,FORM1A
          MOVE      "16",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4130  MOVE      ZERO,FORM1A
          MOVE      "17",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4140  MOVE      ZERO,FORM1A
          MOVE      "18",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4150  MOVE      ZERO,FORM1A
          MOVE      "19",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4160  MOVE      ZERO,FORM1A
          MOVE      "20",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4170  MOVE      ZERO,FORM1A
          MOVE      "21",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4180  MOVE      ZERO,FORM1A
          MOVE      "22",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4190  MOVE      ZERO,FORM1A
          MOVE      "23",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4200  MOVE      ZERO,FORM1A
          MOVE      "24",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4210  MOVE      ZERO,FORM1A
          MOVE      "25",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4220  MOVE      ZERO,FORM1A
          MOVE      "26",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4230  MOVE      ZERO,FORM1A
          MOVE      "27",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4240  MOVE      ZERO,FORM1A
          MOVE      "28",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4250  MOVE      ZERO,FORM1A
          MOVE      "29",FORM2A
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4260  MOVE      ZERO,FORM1A
          MOVE      "30",FORM2A
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                ADD      F2,FORM2A
              ENDIF
            ENDIF
          ENDIF
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4270  MOVE      ONE,FORM1A
          MOVE      "30",FORM2A
          MOVE      ZERO,THTOTAL
          MOVE      ZERO,THFUND
          MOVE      SIX,FORM1B
          MOVE      FOUR,FORM1C
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT4280  MOVE      "1",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4290  MOVE      "2",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4300  MOVE      "3",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4310  MOVE      "4",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4320  MOVE      "5",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4330  MOVE      "6",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4340  MOVE      "7",FORM2A
          MOVE      "1",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4350  MOVE      "1",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4360  MOVE      "2",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4370  MOVE      "3",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4380  MOVE      "4",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4390  MOVE      "5",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4400  MOVE      "6",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4410  MOVE      "7",FORM2A
          MOVE      "4",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4420  MOVE      "1",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4430  MOVE      "2",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4440  MOVE      "3",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4450  MOVE      "4",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4460  MOVE      "5",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4470  MOVE      "6",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4480  MOVE      "7",FORM2A
          MOVE      "5",FORM1A
          CALL      BFBR0000 
          GOTO      PMFT9999 
.
PMFT4490  CALL      GTGST000
          WRITE     HTMLFILE;ITGSTTOT;             * total GST (Item+Accom.)
          GOTO      PMFT9999
.
PMFT4500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,FORM1A
          UNPACK    DIM127,D1,KEY2,DIM127
          MOVE      KEY2,FORM2B
          UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,FORM1C
          CALL      FTMX0000  
          GOTO      PMFT9999
.
PMFT4510  CALL      OTFE0000            * Other fees
          GOTO      PMFT9999
.
PMFT4520  MOVE      FLDITMNO,F3
          SUB       "451",F3
          DIV       "5",F3
          ADD       ONE,F3
          MOVE      F3,FORM2A           * row number
          MOVE      "1",FORM1A          * column no 1
          CALL      HCHR0000 
          GOTO      PMFT9999
.
PMFT4530  MOVE      FLDITMNO,F3
          SUB       "452",F3
          DIV       "5",F3
          ADD       ONE,F3
          MOVE      F3,FORM2A           * row number
          MOVE      "2",FORM1A          * column no 2
          CALL      HCHR0000 
          GOTO      PMFT9999
.
PMFT4540  MOVE      FLDITMNO,F3
          SUB       "453",F3
          DIV       "5",F3
          ADD       ONE,F3
          MOVE      F3,FORM2A           * row number
          MOVE      "3",FORM1A          * column no 3
          CALL      HCHR0000 
          GOTO      PMFT9999
.
PMFT4550  MOVE      FLDITMNO,F3
          SUB       "454",F3
          DIV       "5",F3
          ADD       ONE,F3
          MOVE      F3,FORM2A           * row number
          MOVE      "4",FORM1A          * column no 4
          CALL      HCHR0000 
          GOTO      PMFT9999
.
PMFT4560  MOVE      FLDITMNO,F3
          SUB       "455",F3
          DIV       "5",F3
          ADD       ONE,F3
          MOVE      F3,FORM2A           * row number
          MOVE      "5",FORM1A          * column no 5
          CALL      HCHR0000 
          GOTO      PMFT9999
.
PMFT4920  MOVE      "5",KEY1            * Theatre/Procedure
          MOVE      FLDITMNO,F3
          SUB       "491",F3
          MOVE      F3,FORM1A           * colum no 
          CALL      HTHE0000            
          GOTO      PMFT9999
.
PMFT4970  MOVE      "6",KEY1            * Other(pharmacy/consumables)
          MOVE      FLDITMNO,F3
          SUB       "496",F3
          MOVE      F3,FORM1A           * colum no 
          CALL      HTHE0000            
          GOTO      PMFT9999
.
PMFT5020  MOVE      "7",KEY1            * Prosthesis/gap
          MOVE      FLDITMNO,F3
          SUB       "501",F3
          MOVE      F3,FORM1A           * colum no 
          CALL      HTHE0000            
          GOTO      PMFT9999
.
PMFT5070  CALL      CONF0000            * Consumables
          GOTO      PMFT9999
.
PMFT5080  MOVE      SBTYPEPA,FORM12P2
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      FORM12P2,KEY15
          ELSE
            CALL      RNDD0000                 * Rounding to nearest dollar
          ENDIF
          WRITE     HTMLFILE;KEY15;
          GOTO      PMFT9999
.
PMFT5090  MOVE      SBTYPEHF,FORM12P2
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      FORM12P2,KEY15
          ELSE
            CALL      RNDD0000                 * Rounding to nearest dollar
          ENDIF
          WRITE     HTMLFILE;KEY15;
          GOTO      PMFT9999
.
PMFT5100  MOVE      PRIFEEPA,FORM12P2
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      FORM12P2,KEY15
          ELSE
            CALL      RNDD0000                 * Rounding to nearest dollar
          ENDIF
          WRITE     HTMLFILE;KEY15;
          GOTO      PMFT9999
.
PMFT5110  MOVE      PRIFEEHF,FORM12P2
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      FORM12P2,KEY15
          ELSE
            CALL      RNDD0000                 * Rounding to nearest dollar
          ENDIF
          WRITE     HTMLFILE;KEY15;
          GOTO      PMFT9999
.
.         Discount (HEA Fees Estimate)
.
PMFT5120  CALL      DISC0000            * Discount
          GOTO      PMFT9999
.
.         Printing quantity of 50 Theatre items
.
PMFT5130  MOVE      ZERO,FORM1A
          MOVE      FLDITMNO,F3
          SUB       "512",F3
          COMPARE   ZERO,F3
          GOTO      PMFT9999 IF LESS
          COMPARE   "30",F3
          GOTO      PMFT5132 IF NOT LESS
.
.         Get quantity for the first 29 items
.
          MOVE      F3,FORM2A
          MOVE      THREE,FORM1B        * Theatre fee
.
          MOVE      FIVE,FORM1C         * quantity
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT5132  COMPARE   "30",F3
          GOTO      PMFT9999 IF NOT EQUAL
.
.         Get quantity for item 31 to 50
.
.
          PACK      DIM127,DIM127,SP70
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
.
          MATCH     SP70,KEY1
          IF        @EQUAL
            MOVE      "30",FORM2A
            MOVE      THREE,FORM1B
            MOVE      FIVE,FORM1C         * quantity
            CALL      FTFE0000
            GOTO      PMFT9999
          ENDIF
.
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                MOVE      "30",FORM2A
                ADD       F2,FORM2A
                MOVE      THREE,FORM1B
                MOVE      FIVE,FORM1C         * quantity
                CALL      FTFE0000
              ENDIF
            ENDIF
          ENDIF
          GOTO      PMFT9999
.
.         Printing quantity of 50 Misc. items
.
PMFT5420  MOVE      ZERO,FORM1A
          MOVE      FLDITMNO,F3
          SUB       "542",F3
          COMPARE   ZERO,F3
          GOTO      PMFT9999 IF LESS
          COMPARE   "30",F3
          GOTO      PMFT5422 IF NOT LESS
.
.         Get quantity for the first 29 items
.
          MOVE      F3,FORM2A
          MOVE      SIX,FORM1B          * Misc.item
          MOVE      FIVE,FORM1C         * quantity
          CALL      FTFE0000
          GOTO      PMFT9999
.
PMFT5422  COMPARE   "30",F3
          GOTO      PMFT9999 IF NOT EQUAL
.
.         Get quantity for item 31 to 50
.
.
          PACK      DIM127,DIM127,SP70
          UNPACK    SP70,D2,KEY1
          UNPACK    DIM127,KEY1
.
          MATCH     SP70,KEY1
          IF        @EQUAL
            MOVE      "30",FORM2A
            MOVE      SIX,FORM1B          * Misc.item
            MOVE      FIVE,FORM1C         * quantity
            CALL      FTFE0000
            GOTO      PMFT9999
          ENDIF
.
          MATCH     ".",KEY1
          IF        @EQUAL
            UNPACK    DIM127,KEY1,D2,DIM127
            MATCH     SP1,D2
            IF        !@EQUAL
              MOVE      ZERO,F2
              MOVE      D2,F2
              IF        F2<>0
                MOVE      "30",FORM2A
                ADD       F2,FORM2A
                MOVE      SIX,FORM1B          * Misc.item
                MOVE      FIVE,FORM1C         * quantity
                CALL      FTFE0000
              ENDIF
            ENDIF
          ENDIF
.
          GOTO      PMFT9999
.
PMFT5730  CALL      GTGST000
.
          UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,FORM1A
          MOVE      KEY1,FORM1A
          IF        FORM1A=0
            WRITE     HTMLFILE;ITGSTTOT;       * Total Item GST
          ENDIF
          IF        FORM1A=1
            WRITE     HTMLFILE;ACGSTTOT;       * Total Accommodation GST
          ENDIF
.
          IF        FORM1A=2
            WRITE     HTMLFILE;ITPATGST;       * GST for Item Patient Portion
          ENDIF
          IF        FORM1A=3
            WRITE     HTMLFILE;ITFNDGST;       * GST for Item Rebate Portion
          ENDIF
          IF        FORM1A=4
            WRITE     HTMLFILE;ACPATGST;       * GST for Acc. Patient Portion
          ENDIF
          IF        FORM1A=5
            WRITE     HTMLFILE;ACFNDGST;       * GST for Acc. Rebate Portion
          ENDIF
.
          GOTO      PMFT9999
.
PMFT9999  MATCH     "0",PTCNIFCL
          IF        !@EQUAL
            IF        FLDITMNO<452 | FLDITMNO=507
              MOVE      QUOTEEST,PMFDQUOT   * restore Quote number
              PACK      KEY12,PMFDQUOT,SP70
              CALL      RDPMFED1
              IF        OVRCD=0
                MATCH     "1",PTCNIFCL      * HEA
                IF        @EQUAL
                  MOVE      PMFDUBAS,USEBASIC
                  REP       " 0",USEBASIC
                ENDIF
              ENDIF
            ENDIF
          ENDIF
          RETURN
+
.------------------------------------------------------------
.         Accommodation charge for Healthscope & SJOG layout
.         record type = 1 or 2
.         FORM1A - Column no 
.         FORM2A - Row no
.------------------------------------------------------------
HCHR0000  MOVE      ZERO,SELFINSR           * Uninsured flag
.
          MATCH     "1",PTCNIFCL
          GOTO      HCHR0100 IF EQUAL
.
          MATCH     "2",PTCNIFCL
          GOTO      HCHR0200 IF NOT EQUAL
.
.         Use Quote number for printing IFC from Fees Estimate
.
HCHR0100  PACK      KEY5,ANSC,ANSL,PMFDCLTY
          CALL      RDCODE1
          IF        OVRCD=0
            MATCH     "3",TCINDC5
            IF        @EQUAL
              MOVE      ONE,SELFINSR        * Uninsured
            ENDIF
          ENDIF
.
.         MATCH     "2",PTCNIFCL
.         GOTO      HCHR0200 IF NOT EQUAL
.
          MATCH     "PATWEB76",PRGID
          GOTO      HCHR0200 IF NOT EQUAL
.
          PACK      KEY12,PMFDQUOT,SP70
          GOTO      HCHR0400
.
HCHR0200  PACK      KEY12,SP4,ADMISSNO,SP70
          REP       " 9",KEY12
.
HCHR0400  MOVE      ZERO,FORM2
          CALL      SRTP0000              * Set up record type, return KEY1
          BRANCH    EXIT,HCHR9000
.
          PACK      KEY18,KEY12,KEY1,SP70
          CALL      RSPMFES2
HCHR1000  CALL      RKPMFES2
          BRANCH    OVRCD,HCHR9000
.
          MATCH     KEY12,PMFSQUOT          * Check admission number
          GOTO      HCHR9000 IF NOT EQUAL
.
          COMPARE   FIVE,PMFSRTYP
          GOTO      HCHR9000 IF NOT LESS
.
          CALL      BTEX00000               * Get Bed type
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            IF        PMFSRTYP=2
              MOVE      PMFSDAYH,PRIFEEPA   * save private bed fees
              MOVE      PMFSDAHF,PRIFEEHF
            ENDIF
          ENDIF
.
          MATCH     "1",PTCNIFCL
          IF        @EQUAL
            MATCH     "1",KEY1  
            IF        @EQUAL
              IF        PMFSRTYP=2
                MOVE      PMFSDAYH,PRIFEEPA   * save private bed fees
                MOVE      PMFSDAHF,PRIFEEHF
              ENDIF
            ENDIF
          ENDIF
.         FORM2A(Row) 1,2 and 3, are Sameday rate,Shared and Private 
.         for Daycase and Overnight patient
.         PMFSRTYP=0 for Sameday rate, PMFSRTYP=1 for Share room,
.         PMFSRTYP=2 for Private
.
.
.         Healthscope/SJOG
.
HCHR1400  IF        FORM2A=1 | FORM2A=2 | FORM2A=3
            COMPARE   ZERO,PMFSRTYP
            GOTO      HCHR2000 IF EQUAL
            BRANCH    PMFSRTYP,HCHR2000,HCHR2000
          ENDIF
          COMPARE   ZERO,PMFSQUAN
          GOTO      HCHR9000 IF EQUAL      * Daycase only print row for Sameday
.
HCHR1600  ADD       ONE,FORM2              * line number for other bed type
          MOVE      FORM2A,F2              * Row
          SUB       THREE,F2
.
          COMPARE   FORM2,F2
          GOTO      HCHR1000 IF NOT EQUAL
.
.         All other bed types
.
          ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
          IF        FORM1A=1
            MOVE      "BT",KEY2
            PACK      KEY5,KEY2,PMFSBTYP
            CALL      RDCODE1
            IF        OVRCD=0
              WRITE     HTMLFILE;PTCDLDES;               * CAR 314005
            ENDIF
          ENDIF
          IF        FORM1A=2
            MOVE      PMFSDAYH,FORM12P2
            MATCH     "2",PTCNIFCL
            IF        @EQUAL
              MOVE      FORM12P2,KEY15
            ELSE
              CALL      RNDD0000                 * Rounding to nearest dollar
            ENDIF
            WRITE     HTMLFILE;KEY15;
          ENDIF
.
          COMPARE   THREE,FORM1A
          GOTO      HCHR1900 IF NOT EQUAL
.
          CALL      CFBT0000             * Check Fund Rebate bed type for SJOG
          BRANCH    EXIT,HCHR9999
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      SP70,KEY15
            BRANCH    SELFINSR,HCHR1800        * self insured
            MOVE      PMFSDAHF,FORM12P2        * fund rebate
            MOVE      FORM12P2,KEY15
            GOTO      HCHR1800
          ENDIF
          CALL      RNDD0000                 * Rounding to nearest dollar
.
HCHR1800  WRITE     HTMLFILE;KEY15;
          MOVE      PMFSDAYH,SBTYPEPA        * selected bed type
          MOVE      PMFSDAHF,SBTYPEHF
.
HCHR1900  COMPARE   FOUR,FORM1A
          GOTO      HCHR9999 IF NOT EQUAL
.
          CALL      CFBT0000             * Check Fund Rebate bed type for SJOG
          BRANCH    EXIT,HCHR9999
.
          MOVE      FUNDGAP,FORM12P2
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            IF        SELFINSR=1
              MOVE      PMFSDAYH,FORM12P2    * hospital charge
            ENDIF
            MOVE      FORM12P2,KEY15
            GOTO      HCHR1920
          ENDIF
.
          CALL      RNDD0000                 * Rounding to nearest dollar
HCHR1920  WRITE     HTMLFILE;KEY15;
          GOTO      HCHR9999
.
.         Share or Private bed type
.
HCHR2000  ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
.
.         PMFSRTYP=0 DC rate for overnight patient,
.         PMFSRTYP=1 Share overnight rate or Daycase patient,
.         PMFSRTYP=2 Private rate for overnight patient
.
. IFC HEA-For Daycase & Overnight, for CP row 1 - print Same Day(Sameday Shared)
.                                                 for overnight patient only
.                                         row 2 - print Share
.                                         row 3 - print Private
.
.   SJOG- For Daycase              row 1 - print Daycase rate
.   SJOG- For Overnight, row 1 - blank (only print heading 'Same Day')
.                                  row 2 - print Share
.                                  row 3 - print Private
.
          COMPARE   ONE,FORM1A
          GOTO      HCHR4000 IF NOT EQUAL
.
.         Column 1
.
          IF        FORM2A=1
            WRITE     HTMLFILE;"Same Day";
          ELSE
            IF        FORM2A=2
              WRITE     HTMLFILE;"Shared Room";
            ELSE
              WRITE     HTMLFILE;"Private Room";
            ENDIF
          ENDIF
          GOTO      HCHR9999
.
.         Column(FORM1A)=2
.
HCHR4000  MATCH     "2",PTCNIFCL
          GOTO      HCHR4100 IF NOT EQUAL
.
.         SJOG - Daycase only print record type Private on row 1
.
          IF        PMFSQUAN=0
            COMPARE   ONE,FORM2A
            GOTO      HCHR9000 IF NOT EQUAL
            COMPARE   TWO,PMFSRTYP
            GOTO      HCHR9000 IF NOT EQUAL
            GOTO      HCHR5000
          ENDIF
          GOTO      HCHR4200
.
.         Daycase only prints Record type=1 (shared) on row 1
.
HCHR4100  IF        PMFSQUAN=0
            COMPARE   ONE,FORM2A
            GOTO      HCHR9000 IF NOT EQUAL
...         COMPARE   ONE,PMFSRTYP
....        GOTO      HCHR9000 IF NOT EQUAL
            GOTO      HCHR5000
          ENDIF
.
HCHR4200  MOVE      FORM2A,F2          * row
          SUB       ONE,F2
.
          COMPARE   F2,PMFSRTYP
          GOTO      HCHR1000 IF NOT EQUAL
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MATCH     "PATWEB78",PRGID
            IF        @EQUAL
              IF        FORM1A=3 | FORM1A=4
                CALL      CFBT0000       * Check Fund Rebate bed type for SJOG
                BRANCH    EXIT,HCHR9999
                MOVE      PMFSDAYH,SBTYPEPA        * selected bed type
                MOVE      PMFSDAHF,SBTYPEHF
              ENDIF
            ENDIF
          ENDIF
.
HCHR5000  IF        FORM1A=2
            MOVE      PMFSDAYH,FORM12P2
            MATCH     "2",PTCNIFCL
            IF        @EQUAL
              MOVE      FORM12P2,KEY15
            ELSE
              CALL      RNDD0000                 * Rounding to nearest dollar
            ENDIF
            WRITE     HTMLFILE;KEY15;
          ENDIF
.
.         SJOG only print Private bed for column 3,4 and 5
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            IF        PMFSRTYP<>2
.             MATCH     SP70,PMFDCMCD
.             GOTO      HCHR9999 IF NOT EQUAL   * Casepayment
              GOTO      HCHR9999
            ENDIF
          ENDIF
.
.         Column =3
.
          IF        FORM1A=3
            MATCH     "2",PTCNIFCL
            IF        @EQUAL
              BRANCH    SELFINSR,HCHR9999       * self insured
              MOVE      PMFSDAHF,FORM12P2
              MOVE      FORM12P2,KEY15
            ELSE
              MOVE      PMFSDAHF,FORM12P2
              CALL      RNDD0000               * Rounding to nearest dollar
            ENDIF
            WRITE     HTMLFILE;KEY15;
          ENDIF
.
.         Column =4
.
          IF        FORM1A=4
            MOVE      FUNDGAP,FORM12P2
            MATCH     "2",PTCNIFCL
            IF        @EQUAL
              IF        SELFINSR=1
                MOVE      PMFSDAYH,FORM12P2   * total accommodation fee
              ENDIF
              MOVE      FORM12P2,KEY15
              CALL      RNDD0000                * Rounding to nearest dollar
            ELSE
              CALL      RNDD0000              * Rounding to nearest dollar
            ENDIF
            WRITE     HTMLFILE;KEY15;
          ENDIF
.
.         Column 5 - Maximum
.
.         Private Room - Print Co-payment x LOS
.
          COMPARE   FIVE,FORM1A
          GOTO      HCHR9999 IF NOT EQUAL
.
. 12 lines below new for task 0892480
          MATCH     "1",PTCNIFCL
          IF        @EQUAL
            MATCH     "PATWEB78",PRGID
            IF        @EQUAL
              IF        FORM2A=1
                IF        PMFSQUAN=0
                  WRITE     HTMLFILE;FUNDGAP;
                  GOTO      HCHR9999
                ENDIF
              ENDIF
              IF        FORM2A<>1
                CALL      CFBT0000       * Check Fund Rebate bed type for HEA
                BRANCH    EXIT,HCHR9999
                IF        PMFSQUAN<>0
                  MOVE      PMFSQUAN,FORM3
                  GOTO      HCHR6000
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            IF        PMFSQUAN=0
              MOVE      FUNDGAP,FORM12P2
              IF        SELFINSR=1
                MOVE      PMFSDAYH,FORM12P2
              ENDIF
              MOVE      FORM12P2,KEY15
              WRITE     HTMLFILE;KEY15;
            ELSE
              MOVE      PMFSQUAN,FORM3
              GOTO      HCHR6000
            ENDIF
            CALL      VDVA0000                    * Check for DVA Patient
            COMPARE   ONE,EXIT
            GOTO      HCHR9999 IF NOT EQUAL
.
            IF        PMFSQUAN<>0 & FORM2A=3
              MOVE      PMFSQUAN,FORM3
              GOTO      HCHR6000
            ENDIF
          ENDIF
.
          GOTO      HCHR9999
.
HCHR6000  MOVE      FUNDGAP,FORM5P2         * Co-payment private
          IF        SELFINSR=1
            MOVE      PMFSDAYH,FORM5P2
          ENDIF
.
.         Rounding the Patient cost before multiplied by LOS (as per js)
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      FORM5P2,FORM12P2
            MOVE      FORM12P2,KEY15
            CALL      RNDD0000                * Rounding to nearest dollar
            MOVE      FORM12P2,FORM5P2
          ENDIF
.
.
          MULT      FORM3,FORM5P2
          MOVE      FORM5P2,FORM12P2
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MOVE      FORM12P2,KEY15
.           CALL      RNDD0000                * Rounding to nearest dollar
          ELSE
            CALL      RNDD0000                * Rounding to nearest dollar
          ENDIF
          WRITE     HTMLFILE;KEY15;
          GOTO      HCHR9999
.
HCHR9000  WRITE     HTMLFILE;SP70;
          MOVE      ONE,EXIT
HCHR9999  RETURN
+
.******************************************************************************
.         Rounding to nearest dollar
.******************************************************************************
RNDD0000  COMPARE   ZERO,FORM12P2
          GOTO      RNDD9000 IF EQUAL
.
          UNPACK    SP70,KEY13,KEY2
          MOVE      ZERO,FORM12
          MOVE      ZERO,FORM2
.
          MOVE      FORM12P2,KEY15
          UNPACK    KEY15,KEY12,ANS,KEY2
          MOVE      KEY12,FORM12
          MOVE      KEY2,FORM2
.
          COMPARE   ZERO,FORM2
          GOTO      RNDD9000 IF EQUAL         * No cents
.
          IF        FORM2<50
            MOVE      ZERO,FORM2
          ELSE
            MOVE      ONE,FORM2
          ENDIF
          ADD       FORM2,FORM12              * Add to dollar figure
          MOVE      FORM12,FORM12P2
.
RNDD9000  IF        FORM12P2 = 0
            MOVE      "0.00",KEY15
            RJUSTIFY  KEY15
            GOTO      RNDD9999
          ENDIF
          MOVE      FORM12P2,KEY15
RNDD9999  RETURN
+
.******************************************************************************
.         SJOG - Bed type of Expected Ward/bed for IFC Eligibility Check
.                Use the keyin bed types for IFC Fees estimate
.                Default to Private if blank
.         HEA  - Preferred accommodation (Cat BP)for IFC Eligibility Check
.                Default to Shared if blank
.******************************************************************************
BTEX0000  MOVE      SP70,FNDBTYPE
.
          MATCH     "1",PTCNIFCL          * HEA  Layout
          IF        @EQUAL
            PACK      KEY1,TWO * default to shared
            MATCH     SP70,PMVXPACC
            GOTO      BTEX5000 IF EQUAL
            PACK      KEY5,ANSB,ANSP,PMVXPACC,SP70
            CALL      RDCODE1
            BRANCH    OVRCD,BTEX5000
            MATCH     SP70,TCINDC1
            IF        !@EQUAL
              PACK      KEY1,TCINDC1,SP70
            ENDIF
            GOTO      BTEX5000
          ENDIF
          MATCH     "2",PTCNIFCL
          GOTO      BTEX9999 IF NOT EQUAL       * SJOG Layout
.
BTEX1000  PACK      FNDBTYPE,PMFDBDTY,PMFDBDT2,PMFDBDT3:
                             PMFDBDT4,PMFDBDT5,SP70   * the keyin bed types
.
          MATCH     "PATWEB78",PRGID
          GOTO      BTEX9999 IF NOT EQUAL       * Fees Estimate
.
.         IFC - Get patient Expected bed
.
...       OPEN      BOKRX1A1,"bokrx1af"
...       PACK      KEY8,ADMISSNO
...       CALL      RDBKRX11
...       BRANCH    OVRCD,BTEX3000
...       PACK      KEY6,BKRXPOWD,BKRXPOBD,SP70
...       MATCH     SP70,KEY6
...       GOTO      BTEX4000 IF NOT EQUAL
.
...BTEX3000  OPEN      BOKRC1A1,"bokrc1af"
...       CALL      RDBKREC1
...       BRANCH    OVRCD,BTEX5000
...       PACK      KEY6,BKREWARD,BKREEBED,SP70
...       MATCH     SP70,KEY6
...       GOTO      BTEX5000 IF EQUAL
.
.         Get bed type of the Ward/Bed
.
...BTEX4000  CALL      RDWARD1
...          BRANCH    OVRCD,BTEX5000
.
...       MATCH     SP70,WEFRBT
...       GOTO      BTEX5000 IF EQUAL
.
...       PACK      FNDBTYPE,WEFRBT,SP70        * bed type of Expected Ward/Bed
...       GOTO      BTEX9999
.
.         Use Private bed type for SJOG but Shared for HEA
.
BTEX5000  MOVE      "BT",KEY2
          PACK      KEY5,KEY2,SP70
          CALL      RDSCODE1
BTEX6000  CALL      RDKCODE1
          BRANCH    OVRCD,BTEX9999
.
          MATCH     KEY2,TCODE
          GOTO      BTEX9999 IF NOT EQUAL
.
. *hea use preferred accom or shared
          MATCH     "1",PTCNIFCL
          IF        @EQUAL
            MATCH     KEY1,PTCDNHCP
            GOTO      BTEX6000 IF NOT EQUAL
            GOTO      BTEX8000
          ENDIF
.
          MATCH     "1",PTCDNHCP
          GOTO      BTEX6000 IF NOT EQUAL
.
          COMPARE   ONE,TCFORM6
          GOTO      BTEX6000 IF NOT EQUAL
.
BTEX8000  PACK      FNDBTYPE,ACODE,SP70         * found the bed type
          GOTO      BTEX9999
.
BTEX9999  RETURN
+
.******************************************************************************
.         Check for Fund Rebate bed type
.******************************************************************************
CFBT0000  MOVE      ZERO,EXIT
          MATCH     "1",PTCNIFCL
          GOTO      CFBT0500 IF EQUAL          * HEA Layout
.
          MATCH     "2",PTCNIFCL
          GOTO      CFBT9999 IF NOT EQUAL       * Not SJOG Layout
.
CFBT0500  MATCH     SP70,FNDBTYPE
          GOTO      CFBT9000 IF EQUAL
.
.         Eligibility Check will only have one bed type
.
          MOVE      ZERO,F1
.
          MATCH     "PATWEB78",PRGID
          GOTO      CFBT1000 IF NOT EQUAL
.
          MATCH     FNDBTYPE,PMFSBTYP           * the selected bed type
          GOTO      CFBT9000 IF NOT EQUAL
          GOTO      CFBT9999
.
.         Fees Estimate can have multiple bed types 
.
CFBT1000  COMPARE   FIVE,F1
          GOTO      CFBT9000 IF NOT LESS
.
          ADD       ONE,F1
.
          MOVE      ONE,FORM1
          LOAD      FORM1,F1,ONE,FOUR,SEVEN,TEN,TEN3
.
          RESET     FNDBTYPE,FORM1
          UNPACK    FNDBTYPE,KEY3
          MATCH     SP70,KEY3
          GOTO      CFBT1000 IF EQUAL
.
CFBT6000  MATCH     FNDBTYPE,PMFSBTYP           * the selected bed type
          GOTO      CFBT1000 IF NOT EQUAL
.
          GOTO      CFBT9999
.
CFBT9000  MOVE      ONE,EXIT
.
CFBT9999  RETURN
+
.******************************************************************************
.         Check for DVA Patient
.******************************************************************************
VDVA0000  MOVE      ZERO,EXIT
.         MOVE      ADMISSNO,FORM8
.         MOVE      FORM8,KEY8
.         CALL      RDMISS1
.         BRANCH    OVRCD,VDVA9999
.
.         PACK      KEY5,ANSC,ANSL,ACLAIM        * check for DVA indicator
          PACK      KEY5,ANSC,ANSL,PMFDCLTY      * check for DVA indicator
          CALL      RDCODE1
          IF        OVRCD = 0
            MOVE      ZERO,FORM1
            WHILE     FORM1 < 5
              ADD       ONE,FORM1
              LOAD      ANS,FORM1,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
              MATCH     ANSV,ANS
              GOTO      VDVA2000 IF EQUAL
            DO
          ENDIF
          GOTO      VDVA9999
.
VDVA2000  CALL      RDPTELG1
          BRANCH    OVRCD,VDVA9999
.
          MOVE      ONE,EXIT
VDVA9999  RETURN
+
.------------------------------------------------------------
.         Set up record type for Daycase/Overnight
.------------------------------------------------------------
SRTP0000  PACK      KEY18,KEY12,SP70
          CALL      RSPMFES2
          CALL      RKPMFES2
          BRANCH    OVRCD,SRTP9000
.
          MATCH     KEY12,PMFSQUOT          * Check admission number
          GOTO      SRTP9000 IF NOT EQUAL
.
          COMPARE   ZERO,PMFSQUAN
          GOTO      SRTP3000 IF NOT EQUAL   * Overnight
.
.         Daycase 
.
.         SJOG - print fees of Private bed type for daycase
.         HEA - print fees for Shared bed type for daycase
.         HEA - use preferred accom if entered
.
          MOVE      SP70,KEY1
          IF        FORM2A=1
            MATCH     "2",PTCNIFCL
            IF        @EQUAL
              MOVE      TWO,KEY1            * private
            ELSE
              MOVE      ONE,KEY1            * shared
            ENDIF
          ENDIF
.
          MATCH     "1",PTCNIFCL          * HEA  Layout
          IF        @EQUAL
            MATCH     SP70,PMVXPACC
            GOTO      SRTP8000 IF EQUAL
            PACK      KEY5,ANSB,ANSP,PMVXPACC,SP70
            CALL      RDCODE1
            BRANCH    OVRCD,SRTP8000
            MATCH     "1",TCINDC1   * if indicator 1=1 use Private
            IF        @EQUAL
              MOVE      TWO,KEY1            * private
            ENDIF
          ENDIF

          GOTO      SRTP8000
.
.         Overnight
.
SRTP3000  IF        FORM2A=1
            MOVE      ZERO,KEY1               * Daycase rate on line 1
          ELSE
            IF        FORM2A=2
              MOVE      ONE,KEY1              * share
            ELSE
              IF        FORM2A=3
                MOVE      TWO,KEY1            * Private
              ELSE
                MOVE        THREE,KEY1        * all other bed type
              ENDIF
            ENDIF
          ENDIF
.
SRTP8000  MOVE      ZERO,EXIT
          GOTO      SRTP9999
.
SRTP9000  MOVE      ONE,EXIT
SRTP9999  RETURN
+
.----------------------------------------------------------------
.         Theatre/Procedure for Healthscope layout
.----------------------------------------------------------------
HTHE0000  PACK      KEY12,SP4,ADMISSNO,SP70
          REP       " 9",KEY12
          PACK      KEY18,KEY12,KEY1,SP70
          CALL      RSPMFES2
          CALL      RKPMFES2
          BRANCH    OVRCD,HTHE9000
.
          MATCH     KEY12,PMFSQUOT          * Check admission number
          GOTO      HTHE9000 IF NOT EQUAL
          MATCH     KEY1,PMFSRECT           * Check record type
          GOTO      HTHE9000 IF NOT EQUAL
.
HTHE1000  ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
          IF        FORM1A=1
            IF        PMFSRTYP=5
              WRITE     HTMLFILE;"Theatre/Procedure";
            ELSE
              IF        PMFSRTYP=6
                WRITE     HTMLFILE;"Other(Pharmacy/Consumables/etc.)";
              ELSE
                IF        PMFSRTYP=7
                  WRITE     HTMLFILE;"Prosthesis/Gap";
                ENDIF
              ENDIF
            ENDIF
          ENDIF
          IF        FORM1A=2
            MOVE      PMFSDAYH,FORM12P2
            CALL      RNDD0000                 * Rounding to nearest dollar
            WRITE     HTMLFILE;KEY15;
          ENDIF
          IF        FORM1A=3
            MOVE      PMFSDAHF,FORM12P2
            CALL      RNDD0000                 * Rounding to nearest dollar
            WRITE     HTMLFILE;KEY15;
          ENDIF
          IF        FORM1A=4
            MOVE      FUNDGAP,FORM12P2
            CALL      RNDD0000                 * Rounding to nearest dollar
            WRITE     HTMLFILE;KEY15;
          ENDIF
          GOTO      HTHE9999
.
HTHE9000  MOVE      ZERO,PMFSDAYH
          MOVE      ZERO,PMFSDAHF
          MOVE      ZERO,FUNDGAP
          MOVE      KEY1,PMFSRTYP
          GOTO      HTHE1000
.
HTHE9999  RETURN
+
.------------------------------------------------------------
.         Other fees record type (7) from pmsfes
.------------------------------------------------------------
OTFE0000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,FORM1A
          MOVE      ZERO,FORM1                
          MOVE      "7",KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
OTFE1000  CALL      RKPMFES2
          BRANCH    OVRCD,OTFE9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      OTFE9999 IF NOT EQUAL
.
          COMPARE   SEVEN,PMFSRTYP              * Record type for Other fee?
          GOTO      OTFE9999 IF NOT EQUAL
.
          ADD       ONE,FORM1
          COMPARE   FORM1,FORM1A
          GOTO      OTFE1000 IF NOT EQUAL
.
          WRITE     HTMLFILE;PMFSTHEH;
.
OTFE9999  RETURN
+
.------------------------------------------------------------
.         Consumables fees record type (8) from pmsfes
.------------------------------------------------------------
CONF0000  MOVE      SP70,KEY1
          MOVE      ZERO,FORM1A
          MOVE      "8",KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
CONF1000  CALL      RKPMFES2
          BRANCH    OVRCD,CONF9000
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      CONF9000 IF NOT EQUAL
.
          COMPARE   EIGHT,PMFSRTYP             * Record type for Consumable fee?
          GOTO      CONF9000 IF NOT EQUAL
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MATCH     "Consumab",PMFSTHIT
            GOTO      CONF1000 IF NOT EQUAL
          ENDIF
.
          MATCH     "1",PTCNIFCL
          GOTO      CONF6000 IF NOT EQUAL
.
.  HEA Fees Estimate has Patient and Rebate amount of Consumables
.
          PACK      DIM127,DIM127,SP70
          UNPACK    DIM127,D1,KEY1
          MOVE      KEY1,FORM1A
          BRANCH    FORM1A,CONF2000,CONF2000
.
          GOTO      CONF6000
.
CONF2000  UNPACK    DIM127,D1,KEY1,DIM127
          IF        FORM1A=1
            WRITE     HTMLFILE;PMFSTHEF;    * Rebate portion
          ELSE
            IF        FORM1A=2
              MOVE      PMFSTHEH,FORM12P2
              SUB       PMFSTHEF,FORM12P2
              WRITE     HTMLFILE;FORM12P2;  * Patient  portion
            ENDIF
          ENDIF
          GOTO      CONF9999
.
CONF6000  WRITE     HTMLFILE;PMFSTHEH;
          GOTO      CONF9999
.
CONF9000  MATCH     "1",PTCNIFCL
          IF        @EQUAL
            UNPACK    DIM127,D1,KEY1
            MOVE      KEY1,FORM1A
            COMPARE   ZERO,FORM1A
            GOTO      CONF9999 IF EQUAL
            UNPACK    DIM127,D1,KEY1,DIM127
          ENDIF
CONF9999  RETURN
+
.------------------------------------------------------------
.         Discount record type (8) from pmsfes
.------------------------------------------------------------
DISC0000  MOVE      "9",KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
DISC1000  CALL      RKPMFES2
          BRANCH    OVRCD,DISC9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      DISC9999 IF NOT EQUAL
.
          COMPARE   NINE,PMFSRTYP             * Record type for Discount?
          GOTO      DISC9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PMFSTHEH;
.
DISC9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for PMI Extension file
.------------------------------------------------------------
SPMFS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMFS010,SPMFS020,SPMFS030,SPMFS040,SPMFS050:
                       SPMFS060,SPMFS070,SPMFS080,SPMFS090,SPMFS100:
                       SPMFS110,SPMFS120,SPMFS130                               
.                      
          MOVE      ONE,EXIT
          GOTO      SPMFS999
.
SPMFS010  MOVE      QRYDATA,PMSFS001
          GOTO      SPMFS999
.
SPMFS020  MOVE      QRYDATA,PMSFS002
          GOTO      SPMFS999
.
SPMFS030  MOVE      QRYDATA,PMSFS003
          GOTO      SPMFS999
.
SPMFS040  MOVE      QRYDATA,PMSFS004
          GOTO      SPMFS999
.
SPMFS050  MOVE      QRYDATA,PMSFS005
          GOTO      SPMFS999
.
SPMFS060  MOVE      QRYDATA,PMSFS006
          GOTO      SPMFS999
.
SPMFS070  MOVE      QRYDATA,PMSFS007
          GOTO      SPMFS999
.
SPMFS080  MOVE      QRYDATA,PMSFS008
          GOTO      SPMFS999
.
SPMFS090  MOVE      QRYDATA,PMSFS009
          GOTO      SPMFS999
.
SPMFS100  MOVE      QRYDATA,PMSFS010
          GOTO      SPMFS999
.
SPMFS110  MOVE      QRYDATA,PMSFS011
          GOTO      SPMFS999
.
SPMFS120  MOVE      QRYDATA,PMSFS012
          GOTO      SPMFS999
.
SPMFS130  MOVE      QRYDATA,PMSFS013
          GOTO      SPMFS999
.
SPMFS999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters for PMI Extension file
.------------------------------------------------------------
CPMFS000  MOVE      Z70,PMSFS001
          MOVE      Z70,PMSFS002
          MOVE      Z70,PMSFS003
          MOVE      Z70,PMSFS004 
          MOVE      Z70,PMSFS005
          MOVE      Z70,PMSFS006
          MOVE      Z70,PMSFS007
          MOVE      Z70,PMSFS008
          MOVE      Z70,PMSFS009
          MOVE      Z70,PMSFS010
          MOVE      Z70,PMSFS011
          MOVE      Z70,PMSFS012
          MOVE      Z70,PMSFS013
          RETURN
.
.------------------------------------------------------------
.  Update PMI Extension file
.------------------------------------------------------------
UPPMFS00  MATCH     PMSFS001,Z70  
          IF        !@EQUAL
            MOVE       PMSFS001,PMFSQUOT
          ENDIF
.
          MATCH     PMSFS002,Z70
          IF        !@EQUAL
            MOVE      PMSFS002,DPMFSUNI
          ENDIF
.
          MATCH     PMSFS003,Z70
          IF        !@EQUAL
            MOVE      PMSFS003,PMFSURNO
          ENDIF
.
          MATCH     PMSFS004,Z70   
          IF        !@EQUAL
            MOVE      PMSFS004,PMFSRTYP
          ELSE
            MOVE      ZERO,PMFSRTYP
          ENDIF
.
          MATCH     PMSFS005,Z70   
          IF        !@EQUAL
            MOVE      PMSFS005,PMFSLUMH
          ELSE
            MOVE      ZERO,PMFSLUMH
          ENDIF
.
          MATCH     PMSFS006,Z70   
          IF        !@EQUAL
            MOVE      PMSFS006,PMFSLUMF
          ELSE
            MOVE      ZERO,PMFSLUMF
          ENDIF
.
          MATCH     PMSFS007,Z70   
          IF        !@EQUAL
            MOVE      PMSFS007,PMFSDAFR
          ELSE
            MOVE      ZERO,PMFSDAFR
          ENDIF
.
          MATCH     PMSFS008,Z70   
          IF        !@EQUAL
            MOVE      PMSFS008,PMFSDAYT
          ELSE
            MOVE      ZERO,PMFSDAYT
          ENDIF
.
          MATCH     PMSFS009,Z70   
          IF        !@EQUAL
            MOVE      PMSFS009,PMFSDAYH
          ELSE
            MOVE      ZERO,PMFSDAYH
          ENDIF
.
          MATCH     PMSFS010,Z70   
          IF        !@EQUAL
            MOVE      PMSFS010,PMFSDAHF
          ELSE
            MOVE      ZERO,PMFSDAHF
          ENDIF
.
          MATCH     PMSFS011,Z70
          IF        !@EQUAL
            MOVE      PMSFS011,PMFSTHIT
          ENDIF
.
          MATCH     PMSFS012,Z70
          IF        !@EQUAL
            MOVE      PMSFS012,PMFSTHEH
          ELSE
            MOVE      ZERO,PMFSTHEH
          ENDIF
.
          MATCH     PMSFS013,Z70
          IF        !@EQUAL
            MOVE      PMSFS013,PMFSTHEF
          ELSE
            MOVE      ZERO,PMFSTHEF
          ENDIF
.
UPPMFS99  RETURN
+
.------------------------------------------------------------
.  Theatre / Misc Fees Code PMSFESFD Parameters: FORM1A - Record Type
.                                                FORM1B - Item Number
.                                                FORM1C - PMSFESFD Variable
.------------------------------------------------------------
FTMC0000  MOVE      ONE,FORM1
          MOVE      FORM1A,KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
FTMC1000  CALL      RKPMFES2
          BRANCH    OVRCD,FTMC9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      FTMC9999 IF NOT EQUAL
.
          COMPARE   FORM1A,PMFSRTYP
          GOTO      FTMC9999 IF NOT EQUAL
.
          COMPARE   FORM1B,FORM1
          IF        !@EQUAL
            ADD       ONE,FORM1
            GOTO      FTMC1000
          ENDIF
.
          BRANCH    FORM1C,FTMC2010,FTMC2020
          GOTO      FTMC9999
.
FTMC2010  WRITE     HTMLFILE;PMFSTHIT;
          GOTO      FTMC9999 
.
FTMC2020  COMPARE   THREE,FORM1A
          IF        @EQUAL
            PACK      KEY17,PMFSTHIT,SP70
            CALL      PATITMRD
            BRANCH    OVRCD,FTMC9999
            WRITE     HTMLFILE;IDESC;
          ENDIF
.
          COMPARE   SIX,FORM1A
          IF        @EQUAL
            MOVE      PMFSTHIT,MCHARGE
            CALL      GETMSC00
            BRANCH    EXIT,FTMC9999
            WRITE     HTMLFILE;MDESC;
          ENDIF
          GOTO      FTMC9999
.
FTMC9999  RETURN
+
.------------------------------------------------------------
.  Theatre / Misc Fees Code PMSFESFD Parameters: FORM1A - Record Type
.                                                FORM2B - Item Number
.                                                FORM1C - PMSFESFD Variable
.------------------------------------------------------------
FTMX0000  
.         SJOG is using IFC layout for the Fees Estimate
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
.
.         SJOG is using IFC layout for their Fees Estimate, so
.         Record type for Theatre, Fees Est=3, IFC record type =5
.         Record type for Misc., Fees Est= 6, IFC - record type =8
.
            IF        FORM1A=3
              MOVE      "5",FORM1A
            ENDIF
.
            IF        FORM1A=6
              MOVE      "8",FORM1A
            ENDIF
          ENDIF
.
          MOVE      ONE,FORM2
          MOVE      FORM1A,KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
FTMX1000  CALL      RKPMFES2
          BRANCH    OVRCD,FTMX9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      FTMX9999 IF NOT EQUAL
.
          COMPARE   FORM1A,PMFSRTYP
          GOTO      FTMX9999 IF NOT EQUAL
.
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            IF        PMFSRTYP=5
              MATCH     "PATWEB78",PRGID
              IF        @EQUAL
.               MATCH     "XXX",PMFSBTYP
.               GOTO      FTMX1000 IF EQUAL     * Skip items from Booking
             ENDIF
            ENDIF
          ENDIF
.
          MATCH     "Pharmacy",PMFSTHIT
          GOTO      FTMX1000 IF EQUAL
.
          MATCH     "Prosthet.",PMFSTHIT
          GOTO      FTMX1000 IF EQUAL
.
          MATCH     "Consumab.",PMFSTHIT
          GOTO      FTMX1000 IF EQUAL
.
          COMPARE   FORM2B,FORM2
          IF        !@EQUAL
            ADD       ONE,FORM2
            GOTO      FTMX1000
          ENDIF
.
          BRANCH    FORM1C,FTMX2010,FTMX2020,FTMX2030,FTMX2040,FTMX2050:
                           FTMX2060
          GOTO      FTMX9999
.
FTMX2010  MATCH     "2",PTCNIFCL
          IF        !@EQUAL
            MATCH     SP70,PMFSBTYP             * Item should have blank bedtype
            GOTO      FTMX9999 IF NOT EQUAL     * Must be room rate
          ENDIF
.
          WRITE     HTMLFILE;PMFSTHIT;
          GOTO      FTMX9999
.
FTMX2020  MOVE      THREE,BOOKFLAG
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MATCH     "PATWEB78",PRGID
            IF        @EQUAL
              MOVE      FIVE,BOOKFLAG
            ENDIF
          ENDIF
          COMPARE   BOOKFLAG,FORM1A
          IF        @EQUAL
            PACK      KEY17,PMFSTHIT,SP70
            CALL      PATITMRD
            BRANCH    OVRCD,FTMX9999
            WRITE     HTMLFILE;IDESC;
          ENDIF
.
          MOVE      SIX,BOOKFLAG
          MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MATCH     "PATWEB78",PRGID
            IF        @EQUAL
              MOVE      EIGHT,BOOKFLAG
            ENDIF
          ENDIF
          COMPARE   BOOKFLAG,FORM1A
          IF        @EQUAL
            UNPACK    SP20,PTHFBCAT       * change "H/F Table" to "Table Type"
            PACK      KEY14,PMFDHFUN,PMFDHFTB,SP20
            CALL      RDFUND1            * "Table Type code" now in PTHFBCAT
.
            PACK      KEY29,PMFDCLTY,PMFDHFUN,PTHFBCAT,PMFSTHIT,CURRDATE,SP10
            CALL      PATMCHRD                 * find Miscellaneous Charge Item
            BRANCH    EXIT,FTMX9999
            WRITE     HTMLFILE;MDESC;
          ENDIF
          GOTO      FTMX9999
.
FTMX2030  WRITE     HTMLFILE;PMFSQUAN;
          GOTO      FTMX9999
.
FTMX2040  WRITE     HTMLFILE;PMFSGSTP;
          GOTO      FTMX9999
.
FTMX2050  WRITE     HTMLFILE;PMFSGSTC;
          GOTO      FTMX9999
.
FTMX2060  WRITE     HTMLFILE;PMFSTHEH;           * item fee
          GOTO      FTMX9999
.
FTMX9999  RETURN
+
.------------------------------------------------------------
. Get the appropriate miscellaneous charges record
.------------------------------------------------------------
GETMSC00  MOVE      ZERO,EXIT
          MOVE      MCHARGE,KEY9            * (MCHARGE re-use in PATMCHRD)
.
          UNPACK    SP20,PTHFBCAT           * change "H/F Table" to "Table Type"
          PACK      KEY14,PMFDHFUN,PMFDHFTB,SP20
          CALL      RDFUND1                 * "Table Type code" now in PTHFBCAT
.
          PACK      KEY29,PMFDCLTY,PMFDHFUN,PTHFBCAT,KEY9,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          COMPARE   ZERO,EXIT
          GOTO      GETMSC99 IF EQUAL
.
.         No record with health fund detials - try a blank health fund
.
GETMSC10  PACK      KEY29,PMFDCLTY,SP6,SP3,KEY9,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          COMPARE   ZERO,EXIT
          GOTO      GETMSC99 IF EQUAL
.
.         No record with health fund detials - last chance, try default claim
.
GETMSC20  MOVE      PTCNDCLM,MCLMCOD
          COMPARE   ONE,IBCNMHOS
          GOTO      GETMSC40 IF NOT EQUAL
          BRANCH    OPTION,GETMSC30,GETMSC40,GETMSC40,GETMSC30,GETMSC40
.
GETMSC30  IF        IBCNMHOS=1
            MOVE      ADMISSNO,KEY8
            CALL      RDPMVX11
            IF        OVRCD=0
              PACK      KEY3,PMVXMHOS         * Hospital id
              OPEN      PATHSPA1,"pathspaf"
              CALL      RDPTHSP1
              IF        OVRCD=0
                MOVE      PTHSDCLM,MCLMCOD
              ENDIF
            ENDIF
          ENDIF
.
GETMSC40  PACK      KEY29,MCLMCOD,SP6,SP3,KEY9,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          COMPARE   ZERO,EXIT
          GOTO      GETMSC99 IF EQUAL
.
GETMSC99  RETURN
+
.------------------------------------------------------------
.  Theatre / Misc Fees Code PMSFESFD Parameters: FORM1A - Column no.
.                                                FORM2A - Item Number
.------------------------------------------------------------
FBFE0000  MOVE      ZERO,HEASINSR           * HEA Uninsured flag
          PACK      KEY5,ANSC,ANSL,PMFDCLTY
          CALL      RDCODE1
          IF        OVRCD=0
            MATCH     "3",TCINDC5
            IF        @EQUAL
              MATCH     "1",PTCNIFCL
              IF        @EQUAL
                MOVE      ONE,HEASINSR      * HEA unins.-All charges to Patient
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      ONE,FORM2
          PACK      KEY17,PMFDQUOT,SP20
          CALL      RSPMFES1
FBFE1000  CALL      RKPMFES1
          BRANCH    OVRCD,FBFE9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      FBFE9999 IF NOT EQUAL
.
          IF        ONE<>PMFSRTYP & TWO<>PMFSRTYP & FOUR<>PMFSRTYP
            GOTO      FBFE1000
          ENDIF
.
          COMPARE   FORM2A,FORM2
          IF        !@EQUAL
            ADD       ONE,FORM2
            GOTO      FBFE1000
          ENDIF
.
          COMPARE   ONE,PMFSRTYP
          IF        @EQUAL
            ASSIGN    (PMFSLUMH-PMFSLUMF),FUNDGAP
.
.           WRITE     HTMLFILE;"Lump Sum Charge                ",PMFSLUMH," ",PMFSLUMF,"       ",FUNDGAP;
.
            IF        FORM1A=ONE
              WRITE     HTMLFILE;"Lump Sum Charge";
            ENDIF
            IF        FORM1A=TWO
              WRITE     HTMLFILE;PMFSLUMH;
            ENDIF
            IF        FORM1A=THREE
              IF        HEASINSR=1
                MOVE      ZERO,PMFSLUMF
              ENDIF
              WRITE     HTMLFILE;PMFSLUMF;
            ENDIF
            IF        FORM1A=FOUR
              WRITE     HTMLFILE;FUNDGAP;
            ENDIF
          ENDIF          
.
          MATCH     "1",PTCNIFCL          * HEA
          IF        @EQUAL
            IF        HEASINSR=1
              MOVE      ZERO,PMFSDAHF   * HEA Uninsured - zero HF column
            ENDIF
          ENDIF
.
          COMPARE   TWO,PMFSRTYP
          IF        @EQUAL
            ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
            IF        PMFDNONS=0
.             WRITE     HTMLFILE;"Daycase                        ",PMFSDAYH," ",PMFSDAHF,"       ",FUNDGAP;
.
              IF        FORM1A=ONE
                WRITE     HTMLFILE;"Daycase";
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
.
.   HEC task 0915997 - for daycase not to print Funder column for other bedtypes
.
              IF        FORM1A=THREE
                MATCH     PMFSBTYP,PMFDBDTY
                IF        !@EQUAL
                  MOVE      ZERO,PMFSDAHF
                ENDIF
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
.
            ELSE
              MOVE      PMFSDAFR,FORM4A
              MOVE      PMFSDAYT,FORM4B
.             WRITE     HTMLFILE;FORM4A," - ",FORM4B,"                    ",PMFSDAYH," ",PMFSDAHF,"       ",FUNDGAP;
.
              IF        FORM1A=ONE
                WRITE     HTMLFILE;FORM4A," - ",FORM4B;
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                MOVE      PMFSDAHF,FORM12P2
                MATCH     "0",PTCNIFCL          * Standard Layout
                IF        @EQUAL
                  MULT      PMFSDAFR,FORM12P2
                ENDIF
                WRITE     HTMLFILE;FORM12P2;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
.
            ENDIF   
          ENDIF
.
          COMPARE   FOUR,PMFSRTYP   
          IF        @EQUAL
            ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
            PRINT     *1,"Additional Charge";
            IF        CMXFLG=1 
              MOVE      PMFSDAFR,FORM4A
              MOVE      PMFSDAYT,FORM4B
.             WRITE     HTMLFILE;FORM4A," - ",FORM4B,"                    ",PMFSDAYH," ",PMFSDAHF,"       ",FUNDGAP;
.
              IF        FORM1A=ONE
                WRITE     HTMLFILE;FORM4A," - ",FORM4B;
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
.
            ELSE
.             WRITE     HTMLFILE;"Daycase                        ",PMFSDAYH," ",PMFSDAHF,"       ",FUNDGAP;
.
              IF        FORM1A=ONE
                WRITE     HTMLFILE;"Daycase";
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
.
            ENDIF
          ENDIF
.
FBFE9999  RETURN
.------------------------------------------------------------
.  Fees Estimate
.  Theatre / Misc Fees Code PMSFESFD Parameters: FORM1A - Line Item or Total
.                                                FORM1B - Record Type
.                                                FORM1C - Column no
.                                                FORM2A - Item Number
.                                                DIM1A  - Mis.Desc.
.------------------------------------------------------------
FTFE0000  MOVE      ZERO,SELFINSR           * Uninsured flag
          MOVE      ZERO,HEASINSR
          MOVE      ZERO,FORM1
          MOVE      PTCNIFCL,FORM1
.
          BRANCH    FORM1,FTFE0100,FTFE0100
          GOTO      FTFE0900
.
FTFE0100  PACK      KEY5,ANSC,ANSL,PMFDCLTY
          CALL      RDCODE1
          IF        OVRCD=0
            MATCH     "3",TCINDC5
            IF        @EQUAL
              MOVE      ONE,SELFINSR        * Uninsured
              MOVE      ONE,HEASINSR
            ENDIF
          ENDIF
.
          BRANCH    FORM1,FTFE0110,FTFE0120
          GOTO      FTFE0900
.
FTFE0110  MATCH     "PATWEB78",PRGID
          GOTO      FTFE0900 IF NOT EQUAL
.
.         HEA IFC with Fees Estimate exists,get the Pharmacy & Prosthetics
.
          COMPARE   ONE,FESTFLAG
          GOTO      FTFE0120 IF NOT EQUAL
.
          IF        FORM1C=1
            MOVE      "8",KEY1
            PACK      KEY18,QUOTEEST,KEY1,SP20
            CALL      RSPMFES2
            CALL      RKPMFES2
            BRANCH    OVRCD,FTFE9999
.
            PACK      DIM12,QUOTEEST,SP70
            MATCH     DIM12,PMFSQUOT
            GOTO      FTFE9999 IF NOT EQUAL
.
            COMPARE   "8",PMFSRTYP
            GOTO      FTFE9999 IF NOT EQUAL
.
            WRITE     HTMLFILE;PMFSTHEH;    * Misc.Amount
            GOTO      FTFE9999
          ENDIF
.
          IF        FORM1C=4
            MOVE      ONE,FORM2
            MOVE      FORM1B,KEY1
            PACK      KEY18,PMFDQUOT,KEY1,SP20
            CALL      RSPMFES2
FTFE0112    CALL      RKPMFES2
            BRANCH    OVRCD,FTFE9999
.
            MATCH     PMFDQUOT,PMFSQUOT
            GOTO      FTFE9999 IF NOT EQUAL
.
            COMPARE   FORM1B,PMFSRTYP
            GOTO      FTFE9999 IF NOT EQUAL
.
            COMPARE   FORM2A,FORM2
            IF        !@EQUAL
              ADD       ONE,FORM2
              GOTO      FTFE0112
            ENDIF
.
            WRITE     HTMLFILE;PMFSTHEH;    * Misc.Amount
            GOTO      FTFE9999
          ENDIF
.
.******************************************************************************
.         SJOG Fees Estimate is using IFC layout
.
FTFE0120  IF        FORM1B=3
            MOVE      "5",FORM1B            * IFC Theatre Fees
            GOTO      FTFE0200
          ELSE
            IF        FORM1B=6
              MOVE      "8",FORM1B          * IFC Misc.
              GOTO      FTFE0200
            ENDIF
          ENDIF
          GOTO      FTFE0900
.
.         SJOG
.
FTFE0200  MOVE      FORM1B,KEY1
          MOVE      ONE,FORM2
          PACK      KEY18,PMFDQUOT,KEY1,SP70
          CALL      RSPMFES2
FTFE0300  CALL      RKPMFES2
          BRANCH    OVRCD,FTFE0800
.
          MATCH     PMFDQUOT,PMFSQUOT       * Check quote number
          GOTO      FTFE0800 IF NOT EQUAL
          MATCH     KEY1,PMFSRECT           * Check record type
          GOTO      FTFE0800 IF NOT EQUAL
.
          COMPARE   ONE,FORM1A
          IF        @EQUAL
            ASSIGN    (THTOTAL+PMFSTHEH),THTOTAL
            ASSIGN    (THFUND+PMFSTHEF),THFUND
          ENDIF
.
          MATCH     "PATWEB78",PRGID
          IF        @EQUAL
            IF        PMFSRTYP=8
              MATCH     "Prosthet.",PMFSTHIT       * Prosthesis is Fund rebate
              GOTO      FTFE0300 IF EQUAL
              MATCH     "Pharmacy",PMFSTHIT
              GOTO      FTFE0300 IF EQUAL
              MATCH     "Consumab.",PMFSTHIT
              GOTO      FTFE0300 IF EQUAL
            ENDIF
          ENDIF
.
          COMPARE   FORM2A,FORM2
          IF        !@EQUAL
            ADD       ONE,FORM2
            GOTO      FTFE0300
          ENDIF
.
          ASSIGN    (PMFSTHEH*PMFSQUAN),ITHOSTOT       * total fee x quantity
          ASSIGN    (PMFSTHEF*PMFSQUAN),ITREBTOT       * reb x quantity
          ASSIGN    (PMFSTHEH-PMFSTHEF),FUNDGAP        * patient 
.
          IF        FORM1C=1
            MOVE      SP70,KEY11
            IF        PMFSRTYP=5 & FORM2=1
.             MOVE      "- Theatre  ",KEY11
            ENDIF
            IF        PMFSRTYP=8 & FORM2=1
.             MOVE      "- Misc.Item",KEY11
            ENDIF
.           WRITE     HTMLFILE;PMFSTHIT,KEY11;
.
            CALL      CTAG0000                * Check next tag
          ENDIF
.
          IF        FORM1C=2
            MOVE      PMFSTHEH,FORM12P2
            MOVE      FORM12P2,KEY15
.           CALL      RNDD0000                 * Rounding to nearest dollar
            WRITE     HTMLFILE;KEY15;
          ENDIF
.
          COMPARE   THREE,FORM1C
          GOTO      FTFE0600 IF NOT EQUAL
.
          MOVE      SP70,KEY15
          BRANCH    SELFINSR,FTFE0500        * Self Insured
.
.         Only Theatre fee will have no rebate for using Basic/Default cover
.
          IF        FORM1B=5
            MATCH     "PATWEB78",PRGID
            IF        @EQUAL
              MATCH     "1",USEBASIC
              GOTO      FTFE0500 IF EQUAL
              MOVE      PMFSTHEH,FORM12P2
              MOVE      FORM12P2,KEY15
.             CALL      RNDD0000                 * Rounding to nearest dollar
              GOTO      FTFE0500
            ELSE
              MATCH     "1",PMFDUBAS
              GOTO      FTFE0500 IF EQUAL      * use Basic/default cover rate
              MOVE      PMFSTHEH,FORM12P2
              MOVE      FORM12P2,KEY15
.             CALL      RNDD0000                 * Rounding to nearest dollar
              GOTO      FTFE0500
            ENDIF
          ENDIF
.
          MOVE      PMFSTHEF,FORM12P2
          MATCH     "Prosthet.",PMFSTHIT       * Prosthesis is Fund rebate
          IF        @EQUAL
            MOVE      PMFSTHEH,FORM12P2
          ENDIF
.
          MOVE      FORM12P2,KEY15
.         CALL      RNDD0000                 * Rounding to nearest dollar
.
FTFE0500 MATCH     "PATWEB78",PRGID
          IF        @EQUAL
            MATCH     SP70,KEY15
            IF        !@EQUAL
              IF        PMFSQUAN>1
                MULT      PMFSQUAN,FORM12P2
                MOVE      FORM12P2,KEY15
              ENDIF
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;KEY15;
          GOTO      FTFE9999
.
FTFE0600  COMPARE   FOUR,FORM1C
          GOTO      FTFE0720 IF NOT EQUAL
.
          MOVE      ITHOSTOT,FORM12P2
.
          MATCH     "PATWEB78",PRGID
          IF        @EQUAL
            IF        PMFSQUAN>1
              MOVE      PMFSTHEH,FORM12P2
            ENDIF
          ENDIF
.
          BRANCH    SELFINSR,FTFE0700        * self insured
.
.         Only Theatre fee will have no rebate for using Basic cover
.
          IF        FORM1B=5
            MATCH     "PATWEB78",PRGID
            IF        @EQUAL
              MATCH     "1",USEBASIC
              GOTO      FTFE0700 IF EQUAL
              RETURN
            ELSE
              MATCH     "1",PMFDUBAS
              GOTO      FTFE0700 IF EQUAL
              RETURN
            ENDIF
          ENDIF
.
          MATCH     "Prosthet.",PMFSTHIT
          GOTO      FTFE0720 IF EQUAL        * Prosthesis is Fund Rebate
.
          MOVE      FUNDGAP,FORM12P2
.
FTFE0700  MATCH     "PATWEB78",PRGID
          IF        @EQUAL
            IF        PMFSQUAN>1
              MULT      PMFSQUAN,FORM12P2
            ENDIF
          ENDIF
.
          MOVE      FORM12P2,KEY15
          CALL      RNDD0000                 * Rounding to nearest dollar
          WRITE     HTMLFILE;KEY15;
          GOTO      FTFE9999
.
FTFE0720  COMPARE   ONE,FORM1A
          GOTO      FTFE0300 IF EQUAL
.
FTFE0800  COMPARE   ONE,FORM1A
          RETURN    IF NOT EQUAL
.
          IF        FORM1C=ONE
            WRITE     HTMLFILE;"TOTAL";
          ENDIF
          IF        FORM1C=TWO
            WRITE     HTMLFILE;THTOTAL;
          ENDIF
          IF        FORM1C=THREE
            WRITE     HTMLFILE;THFUND;
          ENDIF
.
          GOTO      FTFE9999
.
.         Fees Estimate
.
FTFE0900  MOVE      ONE,FORM2
          MOVE      FORM1B,KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
FTFE1000  CALL      RKPMFES2
          BRANCH    OVRCD,FTFE9000
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      FTFE9000 IF NOT EQUAL
.           
          COMPARE   FORM1B,PMFSRTYP
          GOTO      FTFE9000 IF NOT EQUAL
.             
          COMPARE   ONE,FORM1A
          IF        @EQUAL
            ASSIGN    (THTOTAL+PMFSTHEH),THTOTAL
            ASSIGN    (THFUND+PMFSTHEF),THFUND
          ENDIF
.
          COMPARE   FORM2A,FORM2
          IF        !@EQUAL
            ADD       ONE,FORM2
            GOTO      FTFE1000
          ENDIF
.
          IF        FORM1C=FIVE
            WRITE     HTMLFILE;PMFSQUAN;
            GOTO      FTFE9999
          ENDIF
.
.>>>>
          BRANCH    HEASINSR,FTFE1020          * HEA Uninsured
.
.         for HEA 'Use Basic Cover' Fees Estimate, Theatre have Zero Rebate
.
          IF        FORM1B=3
            MATCH     "1",PTCNIFCL
            IF        @EQUAL
              MATCH     "PATWEB76",PRGID
              IF        @EQUAL
                MATCH     "1",USEBASIC
                GOTO      FTFE1020 IF EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          ASSIGN    (PMFSTHEH*PMFSQUAN),ITHOSTOT           * fee x quantity
          ASSIGN    (PMFSTHEF*PMFSQUAN),ITREBTOT           * reb x quantity
          ASSIGN    (ITHOSTOT-ITREBTOT),FUNDGAP
          GOTO      FTFE1040
.
FTFE1020  ASSIGN    (PMFSTHEH*PMFSQUAN),ITHOSTOT           * fee x quantity
          MOVE      ZERO,ITREBTOT                          * reb x quantity
          ASSIGN    (ITHOSTOT-ITREBTOT),FUNDGAP
.
FTFE1040  IF        ONE<>FORM1A
.           WRITE     HTMLFILE;PMFSTHIT," ",PMFSTHEH," ",PMFSTHEF,"       ",FUNDGAP;
.
            IF        FORM1C=ONE
              PACK      KEY50,PMFSTHIT,SP70
              PACK      KEY17,PMFSTHIT,Z70
              CALL      RDSITEM1
              CALL      RDPITEM1
              IF        OVRCD=0
                MATCH     ITEMNO,PMFSTHIT
                IF        @EQUAL
                  PACK      KEY50,PMFSTHIT,SP1,IDESC,SP70
                  GOTO      FTFE1060
                ENDIF
              ENDIF
              MATCH     "0",PTCNIFCL          * Standard Layout
              IF        @EQUAL
                IF        FORM1B=6
                  MATCH     "Prosthet.",PMFSTHIT
                  IF        @EQUAL
                    MOVE      "xxxxxxxxx",KEY9
                    MOVE      "Prosthetics",KEY11
                    PACK      KEY50,KEY9,SP1,KEY11,SP70
                    GOTO      FTFE1060
                  ELSE
                    MATCH     "Pharmacy",PMFSTHIT
                    IF        @EQUAL
                      MOVE      "xxxxxxxxx",KEY9
                      PACK      KEY50,KEY9,SP1,PMFSTHIT,SP70
                      GOTO      FTFE1060
                    ENDIF
                  ENDIF
                  MOVE      PMFSTHIT,MCHARGE
                  CALL      GETMSC00
                  IF        EXIT=0
                    PACK      KEY50,PMFSTHIT,SP1,MDESC,SP70
                  ENDIF
                ENDIF
              ENDIF
FTFE1060      WRITE     HTMLFILE;KEY50;
            ENDIF
.
FTFE1100    IF        FORM1C=TWO
              WRITE     HTMLFILE;ITHOSTOT;
            ENDIF
            IF        FORM1C=THREE
              WRITE     HTMLFILE;ITREBTOT;
            ENDIF
            IF        FORM1C=FOUR
              WRITE     HTMLFILE;FUNDGAP;
            ENDIF
.>>>>
          ENDIF
.
          COMPARE   ONE,FORM1A
          GOTO      FTFE1000 IF EQUAL
.
FTFE9000  COMPARE   ONE,FORM1A
          RETURN    IF NOT EQUAL
.
          ASSIGN    (THTOTAL-THFUND),THTHOSPT
.         WRITE     HTMLFILE;"TOTAL      ",THTOTAL,"         ",THFUND,"  ",THTHOSPT;
          IF        FORM1C=ONE
            WRITE     HTMLFILE;"TOTAL";
          ENDIF
          IF        FORM1C=TWO
            WRITE     HTMLFILE;THTOTAL;
          ENDIF
          IF        FORM1C=THREE
            WRITE     HTMLFILE;THFUND;
          ENDIF
          IF        FORM1C=FOUR
            WRITE     HTMLFILE;THTHOSPT;
          ENDIF
.
FTFE9999  RETURN
.
.------------------------------------------------------------
.         Check the last char of the tag
.------------------------------------------------------------
CTAG0000  MATCH     "1",PTCNIFCL
          GOTO      CTAG1200 IF NOT EQUAL
.
          MATCH     "Y",DIM1A
          GOTO      CTAG8000 IF NOT EQUAL
.
          WRITE     HTMLFILE;PMFSTHEH;    * Misc.Amount
          GOTO      CTAG9999
.
CTAG1200  MATCH     "2",PTCNIFCL
          GOTO      CTAG8000 IF NOT EQUAL
.
          MATCH     "X",DIM1A
          GOTO      CTAG2000 IF NOT EQUAL
.
          MOVE      PMFSTHIT,KEY9
          PACK      KEY17,KEY9,SP70
          IF        FORM1B=5
            CALL      PATITMRD           * Theatre fee desc.
            IF        OVRCD=0
              WRITE     HTMLFILE;IDESC;
            ENDIF
          ELSE
            IF        FORM1B=8
              MOVE      PMFSTHIT,MCHARGE  * Misc.Item
              CALL      GETMSC00
              IF        OVRCD=0
                WRITE     HTMLFILE;MDESC;
              ENDIF
            ENDIF
          ENDIF
          GOTO      CTAG9999
.
CTAG2000  MATCH     "Y",DIM1A
          GOTO      CTAG8000 IF NOT EQUAL
.
          IF        FORM1B=8
            MOVE      PMFSTHIT,MCHARGE  * Misc.Item
            CALL      GETMSC00
            IF        OVRCD=0
              MATCH     "Y",PTMCKREB
              GOTO      CTAG9999 IF NOT EQUAL    * keyin Misc.item amount
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;PMFSTHEH;    * Misc.Amount
          GOTO      CTAG9999
.
CTAG8000  WRITE     HTMLFILE;PMFSTHIT;
CTAG9999  RETURN
+
.------------------------------------------------------------
.  Theatre / Misc Fees Code PMSFESFD Parameters: FORM1A - Column No
.                                                FORM2A - Item Number
.------------------------------------------------------------
FOFE0000  MOVE      ONE,FORM2
          MOVE      "5",KEY1
          PACK      KEY18,PMFDQUOT,KEY1,SP20
          CALL      RSPMFES2
FOFE1000  CALL      RKPMFES2
          BRANCH    OVRCD,FOFE9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      FOFE9999 IF NOT EQUAL
.
          COMPARE   FIVE,PMFSRTYP
          GOTO      FOFE9999 IF NOT EQUAL
.
          COMPARE   FORM2A,FORM2
          IF        !@EQUAL
            ADD       ONE,FORM2
            GOTO      FOFE1000
          ENDIF
.
          ASSIGN    (PMFSDAYH-PMFSDAHF),OVRGAP
          IF        PMFDNONS=0
.           WRITE     HTMLFILE;"Daycase","     ",PMFSDAYH," ",PMFSDAHF," ",OVRGAP;
.
            IF        FORM1A=ONE
              WRITE     HTMLFILE;"Daycase";
            ENDIF
            IF        FORM1A=TWO
              WRITE     HTMLFILE;PMFSDAYH;
            ENDIF
            IF        FORM1A=THREE
              WRITE     HTMLFILE;PMFSDAHF;
            ENDIF
            IF        FORM1A=FOUR
              WRITE     HTMLFILE;OVRGAP;
            ENDIF
.
          ELSE
.           WRITE     HTMLFILE;PMFSDAYT,"     ",PMFSDAYH," ",PMFSDAHF," ",OVRGAP;
.
            IF        FORM1A=ONE
              WRITE     HTMLFILE;PMFSDAYT;
            ENDIF
            IF        FORM1A=TWO
              WRITE     HTMLFILE;PMFSDAYH;
            ENDIF
            IF        FORM1A=THREE
              WRITE     HTMLFILE;PMFSDAHF;
            ENDIF
            IF        FORM1A=FOUR
              WRITE     HTMLFILE;OVRGAP;
            ENDIF
.
          ENDIF
.
FOFE9999  RETURN
+
.------------------------------------------------------------
.  Bed Fees by record type  PMSFESFD Parameters: FORM1A - Column no.
.                                                FORM2A - Item Number
.  FORM1A= 1 pmfsdafr (los days)
.        = 2 pmfsdayh (daily accomm charge)
.        = 3 pmfsdahf (daily accomm rebate)
.        = 4 fundgap  (patient cost)
.        = 5 Maximum column (HEA)
.------------------------------------------------------------
BFBR0000  MOVE      ZERO,HEASINSR           * HEA Uninsured flag
          MATCH     "1",PTCNIFCL
          IF        @EQUAL
            PACK      KEY5,ANSC,ANSL,PMFDCLTY
            CALL      RDCODE1
            IF        OVRCD=0
              MATCH     "3",TCINDC5
              IF        @EQUAL
                MOVE      ONE,HEASINSR      * HEA uninsured
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      ONE,FORM2
          PACK      KEY17,PMFDQUOT,SP20
          CALL      RSPMFES1
BFBR1000  CALL      RKPMFES1
          BRANCH    OVRCD,BFBR9999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      BFBR9999 IF NOT EQUAL
.
          IF        ONE<>PMFSRTYP & TWO<>PMFSRTYP & FOUR<>PMFSRTYP
            GOTO      BFBR1000
          ENDIF
.
          COMPARE   FORM2A,FORM2
          IF        !@EQUAL
            ADD       ONE,FORM2
            GOTO      BFBR1000
          ENDIF
.
          COMPARE   ONE,PMFSRTYP
          IF        @EQUAL
            IF        HEASINSR=1
              MOVE      PMFSLUMH,FUNDGAP
            ELSE
              ASSIGN    (PMFSLUMH-PMFSLUMF),FUNDGAP
            ENDIF
.
            IF        FORM1A=ONE
              WRITE     HTMLFILE;"Lump Sum Charge";
            ENDIF
            IF        FORM1A=TWO
              WRITE     HTMLFILE;PMFSLUMH;
            ENDIF
            IF        FORM1A=THREE
              WRITE     HTMLFILE;PMFSLUMF;
            ENDIF
            IF        FORM1A=FOUR
.
.           HEA casepayment, where 'Default rate' is ticked..
.           Lumpsum rebate = basic health fund rebate x LOS
.
              MATCH     "1",PTCNIFCL
              IF        @EQUAL
                MATCH     "1",USEBASIC
                IF        @EQUAL
                  IF        PMFDNONS<>0
                    ASSIGN    (PMFSLUMH-PMFSLUMF * PMFDNONS),FUNDGAP
                  ENDIF
                ENDIF
              ENDIF
              WRITE     HTMLFILE;FUNDGAP;
            ENDIF
            IF        FORM1A=FIVE
              CALL      GBTYP000
            ENDIF
          ENDIF
.
.
          COMPARE   TWO,PMFSRTYP
          IF        @EQUAL
            MATCH     "1",PTCNIFCL
            GOTO      BFBR1400 IF NOT EQUAL   Not HEA
.
            COMPARE   ONE,HEASINSR
            GOTO      BFBR1400 IF NOT EQUAL
.
BFBR1200    ASSIGN    (PMFSDAFR*PMFSDAYH),FUNDGAP
            GOTO      BFBR1600
.
BFBR1400    ASSIGN    (PMFSDAFR*(PMFSDAYH-PMFSDAHF)),FUNDGAP
.
BFBR1600    IF        PMFDNONS=0
              IF        FORM1A=ONE
                MATCH     PMFSBTYP,PMFDBDTY
                IF        @EQUAL
                  WRITE     HTMLFILE;"Daycase";
                ELSE
                  WRITE     HTMLFILE;"0";
                ENDIF
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                MATCH     PMFSBTYP,PMFDBDTY
                IF        @EQUAL
                  IF        PMFSDAFR=0
                    IF        HEASINSR=1
                      ASSIGN    (PMFSDAYH),FUNDGAP
                    ELSE
                      ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
                    ENDIF
                  ENDIF
                ENDIF
.
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
              IF        FORM1A=FIVE
                CALL      GBTYP000
              ENDIF
.
            ELSE
              IF        FORM1A=ONE
                WRITE     HTMLFILE;PMFSDAFR;
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
              IF        FORM1A=FIVE
                CALL      GBTYP000
              ENDIF
.
            ENDIF
          ENDIF
.
          COMPARE   FOUR,PMFSRTYP
          IF        @EQUAL
            IF        HEASINSR=1
              MOVE      PMFSDAYH,FUNDGAP
            ELSE
              ASSIGN    (PMFSDAYH-PMFSDAHF),FUNDGAP
            ENDIF
            PRINT     *1,"Additional Charge";
            IF        CMXFLG=1
              IF        FORM1A=ONE
                WRITE     HTMLFILE;PMFSDAFR;
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
            ELSE
              IF        FORM1A=ONE
                WRITE     HTMLFILE;"Daycase";
              ENDIF
              IF        FORM1A=TWO
                WRITE     HTMLFILE;PMFSDAYH;
              ENDIF
              IF        FORM1A=THREE
                WRITE     HTMLFILE;PMFSDAHF;
              ENDIF
              IF        FORM1A=FOUR
                WRITE     HTMLFILE;FUNDGAP;
              ENDIF
.
            ENDIF
          ENDIF
.
BFBR9999  RETURN
+
.------------------------------------------------------------
. Get Bed Type
.------------------------------------------------------------
GBTYP000  MATCH     SP70,PMFSBTYP
          IF        !@EQUAL
            PACK      KEY5,ANSB,ANST,PMFSBTYP
            CALL      RDCODE1
            IF        OVRCD<>1
              WRITE     HTMLFILE;TDESC;
            ELSE
              WRITE     HTMLFILE;SP20;
            ENDIF
          ELSE
            OPEN      PATCMCA1,"patcmcaf"
            PACK      KEY9,PMFSTHIT,SP70
            CALL      RDPTCMC1
            IF        OVRCD<>1
              WRITE     HTMLFILE;PTCACODE,PTCADES1;
            ELSE
              WRITE     HTMLFILE;"Inlier/Outlier Charges";
            ENDIF
          ENDIF
GBTYP999  RETURN
+
.---------------------------------------------------------------------
. Get GST Total
. SJOG IFC and Fees Estimate has Total Item GST and Accommodation GST
.---------------------------------------------------------------------
GTGST000  MOVE      ZERO,ITGSTTOT          * Item GST
          MOVE      ZERO,ACGSTTOT          * Accommodation GST for SJOG IFC
          MOVE      ZERO,ITPATGST
          MOVE      ZERO,ITFNDGST
          MOVE      ZERO,ACPATGST
          MOVE      ZERO,ACFNDGST
.
          MOVE      ZERO,FORM5P2
          PACK      KEY17,PMFDQUOT,SP20
          CALL      RSPMFES1
GTGST100  CALL      RKPMFES1
          BRANCH    OVRCD,GTGST999
.
          MATCH     PMFDQUOT,PMFSQUOT
          GOTO      GTGST999 IF NOT EQUAL
.
.     SJOG Fees Estimate has same layout as their IFC
.
          MATCH     "2",PTCNIFCL
          GOTO      GTGST200 IF EQUAL
.
          MATCH     "1",PTCNIFCL
          GOTO      GTGST400 IF NOT EQUAL
.
          MATCH     "PATWEB76",PRGID
          GOTO      GTGST400 IF EQUAL          * Fees Estimate
.
GTGST200  IF        PMFSRTYP=2
            IF        PMFSDAFR=0
              MOVE      PMFSGSTA,ACGSTTOT                * Accom.GST
            ELSE
              ASSIGN    (PMFSDAFR*PMFSGSTA),ACGSTTOT     * LOS x gst amount
            ENDIF
.
            MATCH     "2",PTCNIFCL
            GOTO      GTGST400 IF NOT EQUAL
.
            MATCH     "1",PMFSGSTP
            GOTO      GTGST100 IF NOT EQUAL              * GST Not applicable
.
.         Workout GST of Patient and Health fund portion
.
            MOVE      PMFSGSTC,KEY6
            CALL      AGST0000
            MOVE      PMFSDAHF,FORM12P2                  * fund rebate
            MULT      IBGEAMNT,FORM12P2
            DIV       "100.00",FORM12P2
            ADD       FORM12P2,ACFNDGST                  * fund GST total
.
            MOVE      PMFSGSTA,FORM12P2                  * total GST
            SUB       ACFNDGST,FORM12P2                  * subtract fund GST
            IF        PMFSDAFR<>0
              MULT      PMFSDAFR,FORM12P2
            ENDIF
            ADD       FORM12P2,ACPATGST                  * Patient GST
          ENDIF
.
.     -  Record type 5 for Theatre and  8 for Misc. 
.
          IF        (PMFSRTYP=5 | PMFSRTYP=8)
            ASSIGN    (PMFSQUAN*PMFSGSTA),FORM5P2        * quant x gst amount
            ADD       FORM5P2,ITGSTTOT                   * Item GST
.
            MATCH     "2",PTCNIFCL
            GOTO      GTGST100 IF NOT EQUAL
.
            MATCH     "1",PMFSGSTP
            GOTO      GTGST100 IF NOT EQUAL              * GST Not applicable
.
.         Workout GST of Patient and Health fund portion 
.
            MOVE      PMFSGSTC,KEY6
            CALL      AGST0000
.
            COMPARE   FIVE,PMFSRTYP
            GOTO      GTGST300 IF NOT EQUAL
.
            BRANCH    SELFINSR,GTGST300                    * uninsured
.
.         Record type 5 for MBS - HF rebate portion for Insured
.
            IF        PMFSTHEH<>0
              MOVE      PMFSTHEH,FORM12P2                  * fund rebate
              IF        PMFSQUAN>0
                MULT      PMFSQUAN,FORM12P2                * quantity
              ENDIF
              MULT      IBGEAMNT,FORM12P2
              DIV       "100.00",FORM12P2
              ADD       FORM12P2,ITFNDGST                  * fund GST total
            ENDIF
            GOTO       GTGST100
.
GTGST300    MOVE      PMFSGSTA,FORM12P2                  * total GST
            IF        PMFSQUAN>0
              MULT      PMFSQUAN,FORM12P2                * quantity
            ENDIF
            ADD       FORM12P2,ITPATGST                  * Patient GST
          ENDIF
.
          GOTO      GTGST100
.
.>>>> lumpsum
.
GTGST400  IF        PMFSRTYP=1
            ADD       PMFSGSTA,ITGSTTOT
          ENDIF
.
.>>>> daily charge
          IF        PMFSRTYP=2           
            IF        PMFDNONS=0
              MATCH     PMFSBTYP,PMFDBDTY
              IF        @EQUAL
                MOVE      PMFSGSTA,FORM5P2                 * sameday gst
                ADD       FORM5P2,ITGSTTOT
              ELSE
                ASSIGN    (PMFSDAFR*PMFSGSTA),FORM5P2      * LOS x gst amount
                ADD       FORM5P2,ITGSTTOT
              ENDIF
              GOTO      GTGST100
            ENDIF
            ASSIGN    (PMFSDAFR*PMFSGSTA),FORM5P2          * LOS x gst amount
            ADD       FORM5P2,ITGSTTOT
          ENDIF
.
.>>>> theatre/misc.charge
.
          IF        (PMFSRTYP=3 | PMFSRTYP=6)
            ASSIGN    (PMFSQUAN*PMFSGSTA),FORM5P2          * quant x gst amount
            ADD       FORM5P2,ITGSTTOT
          ENDIF
.
          GOTO      GTGST100
.
GTGST999  RETURN
+
.------------------------------------------------------------
. Get Quote number from Fees Estimate link table
.------------------------------------------------------------
GQTE0000  MOVE      ZERO,FESTFLAG
          PACK      KEY20,ADMISSNO,SP70
          CALL      RSPMAEL1
          CALL      RKPMAEL1
          BRANCH    OVRCD,GQTE9000
.
          MATCH     ADMISSNO,PMAEVISN
          GOTO      GQTE9000 IF NOT EQUAL
.
          MOVE      ONE,FESTFLAG
          PACK      PMFDQUOT,PMAEQUOT,SP70
          PACK      KEY12,PMFDQUOT,SP70
          CALL      RDPMFED1
          GOTO      GQTE9999
.
GQTE9000  CALL      CLRAEL00
.
GQTE9999  RETURN
+
