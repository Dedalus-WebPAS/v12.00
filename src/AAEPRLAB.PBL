.******************************************************************************
.* System  : Accident & Emergency                                             *
.* Include : AAEPRLAB.PBL                                                     *
.* Desc    : Print Labels Include                                             *
.******************************************************************************
.* Mods    :                                                                  *
.*          V10.07.01 19/11/2015  Steve Armstrong  CAR 321458                 *
.*                    Mods to make the print quantity for STV zebra wrist band*
.*                    labels hard-coded to "1" (so that the PR script handles *
.*                    the number of labels being printed).                    *
.******************************************************************************
.*          V10.06.02 10/09/2015  Steve Armstrong  CAR 315321                 *
.*                    Mods to remove Marital Status and Religion fields from  *
.*                    STV PMI labels.                                         *
.*          V10.06.01 15/07/2015  Steve Armstrong  CAR 315999                 *
.*                    Mods to handle printing of Wrist Band Labels (Screen    *
.*                    "03") for STV Layout (25).                              *
.******************************************************************************
.*          V10.05.01 21/07/2014  Steve Armstrong  CAR 294204                 *
.*                    Added code to handle layout for SJOG Geelong            *
.*                    (AECNLABL = 10).                                        *
.*                    Also replaced HETYPLAB with AECNLABL.                   *
.******************************************************************************
.*          V10.03.01 10/10/2013  Steve Armstrong  CAR 288277                 *
.*                    Mods to add alternate PMI label format for STV Zebra    *
.*                    barcode labels.                                         *
.******************************************************************************
.*           V9.06.01 06/06/2006  Steve Armstrong  CAR 107577                 *
.*                    Changed the font size for U/R on STV labels from 35,38  *
.*                    30,25 and changed the horizontal position of the U/R    *
.*                    from 155 to 170.                                        *
.******************************************************************************
.*           V9.04.02 23/06/2005  Steve Armstrong  CAR 64477                  *
.*                    Mods for Ballarat label to use WLINEZ4 instead of       *
.*                    WLINE4D to print full staff name.                       *
.*                    Mods to use WLIN1BHS & WLIN2BHS (both 30 chars) for     *
.*                    presenting complaint instead of WLINE2D & WLINE3D (both *
.*                    35 chars).                                              *
.*           V9.04.01 12.04.2005 Ebon Clements CAR 58443                      *
.*                    Changed HETYPLAB = 4 to Ballarat from Hong Kong         *
.******************************************************************************
.*           V9.02.05 19.02.2004 Jill Habasque CAR 47526                      *
.*                    Mods for HWK layout 5                                   *
.*           V9.02.03 10.06.2002 Bronko sosic                                 *
.*                    Added Second Address Line for St Vincent's              *
.*           V9.02.02 03/11/2001  Tonii                                       *
.*                    Fixed printing of St Vincent labels, batch printing now *
.*                    faster, moved "0" to NOCOPIES after print job           *
.*           V9.02.01 13/08/2001  Tonii                                       *
.*                    Added new layout 9, for St Vincent's label              *
.******************************************************************************
.*           V5.07.01 18/10/1999  Caleb Sharman                               *
.*                    Recompiled for DXAAEDET                                 *
.*           V5.05.01 14/10/1997  Steve Armstrong                             *
.*                    Mods for Wrist Band Labels                              *
.******************************************************************************
.*           V5.01    06/04/89 J.Tan                                          *
.*                    Mods to print the line6 (Epworth). SRF5793              *
.*           V5.02    18/04/89 J.Tan  SRF100232                               *
.*                    Allow blank lines at start & end of label(Epworth)      *
.*           V5.03    19/04/89 J.Clark SRF100232                              *
.*                    Allow further blank lines at start & end of label (Epw) *
.*           V5.04    20/04/89 K.Peak                                         *
.*                    Fixed lineup on labels for Epworth  SRF  100252         *
.*           V5.05    10/01/90 K.Peak                                         *
.*                    Added the choice to print additional blank labels       *
.*           V5.01.01 22/03/90  E.Phan  Quote 6650                            *
.*                    Did actual formatting of Southland/New Zealand Labels.  *
.*                    Note that HELSIZE is not used in this option.           *
.*        V5.01.02  05/11/1992    Justin Coates  (HONG KONG changes)          *
.*                  added label type 4 - Hong Kong                            *
.*        V5.01.03  18/10/1993    Gabrielle         (Hawkes Bay Changes)      *
.*                  added label type 5 - Hawkes Bay                           *
.*        V5.01.04  26/05/1994    Rob Leonard  (Taranaki Mods)                *
.*                  added label type 6 - Taranaki                             *
.*        V5.01.05  15/08/1994    Rob Leonard   Taranaki Changes              *
.*                  Reduce space between labels                               *
.*        V5.01.06  03/11/1994    Rob Leonard                                 *
.*                  Added label type 7 - Port Macquarie                       *
.*        V5.03.01  27/07/1995  Greg Horvat                                   *
.*                  Added layout 8 - Mersey                                   *
.*        V5.04.01  03/02/1997  Howellsy                                      *
.*                  Added Screen Painted Labels                               *
.*                                                                            *
.******************************************************************************
.*        LINE-UP PRINT                                                       *
.******************************************************************************
.
AAELINUP  CALL      LINUPAAE
          DISPLAY   *P1:24,*EL,*P20:24,*V2LON:
                    " ** Generating Line-Up **";
          MOVE      LABCOS,NOLABEL
          CALL      AAEPRLAB
          RETURN
.
.******************************************************************************
.*        Actual Label Print                                                  *
.******************************************************************************
.
AAEPRLAB  MOVE      ZERO,ENDFLG
.
          COMPARE   TEN,AECNLABL
          GOTO      AAEPRLB1 IF EQUAL
.
          IF        AECNLABL <> 9 & AECNLABL<>5 & AECNLABL<>4
            PROC      LABELAAE
          ELSE
            MOVE      ONE,EXIT
          ENDIF
.
          COMPARE   ZERO,EXIT
          RETURN    IF EQUAL
.
AAEPRLB1  COMPARE   ONE,STOPQUE
          CALL      OPNPRINT IF NOT EQUAL
.
          COMPARE   TEN,AECNLABL
          GOTO      AAENXTLB IF EQUAL
.
          BRANCH    HELSIZE,SMALAB,WDALAB
.
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "*** Size of LABELS not SET.....Contact I.B.A ***",*W5;
          GOTO      ENDAAELB
.
SMALAB    MOVE      "37",TABPOS2        **** USING SMALL LABELS
          MOVE      "73",TABPOS3
          GOTO      AAENXTLB
.
WDALAB    MOVE      "42",TABPOS2        **** USING WIDE LABELS
          MOVE      "83",TABPOS3
.
.         Loop over the number of labels still to print
.
AAENXTLB  COMPARE   ZERO TO NOLABEL
          GOTO      ENDAAELB IF EQUAL
.
          COMPARE   NOLABEL TO LABCOS
          GOTO      AAECNTLB IF LESS
.
          MOVE      NOLABEL TO LABCOS       *** PRINT REMAINDER
.
AAECNTLB  BRANCH    AECNLABL,AAECNT01,AAECNT10,AELB3000,AELB4000,AELB5000:
                             AELB6000,AELB7000,AELB8000,AELB9000,SJOGED00
          GOTO      AAECNT10
.
.         Epworth
.
AAECNT01  PRINT     *N;       * Allow one blank line at the start of label
.
AAECNT10  BRANCH    LABCOS OF AAELAB1,AAELAB2,AAELAB3
          GOTO      ENDAAELB
.
.         1 label across page
.
AAELAB1   PRINT     *1,WFLINE1:
                    *N,WFLINE2,*N,WFLINE3:
                    *N,WFLINE4,*N,WFLINE5:
                    *N,WFLINE6
          SUB       ONE,NOLABEL
.
          COMPARE   ONE,AECNLABL
          GOTO      AAENXTLB IF NOT EQUAL
.
          PRINT     *N,*N;      * Epworth Allow two blank lines at end of label
          GOTO      AAENXTLB
.
.         2 labels across page
.
AAELAB2   PRINT     *1,WFLINE1,*TABPOS2,WFLINE1:
                    *N,WFLINE2,*TABPOS2,WFLINE2:
                    *N,WFLINE3,*TABPOS2,WFLINE3:
                    *N,WFLINE4,*TABPOS2,WFLINE4:
                    *N,WFLINE5,*TABPOS2,WFLINE5:
                    *N,WFLINE6,*TABPOS2,WFLINE6 
          SUB       TWO,NOLABEL
          COMPARE   ONE,AECNLABL
          GOTO      AAENXTLB IF NOT EQUAL
.
          PRINT     *N,*N;      * Epworth Allow two blank lines at end of label
          GOTO      AAENXTLB
.
.         3 labels across page
.
AAELAB3   PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,WFLINE1:
                    *N,WFLINE2,*TABPOS2,WFLINE2,*TABPOS3,WFLINE2:
                    *N,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WFLINE3:
                    *N,WFLINE4,*TABPOS2,WFLINE4,*TABPOS3,WFLINE4:
                    *N,WFLINE5,*TABPOS2,WFLINE5,*TABPOS3,WFLINE5:
                    *N,WFLINE6,*TABPOS2,WFLINE6,*TABPOS3,WFLINE6
          SUB       THREE,NOLABEL
          COMPARE   ONE,AECNLABL
          GOTO      AAENXTLB IF NOT EQUAL
.
          PRINT     *N,*N;      * Epworth Allow two blank lines at end of label
          GOTO      AAENXTLB
.
.*******************************************************************************
.*        New Zealand/Southland Label Format                                   *
.*******************************************************************************
AELB3000  BRANCH    LABCOS,AELB3100,AELB3200,AELB3300
          GOTO      ENDAAELB
.
. ------- 1 label across -------
.
AELB3100  PRINT     *1,WLINE1:
                    *N,WLINE2:
                    *N,WLINE3:
                    *N,WLINE4:
                    *N,WLINE5,*C,*F;
          SUB       ONE,NOLABEL
          GOTO      AAENXTLB
.
. ------- 2 labels across -------
.
AELB3200  PRINT     *1,WLINE1,*35,WLINE1:
                    *N,WLINE2,*35,WLINE2:
                    *N,WLINE3,*35,WLINE3:
                    *N,WLINE4,*35,WLINE4:
                    *N,WLINE5,*35,WLINE5,*C,*F;
          SUB       TWO,NOLABEL
          GOTO      AAENXTLB
.
. ------- 3 labels across -------
.
AELB3300  PRINT     *1,WLINE1,*35,WLINE1,*69,WLINE1:
                    *N,WLINE2,*35,WLINE2,*69,WLINE2:
                    *N,WLINE3,*35,WLINE3,*69,WLINE3:
                    *N,WLINE4,*35,WLINE4,*69,WLINE4:
                    *N,WLINE5,*35,WLINE5,*69,WLINE5,*C,*F;
          SUB       THREE,NOLABEL
          GOTO      AAENXTLB
.
.*******************************************************************************
.*        Ballarat Format
.*******************************************************************************
.*         Print the emergency label                                     
.*        ^XA - indicates start of new label                              
.*        ^PWa - print width (where a is the width in dots)               
.*               this is set to an arbitrary large number (100000) so     
.*               that the full label width will be used.                  
.*        ^FOx,y - field origin.                                          
.*               position on label where x = horizontal coordinate and    
.*               y = vertical coordinate (in dots).                       
.*        ^Afo,h,w - scalable font.                                       
.*               where f = font id, o = orientation (R = rotated 90deg),  
.*               h = character height (in dots), w = width (in dots).     
.*        ^FDa - Field data (where a is data to be printed)               
.*        ^FS - Field separator (indicates end of field data).            
.*        ^PQq - print quantity (where q is the quantity of labels reqd), 
.*        ^XZ - indicates end of label                                    
.*******************************************************************************
AELB4000  PRINT     CARET,ANSX,ANSA:
.
.                   set print width to maximum
.
                    CARET,ANSP,ANSW,ONE,ZERO,ZERO,ZERO,ZERO,ZERO:
.
.                   print visit date
.
                    CARET,ANSF,ANSO,FIVE,SIX,ZERO,COMMA,THREE,ZERO,ZERO:
                          CARET,ANSA,ZERO,ANSR,COMMA,THREE,THREE,COMMA:
                          THREE,TWO,CARET,ANSF,ANSD,WLINE1D,CARET,ANSF,ANSS:
.
.                   print triage code
.
                    CARET,ANSF,ANSO,FIVE,ONE,FIVE,COMMA,ONE,ZERO,FIVE:
                          CARET,ANSA,ZERO,ANSR,COMMA,THREE,SEVEN,COMMA:
                          THREE,EIGHT,CARET,ANSF,ANSD,"Triage Cat ",EMVITRIG:
                          CARET,ANSF,ANSS:
.
.                   print presenting complaint line 1
.
                    CARET,ANSF,ANSO,FOUR,ONE,ZERO,COMMA,SEVEN,ZERO:
                          CARET,ANSA,ZERO,ANSR,COMMA,THREE,NINE,COMMA:
                          FOUR,FOUR,CARET,ANSF,ANSD,WLIN1BHS,CARET,ANSF,ANSS:
.
.                   print presenting complaint line 2
.
                    CARET,ANSF,ANSO,THREE,SEVEN,ZERO,COMMA,SEVEN,ZERO:
                          CARET,ANSA,ZERO,ANSR,COMMA,THREE,NINE,COMMA:
                          FOUR,FOUR,CARET,ANSF,ANSD,WLIN2BHS,CARET,ANSF,ANSS:
.
.                   print staff name
.
                    CARET,ANSF,ANSO,TWO,FIVE,ZERO,COMMA,FIVE,ZERO:
                          CARET,ANSA,ZERO,ANSR,COMMA,THREE,THREE,COMMA:
                          THREE,SEVEN,CARET,ANSF,ANSD,"Staff Name : ":
                          WLINEZ4,CARET,ANSF,ANSS:
.
.                   set print quantity
.
                    CARET,ANSP,ANSQ,ZCOPY:
.
                    CARET,ANSX,ANSZ
.
          MOVE      ZERO,NOCOPIES
          GOTO      ENDAAELB
.
.*******************************************************************************
.         Hawkes Bay Format
.*******************************************************************************
AELB5000  BRANCH    LABCOS,AELB5100,AELB5200,AELB5300
          GOTO      ENDAAELB
.
AELB5100  PRINT     *1,WLINE1A
          PRINT     *1,WLINE2A
          PRINT     *1,WLINE3A
          PRINT     *1,WLINE4A
          PRINT     *N,*N;
          SUB       ONE,NOLABEL
          GOTO      AAENXTLB
.
AELB5200  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A
          PRINT     *1,WLINE2A,*TABPOS2,WLINE2A
          PRINT     *1,WLINE3A,*TABPOS2,WLINE3A
          PRINT     *1,WLINE4A,*TABPOS2,WLINE4A
          PRINT     *N,*N;
          SUB       TWO,NOLABEL
          GOTO      AAENXTLB
.
AELB5300  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A
          PRINT     *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A
          PRINT     *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A
          PRINT     *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A
          PRINT     *N,*N;
          SUB       THREE,NOLABEL
          GOTO      AAENXTLB
.
.*******************************************************************************
.         Taranaki Format
.*******************************************************************************
AELB6000  BRANCH    LABCOS,AELB6100,AELB6200,AELB6300
          GOTO      ENDAAELB
.
AELB6100  PRINT     *1,WLINE1A
          PRINT     *1,WLINE2A
          PRINT     *1,WLINE3A
          PRINT     *1,WLINE4A
          PRINT     *1,WLINE5A
          PRINT     *N;
          SUB       ONE,NOLABEL
          GOTO      AAENXTLB
.
AELB6200  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A
          PRINT     *1,WLINE2A,*TABPOS2,WLINE2A
          PRINT     *1,WLINE3A,*TABPOS2,WLINE3A
          PRINT     *1,WLINE4A,*TABPOS2,WLINE4A
          PRINT     *1,WLINE5A,*TABPOS2,WLINE5A
          PRINT     *N;
          SUB       TWO,NOLABEL
          GOTO      AAENXTLB
.
AELB6300  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A
          PRINT     *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A
          PRINT     *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A
          PRINT     *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A
          PRINT     *1,WLINE5A,*TABPOS2,WLINE5A,*TABPOS3,WLINE5A
          PRINT     *N;
          SUB       THREE,NOLABEL
          GOTO      AAENXTLB
.
.*******************************************************************************
.         Port Macquarie Format
.*******************************************************************************
AELB7000  BRANCH    LABCOS,AELB7100,AELB7200,AELB7300
          GOTO      ENDAAELB
.
AELB7100  PRINT     *1,WLINE1,*1,WLINE1
          PRINT     *1,WLINE2,*1,WLINE2
          PRINT     *1,WLINE3
          PRINT     *1,WLINE4
          PRINT     *1,WLINE5
          PRINT     *1,WLINE6
          PRINT     *1,WLINE7
          PRINT     *1,WLINE8,*1,WLINE8
          PRINT     *N;
          SUB       ONE,NOLABEL
          GOTO      AAENXTLB
.
AELB7200  PRINT     *1,WLINE1,*1,WLINE1,*TABPOS2,WLINE1,*TABPOS2,WLINE1
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6
          PRINT     *1,WLINE7,*TABPOS2,WLINE7
          PRINT     *1,WLINE8,*1,WLINE8,*TABPOS2,WLINE8,*TABPOS2,WLINE8
          PRINT     *N;
          SUB       TWO,NOLABEL
          GOTO      AAENXTLB
.
AELB7300  PRINT     *1,WLINE1,*1,WLINE1,*TABPOS2,WLINE1,*TABPOS2,WLINE1:
                       *TABPOS3,WLINE1,*TABPOS3,WLINE1
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2:
                       *TABPOS3,WLINE2,*TABPOS3,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6,*TABPOS3,WLINE6
          PRINT     *1,WLINE7,*TABPOS2,WLINE7,*TABPOS3,WLINE7
          PRINT     *1,WLINE8,*1,WLINE8,*TABPOS2,WLINE8,*TABPOS2,WLINE8:
                       *TABPOS3,WLINE8,*TABPOS3,WLINE8
          PRINT     *N;
          SUB       THREE,NOLABEL
          GOTO      AAENXTLB
.
.******************************************************************************
.*                                 AELB8000                                   *
.*                            Print Mersey Labels                             *
.******************************************************************************
AELB8000  BRANCH    LABCOS,AELB8100,AELB8200,AELB8300
          GOTO      ENDAAELB
.
AELB8100  PRINT     *1,WLINE1,*1,WLINE1
          PRINT     *1,WLINE2,*1,WLINE2
          PRINT     *1,WLINE3
          PRINT     *1,WLINE4
          PRINT     *1,WLINE5
          PRINT     *1,WLINE6
          PRINT     *1,WLINE7
          PRINT     *1,WLINE8,*1,WLINE8
          PRINT     *N;
          SUB       ONE,NOLABEL
          GOTO      AAENXTLB
.
AELB8200  PRINT     *1,WLINE1,*1,WLINE1,*TABPOS2,WLINE1,*TABPOS2,WLINE1
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6
          PRINT     *1,WLINE7,*TABPOS2,WLINE7
          PRINT     *1,WLINE8,*1,WLINE8,*TABPOS2,WLINE8,*TABPOS2,WLINE8
          PRINT     *N;
          SUB       TWO,NOLABEL
          GOTO      AAENXTLB
.
AELB8300  PRINT     *1,WLINE1,*1,WLINE1,*TABPOS2,WLINE1,*TABPOS2,WLINE1:
                       *TABPOS3,WLINE1,*TABPOS3,WLINE1
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2:
                       *TABPOS3,WLINE2,*TABPOS3,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6,*TABPOS3,WLINE6
          PRINT     *1,WLINE7,*TABPOS2,WLINE7,*TABPOS3,WLINE7
          PRINT     *1,WLINE8,*1,WLINE8,*TABPOS2,WLINE8,*TABPOS2,WLINE8:
                       *TABPOS3,WLINE8,*TABPOS3,WLINE8
          PRINT     *N;
          SUB       THREE,NOLABEL
          GOTO      AAENXTLB
.
.****************************************************************************
.*        St Vincent Hospital Labels                                        *
.****************************************************************************
.
AELB9000  MATCH     "LABELEMR01",LABELTYP        * using main PMI label ?
          GOTO      AELB9050 IF EQUAL            * yes
.
          MATCH     "LABELEMR03",LABELTYP        * no - wrist band label ?
          GOTO      AELB9100 IF NOT EQUAL        * no - print alternate label
.
.         Print New Zebra Wrist Band Label
.
          PRINT     *1,ZXA:
                    *N,"^FT128,2675^A0,22,20",ZFD,WLINEZ2,ZFS:     * int. line
                    *N,"^FT035,2652^BY2,2^B3N,N,120,N",ZFD,WLINEZ2,ZFS: * b'code
                    *N,"^FT112,2500^A0B,55,70",ZFD,WLINEZ20,ZFS:   * surname
                    *N,"^FT182,2500^A0B,55,70",ZFD,WLINEZ21,ZFS:   * title/gname
                    *N,"^FT252,2500^A0B,55,70",ZFD,WLINEZ15,ZFS:   * ur/dob
                    *N,"^PQ",ONE:
                    *N,ZXZ
          GOTO      ENDAAELB
.
.         Print Zebra Standard PMI Label
.
AELB9050  PRINT     *1,ZXA:
                    *N,ZBARCOD,WLINEZ16:
                    *N,"^FO170,007^A0,30,25",ZFD,WLINEZ1,ZFS:
                    *N,"^FO001,037^A0,25,25",ZFD,WLINEZ2,ZFS:
                    *N,"^FO236,062^A0,18,18",ZFD,WLINEZ5,ZFS:
                    *N,"^FO250,060^A0,20,18",ZFD,WLINEZ7,ZFS:
                    *N,"^FO001,060^A0,25,25",ZFD,WLINEZ3,ZFS:
                    *N,"^FO220,042^A0,18,18",ZFD,WLINEZ4,ZFS:
                    *N,"^FO001,096^A0,18,18",ZFD,WLINEZ8,ZFS:
                    *N,"^FO220,096^A0,18,18",ZFD,WLINEZ14,ZFS:
                    *N,"^FO001,112^A0,18,18",ZFD,WLINEZ17,ZFS:
                    *N,"^FO001,128^A0,18,18",ZFD,WLINEZ9,ZFS:
                    *N,"^FO180,145^A0,20,18",ZFD,WLINEZ13,ZFS:
                    *N,"^FO001,150^A0,15,18",ZFD,WLINEZ11,ZFS:
                    *N,"^FO170,078^A0,20,18",ZFD,WLINEZ6,ZFS:
                    *N,"^PQ",ZCOPY:                    
                    *N,ZXZ
.
          MOVE      ZERO,NOCOPIES
          GOTO      ENDAAELB
.
.         Alternate PMI Label
.
AELB9100  PRINT     *1,ZXA:
                    *N,ZBARCOD,WLINEZ16:
                    *N,"^FO170,007^A0N,30,25",ZFD,WLINEZ1,ZFS:
                    *N,"^FO001,040^A0N,40,25",ZFD,WLINEZ2,ZFS:
                    *N,"^FO001,075^A0N,40,25",ZFD,WLINEZ3,ZFS:
                    *N,"^FO001,125^A0N,40,25",ZFD,WLINEZ6,ZFS:
                    *N,"^PQ",ZCOPY:
                    *N,ZXZ
.
          MOVE      ZERO,NOCOPIES
          GOTO      ENDAAELB
+
.****************************************************************************
.*        SJOG Geelong Labels                                               *
.****************************************************************************
.
SJOGED00  CALL      PRTSJOGL                * (in SJOGLABL)
.
          GOTO      ENDALB9
+
.
. ------- Finished printing -------
.
ENDAAELB  COMPARE   ONE,ENDFLG
          GOTO      ENDALB9 IF EQUAL
.
          COMPARE   ZERO,ADLABEL
          GOTO      ENDALB9 IF EQUAL     * no additional blank labels to print
          MOVE      HADDLAB,NOLABEL
          MOVE      HELPAGE,LABCOS
.
          PACK      WFLINE1,SP30,SP10
          PACK      WFLINE2,SP30,SP10
          PACK      WFLINE3,SP30,SP10
          PACK      WFLINE4,SP30,SP10
          PACK      WFLINE5,SP30,SP10
          PACK      WFLINE6,SP30,SP10
          PACK      WFLINE7,SP30,SP10
          PACK      WFLINE8,SP30,SP10
.
          PACK      WLINE1,SP30,SP10
          PACK      WLINE2,SP30,SP10
          PACK      WLINE3,SP30,SP10
          PACK      WLINE4,SP30,SP10
          PACK      WLINE5,SP30,SP10
          PACK      WLINE6,SP30,SP10
          PACK      WLINE7,SP30,SP10
          PACK      WLINE8,SP30,SP10
.
          MOVE      ONE,ENDFLG
          GOTO      AAENXTLB
.
ENDALB9   COMPARE   ONE,STOPQUE
          CALL      CLSPRINT IF NOT EQUAL
          RETURN
+
          INC       LABELAAE
