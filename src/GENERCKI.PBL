.----------------------------------------------------------------------
.   Program       : GENERCKI
.   CAR Number    : 233033
.   Modifications : 
.        V10.02.01  31/03/2011  Davin           CAR 233033
.           Added 'effective from date' to contract id keyword search
.        V10.01.00  17/12/2010  Davin S
.                   Created Conract ID keyword generation program
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.  data includes
.----------------------------------------------------------------------
.
          INC       STDGENDF
          INC       PMSCIDFD/INC
          INC       PMSCKIFD/INC
.
.----------------------------------------------------------------------
.  local variables
.----------------------------------------------------------------------
.
.
PRGID     INIT      "GENERCKI"
PRGNAM    INIT      "Fix pmsckiaf"
VERSION   INIT      "V12.00.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
.
.---- initialise screen and confirm desire to execute program ----
.
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P1:10,"This will generate Contract ID Keyword records."
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
.---- open files ----
.
          OPEN      PMSCIDA1,"pmscidaf"
          OPEN      PMSCKIA1,"pmsckiaf"
          OPEN      PMSCKIA2,"pmsckiaf"
.
.---- loop through pmscidaf ----
.
          MOVE      ZERO,SECTOR
.
          PACK      KEY6,SP70
ML1000    CALL      RSPMCID1           * read next record
ML1100    CALL      RKPMCID1
          BRANCH    OVRCD,ML9999
.
          ADD       ONE,SECTOR
          IF        SECTOR%100=1
            DISPLAY   *P1:24,*V2LON,SECTOR," - ",PMCICNTR,SP1,*EF;
          ENDIF
.
          PROC      PMSCKIUP
          GOTO      ML1100
.
.---- exit program ----
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
.  code includes
.----------------------------------------------------------------------
.
          INC       PMSCIDIO/INC
          INC       PMSCKIIO/INC
          INC       PMSCKIPR
          INC       STDGENCD
.
