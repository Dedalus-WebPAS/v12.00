.------------------------------------------------------------
. Operation Session File
.
. Inputs  -  Valid record from the oprsesaf
. Outputs -  Field specified by FLDITMNO & DIM127 for any parameters
.
.
. Modifications : 
.
. V11.03.01 03/03/2023  Ebon Clements      TSK 0909393
.           Added hospital to oprsesaf(1-6) and oprdetfa(1&5) indexes
. V11.01.02 03/09/2021  Davin         TSK 0900165
.           Allow zero for prep time (opses010/opseprep) in MOVSES00
. V11.01.01 21/04/2021  Ebon Clements TSK 0904815
.           Cross browser added ; to end of &nbsp OPRLST00
. V11.00.01 13/03/2020  Thanh T       TSK 0838262
.           Added OSES9100
. V10.14.01 28/03/2019  Peter Vela    TSK 0839663
.           Added tag for Session Clinic/Doctor
. V10.12.01 20/03/2018  Peter Vela    TSK 0842991
.           Added OVRCD validation for OSES7800
. V10.06.01 24/06/2015  Don Nguyen    CAR 318454
.           Added OPSES078 in MOVSES00
. V10.05.03 06/11/2014  Don Nguyen    CAR 304059
.           Added OSES8300-OSES8900. Added CLRDEF00.
. V10.05.02 02.09.2014 Ania P         CAR 298084
.           Added OSES7620
. V10.05.01 07.08.2014 Peter Vela     CAR 283302
.           Added OPSECNDT, OPSECNTM, OPSECNID
.  V9.12.01 14.12.2009 Ebon Clements  CAR 210196 
.           Determine first time in recovery DSTRT000 & DENDT000
.  V9.09.02 20.07.2007 Ebon Clements  CAR 145544 
.           Allow theatres with no hospital to be used 
.           by all hospitals/theatres - OPSL0000
.  V9.09.01 02.07.2007 Ebon Clements  CAR 144158 
.           Fixed hospital name tag - OSES7930
.  V9.08.01 28.09.2006 Ebon Clements  CAR 119991
.           Added OPSEHOSP
.  V9.04.04 05.09.2005 Ebon Clements  CAR 73209
.           Changed DSTRT000 and DENDT000 to use new 
.           parameters OPCNDSAS and OPCNDSAE
.  V9.04.03 06.06.2005 Ebon Clements  CAR 62543
.           Added tag 78 for OPCLDOCT - session doctor
.  V9.04.02 18.03.2005 Guomin Fu      CAR 59532
.           Fixed to update OPSEDCC2 with OPSEANAE when there is 
.           no OPSES033 painted on screen, i.e. OPSES033 is blank
.  V9.04.01 02.03.2005 Lina Vo        CAR 56404
.           Added new OPSEFIND & OPSEFINT Fields  
.  V9.03.03 04.08.2004 Lina Vo        CAR 52288
.           Fixed DSTRT000 and DENDT000 to calculate start and
.           end time for all booking status except Cancelled
.  V9.03.02 15.10.2003 Sylvek Litewka CAR 43963
.           Modified procedure OPSL0000 to exlude inactive
.           theatres from selection list.
.  V9.03.01 18.07.2003 Sylvek Litewka CAR 38345
.           Added processiong for new field OPSEDGSI.
.  V9.02.02 27.09.2002 Ebon Clements SRF 20551
.           Fixed description output by session status tag
.  V9.02.01 20.12.2001 Ashwin
.           Change Suspended word to overbooked
.  V9.02.00 30.10.2001 Raghu Surve - HPS 
.           Added tag to show "Suspended" status
.  V9.00.00 31.05.2001 Bronko Sosic
.           Added two new feilds OSES6600 OSES6700
.  V5.07.00 08.11.1999 Pat Dirito
.           Modifications for OPRWEB05
.           OPRWEBSR: used to differentiate between
.           OPRWEB01 & OPRWEB05                
.
.------------------------------------------------------------
OSES0000  BRANCH    FLDITMNO,OSES0100,OSES0200,OSES0300,OSES0400,OSES0500:
                             OSES0600,OSES0700,OSES0800,OSES0900,OSES1000:
                             OSES1100,OSES1200,OSES1300,OSES1400,OSES1500:
                             OSES1600,OSES1700,OSES1800,OSES1900,OSES2000:
                             OSES2100,OSES2200,OSES2300,OSES2400,OSES2500:
                             OSES2600,OSES2700,OSES2800,OSES2900,OSES3000:
                             OSES3100,OSES3200,OSES3300,OSES3400,OSES3500:
                             OSES3600,OSES3700,OSES3800,OSES3900,OSES4000:
                             OSES4100,OSES4200,OSES4300,OSES4400,OSES4500:
                             OSES4600,OSES4700,OSES4800,OSES4900,OSES5000:
                             OSES5100,OSES5200,OSES5300,OSES5400,OSES5500:
                             OSES5600,OSES5700,OSES5800,OSES5900,OSES6000:
                             OSES6100,OSES6200,OSES6300,OSES6400,OSES6500:
                             OSES6600,OSES6700:
.                                           * HPS code starts here
                             OSES6800,OSES6900,OSES7000,OSES7100,OSES7200:
                             OSES7300,OSES7400:
.                                           * HPS code ends here
                             OSES7500,OSES7600,OSES7700,OSES7800,OSES7900:
                             OSES8000,OSES8100,OSES8200,OSES8300,OSES8400:
                             OSES8500,OSES8600,OSES8700,OSES8800,OSES8900:
                             OSES9000,OSES9100
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OSES9999
.
OSES0100  PACK      SESSKEYS,OPSEHOSP,OPSEDATE,OPSETIME,OPSECLIN,SP70
          WRITE     HTMLFILE;SESSKEYS;
          GOTO      OSES9999
.
OSES0200  UNPACK    OPSEDATE,CCENT,CYEAR,CMON,CDAY
          MATCH     CMON,SP70               * HPS Added
          IF        !@EQUAL
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          ENDIF
          GOTO      OSES9999
.
OSES0300  WRITE     HTMLFILE;OPSETIME;
          GOTO      OSES9999
.
OSES0400  
          IF        OPCNCLSU=1
            MOVE      CLINCODE,DOCTCODE  * Using Doc & OPRWEB05
            CALL      DOCDET00
          ELSE
            MOVE      CLINCODE,KEY6      * Using Clinic File for Session
            CALL      RDOPCLI1
            MOVE      OPCLDOCT,DOCTCODE  * Using Clinic Code & OPRWEB05
            MOVE      SP70,DOCFNAME
            CALL      DOCDET00
            MATCH     SP70,DOCFNAME
            IF        @EQUAL
              WRITE     HTMLFILE;OPCLDESC;
            ENDIF
          ENDIF 
          GOTO      OSES9999
.
OSES0500  MOVE      NO,YESNO
          IF        OPSESUSP=1
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      OSES9999
.
OSES0600  LOAD      DAYNAM,OPSEDAY,MON,TUE,WED,THU,FRI,SAT,SUN
          WRITE     HTMLFILE;DAYNAM;
          GOTO      OSES9999
.
OSES0700  UNPACK    OPSEBOOK,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      OSES9999
.
OSES0800  WRITE     HTMLFILE;OPSEENDT;
          GOTO      OSES9999
.
OSES0900  WRITE     HTMLFILE;OPSEDURA;
          GOTO      OSES9999
.
OSES1000  WRITE     HTMLFILE;OPSEBRKT;
          GOTO      OSES9999
.
OSES1100  WRITE     HTMLFILE;OPSEPREP;
          GOTO      OSES9999
.
OSES1200  MOVE      "SP",CATEGORY
          MOVE      OPSETPER,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES1300  MOVE      "ST",CATEGORY
          MOVE      OPSETYPE,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES1400  CALL      OPRLST00       * Operating Room Selection List 
          GOTO      OSES9999
.
OSES1500  MOVE      OPSECORD,DOCTCODE
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES1600  PACK      DOCTCODE,OPSEANAE,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES1700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1 
          BRANCH    F1,OSES1720
.
          BRANCH    OPSESTAT,OSES1712,OSES1713
.
OSES1711  WRITE     HTMLFILE;"Cancelled";
          GOTO      OSES9999
.
OSES1712  WRITE     HTMLFILE;"Active - Booked";
          GOTO      OSES9999
.
OSES1713  WRITE     HTMLFILE;"Active - Extra Session";
          GOTO      OSES9999
.
OSES1720  WRITE     HTMLFILE;OPSESTAT;  * Code
          GOTO      OSES9999
.
.
OSES1800  WRITE     HTMLFILE;OPSETIMB;
          GOTO      OSES9999
.
OSES1900  WRITE     HTMLFILE;OPSEACTS;
          GOTO      OSES9999
.
OSES2000  WRITE     HTMLFILE;OPSEACTE;
          GOTO      OSES9999
.
OSES2100  WRITE     HTMLFILE;OPSEACTD;
          GOTO      OSES9999
.
OSES2200  MOVE      "OO",CATEGORY
          MOVE      OPSEOVER,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2300  MOVE      "OD",CATEGORY
          MOVE      OPSEDELA,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2400  MOVE      "OC",CATEGORY
          MOVE      OPSECANC,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2500  MOVE      "Q6",CATEGORY
          MOVE      OPSEUSR1,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2600  MOVE      "Q7",CATEGORY
          MOVE      OPSEUSR2,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2700  MOVE      "Q8",CATEGORY
          MOVE      OPSEUSR3,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2800  MOVE      "Q9",CATEGORY
          MOVE      OPSEUSR4,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES2900  MOVE      "OP",CATEGORY
          MOVE      OPSETYD1,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3000  MOVE      "OP",CATEGORY
          MOVE      OPSETYD2,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3100  MOVE      "OP",CATEGORY
          MOVE      OPSETYD3,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3200  MOVE      "OP",CATEGORY
          MOVE      OPSETYD4,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3300  MOVE      "OP",CATEGORY
          MOVE      OPSETYD5,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3400  MOVE      "OP",CATEGORY
          MOVE      OPSETYD6,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3500  MOVE      "OP",CATEGORY
          MOVE      OPSETYD7,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3600  MOVE      "OP",CATEGORY
          MOVE      OPSETYD8,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES3700  PACK      DOCTCODE,OPSEDCC1,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES3800  PACK      DOCTCODE,OPSEDCC2,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES3900  PACK      DOCTCODE,OPSEDCC3,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES4000  PACK      DOCTCODE,OPSEDCC4,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES4100  PACK      DOCTCODE,OPSEDCC5,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES4200  PACK      DOCTCODE,OPSEDCC6,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES4300  PACK      DOCTCODE,OPSEDCC7,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES4400  PACK      DOCTCODE,OPSEDCC8,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES4500  MOVE      "OS",CATEGORY
          MOVE      OPSELVD1,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES4600  MOVE      "OS",CATEGORY
          MOVE      OPSELVD2,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES4700  MOVE      "OS",CATEGORY
          MOVE      OPSELVD3,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES4800  MOVE      "OS",CATEGORY
          MOVE      OPSELVD4,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES4900  MOVE      "OS",CATEGORY
          MOVE      OPSELVD5,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5000  MOVE      "OS",CATEGORY
          MOVE      OPSELVD6,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5100  MOVE      "OS",CATEGORY
          MOVE      OPSELVD7,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5200  MOVE      "OS",CATEGORY
          MOVE      OPSELVD8,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5300  MOVE      "ON",CATEGORY
          MOVE      OPSETYN1,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5400  MOVE      "ON",CATEGORY
          MOVE      OPSETYN2,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5500  MOVE      "ON",CATEGORY
          MOVE      OPSETYN3,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5600  MOVE      "ON",CATEGORY
          MOVE      OPSETYN4,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5700  MOVE      "ON",CATEGORY
          MOVE      OPSETYN5,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5800  MOVE      "ON",CATEGORY
          MOVE      OPSETYN6,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES5900  PACK      NURSCODE,OPSENUC1,SP70
          CALL      NURDET00
          GOTO      OSES9999
.
OSES6000  PACK      NURSCODE,OPSENUC2,SP70
          CALL      NURDET00
          GOTO      OSES9999
.
OSES6100  PACK      NURSCODE,OPSENUC3,SP70
          CALL      NURDET00
          GOTO      OSES9999
.
OSES6200  PACK      NURSCODE,OPSENUC4,SP70
          CALL      NURDET00
          GOTO      OSES9999
.
OSES6300  PACK      NURSCODE,OPSENUC5,SP70
          CALL      NURDET00
          GOTO      OSES9999
.
OSES6400  PACK      NURSCODE,OPSENUC6,SP70
          CALL      NURDET00
          GOTO      OSES9999
.
OSES6500  PACK      DOCTCODE,OPSEXDOC,SP70
          CALL      DOCDET00
          GOTO      OSES9999
.
OSES6600  WRITE     HTMLFILE;OPSESPI1;  * Special Instructions 1
          GOTO      OSES9999
.
OSES6700  WRITE     HTMLFILE;OPSESPI2;  * Special Instructions 2
          GOTO      OSES9999
.
.                                           * HPS code starts here
OSES6800  WRITE     HTMLFILE;OPSENDLK;   * Number of Days to Lock
          GOTO      OSES9999
.
OSES6900  MOVE      "TU",CATEGORY
          MOVE      OPSESTYP,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES7000  UNPACK    OPSEACDS,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,CMON
          IF        !@EQUAL
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          ENDIF
          GOTO      OSES9999
.
OSES7100  UNPACK    OPSEACDE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,CMON
          IF        !@EQUAL
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          ENDIF
          GOTO      OSES9999
.
OSES7200  PACK      CURSESS,OPSEHOSP,OPSEDATE,OPSETIME,OPSECLIN,SP70
          CALL      DSTRT000
          WRITE     HTMLFILE;DEFLSTRT;
          GOTO      OSES9999
.
OSES7300  PACK      CURSESS,OPSEHOSP,OPSEDATE,OPSETIME,OPSECLIN,SP70
          CALL      DENDT000
          WRITE     HTMLFILE;CHOUR,":",CMIN;
          GOTO      OSES9999
.
OSES7400  IF        OPSESUSP=1
            WRITE     HTMLFILE;" - OVERBOOKED";
          ENDIF
          GOTO      OSES9999
.                                           * HPS code ends here
OSES7500  MOVE      "YD",CATEGORY
          MOVE      OPSEDGSI,CODE
          CALL      CODITM00
          GOTO      OSES9999
.
OSES7600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OSES7610,OSES7620
.
          MATCH     SP70,OPSEFIND
          GOTO      OSES9999 IF EQUAL
.
          UNPACK    OPSEFIND,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OSES9999
.
OSES7610  MATCH     SP70,OPSEFIND
          IF        @EQUAL
            WRITE     HTMLFILE;"Provisional";
          ELSE
            WRITE     HTMLFILE;"Finalised";
          ENDIF
          GOTO      OSES9999
.
OSES7620  WRITE     HTMLFILE;OPSEFIND;
          GOTO      OSES9999
.
OSES7700  WRITE     HTMLFILE;OPSEFINT;
          GOTO      OSES9999
.
OSES7800  MOVE      CLINCODE,KEY6      * Using Clinic File for Session
          CALL      RDOPCLI1
.         BRANCH    OVRCD,OSES9999
          IF        OVRCD=1
            UNPACK    DIM127,D1,KEY3,DIM127
            GOTO      OSES9999
          ENDIF
.
          MOVE      OPCLDOCT,DOCTCODE
          CALL      DOCDET00
.
          GOTO      OSES9999
.
OSES7900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          COMPARE   ONE,IBCNMHOS
          GOTO      OSES9999 IF NOT EQUAL
.
          BRANCH    F1,OSES7910,OSES7920,OSES7930
.
          PACK      KEY3,OPSEHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,OSES9999
.
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      OSES9999
.
OSES7910  WRITE     HTMLFILE;OPSEHOSP;
          GOTO      OSES9999
.
OSES7920  WRITE     HTMLFILE;"<tr><td class=DataLabel>Hospital</td>":
                             "<td><select name=opses074 title='Hospital' ":
                             "class=Mandatory onchange=GetOpr();>":
                             "<option></option>"
          MOVE      OPSEHOSP,DIM3
          CALL      SSEL0000
          WRITE     HTMLFILE;"</select></td></tr>";
          GOTO      OSES9999
.
OSES7930  PACK      KEY3,OPSEHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,OSES9999
.
          WRITE     HTMLFILE;"<tr><td class=DataLabel>Hospital</td>":
                             "<td><input type=text class=Readonly readonly":
                             " value=#"",PTHSNAME,"#"></td></tr>";
          GOTO      OSES9999
.
OSES8000  MATCH     OPSECNDT,SP70
          GOTO      OSES9999 IF EQUAL
          UNPACK    OPSECNDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      OSES9999
.
OSES8100  WRITE     HTMLFILE;OPSECNTM;
          GOTO      OSES9999
.
OSES8200  MATCH     SP70,OPSECNID
          GOTO      OSES9999 IF EQUAL
          PACK      KEY10,OPSECNID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      OPSECNID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      OSES9999
.
OSES8300  WRITE     HTMLFILE;OPSEDTCM;      * Default Team Completed
          GOTO      OSES9999
.
OSES8400  MATCH     SP70,OPSEUCDT           * User who Completed Default Team
          GOTO      OSES9999 IF EQUAL
          PACK      KEY10,OPSEUCDT,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      OPSEUCDT,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      OSES9999
.
OSES8500  MATCH     SP70,OPSEDCDT           * Date Default Team Completed
          GOTO      OSES9999 IF EQUAL
          UNPACK    OPSEDCDT,CCENT,CYEAR,CMON,CDAY
          WRITE     HTMLFILE;CDAY,SLASH,CMON,SLASH,CCENT,CYEAR;
          GOTO      OSES9999
.
OSES8600  MOVE      SP10,SHRTTIME
          UNPACK    OPSETCDT,SHRTTIME
          WRITE     HTMLFILE;SHRTTIME;          * Time Default Team Completed
          GOTO      OSES9999
.
OSES8700  MATCH     SP70,OPSEUUDT           * User who Updated Default Team
          GOTO      OSES9999 IF EQUAL
          PACK      KEY10,OPSEUUDT,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      OPSEUUDT,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      OSES9999
.
OSES8800  MATCH     SP70,OPSEDUDT           * Date Default Team Updated
          GOTO      OSES9999 IF EQUAL
          UNPACK    OPSEDUDT,CCENT,CYEAR,CMON,CDAY
          WRITE     HTMLFILE;CDAY,SLASH,CMON,SLASH,CCENT,CYEAR;
          GOTO      OSES9999
.
OSES8900  MOVE      SP10,SHRTTIME
          UNPACK    OPSETUDT,SHRTTIME
          WRITE     HTMLFILE;SHRTTIME;          * Time Default Team Updated
          GOTO      OSES9999
.
OSES9000  IF        OPCNCLSU=1
.
            MOVE      CLINCODE,DOCTCODE
            CALL      DOCDET00
.
          ELSE
.
            MOVE      CLINCODE,KEY6      * Using Clinic File for Session
            CALL      RDOPCLI1
.           BRANCH    OVRCD,OSES9999
            IF        OVRCD=1
              UNPACK    DIM127,D1,KEY3,DIM127
              GOTO      OSES9999
            ENDIF
.
            MOVE      OPCLDOCT,DOCTCODE
            CALL      DOCDET00
.
          ENDIF
.
          GOTO      OSES9999
.
OSES9100  WRITE     HTMLFILE;OPSEDATE;
          GOTO      OSES9999
.
OSES9999  RETURN
.
.------------------------------------------------------------
. Hospital Selection
.------------------------------------------------------------
SSEL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
SSEL0100  CALL      RKPTHSP1
          BRANCH    OVRCD,SSEL9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
          MATCH     DIM3,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      SSEL0100
.
SSEL9999  RETURN
.------------------------------------------------------------
. Operating Room Clinic Details
.
.  Parameters    DOCTCODE
.
.  Tag Parameter 0=Description
.                1=Code
.------------------------------------------------------------
CLIDET00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MATCH     SP70,DOCTCODE
          GOTO      CLIDET99 IF EQUAL
          BRANCH    F1,CLIDET10
          MOVE      DOCTCODE,KEY6
          CALL      RDOPCLI1
          IF        OVRCD=0
            CLEAR     DISPNAME
            MOVE      OPCLDESC,NAME35
            CALL      NAMSTR00
            RESET     DISPNAME
            WRITE     HTMLFILE;DISPNAME;
          ENDIF
          GOTO      CLIDET99
.
CLIDET10  WRITE     HTMLFILE;OPCLCLIN;
CLIDET99  RETURN
.------------------------------------------------------------
. Operating Room/Theatre Selection List
.       0 = Description
.       1 = Code
.       2 = Selection List         
.------------------------------------------------------------
OPRLST00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          PACK      KEY6,OPSETHET,SP70
          CALL      RDOPOPR1
          IF        OVRCD=1
            IF        F1=0
              WRITE     HTMLFILE;"&nbsp;";   * Output Blank Description
              GOTO      OPRLST99
            ELSE
              GOTO      OPRLST20
            ENDIF
          ENDIF
.
          BRANCH    F1,OPRLST10,OPRLST20
.
          CLEAR     DISPNAME
          PACK      NAME35,OPRMDESC,SP70    * 0 = Description
          CALL      NAMSTR00             * Formatted
          RESET     DISPNAME
          MOVE      DISPNAME,KEY30
          WRITE     HTMLFILE;KEY30;
          GOTO      OPRLST99
.
OPRLST10  WRITE     HTMLFILE;OPRMROOM;
          GOTO      OPRLST99
.
OPRLST20  CALL      OPSL0000
.
OPRLST99  RETURN
.------------------------------------------------------------
. Operating Room/Theatre Code Selection
.------------------------------------------------------------
OPSL0000  PACK      KEY6,SP70
          CALL      RSOPOPR1
OPSL0100  CALL      RKOPOPR1
          BRANCH    OVRCD,OPSL9999
.
          COMPARE   ONE,OPRMSTAT            * Is theatre inactive?
          GOTO      OPSL0100 IF EQUAL       * Yes, do not display
.
          MOVE      OPRMDESC,KEY35
          PACK      KEY8,QUOTE,OPRMROOM,QUOTE
          MATCH     OPSETHET,OPRMROOM
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               KEY35,"</option>"
          ELSE
            IF        IBCNMHOS=1
              MATCH     SP70,OPRMHOSP
              IF        !@EQUAL
                MATCH     OPSEHOSP,OPRMHOSP
                GOTO      OPSL0100 IF NOT EQUAL
              ENDIF
            ENDIF
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY35,"</option>"
          ENDIF
          GOTO      OPSL0100
.
OPSL9999  RETURN
.
.*********************************************************************
.*                  DSTRT000                    Called by : KACTS000 *
.*        Obtain the default start time of the session               *
.*        using the first case. If time X is blank                   *
.*        default the session start time.                            *
.*        Returns : DEFLSTRT      the default start time             *
.*                  EXPSTART      maximum start time allowed (if one)*
.*********************************************************************
DSTRT000  MOVE      SP70,DEFLSTRT           * the default start time
          MOVE      SP70,EXPSTART           * no maximum start time
.
          PACK      KEY26,CURSESS,SP2,ONE,SP70  * get first booked case
          CALL      RSOPDEA5                * read details file
DSTRT010  CALL      RKOPDEA5                * read details file
          BRANCH    OVRCD,DSTRT800          * no cases for the session
.
          PACK      KEY22,OPDAHOSP,OPDADATE,OPDATIME,OPDACLIN
          MATCH     KEY22,CURSESS
          GOTO      DSTRT800 IF NOT EQUAL
         
          COMPARE   THREE,OPDASTAT          * skip cancelled booking status
          GOTO      DSTRT010 IF EQUAL
.
          MATCH     "15",OPCNDSAS
          GOTO      DSTRT800 IF EQUAL       * use session start time
.
          MOVE      ZERO,FORM2
          MOVE      OPCNDSAS,FORM2          * the time to use
.
          BRANCH    FORM2,DSTRT050,DSTRT050,DSTRT050,DSTRT050:
                          DSTRT150,DSTRT150,DSTRT150,DSTRT050:
                          DSTRT150,DSTRT050,DSTRT050,DSTRT050:
                          DSTRT050,DSTRT050
.
          GOTO      DSTRT800
.
.         Using times from operation arrival and recovery file
.
DSTRT050  PACK      KEY10,OPDAUNIQ,SP70
          CALL      RDOPARD1
          BRANCH    OVRCD,DSTRT800
.
          MOVE      SP70,CTIMEIS
          LOAD      CTIMEIS,FORM2,OPARTCAL,OPARATIM,OPARANAP,OPARANAS:
                                  OPSGTIPS,OPSGTISS,OPSGTISE,OPARANAE:
                                  OPSGTIDR,OPARTIRF,OPARTIRB,OPARTIRD:
                                  OPARTIDP,OPARTETC
.
          IF        FORM2=10
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTIRB,CTIMEIS
            ENDIF
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTIRD,CTIMEIS
            ENDIF
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTICU,CTIMEIS
            ENDIF
          ENDIF
.
          IF        FORM2=11
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTIRD,CTIMEIS
            ENDIF
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTICU,CTIMEIS
            ENDIF
          ENDIF
.
          IF        FORM2=11
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTICU,CTIMEIS
            ENDIF
          ENDIF
.
          MATCH     SP70,CTIMEIS
          GOTO      DSTRT800 IF EQUAL       * no time, use exp start
.
          UNPACK    CTIMEIS,CHOUR,ANS,CMIN  * default to exp start time of case
          MOVE      CTIMEIS,DEFLSTRT        * the default start time
          MOVE      CTIMEIS,EXPSTART        * the latest possible start time
          GOTO      DSTRT999
.
.         Using times from operation surgical details file
.
DSTRT150  PACK      KEY11,OPDAUNIQ,SP1
          CALL      RSOPSRG1
DSTRT200  CALL      RKOPSRG1
          BRANCH    OVRCD,DSTRT800
.
          MATCH     OPDAUNIQ,OPSGUNID
          GOTO      DSTRT800 IF NOT EQUAL
.
          MOVE      SP70,CTIMEIS
          LOAD      CTIMEIS,FORM2,OPARTCAL,OPARATIM,OPARANAP,OPARANAS:
                               OPSGTIPS,OPSGTISS,OPSGTISE,OPARANAE:
                               OPSGTIDR,OPARTIRF,OPARTIRB,OPARTIRD:
                               OPARTIDP,OPARTETC
.
          MATCH     SP70,CTIMEIS
          GOTO      DSTRT200 IF EQUAL
.
          MATCH     SP70,EXPSTART
          IF        !@EQUAL
            MATCH     CTIMEIS,EXPSTART
            GOTO      DSTRT200 IF LESS
          ENDIF
.
          UNPACK    CTIMEIS,CHOUR,ANS,CMIN  * default to exp start time of case
          MOVE      CTIMEIS,DEFLSTRT        * set new default time
          MOVE      CTIMEIS,EXPSTART        * the latest possible start time
          GOTO      DSTRT200
.
.         no time in first case - use session start time
.
DSTRT800  MATCH     SP70,DEFLSTRT
          GOTO      DSTRT999 IF NOT EQUAL
.
          UNPACK    OPSETIME,CHOUR,ANS,CMIN * default to exp start time of sess
          MOVE      OPSETIME,DEFLSTRT       * the default start time
          MOVE      CTIMEIS,EXPSTART        * the latest possible start time
.
DSTRT999  RETURN
+
.*********************************************************************
.*                  DENDT000                    Called by : KACTE000 *
.*        Obtain the default end time of the session                 *
.*        using the last case. If time X is blank                    *
.*        default the session end time.                              *
.*        Returns : EXPEND        minimum end time                   *
.*                  CHOUR         default end time hour              *
.*                  CMIN          default end time min               *
.*********************************************************************
DENDT000  MOVE      SP70,EXPEND
.
          PACK      KEY26,CURSESS,Z70              
          CALL      RSOPDEA5                * position at end of session
DENDT010  CALL      RPOPDEA5                * get last record
          BRANCH    OVRCD,DENDT800          * no cases for the session
.
          PACK      KEY22,OPDAHOSP,OPDADATE,OPDATIME,OPDACLIN
          MATCH     KEY22,CURSESS
          GOTO      DENDT800 IF NOT EQUAL   * different session
.
          COMPARE   THREE,OPDASTAT          * skip cancelled booking status
          GOTO      DENDT010 IF EQUAL
.
          MATCH     "15",OPCNDSAE
          GOTO      DENDT800 IF EQUAL       * use session end time
.
          MOVE      ZERO,FORM2
          MOVE      OPCNDSAE,FORM2          * the time to use
.
          BRANCH    FORM2,DENDT050,DENDT050,DENDT050,DENDT050:
                          DENDT150,DENDT150,DENDT150,DENDT050:
                          DENDT150,DENDT050,DENDT050,DENDT050:
                          DENDT050,DENDT050
.
          GOTO      DENDT800
.
.         Using times from operation arrival and recovery file
.
DENDT050  PACK      KEY10,OPDAUNIQ,SP70
          CALL      RDOPARD1
          BRANCH    OVRCD,DENDT800
.
          MOVE      SP70,CTIMEIS
          LOAD      CTIMEIS,FORM2,OPARTCAL,OPARATIM,OPARANAP,OPARANAS:
                                  OPSGTIPS,OPSGTISS,OPSGTISE,OPARANAE:
                                  OPSGTIDR,OPARTIRF,OPARTIRB,OPARTIRD:
                                  OPARTIDP,OPARTETC
.
          IF        FORM2=10
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTIRB,CTIMEIS
            ENDIF
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTIRD,CTIMEIS
            ENDIF
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTICU,CTIMEIS
            ENDIF
          ENDIF
.         
          IF        FORM2=11
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTIRD,CTIMEIS
            ENDIF
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTICU,CTIMEIS
            ENDIF
          ENDIF
.
          IF        FORM2=11
            MATCH    SP70,CTIMEIS
            IF       @EQUAL
              MOVE     OPARTICU,CTIMEIS
            ENDIF
          ENDIF
.
          MATCH     SP70,CTIMEIS
          GOTO      DENDT800 IF EQUAL       * no time, use exp start
.
          UNPACK    CTIMEIS,CHOUR,ANS,CMIN  * default end time
          PACK      EXPEND,CHOUR,ANS,CMIN   * minimum end time
          GOTO      DENDT999
.
.         Using times from operation surgical details file
.
DENDT150  PACK      KEY11,OPDAUNIQ,SP1
          CALL      RSOPSRG1
DENDT200  CALL      RKOPSRG1
          BRANCH    OVRCD,DENDT800
.
          MATCH     OPDAUNIQ,OPSGUNID
          GOTO      DENDT800 IF NOT EQUAL
.
          MOVE      SP70,CTIMEIS
          LOAD      CTIMEIS,FORM2,OPARTCAL,OPARATIM,OPARANAP,OPARANAS:
                               OPSGTIPS,OPSGTISS,OPSGTISE,OPARANAE:
                               OPSGTIDR,OPARTIRF,OPARTIRB,OPARTIRD:
                               OPARTIDP,OPARTETC
.
          MATCH     SP70,CTIMEIS
          GOTO      DENDT200 IF EQUAL
.
          MATCH     SP70,EXPEND
          IF        !@EQUAL
            MATCH     EXPEND,CTIMEIS
            GOTO      DENDT200 IF LESS
          ENDIF
.
          UNPACK    CTIMEIS,CHOUR,ANS,CMIN  * default end time
          PACK      EXPEND,CHOUR,ANS,CMIN   * minimum end time
          GOTO      DENDT200
.
.         No end time in last case - use session end time
.
DENDT800  MATCH     SP70,EXPEND
          GOTO      DENDT9999 IF NOT EQUAL
.
          UNPACK    OPSEENDT,CHOUR,ANS,CMIN * default end time
          PACK      EXPEND,CHOUR,ANS,CMIN   * minimum end time
.
DENDT999  RETURN
.
.------------------------------------------------------------------------------
.       Move CGI Variables to File Variable for Updating Theatre Session File
.------------------------------------------------------------------------------
MOVSES00  MATCH     OPSES001,SP70
          IF        !@EQUAL
            MOVE      OPSES001,OPSEDATE
          ENDIF
          MATCH     OPSES002,SP70
          IF        !@EQUAL
            MOVE      OPSES002,OPSETIME
          ENDIF
          MATCH     OPSES003,SP70
          IF        !@EQUAL
            MOVE      OPSES003,OPSECLIN
          ENDIF
          MATCH     OPSES004,SP70
          IF        !@EQUAL
            MOVE      OPSES004,DOPSESUS
          ENDIF
          COMPARE   OPSES005,ZERO
          IF        !@EQUAL
            MOVE      OPSES005,OPSEDAY
          ENDIF
          MATCH     OPSES006,SP70
          IF        !@EQUAL
            MOVE      OPSES006,OPSEBOOK
          ENDIF
          MATCH     OPSES007,SP70
          IF        !@EQUAL
            MOVE      OPSES007,OPSEENDT
          ENDIF
          COMPARE   OPSES008,ZERO
          IF        !@EQUAL
            MOVE      OPSES008,OPSEDURA
          ENDIF
          COMPARE   OPSES009,ZERO
          IF        !@EQUAL
            MOVE      OPSES009,OPSEBRKT
          ENDIF
.0900165  COMPARE   OPSES010,ZERO
.0900165  IF        !@EQUAL
            MOVE      OPSES010,OPSEPREP
.0900165  ENDIF
          MATCH     OPSES011,SP70
          IF        !@EQUAL
            MOVE      OPSES011,OPSETPER
          ENDIF
          MATCH     OPSES012,SP70
          IF        !@EQUAL
            MOVE      OPSES012,OPSETYPE
          ENDIF
          MATCH     OPSES013,SP70
          IF        !@EQUAL
            MOVE      OPSES013,OPSETHET
          ENDIF
          MATCH     OPSES014,SP70
          IF        !@EQUAL
            MOVE      OPSES014,OPSECORD
          ENDIF
          MATCH     OPSES015,SP70
          IF        !@EQUAL
            MOVE      OPSES015,OPSEANAE
          ENDIF
          COMPARE   OPSES016,ZERO
          IF        !@EQUAL
            MOVE      OPSES016,OPSESTAT
          ENDIF
          COMPARE   OPSES017,ZERO
          IF        !@EQUAL
            MOVE      OPSES017,OPSETIMB
          ENDIF
          MATCH     OPSES018,SP70
          IF        !@EQUAL
            MOVE      OPSES018,OPSEACTS
          ENDIF
          MATCH     OPSES019,SP70
          IF        !@EQUAL
            MOVE      OPSES019,OPSEACTE
          ENDIF
          COMPARE   OPSES020,ZERO
          IF        !@EQUAL
            MOVE      OPSES020,OPSEACTD
          ENDIF
          MATCH     OPSES021,SP70
          IF        !@EQUAL
            MOVE      OPSES021,OPSEOVER
          ENDIF
          MATCH     OPSES022,SP70
          IF        !@EQUAL
            MOVE      OPSES022,OPSEDELA
          ENDIF
          MATCH     OPSES023,SP70
          IF        !@EQUAL
            MOVE      OPSES023,OPSECANC
          ENDIF
          MATCH     OPSES024,SP70
          IF        !@EQUAL
            MOVE      OPSES024,OPSETYD1
          ENDIF
          MATCH     OPSES025,SP70
          IF        !@EQUAL
            MOVE      OPSES025,OPSETYD2
          ENDIF
          MATCH     OPSES026,SP70
          IF        !@EQUAL
            MOVE      OPSES026,OPSETYD3
          ENDIF
          MATCH     OPSES027,SP70
          IF        !@EQUAL
            MOVE      OPSES027,OPSETYD4
          ENDIF
          MATCH     OPSES028,SP70
          IF        !@EQUAL
            MOVE      OPSES028,OPSETYD5
          ENDIF
          MATCH     OPSES029,SP70
          IF        !@EQUAL
            MOVE      OPSES029,OPSETYD6
          ENDIF
          MATCH     OPSES030,SP70
          IF        !@EQUAL
            MOVE      OPSES030,OPSETYD7
          ENDIF
          MATCH     OPSES031,SP70
          IF        !@EQUAL
            MOVE      OPSES031,OPSETYD8
          ENDIF
          MATCH     OPSES032,SP70
          IF        !@EQUAL
            MOVE      OPSES032,OPSEDCC1
          ENDIF
          MATCH     OPSES033,SP70
          IF        !@EQUAL
            MOVE      OPSES033,OPSEDCC2
          ELSE
            MOVE      OPSEANAE,OPSEDCC2      
          ENDIF
          MATCH     OPSES034,SP70
          IF        !@EQUAL
            MOVE      OPSES034,OPSEDCC3
          ENDIF
          MATCH     OPSES035,SP70
          IF        !@EQUAL
            MOVE      OPSES035,OPSEDCC4
          ENDIF
          MATCH     OPSES036,SP70
          IF        !@EQUAL
            MOVE      OPSES036,OPSEDCC5
          ENDIF
          MATCH     OPSES037,SP70
          IF        !@EQUAL
            MOVE      OPSES037,OPSEDCC6
          ENDIF
          MATCH     OPSES038,SP70
          IF        !@EQUAL
            MOVE      OPSES038,OPSEDCC7
          ENDIF
          MATCH     OPSES039,SP70
          IF        !@EQUAL
            MOVE      OPSES039,OPSEDCC8
          ENDIF
          MATCH     OPSES040,SP70
          IF        !@EQUAL
            MOVE      OPSES040,OPSELVD1
          ENDIF
          MATCH     OPSES041,SP70
          IF        !@EQUAL
            MOVE      OPSES041,OPSELVD2
          ENDIF
          MATCH     OPSES042,SP70
          IF        !@EQUAL
            MOVE      OPSES042,OPSELVD3
          ENDIF
          MATCH     OPSES043,SP70
          IF        !@EQUAL
            MOVE      OPSES043,OPSELVD4
          ENDIF
          MATCH     OPSES044,SP70
          IF        !@EQUAL
            MOVE      OPSES044,OPSELVD5
          ENDIF
          MATCH     OPSES045,SP70
          IF        !@EQUAL
            MOVE      OPSES045,OPSELVD6
          ENDIF
          MATCH     OPSES046,SP70
          IF        !@EQUAL
            MOVE      OPSES046,OPSELVD7
          ENDIF
          MATCH     OPSES047,SP70
          IF        !@EQUAL
            MOVE      OPSES047,OPSELVD8
          ENDIF
          MATCH     OPSES048,SP70
          IF        !@EQUAL
            MOVE      OPSES048,OPSETYN1
          ENDIF
          MATCH     OPSES049,SP70
          IF        !@EQUAL
            MOVE      OPSES049,OPSETYN2
          ENDIF
          MATCH     OPSES050,SP70
          IF        !@EQUAL
            MOVE      OPSES050,OPSETYN3
          ENDIF
          MATCH     OPSES051,SP70
          IF        !@EQUAL
            MOVE      OPSES051,OPSETYN4
          ENDIF
          MATCH     OPSES052,SP70
          IF        !@EQUAL
            MOVE      OPSES052,OPSETYN5
          ENDIF
          MATCH     OPSES053,SP70
          IF        !@EQUAL
            MOVE      OPSES053,OPSETYN6
          ENDIF
          MATCH     OPSES054,SP70
          IF        !@EQUAL
            MOVE      OPSES054,OPSENUC1
          ENDIF
          MATCH     OPSES055,SP70
          IF        !@EQUAL
            MOVE      OPSES055,OPSENUC2
          ENDIF
          MATCH     OPSES056,SP70
          IF        !@EQUAL
            MOVE      OPSES056,OPSENUC3
          ENDIF
          MATCH     OPSES057,SP70
          IF        !@EQUAL
            MOVE      OPSES057,OPSENUC4
          ENDIF
          MATCH     OPSES058,SP70
          IF        !@EQUAL
            MOVE      OPSES058,OPSENUC5
          ENDIF
          MATCH     OPSES059,SP70
          IF        !@EQUAL
            MOVE      OPSES059,OPSENUC6
          ENDIF         
          MATCH     OPSES060,SP70
          IF        !@EQUAL
            MOVE      OPSES060,OPSEUSR1
          ENDIF
          MATCH     OPSES061,SP70
          IF        !@EQUAL
            MOVE      OPSES061,OPSEUSR2
          ENDIF
          MATCH     OPSES062,SP70
          IF        !@EQUAL
            MOVE      OPSES062,OPSEUSR3
          ENDIF
          MATCH     OPSES063,SP70
          IF        !@EQUAL
            MOVE      OPSES063,OPSEUSR4
          ENDIF
          MATCH     OPSES064,SP70
          IF        !@EQUAL
            MOVE      OPSES064,OPSEXDOC
          ENDIF
          MATCH     OPSES065,SP70
          IF        !@EQUAL
            MOVE      OPSES065,OPSEACDS
          ENDIF
          MATCH     OPSES066,SP70
          IF        !@EQUAL
            MOVE      OPSES066,OPSEACDE
          ENDIF
          MATCH     OPSES067,SP70
          IF        !@EQUAL
            MOVE      OPSES067,OPSESPI1
          ENDIF
          MATCH     OPSES068,SP70
          IF        !@EQUAL
            MOVE      OPSES068,OPSESPI2
          ENDIF
          MATCH     OPSES069,SP70
          IF        !@EQUAL
            MOVE      OPSES069,OPSENDLK
          ENDIF
          MATCH     OPSES070,SP70
          IF        !@EQUAL
            MOVE      OPSES070,OPSESTYP
          ENDIF
.                                           * HPS Code Ends Here
          MATCH     OPSES071,SP70
          IF        !@EQUAL
            MOVE      OPSES071,OPSEDGSI
          ENDIF
          MATCH     OPSES074,SP70
          IF        !@EQUAL
            MOVE      OPSES074,OPSEHOSP
          ENDIF
          MATCH     OPSES075,SP70
          IF        !@EQUAL
            MOVE      OPSES075,OPSECNDT
          ENDIF
          MATCH     OPSES076,SP70
          IF        !@EQUAL
            MOVE      OPSES076,OPSECNTM
          ENDIF
          MATCH     OPSES077,SP70
          IF        !@EQUAL
            MOVE      OPSES077,OPSECNID
          ENDIF
          MATCH     OPSES078,SP70
          IF        !@EQUAL
            MOVE      OPSES078,OPSEDTCM
          ENDIF
.
MOVSES99  RETURN
+
.------------------------------------------------------------
.         Clear Default Team Completed fields
.------------------------------------------------------------
CLRDEF00  MOVE      ZERO,OPSEDTCM
          MOVE      SP70,OPSEUCDT
          MOVE      SP70,OPSEDCDT
          MOVE      SP70,OPSETCDT
          MOVE      SP70,OPSEUUDT
          MOVE      SP70,OPSEDUDT
          MOVE      SP70,OPSETUDT
.
CLRDEF99  RETURN
