. Modifications
.    V9.11.01 25/02/2009 Peter Vela    CAR 183976
.             Created Include
.
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
PMOS0000  BRANCH    FLDITMNO,PMOS0100,PMOS0200,PMOS0300,PMOS0400,PMOS0500:
                             PMOS0600,PMOS0700,PMOS0800,PMOS0900,PMOS1000:
                             PMOS1100,PMOS1200,PMOS1300,PMOS1400,PMOS1500:
                             PMOS1600,PMOS1700,PMOS1800,PMOS1900,PMOS2000:
                             PMOS2100,PMOS2200,PMOS2300,PMOS2400,PMOS2500:
                             PMOS2600,PMOS2700,PMOS2800,PMOS2900,PMOS3000:
                             PMOS3100,PMOS3200,PMOS3300,PMOS3400,PMOS3500:
                             PMOS3600,PMOS3700,PMOS3800,PMOS3900,PMOS4000:
                             PMOS4100,PMOS4200,PMOS4300,PMOS4400,PMOS4500

          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMOS9999
.
PMOS0100  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSVISN;
          GOTO      PMOS9999
.
PMOS0200  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCNTR;
          GOTO      PMOS9999
.
PMOS0300  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSSCNT;
          GOTO      PMOS9999
.
PMOS0400  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSRTYP;
          GOTO      PMOS9999
.
PMOS0500  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSITEM;
          GOTO      PMOS9999
.
PMOS0600  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSQUAN;
          GOTO      PMOS9999
.
PMOS0700  MOVE      "  1",KEY3
          CALL      ROES0000
          UNPACK    PMOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSPDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS0800  MOVE      "  1",KEY3
          CALL      ROES0000
          UNPACK    PMOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSCDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS0900  MOVE      "  1",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCTIM;
          GOTO      PMOS9999
.
PMOS1000  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSVISN;
          GOTO      PMOS9999
.
PMOS1100  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCNTR;
          GOTO      PMOS9999
.
PMOS1200  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSSCNT;
          GOTO      PMOS9999
.
PMOS1300  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSRTYP;
          GOTO      PMOS9999
.
PMOS1400  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSITEM;
          GOTO      PMOS9999
.
PMOS1500  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSQUAN;
          GOTO      PMOS9999
.
PMOS1600  MOVE      "  2",KEY3
          CALL      ROES0000
          UNPACK    PMOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSPDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS1700  MOVE      "  2",KEY3
          CALL      ROES0000
          UNPACK    PMOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSCDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS1800  MOVE      "  2",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCTIM;
          GOTO      PMOS9999
.
PMOS1900  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSVISN;
          GOTO      PMOS9999
.
PMOS2000  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCNTR;
          GOTO      PMOS9999
.
PMOS2100  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSSCNT;
          GOTO      PMOS9999
.
PMOS2200  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSRTYP;
          GOTO      PMOS9999
.
PMOS2300  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSITEM;
          GOTO      PMOS9999
.
PMOS2400  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSQUAN;
          GOTO      PMOS9999
.
PMOS2500  MOVE      "  3",KEY3
          CALL      ROES0000
          UNPACK    PMOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSPDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS2600  MOVE      "  3",KEY3
          CALL      ROES0000
          UNPACK    PMOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSCDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS2700  MOVE      "  3",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCTIM;
          GOTO      PMOS9999
.
PMOS2800  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSVISN;
          GOTO      PMOS9999
.
PMOS2900  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCNTR;
          GOTO      PMOS9999
.
PMOS3000  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSSCNT;
          GOTO      PMOS9999
.
PMOS3100  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSRTYP;
          GOTO      PMOS9999
.
PMOS3200  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSITEM;
          GOTO      PMOS9999
.
PMOS3300  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSQUAN;
          GOTO      PMOS9999
.
PMOS3400  MOVE      "  4",KEY3
          CALL      ROES0000
          UNPACK    PMOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSPDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS3500  MOVE      "  4",KEY3
          CALL      ROES0000
          UNPACK    PMOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSCDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS3600  MOVE      "  4",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCTIM;
          GOTO      PMOS9999
.
PMOS3700  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSVISN;
          GOTO      PMOS9999
.
PMOS3800  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCNTR;
          GOTO      PMOS9999
.
PMOS3900  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSSCNT;
          GOTO      PMOS9999
.
PMOS4000  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSRTYP;
          GOTO      PMOS9999
.
PMOS4100  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSITEM;
          GOTO      PMOS9999
.
PMOS4200  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSQUAN;
          GOTO      PMOS9999
.
PMOS4300  MOVE      "  5",KEY3
          CALL      ROES0000
          UNPACK    PMOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSPDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS4400  MOVE      "  5",KEY3
          CALL      ROES0000
          UNPACK    PMOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMOSCDTE
          GOTO      PMOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMOS9999
.
PMOS4500  MOVE      "  5",KEY3
          CALL      ROES0000
          WRITE     HTMLFILE;PMOSCTIM;
          GOTO      PMOS9999
.
PMOS9999  RETURN
.
.------------------------------------------------------------
.   Read pmsoesaf file with report counter input
.------------------------------------------------------------
ROES0000  PACK      KEY11,ADMISSNO,KEY3,SP70
          CALL      RDPMOES1
          IF        OVRCD=1
            CALL      CLPMSOES
          ENDIF
.
ROES9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for pmsoecaf file
.------------------------------------------------------------
SPMOS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY3A,KEY2,KEY3
          MOVE      KEY2,F2
          MOVE      KEY3,F3
          BRANCH    F3,SPMOS010,SPMOS020,SPMOS030,SPMOS040,SPMOS050:
                       SPMOS060,SPMOS070,SPMOS080,SPMOS090
.                      
          MOVE      ONE,EXIT
          GOTO      SPMOS999
.
SPMOS010  MOVE      QRYDATA,PMSOS001[F2]
          GOTO      SPMOS999
.
SPMOS020  MOVE      QRYDATA,PMSOS002[F2]
          GOTO      SPMOS999
.
SPMOS030  MOVE      QRYDATA,PMSOS003[F2]
          GOTO      SPMOS999
.
SPMOS040  MOVE      QRYDATA,PMSOS004[F2]
          GOTO      SPMOS999
.
SPMOS050  MOVE      QRYDATA,PMSOS005[F2]
          GOTO      SPMOS999
.
SPMOS060  MOVE      QRYDATA,PMSOS006[F2]
          GOTO      SPMOS999
.
SPMOS070  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSOS007[F2],CCENT,CYEAR,CMON,CDAY
          GOTO      SPMOS999
.
SPMOS080  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSOS008[F2],CCENT,CYEAR,CMON,CDAY
          GOTO      SPMOS999
.
SPMOS090  MOVE      QRYDATA,PMSOS009[F2]
          GOTO      SPMOS999
.
SPMOS999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters 
.------------------------------------------------------------
CPMOS000  MOVE      ONE,F2
.
          WHILE     F2 <= 50
            MOVE      Z70,PMSOC001[F2]
            MOVE      Z70,PMSOC002[F2]
            MOVE      Z70,PMSOC003[F2]
            MOVE      Z70,PMSOC004[F2]
            MOVE      Z70,PMSOC005[F2]
            MOVE      Z70,PMSOC006[F2]
            MOVE      Z70,PMSOC007[F2]
            MOVE      Z70,PMSOC008[F2]
            MOVE      Z70,PMSOC009[F2]
            ADD       ONE,F2
          DO
.
          RETURN
.
.------------------------------------------------------------
.  Update 
.------------------------------------------------------------
UPPMOS00  MATCH     PMSOS001[F2],Z70  
          IF        !@EQUAL
            MOVE      PMSOS001[F2],PMOSVISN
          ENDIF
.
          MATCH     PMSOS002[F2],Z70
          IF        !@EQUAL
            MOVE      PMSOS002[F2],PMOSCNTR
          ENDIF
.
          MATCH     PMSOS003[F2],Z70   
          IF        !@EQUAL
            MOVE      PMSOS003[F2],PMOSSCNT
          ENDIF
.
          MATCH     PMSOS004[F2],Z70
          IF        !@EQUAL
            MOVE      PMSOS004[F2],PMOSRTYP
          ENDIF
.
          MATCH     PMSOS005[F2],Z70
          IF        !@EQUAL
            MOVE      PMSOS005[F2],PMOSITEM
          ENDIF
.
          MATCH     PMSOS006[F2],Z70   
          IF        !@EQUAL
            MOVE      PMSOS006[F2],PMOSQUAN
          ENDIF
.
          MATCH     PMSOS007[F2],Z70
          IF        !@EQUAL
            MOVE      PMSOS007[F2],PMOSPDTE
          ENDIF
.
          MATCH     PMSOS008[F2],Z70
          IF        !@EQUAL
            MOVE      PMSOS008[F2],PMOSCDTE
          ENDIF
.
          MATCH     PMSOS009[F2],Z70
          IF        !@EQUAL
            MOVE      PMSOS009[F2],PMOSCTIM
          ENDIF
.
UPPMOS99  RETURN
+
