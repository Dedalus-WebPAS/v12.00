ESIPAA00  
          UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MATCH     SP70,CPCDATE
          IF        @EQUAL
            MOVE      "Not Printed",KEY11
          ELSE
            PACK      KEY11,CPCDATE,SP70
          ENDIF
          RETURN
.
ESIPAB00  MOVE      SIPASUP,KEY5
          CALL      RDAPMA1
          PACK      KEY50,SIPASUP,SP1,APMASN1
          RETURN
.
ESIPAC00  
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MATCH     SP70,CPCDATE
          IF        @EQUAL
            MOVE      "Not Input",KEY10
          ELSE
            PACK      KEY10,CPCDATE,SP70
          ENDIF
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINPOAKY
.   Routine   :   KSIPAA00 Keyin Purchase Order      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIPAA00 TOPIC     "SIPAPON "
          MOVE      UNDLN70,SIPAPON 
          KEYIN     *PCCOL:CVERT,*DV,SIPAPON:                                   
                    *PCCOL:CVERT,*V2LON,*JR,SIPAPON:                            
                    *PCCOL:CVERT,*DV,SIPAPON 
.
          ENDSET    SIPAPON 
          APPEND    SP70,SIPAPON 
          RESET     SIPAPON 
.
          MATCH     SP70,SIPAPON 
          GOTO      KSIPAA90 IF EQUAL
.
          ENDSET    SIPAPON 
          CMATCH    EXITCHAR,SIPAPON 
          GOTO      KSIPAA95 IF EQUAL
.
          CMATCH    QUEST,SIPAPON 
          GOTO      KSIPAA10 IF NOT EQUAL
.
          MOVE      CCOL,MYCOL
          MOVE      CVERT,MYVERT
          MOVE      CCITEM,SCCITEM
          CALL      HSIPAZ00
          MOVE      SCCITEM,CCITEM
          MOVE      MYCOL,CCOL
          MOVE      MYVERT,CVERT
.
          PACK      SIPAPON,SIPAPON,SP70
          MATCH     SP70,SIPAPON 
          GOTO      KSIPAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIPAPON                                 
KSIPAA10
          RESET     SIPAPON 
          PACK      KEY7,SIPAPON                                                
          CALL      RASIPA1 
          BRANCH    OVRCD,KSIPAA80
          BRANCH    CKEYTYP,KSIPAA75
          CALL      RDSIPA1 
KSIPAA70
          MOVE      ZERO,EXIT
          GOTO      KSIPAA99
KSIPAA75
          MOVE      "Purchase Order Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KSIPAA00
KSIPAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIPAA99,KSIPAA99
          MOVE      "Purchase Order Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KSIPAA00
KSIPAA90
          MOVE      ONE,EXIT
          GOTO      KSIPAA99
KSIPAA95
          MOVE      TWO,EXIT
KSIPAA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINPOAKY
.   Routine   :   HSIPAZ00 Purchase Order      
.   Return    :           
.-------------------------------------------------------------------------------
HSIPAZ00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3 | HTOP>18
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "20",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIPAZ04
          CALL      GSCRN000
          BRANCH    EXIT,HSIPAZ99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Order No."          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Date Input"       
.
          MOVE      STDCOL02,STDCOL03
          ADD       "12",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Date Printed"       
.
          MOVE      STDCOL03,STDCOL04
          ADD       "13",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Supplier"           
.
          MOVE      STDCOL04,STDCOL05
          ADD       "51",STDCOL05
.
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
          GOTO      HSIPAZ50
.
HSIPAZ08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
.
          IF        0=CSEARCH
            MOVE      SCHFLD01,SIPAPON
            PACK      KEY7,SIPAPON,SP70
            CALL      RSSIPA1
            CALL      RPSIPA1
          ENDIF
          IF        1=CSEARCH
            MOVE      Z70,SIPADPR
            MOVE      Z70,SIPAPON
            PACK      KEY15,SIPADPR,SIPAPON,SP70
            CALL      RSSIPA3
          ENDIF
          IF        2=CSEARCH
            MOVE      SCHFLD02,SIPADIN
            MOVE      SP70,SIPAPON
            PACK      KEY15,SIPADIN,SIPAPON,SP70
            CALL      RSSIPA4
          ENDIF
.
HSIPAZ10
          IF        0=CSEARCH
            CALL      RKSIPA1
            BRANCH    OVRCD,HSIPAZ15
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        1=CSEARCH
            CALL      RPSIPA3 
            BRANCH    OVRCD,HSIPAZ15
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        2=CSEARCH
            CALL      RKSIPA4 
            BRANCH    OVRCD,HSIPAZ15
            PACK      KEY15,SIPADIN,SIPAPON,SP70
          ENDIF
          CALL      HSIPAZ60
          BRANCH    OVRCD,HSIPAZ10
HSIPAZ12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIPAPON 
          CALL      ESIPAC00
          DISPLAY   *PSTDCOL02:STDROW,KEY10   
          CALL      ESIPAA00
          DISPLAY   *PSTDCOL03:STDROW,KEY11   
          CALL      ESIPAB00
          DISPLAY   *PSTDCOL04:STDROW,KEY50   
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIPAZ10 IF NOT EQUAL
HSIPAZ15
          UNPACK    SP70,SIPADIN,SIPADPR,SIPAPON
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIPAZ20
          CALL      HSCRI000
          BRANCH    EXIT,HSIPAZ30,HSIPAZ35,HSIPAZ40,HSIPAZ45,HSIPAZ04:
                              HSIPAZ91,HSIPAZ50
          GOTO      HSIPAZ92
HSIPAZ30
          IF        0=CSEARCH
            CALL      RKSIPA1
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
            CALL      RPSIPA1
          ENDIF
          IF        1=CSEARCH
            CALL      RPSIPA3 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
            CALL      RKSIPA3 
          ENDIF
          IF        2=CSEARCH
            CALL      RKSIPA4 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADIN,SIPAPON,SP70
            CALL      RPSIPA4 
          ENDIF
.
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAZ10
HSIPAZ35
          MOVE      ST1,KEY15
.
          IF        0=CSEARCH
            UNPACK    KEY15,KEY8,KEY7
            CALL      RDSIPA1
            CALL      RPSIPA1
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        1=CSEARCH
            CALL      RDSIPA3 
            CALL      RKSIPA3 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        2=CSEARCH
            CALL      RDSIPA4 
            CALL      RPSIPA4 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADIN,SIPAPON,SP70
          ENDIF
.
          MATCH     SP70,SIPAPON                                                
          GOTO      HSIPAZ85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIPAZ36
          IF        0=CSEARCH
            CALL      RPSIPA1
            BRANCH    OVRCD,HSIPAZ37
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        1=CSEARCH
            CALL      RKSIPA3 
            BRANCH    OVRCD,HSIPAZ37
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        2=CSEARCH
            CALL      RPSIPA4 
            BRANCH    OVRCD,HSIPAZ37
            PACK      KEY15,SIPADIN,SIPAPON,SP70
          ENDIF
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIPAZ36 IF NOT EQUAL
HSIPAZ37
          MOVE      ZERO,XITEMNO
          GOTO      HSIPAZ10
HSIPAZ40
          MOVE      ST1,KEY15
.
          IF        0=CSEARCH
            UNPACK    KEY15,KEY8,KEY7
            CALL      RDSIPA1
            CALL      RPSIPA1
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        1=CSEARCH
            CALL      RDSIPA3 
            CALL      RKSIPA3 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        2=CSEARCH
            CALL      RDSIPA4 
            CALL      RPSIPA4 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADIN,SIPAPON,SP70
          ENDIF
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAZ08
HSIPAZ45
          IF        0=CSEARCH
            CALL      RKSIPA1
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        1=CSEARCH
            CALL      RPSIPA3 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        2=CSEARCH
            CALL      RKSIPA4 
            BRANCH    OVRCD,HSIPAZ85
            PACK      KEY15,SIPADIN,SIPAPON,SP70
          ENDIF
.
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          IF        0=CSEARCH
            PACK      KEY7,Z70
            CALL      RSSIPA1
          ENDIF
          IF        1=CSEARCH
            PACK      KEY15,SP70
            CALL      RSSIPA3
          ENDIF
          IF        2=CSEARCH
            PACK      KEY15,Z70
            CALL      RSSIPA4
          ENDIF
.
HSIPAZ46
          IF        0=CSEARCH
            CALL      RPSIPA1
            BRANCH    OVRCD,HSIPAZ47
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        1=CSEARCH
            CALL      RKSIPA3 
            BRANCH    OVRCD,HSIPAZ47
            PACK      KEY15,SIPADPR,SIPAPON,SP70
          ENDIF
          IF        2=CSEARCH
            CALL      RPSIPA4 
            BRANCH    OVRCD,HSIPAZ47
            PACK      KEY15,SIPADIN,SIPAPON,SP70
          ENDIF
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIPAZ46 IF NOT EQUAL
HSIPAZ47
          MOVE      ZERO,XITEMNO
          GOTO      HSIPAZ10
HSIPAZ50  
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
.
          KEYIN     *PSTDCOL01:STDROW,*V2LON,*JR,KEY7:
                    *PSTDCOL01:STDROW,*DV,KEY7
          PACK      KEY7,KEY7,SP70
          MOVE      KEY7,SCHFLD01
          MATCH     SP70,SCHFLD01
          IF        @EQUAL
            MOVE      ONE,CSEARCH
          ELSE
            MOVE      ZERO,CSEARCH
          ENDIF
          PACK      KEY8,CCC,CYY,CMM,CDD
          REP       " 0",KEY8
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          MOVE      ONE,CCENTRY
          MOVE      ZERO,CDEFDTE
          MOVE      ONE,CCANLDTE
          MOVE      ZERO,CHIGHLT
.
          PACK      KEY4,CCOL,CVERT
          MOVE      STDCOL02,CCOL
          MOVE      STDROW,CVERT
          CALL      KEYDATE
          UNPACK    KEY4,ANS,ANS,KEY2
          MOVE      KEY4,CCOL
          MOVE      KEY2,CVERT
          IF        OVRCD=1
            PACK      SCHFLD02,SP70,SP70
            CLEAR     SCHFLD02
            MOVE      SP70,KEY10
          ELSE
            PACK      KEY8,CCENT,CYEAR,CMON,CDAY
            REP       " 0",KEY8
            MOVE      KEY8,SCHFLD02
            IF        CSEARCH<>0
              MOVE      TWO,CSEARCH
            ENDIF
            CALL      PACDATE
            MOVE      CPCDATE,KEY10
          ENDIF
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,KEY10
.
          PACK      KEY5,SP70
          KEYIN     *PSTDCOL04:STDROW,*V2LON,*JR,*ZF,KEY5:
                    *PSTDCOL04:STDROW,*DV,KEY5
          PACK      KEY5,KEY5,SP70
          MOVE      KEY5,SCHFLD04
.
          PACK      KEY5,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAZ08
.
.
HSIPAZ60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD02
          GOTO      HSIPAZ63 IF EQUAL
          MATCH     SCHFLD02,SIPADIN 
          GOTO      HSIPAZ72 IF LESS     
HSIPAZ63
          CALL      ESIPAB00
          MATCH     SP70,SCHFLD04
          GOTO      HSIPAZ64 IF EQUAL
          MATCH     SCHFLD04,KEY50   
          GOTO      HSIPAZ72 IF NOT EQUAL
HSIPAZ64
HSIPAZ65
HSIPAZ66
HSIPAZ67
HSIPAZ68
HSIPAZ69
HSIPAZ70
          GOTO      HSIPAZ75
HSIPAZ72  MOVE      ONE,OVRCD
HSIPAZ75  RETURN
HSIPAZ85
          LOAD      KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          IF        CSEARCH=2
            UNPACK    KEY15,SIPADIN,SIPAPON 
            CALL      RDSIPA4 
          ELSE
            UNPACK    KEY15,SIPADPR,SIPAPON
            CALL      RDSIPA3 
          ENDIF
HSIPAZ90
          UNPACK    SP70,SIPADIN,SIPADPR,SIPAPON
          BEEP
          GOTO      HSIPAZ20
HSIPAZ91
          MOVE      SP70,SIPASUP 
          MOVE      SP70,SIPAORI 
          MOVE      SP70,SIPAICN 
          MOVE      SP70,SIPASCN 
          MOVE      SP70,SIPADEL 
          MOVE      SP70,SIPAMES 
          MOVE      SP70,SIPADIN 
          MOVE      SP70,SIPADCN 
          MOVE      SP70,SIPADCM 
          MOVE      SP70,SIPACON 
          MOVE      SP70,SIPAIDP 
          MOVE      SP70,SIPAUR1 
          MOVE      SP70,SIPAUR2 
          MOVE      SP70,SIPAUD1 
          MOVE      SP70,SIPAUD2 
          MOVE      SP70,SIPAUC1 
          MOVE      SP70,SIPAUC2 
          MOVE      SP70,SIPAUY1 
          MOVE      SP70,SIPAUY2 
          MOVE      SP70,SIPASPA 
          MOVE      SP70,KEY15
          MOVE      SP70,SIPAPON 
          GOTO      HSIPAZ96
HSIPAZ92
          MOVE      SP70,KEY15
          MOVE      SP70,SIPAPON 
          LOAD      KEY15,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          IF        CSEARCH=2
            UNPACK    KEY15,SIPADIN,SIPAPON 
            CALL      RDSIPA4 
          ELSE
            UNPACK    KEY15,SIPADPR,SIPAPON
            CALL      RDSIPA3 
          ENDIF
HSIPAZ96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIPAZ99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINPOAKY
.   Routine   :   HSIPAA00 Purchase Order      
.   Return    :           
.-------------------------------------------------------------------------------
HSIPAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3 | HTOP>18
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "07",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIPAA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIPAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Order No."          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Date Input"         
.
          MOVE      STDCOL02,STDCOL03
          ADD       "13",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Date Printed"       
.
          MOVE      STDCOL03,STDCOL04
          ADD       "13",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Supplier"           
.
          MOVE      STDCOL04,STDCOL05
          ADD       "51",STDCOL05
HSIPAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIPAPON 
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          PACK      SAVKEY80,SIPADPR,SIPAPON,SP70                               
          SETLPTR   SAVKEY80,8                                                  
          CALL      RSSIPA3 
HSIPAA10
          CALL      RKSIPA3 
          BRANCH    OVRCD,HSIPAA15
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSIPAA12
          CALL      HSIPAA60
          BRANCH    OVRCD,HSIPAA10
HSIPAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIPAPON 
          CALL      ESIPAC00
          DISPLAY   *PSTDCOL02:STDROW,KEY10   
          CALL      ESIPAA00
          DISPLAY   *PSTDCOL03:STDROW,KEY11   
          CALL      ESIPAB00
          DISPLAY   *PSTDCOL04:STDROW,KEY50   
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIPAA10 IF NOT EQUAL
HSIPAA15
          UNPACK    SAVKEY80,SIPADPR,SIPAPON                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIPAA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIPAA30,HSIPAA35,HSIPAA40,HSIPAA45,HSIPAA04:
                              HSIPAA91,HSIPAA50
          GOTO      HSIPAA92
HSIPAA30
          CALL      RKSIPA3 
          BRANCH    OVRCD,HSIPAA85
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA85 IF NOT EQUAL                                       
          CALL      RPSIPA3 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAA10
HSIPAA35
          MOVE      ST1,KEY15
          CALL      RDSIPA3 
          CALL      RPSIPA3 
          BRANCH    OVRCD,HSIPAA85
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA85 IF NOT EQUAL                                       
          MATCH     SP70,SIPAPON                                                
          GOTO      HSIPAA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIPAA36
          CALL      RPSIPA3 
          BRANCH    OVRCD,HSIPAA37
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIPAA36 IF NOT EQUAL
HSIPAA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIPAA10
HSIPAA40
          MOVE      ST1,KEY15
          CALL      RDSIPA3 
          CALL      RPSIPA3 
          BRANCH    OVRCD,HSIPAA85
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAA08
HSIPAA45
          CALL      RKSIPA3 
          BRANCH    OVRCD,HSIPAA85
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY15,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIPA3 
HSIPAA46
          CALL      RPSIPA3 
          BRANCH    OVRCD,HSIPAA47
          PACK      KEY15,SIPADPR,SIPAPON,SP70                                  
          MATCH     SAVKEY80,KEY15                                              
          GOTO      HSIPAA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIPAA46 IF NOT EQUAL
HSIPAA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIPAA10
HSIPAA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIPAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAA08
HSIPAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIPAA08
HSIPAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIPAA61 IF EQUAL
          MATCH     SCHFLD01,SIPAPON 
          GOTO      HSIPAA72 IF NOT EQUAL
HSIPAA61
          CALL      ESIPAC00
          MATCH     SP70,SCHFLD02
          GOTO      HSIPAA62 IF EQUAL
          MATCH     SCHFLD02,KEY10   
          GOTO      HSIPAA72 IF NOT EQUAL
HSIPAA62
          CALL      ESIPAA00
          MATCH     SP70,SCHFLD03
          GOTO      HSIPAA63 IF EQUAL
          MATCH     SCHFLD03,KEY11   
          GOTO      HSIPAA72 IF NOT EQUAL
HSIPAA63
          CALL      ESIPAB00
          MATCH     SP70,SCHFLD04
          GOTO      HSIPAA64 IF EQUAL
          MATCH     SCHFLD04,KEY50   
          GOTO      HSIPAA72 IF NOT EQUAL
HSIPAA64
HSIPAA65
HSIPAA66
HSIPAA67
HSIPAA68
HSIPAA69
HSIPAA70
          GOTO      HSIPAA75
HSIPAA72  MOVE      ONE,OVRCD
HSIPAA75  RETURN
HSIPAA85
          LOAD      KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY15,SIPADPR,SIPAPON                                       
          CALL      RDSIPA3 
HSIPAA90
          UNPACK    SAVKEY80,SIPADPR,SIPAPON                                    
          BEEP
          GOTO      HSIPAA20
HSIPAA91
          MOVE      SP70,SIPASUP 
          MOVE      SP70,SIPAORI 
          MOVE      SP70,SIPAICN 
          MOVE      SP70,SIPASCN 
          MOVE      SP70,SIPADEL 
          MOVE      SP70,SIPAMES 
          MOVE      SP70,SIPADIN 
          MOVE      SP70,SIPADCN 
          MOVE      SP70,SIPADCM 
          MOVE      SP70,SIPACON 
          MOVE      SP70,SIPAIDP 
          MOVE      SP70,SIPAUR1 
          MOVE      SP70,SIPAUR2 
          MOVE      SP70,SIPAUD1 
          MOVE      SP70,SIPAUD2 
          MOVE      SP70,SIPAUC1 
          MOVE      SP70,SIPAUC2 
          MOVE      SP70,SIPAUY1 
          MOVE      SP70,SIPAUY2 
          MOVE      SP70,SIPACST 
          MOVE      SP70,SIPAWAR 
          MOVE      SP70,SIPASPA 
          MOVE      SP70,KEY15
          MOVE      SP70,SIPAPON 
          GOTO      HSIPAA96
HSIPAA92
          MOVE      SP70,KEY15
          MOVE      SP70,SIPAPON 
          LOAD      KEY15,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY15,SIPADPR,SIPAPON                                       
HSIPAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIPAA99
          RETURN
