.******************************************************************************
.* System         : Waiting Lists                                             *
.*                                                                            *
.* Include name   : WATCKSEC.PBL                                              *
.*                                                                            *
.* Function       : To see if user has security to look at a procedure        *
.*                                                                            *
.* Author         : Justin Coates           02/06/1993                        *
.*                                                                            *
.* Parameters     : WATTR1FD record                                           *
.*                  WTCNWLSC      Sector 37 Position 211                      *
.*                  WATSEAA1      this index must be open                     *
.*                  WATSEIA2      this index must be open                     *
.*                                                                            *
.* Returns        : EXIT = 1      not allowed to look at procedure            *
.*                  EXIT = 0          allowed to look at procedure            *
.*                                                                            *
.* Modifications  :                                                           *
.******************************************************************************
WATCKSEC  COMPARE   ONE,WTCNWLSC
          GOTO      CKSEC800 IF NOT EQUAL   * not using security
.
          PACK      KEY4,PASSCODE,SP4
          CALL      RDWTSEA1
          COMPARE   ZERO,OVRCD
          GOTO      CKSEC800 IF EQUAL       * allowed access to ALL
.
          PACK      KEY13,PASSCODE,WMDOCTOR,WMUNIT
          CALL      RDWTSEI2
          BRANCH    OVRCD,CKSEC900          * no access
.
CKSEC800  MOVE      ZERO,EXIT               * user has access
          GOTO      CKSEC999
.
CKSEC900  MOVE      ONE,EXIT                * user doesn't have access
.
CKSEC999  RETURN
..............................................................................
