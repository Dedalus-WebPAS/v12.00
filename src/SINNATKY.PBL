.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINNATKY
.   Routine   :   HSINAB00 By Catalog          
.   Return    :           
.---------------------------------------------------------------------------
HSINAB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "12",HTOP
            MOVE      "24",HBOT
            MOVE      "01",HLEF
            MOVE      "80",HRIG
          ENDIF
HSINAB04
          CALL      GSCRN000
          BRANCH    EXIT,HSINAB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Catalog"            
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 8",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Supply Unit"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "15",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL03,STDCOL04
          ADD       "60",STDCOL04
HSINAB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIICCAT 
          PACK      KEY12,SIWAWAR,SIICCAT
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      SAVKEY80,SIICSUP,SIICCAT,SIICSUT,SP70                       
          SETLPTR   SAVKEY80,5                                                  
          CALL      RSIEB000
HSINAB10
          CALL      RKIEB000
          BRANCH    OVRCD,HSINAB15
          PACK      KEY12,SIWAWAR,SIICCAT
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          CALL      ESINAA00
          BRANCH    CSEARCH,HSINAB12
          CALL      HSINAB60
          BRANCH    OVRCD,HSINAB10
HSINAB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          PACK      KEY39,KEY27,KEY12
          STORE     KEY39,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIICCAT 
          DISPLAY   *PSTDCOL02:STDROW,SIICSUT 
          DISPLAY   *PSTDCOL03:STDROW,SIIADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSINAB10 IF NOT EQUAL
HSINAB15
          UNPACK    SAVKEY80,SIICSUP,SIICCAT,SIICSUT                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSINAB20
          CALL      HSCRI000
          BRANCH    EXIT,HSINAB30,HSINAB35,HSINAB40,HSINAB45,HSINAB04:
                              HSINAB91,HSINAB50
          GOTO      HSINAB92
HSINAB30
          CALL      RKIEB000
          BRANCH    OVRCD,HSINAB85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          MATCH     SAVKEY80,KEY27                                              
          GOTO      HSINAB85 IF NOT EQUAL                                       
          CALL      RPIEB000
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAB10
HSINAB35
          UNPACK    ST1,KEY27,KEY12
          CALL      RDSIIC3 
          CALL      RDSIIE2 
          CALL      RPIEB000
          BRANCH    OVRCD,HSINAB85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT
          MATCH     SP70,SIICCAT                                                
          GOTO      HSINAB85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSINAB36
          CALL      RPIEB000
          BRANCH    OVRCD,HSINAB37
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSINAB36 IF NOT EQUAL
HSINAB37
          MOVE      ZERO,XITEMNO
          GOTO      HSINAB10
HSINAB40
          UNPACK    ST1,KEY27,KEY12
          CALL      RDSIIC3 
          CALL      RDSIIE2 
          CALL      RPIEB000
          BRANCH    OVRCD,HSINAB85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAB08
HSINAB45
          CALL      RKIEB000
          BRANCH    OVRCD,HSINAB85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY12,SIWAWAR,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSIEB000
HSINAB46
          CALL      RPIEB000
          BRANCH    OVRCD,HSINAB47
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSINAB46 IF NOT EQUAL
HSINAB47
          MOVE      ZERO,XITEMNO
          GOTO      HSINAB10
HSINAB50  COMPARE   ZERO,CSEARCH
          GOTO      HSINAB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
.
          MOVE      "63",SECTOR
          READ      CONTROLF,SECTOR;*67,INCOCATE
.
.---- keyin catalog code ----
.
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          IF        ZERO=INCOCATE
            KEYIN     *PSTDCOL01:STDROW,*V2LON,KEY7;
            PACK      KEY7,KEY7,SP70
          ELSE
HSINAB52    KEYIN     *PSTDCOL01:STDROW,*V2LON,*JR,KEY7;
            PACK      KEY7,KEY7,SP70
            MATCH     SP70,KEY7
            IF        !@EQUAL
              TYPE      KEY7
              IF        !@EQUAL
                BEEP
                GOTO      HSINAB52
              ENDIF
            ENDIF
          ENDIF
          PACK      SCHFLD01,KEY7
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,SCHFLD01;
.
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAB08
HSINAB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAB08
HSINAB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSINAB61 IF EQUAL
          MATCH     SCHFLD01,SIICCAT 
          GOTO      HSINAB72 IF NOT EQUAL
HSINAB61
HSINAB62
HSINAB63
HSINAB64
HSINAB65
HSINAB66
HSINAB67
HSINAB68
HSINAB69
HSINAB70
          GOTO      HSINAB75
HSINAB72  MOVE      ONE,OVRCD
HSINAB75  RETURN
HSINAB85
          LOAD      KEY39,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY39,KEY27,KEY12
          UNPACK    KEY27,SIICSUP,SIICCAT,SIICSUT                               
          CALL      RDSIIC3 
          CALL      RDSIIE2 
HSINAB90
          UNPACK    SAVKEY80,SIICSUP,SIICCAT,SIICSUT                            
          BEEP
          GOTO      HSINAB20
HSINAB91
          MOVE      ZERO,SIICCCT 
          MOVE      ZERO,SIICLCT 
          MOVE      ZERO,SIICLTM 
          MOVE      SP70,SIICPNO 
          MOVE      SP70,SIICPD1 
          MOVE      SP70,SIICPD2 
          MOVE      ZERO,SIICMAN 
          MOVE      ZERO,SIICAPO 
          MOVE      SP70,SIICUR1 
          MOVE      SP70,SIICUR2 
          MOVE      SP70,SIICUD1 
          MOVE      SP70,SIICUD2 
          MOVE      SP70,SIICUC1 
          MOVE      SP70,SIICUC2 
          MOVE      SP70,SIICUY1 
          MOVE      SP70,SIICUY2 
          MOVE      SP70,SIICSPA 
          MOVE      SP70,KEY27
          MOVE      SP70,SIICCAT 
          GOTO      HSINAB96
HSINAB92
          MOVE      SP70,KEY27
          MOVE      SP70,KEY12
          MOVE      SP70,SIICCAT 
          LOAD      KEY39,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY39,KEY27,KEY12
          UNPACK    KEY27,SIICSUP,SIICCAT,SIICSUT                               
          CALL      RDSIIC3 
          CALL      RDSIIE2 
HSINAB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSINAB99
          RETURN
.---------------------------------------------------------------------------
. Postional Read A
.---------------------------------------------------------------------------
RSIEB000  CALL      RSSIIE2      * Both Keys Have Been Packed
          CALL      RPSIIE2      * Both Keys Have Been Packed
          MOVE      SP70,SIIECAT
          CALL      RKSIIE2      * Both Keys Have Been Packed
          PACK      KEY27,SAVKEY80,SIIECAT,SP70
          CALL      RSSIIC3
.
RSIEB999  RETURN
.---------------------------------------------------------------------------
. Read Forward A
.---------------------------------------------------------------------------
RKIEB000  CALL      RKSIIC3
          BRANCH    OVRCD,RKIEB999
.
          MATCH     SAVKEY80,SIICSUP
          IF        !@EQUAL
            CALL      RKSIIE2
            BRANCH    OVRCD,RKIEB999
            MATCH     SIWAWAR,SIIEWAR
            IF        !@EQUAL
              MOVE      ONE,OVRCD
              GOTO      RKIEB999
            ENDIF
            PACK      KEY27,SAVKEY80,SIIECAT,SP70
            CALL      RSSIIC3
            GOTO      RKIEB000
          ENDIF
.
          MATCH     SIIECAT,SIICCAT
          IF        !@EQUAL
            CALL      RKSIIE2
            BRANCH    OVRCD,RKIEB999
            MATCH     SIWAWAR,SIIEWAR
            IF        !@EQUAL
              MOVE      ONE,OVRCD
              GOTO      RKIEB999
            ENDIF
            PACK      KEY27,SAVKEY80,SIIECAT,SP70
            CALL      RSSIIC3
            GOTO      RKIEB000
          ENDIF
.
RKIEB999  RETURN
.---------------------------------------------------------------------------
. Read Backward A
.---------------------------------------------------------------------------
RPIEB000  CALL      RPSIIC3
          BRANCH    OVRCD,RPIEB999
.
          MATCH     SAVKEY80,SIICSUP
          IF        !@EQUAL
            CALL      RPSIIE2
            BRANCH    OVRCD,RPIEB999
            MATCH     SIWAWAR,SIIEWAR
            IF        !@EQUAL
              MOVE      ONE,OVRCD
              GOTO      RPIEB999
            ENDIF
            PACK      KEY27,SAVKEY80,SIIECAT,Z70
            CALL      RSSIIC3
            GOTO      RPIEB000
          ENDIF
.
          MATCH     SIIECAT,SIICCAT
          IF        !@EQUAL
            CALL      RPSIIE2
            BRANCH    OVRCD,RPIEB999
            MATCH     SIWAWAR,SIIEWAR
            IF        !@EQUAL
              MOVE      ONE,OVRCD
              GOTO      RPIEB999
            ENDIF
            PACK      KEY27,SAVKEY80,SIIECAT,Z70
            CALL      RSSIIC3
            GOTO      RPIEB000
          ENDIF
.
RPIEB999  RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINNATKY
.   Routine   :   HSINAC00 By Catalog          
.   Return    :           
.---------------------------------------------------------------------------
HSINAC00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "12",HTOP
            MOVE      "24",HBOT
            MOVE      "01",HLEF
            MOVE      "80",HRIG
          ENDIF
HSINAC04
          CALL      GSCRN000
          BRANCH    EXIT,HSINAC99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Nato Code "
.
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Catalog"            
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 8",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Supply Unit"        
.
          MOVE      STDCOL03,STDCOL04
          ADD       "15",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL04,STDCOL05
          ADD       "49",STDCOL05
HSINAC08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIICCAT 
          MOVE      SP70,SINANAT 
          MOVE      ONE,FORM1
          PACK      KEY17,SP9,FORM1,SIICCAT  * To miss Spaces in positional read
          PACK      KEY12,SIWAWAR,SIICCAT
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      SAVKEY80,SIICSUP,SIICCAT,SIICSUT,SP70                       
          SETLPTR   SAVKEY80,5                                                  
          CALL      RSIEC000
HSINAC10
          CALL      RKIEC000
          BRANCH    OVRCD,HSINAC15
          PACK      KEY17,SINANAT,SINACAT
          PACK      KEY12,SIWAWAR,SIICCAT
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          CALL      ESINAA00
          BRANCH    CSEARCH,HSINAC12
          CALL      HSINAC60
          BRANCH    OVRCD,HSINAC10
HSINAC12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          PACK      KEY49,KEY27,KEY12,SINANAT
          STORE     KEY49,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SINANAT 
          DISPLAY   *PSTDCOL02:STDROW,SIICCAT 
          DISPLAY   *PSTDCOL03:STDROW,SIICSUT 
          DISPLAY   *PSTDCOL04:STDROW,SIIADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSINAC10 IF NOT EQUAL
HSINAC15
          UNPACK    SAVKEY80,SIICSUP,SIICCAT,SIICSUT                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSINAC20
          CALL      HSCRI000
          BRANCH    EXIT,HSINAC30,HSINAC35,HSINAC40,HSINAC45,HSINAC04:
                              HSINAC91,HSINAC50
          GOTO      HSINAC92
HSINAC30
          CALL      RKIEC000
          BRANCH    OVRCD,HSINAC85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          MATCH     SAVKEY80,KEY27                                              
          GOTO      HSINAC85 IF NOT EQUAL                                       
          CALL      RPIEC000
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAC10
HSINAC35
          UNPACK    ST1,KEY27,KEY12,KEY17
          CALL      RDSINA2 
          CALL      RDSINA2 
          CALL      RDSIIC3 
          CALL      RPIEC000
          BRANCH    OVRCD,HSINAC85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT
          PACK      KEY17,SINANAT,SINACAT
          MATCH     SP70,SIICCAT                                                
          GOTO      HSINAC85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSINAC36
          CALL      RPIEC000
          BRANCH    OVRCD,HSINAC37
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          PACK      KEY17,SINANAT,SINACAT
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSINAC36 IF NOT EQUAL
HSINAC37
          MOVE      ZERO,XITEMNO
          GOTO      HSINAC10
HSINAC40
          UNPACK    ST1,KEY27,KEY12,KEY17
          CALL      RDSINA2 
          CALL      RDSIIE2 
          CALL      RDSIIC3 
          CALL      RPIEC000
          BRANCH    OVRCD,HSINAC85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          PACK      KEY17,SINANAT,SINACAT
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAC08
HSINAC45
          CALL      RKIEC000
          BRANCH    OVRCD,HSINAC85
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          PACK      KEY17,SINANAT,SINACAT
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY17,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSIEC000
HSINAC46
          CALL      RPIEC000
          BRANCH    OVRCD,HSINAC47
          PACK      KEY27,SIICSUP,SIICCAT,SIICSUT,SP70                          
          PACK      KEY12,SIWAWAR,SIICCAT,SP70                          
          PACK      KEY17,SINANAT,SINACAT
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSINAC46 IF NOT EQUAL
HSINAC47
          MOVE      ZERO,XITEMNO
          GOTO      HSINAC10
HSINAC50  COMPARE   ZERO,CSEARCH
          GOTO      HSINAC55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
.
          MOVE      "63",SECTOR
          READ      CONTROLF,SECTOR;*67,INCOCATE
.
.---- keyin catalog code ----
.
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          IF        ZERO=INCOCATE
            KEYIN     *PSTDCOL01:STDROW,*V2LON,KEY10;
            PACK      KEY10,KEY10,SP70
          ELSE
HSINAC52    KEYIN     *PSTDCOL01:STDROW,*V2LON,*JR,KEY10;
            PACK      KEY10,KEY10,SP70
            MATCH     SP70,KEY10
            IF        !@EQUAL
              TYPE      KEY10
              IF        !@EQUAL
                BEEP
                GOTO      HSINAC52
              ENDIF
            ENDIF
          ENDIF
          PACK      SCHFLD01,KEY10
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,SCHFLD01;
.
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAC08
HSINAC55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSINAC08
HSINAC60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSINAC61 IF EQUAL
          MATCH     SCHFLD01,SIICCAT 
          GOTO      HSINAC72 IF NOT EQUAL
HSINAC61
HSINAC62
HSINAC63
HSINAC64
HSINAC65
HSINAC66
HSINAC67
HSINAC68
HSINAC69
HSINAC70
          GOTO      HSINAC75
HSINAC72  MOVE      ONE,OVRCD
HSINAC75  RETURN
HSINAC85
          LOAD      KEY49,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY49,KEY27,KEY12,SINANAT
          UNPACK    KEY27,SIICSUP,SIICCAT,SIICSUT                               
          PACK      KEY17,SINANAT,SIICCAT
          CALL      RDSIIC3 
          CALL      RDSINA2 
          CALL      RDSIIE2 
HSINAC90
          UNPACK    SAVKEY80,SIICSUP,SIICCAT,SIICSUT                            
          BEEP
          GOTO      HSINAC20
HSINAC91
          MOVE      ZERO,SIICCCT 
          MOVE      ZERO,SIICLCT 
          MOVE      ZERO,SIICLTM 
          MOVE      SP70,SIICPNO 
          MOVE      SP70,SIICPD1 
          MOVE      SP70,SIICPD2 
          MOVE      ZERO,SIICMAN 
          MOVE      ZERO,SIICAPO 
          MOVE      SP70,SIICUR1 
          MOVE      SP70,SIICUR2 
          MOVE      SP70,SIICUD1 
          MOVE      SP70,SIICUD2 
          MOVE      SP70,SIICUC1 
          MOVE      SP70,SIICUC2 
          MOVE      SP70,SIICUY1 
          MOVE      SP70,SIICUY2 
          MOVE      SP70,SIICSPA 
          MOVE      SP70,KEY27
          MOVE      SP70,SIICCAT 
          GOTO      HSINAC96
HSINAC92
          MOVE      SP70,KEY27
          MOVE      SP70,KEY12
          MOVE      SP70,KEY17
          MOVE      SP70,SIICCAT 
          LOAD      KEY49,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY49,KEY27,KEY12,SINANAT
          UNPACK    KEY27,SIICSUP,SIICCAT,SIICSUT                               
          PACK      KEY17,SINANAT,SIICCAT
          CALL      RDSIIC3 
          CALL      RDSIIE2 
          CALL      RDSINA2 
HSINAC96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSINAC99
          RETURN
.---------------------------------------------------------------------------
. Postional Read C
.---------------------------------------------------------------------------
RSIEC000  CALL      RSSINA2      * All 3 keys have been packed
          CALL      RPSINA2
RSIEC100  CALL      RKSINA2
          BRANCH    OVRCD,RSIEC999
.
          MATCH     SP70,SINANAT
          GOTO      RSIEC100 IF EQUAL
.
          PACK      KEY12,SIWAWAR,SINACAT
          CALL      RDSIIE2      * Must Exist in the Warehouse
          BRANCH    OVRCD,RSIEC100
.
          PACK      KEY27,SAVKEY80,SIIECAT,SP70
          CALL      RSSIIC3
          CALL      RKSIIC3
          BRANCH    OVRCD,RSIEC100
.
          CALL      CHKVAL00
          BRANCH    EXIT,RSIEC100   * No good, Get next nato catalog
.
          CALL      RPSIIC3
.
RSIEC999  RETURN
.---------------------------------------------------------------------------
. Read Forward C
.---------------------------------------------------------------------------
RKIEC000  CALL      RKSIIC3
          BRANCH    OVRCD,RKIEC100
.
          CALL      CHKVAL00
          COMPARE   ZERO,EXIT
          GOTO      RKIEC999 IF EQUAL       * Record is valid
.
RKIEC100  CALL      RKSINA2
          BRANCH    OVRCD,RKIEC999
.
          MATCH     SP70,SINANAT
          GOTO      RSIEC000 IF EQUAL
.
          PACK      KEY12,SIWAWAR,SINACAT
          CALL      RDSIIE2
          BRANCH    OVRCD,RKIEC100          * Get Next Nato/Catalog
.
          PACK      KEY27,SAVKEY80,SIIECAT,SP70
          CALL      RSSIIC3
          GOTO      RKIEC000
.
RKIEC999  RETURN
.---------------------------------------------------------------------------
. Read Backward C
.---------------------------------------------------------------------------
RPIEC000  CALL      RPSIIC3
          BRANCH    OVRCD,RPIEC100
.
          CALL      CHKVAL00
          COMPARE   ZERO,EXIT
          GOTO      RPIEC999 IF EQUAL       * Record is valid
.
          COMPARE   ZERO,EXIT
          GOTO      RPIEC999 IF EQUAL       * Record is valid
.
RPIEC100  CALL      RPSINA2
          BRANCH    OVRCD,RPIEC999
.
          PACK      KEY12,SIWAWAR,SINACAT
          CALL      RDSIIE2
          BRANCH    OVRCD,RPIEC100          * Get Next Nato/Catalog
.
          PACK      KEY27,SAVKEY80,SIIECAT,Z70 
          CALL      RSSIIC3
          GOTO      RPIEC000
.
RPIEC999  RETURN
.---------------------------------------------------------------------------
. Check Valid Record C
.---------------------------------------------------------------------------
CHKVAL00  MOVE      ZERO,EXIT
          MATCH     SAVKEY80,SIICSUP
          IF        !@EQUAL
            MOVE      ONE,EXIT
          ENDIF
          MATCH     SIIECAT,SIICCAT
          IF        !@EQUAL
            MOVE      ONE,EXIT
          ENDIF
.
CHKVAL99  RETURN
.
ESINAA00
          MOVE      SP70,SIIADES
          PACK      KEY7,SIICCAT,SP70
          CALL      RDSIIA1
          RETURN
