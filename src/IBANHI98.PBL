.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.12.01 13.08.2009  Davin         CAR 200023
.          Changed read/write of cpasswd to s.114/p.240
.-------------------------------------------------------
. V9.02.01 20.03.2003  Sandra Barcham
.          Added Parameter for Reply FIFO Timeout
.-------------------------------------------------------
. V5.08.03 18.07.2000  Sandra Barcham
.          Spell maintenance correctly in program name
. V5.08.02 06/07/2000  Greg Horvat
.          Moved the parameter PTCNEDID to PTCNNZED
. V5.08.01 03.07.2000 Sandra Barcham
.          Bring case tools into standard Run Macro
.-------------------------------------------------------
. V5.04.01 29.07.1996 B.G.Ackland
.          Added Domicile Clear Option to User Screen
.-------------------------------------------------------
ALRTONLY  INIT      "Alerts System Only"
ALRTWARN  INIT      "Alerts plus Warnings"
WARNONLY  INIT      "Warnings System Only"
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBANHI98
.   Function      :   NHI/MWS Parameter Maintenance           
.   Generated  On :   13/08/2009
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       ALLRITFD/INC
          INC       PATCONFD/INC
.=========================
.Local Variable Definition
.-------------------------
ALRTDESC  DIM      20 * Scr I1 Fld     9
DOMCDESC  DIM      25 * Scr I1 Fld    17
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBANHI98"
PRGNAM    INIT      "NHI/MWS Parameter Maintenance           "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Parameter Menu                     
          ENDIF
          MATCH     "A1",SCRID
          IF         @EQUAL
            CALL       PSA1L000   * Audit Control Screen 1             
          ENDIF
          MATCH     "I1",SCRID
          IF         @EQUAL
            CALL       PSI1L000   * IBA Controlled Screen 1            
          ENDIF
          MATCH     "U1",SCRID
          IF         @EQUAL
            CALL       PSU1L000   * User Defined Screen 1              
          ENDIF
          RETURN
.--------------------------------
. Screen - Parameter Menu                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Parameter Menu                     
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Parameter Menu                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Parameter Menu                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Parameter Menu                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Parameter Menu                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Parameter Menu                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Parameter Menu                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SCA1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SCU1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      GETI1000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Audit Control Screen 1             
.--------------------------------
SCA1L000
SCA1L100
          MOVE      "A1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCA1L200
          CALL      CFA1L000 * Clear Fields
          CALL      GETA1000
SCA1L300
          CALL      KYA1L000 * Enter Key Fields
          BRANCH    EXIT,SCA1L999,SCA1L999
SCA1L400
          CALL      WPA1L000 * Load any WP Details
SCA1L500
          CALL      LMA1L000 * Load any Batch Details
SCA1L600
          CALL      DFA1L000 * Display Fields
SCA1L700
          CALL      SFA1L000 * Select Fields
          BRANCH    EXIT,SCA1L100,SCA1L100,SCA1L200
SCA1L800
SCA1L900
SCA1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Audit Control Screen 1             
.-------------------------------------------------------
CFA1L000
CFA1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Audit Control Screen 1             
.--------------------------------------------------------
KYA1L000
          MOVE      ZERO,EXIT
          GOTO      KYA1L999
.
KYA1L900  MOVE      ONE,EXIT
KYA1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Audit Control Screen 1             
.---------------------------------------------------------
WPA1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Audit Control Screen 1             
.---------------------------------------------------------
LMA1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Audit Control Screen 1             
.---------------------------------------------------------
DFA1L000
          BRANCH   ACCEPT,DFA1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFA1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFA1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFA1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFA1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFA1L010 IF NOT EQUAL
.
          CALL     PSA1L000 * Display Field
          GOTO     DFA1L010
DFA1L900
DFA1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Audit Control Screen 1             
.---------------------------------------------------------
PSA1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSA1L999,PSA1L999,PSA1L999,PSA1L101:
                            PSA1L102
          GOTO     PSA1L999
.
PSA1L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNANMA,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNANDN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
PSA1L999
          RETURN
.---------------------------------------------------------
. Selections for : Audit Control Screen 1             
.---------------------------------------------------------
SFA1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFA1L001  BRANCH   ACCEPT,SFA1L020
.
SFA1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFA1L006,SFA1L101,SFA1L102,SFA1L103:
                            SFA1L104
SFA1L006  BEEP
          GOTO     SFA1L005
SFA1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFA1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFA1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFA1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFA1L020,SFA1L020,SFA1L020,SFA1L103:
                            SFA1L104
          GOTO     SFA1L020
SFA1L090  MOVE     ZERO,ACCEPT
          GOTO     SFA1L001
.
SFA1L101
          MOVE      ZERO,EXIT
          GOTO      SFA1L999
.
SFA1L102
          CALL      POSTA100
          MOVE      ZERO,EXIT
          GOTO      SFA1L999
.
SFA1L103
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNANMA
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNANMA,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNANDN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNANDN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
SFA1L990  MOVE      ONE,EXIT * Exit Char Restart
SFA1L999  RETURN
.--------------------------------
. Screen - IBA Controlled Screen 1            
.--------------------------------
SCI1L000
SCI1L100
          MOVE      "I1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCI1L200
          CALL      CFI1L000 * Clear Fields
SCI1L300
          CALL      KYI1L000 * Enter Key Fields
          BRANCH    EXIT,SCI1L999,SCI1L999
SCI1L400
          CALL      WPI1L000 * Load any WP Details
SCI1L500
          CALL      LMI1L000 * Load any Batch Details
SCI1L600
          CALL      DFI1L000 * Display Fields
SCI1L700
          CALL      SFI1L000 * Select Fields
          BRANCH    EXIT,SCI1L100,SCI1L100,SCI1L200
SCI1L800
SCI1L900
SCI1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : IBA Controlled Screen 1            
.-------------------------------------------------------
CFI1L000
CFI1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for IBA Controlled Screen 1            
.--------------------------------------------------------
KYI1L000
          MOVE      ZERO,EXIT
          GOTO      KYI1L999
.
KYI1L900  MOVE      ONE,EXIT
KYI1L999  RETURN
.---------------------------------------------------------
. Load WP files for : IBA Controlled Screen 1            
.---------------------------------------------------------
WPI1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : IBA Controlled Screen 1            
.---------------------------------------------------------
LMI1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : IBA Controlled Screen 1            
.---------------------------------------------------------
DFI1L000
          BRANCH   ACCEPT,DFI1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI1L010 IF NOT EQUAL
.
          CALL     PSI1L000 * Display Field
          GOTO     DFI1L010
DFI1L900
DFI1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : IBA Controlled Screen 1            
.---------------------------------------------------------
PSI1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI1L999,PSI1L999,PSI1L999,PSI1L101:
                            PSI1L102,PSI1L103,PSI1L104,PSI1L105:
                            PSI1L106,PSI1L107,PSI1L108,PSI1L109:
                            PSI1L999,PSI1L110,PSI1L111,PSI1L112:
                            PSI1L113,PSI1L114
          GOTO     PSI1L999
.
PSI1L101
          MOVE      CPASSWD,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNHII,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L103
          MOVE      PTCNNHID,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L104
          MOVE      PTCNNHIF,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L105
          MOVE      PTCNAWRN,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L106
          MOVE      ALRTDESC,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L107
          MOVE      PTCNNZED,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L108
          MOVE      PTCNEDIF,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNZUR,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L110
          MOVE      PTCNNXTT,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L111
          MOVE      PTCNSEND,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L112
          MOVE      PTCNDOMF,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L113
          MOVE      DOMCDESC,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L114
          MOVE      PTCNNHTM,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
PSI1L999
          RETURN
.---------------------------------------------------------
. Selections for : IBA Controlled Screen 1            
.---------------------------------------------------------
SFI1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI1L001  BRANCH   ACCEPT,SFI1L020
.
SFI1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L006,SFI1L101,SFI1L102,SFI1L103:
                            SFI1L104,SFI1L105,SFI1L106,SFI1L107:
                            SFI1L006,SFI1L108,SFI1L109,SFI1L110:
                            SFI1L006,SFI1L111,SFI1L112,SFI1L113:
                            SFI1L006,SFI1L114
SFI1L006  BEEP
          GOTO     SFI1L005
SFI1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L020,SFI1L020,SFI1L020,SFI1L103:
                            SFI1L104,SFI1L105,SFI1L106,SFI1L107:
                            SFI1L020,SFI1L108,SFI1L109,SFI1L110:
                            SFI1L020,SFI1L111,SFI1L112,SFI1L113:
                            SFI1L020,SFI1L114
          GOTO     SFI1L020
SFI1L090  MOVE     ZERO,ACCEPT
          GOTO     SFI1L001
.
SFI1L101
          MOVE      ZERO,EXIT
          GOTO      SFI1L999
.
SFI1L102
          CALL      POSTI100
          MOVE      ZERO,EXIT
          GOTO      SFI1L999
.
SFI1L103
          CALL     SELECTED
          STRIP     CPASSWD 
          SFORMAT   VAR,SCPSLEN
          MOVE      CPASSWD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CPASSWD 
          SFORMAT   VAR,127
          ENDSET    CPASSWD 
          APPEND    SP70,CPASSWD 
          RESET     CPASSWD 
          CMATCH    EXITCHAR,CPASSWD 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CPASSWD 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L103
            ENDIF
          ENDIF
          MOVE      CPASSWD,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNNHII
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNHII,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L105
          CALL     SELECTED
          STRIP     PTCNNHID
          SFORMAT   VAR,SCPSLEN
          MOVE      PTCNNHID,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,PTCNNHID
          SFORMAT   VAR,127
          ENDSET    PTCNNHID
          APPEND    SP70,PTCNNHID
          RESET     PTCNNHID
          CMATCH    EXITCHAR,PTCNNHID
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,PTCNNHID
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L105
            ENDIF
          ENDIF
          MOVE      PTCNNHID,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L106
          CALL     SELECTED
          STRIP     PTCNNHIF
          SFORMAT   VAR,SCPSLEN
          MOVE      PTCNNHIF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,PTCNNHIF
          SFORMAT   VAR,127
          ENDSET    PTCNNHIF
          APPEND    SP70,PTCNNHIF
          RESET     PTCNNHIF
          CMATCH    EXITCHAR,PTCNNHIF
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,PTCNNHIF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L106
            ENDIF
          ENDIF
          MOVE      PTCNNHIF,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L107
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ALRTDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAWRN000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L107
            ENDIF
            BRANCH    EXIT,SFI1L107,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      PTCNAWRN,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ALRTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L108
          CALL     SELECTED
          STRIP     PTCNNZED
          SFORMAT   VAR,SCPSLEN
          MOVE      PTCNNZED,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,PTCNNZED
          SFORMAT   VAR,127
          ENDSET    PTCNNZED
          APPEND    SP70,PTCNNZED
          RESET     PTCNNZED
          CMATCH    EXITCHAR,PTCNNZED
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,PTCNNZED
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L108
            ENDIF
          ENDIF
          MOVE      PTCNNZED,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,PTCNEDIF
          IF        SCPSMAN=1
            COMPARE   ZERO,PTCNEDIF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L109
            ENDIF
          ENDIF
          MOVE      PTCNEDIF,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNNZUR
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNZUR,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,PTCNNXTT
          IF        SCPSMAN=1
            COMPARE   ZERO,PTCNNXTT
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L111
            ENDIF
          ENDIF
          MOVE      PTCNNXTT,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L112
          CALL     SELECTED
          STRIP     PTCNSEND
          SFORMAT   VAR,SCPSLEN
          MOVE      PTCNSEND,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,PTCNSEND
          SFORMAT   VAR,127
          ENDSET    PTCNSEND
          APPEND    SP70,PTCNSEND
          RESET     PTCNSEND
          CMATCH    EXITCHAR,PTCNSEND
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,PTCNSEND
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L112
            ENDIF
          ENDIF
          MOVE      PTCNSEND,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L113
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DOMCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KDOMF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L113
            ENDIF
            BRANCH    EXIT,SFI1L113,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      PTCNDOMF,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DOMCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L114
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,PTCNNHTM
          IF        SCPSMAN=1
            COMPARE   ZERO,PTCNNHTM
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L114
            ENDIF
          ENDIF
          MOVE      PTCNNHTM,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
SFI1L990  MOVE      ONE,EXIT * Exit Char Restart
SFI1L999  RETURN
.--------------------------------
. Screen - User Defined Screen 1              
.--------------------------------
SCU1L000
SCU1L100
          MOVE      "U1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCU1L200
          CALL      CFU1L000 * Clear Fields
          CALL      GETU1000
SCU1L300
          CALL      KYU1L000 * Enter Key Fields
          BRANCH    EXIT,SCU1L999,SCU1L999
SCU1L400
          CALL      WPU1L000 * Load any WP Details
SCU1L500
          CALL      LMU1L000 * Load any Batch Details
SCU1L600
          CALL      DFU1L000 * Display Fields
SCU1L700
          CALL      SFU1L000 * Select Fields
          BRANCH    EXIT,SCU1L100,SCU1L100,SCU1L200
SCU1L800
SCU1L900
SCU1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : User Defined Screen 1              
.-------------------------------------------------------
CFU1L000
CFU1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for User Defined Screen 1              
.--------------------------------------------------------
KYU1L000
          MOVE      ZERO,EXIT
          GOTO      KYU1L999
.
KYU1L900  MOVE      ONE,EXIT
KYU1L999  RETURN
.---------------------------------------------------------
. Load WP files for : User Defined Screen 1              
.---------------------------------------------------------
WPU1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : User Defined Screen 1              
.---------------------------------------------------------
LMU1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : User Defined Screen 1              
.---------------------------------------------------------
DFU1L000
          BRANCH   ACCEPT,DFU1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFU1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFU1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFU1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFU1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFU1L010 IF NOT EQUAL
.
          CALL     PSU1L000 * Display Field
          GOTO     DFU1L010
DFU1L900
DFU1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : User Defined Screen 1              
.---------------------------------------------------------
PSU1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSU1L999,PSU1L999,PSU1L999,PSU1L101:
                            PSU1L102,PSU1L103,PSU1L104,PSU1L105:
                            PSU1L106,PSU1L107,PSU1L108
          GOTO     PSU1L999
.
PSU1L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNDONR,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNMEDW,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNUDNG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNSCA,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L105
          MOVE      PTCNMPTR,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNVP32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNVM21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNZCD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
PSU1L999
          RETURN
.---------------------------------------------------------
. Selections for : User Defined Screen 1              
.---------------------------------------------------------
SFU1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFU1L001  BRANCH   ACCEPT,SFU1L020
.
SFU1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFU1L006,SFU1L101,SFU1L102,SFU1L103:
                            SFU1L104,SFU1L105,SFU1L106,SFU1L107:
                            SFU1L108,SFU1L109,SFU1L110
SFU1L006  BEEP
          GOTO     SFU1L005
SFU1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFU1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFU1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFU1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFU1L020,SFU1L020,SFU1L020,SFU1L103:
                            SFU1L104,SFU1L105,SFU1L106,SFU1L107:
                            SFU1L108,SFU1L109,SFU1L110
          GOTO     SFU1L020
SFU1L090  MOVE     ZERO,ACCEPT
          GOTO     SFU1L001
.
SFU1L101
          MOVE      ZERO,EXIT
          GOTO      SFU1L999
.
SFU1L102
          CALL      POSTU100
          MOVE      ZERO,EXIT
          GOTO      SFU1L999
.
SFU1L103
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNDONR
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNDONR,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNMEDW
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNMEDW,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNUDNG
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNUDNG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L106
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNNSCA
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNSCA,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,PTCNMPTR
          IF        SCPSMAN=1
            COMPARE   ZERO,PTCNMPTR
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L107
            ENDIF
          ENDIF
          MOVE      PTCNMPTR,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L108
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNVP32
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNVP32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNVM21
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNVM21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PTCNNZCD
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PTCNNZCD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
SFU1L990  MOVE      ONE,EXIT * Exit Char Restart
SFU1L999  RETURN
.@@@@@ Function Restart Point @@@@@
.-----------------------------------------
. Read in Asset System IBA Screen 1
.-----------------------------------------
GETI1000  READ      CONTROLF,HUND14;*240,CPASSWD
.
          READ      CONTROLF,TWENTY1;*138,PTCNNHII,PTCNNHID,*191,PTCNNHIF:
                                     *204,PTCNAWRN,*240,PTCNEDIF
          READ      CONTROLF,SEVENTY7;*45,PTCNNZED
          READ      CONTROLF,SEVENTY9;*33,PTCNSEND
          READ      CONTROLF,EIGHTY;*138,PTCNNZUR,PTCNNUMH:
                                    *142,PTCNDOMF,*223,PTCNNXTT
          READ      CONTROLF,HUND09;*177,PTCNNHTM
          MOVE     ALRTONLY,ALRTDESC
          LOAD     ALRTDESC,PTCNAWRN,ALRTWARN,WARNONLY
          BRANCH   PTCNDOMF,GETI1110,GETI1120
          MOVE     "N/A               ",DOMCDESC
          GOTO     GETI1900
.
GETI1110  MOVE     "Simple Lookup File",DOMCDESC
          GOTO     GETI1900
.
GETI1120  MOVE     "Street Lookup File",DOMCDESC
          GOTO     GETI1900
.
GETI1900  CALL      PASS0000
          BRANCH    EXIT,GETI1999
.
          CALL      SCI1L000        * IBA Controlled Screen 1
.
GETI1999  RETURN
.
PASS0000  MOVE      SP70,KEY8
          KEYIN     *P1:24,*EL,*P20:24,"Enter Password : ",*EOFF,KEY8;
          PACK      KEY8,KEY8,SP30
          MATCH     KEY8,CPASSWD
          GOTO      PASS9500 IF NOT EQUAL
.
          KEYIN     *EOFF,KEY8;
          SQUEEZE   KEY8
          MOVE      KEY8,AUDTSECT
.
          SUB       CDD,AUDTSECT
          SUB       CMM,AUDTSECT
          SUB       CYY,AUDTSECT
.
          COMPARE   ZERO,AUDTSECT
          GOTO      PASS9500 IF NOT EQUAL
.
PASS9000  MOVE      ZERO,EXIT
          GOTO      PASS9999
.
PASS9500  MOVE      ONE,EXIT
.
PASS9999  RETURN
.-----------------------------------------
. Read in System Audit Screen 1
.-----------------------------------------
GETA1000  MOVE      "   80",AUDTSECT
          READ      CONTROLF,AUDTSECT;*140,PTCNANMA,PTCNANDN
          MOVE      ZERO,ACCEPT
          RETURN
.-----------------------------------------
. Save Audit Screen 1
.-----------------------------------------
POSTA100  MOVE      "   80",AUDTSECT
          WRITAB    CONTROLF,AUDTSECT;*140,PTCNANMA,PTCNANDN
          RETURN
.-----------------------------------------
. Post in Asset System IBA Screen 1
.-----------------------------------------
POSTI100  WRITAB    CONTROLF,HUND14;*240,CPASSWD
          WRITAB    CONTROLF,TWENTY1;*138,PTCNNHII,PTCNNHID,*191,PTCNNHIF:
                                     *204,PTCNAWRN,*240,PTCNEDIF
          WRITAB    CONTROLF,SEVENTY7;*45,PTCNNZED
          WRITAB    CONTROLF,SEVENTY9;*33,PTCNSEND
          WRITAB    CONTROLF,EIGHTY;*138,PTCNNZUR,PTCNNUMH:
                                    *142,PTCNDOMF,*223,PTCNNXTT
          WRITAB    CONTROLF,HUND09;*177,PTCNNHTM
          RETURN
.
.------------------------------------------------------------
. Enter Alert Warning Type 0,1,2
.------------------------------------------------------------
KAWRN000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          DISPLAY  *P1:24,"Type : ",*V2LON,"0.",*HOFF," Alerts Only,  ":
                          *V2LON,"1.",*HOFF," Alerts & Warnings,  ":
                          *V2LON,"2.",*HOFF," Warnings Only"
.
KAWRN100  KEYIN    *PCCOL:CVERT,*V2lON,PTCNAWRN
          COMPARE  ZERO,PTCNAWRN
          GOTO     KAWRN110 IF EQUAL
          BRANCH   PTCNAWRN,KAWRN110,KAWRN110
          BEEP
          GOTO     KAWRN100
.
KAWRN110  MOVE     ALRTONLY,ALRTDESC
          LOAD     ALRTDESC,PTCNAWRN,ALRTWARN,WARNONLY
.
KAWRN999  CALL     MESSAGE3
          RETURN
.-------------------------------------------------------------
. Enter Domicile Validation File
.-------------------------------------------------------------
KDOMF000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          DISPLAY  *P1:24,"Type : ",*V2LON,"0.",*HOFF," N/A,  ":
                          *V2LON,"1.",*HOFF," Simple Lookup,  ":
                          *V2LON,"2.",*HOFF," Street Lookup"
.
KDOMF100  KEYIN    *PCCOL:CVERT,*V2lON,PTCNDOMF
          COMPARE  ZERO,PTCNDOMF
          GOTO     KDOMF110 IF EQUAL
          BRANCH   PTCNDOMF,KDOMF120,KDOMF130
          BEEP
          GOTO     KDOMF100
.
KDOMF110  MOVE     "N/A               ",DOMCDESC
          GOTO     KDOMF999
.
KDOMF120  MOVE     "Simple Lookup File",DOMCDESC
          GOTO     KDOMF999
.
KDOMF130  MOVE     "Street Lookup File",DOMCDESC
          GOTO     KDOMF999
.
KDOMF999  CALL     MESSAGE3
          RETURN
.
.-----------------------------------------
. Read in User Def. Screen 1
.-----------------------------------------
GETU1000  READ      CONTROLF,TWENTY1;*174,PTCNDONR,PTCNMEDW,PTCNUDNG,PTCNNSCA:
                             PTCNMPTR,*187,PTCNVP32,PTCNVM21:
                             *190,PTCNPCON,*213,PTCNNZCD
.
.
GETU1900  MOVE      ZERO,ACCEPT
          RETURN
.
. Following No Longer Required
.
.          BRANCH   PTCNPCON,GETU1210,GETU1220,GETU1230
.
.GETU1200  MOVE     "Next of Kin      ",DISPPCON
.          GOTO     GETU1900
.GETU1210  MOVE     "Emergency Contact",DISPPCON
.          GOTO     GETU1900
.GETU1220  MOVE     "Nearest Relative ",DISPPCON
.          GOTO     GETU1900
.GETU1230  MOVE     "N/A              ",DISPPCON
.          GOTO     GETU1900
.-----------------------------------------
. Post in User Def. Screen 1
.-----------------------------------------
POSTU100  WRITAB    CONTROLF,TWENTY1;*174,PTCNDONR,PTCNMEDW,PTCNUDNG,PTCNNSCA:
                             PTCNMPTR,*187,PTCNVP32,PTCNVM21:
                             *190,PTCNPCON,*213,PTCNNZCD
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       ALLRITIO/INC
.
          INC       STDGENCD
.
