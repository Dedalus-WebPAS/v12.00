.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.03.01  10.09.2003 Steve Downing (VF.11.01 CAR 9375)
.           Recompiled for SINREBFD & SINREBIO
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 23.11.2000 Charles Handaya
.           Recompiled only (Modification of Warehouse Security)
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  19.03.1999 Sandra Barcham
.           Fix purchase order purge
.-------------------------------------------------------
CATAMT    FORM    12.2
CATQTY    FORM    12.2
DELETED   FORM    8
ENDCAT    DIM     7
ENDDAT    DIM     10
FINPERD   DIM     2
FINYEAR   DIM     4
LASTPRT   DIM     12
SCANNED   FORM    8
STRCAT    DIM     7
STRDAT    DIM     10
TOTAMT    FORM    12.2
TOTQTY    FORM    12.2
TOTTRN    FORM    5
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN65
.   Function      :   Purge Inventory System Files            
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       SINCIAFD/INC
          INC       SINCIFFD/INC
          INC       SINCONFD/INC
          INC       SINITMFD/INC
          INC       SINNATFD/INC
          INC       SINPOAFD/INC
          INC       SINPOBFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINPOFFD/INC
          INC       SINREAFD/INC
          INC       SINREBFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMCATA  DIM      40 * Scr 01 Fld     6
TOCATA    DIM      40 * Scr 01 Fld     7
FROMDAT   DIM      10 * Scr 01 Fld     8
TODAT     DIM      10 * Scr 01 Fld     9
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN65"
PRGNAM    INIT      "Purge Inventory System Files            "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sinitmaf";
          OPEN      SINITMA1,"sinitmaf"
          DISPLAY   *P56:24,"Opening sinitmaf";
          OPEN      SINITMA2,"sinitmaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpobaf";
          OPEN      SINPOBA1,"sinpobaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA8,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA1,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA2,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA3,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA4,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA1,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA2,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA3,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA4,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA1,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA2,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA3,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Item History Purge                 
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Purge Requisitions                 
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Purchase Order Purge               
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Item History Purge                 
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      MVACCEPT
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Item History Purge                 
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SIWAWAR 
          MOVE      SP70,SIWADES 
          MOVE      SP70,FROMCATA
          MOVE      SP70,TOCATA  
          MOVE      SP70,FROMDAT 
          MOVE      SP70,TODAT   
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Item History Purge                 
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Item History Purge                 
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Item History Purge                 
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Item History Purge                 
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Item History Purge                 
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104,PS01L105:
                            PS01L106
          GOTO     PS01L999
.
PS01L101
          MOVE      SIWAWAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      FROMCATA,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      TOCATA,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      TODAT,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Item History Purge                 
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L104,SF01L006,SF01L105:
                            SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020,SF01L104,SF01L020,SF01L105:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      PITM0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIWAA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIWAWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCATA  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCATA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMCATA,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCATA,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODAT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDATE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
            BRANCH    EXIT,SF01L105,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODAT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Purge Requisitions                 
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      MVACCEPT
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purge Requisitions                 
.-------------------------------------------------------
CF02L000
          MOVE      SP70,FROMDAT 
          MOVE      SP70,TODAT   
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purge Requisitions                 
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purge Requisitions                 
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purge Requisitions                 
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purge Requisitions                 
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purge Requisitions                 
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102
          GOTO     PS02L999
.
PS02L101
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      TODAT,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Purge Requisitions                 
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      PREQ0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODAT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDATB000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODAT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Purchase Order Purge               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      MVACCEPT
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Purge               
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMDAT 
          MOVE      SP70,TODAT   
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Purge               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Purge               
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Purge               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Purge               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Purge               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      TODAT,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Purge               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      PORD0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODAT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDATB000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMDAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODAT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.----------------------------------------------------------------------
. Print Report
.----------------------------------------------------------------------
PITM0000  CLOCK    TIME,CTIMEIS
          MOVE     "99",CLNO
          MOVE     ZERO,CPAGENO
          DISPLAY  *P1:24,*EL,"Scanning :"
          DISPLAY  *P40:24,"Purged :"
          MOVE     SP70,LASTPRT
          MOVE     ZERO,SCANNED
          MOVE     ZERO,DELETED
          PACK     KEY28,SP70
          CALL     RSSIIT1
PITM1000  CALL     RKSIIT1
          BRANCH   OVRCD,PITM9000
          ADD      ONE,SCANNED
          IF       (SCANNED%1000=0)
            DISPLAY   *P20:24,*V2LON,SCANNED
          ENDIF
.
          MATCH    STRCAT,SIITCAT
          GOTO     PITM1000 IF LESS
          MATCH    SIITCAT,ENDCAT
          GOTO     PITM1000 IF LESS
.
          MATCH    STRDAT,SIITDAT
          GOTO     PITM1000 IF LESS
          MATCH    SIITDAT,ENDDAT
          GOTO     PITM1000 IF LESS
.
          PACK     KEY12,SIITWAR,SIITCAT
          MATCH    KEY12,LASTPRT
          IF       !@EQUAL
            MOVE     "99",CLNO
            PACK     LASTPRT,SIITWAR,SIITCAT
          ENDIF
.
          COMPARE  "56",CLNO
          CALL     IHEAD000 IF NOT LESS
.
          UNPACK   SIITDAT,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          UNPACK   SIITPER,FINYEAR,FINPERD
          PRINT    CPCDATE,SP1,SIITTIM,SP1,SIITOPR,SP2,SIITPOR,SP2,SIITPRG:
                   SP1,FINPERD,"/",FINYEAR,SP1,SIITQTY,SIITAMT,SP2,SIITTYP,SP3:
                   SIITCST,SP5,SIITREQ,SP1,SIITPUR,SP1,SIITREF
          ADD      ONE,CLNO
.
          ADD      ONE,DELETED
          IF       (DELETED%1000=0)
            DISPLAY   *P20:24,*V2LON,DELETED
          ENDIF
.
          PACK     KEY28,SIITWAR,SIITCAT,SIITDAT,SIITTIM
          CALL     DESIIT1
          CALL     RSSIIT1
          GOTO     PITM1000
.
PITM9000  COMPARE  ZERO,CPAGENO
          CALL     IHEAD000 IF EQUAL
          CALL     UND132
          PRINT    *50,"****** End of Report ******"
.
PITM9999  RETURN
.------------------------------------------------------------
. Heading
.------------------------------------------------------------
IHEAD000  CALL      HEAD132
          PRINT     "Item History Details Purged"
          PRINT     "Catalog     From : ",FROMCATA," to ",TOCATA
          PRINT     "Date        From : ",FROMDAT," to ",TODAT
          MOVE      SIITCAT,KEY7
          CALL      RDSIIA1
          PRINT     "Warehouse/Catalog : ",SIITWAR,"/",SIITCAT,SP1,SIIADES:
                    "  Issue Unit : ",SIIAISS
          CALL      UND132
          PRINT     "  Date       Time   Opr. Port Program  Period":
                    "         Quantity         Amount Type  C/Centre":
                    "  Req. No. P/O     Reference"
          CALL      UND132
          ADD       "5",CLNO
          RETURN
.
.
.----------------------------------------------------------------------
. Enter Catalog Range
.----------------------------------------------------------------------
RCATA000   MOVE     "    6",FLDID
           CALL     GETPOSIT
           CALL     KSIIAA00
           BRANCH   EXIT,RCATA100,RCATA999
           MOVE     SIIACAT,STRCAT
           PACK     FROMCATA,SIIACAT,SP1,SIIADES
           GOTO     RCATA140
RCATA100   MOVE     "Start             ",FROMCATA
           MOVE     SP70,STRCAT
.
RCATA140   MOVE     FROMCATA,VAR
           CALL     DISPITEM
.
RCATA150   MOVE     "    7",FLDID
           CALL     GETPOSIT
           CALL     KSIIAA00
           BRANCH   EXIT,RCATA200,RCATA999
           MOVE     SIIACAT,ENDCAT
           PACK     TOCATA,SIIACAT,SP1,SIIADES
           MATCH    STRCAT,ENDCAT
           GOTO     RCATA999 IF EQUAL
           GOTO     RCATA999 IF NOT LESS
           BEEP
           MOVE     "To Catalog Must Be > From Catalog - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCATA000
.
RCATA200   MOVE     "Finish             ",TOCATA
           MOVE     "~~~~~~~",ENDCAT
.
RCATA999   MOVE     "    6",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Enter Date Range
.------------------------------------------------------------
RDATE000   MOVE     "    8",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATE100
           MATCH    SP2,CDAY
           GOTO     RDATE100 IF EQUAL
           PACK     STRDAT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRDAT
           CALL     PACDATE
           MOVE     CPCDATE,FROMDAT
           GOTO     RDATE140
.
RDATE100   MOVE     "Start             ",FROMDAT
           MOVE     SP70,STRDAT
.
RDATE140   MOVE     FROMDAT,VAR
           CALL     DISPITEM
.
RDATE150   MOVE     "    9",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATE200
           MATCH    SP2,CDAY
           GOTO     RDATE200 IF EQUAL
           PACK     ENDDAT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDDAT
           CALL     PACDATE
           MOVE     CPCDATE,TODAT
           MATCH    STRDAT,ENDDAT
           GOTO     RDATE999 IF EQUAL
           GOTO     RDATE999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDATE000
.
RDATE200   MOVE     "Finish             ",TODAT
           MOVE     "99999999",ENDDAT
.
RDATE999   MOVE     "    8",FLDID
           CALL     GETPOSIT
           RETURN
.
.----------------------------------------------------------------------
. Purge Requisition Files
.----------------------------------------------------------------------
. Select Print and Delete Requisition in the Date Range Specified
.----------------------------------------------------------------------
PREQ0000  CLOCK    TIME,CTIMEIS
          MOVE     "99",CLNO
          MOVE     ZERO,CPAGENO
          DISPLAY  *P1:24,*EL,"Requisitions Purged  :"
.
          MOVE     SP70,LASTPRT
          MOVE     ZERO,SCANNED
          MOVE     ZERO,DELETED
          PACK     KEY16,STRDAT,SP70
          CALL     RSSIRA3
PREQ1000  CALL     RKSIRA3
          BRANCH   OVRCD,PREQ9000
          MATCH    SIRADAT,ENDDAT
          GOTO     PREQ9000 IF LESS
.
          ADD      ONE,SCANNED
          IF       (SCANNED%1000=0)
            DISPLAY   *P25:24,*V2LON,SCANNED
          ENDIF
.
          UNPACK   SIRADAT,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          MOVE     "Req",KEY3
          IF       SIRAIND=1
            MOVE     "Ret",KEY3
          ENDIF
          COMPARE  "56",CLNO
          CALL     RHEAD000 IF NOT LESS
          PRINT    CPCDATE,SP1,SIRATYP,SIRAREQ,SP1,KEY3,SP1,SIRACST,SP1,SIRATOT;
.
          PACK     KEY20,SIRATYP,SIRAREQ,SP70
          CALL     RSSIRB1
PREQ1100  CALL     RKSIRB1
          BRANCH   OVRCD,PREQ1900
          MATCH    SIRATYP,SIRBTYP
          GOTO     PREQ1900 IF NOT EQUAL
          MATCH    SIRAREQ,SIRBREQ
          GOTO     PREQ1900 IF NOT EQUAL
.
          PRINT    *50,SIRBWAR,SIRBCAT,SIRBRQT,SIRBIQT,SIRBAMT:
                       SP1,SIRBBCH,SP1,SIRBLED,"/",SIRBACC
          ADD      ONE,CLNO
          COMPARE  "56",CLNO
          CALL     RHEAD000 IF NOT LESS
.
          PACK     KEY20,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT,SP70
          CALL     DESIRB1
          CALL     RDSIRB1
          GOTO     PREQ1100
.
PREQ1900  PRINT    " "
          ADD      ONE,CLNO
          PACK     KEY8,SIRATYP,SIRAREQ
          CALL     RDSIRA1
          IF       OVRCD=0
            CALL     DESIRA1
          ENDIF
          GOTO     PREQ1000
.
PREQ9000  COMPARE  ZERO,CPAGENO
          CALL     RHEAD000 IF EQUAL
          CALL     UND132
          PRINT    *50,"****** End of Report ******"
.
PREQ9999  RETURN
.------------------------------------------------------------
. Heading
.------------------------------------------------------------
RHEAD000  CALL      HEAD132
          PRINT     "Requisition Details Purged"
          PRINT     "Date        From : ",FROMDAT," to ",TODAT
          CALL      UND132
          PRINT     " Date      Req No.      C/C             Total":
                    "    WH   Catalog      Requested         Issued":
                    "           Cost Batch Ledger/Acct."
          CALL      UND132
          ADD       "3",CLNO
          RETURN
.
.------------------------------------------------------------
. Enter Date Range
.------------------------------------------------------------
RDATB000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATB100
           MATCH    SP2,CDAY
           GOTO     RDATB100 IF EQUAL
           PACK     STRDAT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRDAT
           CALL     PACDATE
           MOVE     CPCDATE,FROMDAT
           GOTO     RDATB140
.
RDATB100   MOVE     "Start             ",FROMDAT
           MOVE     SP70,STRDAT
.
RDATB140   MOVE     FROMDAT,VAR
           CALL     DISPITEM
.
RDATB150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATB200
           MATCH    SP2,CDAY
           GOTO     RDATB200 IF EQUAL
           PACK     ENDDAT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDDAT
           CALL     PACDATE
           MOVE     CPCDATE,TODAT
           MATCH    STRDAT,ENDDAT
           GOTO     RDATB999 IF EQUAL
           GOTO     RDATB999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDATB000
.
RDATB200   MOVE     "Finish             ",TODAT
           MOVE     "99999999",ENDDAT
.
RDATB999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN
.
.----------------------------------------------------------------------
. Purge Order Files
.----------------------------------------------------------------------
PORD0000  CLOCK    TIME,CTIMEIS
          MOVE     "99",CLNO
          MOVE     ZERO,CPAGENO
          DISPLAY  *P1:24,*EL,"Purchase Orders Purged  :"
.
          MOVE     SP70,LASTPRT
          MOVE     ZERO,SCANNED
          MOVE     ZERO,DELETED
          PACK     KEY15,STRDAT,SP70
          CALL     RSSIPA4
PORD1000  CALL     RKSIPA4
          BRANCH   OVRCD,PORD9000
          MATCH    SIPADIN,ENDDAT
          GOTO     PORD9000 IF LESS
          MATCH    SIPADCN,SP70
          GOTO     PORD1010 IF NOT EQUAL
          MATCH    SIPADCM,SP70
          GOTO     PORD1000 IF EQUAL
.
PORD1010  ADD      ONE,SCANNED
          IF       (SCANNED%1000=0)
            DISPLAY   *P25:24,*V2LON,SCANNED
          ENDIF
.
          UNPACK   SIPADPR,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          MOVE     CPCDATE,KEY10
          UNPACK   SIPADIN,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          COMPARE  "56",CLNO
          CALL     PHEAD000 IF NOT LESS
          MOVE     SIPASUP,KEY5
          CALL     RDAPMA1
.
          MOVE     SIPADEL,KEY30
          PRINT    CPCDATE,SP1,KEY10,SP1,SIPAPON,SP1,SIPASUP,SP1,APMASN1:
                   SIPAORI,SP1,SIPAICN,SP1,KEY30
          ADD      ONE,CLNO
.
          CALL     DELC0000    * Delete Comments
.
          PRINT    " "
          ADD      ONE,CLNO
          PACK     KEY7,SIPAPON,SP70
          CALL     RDSIPA1
          IF       OVRCD=0
            CALL     DESIPA1
          ENDIF
          GOTO     PORD1000
.
PORD9000  COMPARE  ZERO,CPAGENO
          CALL     PHEAD000 IF EQUAL
          CALL     UND132
          PRINT    *50,"****** End of Report ******"
.
PORD9999  RETURN
.------------------------------------------------------------
. Heading
.------------------------------------------------------------
PHEAD000  CALL      HEAD132
          PRINT     "Purchase Order Details Purged"
          PRINT     "Date Input From : ",FROMDAT," to ",TODAT
          CALL      UND132
.
          PRINT     "Date Input Date Print P/O     Supplier       ":
                    "                     Ori Internal Contact     ":
                    "          Delivery Details        "
.
          PRINT     "            Itm  Cost Centre  Prd Grp  Ware  ":
                    "  Catalog     Quantity Rec            Value   ":
                    "                                  "
          CALL      UND132
          ADD       "4",CLNO
          RETURN
.-------------------------------------------------
. Delete Comments for Order
.-------------------------------------------------
DELC0000  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPB1
DELC1000  CALL      RKSIPB1
          BRANCH    OVRCD,DELC1900
          MATCH     SIPAPON,SIPBPON
          GOTO      DELC1900 IF NOT EQUAL
          PACK      KEY10,SIPBPON,SIPBLIN
          CALL      DESIPB1
          CALL      RSSIPB1
          GOTO      DELC1000
.
DELC1900  PACK      KEY13,SIPAPON,SP70
          CALL      RSSIPD1
DELC2000  CALL      RKSIPD1
          BRANCH    OVRCD,DELC2900
          MATCH     SIPAPON,SIPDPON
          GOTO      DELC2900 IF NOT EQUAL
          PACK      KEY13,SIPDPON,SIPDITM,SIPDLIN
          CALL      DESIPD1
          CALL      RSSIPD1
          GOTO      DELC2000
.
DELC2900  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
DELC4000  CALL      RKSIPC1
          BRANCH    OVRCD,DELC4900
          MATCH     SIPAPON,SIPCPON
          GOTO      DELC4900 IF NOT EQUAL
.
          COMPARE   "56",CLNO
          CALL      PHEAD000 IF NOT LESS
.
          PRINT     SP10,SP2,SIPCITM,SP2,SIPCCST,SP8,SIPCPRD,SP4,SIPCWAR:
                    SP3,SIPCCAT,SP2,SIPCRQT,SP2,SIPCTCR
          ADD       ONE,CLNO
.
          PACK      KEY10,SIPCPON,SIPCITM
          CALL      DESIPC1
          CALL      RSSIPC1
          GOTO      DELC4000
.
DELC4900  PACK      KEY12,SIPAPON,SP70
          CALL      RSSIPF1
DELC5000  CALL      RKSIPF1
          BRANCH    OVRCD,DELC5900
          MATCH     SIPAPON,SIPFPON
          GOTO      DELC5900 IF NOT EQUAL
          PACK      KEY12,SIPFPON,SIPFITM,SIPFREC
          CALL      DESIPF1
          CALL      RSSIPF1
          GOTO      DELC5000
.
DELC5900
.
DELC9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSMASIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIFIO/INC
          INC       SINITMIO/INC
          INC       SINNATIO/INC
          INC       SINPOAIO/INC
          INC       SINPOBIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINPOFIO/INC
          INC       SINREAIO/INC
          INC       SINREBIO/INC
          INC       SINWARIO/INC
          INC       SINWARKY    
.
          INC       STDGENCD
.
