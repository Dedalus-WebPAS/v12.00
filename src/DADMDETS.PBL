.******************************************************************************
.* Include Name   : DADMDETS.PBL                                              *
.*                                                                            *
.* Function       : To display the PMI and admission details                  *
.*                  NB. This include is used by PATPRG31 & PATPRG32 & IBATRA21*
.*                                                                            *
.* Author(s)      : CHUCK and LOFTY    (12/11/1991)                           *
.*                                                                            *
.* Parameters     : SCRPSTFD record                                           *
.*                                                                            *
.* Returns        : VAR           the data to display                         *
.*                                                                            *
.* Modifications  :                                                           *
.*        V12.00.01 15/05/2025  Nikitha B        TSK 0955096                  *
.*                  Alphanumeric changes                                      *
.*        V10.13.01 21/08/2018  Nicole Torrisi    TSK 0859684                 *
.*                  Added variable 154 - Admitting Point                      *
.******************************************************************************
.*        V10.07.01 19/10/2015  Don Nguyen        CAR 316625                  *
.*                  Added variable 152 & 153 - HCP Case Team code/desc        *
.******************************************************************************
.*        V10.03.03 27/09/2013  Jill Parkinson CAR 292140                     *
.*                  Changed variable 121 to use pmvxmhos (since preadmits     *
.*                  don't have award)                                         *
.*        V10.03.02 17/05/2012  J.Tan          CAR 261728                     *
.*                  Mods variable 587 - Compensable Insurance Code            *
.*        V10.03.01 17/04/2012  Don Nguyen        CAR 261728                  *
.*                  Added variable 151 - Local GP or Practice Name            *
.*        V10.02.01  25/05/2011  Saroeun Soeur    CAR 242008                  *
.*                  DSPVR149 - DSPVR150                                       *
.*        V10.00.01 08/04/2010  Peter Vela        CAR 219433                  *
.*                  Added Extra Doctor Codes and Descriptions                 *
.*                  PMVXEDC1,PMVXEDC2,PMVXEDC3                                *
.*        V9.12.03  16/10/2009  Ebon Clements     CAR 190680                  *
.*                  Fixed pack of VAR after calls to CMPH0000                 *
.*        V9.12.02  21/05/2009  Saroeun Soeur     CAR 197081                  *
.*                  Added attending doc prescriber number DSPVR142            *
.*        V9.12.01  20/05/2009  Saroeun Soeur     CAR 197081                  *
.*                   Added NHS doctor prescriber number DSPVR141              *
.******************************************************************************
.*        V9.10.03  09/09/2008  Ebon Clements     CAR 175728                  *
.*                  Added item 139 - Compensable/Heath Fund Name              *
.*                  Added item 140 - Compensable/Heath Fund Number            *
.*        V9.10.02  25/07/2008  Ebon Clements     CAR 173834                  *
.*                  Added item 137 - Attending doctor format name             *
.*                                   First name initial.Surname               *
.*                  Added item 138 - Attending doctor title                   *
.*        V9.10.01  16/05/2008  Ebon Clements     CAR 166563                  *
.*                  Added item 135 - Attending doctor surgery phone           *
.*                  Added item 136 - Yes/No patient is <= 180 days old        *
.*        V9.09.01  19/09/2007  Steve Armstrong   CAR 124435                  *
.*                  Added item 134 - ACC Number                               *
.******************************************************************************
.*        V9.08.02  08/12/2006  Jill Habasque     CAR 127698                  *
.*                  Added NZ Approval (132) and claim number  (133)           *
.*        V9.08.01  23/11/2006  Steve Armstrong   CAR 125800                  *
.*                  Added Interpreter Name (Sing) - 131                       *
.******************************************************************************
.*        V9.04.01  17/08/2005  Peter Vela CAR 71773                          *
.*                  Added check for Standby patient in variables:             *
.*                  109, 110, 111, 112                                        *
.*        V9.03.01  11/09/2003  Jill Habasque                                 *
.*                  Fixed move of PMHCTITL to SP70 to be pack                 *
.*        V9.02.00  01/06/2002  Bronko Sosic                                  *
.*                  Changed the output got ward/bed in print for CAC          *
.*        V5.08.03  07/12/2000  Tonii  509 mods                               *
.*                  Added new label to print out Casemix payment (Yes/No)     *
.*        V5.08.02  20/07/2000  Steve Downing                                 *
.*                  Fixed display of 'admission source' details               *
.*        V5.08.01  06/06/2000  Jill Habasque                                 *
.*                  Changed from key10 to key14 for the health fund file      *
.*        V5.08.B02 25/02/2000  Greg Horvat      SRF 637565                   *
.*                  Changes for 4 character DRGs                              *
.*        V5.08.B01 24/01/2000  Jill Habasque                                 *
.*                  Added PTMIGSTA                                            *
.*        V5.07.05  17/09/1999  Andrew Peel  SRF  632303                      *
.*                  Fixed to display casemix code description                 *
.*        V5.07.04  24/08/1999  Greg Horvat                                   *
.*                  Removed the closing of patvadaf as it was causing an I*C  *
.*        V5.07.03  10/08/1999  Davin                                         *
.*                  Axed (commented out) all references to PATAXE             *
.*        V5.07.02  08/07/1999  Greg Horvat      99/00 PRS2 Mods              *
.*                  Changed to display the contract variables                 *
.*        V5.07.01  19/03/1998 J.Tan                                          *
.*                  Added provisional MBS                                     *
.*                  07/10/1998  Glenn Berry      5.07 changes                 *
.******************************************************************************
.*          V5.05.01 03/10/1997  Steve Armstrong    THC Label Mods            *
.*                   Added display of Hospital code for LABELINP              *
.******************************************************************************
.*                  03/02/1992    Graeme Williams                             *
.*                  Use PVIRESI for resident status on admn screens           *
.*                  01/04/1992    J.Tan    SRF 113778                         *
.*                  Fixed to recalculate age at pre-adm.                      *
.*                  30/04/1992    Justin Coates                               *
.*                  Allowed for mhvimxbe = 1 ; unknown                        *
.*                  08/06/92 J.Tan    SRF 105066                              *
.*                  Fixed displaying admission source                         *
.*                  29/07/92  ROD                                             *
.*                  Added MHVIATYP                                            *
.*                  21/08/92  ROD                                             *
.*                  If card type = "C" display whole date ddmmyycc            *
.*                  11/09/92 J.Tan    SRF 117083                              *
.*                  Mods to display LGA codes                                 *
.*                  05/11/1992    Justin Coates  Quote 7421                   *
.*                  Added display of ABWGHT                                   *
.*                  and also remove the PMI displays                          *
.*                  21/12/1992    Whirlpool                                   *
.*                  Added display of variables for dudley                     *
.*                  06/04/1993    Steve O'Gorman                              *
.*                  Fixed display on Health Fund Cover Change                 *
.*                  03/11/1993    Justin Coates  QUOTE 440017 SRF 440204      *
.*                  added display of practice count to practice code field    *
.*                  13/12/1993    Ian Rutt    Mt Alvernia  #3.1               *
.*                  added display for Guarantor Details Screen.               *
.*                  07/03/1994    Justin Coates  SRF 440719                   *
.*                  added display of district of residence                    *
.*                  09/06/1994    Justin Coates                               *
.*                  if adate length = 10, display the century                 *
.*                  18/05/1995    Whirlpool     release 5.03                  *
.*                  Added 8 new fields to new file layout    items 92 - 104   *
.*        V5.04.01  03/02/1997  Howellsy                                      *
.*                  Added Screen Painted Labels                               *
.*        V5.04.02  19/02/1997  Howellsy                                      *
.*                  Added AVISIT,PTMIADOC,PTMIREGS,PTMIUYN1,PTMIUYN2          *
.*        V5.04.03  24/05/1995  Paul Howells                                  *
.*                  added aadmno                                              *
.******************************************************************************
DADMDETS  PACK      VAR,SP30,SP30,SP20
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,DSPVR001,DSPVR002,DSPVR003,DSPVR004,DSPVR005:
                            DSPVR006,DSPVR007,DSPVR008,DSPVR009,DSPVR010:
                            DSPVR011,DSPVR012,DSPVR013,DSPVR014,DSPVR015:
                            DSPVR016,DSPVR017,DSPVR018,DSPVR019,DSPVR020:
                            DSPVR021,DSPVR022,DSPVR023,DSPVR024,DSPVR025:
                            DSPVR026,DSPVR027,DSPVR028,DSPVR029,DSPVR030:
                            DSPVR031,DSPVR032,DSPVR033,DSPVR034,DSPVR035:
                            DSPVR036,DSPVR037,DSPVR038,DSPVR039,DSPVR040:
                            DSPVR041,DSPVR042,DSPVR043,DSPVR044,DSPVR045:
                            DSPVR046,DSPVR047,DSPVR048,DSPVR049,DSPVR050:
                            DSPVR051,DSPVR052,DSPVR053,DSPVR054,DSPVR055:
                            DSPVR056,DSPVR057,DSPVR058,DSPVR059,DSPVR060:
                            DSPVR061,DSPVR062,DSPVR063,DSPVR064,DSPVR065:
                            DSPVR066,DSPVR067,DSPVR068,DSPVR069,DSPVR070:
                            DSPVR071,DSPVR072,DSPVR073,DSPVR074,DSPVR075:
                            DSPVR076,DSPVR077,DSPVR078,DSPVR079,DSPVR080:
                            DSPVR081,DSPVR082,DSPVR083,DSPVR084,DSPVR085:
                            DSPVR086,DSPVR087,DSPVR088,DSPVR089,DSPVR090:
                            DSPVR091,DSPVR092,DSPVR093,DSPVR094,DSPVR095:
                            DSPVR096,DSPVR097,DSPVR098,DSPVR099,DSPVR100:
                            DSPVR101,DSPVR102,DSPVR103,DSPVR104,DSPVR105:
                            DSPVR106,DSPVR107,DSPVR108,DSPVR109,DSPVR110:
                            DSPVR111,DSPVR112,DSPVR113,DSPVR114,DSPVR115:
                            DSPVR116,DSPVR117,DSPVR118,DSPVR119,DSPVR120:
                            DSPVR121,DSPVR122,DSPVR123,DSPVR124,DSPVR125:
                            DSPVR126,DSPVR127,DSPVR128,DSPVR129,DSPVR130:
                            DSPVR131,DSPVR132,DSPVR133,DSPVR134,DSPVR135:
                            DSPVR136,DSPVR137,DSPVR138,DSPVR139,DSPVR140:
                            DSPVR141,DSPVR142,DSPVR143,DSPVR144,DSPVR145:
                            DSPVR146,DSPVR147,DSPVR148,DSPVR149,DSPVR150:
                            DSPVR151,DSPVR152,DSPVR153,DSPVR154
          GOTO      DSPVR999
.
. Display Admission Date
. 
DSPVR001  UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        SCPSLEN = TEN
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DSPVR995
.
. Display Admission Time
. 
DSPVR002  PACK      VAR,ATIME,SP70,SP10
          GOTO      DSPVR995
.
. Display Referring Doctor
. 
DSPVR003  PACK      VAR,ADOCTR,SP70,SP10
          GOTO      DSPVR995
.
. Display Referring Doctor description
.
DSPVR004  MOVE      ADOCTR,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
. Display Attending Doctor
. 
DSPVR005  PACK      VAR,ADOCTA,SP70,SP10
          GOTO      DSPVR995
.
. Display Attending Doctor description
.
DSPVR006  MOVE      ADOCTA,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
. Display Local Doctor
.
DSPVR007  PACK      VAR,ADOCTL,SP70,SP10
          GOTO      DSPVR995
.
. Display Admission Source
.
DSPVR008  PACK      VAR,ASRCE,SP70,SP10
          GOTO      DSPVR995
.
. Display Source Description
.
DSPVR009  PACK      VAR,SP70,SP10
          MATCH     SP3,ASRCE
          IF        !@EQUAL
            PACK      KEY5,ANSS,SP1,ASRCE
            CALL      RDCODE1
            PACK      VAR,TDESC,SP70,SP10
            IF        PTCNUADT = ONE
              MATCH     "1",TCINDC2         * if second ind = 1 do this crap
              IF        @EQUAL
                MATCH     ZEROVISN,AADMNO
                IF        !@EQUAL
                  OPEN      PATDADA1,"patdadaf"
                  MOVE      AADMNO,KEY8
                  CALL      RDPTDAD1
                  CLOSE     PATDADA1
                ELSE
                  MOVE      ZERO,OVRCD
                ENDIF
                IF        OVRCD = ZERO
                  MATCH     SP5,PTDAADTS          * is the code blank
                  IF        !@EQUAL
                    OPEN      PATVADA1,"patvadaf"
                    MOVE      PTDAADTS,KEY5
                    CALL      RDPTVAD1
                    IF        OVRCD = ZERO
                      PACK      VAR,PTVADESC,SP70
                    ENDIF                            * OVRCD = ZERO
                  ENDIF                            * !@EQUAL
                ENDIF                            * OVRCD = ZERO
              ENDIF                            * @EQUAL
            ENDIF                            * PTCNAUDT = ONE
          ENDIF                            * !@EQUAL
          GOTO      DSPVR995
.
. Display Admission Type
.
DSPVR010  PACK      VAR,ATYPE,SP70,SP10
          GOTO      DSPVR995
.
. Display Admission type Description
.
DSPVR011  PACK      TCODE,ANSA,SP1
          MOVE      ATYPE,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Admission Class
.
DSPVR012  PACK      VAR,ACLSS,SP70,SP10
          GOTO      DSPVR995
.
. Display Admission Class Description
.
DSPVR013  PACK      TCODE,ANSP,SP1
          MOVE      ACLSS,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Care class
.
DSPVR014  PACK      VAR,ACARE,SP70,SP10
          GOTO      DSPVR995
.
. Display Care class Description
.
DSPVR015  PACK      TCODE,ANSC,ANSC
          MOVE      ACARE,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Health fund
.
DSPVR016  PACK      VAR,AFUNDH,SP70,SP10
          GOTO      DSPVR995
.
. Display Health fund table
.
DSPVR017  PACK      VAR,AFNDTB,SP70,SP10
          GOTO      DSPVR995
.
. Display Health fund table Description
.
DSPVR018  MOVE      SP70,HFNAME
          OPEN      PATFN1A1,"patfn1af"
          PACK      KEY14,AFUNDH,AFNDTB,SP10
          CALL      RDFUND1
          PACK      VAR,HFNAME,SP70,SP10
          GOTO      DSPVR995
.
. Display Patient Membership No.
.
DSPVR019  PACK      VAR,AFNDMM,SP70,SP10
          GOTO      DSPVR995
.
. Display Treating Doctor
.
DSPVR020  PACK      VAR,ADOCTT,SP70,SP10
          GOTO      DSPVR995
.
. Treating Doctor description
.
DSPVR021  MOVE      ADOCTT,KEY6
          CALL      DXPATDOC                      * set up doctors name
          GOTO      DSPVR999
.
. Display Department
.
DSPVR022  PACK      VAR,ACLSSFT,SP70,SP10
          GOTO      DSPVR995
.
. Display Department Description
.
DSPVR023  PACK      TCODE,ANSA,ANSC
          MOVE      ACLSSFT,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display MBS code
.
DSPVR024  PACK      VAR,AMBS,SP70,SP10
          GOTO      DSPVR995
.
. Display Diagnosis description 1
.
DSPVR025  PACK      VAR,ADIAG1,SP70
          GOTO      DSPVR995
.
. Display Claim
.
DSPVR026  PACK      VAR,ACLAIM,SP70,SP10
          GOTO      DSPVR995
.
. Display Claim Description
.
DSPVR027  PACK      TCODE,ANSC,ANSL
          MOVE      ACLAIM,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Diet code
.
DSPVR028  PACK      VAR,ADIET,SP70,SP10
          GOTO      DSPVR995
.
. Display Diet Description
.
DSPVR029  PACK      TCODE,ANSD,ANSC
          MOVE      ADIET,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Length of Stay
.
DSPVR030  PACK      VAR,ASTAY,SP70,SP10
          GOTO      DSPVR995
.
. Display No. Days of Hospitalisation
.
DSPVR031  PACK      VAR,ADYHOSP,SP70,SP10
          GOTO      DSPVR995
.
. Display Member?
.
DSPVR032  MOVE      DNO,KEY3
          LOAD      KEY3,AMEMB,DYES,DNO
          PACK      VAR,KEY3,SP70,SP10
          GOTO      DSPVR995
.
. Display Membership Number
.
DSPVR033  PACK      VAR,AMEMBNO,SP70,SP10
          GOTO      DSPVR995
.
. Display User Defined 1
.
DSPVR034  PACK      VAR,AUSR1,SP70,SP10
          GOTO      DSPVR995
.
. Display User 1 Description
.
DSPVR035  PACK      TCODE,ANSU,ONE
          MOVE      AUSR1,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display User Defined 2
.
DSPVR036  PACK      VAR,AUSR2,SP70,SP10
          GOTO      DSPVR995
.
. Display User 2 Description
.
DSPVR037  PACK      TCODE,ANSU,TWO
          MOVE      AUSR2,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display User Defined 3
.
DSPVR038  PACK      VAR,AUSR3,SP70,SP10
          GOTO      DSPVR995
.
. Display User 3 Description
.
DSPVR039  PACK      TCODE,ANSU,THREE
          MOVE      AUSR3,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display User Defined 4
.
DSPVR040  PACK      VAR,AUSR4,SP70,SP10
          GOTO      DSPVR995
.
. Display User 4 Description
.
DSPVR041  PACK      TCODE,ANSU,FOUR
          MOVE      AUSR4,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display User Defined 5
.
DSPVR042  PACK      VAR,AUSR5,SP70,SP10
          GOTO      DSPVR995
.
. Display User 5 Description
.
DSPVR043  PACK      TCODE,ANSU,FIVE
          MOVE      AUSR5,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display User Defined 6
.
DSPVR044  PACK      VAR,AUSR6,SP70,SP10
          GOTO      DSPVR995
.
. Display User 6 Description
.
DSPVR045  PACK      TCODE,ANSU,SIX
          MOVE      AUSR6,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display User Defined 7
.
DSPVR046  PACK      VAR,AUSR7,SP70,SP10
          GOTO      DSPVR995
.
. Display User 7 Description
.
DSPVR047  PACK      TCODE,ANSU,SEVEN
          MOVE      AUSR7,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Free format Referring doctor
.
DSPVR048  PACK      VAR,ARDRNAM,SP70,SP10
          GOTO      DSPVR995
.
. Display Yrs of fund membership
.
DSPVR049  PACK      VAR,AFNDYY,SP70,SP10
          GOTO      DSPVR995
.
. Display Fund cover change
.
DSPVR050  UNPACK    AFNDCG,CCENT,CYEAR,CMON
          PACK      VAR,CMON,SLASH,CCENT,CYEAR,SP70,SP10
          GOTO      DSPVR995
.
. Display Resident status
.
DSPVR051  PACK      VAR,PVIRESI,SP70,SP10
          MATCH     SP3,VAR
          GOTO      DSPVR995 IF NOT EQUAL
          PACK      VAR,PTYPE,SP70,SP10
          GOTO      DSPVR995
.
. Display Resident status description
.
DSPVR052  PACK      TCODE,ANST,SP1
          PACK      ACODE,PVIRESI,SP3
          MATCH     SP3,ACODE
          IF        @EQUAL
            MOVE      PTYPE,ACODE
          ENDIF
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Diagnosis description 2
.
DSPVR053  PACK      VAR,ADIAG2,SP70,SP10
          GOTO      DSPVR995
.
. display card number 
.
DSPVR054  PACK      VAR,PTMXCARD,SP70,SP10
          GOTO      DSPVR995
.
. display card expiry date 
.
DSPVR055  UNPACK    PTMXCEXP,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      VAR,CPCDATE,SP70,SP10
          GOTO      DSPVR995
.
. display exemption code
.
DSPVR056  PACK      VAR,PTMXCXMP,SP30,SP30,SP20
          GOTO      DSPVR995
.
. display exemption code description
.
DSPVR057  PACK      TCODE,ANSX,ANSM
          MOVE      PTMXCXMP,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Display Family Id
.
DSPVR058  PACK      VAR,PTMXFMLY,SP30,SP30,SP20
          GOTO      DSPVR995
.
. display Health fund description
.
DSPVR059  PACK      HFNAME,SP30
          PACK      KEY14,AFUNDH,ZERO,ZERO,ZERO,ZERO,SP10
          OPEN      PATFN1A1,"patfn1af"
          CALL      RDFUND1
          PACK      VAR,HFNAME,SP30
          GOTO      DSPVR995
.
. display previous visits
.
DSPVR060  PACK      VAR,PTMIPVIS,SP70,SP10
          GOTO      DSPVR995
.
. display Admission weight
.
DSPVR061  PACK      VAR,ABWGHT,SP70,SP10
          GOTO      DSPVR995
.
. Registered GP Code
.
DSPVR062  PACK      VAR,PMVXRHC1,SP70,SP10
          GOTO      DSPVR995
.
. Registered GP Name
.
DSPVR063  PACK      PMHCSNAM,SP70
          PACK      PMHCGNAM,SP70
          PACK      PMHCTITL,SP70
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME
          PACK      VAR,PACFNAME,SP70,SP10
          GOTO      DSPVR995
.
. GP Practice code
.
DSPVR064  MOVE      "-",ANS
          MATCH     SP2,PMVXRH1C
          IF        @EQUAL
            MOVE      SP1,ANS
          ENDIF
          PACK      VAR,PMVXRH1G,ANS,PMVXRH1C,SP70,SP10
          GOTO      DSPVR995
.
. GP Practice name
.
DSPVR065  PACK      PMHGPNAM,SP70
          PACK      KEY10,PMVXRH1G,SP70
          PACK      KEY12,KEY10,PMVXRH1C,SP70
          CALL      RDPMHCG1
          PACK      VAR,PMHGPNAM,SP70,SP10
          GOTO      DSPVR995
.
. GP Practice Address Line 1
.
DSPVR066  PACK      PMHGADD1,SP70,SP10
          PACK      KEY10,PMVXRH1G,SP70
          PACK      KEY12,KEY10,PMVXRH1C,SP70
          CALL      RDPMHCG1
          PACK      VAR,PMHGADD1,SP70,SP10
          GOTO      DSPVR995
.
. GP Phone Number
.
DSPVR067  PACK      VAR,SP70,SP10
          GOTO      DSPVR995
.
. GPFH Approval Number
.
DSPVR068  PACK      VAR,PTMSFHAN,SP70,SP10
          GOTO      DSPVR995
.
. ECR Approval Number
.
DSPVR069  PACK      VAR,PTMSECRA,SP70,SP10
          GOTO      DSPVR995
.
. Management Intent
.
DSPVR070  PACK      VAR,PTMSMGIN,SP70,SP10
          GOTO      DSPVR995
.
. Management Intent Description
.
DSPVR071  PACK      TCODE,ANSM,ANSI
          MOVE      PTMSMGIN,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Guarantor Type
.
DSPVR072 
.>>>>     PACK      VAR,PTAXGUTY,SP70,SP10
          GOTO      DSPVR995
.
. Gurantor I/C Number
.
DSPVR073 
.>>>>     PACK      VAR,PTAXGUIN,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor I/C Type
.
DSPVR074
.>>>>     PACK      VAR,PTAXGUIT,SP70,SP10
          GOTO      DSPVR995 
.
. Guarantor I/C Type Description
.
DSPVR075
.>>>>     MATCH     SP3,PTAXGUIT
.>>>>     IF        @EQUAL
.>>>>       PACK      TDESC,SP70,SP10
.>>>>       PACK      VAR,TDESC,SP70,SP10
.>>>>       GOTO      DSPVR995
.>>>>     ENDIF
.
.>>>>     IF        PTAXGUTY > TWO 
.>>>>       PACK      KEY5,ANSP,THREE,PTAXGUIT,SP3 
.>>>>       CALL      RDCODE1                    * Only display Type descr.
.>>>>       PACK      VAR,TDESC,SP70,SP10        * when PTAXGUTY = 3 or 4
.>>>>     ELSE
.>>>>       PACK      VAR,SP70,SP10
.>>>>     ENDIF 
          GOTO      DSPVR995
.
. Guarantor Name
.
DSPVR076
.>>>>     PACK      VAR,PTAXGUNM,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Address Line 1
.
DSPVR077
.>>>>     PACK      VAR,PTAXGUA1,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Address Line 2
.
DSPVR078
.>>>>     PACK      VAR,PTAXGUA2,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Address Line 3  
.
DSPVR079
.>>>>     PACK      VAR,PTAXGUA3,SP70,SP10 
          GOTO      DSPVR995
.
. Guarantor Address Line 4
.
DSPVR080
.>>>>     PACK      VAR,PTAXGUA4,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Post Code
.
DSPVR081
.>>>>     PACK      VAR,PTAXGUPC,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Telephone
.
DSPVR082
.>>>>     PACK      VAR,PTAXGUPH,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Occupation
.
DSPVR083
.>>>>     PACK      VAR,PTAXGUOC,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Employer Code 
.
DSPVR084
.>>>>     PACK      VAR,PTAXGUEC,SP70,SP10
          GOTO      DSPVR995
.
. Guarantor Employer Code Description
.
DSPVR085
.>>>>     MATCH     SP6,PTAXGUEC
.>>>>     IF        @EQUAL
.>>>>       PACK      GNAME,SP70,SP10
.>>>>       PACK      VAR,GNAME,SP70,SP10
.>>>>       GOTO      DSPVR995
.>>>>     ENDIF
.
.>>>>     IF        PTAXGUTY > TWO
.>>>>       PACK      KEY6,PTAXGUEC,SP6
.>>>>       CALL      RDGOVR1
.>>>>       PACK      VAR,GNAME,SP70,SP10
.>>>>       GOTO      DSPVR995  
.>>>>     ELSE
.>>>>       GOTO      DSPVR999
.>>>>     ENDIF
          GOTO      DSPVR995
.
. Guarantor Relationship 
.
DSPVR086
.>>>>     PACK      VAR,PTAXGURL,SP70,SP10
          GOTO      DSPVR995
.
DSPVR087
.>>>>     PACK      VAR,SP70,SP10 
.>>>>     MOVE      SCPSCOL,CCOL
.>>>>     MOVE      SCPSROW,CVERT
.>>>>     DISPLAY   *PCCOL:CVERT,*EL
.>>>>     IF        (PTAXGUTY = ONE) & (PTAXGUTY > ZERO)
.>>>>       PACK      VAR,PTMAEMPC,SP70,SP10
.>>>>     ELSE
.>>>>       IF        (PTAXGUTY = TWO) & (PTAXGUTY > ZERO)
.>>>>         PACK      VAR,HCODE,SP70,SP10
.>>>>       ELSE
.>>>>         GOTO      DSPVR999  
.>>>>       ENDIF 
.>>>>     ENDIF
.
          CALL      GINS0000                     * Get TAC/WComp Insurance Code
.
          GOTO      DSPVR995
.
DSPVR088
.>>>>     CALL      GDESC000
          GOTO      DSPVR995 
.
. District of Residence
.
DSPVR089  PACK      VAR,PTMIDOFR,SP70,SP10
          GOTO      DSPVR995
.
DSPVR090  PACK      TCODE,ANSD,ANSA
          MOVE      PTMIDOFR,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. GP code (no practice)
.
DSPVR091  PACK      VAR,PMVXRHC1,SP70,SP10
          GOTO      DSPVR995
.
. Date of Refferal
.
DSPVR092  UNPACK    PTMIREFD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        SCPSLEN = TEN
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DSPVR995
.
. Date of 1st Consultation
.
DSPVR093  UNPACK    PTMIDFCN,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        SCPSLEN = TEN
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DSPVR995
.
. Principle Health Service Purchaser (Cat HP)
.
DSPVR094  PACK      VAR,PTMIPHPU,SP70,SP10
          GOTO      DSPVR995
.
. Principle Health Service Purchaser (Cat HP) Description
.
DSPVR095  PACK      TCODE,ANSH,ANSP
          MOVE      PTMIPHPU,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Health Agency (CAT HA)
.
DSPVR096  PACK      VAR,PTMIAGNC,SP70,SP10
          GOTO      DSPVR995
.
. Health Agency (CAT HA) Description
.
DSPVR097  PACK      TCODE,ANSH,ANSA
          MOVE      PTMIAGNC,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Event Summary Suppress Flag
.
DSPVR098  MATCH     ANSY,PTMIESSF
          IF        @EQUAL
            PACK      VAR,DYES,SP70,SP10
          ELSE
            PACK      VAR,DNO,SP70,SP10
          ENDIF
          GOTO      DSPVR995
.
. User defined field 8
.
DSPVR099  PACK      VAR,PTMIUSR8,SP70,SP10
          GOTO      DSPVR995
.
. User defined field 8 Description
.
DSPVR100  PACK      TCODE,ANSU,EIGHT
          MOVE      PTMIUSR8,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. User defined field 9
.
DSPVR101  PACK      VAR,PTMIUSR9,SP70,SP10
          GOTO      DSPVR995
.
. User defined field 9 Description
.
DSPVR102  PACK      TCODE,ANSU,NINE
          MOVE      PTMIUSR9,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. User defined field 0
.
DSPVR103  PACK      VAR,PTMIUSR0,SP70,SP10
          GOTO      DSPVR995
.
. User defined field 0 Description
.
DSPVR104  PACK      TCODE,ANSU,ZERO
          MOVE      PTMIUSR0,ACODE
          CALL      DXPATCOD
          GOTO      DSPVR999
.
. Provisional DRG code
.
DSPVR105  PACK      VAR,PTMIPDRG,SP70,SP10
          GOTO      DSPVR995
.
. Provisional DRG description
.
DSPVR106  MOVE      SP30,PTDWDESC
          PACK      KEY4,PTMIPDRG
          CALL      RDPTDGW1
          PACK      VAR,PTDWDESC,SP70,SP70
          GOTO      DSPVR995
.
DSPVR107  PACK      VAR,PTMIOPER,SP70,SP10    * security code         
          GOTO      DSPVR995
.
DSPVR108  MOVE      SP70,SECUSER
          MATCH     SP4,PTMIOPER
          IF        !@EQUAL
            CALL      OPPASS1
            PACK      KEY4,PTMIOPER,SP6
            CALL      RDPASS1  
          ENDIF
          PACK      VAR,SECUSER,SP70,SP10
          GOTO      DSPVR995
.
DSPVR109  IF        ASTAT = ONE
            PACK      VAR,PTMIXWRD,SP70,SP10  * ward code
          ELSE
            MATCH     SP70,AWARD
            GOTO      DSPVR09A IF EQUAL
            PACK      VAR,AWARD,SP70,SP10     * ward code
          ENDIF
          GOTO      DSPVR995
.
DSPVR09A  PACK      KEY14,AADMNO,SP70
          CALL      RDSWARD4
          CALL      RDKWARD4
          IF        OVRCD=0
            MATCH     WSTBY,AADMNO
            IF        @EQUAL
              PACK      VAR,WWARD,SP70,SP10
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR110  MOVE      SP30,WBDESC             * ward code
          IF        ASTAT = ONE
            MOVE      PTMIXWRD,KEY3           * ward code
          ELSE
            MATCH     SP70,AWARD
            GOTO      DSPVR10A IF EQUAL
            MOVE      AWARD,KEY3              * ward code
          ENDIF
          PACK      KEY6,KEY3,SP3
          CALL      RDWARD1
          PACK      VAR,WBDESC,SP70,SP70
          GOTO      DSPVR995
.
DSPVR10A  PACK      KEY14,AADMNO,SP70
          CALL      RDSWARD4
          CALL      RDKWARD4
          IF        OVRCD=0
            MATCH     WSTBY,AADMNO
            IF        @EQUAL
              PACK      VAR,WBDESC,SP70,SP70
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR111  IF        ASTAT = ONE
            PACK      VAR,PTMIXWRD,SLASH,PTMIEBED,SP70,SP10     * ward/bed code
          ELSE 
            MATCH     SP70,AWARD
            GOTO      DSPVR11A IF EQUAL
            PACK      VAR,AWARD,SLASH,ABED,SP70,SP10     * ward/bed code
          ENDIF
          GOTO      DSPVR995
.
DSPVR11A  PACK      KEY14,AADMNO,SP70
          CALL      RDSWARD4
          CALL      RDKWARD4
          IF        OVRCD=0
            MATCH     WSTBY,AADMNO
            IF        @EQUAL
              PACK      VAR,WWARD,SLASH,WBED,SP70,SP10
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR112  MOVE      SP30,WBDESC             * ward code
          MATCH     SP70,AWARD
          GOTO      DSPVR12A IF EQUAL
          PACK      KEY6,AWARD,ABED
          CALL      RDWARD1
          PACK      VAR,WBDESC,SP70,SP70
          GOTO      DSPVR995
.
DSPVR12A  PACK      KEY14,AADMNO,SP70
          CALL      RDSWARD4
          CALL      RDKWARD4
          IF        OVRCD=0
            MATCH     WSTBY,AADMNO
            IF        @EQUAL
              PACK      VAR,WBDESC,SP70,SP10
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
. Display Religion Y/N
.
DSPVR113  MOVE      DNO,KEY3
          LOAD      KEY3,AVISIT,DYES,DNO
          PACK      VAR,KEY3,SP70,SP10
          GOTO      DSPVR995
.
. Display Associated Doctor
. 
DSPVR114  PACK      VAR,PTMIADOC,SP70,SP10
          GOTO      DSPVR995
.
. Display Associated Doctor Description
.
DSPVR115  MOVE      PTMIADOC,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
. Display Registrar
. 
DSPVR116  PACK      VAR,PTMIREGS,SP70,SP10
          GOTO      DSPVR995
.
. Display Registrar Description
.
DSPVR117  MOVE      PTMIREGS,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
. Display User Defined Y/N Field 1
.
DSPVR118  IF        PTMIUYN1 = 1
            MOVE      DYES,CCITEMD
          ELSE
            MOVE      DNO,CCITEMD
          ENDIF
          PACK      VAR,CCITEMD,SP70,SP10   * Yes/No field 1
          GOTO      DSPVR995
.
. Display User Defined Y/N Field 2
.
DSPVR119  IF        PTMIUYN2 = 1
            MOVE      DYES,CCITEMD
          ELSE
            MOVE      DNO,CCITEMD
          ENDIF
          PACK      VAR,CCITEMD,SP70,SP10   * Yes/No field 1
          GOTO      DSPVR995
. 
DSPVR120  PACK      VAR,AADMNO,SP70,SP10
          GOTO      DSPVR995
.
DSPVR121  MATCH     SP70,PMVXMHOS
          IF        !@EQUAL
            PACK      VAR,PMVXMHOS,SP70,SP10
            GOTO      DSPVR995
          ENDIF
          PACK      KEY6,AWARD,SP6          * hospital code
          CALL      RDWARD1
          PACK      VAR,PTWDHOSN,SP70,SP10
          GOTO      DSPVR995
. 
.         Casemix code
.
DSPVR122  PACK      VAR,PTMIPCMX,SP70,SP10
          GOTO      DSPVR995
.
.   Casemix code description
.
DSPVR123  PACK      KEY9,PTMIPCMX
          OPEN      PATCMCA1,"patcmcaf"
          CALL      RDPTCMC1
          CLOSE     PATCMCA1
          IF        OVRCD = 1
            PACK      VAR,SP70,SP70,SP70,SP70
          ELSE
            PACK      VAR,PTCADES1,SP70,SP70     * Casemix code
          ENDIF
.
          GOTO      DSPVR995
. 
. ----- PATASFFD variables -----
.
DSPVR124  PACK      VAR,PTAFCODE,SP70,SP10  * Funding arrangement code
          GOTO      DSPVR995
.
DSPVR125  PACK      VAR,PTAFCTYP,SP70,SP10  * Contract type
          GOTO      DSPVR995
.
DSPVR126  PACK      VAR,PTAFCROL,SP70,SP10  * Contract role
          GOTO      DSPVR995
.
DSPVR127  PACK      VAR,PTAFCSID,SP70,SP10  * Contract/spoke id
          GOTO      DSPVR995
.
DSPVR128  PACK      KEY5,PTAFCSID
          OPEN      PATVADA1,"patvadaf"
          CALL      RDPTVAD1                * Read a transfer source file record
          IF        OVRCD<>1
            PACK      VAR,PTVADESC,SP70,SP10 * Contract/spoke id description
          ENDIF
          GOTO      DSPVR995
.
DSPVR129  PACK      VAR,SP70,SP10
          MATCH     ANSY,PTMIGSTA
          IF        @EQUAL
            PACK      VAR,DYES,SP70,SP10
          ELSE
            MATCH     ANSN,PTMIGSTA
            IF        @EQUAL
              PACK      VAR,DNO,SP70,SP10
            ELSE
              MATCH     ANSU,PTMIGSTA
              IF        @EQUAL
                MOVE      "Unknown                  ",VAR
              ENDIF
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR130  MATCH     ANSY,PTMICMXP
          IF        @EQUAL
            PACK      VAR,DYES,SP70,SP10
          ELSE
            PACK      VAR,DNO,SP70,SP10
          ENDIF
          GOTO      DSPVR995
.
DSPVR131  PACK      VAR,PMVXUDF2,SP70,SP10       * Interpreter Name (Sing)
          GOTO      DSPVR995
.
DSPVR132  PACK      VAR,NZSPAPRV,SP70,SP70
          GOTO      DSPVR995
.
DSPVR133  PACK      VAR,NZSPCLNO,SP70,SP70
          GOTO      DSPVR995
.
DSPVR134  PACK      VAR,SP70,SP10
          OPEN      PATWC1A1,"patwc1af"          * ACC Number
          MOVE      AADMNO,KEY8
          CALL      RDWCOM1
          IF        OVRCD = 0
            MATCH     SP20,WCCLMNO
            IF        !@EQUAL
              PACK      VAR,WCCLMNO,SP70,SP10
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR135  PACK      VAR,SP70,SP10                * Attending Doctor Surgery
          MATCH     SP6,ADOCTA                   * phone
          IF        !@EQUAL
            PACK      KEY6,ADOCTA,SP70
            CALL      RDDOCT1
            IF        OVRCD = 0
              PACK      VAR,DTELES,SP70,SP10
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR136  MOVE      ZERO,FORM8                   * Yes/No patient is <= 180
          DAYSEP    PBDATE,ADATE,FORM8           * days old
          IF        FORM8 > 180
            PACK      VAR,DNO,SP70               * > 180 days old
          ELSE      
            PACK      VAR,DYES,SP70              * <= 180 days old
          ENDIF
          GOTO      DSPVR995
.
DSPVR137  PACK      VAR,SP70,SP10                * Attending Doctor Surgery
          MATCH     SP6,ADOCTA                   * format name
          IF        !@EQUAL 
            PACK      KEY6,ADOCTA,SP70           * First Name Initial.Surname
            CALL      RDDOCT1
            IF        OVRCD = 0
              MOVE      DGNAME,D1
              PACK      VAR,D1,DOT,DSNAME,SP70,SP10
            ENDIF                         
          ENDIF             
          GOTO      DSPVR995
.
DSPVR138  PACK      VAR,SP70,SP10                * Attending Doctor Title   
          MATCH     SP6,ADOCTA                  
          IF        !@EQUAL
            PACK      KEY6,ADOCTA,SP70     
            CALL      RDDOCT1
            IF        OVRCD = 0
              PACK      VAR,DTITL,SP70,SP10
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR139  MOVE      ACLAIM,CLAIMCOD
          CALL      CMPH0000
          PACK      VAR,CLMDET1,SP70,SP10
          GOTO      DSPVR995
.
DSPVR140  MOVE      ACLAIM,CLAIMCOD
          CALL      CMPH0000    
          PACK      VAR,CLMDET2,SP70,SP10
          GOTO      DSPVR995
.
. Presciber number (referring doctor)
.
DSPVR141  PACK      KEY8,AADMNO,SP70
          CALL      RDPMVX11
          BRANCH    OVRCD,DSPVR999
          PACK      KEY10,PMVXRHC1,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DSPVR999
          PACK      VAR,PMHCNHSN,SP70
          GOTO      DSPVR995
.
. Prescriber number (attending doctor)
.
DSPVR142  PACK      KEY8,AADMNO,SP70
          CALL      RDMISS1
          BRANCH    OVRCD,DSPVR999
          PACK      KEY10,ADOCTA,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DSPVR999
          PACK      VAR,PMHCNHSN,SP70
          GOTO      DSPVR995
.
. Extra Doctor Code 1
.
DSPVR143  PACK      VAR,PMVXEDC1,SP70
          GOTO      DSPVR995
.
. Extra Doctor Description 1
.
DSPVR144  MOVE      PMVXEDC1,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
. Extra Doctor Code 2
.
DSPVR145  PACK      VAR,PMVXEDC2,SP70
          GOTO      DSPVR995
.
. Extra Doctor Description 2
.
DSPVR146  MOVE      PMVXEDC2,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
. Extra Doctor Code 3
.
DSPVR147  PACK      VAR,PMVXEDC3,SP70
          GOTO      DSPVR995
.
. Extra Doctor Description 3
.
DSPVR148  MOVE      PMVXEDC3,KEY6
          CALL      DXPATDOC
          GOTO      DSPVR999
.
DSPVR149  MOVE      SP70,VAR
          PACK      PTHFHGRP,SP70
          PACK      KEY8,AADMNO,SP70
          CALL      RDMISS1
          IF        OVRCD=1
            GOTO      DSPVR999
          ENDIF
.
          CALL      FDHL0000
          MATCH     SP70,PTHFHGRP
          IF        @EQUAL
            MOVE      PTHFHGRP,VAR
          ENDIF
.
          GOTO      DSPVR995
.
DSPVR150  MOVE      SP70,VAR
          PACK      KEY8,AADMNO,SP70
          PACK      PTHFHGRP,SP70
          PACK      PTHGDESC,SP70
.
          CALL      RDMISS1
          IF        OVRCD=1
            MOVE      SP70,VAR
            GOTO      DSPVR999
          ENDIF
.
          CALL    FDHL0000
          PACK    KEY6,PTHFHGRP,SP70
          CALL    RDPAHGP1
          IF      OVRCD=1
            MOVE    SP70,VAR
          ELSE
            MOVE  PTHGDESC,VAR
          ENDIF
.
          GOTO      DSPVR995
.
DSPVR151  PACK      VAR,SP70,SP70
          PACK      PMHCTITL,SP70
          PACK      PMHCGNAM,SP70
          PACK      PMHCSNAM,SP70
          MOVE      FIVE,F2                       * Local GP Formatted Full Name
          CALL      DAHCP000
.
          MATCH     SP70,PMHCSNAM
          IF        @EQUAL
            PACK      PMHGPNAM,SP70
            MOVE      TWO,F2                      * HCP Practice Name
            CALL      DAHCG000
            GOTO      DSPVR995
          ENDIF
.
          GOTO      DSPVR995
.
.         HCP Case Team
.
DSPVR152  MOVE      PMVXCASE,VAR
          GOTO      DSPVR995
.
DSPVR153  MOVE      SP70,VAR
          MATCH     SP70,PMVXCASE
          IF        !@EQUAL
            PACK      KEY10,PMVXCASE,SP70
            CALL      RDALCAS1
            IF        OVRCD=0
              MOVE      ALCADESC,VAR
            ENDIF
          ENDIF
          GOTO      DSPVR995
.
DSPVR154  PACK      VAR,SP70,SP70
          MATCH     SP70,PMVXAPWD
          IF        !@EQUAL
            PACK      KEY5,CATap,PMVXAPWD
            CALL      RDCODE1
            IF        OVRCD=0
              PACK      VAR,TDESC,SP70,SP10
            ENDIF
          ENDIF
.
          GOTO      DSPVR995
.
DSPVR995  CALL      DISPITEM
.
DSPVR999  RETURN
.******************************************************************************
. Displays the Guarantor type Description
.******************************************************************************
.>>>>GDESC000  BRANCH    PTAXGUTY,GDESC010,GDESC020,GDESC030,GDESC040
.
.>>>>          MOVE      "No Guarantor",VAR
.>>>>          GOTO      GDESC050   
.
.>>>>GDESC010  MOVE      "Employer",VAR
.>>>>          GOTO      GDESC050
.
.>>>>GDESC020  MOVE      "Insurance Company",VAR
.>>>>          GOTO      GDESC050
.
.>>>>GDESC030  MOVE      "Next of Kin",VAR
.>>>>          GOTO      GDESC050
.
.>>>>GDESC040  MOVE      "Other Person",VAR
.
.>>>>GDESC050  ENDSET    VAR
.>>>>          APPEND    SP70,VAR
.>>>>          RESET     VAR
.
.>>>>GDESC999  RETURN
+
.--------------------------------------------------------------------
.         Find Health Fund Group
.--------------------------------------------------------------------
.
FDHL0000  MOVE      SP70,VAR
          MOVE      "0000    ",DIM8
          PACK      KEY14,AFUNDH,DIM8,SP70
          CALL      RDFUND1
          IF        OVRCD<>1
            MATCH     HCODE,AFUNDH
            GOTO      FDHL9999 IF NOT EQUAL
.          
            MATCH     SP70,PTHFHGRP
            IF        @EQUAL
              MOVE      SP70,VAR
            ELSE
              MOVE    PTHFHGRP,VAR
            ENDIF
          ENDIF
.
FDHL9999  RETURN
.
.------------------------------------------------------------
.  HCP Details (pmi based) PMPXRHC1
.  Parameters: F2 (PMSHCP variable)
.------------------------------------------------------------
DAHCP000  PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DAHCP999
.
          BRANCH    F2,DAHCP010,DAHCP020,DAHCP030,DAHCP040,DAHCP050
.
          GOTO      DAHCP999
.
DAHCP010  MOVE      PMHCMOBN,VAR
          GOTO      DAHCP999
.
DAHCP020  MOVE      PMHCPAGR,VAR
          GOTO      DAHCP999
.
DAHCP030  MOVE      PMHCPAGN,VAR
          GOTO      DAHCP999
.
DAHCP040  MOVE      PMHCPRV1,VAR
          GOTO      DAHCP999
.
DAHCP050  MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VAR
          GOTO      DAHCP999
.
DAHCP999  RETURN
.
.------------------------------------------------------------
.  HCP Practice Details (pmi based) PMPXRH1G
.  Parameters: F2 (PMSHCG variable)
.------------------------------------------------------------
DAHCG000  PACK      KEY10,PMPXRH1G,SP70
          PACK      KEY12,KEY10,PMPXR1GC,SP70
          CALL      RDPMHCG1
          BRANCH    OVRCD,DAHCG999
.
          BRANCH    F2,DAHCG010,DAHCG020,DAHCG030,DAHCG040,DAHCG050:
                       DAHCG060,DAHCG070,DAHCG080,DAHCG090,DAHCG100:
                       DAHCG110,DAHCG120,DAHCG130
.
          GOTO      DAHCG9999
.
DAHCG010  MOVE      PMHGPRAC,VAR
          GOTO      DAHCG999
.
DAHCG020  MOVE      PMHGPNAM,VAR
          GOTO      DAHCG999
.
DAHCG030  MOVE      PMHGADD1,VAR
          GOTO      DAHCG999
.
DAHCG040  MOVE      PMHGADD2,VAR
          GOTO      DAHCG999
.
DAHCG050  MOVE      PMHGADD3,VAR
          GOTO      DAHCG999
.
DAHCG060  MOVE      PMHGADD4,VAR
          GOTO      DAHCG999
.
DAHCG070  MOVE      PMHGADD5,VAR
          GOTO      DAHCG999
.
DAHCG080  MOVE      PMHGADD6,VAR
          GOTO      DAHCG999
.
DAHCG090  MOVE      PMHGPTEL,VAR
          GOTO      DAHCG999
.
DAHCG100  MOVE      PMHGPFAX,VAR
          GOTO      DAHCG999
.
DAHCG110  MOVE      PMHGPPNO,VAR
          GOTO      DAHCG999
.
DAHCG120  MOVE      PMHGSTAT,VAR
          GOTO      DAHCG999
.
DAHCG130  MOVE      PMHGPOST,VAR
          GOTO      DAHCG999
.
DAHCG999  RETURN
.
.------------------------------------------------------------
.         Get Insurance code for TAC/Workers Comp.
.------------------------------------------------------------
GINS0000  PACK      VAR,SP70,SP10
          PACK      TCODE,ANSC,ANSL
          MOVE      ACLAIM,ACODE
          CALL      RDCODE1
          BRANCH    OVRCD,GINS9999
.
.         Check the indicators for a W, M, or V (these are the claims)
.
          MOVE      ZERO,FORM2
GINS1000  ADD       ONE,FORM2
          COMPARE   SIX,FORM2
          GOTO      GINS9999 IF NOT LESS
.
          LOAD      ANS USING FORM2 OF TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
.
          CMATCH    "W",ANS
          GOTO      GINS2000 IF EQUAL
.
          CMATCH    "M",ANS
          GOTO      GINS3000 IF EQUAL
.
          CMATCH    "V",ANS
          GOTO      GINS4000 IF EQUAL
.
          GOTO      GINS1000
.
GINS2000  OPEN      PATWC1A1,"patwc1af"          * ACC Number
          MOVE      AADMNO,KEY8
          CALL      RDWCOM1
          IF        OVRCD = 0
            PACK      VAR,WCICODE,SP70,SP10
          ENDIF
          GOTO      GINS9999
.
GINS3000  READ      CONTROLF,TEN3;*188,CMABINS
          PACK      VAR,CMABINS,SP70
          GOTO      GINS9999
.
GINS4000  READ      CONTROLF,TEN3;*194,CVETINS
          PACK      VAR,CVETINS,SP70
          GOTO      GINS9999
.
GINS9999  RETURN
+
