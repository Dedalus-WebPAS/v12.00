. *----------------------------------------------------------------------
. * Include Name  :   NZPRPITM.PBL
. *
. * Function      :   Common CGI functions for NZ Related Provider Information
. *
. * Modifications :
. *
. * V9.08.02  10/01/2007 Ebon Clements  CAR 126779
. *           Added related provider ind to provider type selection list
. * V9.08.01  03/01/2007 Ebon Clements  CAR 126779
. *           Changed NZRPPTYP to use nzpptyaf
. * V9.08.00  09/11/2006 Ebon Clements  CAR 126779
. *           Created Include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear CGI Parameters for NZPRPIFD
.------------------------------------------------------------------------
CPNZRP00  MOVE      Z70,NZRPI001
          MOVE      Z70,NZRPI002
          MOVE      Z70,NZRPI003
          MOVE      Z70,NZRPI004
          MOVE      Z70,NZRPI005
          MOVE      Z70,NZRPI006
          MOVE      Z70,NZRPI007
          MOVE      Z70,NZRPI008
          MOVE      Z70,NZRPI009
          MOVE      Z70,NZRPI010
.
CPNZRP99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for NZPRPIFD
.------------------------------------------------------------
SPNZRP00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPNZRP01,SPNZRP02,SPNZRP03,SPNZRP04,SPNZRP05:
                       SPNZRP06,SPNZRP07,SPNZRP08,SPNZRP09,SPNZRP10
.
          MOVE      ONE,EXIT
          GOTO      SPNZRP99
.
SPNZRP01  PACK      NZRPI001,QRYDATA,SP70
          GOTO      SPNZRP99
.
SPNZRP02  PACK      NZRPI002,QRYDATA,SP70
          GOTO      SPNZRP99
.
SPNZRP03  PACK      NZRPI003,QRYDATA,SP70
          GOTO      SPNZRP99
.
SPNZRP04  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      NZRPI004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPNZRP99
.
SPNZRP05  MOVE      QRYDATA,NZRPI005
          GOTO      SPNZRP99
.
SPNZRP06  MOVE      QRYDATA,NZRPI006
          GOTO      SPNZRP99
.
SPNZRP07  MOVE      QRYDATA,NZRPI007 
          GOTO      SPNZRP99
.
SPNZRP08  MOVE      QRYDATA,NZRPI008
          GOTO      SPNZRP99
.
SPNZRP09  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      NZRPI009,CCENT,CYEAR,CMON,CDAY
          GOTO      SPNZRP99
.
SPNZRP10  MOVE      QRYDATA,NZRPI010
          GOTO      SPNZRP99
.
SPNZRP99  RETURN
.
.--------------------------------------------------------------------------
. NZ Private Related Provider invoice Information
.--------------------------------------------------------------------------
NZRP0000  BRANCH    FLDITMNO,NZRP0100,NZRP0200,NZRP0300,NZRP0400,NZRP0500:
                             NZRP0600,NZRP0700,NZRP0800,NZRP0900,NZRP1000
          GOTO      NZRP9999
.
NZRP0100  WRITE     HTMLFILE;NZRPADMN;
          GOTO      NZRP9999
.
NZRP0200  WRITE     HTMLFILE;NZRPINVN;
          GOTO      NZRP9999
.
NZRP0300  WRITE     HTMLFILE;NZRPRINV;
          GOTO      NZRP9999
.
NZRP0400  UNPACK    NZRPDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      NZRP9999
.
NZRP0500  WRITE     HTMLFILE;NZRPAMNT;
          GOTO      NZRP9999
.
NZRP0600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,NZRP0610,NZRP0620
.
          PACK      KEY3,NZRPPTYP,SP70
          CALL      RDNZPTY1
          BRANCH    OVRCD,NZRP9999
.
          WRITE     HTMLFILE;NZPTDESC;
.
          GOTO      NZRP9999
.
NZRP0610  WRITE     HTMLFILE;NZRPPTYP;
          GOTO      NZRP9999
.
NZRP0620  PACK      KEY33,SP70
          CALL      RSNZPTY2
NZRP0625  CALL      RKNZPTY2
          BRANCH    OVRCD,NZRP9999
.
          MATCH     NZPTPTYP,NZRPPTYP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option ":
                               "value=#"",NZPTPTYP,NZPTPIND,"#" selected>":
                                 NZPTDESC,"</option>"
          ELSE
            MATCH     "1",NZPTACTV
            GOTO      NZRP0625 IF EQUAL
.
            WRITE     HTMLFILE;"<option value=#"",NZPTPTYP,NZPTPIND,"#">":
                                 NZPTDESC,"</option>"
          ENDIF
          GOTO      NZRP0625
.
NZRP0700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,NZRP0710
.
          PACK      KEY10,NZRPPCOD,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,NZRP9999
.
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      NZRP9999
.
NZRP0710  WRITE     HTMLFILE;NZRPPCOD;
          GOTO      NZRP9999
.
NZRP0800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,NZRP0810
.
          WRITE     HTMLFILE;NZRPAPIS;
          GOTO      NZRP9999
.
NZRP0810  MATCH     "1",NZRPAPIS
          IF        @EQUAL
            WRITE     HTMLFILE;"Sent"
            GOTO      NZRP9999
          ENDIF 
          MATCH     "2",NZRPAPIS
          IF        @EQUAL
            WRITE     HTMLFILE;"Paid"
            GOTO      NZRP9999
          ENDIF 
          WRITE     HTMLFILE;"UnSent"
          GOTO      NZRP9999
.
NZRP0900  MATCH     SP70,NZRPAPDT
          GOTO      NZRP9999 IF EQUAL
.
          UNPACK    NZRPAPDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      NZRP9999
.
NZRP1000  WRITE     HTMLFILE;NZRPCOMT;
          GOTO      NZRP9999
.
NZRP9999  RETURN
.
.------------------------------------------------------------
.  Update NZPRPIFD file
.------------------------------------------------------------
MVNZRP00  MATCH     Z70,NZRPI001
          IF        !@EQUAL
            MOVE      NZRPI001,NZRPADMN
          ENDIF
.
          MATCH     Z70,NZRPI002
          IF        !@EQUAL
            MOVE      NZRPI002,NZRPINVN
          ENDIF
.
          MATCH     Z70,NZRPI003
          IF        !@EQUAL
            MOVE      NZRPI003,NZRPRINV
          ENDIF
.
          MATCH     Z70,NZRPI004
          IF        !@EQUAL
            MOVE      NZRPI004,NZRPDATE
          ENDIF
.
          MATCH     Z70,NZRPI005
          IF        !@EQUAL
            MOVE      NZRPI005,NZRPAMNT
          ENDIF
.
          MATCH     Z70,NZRPI006
          IF        !@EQUAL
            MOVE      NZRPI006,NZRPPTYP
          ENDIF
.
          MATCH     Z70,NZRPI007
          IF        !@EQUAL
            MOVE      NZRPI007,NZRPPCOD
          ENDIF
.
          MATCH     Z70,NZRPI008
          IF        !@EQUAL
            MOVE      NZRPI008,NZRPAPIS
          ENDIF
.
          MATCH     Z70,NZRPI009
          IF        !@EQUAL
            MOVE      NZRPI009,NZRPAPDT
          ENDIF
.
          MATCH     Z70,NZRPI010
          IF        !@EQUAL
            MOVE      NZRPI010,NZRPCOMT
          ENDIF
.
MVNZRP99  RETURN
