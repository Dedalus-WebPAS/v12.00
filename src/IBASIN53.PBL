.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.02 08.04.2005 Peter Vela CAR 59696
.          Changed commodity group from DIM 5 to DIM 6
. V9.04.01 02/09/2004  Mike Laming  CAR 53081
.          Correct Screen 2 Fields 1 & 11 to fix error at LM02L000
. V9.03.01 23/07/2004  Mike Laming  CAR 43474
.          Change USCEA200 to not write to "apscebaf" if qty = 0
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 20.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.01  18.07.2000 Charles Handaya
.           Recompiled for SINBACIO change
.           Related to Quote 9817
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.02  02.11.1999 Sandra Barcham
.           Recompiled to change E to exit to X in SINPONCD
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
AVGCURR   FORM      12.2
AVGPREV   FORM      12.2
CHKKEY8   DIM       8
CURRPER   FORM      2
DIM13CHK  DIM       13
DIM30     DIM       30
F12       FORM      12
F12P4     FORM      12.4
FORMCRT   DIM       12
PERDES1   DIM       1
PERDES2   DIM       1
PERDES3   DIM       1
PERDES4   DIM       1
PERDES5   DIM       1
PERDES6   DIM       1
PERDES7   DIM       1
PERDES8   DIM       1
PERDES9   DIM       1
PERDES10  DIM       1
PERDES11  DIM       1
PERDES12  DIM       1
PERDESK   DIM       1
ORDQTY    FORM      12.2
QTYF8     FORM      8
QTYF8P6   FORM      8.6
USECURR   FORM      12.2
USEDAT    DIM       6
USEDAT1   DIM       6
USEDAT2   DIM       6
USEDAT3   DIM       6
USEDAT4   DIM       6
USEDAT5   DIM       6
USEDAT6   DIM       6
USEDAT7   DIM       6
USEDAT8   DIM       6
USEDAT9   DIM       6
USEDAT10  DIM       6
USEDAT11  DIM       6
USEDAT12  DIM       6
USEDAT13  DIM       6
USEDAT14  DIM       6
USEDAT15  DIM       6
USEDAT16  DIM       6
USEDAT17  DIM       6
USEDAT18  DIM       6
USEDAT19  DIM       6
USEDAT20  DIM       6
USEDAT21  DIM       6
USEDAT22  DIM       6
USEDAT23  DIM       6
USEDAT24  DIM       6
USEPER    FORM      12.2
USEPREV   FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN53
.   Function      :   Modify/Process Suggested Orders         
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCEAFD/INC
          INC       APSCEBFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSSNTFD/INC
          INC       APSSUBFD/INC
          INC       FMSAMAFD/INC
          INC       FMSCONFD/INC
          INC       FMSCSAFD/INC
          INC       FMSFPSFD/INC
          INC       FMSLMAFD/INC
          INC       FMSLMCDF    
          INC       FMSLMCFD/INC
          INC       FMSTUPFD/INC
          INC       IBAGEDFD/INC
          INC       IBAGSTFD/INC
          INC       SINBACFD/INC
          INC       SINCGAFD/INC
          INC       SINCGBFD/INC
          INC       SINCIAFD/INC
          INC       SINCIBFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCIEFD/INC
          INC       SINCIFFD/INC
          INC       SINCIGFD/INC
          INC       SINCIHFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINLTTFD/INC
          INC       SINNATFD/INC
          INC       SINORIFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOBFD/INC
          INC       SINPOCFD/INC
          INC       SINRCPFD/INC
          INC       SINSCDFD/INC
          INC       SINSCMFD/INC
          INC       SINSODFD/INC
          INC       SINSOMFD/INC
          INC       SINSUAFD/INC
          INC       SINSUBFD/INC
          INC       SINTMPDF/INC
          INC       SINTRNFD/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMCOMM  DIM      46 * Scr 00 Fld     7
TOCOMM    DIM      46 * Scr 00 Fld     8
FROMPROD  DIM      36 * Scr 00 Fld     9
TOPROD    DIM      36 * Scr 00 Fld    10
FROMSUPP  DIM      36 * Scr 00 Fld    11
TOSUPP    DIM      36 * Scr 00 Fld    12
MESSDESC  DIM      30 * Scr 00 Fld    21
DELVDESC  DIM      30 * Scr 00 Fld    22
INCDESC   DIM      15 * Scr 00 Fld    28
SOQDESC   DIM      30 * Scr 00 Fld    31
FROMIA1   DIM      36 * Scr 00 Fld    32
TOIA1     DIM      36 * Scr 00 Fld    33
UNITCOST  DIM      14 * Scr 01 Fld     3
IUNITCST  DIM      14 * Scr 01 Fld    21
ISSQTY    FORM     12.2 * Scr 01 Fld    22
EXPDDATE  DIM       8 * Scr 01 Fld    23
NSIIBYN   FORM      1 * Scr 01 Fld    35
NSIIGYN   FORM      1 * Scr 01 Fld    36
NSIIDYN   FORM      1 * Scr 01 Fld    37
NOTESIIB  DIM       5 * Scr 01 Fld    38
NOTESIIG  DIM       5 * Scr 01 Fld    39
NOTESIID  DIM       5 * Scr 01 Fld    40
.
.    Multi Item Key Fields Scr 02 Fld    11
.-------------------------------------------------------
SIOD2NAM  INIT      "SIOD2"
SIOD2END  FORM      1   * End Display
SIOD2SNO  FORM      5   * Number of Items on the Screen
SIOD2MKY  DIM       127 * Match Key 
SIOD2EKY  DIM       127 * End Key
SIOD2SKY  DIM       127 * Start Key
SIOD2IDX  INIT      " 132 UC1-5"
SIOD2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIOD2FNM  DIM       8  * Filename
SIOD2CNT  FORM      3  * Number of Items on Screen
LINEDESC  DIM      80 * Scr 02 Fld    11
QUANTITY  DIM       8 * Scr 02 Fld    14
LINECOST  DIM      13 * Scr 02 Fld    19
NOTEAPSN  DIM       5 * Scr 02 Fld    27
NOTELINE  DIM       1 * Scr 02 Fld    28
.
.Word Processor File * Scr 02 Fld    29
.
NAMAPSN1  INIT      "Wapsn1"
FILAPSN1  DIM       8
.
.
.Word Processor File * Scr 03 Fld    58
.
NAMSIIB1  INIT      "Wsiib1"
FILSIIB1  DIM       8
.
.
.Word Processor File * Scr 03 Fld    59
.
NAMSIIG1  INIT      "Wsiig1"
FILSIIG1  DIM       8
.
.
.Word Processor File * Scr 03 Fld    60
.
NAMSIID1  INIT      "Wsiid1"
FILSIID1  DIM       8
.
CONFDESC  DIM      30 * Scr 04 Fld    18
.
.Word Processor File * Scr 04 Fld    20
.
NAMSIPB1  INIT      "Wsipb1"
FILSIPB1  DIM       8
.
ORDTOTAL  FORM     12.2 * Scr 04 Fld    21
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN53"
PRGNAM    INIT      "Modify/Process Suggested Orders         "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RINCOCAT
          CALL      SC00L000
          CLOSE     SIOD2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIG1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIID1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apssntaf";
          OPEN      APSSNTA1,"apssntaf"
          DISPLAY   *P56:24,"Opening apssubaf";
          OPEN      APSSUBA1,"apssubaf"
          DISPLAY   *P56:24,"Opening ibagedaf";
          OPEN      IBAGEDA1,"ibagedaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA3,"ibagstaf"
          MOVE      "   24",AUDTSECT
          MOVE      "210",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudpa";
            OPEN      SINAUDPA,"sinaudpa"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "210",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudpc";
            OPEN      SINAUDPC,"sinaudpc"
          ENDIF
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA3,"sinbacaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgbaf";
          OPEN      SINCGBA1,"sincgbaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincibaf";
          OPEN      SINCIBA1,"sincibaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincigaf";
          OPEN      SINCIGA1,"sincigaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA1,"sincihaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA2,"sincihaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA1,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA2,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA3,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpobaf";
          OPEN      SINPOBA1,"sinpobaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinrcpaf";
          OPEN      SINRCPA1,"sinrcpaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsodaf";
          OPEN      SINSODA1,"sinsodaf"
          DISPLAY   *P56:24,"Opening sinsodaf";
          OPEN      SINSODA2,"sinsodaf"
          DISPLAY   *P56:24,"Opening sinsomaf";
          OPEN      SINSOMA1,"sinsomaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsubaf";
          OPEN      SINSUBA1,"sinsubaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA1,"sintrnaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA2,"sintrnaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Batch Screen Warehouse/Catalog/Description      
.--------------------------------------------------------
          MOVE     ZERO,SIOD2SNO
          MOVE     "02   11",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIOD2SNO
            ENDIF
          ENDIF
          PACK      SIOD2FNM,ANST,SIOD2NAM,PORT
          REP       " 0",SIOD2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIOD2FL1,SIOD2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIOD2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIOD2FNM,SIOD2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIOD2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIOD2FL1,SIOD2FNM
.--------------------------------------------------------
. Initialise Wp Filename for Supplier Notes                     
.--------------------------------------------------------
          PACK      FILAPSN1,NAMAPSN1,PORT
          REP       " 0",FILAPSN1
          DISPLAY   *P56:24,"Create & Open ",FILAPSN1;
          PREP      TEMPWORD,FILAPSN1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog Notes                      
.--------------------------------------------------------
          PACK      FILSIIB1,NAMSIIB1,PORT
          REP       " 0",FILSIIB1
          DISPLAY   *P56:24,"Create & Open ",FILSIIB1;
          PREP      TEMPWORD,FILSIIB1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Warehouse Notes            
.--------------------------------------------------------
          PACK      FILSIIG1,NAMSIIG1,PORT
          REP       " 0",FILSIIG1
          DISPLAY   *P56:24,"Create & Open ",FILSIIG1;
          PREP      TEMPWORD,FILSIIG1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Supplier Notes             
.--------------------------------------------------------
          PACK      FILSIID1,NAMSIID1,PORT
          REP       " 0",FILSIID1
          DISPLAY   *P56:24,"Create & Open ",FILSIID1;
          PREP      TEMPWORD,FILSIID1
.
.--------------------------------------------------------
. Initialise Wp Filename for Additional Comments (Purchase Head)
.--------------------------------------------------------
          PACK      FILSIPB1,NAMSIPB1,PORT
          REP       " 0",FILSIPB1
          DISPLAY   *P56:24,"Create & Open ",FILSIPB1;
          PREP      TEMPWORD,FILSIPB1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Suggested Order Processing Options 
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Seleted Item to Modify             
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Suggested Order Modification       
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Notes Display Screen               
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Generate Order Fields              
          ENDIF
          RETURN
.--------------------------------
. Screen - Suggested Order Processing Options 
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RDPAR000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Suggested Order Processing Options 
.-------------------------------------------------------
CF00L000
          MOVE      SP70,SIOMSID 
          MOVE      SP70,SIOMDES 
          MOVE      ZERO,SIOMPER 
          MOVE      SP70,SIOMORG 
          MOVE      SP70,SIOMDEL 
          MOVE      SP70,SIOMMES 
          MOVE      SP70,FROMCOMM
          MOVE      SP70,TOCOMM  
          MOVE      SP70,FROMPROD
          MOVE      SP70,TOPROD  
          MOVE      SP70,FROMSUPP
          MOVE      SP70,TOSUPP  
          MOVE      SP70,SIOMWAR 
          MOVE      SP70,SIWADES 
          MOVE      SP70,SIOMUID 
          MOVE      SP70,SIOMPOR 
          MOVE      SP70,SIOMTIM 
          MOVE      SP70,SIOMDAT 
          MOVE      ZERO,SIOMINC 
          MOVE      SP70,SIORNAME
          MOVE      SP70,MESSDESC
          MOVE      SP70,DELVDESC
          MOVE      SP70,INCDESC 
          MOVE      SP70,SIOMSOQ 
          MOVE      SP70,SOQDESC 
          MOVE      SP70,FROMIA1 
          MOVE      SP70,TOIA1   
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Suggested Order Processing Options 
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMUID 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMPOR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMTIM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMDAT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ESID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      SIOMSID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOMUID,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOMPOR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOMTIM,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    SIOMDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Suggested Order Processing Options 
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Suggested Order Processing Options 
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Suggested Order Processing Options 
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Suggested Order Processing Options 
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L122:
                            PS00L999,PS00L123,PS00L124,PS00L125:
                            PS00L126
          GOTO     PS00L999
.
PS00L101
          MOVE      SIOMDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SIOMPER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SIOMORG,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SIOMDEL,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SIOMMES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      FROMCOMM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      TOCOMM,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      FROMPROD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      TOPROD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      FROMSUPP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      TOSUPP,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SIOMWAR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      SIOMUID,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      SIOMPOR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      SIOMTIM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          UNPACK    SIOMDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIOMINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      DELVDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      INCDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      SIOMSOQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      SOQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      FROMIA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      TOIA1,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Suggested Order Processing Options 
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L101:
                            SF00L102,SF00L103,SF00L104,SF00L006:
                            SF00L105,SF00L006,SF00L006,SF00L006:
                            SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      UUSIOM1 
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      UUSIOM1 
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      PRINT000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
          CALL      SETBLS00
          CALL      GENALL00
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Seleted Item to Modify             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Seleted Item to Modify             
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Seleted Item to Modify             
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Seleted Item to Modify             
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Seleted Item to Modify             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Seleted Item to Modify             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Seleted Item to Modify             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L124,PS01L125:
                            PS01L126,PS01L127,PS01L128,PS01L129:
                            PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      SIODWAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIODCAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      UNITCOST,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SIODQTY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SIODSUT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      SIODCON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          UNPACK    SIODCDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      SISCDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          UNPACK    SISCSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          UNPACK    SISCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      SIFACTOR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      IUNITCST,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      ISSQTY,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          UNPACK    EXPDDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      NSIIBYN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      NSIIGYN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      NSIIDYN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      NOTESIIG,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Seleted Item to Modify             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L101,SF01L006:
                            SF01L102,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L103,SF01L104,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L105,SF01L106:
                            SF01L107,SF01L108,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L109
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L101,SF01L020:
                            SF01L102,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L103,SF01L104,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IUNITCST
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
            BRANCH    EXIT,SF01L101,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      UNITCOST,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IUNITCST,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L102
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIFACTOR
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUPT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L102
            ENDIF
            BRANCH    EXIT,SF01L102,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIODSUT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIFACTOR,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L103
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIODQTY 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EQTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      ISSQTY,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIODQTY,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EEXDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          UNPACK    EXPDDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L107
          CALL      POST0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      MSUP0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCREEN03
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Suggested Order Modification       
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      SETBLS00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Suggested Order Modification       
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Suggested Order Modification       
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Suggested Order Modification       
.---------------------------------------------------------
WP02L000
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP02L100
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP02L105
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP02L105 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP02L100
WP02L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Suggested Order Modification       
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    11 Warehouse/Catalog/Description      
.---------------------------------------------------------
          UNPACK    SP70,SIODSID,SIODSUP,SIODWAR,SIODCAT
          PACK      KEY20,SIOMSID,APMACRD,SP70
          MOVE      KEY20,SIOD2EKY
          STRIP     SIOD2SKY
          SETLPTR   SIOD2EKY,8
          MOVE      SIOD2EKY,SIOD2SKY
          CALL      RDSIOD2 
          IF        OVRCD=0
            CALL      RPSIOD2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIOD2CNT
          MOVE     ZERO,SIOD2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L105,DP02L106:
                            DP02L107,DP02L108,DP02L109,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L110:
                            DP02L010,DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SIOD2MKY,SP70,SP70
          CALL      UPTSIOD2
          IF        SIOD2END=0
            CALL      RKSIOD2 
            IF        OVRCD=0
              PACK      SIOD2MKY,SIODSID,SIODSUP,SIODWAR,SIODCAT                                                
              MATCH     SIOD2EKY,SIOD2MKY
              IF        @EQUAL
                MOVE      ZERO,SIOD2END
                ADD       ONE,SIOD2CNT
                CALL      UPTSIOD2
          CALL      LINDET00
                MOVE      LINEDESC,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIOD2END
              ENDIF
            ELSE
              MOVE      ONE,SIOD2END
            ENDIF
          ENDIF
          IF        SIOD2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SIOD2END=0
            MOVE      SIODCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SIOD2END=0
            MOVE      UNITCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SIOD2END=0
            MOVE      QUANTITY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SIOD2END=0
            MOVE      SIODSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SIOD2END=0
            MOVE      SIODCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SIOD2END=0
            UNPACK    SIODCDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SIOD2END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SIOD2END=0
            MOVE      LINECOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SIOD2END=0
            MOVE      NOTELINE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIOD2",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIOD2",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY20,SIOD2SKY,SP70
          CALL     RDSIOD2  * Start
          IF       OVRCD=0
            CALL     RPSIOD2  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIOD2",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY20,SIOD2SKY,Z70
          CALL     RSSIOD2  * End
          IF       OVRCD=1
            CALL     RPSIOD2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIOD2SNO
            CALL     RPSIOD2 
            IF       OVRCD=1
              MOVE     SIOD2SNO,SECTOR
            ENDIF
            PACK     SIOD2MKY,SIODSID,SIODSUP,SIODWAR,SIODCAT                                                
            MATCH    SIOD2EKY,SIOD2MKY
            IF       !@EQUAL
              MOVE     SIOD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIOD2",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSIOD2
          BRANCH   OVRCD,PP02L115
          MOVE      SIOD2MKY,KEY20 
          CALL      RSSIOD2 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIOD2SNO
            CALL     RPSIOD2 
            IF       OVRCD=1
              MOVE     SIOD2SNO,SECTOR
            ENDIF
            PACK     SIOD2MKY,SIODSID,SIODSUP,SIODWAR,SIODCAT                                                
            MATCH    SIOD2EKY,SIOD2MKY
            IF       !@EQUAL
              MOVE     SIOD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIOD2SNO
            CALL     RKSIOD2 
            IF       OVRCD=1
              MOVE     SIOD2SNO,SECTOR
            ENDIF
            PACK     SIOD2MKY,SIODSID,SIODSUP,SIODWAR,SIODCAT                                                
            MATCH    SIOD2EKY,SIOD2MKY
            IF       !@EQUAL
              MOVE     SIOD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIOD2",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIOD2 
          BRANCH   OVRCD,NP02L110
          PACK     SIOD2MKY,SIODSID,SIODSUP,SIODWAR,SIODCAT                                                
          MATCH    SIOD2EKY,SIOD2MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIOD2 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIOD2 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Suggested Order Modification       
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    11 Warehouse/Catalog/Description      
.---------------------------------------------------------
UPTSIOD2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIOD2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIOD2FL1,KEY5;SCPSROW,SCPSCOL,SIOD2MKY
          ELSE
            UPDATE    SIOD2FL1;SCPSROW,SCPSCOL,SIOD2MKY
          ENDIF
          RETURN
RDTSIOD2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIOD2FL1,KEY5;SCPSROW,SCPSCOL,SIOD2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIOD2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIOD2FL1,KEY5;;
          READKS    SIOD2FL1;SCPSROW,SCPSCOL,SIOD2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIOD2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Suggested Order Modification       
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIOD2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Suggested Order Modification       
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L103:
                            PS02L104,PS02L105,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L110,PS02L999:
                            PS02L111,PS02L999,PS02L999,PS02L112
          GOTO     PS02L999
.
PS02L101
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          CALL      NAPSN000
          MOVE      NOTEAPSN,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS02L999
.
PS02L112
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Suggested Order Modification       
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L101,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L102:
                            SF02L103,SF02L104,SF02L105,SF02L006:
                            SF02L106,SF02L107,SF02L006,SF02L006:
                            SF02L108,SF02L109,SF02L110,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L101,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L108,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIOD2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSIOD2
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SIOD2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SIOD2MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELLIN00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIOD2
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SIOD2MKY,KEY20 
            CALL      RSSIOD2 
            CALL      RPSIOD2 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "SIOD2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "SIOD2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "SIOD2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "SIOD2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L107
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L108
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 8",SCPSROW
              MOVE     "  4",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "12",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF02L001
.
SF02L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDORD00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GENORD00
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Notes Display Screen               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Notes Display Screen               
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Notes Display Screen               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Notes Display Screen               
.---------------------------------------------------------
WP03L000
          PREP     TEMPWORD,FILSIIB1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIB1 
          IF        OVRCD=0
            CALL      RPSIIB1 
          ENDIF
WP03L100
          CALL     RKSIIB1 
          BRANCH   OVRCD,WP03L105
          PACK     KEY10,SIIBCAT,SIIBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP03L105 IF NOT EQUAL
          PACK     VAR,SIIBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L100
WP03L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILSIIG1
          PACK     KEY15,SIIACAT,SIODWAR,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIIG1 
          IF        OVRCD=0
            CALL      RPSIIG1 
          ENDIF
WP03L110
          CALL     RKSIIG1 
          BRANCH   OVRCD,WP03L115
          PACK     KEY15,SIIGCAT,SIIGWAR,SIIGLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP03L115 IF NOT EQUAL
          PACK     VAR,SIIGCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIGCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L110
WP03L115  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILSIID1
          PACK     KEY15,SIODCAT,SIODSUP,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIID1 
          IF        OVRCD=0
            CALL      RPSIID1 
          ENDIF
WP03L120
          CALL     RKSIID1 
          BRANCH   OVRCD,WP03L125
          PACK     KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP03L125 IF NOT EQUAL
          PACK     VAR,SIIDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L120
WP03L125  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Notes Display Screen               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Notes Display Screen               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Notes Display Screen               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L106,PS03L107,PS03L108:
                            PS03L109,PS03L110,PS03L111,PS03L112:
                            PS03L113,PS03L114,PS03L115,PS03L116:
                            PS03L117,PS03L118,PS03L119,PS03L120:
                            PS03L121,PS03L122,PS03L123,PS03L124:
                            PS03L125,PS03L126,PS03L127,PS03L128:
                            PS03L129,PS03L130,PS03L131,PS03L132:
                            PS03L133,PS03L134,PS03L135,PS03L136:
                            PS03L137,PS03L138,PS03L139,PS03L140:
                            PS03L141,PS03L142,PS03L143,PS03L144:
                            PS03L145,PS03L146,PS03L147,PS03L148:
                            PS03L149,PS03L150,PS03L151,PS03L152:
                            PS03L153,PS03L154,PS03L155,PS03L156:
                            PS03L157,PS03L158,PS03L159,PS03L160:
                            PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      SIIERAS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      SIIESOH,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      SIIEROQ,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      SIIEROL,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          UNPACK    SIIESTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L135
          MOVE      SIICSUP,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L136
          MOVE      SIICSUT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L137
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L138
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L139
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L140
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L141
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L142
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L145
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L146
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L147
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L148
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L149
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L150
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L153
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L154
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L155
          CALL      NSIIB000
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L156
          CALL      NSIIG000
          MOVE      NOTESIIG,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L157
          CALL      NSIID000
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L158
          MOVE     FILSIIB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
.
PS03L159
          MOVE     FILSIIG1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
.
PS03L160
          MOVE     FILSIID1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Notes Display Screen               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L104
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L101,SF03L102,SF03L103:
                            SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIG1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIG1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L103
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIID1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIID1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L104
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Generate Order Fields              
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Generate Order Fields              
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Generate Order Fields              
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Generate Order Fields              
.---------------------------------------------------------
WP04L000
          PREP     TEMPWORD,FILSIPB1
          PACK     KEY10,PORT,Z70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIPB1 
          IF        OVRCD=0
            CALL      RPSIPB1 
          ENDIF
WP04L100
          CALL     RKSIPB1 
          BRANCH   OVRCD,WP04L105
          PACK     KEY10,SIPBPON,SIPBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP04L105 IF NOT EQUAL
          PACK     VAR,SIPBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L100
WP04L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Generate Order Fields              
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Generate Order Fields              
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Generate Order Fields              
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L101,PS04L102,PS04L103,PS04L104:
                            PS04L105,PS04L106,PS04L107,PS04L108:
                            PS04L109,PS04L110,PS04L111,PS04L112:
                            PS04L113,PS04L114,PS04L115,PS04L116:
                            PS04L117,PS04L118,PS04L119,PS04L120:
                            PS04L121,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE     FILSIPB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
.
PS04L121
          MOVE      ORDTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Generate Order Fields              
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L101,SF04L102,SF04L103,SF04L104:
                            SF04L105,SF04L006,SF04L106,SF04L107:
                            SF04L108,SF04L109,SF04L110,SF04L111:
                            SF04L112,SF04L113,SF04L114,SF04L006:
                            SF04L115,SF04L006,SF04L006,SF04L116:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L117,SF04L118
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L101,SF04L102,SF04L103,SF04L104:
                            SF04L105,SF04L020,SF04L106,SF04L107:
                            SF04L108,SF04L109,SF04L110,SF04L111:
                            SF04L112,SF04L113,SF04L114,SF04L020:
                            SF04L115,SF04L020,SF04L020,SF04L116:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,SIPAORI
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L101
            ENDIF
            BRANCH    EXIT,SF04L101,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L102
          CALL     SELECTED
          STRIP     SIPAICN 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAICN,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAICN 
          SFORMAT   VAR,127
          ENDSET    SIPAICN 
          APPEND    SP70,SIPAICN 
          RESET     SIPAICN 
          CMATCH    EXITCHAR,SIPAICN 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAICN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L102
            ENDIF
          ENDIF
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L103
          CALL     SELECTED
          STRIP     SIPASCN 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPASCN,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPASCN 
          SFORMAT   VAR,127
          ENDSET    SIPASCN 
          APPEND    SP70,SIPASCN 
          RESET     SIPASCN 
          CMATCH    EXITCHAR,SIPASCN 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPASCN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
          ENDIF
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDELP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L105
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,MESSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMESS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L105
            ENDIF
            BRANCH    EXIT,SF04L105,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      MESSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L106
          CALL     SELECTED
          STRIP     SIPAIDP 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAIDP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAIDP 
          SFORMAT   VAR,127
          ENDSET    SIPAIDP 
          APPEND    SP70,SIPAIDP 
          RESET     SIPAIDP 
          CMATCH    EXITCHAR,SIPAIDP 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAIDP 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L106
            ENDIF
          ENDIF
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L107
          CALL     SELECTED
          STRIP     SIPAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUR1 
          SFORMAT   VAR,127
          ENDSET    SIPAUR1 
          APPEND    SP70,SIPAUR1 
          RESET     SIPAUR1 
          CMATCH    EXITCHAR,SIPAUR1 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L107
            ENDIF
          ENDIF
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L108
          CALL     SELECTED
          STRIP     SIPAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUR2 
          SFORMAT   VAR,127
          ENDSET    SIPAUR2 
          APPEND    SP70,SIPAUR2 
          RESET     SIPAUR2 
          CMATCH    EXITCHAR,SIPAUR2 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L108
            ENDIF
          ENDIF
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L109
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L110
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L111
          CALL     SELECTED
          STRIP     SIPAUC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUC1 
          SFORMAT   VAR,127
          ENDSET    SIPAUC1 
          APPEND    SP70,SIPAUC1 
          RESET     SIPAUC1 
          CMATCH    EXITCHAR,SIPAUC1 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L111
            ENDIF
          ENDIF
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L112
          CALL     SELECTED
          STRIP     SIPAUC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUC2 
          SFORMAT   VAR,127
          ENDSET    SIPAUC2 
          APPEND    SP70,SIPAUC2 
          RESET     SIPAUC2 
          CMATCH    EXITCHAR,SIPAUC2 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L112
            ENDIF
          ENDIF
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L113
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIPAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIPAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L115
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CONFDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L115
            ENDIF
            BRANCH    EXIT,SF04L115,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CONFDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L116
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     " 10",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPB1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPB1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF04L001
.
SF04L117
          CALL      CAN40000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L118
          CALL      POS40000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
. ------------------------------------------------------------
. Read Catalog Code Keyin Control Information
.
. INCOCATE  FORM      1         67      Catalog Code Type
. 0 Normal Keyin,   1 *JR *DE,   2 Generated ,  3 Generated with Check Digit
.------------------------------------------------------------
RINCOCAT  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*67,INCOCATE,*240,SNCOPURC
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCOCATE
            MOVE      ZERO,SNCOPURC
            WRITAB    CONTROLF,SIXTY3;*67,INCOCATE,*240,SNCOPURC
          ENDIF
.
          RETURN
.------------------------------------------------------------------------
. Read Parameters - Open Nato X-Ref File if required and read incndlcc
.------------------------------------------------------------------------
RDPAR000  OPEN      CONTROLF,"controlf"
          MOVE      ZERO,OVRCD
          READ      CONTROLF,TWENTY6;*248,HPURCHP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*36,SNCOCCOM,*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            MOVE      ZERO,SNCOCCOM
            WRITAB    CONTROLF,SIXTY3;*36,SNCOCCOM,*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
RDPAR999  RETURN
. ------------------------------------------------------------
. Read Barwon Control Information
.
. INCNBLSS  DIM       5          7      BLS Supplier Code
.------------------------------------------------------------
SETBLS00  READ      CONTROLF,TWENTY6;*36,INCNVHAS,*47,INCNVHAN,*172,INCNTRAL:
                                     *194,INCNSOSI
          READ      CONTROLF,SIXTY7;*7,INCNBLSS,*18,INCNBLSN:
                                    *181,INCNBLAL,*203,INCNBLON
.
SETBLS99  RETURN
ESID0000  MOVE      ZERO,CKEYTYP
          CALL      KSIOMA00
          BRANCH    EXIT,ESID9999,ESID9999
.
          READ      CONTROLF,TWENTY5;HADEL1,HADEL2,HADEL3,HADEL4:
                                     HADEL5,HADEL6,HADEL7,HADEL8
ESID0100  MOVE      SIOMSID,KEY3
          CALL      RLSIOM1
          BRANCH    OVRCD,ESID9999,ESID0200
          MOVE      SIOMORG,KEY3
          CALL      RDSIOR1
          MOVE      SIOMDEL,F1
          LOAD      DELVDESC,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                HADEL5,HADEL6,HADEL7,HADEL8
          MOVE      SP70,FROMCOMM
          MOVE      SP70,TOCOMM
          MOVE      SP70,FROMPROD
          MOVE      SP70,TOPROD
          MOVE      SP70,FROMSUPP
          MOVE      SP70,FROMSUPP
          MOVE      SP70,FROMIA1
          MOVE      SP70,TOIA1
.
. check warehouse security
.
          MATCH     SP70,SIOMWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIOMWAR,SP70
            CALL      RDSIWS1
            IF        OVRCD=1
              CLEAR     DISPMSG
              APPEND    "You have no access for Warehouse ",DISPMSG
              APPEND    SIOMWAR,DISPMSG
              APPEND    " - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      ESID9999
            ENDIF
          ENDIF
          MOVE      SIOMWAR,KEY5
          CALL      RDSIWA1
.
          PACK      MESSDESC,SP70
          MATCH     SP70,SIOMMES
          IF        !@EQUAL
            PACK      KEY6,ANSM,ANSE,SP1,SIOMMES
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,MESSDESC
            ENDIF
          ENDIF
.
          CALL      SIDFT000
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ESID9999
.
ESID0200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ESID0100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ESID0000 IF NOT EQUAL
          MATCH     ANSE,ANS
          GOTO      ESID0200 IF NOT EQUAL
          GOTO      ESID0000
.
ESID9999  RETURN
.
.
SIDFT000  MATCH     SP70,SIOMFCO
          IF        @EQUAL
            MOVE      "Start",FROMCOMM
          ELSE
            MOVE      SIOMFCO,KEY6                                     *C-59696
            CALL      RDSIGA1
            PACK      FROMCOMM,KEY6,SP1,SIGADES                        *C-59696
          ENDIF
.
          MATCH     Z70,SIOMTCO
          IF        @EQUAL
            MOVE      "Finish",TOCOMM
          ELSE
            MOVE      SIOMTCO,KEY6                                     *C-59696
            CALL      RDSIGA1
            PACK      TOCOMM,KEY6,SP1,SIGADES                          *C-59696
          ENDIF
.
          MATCH     SP70,SIOMFPG
          IF        @EQUAL
            MOVE      "Start",FROMPROD
          ELSE
            MOVE      SIOMFPG,KEY5
            CALL      RDSISA1
            PACK      FROMPROD,KEY5,SP1,SISADESC
          ENDIF
.
          MATCH     Z70,SIOMTPG
          IF        @EQUAL
            MOVE      "Finish",TOPROD
          ELSE
            MOVE      SIOMTPG,KEY5
            CALL      RDSISA1
            PACK      TOPROD,KEY5,SP1,SISADESC
          ENDIF
.
          MATCH     SP70,SIOMFSU
          IF        @EQUAL
            MOVE      "Start",FROMSUPP
          ELSE
            MOVE      SIOMFSU,KEY5
            CALL      RDAPMA1
            PACK      FROMSUPP,KEY5,SP1,APMASN1
          ENDIF
.
          MATCH     Z70,SIOMTSU
          IF        @EQUAL
            MOVE      "Finish",TOSUPP
          ELSE
            MOVE      SIOMTSU,KEY5
            CALL      RDAPMA1
            PACK      TOSUPP,KEY5,SP1,APMASN1
          ENDIF
.
          MATCH     SP70,SIOMFIA
          IF        @EQUAL
            MOVE      "Start",FROMIA1
          ELSE
            CLEAR     KEY6
            APPEND    "ia1",KEY6
            APPEND    SIOMFIA,KEY6
            RESET     KEY6
            CALL      RDSICD1
            PACK      FROMIA1,SIOMFIA,SP1,SICDDESC
          ENDIF
.
          MATCH     Z70,SIOMTIA
          IF        @EQUAL
            MOVE      "Finish",TOIA1
          ELSE
            CLEAR     KEY6
            APPEND    "ia1",KEY6
            APPEND    SIOMTIA,KEY6
            RESET     KEY6
            CALL      RDSICD1
            PACK      TOIA1,SIOMTIA,SP1,SICDDESC
          ENDIF
.
         BRANCH    SIOMINC,SIDFT100,SIDFT200,SIDFT300
.
SIDFT100 MOVE      "All",INCDESC
         GOTO      SIDFT500
SIDFT200 MOVE      "Contract Only",INCDESC
         GOTO      SIDFT500
SIDFT300 MOVE      "Non-Contract Only",INCDESC
         GOTO      SIDFT500
.
SIDFT500 MOVE      SIOMSOQ,F1
         BRANCH    F1,SIDFT510,SIDFT520
SIDFT510 MOVE      "ROQ+ROL-SOH-SOO+SOB",SOQDESC
         GOTO      SIDFT999
SIDFT520 MOVE      "ROQ Only",SOQDESC
         GOTO      SIDFT999
.
SIDFT999 RETURN
.
.---------------------------------------------------------------
. Print Suggested Re-Order Report
.---------------------------------------------------------------
PRINT000  MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,SECTOR
          MOVE      SP70,LASTSUPP
          MOVE      ZERO,TOTALORD
.
          PACK      SIPEDATE,CCC,CYY,CMM,CDD,SP70
          REP       " 0",SIPEDATE
          CALL      RSIPE000
          MOVE      SIPEPER,CURRPER
.
          CALL      RINPECON
          MOVE      TWENTY4,COUNT
          MOVE      SNCODFYR,F4
          ADD       ONE,F4
          PACK      KEY6,F4,SP70
          CALL      RSSIPE1
.
PRINT020  CALL      RPSIPE1
          BRANCH    OVRCD,PRINT050
          PACK      DIM6,SIPEYEAR,SIPEPER
     STORE     DIM6,COUNT,USEDAT1,USEDAT2,USEDAT3,USEDAT4,USEDAT5,USEDAT6:
                          USEDAT7,USEDAT8,USEDAT9,USEDAT10,USEDAT11,USEDAT12:
                          USEDAT13,USEDAT14,USEDAT15,USEDAT16,USEDAT17,USEDAT18:
                          USEDAT19,USEDAT20,USEDAT21,USEDAT22,USEDAT23,USEDAT24
          MOVE      SIPEPER,FORM2
          LOAD      PERDESK,FORM2,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                                  HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12
          STORE     PERDESK,COUNT,PERDES1,PERDES2,PERDES3,PERDES4,PERDES5:
                                  PERDES6,PERDES7,PERDES8,PERDES9,PERDES10:
                                  PERDES11,PERDES12
          SUB       ONE,COUNT
          COMPARE   ZERO,COUNT
          GOTO      PRINT020 IF NOT EQUAL
.
PRINT050  DISPLAY   *P1:24,*EL
          PACK      KEY20,SIOMSID,SP70
          CALL      RSSIOD2
.
PRINT100  CALL      RKSIOD2
          BRANCH    OVRCD,PRINT900
          MATCH     SIOMSID,SIODSID
          GOTO      PRINT900 IF NOT EQUAL
          ADD       ONE,SECTOR
          DISPLAY   *P1:24,"Printing : ",SIODSUP
          MATCH     SP70,LASTSUPP
          IF        @EQUAL
            MOVE      SIODSUP,LASTSUPP
            CALL      HEAD0000
          ENDIF
          MATCH     SIODSUP,LASTSUPP
          IF        !(@EQUAL)
            CALL      TAIL0000
            MOVE      ZERO,TOTALORD
            MOVE      SIODSUP,LASTSUPP
            CALL      HEAD0000
          ENDIF
          COMPARE   "50",CLNO
          CALL      HEAD0000 IF NOT LESS
.
. Print Details
.
          PACK      KEY12,SIODCAT,SIODWAR
          CALL      RDSIIE1
.
          MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
.
          PACK      KEY27,SIODCAT,SIODSUP,SIODSUT
          CALL      RDSIIC1
          IF        OVRCD=1
            MOVE      "Catalog/Supplier/Supply Unit Not on File",SIICPD1
            MOVE      SP70,SIICPD2
          ENDIF
.
          PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
.
          MOVE      "9,999,999",KEY9
          ASSIGN    SIODQTY*SIFACTOR,ORDQTY
.          MOVE      SIODQTY,ORDQTY
.          ASSIGN    SIODQTY/SIFACTOR,F12P2
          MOVE      SIODQTY,F12P2
          MOVE      F12P2,QTYFORM8
          FEDIT     QTYFORM8,KEY9
          MOVE      "9,999,999.9999",KEY14
          FEDIT     SIODCST,KEY14
          MOVE      "9999,999,999.99",KEY15
          ASSIGN    QTYFORM8*SIODCST,F12P2
          FEDIT     F12P2,KEY15
          ADD       F12P2,TOTALORD
          PRINT     SIICCAT,SP1,SIICPNO,*41,SIODSUT,*57,SIIAISS,SP1,SIFACTOR:
                    *93,KEY9,*104,KEY14,KEY15
          ADD       ONE,CLNO
.
          MATCH     SP70,SIODCON
          GOTO      PRINT500 IF EQUAL
.
          MOVE      SIODCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,PRINT500
          PACK      KEY45,SIODCON,SIODSUP,SIODCAT,SIODCDT,SIODSUT
          CALL      RDSISD1
          BRANCH    OVRCD,PRINT500
.
          PRINT     SIODWAR,*9,SIICPD1,"  Contract : ",SIODCON,SP1,SISCDES
          PRINT     *9,SIICPD2,"   ",SISDPO1
          ADD       TWO,CLNO
          MATCH     SP70,SISDPO2
          IF        !(@EQUAL)
            PRINT     *72,SISDPO2
            ADD       ONE,CLNO
          ENDIF
          GOTO      PRINT600
.
PRINT500  PRINT     SIODWAR,*9,SIICPD1
          ADD       ONE,CLNO
          MATCH     SP70,SIICPD2
          IF        !(@EQUAL)
            PRINT     *9,SIICPD2
            ADD       ONE,CLNO
          ENDIF
.
PRINT600  CALL      BOCAL000
          CALL      OOCAL000
          MOVE      "9,999,999.99",FORMSOH
          MOVE      "9,999,999.99",FORMSOO
          MOVE      "9,999,999.99",FORMROQ
          MOVE      "9,999,999.99",FORMROL
          MOVE      "9,999,999.99",FORMSOB
          MOVE      "9,999,999.99",FORMCRT
          FEDIT     SIIESOH,FORMSOH
          FEDIT     TOTALSOO,FORMSOO
          FEDIT     SIIEROQ,FORMROQ
          FEDIT     SIIEROL,FORMROL
          FEDIT     TOTALSOB,FORMSOB
          SUB       SIIEROQ,ORDQTY
          FEDIT     ORDQTY,FORMCRT
.
          PRINT     *7," SOH: ",FORMSOH:
                       " SOO: ",FORMSOO:
                       " ROQ: ",FORMROQ:
                       " ROL: ",FORMROL:
                       " SOB: ",FORMSOB:
                       " CRT: ",FORMCRT:
                       " ABC: ",SIIEABC
          ADD       ONE,CLNO
.
          MOVE      ONE,COUNT
          MOVE      ZERO,USEPER
          PRINT     *N,"    Previous Year ";
.
PRINT640  LOAD      USEDAT,COUNT,USEDAT1,USEDAT2,USEDAT3,USEDAT4,USEDAT5:
                                 USEDAT6,USEDAT7,USEDAT8,USEDAT9,USEDAT10:
                                 USEDAT11,USEDAT12
          LOAD      PERDESK,COUNT,PERDES1,PERDES2,PERDES3,PERDES4,PERDES5:
                                  PERDES6,PERDES7,PERDES8,PERDES9,PERDES10:
                                  PERDES11,PERDES12
          MOVE      ZERO,SIIHUQT
          PACK      KEY18,SIIACAT,SIODWAR,USEDAT,SP70
          CALL      RDSIIH1
          MOVE      SIIHUQT,F6
          PRINT     PERDESK,":",F6," ";
          ADD       SIIHUQT,USEPER
          MOVE      USEPER,USEPREV
          ADD       ONE,COUNT
          COMPARE   TEN3,COUNT
          GOTO      PRINT640 IF LESS
.
          DIV       TEN2,USEPER
          MOVE      USEPER,AVGPREV
          PRINT     " "
          ADD       TWO,CLNO
          MOVE      ZERO,USEPER
          MOVE      ONE,COUNT
          PRINT     "    Current  Year ";
.
PRINT650  LOAD      USEDAT,COUNT,USEDAT13,USEDAT14,USEDAT15,USEDAT16,USEDAT17:
                                 USEDAT18,USEDAT19,USEDAT20,USEDAT21,USEDAT22:
                                 USEDAT23,USEDAT24
          LOAD      PERDESK,COUNT,PERDES1,PERDES2,PERDES3,PERDES4,PERDES5:
                                  PERDES6,PERDES7,PERDES8,PERDES9,PERDES10:
                                  PERDES11,PERDES12
          MOVE      ZERO,SIIHUQT
          PACK      KEY18,SIIACAT,SIODWAR,USEDAT,SP70
          CALL      RDSIIH1
          MOVE      SIIHUQT,F6
          PRINT     PERDESK,":",F6," ";
          ADD       SIIHUQT,USEPER
          MOVE      USEPER,USECURR
          ADD       ONE,COUNT
          COMPARE   TEN3,COUNT
          GOTO      PRINT650 IF LESS
.
          DIV       CURRPER,USEPER
          MOVE      USEPER,AVGCURR
          PRINT     " "
          ADD       ONE,CLNO
.
          PRINT     *N,*4," Previous Total: ",USEPREV:
                       " Previous Avg.: ",AVGPREV:
                       " Current Total: ",USECURR:
                       " Current Avg.: ",AVGCURR,*N
          ADD       THREE,CLNO
.
          COMPARE   ZERO,SNCOCCOM
          GOTO      PRINT690 IF EQUAL
.
          MOVE      ZERO,COUNT
          PACK      KEY10,SIIACAT,SP70
          CALL      RSSIIB1
PRINT660  CALL      RKSIIB1
          BRANCH    OVRCD,PRINT670
.
          MATCH     SIIBCAT,SIIACAT
          GOTO      PRINT670 IF NOT EQUAL
.
          MATCH     SP70,SIIBCOM
          GOTO      PRINT660 IF EQUAL
.
          IF        COUNT=0
            PRINT     "Catalog Comments          : ";
            MOVE      ONE,COUNT
          ENDIF
          PRINT     *29,SIIBCOM
          ADD       ONE,CLNO
          COMPARE   "60",CLNO
          CALL      HEAD0000 IF NOT LESS
          PACK      SIIBCOM,SP70,SP70
          GOTO      PRINT660
.
PRINT670  MOVE      ZERO,COUNT
          PACK      KEY15,SIIACAT,SIICSUP,SP70
          CALL      RSSIID1
PRINT680  CALL      RKSIID1
          BRANCH    OVRCD,PRINT690
.
          MATCH     SIIACAT,SIIDCAT
          GOTO      PRINT690 IF NOT EQUAL
.
          MATCH     SIICSUP,SIIDSUP
          GOTO      PRINT690 IF NOT EQUAL
.
          MATCH     SP70,SIIDCOM
          GOTO      PRINT680 IF EQUAL
.
          IF        COUNT=0
            PRINT     "Catalog/Supplier Comments : ";
            MOVE      ONE,COUNT
          ENDIF
          PRINT     *29,SIIDCOM
          ADD       ONE,CLNO
          COMPARE   "60",CLNO
          CALL      HEAD0000 IF NOT LESS
          PACK      SIIDCOM,SP70,SP70
          GOTO      PRINT680
.
PRINT690  MOVE      ZERO,COUNT
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
PRINT700  CALL      RKSIIC1
          BRANCH    OVRCD,PRINT800
          MATCH     SIIACAT,SIICCAT
          GOTO      PRINT800 IF NOT EQUAL
          MATCH     SIICSUP,SIODSUP
          GOTO      PRINT700 IF EQUAL
          MOVE      SIICSUP,KEY5
          CALL      RDAPMA1
          BRANCH    OVRCD,PRINT700
          PACK      KEY30,SIIAISS,SIICSUT
          CALL      RDSIFA1
          ASSIGN    SIODQTY/SIFACTOR,F12P2
          MOVE      F12P2,QTYFORM8
.
          IF        COUNT=0
            PRINT     "Possible Alternative Suppliers"
            MOVE      ONE,COUNT
            ADD       ONE,CLNO
          ENDIF
.
          PRINT     APMACRD,SP1,APMASN1,SP1," Ph: ",APMASTEL," P/N: ",SIICPNO:
                    " Unit: ",SIICSUT," Qty: ",QTYFORM8
          ADD       ONE,CLNO
          COMPARE   "60",CLNO
          CALL      HEAD0000 IF NOT LESS
          GOTO      PRINT700
.
PRINT800  CALL      UND132
          GOTO      PRINT100
.
PRINT900  CALL      TAIL0000
          PRINT     *45,"Number of Catalog Selected : ",SECTOR
          PRINT     *50,"**** End of Report ****"
          RETURN
.--------------------------------------------------
. Print Heading
.--------------------------------------------------
HEAD0000  CALL      HEAD132
          MOVE      "8",CLNO
          PRINT     "S.R.O. Code   : ",SIOMSID,SP1,SIOMDES
          IF        CPAGENO=1
            PRINT     "Originator    : ",SIOMORG,SP1,SIORNAME:
                      *80,"User : ",SIOMUID
            PRINT     "Warehouse     : ",SIOMWAR,SP1,SIWADES:
                      *80,"Port : ",SIOMPOR
            UNPACK    SIOMDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            PRINT     "Within        : ",SIOMPER," % of Reorder":
                      *80,"Date : ",CPCDATE
            PRINT     "Include       : ",INCDESC:
                      *80,"Time : ",SIOMTIM
            PRINT     "S.O.Q. Calc.  : ",SOQDESC
            PRINT     "Delivery      : ",SIOMDEL,SP1,DELVDESC
            PRINT     "Message       : ",SIOMMES,SP1,MESSDESC
            PRINT     "Commodity     : ",FROMCOMM," to ",TOCOMM
            PRINT     "Supplier      : ",FROMSUPP," to ",TOSUPP
            PRINT     "Product Group : ",FROMPROD," to ",TOPROD
.
            ADD       NINE,CLNO
            MATCH     "   ",SIOMFIA
            IF        @EQUAL
              MATCH     "~~~",SIOMTIA
              IF        !@EQUAL
                PRINT     "Catalog Group : ",FROMIA1," to ",TOIA1
                ADD       ONE,CLNO
              ENDIF
            ELSE
              PRINT     "Catalog Group : ",FROMIA1," to ",TOIA1
              ADD       ONE,CLNO
            ENDIF
          ENDIF
.
          CALL      UND132
          MOVE      SIODSUP,KEY5
          CALL      RDAPMA1
          STRIP     APMASN1
          STRIP     APMASN2
          STRIP     APMASA1
          STRIP     APMASA2
          STRIP     APMASA3
          PACK      SUPNM100,APMACRD,SP1,APMASN1,SP1,APMASN2
          PACK      SUPAD100,APMASA1,SP1,APMASA2,SP1,APMASA3,SP1,APMASPC
          PRINT        "Supplier : ",SUPNM100:
                    *N,"         : ",SUPAD100:
                    *N,"Contact  : ",APMASCON,"  Phone    : ",APMASTEL:
                       "  Fax    : ",APMASFAX
          CALL      UND132
          PRINT     "Catalog Part Number                     Supply Unit":
                    "     Issue Unit      Factor               Quantity ":
                    "          Price          Value"
          PRINT     "W/house Supplier Description   "
          CALL      UND132
          RETURN
.
TAIL0000
          COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL
.
          MOVE      "9999,999,999.99",KEY15
          FEDIT     TOTALORD,KEY15
          PRINT     *104,"Total         ",KEY15
          CALL      UND132
.
          RETURN
.--------------------------------------------------
. Calculate Stock on Backorder
.--------------------------------------------------
BOCAL000  MOVE      ZERO,TOTALSOB
          PACK      KEY12,SIIECAT,SIIEWAR,SP70
          PACK      KEY25,SIIECAT,SIIEWAR,SP70
          CALL      RSSIBA3
BOCAL100  CALL      RKSIBA3
          BRANCH    OVRCD,BOCAL999
          PACK      KEY25,SIBACAT,SIBAWAR,SP70
          MATCH     KEY12,KEY25
          GOTO      BOCAL999 IF NOT EQUAL
          ADD       SIBAQTY,TOTALSOB
          GOTO      BOCAL100
BOCAL999  RETURN
.--------------------------------------------------
. Calculate Stock on Order
.--------------------------------------------------
OOCAL000  MOVE      SIIESOO,TOTALSOO
          RETURN
.------------------------------------------------------------
. Generate all orders for SRO
.------------------------------------------------------------
GENALL00  PACK     KEY20,SIOMSID,SP70
          CALL     RSSIOD2
          CALL     RKSIOD2
          BRANCH   OVRCD,GENALL99
          MATCH    SIOMSID,SIODSID
          GOTO     GENALL99 IF NOT EQUAL
          MOVE     SIODSUP,APMACRD
.
          CALL     DEFORD00  * Get Default Details
          BRANCH   EXIT,GENALL10
.
          CALL     POS40000  * Post Order
          BRANCH   EXIT,GENALL99
.
          GOTO     GENALL00
.
GENALL10  PACK     KEY20,SIOMSID,APMACRD
          CALL     RSSIOD2
          CALL     RKSIOD2
          BRANCH   OVRCD,GENALL00
          MATCH    SIOMSID,SIODSID
          GOTO     GENALL00 IF NOT EQUAL
          MATCH    APMACRD,SIODSUP
          GOTO     GENALL00 IF NOT EQUAL
          PACK     KEY12,SIODWAR,SIODCAT
          CALL     RASIOD1
          IF       OVRCD=0
            CALL     DESIOD1
          ENDIF
          GOTO     GENALL10
.
GENALL99  RETURN
.
.---------------------------------------------------------------
. Enter Cost
.---------------------------------------------------------------
ECOST000  MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      SIODCST,F9P4
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,F9P4
          MOVE      F9P4,SIODCST
          IF        (SIODCST<0)
            MOVE      SEQ,SIODCST
            MOVE      "        T.B.A.",UNITCOST
            MOVE      "        T.B.A.",IUNITCST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            MOVE      "9,999,999.9999",IUNITCST
.
            ASSIGN    SIODCST/SIFACTOR,F12X4
            FEDIT     F12X4,IUNITCST
            FEDIT     SIODCST,UNITCOST
.
            MOVE      SIIAGST,SIODGST
            CALL      TAXCAL00
.
            MATCH     "*",IUNITCST
            IF        @EQUAL
              MOVE      F12X4,F9P4
              MOVE      F9P4,IUNITCST
            ENDIF
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIODCST,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
.
ECOST999  RETURN
.
TAXCAL00  COMPARE   ZERO,SIODCST
          GOTO      TAXCAL90 IF EQUAL
.
          MATCH     SP6,SIODGST
          GOTO      TAXCAL90 IF EQUAL
.
          PACK      KEY8,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY8
.
          PACK      KEY14,SIODGST,KEY8,SP70
          CALL      RDIBGE1
          COMPARE   ZERO,OVRCD
          GOTO      TAXCAL10 IF EQUAL
.
          CALL      RPIBGE1
          BRANCH    OVRCD,TAXCAL90
.
          MATCH     SIODGST,IBGECODE
          GOTO      TAXCAL90 IF NOT EQUAL
.
TAXCAL10  ASSIGN    (SIODCST-(SIODCST/(ONE+(IBGEAMNT/HUNDRED)))),SIODGSTA
          GOTO      TAXCAL99
.
TAXCAL90  MOVE      ZERO,SIODGSTA
.
TAXCAL99  RETURN
.
EQTY0000  MOVE      SP70,VAR
          CALL      DISPITEM
          ASSIGN    SIODQTY*SIFACTOR,F12P2
          MOVE      F12P2,QTYFORM8
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,QTYFORM8
          IF        QTYFORM8<ZERO
            BEEP
            GOTO      EQTY0000
          ENDIF
          MOVE      QTYFORM8,ISSQTY
          ASSIGN    QTYFORM8/SIFACTOR,SIODQTY
          MOVE      ZERO,EXIT
          MATCH     SP70,SIODCON
          CALL      CHKCON00 IF NOT EQUAL
          BRANCH    EXIT,EQTY0000
          RETURN
.
. Check Contract Pricing
.-------------------------
CHKCON00  PACK      KEY45,SIODCON,SIODCAT,SIODSUP,SIODCDT,SIODSUT,SP70
          CALL      RDSISD1
          BRANCH    OVRCD,CHKCON99
.
          IF        SIODQTY<SISDMQT
            MOVE      SP70,DISPMSG
            CALL      MESSAGE2
            ASSIGN    SISDMQT*SIFACTOR,F12P2
            MOVE      F12P2,QTYFORM8
            DISPLAY   *P1:24,*EL,"Contract Minimum = ",*V2LON,SISDMQT,*HOFF:
                      " (S)/",QTYFORM8,"(I) - ";
            CALL      HITENTER
            MOVE      ONE,EXIT
            GOTO      CHKCON99
          ENDIF
.
          IF        (SISDBQ1=0)|(SIODQTY<SISDBQ1)
            MOVE      SISDUC1,F9P4
            GOTO      CHKCON99
          ENDIF
          IF        (SISDBQ2=0)|(SIODQTY<SISDBQ2)
            MOVE      SISDUC2,F9P4
            GOTO      CHKCON99
          ENDIF
          IF        (SISDBQ3=0)|(SIODQTY<SISDBQ3)
            MOVE      SISDUC3,F9P4
            GOTO      CHKCON99
          ENDIF
.
          IF        !(F9P4=SIODCST)
            MOVE      F9P4,SIODCST
            CALL      FORMAT00
          ENDIF
.
CHKCON99  RETURN
.
FORMAT00  IF        (SIODCST<0)
            MOVE      SEQ,SIODCST
            MOVE      "        T.B.A.",UNITCOST
            MOVE      "        T.B.A.",IUNITCST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            MOVE      "9,999,999.9999",IUNITCST
.
            ASSIGN    SIODCST/SIFACTOR,F12X4
            FEDIT     F12X4,IUNITCST
            FEDIT     SIODCST,UNITCOST
.
            MATCH     "*",IUNITCST
            IF        @EQUAL
              MOVE      F12X4,F9P4
              MOVE      F9P4,IUNITCST
            ENDIF
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIODCST,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
          ASSIGN    SIODQTY/SIFACTOR,F12P2
          MOVE      F12P2,QTYFORM8
          MOVE      QTYFORM8,SIODQTY
          CALL      DF01L000
          MOVE      "    22",FLDID
          CALL      GETPOSIT
          RETURN
.
ESUPT000  IF        ACCEPT=1
            MATCH     SP70,SIODSUT
            GOTO      ESUPT100 IF NOT EQUAL
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SIODCAT,SIICCAT
          MOVE      SIODSUP,SIICSUP
          CALL      KSIICA00
          MOVE      SIICSUT,SIODSUT
          BRANCH    EXIT,ESUPT999,ESUPT999
.
ESUPT100  PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
.
          MOVE      SIICLCT,SIPCECT
          IF        (SIODCST<0)
            MOVE      SEQ,SIODCST
            MOVE      "        T.B.A.",UNITCOST
            MOVE      "        T.B.A.",IUNITCST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            MOVE      "9,999,999.9999",IUNITCST
.
            ASSIGN    SIODCST/SIFACTOR,F12X4
            FEDIT     F12X4,IUNITCST
            FEDIT     SIODCST,UNITCOST
.
            MATCH     "*",IUNITCST
            IF        @EQUAL
              MOVE      F12X4,F9P4
              MOVE      F9P4,IUNITCST
            ENDIF
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIODCST,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
.
          ASSIGN    ISSQTY/SIFACTOR,F12P2
          MOVE      F12P2,QTYFORM8
          MOVE      QTYFORM8,SIODQTY
.
          IF        ACCEPT=0
            MOVE      SP70,SIODCDT
            MOVE      SP70,SIODCON
            MOVE      SP70,SISCDES
            MOVE      SP70,SISCSDT
            MOVE      SP70,SISCEDT
            CALL      DF01L000
            MOVE      "    5",FLDID
            CALL      GETPOSIT
          ENDIF
.
ESUPT999  PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
          RETURN
.
EEXDT000  IF        ACCEPT=0
            UNPACK    EXPDDATE,CCENT,CYEAR,CMON,CDAY
            CALL      KEYDATE
            PACK      EXPDDATE,CCENT,CYEAR,CMON,CDAY
            MOVE      EXPDDATE,SIODEDT
            GOTO      EEXDT999
          ENDIF
.
. Calculate Expected Delivery Date
.----------------------------------
          CALL     CALDD000
.
EEXDT999  RETURN
.
CALDD000  MOVE      CCC,CC
          MOVE      CYY,YY
          MOVE      CMM,MM
          MOVE      CDD,DD              * Todays Date
          CALL      DMYCON              * Convert to Jul Date
          ADD       SIICLTM,JULDAY      * Add Lead Time
          MOVE      JULDAY,JWKDAY
          MOVE      JULYR,JWKYER
          MOVE      JULCC,JWKCC
          CALL      JULCON              * Convert Date Back
          PACK      EXPDDATE,CC,YY,MM,DD
          REP       " 0",EXPDDATE
          RETURN
.
DELT0000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY12,SIODWAR,SIODCAT
          CALL     RASIOD1
          IF       OVRCD=0
            CALL     DESIOD1
          ENDIF
          MOVE     ZERO,EXIT
          GOTO     DELT9999
.
DELT9000  MOVE     ONE,EXIT
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT
          GOTO     DELT9999
.
DELT9999  RETURN
POST0000  PACK      KEY12,SIODWAR,SIODCAT,SP70
          CALL      RASIOD1
          IF        OVRCD=0
            CALL      UPSIOD1
          ELSE
            CALL      WRSIOD1
          ENDIF
          RETURN
.
MSUP0000  DISPLAY    *P1:24,*EL,"Enter Alternative Supplier : "
          MOVE       "24",CVERT
          MOVE       "30",CCOL
          MOVE       SP70,SIICSUP
          STRIP      SIICSUP
.
          KEYIN      *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,SIICSUP:
                     *PCCOL:CVERT,*DV,SIICSUP
.
          ENDSET    SIICSUP
          APPEND    SP70,SIICSUP
          RESET     SIICSUP
.
          MATCH     SP70,SIICSUP
          GOTO      MSUP9000 IF EQUAL
.
          ENDSET    SIICSUP
          CMATCH    EXITCHAR,SIICSUP
          GOTO      MSUP9000 IF EQUAL
.
          CMATCH    QUEST,SIICSUP
          GOTO      MSUP1000 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          MOVE      SIODCAT,SIICCAT
          CALL      HSIICB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIICSUP
          APPEND    SP70,SIICSUP
          RESET     SIICSUP
.
          MATCH     SP70,SIICSUP
          GOTO      MSUP0000 IF EQUAL
          DISPLAY   *PCCOL:CVERT,*V2LON,SIICSUP
          PACK      KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL      RDSIIC1
          COMPARE   ZERO,OVRCD
          GOTO      MSUP2000 IF EQUAL
.
MSUP1000
          RESET     SIICSUP
          PACK      KEY12,SIICCAT,SIICSUP,SP70
          PACK      KEY27,SIICCAT,SIICSUP,SP70
          CALL      RSSIIC1
MSUP1100  CALL      RKSIIC1
          BRANCH    OVRCD,MSUP8000
          PACK      KEY27,SIICCAT,SIICSUP,SP70
          MATCH     KEY12,KEY27
          GOTO      MSUP8000 IF NOT EQUAL
          COMPARE   ZERO,SIICAPO
          GOTO      MSUP1100 IF EQUAL
.
MSUP2000
.
          MOVE      SIICSUP,KEY5
          CALL      RDAPMA1
          BRANCH    OVRCD,MSUP0000
          IF        APMAHOR=1
            MOVE      "Supplier On Hold for Purchase Orders - ",DISPMSG
            CALL      MESSAGE1
            GOTO      MSUP0000
          ENDIF
          IF        SIICAPO=0
            MOVE      "P/O Not Allowed for Supplier/Supply Unit - ",DISPMSG
            CALL      MESSAGE1
            GOTO      MSUP0000
          ENDIF
.
          MOVE      SIICSUP,SIODSUP
          MOVE      SIICSUT,SIODSUT
          MOVE      SIICLCT,SIPCECT
          MOVE      SP70,SIODCON
          MOVE      SP70,SIODCDT
          CALL      POST0000
          MOVE      ZERO,EXIT
.
          GOTO      MSUP9999
.
MSUP8000  MOVE      "Supplier Not Available for This Catalog. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      MSUP0000
.
MSUP9000  MOVE      THREE,EXIT
.
MSUP9999  RETURN
.
SCREEN03  MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
          PACK      KEY12,SIODCAT,SIODWAR
          CALL      RDSIIE1
          PACK      KEY27,SIODCAT,SIODSUP,SIODSUT
          CALL      RDSIIC1
          MOVE      SIODSUP,KEY5
          CALL      RDAPMA1
          MOVE      SIODWAR,KEY5
          CALL      RDSIWA1
          CALL      SC03L000
          RETURN
.
LINDET00  MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
.
          PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
.
          CLEAR     LINEDESC
          APPEND    SIODCAT,LINEDESC
          APPEND    SP1,LINEDESC
          APPEND    SIIADES,LINEDESC
          RESET     LINEDESC
.
          MOVE      "9999,999",QUANTITY
.         ASSIGN    SIODQTY/SIFACTOR,F12P2
.         MOVE      F12P2,QTYFORM8
          MOVE      SIODQTY,QTYFORM8
          FEDIT     QTYFORM8,QUANTITY
          MATCH     "*",QUANTITY
          IF        @EQUAL
            MOVE      QTYFORM8,QUANTITY
          ENDIF
.
          IF        SIODCST<0
            MOVE      "       T.B.A.",LINECOST
            MOVE      "      T.B.A.",UNITCOST
          ELSE
            MOVE      "99,999,999.99",LINECOST
            MOVE      "99,999.9999",UNITCOST
            ASSIGN    QTYFORM8*SIODCST,F10P2
            FEDIT     F10P2,LINECOST
            MATCH     "*",LINECOST
            IF        @EQUAL
              MOVE      F10P2,LINECOST
            ENDIF
            MOVE      SIODCST,F8P2
            FEDIT     F8P2,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      F8P2,UNITCOST
            ENDIF
          ENDIF
.
          CALL      CHKNOT00
.
          RETURN
.
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NAPSN000  MOVE        SP70,NOTEAPSN
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILAPSN1
          TRAPCLR     IO
          BRANCH      OVRCD,NAPSN999
NAPSN100  READ        TEMPWORD,SEQ;APSNDAT
          GOTO        NAPSN900 IF OVER
          MATCH       SP70,APSNDAT
          GOTO        NAPSN100 IF EQUAL
          MOVE        "Notes",NOTEAPSN
NAPSN900  CLOSE       TEMPWORD
NAPSN999  RETURN
.
SELLIN00  MOVE      SIOD2MKY,KEY20
          CALL      RDSIOD2
          IF        OVRCD=1
            BEEP
            MOVE      "Record Not on File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SELLIN99
          ENDIF
          MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
          PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
          MATCH     SP70,SIODCON
          IF        @EQUAL
            MOVE      SP70,SISCDES
            MOVE      SP70,SISCSDT
            MOVE      SP70,SISCEDT
          ELSE
            MOVE      SIODCON,KEY10
            CALL      RDSISC1
          ENDIF
.
          PACK      KEY27,SIODCAT,SIODSUP,SIODSUT
          CALL      RDSIIC1
.
          IF        SIODCST<0
            MOVE      SEQ,SIODCST
            MOVE      "        T.B.A.",UNITCOST
            MOVE      "        T.B.A.",IUNITCST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            MOVE      "9,999,999.9999",IUNITCST
            ASSIGN    SIODCST/SIFACTOR,F12X4
            FEDIT     F12X4,IUNITCST
            FEDIT     SIODCST,UNITCOST
            MATCH     "*",IUNITCST
            IF        @EQUAL
              MOVE      F12X4,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIODCST,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
.
.         ASSIGN    SIODQTY/SIFACTOR,F12P2
.         MOVE      F12P2,QTYFORM8
.         MOVE      QTYFORM8,SUPPQTY
.
          ASSIGN    SIODQTY*SIFACTOR,ISSQTY
.
          CALL      CHKNOT00
          MATCH     SP70,SIODEDT
          IF        @EQUAL
            CALL      CALDD000
          ELSE
            MOVE      SIODEDT,EXPDDATE
          ENDIF
.
          CALL      SC01L000
.
SELLIN99  RETURN
.
. Catalog Supplier Notes
.
CHKNOT00  MOVE        SP70,NOTELINE
          MOVE        "     ",NOTESIID
          MOVE        "0",NSIIDYN
          PACK        KEY12,SIODCAT,SIODSUP,SP70
          PACK        KEY15,SIODCAT,SIODSUP,SP70
          CALL        RSSIID1
CHKNOT10  CALL        RKSIID1
          BRANCH      OVRCD,CHKNOT20
          PACK        KEY15,SIIDCAT,SIIDSUP,SP70
          MATCH       KEY12,KEY15
          GOTO        CHKNOT20 IF NOT EQUAL
          MATCH       SP70,SIIDCOM
          GOTO        CHKNOT10 IF EQUAL
          MOVE        "Notes",NOTESIID
          MOVE        "1",NSIIDYN
          MOVE        "N",NOTELINE
.
. Catalog Warehouse Notes
.
CHKNOT20  MOVE        "     ",NOTESIIG
          MOVE        "0",NSIIGYN
          PACK        KEY12,SIODCAT,SIODWAR,SP70
          PACK        KEY15,SIODCAT,SIODWAR,SP70
          CALL        RSSIIG1
CHKNOT30  CALL        RKSIIG1
          BRANCH      OVRCD,CHKNOT40
          PACK        KEY15,SIIGCAT,SIIGWAR,SP70
          MATCH       KEY12,KEY15
          GOTO        CHKNOT40 IF NOT EQUAL
          MATCH       SP70,SIIGCOM
          GOTO        CHKNOT30 IF EQUAL
          MOVE        "Notes",NOTESIIG
          MOVE        "1",NSIIGYN
          MOVE        "N",NOTELINE
.
. Catalog Notes
.
CHKNOT40  MOVE        "     ",NOTESIIB
          MOVE        "0",NSIIBYN
          PACK        KEY7,SIODCAT,SP70
          PACK        KEY10,SIODCAT,SP70
          CALL        RSSIIB1
CHKNOT50  CALL        RKSIIB1
          BRANCH      OVRCD,CHKNOT60
          MATCH       SIODCAT,SIIBCAT
          GOTO        CHKNOT60 IF NOT EQUAL
          MATCH       SP70,SIIBCOM
          GOTO        CHKNOT50 IF EQUAL
          MOVE        "Notes",NOTESIIB
          MOVE        "1",NSIIBYN
          MOVE        "N",NOTELINE
CHKNOT60  RETURN
.
ADDORD00  MOVE      APMACRD,SIODSUP
          MOVE      SIOMWAR,SIODWAR
          MOVE      SIOMSID,SIODSID
.
ADORD100  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
ADORD200  CALL      CFORD000 * Clear Fields
          CALL      KYORD000 * Enter Key Fields
          BRANCH    EXIT,ADORD999
          MOVE      ZERO,ACCEPT
          CALL      DF01L000 * Display Fields
          MOVE      ONE,ACCEPT
          CALL      SF01L000 * Select Fields
          GOTO      ADORD100
.
ADORD999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Seleted Item to Modify
.--------------------------------------------------------
KYORD000  MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      KYORD900
          ENDIF
.
KYORD100  MOVE      ZERO,CKEYTYP
.
          MOVE      SIODSUP,SIICSUP  * For ? Option
          MOVE      SP70,SIICCAT
          MOVE      SP70,SIICSUT
          CALL      KCATAA00
          BRANCH    EXIT,KYORD900,KYORD900
.
          MOVE      SIIACAT,SIODCAT
          PACK      KEY12,SIODWAR,SIODCAT
          CALL      RASIOD1
          IF        OVRCD=0
            MOVE      "Catalog Already on Suggested Order File. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      KYORD100
          ENDIF
.
          PACK      KEY12,SIODCAT,SIODWAR
          CALL      RDSIIE1
          IF        OVRCD=1
            MOVE      "Catalog Not in Warehouse. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      KYORD100
          ENDIF
.
          MATCH     SP70,SIICSUT
          IF        @EQUAL
            PACK      KEY27,SIODCAT,SIODSUP,SP70
            CALL      RSSIIC1
            CALL      RKSIIC1
            BRANCH    OVRCD,KYORD800,KYORD800
            MATCH     SIODCAT,SIICCAT
            GOTO      KYORD800 IF NOT EQUAL
            MATCH     SIODSUP,SIICSUP
            GOTO      KYORD800 IF NOT EQUAL
          ENDIF
.
          CALL      GETCON00
          BRANCH    EXIT,KYORD100
.
          CALL      CHKNOT00
.
          CALL      CALDD000      * Calculate Delivery Date
.
          MOVE      ZERO,EXIT
          GOTO      KYORD999
.
KYORD800  MOVE      "Catalog Not Available for This Supplier - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      KYORD100
KYORD900  MOVE      ONE,EXIT
KYORD999  RETURN
.
GETCON00  MOVE      ZERO,ACCEPT
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY12,SIODSUP,SIODCAT
          PACK      KEY45,SIODSUP,SIODCAT,CURRDATE,Z70
          CALL      RSSISD3
          CALL      RPSISD3                 * Get Lastest Contract Price
          BRANCH    OVRCD,GETCON50          * This supplier and catalog
          PACK      KEY45,SISDSUP,SISDCAT,SP70
          MATCH     KEY12,KEY45             * Correct Supplier&Catalog
          GOTO      GETCON50 IF NOT EQUAL
          MOVE      SISDCON,KEY10           * Get Contract Header
          CALL      RDSISC1
          BRANCH    OVRCD,GETCON50          * Contact Header Deleted
          MATCH     CURRDATE,SISCEDT        * Check for Completed Contract
          GOTO      GETCON50 IF LESS        * Contract Out of Date
          MOVE      SISDCON,SIODCON
          MOVE      SISDSDT,SIODCDT
          MOVE      SISDSUT,SIODSUT
          MOVE      ZERO,EXIT
          GOTO      GETCON99
.
. Not On Contract for This Supplier so check for any current contracts
.----------------------------------------------------------------------
GETCON50  PACK      KEY45,SIODCAT,CURRDATE,Z70
          CALL      RSSISD2                 * Check for Contract Price
          CALL      RPSISD2                 * Lastest Price
          BRANCH    OVRCD,GETCON90          * No Contract
.
          MATCH     SISDCAT,SIODCAT         * Correct Catalog
          GOTO      GETCON90 IF NOT EQUAL   * No Contract
.
          MOVE      SISDCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,GETCON90          * No Contract
.
          MATCH     CURRDATE,SISCEDT        * Check for Completed Contract
          GOTO      GETCON90 IF LESS        * Contract Out of Date
.
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          BEEP
          DISPLAY   *P1:24,*EL,"Catalog on Contract : ":
                    *V2LON,SISDCON,*HOFF," for Supplier ":
                    *V2LON,SISDSUP,*HOFF,". Ok to Continue (":
                    *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? "
          MOVE      "75",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        FYESNO=1
            MOVE      ZERO,EXIT
          ELSE
            MOVE      ONE,EXIT
          ENDIF
          CALL      MESSAGE3
          GOTO      GETCON99
.
GETCON90  MOVE      ZERO,EXIT
          CALL      CLRCON00
          MOVE      SP70,SIODCON
          MOVE      SP70,SIODCDT
.
GETCON99  RETURN
.--------------------------------------------------
. Enter Catalog Code Specific Supplier
.--------------------------------------------------
KCATAA00  READ      CONTROLF,SIXTY3;*67,INCOCATE,*141,INCNNATO
          MOVE      SP70,NATOCODE
          MOVE      SP70,SIIACAT
          COMPARE   ZERO,INCOCATE
          GOTO      KCATAA01 IF NOT EQUAL
.
          KEYIN     *PCCOL:CVERT,*V2LON,NATOCODE
.
          ENDSET    NATOCODE
          APPEND    SP70,NATOCODE
          RESET     NATOCODE
.
          MATCH     SP70,NATOCODE
          IF        @EQUAL
            MOVE      ONE,EXIT
            GOTO      KCATAA99
          ENDIF
.
          CMATCH    EXITCHAR,NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          REP       UPPLOW,NATOCODE
          MATCH     "E         ",NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          CMATCH    QUEST,NATOCODE
          GOTO      KCATAA10 IF NOT EQUAL
          GOTO      KCATAA02
.
KCATAA01
          MOVE      SP70,NATOCODE
          KEYIN     *PCCOL:CVERT,*V2LON,*JR,NATOCODE
.
          ENDSET    NATOCODE
          APPEND    SP70,NATOCODE
          RESET     NATOCODE
.
          MATCH     SP70,NATOCODE
          IF        @EQUAL
            MOVE      ONE,EXIT
            GOTO      KCATAA99
          ENDIF
.
          REP       UPPLOW,NATOCODE
          ENDSET    NATOCODE
.
          CMATCH    EXITCHAR,NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          MATCH     "E",NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          CMATCH    QUEST,NATOCODE
          GOTO      KCATAA02 IF EQUAL
          RESET     NATOCODE
          GOTO      KCATAA10
.
KCATAA02  MOVE      CCITEM,SCCITEM
          MATCH     SIWAWAR,SP70
          CALL      HSIICC00             * Normal Catalog Lookup
.
          ENDSET    SIICCAT
          APPEND    SP70,SIICCAT
          RESET     SIICCAT
.
          MATCH     SP70,SIICCAT
          GOTO      KCATAA00 IF EQUAL
.
          MOVE      SIICCAT,SIIACAT
          PACK      KEY7,SIIACAT
          CALL      RDSIIA1
          BRANCH    OVRCD,KCATAA80
.
          PACK      KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL      RASIIC1
          IF        OVRCD=0
            CALL      RDSIIC1
          ELSE
            MOVE      SIODSUP,SIICSUP
            MOVE      SP70,SIICSUT
          ENDIF
          DISPLAY   *PCCOL:CVERT,*V2LON,SIIACAT,SP3
.
          MOVE      ZERO,EXIT
          GOTO      KCATAA99
.
KCATAA10
          IF        INCOCATE<>0
            UNPACK    NATOCODE,KEY3,KEY7
          ELSE
            UNPACK    NATOCODE,KEY7,KEY3
          ENDIF
          MOVE      KEY7,SIIACAT
.
          MATCH     KEY3,SP3          * Check if too large for Catalog - Nato?
          IF        @EQUAL
            CALL      RASIIA1
          ELSE
            IF        INCNNATO<>1
              MOVE      "Entry too long for a Catalog Code - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KSIIAA00
            ELSE
              MOVE      ONE,OVRCD     * Simulate for Nato Lookup
            ENDIF
          ENDIF
.
. ------- OVRCD=1 if not found on catalog file or if > 7 chars keyed in and
. ------- Nato Codes are being used.
          IF        OVRCD=1
            CALL      CHKNATO0               * Check Nato File
            BRANCH    EXIT,KSIIAA00
          ENDIF
          PACK      KEY7,SIIACAT
          CALL      RDSIIA1
          BRANCH    OVRCD,KCATAA00
          MOVE      ZERO,EXIT
          GOTO      KCATAA99
.
KCATAA80  BEEP
          MOVE      "Catalog Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KCATAA00
.
KCATAA90  MOVE      ONE,EXIT
          GOTO      KCATAA99
.
KCATAA95  MOVE      TWO,EXIT
          GOTO      KCATAA99
.
KCATAA96  MOVE      THREE,EXIT
.
KCATAA99  RETURN
.---------------------------------------------------------------------------
. Check if SIIANAT is from the Nato File.
.-------------------------------------------------------------------------------
CHKNATO0  MOVE      ZERO,EXIT
.
          MOVE      NATOCODE,KEY10
.
          SQUEEZE   KEY10
          PACK      KEY17,KEY10,SP70
          RESET     KEY10
          MOVE      KEY17,KEY10
.
          IF        INCNNATO=0
            IF        CKEYTYP<>1 & CKEYTYP<>2
              MOVE      "Catalog Does Not Exist - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
            ENDIF
            GOTO      CHKNATO9
          ENDIF
.
          MOVE      SP70,SINANAT
          CALL      RSSINA2
          CALL      RKSINA2
          MATCH     SINANAT,KEY10
          IF        OVRCD=1 | !@EQUAL
            IF CKEYTYP<>1 & CKEYTYP<>2
              MOVE      "Catalog or Nato Code Does Not Exist - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      CHKNATO9
            ENDIF
            IF        INCOCATE<>0
              UNPACK    NATOCODE,KEY3,SIIACAT
            ELSE
              UNPACK    NATOCODE,SIIACAT,KEY3
            ENDIF
          ELSE
            IF        @EQUAL & (CKEYTYP=1 | CKEYTYP=2)
              MOVE      "Nato Code Already Exists - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      CHKNATO9
            ENDIF
            MOVE      SINACAT,SIIACAT
          ENDIF
.
CHKNATO9  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Seleted Item to Modify
.-------------------------------------------------------
CFORD000  MOVE      SP70,SIODCAT
          MOVE      ZERO,SIODCST
          MOVE      ZERO,SIODQTY
          MOVE      SP70,SIODSUT
          MOVE      SP70,SIODCON
          MOVE      SP70,SIODCDT
          MOVE      SP70,SIODSPA
          MOVE      SP70,UNITCOST
          MOVE      SP70,IUNITCST
.
. Clear Contract
.
CLRCON00  MOVE      SP70,SISCCON
          MOVE      SP70,SISCDES
          MOVE      SP70,SISCSDT
          MOVE      SP70,SISCFI2
          MOVE      SP70,SISCEDT
          MOVE      SP70,SISCUR1
          MOVE      SP70,SISCUR2
          MOVE      SP70,SISCUD1
          MOVE      SP70,SISCUD2
          MOVE      SP70,SISCUC1
          MOVE      SP70,SISCUC2
          MOVE      SP70,SISCUY1
          MOVE      SP70,SISCUY2
          MOVE      SP70,SISCSPA
.
          MOVE      SP70,SISDCON
          MOVE      SP70,SISDSUP
          MOVE      SP70,SISDCAT
          MOVE      SP70,SISDSDT
          MOVE      SP70,SISDSUT
          MOVE      SP70,SISDPO1
          MOVE      SP70,SISDPO2
          MOVE      SP70,SISDUR1
          MOVE      SP70,SISDUR2
          MOVE      SP70,SISDUD1
          MOVE      SP70,SISDUD2
          MOVE      SP70,SISDUY1
          MOVE      SP70,SISDUY2
          MOVE      SP70,SISDSPA
          MOVE      ZERO,SISDUC1
          MOVE      ZERO,SISDUC2
          MOVE      ZERO,SISDUC3
          MOVE      ZERO,SISDUC4
          MOVE      ZERO,SISDBQ1
          MOVE      ZERO,SISDBQ2
          MOVE      ZERO,SISDBQ3
          MOVE      ZERO,SISDMQT
          RETURN
.--------------------------------
. Screen - Generate Order Fields
.--------------------------------
GENORD00  CALL      DEFORD00
          BRANCH    EXIT,GENORD80
.
          PREP      TEMPWORD,FILSIPB1        * Init. Word Processor File
          CLOSE     TEMPWORD
.
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
          MOVE      ZERO,ACCEPT
          CALL      DF04L000 * Display Fields
.
          MOVE      ZERO,CATFLAG
          CALL      SF04L000 * Select Fields
.
          PREP      TEMPWORD,FILSIPB1        * Init. Word Processor File
          CLOSE     TEMPWORD
          IF        CATFLAG=1
            MOVE      THREE,EXIT
          ELSE
            MOVE      ZERO,EXIT
          ENDIF
          GOTO      GENORD99
.
GENORD80  MOVE      THREE,EXIT
.
GENORD99  RETURN
.------------------------------------------------------------
. Set Up Default Values for Purchase Order
.------------------------------------------------------------
DEFORD00  MOVE      APMACRD,SIPASUP
          MOVE      APMACRD,KEY5
          CALL      RDAPMA1
          MOVE      APMASCON,SIPASCN
.
          MOVE      SP70,SIPACON
          MOVE      SP70,SIPAICN
          MOVE      SIOMDEL,SIPAPNT
          MOVE      SIOMORG,SIPAORI
          MOVE      SIOMORG,KEY3
          CALL      RDSIOR1
          IF        OVRCD=0
            MOVE      SIORHOSP,SIPAICN
            MOVE      SIORCON,SIPACON
          ENDIF
.
          MOVE      SP70,MESSDESC
          MOVE      SP70,CONFDESC
          MOVE      SP70,SIPAIDP
          MOVE      SP70,SIPAUR1
          MOVE      SP70,SIPAUR2
          MOVE      SP70,SIPAUD1
          MOVE      SP70,SIPAUD2
          MOVE      SP70,SIPAUC1
          MOVE      SP70,SIPAUC2
          MOVE      SP70,SIPAUY1
          MOVE      SP70,SIPAUY2
.
          MOVE      SIOMDEL,F1
          LOAD      SIPADEL,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                               HADEL5,HADEL6,HADEL7,HADEL8
.
          MOVE      SIOMMES,SIPAMES
          MOVE      SP70,MESSDESC
          MATCH     SP70,SIPAMES
          IF        !@EQUAL
            MOVE      "ME ",SICDCATA
            PACK      KEY6,SICDCATA,SIPAMES
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,MESSDESC
            ENDIF
          ENDIF
          MATCH     SP70,SIPACON
          IF        !(@EQUAL)
            MOVE      "CF ",SICDCATA
            PACK      KEY6,SICDCATA,SIPACON
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,CONFDESC
            ENDIF
          ENDIF
.
          MOVE      ZERO,ORDTOTAL
          MOVE      ONE,EXIT
          PACK      CHKKEY8,SIOMSID,APMACRD,SP70
          PACK      KEY20,SIOMSID,APMACRD,SP70
          CALL      RSSIOD2
DEFORD10  CALL      RKSIOD2
          BRANCH    OVRCD,DEFORD20
          PACK      KEY20,SIODSID,SIODSUP,SP70
          MATCH     CHKKEY8,KEY20
          GOTO      DEFORD20 IF NOT EQUAL
          MOVE      ZERO,EXIT
          IF        SIODCST<0
            GOTO      DEFORD10
          ENDIF
.
          MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
          PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
          ASSIGN    (ORDTOTAL+(SIODQTY*SIODCST)),ORDTOTAL
.
          GOTO      DEFORD10
.
DEFORD20  IF        EXIT=1
            MATCH     "04",SCRID
            IF        @EQUAL
              MOVE      "Nothing to Order for That Supplier. - ",DISPMSG
              BEEP
              CALL      MESSAGE1
            ENDIF
          ENDIF
          RETURN
.
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIIB000  MOVE        SP70,NOTESIIB
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIIB1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIIB999
NSIIB100  READ        TEMPWORD,SEQ;SIIBCOM
          GOTO        NSIIB900 IF OVER
          MATCH       SP70,SIIBCOM
          GOTO        NSIIB100 IF EQUAL
          MOVE        "Notes",NOTESIIB
.
NSIIB900  CLOSE       TEMPWORD
NSIIB999  RETURN
.
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIIG000  MOVE        SP70,NOTESIIG
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIIG1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIIG999
NSIIG100  READ        TEMPWORD,SEQ;SIIGCOM
          GOTO        NSIIG900 IF OVER
          MATCH       SP70,SIIGCOM
          GOTO        NSIIG100 IF EQUAL
          MOVE        "Notes",NOTESIIG
.
NSIIG900  CLOSE       TEMPWORD
NSIIG999  RETURN
.
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIID000  MOVE        SP70,NOTESIID
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIID1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIID999
NSIID100  READ        TEMPWORD,SEQ;SIIDCOM
          GOTO        NSIID900 IF OVER
          MATCH       SP70,SIIDCOM
          GOTO        NSIID100 IF EQUAL
          MOVE        "Notes",NOTESIID
.
NSIID900  CLOSE       TEMPWORD
NSIID999  RETURN
.
EDELP000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SIPADEL:
                    *PCCOL:CVERT
          ENDSET    SIPADEL
          APPEND    SP70,SIPADEL
          RESET     SIPADEL
          CMATCH    EXITCHAR,SIPADEL
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      EDELP999
          ENDIF
          MOVE      "0",SIPAPNT
          MOVE      SIPADEL,ANS
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,EDELP100,EDELP100,EDELP100,EDELP100:
                       EDELP100,EDELP100,EDELP100,EDELP100
          GOTO      EDELP999
.
EDELP100  IF        HPURCHP=6
            MOVE      F1,SIPAPNT
            IF        F1 >=1 & F1 <6
              LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                 HADEL5
              PACK      SIPADEL,DIM30,SP70
              GOTO      EDELP999
            ELSE
              MOVE      "6",SIPAPNT
            ENDIF
          ENDIF
.
          IF        HPURCHP=16
            MOVE      F1,SIPAPNT
            IF        F1 >=1 & F1 <9
              LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                 HADEL5,HADEL6,HADEL7,HADEL8
              PACK      SIPADEL,DIM30,SP70
              GOTO      EDELP999
            ELSE
              MOVE      "0",SIPAPNT
              PACK      DIM30,HADEL3,SP70
              GOTO      EDELP999
            ENDIF
          ENDIF
.
          LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                             HADEL5,HADEL6,HADEL7,HADEL8
          PACK      SIPADEL,DIM30,SP70
.
EDELP999  RETURN
.----------------------------------------------
. Enter Message Code
.----------------------------------------------
EMESS000  MOVE        ZERO,CKEYTYP
          MOVE        "ME ",SICDCATA
          MOVE        SP70,MESSDESC
          CALL        KSICDB00
          BRANCH      EXIT,EMESS999,EMESS999
          MOVE        SICDCODE,SIPAMES
          MOVE        SICDDESC,MESSDESC
.
EMESS999  RETURN
.
.----------------------------------------------
. Enter Confirmation Code
.----------------------------------------------
ECONF000  MOVE        ZERO,CKEYTYP
          MOVE        "CF ",SICDCATA
          MOVE        SP70,CONFDESC
          CALL        KSICDB00
          BRANCH      EXIT,ECONF999,ECONF999
          MOVE        SICDCODE,SIPACON
          MOVE        SICDDESC,CONFDESC
.
ECONF999  RETURN
.
CAN40000  MOVE      ONE,CATFLAG
          RETURN
.------------------------------------------------------------
. Generate Order
.------------------------------------------------------------
POS40000  CALL      RDCON000                * Read some parameters
          BRANCH    EXIT,POS49999
.
          CALL      POHED000                * Create P/O Header
          BRANCH    EXIT,POS49999
.
          DISPLAY   *P1:24,*EL,"Generating Order No. : ",*V2LON,SIPAPON
          MOVE      ZERO,F3
          PACK      CHKKEY8,SIOMSID,SIPASUP,SP70
          PACK      KEY20,SIOMSID,SIPASUP,SP70
          CALL      RSSIOD2
.
POS41000  CALL      RKSIOD2
          BRANCH    OVRCD,POS43000
          PACK      KEY20,SIODSID,SIODSUP,SP70
          MATCH     CHKKEY8,KEY20
          GOTO      POS43000 IF NOT EQUAL
.
          CALL      POLIN000        * Write P/O Line Item
          CALL      UPSOO000        * Update Stock on Order
.
          PACK      KEY12,SIODWAR,SIODCAT
          CALL      RASIOD1
          IF        OVRCD=0
            CALL      DESIOD1
          ENDIF
.
          CALL      USCEA000        * Update Stock to A/P files
          CALL      UPCST000        * Update Last & Avg Cost
.
          COMPARE   ZERO,SNCOSMX    * Check Max Lines per Order for SRO
          GOTO      POS41000 IF EQUAL
.
          IF        F3>SNCOSMX | F3=SNCOSMX
            CALL       POEND000
            CALL       POHED000
            DISPLAY   *P1:24,*EL,"Generating Order No. : ",*V2LON,SIPAPON
            MOVE      ZERO,F3
          ENDIF
.
          GOTO      POS41000
.
POS43000  CALL      POEND000
.
POS49000  CALL      UUSIPA1
          MOVE      TWO,EXIT
.
POS49999  RETURN
.------------------------------------------------------------
. Create P/O Header
.------------------------------------------------------------
POHED000  MOVE      SIOMWAR,SIPAWAR  * Set Header Record Warehouse
          CALL      SINORDNO         * Get Next Order Number
          IF        OVRCD=1
            MOVE      "Unable to Allocate an Order Number - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      POHED999
          ENDIF
.
          CALL      WTRN0000         * Write to Barwon transfer if BLS supplier
.
          MATCH     "04",SCRID
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Generating Order No. : ",*V2LON,SIPAPON:
                      *HOFF," - ";
            CALL      HITENTER
          ENDIF
.
          MOVE      SIPAPON,KEY7
          CALL      RASIPA1
          IF        OVRCD=0
            GOTO      POHED000
          ELSE
            MOVE     SIPEDATE,SIPADIN
            MOVE     SP70,SIPADPR
            MOVE     SP70,SIPADCN
            MOVE     SP70,SIPADCM
            CALL     WRSIPA1
            CALL     RLSIPA1
            MOVE     ONE,AUDTTYPE
            CALL     WASIPA00                 * Audit Add
          ENDIF
.
          PACK      KEY7,SIPAPON
          CALL      RDSIRP1
          IF        OVRCD=1
            MOVE      SIPAPON,SIRPPON
            CALL      WRSIRP1
          ENDIF
.
POHED999  RETURN
.------------------------------------------------------------
. Process End of P/O
.------------------------------------------------------------
POEND000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPB1
          TRAPCLR   IO
          BRANCH    OVRCD,POEND999
          MOVE      ZERO,F3
.
POEND100  READ      TEMPWORD,SEQ;SIPBCOM
          GOTO      POEND999 IF OVER
          ADD       ONE,F3
          PACK      KEY10,SIPAPON,F3,SP70
          UNPACK    KEY10,SIPBPON,SIPBLIN
          CALL      WRSIPB1
          GOTO      POEND100
.
POEND999  RETURN
.------------------------------------------------------------
. Write Line to P/O
.------------------------------------------------------------
POLIN000  MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
          PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
.
          MOVE      SIODQTY,SIPCOQT
.
          MOVE      "Stock",SIPCCST
          MOVE      SIIASUB,SIPCPRD
.
          PACK      SIPCDAT,SIPEYEAR,SIPEPER,SP70
          MOVE      SIODWAR,SIPCWAR
          MOVE      SIODCAT,SIPCCAT
          PACK      KEY27,SIODCAT,SIODSUP,SIODSUT
          CALL      RDSIIC1
          IF        OVRCD<>0
            CALL      NEWSIC00        * New Supplier Record
          ELSE
            MOVE      SIODSUT,SIPCSUT
            MOVE      SIODCST,SIPCECT
            MOVE      SIODGSTA,SIPCGSTA
            MOVE      SIODGST,SIPCGST
          ENDIF
          MOVE      SIICPNO,SIPCPN * Stock Orders Not Required
          MOVE      SIICPD1,SIPCPD * Stock Orders Not Required
.
          MATCH     SP70,SIODEDT
          IF        @EQUAL
            CALL      CALDD000
            MOVE      EXPDDATE,SIODEDT
          ENDIF
          MOVE      SIODCDT,SIPCCDT
          MOVE      SIODCON,SIPCCON
          MOVE      SIODEDT,SIPCEDD
          MOVE      SP70,SIPCFDD
          MOVE      SIPCOQT,SIPCOQO
          MOVE      SIPCECT,SIPCOOP
          MOVE      SIPCGSTA,SIPCOGS
          MOVE      ZERO,SIPCRQT
          MOVE      ZERO,SIPCIQT
          MOVE      ZERO,SIPCTCR
          MOVE      ZERO,SIPCTIN
          MOVE      SP70,SIPCUR1
          MOVE      SP70,SIPCUR2
          MOVE      SP70,SIPCUD1
          MOVE      SP70,SIPCUD2
          MOVE      SP70,SIPCUY1
          MOVE      SP70,SIPCUY2
          MOVE      SP70,SIPCSPA
.
          MOVE      SIPAPON,SIPCPON
          MOVE      ONE,F3
.
POLIN100  MOVE      F3,SIPCITM
          PACK      KEY10,SIPCPON,SIPCITM
          CALL      RASIPC1
          IF        OVRCD=0
            ADD       ONE,F3
            GOTO      POLIN100
          ELSE
            DISPLAY   *P35:24,SIPCITM
            CALL      WRSIPC1
            MOVE      ONE,AUDTTYPE
            CALL      WASIPC00                 * Audit Add
          ENDIF
.
POLIN999  RETURN
.------------------------------------------------------------
. Update Stock On Order
.------------------------------------------------------------
UPSOO000  PACK      KEY12,SIPCCAT,SIPCWAR
          CALL      RDSIIE1
          IF        OVRCD=0
            ASSIGN    SIPCOQT*SIFACTOR,SIUSQTY
            IF        SIPCECT<0
              MOVE      ZERO,SIUSCST
            ELSE
              IF        SNCOPURC=1
                ASSIGN    SIPCECT*SIPCOQT,SIUSCST
              ELSE
                MOVE      SIPCECT,F12P4
                SUB       SIPCGSTA,F12P4
                ASSIGN    F12P4*SIPCOQT,SIUSCST
              ENDIF
            ENDIF
            ADD       SIUSQTY,SIIESOO
            CALL      UPSIIE1                    * Update Stock on Order
            CALL      SINORDUS                   * Update Purchases Usage
          ENDIF
          RETURN
.
.------------------------------------------------------------
. Update Last & Avg Cost
.------------------------------------------------------------
UPCST000  IF        HLASTCIN=1
            MATCH     SIPCCAT,SP70
            IF        !@EQUAL
              PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
              CALL      RDSIIC1
              IF        OVRCD=0
                MOVE      SIPCECT,SIICLCT
                CALL      UPSIIC1
              ENDIF
            ENDIF
          ENDIF
.
UPCST100  CALL      RLSIIA1
          IF        OVRCD=0
            CALL      UPSIIA1
            CALL      UUSIIA1
            GOTO      UPCST999
          ENDIF
          IF        OVRCD=2
            CLEAR     DISPMSG
            APPEND    "Catalog Code : ",DISPMSG
            APPEND    SIIACAT,DISPMSG
            APPEND    " Locked.  Keep Trying - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      UPCST100
          ENDIF
UPCST999  RETURN
.----------------------------------------------------------------------
. NEWSIC00    New SIIC record
.----------------------------------------------------------------------
NEWSIC00  DISPLAY   *P1:24,"Cat/Sup/Unit (",SIICCAT,"/",SIICSUP,"/":
                           SIICSUT,") Comb. is now invalid - ";
          CALL      HITENTER
          DISPLAY   *P1:24,*EL,"Catalog: ",SIIACAT,"  Supplier: ",SIICSUP:
                               "  Enter Supplier Unit: ";
          MOVE      SIODCAT,SIICCAT
          MOVE      SIODSUP,SIICSUP
          MOVE      "24",CVERT
          MOVE      "57",CCOL
          CALL      KSIICA00
          BRANCH    EXIT,NEWSIC90,NEWSIC90
.
          MOVE      ONE,SIFACTOR
          PACK      KEY30,SIIAISS,SIPCSUT
          CALL      RDSIFA1
          MOVE      SIODQTY,SIPCOQT
          MOVE      SIICSUT,SIPCSUT
          MOVE      SIICLCT,SIPCECT
          MOVE      SIIAGST,SIPCGST
          CALL      CALTAX00
.         GOTO      NEWSIC99
.
NEWSIC90  MOVE      ONE,EXIT
.
NEWSIC99  RETURN
.----------------------------------------------------------------------
. HACCNT    FORM 1  Running the Accounting System          0=No
. HACCDATA  DIM  20 General Ledger Data Directory
. HORDDES   DIM  1  Order Number Alhpa Prefix
.----------------------------------------------------------------------
RDCON000  MOVE      ZERO,OVRCD
          READ      CONTROLF,TWENTY3;*95,HACCNT,*124,HORDDES
          READ      CONTROLF,TWENTY4;*135,HACCDATA,*165,HLASTCIN
          READ      CONTROLF,SIXTY3;*154,SNCOSMX
          COMPARE   ONE,HACCNT
          GOTO      RDCON900 IF NOT EQUAL
.
.---- GL interface is on ----
.
          CLOSE     CONTROLF           * get gl control file if possible
          MOVE      "controlf.txt",KEY12
          PACK      KEY80,HACCDATA,KEY12
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CONTROLF,KEY80
          TRAPCLR   IO
          IF        OVRCD=1
            OPEN      CONTROLF,"controlf"
          ENDIF
.
          CALL      RDFMCO50           * Read Account Code Parameters
          CALL      RDFMCO51
          CALL      RDFMCO52
          CALL      RDFMCO65
          CLOSE     CONTROLF
          OPEN      CONTROLF,"controlf"
.
          MOVE      "fmsamaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSAMAA1,KEY80
.
          MOVE      "fmslmaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMAA1,KEY80
.
          MOVE      "fmslmcaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMCA1,KEY80
.
          MOVE      "fmscsaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSCSAA1,KEY80
.
          MOVE      "fmstupaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSTUPA1,KEY80
.
          MOVE      ZERO,OVRCD
          MOVE      "apsceaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          TRAP      OVERCOND IF IO
          OPEN      APSCEAA1,KEY80
          TRAPCLR   IO
.
          MOVE      "apscebaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          TRAP      OVERCOND IF IO
          OPEN      APSCEBA1,KEY80
          TRAPCLR   IO
.
          IF        OVRCD=1
            CLEAR     DISPMSG
            APPEND    KEY8,DISPMSG
            APPEND    " does not exist. Create and Re-try - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      RDCON999
          ENDIF
.
RDCON900  PACK      SIPEDATE,CCC,CYY,CMM,CDD
          REP       " 0",SIPEDATE
          MOVE      ZERO,EXIT
          CALL      RSIPE000
          IF        OVRCD=1
            MOVE      "Unable to find Processing Period - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      RDCON999
          ENDIF
          IF        SIPELOC=1
            MOVE      "Processing Period Locked - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      RDCON999
          ENDIF
.
RDCON999  RETURN
.----------------------------------------------------------------------
. Update Stock Item to Accounts Payable Files             - in POS40000
.----------------------------------------------------------------------
USCEA000  COMPARE   ONE,HACCNT
          GOTO      USCEA999 IF NOT EQUAL
.
          MOVE      HORDDES,APEAISC  * System Prefix
          MOVE      SIPCPON,APEAORD
          MOVE      SIPASUP,APEACRD
          PACK      KEY8,APEAISC,APEAORD,SP70
          CALL      RDAPEA1         * Order Header Record
          IF        OVRCD=1
            MOVE      SIPADIN,APEADAT
            CALL      WRAPEA1
          ENDIF
.
          MOVE      HORDDES,APEBISC  * System Prefix
          MOVE      SIPCPON,APEBORD
          PACK      APEBCAT,SIPCITM,SP70
          PACK      KEY14,APEBISC,APEBORD,APEBCAT
          CALL      RDAPEB1
          IF        OVRCD=0
            ADD       SIPCOQT,APEBQTY
            MOVE      SIPCECT,APEBUCT
            MOVE      SIPCGSTA,APEBUGS
            ASSIGN    APEBQTY*APEBUCT,APEBAMT
            ASSIGN    APEBQTY*APEBUGS,APEBGST
            IF        APEBQTY>0
              CALL      UPAPEB1
            ELSE
              CALL      DEAPEB1
              UNPACK    SP70,APEBISC,APEBORD,APEBCAT
              PACK      KEY8,APEAISC,APEAORD,SP70
              PACK      KEY14,KEY8,SP70
              CALL      RSAPEB1
              CALL      RKAPEB1
              PACK      KEY14,APEBISC,APEBORD,APEBCAT,SP70
              MATCH     KEY8,KEY14
              CALL      DEAPEA1 IF NOT EQUAL
            ENDIF
.
            MOVE      SIPCOQT,APEBQTY
            MOVE      SIPCECT,APEBUCT
            MOVE      SIPCGSTA,APEBUGS
            ASSIGN    APEBQTY*APEBUCT,APEBAMT
            ASSIGN    APEBQTY*APEBUGS,APEBGST
            CALL      UFMFP000         * update committed expenditure
            GOTO      USCEA999
          ENDIF
.
. No Existing Record
.--------------------
          MOVE      SIPCWAR,KEY5
          CALL      RDSIWA1
          IF        OVRCD=1
            MOVE      SP70,KEY5
            CALL      RSSIWA1
            CALL      RKSIWA1
          ENDIF
.
          MOVE      SIWALED,APEBLED
          MOVE      SIWADISS,APEBDIS
          MOVE      SIWARESP,APEBRES
          MOVE      SP70,APEBSPA
          MOVE      SIPCOQT,APEBQTY
          MOVE      SIPCECT,APEBUCT
          MOVE      SIPCGSTA,APEBUGS
          ASSIGN    APEBQTY*APEBUCT,APEBAMT
          ASSIGN    APEBQTY*APEBUGS,APEBGST
          MOVE      SIPCPD,APEBDES
.
          BRANCH    SIWAPTY,USCEA100,USCEA100
          MOVE      SIWAPACC,APEBACC
          GOTO      USCEA200
.
USCEA100  STORE     SIWAPACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                      KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          LOAD      APEBACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          IF        FMSUUD2A=1
            PACK      APEBACC,APEBACC,FMSUUD2B
          ENDIF
          PACK      KEY5,SIPCPRD,SP70
          CALL      RDSISA1
          BRANCH    SIWAPTY,USCEA110,USCEA120
.
USCEA110  PACK      SILTSUB,SIPCPRD,SP70
          PACK      FMAMLEDG,APEBLED,SP70
          CALL      GTRA0000                     * check for translation table
          PACK      APEBACC,APEBACC,SILTSUB,SP70 * Add subj code
          GOTO      USCEA200
.
USCEA120  MOVE      SISACOMM,KEY6                                      *C-59696
          CALL      RDSIGA1
          PACK      SILTSUB,SISACOMM,SP70
          PACK      FMAMLEDG,APEBLED,SP70
          CALL      GTRA0000                     * check for translation table
          PACK      APEBACC,APEBACC,SILTSUB,SP70 * Add commodity code
.
USCEA200  CALL      XHKFMS00
.                                           * don't write if qty=0     *I-43474
          IF        APEBQTY > 0
            CALL      WRAPEB1
          ENDIF                                                        *I-43474
          CALL      UFMFP000           * update committed expenditure
.
USCEA999  RETURN
.----------------------------------------------------------------------
. get subjective/commodity translation
.----------------------------------------------------------------------
GTRA0000  PACK      KEY8,FMAMLEDG,SILTSUB,SP70                         *C-59696
          CALL      RDSILT1
.
GTRA9999  RETURN
.------------------------------------------------------------
. Check FMS Account
.------------------------------------------------------------
XHKFMS00  MOVE      ZERO,FMAMTYPE
          PACK      KEY14,APEBLED,APEBACC,SP70
          CALL      RDFMAM1
          IF        OVRCD=1
            SQUEEZE   KEY14
            CALL      RDFMAM1
            IF        OVRCD=0
              UNPACK    KEY14,APEBLED,APEBACC
            ENDIF
          ENDIF
.
          RETURN
.----------------------------------------------------------------------
. Update period summary file
.----------------------------------------------------------------------
UFMFP000  PACK      KEY2,APEBLED,SP70
          CALL      RDFMLA1
          BRANCH    OVRCD,UFMFP999
.
          PACK      KEY14,APEBLED,APEBACC,SP70
          CALL      RDFMAM1
          BRANCH    OVRCD,UFMFP999
.
          PACK      WORKDATE,APEADAT,SP70
          CALL      CFYR0000
          BRANCH    EXIT,UFMFP999
.
          MOVE      "fmsp",KEY4
          PACK      KEY8,KEY4,CURYEAR,SP70
          REP       " 0",CURYEAR
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMSFPSA1,KEY8
          TRAPCLR   IO
          BRANCH    OVRCD,UFMFP999
.
          PACK      KEY14,APEBLED,APEBACC,SP70
          UNPACK    KEY14,FMFPCULD,FMFPCUAC
          CALL      RDFMFP1
          IF        OVRCD=0
            ASSIGN    APEBAMT+FMFPCOM2,FMFPCOM2
            CALL      UPFMFP1
          ELSE
            MOVE      ZERO,FMFPCBF
            MOVE      ZERO,FMFPC01
            MOVE      ZERO,FMFPC02
            MOVE      ZERO,FMFPC03
            MOVE      ZERO,FMFPC04
            MOVE      ZERO,FMFPC05
            MOVE      ZERO,FMFPC06
            MOVE      ZERO,FMFPC07
            MOVE      ZERO,FMFPC08
            MOVE      ZERO,FMFPC09
            MOVE      ZERO,FMFPC10
            MOVE      ZERO,FMFPC11
            MOVE      ZERO,FMFPC12
            MOVE      ZERO,FMFPC13
.
            MOVE      ZERO,FMFPABF
            MOVE      ZERO,FMFPA01
            MOVE      ZERO,FMFPA02
            MOVE      ZERO,FMFPA03
            MOVE      ZERO,FMFPA04
            MOVE      ZERO,FMFPA05
            MOVE      ZERO,FMFPA06
            MOVE      ZERO,FMFPA07
            MOVE      ZERO,FMFPA08
            MOVE      ZERO,FMFPA09
            MOVE      ZERO,FMFPA10
            MOVE      ZERO,FMFPA11
            MOVE      ZERO,FMFPA12
            MOVE      ZERO,FMFPA13
            MOVE      ZERO,FMFPCOM
.
            MOVE      ZERO,FMFPCBFD
            MOVE      ZERO,FMFPC01D
            MOVE      ZERO,FMFPC02D
            MOVE      ZERO,FMFPC03D
            MOVE      ZERO,FMFPC04D
            MOVE      ZERO,FMFPC05D
            MOVE      ZERO,FMFPC06D
            MOVE      ZERO,FMFPC07D
            MOVE      ZERO,FMFPC08D
            MOVE      ZERO,FMFPC09D
            MOVE      ZERO,FMFPC10D
            MOVE      ZERO,FMFPC11D
            MOVE      ZERO,FMFPC12D
            MOVE      ZERO,FMFPC13D
.
            MOVE      ZERO,FMFPABFD
            MOVE      ZERO,FMFPA01D
            MOVE      ZERO,FMFPA02D
            MOVE      ZERO,FMFPA03D
            MOVE      ZERO,FMFPA04D
            MOVE      ZERO,FMFPA05D
            MOVE      ZERO,FMFPA06D
            MOVE      ZERO,FMFPA07D
            MOVE      ZERO,FMFPA08D
            MOVE      ZERO,FMFPA09D
            MOVE      ZERO,FMFPA10D
            MOVE      ZERO,FMFPA11D
            MOVE      ZERO,FMFPA12D
            MOVE      ZERO,FMFPA13D
            MOVE      ZERO,FMFPCOMD
.
            MOVE      ZERO,FMFPCBFT
            MOVE      ZERO,FMFPC01T
            MOVE      ZERO,FMFPC02T
            MOVE      ZERO,FMFPC03T
            MOVE      ZERO,FMFPC04T
            MOVE      ZERO,FMFPC05T
            MOVE      ZERO,FMFPC06T
            MOVE      ZERO,FMFPC07T
            MOVE      ZERO,FMFPC08T
            MOVE      ZERO,FMFPC09T
            MOVE      ZERO,FMFPC10T
            MOVE      ZERO,FMFPC11T
            MOVE      ZERO,FMFPC12T
            MOVE      ZERO,FMFPC13T
.
            MOVE      ZERO,FMFPABFT
            MOVE      ZERO,FMFPA01T
            MOVE      ZERO,FMFPA02T
            MOVE      ZERO,FMFPA03T
            MOVE      ZERO,FMFPA04T
            MOVE      ZERO,FMFPA05T
            MOVE      ZERO,FMFPA06T
            MOVE      ZERO,FMFPA07T
            MOVE      ZERO,FMFPA08T
            MOVE      ZERO,FMFPA09T
            MOVE      ZERO,FMFPA10T
            MOVE      ZERO,FMFPA11T
            MOVE      ZERO,FMFPA12T
            MOVE      ZERO,FMFPA13T
            MOVE      ZERO,FMFPCOMT
.
            PACK      FMFPSPAR,SP70,SP70
            MOVE      APEBAMT,FMFPCOM2
            CALL      WRFMFP1
          ENDIF
.
          COMPARE   ONE,FMCOCALC
          GOTO      UFMFP999 IF NOT EQUAL
.
          PACK      KEY20,PORT,CURYEAR,APEBLED,APEBACC,SP70
          CALL      RDFMTU1            * record exists ?
          COMPARE   ZERO,OVRCD
          GOTO      UFMFP999 IF EQUAL
.
          UNPACK    KEY20,FMTUPORT,FMTUSPEC,FMTUTLED,FMTUTACC
          MOVE      FMAMCLEV,FMTULEV
          MOVE      ZERO,FMTUACT
          MOVE      ZERO,FMTUBUD
          MOVE      SP70,FMTUSPAR
          CALL      WRFMTU1            * Flag For Total Account Update
.
UFMFP999  RETURN
.-----------------------------------------------------------------
. Write to Transfer File
.-----------------------------------------------------------------
WTRN0000  MOVE      ZERO,SOSFLAG
          MATCH     SIPASUP,INCNVHAS
          IF        (@EQUAL)&(INCNSOSI=1)
            CALL      CHKVHA00
          ENDIF
          MATCH     SIPASUP,INCNBLSS
          IF        (@EQUAL)&(INCNBLON=1)
            CALL      CHKBLS00
          ENDIF
.
          IF        SOSFLAG=1
            MOVE      SIPAPON,SITRPURC      * Purchase order
            PACK      KEY7,SITRPURC
            MOVE      ZERO,SITRSTAT         * Status
            PACK      SITREDAT,SIPEDATE     * Date order entered
            PACK      SITRCREA,SP70         * Reason for cancellation
            PACK      SITRTDAT,SP70         * Date order transmitted/cancelled
            PACK      SITRUSER,SP70         * User id for trans/cancellation
            MOVE      SIPAORI,SITRORG       * Transmission/canc. originator
            MATCH     SIPASUP,INCNVHAS
            IF        @EQUAL
              MOVE      INCNBLSN,SITRTNUM   * BLS Transmission Number
            ELSE
              MOVE      INCNVHAN,SITRTNUM   * VHA Transmission number
            ENDIF
.
            CALL      RASITR1               * check if record exists (shouldnt)
            IF        OVRCD=0
              CALL      UPSITR1             * Update record
            ELSE
              CALL      WRSITR1             * Write record
            ENDIF
          ENDIF
.
WTRN9999  RETURN
.---------------------------------------------------------
. Display New Screen for PO Details
.---------------------------------------------------------
DNPO0000  MOVE      "0",HLEF
          CALL      GETSCR00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
          CALL      DF04L000
.
          MOVE      "00",SCRID
          MOVE      "    1",FLDID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
.
DNPO9999  RETURN
.---------------------------------------------------------
. Check VHA Transfer
.---------------------------------------------------------
CHKVHA00  IF        INCNTRAL=0
            CALL      DNPO0000
            PACK      DISPMSG,SP70,SP70
            CALL      MESSAGE2
            DISPLAY   *P1:24,"Is this a SOS transmit order (":
                      *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") ? ";
            MOVE      "24",CVERT
            MOVE      "38",CCOL
            CALL      YORN0000
            CALL      MESSAGE3
            MOVE      FYESNO,SOSFLAG
            CALL      PUTSCR00
          ELSE
            MOVE      ONE,SOSFLAG
          ENDIF
          RETURN
.---------------------------------------------------------
. Check BLS Transfer
.---------------------------------------------------------
CHKBLS00  IF        INCNBLAL=0
            CALL      DNPO0000
            PACK      DISPMSG,SP70,SP70
            CALL      MESSAGE2
            DISPLAY   *P1:24,"Is this a BLS transmit order (":
                      *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") ? ";
            MOVE      "24",CVERT
            MOVE      "38",CCOL
            CALL      YORN0000
            CALL      MESSAGE3
            MOVE      FYESNO,SOSFLAG
            CALL      PUTSCR00
          ELSE
            MOVE      ONE,SOSFLAG
          ENDIF
          RETURN
.
CALTAX00  COMPARE   ZERO,SIPCECT
          GOTO      CALTAX90 IF EQUAL
.
          MATCH     SP6,SIPCGST
          GOTO      CALTAX90 IF EQUAL
.
          PACK      KEY8,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY8
.
          PACK      KEY14,SIPCGST,KEY8,SP70
          CALL      RDIBGE1
          COMPARE   ZERO,OVRCD
          GOTO      CALTAX10 IF EQUAL
.
          CALL      RPIBGE1
          BRANCH    OVRCD,CALTAX90
.
          MATCH     SIPCGST,IBGECODE
          GOTO      CALTAX90 IF NOT EQUAL
.
CALTAX10  ASSIGN    (SIPCECT-(SIPCECT/(ONE+(IBGEAMNT/HUNDRED)))),SIPCGSTA
          GOTO      CALTAX99
.
CALTAX90  MOVE      ZERO,SIPCGSTA
.
CALTAX99  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCEAIO/INC
          INC       APSCEBIO/INC
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSSNTIO/INC
          INC       APSSUBIO/INC
          INC       FMSAMAIO/INC
          INC       FMSCONIO/INC
          INC       FMSCSAIO/INC
          INC       FMSFPSIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMCIO/INC
          INC       FMSLMCKY    
          INC       FMSTUPIO/INC
          INC       IBAGEDIO/INC
          INC       IBAGSTIO/INC
          INC       SINBACIO/INC
          INC       SINCGAIO/INC
          INC       SINCGBIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIBIO/INC
          INC       SINCICIO/INC
          INC       SINCICKY    
          INC       SINCIDIO/INC
          INC       SINCIEIO/INC
          INC       SINCIFIO/INC
          INC       SINCIGIO/INC
          INC       SINCIHIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINFACIO/INC
          INC       SINFACKY    
          INC       SINLTTIO/INC
          INC       SINNATIO/INC
          INC       SINNATKY    
          INC       SINORDUS    
          INC       SINORIIO/INC
          INC       SINORIKY    
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOBIO/INC
          INC       SINPOCIO/INC
          INC       SINPONCD    
          INC       SINRCPIO/INC
          INC       SINSCDIO/INC
          INC       SINSCMIO/INC
          INC       SINSODIO/INC
          INC       SINSOMIO/INC
          INC       SINSOMKY    
          INC       SINSUAIO/INC
          INC       SINSUBIO/INC
          INC       SINTRNIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
.
          INC       STDGENCD
.
