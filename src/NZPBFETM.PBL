. *----------------------------------------------------------------------
. * Include Name  :   NZPBFETM.PBL
. *
. * Function      :   Common CGI functions for NZ Private Bed Fee File
. *
. * Modifications :
. *
.------------------------------------------------------------------------
. V11.04.01 26/06/2024  Thanh T       TSK 0947684
.           Changed NZBFET00 to display the number of rows depending on
.           system parameter
.  V9.08.00 26/10/2006 Ebon Clements  CAR 119985
.           Created Include
.------------------------------------------------------------------------
.   Clear CGI Parameters for NZPBFEFD
.------------------------------------------------------------------------
CPNZBF00  MOVE      SP70,NZBFE001
          MOVE      SP70,NZBFE002
          MOVE      SP70,NZBFE003
          MOVE      SP70,NZBFE004
          MOVE      SP70,NZBFE005
          MOVE      SP70,NZBFE006
          MOVE      SP70,NZBFE007
          MOVE      SP70,NZBFE008
          MOVE      SP70,NZBFE009
          MOVE      SP70,NZBFE010
          MOVE      SP70,NZBFE011
          MOVE      ZERO,NZBFE012
          MOVE      ZERO,NZBFE013
          MOVE      ZERO,NZBFE014
.
          MOVE      SP70,CPNZB001
          MOVE      SP70,CPNZB002
          MOVE      SP70,CPNZB003
          MOVE      SP70,CPNZB004
          MOVE      SP70,CPNZB005
          MOVE      SP70,CPNZB006
.
CPNZBF99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for NZPBFEFD
.------------------------------------------------------------
SPNZBF00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPNZBF01,SPNZBF02,SPNZBF03,SPNZBF04,SPNZBF05:
                       SPNZBF06,SPNZBF07,SPNZBF08,SPNZBF09,SPNZBF10:
                       SPNZBF11,SPNZBF12,SPNZBF13,SPNZBF14
.
          MOVE      ONE,EXIT
          GOTO      SPNZBF99
.
SPNZBF01  PACK      NZBFE001,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF02  PACK      NZBFE002,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF03  PACK      NZBFE003,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF04  PACK      NZBFE004,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF05  PACK      NZBFE005,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF06  PACK      NZBFE006,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF07  PACK      NZBFE007,QRYDATA,SP70
          GOTO      SPNZBF99
.
SPNZBF08  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      NZBFE008,CCENT,CYEAR,CMON,CDAY
          GOTO      SPNZBF99
.
SPNZBF09  MOVE      QRYDATA,NZBFE009
          SQUEEZE   NZBFE009
          GOTO      SPNZBF99
.
SPNZBF10  MOVE      QRYDATA,NZBFE010
          SQUEEZE   NZBFE010
          GOTO      SPNZBF99
.
SPNZBF11  MOVE      QRYDATA,NZBFE011
          GOTO      SPNZBF99
.
SPNZBF12  MOVE      QRYDATA,NZBFE012
          GOTO      SPNZBF99
.
SPNZBF13  MOVE      QRYDATA,NZBFE013
          GOTO      SPNZBF99
.
SPNZBF14  MOVE      QRYDATA,NZBFE014
          GOTO      SPNZBF99
.
SPNZBF99  RETURN
.
.------------------------------------------------------------
. Output NZPBFEFD Fields
.------------------------------------------------------------
NZBF0000  BRANCH    FLDITMNO,NZBF0100,NZBF0200,NZBF0300,NZBF0400,NZBF0500:
                             NZBF0600,NZBF0700,NZBF0800,NZBF0900,NZBF1000:
                             NZBF1100,NZBF1200,NZBF1300,NZBF1400,NZBF1500:
                             NZBF1600,NZBF1700,NZBF1800,NZBF1900,NZBF2000:
                             NZBF2100,NZBF2200,NZBF2300,NZBF2400,NZBF2500:
                             NZBF2600,NZBF2700
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      NZBF9999
.
NZBF0100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          COMPARE   ONE,IBCNMHOS
          GOTO      NZBF9999 IF NOT EQUAL
.
          BRANCH    F1,NZBF0110,NZBF0120
.         
          PACK      KEY3,NZBFHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,NZBF9999
.         
          WRITE     HTMLFILE;PTHSNAME;           * hospital name
          GOTO      NZBF9999
.
NZBF0110  WRITE     HTMLFILE;NZBFHOSP;           * hospital code
          GOTO      NZBF9999
.
NZBF0120  MOVE      NZBFHOSP,DIM3
          CALL      NZBH0000                     * hospital selection list
          GOTO      NZBF9999
.
NZBF0200  MOVE      "CL",CATEGORY                * claim code
          MOVE      NZBFCLMC,CODE
          CALL      CODITM00
          GOTO      NZBF9999
.
NZBF0300  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,NZBF0310
          WRITE     HTMLFILE;NZBFCNTR;           * health fund
          GOTO      NZBF9999
.
NZBF0310  MATCH     SP70,NZBFCNTR
          GOTO      NZBF9999 IF EQUAL
.
          PACK      KEY14,NZBFCNTR,SP70
          CALL      RDSFUND1
          CALL      RDKFUND1
          BRANCH    OVRCD,NZBF9999
.
          WRITE     HTMLFILE;HFNAME;
          GOTO      NZBF9999
.
NZBF0400  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,NZBF0410
          WRITE     HTMLFILE;NZBFFTAB;           * health fund table
          GOTO      NZBF9999
.
NZBF0410  PACK      KEY14,NZBFCNTR,NZBFFTAB,SP70
          CALL      RDFUND1
          BRANCH    OVRCD,NZBF9999
.
          WRITE     HTMLFILE;HFNAME;
          GOTO      NZBF9999
.
NZBF0500  MOVE      "A ",CATEGORY                * admission type
          MOVE      NZBFATYP,CODE
          CALL      CODITM00
          GOTO      NZBF9999
.
NZBF0600  MOVE      "BT",CATEGORY                * bed type   
          MOVE      NZBFBTYP,CODE
          CALL      CODITM00
          GOTO      NZBF9999
.
NZBF0700  WRITE     HTMLFILE;NZBFEDAY;           * highest day in period
          GOTO      NZBF9999
.
NZBF0800  MATCH     NZBFEFDT,SP70                * effective date
          GOTO      NZBF9999 IF EQUAL
.
          UNPACK    NZBFEFDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      NZBF9999
.
NZBF0900  WRITE     HTMLFILE;NZBFRATE;           * patient portion
          GOTO      NZBF9999
.
NZBF1000  WRITE     HTMLFILE;NZBFREBA;           * rebate portion
          GOTO      NZBF9999
.
NZBF1100  WRITE     HTMLFILE;NZBFDESC;           * description
          GOTO      NZBF9999
.
NZBF1200  MATCH     NZBFCDAT,SP70
          GOTO      NZBF9999 IF EQUAL
.
          UNPACK    NZBFCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      NZBF9999
.
NZBF1300  WRITE     HTMLFILE;NZBFCTIM;
          GOTO      NZBF9999
.
NZBF1400  MATCH     SP70,NZBFCUID
          GOTO      NZBF9999 IF EQUAL
.
          PACK      KEY10,NZBFCUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      NZBFCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      NZBF9999
.
NZBF1500  MATCH     NZBFUDAT,SP70
          GOTO      NZBF9999 IF EQUAL
.
          UNPACK    NZBFUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      NZBF9999
.
NZBF1600  WRITE     HTMLFILE;NZBFUTIM;
          GOTO      NZBF9999
.
NZBF1700  MATCH     SP70,NZBFUUID
          GOTO      NZBF9999 IF EQUAL
.         
          PACK      KEY10,NZBFUUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      NZBFUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      NZBF9999
.
NZBF1800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          COMPARE   ONE,IBCNMHOS
          GOTO      NZBF9999 IF NOT EQUAL
.
          BRANCH    F1,NZBF1810,NZBF1820
.
          PACK      KEY3,NZBFE001,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,NZBF9999
.
          WRITE     HTMLFILE;PTHSNAME;           * hospital name
          GOTO      NZBF9999
.
NZBF1810  WRITE     HTMLFILE;NZBFE001;           * hospital code
          GOTO      NZBF9999
.
NZBF1820  MOVE      NZBFE001,DIM3
          CALL      NZBH0000                     * hospital selection list
          GOTO      NZBF9999
.
NZBF1900  MOVE      "CL",CATEGORY                * claim code
          MOVE      NZBFE002,CODE
          CALL      CODITM00
          GOTO      NZBF9999
.
NZBF2000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,NZBF2010
          WRITE     HTMLFILE;NZBFE003;           * health fund
          GOTO      NZBF9999
.
NZBF2010  MATCH     SP70,NZBFE003
          GOTO      NZBF9999 IF EQUAL
.
          PACK      KEY14,NZBFE003,SP70
          CALL      RDSFUND1
          CALL      RDKFUND1
          BRANCH    OVRCD,NZBF9999
.
          WRITE     HTMLFILE;HFNAME;
          GOTO      NZBF9999
.
NZBF2100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,NZBF2110
          WRITE     HTMLFILE;NZBFE004;           * health fund table
          GOTO      NZBF9999
.
NZBF2110  PACK      KEY14,NZBFE003,NZBFE004,SP70
          CALL      RDFUND1
          BRANCH    OVRCD,NZBF9999
.
          WRITE     HTMLFILE;HFNAME;
          GOTO      NZBF9999
.
NZBF2200  MOVE      "A ",CATEGORY                * admission type
          MOVE      NZBFE005,CODE
          CALL      CODITM00
          GOTO      NZBF9999
.
NZBF2300  CALL      NXTNZB00                     * next NZ bed fee
          GOTO      NZBF9999
.
NZBF2400  CALL      PRVNZB00                     * prev NZ bed fee
          GOTO      NZBF9999
.
NZBF2500  WRITE     HTMLFILE;FILEFLAG;
          GOTO      NZBF9999
.
NZBF2600  CALL      NZBFET00                     * list NZ priv bed fee
          GOTO      NZBF9999
.
NZBF2700  MOVE      "BT",CATEGORY                * bed type
          MOVE      NZBFE006,CODE
          CALL      CODITM00
          GOTO      NZBF9999
.         
NZBF9999  RETURN
.
.------------------------------------------------------------
.  Update NZPBFEFD file
.------------------------------------------------------------
MVNZBF00  MOVE      NZBFE001,NZBFHOSP
          MOVE      NZBFE002,NZBFCLMC
          MOVE      NZBFE003,NZBFCNTR
          MOVE      NZBFE004,NZBFFTAB
          MOVE      NZBFE005,NZBFATYP
          MOVE      NZBFE006,NZBFBTYP
          MOVE      NZBFE007,NZBFEDAY
          MOVE      NZBFE008,NZBFEFDT
          MOVE      NZBFE009,NZBFRATE
          MOVE      NZBFE010,NZBFREBA
          MOVE      NZBFE011,NZBFDESC
          MOVE      SP70,NZBFSPAR
.
MVNZBF99  RETURN
.
.------------------------------------------------------------
. Hospital Selection
.------------------------------------------------------------
NZBH0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
NZBH0100  CALL      RKPTHSP1
          BRANCH    OVRCD,NZBH9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
          MATCH     DIM3,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      NZBH0100
.
NZBH9999  RETURN
.
.-------------------------------------------------------------------------
. Link to Next NZ Priv Bed Fee
.-------------------------------------------------------------------------
NXTNZB00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F2
.
          WRITE     HTMLFILE;"patweb77.pbl":
                                 "?reportno=",F2:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&nzbfe001=",NZBFE001:
                                 "&nzbfe002=",NZBFE002:
                                 "&nzbfe003=",NZBFE003:
                                 "&nzbfe004=",NZBFE004:
                                 "&nzbfe005=",NZBFE005:
                                 "&nzbfe006=",NZBFE006:
                                 "&nzbfe007=",NZBFE007:
                                 "&nzbfe008=",NZBFE008:
                                 "&fileflag=",FILEFLAG;
.
NXTNZB99  RETURN
.
.-------------------------------------------------------------
. Link to Prev NZ Priv Bed Fee
.-------------------------------------------------------------
PRVNZB00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F2
.
          WRITE     HTMLFILE;"patweb77.pbl":
                                 "?reportno=",F2:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&nzbfe001=",NZBFE001:
                                 "&nzbfe002=",NZBFE002:
                                 "&nzbfe003=",NZBFE003:
                                 "&nzbfe004=",NZBFE004:
                                 "&nzbfe005=",NZBFE005:
                                 "&nzbfe006=",NZBFE006:
                                 "&nzbfe007=",NZBFE007:
                                 "&nzbfe008=",NZBFE008:
                                 "&fileflag=",FILEFLAG;
.
PRVNZB99  RETURN
.
.------------------------------------------------------------
. Table of NZ Private Bed Fee File Details
.------------------------------------------------------------
NZBFET00  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      NZBFEH00              * Table Heading
.
NZBFET02  IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD   * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          MATCH     "N",FILEFLAG
          GOTO      NZBFET10 IF EQUAL
.
          PACK      KEY37,NZBFE001,NZBFE002,NZBFE003,NZBFE004:       * Current
                          NZBFE005,SP70   * File
          CALL      RSNZBFE1 
NZBFET05  CALL      RKNZBFE1                                         * Current
          BRANCH    OVRCD,NZBFET90                                   * File
          GOTO      NZBFET20
.
NZBFET10  PACK      KEY37,NZBFE001,NZBFE002,NZBFE003,NZBFE004:       * New File
                          NZBFE005,SP70
          CALL      RSNZBF11
NZBFET15  CALL      RKNZBF11                                         * New File
          BRANCH    OVRCD,NZBFET90
.
NZBFET20  MATCH     SP70,NZBFE001
          IF        !@EQUAL
            MATCH     NZBFE001,NZBFHOSP            * hospital
            GOTO      NZBFET90 IF NOT EQUAL
          ENDIF
.
          MATCH     SP70,NZBFE002
          IF        !@EQUAL
            MATCH     NZBFE002,NZBFCLMC            * claim code
            GOTO      NZBFET90 IF NOT EQUAL
          ENDIF
.
          MATCH     SP70,NZBFE003
          IF        !@EQUAL
            MATCH     NZBFE003,NZBFCNTR            * health fund
            GOTO      NZBFET90 IF NOT EQUAL
          ENDIF
.
          MATCH     SP70,NZBFE004
          IF        !@EQUAL
            MATCH     NZBFE004,NZBFFTAB            * table
            GOTO      NZBFET90 IF NOT EQUAL
          ENDIF
.
          MATCH     SP70,NZBFE005
          IF        !@EQUAL
            MATCH     NZBFE005,NZBFATYP          * admission type
            GOTO      NZBFET90 IF NOT EQUAL
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            MATCH     "N",FILEFLAG
            GOTO      NZBFET15 IF EQUAL
            GOTO      NZBFET05
          ENDIF
.
          CALL      NZBFER00
.
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          IF        !@EQUAL
            MATCH     "N",FILEFLAG
            GOTO      NZBFET15 IF EQUAL
            GOTO      NZBFET05
          ENDIF
.
          GOTO      NZBFET99
.
NZBFET90  CALL      NOMORE00     * Display No More Records Message
.
NZBFET99  RETURN
.------------------------------------------------------------
. NZ Private Bed Fee File Table Table Row
.------------------------------------------------------------
NZBFER00  MOVE      SP70,PTHSNAME
          MATCH     SP70,NZBFHOSP
          IF        !@EQUAL
            PACK      KEY3,NZBFHOSP,SP70
            CALL      RDPTHSP1
            IF        OVRCD=1
              MOVE      NZBFHOSP,PTHSNAME        * hospital
            ENDIF
          ENDIF
.
          MOVE      SP70,DISPEDAT
          MATCH     SP70,NZBFEFDT
          IF        !@EQUAL
            UNPACK    NZBFEFDT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPEDAT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          MOVE      ZERO,TOTAL
          ADD       NZBFRATE,TOTAL
          ADD       NZBFREBA,TOTAL
.
          MOVE      SP70,KEY11
          MATCH     SP70,NZBFEFDT
          IF        !@EQUAL
            UNPACK    NZBFEFDT,CCENT,CYEAR,CMON,CDAY * effective date
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      KEY11,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR,SP70
          ENDIF
          REP       " +",KEY11
.
          REP       " +",NZBFHOSP
          REP       " +",NZBFCLMC
          REP       " +",NZBFCNTR
          REP       " +",NZBFFTAB
          REP       " +",NZBFATYP
          REP       " +",NZBFBTYP
          REP       " +",NZBFEDAY
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowLink":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&nzbfe001=",NZBFHOSP:
                             "&nzbfe002=",NZBFCLMC:
                             "&nzbfe003=",NZBFCNTR:
                             "&nzbfe004=",NZBFFTAB:
                             "&nzbfe005=",NZBFATYP:
                             "&nzbfe006=",NZBFBTYP:
                             "&nzbfe007=",NZBFEDAY:
                             "&nzbfe008=",KEY11:
                             "&fileflag=",FILEFLAG,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>";
.
          REP       "+ ",NZBFHOSP
          REP       "+ ",NZBFCLMC
          REP       "+ ",NZBFCNTR
          REP       "+ ",NZBFFTAB
          REP       "+ ",NZBFATYP
          REP       "+ ",NZBFBTYP
          REP       "+ ",NZBFEDAY
          MOVE      SP70,KEY11
.
          IF        IBCNMHOS=1
            WRITE     HTMLFILE;PTHSNAME,"&nbsp;</td>":
                              "<td>&nbsp;",NZBFCLMC,"</td>";
          ELSE 
            WRITE     HTMLFILE;NZBFCLMC,"&nbsp;</td>";
          ENDIF
.
          WRITE     HTMLFILE;"<td>&nbsp;",NZBFCNTR,"</td>":
                             "<td>&nbsp;",NZBFFTAB,"</td>":
                             "<td>&nbsp;",NZBFATYP,"</td>":
                             "<td>&nbsp;",NZBFBTYP,"</td>":
                             "<td>&nbsp;",DISPEDAT,"</td>":
                             "<td>&nbsp;",NZBFEDAY,"</td>":
                             "<td>&nbsp;",NZBFDESC,"</td>":
                             "<td>&nbsp;",NZBFRATE,"</td>":
                             "<td>&nbsp;",NZBFREBA,"</td>":
                             "<td>&nbsp;",TOTAL,"</td>":
                             "</tr>"
.
NZBFER99 RETURN
.
.------------------------------------------------------------
. NZ Private Bed Fee Table Heading
.------------------------------------------------------------
NZBFEH00  WRITE     HTMLFILE;"<tr>";
.
          IF        IBCNMHOS=1
            WRITE     HTMLFILE;"<td class=HeadingCell>Hospital</td>";
          ENDIF
.
          PACK      KEY5,ANSC,ANSL,SP70          * Claim Code
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      SP70,TDESC
          ENDIF
.
          WRITE     HTMLFILE;"<td class=HeadingCell>",TDESC,"</td>":
                             "<td class=HeadingCell>Contract</td>":
                             "<td class=HeadingCell>Table</td>";
.
          PACK      KEY5,ANSA,SP70               * Admission Type
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      SP70,TDESC
          ENDIF
.
          WRITE     HTMLFILE;"<td class=HeadingCell>",TDESC,"</td>";
.
          PACK      KEY5,ANSB,ANST,SP70          * Bed Type
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      SP70,TDESC
          ENDIF
.
          WRITE     HTMLFILE;"<td class=HeadingCell>",TDESC,"</td>":
                             "<td class=HeadingCell>Effective Date</td>":
                             "<td class=HeadingCell>Highest Day in Period</td>":
                             "<td class=HeadingCell>Description</td>":
                             "<td class=HeadingCell>Patient</td>":
                             "<td class=HeadingCell>Rebate</td>":
                             "<td class=HeadingCell>Total</td>":
                             "</tr>"
.
NZBFEH99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Copy NZPBFEFD
.------------------------------------------------------------
CCNZBF00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,CCNZBF01,CCNZBF02,CCNZBF03,CCNZBF04,CCNZBF05:
                       CCNZBF06
.                      
          MOVE      ONE,EXIT
          GOTO      CCNZBF99
.
CCNZBF01  PACK      CPNZB001,QRYDATA,SP70
          GOTO      CCNZBF99
.
CCNZBF02  PACK      CPNZB002,QRYDATA,SP70
          GOTO      CCNZBF99
.
CCNZBF03  PACK      CPNZB003,QRYDATA,SP70
          GOTO      CCNZBF99
.
CCNZBF04  PACK      CPNZB004,QRYDATA,SP70
          GOTO      CCNZBF99
.
CCNZBF05  PACK      CPNZB005,QRYDATA,SP70
          GOTO      CCNZBF99
.
CCNZBF06  PACK      CPNZB006,QRYDATA,SP70
          GOTO      CCNZBF99
.
CCNZBF99  RETURN
.
