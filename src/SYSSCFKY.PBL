.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSSCFKY
.   Routine   :   HSYSCA00 System Code Help    
.   Return    :   SYKV    
.-------------------------------------------------------------------------------
HSYSCA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYSCA04 IF NOT EQUAL
          MOVE      "16",HTOP
          MOVE      "24",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYSCA04
          CALL      GSCRN000
          BRANCH    EXIT,HSYSCA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"System"             
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 7",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HSYSCA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SYSCSYS 
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          CALL      RSSYSC1 
HSYSCA10
          CALL      RKSYSC1 
          BRANCH    OVRCD,HSYSCA15
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSYSCA12
          CALL      HSYSCA60
          BRANCH    OVRCD,HSYSCA10
HSYSCA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY2,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYSCSYS 
          DISPLAY   *PSTDCOL02:STDROW,SYSCDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYSCA10 IF NOT EQUAL
HSYSCA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYSCA20
          CALL      HSCRI000
          BRANCH    EXIT,HSYSCA30,HSYSCA35,HSYSCA40,HSYSCA45,HSYSCA04:
                              HSYSCA91,HSYSCA50
          GOTO      HSYSCA92
HSYSCA30
          CALL      RKSYSC1 
          BRANCH    OVRCD,HSYSCA85
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          CALL      RPSYSC1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCA10
HSYSCA35
          MOVE      ST1,KEY2 
          CALL      RDSYSC1 
          CALL      RPSYSC1 
          BRANCH    OVRCD,HSYSCA85
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYSCA36
          CALL      RPSYSC1 
          BRANCH    OVRCD,HSYSCA37
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYSCA36 IF NOT EQUAL
HSYSCA37
          MOVE      ZERO,XITEMNO
          GOTO      HSYSCA10
HSYSCA40
          MOVE      ST1,KEY2 
          CALL      RDSYSC1 
          CALL      RPSYSC1 
          BRANCH    OVRCD,HSYSCA85
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCA08
HSYSCA45
          CALL      RKSYSC1 
          BRANCH    OVRCD,HSYSCA85
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY2,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYSC1 
HSYSCA46
          CALL      RPSYSC1 
          BRANCH    OVRCD,HSYSCA47
          PACK      KEY2,SYSCSYS,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYSCA46 IF NOT EQUAL
HSYSCA47
          MOVE      ZERO,XITEMNO
          GOTO      HSYSCA10
HSYSCA50  COMPARE   ZERO,CSEARCH
          GOTO      HSYSCA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCA08
HSYSCA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCA08
HSYSCA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYSCA61 IF EQUAL
          MATCH     SCHFLD01,SYSCSYS 
          GOTO      HSYSCA72 IF NOT EQUAL
HSYSCA61
          MATCH     SP70,SCHFLD02
          GOTO      HSYSCA62 IF EQUAL
          MATCH     SCHFLD02,SYSCDES 
          GOTO      HSYSCA72 IF NOT EQUAL
HSYSCA62
HSYSCA63
HSYSCA64
HSYSCA65
HSYSCA66
HSYSCA67
HSYSCA68
HSYSCA69
HSYSCA70
          GOTO      HSYSCA75
HSYSCA72  MOVE      ONE,OVRCD
HSYSCA75  RETURN
HSYSCA85
          LOAD      KEY2,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY2,SYSCSYS                                                
          CALL      RDSYSC1 
HSYSCA90
.                                                                               
          BEEP
          GOTO      HSYSCA20
HSYSCA91
          MOVE      SP70,SYSCID3 
          MOVE      SP70,SYSCDES 
          MOVE      SP70,SYSCSPA 
          MOVE      SP70,KEY2 
          MOVE      SP70,SYSCSYS 
          GOTO      HSYSCA96
HSYSCA92
          MOVE      SP70,KEY2 
          MOVE      SP70,SYSCSYS 
          LOAD      KEY2,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY2,SYSCSYS                                                
HSYSCA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYSCA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSSCFKY
.   Routine   :   HSYSCB00 System Id           
.   Return    :   SYSCSYS 
.-------------------------------------------------------------------------------
HSYSCB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYSCB04 IF NOT EQUAL
          MOVE      "10",HTOP
          MOVE      "24",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYSCB04
          CALL      GSCRN000
          BRANCH    EXIT,HSYSCB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"System"             
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 7",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "30",STDCOL03
HSYSCB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SYSCID3 
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          CALL      RSSYSC2 
HSYSCB10
          CALL      RKSYSC2 
          BRANCH    OVRCD,HSYSCB15
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSYSCB12
          CALL      HSYSCB60
          BRANCH    OVRCD,HSYSCB10
HSYSCB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYSCID3 
          DISPLAY   *PSTDCOL02:STDROW,SYSCDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYSCB10 IF NOT EQUAL
HSYSCB15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYSCB20
          CALL      HSCRI000
          BRANCH    EXIT,HSYSCB30,HSYSCB35,HSYSCB40,HSYSCB45,HSYSCB04:
                              HSYSCB91,HSYSCB50
          GOTO      HSYSCB92
HSYSCB30
          CALL      RKSYSC2 
          BRANCH    OVRCD,HSYSCB85
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          CALL      RPSYSC2 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCB10
HSYSCB35
          MOVE      ST1,KEY3 
          CALL      RDSYSC2 
          CALL      RPSYSC2 
          BRANCH    OVRCD,HSYSCB85
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYSCB36
          CALL      RPSYSC2 
          BRANCH    OVRCD,HSYSCB37
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYSCB36 IF NOT EQUAL
HSYSCB37
          MOVE      ZERO,XITEMNO
          GOTO      HSYSCB10
HSYSCB40
          MOVE      ST1,KEY3 
          CALL      RDSYSC2 
          CALL      RPSYSC2 
          BRANCH    OVRCD,HSYSCB85
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCB08
HSYSCB45
          CALL      RKSYSC2 
          BRANCH    OVRCD,HSYSCB85
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYSC2 
HSYSCB46
          CALL      RPSYSC2 
          BRANCH    OVRCD,HSYSCB47
          PACK      KEY3,SYSCID3,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYSCB46 IF NOT EQUAL
HSYSCB47
          MOVE      ZERO,XITEMNO
          GOTO      HSYSCB10
HSYSCB50  COMPARE   ZERO,CSEARCH
          GOTO      HSYSCB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCB08
HSYSCB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYSCB08
HSYSCB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYSCB61 IF EQUAL
          MATCH     SCHFLD01,SYSCID3 
          GOTO      HSYSCB72 IF NOT EQUAL
HSYSCB61
          MATCH     SP70,SCHFLD02
          GOTO      HSYSCB62 IF EQUAL
          MATCH     SCHFLD02,SYSCDES 
          GOTO      HSYSCB72 IF NOT EQUAL
HSYSCB62
HSYSCB63
HSYSCB64
HSYSCB65
HSYSCB66
HSYSCB67
HSYSCB68
HSYSCB69
HSYSCB70
          GOTO      HSYSCB75
HSYSCB72  MOVE      ONE,OVRCD
HSYSCB75  RETURN
HSYSCB85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,SYSCID3                                                
          CALL      RDSYSC2 
HSYSCB90
.                                                                               
          BEEP
          GOTO      HSYSCB20
HSYSCB91
          MOVE      SP70,SYSCSYS 
          MOVE      SP70,SYSCDES 
          MOVE      SP70,SYSCSPA 
          MOVE      SP70,KEY3 
          MOVE      SP70,SYSCID3 
          GOTO      HSYSCB96
HSYSCB92
          MOVE      SP70,KEY3 
          MOVE      SP70,SYSCID3 
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,SYSCID3                                                
HSYSCB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYSCB99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSSCFKY
.   Routine   :   KSYSCA00 Keyin System Code Keyin   
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYSCA00 TOPIC     "SYSCSYS "
          MOVE      UNDLN70,SYSCSYS 
          KEYIN     *PCCOL:CVERT,*DV,SYSCSYS:                                   
                    *PCCOL:CVERT,*V2LON,SYSCSYS:                                
                    *PCCOL:CVERT,*DV,SYSCSYS 
.
          ENDSET    SYSCSYS 
          APPEND    SP70,SYSCSYS 
          RESET     SYSCSYS 
.
          MATCH     SP70,SYSCSYS 
          GOTO      KSYSCA90 IF EQUAL
.
          CMATCH    EXITCHAR,SYSCSYS 
          GOTO      KSYSCA95 IF EQUAL
.
          CMATCH    QUEST,SYSCSYS 
          GOTO      KSYSCA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYSCA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SYSCSYS 
          APPEND    SP70,SYSCSYS 
          RESET     SYSCSYS 
.
          MATCH     SP70,SYSCSYS 
          GOTO      KSYSCA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SYSCSYS                                 
KSYSCA10
          PACK      KEY2,SYSCSYS                                                
          CALL      RASYSC1 
          BRANCH    OVRCD,KSYSCA80
          BRANCH    CKEYTYP,KSYSCA75
          CALL      RDSYSC1 
KSYSCA70
          MOVE      ZERO,EXIT
          GOTO      KSYSCA99
KSYSCA75
          MOVE      "System Code Keyin Already Exist - ",DISPMSG                                     
          CALL      MESSAGE1
          GOTO      KSYSCA00
KSYSCA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYSCA99,KSYSCA99
          MOVE      "System Code Keyin Does Not Exist - ",DISPMSG                                    
          CALL      MESSAGE1
          GOTO      KSYSCA00
KSYSCA90
          MOVE      ONE,EXIT
          GOTO      KSYSCA99
KSYSCA95
          MOVE      TWO,EXIT
KSYSCA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSSCFKY
.   Routine   :   KSYSCB00 Keyin System Id Keyin     
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYSCB00 TOPIC     "SYSCID3 "
          MOVE      UNDLN70,SYSCID3 
          KEYIN     *PCCOL:CVERT,*DV,SYSCID3:                                   
                    *PCCOL:CVERT,*V2LON,SYSCID3:                                
                    *PCCOL:CVERT,*DV,SYSCID3 
.
          ENDSET    SYSCID3 
          APPEND    SP70,SYSCID3 
          RESET     SYSCID3 
.
          MATCH     SP70,SYSCID3 
          GOTO      KSYSCB90 IF EQUAL
.
          CMATCH    EXITCHAR,SYSCID3 
          GOTO      KSYSCB95 IF EQUAL
.
          CMATCH    QUEST,SYSCID3 
          GOTO      KSYSCB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYSCB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SYSCID3 
          APPEND    SP70,SYSCID3 
          RESET     SYSCID3 
.
          MATCH     SP70,SYSCID3 
          GOTO      KSYSCB00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SYSCID3                                 
KSYSCB10
          PACK      KEY3,SYSCID3                                                
          CALL      RASYSC2 
          BRANCH    OVRCD,KSYSCB80
          BRANCH    CKEYTYP,KSYSCB75
          CALL      RDSYSC2 
KSYSCB70
          MOVE      ZERO,EXIT
          GOTO      KSYSCB99
KSYSCB75
          MOVE      "System Id Keyin Already Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KSYSCB00
KSYSCB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYSCB99,KSYSCB99
          MOVE      "System Id Keyin Does Not Exist - ",DISPMSG                                      
          CALL      MESSAGE1
          GOTO      KSYSCB00
KSYSCB90
          MOVE      ONE,EXIT
          GOTO      KSYSCB99
KSYSCB95
          MOVE      TWO,EXIT
KSYSCB99 TOPIC    PRGID
          RETURN
