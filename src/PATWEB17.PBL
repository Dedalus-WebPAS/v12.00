.----------------------------------------------------------------------
. Program       : PATWEB17
.
. Function      : ABF Adjustment Maintenance
.
. Modifications : 
.----------------------------------------------------------------------
. V11.04.01 18/04/2023 J.Tan      TSK 0943758
.           Removed Psychiatric age fields
. V11.03.01 23/05/2023 J.Tan      TSK 0923703
.           Added Adjustment type 028 - COVID19
. V11.02.01 27/09/2022 Jill Parkinson Task 0923362
.           Changed SRCHCNTR to be packed with QRYDATA,SP70 in SETPAR00 as it
.           is a key field
. V11.00.01 14/07/2020 J.Tan      TSK 0892319
.           Added Adjustment type 026 and 027
. V10.14.03 10/07/2019 Peter Vela TSK 0857392
.           Added Ventilation, Unknown
. V10.14.02 02/07/2019 Peter Vela TSK 0857392
.           Added Age 095 - 099
.           Added MDC Mental Diseases & Disorders, Alcohol/Drug Use&Induced
.           Organic Mental Disorder
. V10.14.01 02/04/2019  Peter Vela               Task 0857392
.           Created Web Server
.           05/06/2019  Peter Vela               Task 0857392
.           Added tag to validate delete of pmshacaf
.           04/06/2019  Peter Vela               Task 0857392
.           Changed HAC save variables to DIMs
.           Removed Pre-MDC
.           Added replaces spaces with zeros in update MDC
.           30/05/2019  Peter Vela               Task 0857392
.           Fixed table columns in ADJTB000
.           27/05/2019  Peter Vela               Task 0857392
.           Fixed initialisation of PMHEUDAT in ABFE2300
.           Added missing Age Groups
.----------------------------------------------------------------------
          INC       IBAWEBDF    
          INC       WEBDATDF
.
          INC       PATCONFD/INC
          INC       PMSADJFD/INC
          INC       PMSADJTD/INC
          INC       PMSAUJFD/INC
          INC       PMSCIDFD/INC
          INC       PMSHACFD/INC
          INC       PMSHACTD/INC
          INC       PMSHDEFD/INC
          INC       PMSHDETD/INC
.
.----------------------------------------------------------------------
.
DIM3      DIM       3
FORM104   FORM      10.4
.
SAVEADJV  FORM      10.4
SAVEHACV  FORM      10.4
SAVECOMV  FORM      10.4
.
SAVECNTR  DIM       6       * Save variable Contract ID
SAVEHACG  DIM       3       * Save variable HAC Group 01=16 Cat Ha
SAVEHACD  DIM       20      * Save variable HAC Group Desc
SAVEHACT  DIM       3       * Save variable HAC Complexity Type
.
SV01ADJV  FORM      10.4    * Save variable value of adjustment 001
SV02ADJV  FORM      10.4    * Save variable value of adjustment 002
SV03ADJV  FORM      10.4    * Save variable value of adjustment 003
SV04ADJV  FORM      10.4    * Save variable value of adjustment 004
SV05ADJV  FORM      10.4    * Save variable value of adjustment 005
SV06ADJV  FORM      10.4    * Save variable value of adjustment 006
SV07ADJV  FORM      10.4    * Save variable value of adjustment 007
SV08ADJV  FORM      10.4    * Save variable value of adjustment 008
SV09ADJV  FORM      10.4    * Save variable value of adjustment 009
SV10ADJV  FORM      10.4    * Save variable value of adjustment 010
SV11ADJV  FORM      10.4    * Save variable value of adjustment 011
SV12ADJV  FORM      10.4    * Save variable value of adjustment 012 
SV13ADJV  FORM      10.4    * Save variable value of adjustment 013
SV14ADJV  FORM      10.4    * Save variable value of adjustment 014
SV15ADJV  FORM      10.4    * Save variable value of adjustment 015
SV16ADJV  FORM      10.4    * Save variable value of adjustment 016
SV17ADJV  FORM      10.4    * Save variable value of adjustment 017
SV18ADJV  FORM      10.4    * Save variable value of adjustment 018
SV19ADJV  FORM      10.4    * Save variable value of adjustment 019
SV20ADJV  FORM      10.4    * Save variable value of adjustment 020
SV21ADJV  FORM      10.4    * Save variable value of adjustment 021
SV22ADJV  FORM      10.4    * Save variable value of adjustment 022
SV23ADJV  FORM      10.4    * Save variable value of adjustment 023
SV24ADJV  FORM      10.4    * Save variable value of adjustment 024
SV25ADJV  FORM      10.4    * Save variable value of adjustment 025
SV26ADJV  FORM      10.4    * Save variable value of adjustment 026
SV27ADJV  FORM      10.4    * Save variable value of adjustment 027
.
SV01HACV  DIM       15      * Save variable HAC Complexity Field 001
SV02HACV  DIM       15      * Save variable HAC Complexity Field 002
SV03HACV  DIM       15      * Save variable HAC Complexity Field 003
SV04HACV  DIM       15      * Save variable HAC Complexity Field 004
SV05HACV  DIM       15      * Save variable HAC Complexity Field 005
SV06HACV  DIM       15      * Save variable HAC Complexity Field 006
SV07HACV  DIM       15      * Save variable HAC Complexity Field 007
SV08HACV  DIM       15      * Save variable HAC Complexity Field 008
.
SV01CHAV  FORM      10.4    * Save var 001 - Charlson - 009 - Charlson Score 1
SV02CHAV  FORM      10.4    * Save var 001 - Charlson - 010 - Charlson Score 2
SV03CHAV  FORM      10.4    * Save var 001 - Charlson - 011 - Charlson Score 3
SV04CHAV  FORM      10.4    * Save var 001 - Charlson - 012 - Charlson Score 4
SV05CHAV  FORM      10.4    * Save var 001 - Charlson - 013 - Charlson Score 5
SV06CHAV  FORM      10.4    * Save var 001 - Charlson - 014 - Charlson Score 6
SV07CHAV  FORM      10.4    * Save var 001 - Charlson - 015 - Charlson Score 7
SV08CHAV  FORM      10.4    * Save var 001 - Charlson - 016 - Charlson Score 8
SV09CHAV  FORM      10.4    * Save var 001 - Charlson - 017 - Charlson Score 9
SV10CHAV  FORM      10.4    * Save var 001 - Charlson - 018 - Charlson Score 10
SV11CHAV  FORM      10.4    * Save var 001 - Charlson - 019 - Charlson Score 11
SV12CHAV  FORM      10.4    * Save var 001 - Charlson - 020 - Charlson Score 12
SV13CHAV  FORM      10.4    * Save var 001 - Charlson - 021 - Charlson Score 13
SV14CHAV  FORM      10.4    * Save var 001 - Charlson - 022 - Charlson Score 14
SV15CHAV  FORM      10.4    * Save var 001 - Charlson - 023 - Charlson Score 15
SV16CHAV  FORM      10.4    * Save var 001 - Charlson - 024 - Charlson Score 16
.
SV01AGEV  FORM      10.4    * Save var 002 - Age - 025 - Age Range 1 (000-004)
SV02AGEV  FORM      10.4    * Save var 002 - Age - 026 - Age Range 2 (005-009)
SV03AGEV  FORM      10.4    * Save var 002 - Age - 027 - Age Range 3 (010-014)
SV04AGEV  FORM      10.4    * Save var 002 - Age - 028 - Age Range 4 (015-019)
SV05AGEV  FORM      10.4    * Save var 002 - Age - 029 - Age Range 5 (020-024)
SV06AGEV  FORM      10.4    * Save var 002 - Age - 030 - Age Range 6 (025-029)
SV07AGEV  FORM      10.4    * Save var 002 - Age - 031 - Age Range 7 (030-034)
SV08AGEV  FORM      10.4    * Save var 002 - Age - 032 - Age Range 8 (035-039)
SV09AGEV  FORM      10.4    * Save var 002 - Age - 033 - Age Range 9 (040-044)
SV10AGEV  FORM      10.4    * Save var 002 - Age - 034 - Age Range 10 (045-049)
SV11AGEV  FORM      10.4    * Save var 002 - Age - 035 - Age Range 11 (050-054)
SV12AGEV  FORM      10.4    * Save var 002 - Age - 036 - Age Range 12 (055-059)
SV13AGEV  FORM      10.4    * Save var 002 - Age - 037 - Age Range 13 (060-064)
SV14AGEV  FORM      10.4    * Save var 002 - Age - 038 - Age Range 14 (065-069)
SV15AGEV  FORM      10.4    * Save var 002 - Age - 040 - Age Range 15 (075-079)
SV16AGEV  FORM      10.4    * Save var 002 - Age - 041 - Age Range 16 (080-084)
SV17AGEV  FORM      10.4    * Save var 002 - Age - 042 - Age Range 17 (085-089)
SV18AGEV  FORM      10.4    * Save var 002 - Age - 043 - Age Range 18 (090-095)
.
SV01MDCV  FORM      10.4    * Save var 003 - MDC - 045 - MDC 020-103 
.                             (Nervous System)
SV02MDCV  FORM      10.4    * Save var 003 - MDC - 046 - MDC 113-125 (Eye)
SV03MDCV  FORM      10.4    * Save var 003 - MDC - 047 - MDC 129-159 
.                             (Ear,Nose,Mouth & Throat)
SV04MDCV  FORM      10.4    * Save var 003 - MDC - 048 - MDC 163-208 
.                             (Respiratory System)
SV05MDCV  FORM      10.4    * Save var 003 - MDC - 049 - MDC 215-316 
.                             (Circulatory System)
SV06MDCV  FORM      10.4    * Save var 003 - MDC - 050 - MDC 326-395 
.                             (Digestive System)
SV07MDCV  FORM      10.4    * Save var 003 - MDC - 051 - MDC 405-446 
.                             (Hepatobiliary System & Pancreas)
SV08MDCV  FORM      10.4    * Save var 003 - MDC - 052 - MDC 553-566 
.                             (Musculoskeletal System & Connective Tissue) 
SV09MDCV  FORM      10.4    * Save var 003 - MDC - 053 - MDC 573-607 
.                             (Skin,Subcutaneous Tissue & Breast)
SV10MDCV  FORM      10.4    * Save var 003 - MDC - 054 - MDC 614-645 
.                             (Endocrine,Nutritional & Metabolic)
SV11MDCV  FORM      10.4    * Save var 003 - MDC - 055 - MDC 652-700 
.                             (Kidney & Urinary Tract)
SV12MDCV  FORM      10.4    * Save var 003 - MDC - 056 - MDC 707-730 
.                             (Male Reproductive System)
SV13MDCV  FORM      10.4    * Save var 003 - MDC - 057 - MDC 734-761 
.                             (Female Reproductive System)
SV14MDCV  FORM      10.4    * Save var 003 - MDC - 058 - MDC 765-782 
.                             (Pregnancy,Childbirt & the Puerperium)
SV15MDCV  FORM      10.4    * Save var 003 - MDC - 059 - MDC 789-785 
.                             (Newborns & Other Neonates)
SV16MDCV  FORM      10.4    * Save var 003 - MDC - 060 - MDC 799-816 
.                             (Blood,Blood Forming Organs, Immunological 
.                             Disorder)
SV17MDCV  FORM      10.4    * Save var 003 - MDC - 061 - MDC 820-849 
.                             (Neoplastic Disorders)
SV18MDCV  FORM      10.4    * Save var 003 - MDC - 062 - MDC 853-872 
.                             (Infectious & Parasitic Disease)
SV19MDCV  FORM      10.4    * Save var 003 - MDC - 063 - MDC 901-923 
.                             (Injuries,Poisonings & Toxic Effects of Drugs)
SV20MDCV  FORM      10.4    * Save var 003 - MDC - 064 - MDC 927-935 (Burns)
SV21MDCV  FORM      10.4    * Save var 003 - MDC - 065 - MDC 939-951 (Factors 
.                             Influencing Health Status & Other Contacts with 
.                             Health Services)
.
SRCHCNTR  DIM       6       * Contract ID Search Variable  
SRCHHACG  DIM       3       * HAC Group 01=16 Cat Ha Search Variable
.
NEXTPAGE  DIM       1       * Nextpage parameter CGI parameter
UPDTTYPE  DIM       1       * Update Type
.
.----------------------------------------------------------------------
PRGID     INIT      "PATWEB17"
VERSION   INIT      "V12.00.00"
PRGNAM    INIT      "New Web Server"
.----------------------------------------------------------------------
.
          CALL      WEBINT00       * Initialise Fifo Etc.
          CALL      INIT0000       * Open Files
.
MAIN1000  CALL      WEBRED00       * Read Fifo WEBPID and USERID
.
          COMPARE   "999",REPORTNO * End Server Process on Report Option 999
          GOTO      MAIN9999 IF EQUAL
.
          BRANCH    REPORTNO,MAIN1100,MAIN1200,MAIN1300
.
          PACK      WEBTITLE,PRGID,SP1,VERSION,SP1,PRGNAM,SP70
          MOVE      "Invalid Option",WEBTITLE
          CALL      WEBERR00   * Create Output File and Write HTML Page Header
          GOTO      MAIN1000
.
MAIN1100  CALL      ABFA0000        
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1200  CALL      ABFH0000
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1300  CALL      ABFE0000
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN9999  MOVE      "SERVER SHUTDOWN COMPLETE",WEBTITLE
          CALL      WEBERR00
          STOP
.------------------------------------------------------------
. Output Next Page Based on CGI Parameter nextpage
.------------------------------------------------------------
NXTPAG00  MOVE      ZERO,F1
          MOVE      NEXTPAGE,F1
          BRANCH    F1,NXTPAG10
.
          CALL      WINCLS00
          GOTO      NXTPAG99
.
NXTPAG10  CALL      RDIREC00
          GOTO      NXTPAG99
.
NXTPAG99  RETURN
.------------------------------------------------------------
. Open Files and Initialize Variables
.------------------------------------------------------------
INIT0000  OPEN      CONTROLF,"controlf"
.
          OPEN      PATCODE1,"patcodes"
          OPEN      PATCODE2,"patcodes"
.
          OPEN      PMSADJA1,"pmsadjaf"
          OPEN      PMSAUJA1,"pmsaujaf"
          OPEN      PMSAUJA2,"pmsaujaf"
          OPEN      PMSHACA1,"pmshacaf"
          OPEN      PMSHACA2,"pmshacaf"
          OPEN      PMSHDEA1,"pmshdeaf"
.
INIT9999  RETURN
.------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------
CLRPAR00  MOVE      ZERO,REPORTNO
          MOVE      SP70,TEMPLATE
          MOVE      SP70,NEXTPAGE
          MOVE      SP70,REDIRECT
          MOVE      SP70,UPDTTYPE
.
          MOVE      SP70,SRCHCNTR
          MOVE      SP70,SRCHHACG
.
          CALL      CLRADJ00
.
          CALL      CLRHAC00
.
          CALL      CLRHDE00
.
CLRPAR99  RETURN
.------------------------------------------------------------
. Set Parameters
.------------------------------------------------------------
SETPAR00  MATCH     "reportno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REPORTNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "template=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TEMPLATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "updttype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,UPDTTYPE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "nextpage=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NEXTPAGE
            GOTO      SETPAR99
          ENDIF 
.
          MATCH     "redirect=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REDIRECT
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "srchcntr=",QRYNAME
          IF        @EQUAL
            PACK      SRCHCNTR,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "srchhacg=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,SRCHHACG
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmadj",QRYNAME
          IF        @EQUAL
            CALL      SPPAJ000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmhac",QRYNAME
          IF        @EQUAL
            CALL      SPPHA000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmhde",QRYNAME
          IF        @EQUAL
            CALL      SPPHE000
            GOTO      SETPAR99
          ENDIF
.
SETPAR99  RETURN
.------------------------------------------------------------
. ABF Adjustment Maintenance
.------------------------------------------------------------
ABFA0000  MATCH     SP70,UPDTTYPE
          GOTO      ABFA7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE            * Add
          GOTO      ABFA1000 IF EQUAL
.
          MATCH     "U",UPDTTYPE            * Update
          GOTO      ABFA2000 IF EQUAL
.
          MATCH     "D",UPDTTYPE            * Delete
          GOTO      ABFA3000 IF EQUAL
.
          GOTO      ABFA9000
.
.   **********  ADD FORMACTION  **********
.
ABFA1000  CALL      CLPMSADJ
.
          PACK      KEY9,PMADJ001,SP70
          CALL      RSPMADJ1
          CALL      RKPMADJ1
          BRANCH    OVRCD,ABFA1500
.
          MATCH     PMADJ001,PMAJCNTR
          GOTO      ABFA9100 IF EQUAL
.
ABFA1500  CALL      MVPMAJ00
.
          MOVE      USERID,PMAJCUID
          CALL      IBACLOCK
          PACK      PMAJCDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMAJCDAT
          MOVE      CTIMEIS,PMAJCTIM
.
          MOVE      "001",PMAJADJT
          MOVE      PMADJ003,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "002",PMAJADJT
          MOVE      PMADJ010,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "003",PMAJADJT
          MOVE      PMADJ011,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "004",PMAJADJT
          MOVE      PMADJ012,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "005",PMAJADJT
          MOVE      PMADJ013,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "006",PMAJADJT
          MOVE      PMADJ014,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "007",PMAJADJT
          MOVE      PMADJ015,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "008",PMAJADJT
          MOVE      PMADJ016,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "009",PMAJADJT
          MOVE      PMADJ017,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "010",PMAJADJT
          MOVE      PMADJ018,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "011",PMAJADJT
          MOVE      PMADJ019,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "012",PMAJADJT
          MOVE      PMADJ020,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "013",PMAJADJT
          MOVE      PMADJ021,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "014",PMAJADJT
          MOVE      PMADJ022,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "015",PMAJADJT
          MOVE      PMADJ023,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "016",PMAJADJT
          MOVE      PMADJ024,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "017",PMAJADJT
          MOVE      PMADJ025,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "018",PMAJADJT
          MOVE      PMADJ026,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "019",PMAJADJT
          MOVE      PMADJ027,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "020",PMAJADJT
          MOVE      PMADJ028,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "021",PMAJADJT
          MOVE      PMADJ029,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "022",PMAJADJT
          MOVE      PMADJ030,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "023",PMAJADJT
          MOVE      PMADJ031,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "024",PMAJADJT
          MOVE      PMADJ032,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "025",PMAJADJT
          MOVE      PMADJ033,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "026",PMAJADJT
          MOVE      PMADJ034,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "027",PMAJADJT
          MOVE      PMADJ035,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      "028",PMAJADJT
          MOVE      PMADJ036,PMAJADJV
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      RAPMADJ1
          IF        OVRCD=1
            CALL      WRPMADJ1
            CALL      AUJADD00
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFA9999
.
.   **********  UPDATE FORMACTION  **********
.
ABFA2000  PACK      KEY9,PMADJ001,SP70
          CALL      RSPMADJ1
          CALL      RKPMADJ1
          BRANCH    OVRCD,ABFA9200
.
          MATCH     PMADJ001,PMAJCNTR
          GOTO      ABFA9200 IF NOT EQUAL
.
          MOVE      USERID,PMADJ007
          CALL      IBACLOCK
          PACK      PMADJ008,CCC,CYY,CMM,CDD
          REP       " 0",PMADJ008
          MOVE      CTIMEIS,PMADJ009
.
          MOVE      "001",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ003,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "002",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ010,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "003",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ011,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "004",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ012,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "005",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ013,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "006",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ014,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "007",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ015,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "008",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ016,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "009",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ017,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "010",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ018,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "011",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ019,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "012",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ020,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "013",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ021,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "014",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ022,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "015",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ023,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "016",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ024,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "017",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ025,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "018",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ026,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "019",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ027,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "020",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ028,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "021",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ029,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "022",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ030,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "023",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ031,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "024",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ032,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "025",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ033,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ENDIF
.
          MOVE      "026",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ034,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ELSE
             MOVE     PMADJ034,FORM104
             CALL     WADJ0000
          ENDIF
.
          MOVE      "027",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ035,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ELSE
             MOVE     PMADJ035,FORM104
             CALL     WADJ0000
          ENDIF
.
          MOVE      "028",PMADJ002
.
          PACK      KEY9,PMADJ001,PMADJ002,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SAVEADJV
            MOVE      PMADJ036,PMAJADJV
            MOVE      PMADJ007,PMAJUUID
            MOVE      PMADJ008,PMAJUDAT
            MOVE      PMADJ009,PMAJUTIM
            CALL      UPPMADJ1
            CALL      AUJCHG00
          ELSE
             MOVE     PMADJ036,FORM104
             CALL     WADJ0000
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFA9999
.
.   **********  DELETE FORMACTION  **********
.
ABFA3000  PACK      KEY9,PMADJ001,SP70
          CALL      RSPMADJ1
          CALL      RKPMADJ1
          BRANCH    OVRCD,ABFA3900
.
          MATCH     PMADJ001,PMAJCNTR
          GOTO      ABFA3900 IF NOT EQUAL
.
          PACK      KEY9,PMAJCNTR,PMAJADJT,SP70
          CALL      DEPMADJ1
.
          CALL      AUJDEL00
.
          GOTO      ABFA3000
.
ABFA3900  MOVE      ZERO,EXIT
          GOTO      ABFA9999
.
.   **********  DISPLAY FORMACTION  **********
.
ABFA7000  CLEAR     WEBTITLE
          MOVE      "ABF Adjustment Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ABFA9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      ABFA9999
.
ABFA9100  MOVE      "Record already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFA9999
.
ABFA9200  MOVE      "Record does not exist.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFA9999
.
ABFA9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFA9999
.
ABFA9999  RETURN
+
.------------------------------------------------------------
. Write a new adjustment on Update
.------------------------------------------------------------
WADJ0000  UNPACK    KEY9,PMAJCNTR,PMAJADJT
          UNPACK    SP70,PMAJUUID,PMAJUDAT,PMAJUTIM
.
          MOVE      USERID,PMAJCUID
          CALL      IBACLOCK
          PACK      PMAJCDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMAJCDAT
          MOVE      CTIMEIS,PMAJCTIM
          MOVE      FORM104,PMAJADJV
.
          CALL      WRPMADJ1
          CALL      AUJADD00
WADJ9999  RETURN
+
.------------------------------------------------------------
. Process Fields 
.------------------------------------------------------------
PROFLD00  BRANCH    REPORTNO,PROFLD10,PROFLD20,PROFLD30
.
          GOTO      PROFLD99 
.
PROFLD10  BRANCH    FLDSETNO,PROFLD11,PROFLD12
          GOTO      PROFLD99
.
PROFLD11  CALL      PMAJ0000
          GOTO      PROFLD99
.
PROFLD12  CALL      ADJMN000
          GOTO      PROFLD99
.
PROFLD20  BRANCH    FLDSETNO,PROFLD21,PROFLD22
          GOTO      PROFLD99
.
PROFLD21  CALL      PMHA0000
          GOTO      PROFLD99
.
PROFLD22  CALL      HACMN000
          GOTO      PROFLD99
.
PROFLD30  BRANCH    FLDSETNO,PROFLD31,PROFLD32
          GOTO      PROFLD99
.
PROFLD31  CALL      PMHE0000
          GOTO      PROFLD99
.
PROFLD32  CALL      HDEMN000
          GOTO      PROFLD99
.
PROFLD99  RETURN
.
.------------------------------------------------------------
. Adjustment Maintenance Tags
.------------------------------------------------------------
ADJMN000  BRANCH    FLDITMNO,ADJMN010,ADJMN020,ADJMN030,ADJMN040
          GOTO      ADJMN999
.
ADJMN010  CALL      ADJTB000
          GOTO      ADJMN999
.
ADJMN020  WRITE     HTMLFILE;SRCHCNTR;
          GOTO      ADJMN999
.
ADJMN030  UNPACK    DIM127,D1,DIM3,DIM127
.
          PACK      KEY9,PMADJ001,DIM3,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            WRITE     HTMLFILE;PMAJADJV;
          ENDIF
.
          GOTO      ADJMN999
.
ADJMN040  WRITE     HTMLFILE;PMADJ001;
          GOTO      ADJMN999
.
ADJMN999  RETURN
.
.------------------------------------------------------------
. Adjustment Maintenance Table
.------------------------------------------------------------
ADJTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      AJHED000 
.
          MATCH     SP70,SRCHCNTR
          GOTO      ADJTB999 IF EQUAL
          GOTO      ADJTB999 IF EOS
.
          PACK      KEY9,SRCHCNTR,SP70
          CALL      RSPMADJ1
          CALL      RKPMADJ1
          BRANCH    OVRCD,ADJTB999
.
          MATCH     SRCHCNTR,PMAJCNTR
          GOTO      ADJTB999 IF NOT EQUAL    
.
          CALL      CLADSV00
.
          MOVE      SRCHCNTR,SAVECNTR
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,ONE,SP70 
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV01ADJV
          ENDIF 
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,TWO,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV02ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,THREE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV03ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,FOUR,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV04ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,FIVE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV05ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,SIX,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV06ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,SEVEN,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV07ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,EIGHT,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV08ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ZERO,NINE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV09ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,ZERO,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV10ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,ONE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV11ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,TWO,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV12ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,THREE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV13ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,FOUR,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV14ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,FIVE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV15ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,SIX,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV16ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,SEVEN,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV17ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,EIGHT,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV18ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,ONE,NINE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV19ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,ZERO,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV20ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,ONE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV21ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,TWO,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV22ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,THREE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV23ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,FOUR,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV24ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,FIVE,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV25ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,SIX,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV26ADJV
          ENDIF
.
          PACK      KEY9,SRCHCNTR,ZERO,TWO,SEVEN,SP70
          CALL      RDPMADJ1
          IF        OVRCD=0
            MOVE      PMAJADJV,SV27ADJV
          ENDIF
.
          CALL      AJROW000
.
ADJTB999  RETURN
.
.------------------------------------------------------------
. Clear Adjustment Save Variables
.------------------------------------------------------------
CLADSV00  MOVE      SP70,SAVECNTR
          MOVE      ZERO,SV01ADJV
          MOVE      ZERO,SV02ADJV
          MOVE      ZERO,SV03ADJV
          MOVE      ZERO,SV04ADJV
          MOVE      ZERO,SV05ADJV
          MOVE      ZERO,SV06ADJV
          MOVE      ZERO,SV07ADJV
          MOVE      ZERO,SV08ADJV
          MOVE      ZERO,SV09ADJV
          MOVE      ZERO,SV10ADJV
          MOVE      ZERO,SV11ADJV
          MOVE      ZERO,SV12ADJV
          MOVE      ZERO,SV13ADJV
          MOVE      ZERO,SV14ADJV
          MOVE      ZERO,SV15ADJV
          MOVE      ZERO,SV16ADJV
          MOVE      ZERO,SV17ADJV
          MOVE      ZERO,SV18ADJV
          MOVE      ZERO,SV19ADJV
          MOVE      ZERO,SV20ADJV
          MOVE      ZERO,SV21ADJV
          MOVE      ZERO,SV22ADJV
          MOVE      ZERO,SV23ADJV
          MOVE      ZERO,SV24ADJV
          MOVE      ZERO,SV25ADJV
          MOVE      ZERO,SV26ADJV
          MOVE      ZERO,SV27ADJV
.
CLADSV99  RETURN
.
.------------------------------------------------------------
. Adjustment Table Details (TABLE HEADING)
.------------------------------------------------------------
AJHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell>":
                               "Contract ID</td>":
.                              "<td class=HeadingCell>":
.                              "Spec. Psy Age<br><=17 w MDC</td>":
.                              "<td class=HeadingCell>":
.                              "Spec. Psy Age<br><=17 no MDC</td>":
.                              "<td class=HeadingCell>":
.                              "Spec. Psy Age<br>>17 no MDC</td>":
                               "<td class=HeadingCell>":
                               "Outer Regional</td>":
                               "<td class=HeadingCell>":
                               "Remote<br>Area (Adm)</td>":
                               "<td class=HeadingCell>":
                               "Remote<br>Area (ED)</td>":
                               "<td class=HeadingCell>":
                               "Very Remote<br>Area (Adm)</td>":
                               "<td class=HeadingCell>":
                               "Very Remote<br>Area (ED)</td>":
                               "<td class=HeadingCell>":
                               "Indigenous<br>Adjustment %</td>":
                               "<td class=HeadingCell>":
                               "Radiotherapy<br>Adjustment %</td>":
                               "<td class=HeadingCell>":
                               "Dialysis<br>Adjustment %</td>":
                               "<td class=HeadingCell>":
                               "ICU<br>Adjustment</td>":
                               "<td class=HeadingCell>":
                               "Private Accommodation<br>Sameday</td>":
                               "<td class=HeadingCell>":
                               "Private Accommodation<br>Overnight</td>":
                               "<td class=HeadingCell>":
                               "Multidisciplinary<br>Clinic</td>":
                               "<td class=HeadingCell>":
                               "ED Age Adjustment<br>65-79</td>":
                               "<td class=HeadingCell>":
                               "ED Age Adjustment<br>Over 79</td>":
                             "</tr>"
.
AJHED999  RETURN
.
.------------------------------------------------------------
. Adjustment Row Details 
.------------------------------------------------------------
AJROW000  WRITE     HTMLFILE;"<tr>":
                             "<td nowrap>":
                             "<A HREF='javascript:ShowDetail01":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pmadj001=",SAVECNTR,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             " ":
                               SAVECNTR,"</td>":
.                              "<td>":
.                              SV01ADJV,"</td>":
.                              "<td>":
.                              SV02ADJV,"</td>":
.                              "<td>":
.                              SV03ADJV,"</td>":
                               "<td>":
                               SV04ADJV,"</td>":
                               "<td>":
                               SV05ADJV,"</td>":
                               "<td>":
                               SV06ADJV,"</td>":
                               "<td>":
                               SV07ADJV,"</td>":
                               "<td>":
                               SV08ADJV,"</td>":
                               "<td>":
                               SV09ADJV,"</td>":
                               "<td>":
                               SV10ADJV,"</td>":
                               "<td>":
                               SV11ADJV,"</td>":
                               "<td>":
                               SV12ADJV,"</td>":
                               "<td>":
                               SV13ADJV,"</td>":
                               "<td>":
                               SV14ADJV,"</td>":
                               "<td>":
                               SV20ADJV,"</td>":
                               "<td>":
                               SV21ADJV,"</td>":
                               "<td>":
                               SV22ADJV,"</td>":
                             "</tr>"
.
AJROW999  RETURN
.
.------------------------------------------------------------
. PMSAUJ Audit Add
.------------------------------------------------------------
AUJADD00  PACK      KEY26,PMAJCDAT,PMAJCTIM,ANSA,PMAJCNTR,PMAJADJT
          CALL      RAPMAUJ1
          IF        OVRCD=1
            MOVE      PMAJCDAT,PMAUADAT
            MOVE      PMAJCTIM,PMAUATIM
            MOVE      ANSA,PMAUATYP
            MOVE      PMAJCNTR,PMAUCNTR
            MOVE      PMAJADJT,PMAUADJT
            MOVE      ZERO,PMAUPVAL
            MOVE      PMAJADJV,PMAUCVAL
            MOVE      PMAJCUID,PMAUCUID
            MOVE      PMAJCDAT,PMAUCDAT
            MOVE      PMAJCTIM,PMAUCTIM
            MOVE      SP70,PMAUSPAR
.
            CALL      WRPMAUJ1
          ENDIF
.
AUJADD99  RETURN
+
.------------------------------------------------------------
. PMSAUJ Audit Change
.------------------------------------------------------------
AUJCHG00  COMPARE   SAVEADJV,PMAJADJV
          GOTO      AUJCHG99 IF EQUAL
.
          PACK      KEY26,PMAJUDAT,PMAJUTIM,ANSC,PMAJCNTR,PMAJADJT
          CALL      RAPMAUJ1
          IF        OVRCD=1
            MOVE      PMAJUDAT,PMAUADAT
            MOVE      PMAJUTIM,PMAUATIM
            MOVE      ANSC,PMAUATYP
            MOVE      PMAJCNTR,PMAUCNTR
            MOVE      PMAJADJT,PMAUADJT
            MOVE      SAVEADJV,PMAUPVAL
            MOVE      PMAJADJV,PMAUCVAL
            MOVE      PMAJUUID,PMAUCUID
            MOVE      PMAJUDAT,PMAUCDAT
            MOVE      PMAJUTIM,PMAUCTIM
            MOVE      SP70,PMAUSPAR
.
            CALL      WRPMAUJ1
          ENDIF
.
AUJCHG99  RETURN
+
.------------------------------------------------------------
. PMSAUJ Audit Delete
.------------------------------------------------------------
AUJDEL00  MOVE      USERID,PMAUCUID
          CALL      IBACLOCK
          PACK      PMAUCDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMAUCDAT
          MOVE      CTIMEIS,PMAUCTIM
.
          PACK      KEY26,PMAUCDAT,PMAUCTIM,ANSD,PMAJCNTR,PMAJADJT
          CALL      RAPMAUJ1
          IF        OVRCD=1
            MOVE      PMAUCDAT,PMAUADAT
            MOVE      PMAUCTIM,PMAUATIM
            MOVE      ANSD,PMAUATYP
            MOVE      PMAJCNTR,PMAUCNTR
            MOVE      PMAJADJT,PMAUADJT
            MOVE      PMAJADJV,PMAUPVAL
            MOVE      ZERO,PMAUCVAL
            MOVE      SP70,PMAUSPAR
.
            CALL      WRPMAUJ1
          ENDIF
.
AUJDEL99  RETURN
+
.------------------------------------------------------------
. Clear ABF HAC Baseline Complexity Save Variables
.------------------------------------------------------------
CLHASV00  MOVE      SP70,SAVECNTR
          MOVE      SP70,SAVEHACV
          MOVE      SP70,SV01HACV
          MOVE      SP70,SV02HACV
          MOVE      SP70,SV03HACV
          MOVE      SP70,SV04HACV
          MOVE      SP70,SV05HACV
          MOVE      SP70,SV06HACV
          MOVE      SP70,SV07HACV
          MOVE      SP70,SV08HACV
.
CLHASV99  RETURN
+
.------------------------------------------------------------
. ABF HAC Baseline Complexity Maintenance
.------------------------------------------------------------
ABFH0000  MATCH     SP70,UPDTTYPE
          GOTO      ABFH7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE            * Add
          GOTO      ABFH1000 IF EQUAL
.
          MATCH     "U",UPDTTYPE            * Update
          GOTO      ABFH2000 IF EQUAL
.
          MATCH     "D",UPDTTYPE            * Delete
          GOTO      ABFH3000 IF EQUAL
.
          GOTO      ABFH9000
.
.   **********  ADD FORMACTION  **********
.
ABFH1000  CALL      CLPMSHAC
.
          PACK      KEY12,PMHAC001,PMHAC002,SP70
          CALL      RSPMHAC1
          CALL      RKPMHAC1
          BRANCH    OVRCD,ABFH1500
.
          MATCH     PMHAC001,PMHACNTR
          GOTO      ABFH1500 IF NOT EQUAL
.
          MATCH     PMHAC002,PMHAHACG
          GOTO      ABFH1500 IF NOT EQUAL
.
          GOTO      ABFH9100
.
ABFH1500  CALL      MVPMHA00
.
          MOVE      USERID,PMHACUID
          CALL      IBACLOCK
          PACK      PMHACDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMHACDAT
          MOVE      CTIMEIS,PMHACTIM
.
          MOVE      "001",PMHAHACF
          MOVE      PMHAC004,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "002",PMHAHACF
          MOVE      PMHAC011,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "003",PMHAHACF
          MOVE      PMHAC012,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "004",PMHAHACF
          MOVE      PMHAC013,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "005",PMHAHACF
          MOVE      PMHAC014,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "006",PMHAHACF
          MOVE      PMHAC015,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "007",PMHAHACF
          MOVE      PMHAC016,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      "008",PMHAHACF
          MOVE      PMHAC017,PMHAHACV
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      RAPMHAC1
          IF        OVRCD=1
            CALL      WRPMHAC1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFH9999
.
.   **********  UPDATE FORMACTION  **********
.
ABFH2000  PACK      KEY12,PMHAC001,PMHAC002,SP70
          CALL      RSPMHAC1
          CALL      RKPMHAC1
          BRANCH    OVRCD,ABFH9200
.
          MATCH     PMHAC001,PMHACNTR
          GOTO      ABFH9200 IF NOT EQUAL
.
          MATCH     PMHAC002,PMHAHACG
          GOTO      ABFH9200 IF NOT EQUAL
.
          MOVE      USERID,PMHAC007
          CALL      IBACLOCK
          PACK      PMHAC008,CCC,CYY,CMM,CDD
          REP       " 0",PMHAC008
          MOVE      CTIMEIS,PMHAC009
.
          MOVE      "001",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC004,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "002",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC011,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "003",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC012,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "004",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC013,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "005",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC014,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "006",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC015,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "007",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC016,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      "008",PMHAC003
.
          PACK      KEY12,PMHAC001,PMHAC002,PMHAC003,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SAVEHACV
            MOVE      PMHAC017,PMHAHACV
            MOVE      PMHAC002,PMHAHACG
            MOVE      PMHAC007,PMHAUUID
            MOVE      PMHAC008,PMHAUDAT
            MOVE      PMHAC009,PMHAUTIM
            CALL      UPPMHAC1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFH9999
.
.   **********  DELETE FORMACTION  **********
.
ABFH3000  PACK      KEY15,PMHAC001,PMHAC002,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFH3100
.
          MATCH     PMHECNTR,PMHAC001
          GOTO      ABFH3100 IF NOT EQUAL
.
          MATCH     PMHEHACG,PMHAC002
          GOTO      ABFH3100 IF NOT EQUAL
.
          GOTO      ABFH9300
.
ABFH3100  PACK      KEY12,PMHAC001,PMHAC002,SP70
          CALL      RSPMHAC1
          CALL      RKPMHAC1
          BRANCH    OVRCD,ABFH3900
.
          MATCH     PMHAC001,PMHACNTR
          GOTO      ABFH3900 IF NOT EQUAL
.
          MATCH     PMHAC002,PMHAHACG
          GOTO      ABFH3900 IF NOT EQUAL
.
          PACK      KEY12,PMHACNTR,PMHAHACG,PMHAHACF,SP70
          CALL      DEPMHAC1
.
          GOTO      ABFH3000
.
ABFH3900  MOVE      ZERO,EXIT
          GOTO      ABFH9999
.
.   **********  DISPLAY FORMACTION  **********
.
ABFH7000  CLEAR     WEBTITLE
          MOVE      "ABF HAC Baseline Complexity Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ABFH9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      ABFH9999
.
ABFH9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFH9999
.
ABFH9100  MOVE      "Record already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFH9999
.
ABFH9200  MOVE      "Record does not exist.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFH9999
.
ABFH9300  MOVE      "MDC, Age, Charlson scores must be deleted first.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFH9999
.
ABFH9999  RETURN
+
.------------------------------------------------------------
. ABF HAC Baseline Complexity Maintenance Tags
.------------------------------------------------------------
HACMN000  BRANCH    FLDITMNO,HACMN010,HACMN020,HACMN030,HACMN040,HACMN050:
                             HACMN060,HACMN070,HACMN080,HACMN090,HACMN100
          GOTO      HACMN999
.
HACMN010  CALL      HACTB000
          GOTO      HACMN999
.
HACMN020  WRITE     HTMLFILE;SRCHCNTR;
          GOTO      HACMN999
.
HACMN030  UNPACK    DIM127,D1,DIM3,DIM127
.
          PACK      KEY12,PMHAC001,PMHAC002,DIM3,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            WRITE     HTMLFILE;PMHAHACV;
          ENDIF
.
          GOTO      HACMN999
.
HACMN040  WRITE     HTMLFILE;PMHAC001;
          GOTO      HACMN999
.
HACMN050  MOVE      "Ha",CATEGORY
          PACK      CODE,PMHAC002,SP70
          CALL      CODITM00
          GOTO      HACMN999
.
HACMN060  MOVE      "Ha",CATEGORY
          PACK      CODE,SRCHHACG,SP70
          CALL      CODITM00
          GOTO      HACMN999
.
HACMN070  PACK      KEY15,PMHAC001,PMHAC002,ZERO,ZERO,ONE,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,HACMN999
.
          MATCH     PMHAC001,PMHECNTR
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     PMHAC002,PMHEHACG
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     "001",PMHEHACT
          GOTO      HACMN999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PMHAC001,PMHAC002,ZERO,ZERO,ONE;
          GOTO      HACMN999
.
HACMN080  PACK      KEY15,PMHAC001,PMHAC002,ZERO,ZERO,TWO,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,HACMN999
.
          MATCH     PMHAC001,PMHECNTR
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     PMHAC002,PMHEHACG
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     "002",PMHEHACT
          GOTO      HACMN999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PMHAC001,PMHAC002,ZERO,ZERO,TWO;
          GOTO      HACMN999
.
HACMN090  PACK      KEY15,PMHAC001,PMHAC002,ZERO,ZERO,THREE,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,HACMN999
.
          MATCH     PMHAC001,PMHECNTR
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     PMHAC002,PMHEHACG
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     "003",PMHEHACT
          GOTO      HACMN999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PMHAC001,PMHAC002,ZERO,ZERO,THREE;
          GOTO      HACMN999
.
HACMN100  PACK      KEY15,PMHAC001,PMHAC002,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,HACMN999
.
          MATCH     PMHECNTR,PMHAC001
          GOTO      HACMN999 IF NOT EQUAL
.
          MATCH     PMHEHACG,PMHAC002
          GOTO      HACMN999 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;
          GOTO      HACMN999
.
HACMN999  RETURN
+
.------------------------------------------------------------
. ABF HAC Baseline Complexity Maintenance Table
.------------------------------------------------------------
HACTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      HAHED000
.
          MATCH     SP70,SRCHCNTR
          GOTO      HACTB999 IF EQUAL
          GOTO      HACTB999 IF EOS
.
.         MATCH     SP70,SRCHHACG
.         GOTO      HACTB999 IF EQUAL
.         GOTO      HACTB999 IF EOS
.
          PACK      KEY12,SRCHCNTR,SRCHHACG,SP70
          CALL      RSPMHAC1
HACTB100  CALL      RKPMHAC1
          BRANCH    OVRCD,HACTB999
.
          MATCH     SRCHCNTR,PMHACNTR
          GOTO      HACTB999 IF NOT EQUAL
.
          MATCH     SP70,SRCHHACG
          IF        !@EQUAL & !@EOS
            MATCH     SRCHHACG,PMHAHACG
            GOTO      HACTB999 IF NOT EQUAL
          ENDIF
.
          CALL      CLHASV00
.
          MOVE      PMHACNTR,SAVECNTR
          MOVE      PMHAHACG,SAVEHACG
.
          MOVE      "Ha",CATEGORY
          MOVE      SAVEHACG,CODE
          CALL      GETCOD00
          MOVE      TDESC,SAVEHACD
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,ONE,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV01HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,TWO,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV02HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,THREE,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV03HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,FOUR,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV04HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,FIVE,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV05HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,SIX,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV06HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,SEVEN,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV07HACV
          ENDIF
.
          PACK      KEY12,SAVECNTR,SAVEHACG,ZERO,ZERO,EIGHT,SP70
          CALL      RDPMHAC1
          IF        OVRCD=0
            MOVE      PMHAHACV,SV08HACV
          ENDIF
.
          CALL      HAROW000
.
          GOTO      HACTB100
.
HACTB999  RETURN
+
.------------------------------------------------------------
. ABF HAC Baseline Complexity Table Details (TABLE HEADING)
.------------------------------------------------------------
HAHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell>":
                               "Contract ID</td>":
                               "<td class=HeadingCell>":
                               "HAC Group</td>":
                               "<td class=HeadingCell>":
                               "Baseline</td>":
                               "<td class=HeadingCell>":
                               "Emergency Admission</td>":
                               "<td class=HeadingCell>":
                               "ICU Hours</td>":
                               "<td class=HeadingCell>":
                               "Admission Transfer</td>":
                               "<td class=HeadingCell>":
                               "DRG Medical</td>":
                               "<td class=HeadingCell>":
                               "DRG Intervention</td>":
                               "<td class=HeadingCell>":
                               "Male</td>":
                               "<td class=HeadingCell>":
                               "Female</td>":
                               "</tr>"
.
HAHED999  RETURN
.
.------------------------------------------------------------
. Adjustment Row Details
.------------------------------------------------------------
HAROW000  WRITE     HTMLFILE;"<tr>":
                             "<td nowrap>":
                             "<A HREF='javascript:ShowDetail01":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pmhac001=",SAVECNTR:
                             "&pmhac002=",SAVEHACG,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             " ":
                               SAVECNTR,"</td>":
                               "<td>":
                               SAVEHACD,"</td>":
                               "<td>":
                               SV01HACV,"</td>":
                               "<td>":
                               SV02HACV,"</td>":
                               "<td>":
                               SV03HACV,"</td>":
                               "<td>":
                               SV04HACV,"</td>":
                               "<td>":
                               SV05HACV,"</td>":
                               "<td>":
                               SV06HACV,"</td>":
                               "<td>":
                               SV07HACV,"</td>":
                               "<td>":
                               SV08HACV,"</td>":
                             "</tr>"
.
HAROW999  RETURN
.
.------------------------------------------------------------
. ABF HAC Detail Complexity Maintenance
.------------------------------------------------------------
ABFE0000  MATCH     SP70,UPDTTYPE
          GOTO      ABFE7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE            * Add Charlson Values
          GOTO      ABFE1000 IF EQUAL
.
          MATCH     "B",UPDTTYPE            * Add Age Values
          GOTO      ABFE1300 IF EQUAL
.
          MATCH     "C",UPDTTYPE            * Add MDC Values
          GOTO      ABFE1600 IF EQUAL
.
          MATCH     "U",UPDTTYPE            * Update Charlson Values
          GOTO      ABFE2000 IF EQUAL
.
          MATCH     "V",UPDTTYPE            * Update Age Values
          GOTO      ABFE2300 IF EQUAL
.
          MATCH     "W",UPDTTYPE            * Update MDC Values
          GOTO      ABFE2600 IF EQUAL
.
          MATCH     "D",UPDTTYPE            * Delete Charlson Values
          GOTO      ABFE3000 IF EQUAL
.
          GOTO      ABFE9000
.
.   **********  ADD FORMACTION Charlson Values  **********
.
ABFE1000  CALL      CLPMSHDE
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFE1050
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE1050 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE1050 IF NOT EQUAL
.
          MATCH     PMHDE003,PMHEHACT
          GOTO      ABFE1050 IF NOT EQUAL
.
          GOTO      ABFE9100
.
ABFE1050  CALL      MVPMHE00
.
          MOVE      USERID,PMHECUID
          CALL      IBACLOCK
          PACK      PMHECDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMHECDAT
          MOVE      CTIMEIS,PMHECTIM
.
          MOVE      "001",PMHEHACT
          MOVE      "066",PMHEHACF
          MOVE      PMHDE067,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "009",PMHEHACF
          MOVE      PMHDE005,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "010",PMHEHACF
          MOVE      PMHDE012,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "011",PMHEHACF
          MOVE      PMHDE013,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "012",PMHEHACF
          MOVE      PMHDE014,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "013",PMHEHACF
          MOVE      PMHDE015,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "014",PMHEHACF
          MOVE      PMHDE016,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "015",PMHEHACF
          MOVE      PMHDE017,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "016",PMHEHACF
          MOVE      PMHDE018,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "017",PMHEHACF
          MOVE      PMHDE019,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "018",PMHEHACF
          MOVE      PMHDE020,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "019",PMHEHACF
          MOVE      PMHDE021,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "020",PMHEHACF
          MOVE      PMHDE022,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "021",PMHEHACF
          MOVE      PMHDE023,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "022",PMHEHACF
          MOVE      PMHDE024,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "023",PMHEHACF
          MOVE      PMHDE025,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "001",PMHEHACT
          MOVE      "024",PMHEHACF
          MOVE      PMHDE026,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  ADD FORMACTION Age Values  **********
.
ABFE1300  CALL      CLPMSHDE
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFE1350
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE1350 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE1350 IF NOT EQUAL
.
          MATCH     PMHDE003,PMHEHACT
          GOTO      ABFE1350 IF NOT EQUAL
.
          GOTO      ABFE9100
.
ABFE1350  CALL      MVPMHE00
.
          MOVE      USERID,PMHECUID
          CALL      IBACLOCK
          PACK      PMHECDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMHECDAT
          MOVE      CTIMEIS,PMHECTIM
.
          MOVE      "002",PMHEHACT
          MOVE      "025",PMHEHACF
          MOVE      PMHDE027,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "026",PMHEHACF
          MOVE      PMHDE028,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "027",PMHEHACF
          MOVE      PMHDE029,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "028",PMHEHACF
          MOVE      PMHDE030,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "029",PMHEHACF
          MOVE      PMHDE031,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "030",PMHEHACF
          MOVE      PMHDE032,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "031",PMHEHACF
          MOVE      PMHDE033,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "032",PMHEHACF
          MOVE      PMHDE034,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "033",PMHEHACF
          MOVE      PMHDE035,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "034",PMHEHACF
          MOVE      PMHDE036,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "035",PMHEHACF
          MOVE      PMHDE037,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "036",PMHEHACF
          MOVE      PMHDE038,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "037",PMHEHACF
          MOVE      PMHDE039,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "038",PMHEHACF
          MOVE      PMHDE040,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "039",PMHEHACF
          MOVE      PMHDE041,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "040",PMHEHACF
          MOVE      PMHDE042,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "041",PMHEHACF
          MOVE      PMHDE043,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "042",PMHEHACF
          MOVE      PMHDE044,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "043",PMHEHACF
          MOVE      PMHDE045,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "002",PMHEHACT
          MOVE      "044",PMHEHACF
          MOVE      PMHDE069,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  ADD FORMACTION MDC Values  **********
.
ABFE1600  CALL      CLPMSHDE
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFE1650
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE1650 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE1650 IF NOT EQUAL
.
          MATCH     PMHDE003,PMHEHACT
          GOTO      ABFE1650 IF NOT EQUAL
.
          GOTO      ABFE9100
.
ABFE1650  CALL      MVPMHE00
.
          MOVE      USERID,PMHECUID
          CALL      IBACLOCK
          PACK      PMHECDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMHECDAT
          MOVE      CTIMEIS,PMHECTIM
.
          MOVE      "003",PMHEHACT
          MOVE      "045",PMHEHACF
          MOVE      PMHDE046,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "046",PMHEHACF
          MOVE      PMHDE047,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "047",PMHEHACF
          MOVE      PMHDE048,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "048",PMHEHACF
          MOVE      PMHDE049,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "049",PMHEHACF
          MOVE      PMHDE050,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "050",PMHEHACF
          MOVE      PMHDE051,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "051",PMHEHACF
          MOVE      PMHDE052,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "052",PMHEHACF
          MOVE      PMHDE053,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "053",PMHEHACF
          MOVE      PMHDE054,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "054",PMHEHACF
          MOVE      PMHDE055,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "055",PMHEHACF
          MOVE      PMHDE056,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "056",PMHEHACF
          MOVE      PMHDE057,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "057",PMHEHACF
          MOVE      PMHDE058,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "058",PMHEHACF
          MOVE      PMHDE059,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "059",PMHEHACF
          MOVE      PMHDE060,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "060",PMHEHACF
          MOVE      PMHDE061,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "061",PMHEHACF
          MOVE      PMHDE062,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "062",PMHEHACF
          MOVE      PMHDE063,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "063",PMHEHACF
          MOVE      PMHDE064,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "064",PMHEHACF
          MOVE      PMHDE065,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "065",PMHEHACF
          MOVE      PMHDE066,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "067",PMHEHACF
          MOVE      PMHDE068,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "068",PMHEHACF
          MOVE      PMHDE070,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "069",PMHEHACF
          MOVE      PMHDE071,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "003",PMHEHACT
          MOVE      "070",PMHEHACF
          MOVE      PMHDE072,PMHECOMV
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      RAPMHDE1
          IF        OVRCD=1
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  UPDATE FORMACTION Charlson Values  **********
.
ABFE2000  PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFH9200
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE9200 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE9200 IF NOT EQUAL
.
          MOVE      USERID,PMHDE011
          CALL      IBACLOCK
          PACK      PMHDE009,CCC,CYY,CMM,CDD
          REP       " 0",PMHDE009
          MOVE      CTIMEIS,PMHDE010
.
          MOVE      "009",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE005,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE005,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1             
          ENDIF
.
          MOVE      "010",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE012,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE012,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "011",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE013,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE0013,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "012",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE014,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE0014,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "013",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE015,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE015,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "014",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE016,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE016,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "015",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE017,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE017,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "016",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE018,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE018,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "017",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE019,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE019,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "018",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE020,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE020,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "019",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE021,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE021,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "020",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE022,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE022,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "021",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE023,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE023,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "022",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE024,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE024,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "023",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE025,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE025,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "024",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE026,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE026,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
ABFE2010  MOVE      "066",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE067,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE067,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  UPDATE FORMACTION Age Values  **********
.
ABFE2300  PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFH9200
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE9200 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE9200 IF NOT EQUAL
.
          MOVE      USERID,PMHDE011
          CALL      IBACLOCK
          PACK      PMHDE009,CCC,CYY,CMM,CDD
          REP       " 0",PMHDE009
          MOVE      CTIMEIS,PMHDE010
.
          MOVE      "025",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE027,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE027,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "026",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE028,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE028,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "027",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE029,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE029,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "028",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE030,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE030,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "029",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE031,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE031,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "030",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE032,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE032,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "031",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE033,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE033,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "032",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE034,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE034,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "033",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE035,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE035,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "034",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE036,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE036,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "035",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE037,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE037,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "036",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE038,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE038,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "037",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE039,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE039,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "038",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE040,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE040,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "039",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE041,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE041,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "040",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE042,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE042,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "041",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE043,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE043,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "042",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE044,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE044,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "043",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE045,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE045,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "044",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE069,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE069,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  UPDATE FORMACTION MDC Values  **********
.
ABFE2600  PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFH9200
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE9200 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE9200 IF NOT EQUAL
.
          MOVE      USERID,PMHDE011
          CALL      IBACLOCK
          PACK      PMHDE009,CCC,CYY,CMM,CDD
          REP       " 0",PMHDE009
          MOVE      CTIMEIS,PMHDE010
.
          MOVE      "067",PMHDE004
 
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE068,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE068,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "068",PMHDE004

          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE070,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE070,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "069",PMHDE004

          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE071,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE071,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "070",PMHDE004

          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE072,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE072,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "045",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE046,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE046,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "046",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE047,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE047,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "047",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE048,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE048,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "048",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE049,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE049,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "049",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE050,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE050,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "050",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE051,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE051,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "051",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE052,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE052,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "052",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE053,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE053,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "053",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE054,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE054,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "054",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE055,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE055,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "055",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE056,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE056,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "056",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE057,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE057,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "057",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE058,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE058,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "058",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE059,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE059,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "059",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE060,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE060,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "060",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE061,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE061,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "061",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE062,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE062,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "062",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE063,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE063,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "063",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE064,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE064,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "064",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE065,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE065,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      "065",PMHDE004
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,PMHDE004,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            MOVE      PMHECOMV,SAVECOMV
            MOVE      PMHDE066,PMHECOMV
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE011,PMHEUUID
            MOVE      PMHDE009,PMHEUDAT
            MOVE      PMHDE010,PMHEUTIM
            MOVE      PMHDE004,PMHEHACF
            CALL      UPPMHDE1
          ELSE
            CALL      CLPMSHDE
            MOVE      PMHDE001,PMHECNTR
            MOVE      PMHDE002,PMHEHACG
            MOVE      PMHDE003,PMHEHACT
            MOVE      PMHDE004,PMHEHACF
            MOVE      PMHDE066,PMHECOMV
            MOVE      PMHDE009,PMHECDAT
            MOVE      PMHDE010,PMHECTIM
            MOVE      PMHDE011,PMHECUID
            CALL      WRPMHDE1
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  DELETE FORMACTION Charlson/Age/MDC Values  **********
.
ABFE3000  PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,SP70
          CALL      RSPMHDE1
          CALL      RKPMHDE1
          BRANCH    OVRCD,ABFE3900
.
          MATCH     PMHDE001,PMHECNTR
          GOTO      ABFE3900 IF NOT EQUAL
.
          MATCH     PMHDE002,PMHEHACG
          GOTO      ABFE3900 IF NOT EQUAL
.
          MATCH     PMHDE003,PMHEHACT
          GOTO      ABFE3900 IF NOT EQUAL
.
          PACK      KEY15,PMHECNTR,PMHEHACG,PMHEHACT,PMHEHACF,SP70
          CALL      DEPMHDE1
.
          GOTO      ABFE3000
.
ABFE3900  MOVE      ZERO,EXIT
          GOTO      ABFE9999
.
.   **********  DISPLAY FORMACTION  **********
.
ABFE7000  CLEAR     WEBTITLE
          MOVE      "ABF HAC Detail Complexity Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ABFE9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      ABFE9999
.
ABFE9100  MOVE      "Record already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFE9999
.
ABFE9200  MOVE      "Record does not exist.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFE9999
.
ABFE9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ABFE9999
.
ABFE9999  RETURN
+
.------------------------------------------------------------
. ABF HAC Detail Complexity Maintenance Tags
.------------------------------------------------------------
HDEMN000  BRANCH    FLDITMNO,HDEMN010,HDEMN020,HDEMN030,HDEMN040,HDEMN050:
                             HDEMN060
          GOTO      HDEMN999
.
HDEMN010  
.         CALL      HDETB000
          GOTO      HDEMN999
.
HDEMN020  
.         WRITE     HTMLFILE;SRCHCNTR;
          GOTO      HDEMN999
.
HDEMN030  UNPACK    DIM127,D1,DIM3,DIM127
.
          PACK      KEY15,PMHDE001,PMHDE002,PMHDE003,DIM3,SP70
          CALL      RDPMHDE1
          IF        OVRCD=0
            WRITE     HTMLFILE;PMHECOMV;
          ENDIF
.
          GOTO      HDEMN999
.
HDEMN040  WRITE     HTMLFILE;PMHDE001;
          GOTO      HDEMN999
.
HDEMN050  MOVE      "Ha",CATEGORY
          PACK      CODE,PMHDE002,SP70
          CALL      CODITM00
          GOTO      HDEMN999
.
HDEMN060  WRITE     HTMLFILE;PMHDE003;
          GOTO      HDEMN999
.
HDEMN999  RETURN
+
          INC       IBAWEBCD
          INC       WEBDATCD
.
          INC       CLPMSADJ
          INC       CLPMSHAC
          INC       CLPMSHDE
.
          INC       PMSADJTM
          INC       PMSHACTM
          INC       PMSHDETM
.
          INC       PMSADJIO/INC
          INC       PMSAUJIO/INC
          INC       PMSCIDIO/INC
          INC       PMSHACIO/INC
          INC       PMSHDEIO/INC
.
          INC       DAYOFWEK
