.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSRESKY
.   Routine   :   HFMRSA00 Responsibility      
.   Return    :           
.-------------------------------------------------------------------------------
HFMRSA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMRSA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMRSA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Responsibility"     
.
          MOVE      STDCOL01,STDCOL02
          ADD       "15",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "35",STDCOL03
HFMRSA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMRSCODE
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          CALL      RSFMRS1 
HFMRSA10
          CALL      RKFMRS1 
          BRANCH    OVRCD,HFMRSA15
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HFMRSA12
          CALL      HFMRSA60
          BRANCH    OVRCD,HFMRSA10
HFMRSA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMRSCODE
          DISPLAY   *PSTDCOL02:STDROW,FMRSDESC
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMRSA10 IF NOT EQUAL
HFMRSA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMRSA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMRSA30,HFMRSA35,HFMRSA40,HFMRSA45,HFMRSA04:
                              HFMRSA91,HFMRSA50
          GOTO      HFMRSA92
HFMRSA30
          CALL      RKFMRS1 
          BRANCH    OVRCD,HFMRSA85
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          CALL      RPFMRS1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMRSA10
HFMRSA35
          MOVE      ST1,KEY4 
          CALL      RDFMRS1 
          CALL      RPFMRS1 
          BRANCH    OVRCD,HFMRSA85
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMRSA36
          CALL      RPFMRS1 
          BRANCH    OVRCD,HFMRSA37
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMRSA36 IF NOT EQUAL
HFMRSA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMRSA10
HFMRSA40
          MOVE      ST1,KEY4 
          CALL      RDFMRS1 
          CALL      RPFMRS1 
          BRANCH    OVRCD,HFMRSA85
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMRSA08
HFMRSA45
          CALL      RKFMRS1 
          BRANCH    OVRCD,HFMRSA85
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMRS1 
HFMRSA46
          CALL      RPFMRS1 
          BRANCH    OVRCD,HFMRSA47
          PACK      KEY4,FMRSCODE,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMRSA46 IF NOT EQUAL
HFMRSA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMRSA10
HFMRSA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMRSA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMRSA08
HFMRSA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMRSA08
HFMRSA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMRSA61 IF EQUAL
          MATCH     SCHFLD01,FMRSCODE
          GOTO      HFMRSA72 IF NOT EQUAL
HFMRSA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMRSA62 IF EQUAL
          MATCH     SCHFLD02,FMRSDESC
          GOTO      HFMRSA72 IF NOT EQUAL
HFMRSA62
HFMRSA63
HFMRSA64
HFMRSA65
HFMRSA66
HFMRSA67
HFMRSA68
HFMRSA69
HFMRSA70
          GOTO      HFMRSA75
HFMRSA72  MOVE      ONE,OVRCD
HFMRSA75  RETURN
HFMRSA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,FMRSCODE                                               
          CALL      RDFMRS1 
HFMRSA90
.                                                                               
          BEEP
          GOTO      HFMRSA20
HFMRSA91
          MOVE      SP70,FMRSDESC
          MOVE      SP70,FMRSTELE
          MOVE      SP70,KEY4 
          MOVE      SP70,FMRSCODE
          GOTO      HFMRSA96
HFMRSA92
          MOVE      SP70,KEY4 
          MOVE      SP70,FMRSCODE
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,FMRSCODE                                               
HFMRSA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMRSA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSRESKY
.   Routine   :   KFMRSA00 Keyin Responsibility      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMRSA00 TOPIC     "FMRSCODE"
          MOVE      UNDLN70,FMRSCODE
          KEYIN     *PCCOL:CVERT,*DV,FMRSCODE:                                  
                    *PCCOL:CVERT,*V2LON,FMRSCODE:                               
                    *PCCOL:CVERT,*DV,FMRSCODE
.
          ENDSET    FMRSCODE
          APPEND    SP70,FMRSCODE
          RESET     FMRSCODE
.
          MATCH     SP70,FMRSCODE
          GOTO      KFMRSA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMRSCODE
          GOTO      KFMRSA95 IF EQUAL
.
          CMATCH    QUEST,FMRSCODE
          GOTO      KFMRSA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMRSA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMRSCODE
          APPEND    SP70,FMRSCODE
          RESET     FMRSCODE
.
          MATCH     SP70,FMRSCODE
          GOTO      KFMRSA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMRSCODE                                
KFMRSA10
          PACK      KEY4,FMRSCODE                                               
          CALL      RAFMRS1 
          BRANCH    OVRCD,KFMRSA80
          BRANCH    CKEYTYP,KFMRSA75
          CALL      RDFMRS1 
KFMRSA70
          MOVE      ZERO,EXIT
          GOTO      KFMRSA99
KFMRSA75
          MOVE      "Responsibility Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KFMRSA00
KFMRSA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMRSA99,KFMRSA99
          MOVE      "Responsibility Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KFMRSA00
KFMRSA90
          MOVE      ONE,EXIT
          GOTO      KFMRSA99
KFMRSA95
          MOVE      TWO,EXIT
KFMRSA99 TOPIC    PRGID
          RETURN
