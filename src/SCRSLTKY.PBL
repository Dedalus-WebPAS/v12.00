.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRSLTKY
.   Routine   :   KSCSLA00 Keyin Selection           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSCSLA00
          MOVE      UNDLN70,SCSLSEL 
          IF        CCOL=0
            KEYIN     *P1:1,*EOFF,*V2LON,*JR,SCSLSEL
          ELSE
            KEYIN     *PCCOL:CVERT,*DV,SCSLSEL:       
                      *PCCOL:CVERT,*V2LON,*JR,SCSLSEL  
          ENDIF
          REP       UPPLOW,SCSLSEL
          IF        CCOL>0
            DISPLAY   *PCCOL:CVERT,*V2LON,SCSLSEL 
          ENDIF
.
          ENDSET    SCSLSEL 
          APPEND    SP70,SCSLSEL 
          RESET     SCSLSEL 
.
          MATCH     "IBASCR05",PRGID
          IF        @EQUAL
            MATCH     SP70,SCSLSEL 
            GOTO      KSCSLA90 IF EQUAL
          ELSE
            MATCH     "IBASCR13",PRGID
            IF        @EQUAL
              MATCH     SP70,SCSLSEL 
              GOTO      KSCSLA90 IF EQUAL
            ELSE
              MATCH     SP70,SCSLSEL 
              IF        @EQUAL
                MOVE      "  0",SCSLSEL
                DISPLAY   *PCCOL:CVERT,*V2LON,SCSLSEL 
              ENDIF
            ENDIF
          ENDIF
.
          ENDSET    SCSLSEL 
          CMATCH    EXITCHAR,SCSLSEL 
          GOTO      KSCSLA95 IF EQUAL
.
          CMATCH    QUEST,SCSLSEL 
          GOTO      KSCSLA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSCSLA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SCSLSEL 
          APPEND    SP70,SCSLSEL 
          RESET     SCSLSEL 
.
          MATCH     SP70,SCSLSEL 
          GOTO      KSCSLA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SCSLSEL                                 
KSCSLA10
          RESET     SCSLSEL 
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL                               
          CALL      RASCSL1 
          BRANCH    OVRCD,KSCSLA80
          BRANCH    CKEYTYP,KSCSLA75
          CALL      RDSCSL1 
KSCSLA70
          MATCH     "IBASCR05",PRGID
          GOTO      KSCSLA71 IF EQUAL
          MATCH     "IBASCR13",PRGID
          GOTO      KSCSLA71 IF EQUAL
          MOVE      SCSLSEC,F2
          MOVE      F2,F1
          IF        F1>SECLEV
            BEEP
            MOVE      "Inadequate Security - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KSCSLA00
          ENDIF
KSCSLA71  MOVE      ZERO,EXIT
          GOTO      KSCSLA99
KSCSLA75
          MOVE      "Selection Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSCSLA00
KSCSLA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSCSLA99,KSCSLA99
          MATCH     "  0",SCSLSEL
          GOTO      KSCSLA90 IF EQUAL
          MOVE      "Selection Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSCSLA00
KSCSLA90
          MATCH     SP70,SCSLSEL 
          MOVE      ONE,EXIT
          GOTO      KSCSLA99
KSCSLA95
          MOVE      TWO,EXIT
KSCSLA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRSLTKY
.   Routine   :   KSCSLB00 Keyin Selection           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSCSLB00
          MOVE      UNDLN70,SCSLSEL 
          KEYIN     *PCCOL:CVERT,*DV,SCSLSEL:                                   
                    *PCCOL:CVERT,*V2LON,*JR,SCSLSEL:                            
                    *PCCOL:CVERT,*DV,SCSLSEL 
.
          ENDSET    SCSLSEL 
          APPEND    SP70,SCSLSEL 
          RESET     SCSLSEL 
.
          MATCH     SP70,SCSLSEL 
          GOTO      KSCSLB90 IF EQUAL
.
          ENDSET    SCSLSEL 
          CMATCH    EXITCHAR,SCSLSEL 
          GOTO      KSCSLB95 IF EQUAL
.
          CMATCH    QUEST,SCSLSEL 
          GOTO      KSCSLB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSCSLA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SCSLSEL 
          APPEND    SP70,SCSLSEL 
          RESET     SCSLSEL 
.
          MATCH     SP70,SCSLSEL 
          GOTO      KSCSLB00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SCSLSEL                                 
KSCSLB10
          RESET     SCSLSEL 
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL                               
          CALL      RASCSL1 
          BRANCH    OVRCD,KSCSLB80
          BRANCH    CKEYTYP,KSCSLB75
          CALL      RDSCSL1 
KSCSLB70
          MOVE      ZERO,EXIT
          GOTO      KSCSLB99
KSCSLB75
          MOVE      "Selection Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSCSLB00
KSCSLB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSCSLB99,KSCSLB99
          MOVE      "Selection Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSCSLB00
KSCSLB90
          MOVE      ONE,EXIT
          GOTO      KSCSLB99
KSCSLB95
          MOVE      TWO,EXIT
KSCSLB99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRSLTKY
.   Routine   :   HSCSLA00 Selection           
.   Return    :           
.-------------------------------------------------------------------------------
HSCSLA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSCSLA04 IF NOT EQUAL
          MOVE      "12",HTOP
          MOVE      "24",HBOT
          MOVE      "30",HLEF
          MOVE      "80",HRIG
          ENDIF
HSCSLA04
          CALL      GSCRN000
          BRANCH    EXIT,HSCSLA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Sel."               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "26",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Row/"               
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 4",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Column"             
.
          MOVE      STDCOL04,STDCOL05
          ADD       " 6",STDCOL05
HSCSLA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SCSLSEL 
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          PACK      SAVKEY80,SCSLPID,SCSLSID,SCSLSEL,SP70                       
          SETLPTR   SAVKEY80,10                                                 
          CALL      RSSCSL1 
HSCSLA10
          CALL      RKSCSL1 
          BRANCH    OVRCD,HSCSLA15
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSCSLA12
          CALL      HSCSLA60
          BRANCH    OVRCD,HSCSLA10
HSCSLA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY13,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SCSLSEL 
          DISPLAY   *PSTDCOL02:STDROW,SCSLDES 
          DISPLAY   *PSTDCOL03:STDROW,SCSLROW 
          DISPLAY   *PSTDCOL04:STDROW,SCSLCOL 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSCSLA10 IF NOT EQUAL
HSCSLA15
          UNPACK    SAVKEY80,SCSLPID,SCSLSID,SCSLSEL                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSCSLA20
          CALL      HSCRI000
          BRANCH    EXIT,HSCSLA30,HSCSLA35,HSCSLA40,HSCSLA45,HSCSLA04:
                              HSCSLA91,HSCSLA50
          GOTO      HSCSLA92
HSCSLA30
          CALL      RKSCSL1 
          BRANCH    OVRCD,HSCSLA85
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA85 IF NOT EQUAL                                       
          CALL      RPSCSL1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCSLA10
HSCSLA35
          MOVE      ST1,KEY13
          CALL      RDSCSL1 
          CALL      RPSCSL1 
          BRANCH    OVRCD,HSCSLA85
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA85 IF NOT EQUAL                                       
          MATCH     SP70,SCSLSEL                                                
          GOTO      HSCSLA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSCSLA36
          CALL      RPSCSL1 
          BRANCH    OVRCD,HSCSLA37
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCSLA36 IF NOT EQUAL
HSCSLA37
          MOVE      ZERO,XITEMNO
          GOTO      HSCSLA10
HSCSLA40
          MOVE      ST1,KEY13
          CALL      RDSCSL1 
          CALL      RPSCSL1 
          BRANCH    OVRCD,HSCSLA85
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCSLA08
HSCSLA45
          CALL      RKSCSL1 
          BRANCH    OVRCD,HSCSLA85
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY13,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSCSL1 
HSCSLA46
          CALL      RPSCSL1 
          BRANCH    OVRCD,HSCSLA47
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL,SP70                          
          MATCH     SAVKEY80,KEY13                                              
          GOTO      HSCSLA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCSLA46 IF NOT EQUAL
HSCSLA47
          MOVE      ZERO,XITEMNO
          GOTO      HSCSLA10
HSCSLA50  COMPARE   ZERO,CSEARCH
          GOTO      HSCSLA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCSLA08
HSCSLA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCSLA08
HSCSLA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSCSLA61 IF EQUAL
          MATCH     SCHFLD01,SCSLSEL 
          GOTO      HSCSLA72 IF NOT EQUAL
HSCSLA61
          MATCH     SP70,SCHFLD02
          GOTO      HSCSLA62 IF EQUAL
          MATCH     SCHFLD02,SCSLDES 
          GOTO      HSCSLA72 IF NOT EQUAL
HSCSLA62
          MATCH     SP70,SCHFLD03
          GOTO      HSCSLA63 IF EQUAL
          MATCH     SCHFLD03,SCSLROW 
          GOTO      HSCSLA72 IF NOT EQUAL
HSCSLA63
          MATCH     SP70,SCHFLD04
          GOTO      HSCSLA64 IF EQUAL
          MATCH     SCHFLD04,SCSLCOL 
          GOTO      HSCSLA72 IF NOT EQUAL
HSCSLA64
HSCSLA65
HSCSLA66
HSCSLA67
HSCSLA68
HSCSLA69
HSCSLA70
          GOTO      HSCSLA75
HSCSLA72  MOVE      ONE,OVRCD
HSCSLA75  RETURN
HSCSLA85
          LOAD      KEY13,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY13,SCSLPID,SCSLSID,SCSLSEL                               
          CALL      RDSCSL1 
HSCSLA90
          UNPACK    SAVKEY80,SCSLPID,SCSLSID,SCSLSEL                            
          BEEP
          GOTO      HSCSLA20
HSCSLA91
          MOVE      SP70,SCSLITM 
          MOVE      SP70,SCSLROW 
          MOVE      SP70,SCSLCOL 
          MOVE      SP70,SCSLDES 
          MOVE      SP70,SCSLSEC 
          MOVE      SP70,SCSLSPA 
          MOVE      SP70,KEY13
          MOVE      SP70,SCSLSEL 
          GOTO      HSCSLA96
HSCSLA92
          MOVE      SP70,KEY13
          MOVE      SP70,SCSLSEL 
          LOAD      KEY13,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY13,SCSLPID,SCSLSID,SCSLSEL                               
HSCSLA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSCSLA99
          RETURN
