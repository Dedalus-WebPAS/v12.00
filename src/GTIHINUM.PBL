.*****************************************************************************
.*                          GTIHINUM                                         *
.*        Get the IHI Number (active) for the specified UR                   *
.* Requires: PURNO - Patient U/R Number                                      *
.* Returns:  IHINUMBR - Active IHI Number                                    *
.*                                                                           *
.* V11.03.02   17/10/2023  Peter Vela    TSK 0935874                         *
.*             Added parameter check for pmsihiaf                            *
.* V11.03.01   10/10/2023  Peter Vela    TSK 0935874                         *
.*             Fixed IO calls for PMSIHIFD change                            *
.*****************************************************************************
.
GTIHINUM  PACK      IHINUMBR,SP70
.
          MATCH     "0",PTCNUNET
          GOTO      GETIHI99 IF EQUAL
.
          PACK      KEY46,PURNO,SP70
          CALL      RSPMIHI1
GETIHI10  CALL      RKPMIHI1
          BRANCH    OVRCD,GETIHI99
.
          MATCH     PURNO,PMIHURNO
          GOTO      GETIHI99 IF NOT EQUAL
.
          MATCH     "1",PMIHASTA            * Activated?
          GOTO      GETIHI10 IF NOT EQUAL   * no; get next record
.
          MATCH     "0",PMIHSTAT            * Active?
          GOTO      GETIHI10 IF NOT EQUAL   * no; get next record
.
          MOVE      PMIHIHIN,IHINUMBR
.
GETIHI99  RETURN
+
