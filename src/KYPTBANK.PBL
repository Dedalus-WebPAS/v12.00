.*************************************************************************
.* Routine Name  :  KYPTBANK
.* Description   :  IF PTCNUBNK & PTCNBANK flags are set, display message :
.*                    "banking has started. Do you wish to proceed?"
.*
.* Author        :  Glenn Berry
.* Date          :  07/07/1993
.*
.* Returns       :  EXIT      = 0  - Proceed
.*                            = 1  - Do not proceed
.* Variables to
.* be defined    :  PTCNUBNK  FORM   1   
.*                  PTCNBANK  FORM   1
.*                  DIM1      DIM    1
.*
.* open files    :  CONTROLF
.*
.*        V9.02.01  11/11/2002 J.Tan 
.*                  Fixed reading controlf file
.*        V6.00.01  07/12/1993  Graeme Williams
.*                  Fixed minor display problem with message
.*
.*************************************************************************
KYPTBANK  MOVE      ZERO,EXIT
.
          READ      CONTROLF,HUND05;*191,PTCNBANK,*192,PTCNUBNK
.
          BRANCH    PTCNUBNK,KYPTBK00        
          GOTO      KYPTBK99                 * not using the message
.
KYPTBK00  BRANCH    PTCNBANK,KYPTBK10        
          GOTO      KYPTBK99                 * flag not set
.
KYPTBK10  KEYIN     *P1:24,*EL,*B,"The banking has started.  Are you sure you ":
                            "want to proceed (",*V2LON,"Y",*HOFF,"/",*V2LON,"N":
                            *HOFF,") ? ",*V2LON,DIM1
.
          REP       "yY",DIM1
          MATCH     "Y",DIM1
          GOTO      KYPTBK95 IF EQUAL
.
KYPTBK90  MOVE      ONE,EXIT
.
KYPTBK95  DISPLAY   *P1:24,*EL               * clear message line
.
KYPTBK99  RETURN
+
