.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.03.01  01.07.2003  Davin Sloan Quote 15040
.           delivery point only mandatory if using MDPs
.-------------------------------------------------------
. V9.02.02  24.04.2003  Davin Sloan Quote 15040
.           Modified validation of delivery point
. V9.02.01  18.03.2003  Davin Sloan Quote 15040
.           Modified program for Multiple Delivery Points
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 20.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.01  18.07.2000 Charles Handaya
.           Recompiled for SINBACIO change
.           Related to Quote 9817
.-------------------------------------------------------
. VF.00.04  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.03  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
. VF.00.02  10.08.1999 Sandra Barcham
.           Allow to run by category ia1 for MHG
. VF.00.01  14.06.1999 Sandra Barcham
.           Print 2 years usage etc for MHG
.-------------------------------------------------------
AVGCURR   FORM      12.2
AVGPREV   FORM      12.2
CURRPER   FORM      2
F12       FORM      12
FORMCRT   DIM       12
PERDES1   DIM       1
PERDES2   DIM       1
PERDES3   DIM       1
PERDES4   DIM       1
PERDES5   DIM       1
PERDES6   DIM       1
PERDES7   DIM       1
PERDES8   DIM       1
PERDES9   DIM       1
PERDES10  DIM       1
PERDES11  DIM       1
PERDES12  DIM       1
PERDESC   DIM       1
ORDQTY    FORM      12.2
QTYF8P6   FORM      8.6
SECSIWS   FORM      1
USECURR   FORM      12.2
USEDAT    DIM       6
USEDAT1   DIM       6
USEDAT2   DIM       6
USEDAT3   DIM       6
USEDAT4   DIM       6
USEDAT5   DIM       6
USEDAT6   DIM       6
USEDAT7   DIM       6
USEDAT8   DIM       6
USEDAT9   DIM       6
USEDAT10  DIM       6
USEDAT11  DIM       6
USEDAT12  DIM       6
USEDAT13  DIM       6
USEDAT14  DIM       6
USEDAT15  DIM       6
USEDAT16  DIM       6
USEDAT17  DIM       6
USEDAT18  DIM       6
USEDAT19  DIM       6
USEDAT20  DIM       6
USEDAT21  DIM       6
USEDAT22  DIM       6
USEDAT23  DIM       6
USEDAT24  DIM       6
USEPER    FORM      12.2
USEPREV   FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN52
.   Function      :   Create/Print Suggested Stock Purchases  
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       IBAGEDFD/INC
          INC       IBAGSTFD/INC
          INC       SINBACFD/INC
          INC       SINCGAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIBFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCIEFD/INC
          INC       SINCIHFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINDPCFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINORIFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINSCDFD/INC
          INC       SINSCMFD/INC
          INC       SINSODFD/INC
          INC       SINSOMFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMCOMM  DIM      46 * Scr 00 Fld     7
TOCOMM    DIM      46 * Scr 00 Fld     8
FROMPROD  DIM      36 * Scr 00 Fld     9
TOPROD    DIM      36 * Scr 00 Fld    10
FROMSUPP  DIM      36 * Scr 00 Fld    11
TOSUPP    DIM      36 * Scr 00 Fld    12
MESSDESC  DIM      30 * Scr 00 Fld    21
DELVDESC  DIM      40 * Scr 00 Fld    22
INCDESC   DIM      15 * Scr 00 Fld    23
DELVCODE  DIM       3 * Scr 00 Fld    25
DELVDSC2  DIM      40 * Scr 00 Fld    26
SOQDESC   DIM      30 * Scr 00 Fld    35
PAGEBRK   FORM      1 * Scr 00 Fld    36
FROMIA1   DIM      36 * Scr 00 Fld    37
TOIA1     DIM      36 * Scr 00 Fld    38
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN52"
PRGNAM    INIT      "Create/Print Suggested Stock Purchases  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening ibagedaf";
          OPEN      IBAGEDA1,"ibagedaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA3,"ibagstaf"
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA3,"sinbacaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincibaf";
          OPEN      SINCIBA1,"sincibaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA1,"sincihaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA2,"sincihaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sindpcaf";
          OPEN      SINDPCA1,"sindpcaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA8,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsodaf";
          OPEN      SINSODA1,"sinsodaf"
          DISPLAY   *P56:24,"Opening sinsodaf";
          OPEN      SINSODA2,"sinsodaf"
          DISPLAY   *P56:24,"Opening sinsomaf";
          OPEN      SINSOMA1,"sinsomaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RDLCC000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,SIOMSID 
          MOVE      SP70,SIOMDES 
          MOVE      ZERO,SIOMPER 
          MOVE      SP70,SIOMORG 
          MOVE      SP70,SIOMDEL 
          MOVE      SP70,SIOMMES 
          MOVE      SP70,FROMCOMM
          MOVE      SP70,TOCOMM  
          MOVE      SP70,FROMPROD
          MOVE      SP70,TOPROD  
          MOVE      SP70,FROMSUPP
          MOVE      SP70,TOSUPP  
          MOVE      SP70,SIOMWAR 
          MOVE      SP70,SIWADES 
          MOVE      SP70,SIOMUID 
          MOVE      SP70,SIOMPOR 
          MOVE      SP70,SIOMTIM 
          MOVE      SP70,SIOMDAT 
          MOVE      ZERO,SIOMINC 
          MOVE      SP70,SIORNAME
          MOVE      SP70,MESSDESC
          MOVE      SP70,DELVDESC
          MOVE      SP70,INCDESC 
          MOVE      SP70,SIOMMDP 
          MOVE      SP70,DELVCODE
          MOVE      SP70,DELVDSC2
          MOVE      SP70,SIOMSOQ 
          MOVE      SP70,SOQDESC 
          MOVE      ZERO,PAGEBRK 
          MOVE      SP70,FROMIA1 
          MOVE      SP70,TOIA1   
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMUID 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMPOR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMTIM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOMDAT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ESID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      SIOMSID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOMUID,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOMPOR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOMTIM,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    SIOMDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L124,PS00L125,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L126,PS00L127,PS00L128:
                            PS00L129,PS00L130
          GOTO     PS00L999
.
PS00L101
          MOVE      SIOMDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SIOMPER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SIOMORG,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SIOMDEL,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SIOMMES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      FROMCOMM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      TOCOMM,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      FROMPROD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      TOPROD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      FROMSUPP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      TOSUPP,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SIOMWAR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      SIOMUID,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      SIOMPOR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      SIOMTIM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          UNPACK    SIOMDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      SIOMINC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      DELVDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      INCDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      SIOMMDP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          CALL      CMDP0000
          MOVE      DELVCODE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      DELVDSC2,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      SIOMSOQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      SOQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PAGEBRK,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      FROMIA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      TOIA1,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L006:
                            SF00L107,SF00L006,SF00L108,SF00L006:
                            SF00L109,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L110,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L111:
                            SF00L112,SF00L006,SF00L006,SF00L113:
                            SF00L114,SF00L006,SF00L115,SF00L116:
                            SF00L117,SF00L118,SF00L006,SF00L119:
                            SF00L120,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L020:
                            SF00L107,SF00L020,SF00L108,SF00L020:
                            SF00L109,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L110,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L111:
                            SF00L112,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L118,SF00L020,SF00L119:
                            SF00L120,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          STRIP     SIOMDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIOMDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIOMDES 
          SFORMAT   VAR,127
          ENDSET    SIOMDES 
          APPEND    SP70,SIOMDES 
          RESET     SIOMDES 
          CMATCH    EXITCHAR,SIOMDES 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIOMDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
          ENDIF
          MOVE      SIOMDES,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIOMPER 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIOMPER 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
          ENDIF
          MOVE      SIOMPER,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,SIOMORG
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIOMORG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          STRIP     SIOMDEL 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIOMDEL,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIOMDEL 
          SFORMAT   VAR,127
          ENDSET    SIOMDEL 
          APPEND    SP70,SIOMDEL 
          RESET     SIOMDEL 
          CMATCH    EXITCHAR,SIOMDEL 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIOMDEL 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
          ENDIF
          MOVE      SIOMDEL,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,MESSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMESS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIOMMES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      MESSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCOMM  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOMM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMCOMM,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCOMM,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPROD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPROD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMPROD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPROD,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOSUPP  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUPP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMSUPP,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOSUPP,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIWA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIOMWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L110
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,INCDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECONT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
            BRANCH    EXIT,SF00L110,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIOMINC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      INCDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          STRIP     SIOMMDP 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIOMMDP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIOMMDP 
          SFORMAT   VAR,127
          ENDSET    SIOMMDP 
          APPEND    SP70,SIOMMDP 
          RESET     SIOMMDP 
          CMATCH    EXITCHAR,SIOMMDP 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIOMMDP 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
          ENDIF
          MOVE      SIOMMDP,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DELVDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DELVDSC2
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDELV000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
            BRANCH    EXIT,SF00L112,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          CALL      CMDP0000
          MOVE      DELVCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DELVDESC,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DELVDSC2,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L113
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRINT000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L114
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CLRGEN00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L115
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L116
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GENER000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L117
          CALL      UUSIOM1 
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L118
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SOQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESOQC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L118
            ENDIF
            BRANCH    EXIT,SF00L118,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIOMSOQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SOQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L119
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PAGEBRK 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PAGEBRK,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L120
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOIA1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EIA10000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L120
            ENDIF
            BRANCH    EXIT,SF00L120,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMIA1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOIA1,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.------------------------------------------------------
. Read Controlf File
.------------------------------------------------------------------
RDLCC000  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TWENTY6;*248,HPURCHP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*36,SNCOCCOM
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,SNCOCCOM
            WRITAB    CONTROLF,SIXTY3;*36,SNCOCCOM
          ENDIF
.
          MOVE      "   ",SIOMFIA
          MOVE      "~~~",SIOMTIA
          CALL      CSIWS000                  * check warehouse security
.
RDLCC999  RETURN
.----------------------------------------------------------------------
. Check warehouse security
. Returns SECSIWS : 0 = no access to any warehouse
.                   1 = access to one warehouse
.                   2 = access to more than one warehouse
.                   3 = access to all warehouse(Not Applicable - for future use)
.----------------------------------------------------------------------
..                                            * (for future use)
..CSIWS000  MOVE      "3",SECSIWS             * default to all warehouse's
.
..          PACK      KEY9,SP70               * any security set up ???
..          CALL      RSSIWS1
..          CALL      RKSIWS1
..          BRANCH    OVRCD,CSIWS999
.
CSIWS000  MOVE      "0",SECSIWS             * check for no warehouse's
          PACK      KEY9,PASSCODE,SP70
          CALL      RSSIWS1
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "1",SECSIWS             * check for one warehouse's
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "2",SECSIWS             * more than one warehouse
.
CSIWS999  RETURN
.
CMDP0000  READ      CONTROLF,SIXTY3;*241,SNCOMDPC
          COMPARE   ONE,SNCOMDPC
          IF        @EQUAL
            MOVE      SIOMMDP,KEY3
            CALL      RDSIDP1
            IF        OVRCD<>1
              MOVE      SIOMMDP,DELVCODE
              MOVE      SIDPADD1,DELVDESC
              MOVE      SIDPADD2,DELVDSC2
            ENDIF
          ELSE
            MOVE      SIOMDEL,DELVCODE
          ENDIF
CMDP9999  RETURN
.
ESID0000  COMPARE   ZERO,SECSIWS
          GOTO      ESID9000 IF EQUAL
.
          CALL      KSIOMA00
          BRANCH    EXIT,ESID9999,ESID9999
.
          READ      CONTROLF,TWENTY5;HADEL1,HADEL2,HADEL3,HADEL4:
                                     HADEL5,HADEL6,HADEL7,HADEL8
          COMPARE   ONE,OVRCD
          GOTO      ESID0900 IF EQUAL
.
ESID0100  MOVE      SIOMSID,KEY3
          CALL      RLSIOM1
          BRANCH    OVRCD,ESID9999,ESID0200
          MOVE      SIOMORG,KEY3
          CALL      RDSIOR1
          MOVE      SIOMDEL,F1
          LOAD      DELVDESC,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                HADEL5,HADEL6,HADEL7,HADEL8
.
. check warehouse security
.
          MATCH     SP70,SIOMWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIOMWAR,SP70
            CALL      RDSIWS1
            IF        OVRCD=1
              CLEAR     DISPMSG
              APPEND    "You have no access for Warehouse ",DISPMSG
              APPEND    SIOMWAR,DISPMSG
              APPEND    " - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      ESID9999
            ENDIF
          ENDIF
.
          MOVE      SIOMWAR,KEY5
          CALL      RDSIWA1
.
          PACK      MESSDESC,SP70
          MATCH     SP70,SIOMMES
          IF        !@EQUAL
            PACK      KEY6,ANSM,ANSE,SP1,SIOMMES
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,MESSDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,FROMCOMM
          MOVE      SP70,TOCOMM
          MOVE      SP70,FROMPROD
          MOVE      SP70,TOPROD
          MOVE      SP70,FROMSUPP
          MOVE      SP70,TOSUPP
          MOVE      SP70,FROMIA1
          MOVE      SP70,TOIA1
.
          CALL      SIDFT000
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ESID9999
.
ESID0200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ESID0100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ESID0000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ESID0200 IF NOT EQUAL
          GOTO      ESID0000
.
ESID0900  PACK      SIOMDAT,CCC,CYY,CMM,CDD
          REP       " 0",SIOMDAT
          CLOCK     TIME,SIOMTIM
          MOVE      PORT,SIOMPOR
          MOVE      PASSCODE,SIOMUID
          GOTO      ESID9999
.
ESID9000  MOVE      "You have no access for All Warehouses - ",DISPMSG
          CALL      MESSAGE1
          GOTO      ESID9999
.
ESID9999  RETURN
.
SIDFT000  MATCH     SP70,SIOMFCO
          IF        @EQUAL
            MOVE      "Start",FROMCOMM
          ELSE
            MOVE      SIOMFCO,KEY6                                     *C-59696
            CALL      RDSIGA1
            PACK      FROMCOMM,KEY6,SP1,SIGADES                        *C-59696
          ENDIF
.
          MATCH     Z70,SIOMTCO
          IF        @EQUAL
            MOVE      "Finish",TOCOMM
          ELSE
            MOVE      SIOMTCO,KEY6                                     *C-59696
            CALL      RDSIGA1
            PACK      TOCOMM,KEY6,SP1,SIGADES                          *C-59696
          ENDIF
.
          MATCH     SP70,SIOMFPG
          IF        @EQUAL
            MOVE      "Start",FROMPROD
          ELSE
            MOVE      SIOMFPG,KEY5
            CALL      RDSISA1
            PACK      FROMPROD,KEY5,SP1,SISADESC
          ENDIF
.
          MATCH     Z70,SIOMTPG
          IF        @EQUAL
            MOVE      "Finish",TOPROD
          ELSE
            MOVE      SIOMTPG,KEY5
            CALL      RDSISA1
            PACK      TOPROD,KEY5,SP1,SISADESC
          ENDIF
.
          MATCH     SP70,SIOMFSU
          IF        @EQUAL
            MOVE      "Start",FROMSUPP
          ELSE
            MOVE      SIOMFSU,KEY5
            CALL      RDAPMA1
            PACK      FROMSUPP,KEY5,SP1,APMASN1
          ENDIF
.
          MATCH     Z70,SIOMTSU
          IF        @EQUAL
            MOVE      "Finish",TOSUPP
          ELSE
            MOVE      SIOMTSU,KEY5
            CALL      RDAPMA1
            PACK      TOSUPP,KEY5,SP1,APMASN1
          ENDIF
.
          MATCH     SP70,SIOMFIA
          IF        @EQUAL
            MOVE      "Start",FROMIA1
          ELSE
            MOVE      "ia1",KEY3
            PACK      KEY6,KEY3,SIOMFIA
            CALL      RDSICD1
            PACK      FROMIA1,SICDCODE,SP1,SICDDESC
          ENDIF
.
          MATCH     Z70,SIOMTIA
          IF        @EQUAL
            MOVE      "Finish",TOIA1
          ELSE
            MOVE      "ia1",KEY3
            PACK      KEY6,KEY3,SIOMTIA
            CALL      RDSICD1
            PACK      TOIA1,SICDCODE,SP1,SICDDESC
          ENDIF
.
         BRANCH    SIOMINC,SIDFT100,SIDFT200,SIDFT300
.
SIDFT100 MOVE      "All",INCDESC
         GOTO      SIDFT500
SIDFT200 MOVE      "Contract Only",INCDESC
         GOTO      SIDFT500
SIDFT300 MOVE      "Non-Contract Only",INCDESC
         GOTO      SIDFT500
.
SIDFT500 MOVE      SIOMSOQ,F1
         BRANCH    F1,SIDFT510,SIDFT520
SIDFT510 MOVE      "ROQ+ROL-SOH-SOO+SOB",SOQDESC
         GOTO      SIDFT999
SIDFT520 MOVE      "ROQ Only",SOQDESC
         GOTO      SIDFT999
.
SIDFT999 RETURN
.----------------------------------------------
. Enter Message Code
.----------------------------------------------
EMESS000  MOVE        ZERO,CKEYTYP
          MOVE        "ME ",SICDCATA
          MOVE        SP70,MESSDESC
          CALL        KIMESS00
          BRANCH      EXIT,EMESS999,EMESS999
          MOVE        SICDCODE,SIOMMES
          MOVE        SICDDESC,MESSDESC
.
EMESS999  RETURN
.
KIMESS00 TOPIC     "SICDCODE"
          MOVE      SIORMESS,SICDCODE
          STRIP     SICDCODE
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SICDCODE:
                    *PCCOL:CVERT,*DV,SICDCODE
.
          PACK      SICDCODE,SICDCODE,SP70
.
          MATCH     SP70,SICDCODE
          GOTO      KIMESS90 IF EQUAL
.
          CMATCH    EXITCHAR,SICDCODE
          GOTO      KIMESS95 IF EQUAL
.
          CMATCH    QUEST,SICDCODE
          GOTO      KIMESS10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSICDB00
          MOVE      SCCITEM,CCITEM
          PACK      SICDCODE,SICDCODE,SP70
          MATCH     SP70,SICDCODE
          GOTO      KIMESS00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SICDCODE
KIMESS10
          PACK      KEY6,SICDCATA,SICDCODE
          CALL      RASICD1
          BRANCH    OVRCD,KIMESS80
          BRANCH    CKEYTYP,KIMESS75
          CALL      RDSICD1
KIMESS70
          MOVE      ZERO,EXIT
          GOTO      KIMESS99
KIMESS75
          MOVE      "Code Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KIMESS00
KIMESS80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KIMESS99,KIMESS99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KIMESS00
KIMESS90
          MOVE      ONE,EXIT
          GOTO      KIMESS99
KIMESS95
          MOVE      TWO,EXIT
KIMESS99  TOPIC    PRGID
          RETURN
.
ECOMM000  IF       ACCEPT=1
            MOVE     SP70,SIOMFCO
            MOVE     Z70,SIOMTCO
            MOVE     "Start",FROMCOMM
            MOVE     "Finish",TOCOMM
            MOVE     ZERO,EXIT
            GOTO     ECOMM999
          ENDIF
.
          MOVE     "    7",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          CALL     KSIGAA00
          BRANCH   EXIT,ECOMM100,ECOMM999
          MOVE     SIGACOD,SIOMFCO
          PACK     FROMCOMM,SIGACOD,SP1,SIGADES
          GOTO     ECOMM200
ECOMM100  MOVE     SP70,FROMCOMM
          MOVE     SP70,SIOMFCO
          MOVE     "Start",FROMCOMM
ECOMM200  MOVE     FROMCOMM,VAR
          CALL     DISPITEM
.
ECOMM300  MOVE     "    8",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          CALL     KSIGAA00
          BRANCH   EXIT,ECOMM400,ECOMM999
          MOVE     SIGACOD,SIOMTCO
          PACK     TOCOMM,SIGACOD,SP1,SIGADES
          MATCH    SIOMFCO,SIOMTCO
          GOTO     ECOMM500 IF NOT LESS
          MOVE     "To Group Must be Greater Than From Group - ",DISPMSG
          CALL     MESSAGE1
          GOTO     ECOMM000
ECOMM400  MOVE     SP70,TOCOMM
          MOVE     Z70,SIOMTCO
          MOVE     "Finish",TOCOMM
ECOMM500  MOVE     TOCOMM,VAR
          CALL     DISPITEM
          MOVE     "    7",FLDID
          CALL     GETPOSIT
ECOMM999  RETURN
EPROD000  IF       ACCEPT=1
            MOVE     SP70,SIOMFPG
            MOVE     Z70,SIOMTPG
            MOVE     "Start",FROMPROD
            MOVE     "Finish",TOPROD
            MOVE     ZERO,EXIT
            GOTO     EPROD999
          ENDIF
.
          MOVE     "    9",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          CALL     KSISAA00
          BRANCH   EXIT,EPROD100,EPROD999
          MOVE     SISACODE,SIOMFPG
          PACK     FROMPROD,SISACODE,SP1,SISADESC
          GOTO     EPROD200
EPROD100  MOVE     SP70,FROMPROD
          MOVE     SP70,SIOMFPG
          MOVE     "Start",FROMPROD
EPROD200  MOVE     FROMPROD,VAR
          CALL     DISPITEM
.
EPROD300  MOVE     "   10",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          CALL     KSISAA00
          BRANCH   EXIT,EPROD400,EPROD999
          MOVE     SISACODE,SIOMTPG
          PACK     TOPROD,SISACODE,SP1,SISADESC
          MATCH    SIOMFPG,SIOMTPG
          GOTO     EPROD500 IF NOT LESS
          MOVE     "To Group Must be Greater Than From Group - ",DISPMSG
          CALL     MESSAGE1
          GOTO     EPROD000
EPROD400  MOVE     SP70,TOPROD
          MOVE     Z70,SIOMTPG
          MOVE     "Finish",TOPROD
EPROD500  MOVE     TOPROD,VAR
          CALL     DISPITEM
          MOVE     "    9",FLDID
          CALL     GETPOSIT
EPROD999  RETURN
ESUPP000  IF       ACCEPT=1
            MOVE     SP70,SIOMFSU
            MOVE     Z70,SIOMTSU
            MOVE     "Start",FROMSUPP
            MOVE     "Finish",TOSUPP
            MOVE     ZERO,EXIT
            GOTO     ESUPP999
          ENDIF
.
          MOVE     "   11",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          CALL     KAPMAA00
          BRANCH   EXIT,ESUPP100,ESUPP999
          MOVE     APMACRD,SIOMFSU
          PACK     FROMSUPP,APMACRD,SP1,APMASN1
          GOTO     ESUPP200
ESUPP100  MOVE     SP70,FROMSUPP
          MOVE     SP70,SIOMFSU
          MOVE     "Start",FROMSUPP
ESUPP200  MOVE     FROMSUPP,VAR
          CALL     DISPITEM
.
ESUPP300  MOVE     "   12",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          CALL     KAPMAA00
          BRANCH   EXIT,ESUPP400,ESUPP999
          MOVE     APMACRD,SIOMTSU
          PACK     TOSUPP,APMACRD,SP1,APMASN1
          MATCH    SIOMFSU,SIOMTSU
          GOTO     ESUPP500 IF NOT LESS
          MOVE     "To Supplier Must be Greater Than From Supplier - ",DISPMSG
          CALL     MESSAGE1
          GOTO     ESUPP000
ESUPP400  MOVE     SP70,TOSUPP
          MOVE     Z70,SIOMTSU
          MOVE     "Finish",TOSUPP
ESUPP500  MOVE     TOSUPP,VAR
          CALL     DISPITEM
          MOVE     "   11",FLDID
          CALL     GETPOSIT
ESUPP999  RETURN
.----------------------------------------------------------------------
. Keyin SIWA
.----------------------------------------------------------------------
KSIWA000
          CALL      KSIWSA00                     * keyin SIWA with security
          BRANCH    EXIT,KSIWA950,KSIWA950
.
          REP       " 0",SIWANPO
          MATCH     "0000000",SIWANPO
          IF        @EQUAL
            CLEAR     DISPMSG
            APPEND    "Warehouse May Not Have Purchase Orders - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KSIWA000
          ENDIF
.
KSIWA900  MOVE      ZERO,EXIT
          MOVE      SIWAWAR,SIOMWAR
          GOTO      KSIWA999
.
KSIWA950  MOVE      TWO,EXIT
.
KSIWA999  RETURN
ECONT000 IF        ACCEPT=1
           MOVE      ONE,SIOMINC
         ENDIF
         MOVE      SP70,DISPMSG
         CALL      MESSAGE2
ECONT010 DISPLAY   *P1:24,*EL,*V2LON,"1. ",*HOFF,"Include All, ":
                   *V2LON,"2. ",*HOFF,"Contract Only, ":
                   *V2LON,"3. ",*HOFF,"Non-Contract Only"
         KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SIOMINC
         BRANCH    SIOMINC,ECONT100,ECONT200,ECONT300
         BEEP
         GOTO      ECONT010
ECONT100 MOVE      "All",INCDESC
         GOTO      ECONT999
ECONT200 MOVE      "Contract Only",INCDESC
         GOTO      ECONT999
ECONT300 MOVE      "Non-Contract Only",INCDESC
         GOTO      ECONT999
ECONT999 CALL      MESSAGE3
         RETURN
.
EDELV000  READ      CONTROLF,SIXTY3;*241,SNCOMDPC
          COMPARE   ONE,SNCOMDPC
          IF        @EQUAL
            CALL        MDPC0000            * using Multiple Delivery Points
            GOTO        EDELV999
          ENDIF
.
          PACK      DELVCODE,SP70
          MOVE      SIORDEL,F1
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,F1
          MOVE      F1,SIOMDEL
          BRANCH    F1,EDELV100,EDELV100,EDELV100,EDELV100:
                       EDELV100,EDELV100,EDELV100,EDELV100
          BEEP
          GOTO      EDELV000
.
EDELV100  IF        HPURCHP=16
           MOVE       F1,SIOMDEL
           IF         F1 >=1 & F1 <9
             LOAD       DELVDESC,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                    HADEL5,HADEL6,HADEL7,HADEL8
             GOTO       EDELV999
           ELSE
             MOVE       "0",SIOMDEL
             PACK       DELVDESC,HADEL3,SP70
             GOTO       EDELV999
           ENDIF
          ENDIF
.
          MOVE      SIOMDEL,DELVCODE
          LOAD      DELVDESC,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                HADEL5,HADEL6,HADEL7,HADEL8
EDELV999  RETURN
.
MDPC0000  MOVE     ZERO,CKEYTYP
          CALL     KSIDPA00
          BRANCH   EXIT,MDPC9999,MDPC9999
          COMPARE  ONE,OVRCD
          GOTO     MDPC9999 IF EQUAL
.
MDPC1000  MOVE      SIDPCODE,KEY3
          CALL      RDSIDP1
          BRANCH    OVRCD,MDPC9999
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          MOVE      SIDPCODE,SIOMMDP
          MOVE      SIOMMDP,DELVCODE
          MOVE      SIDPADD1,DELVDESC
          MOVE      SIDPADD2,DELVDSC2
          PACK      SIOMDEL,SP70
.
MDPC9999  RETURN
.
.---------------------------------------------------------------
. Print Suggested Re-Order Report
.---------------------------------------------------------------
PRINT000  MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,F5
          MOVE      SP70,LASTSUPP
          MOVE      ZERO,TOTALORD
.
          PACK      SIPEDATE,CCC,CYY,CMM,CDD,SP70
          REP       " 0",SIPEDATE
          CALL      RSIPE000
          MOVE      SIPEPER,CURRPER
.
          CALL      RINPECON
          MOVE      TWENTY4,COUNT
          MOVE      SNCODFYR,F4
          ADD       ONE,F4
          PACK      KEY6,F4,SP70
          CALL      RSSIPE1
.
PRINT020  CALL      RPSIPE1
          BRANCH    OVRCD,PRINT050
          PACK      DIM6,SIPEYEAR,SIPEPER
     STORE     DIM6,COUNT,USEDAT1,USEDAT2,USEDAT3,USEDAT4,USEDAT5,USEDAT6:
                          USEDAT7,USEDAT8,USEDAT9,USEDAT10,USEDAT11,USEDAT12:
                          USEDAT13,USEDAT14,USEDAT15,USEDAT16,USEDAT17,USEDAT18:
                          USEDAT19,USEDAT20,USEDAT21,USEDAT22,USEDAT23,USEDAT24
          MOVE      SIPEPER,FORM2
          LOAD      PERDESC,FORM2,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                                  HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12
          STORE     PERDESC,COUNT,PERDES1,PERDES2,PERDES3,PERDES4,PERDES5:
                                  PERDES6,PERDES7,PERDES8,PERDES9,PERDES10:
                                  PERDES11,PERDES12
          SUB       ONE,COUNT
          COMPARE   ZERO,COUNT
          GOTO      PRINT020 IF NOT EQUAL
.
PRINT050  DISPLAY   *P1:24,*EL
          PACK      KEY20,SIOMSID,SP70
          CALL      RSSIOD2
.
PRINT100  CALL      RKSIOD2
          BRANCH    OVRCD,PRINT900
          MATCH     SIOMSID,SIODSID
          GOTO      PRINT900 IF NOT EQUAL
          ADD       ONE,F5
          DISPLAY   *P1:24,"Printing : ",SIODSUP
          MATCH     SP70,LASTSUPP
          IF        @EQUAL
            MOVE      SIODSUP,LASTSUPP
            CALL      HEAD0000
          ENDIF
          MATCH     SIODSUP,LASTSUPP
          IF        !(@EQUAL)
            CALL      TAIL0000
            MOVE      ZERO,TOTALORD
            MOVE      SIODSUP,LASTSUPP
            CALL      HEAD0000
          ENDIF
          COMPARE   "50",CLNO
          CALL      HEAD0000 IF NOT LESS
.
. Print Details
.
          PACK      KEY12,SIODCAT,SIODWAR
          CALL      RDSIIE1
.
          MOVE      SIODCAT,KEY7
          CALL      RDSIIA1
.
          PACK      KEY27,SIODCAT,SIODSUP,SIODSUT
          CALL      RDSIIC1
          IF        OVRCD=1
            MOVE      "Catalog/Supplier/Supply Unit Not on File",SIICPD1
            MOVE      SP70,SIICPD2
          ENDIF
.
          PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
.
          MOVE      "9,999,999",KEY9
          ASSIGN    SIODQTY*SIFACTOR,ORDQTY
.          MOVE      SIODQTY,ORDQTY
.          ASSIGN    SIODQTY/SIFACTOR,F12P2
          MOVE      SIODQTY,F12P2
          MOVE      F12P2,QTYFORM8
          FEDIT     QTYFORM8,KEY9
          MOVE      "9,999,999.9999",KEY14
          FEDIT     SIODCST,KEY14
          MOVE      "9999,999,999.99",KEY15
          ASSIGN    QTYFORM8*SIODCST,F12P2
          FEDIT     F12P2,KEY15
          ADD       F12P2,TOTALORD
          PRINT     SIICCAT,SP1,SIICPNO,*41,SIODSUT,*57,SIIAISS,SP1,SIFACTOR:
                    *93,KEY9,*104,KEY14,KEY15
          ADD       ONE,CLNO
.
          MATCH     SP70,SIODCON
          GOTO      PRINT500 IF EQUAL
.
          MOVE      SIODCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,PRINT500
          PACK      KEY45,SIODCON,SIODSUP,SIODCAT,SIODCDT,SIODSUT
          CALL      RDSISD1
          BRANCH    OVRCD,PRINT500
.
          PRINT     *9,SIICPD1,"  Contract : ",SIODCON,SP1,SISCDES
          PRINT     *9,SIICPD2,"   ",SISDPO1
          ADD       TWO,CLNO
          MATCH     SP70,SISDPO2
          IF        !(@EQUAL)
            PRINT     *72,SISDPO2
            ADD       ONE,CLNO
          ENDIF
          GOTO      PRINT600
.
PRINT500  PRINT     *9,SIICPD1
          ADD       ONE,CLNO
          MATCH     SP70,SIICPD2
          IF        !(@EQUAL)
            PRINT     *9,SIICPD2
            ADD       ONE,CLNO
          ENDIF
.
PRINT600  CALL      BOCAL000
          CALL      OOCAL000
          MOVE      "9,999,999.99",FORMSOH
          MOVE      "9,999,999.99",FORMSOO
          MOVE      "9,999,999.99",FORMROQ
          MOVE      "9,999,999.99",FORMROL
          MOVE      "9,999,999.99",FORMSOB
          MOVE      "9,999,999.99",FORMCRT
          FEDIT     SIIESOH,FORMSOH
          FEDIT     TOTALSOO,FORMSOO
          FEDIT     SIIEROQ,FORMROQ
          FEDIT     SIIEROL,FORMROL
          FEDIT     TOTALSOB,FORMSOB
          SUB       SIIEROQ,ORDQTY
          FEDIT     ORDQTY,FORMCRT
.
          PRINT     *7," SOH: ",FORMSOH:
                       " SOO: ",FORMSOO:
                       " ROQ: ",FORMROQ:
                       " ROL: ",FORMROL:
                       " SOB: ",FORMSOB:
                       " CRT: ",FORMCRT:
                       " ABC: ",SIIEABC
          ADD       ONE,CLNO
.
          MOVE      ONE,COUNT
          MOVE      ZERO,USEPER
          PRINT     *N,"    Previous Year ";
.
PRINT640  LOAD      USEDAT,COUNT,USEDAT1,USEDAT2,USEDAT3,USEDAT4,USEDAT5:
                                 USEDAT6,USEDAT7,USEDAT8,USEDAT9,USEDAT10:
                                 USEDAT11,USEDAT12
          LOAD      PERDESC,COUNT,PERDES1,PERDES2,PERDES3,PERDES4,PERDES5:
                                  PERDES6,PERDES7,PERDES8,PERDES9,PERDES10:
                                  PERDES11,PERDES12
          MOVE      ZERO,SIIHUQT
          PACK      KEY18,SIIACAT,SIODWAR,USEDAT,SP70
          CALL      RDSIIH1
          MOVE      SIIHUQT,F6
          PRINT     PERDESC,":",F6," ";
          ADD       SIIHUQT,USEPER
          MOVE      USEPER,USEPREV
          ADD       ONE,COUNT
          COMPARE   TEN3,COUNT
          GOTO      PRINT640 IF LESS
.
          DIV       TEN2,USEPER
          MOVE      USEPER,AVGPREV
          PRINT     " "
          ADD       TWO,CLNO
          MOVE      ZERO,USEPER
          MOVE      ONE,COUNT
          PRINT     "    Current  Year ";
.
PRINT650  LOAD      USEDAT,COUNT,USEDAT13,USEDAT14,USEDAT15,USEDAT16,USEDAT17:
                                 USEDAT18,USEDAT19,USEDAT20,USEDAT21,USEDAT22:
                                 USEDAT23,USEDAT24
          LOAD      PERDESC,COUNT,PERDES1,PERDES2,PERDES3,PERDES4,PERDES5:
                                  PERDES6,PERDES7,PERDES8,PERDES9,PERDES10:
                                  PERDES11,PERDES12
          MOVE      ZERO,SIIHUQT
          PACK      KEY18,SIIACAT,SIODWAR,USEDAT,SP70
          CALL      RDSIIH1
          MOVE      SIIHUQT,F6
          PRINT     PERDESC,":",F6," ";
          ADD       SIIHUQT,USEPER
          MOVE      USEPER,USECURR
          ADD       ONE,COUNT
          COMPARE   TEN3,COUNT
          GOTO      PRINT650 IF LESS
.
          DIV       CURRPER,USEPER
          MOVE      USEPER,AVGCURR
          PRINT     " "
          ADD       ONE,CLNO
.
          PRINT     *N,*4," Previous Total: ",USEPREV:
                       " Previous Avg.: ",AVGPREV:
                       " Current Total: ",USECURR:
                       " Current Avg.: ",AVGCURR,*N
          ADD       THREE,CLNO
.
          COMPARE   ZERO,SNCOCCOM
          GOTO      PRINT730 IF EQUAL
.
          MOVE      ZERO,COUNT
          PACK      KEY10,SIIACAT,SP70
          CALL      RSSIIB1
PRINT700  CALL      RKSIIB1
          BRANCH    OVRCD,PRINT710
.
          MATCH     SIIBCAT,SIIACAT
          GOTO      PRINT710 IF NOT EQUAL
.
          MATCH     SP70,SIIBCOM
          GOTO      PRINT700 IF EQUAL
.
          IF        COUNT=0
            PRINT     "Catalog Comments          : ";
            MOVE      ONE,COUNT
          ENDIF
          PRINT     *29,SIIBCOM
          ADD       ONE,CLNO
          COMPARE   "60",CLNO
          CALL      HEAD0000 IF NOT LESS
          PACK      SIIBCOM,SP70,SP70
          GOTO      PRINT700
.
PRINT710  MOVE      ZERO,COUNT
          PACK      KEY15,SIIACAT,SIICSUP,SP70
          CALL      RSSIID1
PRINT720  CALL      RKSIID1
          BRANCH    OVRCD,PRINT730
.
          MATCH     SIIACAT,SIIDCAT
          GOTO      PRINT730 IF NOT EQUAL
.
          MATCH     SIICSUP,SIIDSUP
          GOTO      PRINT730 IF NOT EQUAL
.
          MATCH     SP70,SIIDCOM
          GOTO      PRINT720 IF EQUAL
.
          IF        COUNT=0
            PRINT     "Catalog/Supplier Comments : ";
            MOVE      ONE,COUNT
          ENDIF
          PRINT     *29,SIIDCOM
          ADD       ONE,CLNO
          COMPARE   "60",CLNO
          CALL      HEAD0000 IF NOT LESS
          PACK      SIIDCOM,SP70,SP70
          GOTO      PRINT720
.
PRINT730  MOVE      ZERO,COUNT
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
PRINT740  CALL      RKSIIC1
          BRANCH    OVRCD,PRINT800
          MATCH     SIIACAT,SIICCAT
          GOTO      PRINT800 IF NOT EQUAL
          MATCH     SIICSUP,SIODSUP
          GOTO      PRINT740 IF EQUAL
          MOVE      SIICSUP,KEY5
          CALL      RDAPMA1
          BRANCH    OVRCD,PRINT740
          PACK      KEY30,SIIAISS,SIICSUT
          CALL      RDSIFA1
.         ASSIGN    SIODQTY/SIFACTOR,F12P2
          MOVE      SIODQTY,F12P2
          MOVE      F12P2,QTYFORM8
          IF        COUNT=0
            PRINT     "Possible Alternative Suppliers"
            MOVE      ONE,COUNT
            ADD       ONE,CLNO
          ENDIF
.
          PRINT     APMACRD,SP1,APMASN1,SP1," Ph: ",APMASTEL," P/N: ",SIICPNO:
                    " Unit: ",SIICSUT," Qty: ",QTYFORM8
          ADD       ONE,CLNO
          COMPARE   "60",CLNO
          CALL      HEAD0000 IF NOT LESS
          GOTO      PRINT740
.
PRINT800  CALL      UND132
          GOTO      PRINT100
.
PRINT900  CALL      TAIL0000
          PRINT     *45,"Number of Catalog Selected : ",F5
          PRINT     *50,"**** End of Report ****"
          RETURN
.--------------------------------------------------
. Print Heading
.--------------------------------------------------
HEAD0000  CALL      HEAD132
          MOVE      "8",CLNO
          PRINT     "S.R.O. Code   : ",SIOMSID,SP1,SIOMDES
          IF        CPAGENO=1
            PRINT     "Originator    : ",SIOMORG,SP1,SIORNAME:
                      *80,"User : ",SIOMUID
            PRINT     "Warehouse     : ",SIOMWAR,SP1,SIWADES:
                      *80,"Port : ",SIOMPOR
            UNPACK    SIOMDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            PRINT     "Within        : ",SIOMPER," % of Reorder":
                      *80,"Date : ",CPCDATE
            PRINT     "Include       : ",INCDESC:
                      *80,"Time : ",SIOMTIM
            PRINT     "S.O.Q. Calc.  : ",SOQDESC
            PRINT     "Delivery      : ",DELVCODE,SP1,DELVDESC
            PRINT     "Message       : ",SIOMMES,SP1,MESSDESC
            PRINT     "Commodity     : ",FROMCOMM," to ",TOCOMM
            PRINT     "Supplier      : ",FROMSUPP," to ",TOSUPP
            PRINT     "Product Group : ",FROMPROD," to ",TOPROD
.
            ADD       NINE,CLNO
            MATCH     "   ",SIOMFIA
            IF        @EQUAL
              MATCH     "~~~",SIOMTIA
              IF        !@EQUAL
                PRINT     "Catalog Group : ",FROMIA1," to ",TOIA1
                ADD       ONE,CLNO
              ENDIF
            ELSE
              PRINT     "Catalog Group : ",FROMIA1," to ",TOIA1
              ADD       ONE,CLNO
            ENDIF
          ENDIF
.
          CALL      UND132
          MOVE      SIODSUP,KEY5
          CALL      RDAPMA1
          STRIP     APMASN1
          STRIP     APMASN2
          STRIP     APMASA1
          STRIP     APMASA2
          STRIP     APMASA3
          PACK      SUPNM100,APMACRD,SP1,APMASN1,SP1,APMASN2
          PACK      SUPAD100,APMASA1,SP1,APMASA2,SP1,APMASA3,SP1,APMASPC
          PRINT        "Supplier : ",SUPNM100:
                    *N,"         : ",SUPAD100:
                    *N,"Contact  : ",APMASCON,"  Phone    : ",APMASTEL:
                       "  Fax    : ",APMASFAX
          CALL      UND132
          PRINT     "Catalog Part Number                     Supply Unit":
                    "     Issue Unit      Factor               Quantity ":
                    "          Price          Value"
          PRINT     "        Supplier Description   "
          CALL      UND132
          RETURN
.
TAIL0000
          COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL       * print heading if nothing found
.
          MOVE      "9999,999,999.99",KEY15
          FEDIT     TOTALORD,KEY15
          PRINT     *104,"Total         ",KEY15
          CALL      UND132
.
          RETURN
.--------------------------------------------------
. Calculate Stock on Backorder
.--------------------------------------------------
BOCAL000  MOVE      ZERO,TOTALSOB
          PACK      KEY12,SIIECAT,SIIEWAR,SP70
          PACK      KEY25,SIIECAT,SIIEWAR,SP70
          CALL      RSSIBA3
BOCAL100  CALL      RKSIBA3
          BRANCH    OVRCD,BOCAL999
          PACK      KEY25,SIBACAT,SIBAWAR,SP70
          MATCH     KEY12,KEY25
          GOTO      BOCAL999 IF NOT EQUAL
          ADD       SIBAQTY,TOTALSOB
          GOTO      BOCAL100
.
BOCAL999  RETURN
.--------------------------------------------------
. Calculate Stock on Order
.--------------------------------------------------
OOCAL000  MOVE      SIIESOO,TOTALSOO
          RETURN
.

DELT0000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY3,SIOMSID
          CALL     RASIOM1
          IF       OVRCD=0
            CALL     DESIOM1
          ENDIF
          CALL     CLRGEN00
          MOVE     TWO,EXIT
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT
          GOTO     DELT9999
DELT9999  RETURN
.------------------------------------------------------
. Generate Suggested Orders
.--------------------------
. Possible Errors ( These will Display on Screen When They Occur. )
.------------------------------------------------------------------
. Factor Not on Factor File.
. Contracted Supplier Code Invalid.
. Contracted Supplier Suspended for Order Processing.
. Preferred Supplier Code Invalid.
. Preferred Supplier Suspended for Order Processing.
. Preferred Supplier Does Not Have a Valid Catalog Record.
. Re Order Quantity Less Than Min Contract Order Qty.
. No Valid Suppliers Found for a Catalog.
.
. Notes
.-------
. A Warehouse/Catalog May Only Appear on one Suggested Reorder at a Time.
.
. Suggested Order Calculations
.-----------------------------
. Extract for Order if
.
.   SOH+SOO-SOB < ROL+(ROL*PER/100.0)
.
. Re Order Quantity Equals
.
.   (ROQ+ROL-SOH-SOO+SOB)/FAC    Rounded to the Nearest Whole Supply Unit
.     or
.   (ROQ)/FAC                    Rounded to the Nearest Whole Supply Unit
.
. Where
.   SOH = Stock on Hand     ( in Issue Units)
.   SOO = Stock on Order    ( in Issue Units)
.   SOB = Stock on Backorder( in Issue Units)
.   ROL = Re Order Level    ( in Issue Units)
.   ROQ = Re Order Quantity ( in Issue Units)
.   FAC = Issue Unit / Supply Unit Relationship Factor
.------------------------------------------------------
GENER000  READ     CONTROLF,SIXTY3;*241,SNCOMDPC
          COMPARE  ONE,SNCOMDPC
          GOTO     GENER100 IF NOT EQUAL
.
          MATCH    SP70,DELVCODE
          GOTO     GENER950 IF EQUAL
.
GENER100  PACK     KEY3,SIOMSID
          PACK     SIOMDAT,CCC,CYY,CMM,CDD
          REP      " 0",SIOMDAT
          CLOCK    TIME,SIOMTIM
          MOVE     PORT,SIOMPOR
          MOVE     PASSCODE,SIOMUID
.
          CALL     RASIOM1
          IF       OVRCD=0
            CALL     CLRGEN00
            CALL     UPSIOM1
          ELSE
            CALL     WRSIOM1
            CALL     RLSIOM1    * Lock on Write
          ENDIF
.
          CALL      EXTR0000    * Extract Data
.
          CALL      PRINT000    * Print Data
.
          CALL      UUSIOM1     * Unlock
.
GENER900  MOVE      ZERO,EXIT
          GOTO      GENER999
.
GENER950  MOVE      ONE,EXIT
          MOVE      "Delivery Point is mandatory - ",DISPMSG
          BEEP
          CALL      MESSAGE1
GENER999  RETURN
.--------------------------------------------------
. Clear Previous Generation
.--------------------------------------------------
CLRGEN00  DISPLAY   *P1:24,*EL,"Clearing Extract : "
          PACK      KEY20,SIOMSID,SP70
          CALL      RSSIOD2
CLRGEN10  CALL      RKSIOD2
          BRANCH    OVRCD,CLRGEN99
          MATCH     SIOMSID,SIODSID
          GOTO      CLRGEN99 IF NOT EQUAL
          PACK      KEY12,SIODWAR,SIODCAT
          DISPLAY   *P20:24,*V2LON,SIODSUP
          CALL      RDSIOD1
          IF        OVRCD=0
            CALL      DESIOD1
          ENDIF
          GOTO      CLRGEN10
CLRGEN99  RETURN
.--------------------------------------------------
. Extract Data
.--------------------------------------------------
EXTR0000  DISPLAY   *P1:24,*EL
          PACK      KEY12,SP70
          CALL      RSSIIE1
.
EXTR1000  CALL      RKSIIE1
          BRANCH    OVRCD,EXTR9999
          MATCH     SIOMWAR,SIIEWAR
          GOTO      EXTR1000 IF NOT EQUAL
.
. If Stock on Hand is Greater than the Re-Order Level + X % Then Ignore Item
. Note : This Assumes that no back orders will exist if there is Stock.
.
          IF        (SIIESOH)>(SIIEROL+(SIIEROL*SIOMPER/100.0))
            GOTO      EXTR1000
          ENDIF
.
          CALL      RANCHK00      * Range Check for Commodity/Product/Warehouse
          BRANCH    EXIT,EXTR1000 * Exit 1 Out of Range
.
          DISPLAY   *P1:24,"Extracting : ",*V2LON,SIIECAT
.
          CALL      CALBO000      * Calculate Back Order Qty
          CALL      USOO0000      * Calculate On Order Qty
.
. If Stock on Hand + Stock on Order - Stock on Backorder is Less Than or = to
. Re-Order Level + X % Then add to Extract File.
.
          IF   !((SIIESOH+TOTALSOO-TOTALSOB)>(SIIEROL+(SIIEROL*SIOMPER/100.0)))
            CALL    ADDEXT00
          ENDIF
          GOTO      EXTR1000
.
EXTR9999  RETURN
.--------------------------------------------------
. Add to Extract File
.--------------------------------------------------
ADDEXT00  CALL      GETSUP00       * Determine Supplier and Contract
          BRANCH    EXIT,ADDEXT99  * Supplier Out of Range
.
          MATCH     SP70,SIODCON
          GOTO      ADDEXT10 IF NOT EQUAL
.
          MOVE      SIICSUP,SIODSUP
          MOVE      SIICSUT,SIODSUT
          MOVE      SIICLCT,SIODCST
          MOVE      SIIAGST,SIODGST
          CALL      CALTAX00
          MOVE      SP70,SIODCDT
          CALL      GETFAC00     * Get Factor
.
          MATCH     "2",SIOMSOQ
          IF        @EQUAL
             MOVE      SIIEROQ,QTYFORM8
          ELSE
             ASSIGN    SIIEROQ+SIIEROL-SIIESOH-TOTALSOO+TOTALSOB,F12P2
             MOVE      F12P2,QTYFORM8
          ENDIF
          MOVE      QTYFORM8,QTYF8P6
          IF        (QTYF8P6%SIFACTOR)>0
            ASSIGN    QTYF8P6/SIFACTOR + 0.5,QTYF8P6
            MOVE      QTYF8P6,CONTQTY
          ELSE
            ASSIGN    QTYF8P6/SIFACTOR,QTYF8P6
            MOVE      QTYF8P6,CONTQTY
          ENDIF
.          ASSIGN    (CONTQTY*SIFACTOR),SIODQTY        * in sifactor multiples
          MOVE      CONTQTY,SIODQTY        * in Supply Units
          GOTO      ADDEXT80
.
ADDEXT10  MOVE      SISDSUT,SIODSUT
          MOVE      SISDSUP,SIODSUP
          MOVE      SISDSDT,SIODCDT
          CALL      GETFAC00     * Get Factor
.
          MATCH     "2",SIOMSOQ
          IF        @EQUAL
             MOVE      SIIEROQ,QTYFORM8
          ELSE
             ASSIGN    SIIEROQ+SIIEROL-SIIESOH-TOTALSOO+TOTALSOB,F12P2
             MOVE      F12P2,QTYFORM8
          ENDIF
          MOVE      QTYFORM8,QTYF8P6
          IF        (QTYF8P6%SIFACTOR)>0
            ASSIGN    QTYF8P6/SIFACTOR + 0.5,QTYF8P6
            MOVE      QTYF8P6,CONTQTY
          ELSE
            ASSIGN    QTYF8P6/SIFACTOR,QTYF8P6
            MOVE      QTYF8P6,CONTQTY
          ENDIF
.         ASSIGN    (CONTQTY*SIFACTOR),SIODQTY        * in sifactor multiples
          MOVE      CONTQTY,SIODQTY        * in Supply Units
          IF        CONTQTY<SISDMQT
            CALL      CONMIN00     * Contract Minimum
          ENDIF
          CALL      CONCST00     * Determine Contracted Cost
.
          MOVE      SIIAGST,SIODGST
          CALL      CALTAX00
.
ADDEXT80  COMPARE   ZERO,SIODQTY
          GOTO      ADDEXT99 IF EQUAL
.
          MOVE      SP70,SIODSPA
          MOVE      SP70,SIODEDT
          PACK      KEY12,SIODWAR,SIODCAT
          CALL      RDSIOD1
          IF        OVRCD=1
            CALL      WRSIOD1
          ENDIF
.
ADDEXT99  RETURN
.---------------------------------------------
. Determine Contract Price from Price Breaks
.---------------------------------------------
CONCST00  IF        (SISDBQ1=0)|(CONTQTY<SISDBQ1)
            MOVE      SISDUC1,SIODCST
            GOTO      CONCST99
          ENDIF
          IF        (SISDBQ2=0)|(CONTQTY<SISDBQ2)
            MOVE      SISDUC2,SIODCST
            GOTO      CONCST99
          ENDIF
          IF        (SISDBQ3=0)|(CONTQTY<SISDBQ3)
            MOVE      SISDUC3,SIODCST
            GOTO      CONCST99
          ENDIF
          MOVE      SISDUC4,SIODCST
CONCST99  RETURN
.--------------------------------------------------
. Contract Minimum
.--------------------------------------------------
CONMIN00  BEEP
          DISPLAY   *P1:17,*EF
          HLINE     *G37,17,1,80
          DISPLAY   *P10:18,*V2LON:
                     "Re Order Quantity Less Than Contract Minimum",*HOFF:
                    *P1:20,"Catalog   : ",*V2LON,SIODCAT,*HOFF:
                            SP1,SIIADES:
                    *P1:21,"Warehouse : ",*V2LON,SIODWAR,*HOFF:
                              "  Supply Unit : ",*V2LON,SIODSUT,*HOFF:
                              "  Issue  Unit : ",*V2LON,SIIAISS,*HOFF:
                    *P1:22,"Con. Min. : ",*V2LON,SISDMQT,*HOFF:
                              "  Re Order Qty : ",*V2LON,CONTQTY:
                    *P1:24,"Contact Minimum Used - ";
          CALL      HITENTER
          DISPLAY   *P1:24,*EL
          MOVE      SISDMQT,CONTQTY
.         ASSIGN    CONTQTY*SIFACTOR,SIODQTY
          MOVE      CONTQTY,SIODQTY
          RETURN
.---------------------------------------------
. Get Factor
.---------------------------------------------
GETFAC00  PACK      KEY30,SIIAISS,SIODSUT
          CALL      RDSIFA1
          BRANCH    OVRCD,GETFAC05
          GOTO      GETFAC99
.
GETFAC05  BEEP
          DISPLAY   *P1:19,*EF
          HLINE     *G37,19,1,80
          DISPLAY   *P1:20,"Invalid Factor Combination Found":
                    *P1:21,"Catalog   : ",*V2LON,SIIECAT,*HOFF,SP1,SIIADES:
                    *P1:22,"Supply    : ",*V2LON,SIODSUT,*HOFF:
                    "     Issue  : ",*V2LON,SIIAISS
          MOVE      ONE,SIFACTOR
.
GETFAC10  KEYIN     *P1:24,"Enter Factor : ",*V2LON,*RV,*MASK,SIFACTOR,*HOFF:
                    *P1:24,"Enter Factor : ",*V2LON,*DV,SIFACTOR;
GETFAC20  KEYIN     *P50:24,"Ok (Y/N) ? ",*V2LON,ANS;
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      GETFAC10 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      GETFAC20 IF NOT EQUAL
          DISPLAY   *P1:24,*EL
GETFAC99  RETURN
.--------------------------------------------------
. Determine Supplier
.--------------------------------------------------
GETSUP00  MOVE      SP70,SIODCON
          MOVE      SP70,SIODSUP
          MOVE      SP70,SIODSUT
          MOVE      SIOMSID,SIODSID
          MOVE      SIIEWAR,SIODWAR
          MOVE      SIIECAT,SIODCAT
          MOVE      ZERO,SIODCST
          MOVE      ZERO,SIODGSTA
          MOVE      ZERO,SIODQTY
          MOVE      SP70,SIODGST
          MOVE      SP70,SIODCDT
.
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY45,SIIECAT,CURRDATE,Z70
          CALL      RSSISD2                 * Check for Contract Price
          CALL      RPSISD2                 * Lastest Price
          BRANCH    OVRCD,GETSUP10          * No Contract
.
          MATCH     SISDCAT,SIIECAT         * Correct Catalog
          GOTO      GETSUP10 IF NOT EQUAL   * No Contract
.
          MOVE      SISDCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,GETSUP10          * No Contract
.
          MATCH     SISCEDT,CURRDATE        * Check for Completed Contract
          GOTO      GETSUP10 IF NOT LESS    * Contract Out of Date
.
          COMPARE   THREE,SIOMINC            * Non Contract Only
          GOTO      GETSUP90 IF EQUAL
.
          MOVE      SISCCON,SIODCON
          MOVE      SISDSUP,SIODSUP
          MOVE      SISDSUT,SIODSUT
.
          CALL      SUPCHK00                * Check Supplier Code
          BRANCH    EXIT,GETSUP10
.
          PACK      KEY27,SIODCAT,SIODSUP,SIODSUT
          CALL      RDSIIC1
          IF        OVRCD=1
            BEEP
            DISPLAY   *P1:19,*EF
            HLINE     *G37,19,1,80
            DISPLAY   *P1:20,"Supplier/Supply Unit ",*V2LON,SIODSUP,"/",SIODSUT:
                      *HOFF," is Not a Valid Catalog/Supplier Record.":
                      *P1:21,"Catalog   : ",*V2LON,SIIECAT,*HOFF,SP1,SIIADES:
                      *P1:22,"Warehouse : ",*V2LON,SIIEWAR,*HOFF:
                      *P1:24,"Alternative Supplier Used - ";
            CALL      HITENTER
            DISPLAY   *P1:24,*EL
            GOTO      GETSUP10
          ENDIF
          GOTO      GETSUP80
.
GETSUP10
          COMPARE   TWO,SIOMINC             * Contract Only
          GOTO      GETSUP90 IF EQUAL
          MOVE      SIIAPSC,SIODSUP
          MOVE      SP70,SIODCON
          CALL      SUPCHK00
          BRANCH    EXIT,GETSUP20
.
          PACK      KEY12,SIIECAT,SIODSUP,SP70
          PACK      KEY27,SIIECAT,SIODSUP,SP70
          CALL      RSSIIC1
GETSUP12  CALL      RKSIIC1
          BRANCH    OVRCD,GETSUP15
          PACK      KEY27,SIICCAT,SIICSUP,SP70
          MATCH     KEY12,KEY27
          GOTO      GETSUP15 IF NOT EQUAL
          COMPARE   ZERO,SIICAPO
          GOTO      GETSUP12 IF EQUAL
          GOTO      GETSUP80
.
GETSUP15  BEEP
          DISPLAY   *P1:19,*EF
          HLINE     *G37,19,1,80
          DISPLAY   *P1:20,"Supplier Code ",*V2LON,KEY5:
                    *HOFF," Does Not have a Valid Catalog/Supplier Record.":
                    *P1:21,"Catalog   : ",*V2LON,SIIECAT,*HOFF,SP1,SIIADES:
                    *P1:22,"Warehouse : ",*V2LON,SIIEWAR,*HOFF:
                    *P1:24,"Alternative Supplier Used - ";
          CALL      HITENTER
          DISPLAY   *P1:24
.
GETSUP20  PACK      KEY27,SIIECAT,SP70
          CALL      RSSIIC1
.
GETSUP30  CALL      RKSIIC1
          BRANCH    OVRCD,GETSUP70
          MATCH     SIIECAT,SIICCAT
          GOTO      GETSUP70 IF NOT EQUAL
          MATCH     SIIAPSC,SIICSUP      * Ignore Prefered Supplier
          GOTO      GETSUP30 IF EQUAL
          COMPARE   ZERO,SIICAPO
          GOTO      GETSUP30 IF EQUAL
          MOVE      SIICSUP,SIODSUP
          GOTO      GETSUP80
GETSUP70  BEEP
          DISPLAY   *P1:19,*EF
          HLINE     *G37,19,1,80
          DISPLAY   *P1:20,*V2LON,*ULON,"No Valid Supplier Found",*HOFF:
                    *P1:21,"Catalog   : ",*V2LON,SIIECAT,*HOFF,SP1,SIIADES:
                    *P1:22,"Warehouse : ",*V2LON,SIIEWAR,*HOFF:
                    *P1:24,"Catalog Not Included - ";
          CALL      HITENTER
          DISPLAY   *P1:24,*EL
          GOTO      GETSUP90
.
GETSUP80  MATCH     SIOMFSU,SIODSUP
          GOTO      GETSUP90 IF LESS
          MATCH     SIODSUP,SIOMTSU
          GOTO      GETSUP90 IF LESS
          MOVE      ZERO,EXIT
          GOTO      GETSUP99
.
GETSUP90  MOVE      ONE,EXIT
GETSUP99  RETURN
.--------------------------------------------------
. Check Range Option EXIT=1 if not in Range
. Check for Item Already on a Suggestion List
.           Suspension
.           Warehouse
.           Product Group
.           Commodity Group
.--------------------------------------------------
RANCHK00  PACK      KEY12,SIIEWAR,SIIECAT
          CALL      RDSIOD1
          COMPARE   ZERO,OVRCD
          GOTO      RANCHK90 IF EQUAL
.
. Suspended   Susp. 0-Not Susp, 1-Reqn, 2-P/O, 3-Both
.
          IF        SIIESUS>1
            GOTO      RANCHK90
          ENDIF
.
          PACK      KEY7,SIIECAT,SP70
          CALL      RDSIIA1
          BRANCH    OVRCD,RANCHK90
          BRANCH    SIIANON,RANCHK90
.
          IF        SIIASUS>1
            GOTO      RANCHK90
          ENDIF
.
          MATCH     SIOMFIA,SIIAUC1
          GOTO      RANCHK90 IF LESS
          MATCH     SIIAUC1,SIOMTIA
          GOTO      RANCHK90 IF LESS
.
. Product Group Range
.
          MATCH     SIOMFPG,SIIASUB
          GOTO      RANCHK90 IF LESS
          MATCH     SIIASUB,SIOMTPG
          GOTO      RANCHK90 IF LESS
.
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
          BRANCH    OVRCD,RANCHK90
.
. Commodity Group Range
.
          MATCH     SIOMFCO,SISACOMM
          GOTO      RANCHK90 IF LESS
          MATCH     SISACOMM,SIOMTCO
          GOTO      RANCHK90 IF LESS
.
          MOVE      ZERO,EXIT     * In Range
          GOTO      RANCHK99
.
RANCHK90  MOVE      ONE,EXIT      * Out of Range
.
RANCHK99  RETURN
.--------------------------------------------------
. Calculate Stock on Backorder
.--------------------------------------------------
CALBO000  MOVE      ZERO,TOTALSOB
          PACK      KEY12,SIIECAT,SIIEWAR,SP70
          PACK      KEY25,SIIECAT,SIIEWAR,SP70
          CALL      RSSIBA3
.
CALBO100  CALL      RKSIBA3
          BRANCH    OVRCD,CALBO999
          PACK      KEY25,SIBACAT,SIBAWAR,SP70
          MATCH     KEY12,KEY25
          GOTO      CALBO999 IF NOT EQUAL
          ADD       SIBAQTY,TOTALSOB
          GOTO      CALBO100
.
CALBO999  RETURN
.--------------------------------------------------
. Calculate Stock on Order
.--------------------------------------------------
USOO0000
          PACK     KEY7,SIIECAT
          REPEAT
            CALL     RLSIIA1
            BRANCH   OVRCD,USOO5000
            ADD      ONE,SECTOR   * Display Record Counter Every 6000 Records
            IF       (SECTOR%6000.0=0)&(OVRCD=2)
              GOTO      USOO5000
            ENDIF
          UNTIL    OVRCD=0
.
          PACK     KEY12,SIIECAT,SIIEWAR
          REPEAT
            CALL     RLSIIE1
            BRANCH   OVRCD,USOO5000
            ADD      ONE,SECTOR   * Display Record Counter Every 6000 Records
            IF       (SECTOR%6000.0=0)&(OVRCD=2)
              GOTO      USOO5000
            ENDIF
          UNTIL    OVRCD=0
.
          MOVE     ZERO,EXIT
          MOVE     ZERO,F12P2
          PACK     KEY25,SIIECAT,ONE,SP70
          CALL     RSSIPC6
.
USOO1100  CALL     RKSIPC6
          BRANCH   OVRCD,USOO1900
          MATCH    SIIECAT,SIPCCAT
          GOTO     USOO1900 IF NOT EQUAL
          MATCH    SIIEWAR,SIPCWAR
          GOTO     USOO1100 IF NOT EQUAL
.
          MOVE     ONE,SIFACTOR
          PACK     KEY30,SIIAISS,SIPCSUT
          CALL     RDSIFA1
.
          CALL     UUSIPA1
          MOVE     ZERO,SECTOR
          PACK     KEY7,SIPCPON,SP70
          REPEAT
            CALL     RLSIPA1
            BRANCH   OVRCD,USOO1100
            ADD      ONE,SECTOR    * Display Record Counter Every 6000 Records
            IF       (SECTOR%6000.0=0)&(OVRCD=2)
              GOTO     USOO5000
            ENDIF
          UNTIL    OVRCD=0
.
          MATCH    SP70,SIPADCM
          GOTO     USOO1200 IF NOT EQUAL  * Completed Order No more Outstanding
          MATCH    SP70,SIPADCN
          GOTO     USOO1200 IF NOT EQUAL  * Cancelled Order No more Outstanding
.
          IF       (SIFACTOR*SIPCOQT)-SIPCRQT > 0
            ASSIGN   F12P2+(SIFACTOR*SIPCOQT)-SIPCRQT,F12P2
          ENDIF
          GOTO     USOO1100
.
USOO1200  PACK     KEY10,SIPCPON,SIPCITM * Should be blank if No Outstanding
          CALL     RDSIPC1
          IF       OVRCD=0
            MOVE     SP70,SIPCEDD
            CALL     UPSIPC1
          ENDIF
          GOTO     USOO1100
.
USOO1900  IF       !(F12P2=SIIESOO)
            MOVE     F12P2,SIIESOO
            CALL     UPSIIE1
          ENDIF
.
USOO5000
          CALL      UUSIPA1
          CALL      UUSIIA1
          CALL      UUSIIE1
.
          MOVE      SIIESOO,TOTALSOO
.
USOO9999  RETURN
.------------------------------------------------------------
. Check Supplier Code Exists and is not on hold for Orders
.------------------------------------------------------------
SUPCHK00  MOVE      SIODSUP,KEY5
          MOVE      ZERO,EXIT
          CALL      RDAPMA1
          IF        OVRCD=1
            BEEP
            DISPLAY   *P1:19,*EF
            HLINE     *G37,19,1,80
            DISPLAY   *P1:20,"Supplier Code ",*V2LON,KEY5:
                      *HOFF," No Longer Exists.":
                      *P1:21,"Catalog   : ",*V2LON,SIIECAT,*HOFF,SP1,SIIADES:
                      *P1:22,"Warehouse : ",*V2LON,SIIEWAR,*HOFF:
                      "     Contract : ",*V2LON,SIODCON:
                      *P1:24,"Alternative Supplier Used - ";
            CALL      HITENTER
            DISPLAY   *P1:24,*EL
            MOVE      ONE,EXIT
          ENDIF
.
          IF        APMAHOR=1
            BEEP
            DISPLAY   *P1:19,*EF
            HLINE     *G37,19,1,80
            DISPLAY   *P1:20,"Supplier Code ",*V2LON,KEY5:
                      *HOFF," is On Hold for Order Processing.":
                      *P1:21,"Catalog   : ",*V2LON,SIIECAT,*HOFF,SP1,SIIADES:
                      *P1:22,"Warehouse : ",*V2LON,SIIEWAR,*HOFF:
                      "     Contract : ",*V2LON,SIODCON:
                      *P1:24,"Alternative Supplier Used - ";
            CALL      HITENTER
            DISPLAY   *P1:24,*EL
            MOVE      ONE,EXIT
          ENDIF
          RETURN
.
CALTAX00  COMPARE   ZERO,SIODCST
          GOTO      CALTAX90 IF EQUAL
.
          MATCH     SP6,SIODGST
          GOTO      CALTAX90 IF EQUAL
.
          PACK      KEY8,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY8
.
          PACK      KEY14,SIODGST,KEY8,SP70
          CALL      RDIBGE1
          COMPARE   ZERO,OVRCD
          GOTO      CALTAX10 IF EQUAL
.
          CALL      RPIBGE1
          BRANCH    OVRCD,CALTAX90
.
          MATCH     SIODGST,IBGECODE
          GOTO      CALTAX90 IF NOT EQUAL
.
CALTAX10  ASSIGN    (SIODCST-(SIODCST/(ONE+(IBGEAMNT/HUNDRED)))),SIODGSTA
          GOTO      CALTAX99
.
CALTAX90  MOVE      ZERO,SIODGSTA
.
CALTAX99  RETURN
.
ESOQC000 IF        ACCEPT=1
           MOVE      ONE,SIOMSOQ
         ENDIF
         MOVE      SP70,DISPMSG
         CALL      MESSAGE2
ESOQC010 MOVE      SIOMSOQ,F1
         DISPLAY   *P1:24,*EL,"Re-Order Calculation : ":
                   *V2LON,"1. ",*HOFF,"ROQ+ROL-SOH-SOO+SOB , ":
                   *V2LON,"2. ",*HOFF,"ROQ Only"
         KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,F1
         MOVE      F1,SIOMSOQ
         BRANCH    F1,ESOQC100,ESOQC200
         BEEP
         GOTO      ESOQC010
.
ESOQC100 MOVE      "ROQ+ROL-SOH-SOO+SOB",SOQDESC
         GOTO      ESOQC999
.
ESOQC200 MOVE      "ROQ Only",SOQDESC
         GOTO      ESOQC999
.
ESOQC999 CALL      MESSAGE3
         RETURN
EIA10000  IF       ACCEPT=1
            MOVE     SP70,SIOMFIA
            MOVE     Z70,SIOMTIA
            MOVE     "Start",FROMIA1
            MOVE     "Finish",TOIA1
            MOVE     ZERO,EXIT
            GOTO     EIA10999
          ENDIF
.
          MOVE     "   37",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          MOVE     "ia1",SICDCATA
          CALL     KSICDB00
          BRANCH   EXIT,EIA10100,EIA10999
          MOVE     SICDCODE,SIOMFIA
          PACK     FROMIA1,SICDCODE,SP1,SICDDESC
          GOTO     EIA10200
EIA10100  MOVE     SP70,FROMIA1
          MOVE     SP70,SIOMFIA
          MOVE     "Start",FROMIA1
EIA10200  MOVE     FROMIA1,VAR
          CALL     DISPITEM
.
EIA10300  MOVE     "   38",FLDID
          CALL     GETPOSIT
          MOVE     SP70,VAR
          CALL     DISPITEM
          MOVE     "ia1",SICDCATA
          CALL     KSICDB00
          BRANCH   EXIT,EIA10400,EIA10999
          MOVE     SICDCODE,SIOMTIA
          PACK     TOIA1,SICDCODE,SP1,SICDDESC
          MATCH    SIOMFIA,SIOMTIA
          GOTO     EIA10500 IF NOT LESS
          MOVE     "To Code Must be Greater Than From Code - ",DISPMSG
          CALL     MESSAGE1
          GOTO     EIA10000
EIA10400  MOVE     SP70,TOIA1
          MOVE     Z70,SIOMTIA
          MOVE     "Finish",TOIA1
EIA10500  MOVE     TOIA1,VAR
          CALL     DISPITEM
          MOVE     "   37",FLDID
          CALL     GETPOSIT
EIA10999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       IBAGEDIO/INC
          INC       IBAGSTIO/INC
          INC       SINBACIO/INC
          INC       SINCGAIO/INC
          INC       SINCGAKY    
          INC       SINCIAIO/INC
          INC       SINCIBIO/INC
          INC       SINCICIO/INC
          INC       SINCIDIO/INC
          INC       SINCIEIO/INC
          INC       SINCIHIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINDPCIO/INC
          INC       SINDPCKY    
          INC       SINFACIO/INC
          INC       SINNATIO/INC
          INC       SINORIIO/INC
          INC       SINORIKY    
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       SINSCDIO/INC
          INC       SINSCMIO/INC
          INC       SINSODIO/INC
          INC       SINSOMIO/INC
          INC       SINSOMKY    
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
