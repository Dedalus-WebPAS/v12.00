.----------------------------------------------------------------------
.   Program       : GENERCMC.PBL
.   CAR Number    : 40305 
.   Description   : This program generates the keyword search table (patkcmaf)
.                   from the Patient System Casemix codes table (patcmcaf)
.   Modifications : 
.
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.  data includes
.----------------------------------------------------------------------
.
          INC       STDGENDF
          INC       PATCMCFD/INC
          INC       PATKCMFD/INC
.
.----------------------------------------------------------------------
.  local variables
.----------------------------------------------------------------------
.
.
PRGID     INIT      "GENERCMC"
PRGNAM    INIT      "Generate patcmcaf"
VERSION   INIT      "V12.00.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
.
.---- initialise screen and confirm desire to execute program ----
.
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P1:10,"This will generate Casemix Code Keyword records."
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
.
.---- open files ----
.
          OPEN      PATCMCA1,"patcmcaf"
          OPEN      PATKCMA1,"patkcmaf"
          OPEN      PATKCMA2,"patkcmaf"
.
.
.---- loop through patcmcaf and add new records to patkcmaf ----
.
ML2000    PACK      KEY9,SP70
          MOVE      ZERO,SECTOR
.
          CALL      RSPTCMC1           * read next record
ML2100    CALL      RKPTCMC1
          BRANCH    OVRCD,ML9999
.
          ADD       ONE,SECTOR         * display every 100th record
          IF        SECTOR%100=1
            DISPLAY   *P1:24,*V2LON,"Adding...",SECTOR," - ",PTCACODE,*EF;
          ENDIF
.
          PROC      PATKCMUP
          GOTO      ML2100
.
.---- exit program ----
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
.  code includes
.----------------------------------------------------------------------
.
          INC       PATCMCIO/INC
          INC       PATKCMIO/INC
          INC       PATKCMPR
          INC       STDGENCD
.
