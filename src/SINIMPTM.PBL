. *----------------------------------------------------------------------
. * Include Name  :   SINIMPTM.PBL
. *
. * Function      :   CGI variable functions for SINIMPFD - sinimpaf.dat
. *
. * Modifications :
. *
. * V9.04.00 25/02/2005 Lina Vo                  CAR 56404
. *          Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear parameters for the imprest file
.------------------------------------------------------------------------
CPSIMP00  MOVE      Z70,SIIMP001
          MOVE      Z70,SIIMP002
          MOVE      Z70,SIIMP003
          MOVE      Z70,SIIMP004
          MOVE      Z70,SIIMP005
          MOVE      Z70,SIIMP006
          MOVE      Z70,SIIMP007
          MOVE      Z70,SIIMP008
          MOVE      Z70,SIIMP009
          MOVE      Z70,SIIMP010
          MOVE      Z70,SIIMP011
          MOVE      Z70,SIIMP012
          MOVE      Z70,SIIMP013
          MOVE      Z70,SIIMP014
          MOVE      Z70,SIIMP015
.
CPSIMP99  RETURN
.
.------------------------------------------------------------
. imprest file standard tags
.------------------------------------------------------------
SIMP0000  BRANCH    FLDITMNO,SIMP0010,SIMP0020,SIMP0030,SIMP0040,SIMP0050:
                             SIMP0060,SIMP0070,SIMP0080,SIMP0090,SIMP0100:
                             SIMP0110,SIMP0120,SIMP0130,SIMP0140,SIMP0150
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      SIMP9999
.
SIMP0010  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIMP0011
          WRITE     HTMLFILE;SIIMCST;  
          GOTO      SIMP9999
.
SIMP0011  PACK      KEY5,SIIMCST,SP10
          CALL      RDSICA1
          BRANCH    OVRCD,SIMP9999
.
          WRITE     HTMLFILE;SICADESC;
          GOTO      SIMP9999
.
SIMP0020  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIMP0021
          WRITE     HTMLFILE;SIIMCAT;  
          GOTO      SIMP9999
.
SIMP0021  PACK      KEY7,SIIMCAT,SP10
          CALL      RDSIIA1
          BRANCH    OVRCD,SIMP9999
.
          WRITE     HTMLFILE;SIIADES;
          GOTO      SIMP9999
.
SIMP0030  WRITE     HTMLFILE;SIIMSEQ;  
          GOTO      SIMP9999
.
SIMP0040  WRITE     HTMLFILE;SIIMMAX;  
          GOTO      SIMP9999
.
SIMP0050  WRITE     HTMLFILE;SIIMREQ;
          GOTO      SIMP9999
.
SIMP0060  WRITE     HTMLFILE;SIIMQOH;
          GOTO      SIMP9999
.
SIMP0070  WRITE     HTMLFILE;SIIMUR1;
          GOTO      SIMP9999
.
SIMP0080  WRITE     HTMLFILE;SIIMUR2;
          GOTO      SIMP9999
.
SIMP0090  MATCH     SIIMUD1,SP70
          GOTO      SIMP9999 IF EQUAL
.
          UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIMP9999
.
SIMP0100  MATCH     SIIMUD2,SP70
          GOTO      SIMP9999 IF EQUAL
.
          UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SIMP9999
.
SIMP0110  WRITE     HTMLFILE;SIIMUC1;
          GOTO      SIMP9999
.
SIMP0120  WRITE     HTMLFILE;SIIMUC2;
          GOTO      SIMP9999
.
SIMP0130  WRITE     HTMLFILE;SIIMUY1;
          GOTO      SIMP9999
.
SIMP0140  WRITE     HTMLFILE;SIIMUY2;
          GOTO      SIMP9999
.
SIMP0150  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,SIMP0151
          WRITE     HTMLFILE;SIIMWAR;
          GOTO      SIMP9999
.
SIMP0151  PACK      KEY5,SIIMWAR,SP10
          CALL      RDSIWA1
          BRANCH    OVRCD,SIMP9999
.
          WRITE     HTMLFILE;SIWADES;
          GOTO      SIMP9999
.
SIMP9999  RETURN
.------------------------------------------------------------
.   Set Parameters for the imprest file
.------------------------------------------------------------
SPIMP000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPIMP010,SPIMP020,SPIMP030,SPIMP040,SPIMP050:
                       SPIMP060,SPIMP070,SPIMP080,SPIMP090,SPIMP100:
                       SPIMP110,SPIMP120,SPIMP130,SPIMP140,SPIMP150
.
          MOVE      ONE,EXIT
          GOTO      SPIMP999
.
SPIMP010  MOVE      QRYDATA,SIIMP001
          GOTO      SPIMP999
.
SPIMP020  MOVE      QRYDATA,SIIMP002
          GOTO      SPIMP999
.
SPIMP030  MOVE      QRYDATA,SIIMP003
          GOTO      SPIMP999
.
SPIMP040  MOVE      QRYDATA,SIIMP004
          GOTO      SPIMP999
.
SPIMP050  MOVE      QRYDATA,SIIMP005
          GOTO      SPIMP999
.
SPIMP060  MOVE      QRYDATA,SIIMP006
          GOTO      SPIMP999
.
SPIMP070  MOVE      QRYDATA,SIIMP007
          GOTO      SPIMP999
.
SPIMP080  MOVE      QRYDATA,SIIMP008
          GOTO      SPIMP999
.
SPIMP090  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIIMP009,CCENT,CYEAR,CMON,CDAY
          GOTO      SPIMP999
.
SPIMP100  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SIIMP010,CCENT,CYEAR,CMON,CDAY
          GOTO      SPIMP999
.
SPIMP110  MOVE      QRYDATA,SIIMP011
          GOTO      SPIMP999
.
SPIMP120  MOVE      QRYDATA,SIIMP012
          GOTO      SPIMP999
.
SPIMP130  MOVE      QRYDATA,SIIMP013
          GOTO      SPIMP999
.
SPIMP140  MOVE      QRYDATA,SIIMP014
          GOTO      SPIMP999
.
SPIMP150  MOVE      QRYDATA,SIIMP015
          GOTO      SPIMP999
.
SPIMP999  RETURN
.
.------------------------------------------------------------
.  Update imprest file
.------------------------------------------------------------
MVSIMP00  MATCH     SIIMP001,Z70
          IF        !@EQUAL
            MOVE      SIIMP001,SIIMCST
          ENDIF
.
          MATCH     SIIMP002,Z70
          IF        !@EQUAL
            MOVE      SIIMP002,SIIMCAT
          ENDIF
.
          MATCH     SIIMP003,Z70
          IF        !@EQUAL
            MOVE      SIIMP003,SIIMSEQ
          ENDIF
.
          MATCH     SIIMP004,Z70
          IF        !@EQUAL
            MOVE      SIIMP004,SIIMMAX
          ENDIF
.
          MATCH     SIIMP005,Z70
          IF        !@EQUAL
            MOVE      SIIMP005,SIIMREQ
          ENDIF
.
          MATCH     SIIMP006,Z70
          IF        !@EQUAL
            MOVE      SIIMP006,SIIMQOH
          ENDIF
.
          MATCH     SIIMP007,Z70
          IF        !@EQUAL
            MOVE      SIIMP007,SIIMUR1
          ENDIF
.
          MATCH     SIIMP008,Z70
          IF        !@EQUAL
            MOVE      SIIMP008,SIIMUR2
          ENDIF
.
          MATCH     SIIMP009,Z70
          IF        !@EQUAL
            MOVE      SIIMP009,SIIMUD1
          ENDIF
.
          MATCH     SIIMP010,Z70
          IF        !@EQUAL
            MOVE      SIIMP010,SIIMUD2
          ENDIF
.
          MATCH     SIIMP011,Z70
          IF        !@EQUAL
            MOVE      SIIMP011,SIIMUC1
          ENDIF
.
          MATCH     SIIMP012,Z70
          IF        !@EQUAL
            MOVE      SIIMP012,SIIMUC2
          ENDIF
.
          MATCH     SIIMP013,Z70
          IF        !@EQUAL
            MOVE      SIIMP013,SIIMUY1
          ENDIF
.
          MATCH     SIIMP014,Z70
          IF        !@EQUAL
            MOVE      SIIMP014,SIIMUY2
          ENDIF
.
          MATCH     SIIMP015,Z70
          IF        !@EQUAL
            MOVE      SIIMP015,SIIMWAR
          ENDIF
.
MVSIMP99  RETURN
.
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLSIMP00  MOVE      SP70,SIIMCST  
          MOVE      SP70,SIIMCAT 
          MOVE      SP70,SIIMSEQ  
          MOVE      ZERO,SIIMMAX       
          MOVE      ZERO,SIIMREQ
          MOVE      ZERO,SIIMQOH
          MOVE      SP70,SIIMUR1  
          MOVE      SP70,SIIMUR2  
          MOVE      SP70,SIIMUD1  
          MOVE      SP70,SIIMUD2  
          MOVE      SP70,SIIMUC1  
          MOVE      SP70,SIIMUC2  
          MOVE      SP70,SIIMUY1  
          MOVE      SP70,SIIMUY2  
          MOVE      SP70,SIIMWAR  
          MOVE      SP70,SIIMSPA  
.
CLSIMP99  RETURN
