. *----------------------------------------------------------------------
. * Include Name  :   PMSSPETM.PBL
. *
. * Function      :   Common routines for PMSSPEFD - pmsspeaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.06.01  07/04/2015  Peter Vela    CAR 303889
.             Created include
.------------------------------------------------------------------------
.   Clear parameters for hcp specialty file
.------------------------------------------------------------------------
CPPMSE00  MOVE      Z70,PMSPE001
          MOVE      Z70,PMSPE002
          MOVE      Z70,PMSPE003
          MOVE      Z70,PMSPE004
CPPMSE99  RETURN
.------------------------------------------------------------
. Tags for hcp specialty table
.------------------------------------------------------------
PMSE0000  BRANCH    FLDITMNO,PMSE0010,PMSE0020,PMSE0030,PMSE0040,PMSE0050:
                             PMSE0060,PMSE0070,PMSE0080,PMSE0090,PMSE0100
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMSE9999
.
PMSE0010  WRITE     HTMLFILE;PMSEHCPC;
          GOTO      PMSE9999
.
PMSE0020  MOVE      "A ",CATEGORY
          MOVE      PMSESPEC,CODE
          CALL      CODITM00
          GOTO      PMSE9999
.
PMSE0030  MATCH     PMSESDAT,SP70
          GOTO      PMSE9999 IF EQUAL
.
          UNPACK    PMSESDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMSE9999
.
PMSE0040  MATCH     PMSEEDAT,SP70
          GOTO      PMSE9999 IF EQUAL
.
          UNPACK    PMSEEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMSE9999
.
PMSE0050  MATCH     SP70,PMSECUID
          GOTO      PMSE9999 IF EQUAL
.
          PACK      KEY10,PMSECUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMSECUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMSE9999
.
PMSE0060  MATCH     PMSECDAT,SP70
          GOTO      PMSE9999 IF EQUAL
.
          UNPACK    PMSECDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMSE9999
.
PMSE0070  WRITE     HTMLFILE;PMSECTIM;
          GOTO      PMSE9999
.
PMSE0080  MATCH     SP70,PMSEUUID
          GOTO      PMSE9999 IF EQUAL
.
          PACK      KEY10,PMSEUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMSEUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMSE9999
.
PMSE0090  MATCH     PMSEUDAT,SP70
          GOTO      PMSE9999 IF EQUAL
.
          UNPACK    PMSEUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMSE9999
.
PMSE0100  WRITE     HTMLFILE;PMSEUTIM;
          GOTO      PMSE9999
.
PMSE9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for hcp speciality
.------------------------------------------------------------
SPPSE000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPSE001,SPPSE002,SPPSE003,SPPSE004
.
          MOVE      ONE,EXIT
          GOTO      SPPSE999
.
SPPSE001  MOVE      QRYDATA,PMSPE001
          GOTO      SPPSE999
.
SPPSE002  MOVE      QRYDATA,PMSPE002
          GOTO      SPPSE999
.
SPPSE003  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSPE003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPSE999
.
SPPSE004  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSPE004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPSE999
.
SPPSE999  RETURN
.
.------------------------------------------------------------
.  Update doctor arrangements details
.------------------------------------------------------------
MVPMSE00  MATCH     PMSPE001,Z70
          IF        !@EQUAL
            MOVE      PMSPE001,PMSEHCPC
          ENDIF
.
          MATCH     PMSPE002,Z70
          IF        !@EQUAL
            MOVE      PMSPE002,PMSESPEC
          ENDIF
.
          MATCH     PMSPE003,Z70
          IF        !@EQUAL
            MOVE      PMSPE003,PMSESDAT
          ENDIF
.
          MATCH     PMSPE004,Z70
          IF        !@EQUAL
            MOVE      PMSPE004,PMSEEDAT
          ENDIF
.
MVPMSE99  RETURN
+
