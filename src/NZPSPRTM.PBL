. *----------------------------------------------------------------------
. * Include Name  :   NZPSPRTM.INC
. *
. * Function      :   NZ Private Procedure and Funder details     
. *                   Common Functions
. *
. * Modifications :
. *
. * V11.01.01 26/02/2021  J.Tan          TSK 0903267
. *           Mod duration (SQUEEZE NZSPR020)
. * V11.00.02 09/02/2021  J.Tan          TSK 0898692
. *           Mod SPNZSP00 routine to Pack instead of MOVE
. * V11.00.01 11/03/2020  J.Tan          TSK 0838262
. *           Added Effective from and to date to MBS Item file
. * V10.14.01 27/06/2019 Richa Phogat   TSK 0827497
. *           Updated SPNZSP13, SPNZSP14, SPNZSP15 by replacing Move to Pack
. * V9.08.00  05/10/2006 Jill Habasque  CAR 120004
. *           Created Include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear CGI Parameters for NZPSPRFD
.------------------------------------------------------------------------
CPNZSP00  MOVE      Z70,NZSPR001
          MOVE      Z70,NZSPR002
          MOVE      Z70,NZSPR003
          MOVE      Z70,NZSPR004
          MOVE      Z70,NZSPR005
          MOVE      Z70,NZSPR006
          MOVE      Z70,NZSPR007
          MOVE      Z70,NZSPR008
          MOVE      Z70,NZSPR009
          MOVE      Z70,NZSPR010
          MOVE      Z70,NZSPR011
          MOVE      Z70,NZSPR012
          MOVE      Z70,NZSPR013
          MOVE      Z70,NZSPR014
          MOVE      Z70,NZSPR015
          MOVE      Z70,NZSPR016
          MOVE      Z70,NZSPR017
          MOVE      Z70,NZSPR018
          MOVE      Z70,NZSPR019
          MOVE      Z70,NZSPR020
          MOVE      Z70,NZSPR021
          MOVE      Z70,NZSPR022
          MOVE      Z70,NZSPR023
          MOVE      Z70,NZSPR024
          MOVE      Z70,NZSPR025
.
CPNZSP99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for NZPSPRFD
.------------------------------------------------------------
SPNZSP00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPNZSP01,SPNZSP02,SPNZSP03,SPNZSP04,SPNZSP05:
                       SPNZSP06,SPNZSP07,SPNZSP08,SPNZSP09,SPNZSP10:
                       SPNZSP11,SPNZSP12,SPNZSP13,SPNZSP14,SPNZSP15:
                       SPNZSP16,SPNZSP17,SPNZSP18,SPNZSP19,SPNZSP20:
                       SPNZSP21,SPNZSP22,SPNZSP23,SPNZSP24,SPNZSP25
.
          MOVE      ONE,EXIT
          GOTO      SPNZSP99
.
SPNZSP01  PACK      NZSPR001,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP02  PACK      NZSPR002,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP03  PACK      NZSPR003,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP04  PACK      NZSPR004,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP05  PACK      NZSPR005,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP06  PACK      NZSPR006,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP07  PACK      NZSPR007,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP08  PACK      NZSPR008,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP09  PACK      NZSPR009,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP10  PACK      NZSPR010,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP11  PACK      NZSPR011,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP12  PACK      NZSPR012,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP13  PACK      NZSPR013,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP14  PACK      NZSPR014,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP15  PACK      NZSPR015,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP16  PACK      NZSPR016,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP17  PACK      NZSPR017,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP18  PACK      NZSPR018,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP19  PACK      NZSPR019,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP20  SQUEEZE   QRYDATA
          MOVE      QRYDATA,NZSPR020
          GOTO      SPNZSP99
.
SPNZSP21  PACK      NZSPR021,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP22  PACK      NZSPR022,QRYDATA,SP70
          GOTO      SPNZSP99
.
SPNZSP23  PACK      NZSPR023,QRYDATA,SP70
          GOTO      SPNZSP99
. 
SPNZSP24  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      NZSPR024,CCENT,CYEAR,CMON,CDAY,SP70
          MATCH     SP70,NZSPR024
          IF        !@EQUAL
            REP       " 0",NZSPR024
          ENDIF
          GOTO      SPNZSP99
.
SPNZSP25  PACK      NZSPR025,QRYDATA,SP70
          GOTO      SPNZSP99
. 
SPNZSP99  RETURN
.------------------------------------------------------------
. Output NZPSPRFD Fields
.------------------------------------------------------------
NZSP0000  BRANCH    FLDITMNO,NZSP0100,NZSP0200,NZSP0300,NZSP0400,NZSP0500:
                             NZSP0600,NZSP0700,NZSP0800,NZSP0900,NZSP1000:
                             NZSP1100,NZSP1200,NZSP1300,NZSP1400,NZSP1500:
                             NZSP1600,NZSP1700,NZSP1800,NZSP1900,NZSP2000:
                             NZSP2100,NZSP2200,NZSP2300,NZSP2400,NZSP2500:
                             NZSP2600,NZSP2700,NZSP2800,NZSP2900,NZSP3000:
                             NZSP3100,NZSP3200,NZSP3300,NZSP3400,NZSP3500:
                             NZSP3600,NZSP3700,NZSP3800
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      NZSP9999
.
NZSP0100  WRITE     HTMLFILE;NZSPADMN;           * admission number
          GOTO      NZSP9999
.
NZSP0200  MOVE      "CL",CATEGORY                * claim code
          MOVE      NZSPCLMN,CODE
          CALL      CODITM00 
          GOTO      NZSP9999
.
NZSP0300  MOVE      NZSPSURG,DOCTCODE            * surgeon
          CALL      DOCDET00
          GOTO      NZSP9999
.
NZSP0400  UNPACK    DIM127,D1,KEY1,DIM127        * procedure
          MOVE      ZERO,F1                      * .0   Code .1 Description
          MOVE      KEY1,F1
          MATCH     SP70,NZSPPROC
          GOTO      NZSP9999 IF EQUAL
          BRANCH    F1,NZSP0420
.
NZSP0410  WRITE     HTMLFILE;NZSPPROC;
          GOTO      NZSP9999
.
NZSP0420  PACK      KEY17,NZSPPROC,SP70
          CALL      PATITMRD
          BRANCH    OVRCD,NZSP9999
          WRITE     HTMLFILE;IDESC;
          GOTO      NZSP9999
.
NZSP0500  WRITE     HTMLFILE;NZSPUNIQ;           * unique count
          GOTO      NZSP9999
.
NZSP0600  UNPACK    DIM127,D1,KEY1,DIM127        * contract
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,NZSP0610,NZSP0620
          MATCH     SP70,NZSPCNTR
          GOTO      NZSP9999 IF EQUAL
          WRITE     HTMLFILE;NZSPCNTR;
          GOTO      NZSP9999
.
NZSP0610  PACK      KEY14,NZSPCNTR,ZERO,ZERO,ZERO,ZERO,SP10
          CALL      RDFUND1
          IF        OVRCD=0
            WRITE     HTMLFILE;HFNAME;
          ELSE
            WRITE     HTMLFILE;NZSPCNTR;
          ENDIF
          GOTO      NZSP9999
.
.   Display Selection List for health fund
.
NZSP0620  PACK      KEY14,SP70
          CALL      RDSFUND1
NZSP0625  CALL      RDKFUND1
          BRANCH    OVRCD,NZSP9999
.
          BRANCH    PHFTACT,NZSP0625   * if code is inactive,ignore
.
          MATCH     HCODE,NZSPCNTR
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",HCODE,"#" selected> ":
                               HCODE,": ",HFNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",HCODE,"#"> ":
                               HCODE,": ",HFNAME,"</option>"
          ENDIF
          GOTO      NZSP0625
.
NZSP0700  WRITE     HTMLFILE;NZSPCPRC;           * contract code
          GOTO      NZSP9999
.
NZSP0800  WRITE     HTMLFILE;NZSPPRIM;           * primary yes/no
          GOTO      NZSP9999
.
NZSP0900  PACK      DOCTCODE,NZSPANAE,SP70       * anaesthetist
          CALL      DOCDET00             
          GOTO      NZSP9999
.
NZSP1000  WRITE     HTMLFILE;NZSPPDES;           * procedure description
          GOTO      NZSP9999
.
NZSP1100  WRITE     HTMLFILE;NZSPICAP;           * invoice capture status
          GOTO      NZSP9999
.
NZSP1200  WRITE     HTMLFILE;NZSPPIND;           * planned/performed
          GOTO      NZSP9999
.
NZSP1300  WRITE     HTMLFILE;NZSPPINS;           * insurance
          GOTO      NZSP9999
.
NZSP1400  MOVE      "I ",CATEGORY                * Insurer
          MOVE      NZSPINSR,CODE
          CALL      CODITM00 
          GOTO      NZSP9999
.
NZSP1500  WRITE     HTMLFILE;NZSPAPRV;           * approval number
          GOTO      NZSP9999
.
NZSP1600  WRITE     HTMLFILE;NZSPAPSI;           * approval sighted
          GOTO      NZSP9999
.
NZSP1700  WRITE     HTMLFILE;NZSPCLNO;           * claim number
          GOTO      NZSP9999
.
NZSP1800  WRITE     HTMLFILE;NZSPAPNT;           * approval notes
          GOTO      NZSP9999
.
NZSP1900  WRITE     HTMLFILE;NZSPCMNT;           * comment
          GOTO      NZSP9999
.
NZSP2000  WRITE     HTMLFILE;NZSPTDUR;           * minutes of theatre duration
          GOTO      NZSP9999
.
NZSP2100  WRITE     HTMLFILE;NZSPTFEE;           * theatre fee
          GOTO      NZSP9999
.
NZSP2200  MOVE      "UJ",CATEGORY                * user defined 1
          MOVE      NZSPUDF1,CODE
          CALL      CODITM00 
          GOTO      NZSP9999
.
NZSP2300  MOVE      "UK",CATEGORY                * user defined 2
          MOVE      NZSPUDF2,CODE
          CALL      CODITM00 
          GOTO      NZSP9999
.
NZSP2400  MATCH     NZSPCDAT,SP70
          GOTO      NZSP9999 IF EQUAL
.
          UNPACK    NZSPCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      NZSP9999
.
NZSP2500  WRITE     HTMLFILE;NZSPCTIM;
          GOTO      NZSP9999
.
NZSP2600  PACK      KEY10,NZSPCUID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,NZSP9999
.
          WRITE     HTMLFILE;WBSENAM;
          GOTO      NZSP9999
.
NZSP2700  MATCH     NZSPUDAT,SP70
          GOTO      NZSP9999 IF EQUAL
.
          UNPACK    NZSPUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      NZSP9999
.
NZSP2800  WRITE     HTMLFILE;NZSPUTIM;
          GOTO      NZSP9999
.
NZSP2900  PACK      KEY10,NZSPUUID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,NZSP9999
.
          WRITE     HTMLFILE;WBSENAM;
          GOTO      NZSP9999
.
NZSP3000  MATCH     NZSPADTE,SP70
          GOTO      NZSP9999 IF EQUAL
.
          UNPACK    NZSPADTE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      NZSP9999
.         
NZSP3100  WRITE     HTMLFILE;NZSPFFEE;
          GOTO      NZSP9999
.
NZSP3200  WRITE     HTMLFILE;NZSPHPAY;
          GOTO      NZSP9999
.
NZSP3300  WRITE     HTMLFILE;NZSPCPAY;
          GOTO      NZSP9999
.
NZSP3400  WRITE     HTMLFILE;NZSPFADJ;
          GOTO      NZSP9999
.
NZSP3500  WRITE     HTMLFILE;NZSPHADJ;
          GOTO      NZSP9999
.
NZSP3600  WRITE     HTMLFILE;NZSPCADJ;
          GOTO      NZSP9999
.
NZSP3700  WRITE     HTMLFILE;NZSPUNTH;
          GOTO      NZSP9999
.
NZSP3800  WRITE     HTMLFILE;NZSPINVD;
          GOTO      NZSP9999
.
NZSP9999  RETURN
.
.------------------------------------------------------------
. Clear file variables for NZPSPRFD
.------------------------------------------------------------
CLNZSP00  MOVE      SP70,NZSPADMN
          MOVE      SP70,NZSPCLMN
          MOVE      SP70,NZSPSURG
          MOVE      SP70,NZSPPROC
          MOVE      SP70,NZSPUNIQ
          MOVE      SP70,NZSPCNTR
          MOVE      SP70,NZSPCPRC
          MOVE      ZERO,NZSPPRIM
          MOVE      SP70,NZSPANAE
          MOVE      SP70,NZSPPDES
          MOVE      ZERO,NZSPICAP
          MOVE      ZERO,NZSPPIND
          MOVE      ZERO,NZSPPINS
          MOVE      SP70,NZSPINSR
          MOVE      SP70,NZSPAPRV
          MOVE      ZERO,NZSPAPSI
          MOVE      SP70,NZSPCLNO
          MOVE      SP70,NZSPAPNT
          MOVE      SP70,NZSPCMNT
          MOVE      ZERO,NZSPTDUR
          MOVE      ZERO,NZSPTFEE
          MOVE      ZERO,NZSPFFEE
          MOVE      ZERO,NZSPHPAY
          MOVE      ZERO,NZSPCPAY
          MOVE      ZERO,NZSPFADJ
          MOVE      ZERO,NZSPHADJ
          MOVE      ZERO,NZSPCADJ
          MOVE      SP70,NZSPUDF1
          MOVE      SP70,NZSPUDF2
          MOVE      SP70,NZSPCDAT
          MOVE      SP70,NZSPCTIM
          MOVE      SP70,NZSPCUID
          MOVE      SP70,NZSPUDAT
          MOVE      SP70,NZSPUTIM
          MOVE      SP70,NZSPUUID
          MOVE      SP70,NZSPADTE
          MOVE      SP70,NZSPUNTH
          MOVE      SP70,NZSPSPAR
.
CLNZSP99  RETURN
.
.------------------------------------------------------------
.  Update NZPSPRFD file
.------------------------------------------------------------
MVNZSP00  MATCH     NZSPR001,Z70
          IF        !@EQUAL
            MOVE      NZSPR001,NZSPADMN
          ENDIF
.
          MATCH     NZSPR002,Z70
          IF        !@EQUAL
            MOVE      NZSPR002,NZSPCLMN
          ENDIF
.
          MATCH     NZSPR003,Z70
          IF        !@EQUAL
            MOVE      NZSPR003,NZSPSURG
          ENDIF
.
          MATCH     NZSPR004,Z70
          IF        !@EQUAL
            MOVE      NZSPR004,NZSPPROC
          ENDIF
.
          MATCH     NZSPR005,Z70
          IF        !@EQUAL
            MOVE      NZSPR005,NZSPUNIQ
          ENDIF
.
          MATCH     NZSPR006,Z70
          IF        !@EQUAL
            MOVE      NZSPR006,NZSPCNTR
          ENDIF
.
          MATCH     NZSPR007,Z70
          IF        !@EQUAL
            MOVE      NZSPR007,NZSPCPRC
          ENDIF
.
          MATCH     NZSPR008,Z70
          IF        !@EQUAL
            MOVE      NZSPR008,NZSPPRIM
          ENDIF
.
          MATCH     NZSPR009,Z70
          IF        !@EQUAL
            MOVE      NZSPR009,NZSPANAE
          ENDIF
.
          MATCH     NZSPR010,Z70
          IF        !@EQUAL
            MOVE      NZSPR010,NZSPPDES
          ENDIF
.
          MATCH     NZSPR011,Z70
          IF        !@EQUAL
            MOVE      NZSPR011,NZSPICAP
          ENDIF
.
          MATCH     NZSPR012,Z70
          IF        !@EQUAL
            MOVE      NZSPR012,NZSPPIND
          ENDIF
.
          MATCH     NZSPR013,Z70
          IF        !@EQUAL
            MOVE      NZSPR013,NZSPPINS
          ENDIF
.
          MATCH     NZSPR014,Z70
          IF        !@EQUAL
            MOVE      NZSPR014,NZSPINSR
          ENDIF
.
          MATCH     NZSPR015,Z70
          IF        !@EQUAL
            MOVE      NZSPR015,NZSPAPRV
          ENDIF
.
          MATCH     NZSPR016,Z70
          IF        !@EQUAL
            MOVE      NZSPR016,NZSPAPSI
          ENDIF
.
          MATCH     NZSPR017,Z70
          IF        !@EQUAL
            MOVE      NZSPR017,NZSPCLNO
          ENDIF
.
          MATCH     NZSPR018,Z70
          IF        !@EQUAL
            MOVE      NZSPR018,NZSPAPNT
          ENDIF
.
          MATCH     NZSPR019,Z70
          IF        !@EQUAL
            MOVE      NZSPR019,NZSPCMNT
          ENDIF
.
          MATCH     NZSPR020,Z70
          IF        !@EQUAL
            SQUEEZE   NZSPR020
            MOVE      NZSPR020,NZSPTDUR
          ENDIF
.
          MATCH     NZSPR021,Z70
          IF        !@EQUAL
            MOVE      NZSPR021,NZSPTFEE
          ENDIF
.
          MATCH     NZSPR022,Z70
          IF        !@EQUAL
            MOVE      NZSPR022,NZSPUDF1
          ENDIF
.
          MATCH     NZSPR023,Z70
          IF        !@EQUAL
            MOVE      NZSPR023,NZSPUDF2
          ENDIF
.
          MATCH     NZSPR024,Z70
          IF        !@EQUAL
            MOVE      NZSPR024,NZSPADTE
          ENDIF
.
          MATCH     NZSPR025,Z70
          IF        !@EQUAL
            MOVE      NZSPR025,NZSPUNTH
          ENDIF
.
MVNZSP99  RETURN
