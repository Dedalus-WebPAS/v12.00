.**********************************************************************
. SINORDPR - print purchase order routine
. SINORDLU - print purchase order lineup routine
.
.  Returns  EXIT    (0=printed 1=missing or locked)
.
.  Requires SIPAPON (Purchase order number)
.           NOPRINT (0=print from this routine, 1=print elsewhere)
.           SELPRINT called prior to this routine   } These two requirements
.           Open Files : IBACODE1 + IBAPRINT1       } exist in function SELPRT00
.           Includes   : IBACODFD/INC IBAPRNFD/INC
.                        IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.                        SINTMPDF/INC SINCODFD/IO  SINORIFD/IO  APSMASFD/IO
.                        SINSIAFD/IO  SINPOAFD/IO  SINPOBFD/INC SINPOCFD/INC
.                        SINPODFD/IO
.           Note : already includes IBAPASFD & IBAPASIO
.
.  Mods:
.         V9.04.01  26/10/2004  Mike Laming   CAR 54244
.                   Change HPURCHP=12 (St Andrews Bris) to add 15 lines
.                   to the top of each page
.         18/03/2003  Davin  Quote 15040
.                     Print new delivery point for MHAC (18)
.**********************************************************************
.
.-----------------------------------------------------------------------
. HPURCHP : 0   1   2   3   4   5   6    7    8    9   10  11  12  13  14  15
. SITE    : HRH STV MER SAI HWK MOD SAR  DAR  STH  MAT SVL EPW SAB ACC BUD STG
. HPURCHP : 16  17  18
. SITE    : PHS LAS MHG
.-----------------------------------------------------------------------
.
SINORDPR  READ      CONTROLF,TWENTY3;*124,HORDDES 
          READ      CONTROLF,TWENTY6;*248,HPURCHP
.
          MOVE      SP70,EARLYDEL
.
          IF        NOPRINT=0
            CALL      OPNPRINT              * open print file
          ENDIF
.
          CALL      PORD0000                * print routine
          BRANCH    EXIT,SINORP99           * could not print ?
.                                           * check if anything to print
          IF        NOPRINT=0
            IF        !(CPAGENO>0)
              DISPLAY   *P1:24,*B,*EL,"Nothing to Print for PO ",SIPAPON," - ";
              CALL      HITENTER
            ENDIF
            DISPLAY   *P1:24,*EL;
          ENDIF
.
SINORP99  IF        NOPRINT=0
            CALL      CLSPRINT              * Open print file
          ENDIF
          RETURN
.********************************************************************
. PORD - print report
.        Requires SIPAPON (Purchase order number)
.        Returns  EXIT    (0=printed 1=missing or locked)
.********************************************************************
PORD0000  PACK      KEY7,SIPAPON,SP70            * lock purchase order record
          REPEAT
            CALL      RLSIPA1
            BRANCH    OVRCD,PORD9100             * 1=missing, 2=locked
            IF        OVRCD=2
              KEYIN     *P1:24,*EL,"Purchase Order Locked - (":
                        *V2LON,"R",*HOFF,")etry or e(":
                        *V2LON,"X",*HOFF,")it ? ",*V2LON,ANS
              PACK      ANS,ANS,SP70
              REP       UPPLOW,ANS
              MATCH     "E",ANS
              GOTO      PORD9500 IF EQUAL
              MATCH     "X",ANS
              GOTO      PORD9500 IF EQUAL
            ENDIF
          UNTIL     OVRCD=0
.
.                                           * set up no. of items & get ph. no.
          READ      CONTROLF,TEN3;CHADD1,CHADD2,CHPOST:
                                 *129,CHTELEB
          MOVE      "20",MAXITEMS
          IF        HPURCHP=1
            MOVE      "18",MAXITEMS
          ENDIF
          IF        HPURCHP=2 | HPURCHP=11
            MOVE      "20",MAXITEMS        * RKS 19/9/94
          ENDIF
          IF        HPURCHP=3
            MOVE      "20",MAXITEMS
          ENDIF
          IF        HPURCHP=4
            MOVE      "22",MAXITEMS
          ENDIF
          IF        HPURCHP=5
            MOVE      "20",MAXITEMS
          ENDIF
          IF        HPURCHP=6
            MOVE      "21",MAXITEMS        * RKS 20/9/94
          ENDIF
          IF        HPURCHP=7
            MOVE      "26",MAXITEMS        * RKS 20/9/94
          ENDIF
          IF        HPURCHP=8
            MOVE      "22",MAXITEMS        * RKS 23/2/95
          ENDIF
          IF        HPURCHP=9
            MOVE      "21",MAXITEMS        * RKS 23/2/95
          ENDIF
          IF        HPURCHP=10
            MOVE      "35",MAXITEMS
          ENDIF
          IF        HPURCHP=12
            MOVE      "21",MAXITEMS
          ENDIF
          IF        HPURCHP=13
            MOVE      "21",MAXITEMS
          ENDIF
          IF        HPURCHP=14
            MOVE      "24",MAXITEMS
          ENDIF
          IF        HPURCHP=15
            MOVE      "28",MAXITEMS
          ENDIF
          IF        HPURCHP=16
            MOVE      "19",MAXITEMS
          ENDIF
          IF        HPURCHP=17
            MOVE      "24",MAXITEMS
          ENDIF
          IF        HPURCHP=18
            MOVE      "21",MAXITEMS
          ENDIF
.
          DISPLAY   *P1:24,*EL,"Printing Purchase Order ",*V2LON,SIPAPON;
.
          MOVE      ZERO,CPAGENO                 * reset page no.
          MOVE      "999",CLNO                   * init last line number
          MOVE      ZERO,TF7P2                   * clear total
          MOVE      ZERO,TF7P2B                  * clear total GST
          MOVE      "1",COUNTFL1                 * count number of pages
          MOVE      "0",COUNTFL2
          CALL      WRIT0000                     * print details
.
          MOVE      CPAGENO,F2B                  * save total page number
          MOVE      ZERO,CPAGENO                 * reset page no.
          MOVE      "999",CLNO                   * init last line number
          MOVE      ZERO,TF7P2                   * clear total
          MOVE      ZERO,TF7P2B                  * clear total GST
          MOVE      "0",COUNTFL1                 * count number of pages
          CALL      WRIT0000                     * print details
.
          COMPARE   CPAGENO,ZERO
          CALL      ENDP0000 IF LESS             * print end of purchase order
          CALL      UUSIPA1
.
PORD9000  MOVE      ZERO,EXIT                    * everything is cool !!
          GOTO      PORD9999
.
.---- error messages ----
.
PORD9100
          DISPLAY   *P1:24,*EL,"Purchase Order ":
                    *V2LON,SIPAPON,*HOFF," Does Not Exist - ";
          CALL      HITENTER
          GOTO      PORD9500
.
.
PORD9500  MOVE      ONE,EXIT                     * uncool !!
.
PORD9999  RETURN
.********************************************************************
. HEAD - print report                               Called by PORD
.********************************************************************
.
HEAD0000  IF        (COUNTFL1=0)&(COUNTFL2=0)&(CPAGENO>0)
            CALL      FILP0000              * fill to end of page if printing
          ENDIF
.
          ADD       ONE,CPAGENO             * next page
          MOVE      ZERO,CLNO                * reset line number
.
          COMPARE   ONE,COUNTFL1
          GOTO      HEAD9999 IF EQUAL       * just counting pages ?
          COMPARE   ONE,COUNTFL2
          GOTO      HEAD9999 IF EQUAL       * just counting pages ?
.
          MOVE      SP10,MHGPRT
          REP       " 0",SIPADCN            * check if cancelled
          MATCH     "00000000",SIPADCN
          IF        @EQUAL
            REP       " 0",SIPADCM          * check if completed
            MATCH     "00000000",SIPADCM
            IF        @EQUAL
              REP       " 0",SIPADPR        * check if reprint
              MATCH     "00000000",SIPADPR
              IF        @EQUAL
                MOVE      SP70,KEY20
              ELSE
                MOVE      " Reprint ",MHGPRT
                MOVE      " Reprint            ",KEY20
                IF        HPURCHP=2|HPURCHP=3|HPURCHP=6|HPURCHP=11
                  MOVE      "Reprint             ",KEY20
                ENDIF
              ENDIF
            ELSE
              MOVE      "Completed",MHGPRT
              UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY
              CALL      PACDATE
              PACK      KEY20,MHGPRT,SP1,CPCDATE,SP70
            ENDIF
          ELSE
            MOVE      "Cancelled",MHGPRT
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            PACK      KEY20,MHGPRT,SP1,CPCDATE,SP70
          ENDIF
.
          PACK      KEY10,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY10
          UNPACK    KEY10,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          UNPACK    SP70,SIORHOSP,SIOREXT
          PACK      KEY3,SIPAORI,SP70
          CALL      RDSIOR1
.
          UNPACK    SP70,APMASN1,APMASN2
          UNPACK    SP70,APMASA1,APMASA2
          UNPACK    SP70,APMASA3,APMASPC,APMASTEL,APMASFAX
          UNPACK    SP70,APMASCON
          PACK      KEY5,SIPASUP,SP70
          CALL      RDAPMA1
          MATCH     SP70,APMASFAX
          IF        @EQUAL
            PACK      KEY35,APMASTEL,SP70
          ELSE
            MOVE      "  FAX ",KEY6
            STRIP     APMASTEL
            PACK      KEY35,APMASTEL,KEY6,APMASFAX,SP70
          ENDIF
.
          MOVE      SP70,SICDDESC
          MATCH     SP70,SIPAMES
          IF        !@EQUAL
            MOVE      "ME ",KEY3
            PACK      KEY6,KEY3,SIPAMES,SP70
            CALL      RDSICD1
          ENDIF
          PACK      MESSDESK,SICDDESC,SP70
.
          MOVE      SP70,SICDDESC
          MATCH     SP70,SIPACON
          IF        !(@EQUAL)
            MOVE      "CF ",KEY3
            PACK      KEY6,KEY3,SIPACON,SP70
            CALL      RDSICD1
          ENDIF
          PACK      CONFDESK,SICDDESC,SP70
.
          MOVE      CPAGENO,F2A
.
          MOVE      SP70,SIWADES
          PACK      KEY5,SIPAWAR,SP70
          CALL      RDSIWA1
.
          IF        HPURCHP=0
            PRINT     *N:
                      *87,SIPAPON,*N,*N:
                      *83,F2A,*91,F2B,*N:
                      *41,SP8,KEY20,*N:
                      *83,CPCDATE,*N:
                      *41,CONFDESK,*N,*N,*N:
                      *15,APMACRD,*N,*N:
                      *3,APMASN1,*40,SIPADEL,*N:
                      *3,APMASN2,*N:
                      *3,APMASA1,*47,SIPAICN,*N:
                      *3,APMASA2,*N:
                      *3,APMASA3,*29,APMASPC,*47,SIOREXT,*82,CHTELEB,*N:
                      *3,KEY35,*N:
                      *3,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=1
            PRINT     *87,SIPAPON,*N,*N:
                      *83,F2A,"  of  ",*91,F2B,*N:
                      *41,KEY20,*N:
                      *83,CPCDATE,*N:
                      *41,CONFDESK,*N,*N,*N:
                      *15,APMACRD,*N,*N:
                      *3,APMASN1,*40,SIPADEL,*N:
                      *3,APMASN2,*N:
                      *3,APMASA1,*45,SIPAICN,*N:
                      *3,APMASA2,*N:
                      *3,APMASA3,*29,APMASPC,*45,SIOREXT,*N:
                      *3,KEY35,*N:
                      *3,MESSDESK,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=2
            MOVE      SIPCUR1,DIM8
            PRINT     *N,*N,*N,*N:
                      *71,HORDDES,SIPAPON,*97,DIM8,*N:
                      *93,"Page ",F2A," of ",F2B,*N,*N:
                      *19,APMASN1,*N:
                      *19,APMASN2,*66,CPCDATE,*N:
                      *19,APMASA1,*N:
                      *19,APMASA2,*66,SIPAICN,*N:
                      *19,APMASA3,SP1,APMASPC,*66,SIPASCN,*N:
                      *19,MESSDESK,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=3
            PRINT     *N,*N,*N,*N,*N:
                      *69,HORDDES,SIPAPON,*N:
                      *93,"Page ",F2A," of ",F2B,*N,*N:
                      *5,SIPASUP,*19,APMASN1,*65,KEY20,*N:
                                 *19,APMASN2,*65,CPCDATE,*95,SIWADES,*N:
                                 *19,APMASA1,*N:
                                 *19,APMASA2,*65,SIPAICN,*N:
                                 *19,APMASA3,SP1,APMASPC,*65,SIPASCN:
                                     *100,SIPAWAR,*N,*N:
                                 *19,MESSDESK,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=4
            PRINT     *87,SIPAPON,*N,*N:
                      *83,F2A,*91,F2B,*N:
                      *41,SP8,KEY20,*N:
                      *83,CPCDATE,*N:
                      *41,CONFDESK,*N,*N,*N:
                      *15,APMACRD,*N,*40,SIPADEL,*N:
                      *3,APMASN1,*N:
                      *3,APMASN2,*40,MESSDESK,*N:
                      *3,APMASA1,*47,SIPAICN,*N:
                      *3,APMASA2,*N:
                      *3,APMASA3,*29,APMASPC,*47,SIOREXT,*87,CHTELEB,*N:
                      *3,KEY35,*N:
                      *3,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=5
            PRINT     *N,*93,SIPAPON,*N:
                      *73,"Page : ",F2A,*92,CPCDATE:
                      *N,*73,KEY20,*N,*N,*N,*N,*N,*N:
                      *16,APMASN1,*N:
                      *16,APMASN2,*N:
                      *16,APMASA1,*N:
                      *16,APMASA2,*N:
                      *16,APMASA3,SP1,APMASPC,*N,*N,*N:
                      *N,*9,MESSDESK,*73,SIPADEL,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=6
            UNPACK    SP70,SICACODE,SICADESC
            MATCH     SP70,SIPACST
            IF        !@EQUAL
              PACK      KEY5,SIPACST,SP70
              CALL      RDSICA1
              IF        OVRCD<>0
                UNPACK    SP70,SICADESC,SICACODE
              ENDIF
            ENDIF
            MOVE      SICADESC,KEY20
            MOVE      SIPCUR1,DIM8
            PRINT     *N,*N,*N,*N,*N,*N:
                      *70,HORDDES,SIPAPON,*96,DIM8,*N:
                      *92,"Page ",F2A," of ",F2B,*N,*N:
                      *18,APMASN1,*N:
                      *18,APMASN2,*65,CPCDATE,*88,KEY20,*N:
                      *18,APMASA1,*N:
                      *18,APMASA2,*65,SIPAICN,*N:
                      *18,APMASA3,SP1,APMASPC,*65,SIPASCN,*96,SICACODE,*N:
                      *18,MESSDESK,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=7
            CALL      SET7P000          * Set Option 7 Parameters
.
            PRINT     *N,*N,*N:
                      *11,HNAME,*N:
                      *11,CHADD1,*60,"Phone:  ",CHTELEB,*N:
                      *11,CHADD2,*44,CHPOST,*60,"Fax  :  ",SNCOFAXN,*N,*N:
                      *60,"PURCHASE ORDER: *",SIPAPON,SP3,WVHAMESS,*N,*N:
                      *6,"To:  ",APMASN1,*60,"Date:",*66,CPCDATE:
                      *N,*11,APMASN2,*N,*11,APMASA1,*N,*11,APMASA2,*N:
                      *11,APMASA3,*44,APMASPC,*N,*N:
                      *4,"*----------------------------------------":
                         "----------------------------------------*",*N:
                      *6,"QTY",*12,"UNIT OF SUPPLY":
.                     *28,"DESCRIPTION",*63,"PART",*72,"UNIT PRICE",*N:
                      *28,"DESCRIPTION",*63,"HOSP",*76,"EXTENDED",*N:
                      *63,"CODE",*78,"COST  ",*N:
                      *4,"*----------------------------------------":
                         "----------------------------------------*"
          ENDIF
.
          IF        HPURCHP=8
            MOVE      SIPCUR1,DIM8               * Req. Number 1
            MOVE      SIPCUR2,KEY8               * Req. Number 2
            PACK      KEY13,SP70
            MATCH     SP5,SIPACST
            IF        @EQUAL
              MOVE      SIPAWAR,KEY5
              CALL      RDSIWA1
              IF        OVRCD=0
                PACK      KEY13,SIWADES
              ENDIF
            ELSE
              MOVE      SIPACST,KEY5
              CALL      RDSICA1
              IF        OVRCD=0
                PACK      KEY13,SICADESC
              ENDIF
            ENDIF
            PRINT     *N,*N,*N,*N:
                      *49,WVHAMESS,*N:
                      *71,HORDDES,SIPAPON,*95,DIM8,*N,*95,KEY8,*N,*N,*N:
                      *14,APMASN1,*57,CPCDATE,*88,KEY13,*N:
                      *14,APMASN2,*N:
                      *14,APMASA1,*57,SIPAICN,*N:
                      *14,APMASA2,*57,SIOREXT,*91,KEY5,*N:
                      *14,APMASA3,*44,APMASPC,*N:
                      *14,MESSDESK,*57,SIPASCN,*N:
                      *32,SIPASUP,*57,APMASFAX,*N,*N
          ENDIF
.
          IF        HPURCHP=9
            MOVE      SIPCUR1,DIM8               * Req. Number 1
            MOVE      SIPCUR2,KEY8               * Req. Number 2
            PACK      KEY13,SP70
            MOVE      SIPCCST,KEY5
            CALL      RDSICA1
            IF        OVRCD=0
              PACK      KEY13,SICADESC
            ENDIF
            PRINT     *N,*N,*N,*N:
                      *49,WVHAMESS,*N,*N:
                      *71,HORDDES,SIPAPON,*95,DIM8,*N,*95,KEY8,*N,*N:
                      *17,APMASN1,*N:
                      *17,APMASN2,*63,CPCDATE,*N:
                      *17,APMASA1,*N:
                      *17,APMASA2,*63,SIPAICN,*N:
                      *17,APMASA3,*44,APMASPC,*63,APMASCON,*N:
                      *17,MESSDESK,*63,CONFDESK,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=10
.. * QUOTE 9871 - Change matrix printer Landscape into matrix printer Potrait
.. *              using 12 Cpi
..            PRINT     *N:
..                      *118,SIPAPON,*N,*N:
..                      *66,SP8,KEY20,*115,F2A,*123,F2B,*N:
..                      *66,CONFDESK,*N:
..                      *120,CPCDATE,*N:
..                      *25,APMACRD,*N:
..                      *13,APMASN1,*N:
..                      *13,APMASN2,*N,*73,SIPADEL:
..                      *13,APMASA1,*N:
..                      *13,APMASA2,*N,*79,SIPAICN:
..                      *13,APMASA3,*39,APMASPC,*N:
..                      *13,KEY35,*N,*79,SIOREXT:
..                      *13,MESSDESK,*N,*N,*120,CHTELEB,*N,*N,*N
            CALL      LCOMT000
            PRINT     *N:
                      *91,SIPAPON,*N:
                      *47,KEY20,*N:
                      *88,F2A,*96,F2B,*N:
                      *40,CONFDESK,*N:
                      *25,APMACRD,*88,CPCDATE,*N:
                      *1,APMASN1,*N:
                      *1,APMASN2,*58,SIPADEL,*N:
                      *1,APMASA1,*N:
                      *1,APMASA2,*68,SIPAICN,*N:
                      *1,APMASA3,SP1,APMASPC,*N:
                      *1,KEY35,*68,SIOREXT,*N:
                      *N:
                      *1,MESSDESK,*N:
                      *1,COMMENT1,*N:
                      *1,COMMENT2,*N:
                      *1,COMMENT3,*N:
                      *1,COMMENT4,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=11
            MOVE      SIPCUR1,DIM8
            PRINT     *N,*N,*N,*N,*N:
                      *71,HORDDES,SIPAPON,*97,DIM8,*N:
                      *93,"Page ",F2A," of ",F2B,*N,*N:
                      *19,APMASN1,*N:
                      *19,APMASN2,*66,CPCDATE,*N:
                      *19,APMASA1,*N:
                      *19,APMASA2,*66,SIPAICN,*N:
                      *19,APMASA3,SP1,APMASPC,*66,SIPASCN,*N:
                      *19,MESSDESK,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=12
            PACK      KEY21,SP70
            MATCH     SP5,SIPACST
            IF        @EQUAL
              MOVE      SIPAWAR,KEY5
              CALL      RDSIWA1
              IF        OVRCD=0
                PACK      KEY21,SIWADES
              ENDIF
            ELSE
              MOVE      SIPACST,KEY5
              CALL      RDSICA1
              IF        OVRCD=0
                PACK      KEY21,SICADESC
              ENDIF
            ENDIF
            PRINT     *N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:    *I-54244
                      *89,CPCDATE,*N:
                      *15,"Page ",F2A," of ",F2B,*N,*N:
.......         *64,HORDDES,SIPAPON,*N:  * Changed 21/10/96 Quote 8703
                      *65,SIPAPON,SP1,KEY20,*N:
                      *89,SIPAICN,*N:
                      *5,SIPASUP,*15,APMASN1,*89,SIPASCN,*N:
                      *15,APMASN2,*N:
                      *15,APMASA1,*89,KEY21,*113,SIPAUR1,*N:
                      *15,APMASA2,*113,SIPAUR2,*N: 
                      *15,APMASA3,SP1,APMASPC,*89,KEY5,*N,*N:
                      *15,MESSDESK,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=13
            MOVE      SIPCUR1,DIM8               * Req. Number 1
            MOVE      SIPCUR2,KEY8               * Req. Number 2
            PRINT     *N,*81,"Page :",F2A,*N,*N,*N,*N:
                      *N,*13,APMASN1,*63,HORDDES,SIPAPON:
                      *N,*5,APMACRD,*13,APMASN2:
                      *N,*13,APMASA1,*62,CPCDATE:
                      *N,*13,APMASA2:
                      *N,*13,APMASA3,SP4,APMASPC,*55,CONFDESK,*N:
                      *N,*21,APMASTEL:
                      *N,*55,DIM8:
                      *N,*21,SIPASCN,*55,KEY8:
                      *N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=14
            PACK      APPPDES,SP70
            MOVE      APMAPPD,KEY2
            CALL      RDAPPP1
            UNPACK    APMAUR1,DIM15,DIM15A
            UNPACK    SIPADEL,DIM15A,DIM15B
            MOVE      SIWADES,DIM35
            PRINT     *104,HORDDES,SIPAPON:
                      *N,*N,*104,CPCDATE:
                      *N,*N,*104,F2A:
                      *N,*N,*64,SIORNAME,*N:
                      *N,*2,APMACRD,*14,APMASN1,*89,APPPDES:
                      *N,*14,APMASN2:
                      *N,*14,APMASA1,*60,DIM15,*89,CONFDESK:
                      *N,*14,APMASA2:
                      *N,*14,APMASA3,SP4,APMASPC,*57,SIPASCN:
                      *N,*57,APMASTEL,*89,DIM15A:
                      *N,*14,SIPAWAR," ",DIM35,*57,APMASFAX,*89,DIM15B:
                      *N,*N,*N
          ENDIF
.
          IF        HPURCHP=15
            PRINT     *N,*N,*N,*N,*N,*N,*22,APMASN1,*107,HORDDES,SIPAPON:
                      *N,*22,APMASA1:
                      *N,*22,APMASA2,*105,F2A," of ",F2B:
                      *N,*22,APMASA3,*49,APMASPC,*105,CPCDATE:
                      *N,*26,APMASTEL,*105,SIORNAME:
                      *N,*26,APMASFAX,*105,SIOREXT:
                      *N,*26,APMASCON:
                      *N,*90,CONFDESK
            CALL      LCOMT000
            PRINT     *24,COMMENT1:
                      *N,*24,COMMENT2:
                      *N,*24,COMMENT3:
                      *N,*24,COMMENT4,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=16
            UNPACK    SP70,SICACODE,SICADESC
            MATCH     SP70,SIPACST
            IF        !@EQUAL
              PACK      KEY5,SIPACST,SP70
              CALL      RDSICA1
              IF        OVRCD<>0
                UNPACK    SP70,SICADESC,SICACODE
              ENDIF
            ENDIF
            MOVE    SICADESC,KEY20
            PRINT   *N,*N,*N,*N
            MOVE    SIPAPNT,FORM1
            IF      FORM1=2|FORM1=5
              PRINT    *28,"X"
            ENDIF
            IF      FORM1=1|FORM1=4
              PRINT    *45,"X"
            ENDIF 
            IF      FORM1=3|FORM1=6|FORM1=7|FORM1=8|FORM1=0
              PRINT    *60,"X"
            ENDIF
            PRINT     *N,*N,*85,HORDDES,SIPAPON:
                      *N,*N,*N,*N:
                      *13,APMASN1,*68,CPCDATE,*95,KEY20,*N:
                      *13,APMASN2,*68,SIOREXT,*N:
                      *13,APMASA1,*68,SIPAICN,*95,SICACODE,*N:
                      *13,APMASA2,*68,SIPASCN,*N:
                      *13,APMASA3,SP1,APMASPC,*N:
                      *N,*N
          ENDIF
.
          IF        HPURCHP=17
            PRINT     *N,*102,SIPAPON,*N,*N,*N:
                      *95,F2A," of ",F2B,*N,*N:
                      *51,KEY20,*N:
                      *95,CPCDATE,*N:
                      *51,CONFDESK,*N,*N,*N,*N,*N:
                      *15,APMACRD,*56,SIPADEL,*N,*N:
                      *3,APMASN1,*N:
                      *3,APMASN2,*N:
                      *3,APMASA1,*N:
                      *3,APMASA2,*52,SIPAICN,*N:
                      *3,APMASA3,*29,APMASPC,*N,*N,*52,SIOREXT:
                      *N,*3,KEY35,*N,*N,*3,MESSDESK,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=18
            READ      CONTROLF,SIXTY3;*241,SNCOMDPC   * multiple delivery point
            COMPARE   ONE,SNCOMDPC
            IF        @EQUAL
              MOVE      SIPAMDP,KEY3
              CALL      RDSIDP1
              IF        OVRCD<>1
                PACK      COMMENT1,SIDPADD1,SP70
                PACK      COMMENT3,SIDPADD2,SP70
                PACK      COMMENT2,SP70
                PACK      COMMENT4,SP70
              ENDIF
            ELSE
              CALL      LCOMT000
              STRIP     COMMENT1
              STRIP     COMMENT2
              STRIP     COMMENT3
              STRIP     COMMENT4
            ENDIF
.
            MOVE      "Attn: ",D6
            MATCH     SP70,APMASCON
            IF        @EQUAL
              MOVE      SP70,D6
            ENDIF
            PRINT     *N,*N,*N,*N,*N,*N:
                      *13,APMASN1,*124,SIPAPON,*124,SIPAPON,*N:
                      *13,APMASN2,*56,SIORNAME,*77,"Ph:",SIOREXT:
                      *100,CPCDATE,*N:
                      *13,APMASA1,*76,"Fax:",SIORUR1:
                      *124,"Page ",F2A," of ",F2B,*N:
                      *13,APMASA2,*124,MHGPRT,*N:
                      *13,APMASA3," ",APMASPC,*56,APMACRD,*N:
                      *56,APMASTEL," Fax: ",APMASFAX,*100,DEL181,*N,*N:
                      *13,*+,COMMENT1,*-,SP1,*+,COMMENT2,*-,*N:
                      *13,*+,COMMENT3,*-,SP1,*+,COMMENT4,*-,*N,*N,*N,*N
          ENDIF
.
          UNPACK    SP70,DELDT1,DELDT2,DELDT3,DELDT4,DELDT5
          UNPACK    SP70,DELDT6,DELDT7,DELDT8,DELDT9,DELDT10
.
HEAD9999  RETURN
.********************************************************************
. LCOMT  -  Load comments for P/O 15                Called by HEAD
.********************************************************************
LCOMT000  CLEAR     COMMENT1
          CLEAR     COMMENT2
          CLEAR     COMMENT3
          CLEAR     COMMENT4
          PACK      COMMENT1,SP70
          PACK      COMMENT2,SP70
          PACK      COMMENT3,SP70
          PACK      COMMENT4,SP70
          MOVE      ONE,F4
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPB1
.
LCOMT100  CALL      RKSIPB1
          BRANCH    OVRCD,LCOMT999
.
          MATCH     SIPBPON,SIPAPON
          GOTO      LCOMT999 IF NOT EQUAL
.
          STORE     SIPBCOM,F4,COMMENT1,COMMENT2,COMMENT3,COMMENT4
          ADD       ONE,F4
          COMPARE   FIVE,F4
          GOTO      LCOMT100 IF NOT EQUAL
.
LCOMT999  RETURN

.********************************************************************
. SET7P  -  Set Option 7 Parameters                 Called by HEAD
.********************************************************************
SET7P000  MOVE      "13",SECTOR
          READ      CONTROLF,SECTOR;*1,CHADD1,CHADD2,CHPOST,*129,CHTELEB
          MOVE      "23",SECTOR
          READ      CONTROLF,SECTOR;*1,HNAME
          MOVE      "67",SECTOR
          READ      CONTROLF,SECTOR;*7,INCNBLSS,*141,INCNBLSM
          MOVE      "26",SECTOR
          READ      CONTROLF,SECTOR;*36,INCNVHAS,*132,INCNVHAM
          READ      CONTROLF,SIXTY3;*163,SNCOFAXN
.
          PACK      WVHAMESS,SP70
          MATCH     SIPASUP,INCNVHAS
          IF        @EQUAL
            PACK      WVHAMESS,INCNVHAM,SP70
          ENDIF
          MATCH     SIPASUP,INCNBLSS
          IF        @EQUAL
            PACK      WVHAMESS,INCNBLSM,SP70
          ENDIF
.
SET7P999  RETURN
.********************************************************************
. WRIT - print data line                            Called by PORD
.        Requires : COUNTFL1 (1=don't print)
.********************************************************************
.
.---- line item loop ----
.
WRIT0000  PACK      KEY10,SIPAPON,SP70         * loop through line items
          CALL      RSSIPC1
.
WRIT1000  CALL      RKSIPC1                    * get next line item
          BRANCH    OVRCD,WRIT5000
.
          MATCH     SIPCPON,SIPAPON            * at end of purchase order ?
          IF        !@EQUAL
            CALL      RPSIPC1                  * get previous details for print
            GOTO      WRIT5000
          ENDIF
.
          MATCH     EARLYDEL,SP70
          IF        @EQUAL
            MATCH     SIPCEDD,SP70
            IF        !@EQUAL
              UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
              CALL      PACDATE
              MOVE      CPCDATE,EARLYDEL
            ENDIF
          ENDIF
.
WRIT2000  MOVE      "1",COUNTFL2               * just counting !!
.
          IF        HPURCHP=18
            MATCH     SP70,SIPCEDD
            IF        !@EQUAL
              UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
              CALL      PACDATE
              MATCH     SP70,DEL181
              IF        !@EQUAL
                PACK      DEL181,CPCDATE,SP70
              ENDIF
            ENDIF
          ENDIF
.           
          MOVE      CLNO,SCLNO                 * save current line number
          MOVE      CPAGENO,SCPAGENO           * save current page number
          CALL      PRTA0000                   * count line item data lines
.                                              * check if page will be filled
.                                              * and if item goes over 1 page
          IF        (CPAGENO-1=SCPAGENO)&!(CLNO>SCLNO)&!(999=SCLNO)
            MOVE      SCLNO,CLNO               * restore current line number
            MOVE      SCPAGENO,CPAGENO         * restore current page number
            MOVE      "0",COUNTFL2
            CALL      HEAD0000                 * get next page
            GOTO      WRIT2000                 * restart from next page
          ENDIF
.
          IF        COUNTFL1=0
            MOVE      SCLNO,CLNO               * restore current line number
            MOVE      SCPAGENO,CPAGENO         * restore current page number
            MOVE      "0",COUNTFL2
            CALL      PRTA0000                 * print line item data lines
          ENDIF
.
          GOTO      WRIT1000                   * get next line item
.
.---- purchase order comment loop ----
.
WRIT5000  IF        HPURCHP=5 | HPURCHP=10 | HPURCHP=14 | HPURCHP=18
            GOTO      WRIT9000
          ENDIF
.
          PACK      KEY10,SIPAPON,SP70         * loop through purch ord comments
          CALL      RSSIPB1
.
WRIT6000  CALL      RKSIPB1                    * get next line item comment
          BRANCH    OVRCD,WRIT9000
          MATCH     SIPBPON,SIPAPON            * at end of comments ?
          GOTO      WRIT9000 IF NOT EQUAL
.
          MATCH     SIPBCOM,SP70               * blank line ?
          GOTO      WRIT6000 IF EQUAL
.
WRIT7000  COMPARE   MAXITEMS,CLNO              * end of page ?
          CALL      HEAD0000 IF NOT LESS       * start new page
          ADD       ONE,CLNO                   * increment line number
          IF        COUNTFL1=0
            IF        HPURCHP=0
              PRINT     *14,SIPBCOM
            ENDIF
.
            IF        HPURCHP=1
              PRINT     *14,SIPBCOM
            ENDIF
.
            IF        HPURCHP=2 | HPURCHP=11
              MOVE      SIPDCOM,KEY30
              PRINT     *35,KEY30
            ENDIF
.
            IF        HPURCHP=3
              PRINT     *30,SIPBCOM
            ENDIF
.
            IF        HPURCHP=4
              PRINT     *14,SIPBCOM
            ENDIF
.
            IF        HPURCHP=5
              PRINT     *27,SIPBCOM
            ENDIF
.
            IF        HPURCHP=6
              MOVE      SIPDCOM,KEY30
              PRINT     *34,KEY30
            ENDIF
.
            IF        HPURCHP=7
              MOVE      SIPDCOM,KEY30
              PRINT     *28,KEY30
            ENDIF
.
            IF        HPURCHP=8
              MOVE      SIPDCOM,KEY30
              PRINT     *29,KEY30
            ENDIF
.
            IF        HPURCHP=9
              MOVE      SIPDCOM,KEY30
              PRINT     *33,KEY30
            ENDIF
.
            IF        HPURCHP=10
              SUB       ONE,CLNO
            ENDIF
.
            IF        HPURCHP=12
              MOVE      SIPDCOM,KEY30
              PRINT     *33,KEY30
            ENDIF
.
            IF        HPURCHP=13
              MOVE      SIPDCOM,KEY30
              PRINT     *46,KEY30
            ENDIF
.
            IF        HPURCHP=15
              MOVE      SIPDCOM,KEY30
              PRINT     *44,KEY30
            ENDIF
.
            IF        HPURCHP=16
              MOVE      SIPDCOM,KEY30
              PRINT     *31,KEY30
            ENDIF
.
            IF        HPURCHP=17
              PRINT     *14,SIPDCOM
            ENDIF
.
            IF        HPURCHP=18
              PRINT     *9,SIPDCOM
            ENDIF
.
          ENDIF
          GOTO      WRIT6000
.
WRIT9000
.
WRIT9999  RETURN
.********************************************************************
. PRTA - print line items                           Called by WRIT
.        Requires : COUNTFL2 (1=dont print)
.********************************************************************
.
PRTA0000  MOVE      SP70,LINE1                 * clear lines
          MOVE      SP70,LINE2
          MOVE      SP70,LINE3
          MOVE      SP70,LINE4
          MOVE      SP70,LINE5
          MOVE      SP70,LINE6
          MOVE      SP70,LINE7
.
.---- get part number ----
.
          IF        HPURCHP=4|HPURCHP=5|HPURCHP=7|HPURCHP=10
            PACK      LINE3,SIPCPN,SP70        * SRFROB
          ENDIF
          IF       HPURCHP=0|HPURCHP=1|HPURCHP=8|HPURCHP=9|HPURCHP=13|HPURCHP=15|HPURCHP=17
            PACK      LINE1,SIPCPN,SP70
          ENDIF
.
.---- get catalog description ----
.
          MATCH     SP70,SIPCCAT               * catalog blank ?
          IF        @EQUAL
            IF      HPURCHP=4|HPURCHP=5|HPURCHP=18|(HPURCHP>=7&HPURCHP<=10|HPURCHP=16)
              MOVE      SIPCPD,LINE1
            ELSE
              MOVE      SIPCPD,LINE2
            ENDIF
          ELSE
            MOVE      SP70,SIICPD1
            MOVE      SP70,SIICPD2
            PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
            CALL      RDSIIC1
            IF        OVRCD=0
              IF        HPURCHP=4|HPURCHP=5|HPURCHP=18|(HPURCHP>=7&HPURCHP<=10|HPURCHP=16)
                MATCH     SP70,SIICPD1
                IF        @EQUAL
                  PACK      KEY7,SIPCCAT,SP70
                  CALL      RDSIIA1
                  MOVE      SIIADES,LINE1
                ELSE
                  MOVE      SIICPD1,LINE1
                  MOVE      SIICPD2,LINE2
                ENDIF
              ELSE
                MOVE      SIICPD1,LINE2
                MOVE      SIICPD2,LINE3
              ENDIF
            ELSE
              IF        HPURCHP=4|HPURCHP=5|HPURCHP=18|(HPURCHP>=7&HPURCHP<=10)|HPURCHP=13|HPURCHP=15|HPURCHP=16
                MOVE      SIPCPD,LINE1
              ELSE
                MOVE      SIPCPD,LINE2
              ENDIF
            ENDIF
          ENDIF
.
          IF        HPURCHP=4|HPURCHP=5|HPURCHP=7|HPURCHP=8|HPURCHP=9
            MOVE      SP70,LINE7
          ENDIF
.
.---- get purchase order references from contract details ----
.
          PACK      SISDPO1,SP70
          PACK      SISDPO2,SP70
          PACK      KEY45,SIPCCON,SIPASUP,SIPCCAT,SIPCCDT,SIPCSUT,SP70
          CALL      RDSISD1
          UNPACK    SISDPO1,LINE4
          UNPACK    SISDPO2,LINE5
.
          MOVE      SIPCOQT,F7
          MOVE      SIPCOQT,F5
          ASSIGN    SIPCOQT*SIPCECT,F7P2
          MOVE      SIPCECT,F8P4
          MOVE      SIPCECT,F7P2A
.
. preparation for Expected Cost Supply Unit Excluded GST & Expected GST data
.
          ASSIGN    SIPCOQT*SIPCGSTA,F7P2B
.
          IF        !(SIPCECT=-1)&(COUNTFL1=0)&(COUNTFL2=0)
            ADD       F7P2,TF7P2
            ADD       F7P2B,TF7P2B
          ENDIF
.
          IF        HPURCHP=10
            MOVE      SP5,SISACOMM
            PACK      KEY5,SIPCPRD,SP70
            CALL      RDSISA1
            MATCH     "Stock",SIPCCST
            IF        @EQUAL
              MOVE      SP70,SIWAPACC
              PACK      KEY5,SIPCWAR
              CALL      RDSIWA1
              STRIP     SIWAPACC
              PACK      LINE4,SP10,OFFUSE,SIWAPACC,HYPHEN,SISACOMM,SP70
            ELSE
              PACK      KEY5,SIPCCST,SP70
              CALL      RDSICA1
              UNPACK    SICAGL,DIM2,DIM12
              MATCH     SP20,DIM12
              IF        @EQUAL
                MOVE      SICAPACC,DIM12
                SQUEEZE   DIM12
                PACK      LINE4,SP10,OFFUSE,DIM12,SP70
              ELSE
                SQUEEZE   DIM12
                PACK      LINE4,SP10,OFFUSE,DIM12,HYPHEN,SISACOMM,SP70
              ENDIF
            ENDIF
            PACK      LINE5,SP70,SP70 
            PACK      LINE6,SP70,SP70 
            PACK      LINE7,SP70,SP70 
          ENDIF
.
          IF        HPURCHP=9|HPURCHP=8
            PACK      LINE4,SP70,SP70 
            PACK      LINE5,SP70,SP70 
            PACK      LINE6,SP70,SP70 
            PACK      LINE7,SP70,SP70 
          ENDIF
.
          IF        HPURCHP=14
            MOVE      SP70,LINE1
            MOVE      SP70,LINE2
            MOVE      SP70,LINE3
            MOVE      SP70,LINE4
            MOVE      SP70,LINE5
            MOVE      SP70,LINE6
            MOVE      SP70,LINE7
          ENDIF
.
.     ---- line item comment loop ----
.
          MOVE      "0",PRTFLAG                * nothing printed yet !!
          PACK      KEY13,SIPCPON,SIPCITM,SP70 * loop through line item comments
          CALL      RSSIPD1
.
PRTA2000  CALL      RKSIPD1                    * get next line item comment
          BRANCH    OVRCD,PRTA4000
          MATCH     SIPDPON,SIPCPON            * at end of comments ?
          GOTO      PRTA4000 IF NOT EQUAL
          MATCH     SIPDITM,SIPCITM            * at end of comments ?
          GOTO      PRTA4000 IF NOT EQUAL
.
          MATCH     SIPDCOM,SP70               * blank line ?
          GOTO      PRTA2000 IF EQUAL
.
          CALL      PRTB0000                   * print details
          GOTO      PRTA2000
.
PRTA4000  MOVE      SP70,SIPDCOM
          CALL      PRTB0000                   * make sure details printed
.
PRTA9999  RETURN
.********************************************************************
. PRTB - print line items                           Called by PRTA
.        Requires : COUNTFL2 (1=don't print)
.                   PRTFLAG  (1=main data already printed)
.********************************************************************
PRTB0000  BRANCH    PRTFLAG,PRTB1000
.
.---- prinT MAIN DATA ----
.
..........srf133756
          COMPARE   HPURCHP,TEN
          GOTO      PRTB0100 IF EQUAL
.
          IF        HPURCHP=14
            GOTO      PRTB0100
          ENDIF
.
          MATCH     LINE6,SP70              * save line
          IF        @EQUAL
            PACK      LINE6,SIPDCOM,SP70
            MATCH     SIPDCOM,SP70          * check if it is time to unload
            GOTO      PRTB9999 IF NOT EQUAL
          ELSE
            PACK      LINE7,SIPDCOM,SP70
          ENDIF
.
PRTB0100  MOVE      "0",SECTOR              * consolidate data lines
          MATCH     SP70,LINE1
          WHILE     @EQUAL & (SECTOR<7)
            ADD       ONE,SECTOR
            MOVE      LINE2,LINE1
            MOVE      LINE3,LINE2
            MOVE      LINE4,LINE3
            MOVE      LINE5,LINE4
            MOVE      LINE6,LINE5
            MOVE      LINE7,LINE6
            MOVE      SP70,LINE7
            MATCH     SP70,LINE1
          DO
          MATCH     SP70,LINE2
          WHILE     @EQUAL & (SECTOR<7)
            ADD       ONE,SECTOR
            MOVE      LINE3,LINE2
            MOVE      LINE4,LINE3
            MOVE      LINE5,LINE4
            MOVE      LINE6,LINE5
            MOVE      LINE7,LINE6
            MOVE      SP70,LINE7
            MATCH     SP70,LINE2
          DO
          MATCH     SP70,LINE3
          WHILE     @EQUAL & (SECTOR<7)
            ADD       ONE,SECTOR
            MOVE      LINE4,LINE3
            MOVE      LINE5,LINE4
            MOVE      LINE6,LINE5
            MOVE      LINE7,LINE6
            MOVE      SP70,LINE7
            MATCH     SP70,LINE3
          DO
          MATCH     SP70,LINE4
          WHILE     @EQUAL & (SECTOR<7)
            ADD       ONE,SECTOR
            MOVE      LINE5,LINE4
            MOVE      LINE6,LINE5
            MOVE      LINE7,LINE6
            MOVE      SP70,LINE7
            MATCH     SP70,LINE4
          DO
          MATCH     SP70,LINE5
          WHILE     @EQUAL & (SECTOR<7)
            ADD       ONE,SECTOR
            MOVE      LINE6,LINE5
            MOVE      LINE7,LINE6
            MOVE      SP70,LINE7
            MATCH     SP70,LINE5
          DO
          MATCH     SP70,LINE6
          WHILE     @EQUAL & (SECTOR<7)
            ADD       ONE,SECTOR
            MOVE      LINE7,LINE6
            MOVE      SP70,LINE7
            MATCH     SP70,LINE6
          DO
.
          IF        HPURCHP<>4
            COMPARE   MAXITEMS,CLNO
            CALL      HEAD0000 IF NOT LESS
          ELSE
            IF        CLNO >= (MAXITEMS-1)
              CALL      HEAD0000                 * start new page
            ELSE
              ADD       ONE,CLNO               * increment line number
              IF        COUNTFL2=0
                PRINT     SP1                  * Blank Line Between Items
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      LINE1,KEY60                * print main line 1
          IF        HPURCHP=8|HPURCHP=10
            CALL      BREAK000                 * break up line neatly to 45
          ELSE
            IF        HPURCHP=16
              CALL      BRK27000
            ELSE
              IF        HPURCHP=18
                CALL      BRK40000
              ELSE
                CALL      BKLIN000                 * Break up line to 30
              ENDIF
            ENDIF
          ENDIF
.
          ADD       ONE,CLNO                   * increment line number
.
          IF        COUNTFL2=0
            IF        F8P4=-1
              MOVE      "  T.B.A.       ",KEY13
              MOVE      "  T.B.A.       ",KEY10
              IF        HPURCHP=10
                 MOVE      "  T.B.A.  ",DUTPRC10
                 MOVE      "  T.B.A.  ",DTOGST10
              ENDIF
              IF        HPURCHP=13
                 MOVE      "       T.B.A.",KEY13
                 MOVE      "    T.B.A.",KEY10
              ENDIF
              IF        HPURCHP=14
                MOVE      "  T.B.A.",KEY8
                MOVE      "    T.B.A.",KEY10
              ENDIF
              IF        HPURCHP=16
                MOVE      "T.B.A.",KEY6
                MOVE      "  T.B.A.",KEY8
              ENDIF
              IF        HPURCHP=18
                MOVE      "T.B.A.",KEY8
                MOVE      "  T.B.A.",KEY10
              ENDIF
            ELSE
              MOVE      F8P4,KEY13
              MOVE      F7P2,KEY10
              IF        HPURCHP=10
                MOVE      F7P2A,DUTPRC10
                MOVE      F7P2B,DTOGST10
              ENDIF
              IF        HPURCHP=14
                MOVE      F8P4,FORM5P2
                MOVE      FORM5P2,KEY8
              ENDIF
              IF        HPURCHP=16
                MOVE      F8P4,FORM8P2
                MOVE      FORM8P2,KEY11
                MOVE      F7P2,KEY10
              ENDIF
              IF        HPURCHP=18
                MOVE      F8P4,FORM5P2
                MOVE      FORM5P2,KEY8
                MOVE      F7P2,KEY10
              ENDIF
            ENDIF
.
            IF        HPURCHP=0
              PRINT     *7,SIPCITM,*14,KEY30,*46,F7:
                        *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10
            ENDIF
.
            IF        HPURCHP=1
              PRINT     *7,SIPCITM,*14,KEY30,*46,F7:
                        *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10
            ENDIF
.
            IF        HPURCHP=2 | HPURCHP=11
              PRINT     *7,SIPCITM,*11,F7,*19,SIPCSUT,*35,KEY30,*68,SIPCCAT:
                        *79,KEY13,*94,SIPCCST,*100,SIPCPRD
            ENDIF
.
            IF        HPURCHP=3
              MOVE      SP70,SISACOMM
              PACK      KEY5,SIPCPRD,SP70
              CALL      RDSISA1
              MOVE      SIPCSUT,KEY11
              PRINT     *7,SIPCITM,SP1,F7,SP1,KEY11,*30,KEY30,SP7,SIPCCAT:
                        *80,KEY13,SP3,KEY10,*110,SISACOMM
            ENDIF
.
            IF        HPURCHP=4
              PRINT     *7,SIPCITM,*14,KEY30,*46,F7:
                        *55,SIPCSUT,*80,KEY13,*98,KEY10
            ENDIF
.
            IF        HPURCHP=5
              PACK      SIIANAT,SP70
              PACK      KEY7,SIPCCAT,SP20
              CALL      RDSIIA1
              PRINT     *5,F7,*13,SIPCSUT,*27,KEY30:
                        *59,SIIANAT,*69,KEY10,*80,SIPCPRD
            ENDIF
.
            IF        HPURCHP=6
              MOVE      SIPCPN,KEY15
              PRINT     *6,SIPCITM,*10,F7,*18,SIPCSUT,*34,KEY30,*67,KEY15:
                        *78,KEY13,*91,SIPCCAT,*99,SIPCPRD
            ENDIF
.
            IF        HPURCHP=7
              MOVE      SIPCPN,KEY15
              PRINT     *4,F7,*12,SIPCSUT,*28,KEY30,*62,SIPCCAT,*74,KEY10
            ENDIF
.
            IF        HPURCHP=8
              MOVE      SIPCECT,FORM8P2
              IF        FORM8P2=-1
                MOVE      "     T.B.A.    ",KEY13
              ELSE
                MOVE      FORM8P2,KEY13
              ENDIF
              PRINT     *1,SIPCITM,*5,F7,*13,SIPCSUT,*29,KEY45:
                        *75,KEY13,*86,SIPCCAT,*94,SIPCPRD
            ENDIF
.
            IF        HPURCHP=9
              MOVE      SIPCECT,FORM8P2
              IF        FORM8P2=-1
                MOVE      "     T.B.A.    ",KEY13
              ELSE
                MOVE      FORM8P2,KEY13
              ENDIF
              PRINT     *5,SIPCITM,*9,F7,*17,SIPCSUT,*33,KEY30,*65,SIPCCAT:
                        *78,KEY13,*97,SIPCPRD
            ENDIF
.
            IF        HPURCHP=10
.. * QUOTE 9871 - Change matrix printer Landscape into matrix printer Potrait
.. *              using 12 Cpi
..              PRINT     *1,SIPCITM,*10,KEY45,*54,F7:
..                        *66,SIPCSUT,*78,KEY13,*98,KEY10
              MOVE      SIPCSUT,D12
              PRINT     *1,KEY45,*47,F5:
                        *53,D12,*66,DUTPRC10,*77,DTOGST10,*88,KEY10
            ENDIF
.
            IF        HPURCHP=12
              MOVE      SP70,SISACOMM
              PACK      KEY5,SIPCPRD,SP70
              CALL      RDSISA1
              MOVE      SIPCSUT,KEY12
              PRINT     *6,SIPCITM,*14,F7,*22,KEY12,*33,KEY30,*73,SIPCCAT:
                        *83,KEY13,*98,KEY10,*111,SISACOMM
            ENDIF
.
            IF        HPURCHP=13
              MOVE      F7,F4
              MOVE      SIPCSUT,D9
              PRINT     *1,SIPCCST,SP1,SIPCPRD,*17,SIPCCAT,*27,SIPCITM:
                        *32,F4,SP1,D9,*46,KEY30,*72,KEY13,*86,KEY10
            ENDIF
.
            IF        HPURCHP=14
              MOVE      F7,F5
              MOVE      SIPCSUT,D7
              UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
              CALL      PACDATE
              MATCH     SP7,SIPCCAT
              IF        @EQUAL
                PRINT     *2,SIPCCST,*14,SIPCCAT,*27,SIPCITM:
                          *31,F5,*37,D7,*45,SIPCPD,*95,KEY8:
                          *103,KEY10
              ELSE
                PACK      SIIADES,SP70
                PACK      KEY7,SIPCCAT
                CALL      RDSIIA1
                MOVE      SIICPD1,D50
                PRINT     *2,SIPCCST,*14,SIPCCAT,*27,SIPCITM:
                          *31,F5,*37,D7,*45,D50,*95,KEY8:
                          *103,KEY10
              ENDIF
            ENDIF
.
            IF        HPURCHP=15
              MOVE      F7,F5
              UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
              MOVE      SP10,D10
              MATCH     SP2,CDAY
              IF        !@EQUAL
                PACK      D10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
              ENDIF
              PACK      DIM15,SP20
              MATCH     "Stock",SIPCCST
              IF        !@EQUAL
                PACK      KEY5,SIPCCST
                CALL      RDSICA1
                IF        OVRCD=0
                  PACK      DIM15,SICADESC
                ENDIF
              ENDIF
              PRINT     *7,SIPCCAT,*16,SIPCITM,*20,F7,*28,SIPCSUT:
                        *44,KEY30,*75,DIM15,*91,KEY13,*106,KEY10,*119,D10
            ENDIF
.
            IF        HPURCHP=16
              MOVE      SIPCPN,KEY12
              MOVE      SIPCSUT,DIM15
              PRINT     *5,SIPCITM,*9,F5,*15,DIM15,*31,KEY27,*59,KEY12:
                        *72,KEY11,*84,KEY10,*95,SIPCCAT,*112,SIPCCST
            ENDIF
.
            IF        HPURCHP=17
              PRINT     *7,SIPCITM,*14,KEY30,*52,F7:
                        *64,SIPCSUT,*83,SIPCCST,*96,KEY13,*116,KEY10
            ENDIF
.
            IF        HPURCHP=18
              MOVE      SP5,SISACOMM
              PACK      KEY5,SIPCPRD,SP70
              CALL      RDSISA1
              MATCH     "Stock",SIPCCST
              IF        @EQUAL
                MOVE      SP70,SIWAPACC
                PACK      KEY5,SIPCWAR
                CALL      RDSIWA1
                PACK      KEY14,SIWADES,SP70
              ELSE
                PACK      SICADESC,SP70
                PACK      KEY5,SIPCCST,SP70
                CALL      RDSICA1
                PACK      KEY14,SICADESC,SP70
              ENDIF
.
              SQUEEZE   SIPCUR1
              MOVE      SIPCUR1,KEY6
              UNPACK    SIPCPN,PNLN1,PNLN2
.
              PRINT     *5,SIPCITM,*9,KEY40,*50,PNLN1,*68,F7:
                        *78,KEY8,*86,KEY10:
                        *97,SIPCCAT,*104,SIPCCST,"-",SIPCPRD:
                        *116,KEY6,*123,KEY14
            ENDIF
          ENDIF
.
          COMPARE   MAXITEMS,CLNO              * end of page ?
          CALL      HEAD0000 IF NOT LESS       * start new page
.
          MOVE      LINE1,KEY60
          IF        HPURCHP=8|HPURCHP=10
            CALL      BREAK000                   * break up line neatly
          ELSE
            IF        HPURCHP=16
             CALL       BRK27000
            ELSE
             IF         HPURCHP=18
               CALL       BRK40000
             ELSE
               CALL       BKLIN000
             ENDIF
            ENDIF
          ENDIF
          PACK      KEY60,KEY60,SP70           * print main line 2
          MATCH     SP70,KEY60
          IF        @EQUAL
            MOVE      LINE2,KEY60
            MOVE      LINE3,LINE2
            MOVE      LINE4,LINE3
            MOVE      LINE5,LINE4
            MOVE      LINE6,LINE5
            MOVE      SP70,LINE6
          ENDIF
          PACK      KEY60,KEY60,SP70
          IF        HPURCHP=8|HPURCHP=10|HPURCHP=4|HPURCHP=15
            CALL      BREAK000                   * break up line neatly
          ELSE
            IF        HPURCHP=16
             CALL       BRK27000
            ELSE
             IF         HPURCHP=18
               CALL       BRK40000
             ELSE
               CALL       BKLIN000
             ENDIF
            ENDIF
          ENDIF
.  
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          ADD       ONE,CLNO                   * increment line number
          IF        COUNTFL2=0
            IF        HPURCHP=0
              PRINT     *3,SIPCCAT,*14,KEY30,*56,CPCDATE
            ENDIF
.
            IF        HPURCHP=1
              PRINT     *3,SIPCCAT,*14,KEY30,*56,CPCDATE
            ENDIF
.
            IF        HPURCHP=2 | HPURCHP=11
              MOVE      SIPCPN,KEY15
              PRINT     *35,KEY30,*68,KEY15
            ENDIF
.
            IF        HPURCHP=3
              PRINT     *30,KEY30,SP2,SIPCPN,*110,SIPCCST
            ENDIF
.
            IF        HPURCHP=4
              PACK      KEY15,SIPCCST,SP70
              MOVE      SIPCCST,KEY5
              CALL      RDSICA1
              IF        OVRCD=0
                PACK      KEY15,SICADESC
              ENDIF
              PRINT     *3,SIPCCAT,*14,KEY45,*65,KEY15
            ENDIF
.
            IF        HPURCHP=5
              PRINT     *9,KEY13,*27,KEY30,*59,SIPCCST,*80,SIPCCAT
            ENDIF
.
            IF        HPURCHP=6
              PRINT     *34,KEY30
            ENDIF
.
            IF        HPURCHP=7
              PRINT     *28,KEY30
            ENDIF
.
            IF        HPURCHP=8 
              PRINT     *29,KEY45
            ENDIF
.
            IF        HPURCHP=9
              MOVE      SIPCPN,KEY15
              PRINT     *17,SIPCCST,*33,KEY30,*64,KEY15
            ENDIF
.
            IF        HPURCHP=10
              PRINT     *10,KEY45
            ENDIF
.
            IF        HPURCHP=12
              PRINT     *33,KEY30,*65,SIPCPN
            ENDIF
.
            IF        HPURCHP=13
              PRINT     *46,KEY30
            ENDIF
.
            IF        HPURCHP=14
              PRINT     *45,SIPCPN,*84,CPCDATE:
                        *N,SP1
              ADD       ONE,CLNO
            ENDIF
.
            IF        HPURCHP=15
              PRINT     *44,KEY45
            ENDIF
.
            IF        HPURCHP=16
              PRINT     *31,KEY27
            ENDIF
.
            IF        HPURCHP=17
              PRINT     *3,SIPCCAT,*14,KEY30,*64,CPCDATE
            ENDIF
.
            IF        HPURCHP=18
              PACK      KEY14,SIPAIDP,SP70
              PRINT     *9,KEY40,*50,PNLN2,*64,SIPCSUT,*123,KEY14
            ENDIF
.
            MATCH     SP70,CPCDATE
            IF        !@EQUAL
              MOVE      ZERO,F1
              REPEAT
                ADD       ONE,F1
                MOVE      SP70,KEY15
                LOAD      KEY15,F1,DELDT1,DELDT2,DELDT3,DELDT4,DELDT5:
                                   DELDT6,DELDT7,DELDT8,DELDT9,DELDT10
                MATCH     SP70,KEY15
              UNTIL     @EQUAL
              PACK      KEY15,SIPCITM,DOT,SP1,CPCDATE,SP70
              STORE     KEY15,F1,DELDT1,DELDT2,DELDT3,DELDT4,DELDT5:
                                 DELDT6,DELDT7,DELDT8,DELDT9,DELDT10
            ENDIF
          ENDIF
.
          MATCH     SP70,KEY60                 * print rest of data line
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
.
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,KEY60
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,KEY60
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PRINT     *35,KEY60
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,KEY60
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,KEY60
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,KEY60
              ENDIF
.
              IF        HPURCHP=6
                PRINT     *34,KEY60
              ENDIF
.
              IF        HPURCHP=7
                PRINT     *28,KEY60
              ENDIF
.
              IF        HPURCHP=8
                PRINT     *29,KEY60
              ENDIF
.
              IF        HPURCHP=9
                PRINT     *33,KEY60
              ENDIF
.
              IF        HPURCHP=10
                PRINT     *10,KEY60
              ENDIF
.
              IF        HPURCHP=12
                PRINT     *33,KEY60
              ENDIF
.
              IF        HPURCHP=13
                PRINT     *46,KEY60
              ENDIF
.
              IF        HPURCHP=15
                PRINT     *44,KEY60
              ENDIF
.
              IF        HPURCHP=16
                PRINT     *31,KEY60
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,KEY60
              ENDIF
.
              IF        HPURCHP=18
                PRINT     *9,KEY60
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,LINE2                 * print data line 2
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,LINE2
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,LINE2
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PACK      KEY60,LINE2,SP70
                CALL      BKLIN000
                PRINT     *35,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *35,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,LINE2
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,LINE2
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,LINE2
              ENDIF
.
              IF        HPURCHP=6
                PACK      KEY60,LINE2,SP70
                CALL      BKLIN000
                PRINT     *34,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *34,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=7
                PACK      KEY60,LINE2,SP70
                CALL      BKLIN000
                PRINT     *28,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *28,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=8
                PACK      KEY60,LINE2,SP70
                CALL      BREAK000
                PRINT     *29,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *29,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=9
                PACK      KEY60,LINE2,SP70
                CALL      BKLIN000
                PRINT     *33,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=10
                PACK      KEY60,LINE2,SP70
                CALL      BREAK000
                PRINT     *10,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *10,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=12
                PACK      KEY60,LINE2,SP70
                CALL      BREAK000
                PRINT     *33,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=13
                PACK      KEY60,LINE2,SP70
                CALL      BREAK000
                PRINT     *46,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *46,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=15
                PACK      KEY60,LINE2,SP70
                CALL      BREAK000
                PRINT     *44,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *44,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=16
                PACK      KEY60,LINE2,SP70
                CALL      BKLIN000
                PRINT     *31,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *31,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,LINE2
              ENDIF
.
              IF        HPURCHP=18
                PACK      KEY60,LINE2,SP70
                CALL      BRK40000
                PRINT     *9,KEY40
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       ONE,CLNO
                  PRINT     *9,KEY60
                ENDIF
              ENDIF
.
            ELSE
              IF        HPURCHP=18
                PACK      KEY60,LINE2,SP70
                CALL      BRK40000
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       ONE,CLNO
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,LINE3                 * print data line 3
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,LINE3
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,LINE3
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PACK      KEY60,LINE3,SP70
                CALL      BKLIN000
                PRINT     *35,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *35,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,LINE3
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,LINE3
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,LINE3
              ENDIF
.
              IF        HPURCHP=6
                PACK      KEY60,LINE3,SP70
                CALL      BKLIN000
                PRINT     *34,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *34,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=7
                PACK      KEY60,LINE3,SP70
                CALL      BKLIN000
                PRINT     *28,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *28,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=8
                PACK      KEY60,LINE3,SP70
                CALL      BREAK000
                PRINT     *29,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *29,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=9
                PACK      KEY60,LINE3,SP70
                CALL      BKLIN000
                PRINT     *33,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=10
                PACK      KEY60,LINE3,SP70
                CALL      BREAK000
                PRINT     *10,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *10,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=12
                PACK      KEY60,LINE3,SP70
                CALL      BREAK000
                PRINT     *33,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=13
                PACK      KEY60,LINE3,SP70
                CALL      BREAK000
                PRINT     *46,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *46,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=15
                PACK      KEY60,LINE3,SP70
                CALL      BREAK000
                PRINT     *44,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *44,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=16
                PACK      KEY60,LINE3,SP70
                CALL      BKLIN000
                PRINT     *31,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *31,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,LINE3
              ENDIF
.
              IF        HPURCHP=18
                PACK      KEY60,LINE3,SP70
                CALL      BRK40000
                PRINT     *9,KEY40
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       ONE,CLNO
                  PRINT     *9,KEY60
                ENDIF
              ENDIF
.
            ELSE
              IF        HPURCHP=18
                PACK      KEY60,LINE3,SP70
                CALL      BRK40000
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       ONE,CLNO
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,LINE4                 * print data line 4
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,LINE4
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,LINE4
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PACK      KEY60,LINE4,SP70
                CALL      BKLIN000
                PRINT     *35,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *35,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,LINE4
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,LINE4
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,LINE4
              ENDIF
.
              IF        HPURCHP=6
                PACK      KEY60,LINE4,SP70
                CALL      BKLIN000
                PRINT     *34,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *34,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=7
                PACK      KEY60,LINE4,SP70
                CALL      BKLIN000
                PRINT     *28,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *28,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=8
                PACK      KEY60,LINE4,SP70
                CALL      BREAK000
                PRINT     *29,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *29,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=9
                PACK      KEY60,LINE4,SP70
                CALL      BKLIN000
                PRINT     *33,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=10
                SUB       ONE,CLNO
              ENDIF
.
              IF        HPURCHP=12
                PACK      KEY60,LINE4,SP70
                CALL      BREAK000
                PRINT     *33,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=13
                PACK      KEY60,LINE4,SP70
                CALL      BREAK000
                PRINT     *46,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *46,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=15
                PACK      KEY60,LINE4,SP70
                CALL      BREAK000
                PRINT     *44,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *44,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=16
                PACK      KEY60,LINE4,SP70
                CALL      BKLIN000
                PRINT     *31,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *31,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,LINE4
              ENDIF
.
              IF        HPURCHP=18
                PACK      KEY60,LINE3,SP70
                CALL      BRK40000
                PRINT     *9,KEY40
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       ONE,CLNO
                  PRINT     *9,KEY60
                ENDIF
              ENDIF
.
            ENDIF
          ENDIF
.
          MATCH     SP70,LINE5                 * print data line 5
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
	      IF        HPURCHP=0
		PRINT     *14,LINE5
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,LINE5
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PACK      KEY60,LINE5,SP70
                CALL      BKLIN000
                PRINT     *35,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *35,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,LINE5
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,LINE5
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,LINE5
              ENDIF
.
              IF        HPURCHP=6
                PACK      KEY60,LINE5,SP70
                CALL      BKLIN000
                PRINT     *34,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *34,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=7
                PACK      KEY60,LINE5,SP70
                CALL      BKLIN000
                PRINT     *28,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *28,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=8
                PACK      KEY60,LINE5,SP70
                CALL      BREAK000
                PRINT     *29,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *29,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=9
                PACK      KEY60,LINE5,SP70
                CALL      BKLIN000
                PRINT     *33,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=10
                SUB       ONE,CLNO
              ENDIF
.
              IF        HPURCHP=12
                PACK      KEY60,LINE5,SP70
                CALL      BREAK000
                PRINT     *33,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=13
                PACK      KEY60,LINE5,SP70
                CALL      BREAK000
                PRINT     *46,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *46,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=15
                PACK      KEY60,LINE5,SP70
                CALL      BREAK000
                PRINT     *44,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *44,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=16
                PACK      KEY60,LINE5,SP70
                CALL      BKLIN000
                PRINT     *31,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *31,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,LINE5
              ENDIF
.
              IF        HPURCHP=18
                SUB       ONE,CLNO
              ENDIF
.
            ENDIF
          ENDIF
.
          MATCH     SP70,LINE6                 * print data line 6
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,LINE6
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,LINE6
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PACK      KEY60,LINE6,SP70
                CALL      BKLIN000
                PRINT     *35,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *35,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,LINE6
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,LINE6
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,LINE6
              ENDIF
.
              IF        HPURCHP=6
                PACK      KEY60,LINE6,SP70
                CALL      BKLIN000
                PRINT     *34,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *34,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=7
                PACK      KEY60,LINE6,SP70
                CALL      BKLIN000
                PRINT     *28,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *28,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=8
                PACK      KEY60,LINE6,SP70
                CALL      BREAK000
                PRINT     *29,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *29,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=9
                PACK      KEY60,LINE6,SP70
                CALL      BKLIN000
                PRINT     *33,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=10
                SUB       ONE,CLNO
              ENDIF
.
              IF        HPURCHP=12
                PACK      KEY60,LINE6,SP70
                CALL      BREAK000
                PRINT     *33,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=13
                PACK      KEY60,LINE6,SP70
                CALL      BREAK000
                PRINT     *46,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *46,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=11
                PACK      KEY60,LINE6,SP70
                CALL      BREAK000
                PRINT     *44,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *44,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=16
                PACK      KEY60,LINE6,SP70
                CALL      BKLIN000
                PRINT     *31,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *31,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,LINE6
              ENDIF
.
              IF        HPURCHP=18
                SUB       ONE,CLNO
              ENDIF
.
            ENDIF
          ENDIF
.
          MATCH     SP70,LINE7                 * print data line 7
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,LINE7
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,LINE7
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                PACK      KEY60,LINE7,SP70
                CALL      BKLIN000
                PRINT     *35,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *35,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,LINE7
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,LINE7
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,LINE7
              ENDIF
.
              IF        HPURCHP=6
                PACK      KEY60,LINE7,SP70
                CALL      BKLIN000
                PRINT     *34,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *34,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=7
                PACK      KEY60,LINE7,SP70
                CALL      BKLIN000
                PRINT     *28,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *28,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=8
                PACK      KEY60,LINE7,SP70
                CALL      BREAK000
                PRINT     *29,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *29,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=9
                PACK      KEY60,LINE7,SP70
                CALL      BKLIN000
                PRINT     *33,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=10
                SUB       ONE,CLNO
              ENDIF
.
              IF        HPURCHP=12
                PACK      KEY60,LINE7,SP70
                CALL      BREAK000
                PRINT     *33,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *33,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=13
                PACK      KEY60,LINE7,SP70
                CALL      BREAK000
                PRINT     *46,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *46,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=15
                PACK      KEY60,LINE7,SP70
                CALL      BREAK000
                PRINT     *44,KEY45
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *44,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=16
                PACK      KEY60,LINE7,SP70
                CALL      BKLIN000
                PRINT     *31,KEY30
                MATCH     KEY60,SP70
                IF        !@EQUAL
                  ADD       "1",CLNO
                  PRINT     *31,KEY60
                ENDIF
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,LINE7
              ENDIF
.
              IF        HPURCHP=18
                SUB       ONE,CLNO
              ENDIF
.
            ENDIF
          ENDIF
.
          MOVE      ONE,PRTFLAG                * main data printed
          GOTO      PRTB9999
.
.---- print comments data ----
.
PRTB1000  IF        HPURCHP=10|HPURCHP=14
            GOTO      PRTB9999
          ENDIF
.
          MATCH     SP70,SIPDCOM               * print data line if not blank
          IF        !@EQUAL
            COMPARE   MAXITEMS,CLNO            * end of page ?
            CALL      HEAD0000 IF NOT LESS     * start new page
            ADD       ONE,CLNO                 * increment line number
            IF        COUNTFL2=0
              IF        HPURCHP=0
                PRINT     *14,SIPDCOM
              ENDIF
.
              IF        HPURCHP=1
                PRINT     *14,SIPDCOM
              ENDIF
.
              IF        HPURCHP=2 | HPURCHP=11
                MOVE      SIPDCOM,KEY30
                PRINT     *35,KEY30
              ENDIF
.
              IF        HPURCHP=3
                PRINT     *30,SIPDCOM
              ENDIF
.
              IF        HPURCHP=4
                PRINT     *14,SIPDCOM
              ENDIF
.
              IF        HPURCHP=5
                PRINT     *27,SIPDCOM
              ENDIF
.
              IF        HPURCHP=6
                MOVE      SIPDCOM,KEY30
                PRINT     *34,KEY30
              ENDIF
.
              IF        HPURCHP=7
                MOVE      SIPDCOM,KEY30
                PRINT     *28,KEY30
              ENDIF
.
              IF        HPURCHP=8
                PRINT     *29,SIPDCOM
              ENDIF
.
              IF        HPURCHP=9
                MOVE      SIPDCOM,KEY30
                PRINT     *33,KEY30
              ENDIF
.
              IF        HPURCHP=10
                SUB       ONE,CLNO
              ENDIF
.
              IF        HPURCHP=12
                PRINT     *33,SIPDCOM
              ENDIF
.
              IF        HPURCHP=13
                PRINT     *46,SIPDCOM
              ENDIF
.
              IF        HPURCHP=15
                PRINT     *44,SIPDCOM
              ENDIF
.
              IF        HPURCHP=16
                MOVE      SIPDCOM,KEY30
                PRINT     *31,KEY30
              ENDIF
.
              IF        HPURCHP=17
                PRINT     *14,SIPDCOM
              ENDIF
.
              IF        HPURCHP=18
                PRINT     *9,SIPDCOM
              ENDIF
.
            ENDIF
          ENDIF
.
PRTB9999  RETURN
.********************************************************************
. BKLIN - Break up KEY60 into two neat halves        Called by lots
.         Requires - KEY60   (original line)
.         Returns  - KEY30   (line 1)
.                    KEY60   (line 2)
.********************************************************************
BKLIN000  RESET     KEY60,31
          CMATCH    SP70,KEY60
          WHILE     !@EQUAL&!@EOS
            BUMP      KEY60,-1
            IF        !@EOS
              CMATCH    SP70,KEY60
            ENDIF
          DO
.
          IF        @EOS
            SETLPTR   KEY60
            RESET     KEY60
            UNPACK    KEY60,KEY30,KEY60
          ELSE
            LENSET    KEY60
            RESET     KEY60
            MOVE      KEY60,KEY30
            PACK      KEY30,KEY30,SP70
.
            ENDSET    KEY60
            SETLPTR   KEY60
            BUMP      KEY60
            PACK      KEY60,KEY60,SP70
          ENDIF
.
BKLIN999  RETURN
.********************************************************************
. BREAK - Break up KEY60 into two neat halves        Called by lots
.         Requires - KEY60   (original line)
.         Returns  - KEY45   (line 1)
.                    KEY60   (line 2)
.********************************************************************
BREAK000  RESET     KEY60,46
          CMATCH    SP70,KEY60
          WHILE     !@EQUAL&!@EOS
            BUMP      KEY60,-1
            IF        !@EOS
              CMATCH    SP70,KEY60
            ENDIF
          DO
.
          IF        @EOS
            SETLPTR   KEY60
            RESET     KEY60
            UNPACK    KEY60,KEY45,KEY60
          ELSE
            LENSET    KEY60
            RESET     KEY60
            MOVE      KEY60,KEY45
            PACK      KEY45,KEY45,SP70
.
            ENDSET    KEY60
            SETLPTR   KEY60
            BUMP      KEY60
            PACK      KEY60,KEY60,SP70
          ENDIF
.
BREAK999  RETURN
.********************************************************************
. BRK27 - Break up KEY60 into two neat halves        Called by lots
.         Requires - KEY60   (original line)
.         Returns  - KEY27   (line 1)
.                    KEY60   (line 2)
.********************************************************************
BRK27000  RESET     KEY60,28
          CMATCH    SP70,KEY60
          WHILE     !@EQUAL&!@EOS
            BUMP      KEY60,-1
            IF        !@EOS
              CMATCH    SP70,KEY60
            ENDIF
          DO
.
          IF        @EOS
            SETLPTR   KEY60
            RESET     KEY60
            UNPACK    KEY60,KEY27,KEY60
          ELSE
            LENSET    KEY60
            RESET     KEY60
            MOVE      KEY60,KEY27
            PACK      KEY27,KEY27,SP70
.
            ENDSET    KEY60
            SETLPTR   KEY60
            BUMP      KEY60
            PACK      KEY60,KEY60,SP70
          ENDIF
.
BRK27999  RETURN
.********************************************************************
. BRK40 - Break up KEY60 into two neat halves        Called by lots
.         Requires - KEY60   (original line)
.         Returns  - KEY40   (line 1)
.                    KEY60   (line 2)
.********************************************************************
BRK40000  RESET     KEY60,41
          CMATCH    SP70,KEY60
          WHILE     !@EQUAL&!@EOS
            BUMP      KEY60,-1
            IF        !@EOS
              CMATCH    SP70,KEY60
            ENDIF
          DO
.
          IF        @EOS
            SETLPTR   KEY60
            RESET     KEY60
            UNPACK    KEY60,KEY40,KEY60
          ELSE
            LENSET    KEY60
            RESET     KEY60
            MOVE      KEY60,KEY40
            PACK      KEY40,KEY40,SP70
.
            ENDSET    KEY60
            SETLPTR   KEY60
            BUMP      KEY60
            PACK      KEY60,KEY60,SP70
          ENDIF
.
BRK40999  RETURN
.********************************************************************
. FILP - fill to end of purchase order                Called by HEAD
.********************************************************************
FILP0000
.
.---- fill rest of purchase order body ----
.
          WHILE     MAXITEMS>CLNO
            ADD       ONE,CLNO                   * print blank lines
            PRINT     SP1
          DO
.
.---- print total ----
.
          IF        HPURCHP=0
            PRINT     *N,*N,*98," CONTINUED",*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=1
            PRINT     *N,*N,*98," CONTINUED",*N,*N
          ENDIF
.
          IF        HPURCHP=2 | HPURCHP=11
            PRINT     *80,CONFDESK,*N:
                      *18,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *18,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *80," CONTINUED",*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=3
            PRINT     *19,CONFDESK,*N,*N:
                      *16,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4:
                      *16,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8,*N:
                         *83," CONTINUED",*N:
                      *16,DELDT9,SP1,DELDT10:
                      *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=4
            PRINT     *N,*98," CONTINUED",*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=5
            PRINT     *N,*69," CONTINUED",*N
          ENDIF
.
          IF        HPURCHP=6
            PRINT     *17,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *17,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *79," CONTINUED",*N,*N
            CALL    PDELP000
          ENDIF
.
          IF        HPURCHP=7
            PRINT     *4,"*----------------------------------------":
                         "----------------------------------------*"
            PRINT     *39,"*** Continued on next page ***"        * DARWIN
            PRINT     *4,"*----------------------------------------":
                         "----------------------------------------*"
            PRINT     *N,*N:
                      *4,"Delivery Point: ",SIPADEL:
                      *N,*N,*N:
                      *45,"____________________     ___/___/___",*N:
                      *45,"Authorised By:             Date":
                      *N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=8
            UNPACK    SIPAIDP,KEY25,KEY15
            PRINT     *N,*12,EARLYDEL,*N,*N,*N,*N:
                      *15,KEY25,*N:
                      *15,KEY15,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=9
            PRINT     *15,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *15,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *81," CONTINUED",*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=10
            PRINT     *88," CONTINUED",*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=12
            PRINT     *97," CONTINUED",*N:
                      *17,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *17,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=13
            PRINT     *46,"*** Continued on next page ***":
                      *N,*N,*87,"*******.**",*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=14
            PRINT     *44,"*** Continued on next page ***":
                      *N,*N,*104,"******.**",*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=15
            PRINT     *N,*106," CONTINUED"
          ENDIF
.
          IF        HPURCHP=16
            PRINT     *11,DELDT1,DELDT2,DELDT3:
                      *68,"CONTINUED",*N:
                      *11,DELDT4,DELDT5,DELDT6,DELDT7,*N:
                      *11,DELDT8,DELDT9,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=17
            PRINT     *N,*N,*N,*N,*N,*N,*116," CONTINUED",*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=18
            PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
FILP9999  RETURN
.********************************************************************
. PDELP - print delivery Point                       Called by FILP
.********************************************************************
PDELP000  MOVE    SIPAPNT,FORM1
          IF      FORM1=1
            PRINT    *8,"XX";
          ENDIF
          IF      FORM1=2
            PRINT    *28,"XX";
          ENDIF 
          PRINT   *N
          IF      FORM1=3
            PRINT    *8,"XX";
          ENDIF
          IF      FORM1=4
            PRINT    *28,"XX";
          ENDIF 
          PRINT   *N
          IF      FORM1=5
            PRINT    *8,"XX";
          ENDIF
          IF      FORM1=6 |FORM1=0
            MOVE     SIPADEL,KEY27
            PRINT    *28,"XX",*N,*31,KEY27,*N,*N
          ELSE
            PRINT    *N,*N,*N
          ENDIF 
.
PDELP999  RETURN
.********************************************************************
. ENDP - print end of purchase order                Called by PORD
.********************************************************************
ENDP0000
.
.---- fill rest of purchase order body ----
.
          WHILE     MAXITEMS>CLNO
            ADD       "1",CLNO                   * print blank lines
            PRINT     SP1
          DO
.
.---- print total ----
.
          IF        HPURCHP=0
            PRINT     *N,*N,*98,TF7P2,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=1
            PRINT     *N,*N,*98,TF7P2,*N,*N
          ENDIF
.
          IF        HPURCHP=2 | HPURCHP=11
            PRINT     *80,CONFDESK,*N:
                      *18,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *18,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                         *80,TF7P2,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=3
            PRINT     *19,CONFDESK,*N,*N:
                      *16,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4:
                      *16,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8,*N:
                         *83,TF7P2,*N:
                      *16,DELDT9,SP1,DELDT10:
                      *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=4
            PRINT     *N,*98,TF7P2,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=5
            PRINT     *N,*18,SIPCCST,*30,SICARID,*69,TF7P2,*N
          ENDIF
.
          IF        HPURCHP=6
            PRINT     *17,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *17,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *79,TF7P2,*N,*N
            CALL      PDELP000
          ENDIF
.
          IF        HPURCHP=7
            PRINT     *4,"*----------------------------------------":
                         "----------------------------------------*"
            PRINT     *74,TF7P2                                   * DARWIN
            PRINT     *4,"*----------------------------------------":
                         "----------------------------------------*"
            PRINT     *N,*N:
                      *4,"Delivery Point: ",SIPADEL:
                      *N,*N,*N:
                      *45,"____________________     ___/___/___",*N:
                      *45,"Authorised By:             Date":
                      *N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=8
            UNPACK    SIPADEL,KEY25,KEY15
            PRINT     *N,*10,EARLYDEL,*N,*N,*N,*N:
                      *10,KEY25,*N:
                      *10,KEY15,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=9
            PRINT     *15,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *15,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *81,TF7P2,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=10
            PRINT     *77,TF7P2B,*88,TF7P2,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=12
            PRINT     *97,TF7P2,*N:
                      *17,DELDT1,SP1,DELDT2,SP1,DELDT3,SP1,DELDT4,*N:
                      *17,DELDT5,SP1,DELDT6,SP1,DELDT7,SP1,DELDT8:
                      *N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=13
            PRINT     *N,*N,*86,TF7P2,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=14
            PRINT     *57,MESSDESK,*N,*N,*103,TF7P2,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=15
            PRINT     *N,*106,TF7P2
          ENDIF
.
          IF        HPURCHP=16
            MOVE      TF7P2,TF6P2
            PRINT     *11,DELDT1,DELDT2,DELDT3:
                      *68,TF6P2,*N:
                      *11,DELDT4,DELDT5,DELDT6,DELDT7,*N:
                      *11,DELDT8,DELDT9,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=17
            PRINT     *N,*N,*N,*N,*N,*N,*116,TF7P2,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=18
            PRINT     *86,TF7P2,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
            PACK      DEL181,SP70
          ENDIF
.
          MOVE      "2",AUDTTYPE
          CALL      WASIPA00               * Write to Audit file
.
          PACK      KEY7,SIPAPON,SP70
          CALL      RDSIPA1
          IF        OVRCD=0
            PACK      SIPADPR,CCC,CYY,CMM,CDD,SP70
            REP       " 0",SIPADPR
            CALL      UPSIPA1                    * update date printed
          ENDIF
.
          MOVE      "3",AUDTTYPE
          CALL      WASIPA00               * Write to Audit file
.
ENDP9999  RETURN
.********************************************************************
. SINORDLU - print lineup
.********************************************************************
.
SINORDLU  READ      CONTROLF,TWENTY6;*248,HPURCHP
.
          CALL      OPNPRINT                * open print file
.
          MOVE      "******************************",SIPCITM
          MOVE      "******************************",KEY30
          MOVE      "***********************************",KEY35
          MOVE      "*********************************************",KEY45
          MOVE      "******************************",SIPCSUT
          MOVE      "******************************",SIPCCST
          MOVE      "******************************",SIPCCAT
          MOVE      "******************************",SIPCPRD
          MOVE      "******************************",SISACOMM
          MOVE      " 999999",F7
          MOVE      " 9999999.9999",KEY13
          MOVE      " 999999.99",KEY10
.
          IF        HPURCHP=0
            PRINT     *N:
                      *87,"*******",*N,*N:
                      *83,"**",*91,"**",*N:
                      *41,SP8,"**********",*N:
                      *83,"**********",*N:
                      *41,"******************************",*N,*N,*N,*N,*N:
                      *3,"******************************":
                          *40,"****************************************",*N:
                      *3,"******************************",*N:
                      *3,"*************************":
                          *47,"********************",*N:
                      *3,"*************************",*N:
                      *3,"*************************":
                          *29,"******",*47,"**********",*82,"*************",*N:
                      *3,"***********************************",*N,*N,*N,*N,*N:
                      *7,SIPCITM,*14,KEY30,*46,F7:
                      *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=1
            PRINT     *87,"*******",*N,*N:
                      *83,"**",*91,"**",*N:
                      *41,SP8,"**********",*N:
                      *83,"**********",*N:
                      *41,"******************************",*N,*N,*N,*N,*N:
                      *3,"******************************":
                          *40,"****************************************",*N:
                      *3,"******************************",*N:
                      *3,"*************************":
                          *47,"********************",*N:
                      *3,"*************************",*N:
                      *3,"*************************":
                          *29,"******",*47,"**********",*82,"*************",*N:
                      *3,"***********************************",*N,*N,*N,*N,*N:
                      *7,SIPCITM,*14,KEY30,*46,F7:
                      *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=2
            PRINT     *N,*N,*N,*N:
                      *71,"*******",*97,"********",*N:
                      *93,"Page ** of **",*N,*N:
                      *19,"******************************",*N:
                      *19,"******************************",*66,"********",*N:
                      *19,"******************************",*N:
                      *19,"******************************":
                           *66,"********************",*N:
                      *19,"******************************",*N:
                      *19,"******************************",*N,*N,*N,*N,*N:
                      *7,SIPCITM,*11,F7,*19,SIPCSUT,*35,KEY30,*68,SIPCCAT:
                      *80,KEY13,*99,SIPCPRD:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=3
            MOVE      SIPCSUT,KEY11
            PRINT     "XX",*N,*N,*N,*N,*N:
                      *69,"********",*N:
                      *93,"Page ** of **",*N,*N:
                      *19,"******************************":
                           *65,"********************",*N:
                      *19,"******************************",*65,"********",*N:
                      *19,"******************************",*N:
                      *19,"******************************":
                           *65,"********************",*N:
                      *19,"******************************":
                           *65,"********************",*N,*N:
                      *19,"******************************",*N,*N,*N,*N:
                      *7,SIPCITM,SP1,F7,SP1,KEY11,*30,KEY30,SP7,SIPCCAT:
                      *80,KEY13,SP3,KEY10,*110,SIPCPRD:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,"XX"
          ENDIF
.
          IF        HPURCHP=4
            PRINT     *N:
                      *87,"*******",*N,*N:
                      *83,"**",*91,"**",*N:
                      *41,SP8,"**********",*N:
                      *83,"**********",*N:
                      *41,"******************************",*N,*N,*N,*N,*N:
                      *3,"******************************":
                          *40,"****************************************",*N:
                      *3,"******************************",*N:
                      *3,"*************************":
                          *47,"********************",*N:
                      *3,"*************************",*N:
                      *3,"*************************":
                          *29,"******",*47,"**********",*82,"*************",*N:
                      *3,"***********************************",*N,*N,*N,*N,*N:
                      *7,SIPCITM,*14,KEY30,*46,F7:
                      *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=5
            PACK      SIIANAT,SP70
            PACK      KEY7,SIPCCAT,SP20
            CALL      RDSIIA1
            PRINT     *N,*93,"********",*N:
                      *73,"Page : 99",*92,"99/99/99":
                      *N,*73,"********************",*N,*N,*N,*N,*N,*N:
                      *16,"******************************",*N:
                      *16,"******************************",*N:
                      *16,"*************************",*N:
                      *16,"*************************",*N:
                      *16,"************************* ******",*N,*N,*N:
                      *N,*9,"********************",*73:
                      "******************************",*N,*N,*N,*N:
                      *5,F7,*13,SIPCSUT,*27,KEY30:
                      *59,SIIANAT,*69,KEY10,*80,SIPCPRD:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N
          ENDIF
.
          IF        HPURCHP=6
            MOVE      SIPCPN,KEY15
            PRINT     *N,*N,*N,*N,*N,*N:
                      *70,"*******",*96,"********",*N:
                      *92,"Page ** of **",*N,*N:
                      *18,"******************************",*N:
                      *18,"******************************",*65,"********",*N:
                      *18,"******************************",*N:
                      *18,"******************************":
                           *65,"********************",*N:
                      *18,"******************************",*N:
                      *18,"******************************",*N,*N,*N,*N,*N:
                      *6,SIPCITM,*10,F7,*18,SIPCSUT,*34,KEY30,*67,KEY15:
                      *79,KEY13,*91,SIPCCAT,*99,SIPCPRD:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=7
            PRINT     *N,*N,*N,*11,"********************",*N:       * DARWIN
                      *11,"******************************":
                      *60,"Phone:  999999999999",*N:
                      *11,"******************************   999999":
                      *60,"Fax  :  999999999999",*N:
                      *N,*60,"PURCHASE ORDER: 9999999",*N,*N:
                      *6,"To:  ******************************":
                      *60,"Date :  99/99/99",*N:
                      *11,"******************************",*N:
                      *11,"******************************",*N:
                      *11,"******************************",*N:
                      *11,"******************************",*N:
                      *11,"********************    9999",*N:
                      *4,"*----------------------------------------":
                         "----------------------------------------*",*N:
                      *6,"QTY",*12,"UNIT OF SUPPLY":
.                     *28,"DESCRIPTION",*63,"PART",*72,"UNIT PRICE",*N:
                      *28,"DESCRIPTION",*63,"HOSP",*72,"RECEIVED",*N:
                      *63,"CODE",*72,"DATE/QTY",*N:
                      *4,"*----------------------------------------":
                         "----------------------------------------*",*N:
                      *4,"9999999",*12,SIPCSUT,*28,KEY30,*62,SIPCCAT:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=8
            MOVE      SIPCUR1,DIM8               * Req. Number 1
            MOVE      SIPCUR2,KEY8               * Req. Number 2
            PACK      KEY13,SP70
            MOVE      SIPCCST,KEY5
            CALL      RDSICA1
            IF        OVRCD=0
              PACK      KEY13,SICADESC
            ENDIF
            PRINT     *N,*N,*N,*N:
                      *71,SIPAPON,*95,DIM8,*N,*95,KEY8,*N,*N,*N:
                      *17,"**********************************",*N:
                      *17,"**********************************",*92,KEY13,*N:
                      *17,"**********************************",*N:
                      *17,"**********************************",*N:
                      *17,"***********************  *********",*N:
                      *17,"*********",*N,*N,*N,*N:
                      *1,"***",*5,"*******",*13,"***************":
                      *29,"*******************************************":
                      *75,"********.**",*86,"*******",*94,"*****":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=9
            MOVE      SIPCUR1,DIM8               * Req. Number 1
            MOVE      SIPCUR2,KEY8               * Req. Number 2
            PACK      KEY13,SP70
            MOVE      SIPCCST,KEY5
            CALL      RDSICA1
            IF        OVRCD=0
              PACK      KEY13,SICADESC
            ENDIF
            PRINT     *N,*N,*N:
                      *N,*N:
                      *71,SIPAPON,*95,DIM8,*N,*95,KEY8,*N,*N:
                      *17,"**********************************",*N:
                      *17,"**********************************",*92,KEY13,*N:
                      *17,"**********************************",*N:
                      *17,"**********************************",*N:
                      *17,"***********************  *********",*63,"*******",*N:
                      *17,"*********",*N,*N,*N,*N:
                      *6,"***",*9,"*******",*17,"***************":
                      *33,"******************************",*64,"*******":
                      *80,"************",*96,"*****",*N:
                      *17,"*****",*64,"***************",*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=10
            PRINT     *N,*91,"*******",*N:
                      *47,"********************",*N:
                      *88,"**",*96,"**",*N:
                      *40,"******************************",*N:
                      *25,"*****",*88,"**/**/****",*N:
                      *1,"******************************",*N:
                      *1,"******************************":
                      *58,"****************************************",*N:
                      *1,"*************************",*N:
                      *1,"*************************":
                      *68,"******************************",*N:
                      *1,"*************************",SP1,"******",*N:
                      *1,"***********************************":
                      *68,"**********",*N:
                      *N:
                      *1,"******************************",*N:
                      *1,"****************************************":
                      *41,"********************",*N:
                      *1,"****************************************":
                      *41,"********************",*N:
                      *1,"****************************************":
                      *41,"********************",*N:
                      *1,"****************************************":
                      *41,"********************",*N:
                      *N,*N,*N,*N:
                      *1,"*********************************************":
                      *47,"99999",*53,"************",*66,"9999999.99":
                      *77,"9999999.99",*88,"9999999.99":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N:
                      *77,"9999999.99",*88,"9999999.99":
                      *N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=11
            PRINT     *N,*N,*N,*N,*N:
                      *71,"*******",*97,"********",*N:
                      *93,"Page ** of **",*N,*N:
                      *19,"******************************",*N:
                      *19,"******************************",*66,"********",*N:
                      *19,"******************************",*N:
                      *19,"******************************":
                           *66,"********************",*N:
                      *19,"******************************",*N:
                      *19,"******************************",*N,*N,*N,*N:
                      *7,SIPCITM,*11,F7,*19,SIPCSUT,*35,KEY30,*68,SIPCCAT:
                      *80,KEY13,*99,SIPCPRD:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=12
            PRINT     *N,*N,*N,*N:
                      *89,"********",*N:
                      *15,"Page ",ONE," of ",ONE,*N,*N:
                      *65,"*******",*N:
                      *89,"********************",*N:
                      *15,"********************",*89,"********************",*N:
                      *15,"********************",*N:
                      *15,"********************",*N:
                      *15,"********************",*84,"********************",*N:
                      *15,"********************",SP1,"*****",*84,"*****",*N:
                      *15,"********************",*N,*N,*N,*N,*N:
                      *6,SIPCITM,*20,"*******",*33,KEY35,*73,SIPCCAT:
                      *82,"********.****",*97,"*******.**",*110,"*****":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=13
            PRINT     *N,*81,"Page :999",*N,*N,*N,*N:
                      *N,*13,"******************************",*63,"*******":
                      *N,*13,"******************************":
                      *N,*13,"******************************",*59,"99/99/99":
                      *N,*13,"******************************":
                      *N,*13,"******************************":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*1,"99999999999",*13,"**************"," 999 ":
                      "*************":
                      *46,"*****************************",*76,"99999.9999":
                      *88,"999999.99":
                      *N,*46,"*****************************":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*46,"*****************************":
                      *N,*46,"*** Continued on next page **":
                      *N,*N,*88,"999999.99",*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=14
            PRINT     *104,"99999999":
                      *N,*N,*104,"99/99/99":
                      *N,*N,*104,"999":
                      *N,*N,*64,"XXXXXXXXXXXXXXXXXXXX",*N:
                      *N,*2,"XXXXX",*14,"******************************":
                      *89,"XXXXXXXXXXXXXXXXXXXX":
                      *N,*14,"******************************":
                      *N,*14,"******************************":
                      *60,"XXXXXXXXXXXXXXX":
                      *89,"XXXXXXXXXXXXXXXXXXXX":
                      *N,*14,"******************************":
                      *N,*14,"******************************":
                      *57,"XXXXXXXXXXXXXXXXXXX":
                      *N,*57,"XXXXXXXXXXXXXXX":
                      *89,"XXXXXXXXXXXXXXXXXXXX":
                      *N,*14,"XXXXXXXXXXXXXXXXXXXX",*57,"XXXXXXXXXXXXXXX":
                      *89,"XXXXXXXXXXXXXXXXXXXX":
                      *N,*N,*N,*N:
                      *2,"XXXXX",*14,"9999999",*27,"999",*31,"99999":
                      *37,"XXXXX",*44,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                      *96,"9999.99",*104,"999999.99":
                      *N,*47,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *47,"*** Continued on next page **":
                      *N,*N,*104,"999999.99"
          ENDIF
.
          IF        HPURCHP=15
            PRINT     *87,"*******",*N,*N:
                      *83,"**",*91,"**",*N:
                      *41,SP8,"**********",*N:
                      *83,"**********",*N:
                      *41,"******************************",*N,*N,*N,*N,*N:
                      *3,"******************************":
                          *40,"****************************************",*N:
                      *3,"******************************",*N:
                      *3,"*************************":
                          *47,"********************",*N:
                      *3,"*************************",*N:
                      *3,"*************************":
                          *29,"******",*47,"**********",*82,"*************",*N:
                      *3,"***********************************",*N,*N,*N,*N,*N:
                      *7,SIPCITM,*14,KEY30,*46,F7:
                      *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=16
            MOVE      SIPCPN,KEY15
            PRINT     *N,*N,*N,*N:
                      *N,*28,"X",*45,"X",*60,"X":
                      *N,*N,*N,*85,"XXXXXXXX":
                      *N,*N,*N,*N:
                      *13,"******************************",*68,"XX/XX/XX":
                      *95,"********************",*N:
                      *13,"******************************":
                      *68,"******************************",*N:
                      *13,"******************************":
                      *68,"*****************":
                      *95,"*****",*N:
                      *13,"******************************":
                      *68,"******************************",*N:
                      *13,"******************************":
                      *N,*N,*N,*N:
                      *5,"XXX",*9,"99999",*15,"XXXXXX":
                      *22,"**************************":
                      *49,"XXXXXXXXXXXX",*62,"XXXXXX",*69,"99999.99":
                      *78,"9999999",*97,"XXXXX":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *68,"999999.99":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=17
            PRINT     *87,"*******",*N,*N:
                      *83,"**",*91,"**",*N:
                      *41,SP8,"**********",*N:
                      *83,"**********",*N:
                      *41,"******************************",*N,*N,*N,*N,*N:
                      *3,"******************************":
                          *40,"****************************************",*N:
                      *3,"******************************",*N:
                      *3,"*************************":
                          *47,"********************",*N:
                      *3,"*************************",*N:
                      *3,"*************************":
                          *29,"******",*47,"**********",*82,"*************",*N:
                      *3,"***********************************",*N,*N,*N,*N,*N:
                      *7,SIPCITM,*14,KEY30,*46,F7:
                      *56,SIPCSUT,*73,SIPCCST,*80,KEY13,*98,KEY10:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
.
          IF        HPURCHP=18
            PRINT     *N,*N,*N,*N,*N,*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX":
                      *56,"XXXXXXXXXXXXXXXXXXXX",*124,"9999999",*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX":
                      *56,"XXXXXXXXXXXXXXXXXXXX",*100,"99/99/9999",*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX":
                      *56,"XXXXXXXXXXXXXXXXXXXX",*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX":
                      *56,"XXXXXXXXXXXXXXXXXXXX",*97,"XXXXXXXXXXXXXXXX",*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX":
                      *56,"XXXXXXXXXXXXXXXXXXXX",*97,"XXXXXXXXXXXXXXXX",*N:
                      *56,"XXXXXXXXXXXXXXXXXXXX",*97,"XXXXXXXXXXXXXXXX",*N:
                      *97,"XXXXXXXXXXXXXXXX",*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX",*97,"XXXXXXXXXXXXXXXX",*N:
                      *13,"XXXXXXXXXXXXXXXXXXXX",*97,"XXXXXXXXXXXXXXXX",*N:
                      *N,*N:
                      *N,*5,"XXX",*9,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                      *50,"XXXXXXXXXXXXX",*65,"9999999999",*78,"99999.99":
                      *87,"999999.99",*97,"999999",*107,"XXXXX":
                      *116,"999999",*123,"XXXXXXXXXXXXXX":
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *5,"XXX",*9,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                      *50,"XXXXXXXXXXXXX",*65,"9999999999",*78,"99999.99":
                      *87,"999999.99",*97,"999999",*107,"XXXXX":
                      *116,"999999",*123,"XXXXXXXXXXXXXX"
          ENDIF
.
          CALL      CLSPRINT                * close print file & print
.
          RETURN
