.
.         PATSHT2 
.         -------
.
.         THIS INCLUDE PRINTS THE PATIENT SUMMARY (IDENTIFICATION) DETAILS
.
.         Layout 1 - St. Andrews
.
.*        V12.00.01 23/05/2025 Nikitha B          TSK 0955096                
.*                  Alphanumeric changes                                      
.*        V11.00.01 02/04/2020  J.Tan             TSK 0868813
.*                  Changed PKNAME to DIM80
.*        V5.08.01  06/06/2000  Jill Habasque                                 
.*                  Changed from key10 to key14 for the health fund file      
.         V5.07.01  13/07/1999  Greg Horvat
.                   Replaced certain variables & with KEY variables
.                   08/10/1998  Glenn Berry      5.07 changes
.******************************************************************************
.         Mods :  V5.01.01  19/04/93  DIG
.                           Changed to include TEXTRA variable for additional
.                           charging
.
.        IDENTIFICATION VARIABLES
.
. ADOCDESC DIM      22
. A8DATE   DIM      8
. CLMDET1  DIM      50
. CLMDET2  DIM      50
. D8DATE   DIM      8
. DFUND    DIM      20
. NETTOT   FORM     6.2
. XDAY1    DIM      2
. XMON1    DIM      2
. XYEAR1   DIM      2
. XAGE     DIM      3
.
LINUPID2
        CALL      OPNPRINT
        PRINT     *58,"999999",*N,*58,X10,*N,*58,"999999",*N,*N:
                  *N,*1,X20:
                  *23,X20,X5,*58,X3,SLASH,X3,*N,*N:
                  *1,X20,X5:
                  *48,X1,DOT,X20,*N:
                  *1,X20,X5,*48,X10,X2,*N:
                  *1,X15,*21,"9999",*48,X10,X2,*N,*N:
                  *1,X20,*48,X10,*N:
                  *1,X20,X5,*N:
                  *1,X20,X5,*48,X10,X2,*N:
                  *1,X15,*21,"9999",*48,X10,X2,*N,*N:
                  *14,"99/99/99",*24,"999",*32,X3,*N:
                  *52,"99/99/99",*64,"99:99",*N:
                  *1,X10,X1,*14,X3,*24,X1,*32,X1:
                  *60,X3:
                  *N,*N:
.
                  *58,"999999",*N,*58,X10,*N,*58,"999999",*N,*N:
                  *N,*1,X20:
                  *23,X20,X5,*N,*N:
                  *1,X20,X5:
                  *48,X1,DOT,X20,*N:
                  *1,X20,X5,*48,X10,X2,*N:
                  *1,X15,*21,"9999",*48,X10,X2,*N,*N:
                  *1,X20,*48,X10,*N:
                  *1,X20,X5,*N:
                  *1,X20,X5,*48,X10,X2,*N:
                  *1,X15,*21,"9999",*48,X10,X2,*N,*N:
                  *14,"99/99/99",*24,"999",*32,X3,*N:
                  *52,"99/99/99",*64,"99:99",*N:
                  *1,X10,X1,*14,X3,*24,X1,*32,X1:
                  *60,X3:
                  *N,*N:
                  *1,X30,X20,*N:
                  *N,*10,"99",*N,*N:
                  *11,X20:
                  *44,X10,*65,X4,*N,*N:
                  *1,X3,*11,"  9999.99":
                  *22,X20,X20,*N:
                  *22,X20,X20,*N:
.
                  *N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N:
.
                  *58,"999999",*N,*58,X10,*N,*58,"999999",*N,*N:
                  *N,*1,X20:
                  *23,X20,X5,*N,*N:
                  *1,X20,X5:
                  *48,X1,DOT,X20,*N:
                  *1,X20,X5,*48,X10,X2,*N:
                  *1,X15,*21,"9999",*48,X10,X2,*N,*N:
                  *1,X20,*48,X10,*N:
                  *1,X20,X5,*N:
                  *1,X20,X5,*48,X10,X2,*N:
                  *1,X15,*21,"9999",*48,X10,X2,*N,*N:
                  *14,"99/99/99",*24,"999",*32,X3,*N:
                  *52,"99/99/99",*64,"99:99",*N:
                  *1,X10,X1,*14,X3,*24,X1,*32,X1:
                  *60,X3:
                  *N,*N:
                  *1,X30,X20,*N:
.
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N
.
        CALL      CLSPRINT
        RETURN
.
SETLID2 UNPACK          ADATE,XCENT,XYEAR,XMON,XDAY
        PACK            A8DATE WITH XDAY,SLASH,XMON,SLASH,XYEAR
.
        COMPARE         THREE,ASTAT
        GOTO            NOTDSC2 IF NOT EQUAL
.
        MATCH           SP8,DDATE
        GOTO            NOTDSC2 IF EQUAL
.
        UNPACK          DDATE,XCENT,XYEAR,XMON,XDAY
        PACK            D8DATE WITH XDAY,SLASH,XMON,SLASH,XYEAR
.
        GOTO            GETDOC2
.
NOTDSC2 MOVE            SP8,D8DATE
        MOVE            SP3,DDEST
        MOVE            SP8,DTIME
.
GETDOC2 MOVE            ADOCTA,KEY6
        CALL            RDDOCT1
        BRANCH          OVRCD OF NODOC
.
        MOVE            DGNAME,ANS
        CLEAR           ADOCDESC
        MATCH           SP1,ANS
        GOTO            APPDSN IF EQUAL
        APPEND          ANS,ADOCDESC
        APPEND          DOT,ADOCDESC
APPDSN  APPEND          DSNAME,ADOCDESC
        APPEND          SP2,ADOCDESC
        RESET           ADOCDESC
.
        MOVE            SP12,DTELEH
        GOTO            GETHF
.
NODOC   MOVE            SP30,ADOCDESC
        MOVE            SP12,DTELES
        MOVE            SP12,DTELEH
.
GETHF   PACK            KEY14 WITH AFUNDH,ZERO4,SP10
        MOVE            SP30,HFNAME
        CALL            RDFUND1
        MOVE            HFNAME,DFUND
        MOVE            ADIAG1,KEY50
.
        MOVE            ZERO,FORM62
        MOVE            ZERO,FORM62A
        MOVE            ZERO,STEXTRA
        MOVE            ZERO,HFPORT
        MOVE            ZERO,MAXDISC
.
        OPEN            PATTRAN2,"pattranf"
        PACK            KEY30,AADMNO,SP30
        CALL            RDSTRAN2
NXTRN   CALL            RDKTRAN2
        BRANCH          OVRCD OF CALNET
.
        MATCH           AADMNO,TADMN
        GOTO            CALNET IF NOT EQUAL
.
        MOVE            TRATEF,FORM62
        MOVE            TRATEH,HFPORT
        MOVE            TDISC,MAXDISC
        MOVE            TALLW,FORM62A
        MOVE            TEXTRA,STEXTRA
        GOTO            NXTRN
.
CALNET  CLOSE           PATTRAN2
        MOVE            FORM62,NETTOT
        ADD             HFPORT,NETTOT
        ADD             STEXTRA,NETTOT
        SUB             MAXDISC,NETTOT
        SUB             FORM62A,NETTOT
.
.       Get claim details if any
.
GETCLM  PACK            CLMDET1 WITH SP30,SP30
        PACK            CLMDET2 WITH SP30,SP30
.
        UNPACK          SP5 WITH TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
        MOVE            "CL" TO TCODE
        PACK            KEY5 WITH TCODE,ACLAIM
        CALL            RDCODE1
.
        MOVE            ZERO,FORM2
GETCLLP ADD             ONE,FORM2
        COMPARE         SIX,FORM2
        GOTO            ENDCLM IF NOT LESS
.
        LOAD            ANS USING FORM2 OF TCINDC1,TCINDC2,TCINDC3:
                                           TCINDC4,TCINDC5
.
        CMATCH          "W" TO ANS
        GOTO            WCO IF EQUAL
        CMATCH          "M" TO ANS
        GOTO            MAB IF EQUAL
        CMATCH          "V" TO ANS
        GOTO            VET IF EQUAL
.
        GOTO            GETCLLP
.
WCO     MOVE            AADMNO,KEY8
        OPEN      PATWC1A1,"patwc1af"
        CALL            RDWCOM1
        CLOSE     PATWC1A1
        BRANCH          OVRCD OF ENDCLM
.
        MOVE            SP30,INAME
        MOVE            WCICODE,KEY6
        OPEN      PATIN1A1,"patin1af"
        CALL            RDINSR1
        CLOSE     PATIN1A1
.
        CLEAR           CLMDET1
        APPEND          "W/COMP CLAIM: EMPLOYER: ",CLMDET1
        APPEND          WCENAME,CLMDET1
        APPEND          SP30,CLMDET1
        RESET           CLMDET1
.
        CLEAR           CLMDET2
        APPEND          "INS CO: ",CLMDET2
        APPEND          INAME,CLMDET2
        RESET           CLMDET2,27
        APPEND          " CLM NO: ",CLMDET2
        APPEND          WCCLMNO,CLMDET2
        APPEND          SP30,CLMDET2
        RESET           CLMDET2
        GOTO            ENDCLM
.
MAB     MOVE            AADMNO,KEY8
        OPEN            PATWMAB1,"patwmabf"
        CALL            RDWMAB1
        CLOSE           PATWMAB1
        BRANCH          OVRCD OF ENDCLM
.
        CLEAR           CLMDET1
        APPEND          "M.A.B. CLAIM NO.: ",CLMDET1
        APPEND          MREFNO,CLMDET1
        APPEND          SP30,CLMDET1
        RESET           CLMDET1
.
        PACK            CLMDET2 WITH SP30,SP20
        GOTO            ENDCLM
.
VET     MOVE            AADMNO,KEY8
        OPEN            PATWVET1,"patwvetf"
        CALL            RDWVET1
        CLOSE           PATWVET1
        BRANCH          OVRCD OF ENDCLM
.
        CLEAR           CLMDET1
        APPEND          "VETERAN AFFAIRS NO.: ",CLMDET1
        APPEND          VCLMNO,CLMDET1
        APPEND          SP30,CLMDET1
        RESET           CLMDET1
.
        PACK            CLMDET2 WITH SP30,SP20
        GOTO            ENDCLM
.
ENDCLM  UNPACK      PBDATE,XCENT,XYEAR,XMON,XDAY
        UNPACK      PLDDATE,XCENT1,XYEAR1,XMON1,XDAY1
.
        PACK            AWRDBED WITH AWARD,SLASH,ABED
        BRANCH          ASTAT OF PRADZ,GOTWRD,NOWARD,GOTWRD
.
PRADZ   MOVE            SP8,ATIME
.
NOWARD  MOVE            SP7,AWRDBED
GOTWRD  
.
        CALL            LABELAGE
.
        RETURN
.
PRTSHT2  
        CALL      OPNPRINT
.
        UNPACK    PKNAME,KEY45
        PRINT     *58,AURNO,*N,*58,PMEDI,*N,*58,AADMNO,*N,*N:
                  *N,*1,PSNAME,*23,PGNAME,*N,*N:
                  *1,PADD1,*48,ADOCDESC,*N:
                  *1,PADD2,*48,DTELES,*N:
                  *1,PSUBRB,*21,PPOST,*48,DTELEH,*N,*N:
                  *1,PNKNAME,*48,PNKRELP,*N:
                  *1,PNKADD1,*N:
                  *1,PNKADD2,*48,PNKTELP,*N:
                  *1,PNKSUBR,*21,PNKPOST,*48,PNKTELB,*N,*N:
                  *14,XDAY,SLASH,XMON,SLASH,XYEAR,*24,XAGE,*32,PREG,*N:
                  *52,D8DATE,*64,DTIME,*N:
                  *1,PTELEP,*14,PCONT,*24,PSEX,*32,PMSTAT,*60,DDEST:
                  *N,*N:
.
                  *58,AURNO,*N,*58,PMEDI,*N,*58,AADMNO,*N,*N:
                  *N,*1,PSNAME,*23,PGNAME,*N,*N:
                  *1,PADD1,*48,ADOCDESC,*N:
                  *1,PADD2,*48,DTELES,*N:
                  *1,PSUBRB,*21,PPOST,*48,DTELEH,*N,*N:
                  *1,KEY45,*48,PKRELP,*N:
                  *1,PKADD1,*N:
                  *1,PKADD2,*48,PKTELEP,*N:
                  *1,PKSUBR,*21,PKPOST,*48,PKTELEB,*N,*N:
                  *14,XDAY,SLASH,XMON,SLASH,XYEAR,*24,XAGE,*32,PREG,*N:
                  *52,D8DATE,*64,DTIME,*N:
                  *1,PTELEP,*14,PCONT,*24,PSEX,*32,PMSTAT,*60,DDEST:
                  *N,*N:
                  *1,KEY50,*N:
                  *N,*10,XYEAR1,*N,*N:
                  *11,DFUND,*44,AFNDMM,*65,AFNDTB,*N,*N:
                  *1,AUSR1,*11,NETTOT,*22,CLMDET1,*N,*22,CLMDET2,*N:
.
                  *N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N:
.
                  *58,AURNO,*N,*58,PMEDI,*N,*58,AADMNO,*N,*N:
                  *N,*1,PSNAME,*23,PGNAME,*N,*N:
                  *1,PADD1,*48,ADOCDESC,*N:
                  *1,PADD2,*48,DTELES,*N:
                  *1,PSUBRB,*21,PPOST,*48,DTELEH,*N,*N:
                  *1,KEY45,*48,PKRELP,*N:
                  *1,PKADD1,*N:
                  *1,PKADD2,*48,PKTELEP,*N:
                  *1,PKSUBR,*21,PKPOST,*48,PKTELEB,*N,*N:
                  *14,XDAY,SLASH,XMON,SLASH,XYEAR,*24,XAGE,*32,PREG,*N:
                  *52,D8DATE,*64,DTIME,*N:
                  *1,PTELEP,*14,PCONT,*24,PSEX,*32,PMSTAT,*60,DDEST:
                  *N,*N:
                  *1,KEY50,*N:
.
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                  *N,*N,*N,*N
.
        CALL      CLSPRINT
        RETURN
.
