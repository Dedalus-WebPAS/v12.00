. V9.04.01 04/04/2005 PV CAR 59696 Changed SILTCOD from DIM 5 to DIM 6
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINLTTKY
.   Routine   :   KSILTA00 Keyin Ledger Code         
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSILTA00 TOPIC     "SILTLED "
          MATCH     SILTLED,SP20
          IF        @EQUAL
            MOVE      UNDLN70,SILTLED 
            KEYIN     *PCCOL:CVERT,*DV,SILTLED: 
                      *PCCOL:CVERT,*V2LON,SILTLED:
                      *PCCOL:CVERT,*DV,SILTLED 
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,SILTLED:
                      *PCCOL:CVERT,*DV,SILTLED 
          ENDIF
.
          ENDSET    SILTLED 
          APPEND    SP70,SILTLED 
          RESET     SILTLED 
.
          MATCH     SP70,SILTLED 
          GOTO      KSILTA90 IF EQUAL
.
          CMATCH    EXITCHAR,SILTLED 
          GOTO      KSILTA95 IF EQUAL
.
          CMATCH    QUEST,SILTLED 
          GOTO      KSILTA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSILTA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SILTLED 
          APPEND    SP70,SILTLED 
          RESET     SILTLED 
.
          MATCH     SP70,SILTLED 
          GOTO      KSILTA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SILTLED                                 
KSILTA10
          PACK      KEY8,SILTLED,SP70
          CALL      RSSILT1 
          CALL      RKSILT1 
          MATCH     SILTLED,KEY8
          IF        !@EQUAL | OVRCD=1
            GOTO      KSILTA80
          ENDIF
          BRANCH    CKEYTYP,KSILTA75
          PACK      KEY8,SILTLED,SILTCOD
          CALL      RDSILT1 
KSILTA70
          MOVE      ZERO,EXIT
          GOTO      KSILTA99
KSILTA75
          MOVE      "Ledger Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KSILTA00
KSILTA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSILTA99,KSILTA99
          MOVE      "Ledger Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KSILTA00
KSILTA90
          MOVE      ONE,EXIT
          GOTO      KSILTA99
KSILTA95
          MOVE      TWO,EXIT
KSILTA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINLTTKY
.   Routine   :   HSILTA00 Ledger Translation  
.   Return    :           
.-------------------------------------------------------------------------------
HSILTA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "22",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HSILTA04
          CALL      GSCRN000
          BRANCH    EXIT,HSILTA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Ledger"             
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 7",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Subj/Comm"          
.
          MOVE      STDCOL02,STDCOL03
          ADD       "11",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"GL Subjective"      
.
          MOVE      STDCOL03,STDCOL04
          ADD       "15",STDCOL04
HSILTA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SILTLED 
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          CALL      RSSILT1 
HSILTA10
          CALL      RKSILT1 
          BRANCH    OVRCD,HSILTA15
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSILTA12
          CALL      HSILTA60
          BRANCH    OVRCD,HSILTA10
HSILTA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SILTLED     
          DISPLAY   *PSTDCOL02:STDROW,SILTCOD     
          DISPLAY   *PSTDCOL03:STDROW,SILTSUB     
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSILTA10 IF NOT EQUAL
HSILTA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSILTA20
          CALL      HSCRI000
          BRANCH    EXIT,HSILTA30,HSILTA35,HSILTA40,HSILTA45,HSILTA04:
                              HSILTA91,HSILTA50
          GOTO      HSILTA92
HSILTA30
          CALL      RKSILT1 
          BRANCH    OVRCD,HSILTA85
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          CALL      RPSILT1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTA10
HSILTA35
          MOVE      ST1,KEY8 
          CALL      RDSILT1 
          CALL      RPSILT1 
          BRANCH    OVRCD,HSILTA85
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSILTA36
          CALL      RPSILT1 
          BRANCH    OVRCD,HSILTA37
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSILTA36 IF NOT EQUAL
HSILTA37
          MOVE      ZERO,XITEMNO
          GOTO      HSILTA10
HSILTA40
          MOVE      ST1,KEY8 
          CALL      RDSILT1 
          CALL      RPSILT1 
          BRANCH    OVRCD,HSILTA85
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTA08
HSILTA45
          CALL      RKSILT1 
          BRANCH    OVRCD,HSILTA85
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSILT1 
HSILTA46
          CALL      RPSILT1 
          BRANCH    OVRCD,HSILTA47
          PACK      KEY8,SILTLED,SILTCOD,SP70                                   
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSILTA46 IF NOT EQUAL
HSILTA47
          MOVE      ZERO,XITEMNO
          GOTO      HSILTA10
HSILTA50  COMPARE   ZERO,CSEARCH
          GOTO      HSILTA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTA08
HSILTA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTA08
HSILTA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSILTA61 IF EQUAL
          MATCH     SCHFLD01,SILTLED     
          GOTO      HSILTA72 IF NOT EQUAL
HSILTA61
          MATCH     SP70,SCHFLD02
          GOTO      HSILTA62 IF EQUAL
          MATCH     SCHFLD02,SILTCOD     
          GOTO      HSILTA72 IF NOT EQUAL
HSILTA62
          MATCH     SP70,SCHFLD03
          GOTO      HSILTA63 IF EQUAL
          MATCH     SCHFLD03,SILTSUB     
          GOTO      HSILTA72 IF NOT EQUAL
HSILTA63
HSILTA64
HSILTA65
HSILTA66
HSILTA67
HSILTA68
HSILTA69
HSILTA70
          GOTO      HSILTA75
HSILTA72  MOVE      ONE,OVRCD
HSILTA75  RETURN
HSILTA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,SILTLED,SILTCOD                                        
          CALL      RDSILT1 
HSILTA90
.                                                                               
          BEEP
          GOTO      HSILTA20
HSILTA91
          MOVE      SP70,SILTSUB 
          MOVE      SP70,SILTSPA 
          MOVE      SP70,KEY8 
          MOVE      SP70,SILTLED 
          GOTO      HSILTA96
HSILTA92
          MOVE      SP70,KEY8 
          MOVE      SP70,SILTLED 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,SILTLED,SILTCOD                                        
HSILTA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSILTA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINLTTKY
.   Routine   :   HSILTB00 Ledger Tran. by GL  
.   Return    :   SILTLED 
.-------------------------------------------------------------------------------
HSILTB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "22",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HSILTB04
          CALL      GSCRN000
          BRANCH    EXIT,HSILTB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Ledger"             
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 7",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"GL Subjective"      
.
          MOVE      STDCOL02,STDCOL03
          ADD       "15",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Subj/Comm"          
.
          MOVE      STDCOL03,STDCOL04
          ADD       "11",STDCOL04
HSILTB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SILTLED 
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          CALL      RSSILT2 
HSILTB10
          CALL      RKSILT2 
          BRANCH    OVRCD,HSILTB15
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSILTB12
          CALL      HSILTB60
          BRANCH    OVRCD,HSILTB10
HSILTB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY20,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SILTLED     
          DISPLAY   *PSTDCOL02:STDROW,SILTSUB     
          DISPLAY   *PSTDCOL03:STDROW,SILTCOD     
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSILTB10 IF NOT EQUAL
HSILTB15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSILTB20
          CALL      HSCRI000
          BRANCH    EXIT,HSILTB30,HSILTB35,HSILTB40,HSILTB45,HSILTB04:
                              HSILTB91,HSILTB50
          GOTO      HSILTB92
HSILTB30
          CALL      RKSILT2 
          BRANCH    OVRCD,HSILTB85
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          CALL      RPSILT2 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTB10
HSILTB35
          MOVE      ST1,KEY20
          CALL      RDSILT2 
          CALL      RPSILT2 
          BRANCH    OVRCD,HSILTB85
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSILTB36
          CALL      RPSILT2 
          BRANCH    OVRCD,HSILTB37
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSILTB36 IF NOT EQUAL
HSILTB37
          MOVE      ZERO,XITEMNO
          GOTO      HSILTB10
HSILTB40
          MOVE      ST1,KEY20
          CALL      RDSILT2 
          CALL      RPSILT2 
          BRANCH    OVRCD,HSILTB85
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTB08
HSILTB45
          CALL      RKSILT2 
          BRANCH    OVRCD,HSILTB85
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY20,Z70                                                   
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSILT2 
HSILTB46
          CALL      RPSILT2 
          BRANCH    OVRCD,HSILTB47
          PACK      KEY20,SILTLED,SILTSUB,SILTCOD,SP70                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSILTB46 IF NOT EQUAL
HSILTB47
          MOVE      ZERO,XITEMNO
          GOTO      HSILTB10
HSILTB50  COMPARE   ZERO,CSEARCH
          GOTO      HSILTB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTB08
HSILTB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSILTB08
HSILTB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSILTB61 IF EQUAL
          MATCH     SCHFLD01,SILTLED     
          GOTO      HSILTB72 IF NOT EQUAL
HSILTB61
          MATCH     SP70,SCHFLD02
          GOTO      HSILTB62 IF EQUAL
          MATCH     SCHFLD02,SILTSUB     
          GOTO      HSILTB72 IF NOT EQUAL
HSILTB62
          MATCH     SP70,SCHFLD03
          GOTO      HSILTB63 IF EQUAL
          MATCH     SCHFLD03,SILTCOD     
          GOTO      HSILTB72 IF NOT EQUAL
HSILTB63
HSILTB64
HSILTB65
HSILTB66
HSILTB67
HSILTB68
HSILTB69
HSILTB70
          GOTO      HSILTB75
HSILTB72  MOVE      ONE,OVRCD
HSILTB75  RETURN
HSILTB85
          LOAD      KEY20,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY20,SILTLED,SILTSUB,SILTCOD                               
          CALL      RDSILT2 
HSILTB90
.                                                                               
          BEEP
          GOTO      HSILTB20
HSILTB91
          MOVE      SP70,SILTSPA 
          MOVE      SP70,KEY20
          MOVE      SP70,SILTLED 
          GOTO      HSILTB96
HSILTB92
          MOVE      SP70,KEY20
          MOVE      SP70,SILTLED 
          LOAD      KEY20,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY20,SILTLED,SILTSUB,SILTCOD                               
HSILTB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSILTB99
          RETURN
