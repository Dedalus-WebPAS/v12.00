.******************************************************************************
.* System    :   Private Practice System                                      *
.* Program   :   IBAPRI37                                                     *
.* Desc      :   Invoice Pending Report                                       *
.******************************************************************************
.* Date      :   15/11/91                                                     *
.* Author    :   Stephen Armstrong                                            *
.* Function  :   Prints a report in debtor sequence detailing any pending     *
.*               invoices on file and the amount to be billed                 *
.* Mods      :                                                                *
.*                                                                            *
.******************************************************************************
.* V12.00.01 27/08/2025  Alina Bhari      TSK 0954453                         *
.*           Recompiled for PRIINVHL - Added Patient Name                     *
.* V11.05.02 06/03/2025  Jacob Jackson    TSK 0945956                         *
.*           Remove title from name if GI Ind 3=B                             *
.*           04/02/2025  Peter Vela       TSK 0939466                         *
.*           Recompiled for PRIINVPR - Added Distance In kms                  *
.*           Eclipse WebServices DVAW                                         *
.* V11.05.01 20/01/2025  Jacob Jackson    TSK 0945956                         *
.*           Add "Linked Visit Number" to report                              *
.* V11.04.01 09/07/2024  J.Tan            TSK 0934944                         *
.*           Mod to check Referral Provider no from a linked Practice         *
.* V11.03.02 08/11/2023  Nikitha B      TSK 0927699c                          *
.*           Read CAPPRVNO and PTCNHABN for Hospital Approval and ABN number. *
.* V11.03.01 04/10/2023  Nikitha B     TSK 0927699                            *
.*           Recomplied for PRIINVHL, PRIINVTL - Stationary variables         *
.* V11.01.03 24/08/2021   Davin           TSK 0897318                         *
.*           Recompiled for PRIINVTL - added field 51 (Adjustment Total)      *
.* V11.01.02 20/07/2021   J.Tan           TSK 0908902                         *
.*           Recompiled for PRIINVPR - printing Insurance for multi pages inv.*
.* V11.01.01 29/04/2021  Tracey Nguyen    TSK 0308555                         *
.*           Added PATIN1FD/IO for PRIINVPR - Added routine PRTAC000 to print *
.*           WorkCover and TAC details on the body of the invoice             *
.*----------------------------------------------------------------------------*
.* V11.00.06 11/11/2020  Peter Vela       TSK 0898361                         *
.*           Recompiled for PRIINVPR                                          *
.* V11.00.05 20/10/2020  Peter Vela       TSK 0898361                         *
.*           Recompiled for PRIINVPR                                          *
.* V11.00.04 24/04/2020  Peter Vela       TSK 0874025                         *
.*           Recompiled for PRIINVPR                                          *
.* V11.00.03 22/04/2020  Peter Vela       TSK 0874025                         *
.*           Recompiled for PRIECTFD                                          *
.* V11.00.02 17/04/2020  Peter Vela    TSK 0874025                            *
.*           Recompiled for PRIECTFD                                          *
.* V11.00.01 15/04/2020  Thanh T.      TSK 0879163                            *
.*           Added SEXDSP00                                                   *
.******************************************************************************
.* V10.14.04 20/08/2019  Thanh T.      TSK 0879967                            *
.*           Recompiled for PRIINVPR changes                                  *
.* V10.14.03 23/04/2019  Peter Vela    TSK 0871522                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.14.02 22/03/2019  J.Tan            TSK 0857392                         *
.*           Changed RCP Transaction count from DIM3 to DIM5                  *
.* V10.14.01 21/11/2018  Peter Vela    TSK 0866770                            *
.*           Recompiled for PRIINVPR                                          *
.******************************************************************************
.* V10.13.03 21/11/2018  Peter Vela    TSK 0866770                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.13.02 02/11/2018  Peter Vela    TSK 0863035                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.13.01 03/08/2018  Richa Phogat  TSK 0848506                            *
.*           Updated keylength for RDPRDO1 from KEY18 to KEY22                *
.*           Changed DIM23 to DIM27                                           *
.* V10.12.01 26/04/2018  Peter Vela    TSK 0852811                            *
.*           Recompiled for PRIINVTL                                          *
.* V10.11.03 06/09/2017  J.Tan         TSK 0821057                            *
.*           Recompiled for PRIINVHL - mod to variable 76 health fund         *
.* V10.11.02 28/07/2017  Peter Vela    TSK 0837619                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.11.01 28/07/2017  Peter Vela    TSK 0837619                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.10.01 10/05/2017  Tracey Nguyen TSK 0837929                            *
.*           Recompiled for PRIINVHL and PRIINVTL - Fixed I*C error message   *
.*           on PATMESG1                                                      *
.* V10.08.03 22/06/2016  Peter Vela    TSK 0294177                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.08.02 09/06/2016  Peter Vela    TSK 0820206                            *
.*           Recompiled for PRIINVHL                                          *
.* V10.08.01 07/04/2016  Peter Vela    CAR 0294177                            *
.*           Recompiled for PRIINVPR                                          *
.* V10.06.01 15/05/2015  Davin         CAR 310155                             *
.*           Recompiled for PATGBCRN - added MOD10V05 for BPAY                *
.* V10.04.09 16/06/2014  Peter Vela    CAR 302147                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.08 12/06/2014  Steve Armstrong  CAR 301639                          *
.*           Recompiled for changes to PRIINVPR (tempfile issues)             *
.* V10.04.07 17/04/2014  Peter Vela    CAR 285260                             *
.*           Recompiled for PRIINVPR - Moved Cabrini invoice tail one line    *
.*           down in PRINV230                                                 *
.* V10.04.06 15/04/2014  J.Tan         CAR 261630                             *
.*           Recompiled for PRIINVPR - Removed port number from temp file name*
.* V10.04.05 15/04/2014  Peter Vela    CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.04 14/04/2014  Peter Vela    CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.03 11/04/2014  Peter Vela    CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.02 31/03/2014  Peter Vela    CAR 285260                             *
.*           Recompiled for PRIINVPR                                          *
.* V10.04.01 05/04/2014  J.Tan         CAR 298195                             *
.*           Replaced PRIINVVR with PRIWEBVR                                  *
.* V10.03.07 09/12/2013  J.Tan         CAR 280726                             *
.*           Recompiled for PRIINVPR - flag for Inpatients from Other hospital*
.* V10.03.06 05/07/2013  J.Tan         CAR 288042                             *
.*           Recompiled for PRIINVPR - Fixed WEBFLAG                          *
.* V10.03.05 20/06/2013  Davin         CAR 287161                             *
.*           Recompiled for PATGBCRN - right justify ptcnhbpi                 *
.* V10.03.04 04/06/2013  J.Tan         CAR 269971                             *
.*           Mods to read rounding parameter                                  *
.* V10.03.03 18/07/2012  Don Nguyen    CAR 264561                             *
.*           Recompiled for PATGBCRN                                          *
.* V10.03.02 09/05/2012 J.Tan          CAR 222041                             *
.*           Recompiled for PRIINVPR - checking for range of Medical Prac     *
.* V10.03.01 17/02/2012  J.Tan             CAR 245412                         *
.*           Mods checking for range of Medical practice for each item transac*
.* V10.00.03 14/09/2010  Davin             CAR 229590                         *
.*           Recompiled for PRIINVTL                                          *
.* V10.00.02 26/08/2010  Davin             CAR 226963                         *
.*           Recompiled for PRIINVHL & PRIINVTL                               *
.* V10.00.01 24/08/2010  Peter Vela CAR 221500                                *
.*           Recompiled for PRIINVTL                                          *
.* V9.12.06  09/12/2009  Mike Laming    CAR 210835                            *
.*           Recompiled for PRIINVPR                                          *
.* V9.12.05  28/10/2009  Peter Vela     CAR 207238                            *
.*           Recompiled for PRIINVPR                                          *
.* V9.12.04  01/10/2009  Peter Vela     CAR 203243                            *
.*           Recompiled for PRIINVHL                                          *
.* V9.12.03  03/09/2009  Peter Vela     CAR 194715                            *
.*           Recompiled for PRIINVHL PRIINVTL                                 *
.* V9.12.02  07/08/2009  Mike Laming    CAR 123419                            *
.*           Recompiled for PRIINVPR - re-write PATHL000, Add PRIHTRaf 4th Indx
.* V9.12.01  23/07/2009  J.Tan          CAR 200230                            *
.*           Recompiled for PRICALFN - fixed generating previous year data    *
.* V9.11.04  23/09/2009  Davin            CAR 178015                          *
.*           Recompiled for PRIINVTL - Added field 33 for BPAY CRN (Generated)*
.*           Added VARGBCRN and PATGBCRN - BPAY Reference Number              *
.* V9.11.03  08/01/2009  Steve Armstrong   CAR 185927                         *
.*           Recompiled for changes to PRIINVPR & PRIINVVR.                   *
.*           08/01/2009 J.Tan      CAR 178415                                 *
.*           Added Medical Practice to prifinsf                               *
.* V9.11.02  01/12/2008  Steve Armstrong   CAR 184702                         *
.*           Recompiled for changes to PRIINVHL & PRIINVTL.                   *
.* V9.11.01  20/10/2008  J.Tan         CAR 178415                             *
.*           Mods checking for Medical practice user access                   *
.******************************************************************************
.* V9.10.01  12/05/2008  J.Tan         CAR 162313                             *
.*           Added Deposit Status to compdeaf file                            *
.******************************************************************************
.* V9.08.02  14/05/2007  Peter Vela    CAR 136586                             *
.*           Recompiled for PRIINVPR - Added SJOG Referral Doctor details     *
.* V9.08.01  28/09/2006  Peter Vela    CAR 118366                             *
.*           Recompiled for PRIINVHL - Added medicare suffix                  *
.******************************************************************************
.* V9.06.01  28/04/2006  Peter Vela    CAR 102393                             *
.*           Recompiled for PRIINVHL - Added PRFA variables from PRIINVFD     *
.******************************************************************************
.* V9.05.02  27/03/2006  Peter Vela    CAR 95780                              *
.*           Recompiled for PRIINVHL - Added emg mobile contact numbers       *
.* V9.05.01  27/03/2006  Peter Vela CAR 61299                                 *
.*           Recompiled for PRIINVHL                                          *
.******************************************************************************
.* V9.04.05  06/10/2005  J.Tan    CAR 79018                                   *
.*           Recompiled for PRIINVPR - fixing item amount                     *
.* V9.04.04  03/08/05 J.Tan    CAR 62750                                      *
.*           Removed redefined amount variables                               *
.* V9.04.03  01/07/2005  J.Tan    CAR 61649                                   *
.*           Fixed set up packname format                                     *
.* V9.04.02  16/06/2005  J.Tan    CAR 56701                                   *
.*           Recompiled for PRIINVPR - HIC item invoice file                  *
.* V9.04.01  24/06/2004  J.Tan    CAR 55893                                   *
.*           Recompiled for PRIINVPR - fixed west wimmera invoice layou       *
.******************************************************************************
.* V9.03.07  24/06/2004  J.Tan    CAR 50235                                   *
.*           Recompiled for PRIINVPR - non bank deposit                       *
.* V9.03.06  26/05/04 J.Tan  CAR 49769                                        *
.*           Fixed getting patient debtors name                               *
.* V9.03.05  01/04/2004 J.Tan   CAR 44116                                     *
.*           Recompiled for PRIINVPR - mods for credit note                   *
.* V9.03.04  02/03/2004  Lina Vo        CAR 47921                             *
.*           Removed use of PRIDBTFD & IO.                                    *
.* V9.03.03  16/02/2004  Lina Vo        CAR 44137                             *
.*           Changed program to produce report by Medical Practice break down.*
.*           Also keyin Medical Practice range with Start and Finish as       *
.*           Default.                                                         *
.* V9.03.02  29/01/2004  J.Tan                                                *
.*           Recompiled for PRIINVPR - removing pridep                        *
.* V9.03.01  29/10/2003 Sandra Barcham   43783                                *
.*           Recompiled for NZHISIIO and NZHISIUP                             *
.******************************************************************************
.*        V9.02.19  13/02/2003  Dean Cramer  CAR 22238                        *
.*                  Recompiled for RCPTRNFD                                   *
.*        V9.02.18  20/11/2002  Dean Cramer                                   *
.*                  Recompiled for PRIINVPR - RCH PRAs for invoices           *
.*        V9.02.17  06/11/2002  J.Tan                                         *
.*                  Recompiled for PRIKYDEB - merge U/R                       *
.*        V9.02.16  25/10/2002  J.Tan                                         *
.*                  Recompiled for PRIINVPR - fixed displaying o/s amount     *
.*        V9.02.15  21/10/2002  J.Tan                                         *
.*                  Recompiled for PRIINVTL - outstanding amount              *
.*        V9.02.14  18/07/2002  Dean Cramer srf 19532 rebounded               *
.*                  Fix W * I when no medical practice entered from ? list    *
.*        V9.02.13  10/07/2002  Dean Cramer                                   *
.*                  Include the Patient Type on the report.  srf 19187        *
.*                  Fix where deposit section not verfying the debtor number  *
.*                  because of bad key setup befpre RDMAST1. srf 19532        *
.*        V9.02.12  25/06/2002  J.Tan                                         *
.*                  Mods to check the selected medical practice               *
.*        V9.02.11  21/06/2002  J.Tan                                         *
.*                  Fixed reading tempfile P*K                                *
.*        V9.02.10  19/06/2002  J.Tan                                         *
.*                  Recompiled for PRIINVVR & PRIINVIT                        *
.*        V9.02.09  04/06/2002  Dean Cramer Srf 17730(rebound)
.*                  Recompiled for PRIINVVR & PRIINVIT
.*        V9.02.08  31/05/2002  Dean Cramer Srf 17730                         *
.*                  Add Given Name to name sequence order.                    *
.*        V9.02.07  27/05/2002  J.Tan                                         *
.*                  Recompiled for PRIINVHL - Added patient indicator         *
.*        V9.02.06  17/05/2002  Dean Cramer                                   *
.*                  Include Patient Surname Sequence option                   *
.*                  13/05/2002  Dean Cramer                                   *
.*                  Include Medical Practice selection                        *
.*        V9.02.05  08/03/2002  J.Tan                                         *
.*                  Recompiled for PRIINVHL - Added claim code                *
.*        V9.02.04  07/02/2002  J.Tan                                         *
.*                  Recompiled for PRIINVPR - Doctor Income percentage        *
.*        V9.02.03  10/01/2002  J.Tan                                         *
.*                  Recompiled for PRIINVIT - Changed key for tempfile        *
.*        V9.02.02  01/11/2001  Greg Horvat                                   *
.*                  Recompiled for ACTCOMN1 - Added xtra option to the        *
.*                  parameter PNSWRACE                                        *
.*        V9.02.01  02/10/2001  J.Tan                                         *
.*                  Mods to use PMSHCPFD instead of PATDO1FD                  *
.*        V5.10.B01 12/04/2001  Glenn Saunders                                *
.*                  Remove all references to PATSUR file (old surname file).  *
.*        V5.08.08  15/09/2000  Davin  SRF 4964                               *
.*                  Recompiled for PRIINVHL - invoice indicator               *
.*        V5.08.07  16/08/2000  Caleb Sharman                                 *
.*                  Changed Health Fund variables to be 8 chars               *
.*        V5.08.06  15/08/2000  Davin  SRF 4106                               *
.*                  Recompiled for PRIINVPR - templated tail for multipage    *
.*        V5.08.05  02/08/2000  J.Tan                                         *
.*                  Recompiled for PRIINVPR - form feed                       *
.*        V5.08.04  03/07/2000  Steve Downing                                 *
.*                  Recompiled for PRIINVPR                                   *
.*        V5.08.03  21/06/2000  Davin                                         *
.*                  Recompiled for PRIINVPR - added invoice templating        *
.*                  29/06/2000  Steve Armstrong                               *
.*                  Recompiled for changes to PRICALFS (PATFIGFD)             *
.*        V5.08.02  17/05/2000  J.Tan                                         *
.*                  Recompiled for PRIINVPR - invoice on landscape            *
.*        V5.08.01  05/05/2000  J.Tan                                         *
.*                  Recompiled for PRIDOCT file                               *
.*        V5.08.B02 26/03/2000  J.Tan                                         *
.*                  Recompiled for PRIINVPR - GST                             *
.*        V5.08.B01 25/02/2000  Greg Horvat                                   *
.*                  Removed OUTADJFD OUTADJIO PATMMRFD PATMMRIO & PRIPRADJ    *
.*        V5.07.07  24/11/1999  J.Tan                                         *
.*                  Recompiled for PRIINVPR - set PRDTSERV to one for cash    *
.*        V5.07.06  18/10/1999  Steve Armstrong                               *
.*                  Recompiled for tempfile index changes to PRIINVPR/PRIINVVR*
.*        V5.07.05  15/10/1999  D.Di Paola                                    *
.*                  Recompiled for PRISPTFD and PRIITMFD                      *
.*        V5.07.04  12/10/1999  J Habasque                                    *
.*                  Recompiled for PRIHRTFD & PRIBULFD                        *
.*        V5.07.03  02/07/1999  J.Tan                                         *
.*                  Recompiled for PRIINVPR for private practice receipt no.  *
.*        V5.07.02  22/06/1999  Jill Habasque                                 *
.*                  Recompiled for PRISTAIO                                   *
.*        V5.07.01  09/06/1999  Greg Horvat                                   *
.*                  Recompiled for PRIINVIO - Fixed problem with direct read  *
.*                  Jill Habasque - Recompiled for PRIINVS srf 632328         *
.*        V5.07.B01 30/11/1998  Davin                                         *
.*                  Mods for 507 (CPDATE)                                     *
.******************************************************************************
.*        V5.05.02  11/12/1997  Nick   SRF 623274                             *
.*                  Recompiled for PRIINVPR                                   *
.*        V5.05.01  09/10/1997  Steve Armstrong    WWH Mods                   *
.*                  Removed ARS related code for G/L Interface                *
.**************************************************************************** *
.*        V6.04.01  06/12/1996  Greg Horvat                                   *
.*                  Recompiled for PRIINVPR - Changed some include labels     *
.* ************************************************************************** *
.*                                                                            *
.*        V6.03.01  31/01/1995  Paul Howells     Surname Search               *
.*                  Added PATCOMM & PATCOMN1                                  *
.*        V6.03.B2  18/03/1995  Graeme Williams   R6.03 enhancements          *
.*                  Added PRISPTFD and PRIEXCFD. Read in item record before   *
.*                  calling GETAJ000                                          *
.*        V6.03.B3  01/05/1995  Greg Horvat      SRF 135684                   *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.03.B4  02/05/1995  Gabrielle       Mt Wilga                      *
.*                  Changed description of St Edmunds invoice layout to       *
.*                  Alpha, removed printing the heading description from      *
.*                  either controlf of pripracf file using prcnaddr param.    *
.*        V6.03.B5  02/05/1995  Gabrielle   SRF 133213                        *
.*                  Removed "Hit <ENTER>..." message when displaying invoice  *
.*                  layouts that go over a screen                             *
.*        V6.03.06  26/06/1995  Paul Howells     SRF 610111                   *
.*                  Recompiled for PRIINVPR.                                  *
.*        V6.03.07  06/10/1995  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR, PRIKYDEB & PRIVRDEB              *
.*        V6.03.08  18/10/1995  Steve Armstrong                               *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.03.09  28/10/1995  Steve Armstrong   SRF 612041                  *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.03.10  06/11/1995  Steve Armstrong   SRF 612041                  *
.*                  Recompiled for PRIINVPR                                   *
.*        V6.03.11  29/11/1995  Greg Horvat      SRF 612884                   *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.12  18/12/1995  Greg Horvat      SRF 612884 (Rebound)         *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.13  22/12/95 J.Tan     SRF 613313                             *
.*                  Recompiled for PRIINVPR - Print message on Lingards layout*
.*        V6.03.14  27/02/1996  Greg Horvat      SRF 614008                   *
.*                  Changed to print to be invoiced deposits on the report    *
.*                  29/02/1996  Greg Horvat      SRF 614008                   *
.*                  Recompiled for PRIINVPR - not updating prifinsf & pristatf*
.*                  properly when printing deposits                           *
.*        V6.03.15  07/03/1996  Greg Horvat      SRF 614378                   *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.16  12/03/1996  Greg Horvat      SRF 614473                   *
.*                  Recompiled for PRINNVPR - Changed Lingards invoice layout *
.*        V6.03.17  25/03/1996  Greg Horvat      SRF 614592                   *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.18  03/04/1996  Greg Horvat      SRF 614592 (Rebound)         *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.19  10/05/1996  Greg Horvat      SRF 615220                   *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.20  31/05/1996  Greg Horvat      SRF 615220 (Rebound)         *
.*                  Recompiled for PRIINVPR - Changed Lingards invoice layout *
.*        V6.03.21  10/11/1996  Greg Horvat      SRF 617359                   *
.*                  Recompiled for PRIINVPR - Changed to write the medicare   *
.*                  assign form number from the hold DTR file to the DTR file *
.*                                                                            *
.******************************************************************************
.
.$$$$$
.         Invoice Pending Report (IBAPRI37)
.         ---------------------------------
.
.         ML0000
.         Open files and initialisation
.         pridebtf
.         prihdbtf
.         prihreff
.         prihtraf
.         pritestf
.         prithisf
.         primultf
.         prigrpaf
.         priitemf
.         pridoctf
.         patma1af
.         patcodes
.         controlf
.
.         ML0100
.         Get the user option
.            If zero selected, end program
.            If one selected, proceed to create temp. file
.
.         ML1000
.         Create a temporary file to load debtors with pending invoices
.
.         Load the temp. file with the debtor numbers and unique identifiers
.            from those records in the referral file with pending invoices
.
.         Process each debtor's pending transactions using the invoice
.            subroutines to calculate pathology billing, then print them
.         
.         Get the next option
.
.         ML9999
.         Chain back to calling program
.
.$$$$$
.
.
          INC       STD001FD
.
.
.         Temporary File Definition
.         -------------------------
.
.         Filename : PRI37Axx.dat          (xx = port id)
.
PENTEMP1  IFILE SQL, FIXED=65, KEY="U1-8"
PENTEMP2  IFILE SQL, FIXED=65, KEY="U9-16,17-18,1-8"
PENTEMP3  IFILE SQL, FIXED=65, KEY="U19-38,39-58,9-16,17-18,1-8"
PENTEMP4  IFILE SQL, FIXED=65, KEY="U59-64,9-16,17-18,1-8"
.
.NAME     TYPE    LENGTH     PHYSICAL     START     DESCRIPTION
.----     ----    ------     --------     -----     -----------
DTEMPUNQ  DIM       8           8           1       Unique identifier
TEMPDEB   DIM       8           8           9       Debtor number
DTEMPSCN  DIM       2           2          17       Scan flag
TEMPSUR   DIM       20          20         19       Patient Surname  
TEMPGIV   DIM       20          20         39       Patient Given name  
TEMPPRAC  DIM       6           6          59       Medical Practice    
.
.End of Record                             65
.
. Redefine form fields from key
. -----------------------------
.
TEMPUNQ   FORM      8
TEMPSCN   FORM      2
.
.
. FILE DESCRIPTION INCLUDES
. -------------------------
.
          INC       TFILEVAR/INC                 * Generate Temp File Name
          INC       WEBERRFD/INC                 * Web Server Error Logging
.
          INC       IBAGEDFD/INC
          INC       IBAGSTFD/INC
          INC       IBAPRNFD/INC
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
          INC       PRIAUIFD/INC
          INC       PRIBULFD/INC                 * bulk billing file
          INC       PRICNOFD/INC                 * Credit note file
...          INC       PRIDBTFD/INC                 * debtor file
          INC       PRIHDBFD/INC                 * holding header file
          INC       PRIHOLFD/INC                 * account hold file
          INC       PRIHREFD/INC                 * holding referral record
          INC       PRIHTRFD/INC                 * holding transaction file
          INC       PRICONFD/INC                 * control file
          INC       PRIDTRFD/INC                 * debtor transaction file
          INC       PRIEXCFD/INC                 * exception charges file
          INC       PRIITMFD/INC                 * item file
          INC       PRISTAFD/INC                 * financial statistics file
          INC       PRIGRPFD/INC                 * item group file
          INC       PRITESFD/INC                 * pathology test file
          INC       PRIHISFD/INC                 * history file
          INC       PRIWCOFD/INC                 * workers comp file
          INC       PRIMABFD/INC                 * transport accident file
          INC       PRIMGPFD/INC                 * medicare gap file
          INC       PRIVAFFD/INC                 * veteran affair file
          INC       PRIINVFD/INC                 * invoice file
          INC       PRIPRAFD/INC                 * medical practice file
          INC       PRISPTFD/INC                 * spec. path. test file
          INC       PRIMULFD/INC                 * multiple codes file
          INC       PRIFIGFD/INC                 * financial summary file
          INC       PRIFINFD/INC                 * financial summary file
          INC       PRIDOCFD/INC                 * doctor file
          INC       PRIALSFD/INC                 * Medical Prac.all user access
          INC       PRISECFD/INC                 * Medical Prac.security access
.
          INC       PATCONFD/INC                 * control file
          INC       PATMA1FD/INC                 * patient master file
          INC       PATMESFD/INC                 * message file
          INC       PATCODFD/INC                 * codes file
          INC       PATIN1FD/INC                 * Insurance file
          INC       PMSHCPFD/INC                 * doctor file
          INC       PMSHCLFD/INC
          INC       PATDRGFD/INC                 * date range period file
          INC       PATGSRFD/INC                 * Surname / Given Name File
          INC       PATVISFD/INC                 * visit file
          INC       PATMI1FD/INC                 * admission file
          INC       PATPERFD/INC                 * doctor personal file
          INC       PATPR1FD/INC                 * pre-admission file
          INC       PATRE1FD/INC                 * PRA file            
          INC       PMSPX2FD/INC
          INC       PMSVX1FD/INC
          INC       OUTPREFD/INC                 * Out. pre-att. booking file
          INC       BOKRC1FD/INC
.
          INC       HICITIFD/INC                 * HIC items invoice file
          INC       PRIECTFD/INC
          INC       PRIVRDEB/INC                 * variables for PRIKYDEB
          INC       PRIWEBVR/INC                 * variables for PRIINVPR
          INC       RCPBNKFD/INC
          INC       RCPBDTFD/INC
          INC       RCPDTEFD/INC                 * receipt details file
          INC       RCPREGFD/INC                 * register              
          INC       COMDEPFD/INC                 * common deposit file
          INC       PATCOMM/INC
.
          INC       PATALRFD/INC                 * Alerts & Medical Warnings
          INC       NZHISIFD/INC                 * NZHIS Variables
          INC       NHIMASFD/INC                 * NZHIS Variables
          INC       PATDHEAD/INC                 * PMI Header Details
          INC       PATCALAG/INC                 * PMI Age Calc
          INC       PMIVARS/INC                  * PMI Variables
          INC       SCRPSTFD/INC
          INC       VARGBCRN/INC
.
          INC       PATHSPFD/INC           * Hospital Details for GBCRN000
.
          INC       WEBIMCFD/INC
          INC       WEBB2BFD/INC
.
COUNT     FORM      3
.
.
. PROGRAM CONSTANTS
. -----------------
.
AMA       INIT      "A-"
CATEGORY  DIM       2
CODE      DIM       3
ERASE     INIT      "iserase "
ECCLMARR  DIM       50
FINISH    INIT      "Finish"
ISBUILD   INIT      "isbuild "
MBS       INIT      "M-"
PIPE      INIT      "|"
SP45      INIT      "                                             "
START     INIT      "Start"
UKEY1     INIT      " 65 UC1-8 UC9-16,17-18,1-8 UC19-38,39-58,9-16,17-18,1-8"
UKEY2     INIT      " UC59-64,9-16,17-18,1-8"
X5        INIT      "XXXXX"
X10       INIT      "XXXXXXXXXX"
ZED6      INIT      "zzzzzz"
CATGI     INIT      "GI"
.
.
. LOCAL VARIABLE DEFINITION
. -------------------------
.
AMNTPRAC  FORM      8.2                          * medical practice subtotal
.
CALCDATE  DATE      8
CMDLIN1   DIM       125
CMDLIN2   DIM       16
CURRROW   FORM      3
.
DIM3      DIM       3
DIM5      DIM       5
DIM8      DIM       8
DIM10     DIM       10
DIM15     DIM       15
DIM25     DIM       25
DIM28     DIM       28
DISPAMNT  FORM      8.2                          * medical practice subtotal
.
FRSTFLAG  FORM      1
FGSTFLAG  FORM      1
FMTDEBT   DIM       9                            * formatted debtor number
FMTNAME   DIM       30                           * formatted debtor name
FMTPRAC   DIM       6                            * formatted medical practice
FORM3     FORM      3
FORM8     FORM      8
FSTAMNT   FORM      12.2                         * for PRICALFS
FSTDATE   DIM       8                            * for PRICALFS
FSTWORK   FORM      12.2                         * for PRICALFS
FULLINE   FORM      1                            * print full line flag
.                                                   0 = print full line
.                                                   1 = print short line
.
KEYSTARR  DIM       50[99]  * Key Strokes Array
KEYSTCNT  FORM      2       * Key Strokes Counter
FRSTGNAM  DIM       40
FULLGNAM  DIM       80
GRANDTOT  FORM      12.2                     * Grand total
HEALTHFD  DIM       6
IBCNABNN  DIM       11
IBCNUGST  FORM      1
IBCNUMCI  DIM       1
INVOICEN  FORM      8
MESSCODE  DIM       3
MPDESC    DIM       30                      * for PRIMPDDS
SMPDESC   DIM       6                      
EMPDESC   DIM       6                
MPRAC     DIM       6                       * medical practice
MPGEFLAG  FORM      1
NOTRANFG  FORM      1                       * Transaction flag
.
PATNAME   DIM       25
PATADD3   DIM       21
PREFIX    DIM       2                            * item prefix
PRNTSTRT  FORM      3
PRANAME   DIM       45                 * name of P.R.A.
PRAADD1   DIM       35                 * address of P.R.A. - line 1
PRAADD2   DIM       35                 *                     line 2
PRAADD3   DIM       35                 *                     line 3
PRAADD4   DIM       35
PRAPOST   DIM       8                  * postcode of P.R.A.
PRAPPHON  DIM       20                 * home phone of P.R.A.
PRABPHON  DIM       20                 * business phone of P.R.A.
PRAMPHON  DIM       20                 * mobile phone of P.R.A.
PRARREL   DIM       10                 * relationship of P.R.A.
.
PAGEPRAC  DIM       6                            * save med pract 
RACLINDC  DIM       1
SAVDEBT   DIM       8                            * save debtor variable
SAVSCAN   FORM      2                            * save scan flag
SCNDGNAM  DIM       40
SCHDDESC  DIM       50
SCHDCOPY  FORM      3       * No of Copies
SCHDPRIN  DIM       1       * Print Report 0=No 1
SCHDPRNT  DIM       6       * Printer No
OPTNFLAG  FORM      1
SETDFRPT  FORM      2
SETDFPRG  DIM       8
SELPRINT  DIM       6
SCHDTIME  DIM       8
SCHDDATE  DIM       8
SCHDPGID  DIM       8
PRHRE028  DIM       3
SEPFLAG   FORM      1                            * separate pages flag for MPs
.                                                    0 = No
.                                                    1 = Yes
SUBTOTAL  FORM      8.2                          * debtor subtotal
.
TEMPFILE  DIM       8
TOTINVAT  FORM      8.2                          * total invoice amount
TOTDEPAT  FORM      8.2                          * total deposit amount
.
VARIABLE  DIM       127
.
.
BJDAY     FORM      3
CJDAY     FORM      3
URDIM8    DIM       8
USERID    DIM       10
.
IBCNMHOS  FORM      1
.
CHKMPRAC  FORM      1
CREDTOT   FORM      8.2
CRDNFLAG  FORM      1
DIM27     DIM       27
EPRAC     DIM       6                  * medical practice
FORM7P2   FORM      7.2
FORM82    FORM      8.2
HTMLFILE  FIFO      ASCII, FIXED=250            *used in PATCATBI
SPRAC     DIM       6                  * medical practice
TEMP8P2   FORM      8.2
WEBFLAG   FORM      1
INVPFLAG  FORM      1
PHLNFLAG  FORM      1
VALDGICD  FORM      1
.
PRGID     INIT      "IBAPRI37"
PRGNAM    INIT      "Invoice Pending Report"
VERSION   INIT      "V12.00.01"
+
.**************************************************************************
.*                              ML0000                                    *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
ML0000    CALL      INIT0000                * Initialisation and open files
.
ML0100    CALL      OPTN0000                * Select options
          BRANCH    EXIT,ML9999             * EXIT = 1 if 0 chosen in menu
.
          CALL      SPRA0000               * get starting M.P.
          BRANCH    EXIT,ML1000            * exitchar input
.
          CALL      EPRA0000               * get ending M.P.
          BRANCH    EXIT,ML1000            * exitchar entered
          CALL      SPAG0000               * see if sep. pages for each M.P.
.
ML1000    CALL      USID0000                * Keyin user id       
          CALL      CREA0000                * Create temporary file
          CALL      LOAD0000                * Load in debtors
          CALL      PROC0000                * Process records for printing
.
          COMPARE   ONE,COPTION
          GOTO      ML2000 IF NOT EQUAL
.
.         By Patient Surname Sequence
.
          CALL      CREA0000
          CALL      SLOD0000
          CALL      SDEP0000
          GOTO      ML3000
.
.         By Debtor Number & Medical Practice Sequence
.
ML2000    CALL      PDEP0000                * Print deposits
.
ML3000    CALL      GRTL0000                * Print the grand total
          PRINT     *1,"*** End of Report ***"
          CALL      KILL0000                * Erase temp file
          GOTO      ML0100                  * Get next option
.
ML9999    CHAIN     PGM                     * Chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: ML0000    *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
.
INIT0000  CALL      DISPHEAD                     * display heading
.
          DISPLAY   *P56:24,"Opening pribulkf";
          OPEN      PRIBULK1,"pribulkf"          * bulk billing file
.
...          DISPLAY   *P64:24,"pridebtf";
...          OPEN      PRIDEBT1,"pridebtf"          * debtor file
.
          DISPLAY   *P64:24,"prihdbtf";
          OPEN      PRIHDBT2,"prihdbtf"          * holding header file
.
          DISPLAY   *P64:24,"priholdf";
          OPEN      PRIHOLA1,"priholdf"          * account hold file
.
          DISPLAY   *P64:24,"prihreff";
          OPEN      PRIHREF1,"prihreff"
          OPEN      PRIHREF2,"prihreff"          * holding referral file
.
          DISPLAY   *P64:24,"prihtraf";
          OPEN      PRIHTRA1,"prihtraf"          * holding transaction file
          OPEN      PRIHTRA2,"prihtraf"
          OPEN      PRIHTRA4,"prihtraf"                               *I-123419
.
          DISPLAY   *P64:24,"pmshclaf";
          OPEN      PMSHCLA1,"pmshclaf"
.
          DISPLAY   *P64:24,"pridoctf";
          OPEN      PRIDOCT1,"pridoctf"          * practice doctor file
.
          DISPLAY   *P64:24,"pritestf";
          OPEN      PRITEST1,"pritestf"          * test file
.
          DISPLAY   *P64:24,"prithisf";
          OPEN      PRITHIS1,"prithisf"          * test history file
.
          DISPLAY   *P64:24,"primgpaf";
          OPEN      PRIMGPA1,"primgpaf"          * medicare gap file
.
          DISPLAY   *P64:24,"primultf";
          OPEN      PRIMULT1,"primultf"          * multiple codes file
.
          DISPLAY   *P64:24,"pripracf";
          OPEN      PRIPRAC1,"pripracf"
.
          DISPLAY   *P64:24,"prigrpaf";
          OPEN      PRIGRPA1,"prigrpaf"          * group file
.
          OPEN      PRIALSA1,"prialsaf"
          OPEN      PRISECA1,"prisecaf"
.
          DISPLAY   *P64:24,"priitemf";
          OPEN      PRIITEM1,"priitemf"          * item file
.
          DISPLAY   *P64:24,"comdepaf";
          OPEN      COMDEPA4,"comdepaf"
          OPEN      COMDEPA6,"comdepaf"
.
          DISPLAY   *P64:24,"rcpdteaf";
          OPEN      RCPDTEA1,"rcpdteaf"
.
          DISPLAY   *P64:24,"rcpregaf";
          OPEN      RCPREGA1,"rcpregaf"
.
          DISPLAY   *P64:24,"patma1af";
          OPEN      PATMA1A1,"patma1af"                     * patient master file
          OPEN      PATMX1A1,"patmx1af"                     * patient master file
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"          * codes file
.
          DISPLAY   *P64:24,"controlf";
          OPEN      CONTROLF,"controlf"          * control file
          READ      CONTROLF,ZERO;*85,IBCNUGST
          READ      CONTROLF,TEN;*79,CAPPRVNO
          READ      CONTROLF,THIRTY3;*200,PRCNRDOC
          READ      CONTROLF,THIRTY4;*226,PRCNNRND
          READ      CONTROLF,HUND24;*111,PTCNUIMC
          READ      CONTROLF,HUND29;*61,PTCNWSIN,*73,PTCNIMCW
          READ      CONTROLF,HUND30;*1,PTCNHABN
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,TEMPFILE
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAME2
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,FNAME3
.
          MOVE      TWO,PACFRMT
.
INIT9999  RETURN
+
.****************************************************************************
.*                                OPTN0000             Called by: ML0000    *
.*                        get user options or exit                          *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Valid option selected                  *
.*                        TRUE  (1)  Exit option selected                   *
.*              COPTION = 1  Invoices pending                               *
.****************************************************************************
.
OPTN0000  DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = Patient Surname Sequence":
                    *P1:6,*V2LON,TWO,*HOFF," = Debtor Number Sequence": 
                    *P1:7,*V2LON,THREE,*HOFF," = Medical Practice Sequence" 
.
OPTN1000  KEYIN     *P1:9,*EL,"Select option : ",*DV,UNDLN1:
                    *P17:9,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION
          GOTO      OPTN9500 IF EQUAL            * exit
.
          COMPARE   FOUR,COPTION
          GOTO      OPTN9000 IF LESS
.
          BEEP
          GOTO      OPTN1000
.
OPTN9000  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.**************************************************************************
.*                               SPRA0000              Called by: ML0000  *
.*                       input medical practice code                      *
.* Returns:          EXIT  0 = valid code input                           *
.*                         1 = exitchar input                             *
.**************************************************************************
SPRA0000  KEYIN     *P1:11,*EF,"From Medical Practice : ",*DV,UNDLN6:
                    *P25:11,*V2LON,MPRAC,*P25:11,*DV,MPRAC;
.
          CALL      CHKP0000                     * see what was entered
          BRANCH    EXIT,SPRA5000:               * nothing entered
                         SPRA4000:               * ? entered
                         SPRA9500:               * exitchar input
                         SPRA8000                * valid input
          GOTO      SPRA0000                     * invalid input
.
SPRA4000  MOVE      ZERO,HLEF
          CALL      GETSCR00                     * save screen
.
SPRA4200  CALL      PRIPRADS                     * list codes on file
.
SPRA4500  KEYIN     *P1:24,*EL,"From Medical Practice : ",*DV,UNDLN6:
                    *P25:24,*V2LON,MPRAC,*P25:24,*DV,MPRAC;
.
          CALL      CHKP0000                     * see what was entered
          BRANCH    EXIT,SPRA4900:               * nothing entered
                         SPRA4200:               * ? entered
                         SPRA9400:               * exitchar input
                         SPRA7900                * valid input
          GOTO      SPRA4500                     * invalid input
.
SPRA4900  CALL      PUTSCR00                     * restore screen
SPRA5000  MOVE      SP6,SPRAC
          DISPLAY   *P25:11,*V2LON,START;
          MOVE      START,SMPDESC         * save description
          GOTO      SPRA8500
.
SPRA7900  CALL      PUTSCR00                     * restore screen
          DISPLAY   *P25:11,*V2LON,MPRAC;
.
SPRA8000  MOVE      MPRAC,SPRAC
          DISPLAY   *P35:11,PRPRDESC;
          MOVE      MPRAC,SMPDESC         * save description
.
SPRA8500  MOVE      ZERO,EXIT
          GOTO      SPRA9999
.
SPRA9400  CALL      FRESCR00
SPRA9500  MOVE      ONE,EXIT
.
SPRA9999  RETURN
+
.**************************************************************************
.*                               EPRA0000              Called by: ML0000  *
.*                       input medical practice code                      *
.* Returns:          EXIT  0 = valid code input                           *
.*                         1 = exitchar input                             *
.**************************************************************************
EPRA0000  KEYIN     *P1:12,*EF,"To   Medical Practice : ",*DV,UNDLN6:
                    *P25:12,*V2LON,MPRAC,*P25:12,*DV,MPRAC;
.
          CALL      CHKP0000                     * see what was entered
          BRANCH    EXIT,EPRA5000:               * nothing entered
                         EPRA4000:               * ? entered
                         EPRA9500:               * exitchar input
                         EPRA3000                * valid input
          GOTO      EPRA0000                     * invalid input
.
EPRA3000  MATCH     SPRAC,MPRAC                  * end prac < start prac ?
          GOTO      EPRA8000 IF NOT LESS         * no
.
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "To Practice must be greater than or = From Practice.    ";
          CALL      HITENTER
          GOTO      EPRA0000
.
EPRA4000  MOVE      ZERO,HLEF
          CALL      GETSCR00                     * save screen
.
EPRA4200  CALL      PRIPRADS                     * list codes on file
.
EPRA4500  KEYIN     *P1:24,*EL,"To   Medical Practice : ",*DV,UNDLN6:
                    *P25:24,*V2LON,MPRAC,*P25:24,*DV,MPRAC;
.
          CALL      CHKP0000                     * see what was entered
          BRANCH    EXIT,EPRA4900:               * nothing entered
                         EPRA4200:               * ? entered
                         EPRA9400:               * exitchar input
                         EPRA6000                * valid input
          GOTO      EPRA4500                     * invalid input
.
EPRA4900  CALL      PUTSCR00                     * restore screen
EPRA5000  MOVE      ZED6,EPRAC
          DISPLAY   *P25:12,*V2LON,FINISH;
          MOVE      FINISH,EMPDESC         * save description
          GOTO      EPRA8500
.
EPRA6000  MATCH     SPRAC,MPRAC                  * end prac < start prac ?
          GOTO      EPRA7900 IF NOT LESS         * no
.
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "To Practice must be greater than or = From Practice.    ";
          CALL      HITENTER
          GOTO      EPRA4500
.
EPRA7900  CALL      PUTSCR00                     * restore screen
          DISPLAY   *P25:12,*V2LON,MPRAC;
.
EPRA8000  MOVE      MPRAC,EPRAC
          DISPLAY   *P35:12,PRPRDESC;
          MOVE      MPRAC,EMPDESC         * save description
.
EPRA8500  MOVE      ZERO,EXIT
          GOTO      EPRA9999
.
EPRA9400  CALL      FRESCR00
EPRA9500  MOVE      ONE,EXIT
.
EPRA9999  RETURN
+
.**************************************************************************
.*                             CHKP0000                Called by: SPRA0000*
.*             see what was input for medical practice            EPRA0000*
.* Returns:           EXIT   0 = invalid input                            *
.*                           1 = nothing input                            *
.*                           2 = ? input                                  *
.*                           3 = exitchar input                           *
.*                           4 = valid input                              *
.**************************************************************************
CHKP0000  ENDSET     MPRAC
          APPEND     SP6,MPRAC
          RESET      MPRAC
.
          MATCH      SP6,MPRAC                    * anything entered ?
          GOTO       CHKP8000 IF EQUAL             * yes
.
          CMATCH     EXITCHAR,MPRAC               * exitchar input ?
          GOTO       CHKP9000 IF EQUAL             * yes
.
          CMATCH     QUEST,MPRAC                  * "?" input ?
          GOTO       CHKP8500 IF EQUAL             * yes
.
          MOVE       MPRAC,KEY6
          CALL       RDPRPR1
          COMPARE    ZERO,OVRCD                   * record on file ?
          GOTO       CHKP9500 IF EQUAL             * yes
.
          DISPLAY    *P1:24,*EL,*B,*V2LON,"Medical Practice not on file.    ";
          CALL       HITENTER
          MOVE       ZERO,EXIT
          GOTO       CHKP9999
.
CHKP8000  MOVE       ONE,EXIT
          GOTO       CHKP9999
.
CHKP8500  MOVE       TWO,EXIT
          GOTO       CHKP9999
.
CHKP9000  MOVE       THREE,EXIT
          GOTO       CHKP9999
.
CHKP9500  MOVE       FOUR,EXIT
.
CHKP9999  RETURN
+
.****************************************************************************
.*                               SPAG0000              Called by: ML0000    *
.*                see if separate pages for each M.P.                       *
.****************************************************************************
SPAG0000  COMPARE   THREE,COPTION
          GOTO      SPAG1500 IF NOT EQUAL
          MATCH     SPRAC,EPRAC                  * same medical practice ?
          GOTO      SPAG1500 IF EQUAL            * yes - bypass question
.
          KEYIN     *P1:14,*EL,"Separate pages for each Medical Practice (":
                    *V2LON,*DV,ANSY,*HOFF,*DV,SLASH,*V2LON,*DV,ANSN,*HOFF:
                    ") ? ",*DV,ANSN,*P50:14,*V2LON,ANS;
          ENDSET    ANS
          APPEND    SP1,ANS
          RESET     ANS
.
          MATCH     SP1,ANS                      * anything entered ?
          GOTO      SPAG1000 IF EQUAL            * no
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS                     * N entered ?
          GOTO      SPAG1000 IF EQUAL            * yes
          MATCH     ANSY,ANS                     * Y entered ?
          GOTO      SPAG2000 IF EQUAL            * yes
          BEEP
          GOTO      SPAG0000                     * invalid
.
SPAG1000  DISPLAY   *P50:14,*V2LON,NO;
SPAG1500  MOVE      ZERO,SEPFLAG
          GOTO      SPAG9999
.
SPAG2000  DISPLAY   *P50:14,*V2LON,YES;
          MOVE      ONE,SEPFLAG
.
SPAG9999  RETURN
+
.****************************************************************************
.         Keyin user id
.****************************************************************************
USID0000  KEYIN     *P1:17,*EL,"User Id : ",USERID;
          PACK      USERID,USERID,SP70
          MATCH     SP70,USERID
          GOTO      USID0000 IF EQUAL
USID9999  RETURN
+
.****************************************************************************
.*                               LOAD0000              Called by: ML0000    *
.*       Load the temp file with the relevant unique identifiers            *
.*       for the debtors that have pending invoices                         *
.****************************************************************************
.
LOAD0000  DISPLAY   *P1:24,*EL,"Loading debtors: ";
          PACK      KEY28,ONE,SP30
          CALL      RSPRHR2                      * position on referral holding
.                                                  file
.         read through referral holding file
.
LOAD0100  CALL      RKPRHR2                      * read next record
          BRANCH    OVRCD,LOAD9999               * end of file
.
          COMPARE   ONE,PRHRPINV                 * finished if no more invoices
          GOTO      LOAD9999 IF NOT EQUAL          to print
.
.         Check if in medical practice range
.
          MATCH     SPRAC,PRHRPRAC          * practice >= start practice ?
          GOTO      LOAD0100 IF LESS        * no - ignore
.
          MATCH     PRHRPRAC,EPRAC          * practice <= end practice ?
          GOTO      LOAD0100 IF LESS        * no - ignore
.
.         check the medical practice user access
.
          PACK      KEY10,USERID,SP70
          CALL      RDPRALS1
          COMPARE   ZERO,OVRCD
          GOTO      LOAD0110 IF EQUAL       * User has access to all Med.Prac.
.
          PACK      KEY16,PRHRPRAC,USERID,SP70
          CALL      RDPRSEC1
          BRANCH    OVRCD,LOAD0100          * no access
.
LOAD0110  MOVE      PRHRUNIQ,KEY8
          CALL      RDPRHD2                      * read header file
          BRANCH    OVRCD,LOAD0100
.
          MATCH     SP3,PRHRPIND                 * patient indicator exist ?
          GOTO      LOAD0100 IF EQUAL            * no
.
          PACK      KEY5,CODEGI,PRHRPIND  
          CALL      RDCODE1                      * read patient codes file
          BRANCH    OVRCD,LOAD0100
.
.         set up the variables for the temp file
.
LOAD0150  MOVE      PRHDDEBT,TEMPDEB
          MOVE      PRHDSCAN,TEMPSCN
          MOVE      PRHRPRAC,TEMPPRAC
.
          PACK      TEMPSUR,SP30
          PACK      TEMPGIV,SP30
          MOVE      "Unknown debtor",TEMPSUR 
.         COMPARE   ZERO,TEMPSCN                 * debtor ?
.         IF        !@EQUAL
..        IF        @EQUAL
..           MOVE      TEMPDEB,KEY8              * yes
..           CALL      RDPRDB1                   * read debtor record
..           BRANCH    OVRCD,LOAD0200            * not found
..           PACK      TEMPSUR,PRDBSNAM,SP20     * format debtor name
..           PACK      TEMPGIV,PRDBGNAM,SP20     * format debtor name
..        ELSE
             MOVE      TEMPDEB,PURNO
             MOVE      PURNO,KEY8
             CALL      RDMAST1                   * read PMI record
             BRANCH    OVRCD,LOAD0200            * not found
             PACK      TEMPSUR,PSNAME,SP20       * format PMI name
             PACK      TEMPGIV,PGNAME,SP20       * format PMI name
.         ENDIF
.
LOAD0200  MOVE      PRHDUNIQ,KEY8
          CALL      RATEMP1                      * position on the temp file
          BRANCH    OVRCD,LOAD0900               * not on file
.
          GOTO      LOAD0100                     * get next record
.
.         write to the temp file
.
LOAD0900  DISPLAY   *P18:24,*EL,*V2LON,TEMPDEB;
          CALL      WRTEMP1
.
          GOTO      LOAD0100                     * get next record
.
LOAD9999  RETURN
+
.****************************************************************************
.*                               PROC0000              Called by: ML0000    *
.*                  process the records for printing                        *
.****************************************************************************
.
PROC0000  DISPLAY   *P1:24,*EL,"Processing: ";
          MOVE      ZERO,CPAGENO
          MOVE      ONE,CNOUNDLN
          MOVE      ZERO,CLNO
          MOVE      ZERO,TOTINVAT
          MOVE      SP70,PAGEPRAC
          MOVE      ZERO,AMNTPRAC
          MOVE      ONE,INVPFLAG
.
          CALL      IBACLOCK
          CALL      HEAD0000
          CALL      CLRTF000                     * clear the temp file
          MOVE      ONE,NOTRANFG            * Set no transaction flag
.
          BRANCH    COPTION,PROC0500,PROC0450,PROC0550
.
.         By Debtor Number
.
PROC0450  MOVE      SP20,KEY18
          CALL      RSTEMP2                      * position at start of file
          CALL      RKTEMP2                      * read first record
          BRANCH    OVRCD,PROC9999               * no records on file
          GOTO      PROC0600
.
.         By Patient Surname
.
PROC0500  PACK      KEY58,SP70
          CALL      RSTEMP3                      * position at start of file
          CALL      RKTEMP3                      * read first record
          BRANCH    OVRCD,PROC9999               * no records on file
          GOTO      PROC0600
.
.         By Medical practice 
.
PROC0550  PACK      KEY24,SP70
          CALL      RSTEMP4                      * position at start of file
          CALL      RKTEMP4                      * read first record
          BRANCH    OVRCD,PROC9999               * no records on file
          GOTO      PROC0600
.
PROC0600  MOVE      TEMPDEB,SAVDEBT              * save first debtor number
          MOVE      TEMPSCN,SAVSCAN              * save scan flag also
.
PROC1000  DISPLAY   *P13:24,*EL,*V2LON,TEMPDEB;
.
          MOVE      TEMPDEB,VDEBTOR
          MOVE      TEMPSCN,VSCANPMI
.
          CALL      PRIINVLD                     * load the data into the temp
.                                                  file for this debtor number
PROC2000  BRANCH    COPTION,PROC2500,PROC2450,PROC2550
.
.         By Debtor Number
.
PROC2450  CALL      RKTEMP2                      * read next record
          BRANCH    OVRCD,PROC9000               * no more records
          GOTO      PROC2600
.
.         By Debtor Surname
.
PROC2500  CALL      RKTEMP3                      * read next record
          BRANCH    OVRCD,PROC9000               * no more records
          GOTO      PROC2600
.
.         By Medical Practice
.
PROC2550  CALL      RKTEMP4                      * read next record
          BRANCH    OVRCD,PROC9000               * no more records
          GOTO      PROC2600
.
PROC2600  MATCH     TEMPDEB,SAVDEBT              * same debtor still ?
          GOTO      PROC3000 IF NOT EQUAL        * no
.
          COMPARE   TEMPSCN,SAVSCAN              * same scan flag ?
          GOTO      PROC3000 IF NOT EQUAL        * no
.
          GOTO      PROC1000                     * same debtor
.
.         Print previous debtor's transactions
.
PROC3000  CALL      PPTMP000                     * process the path. temp file
          CALL      PRIN0000                     * print a debtor's records
          CALL      CLRTF000                     * clear the temp file
.
          MOVE      TEMPDEB,SAVDEBT              * save new debtor number
          MOVE      TEMPSCN,SAVSCAN              * save scan flag also
          GOTO      PROC1000
.
PROC9000  CALL      PPTMP000                     * process last debtor
          CALL      PRIN0000
          IF        COPTION=3
            PRINT     *1,PIPE,*80," Invoice Pending Total For ",PAGEPRAC:
                      *120,AMNTPRAC,*132,PIPE
            ADD       ONE,CLNO
            CALL      LINE0000
          ENDIF
.
          IF        TOTINVAT<>0
            PRINT     *1,PIPE,*96,"INVOICE PENDING TOTAL",*120,TOTINVAT:
                      *132,PIPE
            ADD       ONE,CLNO
            CALL      LINE0000
            MOVE      ZERO,NOTRANFG           * Reset no transaction flag
          ENDIF
PROC9999  RETURN
+
.******************************************************************************
.*                                  PDEP0000              Called by: ML0000   *
.*                               Print Deposits                               *
.******************************************************************************
PDEP0000  MOVE      ZERO,TOTDEPAT           * Reset total deposit amount
          MOVE      ZERO,SUBTOTAL           * Reset debtor subtotal
          MOVE      SP8,SAVDEBT
          MOVE      THREE,SAVSCAN
          MOVE      SP6,SAVPRAC
          MOVE      SP6,PAGEPRAC
          MOVE      ZERO,AMNTPRAC
          MOVE      ZERO,INVPFLAG
.
          MOVE      "0",CMDESTAT            * Deposit held
          PACK      KEY33,CMDESTAT,SP70      
          CALL      RSCMDEP4                * Position on & read the PP deposit
          CALL      RKCMDEP4                * file
          BRANCH    OVRCD,PDEP9500
          MATCH     "0",CMDESTAT
          GOTO      PDEP9500 IF NOT EQUAL
.
          IF        CLNO>=46
            CALL      LINE0000              * Print an underline
            CALL      HEAD0000              * Print the report header
            GOTO      PDEP0100
          ENDIF
.
          IF        TOTINVAT<>0
            IF        SEPFLAG=1
              CALL      HEAD0000
            ELSE
              PRINT     *N
              CALL      SHED0000            * Print the subheading
              ADD       FIVE,CLNO                     * increment line count
            ENDIF
          ENDIF
.
PDEP0100  COMPARE   THREE,COPTION
          GOTO      PDEP0900 IF NOT EQUAL
. 
.         Print by Medical Practice 
.
PDEP0500  MOVE      "0",CMDESTAT            * Deposit held
          PACK      KEY33,CMDESTAT,SP70
          CALL      RSCMDEP6                * Position on & read the PP deposit
PDEP0600  CALL      RKCMDEP6                * file
          BRANCH    OVRCD,PDEP9000
          MATCH     "0",CMDESTAT
          GOTO      PDEP9000 IF NOT EQUAL
          GOTO      PDEP1050
.
.         Print by Debtor Number
.
PDEP0900  MOVE      "0",CMDESTAT            * Deposit held
          PACK      KEY33,CMDESTAT,SP70
          CALL      RSCMDEP4                * Position on & read the PP deposit
PDEP1000  CALL      RKCMDEP4                * file
          BRANCH    OVRCD,PDEP9000
          MATCH     "0",CMDESTAT
          GOTO      PDEP9000 IF NOT EQUAL
.
.         Check if in medical practice range
.         
PDEP1050  MATCH     SPRAC,CMDEPRAC          * practice >= start practice ?
          GOTO      PDEP8900 IF LESS
.         
          MATCH     CMDEPRAC,EPRAC          * practice <= end practice ?
          GOTO      PDEP8900 IF LESS
.
.         check the medical practice user access
.
          PACK      KEY10,USERID,SP70
          CALL      RDPRALS1
          COMPARE   ZERO,OVRCD
          GOTO      PDEP1080 IF EQUAL       * User has access to all Med.Prac.
.
          PACK      KEY16,CMDEPRAC,USERID,SP70
          CALL      RDPRSEC1
          BRANCH    OVRCD,PDEP8900          * no access
.
PDEP1080  MOVE      ZERO,RCDTAMNT
          PACK      KEY17,CMDERECN,CMDETCNT
          CALL      RDRCDTE1
          BRANCH    OVRCD,PDEP8900
.
          PACK      KEY3,RCDTREGI
          CALL      RDREGA1
          BRANCH    OVRCD,PDEP8900
.
          COMPARE   NINTY6,REGIBACD        * Private Practice Deposit 
          GOTO      PDEP8900 IF NOT EQUAL
.
PDEP1100  MATCH     SAVDEBT,CMDEURNO
          GOTO      PDEP2000 IF NOT EQUAL   * Different debtor number
.
.         MOVE      CMDESFLG,FORM1
.         MOVE      FORM1,FORM2
.         COMPARE   SAVSCAN,FORM2
.         GOTO      PDEP2000 IF NOT EQUAL   * Different scanflag
.
          GOTO      PDEP3000
.
. ----- Get the patient details -----
.
PDEP2000  MOVE      SP1,ANS
          MOVE      CMDESFLG,FORM1
          LOAD      ANS,FORM1,ANSP
          PACK      FMTDEBT,ANS,CMDEURNO    * Set the printed debtor number
.
          MOVE      "Unknown debtor",FMTNAME
.         MATCH     "1",CMDESFLG
.         IF        @EQUAL
            MOVE      CMDEURNO,KEY8
            CALL      RDMAST1               * Read the master file
            IF        OVRCD<>1
              MOVE      PSNAME,PACSNAME
              MOVE      PGNAME,PACGNAME
              MOVE      PTITL,PACTITLE
              MOVE      TWO,PACFRMT
              CALL      PACNAME             * Format the patient name
              MOVE      PACFNAME,FMTNAME    * Set the printed debtor name
            ENDIF
..        ELSE
..          PACK      KEY8,CMDEURNO
..          CALL      RDPRDB1               * Read the PP debtor file
..          IF        OVRCD<>1
..            MOVE      PRDBSNAM,PACSNAME
..            MOVE      PRDBGNAM,PACGNAME
..            MOVE      PRDBTITL,PACTITLE
..            CALL      PACNAME             * Format the patient name
..            MOVE      PACFNAME,FMTNAME    * Set the printed debtor name
..          ENDIF
.         ENDIF
          IF        SUBTOTAL<>0
            PRINT     *120,SUBTOTAL,*132,PIPE
            CALL      LINE0000              * Print an underline
          ENDIF
          MOVE      CMDEURNO,SAVDEBT
          MOVE      ZERO,FORM1
          MOVE      CMDESFLG,FORM1
          MOVE      FORM1,SAVSCAN
          MOVE      SP6,SAVPRAC
          MOVE      ZERO,SUBTOTAL           * Reset debtor subtotal
.
PDEP3000  IF        SUBTOTAL<>0
            PRINT     *132,PIPE
          ENDIF
.
          COMPARE   THREE,COPTION
          GOTO      PDEP8000 IF NOT EQUAL
.
.         Print Medical Practice per Separate Page
.
          MATCH     SP70,PAGEPRAC           * First deposit record
          IF        @EQUAL
            MOVE      CMDEPRAC,PAGEPRAC
            MOVE      RCDTAMNT,AMNTPRAC
            GOTO      PDEP8100
          ENDIF
.
          MATCH     CMDEPRAC,PAGEPRAC       * Same Medical Practice
          IF        @EQUAL
            ADD       RCDTAMNT,AMNTPRAC
            GOTO      PDEP8000
          ENDIF  
.
.         Different Medical Practice
.
          PRINT     *1,PIPE,*80," Deposits Pending Total For ",PAGEPRAC:
                    *120,AMNTPRAC,*132,PIPE
          ADD       ONE,CLNO
          CALL      LINE0000
          MOVE      RCDTAMNT,AMNTPRAC
          MOVE      CMDEPRAC,PAGEPRAC
          IF        SEPFLAG=1
            CALL      HEAD0000
          ELSE
            IF        CLNO>=46
              GOTO      PDEP8000
            ENDIF
            PRINT     *N
            CALL      SHED0000
            ADD       FIVE,CLNO                     * increment line count
          ENDIF
          GOTO      PDEP8100
.
PDEP8000  IF        CLNO>=46
            CALL      HEAD0000              * Print the report header
          ENDIF
.
PDEP8100  MATCH     SAVPRAC,CMDEPRAC
          IF        !@EQUAL
            MOVE      CMDEPRAC,FMTPRAC      * Set the printed medical practice
            MOVE      CMDEPRAC,SAVPRAC
          ENDIF
.
          UNPACK    CMDETDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * Format the deposit date
          REP       " 0",CPCDATE
          MOVE      FMTNAME,DIM25
          MOVE      RCDTAMNT,DISPAMNT
          PRINT     *1,PIPE,*2,FMTDEBT,*12,PIPE,*14,DIM25,*40,PIPE,*45,PIPE:
                    *47,FMTPRAC,*54,PIPE,*55,CPCDATE,*65,PIPE,*67,"DEPOSIT":
                    *84,PIPE,*90,PIPE,*104,PIPE,*106,DISPAMNT,*118,PIPE;
          DISPLAY   *P13:24,*EL,*V2LON,CMDEURNO;
          ADD       ONE,CLNO
          ADD       RCDTAMNT,SUBTOTAL       * Increment debtor subtotal
          ADD       RCDTAMNT,TOTDEPAT       * Increment total deposit amount
          MOVE      SP10,FMTDEBT            * Reset the printed debtor number
          MOVE      SP30,FMTNAME            * Reset the printed debtor name
          MOVE      SP6,FMTPRAC             * Reset the printed medical prac
.
PDEP8900  COMPARE   THREE,COPTION
          GOTO      PDEP0600 IF EQUAL
          GOTO      PDEP1000
.
PDEP9000  PRINT     *120,SUBTOTAL,*132,PIPE
          CALL      LINE0000                * Print an underline
          IF        COPTION=3
            PRINT     *1,PIPE,*80," Deposits Pending Total For ",PAGEPRAC:
                      *120,AMNTPRAC,*132,PIPE
            ADD       ONE,CLNO
            CALL      LINE0000
          ENDIF
          PRINT     *1,PIPE,*95,"DEPOSITS PENDING TOTAL",*120,TOTDEPAT:
                    *132,PIPE
          ADD       ONE,CLNO
          CALL      LINE0000                * Print an underline
          GOTO      PDEP9999
.
PDEP9500  IF        NOTRANFG=1
            DISPLAY   *P1:24,*EL,*B,"No transactions found.  ";
            CALL      HITENTER
          ENDIF
PDEP9999  RETURN
+
.******************************************************************************
.*                                  SLOD0000              Called by: ML0000   *
.*                               Load Deposit Details                         *
.******************************************************************************
SLOD0000  MOVE      "0",CMDESTAT            * Deposit held
          PACK      KEY33,CMDESTAT,SP70
          MOVE      SP8,SAVDEBT
          MOVE      THREE,SAVSCAN
          MOVE      SP6,SAVPRAC
          CALL      RSCMDEP4                * Position on & read the PP deposit
SLOD1000  CALL      RKCMDEP4                  file
          BRANCH    OVRCD,SLOD9999
          MATCH     "0",CMDESTAT
          GOTO      SLOD9999 IF NOT EQUAL
.
.         Check if in medical practice range
.         
          MATCH     SPRAC,CMDEPRAC          * practice >= start practice ?
          GOTO      SLOD1000 IF LESS        * no - ignore
.         
          MATCH     CMDEPRAC,EPRAC          * practice <= end practice ?
          GOTO      SLOD1000 IF LESS        * no - ignore
.
.         check the medical practice user access
.
          PACK      KEY10,USERID,SP70
          CALL      RDPRALS1
          COMPARE   ZERO,OVRCD
          GOTO      SLOD1020 IF EQUAL       * User has access to all Med.Prac.
.
          PACK      KEY16,CMDEPRAC,USERID,SP70
          CALL      RDPRSEC1
          BRANCH    OVRCD,SLOD1000          * no access
.
SLOD1020  MOVE      ZERO,RCDTAMNT
          PACK      KEY17,CMDERECN,CMDETCNT
          CALL      RDRCDTE1
          BRANCH    OVRCD,SLOD1000
.
          PACK      KEY3,RCDTREGI
          CALL      RDREGA1
          BRANCH    OVRCD,SLOD1000
.
          COMPARE   NINTY6,REGIBACD        * Private Practice Deposit
          GOTO      SLOD1000 IF NOT EQUAL
.
SLOD1100  PACK      TEMPSUR,SP30
          PACK      TEMPGIV,SP30
          MOVE      "Unknown debtor",TEMPSUR  
.         MATCH     "1",CMDESFLG
.         IF        @EQUAL
            MOVE      CMDEURNO,KEY8  
            CALL      RDMAST1               * Read the master file
            IF        OVRCD<>1
              PACK      TEMPSUR,PSNAME,SP20     
              PACK      TEMPGIV,PGNAME,SP20     
            ENDIF
..        ELSE
..          PACK      KEY8,CMDEURNO
..          CALL      RDPRDB1               * Read the PP debtor file
..          IF        OVRCD<>1
..            PACK      TEMPSUR,PRDBSNAM,SP20    
..            PACK      TEMPGIV,PRDBGNAM,SP20    
..          ENDIF
.         ENDIF
          MOVE      CMDEURNO,KEY8      
          MOVE      CMDEURNO,TEMPDEB
          MOVE      ZERO,FORM1
          MOVE      CMDESFLG,FORM1
          MOVE      FORM1,TEMPSCN
          CALL      RATEMP1                      * position on the temp file
          BRANCH    OVRCD,SLOD9000               * not on file
.
          GOTO      SLOD1000                     * get next record
.
.         write to the temp file
.
SLOD9000  DISPLAY   *P18:24,*EL,*V2LON,TEMPDEB;
          CALL      WRTEMP1
          GOTO      SLOD1000
.
SLOD9999  RETURN
.******************************************************************************
.*                                  SDEP0000              Called by: ML0000   *
.*                               Print Deposits - Surname Seq                 *
.******************************************************************************
SDEP0000  MOVE      ZERO,TOTDEPAT           * Reset total deposit amount
          MOVE      ZERO,SUBTOTAL           * Reset debtor subtotal
          PACK      KEY47,SP30
          MOVE      SP6,SAVPRAC
          MOVE	    ZERO,INVPFLAG
.
          PACK      KEY58,SP70
          CALL      RSTEMP3                      * position at start of file
          CALL      RKTEMP3                      * read first record
          BRANCH    OVRCD,SDEP9500               * no records on file
.
          IF        CLNO>=46
            CALL      LINE0000              * Print an underline
            CALL      HEAD0000              * Print the report header
          ELSE
            IF        TOTINVAT<>0
              PRINT     *N
              CALL      SHED0000            * Print the subheading
              ADD       FIVE,CLNO                     * increment line count
            ENDIF
          ENDIF
.
          PACK      KEY58,SP70
          CALL      RSTEMP3                      * position at start of file
SDEP0500  CALL      RKTEMP3                      * read first record
          BRANCH    OVRCD,SDEP9000               * no records on file
.
          MOVE      SP1,ANS
          MOVE      TEMPSCN,FORM2
          LOAD      ANS,FORM2,ANSP
          PACK      FMTDEBT,ANS,TEMPDEB     * Set the printed debtor number
.
. ----- Get the patient details -----
.
          MOVE      "Unknown debtor",FMTNAME
.         IF        TEMPSCN=1
            MOVE      TEMPDEB,KEY8 
            CALL      RDMAST1               * Read the master file
            IF        OVRCD<>1
              MOVE      PSNAME,PACSNAME
              MOVE      PGNAME,PACGNAME
              MOVE      PTITL,PACTITLE
              MOVE      TWO,PACFRMT
              CALL      PACNAME             * Format the patient name
              MOVE      PACFNAME,FMTNAME    * Set the printed debtor name
            ENDIF
..        ELSE
..          PACK      KEY8,TEMPDEB 
..          CALL      RDPRDB1               * Read the PP debtor file
..          IF        OVRCD<>1
..            MOVE      PRDBSNAM,PACSNAME
..            MOVE      PRDBGNAM,PACGNAME
..            MOVE      PRDBTITL,PACTITLE
..            CALL      PACNAME             * Format the patient name
..            MOVE      PACFNAME,FMTNAME    * Set the printed debtor name
..          ENDIF
.         ENDIF
.
          IF        SUBTOTAL<>0
            PRINT     *120,SUBTOTAL,*132,PIPE
            CALL      LINE0000              * Print an underline
          ENDIF
.
          MOVE      ZERO,FORM1
          MOVE      CMDESFLG,FORM1
          MOVE      SP6,SAVPRAC
          MOVE      ZERO,SUBTOTAL           * Reset debtor subtotal
.
          MOVE      TEMPSCN,FORM1
          MOVE      FORM1,CMDESFLG
          MOVE      "0",CMDESTAT            * Deposit held
          PACK      KEY33,CMDESTAT,TEMPDEB,SP30
          CALL      RSCMDEP4                * Position on & read the PP deposit
SDEP1000  CALL      RKCMDEP4                  file
          BRANCH    OVRCD,SDEP0500
.
          MATCH     "0",CMDESTAT            * Deposit held?
          GOTO      SDEP0500 IF NOT EQUAL
          MATCH     TEMPDEB,CMDEURNO
          GOTO      SDEP0500 IF NOT EQUAL
.
.         Check if in medical practice range
.
          MATCH     SPRAC,CMDEPRAC          * practice >= start practice ?
          GOTO      SDEP0500 IF LESS        * no - ignore
.
          MATCH     CMDEPRAC,EPRAC          * practice <= end practice ?
          GOTO      SDEP0500 IF LESS        * no - ignore
.
.         check the medical practice user access
.
          PACK      KEY10,USERID,SP70
          CALL      RDPRALS1
          COMPARE   ZERO,OVRCD
          GOTO      SDEP2000 IF EQUAL       * User has access to all Med.Prac.
.
          PACK      KEY16,CMDEPRAC,USERID,SP70
          CALL      RDPRSEC1
          BRANCH    OVRCD,SDEP0500          * no access
.
SDEP2000  MOVE      ZERO,RCDTAMNT
          PACK      KEY17,CMDERECN,CMDETCNT
          CALL      RDRCDTE1
          BRANCH    OVRCD,SDEP1000
.
          PACK      KEY3,RCDTREGI
          CALL      RDREGA1
          BRANCH    OVRCD,SDEP1000
.
          COMPARE   NINTY6,REGIBACD        * Private Practice Deposit
          GOTO      SDEP1000 IF NOT EQUAL
.
SDEP3000  IF        SUBTOTAL<>0
            PRINT     *132,PIPE
          ENDIF
.
          IF        CLNO>=46
            CALL      HEAD0000              * Print the report header
          ENDIF
.
          MATCH     SAVPRAC,CMDEPRAC
          IF        !@EQUAL
            MOVE      CMDEPRAC,FMTPRAC      * Set the printed medical practice
            MOVE      CMDEPRAC,SAVPRAC
          ENDIF
.
          UNPACK    CMDETDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * Format the deposit date
          REP       " 0",CPCDATE
          MOVE      FMTNAME,DIM25
          MOVE      RCDTAMNT,DISPAMNT
          PRINT     *1,PIPE,*2,FMTDEBT,*12,PIPE,*14,DIM25,*40,PIPE,*45,PIPE:
                    *47,FMTPRAC,*54,PIPE,*55,CPCDATE,*65,PIPE,*67,"DEPOSIT":
                    *84,PIPE,*90,PIPE,*104,PIPE,*106,DISPAMNT,*118,PIPE;
          DISPLAY   *P13:24,*EL,*V2LON,CMDEURNO;
          ADD       ONE,CLNO
          ADD       RCDTAMNT,SUBTOTAL       * Increment debtor subtotal
          ADD       RCDTAMNT,TOTDEPAT       * Increment total deposit amount
          MOVE      SP10,FMTDEBT            * Reset the printed debtor number
          MOVE      SP30,FMTNAME            * Reset the printed debtor name
          MOVE      SP6,FMTPRAC             * Reset the printed medical prac
          GOTO      SDEP1000
.
SDEP9000  PRINT     *120,SUBTOTAL,*132,PIPE
          CALL      LINE0000                * Print an underline
          PRINT     *1,PIPE,*95,"DEPOSITS PENDING TOTAL",*120,TOTDEPAT:
                    *132,PIPE 
          ADD       ONE,CLNO
          CALL      LINE0000                * Print an underline
          GOTO      SDEP9999
.
SDEP9500  IF        NOTRANFG=1
            DISPLAY   *P1:24,*EL,*B,"No transactions found.  ";
            CALL      HITENTER
          ENDIF
SDEP9999  RETURN
+
.******************************************************************************
.*                                  GRTL0000              Called by: ML0000   *
.*                            Print The Grand Total                           *
.******************************************************************************
GRTL0000  ASSIGN    (TOTINVAT-TOTDEPAT),GRANDTOT
          PRINT     *N,*N:
                    *47,"*--------------------------------------*",*N:
                    *47,PIPE,*49,"INVOICE PENDING TOTAL :",*74,TOTINVAT:
                    *86,PIPE,*N:
                    *47,PIPE,*49,"LESS DEPOSITS         :",*74,TOTDEPAT:
                    *86,PIPE,*N:
                    *47,PIPE,*73,"------------",*86,PIPE,*N:
                    *47,PIPE,*49,"NETT TOTAL            :",*70,GRANDTOT:
                    *86,PIPE,*N:
                    *47,"*--------------------------------------*",*N
GRTL9999  RETURN
+
.****************************************************************************
.*                            PRIN0000                 Called by: PROC0000  *
.*               print the records for a debtor                             *
.****************************************************************************
.
PRIN0000  MOVE      SP6,SAVPRAC
          PACK      KEY80,SP30,SP30,SP20
          CALL      RSTMPR2                      * position at start of file
PRIN1000  CALL      RKTMPR2                      * read next record
          BRANCH    OVRCD,PRIN9999               * no records on file
.
          MATCH     SPRAC,TMPPRAC           * practice >= start practice ?
          GOTO      PRIN1000 IF LESS        * no - ignore
          MATCH     TMPPRAC,EPRAC          * practice <= end practice ?
          GOTO      PRIN1000 IF LESS        * no - ignore
.
          MOVE      ZERO,SUBTOTAL                * initialise debtor total
          MOVE      ONE,FULLINE                  * print short line
.
.         Format the debtor's number & name
.
          MOVE      SP1,ANS
          MOVE      TMPSCAN,FORM2
          LOAD      ANS,FORM2,ANSP
          PACK      FMTDEBT,ANS,TMPDEBT
.
          MOVE      "Unknown debtor",FMTNAME
.         COMPARE   ZERO,TMPSCAN                 * debtor ?
.         IF        !@EQUAL
...       IF        @EQUAL
...          MOVE      TMPDEBT,KEY8              * yes
...          CALL      RDPRDB1                   * read debtor record
...          BRANCH    OVRCD,PRIN2000            * not found
.
...          MOVE      PRDBSNAM,PACSNAME         * format debtor name
...          MOVE      PRDBGNAM,PACGNAME
...          MOVE      PRDBTITL,PACTITLE
...       ELSE
             MOVE      TMPDEBT,PURNO
             MOVE      PURNO,KEY8
             CALL      RDMAST1                   * read PMI record
             BRANCH    OVRCD,PRIN2000            * not found
.
             MOVE      PSNAME,PACSNAME           * format PMI name
             MOVE      PGNAME,PACGNAME
.
             CALL      CHGI0000
             COMPARE   ONE,VALDGICD
             IF        @EQUAL
               MOVE      SP70,PACTITLE
             ELSE
               MOVE      PTITL,PACTITLE
             ENDIF
             MOVE      TWO,PACFRMT
             CALL      PACNAME
             MOVE      PACFNAME,FMTNAME
.         ENDIF
.
PRIN2000  MOVE      ONEHUND,PRDOFEEP             * get % doctor charge
          PACK      KEY22,TMPPRAC,TMPSDOCT,TMPCLAIM,TMPPIND
          CALL      RDPRDO1
.
          CALL      RDIT0000                * read in item file record
.
          MOVE      TMPITOT,TEMPTOTV
          MOVE      TMPITOT,TEMPAMNT
          CALL      GETAJ000                     * adjust for doctor % charge
          MOVE      TEMPAMNT,TMPITOT
          MULT      TMPSERVS,TMPITOT             * calculate line total
.
          MOVE      TMPIAMNT,TEMPTOTV
          MOVE      TMPIAMNT,TEMPAMNT
          CALL      GETAJ000
          MOVE      TEMPAMNT,TMPIAMNT
.
          CALL      DISP0000                     * print transaction
.
          CALL      RKTMPR2                      * read next record
          BRANCH    OVRCD,PRIN9000               * no more records
.
          MATCH     SPRAC,TMPPRAC           * practice >= start practice ?
          GOTO      PRIN9000 IF LESS        * no - ignore
          MATCH     TMPPRAC,EPRAC          * practice <= end practice ?
          GOTO      PRIN9000 IF LESS        * no - ignore
.
.         There are more records for this debtor so don't print the
.         subtotal yet
.
          PRINT     *132,PIPE
          GOTO      PRIN2000                     * display record
.
.         Last record for this debtor so print in subtotal
.
PRIN9000  PRINT     *120,SUBTOTAL,*132,PIPE
          ADD       SUBTOTAL,TOTINVAT
          CALL      LINE0000
.
PRIN9999  RETURN
+
.****************************************************************************
.*                                RDIT0000             Called by: PRIN0000  *
.*         read in the item record to find out if fixed charged             *
.****************************************************************************
.
RDIT0000  PACK      KEY22,TMPIFLAG,TMPITEM,TMPSITEM,TMPSDATE
          CALL      RDPRIT1                 * read the item file
          COMPARE   ZERO,OVRCD
          GOTO      RDIT9999 IF EQUAL
.
          CALL      RPPRIT1                 * get the previous record on the 
          BRANCH    OVRCD,RDIT9000            item file
.
          MATCH     PRITSUBN,TMPSITEM       * see if we have the same sub-item
          GOTO      RDIT9000 IF NOT EQUAL
.
          MATCH     PRITITMN,TMPITEM        * see if we have the same item
          GOTO      RDIT9000 IF NOT EQUAL
.
          COMPARE   PRITFLAG,TMPIFLAG       * see if we have the item type
          GOTO      RDIT9000 IF NOT EQUAL
.
.         We have the required record
.
          GOTO      RDIT9999
.
.------ assume not a fixed charged item -------
.
RDIT9000  MOVE      TWO,PRITFIXD        * not fixed charged
.
RDIT9999  RETURN
+
.****************************************************************************
.*                                RDLN0000             Called by: DISP0000  *
.*    read in the private practice holding record to see if values exist    *
.****************************************************************************
.
RDLN0000  PACK      KEY22,DTMPIFLG,TMPITEM,TMPSITEM,TMPSDATE
          CALL      RDPRHT2
.
          COMPARE   ONE,OVRCD
          GOTO      RDLN9900 IF EQUAL
.
.          MATCH     TMPITEM,PRHTITMN
.          GOTO      RDLN9900 IF NOT EQUAL
.
          MATCH     SP70,PRHTITMN
          GOTO      RDLN9900 IF EQUAL
.
.          MATCH     TMPSDATE,PRHTDATE
.          GOTO      RDLN9900 IF NOT EQUAL
.
          MATCH     SP70,PRHTDATE
          GOTO      RDLN9900 IF EQUAL
.
.          MATCH     DTMPTRAN,DPRHTNUM
.          IF        !@EQUAL
.            GOTO      RDLN1000          *duplicate key, go to next item
.          ENDIF
.
          MOVE      ZERO,PHLNFLAG
          GOTO      RDLN9999
. 
RDLN9900  MOVE      ONE,PHLNFLAG
.
RDLN9999  RETURN
+
.****************************************************************************
.*                                CHGI0000             Called by: DISP0000  *
.*    read in the private practice holding record to see if values exist    *
.****************************************************************************
CHGI0000  PACK      KEY5,CATGI,SP3
          CALL      RDSCODE1
CHGI1000  CALL      RDKCODE1
          BRANCH    OVRCD,CHGI9999
.
          MATCH     CATGI,TCODE
          GOTO      CHGI2000 IF NOT EQUAL
.
          MATCH     ANSB,TCINDC3
          GOTO      CHGI3000 IF EQUAL
.
          GOTO      CHGI10000
.
CHGI2000  MOVE      ZERO,VALDGICD
          GOTO      CHGI9999
.
CHGI3000  MOVE      ONE,VALDGICD
.
CHGI9999  RETURN
.****************************************************************************
.*                            DISP0000                 Called by: PRIN0000  *
.*                 print a transaction line                                 *
.****************************************************************************
.
DISP0000  COMPARE   THREE,COPTION
          GOTO      DISP0500 IF NOT EQUAL
.
.         Print Medical Practice per Separate Page 
.
          MATCH     SP70,PAGEPRAC
          IF        @EQUAL
            MOVE      TMPPRAC,PAGEPRAC
            MOVE      TMPITOT,AMNTPRAC
            GOTO      DISP0500
          ENDIF
.
          MATCH     TMPPRAC,PAGEPRAC
          IF        @EQUAL
            ADD       TMPITOT,AMNTPRAC
            GOTO      DISP0500
          ENDIF
.
          PRINT     *1,PIPE,*80," Invoice Pending Total For ",PAGEPRAC:
                    *120,AMNTPRAC,*132,PIPE 
          ADD       ONE,CLNO
          CALL      LINE0000
          MOVE      TMPITOT,AMNTPRAC
          MOVE      TMPPRAC,PAGEPRAC
          IF        SEPFLAG=1
            CALL      HEAD0000                     
          ELSE
            IF        CLNO>=46
              GOTO      DISP0500
            ENDIF
            PRINT     *N
            CALL      SHED0000 
            ADD       FIVE,CLNO                     * increment line count
          ENDIF
          GOTO      DISP1000
.
DISP0500  COMPARE   FORTY6,CLNO                  * page full ?
          IF        @LESS
             GOTO      DISP1000                  * no
          ELSE
             CALL   LINE0000
             CALL   HEAD0000                     * yes
          ENDIF
.
DISP1000  COMPARE   FULLINE,ZERO                 * not full line
          IF        @EQUAL
             CALL      CHGI0000
             BRANCH    VALDGICD,DISP1002
.
             GOTO      DISP1004
.
DISP1002     CALL      RDLN0000
             BRANCH    PHLNFLAG,DISP1003
.
             PRINT     *1,PIPE,*12,PIPE,*30,PIPE,*31,PRHTLVIS,*40,PIPE,*45,PIPE;
             GOTO      DISP1005
.
DISP1003     PRINT     *1,PIPE,*12,PIPE,*30,PIPE,*40,PIPE,*45,PIPE;
             GOTO      DISP1005
.
DISP1004     PRINT     *1,PIPE,*12,PIPE,*40,PIPE,*45,PIPE;
.
DISP1005     MATCH     SAVPRAC,TMPPRAC           * same practice still ?
             IF        @EQUAL
                GOTO      DISP3000               * yes
             ELSE
                PRINT     *47,TMPPRAC;
                MOVE      TMPPRAC,SAVPRAC        * no
             ENDIF
          ELSE
             CALL      CHGI0000
             BRANCH    VALDGICD,DISP1020
.
             GOTO      DISP1030
.
DISP1020     CALL      RDLN0000
             MOVE      FMTNAME,DIM15
.
             BRANCH    PHLNFLAG,DISP1025
.
             PRINT     *1,PIPE,*2,FMTDEBT,*12,PIPE,*14,DIM15,*30,PIPE:
                       *31,PRHTLVIS,*40,PIPE,*41,TMPPIND,*45,PIPE,*47,TMPPRAC;
             GOTO      DISP1029
.            
DISP1025     PRINT     *1,PIPE,*2,FMTDEBT,*12,PIPE,*14,DIM15,*30,PIPE:
                       *40,PIPE,*41,TMPPIND,*45,PIPE,*47,TMPPRAC;
.
DISP1029     MOVE      TMPPRAC,SAVPRAC
             GOTO      DISP3000
.
DISP1030     MOVE      FMTNAME,DIM25
             PRINT     *1,PIPE,*2,FMTDEBT,*12,PIPE,*14,DIM25,*40,PIPE:
                       *41,TMPPIND,*45,PIPE,*47,TMPPRAC;
             MOVE      TMPPRAC,SAVPRAC
          ENDIF
.
DISP3000  UNPACK    TMPSDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      MBS,PREFIX
          MOVE      TMPIFLAG,FORM2
          LOAD      PREFIX,FORM2,AMA
          PRINT     *54,PIPE,*55,CPCDATE,*65,PIPE,*67,PREFIX,TMPITEM;
.
          MATCH     SP3,TMPSITEM                 * subitem blank ?
          GOTO      DISP4000 IF EQUAL            * yes
.
          PRINT     *78,"(",TMPSITEM,")";
.
DISP4000  MOVE      TMPIAMNT,DISPAMNT
          PRINT     *84,PIPE,*86,TMPSERVS,*90,PIPE,*92,DISPAMNT,*104,PIPE;
.
          COMPARE   ZERO,TMPITOT                 * zero total ?
          GOTO      DISP5000 IF EQUAL            * yes - don't print
.
          MOVE      TMPITOT,DISPAMNT
          PRINT     *106,DISPAMNT;
.
DISP5000  PRINT     *118,PIPE;
.
          ADD       ONE,CLNO                     * increment line count
          ADD       TMPITOT,SUBTOTAL
          MOVE      ZERO,FULLINE                 * print full line
.
DISP9999  RETURN
+
.****************************************************************************
.*                            HEAD0000                 Called by: PROC0000  *
.*                       print page heading                       DISP0000  *
.****************************************************************************
HEAD0000  CALL      HEAD132                 * Display page header
.
          IF        COPTION=1
            PRINT     *40,"Patient Surname Sequence"
          ENDIF
          IF        COPTION=2
            PRINT     *40,"Debtor Number Sequence"
          ENDIF
          IF        COPTION=3
            PRINT     *40,"Medical Practice Sequence"
          ENDIF
.
          PRINT     *40,"Medical Practice: ",SMPDESC," To ",EMPDESC:
                    *N
.
          CALL      SHED0000                * Print the subheading
          MOVE      ONE,FULLINE
          MOVE      TEN,CLNO              * Increment line count
HEAD9999  RETURN
+
.****************************************************************************
.*                            SHED0000                 Called by: HEAD0000  *
.*                      Print The Subheading                      DDEP0000  *
.****************************************************************************
SHED0000  CALL      LINE0000                * Draw line across page
.
          CALL      CHGI0000
          BRANCH    VALDGICD,SHED0300
.
SHED0200  PRINT     *1,PIPE,*2,"DEBTOR ##",*12,PIPE,*14,"PATIENT NAME":
                    *40,PIPE,*41,"TYP.",*45,PIPE,*47,"MED.",*54,PIPE:
                    *56,"SERVICE",*65,PIPE,*67,"ITEM ##",*84,PIPE,*85,"NO OF":
                    *90,PIPE,*92,"UNIT COST",*104,PIPE,*106,"TOTAL COST":
                    *118,PIPE,*121,"SUBTOTAL",*132,PIPE,*N:
                    *1,PIPE,*12,PIPE,*40,PIPE,*45,PIPE,*47,"PRAC.":
                    *54,PIPE,*57,"DATE":
                    *65,PIPE,*84,PIPE,*85,"ITEMS",*90,PIPE,*104,PIPE,*118,PIPE:
                    *132,PIPE
          CALL      LINE0000                * Draw line across page
.
          GOTO      SHED9999
.
SHED0300  COMPARE   ONE,INVPFLAG
          GOTO      SHED0200 IF NOT EQUAL
.
          PRINT     *1,PIPE,*2,"DEBTOR ##",*12,PIPE,*14,"PATIENT NAME":
                    *30,PIPE,*31,"LNK VISIT",*40,PIPE,*41,"TYP.",*45,PIPE:
                    *47,"MED.",*54,PIPE:
                    *56,"SERVICE",*65,PIPE,*67,"ITEM ##",*84,PIPE,*85,"NO OF":
                    *90,PIPE,*92,"UNIT COST",*104,PIPE,*106,"TOTAL COST":
                    *118,PIPE,*121,"SUBTOTAL",*132,PIPE,*N:
                    *1,PIPE,*12,PIPE,*30,PIPE,*40,PIPE,*45,PIPE,*47,"PRAC.":
                    *54,PIPE,*57,"DATE":
                    *65,PIPE,*84,PIPE,*85,"ITEMS",*90,PIPE,*104,PIPE,*118,PIPE:
                    *132,PIPE
          CALL      LINE0000                * Draw line across page

SHED9999  RETURN
+
.****************************************************************************
.*                            LINE0000                 Called by: PRIN0000  *
.*                      draw line across page                     HEAD0000  *
.*                                                                DISP0000  *
.****************************************************************************
.
LINE0000  PRINT     "*-----------------------------------------------":
                    "------------------------------------------------":
                    "-----------------------------------*"
.
          ADD       ONE,CLNO
.
LINE9999  RETURN
+
.**************************************************************************
.*                              CREA0000               Called by: ML0000  *
.*             create a new temporary file                                *
.**************************************************************************
.
CREA0000  CALL      KILL0000                     * remove existing file
.
          PACK      CMDLIN1,ISBUILD,TEMPFILE,UKEY1,UKEY2
          EXECUTE   CMDLIN1,TASKID               * create temporary index file
.
          OPEN      PENTEMP1,TEMPFILE            * open temp index file
          OPEN      PENTEMP2,TEMPFILE
          OPEN      PENTEMP3,TEMPFILE
          OPEN      PENTEMP4,TEMPFILE
.
          CALL      CREATP00                     * create second temp file
.
CREA9999  RETURN
+
.****************************************************************************
.*                              KILL0000               Called by: ML0000    *
.*               close and erase the temporary file               CREA0000  *
.****************************************************************************
.
KILL0000  CLOSE     PENTEMP1                     * close file
          CLOSE     PENTEMP2
          CLOSE     PENTEMP3
.
          PACK      CMDLIN2,ERASE,TEMPFILE       * set file erase command
          EXECUTE   CMDLIN2,TASKID               * erase temp file
          CALL      RMTMP000                     * remove PRIINVPR temp files
KILL9999  RETURN
+
.****************************************************************************
.
GETSVAR   RETURN
+
.****************************************************************************
.*        IO ROUTINES FOR TEMPORARY FILE                                    *
.****************************************************************************
.
RATEMP1   MOVE      ZERO,OVRCD
          RESET     KEY8
          READ      PENTEMP1,KEY8;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
WRTEMP1   MOVE      TEMPSCN,DTEMPSCN
          WRITE     PENTEMP1,KEY8;KEY8,TEMPDEB,DTEMPSCN,TEMPSUR,TEMPGIV,TEMPPRAC
          RETURN
.
.         2nd Index
.
RSTEMP2   READ      PENTEMP2,KEY18;;
          RETURN
.
RKTEMP2   MOVE      ZERO,OVRCD
          READKS    PENTEMP2;DTEMPUNQ,TEMPDEB,DTEMPSCN,TEMPSUR,TEMPGIV,TEMPPRAC
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
.
RSTEMP3   READ      PENTEMP3,KEY58;;
          RETURN
.
RKTEMP3   MOVE      ZERO,OVRCD
          READKS    PENTEMP3;DTEMPUNQ,TEMPDEB,DTEMPSCN,TEMPSUR,TEMPGIV,TEMPPRAC
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
+
.
.         4th Index
.
RSTEMP4   READ      PENTEMP4,KEY24;;
          RETURN
.
RKTEMP4   MOVE      ZERO,OVRCD
          READKS    PENTEMP4;DTEMPUNQ,TEMPDEB,DTEMPSCN,TEMPSUR,TEMPGIV,TEMPPRAC
          GOTO      OVERCOND IF OVER
          MOVE      DTEMPUNQ,TEMPUNQ
          MOVE      DTEMPSCN,TEMPSCN
          RETURN
+
SCHPRO00
SETDEF00
GETCOD00
OPEN0000
CLOS0000  RETURN
. =========================================================================
.  I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       IBAPRINT
          INC       PRIINVPR
          INC       CLPRIDTR
          INC       PRIINVHL
          INC       PRIINVTL
          INC       PRICALFS
          INC       PRIPRADS
          INC       PATSNDX
          INC       TFILENAM                * Generate Temp File Name
          INC       SEXDSP00
.
          INC       WEBERRIO/INC            * Web Server Error Logging
          INC       HICITIIO/INC                 * HIC items invoice file
          INC       IBAGEDIO/INC
          INC       IBAGSTIO/INC
          INC       IBAPRNIO/INC
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
          INC       PRIAUIIO/INC
          INC       PRIBULIO/INC                 * bulk billing file
          INC       PRICNOIO/INC                 * Credit note file
...          INC       PRIDBTIO/INC                 * debtor file
          INC       PRIECTIO/INC
          INC       PRIEXCIO/INC
          INC       PRIHDBIO/INC                 * holding header file
          INC       PRIHREIO/INC                 * holding referral file
          INC       PRIHOLIO/INC                 * account hold file
          INC       PRIHTRIO/INC                 * holding transaction file
          INC       PRIDTRIO/INC                 * debtor transaction file
          INC       PRIITMIO/INC                 * item file
          INC       PRISTAIO/INC                 * financial statistics file
          INC       PRIGRPIO/INC                 * item group file
          INC       PRITESIO/INC                 * pathology test file
          INC       PRIHISIO/INC                 * history file
          INC       PRIWCOIO/INC                 * workers comp file
          INC       PRIMABIO/INC                 * transport accident file
          INC       PRIMGPIO/INC                 * medicare gap file
          INC       PRIVAFIO/INC                 * veteran affair file
          INC       PRIINVIO/INC                 * invoice file
          INC       PRIPRAIO/INC                 * medical practice file
          INC       PRISPTIO/INC                 * spec. path. test file
          INC       PRIMULIO/INC                 * multiple codes file
          INC       PRIFIGIO/INC                 * financial summary file
          INC       PRIFINIO/INC                 * financial summary file
          INC       PRIINVIT/INC                 * for PRIINVPR
          INC       PRIDOCIO/INC                 * M.P. doctor file
          INC       PRIALSIO/INC                 * Medical Prac.all user access
          INC       PRISECIO/INC                 * Medical Prac.security access
.
          INC       PATMA1IO/INC                 * patient master file
          INC       PATMESIO/INC                 * message file
          INC       PATCODIO/INC                 * codes file
          INC       PATIN1IO/INC                 * Insurance file
          INC       PMSHCPIO/INC                 * doctor file
          INC       PMSHCLIO/INC
          INC       PATDRGIO/INC                 * date range period file
          INC       PATGSRIO/INC                 * Patient Surname / Given Name
          INC       PATVISIO/INC                 * visit file
          INC       PATMI1IO/INC                 * admission file
          INC       PATPERIO/INC                 * doctor personal file
          INC       PATPR1IO/INC                 * pre-admission file
          INC       PATRE1IO/INC                 * PRA file          
          INC       PMSPX2IO/INC
          INC       PMSVX1IO/INC
          INC       OUTPREIO/INC
          INC       BOKRC1IO/INC
          INC       RCPBNKIO/INC
          INC       RCPBDTIO/INC
          INC       RCPDTEIO/INC
          INC       RCPREGIO/INC
          INC       COMDEPIO/INC                 * cash file
          INC       PATCOMN1                     * KURN
.
          INC       PATSNX2
          INC       PATGBCRN   
          INC       NZIBSRCH
          INC       NZHISIIO
          INC       CLPATMAS
          INC       CALCAGE
          INC       NHIMASIO/INC                 * NZHIS Variables
.
          INC       PATHSPIO/INC           * Hospital Details for GBCRN000
.
          INC       WEBIMCIO/INC
          INC       WEBB2BIO/INC
