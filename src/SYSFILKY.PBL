.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSFILKY
.   Routine   :   HSYFIA00 File Code Help      
.   Return    :           
.-------------------------------------------------------------------------------
HSYFIA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYFIA04 IF NOT EQUAL
          MOVE      "14",HTOP
          MOVE      "24",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYFIA04
          CALL      GSCRN000
          BRANCH    EXIT,HSYFIA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HSYFIA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SYFIFIL 
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          PACK      SAVKEY80,SYFISYS,SYFIFIL,SP70                               
          SETLPTR   SAVKEY80,2                                                  
          CALL      RSSYFI1 
HSYFIA10
          CALL      RKSYFI1 
          BRANCH    OVRCD,HSYFIA15
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSYFIA12
          CALL      HSYFIA60
          BRANCH    OVRCD,HSYFIA10
HSYFIA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYFIFIL 
          DISPLAY   *PSTDCOL02:STDROW,SYFIDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYFIA10 IF NOT EQUAL
HSYFIA15
          UNPACK    SAVKEY80,SYFISYS,SYFIFIL                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYFIA20
          CALL      HSCRI000
          BRANCH    EXIT,HSYFIA30,HSYFIA35,HSYFIA40,HSYFIA45,HSYFIA04:
                              HSYFIA91,HSYFIA50
          GOTO      HSYFIA92
HSYFIA30
          CALL      RKSYFI1 
          BRANCH    OVRCD,HSYFIA85
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA85 IF NOT EQUAL                                       
          CALL      RPSYFI1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYFIA10
HSYFIA35
          MOVE      ST1,KEY4 
          CALL      RDSYFI1 
          CALL      RPSYFI1 
          BRANCH    OVRCD,HSYFIA85
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA85 IF NOT EQUAL                                       
          MATCH     SP70,SYFIFIL                                                
          GOTO      HSYFIA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYFIA36
          CALL      RPSYFI1 
          BRANCH    OVRCD,HSYFIA37
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYFIA36 IF NOT EQUAL
HSYFIA37
          MOVE      ZERO,XITEMNO
          GOTO      HSYFIA10
HSYFIA40
          MOVE      ST1,KEY4 
          CALL      RDSYFI1 
          CALL      RPSYFI1 
          BRANCH    OVRCD,HSYFIA85
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYFIA08
HSYFIA45
          CALL      RKSYFI1 
          BRANCH    OVRCD,HSYFIA85
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,SAVKEY80,Z70                                           
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYFI1 
HSYFIA46
          CALL      RPSYFI1 
          BRANCH    OVRCD,HSYFIA47
          PACK      KEY4,SYFISYS,SYFIFIL,SP70                                   
          MATCH     SAVKEY80,KEY4                                               
          GOTO      HSYFIA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYFIA46 IF NOT EQUAL
HSYFIA47
          MOVE      ZERO,XITEMNO
          GOTO      HSYFIA10
HSYFIA50  COMPARE   ZERO,CSEARCH
          GOTO      HSYFIA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYFIA08
HSYFIA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYFIA08
HSYFIA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYFIA61 IF EQUAL
          MATCH     SCHFLD01,SYFIFIL 
          GOTO      HSYFIA72 IF NOT EQUAL
HSYFIA61
          MATCH     SP70,SCHFLD02
          GOTO      HSYFIA62 IF EQUAL
          MATCH     SCHFLD02,SYFIDES 
          GOTO      HSYFIA72 IF NOT EQUAL
HSYFIA62
HSYFIA63
HSYFIA64
HSYFIA65
HSYFIA66
HSYFIA67
HSYFIA68
HSYFIA69
HSYFIA70
          GOTO      HSYFIA75
HSYFIA72  MOVE      ONE,OVRCD
HSYFIA75  RETURN
HSYFIA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,SYFISYS,SYFIFIL                                        
          CALL      RDSYFI1 
HSYFIA90
          UNPACK    SAVKEY80,SYFISYS,SYFIFIL                                    
          BEEP
          GOTO      HSYFIA20
HSYFIA91
          MOVE      SP70,SYFIID3 
          MOVE      SP70,SYFIDES 
          MOVE      ZERO,SYFIAUD 
          MOVE      ZERO,SYFITIO 
          MOVE      SP70,SYFIID4 
          MOVE      ZERO,SYFIASEC
          MOVE      ZERO,SYFIAPOS
          MOVE      ZERO,SYFILOC 
          MOVE      SP70,SYFIREL 
          MOVE      ZERO,SYFIVERS
          MOVE      SP70,SYFISPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,SYFIFIL 
          GOTO      HSYFIA96
HSYFIA92
          MOVE      SP70,KEY4 
          MOVE      SP70,SYFIFIL 
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,SYFISYS,SYFIFIL                                        
HSYFIA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYFIA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSFILKY
.   Routine   :   KSYFIA00 Keyin File Code Keyin     
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYFIA00 TOPIC     "SYFIFIL "
          MOVE      UNDLN70,SYFIFIL 
          KEYIN     *PCCOL:CVERT,*DV,SYFIFIL:                                   
                    *PCCOL:CVERT,*V2LON,SYFIFIL:                                
                    *PCCOL:CVERT,*DV,SYFIFIL 
.
          ENDSET    SYFIFIL 
          APPEND    SP70,SYFIFIL 
          RESET     SYFIFIL 
          REP       UPPLOW,SYFIFIL
.
          MATCH     SP70,SYFIFIL 
          GOTO      KSYFIA90 IF EQUAL
.
          CMATCH    EXITCHAR,SYFIFIL 
          GOTO      KSYFIA95 IF EQUAL
.
          CMATCH    QUEST,SYFIFIL 
          GOTO      KSYFIA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYFIA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SYFIFIL 
          APPEND    SP70,SYFIFIL 
          RESET     SYFIFIL 
.
          MATCH     SP70,SYFIFIL 
          GOTO      KSYFIA00 IF EQUAL
.
KSYFIA10
          DISPLAY   *PCCOL:CVERT,*V2LON,SYFIFIL                                 
          PACK      KEY4,SYFISYS,SYFIFIL                                        
          CALL      RASYFI1 
          BRANCH    OVRCD,KSYFIA80
          BRANCH    CKEYTYP,KSYFIA75
          CALL      RDSYFI1 
KSYFIA70
          MOVE      ZERO,EXIT
          GOTO      KSYFIA99
KSYFIA75
          MOVE      "File Code Keyin Already Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KSYFIA00
KSYFIA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYFIA99,KSYFIA99
          MOVE      "File Code Keyin Does Not Exist - ",DISPMSG                                      
          CALL      MESSAGE1
          GOTO      KSYFIA00
KSYFIA90
          MOVE      ONE,EXIT
          GOTO      KSYFIA99
KSYFIA95
          MOVE      TWO,EXIT
KSYFIA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSFILKY
.   Routine   :   KSYFIB00 Keyin File Id Keyin       
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYFIB00 TOPIC     "SYFIID3 "
          MOVE      UNDLN70,SYFIID3 
          KEYIN     *PCCOL:CVERT,*DV,SYFIID3:                                   
                    *PCCOL:CVERT,*V2LON,SYFIID3:                                
                    *PCCOL:CVERT,*DV,SYFIID3 
.
          ENDSET    SYFIID3 
          APPEND    SP70,SYFIID3 
          RESET     SYFIID3 
          REP       UPPLOW,SYFIID3
.
          MATCH     SP70,SYFIID3 
          GOTO      KSYFIB90 IF EQUAL
.
          CMATCH    EXITCHAR,SYFIID3 
          GOTO      KSYFIB95 IF EQUAL
.
          CMATCH    QUEST,SYFIID3 
          GOTO      KSYFIB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYFIA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SYFIID3 
          APPEND    SP70,SYFIID3 
          RESET     SYFIID3 
.
          MATCH     SP70,SYFIID3 
          GOTO      KSYFIB00 IF EQUAL
.
KSYFIB10
          DISPLAY   *PCCOL:CVERT,*V2LON,SYFIID3
          PACK      KEY5,SYFISYS,SYFIID3                                        
          CALL      RASYFI2 
          BRANCH    OVRCD,KSYFIB80
          BRANCH    CKEYTYP,KSYFIB75
          CALL      RDSYFI2 
KSYFIB70
          MOVE      ZERO,EXIT
          GOTO      KSYFIB99
KSYFIB75
          MOVE      "File Id Keyin Already Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KSYFIB00
KSYFIB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYFIB99,KSYFIB99
          MOVE      "File Id Keyin Does Not Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KSYFIB00
KSYFIB90
          MOVE      ONE,EXIT
          GOTO      KSYFIB99
KSYFIB95
          MOVE      TWO,EXIT
KSYFIB99 TOPIC    PRGID
          RETURN
