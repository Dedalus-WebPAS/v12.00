.*------------------------------------------------------------------------------
.* NAMST1CD.PBL
.* V10.03.00  05/02/2013  Patrick Adair                               CAR 263963
.*            Created as copy of NAMSTRCD to allow for DISPNMLG of 71 chars
.*            This will be redundant once 10.04 changes update NAMSTRCD
.*------------------------------------------------------------------------------
.* Format Name 
.*------------------------------------------------------------------------------
NAMST100  RESET     NAME35
          GOTO      NAMST199 IF EOS
.
NAMST110  CMATCH    SP1,NAME35                   * Remove Leading Blanks
          IF        @EQUAL
            BUMP      NAME35
            GOTO      NAMST110 IF NOT EOS
            GOTO      NAMST199                   * entire name if blank
          ENDIF
          PACK      KEY35,NAME35,SP30            * reset form pointer
          MOVE      KEY35,NAME35
.
          SCAN      SP1,NAME35                   * Locate the blank
          GOTO      NAMST120 IF NOT EQUAL
          BUMP      NAME35,-1                    * go back 1 to end of name
          MOVEFPTR  NAME35,CCITEM                * another handly form field
          RESET     NAME35                       * reset the form pointer
          SETLPTR   NAME35,CCITEM                * set logical len to end of name
.
.         Save this name
.
          UNPACK    NAME35,KEY1,KEY50
          MATCH     "'",KEY1
          IF        @EQUAL
            UNPACK    NAME35,KEY2,KEY50
            REP       DOWNCASE,KEY50
            APPEND    KEY2,DISPNMLG
          ELSE
            REP       DOWNCASE,KEY50
            APPEND    KEY1,DISPNMLG
          ENDIF
          STRIP     KEY50
          APPEND    KEY50,DISPNMLG
          APPEND    SP1,DISPNMLG
.
.         Check for any more names
.
          SETLPTR   NAME35,35                    * reset logical length
          ADD       ONE,CCITEM                   * position of 1st blank
          RESET     NAME35,CCITEM                * reset to this point
          PACK      KEY35,NAME35,SP70            * reset form pointer
          MOVE      KEY35,NAME35
          GOTO      NAMST110
.
.         Rest of the string is one name
.
NAMST120  UNPACK    NAME35,KEY1,KEY50
          REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNMLG
          STRIP     KEY50
          APPEND    KEY50,DISPNMLG
          APPEND    SP1,DISPNMLG
.
NAMST199  RETURN
.
.-------------------------------------------------
. Format Name as is - same as namstr but without formatting case
.-------------------------------------------------
NAMAS100  RESET     NAME35
          GOTO      NAMAS199 IF EOS
.
NAMAS110  CMATCH    SP1,NAME35                   * Remove Leading Blanks
          IF        @EQUAL
            BUMP      NAME35
            GOTO      NAMAS110 IF NOT EOS
            GOTO      NAMAS199                   * entire name if blank
          ENDIF
          PACK      KEY35,NAME35,SP30            * reset form pointer
          MOVE      KEY35,NAME35
.
          SCAN      SP1,NAME35                   * Locate the blank
          GOTO      NAMAS120 IF NOT EQUAL
          BUMP      NAME35,-1                    * go back 1 to end of name
          MOVEFPTR  NAME35,CCITEM                * another handly form field
          RESET     NAME35                       * reset the form pointer
          SETLPTR   NAME35,CCITEM                * set logical len to end of name
.
.         Save this name
.
          UNPACK    NAME35,KEY1,KEY50
.....     REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNMLG
          STRIP     KEY50
          APPEND    KEY50,DISPNMLG
          APPEND    SP1,DISPNMLG
.
.         Check for any more names
.
          SETLPTR   NAME35,35                    * reset logical length
          ADD       ONE,CCITEM                   * position of 1st blank
          RESET     NAME35,CCITEM                * reset to this point
          PACK      KEY35,NAME35,SP70            * reset form pointer
          MOVE      KEY35,NAME35
          GOTO      NAMAS110
.
.         Rest of the string is one name
.
NAMAS120  UNPACK    NAME35,KEY1,KEY50
.....     REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNMLG
          STRIP     KEY50
          APPEND    KEY50,DISPNMLG
          APPEND    SP1,DISPNMLG
.
NAMAS199  RETURN
.
