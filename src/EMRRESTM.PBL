. *-----------------------------------------------------------------------
. * Include Name  :   EMRRESTM.PBL
. *
. * Function      :   CGI variables functions for EMRRESFD - emrresaf.dat
. *-----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.03.00  22/10/2012  Ebon Clements CAR 266929
.             Created include
. *-----------------------------------------------------------------------
.-------------------------------------------------------------------------
.   Clear Parameters for research program file
.-------------------------------------------------------------------------
CPEMRE00  MOVE      Z70,EMRES001
          MOVE      Z70,EMRES002
          MOVE      Z70,EMRES003
          MOVE      Z70,EMRES004
.
CPEMRE99  RETURN
.
.--------------------------------------------------------------------------
. Tags for research program file
.--------------------------------------------------------------------------
EMRE0000  BRANCH    FLDITMNO,EMRE0010,EMRE0020,EMRE0030,EMRE0040,EMRE0050:
                             EMRE0060,EMRE0070,EMRE0080,EMRE0090,EMRE0100:
                             EMRE0110,EMRE0120
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMRE9999
.
EMRE0010  MOVE      "eu",CATEGORY
          MOVE      EMRERESP,CODE
          CALL      CODITM00
          GOTO      EMRE9999
.
EMRE0020  UNPACK    EMRESDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMRE9999
.
EMRE0030  MATCH     SP70,EMREEDAT
          GOTO      EMRE9999 IF EQUAL
.
          UNPACK    EMREEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMRE9999
.
EMRE0040  MATCH     "1",EMRESTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"Inactive";
          ELSE
            WRITE     HTMLFILE;"Active";
          ENDIF
          GOTO      EMRE9999
.
EMRE0050  MATCH     EMREGDAT,SP70
          GOTO      EMRE9999 IF EQUAL
.
          UNPACK    EMREGDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMRE9999
.
EMRE0060  WRITE     HTMLFILE;EMREGTIM;
          GOTO      EMRE9999

EMRE0070  MATCH     SP70,EMRECUID
          GOTO      EMRE9999 IF EQUAL
.
          PACK      KEY10,EMRECUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMRECUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMRE9999

EMRE0080  MATCH     EMRECDAT,SP70
          GOTO      EMRE9999 IF EQUAL
.
          UNPACK    EMRECDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMRE9999
.
EMRE0090  WRITE     HTMLFILE;EMRECTIM;
          GOTO      EMRE9999
.
EMRE0100  MATCH     SP70,EMREUUID
          GOTO      EMRE9999 IF EQUAL
.
          PACK      KEY10,EMREUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMREUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMRE9999

EMRE0110  MATCH     EMREUDAT,SP70
          GOTO      EMRE9999 IF EQUAL
.
          UNPACK    EMREUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMRE9999
.
EMRE0120  WRITE     HTMLFILE;EMREUTIM;
          GOTO      EMRE9999
.
EMRE9999  RETURN
.
.--------------------------------------------------------------------------
. Set parameters for research program file                     
.--------------------------------------------------------------------------
SPEMRE00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMRE01,SPEMRE02,SPEMRE03,SPEMRE04
.
          MOVE      ONE,EXIT
          GOTO      SPEMRE99
.
SPEMRE01  PACK      EMRES001,QRYDATA,SP70
          GOTO      SPEMRE99
.
SPEMRE02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      EMRES002,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMRE99
.
SPEMRE03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      EMRES003,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMRE99
.
SPEMRE04  PACK      EMRES004,QRYDATA,SP70
          GOTO      SPEMRE99
.
SPEMRE99  RETURN
.
.--------------------------------------------------------------------------
. Update cgi to file vars for research program file                     
.--------------------------------------------------------------------------
MVEMRE00  MATCH     EMRES001,Z70
          IF        !@EQUAL
            MOVE      EMRES001,EMRERESP
          ENDIF
.
          MATCH     EMRES002,Z70
          IF        !@EQUAL
            MOVE      EMRES002,EMRESDAT
          ENDIF
.
          MATCH     EMRES003,Z70
          IF        !@EQUAL
            MOVE      EMRES003,EMREEDAT
          ENDIF
.
          MATCH     EMRES004,Z70
          IF        !@EQUAL
            MOVE      EMRES004,EMRESTAT
          ENDIF
.
MVEMRE99  RETURN
.
.--------------------------------------------------------------------------
. Clear file vars for research program file                     
.--------------------------------------------------------------------------
CLEMRE00  MOVE      SP70,EMRERESP
          MOVE      SP70,EMRESDAT
          MOVE      SP70,EMREEDAT
          MOVE      SP70,EMRESTAT
          MOVE      SP70,EMREGDAT
          MOVE      SP70,EMREGTIM
          MOVE      SP70,EMRECUID
          MOVE      SP70,EMRECDAT
          MOVE      SP70,EMRECTIM
          MOVE      SP70,EMREUUID
          MOVE      SP70,EMREUDAT
          MOVE      SP70,EMREUTIM
          MOVE      SP70,EMRESPAR
.
CLEMRE99  RETURN
