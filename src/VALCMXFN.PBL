VALCMXFN
. ******************************************************************************
.* System         : Patient Billing                                           *
.* Include Name   : VALCMXFN.PBL                                              *
.* Author         : J.Tan                                                     *
.* Date           : 28/01/2011                                                *
.* Function       : Routine to validate Casemix funding                       *
.*                                                                            *
.* Requires       : KEY18 - Claim Code,Health Fund, Casemix code              *
.*                  CEFFDATE - Effective date  (used in VALCONTR)             *
.*                                                                            *
.* Returns        : EXIT  - 0 Valid                                           *
.*                        - 1 Not valid                                       *
. ******************************************************************************
.         Validate Contract ID
.
VCMF0000  MOVE      ZERO,F1
          UNPACK    KEY18,KEY3,KEY6,KEY9
          OPEN      PATCMXA1,"patcmxaf"
.
VCMF1000  PACK      KEY24,KEY18,SP30
          CALL      RSPTCMX1
VCMF2000  CALL      RKPTCMX1
          BRANCH    OVRCD,VCMF3000
.
          PACK      SKEY18,PTCMCLMN,PTCMHFND,PTCMCASM,SP70
          MATCH     KEY18,SKEY18
          GOTO      VCMF3000 IF NOT EQUAL
.
          MOVE      PTCMCNID,KEY6
          CALL      VALCONTR
          BRANCH    EXIT,VCMF2000
          MOVE      PTCMCNID,CONTRCID
          GOTO      VCMF9999
.
VCMF3000  ADD       ONE,F1
          BRANCH    F1,VCMF6000,VCMF7000
          MOVE      ZERO,PTCMXLOS
          MOVE      SP70,CONTRCID
          GOTO      VCMF8000
.
.         Try default
.
VCMF6000  PACK      KEY18,KEY3,SP6,KEY9,SP30
          GOTO      VCMF1000
.
VCMF7000  PACK      KEY18,PTCNDCLM,SP6,KEY9,SP30
          GOTO      VCMF1000
.
VCMF8000  MOVE      ONE,EXIT
VCMF9999  RETURN
+
