.
.  **********************************************************************
.  *                                                                    *
.  *     Include Name : IBAEXTTM.PBL                                    *
.  *                                                                    *
.  *     Function     : File Definition include for Common Call         *
.  *                    Extansion Table (PABX) CGI variable functions   *
.  *                                                                    *
.  *     Modifications:                                                 *
.  *      V9.03.00  24.05.2004  Sylvel Litewka  CAR 49527               *
.  *                Created include                                     *
.  **********************************************************************
.------------------------------------------------------------------------
.   Clear Parameters for IBAEXTFD
.------------------------------------------------------------------------
CPEXT000  MOVE      Z70,IBEXT001
          MOVE      Z70,IBEXT002
          MOVE      Z70,IBEXT003
          MOVE      Z70,IBEXT004
          MOVE      Z70,IBEXT005
          MOVE      Z70,IBEXT006
          MOVE      Z70,IBEXT007
          MOVE      Z70,IBEXT008
          MOVE      Z70,IBEXT009
          MOVE      Z70,IBEXT010
.
CPEXT999  RETURN
.
.------------------------------------------------------------------------
.   Clear File Variables for IBAEXTFD
.------------------------------------------------------------------------
CLEXT000  MOVE      SP70,IBEXEXTN
          MOVE      SP70,IBEXDESC
          MOVE      SP70,IBEXCHRG
          MOVE      ZERO,IBEXETYP
          MOVE      SP70,IBEXDEBT
          MOVE      SP70,IBEXPTYP
          MOVE      SP70,IBEXLEVL
          MOVE      SP70,IBEXSRVL
          MOVE      SP70,DIBEXTEN
          MOVE      ZERO,IBEXTENN
          MOVE      SP70,IBEXLVLD
          MOVE      SP70,IBEXSPAR
.
CLEXT999  RETURN
.
.------------------------------------------------------------
. Display fields from IBAEXTFD
.------------------------------------------------------------
IBEX0000  BRANCH    FLDITMNO,IBEX0100,IBEX0200,IBEX0300,IBEX0400,IBEX0500:
                             IBEX0600,IBEX0700,IBEX0800,IBEX0900,IBEX1000
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      IBEX9999
.
IBEX0100  WRITE     HTMLFILE;IBEXEXTN;      * Extension Number
          GOTO      IBEX9999
.
IBEX0200  WRITE     HTMLFILE;IBEXDESC;      * Description 
          GOTO      IBEX9999
.
IBEX0300  MOVE      "CY",CATEGORY           * Charge Type
          PACK      CODE,IBEXCHRG,SP70
          CALL      CODITM00
          GOTO      IBEX9999
.
IBEX0400  WRITE     HTMLFILE;IBEXETYP;      * Extension Type    
          GOTO      IBEX9999
.
IBEX0500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,IBEX0510
.
          WRITE     HTMLFILE;IBEXDEBT;      * Debtor Code (Account Receivable)
          GOTO      IBEX9999
.
IBEX0510  PACK      KEY8,IBEXDEBT,SP70
          CALL      RDDBDB1
          IF        OVRCD=0
            WRITE     HTMLFILE;DBDBNA1;
          ELSE
            WRITE     HTMLFILE;IBEXDEBT;
          ENDIF
          GOTO      IBEX9999
.
IBEX0600  MOVE      "XV",CATEGORY           * Phone Type
          PACK      CODE,IBEXPTYP,SP70
          CALL      CODITM00
          GOTO      IBEX9999
.
IBEX0700  MOVE      "XW",CATEGORY           * Access Level Enable
          PACK      CODE,IBEXLEVL,SP70
          CALL      CODITM00
          GOTO      IBEX9999
.
IBEX0800  MOVE      "XX",CATEGORY           * Service Level
          PACK      CODE,IBEXSRVL,SP70
          CALL      CODITM00
          GOTO      IBEX9999
.
IBEX0900  WRITE     HTMLFILE;IBEXTENN;      * Tenant Number
          GOTO      IBEX9999
.
IBEX1000  MOVE      "XW",CATEGORY           * Access Level Disable
          PACK      CODE,IBEXLVLD,SP70
          CALL      CODITM00
          GOTO      IBEX9999
.
IBEX9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for IBAEXTFD
.------------------------------------------------------------
SPEXT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEXT001,SPEXT002,SPEXT003,SPEXT004,SPEXT005:
                       SPEXT006,SPEXT007,SPEXT008,SPEXT009,SPEXT010
.
          MOVE      ONE,EXIT
          GOTO      SPEXT999
.
SPEXT001  MOVE      QRYDATA,IBEXT001
          GOTO      SPEXT999
.
SPEXT002  MOVE      QRYDATA,IBEXT002
          GOTO      SPEXT999
.
SPEXT003  MOVE      QRYDATA,IBEXT003
          GOTO      SPEXT999
.
SPEXT004  MOVE      QRYDATA,IBEXT004
          GOTO      SPEXT999
.
SPEXT005  MOVE      QRYDATA,IBEXT005
          GOTO      SPEXT999
.
SPEXT006  MOVE      QRYDATA,IBEXT006
          GOTO      SPEXT999
.
SPEXT007  MOVE      QRYDATA,IBEXT007
          GOTO      SPEXT999
.
SPEXT008  MOVE      QRYDATA,IBEXT008
          GOTO      SPEXT999
.
SPEXT009  MOVE      QRYDATA,IBEXT009
          GOTO      SPEXT999
.
SPEXT010  MOVE      QRYDATA,IBEXT010
          GOTO      SPEXT999
.
SPEXT999  RETURN
.
.------------------------------------------------------------
.  Update IBAEXTFD file variables
.------------------------------------------------------------
MVEXT000  MATCH     Z70,IBEXT001 
          IF        !@EQUAL
            MOVE      IBEXT001,IBEXEXTN     * Extension Number
          ENDIF
.
          MATCH     Z70,IBEXT002
          IF        !@EQUAL
            MOVE      IBEXT002,IBEXDESC     * Description
          ENDIF
.
          MATCH     Z70,IBEXT003
          IF        !@EQUAL
            MOVE      IBEXT003,IBEXCHRG     * Charge Type (Cat CY)
          ENDIF
.
          MATCH     Z70,IBEXT004
          IF        !@EQUAL
            MOVE      IBEXT004,IBEXETYP     * Extension Type
          ENDIF
.
          MATCH     Z70,IBEXT005
          IF        !@EQUAL
            MOVE      IBEXT005,IBEXDEBT     * Debtor Code
          ENDIF
.
          MATCH     Z70,IBEXT006
          IF        !@EQUAL
            MOVE      IBEXT006,IBEXPTYP     * Phone Type (Cat XV)
          ENDIF
.
          MATCH     Z70,IBEXT007
          IF        !@EQUAL
            MOVE      IBEXT007,IBEXLEVL     * Access Level Enable (Cat XW)
          ENDIF
.
          MATCH     Z70,IBEXT008
          IF        !@EQUAL
            MOVE      IBEXT008,IBEXSRVL     * Service Level (Cat XX)
          ENDIF
.
          MATCH     Z70,IBEXT009
          IF        !@EQUAL
            MOVE      IBEXT009,IBEXTENN     * Tenant Number
          ENDIF
.
          MATCH     Z70,IBEXT010
          IF        !@EQUAL
            MOVE      IBEXT010,IBEXLVLD     * Access Level Disable (Cat XW)
          ENDIF
.
MVEXT999  RETURN
.
