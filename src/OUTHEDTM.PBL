. *----------------------------------------------------------------------
. * Include Name  :   OUTHEDTM.PBL
. *
. * Function      :   CGI Variables for OUTHEDFD - outhedaf
. *
. * Mods          :
. *
. *       V11.04.01 29.04.2022 PJ Le Febour  TSK 0906342
. *                 Added OTHED053 for Default Procedure(OTHEPCOD)       
. *       V11.02.01 29.03.2022 DA Sarkies    TSK 0905641
. *                 Added CGI variables for Additional HCPs.
. *       V11.00.01 24/11/2020 Ebon Clemenst TSK 0876663
. *                 Added OTHEAOPN to OTHEDATE
. *       V10.11.01 09/11/2017 Davin         TSK 0846915
. *                 Added OTHED043(OTHEHCLI) and OTHED044(OTHEHCAI)
. *       V10.05.01 16/07/2014 Ebon Clements CAR 251384
. *                 Added OTHED041 and OTHED042
. *       V10.04.01 06/02/2014 Ebon Clements CAR 291879
. *                 Added OTHED040
. *       V10.03.01 19/02/2013 Ebon Clements CAR 277862
. *                 Added OTHED039 and OTHEMREF
. *       V10.02.06 15/07/2011  Peter McMullen CAR 246597
. *                 Added OTHED038 and OTHEXPUL
. *       V10.02.05 04/07/2011  Ebon Clements  CAR 240724
. *                 Mods for MRT hospital/location - Added hospital
. *                 to location key
. *       V10.02.04 24/06/2011 Ebon Clements CAR 242246
. *                 Added OTHED032 to OTHED037
. *       V10.02.03 16/06/2011 Ebon Clements  CAR 239534
. *                 Added OTHED031
. *       V10.02.02 03/06/2011 Ebon Clements  CAR 239525
. *                 Added OTHED030
. *       V10.02.01 19/05/2011 Ebon Clements  CAR 239554
. *                 Added OTHED029
. *       V9.07.01  18/08/2006 Ebon Clements  CAR 110245
. *                 Added OTHED028
. *       V9.06.01  17/05/2006  Ebon Clements CAR 104150
. *                 Added multi hospital test to mr location
. *                 and A/H Dept drowdowns
. *       V9.05.01  22/03/2006 Ebon Clements  CAR 79277
. *                Added OTHED027
. *       V9.05.B02 01/02/2006 Ebon Clements  CAR 91752
. *                Added OTHED025 and OTHED026
. *       V9.05.B01 12/01/2006 Ebon Clements  CAR 76341
. *                Added OTHED023 and OTHED024
. *       V9.04.00 15/05/2005 Ebon Clements   CAR 58654
. *                Added OTHED022 - Allow group bookings
. *       V9.03.02 14/04/2004 Ebon Clements   CAR 48981
. *                Fixed OTHED007 cgi update           
. *       V9.03.01 26/09/2003 Ebon Clements   CAR 43741
. *                Fixed OTHELTYP selection list tag
. *       V9.03.00 19/09/2003 Ebon Clements   CAR 22361
. *                Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for the outpatient template header
.------------------------------------------------------------------------
CPOTHE00  MOVE      Z70,OTHED001
          MOVE      Z70,OTHED002
          MOVE      Z70,OTHED003
          MOVE      Z70,OTHED004
          MOVE      Z70,OTHED005
          MOVE      Z70,OTHED006
          MOVE      Z70,OTHED007
          MOVE      Z70,OTHED008
          MOVE      Z70,OTHED009
          MOVE      Z70,OTHED010
          MOVE      Z70,OTHED011
          MOVE      Z70,OTHED012
          MOVE      Z70,OTHED013
          MOVE      Z70,OTHED014
          MOVE      Z70,OTHED015
          MOVE      Z70,OTHED016
          MOVE      Z70,OTHED017
          MOVE      Z70,OTHED018
          MOVE      Z70,OTHED019
          MOVE      Z70,OTHED020
          MOVE      Z70,OTHED021
          MOVE      Z70,OTHED022
          MOVE      Z70,OTHED023
          MOVE      Z70,OTHED024
          MOVE      Z70,OTHED025
          MOVE      Z70,OTHED026
          MOVE      Z70,OTHED027
          MOVE      Z70,OTHED028
          MOVE      Z70,OTHED029
          MOVE      Z70,OTHED030
          MOVE      Z70,OTHED031
          MOVE      Z70,OTHED032
          MOVE      Z70,OTHED033
          MOVE      Z70,OTHED034
          MOVE      Z70,OTHED035
          MOVE      Z70,OTHED036
          MOVE      Z70,OTHED037
          MOVE      Z70,OTHED038
          MOVE      Z70,OTHED039
          MOVE      Z70,OTHED040
          MOVE      Z70,OTHED041
          MOVE      Z70,OTHED042
          MOVE      Z70,OTHED043
          MOVE      Z70,OTHED044
          MOVE      Z70,OTHED045
          MOVE      Z70,OTHED046
          MOVE      Z70,OTHED047
          MOVE      Z70,OTHED048
          MOVE      Z70,OTHED049
          MOVE      Z70,OTHED050
          MOVE      Z70,OTHED051
          MOVE      Z70,OTHED052
          MOVE      Z70,OTHED053
.
CPOTHE99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for the outpatient template header
.------------------------------------------------------------
SPOTHE00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPOTHE01,SPOTHE02,SPOTHE03,SPOTHE04,SPOTHE05:
                       SPOTHE06,SPOTHE07,SPOTHE08,SPOTHE09,SPOTHE10:
                       SPOTHE11,SPOTHE12,SPOTHE13,SPOTHE14,SPOTHE15:
                       SPOTHE16,SPOTHE17,SPOTHE18,SPOTHE19,SPOTHE20:
                       SPOTHE21,SPOTHE22,SPOTHE23,SPOTHE24,SPOTHE25:
                       SPOTHE26,SPOTHE27,SPOTHE28,SPOTHE29,SPOTHE30:
                       SPOTHE31,SPOTHE32,SPOTHE33,SPOTHE34,SPOTHE35:
                       SPOTHE36,SPOTHE37,SPOTHE38,SPOTHE39,SPOTHE40:
                       SPOTHE41,SPOTHE42,SPOTHE43,SPOTHE44,SPOTHE45:
                       SPOTHE46,SPOTHE47,SPOTHE48,SPOTHE49,SPOTHE50:
                       SPOTHE51,SPOTHE52,SPOTHE53
.
          MOVE      ONE,EXIT
          GOTO      SPOTHE99
.
SPOTHE01  MOVE      QRYDATA,OTHED001
          PACK      OTHED001,OTHED001,SP70
          GOTO      SPOTHE99
.
SPOTHE02  MOVE      QRYDATA,OTHED002
          PACK      OTHED002,OTHED002,SP70
          GOTO      SPOTHE99
.
SPOTHE03  MOVE      QRYDATA,OTHED003
          PACK      OTHED003,OTHED003,SP70
          GOTO      SPOTHE99
.
SPOTHE04  MOVE      QRYDATA,OTHED004
          PACK      OTHED004,OTHED004,SP70
          GOTO      SPOTHE99
.
SPOTHE05  MOVE      QRYDATA,OTHED005
          PACK      OTHED005,OTHED005,SP70
          GOTO      SPOTHE99
.
SPOTHE06  PACK      QRYDATA,QRYDATA,SP30
          UNPACK    QRYDATA,KEY8,KEY3 * Check for formatted or unformatted date
          MATCH     SP70,KEY3
          IF        @EQUAL
            MOVE      QRYDATA,OTHED006 * Do not change date format = (CCYYMMDD)
          ELSE
            MOVE      QRYDATA,KEY11   * Change Date as format is (DD MON CCYY)
            PACK      KEY11,KEY11,SP70
            MATCH     SP70,KEY11
            IF        !@EQUAL
              UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
              CALL      SETMTH00
              PACK      OTHED006,CCENT,CYEAR,CMON,CDAY
              REP       " 0",OTHED006
            ENDIF
          ENDIF
          GOTO      SPOTHE99
.
SPOTHE07  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTHED007,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPOTHE99
.
SPOTHE08  MOVE      QRYDATA,OTHED008
          GOTO      SPOTHE99
.
SPOTHE09  MOVE      QRYDATA,OTHED009
          GOTO      SPOTHE99
.
SPOTHE10  MOVE      QRYDATA,OTHED010
          GOTO      SPOTHE99
.
SPOTHE11  MOVE      QRYDATA,OTHED011
          GOTO      SPOTHE99
.
SPOTHE12  MOVE      QRYDATA,OTHED012
          GOTO      SPOTHE99
.
SPOTHE13  MOVE      QRYDATA,OTHED013
          GOTO      SPOTHE99
.
SPOTHE14  MOVE      QRYDATA,OTHED014
          GOTO      SPOTHE99
.
SPOTHE15  MOVE      QRYDATA,OTHED015
          GOTO      SPOTHE99
.
SPOTHE16  MOVE      QRYDATA,OTHED016
          GOTO      SPOTHE99
.
SPOTHE17  MOVE      QRYDATA,OTHED017
          GOTO      SPOTHE99
.
SPOTHE18  MOVE      QRYDATA,OTHED018
          GOTO      SPOTHE99
.
SPOTHE19  MOVE      QRYDATA,OTHED019
          GOTO      SPOTHE99
.
SPOTHE20  MOVE      QRYDATA,OTHED020
          GOTO      SPOTHE99
.
SPOTHE21  MOVE      QRYDATA,OTHED021
          GOTO      SPOTHE99
.
SPOTHE22  MOVE      QRYDATA,OTHED022
          GOTO      SPOTHE99
.
SPOTHE23  MOVE      QRYDATA,OTHED023
          GOTO      SPOTHE99
.
SPOTHE24  MOVE      QRYDATA,OTHED024
          GOTO      SPOTHE99
.
SPOTHE25  MOVE      QRYDATA,OTHED025
          GOTO      SPOTHE99
.
SPOTHE26  MOVE      QRYDATA,OTHED026
          GOTO      SPOTHE99
.
SPOTHE27  MOVE      QRYDATA,OTHED027
          GOTO      SPOTHE99
.
SPOTHE28  MOVE      QRYDATA,OTHED028
          GOTO      SPOTHE99
.
SPOTHE29  MOVE      QRYDATA,OTHED029
          GOTO      SPOTHE99
.
SPOTHE30  MOVE      QRYDATA,OTHED030
          GOTO      SPOTHE99
.
SPOTHE31  MOVE      QRYDATA,OTHED031
          GOTO      SPOTHE99
.
SPOTHE32  MOVE      QRYDATA,OTHED032
          GOTO      SPOTHE99
.
SPOTHE33  MOVE      QRYDATA,OTHED033
          GOTO      SPOTHE99
.
SPOTHE34  MOVE      QRYDATA,OTHED034
          GOTO      SPOTHE99
.
SPOTHE35  MOVE      QRYDATA,OTHED035
          GOTO      SPOTHE99
.
SPOTHE36  MOVE      QRYDATA,OTHED036
          GOTO      SPOTHE99
.
SPOTHE37  MOVE      QRYDATA,OTHED037
          GOTO      SPOTHE99
.
SPOTHE38  MOVE      QRYDATA,OTHED038
          GOTO      SPOTHE99
.
SPOTHE39  MOVE      QRYDATA,OTHED039
          GOTO      SPOTHE99
.
SPOTHE40  MOVE      QRYDATA,OTHED040
          GOTO      SPOTHE99
.
SPOTHE41  MOVE      QRYDATA,OTHED041 
          GOTO      SPOTHE99
.
SPOTHE42  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OTHED042,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPOTHE99
.
SPOTHE43  MOVE      QRYDATA,OTHED043
          GOTO      SPOTHE99
.
SPOTHE44  MOVE      QRYDATA,OTHED044
          GOTO      SPOTHE99
.
SPOTHE45  MOVE      QRYDATA,OTHED045
          GOTO      SPOTHE99
.
SPOTHE46  MOVE      QRYDATA,OTHED046
          GOTO      SPOTHE99
.
SPOTHE47  MOVE      QRYDATA,OTHED047
          GOTO      SPOTHE99
.
SPOTHE48  MOVE      QRYDATA,OTHED048
          GOTO      SPOTHE99
.
SPOTHE49  MOVE      QRYDATA,OTHED049
          GOTO      SPOTHE99
.
SPOTHE50  MOVE      QRYDATA,OTHED050
          GOTO      SPOTHE99
.
SPOTHE51  MOVE      QRYDATA,OTHED051
          GOTO      SPOTHE99
.
SPOTHE52  MOVE      QRYDATA,OTHED052
          GOTO      SPOTHE99
.
SPOTHE53  MOVE      QRYDATA,OTHED053
          GOTO      SPOTHE99
.
SPOTHE99  RETURN
.
.------------------------------------------------------------
. Outpatient clinic master template
.------------------------------------------------------------
OHED0000  BRANCH    FLDITMNO,OHED0100,OHED0200,OHED0300,OHED0400,OHED0500:
                             OHED0600,OHED0700,OHED0800,OHED0900,OHED1000:
                             OHED1100,OHED1200,OHED1300,OHED1400,OHED1500:
                             OHED1600,OHED1700,OHED1800,OHED1900,OHED2000:
                             OHED2100,OHED2200,OHED2300,OHED2400,OHED2500:
                             OHED2600,OHED2700,OHED2800,OHED2900,OHED3000:
                             OHED3100,OHED3200,OHED3300,OHED3400,OHED3500:
                             OHED3600,OHED3700,OHED3800,OHED3900,OHED4000:
                             OHED4100,OHED4200,OHED4300,OHED4400,OHED4500:
                             OHED4600,OHED4700,OHED4800,OHED4900,OHED5000:
                             OHED5100,OHED5200,OHED5300,OHED5400,OHED5500:
                             OHED5600,OHED5700,OHED5800,OHED5900,OHED6000
.
          WRITE     HTMLFILE;"Invalid IBA Tag OHED0000";
          GOTO      OHED9999
.
OHED0100  WRITE     HTMLFILE;OTHESITE;
          GOTO      OHED9999
.
OHED0200  WRITE     HTMLFILE;OTHECLIN;
          GOTO      OHED9999
.
OHED0300  WRITE     HTMLFILE;OTHEWDAY;
          GOTO      OHED9999
.
OHED0400  WRITE     HTMLFILE;OTHESTRT;
          GOTO      OHED9999
.
OHED0500  WRITE     HTMLFILE;OTHESHNO;
          GOTO      OHED9999
.
OHED0600  WRITE     HTMLFILE;OTHESDAT;
          GOTO      OHED9999
.
OHED0700  MATCH     OTHEDTCC,SP70
          GOTO      OHED9999 IF EQUAL
.
          UNPACK    OTHEDTCC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR; 
          GOTO      OHED9999
.
OHED0800  WRITE     HTMLFILE;OTHECOM1;
          GOTO      OHED9999
.
OHED0900  WRITE     HTMLFILE;OTHECOM2;
          GOTO      OHED9999
.
OHED1000  WRITE     HTMLFILE;OTHEINS1;
          GOTO      OHED9999
.
OHED1100  WRITE     HTMLFILE;OTHEINS2;
          GOTO      OHED9999
.
OHED1200  WRITE     HTMLFILE;OTHEINS3;
          GOTO      OHED9999
.
OHED1300  WRITE     HTMLFILE;OTHEDURN;
          GOTO      OHED9999
.
OHED1400  WRITE     HTMLFILE;OTHEBFIN;
          GOTO      OHED9999
.
OHED1500  WRITE     HTMLFILE;OTHESEND;
          GOTO      OHED9999
.
OHED1600  MOVE      "CT",CATEGORY       * Location Type
          MOVE      OTHELTYP,CODE
          CALL      CODITM00 
          GOTO      OHED9999
.
OHED1700  WRITE     HTMLFILE;OTHECLSE;
          GOTO      OHED9999
.
OHED1800  WRITE     HTMLFILE;OTHEHOSP;
          GOTO      OHED9999
.
OHED1900  WRITE     HTMLFILE;OTHELOCN;      * MRT Location Code
          GOTO      OHED9999
.
OHED2000  CALL      HEDTYP00                * Clinic Type Selection
          GOTO      OHED9999
.
OHED2100  MOVE      "CI",CATEGORY           * Clinic Indicator M=MEDICAL
          MOVE      OTHECIND,CODE           *                  N=NON-MEDICAL
          CALL      CODITM00 
          GOTO      OHED9999
.
OHED2200  MATCH     SP70,OTHEWDAY         * Set Table Day of Week Display
          IF        !@EQUAL
            MOVE      ZERO,F1
            MOVE      OTHEWDAY,F1
            LOAD      DAYDESC,F1,MON,TUE,WED,THU,FRI,SAT,SUN
            WRITE     HTMLFILE;DAYDESC;   * Day Indicator
          ENDIF
          GOTO      OHED9999
.
OHED2300  MATCH     OTHESDAT,SP70
          GOTO      OHED9999 IF EQUAL
.
          UNPACK    OTHESDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OHED9999
.
OHED2400  PACK      KEY20,WBSESIT,OTHECLSE,Z70
          CALL      RDSCLIA1            * Formated Clinic Session Desc
          CALL      RDPCLIA1            * Formated Clinic Session Desc
          BRANCH    OVRCD,OHED2450
          MATCH     WBSESIT,OCASITE
          GOTO      OHED2450 IF NOT EQUAL
          MATCH     OTHECLSE,OCACLIN
          GOTO      OHED2450 IF NOT EQUAL
          CLEAR     DISPNAME
          WRITE     HTMLFILE;OCADESC;
          GOTO      OHED9999
.
OHED2450  PACK      KEY20,WBSESIT,OTHECLSE,SP70
          CALL      RDCLIA1            * Formated Clinic Session Desc
          BRANCH    OVRCD,OHED9999
.
          WRITE     HTMLFILE;OCADESC;
          GOTO      OHED9999
.
OHED2500  CALL      HDHSEL00                * Hospital Selection list
          GOTO      OHED9999
.
OHED2600  WRITE     HTMLFILE;OTHESHNO;
. 
          MATCH     OTHESDAT,SP70
          GOTO      OHED9999 IF EQUAL
.
          UNPACK    OTHESDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;" - ",CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
. 
          MATCH     OTHEDTCC,SP70
          GOTO      OHED9999 IF EQUAL
.
          UNPACK    OTHEDTCC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;" - ",CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OHED9999
.
OHED2700  CALL      CHOS0000           * Check if open sessions exist for this
          GOTO      OHED9999           * schdule number and date
.
OHED2800  WRITE     HTMLFILE;OTHEGBOK;
          GOTO      OHED9999
.
OHED2900  CALL      ARFT0000                * Allied Health Department
          GOTO      OHED9999
.
OHED3000  WRITE     HTMLFILE;OTHECENC;      * Collect Enc Details
          GOTO      OHED9999
.
OHED3100  WRITE     HTMLFILE;OTHEKDOC;      * Keyin HCP on attendance
          GOTO      OHED9999
.
OHED3200  UNPACK    DIM127,D1,KEY1,DIM127   * Default HCP
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OHED3210,OHED3220
          PACK      KEY10,OTHEDEFD,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,OHED9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      OHED9999
.         
OHED3210  WRITE     HTMLFILE;OTHEDEFD;
          GOTO      OHED9999
.
OHED3220  MATCH     SP70,OTHEDEFD
          GOTO      OHED9999 IF EQUAL
.
          PACK      KEY10,OTHEDEFD,SP70
          CALL      RDPMHCP1
          IF        OVRCD=1
            WRITE     HTMLFILE;ONE;         * Invalid Doctor
            GOTO      OHED9999
          ENDIF
.
          MATCH     "1",PMHCSTTS
          IF        @EQUAL
            WRITE     HTMLFILE;ONE;         * Inactive Doctor
            GOTO      OHED9999
          ENDIF
.
          WRITE     HTMLFILE;ZERO;          * Valid Doctor
          GOTO      OHED9999
.
OHED3300  WRITE     HTMLFILE;OTHECCAR;
          GOTO      OHED9999
.
OHED3400  WRITE     HTMLFILE;OTHECTRN;
          GOTO      OHED9999
.
OHED3500  WRITE     HTMLFILE;OTHENDPS;
          GOTO      OHED9999
.
OHED3600  WRITE     HTMLFILE;OTHECPMI;
          GOTO      OHED9999
.
OHED3700  WRITE     HTMLFILE;OTHECPAG;
          GOTO      OHED9999
.
OHED3800  WRITE     HTMLFILE;OTHECTEL;
          GOTO      OHED9999
.
OHED3900  MOVE      "NM",CATEGORY
          MOVE      OTHENMDS,CODE
          CALL      CODITM00 
          GOTO      OHED9999
.
OHED4000  MOVE      "CC",CATEGORY
          MOVE      OTHECART,CODE
          CALL      CODITM00 
          GOTO      OHED9999
.
OHED4100  MOVE      "sd",CATEGORY
          MOVE      OTHESRVD,CODE
          CALL      CODITM00 
          GOTO      OHED9999
.
OHED4200  WRITE     HTMLFILE;OTHECLHR;
          GOTO      OHED9999
.
OHED4300  WRITE     HTMLFILE;OTHEMLTD;
          GOTO      OHED9999
.
OHED4400  WRITE     HTMLFILE;OTHEXPUL;
          GOTO      OHED9999
.
OHED4500  WRITE     HTMLFILE;OTHEMREF;
          GOTO      OHED9999
.
OHED4600  WRITE     HTMLFILE;OTHEHPIO;
          GOTO      OHED9999
.
OHED4700  MOVE      "NC",CATEGORY
          MOVE      OTHETCOD,CODE
          CALL      CODITM00 
          GOTO      OHED9999
.
OHED4800  MATCH     OTHETCED,SP70
          GOTO      OHED9999 IF EQUAL
.
          UNPACK    OTHETCED,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OHED9999
.
OHED4900  WRITE     HTMLFILE;OTHEHCLI;
          GOTO      OHED9999
.
OHED5000  WRITE     HTMLFILE;OTHEHCAI;
          GOTO      OHED9999
.
OHED5100  WRITE     HTMLFILE;OTHEAOPN;      * Auto Open Clinic
          GOTO      OHED9999
.
OHED5200  WRITE     HTMLFILE;OTHEAOFR;      * Auto Open Frequency
          GOTO      OHED9999
.
OHED5300  WRITE     HTMLFILE;OTHEAOWM;      * Auto Open Week of Month 
          GOTO      OHED9999
.
OHED5400  WRITE     HTMLFILE;OTHEAAOW;      * Auto Open Number of Weeks in
          GOTO      OHED9999                * advance
.
OHED5500  MATCH     OTHEDATE,SP70           * Last Session Open Date
          GOTO      OHED9999 IF EQUAL
.
          UNPACK    OTHEDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OHED9999
.
OHED5600  WRITE     HTMLFILE;OTHEHCP1;      * Additional HCP 1
          GOTO      OHED9999
.
OHED5700  WRITE     HTMLFILE;OTHEHCP2;      * Additional HCP 2
          GOTO      OHED9999
.
OHED5800  WRITE     HTMLFILE;OTHEHCP3;      * Additional HCP 3
          GOTO      OHED9999
.
OHED5900  WRITE     HTMLFILE;OTHEHCP4;      * Additional HCP 4
          GOTO      OHED9999
.
OHED6000  WRITE     HTMLFILE;OTHEPCOD;      * Default Procedure
          GOTO      OHED9999
.
OHED9999  RETURN
.
.------------------------------------------------------------
. Moved cgi variables to file variables
.------------------------------------------------------------
MVOTHE00  MOVE      WBSESIT,OTHESITE
.
          MATCH     Z70,OTHED002
          IF        !@EQUAL
            MOVE      OTHED002,OTHECLIN
          ENDIF       
.
          MATCH     Z70,OTHED003
          IF        !@EQUAL
            MOVE      OTHED003,OTHEWDAY
          ENDIF       
.
          MATCH     Z70,OTHED004
          IF        !@EQUAL
            MOVE      OTHED004,OTHESTRT
          ENDIF       
.
          MATCH     Z70,OTHED005
          IF        !@EQUAL
            MOVE      OTHED005,OTHESHNO
          ENDIF       
.
          MATCH     Z70,OTHED006
          IF        !@EQUAL
            MOVE      OTHED006,OTHESDAT
          ENDIF       
.
          MATCH     Z70,OTHED007
          IF        !@EQUAL
            MOVE      OTHED007,OTHEDTCC
          ENDIF       
.
          MATCH     Z70,OTHED008
          IF        !@EQUAL
            MOVE      OTHED008,OTHECOM1
          ENDIF       
.
          MATCH     Z70,OTHED009
          IF        !@EQUAL
            MOVE      OTHED009,OTHECOM2
          ENDIF       
.
          MATCH     Z70,OTHED010
          IF        !@EQUAL
            MOVE      OTHED010,OTHEINS1
          ENDIF       
.
          MATCH     Z70,OTHED011
          IF        !@EQUAL
            MOVE      OTHED011,OTHEINS2
          ENDIF       
.
          MATCH     Z70,OTHED012
          IF        !@EQUAL
            MOVE      OTHED012,OTHEINS3
          ENDIF       
.
          MATCH     Z70,OTHED013
          IF        !@EQUAL
            MOVE      OTHED013,OTHEDURN
          ENDIF       
.
          MATCH     Z70,OTHED014
          IF        !@EQUAL
            MOVE      OTHED014,OTHEBFIN
          ENDIF       
.
          MATCH     Z70,OTHED015
          IF        !@EQUAL
            MOVE      OTHED015,OTHESEND
          ENDIF       
.
          MATCH     Z70,OTHED016
          IF        !@EQUAL
            MOVE      OTHED016,OTHELTYP
          ENDIF       
.
          MATCH     Z70,OTHED017
          IF        !@EQUAL
            MOVE      OTHED017,OTHECLSE
          ENDIF       
.
          MATCH     Z70,OTHED018
          IF        !@EQUAL
            MOVE      OTHED018,OTHEHOSP
          ENDIF       
.
          MATCH     Z70,OTHED019
          IF        !@EQUAL
            MOVE      OTHED019,OTHELOCN
          ENDIF       
.
          MATCH     Z70,OTHED020
          IF        !@EQUAL
            MOVE      OTHED020,OTHECTYP
          ENDIF       
.
          MATCH     Z70,OTHED021
          IF        !@EQUAL
            MOVE      OTHED021,OTHECIND
          ENDIF       
.
          MATCH     Z70,OTHED022
          IF        !@EQUAL
            MOVE      OTHED022,OTHEGBOK
          ENDIF       
.
          MATCH     Z70,OTHED023
          IF        !@EQUAL
            MOVE      OTHED023,OTHEADEP
          ENDIF       
.
          MATCH     Z70,OTHED024
          IF        !@EQUAL
            MOVE      OTHED024,OTHECENC
          ENDIF       
.
          MATCH     Z70,OTHED025
          IF        !@EQUAL
            MOVE      OTHED025,OTHEKDOC
          ENDIF       
.
          MATCH     Z70,OTHED026
          IF        !@EQUAL
            MOVE      OTHED026,OTHEDEFD
          ENDIF       
.
          MATCH     Z70,OTHED027
          IF        !@EQUAL
            MOVE      OTHED027,OTHECCAR
          ENDIF       
.
          MATCH     Z70,OTHED028
          IF        !@EQUAL
            MOVE      OTHED028,OTHECTRN
          ENDIF       
.
          MATCH     Z70,OTHED029
          IF        !@EQUAL
            MOVE      ZERO,F3
            SQUEEZE   OTHED029
            MOVE      OTHED029,F3
            MOVE      F3,OTHENDPS
            RESET     OTHED029
          ENDIF       
.
          MATCH     Z70,OTHED030
          IF        !@EQUAL
            MOVE      OTHED030,OTHECPMI
          ENDIF       
.
          MATCH     Z70,OTHED031
          IF        !@EQUAL
            MOVE      OTHED031,OTHECPAG
          ENDIF       
.
          MATCH     Z70,OTHED032
          IF        !@EQUAL
            MOVE      OTHED032,OTHECTEL
          ENDIF       
.
          MATCH     Z70,OTHED033
          IF        !@EQUAL
            MOVE      OTHED033,OTHENMDS
          ENDIF       
.
          MATCH     Z70,OTHED034
          IF        !@EQUAL
            MOVE      OTHED034,OTHECART
          ENDIF       
.
          MATCH     Z70,OTHED035
          IF        !@EQUAL
            MOVE      OTHED035,OTHESRVD
          ENDIF       
.
          MATCH     Z70,OTHED036
          IF        !@EQUAL
            MOVE      OTHED036,OTHECLHR
          ENDIF       
.
          MATCH     Z70,OTHED037
          IF        !@EQUAL
            MOVE      OTHED037,OTHEMLTD
          ENDIF       
.
          MATCH     Z70,OTHED038
          IF        !@EQUAL
            MOVE      OTHED038,OTHEXPUL
          ENDIF       
.
          MATCH     Z70,OTHED039
          IF        !@EQUAL
            MOVE      OTHED039,OTHEMREF
          ENDIF       
.
          MATCH     Z70,OTHED040
          IF        !@EQUAL
            MOVE      OTHED040,OTHEHPIO
          ENDIF       
.
          MATCH     Z70,OTHED041
          IF        !@EQUAL
            MOVE      OTHED041,OTHETCOD
          ENDIF       
.
          MATCH     Z70,OTHED042
          IF        !@EQUAL
            MOVE      OTHED042,OTHETCED
          ENDIF       
.
          MATCH     Z70,OTHED043
          IF        !@EQUAL
            MOVE      OTHED043,OTHEHCLI
          ENDIF       
.
          MATCH     Z70,OTHED044
          IF        !@EQUAL
            MOVE      OTHED044,OTHEHCAI
          ENDIF       
.
          MATCH     Z70,OTHED045
          IF        !@EQUAL
            MOVE      OTHED045,OTHEAOPN
          ENDIF       
.
          MATCH     Z70,OTHED046
          IF        !@EQUAL
            MOVE      OTHED046,OTHEAOFR
          ENDIF       
.
          MATCH     Z70,OTHED047
          IF        !@EQUAL
            MOVE      OTHED047,OTHEAOWM
          ENDIF       
.
          MATCH     Z70,OTHED048
          IF        !@EQUAL
            MOVE      OTHED048,OTHEAAOW
          ENDIF       
.
          MATCH     Z70,OTHED049
          IF        !@EQUAL
            MOVE      OTHED049,OTHEHCP1
          ENDIF       
.
          MATCH     Z70,OTHED050
          IF        !@EQUAL
            MOVE      OTHED050,OTHEHCP2
          ENDIF       
.
          MATCH     Z70,OTHED051
          IF        !@EQUAL
            MOVE      OTHED051,OTHEHCP3
          ENDIF       
.
          MATCH     Z70,OTHED052
          IF        !@EQUAL
            MOVE      OTHED052,OTHEHCP4
          ENDIF       
.
          MATCH     Z70,OTHED053
          IF        !@EQUAL
            MOVE      OTHED053,OTHEPCOD
          ENDIF       
.
MVOTHE99  RETURN
.
.------------------------------------------------------------
. Clinic Type Selection List
.------------------------------------------------------------
HEDTYP00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MATCH     SP70,OTHECTYP
          GOTO      HEDTYP20 IF EQUAL
.
          PACK      KEY12,WBSESIT,OTHECTYP
          CALL      RDCTYA1
          BRANCH    OVRCD,HEDTYP20
.
          BRANCH    F1,HEDTYP10,HEDTYP20
          CLEAR     DISPNAME
          PACK      NAME35,OCTDESC,SP70  * 0 = Description
          CALL      NAMSTR00             * Formatted
          RESET     DISPNAME
          MOVE      DISPNAME,KEY30
          WRITE     HTMLFILE;KEY30;
          GOTO      HEDTYP99
.
HEDTYP10  WRITE     HTMLFILE;OCTCTYP;
          GOTO      HEDTYP99
.
HEDTYP20  CALL      HCSL0000
.
HEDTYP99  RETURN
.
.------------------------------------------------------------
. Clinic Type Selection
.------------------------------------------------------------
HCSL0000  PACK      KEY12,WBSESIT,SP70
          CALL      RDSCTYA1
HCSL0100  CALL      RDKCTYA1
          BRANCH    OVRCD,HCSL9999
.
          MATCH     WBSESIT,OCTSITE
          GOTO      HCSL9999 IF NOT EQUAL
.
          MOVE      OCTDESC,KEY30
          PACK      KEY8,QUOTE,OCTCTYP,QUOTE
          MATCH     OTHECTYP,OCTCTYP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               KEY30,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY30,"</option>"
          ENDIF
          GOTO      HCSL0100
.
HCSL9999  RETURN
.------------------------------------------------------------
. Hospital Selection List
.------------------------------------------------------------
HDHSEL00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MATCH     SP70,OTHEHOSP
          GOTO      HDHSEL20 IF EQUAL
          PACK      KEY3,OTHEHOSP
          CALL      RDPTHSP1
          BRANCH    OVRCD,HDHSEL20
          BRANCH    F1,HDHSEL10,HDHSEL20
          WRITE     HTMLFILE;PTHSHOSP;
          GOTO      HDHSEL99
.
HDHSEL10  WRITE     HTMLFILE;PTHSNAME;
          GOTO      HDHSEL99
.
HDHSEL20  CALL      HHSL0000
.
HDHSEL99  RETURN
.------------------------------------------------------------
. Hospital Selection
.------------------------------------------------------------
HHSL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
HHSL0100  CALL      RKPTHSP1
          BRANCH    OVRCD,HHSL9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
.
          MATCH     OTHEHOSP,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            IF        IBCNMHOS=1
              PACK      KEY13,USERID,SP70            * All hospital access
              CALL      RDMLSEC1
              IF        OVRCD=1
                PACK      KEY13,USERID,PTHSHOSP,SP70 * This hospital access
                CALL      RDMLSEC1
                BRANCH    OVRCD,HHSL0100
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      HHSL0100
.
HHSL9999  RETURN
.
.----------------------------------------------------------------
.                         CHOS0000
. Check to see if we can delete this template header. If there are any sessions
. that have been opened we can not delete it. Called by OUTMAB00
. This will change the file position for outsesaf index 5
.----------------------------------------------------------------
CHOS0000  PACK      KEY36,OTHESITE,OTHECLIN,OTHEWDAY,OTHESTRT,OTHESHNO:
                          OTHESDAT,SP70
          CALL      RDSSESA5
          CALL      RDKSESA5
          BRANCH    OVRCD,CHOS9500
.
          MATCH     OTHESITE,OSESITE             * Same Site
          GOTO      CHOS9500 IF NOT EQUAL
.
          MATCH     OTHECLIN,OSECLIN             * Same Clinic
          GOTO      CHOS9500 IF NOT EQUAL
.
          MATCH     OTHEWDAY,DOSEDAY             * Same Day
          GOTO      CHOS9500 IF NOT EQUAL
.
          MATCH     OTHESTRT,OSESTRT             * Same Start Time
          GOTO      CHOS9500 IF NOT EQUAL
.
          MATCH     OTHESHNO,OSESSHNO            * Same Schedule
          GOTO      CHOS9500 IF NOT EQUAL
.
          MATCH     OTHESDAT,OSESSDAT            * Same Schedule Date
          GOTO      CHOS9500 IF NOT EQUAL
.
CHOS9000  WRITE     HTMLFILE;ONE;                * Yes there is open sessions
          GOTO      CHOS9999
.
CHOS9500  WRITE     HTMLFILE;ZERO;               * No there is open sessions
          GOTO      CHOS9999
.
CHOS9999  RETURN
