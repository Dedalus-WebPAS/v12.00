.------------------------------------------------------------
.  Modifications:                                                
.  V10.01.01 10/02/2011  Ebon Clements CAR 234598
.            Added PTDOAHC1 to PTDOAHC3
.  V9.09.02  11/12/2007  Ebon Clements CAR 143977
.            Added PTDODEAC - Accred. Expiry Date
.  V9.09.01  30/08/2007  Peter Vela    CAR 148637
.            Added PTDOEXML Exclude from Mailing List
.  V9.08.01  05/06/2007  Mike Laming   CAR 142039
.            Correct PTDOCOMT write HTML as Cat."CZ"
.  V9.05.01  15/03/2006  Ebon Clements  CAR 78533  
.            Added PTDOHOSS                            
. Add Field
.------------------------------------------------------------
DOCF0000  BRANCH    FLDITMNO,DOCF0100,DOCF0200,DOCF0300,DOCF0400,DOCF0500:
                             DOCF0600,DOCF0700,DOCF0800,DOCF0900,DOCF1000:
                             DOCF1100,DOCF1200,DOCF1300,DOCF1400,DOCF1500:
                             DOCF1600,DOCF1700,DOCF1800,DOCF1900,DOCF2000:
                             DOCF2100,DOCF2200,DOCF2300,DOCF2400,DOCF2500:
                             DOCF2600,DOCF2700,DOCF2800,DOCF2900,DOCF3000:
                             DOCF3100,DOCF3200,DOCF3300,DOCF3400,DOCF3500:
                             DOCF3600,DOCF3700,DOCF3800,DOCF3900,DOCF4000:
                             DOCF4100,DOCF4200,DOCF4300,DOCF4400,DOCF4500:
                             DOCF4600,DOCF4700,DOCF4800,DOCF4900,DOCF5000:
                             DOCF5100,DOCF5200,DOCF5300,DOCF5400,DOCF5500:
                             DOCF5600,DOCF5700,DOCF5800,DOCF5900,DOCF6000:
                             DOCF6100,DOCF6200,DOCF6300,DOCF6400,DOCF6500:
                             DOCF6600,DOCF6700,DOCF6800,DOCF6900,DOCF7000:
                             DOCF7100,DOCF7200,DOCF7300,DOCF7400,DOCF7500:
                             DOCF7600,DOCF7700,DOCF7800,DOCF7900,DOCF8000:
                             DOCF8100,DOCF8200,DOCF8300,DOCF8400,DOCF8500:
                             DOCF8600
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      DOCF9999
.
DOCF0100  REP       " +",DOCTCODE
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          WRITE     HTMLFILE;LINKPRG,".pbl?":
                             "&reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&doctcode=",DOCTCODE;
          REP       "+ ",DOCTCODE
          GOTO      DOCF9999
.
DOCF0200  CALL      DOCNAM00
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      DOCF9999
.
DOCF0300  WRITE     HTMLFILE;DCODE;
          GOTO      DOCF9999
.
DOCF0400  MATCH     SP70,DTITL 
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DTITL;
          GOTO      DOCF9999
.
DOCF0500  MATCH     SP70,DGNAME 
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DGNAME;
          GOTO      DOCF9999
.
DOCF0600  MATCH     SP70,DSNAME 
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DSNAME;
          GOTO      DOCF9999
.
DOCF0700  MATCH     SP70,DRNAME
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DRNAME;
          GOTO      DOCF9999
.
DOCF0800  MATCH     SP70,DSADD1
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DSADD1;
          GOTO      DOCF9999
.
DOCF0900  MATCH     SP70,DSADD2
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DSADD2;
          GOTO      DOCF9999
.
DOCF1000  MATCH     SP70,DSADD3
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DSADD3;
          GOTO      DOCF9999
.
DOCF1100  MATCH     SP70,DSADD4
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DSADD4;
          GOTO      DOCF9999
.
DOCF1200  MATCH     SP70,DSPOST
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DSPOST;
          GOTO      DOCF9999
.
DOCF1300  MATCH     SP70,DTELES
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DTELES;
          GOTO      DOCF9999
.
DOCF1400  MATCH     SP70,DTELEP
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DTELEP;
          GOTO      DOCF9999
.
DOCF1500  MATCH     SP70,DPAGER
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DPAGER;
          GOTO      DOCF9999
.
DOCF1600  MATCH     SP70,DASSOC1
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DASSOC1;
          GOTO      DOCF9999
DOCF1700  MATCH     SP70,DASSOC2
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DASSOC2;
          GOTO      DOCF9999
.
DOCF1800  MATCH     SP70,DPROV
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DPROV;
          GOTO      DOCF9999
.
DOCF1900  MATCH     SP70,DTELEH
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DTELEH;
          GOTO      DOCF9999
.
DOCF2000  MATCH     SP70,DHADD1
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DHADD1;
          GOTO      DOCF9999
.
DOCF2100  MATCH     SP70,DHADD2
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DHADD2;
          GOTO      DOCF9999
.
DOCF2200  MATCH     SP70,DHADD3
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DHADD3;
          GOTO      DOCF9999
.
DOCF2300  MATCH     SP70,DHADD4 
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DHADD4;
          GOTO      DOCF9999
.
DOCF2400  MATCH     SP70,DHPOST
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;DHPOST;
          GOTO      DOCF9999
.
DOCF2500  MATCH     SP70,DAFIRST
          GOTO      DOCF9999 IF EQUAL
. 
          UNPACK    DAFIRST,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF2600  MATCH     SP70,DALAST
          GOTO      DOCF9999 IF EQUAL
. 
          UNPACK    DALAST,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF2700  COMPARE   ZERO,DAYEARS 
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DAYEARS;
          GOTO      DOCF9999
.
DOCF2800  MOVE      "AT",CATEGORY
          MOVE      DACCRED,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF2900  MOVE      "DT",CATEGORY
          MOVE      DRTYPE,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF3000  MOVE      "DT",CATEGORY
          MOVE      DRTYPE2,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF3100  MOVE      "DT",CATEGORY
          MOVE      DRTYPE3,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF3200  MOVE      "DT",CATEGORY
          MOVE      DRTYPE4,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF3300  MOVE      "DT",CATEGORY
          MOVE      DRTYPE5,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF3400  MATCH     SP70,PTDONHSN
          GOTO      DOCF9999 IF EQUAL 
          WRITE     HTMLFILE;PTDONHSN;
          GOTO      DOCF9999
.
DOCF3500  MATCH     SP70,DBIRTH 
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    DBIRTH,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF3600  COMPARE   ZERO,DHCSCOD 
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DHCSCOD;
          GOTO      DOCF9999
.
DOCF3700  MOVE      "DL",CATEGORY
          MOVE      DALEVEL,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF3800  UNPACK    DIM127,D1,KEY1,DIM127     
          MATCH     "1",KEY1
          GOTO      DOCF3810 IF NOT EQUAL
          WRITE     HTMLFILE;DRSTAT;
          GOTO      DOCF9999
.          
DOCF3810  BRANCH    DRSTAT,DOCF3820,DOCF3830
          WRITE     HTMLFILE;"Active in Hospital";
          GOTO      DOCF9999
DOCF3820  WRITE     HTMLFILE;"Not Active";
          GOTO      DOCF9999
DOCF3830  WRITE     HTMLFILE;"Active Outside";
          GOTO      DOCF9999
.
DOCF3900  
.         MATCH     SP70,PTDOPAYN
.         GOTO      DOCF9999 IF EQUAL 
.         WRITE     HTMLFILE;PTDOPAYN;
          GOTO      DOCF9999
.
DOCF4000  REP       " +",DOCTCODE
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          WRITE     HTMLFILE;"onClick=#"ShowDoctor('":
                             LINKPRG,".pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                              "&doctcode=",DOCTCODE,"');#"";
          REP       "+ ",DOCTCODE
          GOTO      DOCF9999
.
DOCF4100  MATCH     SP70,PTDOFAXN
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOFAXN;
          GOTO      DOCF9999
.
DOCF4200  MATCH     SP70,PTDOMOBL
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOMOBL;
          GOTO      DOCF9999
.
DOCF4300  MATCH     SP70,PTDOGLCC
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOGLCC;
          GOTO      DOCF9999
.
DOCF4400  MATCH     SP70,PTDOWHDP
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOWHDP;
          GOTO      DOCF9999
.
DOCF4500  MATCH     SP70,PTDOMREG
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOMREG;
          GOTO      DOCF9999
.
DOCF4600  MATCH     SP70,DLUPDDTE
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DLUPDDTE;
          GOTO      DOCF9999
.
DOCF4700  MATCH     SP70,DLUPDTME
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DLUPDTME;
          GOTO      DOCF9999
.
DOCF4800  PACK      KEY16,DLUPDDTE,DLUPDTME
          WRITE     HTMLFILE;KEY16;
          GOTO      DOCF9999
.
DOCF4900  MATCH     SP70,PTDOSEML
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOSEML;
          GOTO      DOCF9999
.
DOCF5000  MATCH     SP70,DASSOC3
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DASSOC3;
          GOTO      DOCF9999
.
DOCF5100  MATCH     SP70,DASSOC4
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DASSOC4;
          GOTO      DOCF9999
.
DOCF5200  MATCH     SP70,DASSOC5
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;DASSOC5;
          GOTO      DOCF9999
.
DOCF5300  MATCH     SP70,PTDOHEML
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOHEML;
          GOTO      DOCF9999
.
DOCF5400  MATCH     SP70,PTDOHFAX
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOHFAX;
          GOTO      DOCF9999
.
DOCF5500  MOVE      "R5",CATEGORY
          MOVE      PTDOUDF1,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF5600  MOVE      "R6",CATEGORY
          MOVE      PTDOUDF2,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF5700  MOVE      "R7",CATEGORY
          MOVE      PTDOUDF3,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF5800  MOVE      "R8",CATEGORY
          MOVE      PTDOUDF4,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF5900  MOVE      "R9",CATEGORY
          MOVE      PTDOUDF5,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF6000  MATCH     SP70,PTDOINSC
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOINSC;
          GOTO      DOCF9999
.
DOCF6100  MATCH     SP70,PTDOINSN
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOINSN;
          GOTO      DOCF9999
.
DOCF6200  MATCH     SP70,PTDOINSF
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOINSF,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF6300  MATCH     SP70,PTDOINST
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOINST,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF6400  MATCH     SP70,PTDOREGN
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOREGN;
          GOTO      DOCF9999
.
DOCF6500  MATCH     SP70,PTDOREGF
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOREGF,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF6600  MATCH     SP70,PTDOREGT
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOREGT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF6700  MATCH     SP70,PTDOVISA
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOVISA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF6800  MOVE      "CZ",CATEGORY                                     *C-142039
          MOVE      PTDOCOMT,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF6900  MATCH     SP70,PTDOPREF
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOPREF;
          GOTO      DOCF9999
.
DOCF7000  MATCH     SP70,PTDOABNN
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOABNN;
          GOTO      DOCF9999
.
DOCF7100  MATCH     SP70,PTDODINA
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDODINA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF7200  MATCH     SP70,PTDODACT
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDODACT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF7300  MATCH     SP70,PTDODACO
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDODACO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF7400  MATCH     SP70,PTDOPRO2
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOPRO2;
          GOTO      DOCF9999
.
DOCF7500  MATCH     SP70,PTDOPRO3
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOPRO3;
          GOTO      DOCF9999
.
DOCF7600  MATCH     SP70,PTDOPRO4
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOPRO4;
          GOTO      DOCF9999
.
DOCF7700  MATCH     SP70,PTDOPRO5
          GOTO      DOCF9999 IF EQUAL
          WRITE     HTMLFILE;PTDOPRO5;
          GOTO      DOCF9999
.
DOCF7800  MATCH     SP70,PTDOSDAT
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOSDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF7900  MATCH     SP70,PTDOEDAT
          GOTO      DOCF9999 IF EQUAL
.
          UNPACK    PTDOEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      DOCF9999
.
DOCF8000  WRITE     HTMLFILE;PTDOAUPD;
          GOTO      DOCF9999
.
DOCF8100  WRITE     HTMLFILE;PTDOHOSS;
          GOTO      DOCF9999
.
DOCF8200  WRITE     HTMLFILE;PTDOEXML;
          GOTO      DOCF9999
.
DOCF8300  MATCH     SP70,PTDODEAC
          GOTO      DOCF9999 IF EQUAL
.         
          UNPACK    PTDODEAC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DOCF9999
.
DOCF8400  MOVE      "CZ",CATEGORY
          MOVE      PTDOAHC1,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF8500  MOVE      "CZ",CATEGORY
          MOVE      PTDOAHC2,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF8600  MOVE      "CZ",CATEGORY
          MOVE      PTDOAHC3,CODE
          CALL      CODITM00
          GOTO      DOCF9999
.
DOCF9999  RETURN
.------------------------------------------------------------
. Short Format Doctor Name in Title Text
.------------------------------------------------------------
DOCSNM00  CLEAR     DISPNAME
          MOVE      SP70,DOCFNAME
          PACK      NAME35,DTITL,SP70
          CALL      NAMSTR00
          MOVE      DGNAME,KEY1
          PACK      NAME35,KEY1,SP70
          CALL      NAMSTR00
          PACK      NAME35,DSNAME,SP70
          CALL      NAMSTR00
          APPEND    SP70,DISPNAME
          RESET     DISPNAME
          MOVE      DISPNAME,DOCFNAME
          STRIP     DOCFNAME
          RETURN
.------------------------------------------------------------
. Format Doctor Name in Title Text
.------------------------------------------------------------
DOCNAM00  CLEAR     DISPNAME
          MOVE      SP70,DOCFNAME
          PACK      NAME35,DTITL,SP70
          CALL      NAMSTR00
          PACK      NAME35,DGNAME,SP70
          CALL      DOCGIV00
          PACK      NAME35,DSNAME,SP70
          CALL      NAMSTR00
          APPEND    SP70,DISPNAME
          RESET     DISPNAME
          MOVE      DISPNAME,DOCFNAME
          STRIP     DOCFNAME
          RETURN
.-------------------------------------------------
. Format Doctors Given Name 
.-------------------------------------------------
DOCGIV00  CMATCH    SP1,NAME35               * Remove Leading Blanks
          IF        @EQUAL
            BUMP      NAME35
            GOTO      DOCGIV00 IF NOT EOS
            GOTO      DOCGIV99               * entire name if blank
          ENDIF
          PACK      KEY35,NAME35,SP30        * reset form pointer
          MOVE      KEY35,NAME35
.
          SCAN      SP1,NAME35             * Locate the blank
          GOTO      DOCGIV20 IF NOT EQUAL
          BUMP      NAME35,-1              * go back 1 to end of name
          MOVEFPTR  NAME35,CCITEM          * another handly form field
          RESET     NAME35                 * reset the form pointer
          SETLPTR   NAME35,CCITEM          * set logical length to end of name
.
.         Save this name
.
          UNPACK    NAME35,KEY1,KEY50
          REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNAME
          STRIP     KEY50
          APPEND    KEY50,DISPNAME
          APPEND    SP1,DISPNAME
.
.         Check for any more names
.
          SETLPTR   NAME35,35              * reset logical length
          ADD       ONE,CCITEM             * position of 1st blank
          RESET     NAME35,CCITEM          * reset to this point
          PACK      KEY35,NAME35,SP70      * reset form pointer
          MOVE      KEY35,NAME35

DOCGIV10  CMATCH    SP1,NAME35               * Remove Leading Blanks
          IF        @EQUAL
            BUMP      NAME35
            GOTO      DOCGIV10 IF NOT EOS
            GOTO      DOCGIV99               * entire name if blank
          ENDIF
          PACK      KEY35,NAME35,SP30        * reset form pointer
          MOVE      KEY35,NAME35
.
          SCAN      SP1,NAME35             * Locate the blank
          GOTO      DOCGIV20 IF NOT EQUAL
          BUMP      NAME35,-1              * go back 1 to end of name
          MOVEFPTR  NAME35,CCITEM          * another handly form field
          RESET     NAME35                 * reset the form pointer
          SETLPTR   NAME35,CCITEM          * set logical length to end of name
.
.         Save this Initial
.
          UNPACK    NAME35,KEY1,KEY50
          APPEND    KEY1,DISPNAME
          APPEND    SP1,DISPNAME
.
          GOTO      DOCGIV99
.
.         Rest of the string is one name
.
DOCGIV20  UNPACK    NAME35,KEY1,KEY50
          REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNAME
          STRIP     KEY50
          APPEND    KEY50,DISPNAME
          APPEND    SP1,DISPNAME
.
DOCGIV99  RETURN
.------------------------------------------------------------
. Get Doctor Details 
.------------------------------------------------------------
DOCDET00  UNPACK    DIM127,D1,FLDITEM,DIM127
          MOVE      FLDITEM,FLDITMNO
          MATCH     SP70,DOCTCODE
          GOTO      DOCDET90 IF EQUAL
          MOVE      DOCTCODE,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD,DOCDET90
          CALL      DOCF0000
          GOTO      DOCDET99
.
DOCDET90  CALL      DOCPAR00    * Get Rid of Parameters
.
DOCDET99  RETURN
.------------------------------------------------------------
. Get Rid of Parameters in Template
.------------------------------------------------------------
DOCPAR00  BRANCH    FLDITMNO,DOCPAR10,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99: *10
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99: *20
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR99,DOCPAR20,DOCPAR20,DOCPAR20: *30
                             DOCPAR20,DOCPAR20,DOCPAR20,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR20,DOCPAR99,DOCPAR99,DOCPAR10: *40
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99: 
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99: *50
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99: *60
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99: *70
                             DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99,DOCPAR99:
                             DOCPAR99,DOCPAR99
          GOTO      DOCPAR99
. Server Link
DOCPAR10  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          GOTO      DOCPAR99
. Code 0,1,2
DOCPAR20  UNPACK    DIM127,D1,ANS,DIM127
          GOTO      DOCPAR99
DOCPAR99  RETURN
.
