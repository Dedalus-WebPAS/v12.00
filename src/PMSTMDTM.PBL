. *----------------------------------------------------------------------
. * Include Name  :   PMSTMDTM.PBL
. *
. * Function      :   CGI variables for PMSTMDFD - pmstmdaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.02.01  04/07/2011  Davin         CAR 240723
.             Created include
.------------------------------------------------------------------------
.   Clear parameters for doctor unit/teams file
.------------------------------------------------------------------------
CPPMTM00  MOVE      Z70,PMTMD001
          MOVE      Z70,PMTMD002
          MOVE      Z70,PMTMD003
          MOVE      Z70,PMTMD004
          MOVE      Z70,PMTMD005
          MOVE      Z70,PMTMD006
          MOVE      Z70,PMTMD007
CPPMTM99  RETURN
.------------------------------------------------------------
. Tags for doctor unit/teams table
.------------------------------------------------------------
PMTM0000  BRANCH    FLDITMNO,PMTM0010,PMTM0020,PMTM0030,PMTM0040,PMTM0050:
                             PMTM0060,PMTM0070,PMTM0080,PMTM0090,PMTM0100:
                             PMTM0110,PMTM0120,PMTM0130
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMTM9999
.
PMTM0010  WRITE     HTMLFILE;PMTDDOCT;
          GOTO      PMTM9999
.
PMTM0020  WRITE     HTMLFILE;PMTDHOSP;
          GOTO      PMTM9999
.
PMTM0030  MOVE      "AC",CATEGORY
          MOVE      PMTDUNIT,CODE
          CALL      CODITM00
          GOTO      PMTM9999
.
PMTM0040  WRITE     HTMLFILE;PMTDTEAM;
          GOTO      PMTM9999
.
PMTM0050  WRITE     HTMLFILE;PMTDACTV;
          GOTO      PMTM9999
.
PMTM0060  WRITE     HTMLFILE;PMTDHEAD;
          GOTO      PMTM9999
.
PMTM0070  WRITE     HTMLFILE;PMTDPROV;
          GOTO      PMTM9999
.
PMTM0080  MATCH     SP70,PMTDCUID
          GOTO      PMTM9999 IF EQUAL
.
          PACK      KEY10,PMTDCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMTDCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMTM9999
.
PMTM0090  MATCH     PMTDCDAT,SP70
          GOTO      PMTM9999 IF EQUAL
.
          UNPACK    PMTDCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMTM9999
.
PMTM0100  WRITE     HTMLFILE;PMTDCTIM;
          GOTO      PMTM9999
.
PMTM0110  MATCH     SP70,PMTDUUID
          GOTO      PMTM9999 IF EQUAL
.
          PACK      KEY10,PMTDUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMTDUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMTM9999
.
PMTM0120  MATCH     PMTDUDAT,SP70
          GOTO      PMTM9999 IF EQUAL
.
          UNPACK    PMTDUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMTM9999
.
PMTM0130  WRITE     HTMLFILE;PMTDUTIM;
          GOTO      PMTM9999
.
PMTM9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for doctor unit/teams
.------------------------------------------------------------
SPPMU000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMU001,SPPMU002,SPPMU003,SPPMU004,SPPMU005:
                       SPPMU006,SPPMU007
.
          MOVE      ONE,EXIT
          GOTO      SPPMU999
.
SPPMU001  MOVE      QRYDATA,PMTMD001
          GOTO      SPPMU999
.
SPPMU002  MOVE      QRYDATA,PMTMD002
          GOTO      SPPMU999
.
SPPMU003  MOVE      QRYDATA,PMTMD003
          GOTO      SPPMU999
.
SPPMU004  MOVE      QRYDATA,PMTMD004
          GOTO      SPPMU999
.
SPPMU005  MOVE      QRYDATA,PMTMD005
          GOTO      SPPMU999
.
SPPMU006  MOVE      QRYDATA,PMTMD006
          GOTO      SPPMU999
.
SPPMU007  MOVE      QRYDATA,PMTMD007
          GOTO      SPPMU999
.
SPPMU999  RETURN
.
.------------------------------------------------------------
.  Update doctor unit/teams details
.------------------------------------------------------------
MVPMTM00  MATCH     PMTMD001,Z70
          IF        !@EQUAL
            MOVE      PMTMD001,PMTDDOCT
          ENDIF
.
          MATCH     PMTMD002,Z70
          IF        !@EQUAL
            MOVE      PMTMD002,PMTDHOSP
          ENDIF
.
          MATCH     PMTMD003,Z70
          IF        !@EQUAL
            MOVE      PMTMD003,PMTDUNIT
          ENDIF
.
          MATCH     PMTMD004,Z70
          IF        !@EQUAL
            MOVE      PMTMD004,PMTDTEAM
          ENDIF
.
          MATCH     "2",PMTMD005
          IF        @EQUAL
            MOVE      ZERO,PMTDACTV       * active
          ELSE
            MOVE      ONE,PMTDACTV        * not active
          ENDIF
.
          MATCH     "2",PMTMD006
          IF        @EQUAL
            MOVE      ONE,PMTDHEAD        * head of unit
          ELSE
            MOVE      ZERO,PMTDHEAD       * not head of unit
          ENDIF
.
          MATCH     PMTMD007,Z70
          IF        !@EQUAL
            MOVE      PMTMD007,PMTDPROV
          ENDIF
.
MVPMTM99  RETURN
+
