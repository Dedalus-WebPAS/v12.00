.***************************************************************************
.* System    :   Patient Management System                                 *
.* Program   :   DRGSTMNT                                                  *
.* Desc      :   Print DRG Statements                                      *
.***************************************************************************
.* Date      :   17/04/2003                                                *
.* Author    :   Tonii                                                     *
.* Function  :   Program to grab relevant information from various tables  *
.*               and print out a DRG statement                             *
.*                                                                         *
.* Modifications:                                                          *
.*    V11.05.01  17/03/2025  Davin          TSK 0956210                    *
.*               Add ICD10 Ed.13 - Go-live Date PTCNGDX3 (Sect.130 Pos.86) *
.*               Add test for DRG 12.0 at PROC0410                         *
.*    V11.02.02  20/04/2022  Davin          TSK 0917793                    *
.*               Add test for DRG 11.0 at PROC0410                         *
.*    V11.02.01  29/03/2022  Davin          TSK 0917793                    *
.*               Add ICD10 Ed.12 - Go-live Date PTCNGDX2 (Sect.128 Pos.231)*
.*    V11.00.02  23/09/2020  Ebon Clements  TSK 0893634                    *
.*               Added WIES27 functionality for 2020/2021                  *
.*    V11.00.01  23/09/2020  Ebon Clements   TSK 0893634                   *
.*               Added WIES27 functionality for 2020/2021                  *
.*    V10.14.02  26/08/2019  Davin           TSK 0880255                   *
.*               Added WIES26 functionality for 2019/2020                  *
.*    V10.14.01  27/02/2019  Richa Phogat    TSK 0870439                   *
.*               Add test for DRG 10.0 at PROC0410                         *
.*    V10.13.01  17/08/2018  Davin           TSK 0860935                   *
.*               Added WIES25 functionality for 2018/2019                  *
.*    V10.12.01  23/03/2018  Tracey Nguyen   TSK 0852793                   *
.*               Add test for DRG 9.0 at PROC0410                          *
.*    V10.11.01  15/08/2017  Davin           TSK 0842626                   *
.*               Added WIES24 functionality for 2017/2018                  *
.*    V10.10.01  08/03/2017  Davin           TSK 0833093     HDP 2017/2018 *
.*               Add ICD10 Ed.10 - Go-live Date PTCNGDVX (Sect.110 Pos.85) *
.*    V10.08.01  18/07/2016  Davin           TSK 0822753                   *
.*               Added WIES23 functionality for 2016/2017                  *
.*    V10.06.03  29/05/2015  Ebon Clements   CAR 317094                    *
.*               Add test for DRG 8.0 at PROC0410                          *
.*    V10.06.02  12/04/2016 J.Tan           CAR 304813                     *
.*               Added WIES 22                                             *
.*    V10.06.01  17/03/2015  Davin           CAR 311669      HDP 2015/2016 *
.*               Add ICD10 Ed.9 - Go-live Date PTCNGDV9 (Sect.110 Pos.77)  *
.*    V10.05.01  09/09/2014 Davin           CAR 296980                     *
.*               Added WIES 21                                             *
.*    V10.03.05  08/08/2013 Davin           CAR 284960                     *
.*               Added WIES 20                                             *
.*    V10.03.04  03/05/2013  Davin           CAR 284669 HDP 2013 DRG 7.0   *
.*               Added test for DRG 7.0 at PROC0410                        *
.*    V10.03.03  23/04/2013  Davin           CAR 284420      HDP 2013/2014 *
.*               Add ICD10 Ed.8 - Go-live Date PTCNGDV8 (Sect.110 Pos.69)  *
.*    V10.03.02  08/08/2012 Davin           CAR 270114                     *
.*               Added WIES 19                                             *
.*    V10.03.01  26/06/2012  Mike Laming      CAR 267797 HDP 2012 DRG 6.2  *
.*               Added test for DRG 6.2 at PROC0410                        *
.*    V10.02.02  11/08/2011 Davin           CAR 238236                     *
.*               Added WIES 18                                             *
.*    V10.02.01  28/03/2011  Mike Laming   CAR 240107                      *
.*               Mods to PATECDaf & PATECOaf variables & Keys              *
.*    V10.00.02  06/04/2010  Mike Laming     CAR 219246      HDP 2010      *
.*               Add ICD10 Ed.7 - Go-live Date PTCNGDV7 (Sect.110 Pos.61)  *
.*    V10.00.01  24/03/2010 Davin           CAR 216505                     *
.*               Added WIES 17                                             *
.*     V9.12.02  01/07/2009 Davin           CAR 199724                     *
.*               Added WIES 16                                             *
.*     V9.12.01  19/06/2009  Mike Laming      CAR 197814 HDP 2009 DRG 6.0  *
.*               Added test for DRG 6.0 at PROC0410                        *
.*    17/07/2008 Davin           CAR 163993                                *
.*               Added WIES 15                                             *
.*    20/03/2008 Mike Laming     CAR 163918   HDP 2008                     *
.*               Add PTCNGDRV5 ICD10 Ed.6 Go-live Date                     *
.*    14/01/2007 Ebon Clements   CAR 157297                                *
.*               Fixed printing of Diagnosis Code heading                  *
.*    01/08/2007 Steve Armstrong   CAR 145161                              *
.*               Removed all reference to WIES 10 - no longer supported.   *
.*    18/07/2007 Mike Laming     CAR 145161                                *
.*               Added WIES 14                                             *
.*    17/04/2007 Mike Laming     CAR 137125  HDP 2007 DRG 5.2              *
.*               Added DRG 5.1, WIES 13 and DRG 5.2 - rearranged code      *
.*               Added DRG Version to "patdgwaf" - field PTDWDRGV          *
.*    09/05/2006 Mike Laming     CAR 105244                                *
.*               Added 2006 ICD10 Ed5 Go-live Date PTCNGDV5 (using WIES 12)*
.*    26/07/2005 Peter Vela      CAR 66960                                 *
.*               Added 2005/2006 WIES12 file (patw12bf)                    *
.*    29/12/2003 Sylvek Litewka  CAR 20222                                 *
.*               Modified PROC0000 and PRNT0000 to use Descriptions for    *
.*               Disease and Operation codes from patecdaf and patecoaf    *
.*               instead of reading ICD10 files for default descriptions.  *
.*    23/12/2003 Pat Dirito      CAR 44742                                 *
.*               Added Calculation of Monetary Value for WIES on DRG       *
.*               Sylvek Litewka  CAR 44742                                 *
.*               Modified procedure PRNT0000 to right align columns        *
.*               containing numeric fields.                                *
.*    02/10/2003 Sylvek Litewka  CAR 42784                                 *
.*               Modified procedure PRNT0000 to highlight DRG diver codes  *
.*               by printing them in BOLD. The DRG driver indicator is no  *
.*               longer printed as character preceding the actual code.    *
.*    15/08/2003 Sylvek Litewka  CAR 20019                                 *
.*               Added "PCCL Value" filed.                                 *
.*                                                                         *
.***************************************************************************
.
.****************************************************************************
PRTDRGST  COMPARE   ZERO,NOCOPIES
          GOTO      PRTDRG99 IF EQUAL
.
          CALL      PROC0000
.
          CALL      OPNPRINT
.
          CALL      PRNT0000
.
          CALL      CLSPRINT
.
PRTDRG99  RETURN
.****************************************************************************
.  Read Appropriate files
.****************************************************************************
PROC0000  MOVE      ZERO,MONEWIES
          MOVE      ZERO,COUNTER
          REPEAT
            ADD       ONE,COUNTER
            PACK      DISARRAY[COUNTER],SP30,SP70
            PACK      OPRARRAY[COUNTER],SP30,SP70
          UNTIL     COUNTER>=99
.
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDMISS1
          BRANCH    OVRCD,PROC9000
.
          UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,ADMDATE
.
          PACK      CONSLTNT,UNKNOWN,SP30
          PACK      KEY6,ADOCTA
          CALL      RDDOCT1
          IF        OVRCD=0
            MOVE      DSNAME,PACSNAME
            MOVE      DGNAME,PACGNAME
            MOVE      DTITL,PACTITLE
            MOVE      ONE,PACFRMT
            CALL      PACNAME
            MOVE      PACFNAME,CONSLTNT
          ENDIF
.
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDVISA1
.
          PACK      KEY30,ADMISSNO,SP30
          CALL      RDSTRAN2
          CALL      RDKTRAN2
.
          MATCH     ADMISSNO,DTADMN
          GOTO      PROC0100 IF NOT EQUAL
.
          PACK      KEY5,ANSA,ANSC,TDEPT
          CALL      RDCODE1
          BRANCH    OVRCD,PROC0100
.
          MOVE      TDESC,UNIT          
.
PROC0100  PACK      KEY8,PVIURNO,SP70
          CALL      RDMAST1
          BRANCH    OVRCD,PROC0200
.
          MOVE      PURNO,URNUMBER
.
          MOVE      PSNAME,PACSNAME
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          MOVE      ONE,PACFRMT
.
          CALL      PACNAME                 * pack the patient's name
          MOVE      PACFNAME,FPATNAME 
.
PROC0200  PACK      KEY8,ADMISSNO,SP70
          CALL      RDDSCH1
          BRANCH    OVRCD,PROC0300
.
          UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DSCHDATE
          MOVE      PTDSDLOS,LOS
          MOVE      PTDSDWRD,DSCHWARD
.
          PACK      KEY6,PTDSDWRD,SP70
          CALL      RDWARD1
          MATCH     PTDSDWRD,WWARD
          IF        @EQUAL 
            MOVE      WBDESC,DSCWDDSC
          ENDIF
.
          MOVE      PTDSDDRG,DRGCODE
          PACK      KEY4,DRGCODE
          MOVE      "999",KEY3
          PACK      KEY7,KEY4,KEY3,SP10                               *I-137125
          CALL      RSPTDGW1                                          *C-137125
          CALL      RPPTDGW1
          IF        OVRCD=0
            MATCH     PTDWDRGC,KEY4
            IF        @EQUAL
              PACK      DRGDESC,PTDWDESC,SP30
            ENDIF
          ENDIF
.
          MOVE      PTDSVOGU,DRGVERSN
.
PROC0300  PACK      KEY8,ADMISSNO,SP70
          CALL      RDPTICU1
          BRANCH    OVRCD,PROC0400
.
          MOVE      PTICUCCU,CCUTIME
          MOVE      PTICUINT,ICUTIME
          MOVE      PTICUMEC,MECHVENT
.
PROC0400  MOVE      ONE,FORM2               * default to WIES 11
.
          MATCH     PTCNGDV4,DDATE          * check ICD Ed.4
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
          ENDIF
.
          MATCH     PTCNGDV5,DDATE          * check ICD Ed.5
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE                                *I-145161
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDV6,DDATE          * check ICD10 Ed.6        *I-163918
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDV7,DDATE          * check ICD10 Ed.7        *I-219246
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE                                
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDV8,DDATE          * check ICD10 Ed.8        *I-284420
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDV9,DDATE          * check ICD10 Ed.9        *I-311669
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDVX,DDATE          * check ICD10 Ed.10       *I-0833093
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDX1,DDATE          * check ICD10 Ed.11       *I-0869412
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDX2,DDATE          * check ICD10 Ed.12       *I-0917793
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
          MATCH     PTCNGDX3,DDATE          * check ICD10 Ed.13       *I-0956210
          IF        !@LESS
            MOVE      TWO,FORM2             * WIES 12
            MATCH     "20040701",DDATE
            IF        !@LESS
              MOVE      TWO,FORM2           * WIES 12
            ENDIF
            MATCH     "20060701",DDATE
            IF        !@LESS
              MOVE      THREE,FORM2         * WIES 13
            ENDIF
            MATCH     "20070701",DDATE
            IF        !@LESS
              MOVE      FOUR,FORM2          * WIES 14
            ENDIF
            MATCH     "20080701",DDATE
            IF        !@LESS
              MOVE      FIVE,FORM2          * WIES 15
            ENDIF
            MATCH     "20090701",DDATE
            IF        !@LESS
              MOVE      SIX,FORM2           * WIES 16
            ENDIF
            MATCH     "20100701",DDATE
            IF        !@LESS
              MOVE      SEVEN,FORM2         * WIES 17
            ENDIF
            MATCH     "20110701",DDATE
            IF        !@LESS
              MOVE      EIGHT,FORM2         * WIES 18
            ENDIF
            MATCH     "20120701",DDATE
            IF        !@LESS
              MOVE      NINE,FORM2          * WIES 19
            ENDIF
            MATCH     "20130701",DDATE
            IF        !@LESS
              MOVE      TEN,FORM2           * WIES 20
            ENDIF
            MATCH     "20140701",DDATE
            IF        !@LESS
              MOVE      TEN1,FORM2          * WIES 21
            ENDIF
            MATCH     "20150701",DDATE
            IF        !@LESS
              MOVE      TEN2,FORM2          * WIES 22
            ENDIF
            MATCH     "20160701",DDATE
            IF        !@LESS
              MOVE      TEN3,FORM2          * WIES 23
            ENDIF
            MATCH     "20170701",DDATE
            IF        !@LESS
              MOVE      TEN4,FORM2          * WIES 24
            ENDIF
            MATCH     "20180701",DDATE
            IF        !@LESS
              MOVE      TEN5,FORM2          * WIES 25
            ENDIF
            MATCH     "20190701",DDATE
            IF        !@LESS
              MOVE      TEN6,FORM2          * WIES 26
            ENDIF
            MATCH     "20200701",DDATE
            IF        !@LESS
              MOVE      TEN7,FORM2          * WIES 27
            ENDIF
          ENDIF
.
PROC0410  MOVE      SP1,KEY1                * check DRG Version in use
.
          MATCH     DRG120,PTCNDGPV         * DRG 12.0
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG110,PTCNDGPV         * DRG 11.0
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG100,PTCNDGPV         * DRG 10.0
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG090,PTCNDGPV         * DRG 9.0
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG080,PTCNDGPV         * DRG 8.0 
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG070,PTCNDGPV         * DRG 7.0                 *I-284669
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG062,PTCNDGPV         * DRG 6.2                 *I-267797
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG060,PTCNDGPV         * DRG 6.0                 *I-197814
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG052,PTCNDGPV         * DRG 5.2
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450:       * WIES 13
                            PROC0460:       * WIES 14
                            PROC0470:       * WIES 15
                            PROC0480:       * WIES 16
                            PROC0485:       * WIES 17
                            PROC0486:       * WIES 18
                            PROC0487:       * WIES 19
                            PROC0488:       * WIES 20
                            PROC0489:       * WIES 21
                            PROC0490:       * WIES 22
                            PROC0491:       * WIES 23
                            PROC0492:       * WIES 24
                            PROC0493:       * WIES 25
                            PROC0494:       * WIES 26
                            PROC0495        * WIES 27
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG051,PTCNDGPV         * DRG 5.1
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440:       * WIES 12
                            PROC0450        * WIES 13
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG050,PTCNDGPV         * DRG 5.0
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440        * WIES 12
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
          MATCH     DRG042,PTCNDGPV         * DRG 4.2
          IF        @EQUAL
            BRANCH    FORM2,PROC0430:       * WIES 11
                            PROC0440        * WIES 12
            GOTO      PROC0440              * default to WIES12
          ENDIF
.
.         ***********************************  WIES11
.
PROC0430  PACK      KEY4,DRGCODE
          CALL      RDPT111
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT11TODW,WGHTDAY
          MOVE      PT11LIBP,TRIMLOW
          MOVE      PT11HIBP,TRIMHIGH
          MOVE      PT11ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES12
.
PROC0440  PACK      KEY4,DRGCODE
          MATCH     "20050701",DDATE
          IF        !@LESS
            CALL      RDPT12B1
          ELSE
            CALL      RDPT121
          ENDIF
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT12TODW,WGHTDAY
          MOVE      PT12LIBP,TRIMLOW
          MOVE      PT12HIBP,TRIMHIGH
          MOVE      PT12ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES13
.
PROC0450  PACK      KEY4,DRGCODE                                      *I-137125
          CALL      RDPT131
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT13TODW,WGHTDAY
          MOVE      PT13LIBP,TRIMLOW
          MOVE      PT13HIBP,TRIMHIGH
          MOVE      PT13ILOS,TRMAVLOS
          GOTO      PROC0500
.           
.         ***********************************  WIES14
.         
PROC0460  PACK      KEY4,DRGCODE                                      *I-145161
          CALL      RDPT141
          BRANCH    OVRCD,PROC0500
.         
          MOVE      PT14TODW,WGHTDAY
          MOVE      PT14LIBP,TRIMLOW
          MOVE      PT14HIBP,TRIMHIGH
          MOVE      PT14ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES15
.
PROC0470  PACK      KEY4,DRGCODE
          CALL      RDPT151
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT15TODW,WGHTDAY
          MOVE      PT15LIBP,TRIMLOW
          MOVE      PT15HIBP,TRIMHIGH
          MOVE      PT15ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES16
.
PROC0480  PACK      KEY4,DRGCODE
          CALL      RDPT161
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT16TODW,WGHTDAY
          MOVE      PT16LIBP,TRIMLOW
          MOVE      PT16HIBP,TRIMHIGH
          MOVE      PT16ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES17
.
PROC0485  PACK      KEY4,DRGCODE
          CALL      RDPT171
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT17TODW,WGHTDAY
          MOVE      PT17LIBP,TRIMLOW
          MOVE      PT17HIBP,TRIMHIGH
          MOVE      PT17ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES18
.
PROC0486  PACK      KEY4,DRGCODE
          CALL      RDPT181
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT18TODW,WGHTDAY
          MOVE      PT18LIBP,TRIMLOW
          MOVE      PT18HIBP,TRIMHIGH
          MOVE      PT18ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES19
.
PROC0487  PACK      KEY4,DRGCODE
          CALL      RDPT191
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT19TODW,WGHTDAY
          MOVE      PT19LIBP,TRIMLOW
          MOVE      PT19HIBP,TRIMHIGH
          MOVE      PT19ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES20
.
PROC0488  PACK      KEY4,DRGCODE
          CALL      RDPT201
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT20TODW,WGHTDAY
          MOVE      PT20LIBP,TRIMLOW
          MOVE      PT20HIBP,TRIMHIGH
          MOVE      PT20ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES21
.
PROC0489  PACK      KEY4,DRGCODE
          CALL      RDPT211
          BRANCH    OVRCD,PROC0500
.
          MOVE      PT21TODW,WGHTDAY
          MOVE      PT21LIBP,TRIMLOW
          MOVE      PT21HIBP,TRIMHIGH
          MOVE      PT21ILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES22
.
PROC0490  MOVE      "022",PTWIVRSN
          PACK      KEY7,DRGCODE,PTWIVRSN
          CALL      RDPTWIE1
          BRANCH    OVRCD,PROC0500
.
          MOVE      PTWITODW,WGHTDAY
          MOVE      PTWILIBP,TRIMLOW
          MOVE      PTWIHIBP,TRIMHIGH
          MOVE      PTWIILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES23
.
PROC0491  MOVE      "023",PTWIVRSN
          PACK      KEY7,DRGCODE,PTWIVRSN
          CALL      RDPTWIE1
          BRANCH    OVRCD,PROC0500
.
          MOVE      PTWITODW,WGHTDAY
          MOVE      PTWILIBP,TRIMLOW
          MOVE      PTWIHIBP,TRIMHIGH
          MOVE      PTWIILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES24
.
PROC0492  MOVE      "024",PTWIVRSN
          PACK      KEY7,DRGCODE,PTWIVRSN
          CALL      RDPTWIE1
          BRANCH    OVRCD,PROC0500
.
          MOVE      PTWITODW,WGHTDAY
          MOVE      PTWILIBP,TRIMLOW
          MOVE      PTWIHIBP,TRIMHIGH
          MOVE      PTWIILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES25
.
PROC0493  MOVE      "025",PTWIVRSN
          PACK      KEY7,DRGCODE,PTWIVRSN
          CALL      RDPTWIE1
          BRANCH    OVRCD,PROC0500
.
          MOVE      PTWITODW,WGHTDAY
          MOVE      PTWILIBP,TRIMLOW
          MOVE      PTWIHIBP,TRIMHIGH
          MOVE      PTWIILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES26
.
PROC0494  MOVE      "026",PTWIVRSN
          PACK      KEY7,DRGCODE,PTWIVRSN
          CALL      RDPTWIE1
          BRANCH    OVRCD,PROC0500
.
          MOVE      PTWITODW,WGHTDAY
          MOVE      PTWILIBP,TRIMLOW
          MOVE      PTWIHIBP,TRIMHIGH
          MOVE      PTWIILOS,TRMAVLOS
          GOTO      PROC0500
.
.         ***********************************  WIES27
.
PROC0495  MOVE      "027",PTWIVRSN
          PACK      KEY7,DRGCODE,PTWIVRSN
          CALL      RDPTWIE1
          BRANCH    OVRCD,PROC0500
.
          MOVE      PTWITODW,WGHTDAY
          MOVE      PTWILIBP,TRIMLOW
          MOVE      PTWIHIBP,TRIMHIGH
          MOVE      PTWIILOS,TRMAVLOS
          GOTO      PROC0500
.
PROC0500  PACK      KEY13,ADMISSNO,SP1,ONE,DRGVERSN
          CALL      RDPTPGR1
          BRANCH    OVRCD,PROC0600
.
          MOVE      PTPGWWTU,WGHTALL
          MOVE      PTPGWTOL,WIESALL
          MOVE      PTPGPCCL,PCCLVAL
.
          CALL      MONWIE00     * Calculate Monetary Value for WIES on DRG
.
PROC0600  MOVE      ZERO,COUNTER
          PACK      KEY13,ADMISSNO,SP30
          CALL      RSPTECD1
PROC0650  CALL      RKPTECD1
          IF        OVRCD=1
            MOVE      COUNTER,DISCOUNT    * Number of Diagnosis code 
            GOTO      PROC0700
          ENDIF
.
          MATCH     DPTEDADM,ADMISSNO  
          IF        !@EQUAL
            MOVE      COUNTER,DISCOUNT      * Number of Diagnosis code
            GOTO      PROC0700
          ENDIF
.
          ADD       ONE,COUNTER
.
          PACK      KEY9,PTEDCODE,SP30
          PACK      DISARRAY[COUNTER],PTEDDRGD,KEY9,PTEDDESC,SP70
          COMPARE   "99",COUNTER
          GOTO      PROC0700 IF NOT LESS
          GOTO      PROC0650
.
PROC0700  MOVE      ZERO,COUNTER
          PACK      KEY13,ADMISSNO,SP30
          CALL      RSPTECO1
PROC0750  CALL      RKPTECO1
          IF        OVRCD=1
            MOVE      COUNTER,OPRCOUNT      * Number of Operation codes
            GOTO      PROC9999
          ENDIF
.
          MATCH     DPTEOADM,ADMISSNO  
          IF        !@EQUAL
            MOVE      COUNTER,OPRCOUNT      * Number of Operation codes
            GOTO      PROC9999
          ENDIF
.
          ADD       ONE,COUNTER
          PACK      KEY9,PTEOCODE,SP30
          PACK      OPRARRAY[COUNTER],KEY9,PTEODESC,SP70
          COMPARE   "99",COUNTER
          GOTO      PROC9999 IF NOT LESS
          GOTO      PROC0750
.
PROC9000  DISPLAY   *P1:24,*EL,"Admission Number does not exist!";
          CALL      HITENTER
.
PROC9999  RETURN
.****************************************************************************
.                 Calculate Monetary Value for WIES on DRG
.
.                         INPUTS: DDATE, PTPGWTOL
.                            OUTPUT: MONEWIES
.****************************************************************************
MONWIE00  PACK      KEY8,DDATE,SP70
          CALL      RDPMWD1
          BRANCH    OVRCD,MONWIE11
.
          GOTO      MONWIE20     * Record found calculate.
.
MONWIE11  PACK      KEY8,DDATE,SP70   * Locate Effective Period
          CALL      RSPMWD1
          CALL      RPPMWD1
          BRANCH    OVRCD,MONWIE99
.
MONWIE20  ASSIGN    PTPGWTOL*PMWDVALU,MONEWIES
          GOTO      MONWIE99
.
MONWIE99  RETURN
+
.****************************************************************************
.*                                PRNT0000                                  *
.*                           Print DRG Statement                            *
.****************************************************************************
PRNT0000  PRINT     *N,*1,CNAME,*65,"Date: ",CURRDATE:
                    *N,*33,*V2LON,"DRG Statement",*HOFF:
                    *N:
                    *N,*1,"Unit:",*10,UNIT:
                       *40,"Consultant:",*52,CONSLTNT:
                    *N:
                    *N,*1,"Patient Name:",*15,FPATNAME:
                       *40,"U/R Number:",*52,URNUMBER:
                    *N:
                    *N,*1,"Admission Date:",*17,ADMDATE:
                       *33,"Discharge Date:",*49,DSCHDATE:
                       *63,"LOS: ",LOS," days" 
.
          COMPARE   ONE,CUSTFLAG     * Custome site flag 1=RCH
          IF        @EQUAL 
            PRINT     *N,*53,"Neonatal Time:",*69,CCUTIME," hrs"
          ELSE
            PRINT     *N,*56,"CCU Time  :",*69,CCUTIME," hrs"
          ENDIF
.
          PRINT     *N,*56,"ICU Time  :",*69,ICUTIME," hrs":
                    *N,*56,"Mech. Vent:",*69,MECHVENT," hrs":
                    *N:
                    *N,*1,"Discharge Ward:",*18,DSCHWARD,*23,DSCWDDSC:
                    *N:
                    *N,*1,"DRG:",*10,DRGCODE,*16,DRGDESC:
                    *N:
                    *N,*1,"Weights:",*14,"All :",*21,WGHTALL:
                       *40,"Day:",*64,WGHTDAY:
                    *N:
                    *N,*1,"Trim points:",*14,"Low :",*29,TRIMLOW:
                    *N,*14,"High:",*29,TRIMHIGH:
                       *40,"Inlier Avg LOS:",*62,TRMAVLOS:
                    *N:
...                    *N,*1,"Chargeable Patient IES: xxxxxxx":
                    *N,*40,"WIES(All):",*52,WIESALL:
                    *N,*40,"PCCL Value:",*68,PCCLVAL:
                    *N,*40,"$Value:",*59,MONEWIES:
                    *N,*N:
                    *N,*ULON,"Diagnosis Codes"
.
PRNT1000  MOVE      ONE,COUNTER
          REPEAT  
            UNPACK    DISARRAY[COUNTER],DRGDRVER,DISCODE,DISDESC
            MATCH     "1",DRGDRVER
            IF        @EQUAL
              PRINT     *1,*V2LON,DISCODE,*HOFF,*12,DISDESC
            ELSE
              PRINT     *1,DISCODE,*12,DISDESC
            ENDIF
            ADD       ONE,COUNTER
          UNTIL     COUNTER>DISCOUNT 
.
          MOVE      ONE,COUNTER
          REPEAT
            UNPACK    OPRARRAY[COUNTER],OPRCODE,OPRDESC
            PRINT     *1,OPRCODE,*12,OPRDESC
            ADD       ONE,COUNTER
          UNTIL     COUNTER>OPRCOUNT 
.
PRNT9999  RETURN
