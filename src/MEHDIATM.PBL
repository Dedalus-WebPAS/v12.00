.----------------------------------------------------------------------
. Program       : MEHDIATM     (was MEHVISTM)
.
. Function      : Output Mental Health Diagnosis Variables           
.
. Modifications :
.----------------------------------------------------------------------
.  V10.14.01  12/06/2019  Tracey Nguyen   TSK 0856503
.             Added ICD10 Diagnosis type 1 to 6 - MHDIDTY1 to MHDIDTY6
.  V10.03.01  02/10/2013  Patrick Adair   CAR 265798
.             Corrected non-standard HTMLFIlE write statements on all date fields
.  V10.00.02  12/08/2010  Mike Laming  CAR 228152
.             Mods to MVDIA000 to set MHDICHNG "change flag" if data changes
.  V10.00.01  26/03/2010  Mike Laming  CAR 217575
.             Add new MH Diagnosis fields - HCP Code & Case Team Code
.   V9.12.01  03/12/2009  Mike Laming  CAR 195158
.             Add new MH Diagnosis fields - extra Diag. fields & Axis fields
.   V9.10.01  04/06/2008 Jill Habasque CAR 155001
.             Changed MHDIX4CD to xa (from XA) and MHDIX5CD to xb (from XB)
.   V9.09.01  18/03/2008 J.Tan    CAR 156964 
.             Added Axis III
.   V9.02.00  14/10/2002 Katie Nelson - Created
.----------------------------------------------------------------------
.
.
.------------------------------------------------------------
. Visit Details 
.------------------------------------------------------------
MHDI0000  BRANCH    FLDITMNO,MHDI0100,MHDI0200,MHDI0300,MHDI0400,MHDI0500:
                             MHDI0600,MHDI0700,MHDI0800,MHDI0900,MHDI1000:
                             MHDI1100,MHDI1200,MHDI1300,MHDI1400,MHDI1500:
                             MHDI1600,MHDI1700,MHDI1800,MHDI1900,MHDI2000:
                             MHDI2100,MHDI2200,MHDI2300,MHDI2400,MHDI2500:
                             MHDI2600,MHDI2700,MHDI2800,MHDI2900,MHDI3000:
                             MHDI3100,MHDI3200,MHDI3300,MHDI3400,MHDI3500:
                             MHDI3600,MHDI3700,MHDI3800,MHDI3900,MHDI4000:
                             MHDI4100,MHDI4200,MHDI4300,MHDI4400,MHDI4500:
                             MHDI4600,MHDI4700,MHDI4800,MHDI4900,MHDI5000:
                             MHDI5100,MHDI5200,MHDI5300,MHDI5400,MHDI5500:
                             MHDI5600,MHDI5700,MHDI5800,MHDI5900,MHDI6000:
                             MHDI6100,MHDI6200,MHDI6300,MHDI6400,MHDI6500
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      MHDI9999
.
MHDI0100  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          WRITE     HTMLFILE;LINKPRG,".pbl?":
                             "&reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&urnumber=",URNUMBER:
                             "&admissno=",ADMISSNO;
          GOTO      MHDI9999
.
MHDI0200  WRITE     HTMLFILE;MHDIADMN;
          GOTO      MHDI9999
.
MHDI0300  MATCH     MHDIDATE,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI0400  WRITE     HTMLFILE;MHDIICD1;
          GOTO      MHDI9999
.
MHDI0500  WRITE     HTMLFILE;MHDIDES1; 
          GOTO      MHDI9999
.
MHDI0600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI0610
          WRITE     HTMLFILE;MHDISUP1;
          GOTO      MHDI9999
.
MHDI0610  COMPARE   ONE,MHDISUP1
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDISUP1
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDI9999
.
MHDI0700  MATCH     MHDIDAT1,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDAT1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI0800  WRITE     HTMLFILE;MHDIICD2;  
          GOTO      MHDI9999
.
MHDI0900  WRITE     HTMLFILE;MHDIDES2;  
          GOTO      MHDI9999
.
MHDI1000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI1010
          WRITE     HTMLFILE;MHDISUP2;
          GOTO      MHDI9999
.
MHDI1010  COMPARE   ONE,MHDISUP2
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDISUP2
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDI9999
.
MHDI1100  MATCH     MHDIDAT2,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDAT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI1200  WRITE     HTMLFILE;MHDIX1CA;  
          GOTO      MHDI9999
.
MHDI1300  WRITE     HTMLFILE;MHDIX1CB;  
          GOTO      MHDI9999
.
MHDI1400  WRITE     HTMLFILE;MHDIX1CC;  
          GOTO      MHDI9999
.
MHDI1500  WRITE     HTMLFILE;MHDIX1DA;  
          GOTO      MHDI9999
.
MHDI1600  WRITE     HTMLFILE;MHDIX1DB;  
          GOTO      MHDI9999
.
MHDI1700  WRITE     HTMLFILE;MHDIX1DC;  
          GOTO      MHDI9999
.
MHDI1800  WRITE     HTMLFILE;MHDIX2CA;  
          GOTO      MHDI9999
.
MHDI1900  WRITE     HTMLFILE;MHDIX2CB;  
          GOTO      MHDI9999
.
MHDI2000  WRITE     HTMLFILE;MHDIX2CC;  
          GOTO      MHDI9999
.
MHDI2100  WRITE     HTMLFILE;MHDIX2DA;  
          GOTO      MHDI9999
.
MHDI2200  WRITE     HTMLFILE;MHDIX2DB;  
          GOTO      MHDI9999
.
MHDI2300  WRITE     HTMLFILE;MHDIX2DC;  
          GOTO      MHDI9999
.
MHDI2400  WRITE     HTMLFILE;MHDIX3DS;  
          GOTO      MHDI9999
.
MHDI2500  MOVE      "xa",CATEGORY
          PACK      CODE,MHDIX4CD,SP70
          CALL      CODITM00
          GOTO      MHDI9999
.
MHDI2600  MOVE      "xb",CATEGORY
          PACK      CODE,MHDIX5CD,SP70
          CALL      CODITM00
          GOTO      MHDI9999
.
MHDI2700  MATCH     MHDIXDAT,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIXDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI2800  WRITE     HTMLFILE;MHDIOPER;  
          GOTO      MHDI9999
.
MHDI2900  WRITE     HTMLFILE;MHDIAXIV;  
          GOTO      MHDI9999
.
MHDI3000  WRITE     HTMLFILE;MHDIX3CA;  
          GOTO      MHDI9999
.
MHDI3100  WRITE     HTMLFILE;MHDIX3CB;  
          GOTO      MHDI9999
.
MHDI3200  WRITE     HTMLFILE;MHDIX3CC;  
          GOTO      MHDI9999
.
MHDI3300  WRITE     HTMLFILE;MHDIX3DA;  
          GOTO      MHDI9999
.
MHDI3400  WRITE     HTMLFILE;MHDIX3DB;  
          GOTO      MHDI9999
.
MHDI3500  WRITE     HTMLFILE;MHDIX3DC;  
          GOTO      MHDI9999
.
MHDI3600  WRITE     HTMLFILE;MHDIICD3;
          GOTO      MHDI9999
.
MHDI3700  WRITE     HTMLFILE;MHDIDES3;
          GOTO      MHDI9999
.
MHDI3800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI3810
          WRITE     HTMLFILE;MHDISUP3;
          GOTO      MHDI9999
.
MHDI3810  COMPARE   ONE,MHDISUP3
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDISUP3
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDI9999
.
MHDI3900  PACK      KEY8,MHDIDAT3,SP70
          MATCH     KEY8,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDAT3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI4000  WRITE     HTMLFILE;MHDIICD4;
          GOTO      MHDI9999
.
MHDI4100  WRITE     HTMLFILE;MHDIDES4;
          GOTO      MHDI9999
.
MHDI4200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI4210
          WRITE     HTMLFILE;MHDISUP4;
          GOTO      MHDI9999
.
MHDI4210  COMPARE   ONE,MHDISUP4
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDISUP4
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDI9999
.
MHDI4300  PACK      KEY8,MHDIDAT4,SP70
          MATCH     KEY8,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDAT4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI4400  WRITE     HTMLFILE;MHDIICD5;
          GOTO      MHDI9999
.
MHDI4500  WRITE     HTMLFILE;MHDIDES5;
          GOTO      MHDI9999
.
MHDI4600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI4610
          WRITE     HTMLFILE;MHDISUP5;
          GOTO      MHDI9999
.
MHDI4610  COMPARE   ONE,MHDISUP5
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDISUP5
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDI9999
.
MHDI4700  PACK      KEY8,MHDIDAT5,SP70
          MATCH     KEY8,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDAT5,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI4800  WRITE     HTMLFILE;MHDIICD6;
          GOTO      MHDI9999
.
MHDI4900  WRITE     HTMLFILE;MHDIDES6;
          GOTO      MHDI9999
.
MHDI5000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI5010
          WRITE     HTMLFILE;MHDISUP6;
          GOTO      MHDI9999
.
MHDI5010  COMPARE   ONE,MHDISUP6
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDISUP6
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDI9999
.
MHDI5100  PACK      KEY8,MHDIDAT6,SP70
          MATCH     KEY8,SP70
          GOTO      MHDI9999 IF EQUAL
          UNPACK    MHDIDAT6,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      MHDI9999
.
MHDI5200  WRITE     HTMLFILE;MHDIP1CA;
          GOTO      MHDI9999
.
MHDI5300  WRITE     HTMLFILE;MHDIP1CB;
          GOTO      MHDI9999
.
MHDI5400  WRITE     HTMLFILE;MHDIP1CC;
          GOTO      MHDI9999
.
MHDI5500  WRITE     HTMLFILE;MHDIP2CA;
          GOTO      MHDI9999
.
MHDI5600  WRITE     HTMLFILE;MHDIP2CB;
          GOTO      MHDI9999
.
MHDI5700  WRITE     HTMLFILE;MHDIP2CC;
          GOTO      MHDI9999
.
MHDI5800  UNPACK    DIM127,D1,KEY1,DIM127        * HCP Code           *I-195158
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI5810
          PACK      KEY10,MHDIHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,MHDI9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      MHDI9999
.
MHDI5810  WRITE     HTMLFILE;MHDIHCPC;
          GOTO      MHDI9999
.
MHDI5900  UNPACK    DIM127,D1,KEY1,DIM127   * Case Team (linked to Respon.Clin)
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDI5910
.
          MOVE      "Unknown Case Team",ALCADESC
          PACK      KEY10,MHDICAST,SP10
          CALL      RDALCAS1
          WRITE     HTMLFILE;ALCADESC;
          GOTO      MHDI9999
.
MHDI5910  WRITE     HTMLFILE;MHDICAST;
          GOTO      MHDI9999
.
MHDI6000  WRITE     HTMLFILE;MHDIDTY1;
          GOTO      MHDI9999
.
MHDI6100  WRITE     HTMLFILE;MHDIDTY2;
          GOTO      MHDI9999
.
MHDI6200  WRITE     HTMLFILE;MHDIDTY3;
          GOTO      MHDI9999
.
MHDI6300  WRITE     HTMLFILE;MHDIDTY4;
          GOTO      MHDI9999
.
MHDI6400  WRITE     HTMLFILE;MHDIDTY5;
          GOTO      MHDI9999
.
MHDI6500  WRITE     HTMLFILE;MHDIDTY6;
          GOTO      MHDI9999
.
MHDI9999  RETURN
+
.------------------------------------------------------------
. Clear cgi variables
.------------------------------------------------------------
CLRMDI00  MOVE      Z70,MEHDI001
          MOVE      Z70,MEHDI002
          MOVE      Z70,MEHDI003
          MOVE      Z70,MEHDI004
          MOVE      ZERO,MEHDI005
          MOVE      Z70,MEHDI006
          MOVE      Z70,MEHDI007
          MOVE      Z70,MEHDI008
          MOVE      ZERO,MEHDI009
          MOVE      Z70,MEHDI010
          MOVE      Z70,MEHDI011
          MOVE      Z70,MEHDI012
          MOVE      Z70,MEHDI013
          MOVE      Z70,MEHDI014
          MOVE      Z70,MEHDI015
          MOVE      Z70,MEHDI016
          MOVE      Z70,MEHDI017
          MOVE      Z70,MEHDI018
          MOVE      Z70,MEHDI019
          MOVE      Z70,MEHDI020
          MOVE      Z70,MEHDI021
          MOVE      Z70,MEHDI022
          MOVE      Z70,MEHDI023
          MOVE      Z70,MEHDI024
          MOVE      Z70,MEHDI025
          MOVE      Z70,MEHDI026
          MOVE      Z70,MEHDI027
          MOVE      Z70,MEHDI028
          MOVE      Z70,MEHDI029
          MOVE      Z70,MEHDI030
          MOVE      Z70,MEHDI031
          MOVE      Z70,MEHDI032
          MOVE      Z70,MEHDI033
          MOVE      Z70,MEHDI034
          MOVE      Z70,MEHDI035
          MOVE      Z70,MEHDI036
          MOVE      ZERO,MEHDI037
          MOVE      Z70,MEHDI038
          MOVE      Z70,MEHDI039
          MOVE      Z70,MEHDI040
          MOVE      ZERO,MEHDI041
          MOVE      Z70,MEHDI042
          MOVE      Z70,MEHDI043
          MOVE      Z70,MEHDI044
          MOVE      ZERO,MEHDI045
          MOVE      Z70,MEHDI046
          MOVE      Z70,MEHDI047
          MOVE      Z70,MEHDI048
          MOVE      ZERO,MEHDI049
          MOVE      Z70,MEHDI050
          MOVE      Z70,MEHDI051
          MOVE      Z70,MEHDI052
          MOVE      Z70,MEHDI053
          MOVE      Z70,MEHDI054
          MOVE      Z70,MEHDI055
          MOVE      Z70,MEHDI056
          MOVE      Z70,MEHDI057
          MOVE      Z70,MEHDI058
          MOVE      Z70,MEHDI059
          MOVE      Z70,MEHDI060
          MOVE      Z70,MEHDI061
          MOVE      Z70,MEHDI062
          MOVE      Z70,MEHDI063
          MOVE      Z70,MEHDI064
.
CLRMDI99  RETURN
+
.------------------------------------------------------------
.   Set Parameters for mental health  visit table
.------------------------------------------------------------
SETMDI00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
.
          BRANCH    F3,SETMDI01,SETMDI02,SETMDI03,SETMDI04,SETMDI05:
                       SETMDI06,SETMDI07,SETMDI08,SETMDI09,SETMDI10:
                       SETMDI11,SETMDI12,SETMDI13,SETMDI14,SETMDI15:
                       SETMDI16,SETMDI17,SETMDI18,SETMDI19,SETMDI20:
                       SETMDI21,SETMDI22,SETMDI23,SETMDI24,SETMDI25:
                       SETMDI26,SETMDI27,SETMDI28,SETMDI29,SETMDI30:
                       SETMDI31,SETMDI32,SETMDI33,SETMDI34,SETMDI35:
                       SETMDI36,SETMDI37,SETMDI38,SETMDI39,SETMDI40:
                       SETMDI41,SETMDI42,SETMDI43,SETMDI44,SETMDI45:
                       SETMDI46,SETMDI47,SETMDI48,SETMDI49,SETMDI50:
                       SETMDI51,SETMDI52,SETMDI53,SETMDI54,SETMDI55:
                       SETMDI56,SETMDI57,SETMDI58,SETMDI59,SETMDI60:
                       SETMDI61,SETMDI62,SETMDI63,SETMDI64
.
          MOVE      ONE,EXIT
          GOTO      SETMDI99
.
SETMDI01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,MEHDI001
          PACK      MEHDI001,MEHDI001,SP70
          GOTO      SETMDI99
.
SETMDI02  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI002,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI03  PACK      MEHDI003,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI04  PACK      MEHDI004,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI05  MOVE      ZERO,MEHDI005
          MOVE      QRYDATA,MEHDI005
          GOTO      SETMDI99
.
SETMDI06  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI006,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI07  PACK      MEHDI007,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI08  PACK      MEHDI008,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI09  MOVE      ZERO,MEHDI009
          MOVE      QRYDATA,MEHDI009
          GOTO      SETMDI99
.
SETMDI10  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI010,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI11  PACK      MEHDI011,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI12  PACK      MEHDI012,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI13  PACK      MEHDI013,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI14  PACK      MEHDI014,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI15  PACK      MEHDI015,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI16  PACK      MEHDI016,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI17  PACK      MEHDI017,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI18  PACK      MEHDI018,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI19  PACK      MEHDI019,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI20  PACK      MEHDI020,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI21  PACK      MEHDI021,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI22  PACK      MEHDI022,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI23  PACK      MEHDI023,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI24  PACK      MEHDI024,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI25  PACK      MEHDI025,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI26  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI026,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI27  PACK      MEHDI027,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI28  PACK      MEHDI028,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI29  PACK      MEHDI029,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI30  PACK      MEHDI030,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI31  PACK      MEHDI031,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI32  PACK      MEHDI032,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI33  PACK      MEHDI033,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI34  PACK      MEHDI034,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI35  PACK      MEHDI035,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI36  PACK      MEHDI036,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI37  MOVE      ZERO,MEHDI037
          MOVE      QRYDATA,MEHDI037
          GOTO      SETMDI99
.
SETMDI38  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI038,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI39  PACK      MEHDI039,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI40  PACK      MEHDI040,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI41  MOVE      ZERO,MEHDI041
          MOVE      QRYDATA,MEHDI041
          GOTO      SETMDI99
.
SETMDI42  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI042,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI43  PACK      MEHDI043,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI44  PACK      MEHDI044,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI45  MOVE      ZERO,MEHDI045
          MOVE      QRYDATA,MEHDI045
          GOTO      SETMDI99
.
SETMDI46  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI046,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI47  PACK      MEHDI047,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI48  PACK      MEHDI048,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI49  MOVE      ZERO,MEHDI049
          MOVE      QRYDATA,MEHDI049
          GOTO      SETMDI99
.
SETMDI50  PACK      KEY20,QRYDATA,SP20
          UNPACK    KEY20,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDI050,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDI99
.
SETMDI51  PACK      MEHDI051,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI52  PACK      MEHDI052,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI53  PACK      MEHDI053,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI54  PACK      MEHDI054,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI55  PACK      MEHDI055,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI56  PACK      MEHDI056,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI57  PACK      MEHDI057,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI58  PACK      MEHDI058,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI59  PACK      MEHDI059,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI60  PACK      MEHDI060,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI61  PACK      MEHDI061,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI62  PACK      MEHDI062,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI63  PACK      MEHDI063,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI64  PACK      MEHDI064,QRYDATA,SP70
          GOTO      SETMDI99
.
SETMDI99  RETURN

.------------------------------------------------------------
.   Move cgi's into file variables               
.------------------------------------------------------------
.
MVDIA000  MOVE      ZERO,MHDICHNG           * reset "data changed" flag
          MATCH     Z70,MEHDI002
          IF        !@EQUAL
            MOVE      MEHDI002,MHDIDATE
          ENDIF
.
          MATCH     Z70,MEHDI003
          IF        !@EQUAL
            MATCH     MEHDI003,MHDIICD1
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI003,MHDIICD1
          ENDIF
.
          MATCH     Z70,MEHDI004
          IF        !@EQUAL
            MOVE      MEHDI004,MHDIDES1
          ENDIF
.
          COMPARE   ZERO,MEHDI005
          IF        !@EQUAL
            IF        MEHDI005 <> MHDISUP1
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI005,MHDISUP1
          ENDIF
.
          MATCH     Z70,MEHDI006
          IF        !@EQUAL
            MATCH     MEHDI006,MHDIDAT1
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI006,MHDIDAT1
          ENDIF
.
          MATCH     Z70,MEHDI007
          IF        !@EQUAL
            MATCH     MEHDI007,MHDIICD2
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI007,MHDIICD2
          ENDIF
.
          MATCH     Z70,MEHDI008
          IF        !@EQUAL
            MOVE      MEHDI008,MHDIDES2
          ENDIF
.
          COMPARE   ZERO,MEHDI009
          IF        !@EQUAL
            IF        MEHDI009 <> MHDISUP2
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI009,MHDISUP2
          ENDIF
.
          MATCH     Z70,MEHDI010
          IF        !@EQUAL
            MATCH     MEHDI010,MHDIDAT2
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI010,MHDIDAT2
          ENDIF
.
          MATCH     Z70,MEHDI011
          IF        !@EQUAL
            MATCH     MEHDI011,MHDIX1CA
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI011,MHDIX1CA
          ENDIF
.
          MATCH     Z70,MEHDI012
          IF        !@EQUAL
            MATCH     MEHDI012,MHDIX1CB
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI012,MHDIX1CB
          ENDIF
.
          MATCH     Z70,MEHDI013
          IF        !@EQUAL
            MATCH     MEHDI013,MHDIX1CC
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI013,MHDIX1CC
          ENDIF
.
          MATCH     Z70,MEHDI014
          IF        !@EQUAL
            MOVE      MEHDI014,MHDIX1DA
          ENDIF
.
          MATCH     Z70,MEHDI015
          IF        !@EQUAL
            MOVE      MEHDI015,MHDIX1DB
          ENDIF
.
          MATCH     Z70,MEHDI016
          IF        !@EQUAL
            MOVE      MEHDI016,MHDIX1DC
          ENDIF
.
          MATCH     Z70,MEHDI017
          IF        !@EQUAL
            MATCH     MEHDI017,MHDIX2CA
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI017,MHDIX2CA
          ENDIF
.
          MATCH     Z70,MEHDI018
          IF        !@EQUAL
            MATCH     MEHDI018,MHDIX2CB
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI018,MHDIX2CB
          ENDIF
.
          MATCH     Z70,MEHDI019
          IF        !@EQUAL
            MATCH     MEHDI019,MHDIX2CC
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI019,MHDIX2CC
          ENDIF
.
          MATCH     Z70,MEHDI020 
          IF        !@EQUAL
            MOVE      MEHDI020,MHDIX2DA
          ENDIF
.
          MATCH     Z70,MEHDI021
          IF        !@EQUAL
            MOVE      MEHDI021,MHDIX2DB
          ENDIF
.
          MATCH     Z70,MEHDI022
          IF        !@EQUAL
            MOVE      MEHDI022,MHDIX2DC
          ENDIF
.
          MATCH     Z70,MEHDI023
          IF        !@EQUAL
            MOVE      MEHDI023,MHDIX3DS
          ENDIF
.
          MATCH     Z70,MEHDI024
          IF        !@EQUAL
            MATCH     MEHDI024,MHDIX4CD
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI024,MHDIX4CD
          ENDIF
.
          MATCH     Z70,MEHDI025
          IF        !@EQUAL
            MATCH     MEHDI025,MHDIX5CD
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI025,MHDIX5CD
          ENDIF
.
          MATCH     Z70,MEHDI026
          IF        !@EQUAL
            MATCH     MEHDI026,MHDIXDAT
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI026,MHDIXDAT
          ENDIF
.
          MATCH     Z70,MEHDI027
          IF        !@EQUAL
            MOVE      MEHDI027,MHDIOPER
          ENDIF
.
          MATCH     Z70,MEHDI028
          IF        !@EQUAL
            MOVE      MEHDI028,MHDIAXIV
          ENDIF
.
          MATCH     Z70,MEHDI029
          IF        !@EQUAL
            MATCH     MEHDI029,MHDIX3CA
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI029,MHDIX3CA
          ENDIF
.
          MATCH     Z70,MEHDI030
          IF        !@EQUAL
            MATCH     MEHDI030,MHDIX3CB
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI030,MHDIX3CB
          ENDIF
.
          MATCH     Z70,MEHDI031
          IF        !@EQUAL
            MATCH     MEHDI031,MHDIX3CC
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI031,MHDIX3CC
          ENDIF
.
          MATCH     Z70,MEHDI032
          IF        !@EQUAL
            MOVE      MEHDI032,MHDIX3DA
          ENDIF
.
          MATCH     Z70,MEHDI033
          IF        !@EQUAL
            MOVE      MEHDI033,MHDIX3DB
          ENDIF
.
          MATCH     Z70,MEHDI034
          IF        !@EQUAL
            MOVE      MEHDI034,MHDIX3DC
          ENDIF
.
          MATCH     Z70,MEHDI035
          IF        !@EQUAL
            MATCH     MEHDI035,MHDIICD3
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI035,MHDIICD3
          ENDIF
.
          MATCH     Z70,MEHDI036
          IF        !@EQUAL
            MOVE      MEHDI036,MHDIDES3
          ENDIF
.
          COMPARE   ZERO,MEHDI037
          IF        !@EQUAL
            IF        MEHDI037 <> MHDISUP3
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI037,MHDISUP3
          ENDIF
.
          MATCH     Z70,MEHDI038
          IF        !@EQUAL
            MATCH     MEHDI038,MHDIDAT3
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI038,MHDIDAT3
          ENDIF
.
          MATCH     Z70,MEHDI039
          IF        !@EQUAL
            MATCH     MEHDI039,MHDIICD4
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI039,MHDIICD4
          ENDIF
.
          MATCH     Z70,MEHDI040
          IF        !@EQUAL
            MOVE      MEHDI040,MHDIDES4
          ENDIF
.
          COMPARE   ZERO,MEHDI041
          IF        !@EQUAL
            IF        MEHDI041 <> MHDISUP4
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI041,MHDISUP4
          ENDIF
.
          MATCH     Z70,MEHDI042
          IF        !@EQUAL
            MATCH     MEHDI042,MHDIDAT4
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI042,MHDIDAT4
          ENDIF
.
          MATCH     Z70,MEHDI043
          IF        !@EQUAL
            MATCH     MEHDI043,MHDIICD5
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI043,MHDIICD5
          ENDIF
.
          MATCH     Z70,MEHDI044
          IF        !@EQUAL
            MOVE      MEHDI044,MHDIDES5
          ENDIF
.
          COMPARE   ZERO,MEHDI045
          IF        !@EQUAL
            IF        MEHDI045 <> MHDISUP5
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI045,MHDISUP5
          ENDIF
.
          MATCH     Z70,MEHDI046
          IF        !@EQUAL
            MATCH     MEHDI046,MHDIDAT5
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI046,MHDIDAT5
          ENDIF
.
          MATCH     Z70,MEHDI047
          IF        !@EQUAL
            MATCH     MEHDI047,MHDIICD6
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI047,MHDIICD6
          ENDIF
.
          MATCH     Z70,MEHDI048
          IF        !@EQUAL
            MOVE      MEHDI048,MHDIDES6
          ENDIF
.
          COMPARE   ZERO,MEHDI049
          IF        !@EQUAL
            IF        MEHDI049 <> MHDISUP6
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI049,MHDISUP6
          ENDIF
.
          MATCH     Z70,MEHDI050
          IF        !@EQUAL
            MATCH     MEHDI050,MHDIDAT6
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI050,MHDIDAT6
          ENDIF
.
          MATCH     Z70,MEHDI051
          IF        !@EQUAL
            MATCH     MEHDI051,MHDIP1CA
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI051,MHDIP1CA
          ENDIF
.
          MATCH     Z70,MEHDI052
          IF        !@EQUAL
            MATCH     MEHDI052,MHDIP1CB
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI052,MHDIP1CB
          ENDIF
.
          MATCH     Z70,MEHDI053
          IF        !@EQUAL
            MATCH     MEHDI053,MHDIP1CC
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI053,MHDIP1CC
          ENDIF
.
          MATCH     Z70,MEHDI054
          IF        !@EQUAL
            MATCH     MEHDI054,MHDIP2CA
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI054,MHDIP2CA
          ENDIF
.
          MATCH     Z70,MEHDI055
          IF        !@EQUAL
            MATCH     MEHDI055,MHDIP2CB
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI055,MHDIP2CB
          ENDIF
.
          MATCH     Z70,MEHDI056
          IF        !@EQUAL
            MATCH     MEHDI056,MHDIP2CC
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI056,MHDIP2CC
          ENDIF
.
          MATCH     Z70,MEHDI057
          IF        !@EQUAL
            MATCH     MEHDI057,MHDIHCPC
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI057,MHDIHCPC
          ENDIF
.
          MATCH     Z70,MEHDI058
          IF        !@EQUAL
            MATCH     MEHDI058,MHDICAST
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI058,MHDICAST
          ENDIF
.
          MATCH     Z70,MEHDI059
          IF        !@EQUAL
            MATCH     MEHDI059,MHDIDTY1
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI059,MHDIDTY1
          ENDIF
.
          MATCH     Z70,MEHDI060
          IF        !@EQUAL
            MATCH     MEHDI060,MHDIDTY2
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI060,MHDIDTY2
          ENDIF
.
          MATCH     Z70,MEHDI061
          IF        !@EQUAL
            MATCH     MEHDI061,MHDIDTY3
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI061,MHDIDTY3
          ENDIF
.
          MATCH     Z70,MEHDI062
          IF        !@EQUAL
            MATCH     MEHDI062,MHDIDTY4
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI062,MHDIDTY4
          ENDIF
.
          MATCH     Z70,MEHDI063
          IF        !@EQUAL
            MATCH     MEHDI063,MHDIDTY5
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI063,MHDIDTY5
          ENDIF
.
          MATCH     Z70,MEHDI064
          IF        !@EQUAL
            MATCH     MEHDI064,MHDIDTY6
            IF        !@EQUAL
              MOVE      ONE,MHDICHNG
            ENDIF
            MOVE      MEHDI064,MHDIDTY6
          ENDIF
.
MVDIA999  RETURN                  
