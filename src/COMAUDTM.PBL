. *----------------------------------------------------------------------
. * Include Name  :   COMAUDTM.PBL
. *
. * Function      :   CGI variable functions for COMAUDFD - comaudaf.dat
. *
. * Modifications :                                                       
. *
. * V11.01.01 10/01/2022 J.Tan    Task 0309320
. *           Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------
. Common Transferred deposit audit file standard tags
.------------------------------------------------------------
CMAU0000  BRANCH    FLDITMNO,CMAU0010,CMAU0020,CMAU0030,CMAU0040,CMAU0050:
                             CMAU0060,CMAU0070,CMAU0080,CMAU0090,CMAU0100:
                             CMAU0110,CMAU0120,CMAU0130,CMAU0140,CMAU0150:
                             CMAU0160,CMAU0170,CMAU0180
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CMAU9999
.
CMAU0010  WRITE     HTMLFILE;CMAURECN;
          GOTO      CMAU9999
.
CMAU0020  WRITE     HTMLFILE;CMAUTCNT;
          GOTO      CMAU9999
.
CMAU0030  MATCH     CMAUTDAT,SP70
          GOTO      CMAU9999 IF EQUAL
.
          UNPACK    CMAUTDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CMAU9999
.
CMAU0040  WRITE     HTMLFILE;CMAUTTIM;
          GOTO      CMAU9999
.
CMAU0050  WRITE     HTMLFILE;CMAUURNO;
          GOTO      CMAU9999
.
CMAU0060  WRITE     HTMLFILE;CMAUFADM;             * Visit number From
          GOTO      CMAU9999
.
CMAU0070  WRITE     HTMLFILE;CMAUTADM;             * Visit number To
          GOTO      CMAU9999
.
CMAU0080  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CMAU0082
          MOVE      CMAUFPRA,KEY6                  * Medical Practice From
          CALL      RDPRPR1
          BRANCH    OVRCD,CMAU9999
          WRITE     HTMLFILE;PRPRDESC;
          GOTO      CMAU9999
.
CMAU0082  WRITE     HTMLFILE;CMAUFPRA;
          GOTO      CMAU9999
.
CMAU0090  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CMAU0092
          MOVE      CMAUTPRA,KEY6                  * Medical Practice To
          CALL      RDPRPR1
          BRANCH    OVRCD,CMAU9999
          WRITE     HTMLFILE;PRPRDESC;
          GOTO      CMAU9999
.
CMAU0092  WRITE     HTMLFILE;CMAUTPRA;
          GOTO      CMAU9999
.
CMAU0100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CMAU0102
          PACK      KEY10,CMAUFSDR,SP30            * Service Doctor From
          CALL      RDPMHCP1
          BRANCH    OVRCD,CMAU9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      CMAU9999
.
CMAU0102  WRITE     HTMLFILE;CMAUFSDR;
          GOTO      CMAU9999
.
CMAU0110  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CMAU0112
          PACK      KEY10,CMAUTSDR,SP30            * Service Doctor To
          CALL      RDPMHCP1
          BRANCH    OVRCD,CMAU9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      CMAU9999
.
CMAU0112  WRITE     HTMLFILE;CMAUFSDR;
          GOTO      CMAU9999
.
CMAU0120  MOVE      "DP",CATEGORY
          MOVE      CMAUFDTY,CODE            * Deposit Type From
          CALL      CODITM00
          GOTO      CMAU9999
.
CMAU0130  MOVE      "DP",CATEGORY
          MOVE      CMAUTDTY,CODE            * Deposit Type To
          CALL      CODITM00
          GOTO      CMAU9999
.
CMAU0140  MOVE      CMAUFVTY,KEY1
          CALL      VTYP0000                 * Set up Visit type description
          WRITE     HTMLFILE;KEY20;
          GOTO      CMAU9999
.
CMAU0150  MOVE      CMAUTVTY,KEY1
          CALL      VTYP0000                 * Set up Visit type description
          WRITE     HTMLFILE;KEY20;
          GOTO      CMAU9999
.
CMAU0160  PACK      KEY3,CMAUFREG            * Register From
          CALL      RDREGA1
          IF        OVRCD=1
            MOVE      CMAUFREG,REGDESC
          ENDIF
          WRITE     HTMLFILE;REGDESC;
          GOTO      CMAU9999
.
CMAU0170  PACK      KEY3,CMAUTREG            * Register To
          CALL      RDREGA1
          IF        OVRCD=1
            MOVE      CMAUTREG,REGDESC
          ENDIF
          WRITE     HTMLFILE;REGDESC;
          GOTO      CMAU9999
.
CMAU0180  PACK      KEY10,CMAUCUID,SP70       * WEB User Id
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      CMAUCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM; 
          GOTO      CMAU9999
.
CMAU9999  RETURN
+
.------------------------------------------------------------
.  Set visit type description
.------------------------------------------------------------
VTYP0000  MOVE      SP70,KEY20
          MATCH     "1",KEY1
          IF        @EQUAL
            MOVE      "Emergency",KEY20
          ENDIF
          MATCH     "2",KEY1
          IF        @EQUAL
            MOVE      "Outpatient",KEY20
          ENDIF
          MATCH     "3",KEY1
          IF        @EQUAL
            MOVE      "Inpatient",KEY20
          ENDIF
          MATCH     "4",KEY1
          IF        @EQUAL
            MOVE      "Private Practice",KEY20
          ENDIF
VTYP9999  RETURN
+
.------------------------------------------------------------
.  Clear transferred deposit audit file
.------------------------------------------------------------
CLCMAU00  MOVE      SP70,CMAURECN  * Receipt Number
          MOVE      SP70,CMAUTCNT  * Transaction Count
          MOVE      SP70,CMAUTDAT  * Date Deposit Transferred (CCYYMMDD)
          MOVE      SP70,CMAUTTIM  * Time Deposit Transferred (hh:mm:ss)
          MOVE      SP70,CMAUURNO  * Patient U/R No
          MOVE      SP70,CMAUFADM  * Visit Number Deposit Transferred From
          MOVE      SP70,CMAUTADM  * Visit Number Deposit Transferred To
          MOVE      SP70,CMAUFPRA  * Medical Practice Deposit Transferred From
          MOVE      SP70,CMAUTPRA  * Medical Practice Deposit To
          MOVE      SP70,CMAUFSDR  * Service Doctor From
          MOVE      SP70,CMAUTSDR  * Service Doctor To
          MOVE      SP70,CMAUFDTY  * Deposit Type From (Cat DP)
          MOVE      SP70,CMAUTDTY  * Deposit Type to (Cat DP)
          MOVE      SP70,CMAUFVTY  * Visit Type From
          MOVE      SP70,CMAUTVTY  * Visit Type To
          MOVE      SP70,CMAUFREG  * Register From
          MOVE      SP70,CMAUTREG  * Register To
          MOVE      SP70,CMAUCUID  * Web User Id Created (websecaf)
          MOVE      SP70,CMAUSPAR  * Spare Variable
.
CLCMAU99  RETURN
