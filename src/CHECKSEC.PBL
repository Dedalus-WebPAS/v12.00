.
.    ROUTINE TO VERIFY THAT THE SECURITY CODE IS CORRECT
.
         ENDSET    PCEMPNA
         APPEND    SPACES,PCEMPNA
         RESET     PCEMPNA,30
         RESET     PCEMPNA
.
         MATCH     SPACES,PCEMPNA
         GOTO      X27532 IF EQUAL
.
X26142
         MOVE      ZERO,N01407
         MOVE      ZERO,N01521
         MOVE      ZERO,N01423
         MOVE      ZERO,N01427
         MOVE      ZERO,N01433
         MOVE      ZERO,N01437
         MOVE      ZERO,N01443
.
X26257   CMATCH    "A",PCEMPNA
         GOTO      X26365 IF EQUAL
         CMATCH    "E",PCEMPNA
         GOTO      X26411 IF EQUAL
         CMATCH    "I",PCEMPNA
         GOTO      X26427 IF EQUAL
         CMATCH    "O",PCEMPNA
         GOTO      X26445 IF EQUAL
         CMATCH    "U",PCEMPNA
         GOTO      X26463 IF EQUAL
         CMATCH    " ",PCEMPNA
         GOTO      X26352 IF EQUAL
         ADD       ONE,N01521
.
X26352   BUMP      PCEMPNA
         GOTO      X26501 IF EOS
         GOTO      X26257
.
X26365   ADD       ONE,N01423
         GOTO      X26352
.
X26411   ADD       ONE,N01427
         GOTO      X26352
.
X26427   ADD       ONE,N01433
         GOTO      X26352
.
X26445   ADD       ONE,N01437
         GOTO      X26352
.
X26463   ADD       ONE,N01443
         GOTO      X26352
.
X26501   ADD       ONE,N01423
         MOVE      N01423,N01447
         MULT      N01423,N01447
         MULT      N01423,N01447
         ADD       ONE,N01427
         MOVE      N01427,N01457
         MULT      N01427,N01457
         MULT      N01427,N01457
         ADD       ONE,N01433
         MOVE      N01433,N01467
         MULT      N01433,N01467
         MULT      N01433,N01467
         ADD       ONE,N01437
         MOVE      N01437,N01477
         MULT      N01437,N01477
         MULT      N01437,N01477
         ADD       ONE,N01443
         MOVE      N01443,N01507
         MULT      N01443,N01507
         MULT      N01443,N01507
         MOVE      N01447,N01525
         MULT      "2",N01457
         ADD       N01457,N01525
         MULT      "3",N01467
         ADD       N01467,N01525
         MULT      "4",N01477
         ADD       N01477,N01525
         MULT      "5",N01507
         ADD       N01507,N01525
         ADD       ONE,N01521
         MULT      N01521,N01525
         ADD       "11",N01521
         MULT      N01521,N01525
         TYPE      ICOMP
         GOTO      X27335 IF EQUAL
         MOVE      ONE,N01521
.
X27101   CMATCH    "A",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
         CMATCH    "E",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
         CMATCH    "I",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
         CMATCH    "M",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
         CMATCH    "Q",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
         CMATCH    "U",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
         CMATCH    "Y",ICOMP
         GOTO      X27306 IF LESS
         ADD       ONE,N01521
.
X27306   BUMP      ICOMP
         GOTO      X27355 IF EOS
         MULT      "10",N01521
         GOTO      X27101
.
X27335   MOVE      ICOMP,N01521
         ADD       ONE,N01521
.
X27355   MULT      N01521,N01525
         MOVE      N01525,N01507
         MULT      "99999",N01507
         DIV       "12",N01507
         MOVE      N01507,N01525
         COMPARE   "100000",N01525
         GOTO      X27501 IF NOT LESS
         ADD       "765432",N01525
.
X27501   MOVE      N01525,S01412
.
         MATCH     S01412,PCD6
         GOTO      X27532 IF NOT EQUAL
         GOTO      CHECKERR
.
.   INVALID CODE
.
X27532   MOVE      ONE TO FLAG
         RETURN
.
.   VALID CODE
.
CHECKERR MOVE      ZERO TO FLAG
         RETURN
