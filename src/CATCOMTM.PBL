.******************************************************************************
.* System         : CAT                                                       *
.*                                                                            *
.* Include Name   : CATCOMTM.PBL                                              *
.*                                                                            *
.* Function       : CGI processing for Completed Menus Table (catcomaf)       *
.*                  CLCTCM00 - clear CGI variables                            *
.*                  CCOM0000 - create and write output tags                   *
.*                  SCCOM000 - set parameters                                 *
.*                  MVCOM000 - move data to file variables                    *
.*                                                                            *
.* Modifications  :                                                           *
.*      V10.07.00   24/11/2015  Davin          CAR 310749                     *
.*                  Created include                                           *
.******************************************************************************
CLCTCM00  MOVE      Z70,CTCOM001
          MOVE      Z70,CTCOM002
          MOVE      Z70,CTCOM003
          MOVE      Z70,CTCOM004
          MOVE      Z70,CTCOM005
          MOVE      Z70,CTCOM006
          MOVE      ZERO,CTCOM007
          MOVE      ZERO,CTCOM008
          MOVE      ZERO,CTCOM009
          MOVE      ZERO,CTCOM010
          MOVE      Z70,CTCOM011
          MOVE      Z70,CTCOM012
          MOVE      Z70,CTCOM013
          MOVE      Z70,CTCOM014
          MOVE      Z70,CTCOM015
          MOVE      Z70,CTCOM016
          MOVE      Z70,CTCOM017
          MOVE      Z70,CTCOM018
          MOVE      Z70,CTCOM019
          MOVE      Z70,CTCOM020
          MOVE      Z70,CTCOM021
          MOVE      Z70,CTCOM022
          MOVE      Z70,CTCOM023
          MOVE      Z70,CTCOM024
          MOVE      Z70,CTCOM025
          MOVE      Z70,CTCOM026
          MOVE      Z70,CTCOM027
          MOVE      Z70,CTCOM028
          MOVE      Z70,CTCOM029
          MOVE      Z70,CTCOM030
          MOVE      Z70,CTCOM031
          MOVE      Z70,CTCOM032
          MOVE      Z70,CTCOM033
          MOVE      Z70,CTCOM034
          MOVE      Z70,CTCOM035
          MOVE      Z70,CTCOM036
          MOVE      Z70,CTCOB001
          MOVE      Z70,CTCOB002
          MOVE      Z70,CTCOB003
          MOVE      Z70,CTCOB004
          MOVE      Z70,CTCOB005
          MOVE      Z70,CTCOL001
          MOVE      Z70,CTCOL002
          MOVE      Z70,CTCOL003
          MOVE      Z70,CTCOL004
          MOVE      Z70,CTCOL005
          MOVE      Z70,CTCOD001
          MOVE      Z70,CTCOD002
          MOVE      Z70,CTCOD003
          MOVE      Z70,CTCOD004
          MOVE      Z70,CTCOD005
CLCTCM99  RETURN
+
.------------------------------------------------------------------------
.   Output Server tags for Completed Menus Table (catcomaf)
.------------------------------------------------------------------------
CCOM0000  UNPACK    DIM127,D1,KEY1,DIM127      * Breakfast:1/lunch:3/dinner:5
.
          PACK      KEY17,ADMISSNO,LASTDATE,KEY1
          CALL      RDCTCOM1
          IF        OVRCD = 1
            CALL      CLCATCOM
          ENDIF
.
          BRANCH    FLDITMNO,CCOM0100,CCOM0200,CCOM0300,CCOM0400,CCOM0500:
                             CCOM0600,CCOM0700,CCOM0800,CCOM0900,CCOM1000:
                             CCOM1100,CCOM1200,CCOM1300,CCOM1400,CCOM1500:
                             CCOM1600,CCOM1700,CCOM1800,CCOM1900,CCOM2000:
                             CCOM2100,CCOM2200,CCOM2300,CCOM2400,CCOM2500:
                             CCOM2600,CCOM2700,CCOM2800,CCOM2900,CCOM3000:
                             CCOM3100,CCOM3200,CCOM3300,CCOM3400,CCOM3500:
                             CCOM3600
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CCOM9999
.
CCOM0100  WRITE     HTMLFILE;DCTCOADM;
          GOTO      CCOM9999
.
CCOM0200  WRITE     HTMLFILE;CTCODATE;
          GOTO      CCOM9999
.
CCOM0300  WRITE     HTMLFILE;DCTCOMEA;
          GOTO      CCOM9999
.
CCOM0400  WRITE     HTMLFILE;CTCOMENU;
          GOTO      CCOM9999
.
CCOM0500  MOVE      "DC",CATEGORY
          MOVE      CTCODIET,CODE
          CALL      CODITM00
          GOTO      CCOM9999
.
CCOM0600  WRITE     HTMLFILE;CTCOWARD;
          GOTO      CCOM9999
.
CCOM0700  WRITE     HTMLFILE;CTCOSIZE;
          GOTO      CCOM9999
.
CCOM0800  WRITE     HTMLFILE;CTCOSTAT;
          GOTO      CCOM9999
.
CCOM0900  WRITE     HTMLFILE;CTCOBELT;
          GOTO      CCOM9999
.
CCOM1000  WRITE     HTMLFILE;CTCOMTYP;
          GOTO      CCOM9999
.
CCOM1100  WRITE     HTMLFILE;CTCOPRNT;
          GOTO      CCOM9999
.
CCOM1200  WRITE     HTMLFILE;CTCOIT01;
          GOTO      CCOM9999
.
CCOM1300  MOVE      "MJ",CATEGORY
          MOVE      CTCOIT02,CODE
          CALL      CODITM00
          GOTO      CCOM9999
.
CCOM1400  MOVE      "MJ",CATEGORY
          MOVE      CTCOIT03,CODE
          CALL      CODITM00
          GOTO      CCOM9999
.
CCOM1500  MOVE      "MJ",CATEGORY
          MOVE      CTCOIT04,CODE
          CALL      CODITM00
          GOTO      CCOM9999
.
CCOM1600  MOVE      "MJ",CATEGORY
          MOVE      CTCOIT05,CODE
          CALL      CODITM00
          GOTO      CCOM9999
.
CCOM1700  WRITE     HTMLFILE;CTCOIT06;
          GOTO      CCOM9999
.
CCOM1800  WRITE     HTMLFILE;CTCOIT07;
          GOTO      CCOM9999
.
CCOM1900  WRITE     HTMLFILE;CTCOIT08;
          GOTO      CCOM9999
.
CCOM2000  WRITE     HTMLFILE;CTCOIT09;
          GOTO      CCOM9999
.
CCOM2100  WRITE     HTMLFILE;CTCOIT10;
          GOTO      CCOM9999
.
CCOM2200  WRITE     HTMLFILE;CTCOIT11;
          GOTO      CCOM9999
.
CCOM2300  WRITE     HTMLFILE;CTCOIT12;
          GOTO      CCOM9999
.
CCOM2400  WRITE     HTMLFILE;CTCOIT13;
          GOTO      CCOM9999
.
CCOM2500  WRITE     HTMLFILE;CTCOIT14;
          GOTO      CCOM9999
.
CCOM2600  WRITE     HTMLFILE;CTCOIT15;
          GOTO      CCOM9999
.
CCOM2700  WRITE     HTMLFILE;CTCOIT16;
          GOTO      CCOM9999
.
CCOM2800  WRITE     HTMLFILE;CTCOIT17;
          GOTO      CCOM9999
.
CCOM2900  WRITE     HTMLFILE;CTCOIT18;
          GOTO      CCOM9999
.
CCOM3000  WRITE     HTMLFILE;CTCOIT19;
          GOTO      CCOM9999
.
CCOM3100  WRITE     HTMLFILE;CTCOIT20;
          GOTO      CCOM9999
.
CCOM3200  WRITE     HTMLFILE;CTCODNAM;
          GOTO      CCOM9999
.
CCOM3300  WRITE     HTMLFILE;CTCOPAGN;
          GOTO      CCOM9999
.
CCOM3400  WRITE     HTMLFILE;CTCOOTHR;
          GOTO      CCOM9999
.
CCOM3500  WRITE     HTMLFILE;CTCODTYP;
          GOTO      CCOM9999
.
CCOM3600  WRITE     HTMLFILE;CTCOALVL;
          GOTO      CCOM9999
.
CCOM9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Completed Menus Table details
.------------------------------------------------------------
SCCOM000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SCCOM001,SCCOM002,SCCOM003,SCCOM004,SCCOM005:
                       SCCOM006,SCCOM007,SCCOM008,SCCOM009,SCCOM010:
                       SCCOM011,SCCOM012,SCCOM013,SCCOM014,SCCOM015:
                       SCCOM016,SCCOM017,SCCOM018,SCCOM019,SCCOM020:
                       SCCOM021,SCCOM022,SCCOM023,SCCOM024,SCCOM025:
                       SCCOM026,SCCOM027,SCCOM028,SCCOM029,SCCOM030:
                       SCCOM031,SCCOM032,SCCOM033,SCCOM034,SCCOM035:
                       SCCOM036
.
          MOVE      ONE,EXIT
          GOTO      SCCOM999
.
SCCOM001  PACK      CTCOM001,QRYDATA,SP70
          GOTO      SCCOM999
.
SCCOM002  PACK      CTCOM002,QRYDATA,SP70
          GOTO      SCCOM999
.
SCCOM003  PACK      CTCOM003,QRYDATA,SP70
          GOTO      SCCOM999
.
SCCOM004  PACK      CTCOM004,QRYDATA,SP70
          GOTO      SCCOM999
.
SCCOM005  PACK      CTCOM005,QRYDATA,SP70
          GOTO      SCCOM999
.
SCCOM006  MOVE      QRYDATA,CTCOM006
          GOTO      SCCOM999
.
SCCOM007  MOVE      QRYDATA,CTCOM007
          GOTO      SCCOM999
.
SCCOM008  MOVE      QRYDATA,CTCOM008
          GOTO      SCCOM999
.
SCCOM009  MOVE      QRYDATA,CTCOM009
          GOTO      SCCOM999
.
SCCOM010  MOVE      QRYDATA,CTCOM010
          GOTO      SCCOM999
.
SCCOM011  MOVE      QRYDATA,CTCOM011
          GOTO      SCCOM999
.
SCCOM012  MOVE      QRYDATA,CTCOM012
          GOTO      SCCOM999
.
SCCOM013  MOVE      QRYDATA,CTCOM013
          GOTO      SCCOM999
.
SCCOM014  MOVE      QRYDATA,CTCOM014
          GOTO      SCCOM999
.
SCCOM015  MOVE      QRYDATA,CTCOM015
          GOTO      SCCOM999
.
SCCOM016  MOVE      QRYDATA,CTCOM016
          GOTO      SCCOM999
.
SCCOM017  MOVE      QRYDATA,CTCOM017
          GOTO      SCCOM999
.
SCCOM018  MOVE      QRYDATA,CTCOM018
          GOTO      SCCOM999
.
SCCOM019  MOVE      QRYDATA,CTCOM019
          GOTO      SCCOM999
.
SCCOM020  MOVE      QRYDATA,CTCOM020
          GOTO      SCCOM999
.
SCCOM021  MOVE      QRYDATA,CTCOM021
          GOTO      SCCOM999
.
SCCOM022  MOVE      QRYDATA,CTCOM022
          GOTO      SCCOM999
.
SCCOM023  MOVE      QRYDATA,CTCOM023
          GOTO      SCCOM999
.
SCCOM024  MOVE      QRYDATA,CTCOM024
          GOTO      SCCOM999
.
SCCOM025  MOVE      QRYDATA,CTCOM025
          GOTO      SCCOM999
.
SCCOM026  MOVE      QRYDATA,CTCOM026
          GOTO      SCCOM999
.
SCCOM027  MOVE      QRYDATA,CTCOM027
          GOTO      SCCOM999
.
SCCOM028  MOVE      QRYDATA,CTCOM028
          GOTO      SCCOM999
.
SCCOM029  MOVE      QRYDATA,CTCOM029
          GOTO      SCCOM999
.
SCCOM030  MOVE      QRYDATA,CTCOM030
          GOTO      SCCOM999
.
SCCOM031  MOVE      QRYDATA,CTCOM031
          GOTO      SCCOM999
.
SCCOM032  MOVE      QRYDATA,CTCOM032
          GOTO      SCCOM999
.
SCCOM033  MOVE      QRYDATA,CTCOM033
          GOTO      SCCOM999
.
SCCOM034  MOVE      QRYDATA,CTCOM034
          GOTO      SCCOM999
.
SCCOM035  MOVE      QRYDATA,CTCOM035
          GOTO      SCCOM999
.
SCCOM036  MOVE      QRYDATA,CTCOM036
          GOTO      SCCOM999
.
SCCOM999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Completed Menus Table details Breakfast
.------------------------------------------------------------
SCCOB000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SCCOB001,SCCOB002,SCCOB003,SCCOB004,SCCOB005
.
          MOVE      ONE,EXIT
          GOTO      SCCOB999
.
SCCOB001  PACK      CTCOB001,QRYDATA,SP70
          GOTO      SCCOB999
.
SCCOB002  PACK      CTCOB002,QRYDATA,SP70
          GOTO      SCCOB999
.
SCCOB003  PACK      CTCOB003,QRYDATA,SP70
          GOTO      SCCOB999
.
SCCOB004  PACK      CTCOB004,QRYDATA,SP70
          GOTO      SCCOB999
.
SCCOB005  PACK      CTCOB005,QRYDATA,SP70
          GOTO      SCCOB999
.
SCCOB999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Completed Menus Table details Lunch
.------------------------------------------------------------
SCCOL000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SCCOL001,SCCOL002,SCCOL003,SCCOL004,SCCOL005
.
          MOVE      ONE,EXIT
          GOTO      SCCOL999
.
SCCOL001  PACK      CTCOL001,QRYDATA,SP70
          GOTO      SCCOL999
.
SCCOL002  PACK      CTCOL002,QRYDATA,SP70
          GOTO      SCCOL999
.
SCCOL003  PACK      CTCOL003,QRYDATA,SP70
          GOTO      SCCOL999
.
SCCOL004  PACK      CTCOL004,QRYDATA,SP70
          GOTO      SCCOL999
.
SCCOL005  PACK      CTCOL005,QRYDATA,SP70
          GOTO      SCCOL999
.
SCCOL999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Completed Menus Table details Dinner
.------------------------------------------------------------
SCCOD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SCCOD001,SCCOD002,SCCOD003,SCCOD004,SCCOD005
.
          MOVE      ONE,EXIT
          GOTO      SCCOD999
.
SCCOD001  PACK      CTCOD001,QRYDATA,SP70
          GOTO      SCCOD999
.
SCCOD002  PACK      CTCOD002,QRYDATA,SP70
          GOTO      SCCOD999
.
SCCOD003  PACK      CTCOD003,QRYDATA,SP70
          GOTO      SCCOD999
.
SCCOD004  PACK      CTCOD004,QRYDATA,SP70
          GOTO      SCCOD999
.
SCCOD005  PACK      CTCOD005,QRYDATA,SP70
          GOTO      SCCOD999
.
SCCOD999  RETURN
+
.------------------------------------------------------------
.   Move CGI values to Completed Menus Table record.
.------------------------------------------------------------
MVCOM000  MATCH     CTCOM001,Z70
          IF        !@EQUAL
            MOVE      CTCOM001,CTCOADMN
          ENDIF
.
          MATCH     CTCOM002,Z70
          IF        !@EQUAL
            MOVE      CTCOM002,CTCODATE
          ENDIF
.
          MATCH     CTCOM003,Z70
          IF        !@EQUAL
            MOVE      CTCOM003,CTCOMEAL
          ENDIF
.
          MATCH     CTCOM004,Z70
          IF        !@EQUAL
            MOVE      CTCOM004,CTCOMENU
          ENDIF
.
          MATCH     CTCOM005,Z70
          IF        !@EQUAL
            MOVE      CTCOM005,CTCODIET
          ENDIF
.
          MATCH     CTCOM006,Z70
          IF        !@EQUAL
            MOVE      CTCOM006,CTCOWARD
          ENDIF
.
          COMPARE   CTCOM007,ZERO
          IF        !@EQUAL
            MOVE      CTCOM007,CTCOSIZE
          ENDIF
.
          COMPARE   CTCOM008,ZERO
          IF        !@EQUAL
            MOVE      CTCOM008,CTCOSTAT
          ENDIF
.
          COMPARE   CTCOM009,ZERO
          IF        !@EQUAL
            MOVE      CTCOM009,CTCOBELT
          ENDIF
.
          COMPARE   CTCOM010,ZERO
          IF        !@EQUAL
            MOVE      CTCOM010,CTCOMTYP
          ENDIF
.
          MATCH     CTCOM011,Z70
          IF        !@EQUAL
            MOVE      CTCOM011,CTCOPRNT
          ENDIF
.
          MATCH     CTCOM012,Z70
          IF        !@EQUAL
            MOVE      CTCOM012,CTCOIT01
          ENDIF
.
          MATCH     CTCOM013,Z70
          IF        !@EQUAL
            MOVE      CTCOM013,CTCOIT02
          ENDIF
.
          MATCH     CTCOM014,Z70
          IF        !@EQUAL
            MOVE      CTCOM014,CTCOIT03
          ENDIF
.
          MATCH     CTCOM015,Z70
          IF        !@EQUAL
            MOVE      CTCOM015,CTCOIT04
          ENDIF
.
          MATCH     CTCOM016,Z70
          IF        !@EQUAL
            MOVE      CTCOM016,CTCOIT05
          ENDIF
.
          MATCH     CTCOM017,Z70
          IF        !@EQUAL
            MOVE      CTCOM017,CTCOIT06
          ENDIF
.
          MATCH     CTCOM018,Z70
          IF        !@EQUAL
            MOVE      CTCOM018,CTCOIT07
          ENDIF
.
          MATCH     CTCOM019,Z70
          IF        !@EQUAL
            MOVE      CTCOM019,CTCOIT08
          ENDIF
.
          MATCH     CTCOM020,Z70
          IF        !@EQUAL
            MOVE      CTCOM020,CTCOIT09
          ENDIF
.
          MATCH     CTCOM021,Z70
          IF        !@EQUAL
            MOVE      CTCOM021,CTCOIT10
          ENDIF
.
          MATCH     CTCOM022,Z70
          IF        !@EQUAL
            MOVE      CTCOM022,CTCOIT11
          ENDIF
.
          MATCH     CTCOM023,Z70
          IF        !@EQUAL
            MOVE      CTCOM023,CTCOIT12
          ENDIF
.
          MATCH     CTCOM024,Z70
          IF        !@EQUAL
            MOVE      CTCOM024,CTCOIT13
          ENDIF
.
          MATCH     CTCOM025,Z70
          IF        !@EQUAL
            MOVE      CTCOM025,CTCOIT14
          ENDIF
.
          MATCH     CTCOM026,Z70
          IF        !@EQUAL
            MOVE      CTCOM026,CTCOIT15
          ENDIF
.
          MATCH     CTCOM027,Z70
          IF        !@EQUAL
            MOVE      CTCOM027,CTCOIT16
          ENDIF
.
          MATCH     CTCOM028,Z70
          IF        !@EQUAL
            MOVE      CTCOM028,CTCOIT17
          ENDIF
.
          MATCH     CTCOM029,Z70
          IF        !@EQUAL
            MOVE      CTCOM029,CTCOIT18
          ENDIF
.
          MATCH     CTCOM030,Z70
          IF        !@EQUAL
            MOVE      CTCOM030,CTCOIT19
          ENDIF
.
          MATCH     CTCOM031,Z70
          IF        !@EQUAL
            MOVE      CTCOM031,CTCOIT20
          ENDIF
.
          MATCH     CTCOM032,Z70
          IF        !@EQUAL
            MOVE      CTCOM032,CTCODNAM
          ENDIF
.
          MATCH     CTCOM033,Z70
          IF        !@EQUAL
            MOVE      CTCOM033,CTCOPAGN
          ENDIF
.
          MATCH     CTCOM034,Z70
          IF        !@EQUAL
            MOVE      CTCOM034,CTCOOTHR
          ENDIF
.
          MATCH     CTCOM035,Z70
          IF        !@EQUAL
            MOVE      CTCOM035,CTCODTYP
          ENDIF
.
          MATCH     CTCOM036,Z70
          IF        !@EQUAL
            MOVE      CTCOM036,CTCOALVL
          ENDIF
.
MVCOM999  RETURN
+
.------------------------------------------------------------
.   Move CGI values to Completed Menus Table record Breakfast
.------------------------------------------------------------
MVCOB000  MATCH     CTCOB001,Z70
          IF        !@EQUAL
            MOVE      CTCOB001,CTCODIET
          ENDIF
.
          MATCH     CTCOB002,Z70
          IF        !@EQUAL
            MOVE      CTCOB002,CTCOIT02
          ENDIF
.
          MATCH     CTCOB003,Z70
          IF        !@EQUAL
            MOVE      CTCOB003,CTCOIT03
          ENDIF
.
          MATCH     CTCOB004,Z70
          IF        !@EQUAL
            MOVE      CTCOB004,CTCOIT04
          ENDIF
.
          MATCH     CTCOB005,Z70
          IF        !@EQUAL
            MOVE      CTCOB005,CTCOIT05
          ENDIF
.
MVCOB999  RETURN
+
.------------------------------------------------------------
.   Move CGI values to Completed Menus Table record Lunch
.------------------------------------------------------------
MVCOL000  MATCH     CTCOL001,Z70
          IF        !@EQUAL
            MOVE      CTCOL001,CTCODIET
          ENDIF
.
          MATCH     CTCOL002,Z70
          IF        !@EQUAL
            MOVE      CTCOL002,CTCOIT02
          ENDIF
.
          MATCH     CTCOL003,Z70
          IF        !@EQUAL
            MOVE      CTCOL003,CTCOIT03
          ENDIF
.
          MATCH     CTCOL004,Z70
          IF        !@EQUAL
            MOVE      CTCOL004,CTCOIT04
          ENDIF
.
          MATCH     CTCOL005,Z70
          IF        !@EQUAL
            MOVE      CTCOL005,CTCOIT05
          ENDIF
.
MVCOL999  RETURN
+
.------------------------------------------------------------
.   Move CGI values to Completed Menus Table record Dinner
.------------------------------------------------------------
MVCOD000  MATCH     CTCOD001,Z70
          IF        !@EQUAL
            MOVE      CTCOD001,CTCODIET
          ENDIF
.
          MATCH     CTCOD002,Z70
          IF        !@EQUAL
            MOVE      CTCOD002,CTCOIT02
          ENDIF
.
          MATCH     CTCOD003,Z70
          IF        !@EQUAL
            MOVE      CTCOD003,CTCOIT03
          ENDIF
.
          MATCH     CTCOD004,Z70
          IF        !@EQUAL
            MOVE      CTCOD004,CTCOIT04
          ENDIF
.
          MATCH     CTCOD005,Z70
          IF        !@EQUAL
            MOVE      CTCOD005,CTCOIT05
          ENDIF
.
MVCOD999  RETURN
+
