.******************************************************************************
.* system         : theatre                                                   *
.* program        : IBAOPR65                                                  *
.* description    : Operation Type Summary                                    *
.******************************************************************************
.* programmer     : Paul Duncan                                               *
.* date           : 21/02/90                                                  *
.* mods           :                                                           *
.*        V10.04.01 23/06/2014   J.Tan           CAR 261630                   *
.*                  Removed port number from temp file name                   *
.*        V5.07.B01 18/01/1999  Nicole Harrington 507 rebound 089             *
.*                  Mods to include century on to and from dates              *
.******************************************************************************
.*                  24/10/90   J. Ceniza. Fixed up bugs                       *
.*        V5.00     R.Knowles  (18/12/90)  Converted to Version 5             *
.*        V5.01     Peter Eddey 02/0191                                       *
.*                  Did cosmetic changes to report                            *
.*                                                                            *
.*        V5.01.02  21/01/1991   Justin Coates                                *
.*                  Converted back to Release 5.01                            *
.*                  04/02/1991   ROD                                          *
.*                  Changed date range not to default to Start & Finish       *
.*                  12/02/1991   ROD                                          *
.*                  Changed a couple of printing formats (just slightly)      *
.*                  15/02/1991   ROD                                          *
.*                  Added default to end date and if nothing input for        *
.*                  operation type then use All operation types               *
.*        V5.01.03  19/02/1991   Graeme Williams                              *
.*                  Fixed a minor bug with loading the temp file              *
.*        V5.01.04  22/05/91  Steve O'Gorman                                  *
.*                  Fixed Errors found by the New Compiler                    *
.*        V5.01.05  30/12/1991    Justin Coates  (Modbury Changes)            *
.*                  Merge all records with same breakdown code for layout 1   *
.*                  Added report layout to allow for new value (opotuser)     *
.*        V5.01.06  06/02/92      J.Tan     SRF 112960                        *
.*                  Mods not to print zero statistics                         *
.*        V5.01.07  12/06/92   Lofty                                          *
.*                  Made changes for Wellington (Faxes)                       *
.*        V5.01.08  23/07/92   ROD                                            *
.*                  Print comments at end of report layout 2                  *
.*        V5.01.09  24/05/1995  Matt Surridge                                 *
.*                  Fixed bugs for global recompile.                          *
.******************************************************************************
.
.$$$$$
.  Operation Type Summary      
.  ----------------------
.  - Initialisation
.       - Display Header
.       - Open Files
.          OPROTSA1
.
.  - Processing Options
.       - 0 = Exit
.       - 1 = By Operation Type       
.                       - GTOP0000 - Enter operation type and verify to file
.       - DTRN0000 - enter date range required.
.           - O.K to Continue ?
.       - PROC0000 - loop thru oprotsaf file, writing to tempfile for the 
.                    requested operation and updating for each day of the
.                    week.
.       - TEMP0000 - print the entire contents of the tempfile.
.              - DOA0000 - print data for breakdown summary A
.              - DOB0000 - print data for breakdown summary B
.              - DOC0000 - print data for breakdown summary C
.              - DOD0000 - print data for breakdown summary D
.              - DOE0000 - print data for breakdown summary E
.              - DOF0000 - print data for breakdown summary F
.              - DOG0000 - print data for breakdown summary G
.              - DOH0000 - print data for breakdown summary H
.              - DOI0000 - print data for breakdown summary I
.              - DOJ0000 - print data for breakdown summary J
.              - DOK0000 - print data for breakdown summary K
.              - DOL0000 - print data for breakdown summary L
.              - DOM0000 - print data for breakdown summary M
.              - TOT0000 - print totals
.           - Print end of report message
.  - END
.$$$$$$
          INC       STD001FD
          INC       IBASEQFD/INC            * Sequential Numbers File
          INC       TFILEVAR/INC            * Generate Temp File Name
          INC       WEBERRFD/INC            * Web Server Error Logging
.
          INC       OPRCONFD/INC
          INC       OPROTSFD/INC
          INC       PATCODFD/INC
.
.************************************************************************
.*                           CONSTANTS                                  *
.************************************************************************ 
CAS       INIT      " Number of Cases"
CATY6     INIT      "Y6"
CATY7     INIT      "Y7"
CATY8     INIT      "Y8"
CATY9     INIT      "Y9"
CATZ1     INIT      "Z1"
CATZ2     INIT      "Z2"
CATZ3     INIT      "Z3"
CATZ4     INIT      "Z4"
CATZ5     INIT      "Z5"
CATZ6     INIT      "Z6"
CATZ7     INIT      "Z7"
CATZ8     INIT      "Z8"
ISBUILD   INIT      "isbuild "
ISERASE   INIT      "iserase "
MIN       INIT      " Minutes Used"
OPCNBRKM  INIT      "23:59"
OY        INIT      "OY"
SP50      INIT      "                                        "
ST        INIT      "ST"
ZED       INIT      "z"
.
.************************************************************************
.*                           VARIABLES                                  *
.************************************************************************
CMDLINE   DIM       70
CODE      DIM       2
DATEFR    DIM       8
DATETO    DIM       8
FORM6     FORM      6
FRTIME    DIM       5
HEADFLG   FORM      1
LABEL     DIM       20
OPER      DIM       3
OPRTEMP1  DIM       8
PRDTFR    DIM       10
PRDTTO    DIM       10
PRTFLG    FORM      1
SPSP      DIM       3
TEMP      FORM      8
TOTAL     FORM      8
TOTCAS    FORM      8
TOTIME    DIM       5
USERCAT   DIM       2
USERNO    DIM       17
USERYES   DIM       17
.
KEYA      INIT      " 34 U1-1,2-2,3-5"
TEMPFIL1  IFILE     SQL, FIXED=34, KEY="U1-1,2-2,3-5"
.Name     Type      Length    Phys.  Start  Description
.-------  -----     ------    -----  -----  ------------------------------------
TEMPSUM   DIM       1           1        1  Breakdown code        (opotperd)
TEMPTYP   DIM       1           1        2  Cases/Minutes
TEMPUSER  DIM       3           3        3  User defined field    (opotuser)
TEMPMOCT  FORM      6           4        6  Total for Monday
TEMPTUCT  FORM      6           4       10  Total for Tuesday
TEMPWECT  FORM      6           4       14  Total for Wednesday
TEMPTHCT  FORM      6           4       18  Total for Thursday
TEMPFRCT  FORM      6           4       22  Total for Friday
TEMPSACT  FORM      6           4       26  Total for Saturday
TEMPSUCT  FORM      6           4       30  Total for Sunday
.                                       34  End of Record
.
PRGID     INIT      "IBAOPR65"
PRGNAM    INIT      "Operation Type Summary"
VERSION   INIT      "V12.00.00"
.
.************************************************************************
.*                              MAIN LINE                               *
.************************************************************************
ML0000    CALL      INIT0000            
.
ML1000    CALL      SCRN0000                * Display main screen
          CALL      SLCT0000                * Get selection
          BRANCH    EXIT,ML9999             * exit?
.
ML2000    CALL      GTOP0000                * get operation type
.
ML3000    CALL      DTRN0000                * get date range
          BRANCH    EXIT,ML2000             * no date entered
.
          CALL      CONTQST                 * Ok. to continue ?
          BRANCH    CEXIT,ML4000:           * 'Y'es
                          ML5000:           * 'N'o
                          ML1000            * 'C'ancel
.
ML4000    CALL      PROC0000                * process and write to tempfile
          CALL      TEMP0000                * output tempfile
          GOTO      ML1000
.
ML5000    CALL      CLR0000                 * clear working variables 
          CALL      DISP0000                * re-display screen
          GOTO      ML2000
.
ML9999    CALL      KILL0000
          CHAIN     PGM
.
.************************************************************************
.*                              INIT0000                                *
.*            Display head, open file and read control file             *
.************************************************************************
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CNOUNDLN
.
          DISPLAY   *P50:24,"oprotsaf"
          OPEN      OPROTSA1,"oprotsaf"
.
          DISPLAY   *P50:24,"patcodes"
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P50:24,"controlf"
          OPEN      CONTROLF,"controlf"          
.
          READ      CONTROLF,FORTY;*143,OPCNBRKA:     * summary breakdowns
                                   *148,OPCNBRKB:
                                   *153,OPCNBRKC:
                                   *158,OPCNBRKD:
                                   *163,OPCNBRKE:
                                   *168,OPCNBRKF:
                                   *173,OPCNBRKG:
                                   *178,OPCNBRKH:
                                   *183,OPCNBRKI:
                                   *188,OPCNBRKJ:
                                   *193,OPCNBRKK:
                                   *198,OPCNBRKL
          READ      CONTROLF,FORTY2;*107,OPCNOTSU,*111,OPCNR65A,OPCNMM65
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,OPRTEMP1
.
          BRANCH    OPCNR65A,INIT9999
.
          MOVE      SP2,USERCAT
          LOAD      USERCAT,OPCNOTSU,CATZ1,CATZ2,CATZ3,CATZ4,CATZ5:
                                     CATZ6,CATZ7,CATZ8,CATY6,CATY7:
                                     CATY8,CATY9
.
          BRANCH    OPCNMM65,INIT1000
.
          MOVE      "Y  ",ACODE             * get the descriptions 
          PACK      KEY5,USERCAT,ACODE      * from the codes files
          CALL      RDCODE1
          MOVE      TDESC,USERYES
          MOVE      "N  ",ACODE
          PACK      KEY5,USERCAT,ACODE
          CALL      RDCODE1
          MOVE      TDESC,USERNO 
          GOTO      INIT9999
.
INIT1000  MOVE      "No of Major Cases",USERYES
          MOVE      "No of Minor Cases",USERNO 
.
INIT9999  RETURN
.
.************************************************************************
.*                              SCRN0000                                *
.*                  Display main options screen                         *
.************************************************************************
SCRN0000  HLINE     *G37,2,51,80
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = By Operation Type"
.
SCRN9999  RETURN
.
.************************************************************************
.*                              SLCT0000                                *
.*                        Get main selection                            *
.************************************************************************
SLCT0000  KEYIN     *P1:7,*EL,"Select Option : _":
                    *P17:7,*V2LON,OPTION
.
          COMPARE   ZERO,OPTION
          GOTO      SLCT9000 IF EQUAL
.
          DISPLAY   *P17:7,*EL,*V2LON,OPTION
.
          BRANCH    OPTION,SLCT8000
          BEEP
          GOTO      SLCT0000
.
SLCT8000  MOVE      ZERO,EXIT               * don't exit
          GOTO      SLCT9999
.
SLCT9000  MOVE      ONE,EXIT                * chose exit
.
SLCT9999  RETURN
.*************************************************************************
.*                        CLR0000                  Called by : ML0000    *
.*               clear working variables                                 *
.*************************************************************************
CLR0000   MOVE      SP3,OPER
          MOVE      SP20,TDESC
CLR9999   RETURN
.
.*************************************************************************
.*                           GTOP0000                                    *
.*                    Get operation type                                 *
.*                     called by : ML2000                                *[
.*************************************************************************
GTOP0000  CALL      CLR0000
          KEYIN     *P1:9,*EF,"Operation Type : ___",*V2LON,*P18:9,OPER:
                    *P18:9,*DV,OPER
.
          ENDSET    OPER
          APPEND    SP3,OPER
          RESET     OPER
. 
          MATCH     SP3,OPER                * nothing entered?
          GOTO      GTOP8500 IF EQUAL
.
          MATCH     QUEST,OPER              * question mark?
          GOTO      GTOP2000 IF EQUAL
.
          PACK      KEY5,OY,OPER            * valid operation type?
          CALL      RDCODE1
          BRANCH    OVRCD,GTOP1000
.
          DISPLAY   *P30:9,TDESC            * display description
          GOTO      GTOP8000
.
GTOP1000  DISPLAY   *P1:24,*EL,*B,"Invalid Operation Type. ";
          CALL      HITENTER
          GOTO      GTOP0000
.
GTOP2000  CALL      QEST0000                * question mark routine
          BRANCH    EXIT,GTOP8500
.
GTOP8000  MOVE      FALSE,EXIT
          GOTO      GTOP9999
.
GTOP8500  MOVE      "All operation types",TDESC
          DISPLAY   *P30:9,*EL,TDESC            * display description
.
GTOP9999  RETURN
.
.*************************************************************************
.*                           QEST0000                                    *
.*             Display all Operation Types on file                       *
.*                     called by : GTOP2000                              *
.*************************************************************************
QEST0000  MOVE      OY,CODE
          CALL      PATCODDS                * question mark on codes file
          CALL      CLR0000
.
QEST2000  KEYIN     *P1:24,*EL,"Operation Type : ___",*P18:24,*V2LON,OPER:
                    *DV,*P18:24,OPER;
.
          ENDSET    OPER
          APPEND    SP3,OPER
          RESET     OPER
.
          MATCH     SP3,OPER                * nothing entered?
          GOTO      QEST9000 IF EQUAL
.
          MATCH     QUEST,OPER              * question mark?
          GOTO      QEST0000 IF EQUAL
.
          PACK      KEY5,OY,OPER            * valid operation type?
          CALL      RDCODE1
          BRANCH    OVRCD,QEST4000
. 
.*** re-display screen
          CALL      DISP0000
.
          MOVE      FALSE,EXIT
          GOTO      QEST9999 
.
QEST4000  DISPLAY   *P1:24,*EL,*B,"Invalid Operation Type. ";
          CALL      HITENTER
          GOTO      QEST2000
.
QEST9000  CALL      DISP0000                 * redisplay screen
          MOVE      TRUE,EXIT
.
QEST9999  RETURN
.
.****************************************************************************   
.*                  DISP0000                                                *
.*             Re-display screen                                            *
.****************************************************************************
DISP0000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = By Operation Type":
                    *P1:7,"Select Option : ",*V2LON,OPTION,*HOFF:
                    *P1:9,"Operation type : ",*V2LON,OPER,*P30:9,*HOFF,TDESC
.
DISP9999  RETURN
.
.************************************************************************
.*                              DTRN0000                                *
.*                  Get date range to be printed                        *
.************************************************************************
DTRN0000  DISPLAY   *P1:11,*EL,"From Date  :"
          DISPLAY   *P1:12,*EL,"To Date    :"
.
.**** set up keydate parametres
.
          MOVE      TEN4,CCOL
          MOVE      TEN1,CVERT
          UNPACK    SP20,CCENT,CDAY,CMON,CYEAR   * clear variables
          MOVE      ZERO,CHIGHLT                 * highlight on
          MOVE      CCC,CCENT                    * default century
.
          CALL      KEYDATE                      * get a date
          BRANCH    CQUEST,DTRN0000
          BRANCH    OVRCD,DTRN8000               * no input
.
          PACK      DATEFR,CCENT,CYEAR,CMON,CDAY       * set up date from
          REP       " 0",DATEFR
          CALL      PACDATE
          MOVE      CPCDATE,PRDTFR           * print from date
.
.**** set keydate parametres
.
DTRN1500  MOVE      TEN4,CCOL
          MOVE      TEN2,CVERT
          MOVE      ZERO,CHIGHLT            * highlight on
          MOVE      CCC,CCENT               * default century
.
          CALL      KEYDATE
          BRANCH    CQUEST,DTRN1500
          BRANCH    OVRCD,DTRN0000
.
          PACK      DATETO,CCENT,CYEAR,CMON,CDAY       * set up date to
          REP       " 0",DATETO
          CALL      PACDATE
          MOVE      CPCDATE,PRDTTO           * print to   date
.
DTRN2000  MATCH     DATEFR,DATETO           * valid range?
          GOTO      DTRN3000 IF LESS
.
          MOVE      ZERO,EXIT
          GOTO      DTRN9999
.
DTRN3000  DISPLAY   *P1:24,*EL,*B,"Invalid date range. ";
          CALL      HITENTER
          GOTO      DTRN0000
.
DTRN8000  MOVE      ONE,EXIT            * nothing entered for start date
.
DTRN9999  RETURN
.
.*********************************************************************
.*                  PROC0000                    Called by : ML4000   *
.*        Process data to the temp file.                             *
.*********************************************************************
PROC0000  CALL      CREA0000                * create tempfile
          DISPLAY   *P50:24,*V2LON,"Processing";
          PACK      KEY15,DATEFR,OPER,SP10
          CALL      RSOPOTS1
.
PROC1000  CALL      RKOPOTS1                * read next record
          BRANCH    OVRCD,PROC9999
.
          MATCH     OPOTDATE,DATETO         * read too far?
          GOTO      PROC9999 IF LESS
.
          DISPLAY   *P65:24,OPOTDATE,SP1,OPOTTYPE
          MATCH     SP3,OPER
          GOTO      PROC1500 IF EQUAL       * using all operation types
.
          MATCH     OPER,OPOTTYPE
          GOTO      PROC1000 IF NOT EQUAL   * wrong operation type
.
.         set the key to temp file
.
PROC1500  COMPARE   TWO,OPCNR65A
          GOTO      PROC1600 IF EQUAL       * want the actual code
.
          MOVE      "zzz",OPOTUSER          * set the code
.
.         add the number of cases for OPOTUSER
.
PROC1600  MOVE      OPOTPERD,TEMPSUM        * set up sum. breakdown
          MOVE      "C",TEMPTYP             * C = cases
          MOVE      OPOTUSER,TEMPUSER       * user defined code
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPOTNCAS,FORM6          * set amount to add
          CALL      MTMP0000                * update temp file
.
.         GRAND TOTAL cases for OPOTUSER
.
          MOVE      ZED,TEMPSUM             * z = total 
          MOVE      "C",TEMPTYP             * C = cases
          MOVE      OPOTUSER,TEMPUSER       * user defined code
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPOTNCAS,FORM6          * set amount to add
          CALL      MTMP0000                * update temp file
.
.         add minutes record for OPOTUSER
.
          MOVE      OPOTPERD,TEMPSUM        * breakdown period
          MOVE      "M",TEMPTYP             * M = minutes
          MOVE      "zzz",TEMPUSER          * set user to zzz
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPOTTIME,FORM6          * set time to add
          CALL      MTMP0000
.
.         GRAND TOTAL minutes for OPOTUSER
.
          MOVE      ZED,TEMPSUM             * z = total
          MOVE      "M",TEMPTYP             * M = minutes
          MOVE      "zzz",TEMPUSER          * set user to zzz
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPOTTIME,FORM6          * set time to add
          CALL      MTMP0000
          MOVE      OPOTUSER,TEMPUSER       * restore user
.
.         the next two are only done for report type 2
.
          BRANCH    OPCNR65A,PROC1000       * in report layout 1
          MATCH     "zzz",TEMPUSER
          GOTO      PROC1000 IF EQUAL       * in report layout 1
.
.         TOTAL CASES for breakdown
.
          MOVE      OPOTPERD,TEMPSUM        * breakdown period
          MOVE      ANSC,TEMPTYP            * C = case record
          MOVE      "zzz",TEMPUSER          * total cases for temp user
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPOTNCAS,FORM6          * set amount to add
          CALL      MTMP0000
.
.         GRAND TOTAL cases 
.
          MOVE      ZED,TEMPSUM             * z = total
          MOVE      ANSC,TEMPTYP            * C = case record
          MOVE      "zzz",TEMPUSER          * total cases for temp user
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPOTNCAS,FORM6          * set amount to add
          CALL      MTMP0000
          GOTO      PROC1000
.
PROC9999  RETURN
.
.*************************************************************************
.*                           TEMP0000                                    *
.*              Print the contents of the tempfile                       *
.*                     called by : ML3000                                *
.*************************************************************************
TEMP0000  CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          CALL      HEAD0000
.
          DISPLAY   *P50:24,*V2LON,*EL,"Printing"
          CALL      DOA0000                 * print summary breakdown A
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOB0000                 * print summary breakdown B
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOC0000                 * print summary breakdown C
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOD0000                 * print summary breakdown D
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOE0000                 * print summary breakdown E
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOF0000                 * print summary breakdown F
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOG0000                 * print summary breakdown G
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOH0000                 * print summary breakdown H
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOI0000                 * print summary breakdown I
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOJ0000                 * print summary breakdown J
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOK0000                 * print summary breakdown K
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOL0000                 * print summary breakdown L
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOM0000                 * print summary breakdown M
.        
TEMP1000  CALL      TOT0000                 * print totals
          DISPLAY   *P50:24,*EL
.
TEMP9999  RETURN        
.
.*************************************************************************
.*                           DOA0000                                     *
.*          Print the records in summary breakdown A                     *
.*************************************************************************
DOA0000   MOVE      ZERO,PRTFLG
          MOVE      "00:00",FRTIME          * set up from time
          MATCH     "00:00",OPCNBRKA        * set up to time
          GOTO      DOA0500 IF EQUAL
          MOVE      OPCNBRKA,TOTIME
          GOTO      DOA0700
.
DOA0500   MOVE      OPCNBRKM,TOTIME    
.
DOA0700   COMPARE   TWO,OPCNR65A
          GOTO      DOA6500 IF EQUAL        * report type 2
.
.         Report layout 1
.         print the cases
.
          MOVE      "A",TEMPSUM             * set up summary breakdown
          MOVE      "C",TEMPTYP             * C = cases
          MOVE      " - ",SPSP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1                
.
          MOVE      CAS,LABEL               * set up label 
          CALL      PRNT0000                * print a line of output
.
.         print the minutes
.
          MOVE      "A",TEMPSUM
          MOVE      "M",TEMPTYP
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME             * clear times to print
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set up label
          CALL      PRNT0000
          GOTO      DOA7000
.
.         Report Layout 2
.
DOA6500   MOVE      "A",DIM1                * breakdown A
          CALL      PRNT0000
.
.         see if any more breakdowns to go
.
DOA7000   MATCH     OPCNBRKA,OPCNBRKM
          GOTO      DOA9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKA        * last breakdown ?
          GOTO      DOA9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOA8000 IF EQUAL
.
          PRINT     *N;
DOA8000   MOVE      FALSE,EXIT
          GOTO      DOA9999
.
DOA9000   MOVE      TRUE,EXIT
.         
DOA9999   RETURN
+
.*************************************************************************
.*                           DOB0000                                     *
.*          Print the records in summary breakdown B                     *
.*************************************************************************
DOB0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKA,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKB        * set up to time
          GOTO      DOB0500 IF EQUAL
          MOVE      OPCNBRKB,TOTIME
          GOTO      DOB0700
.
DOB0500   MOVE      OPCNBRKM,TOTIME    
.
DOB0700   COMPARE   TWO,OPCNR65A
          GOTO      DOB6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "B",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "B",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOB7000
.
.         Report Layout 2
.
DOB6500   MOVE      "B",DIM1                * breakdown B
          CALL      PRNT0000
.
DOB7000   MATCH     OPCNBRKB,OPCNBRKM
          GOTO      DOB9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKB
          GOTO      DOB9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOB8000 IF EQUAL
.
          PRINT     *N;
DOB8000   MOVE      FALSE,EXIT
          GOTO      DOB9999
.
DOB9000   MOVE      TRUE,EXIT
.         
DOB9999   RETURN
+
.*************************************************************************
.*                           DOC0000                                     *
.*          Print the records in summary breakdown C                     *
.*************************************************************************
DOC0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKB,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKC        * set up to time
          GOTO      DOC0500 IF EQUAL
          MOVE      OPCNBRKC,TOTIME
          GOTO      DOC0700
.
DOC0500   MOVE      OPCNBRKM,TOTIME    
.
DOC0700   COMPARE   TWO,OPCNR65A
          GOTO      DOC6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "C",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "C",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOB7000
.
.         Report Layout 2
.
DOC6500   MOVE      "C",DIM1                * breakdown C
          CALL      PRNT0000
.
DOC7000   MATCH     OPCNBRKC,OPCNBRKM
          GOTO      DOC9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKC
          GOTO      DOC9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOC8000 IF EQUAL
.
          PRINT     *N;
DOC8000   MOVE      FALSE,EXIT
          GOTO      DOC9999
.
DOC9000   MOVE      TRUE,EXIT
.         
DOC9999   RETURN
+
.*************************************************************************
.*                           DOD0000                                     *
.*          Print the records in summary breakdown D                     *
.*************************************************************************
DOD0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKC,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKD        * set up to time
          GOTO      DOD0500 IF EQUAL
          MOVE      OPCNBRKD,TOTIME
          GOTO      DOD0700
.
DOD0500   MOVE      OPCNBRKM,TOTIME    
.
DOD0700   COMPARE   TWO,OPCNR65A
          GOTO      DOD6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "D",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "D",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      MIN,LABEL               * set print type
          MOVE      SP3,SPSP
          CALL      PRNT0000
          GOTO      DOD7000
.
.         Report Layout 2
.
DOD6500   MOVE      "D",DIM1                * breakdown D
          CALL      PRNT0000
.
DOD7000   MATCH     OPCNBRKD,OPCNBRKM
          GOTO      DOD9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKD
          GOTO      DOD9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOD8000 IF EQUAL
.
          PRINT     *N;
DOD8000   MOVE      FALSE,EXIT
          GOTO      DOD9999
.
DOD9000   MOVE      TRUE,EXIT
.         
DOD9999   RETURN
.
.*************************************************************************
.*                           DOE0000                                     *
.*          Print the records in summary breakdown E                     *
.*************************************************************************
DOE0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKD,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKE        * set up to time
          GOTO      DOE0500 IF EQUAL
          MOVE      OPCNBRKE,TOTIME
          GOTO      DOE0700
.
DOE0500   MOVE      OPCNBRKM,TOTIME    
.
DOE0700   COMPARE   TWO,OPCNR65A
          GOTO      DOE6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "E",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "E",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          REP       "C1M2",TEMPTYP
          CALL      PRNT0000
          GOTO      DOE7000
.
.         Report Layout 2
.
DOE6500   MOVE      "E",DIM1                * breakdown E
          CALL      PRNT0000
.
DOE7000   MATCH     OPCNBRKE,OPCNBRKM
          GOTO      DOE9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKE
          GOTO      DOE9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOE8000 IF EQUAL
.
          PRINT     *N;
DOE8000   MOVE      FALSE,EXIT
          GOTO      DOE9999
.
DOE9000   MOVE      TRUE,EXIT
.         
DOE9999   RETURN
+
.*************************************************************************
.*                           DOF0000                                     *
.*          Print the records in summary breakdown F                     *
.*************************************************************************
DOF0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKE,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKF        * set up to time
          GOTO      DOF0500 IF EQUAL
          MOVE      OPCNBRKF,TOTIME
          GOTO      DOF0700
.
DOF0500   MOVE      OPCNBRKM,TOTIME    
.
DOF0700   COMPARE   TWO,OPCNR65A
          GOTO      DOF6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "F",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "F",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOF7000
.
.         Report Layout 2
.
DOF6500   MOVE      "F",DIM1                * breakdown F
          CALL      PRNT0000
.
DOF7000   MATCH     OPCNBRKF,OPCNBRKM
          GOTO      DOF9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKF
          GOTO      DOF9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOF8000 IF EQUAL
.
          PRINT     *N;
DOF8000   MOVE      FALSE,EXIT
          GOTO      DOF9999
.
DOF9000   MOVE      TRUE,EXIT
.         
DOF9999   RETURN
+
.*************************************************************************
.*                           DOG0000                                     *
.*          Print the records in summary breakdown G                     *
.*************************************************************************
DOG0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKF,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKG        * set up to time
          GOTO      DOG0500 IF EQUAL
          MOVE      OPCNBRKG,TOTIME
          GOTO      DOG0700
.
DOG0500   MOVE      OPCNBRKM,TOTIME    
.
DOG0700   COMPARE   TWO,OPCNR65A
          GOTO      DOG6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "G",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "G",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOG7000
.
.         Report Layout 2
.
DOG6500   MOVE      "G",DIM1                * breakdown G
          CALL      PRNT0000
.
DOG7000   MATCH     OPCNBRKG,OPCNBRKM
          GOTO      DOG9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKG
          GOTO      DOG9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOG8000 IF EQUAL
.
          PRINT     *N;
DOG8000   MOVE      FALSE,EXIT
          GOTO      DOG9999
.
DOG9000   MOVE      TRUE,EXIT
.         
DOG9999   RETURN
+
.*************************************************************************
.*                           DOH0000                                     *
.*          Print the records in summary breakdown H                     *
.*************************************************************************
DOH0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKG,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKH        * set up to time
          GOTO      DOH0500 IF EQUAL
          MOVE      OPCNBRKH,TOTIME
          GOTO      DOH0700
.
DOH0500   MOVE      OPCNBRKM,TOTIME    
.
DOH0700   COMPARE   TWO,OPCNR65A
          GOTO      DOH6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "H",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "H",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOH7000
.
.         Report Layout 2
.
DOH6500   MOVE      "H",DIM1                * breakdown H
          CALL      PRNT0000
.
DOH7000   MATCH     OPCNBRKH,OPCNBRKM
          GOTO      DOH9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKH
          GOTO      DOH9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOH8000 IF EQUAL
.
          PRINT     *N;
DOH8000   MOVE      FALSE,EXIT
          GOTO      DOH9999
.
DOH9000   MOVE      TRUE,EXIT
.         
DOH9999   RETURN
+
.*************************************************************************
.*                           DOI0000                                     *
.*          Print the records in summary breakdown I                     *
.*************************************************************************
DOI0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKH,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKI        * set up to time
          GOTO      DOI0500 IF EQUAL
          MOVE      OPCNBRKI,TOTIME
          GOTO      DOI0700
.
DOI0500   MOVE      OPCNBRKM,TOTIME    
.
DOI0700   COMPARE   TWO,OPCNR65A
          GOTO      DOI6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "I",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "I",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOI7000
.
.         Report Layout 2
.
DOI6500   MOVE      "I",DIM1                * breakdown I
          CALL      PRNT0000
.
DOI7000   MATCH     OPCNBRKI,OPCNBRKM
          GOTO      DOI9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKI
          GOTO      DOI9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOI8000 IF EQUAL
.
          PRINT     *N;
DOI8000   MOVE      FALSE,EXIT
          GOTO      DOI9999
.
DOI9000   MOVE      TRUE,EXIT
.         
DOI9999   RETURN
+
.*************************************************************************
.*                           DOJ0000                                     *
.*          Print the records in summary breakdown J                     *
.*************************************************************************
DOJ0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKI,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKJ        * set up to time
          GOTO      DOJ0500 IF EQUAL
          MOVE      OPCNBRKJ,TOTIME
          GOTO      DOJ0700
.
DOJ0500   MOVE      OPCNBRKM,TOTIME    
.
DOJ0700   COMPARE   TWO,OPCNR65A
          GOTO      DOJ6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "J",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "J",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOJ7000
.
.         Report Layout 2
.
DOJ6500   MOVE      "J",DIM1                * breakdown J
          CALL      PRNT0000
.
DOJ7000   MATCH     OPCNBRKJ,OPCNBRKM
          GOTO      DOJ9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKJ
          GOTO      DOJ9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOJ8000 IF EQUAL
.
          PRINT     *N;
DOJ8000   MOVE      FALSE,EXIT
          GOTO      DOJ9999
.
DOJ9000   MOVE      TRUE,EXIT
.         
DOJ9999   RETURN
+
.*************************************************************************
.*                           DOK0000                                     *
.*          Print the records in summary breakdown K                     *
.*************************************************************************
DOK0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKJ,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKK        * set up to time
          GOTO      DOK0500 IF EQUAL
          MOVE      OPCNBRKK,TOTIME
          GOTO      DOK0700
.
DOK0500   MOVE      OPCNBRKM,TOTIME    
.
DOK0700   COMPARE   TWO,OPCNR65A
          GOTO      DOK6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "K",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "K",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOK7000
.
.         Report Layout 2
.
DOK6500   MOVE      "K",DIM1                * breakdown K
          CALL      PRNT0000
.
DOK7000   MATCH     OPCNBRKK,OPCNBRKM
          GOTO      DOK9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKK
          GOTO      DOK9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOK8000 IF EQUAL
.
          PRINT     *N;
DOK8000   MOVE      FALSE,EXIT
          GOTO      DOK9999
.
DOK9000   MOVE      TRUE,EXIT
.         
DOK9999   RETURN
+
.*************************************************************************
.*                           DOL0000                                     *
.*          Print the records in summary breakdown L                     *
.*************************************************************************
DOL0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKK,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKL        * set up to time
          GOTO      DOL0500 IF EQUAL
          MOVE      OPCNBRKL,TOTIME
          GOTO      DOL0700
.
DOL0500   MOVE      OPCNBRKM,TOTIME    
.
DOL0700   COMPARE   TWO,OPCNR65A
          GOTO      DOL6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "L",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "L",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOL7000
.
.         Report Layout 2
.
DOL6500   MOVE      "L",DIM1                * breakdown L
          CALL      PRNT0000
.
DOL7000   MATCH     OPCNBRKL,OPCNBRKM
          GOTO      DOL9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKL
          GOTO      DOL9000 IF EQUAL
.
          COMPARE   ZERO,PRTFLG
          GOTO      DOL8000 IF EQUAL
.
          PRINT     *N;
DOL8000   MOVE      FALSE,EXIT
          GOTO      DOL9999
.
DOL9000   MOVE      TRUE,EXIT
.         
DOL9999   RETURN
+
.*************************************************************************
.*                           DOM0000                                     *
.*          Print the records in summary breakdown M                     *
.*************************************************************************
DOM0000   MOVE      ZERO,PRTFLG
          MOVE      OPCNBRKL,FRTIME         * set up from time
          MOVE      OPCNBRKM,TOTIME         * set up end time
.
          COMPARE   TWO,OPCNR65A
          GOTO      DOM6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "M",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      OPCNBRKL,FRTIME
          MOVE      OPCNBRKM,TOTIME
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print minutes
.
          MOVE      "M",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOM9999
.
.         Report Layout 2
.
DOM6500   MOVE      "M",DIM1                * breakdown M
          CALL      PRNT0000
.
DOM9999   RETURN
+
.*********************************************************************
.*                  MTMP0000                    Called by : PROC0000 *
.*        Para's  : KEY5          period/type/user                   *
.*                  FORM6         amount to add                      *
.*                  OPOTDOFW      day of the week                    *
.*********************************************************************
MTMP0000  CALL      CLVR0000                * clear the variables
          CALL      RDOPTP1                 * read temp file
.
.         update record
.
          LOAD      TEMP,OPOTDOFW,TEMPMOCT,TEMPTUCT,TEMPWECT,TEMPTHCT:
                                  TEMPFRCT,TEMPSACT,TEMPSUCT
          ADD       FORM6,TEMP
          STORE     TEMP,OPOTDOFW,TEMPMOCT,TEMPTUCT,TEMPWECT,TEMPTHCT:
                                  TEMPFRCT,TEMPSACT,TEMPSUCT
.
          BRANCH    OVRCD,MTMP5000          * go and write 
.
          CALL      UPOPTP1                 * update record
          GOTO      MTMP9999
.
MTMP5000  CALL      WROPTP1                 * write new record
.
MTMP9999  RETURN
+
.*********************************************************************
.*                  TOT0000                     Called by : PROC1000 *
.*        Print the line of totals at bottom of page                 *
.*********************************************************************
TOT0000   BRANCH    OPCNR65A,TOT1000,TOT2000
          GOTO      TOT9999
.
.         Report Layout 1
.
TOT1000   CALL      UND132
          MOVE      "zzz",ACODE
          PACK      KEY5,ZED,ANSC,ACODE
          CALL      RDOPTP1
          PRINT     "Total Number of Cases",*34,TEMPMOCT,*46,TEMPTUCT:
                    *58,TEMPWECT,*70,TEMPTHCT,*82,TEMPFRCT,*94,TEMPSACT:
                    *107,TEMPSUCT;
          MOVE      ZERO,TOTCAS
          ADD       TEMPMOCT,TOTCAS
          ADD       TEMPTUCT,TOTCAS
          ADD       TEMPWECT,TOTCAS
          ADD       TEMPTHCT,TOTCAS
          ADD       TEMPFRCT,TOTCAS
          ADD       TEMPSACT,TOTCAS
          ADD       TEMPSUCT,TOTCAS
          PRINT     *118,TOTCAS
.
          MOVE      "zzz",ACODE
          PACK      KEY5,ZED,ANSM,ACODE
          CALL      RDOPTP1
          PRINT     "Total Minutes Used   ",*34,TEMPMOCT,*46,TEMPTUCT:
                    *58,TEMPWECT,*70,TEMPTHCT,*82,TEMPFRCT,*94,TEMPSACT:
                    *107,TEMPSUCT;
          MOVE      ZERO,TOTCAS
          ADD       TEMPMOCT,TOTCAS
          ADD       TEMPTUCT,TOTCAS
          ADD       TEMPWECT,TOTCAS
          ADD       TEMPTHCT,TOTCAS
          ADD       TEMPFRCT,TOTCAS
          ADD       TEMPSACT,TOTCAS
          ADD       TEMPSUCT,TOTCAS
          PRINT     *118,TOTCAS
.
          CALL      UND132
          PRINT     *N,"Total Minutes Used   = Theatre duration"
          PRINT     *N," *** End of Report ***",*N
          GOTO      TOT9999
.
.         Report Layout 2
.
TOT2000   CALL      UND132
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS    * print new heading
.
          MOVE      ZED,DIM1
          CALL      PRNT0000
          CALL      UND132
          PRINT     *N,"Total Minutes Used   = Theatre duration"
          PRINT     *N," *** End of Report ***",*N
.
TOT9999   RETURN
+
.*********************************************************************
.*                  PRNT0000                    Called by : lots     * 
.*        Print a line of code                                       *
.*        Para's  : DIM1          breakdown code for layout 2        *
.*********************************************************************
PRNT0000  MOVE      ZERO,HEADFLG
          BRANCH    OPCNR65A,PRNT1000,PRNT2000
          GOTO      PRNT9999
.
.         Report Layout 1
.
PRNT1000  MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          COMPARE   ZERO,TOTAL
          GOTO      PRNT9999 IF EQUAL       * dont print zero totals
.
          PRINT     FRTIME,SPSP,TOTIME,LABEL,*34,TEMPMOCT,*46,TEMPTUCT:
                    *58,TEMPWECT,*70,TEMPTHCT,*82,TEMPFRCT,*94,TEMPSACT:
                    *107,TEMPSUCT,*118,TOTAL
          ADD       ONE,CLNO
          MOVE      ONE,PRTFLG
          GOTO      PRNT9999
.
.         Report Layout 2
.
PRNT2000  COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS    * print new heading
.
. ******* print number of major cases *******
.
          MOVE      "Y  ",ACODE             * major cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
.
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
.
          COMPARE   ZERO,TOTAL
          GOTO      PRNT2100 IF EQUAL       * dont print zero totals
.
          MATCH     ZED,DIM1
          GOTO      PRNT2040 IF EQUAL       * printing grand total
.
          PRINT     FRTIME," - ",TOTIME;
          MOVE      ONE,HEADFLG
          GOTO      PRNT2050
.
PRNT2040  PRINT     "GRAND TOTAL   ";
          MOVE      ONE,HEADFLG
.
PRNT2050  PRINT     *15,USERYES,*39,TEMPMOCT,*51,TEMPTUCT,*63,TEMPWECT:
                    *75,TEMPTHCT,*87,TEMPFRCT,*99,TEMPSACT,*111,TEMPSUCT:
                    *123,TOTAL
          MOVE      ONE,PRTFLG
          ADD       ONE,CLNO
.
. ******* print number of minor cases *******
.
PRNT2100  MOVE      "N  ",ACODE             * minor cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
.
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
.
          COMPARE   ZERO,TOTAL
          GOTO      PRNT2300 IF EQUAL       * dont print zero totals
.
          MATCH     ZED,DIM1
          GOTO      PRNT2150 IF EQUAL       * printing grand total
.
          BRANCH    HEADFLG,PRNT2200
          PRINT     FRTIME," - ",TOTIME;
          MOVE      ONE,HEADFLG
          GOTO      PRNT2200
.
PRNT2150  BRANCH    HEADFLG,PRNT2200
          PRINT     "GRAND TOTAL   ";
          MOVE      ONE,HEADFLG
.
PRNT2200  PRINT     *15,USERNO,*39,TEMPMOCT,*51,TEMPTUCT,*63,TEMPWECT:
                    *75,TEMPTHCT,*87,TEMPFRCT,*99,TEMPSACT,*111,TEMPSUCT:
                    *123,TOTAL
          MOVE      ONE,PRTFLG
          ADD       ONE,CLNO
.
. ******* print number of unknown cases *******
.
PRNT2300  MOVE      SP3,ACODE               * unknown cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
.
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
.
          COMPARE   ZERO,TOTAL
          GOTO      PRNT2500 IF EQUAL       * dont print zero totals
.
          MATCH     ZED,DIM1
          GOTO      PRNT2350 IF EQUAL       * printing grand total
.
          BRANCH    HEADFLG,PRNT2400
          PRINT     FRTIME," - ",TOTIME;
          MOVE      ONE,HEADFLG
          GOTO      PRNT2400
.
PRNT2350  BRANCH    HEADFLG,PRNT2400
          PRINT     "GRAND TOTAL   ";
          MOVE      ONE,HEADFLG
.
PRNT2400  PRINT     *15,"No Code Entered",*39,TEMPMOCT,*51,TEMPTUCT:
                    *63,TEMPWECT,*75,TEMPTHCT,*87,TEMPFRCT,*99,TEMPSACT:
                    *111,TEMPSUCT,*123,TOTAL
          MOVE      ONE,PRTFLG
          ADD       ONE,CLNO
.
. ******* print total number of cases *******
.
PRNT2500  MOVE      "zzz",ACODE             * total number of cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
.
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
.
          COMPARE   ZERO,TOTAL
          GOTO      PRNT2700 IF EQUAL       * dont print zero totals
.
          MATCH     ZED,DIM1
          GOTO      PRNT2550 IF EQUAL       * printing grand total
.
          BRANCH    HEADFLG,PRNT2600
          PRINT     FRTIME," - ",TOTIME;
          MOVE      ONE,HEADFLG
          GOTO      PRNT2600
.
PRNT2550  BRANCH    HEADFLG,PRNT2600
          PRINT     "GRAND TOTAL   ";
          MOVE      ONE,HEADFLG
.
PRNT2600  PRINT     *15,"Total Number of Cases",*39,TEMPMOCT,*51,TEMPTUCT:
                    *63,TEMPWECT:
                    *75,TEMPTHCT,*87,TEMPFRCT,*99,TEMPSACT,*111,TEMPSUCT;
          PRINT     *123,TOTAL
          MOVE      ONE,PRTFLG
          ADD       ONE,CLNO
.
. ******* print total number of minutes *******
.
PRNT2700  MOVE      "zzz",ACODE             * total minutes used
          PACK      KEY5,DIM1,ANSM,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
.
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
.
          COMPARE   ZERO,TOTAL
          GOTO      PRNT9999 IF EQUAL       * dont print zero totals
.
          MATCH     ZED,DIM1
          GOTO      PRNT2750 IF EQUAL       * We are printing grand total
.
          BRANCH    HEADFLG,PRNT2800
          PRINT     FRTIME," - ",TOTIME;
          MOVE      ONE,HEADFLG
          GOTO      PRNT2800
.
PRNT2750  BRANCH    HEADFLG,PRNT2800
          PRINT     "GRAND TOTAL   ";
          MOVE      ONE,HEADFLG
.
PRNT2800  PRINT     *15,"Total Minutes Used",*39,TEMPMOCT,*51,TEMPTUCT:
                    *63,TEMPWECT:
                    *75,TEMPTHCT,*87,TEMPFRCT,*99,TEMPSACT,*111,TEMPSUCT;
          PRINT     *123,TOTAL
          MOVE      ONE,PRTFLG
          ADD       ONE,CLNO
.
PRNT9999  RETURN
.
.*********************************************************************
.*                  HEAD0000                                         *
.*        Print Heading                                              *
.*********************************************************************
HEAD0000  BRANCH    OPCNR65A,HEAD1000,HEAD2000
          GOTO      HEAD9999
.
.         Report Layout 1
.
HEAD1000  CALL      HEAD132
          PRINT     *N,*40,"Operation Type : ",OPER,SP2,TDESC:
                    *N,*N,*40,"From : ",PRDTFR," To : ",PRDTTO,*N
          CALL      UND132
          PRINT     "Time Periods",*32,"Monday",*44,"Tuesday",*56:
                    "Wednesday",*68,"Thursday",*80,"Friday",*93,"Saturday":
                    *104,"Sunday",*121,"TOTAL"
          CALL      UND132
          MOVE      "10",CLNO
          GOTO      HEAD9999
.
.         Report Layout 2
.
HEAD2000  CALL      HEAD132
          PRINT     *N,*40,"Operation Type : ",OPER,SP2,TDESC:
                    *N,*N,*40,"From : ",PRDTFR," To : ",PRDTTO,*N
          CALL      UND132
          PRINT     "Time Periods",*39,"Monday",*50,"Tuesday",*60:
                    "Wednesday",*73,"Thursday",*87,"Friday",*97,"Saturday":
                    *111,"Sunday",*126,"TOTAL"
          CALL      UND132
          MOVE      "12",CLNO
          GOTO      HEAD9999
.
HEAD9999  RETURN
+
.*********************************************************************
.*                  CLVR0000                                         *
.*        Clears working variables                                   *
.*********************************************************************
CLVR0000  MOVE      ZERO,TEMPMOCT
          MOVE      ZERO,TEMPTUCT
          MOVE      ZERO,TEMPWECT
          MOVE      ZERO,TEMPTHCT
          MOVE      ZERO,TEMPFRCT
          MOVE      ZERO,TEMPSACT
          MOVE      ZERO,TEMPSUCT
          MOVE      ZERO,TOTAL
CLVR9999  RETURN
+
.**********************************************************************
.*                  CREA0000                                          *
.*        Create the Indexed Temp File                                *
.**********************************************************************
CREA0000  CALL      KILL0000                       * kill existing temp file
          CLEAR     CMDLINE
          PACK      CMDLINE,ISBUILD,OPRTEMP1,KEYA,SP20
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      TEMPFIL1,OPRTEMP1
.
CREA9999  RETURN
+
.**********************************************************************
.*                              KILL0000                              *
.*                  Kill the Tempfile if it Already Exists            *
.**********************************************************************
KILL0000  CLEAR     CMDLINE
          CLOSE     TEMPFIL1
          PACK      CMDLINE,ISERASE,OPRTEMP1
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
KILL9999  RETURN
+
.************************************************************************
.*                           I/O                                        *
.*               I/O routines for temp file                             *
.************************************************************************
RAOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READ      TEMPFIL1,KEY5;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READ      TEMPFIL1,KEY5;;
          RETURN
.
RDOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READ      TEMPFIL1,KEY5;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                                  TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          GOTO      OVERCOND IF OVER
          RETURN
.
RKOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READKS    TEMPFIL1;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                             TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          GOTO      OVERCOND IF OVER
          RETURN
.
RPOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READKP    TEMPFIL1;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                             TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          GOTO      OVERCOND IF OVER
          RETURN
.
WROPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          WRITE     TEMPFIL1,KEY5;KEY5,TEMPMOCT,TEMPTUCT,TEMPWECT: 
                             TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          RETURN
.
UPOPTP1   UPDATE    TEMPFIL1;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                             TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          RETURN
.
DEOPTP1   RESET     KEY5
          DELETE    TEMPFIL1,KEY2
          RETURN
.
.
.         I/O includes needed
.
          INC       STD001IO
          INC       TFILENAM                * Generate Temp File Name
          INC       IBASEQIO/INC            * Sequential Numbers File
          INC       WEBERRIO/INC            * Web Server Error Logging
.
          INC       OPROTSIO/INC
          INC       PATCODKY
          INC       PATCODIO/INC
...............................................................................
