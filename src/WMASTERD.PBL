.
. Program  : WMASTERD
.
. Function : Master Program for Development
.            (NO PROGRAM RESTART)
.
          INC       IBAWEBDF    
          INC       PATCONFD/INC
.
PRGID     INIT      "WMASTERD"
PRGNAM    INIT      "Web Master Error Control Program - Development"
VERSION   INIT      "V12.00.00"
.
          OPEN      CONTROLF,"controlf"
          OPEN      WEBERRA1,"weberraf"
          CALL      IBACLOCK
.
MAIN1000  CLOCK     TIME,CTIMEIS
.
          MOVE      ZERO,F1
          MOVE      EXITFLAG,F1
          BRANCH    F1,MAIN9000
.
          PACK      KEY24,SERVERID,CCC,CYY,CMM,CDD,CTIMEIS,SP70
          REP       " 0",KEY24
          CALL      RDWBER1
          IF        OVRCD=0
            GOTO      MAIN1000
          ENDIF
          UNPACK    KEY24,WBERPID,WBERDAT,WBERTIM
          MOVE      PRGERROR,WBERERR
          MOVE      USERID,WBERUID
          MOVE      REPORTNO,WBERREP
          MOVE      TEMPLATE,WBERTMP
          MOVE      URNUMBER,WBERURN
          MOVE      ADMISSNO,WBERVIS
          MOVE      PRGERRCT,F3
          MOVE      F3,WBERCNT
          MOVE      SP70,WBERSPA
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRWBER1
          TRAPCLR   IO
.
          MOVE      PRGERRCT,F3
          ADD       "1",F3
          MOVE      F3,PRGERRCT
..          IF        F3<10
..            TRAP      MAIN9999 IF CFAIL
..            CHAIN     SERVERID
..          ENDIF
.
          GOTO      MAIN9999
.
MAIN9000  PACK      KEY24,SERVERID,CCC,CYY,CMM,CDD,CTIMEIS,SP70
          REP       " 0",KEY24
          CALL      RDWBER1
          IF        OVRCD=0
            GOTO      MAIN1000
          ENDIF
          UNPACK    KEY24,WBERPID,WBERDAT,WBERTIM
          MOVE      "Clean Shutdown Triggered",WBERERR
          MOVE      SP70,WBERUID
          MOVE      SP70,WBERREP
          MOVE      SP70,WBERTMP
          MOVE      SP70,WBERURN
          MOVE      SP70,WBERVIS
          MOVE      PRGERRCT,F3
          MOVE      F3,WBERCNT
          MOVE      SP70,WBERSPA
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          CALL      WRWBER1
          TRAPCLR   IO
.
MAIN9999  SHUTDOWN  ""
.------------------------------------------------------------
. Dummy Labels for Web Common Routines (NOT USED)
.------------------------------------------------------------
PROFLD00
SETPAR00
CLRPAR00  RETURN
.
          INC       IBAWEBCD    
