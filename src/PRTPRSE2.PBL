          INC       STD001FD
.
TEMP1     FILE      ASCII, FIXED=240
TEMP2     IFILE     SQL, FIXED=240, KEY="U9-16"
.
.Name     Type   Length  Physical  Start  Description
.----     ----   ------  --------  -----  -----------
E2        DIM       2        2       1    Transaction type - E2
UNIQKEY   DIM       6        6       3    Unique key - episode no / admin no
EPIURNO   DIM       8        8       9    U/R number
EPISITID  DIM       1        1       17   Site id
EPIMEDI   DIM      11       11       18   Medicare number
EPIMCSFX  DIM       3        3       29   Medicare suffix
EPISEX    DIM       1        1       32   Sex
EPIMSTAT  DIM       1        1       33   Marital status
EPIBDATE  DIM       8        8       34   Date of birth (ddmmccyy)
EPIPOST   DIM       4        4       42   Postcode
EPISUBRB  DIM      22       22       46   Suburb/Locality
EPIADATR  DIM       8        8       68   Admission date (ddmmyy)
EPIATIME  DIM       4        4       76   Admission time
EPIATYPE  DIM       1        1       80   Admission type
EPIASRCE  DIM       1        1       81   Admission source
EPITSRCE  DIM       4        4       82   Transfer source code
.
EPILVMTD  DIM       2        2       86   Month to date leave days
EPILVTOT  DIM       3        3       88   Year to date leave days
EPILVYTD  DIM       3        3       91   Total leave days
.
EPIACST1  DIM       2        2       94   1st episode account status
EPIATYP1  DIM       1        1       96   1st episode Accommodation type
EPIQTYP1  DIM       1        1       97   1st episode qualification status
EPIABDP1  DIM       2        2       98   1st episode period to date bed days
EPIABDY1  DIM       3        3      100   1st episode year to date bed days
EPIABDA1  DIM       4        4      103   1st episode total bed days
.
EPIACST2  DIM       2        2      107   2nd episode account status
EPIATYP2  DIM       1        1      109   2nd episode Accommodation type
EPIQTYP2  DIM       1        1      110   2nd episode qualification status
EPIABDP2  DIM       2        2      111   2nd episode period to date bed days
EPIABDY2  DIM       3        3      113   2nd episode year to date bed days
EPIABDA2  DIM       4        4      116   2nd episode total bed days
.
EPIACST3  DIM       2        2      120   3rd episode account status
EPIATYP3  DIM       1        1      122   3rd episode Accommodation type
EPIQTYP3  DIM       1        1      123   3rd episode qualification status
EPIABDP3  DIM       2        2      124   3rd episode period to date bed days
EPIABDY3  DIM       3        3      126   3rd episode year to date bed days
EPIABDA3  DIM       4        4      129   3rd episode total bed days
.
EPIACST4  DIM       2        2      133   4th episode account status
EPIATYP4  DIM       1        1      135   4th episode Accommodation type
EPIQTYP4  DIM       1        1      136   4th episode qualification status
EPIABDP4  DIM       2        2      137   4th episode period to date bed days
EPIABDY4  DIM       3        3      139   4th episode year to date bed days
EPIABDA4  DIM       4        4      142   4th episode total bed days
.
EPIACST5  DIM       2        2      146   5th episode account status
EPIATYP5  DIM       1        1      148   5th episode Accommodation type
EPIQTYP5  DIM       1        1      149   5th episode qualification status
EPIABDP5  DIM       2        2      150   5th episode period to date bed days
EPIABDY5  DIM       3        3      152   5th episode year to date bed days
EPIABDA5  DIM       4        4      155   5th episode total bed days
.
EPIACST6  DIM       2        2      159   6th episode account status
EPIATYP6  DIM       1        1      161   6th episode Accommodation type
EPIQTYP6  DIM       1        1      162   6th episode qualification status
EPIABDP6  DIM       2        2      163   6th episode period to date bed days
EPIABDY6  DIM       3        3      165   6th episode year to date bed days
EPIABDA6  DIM       4        4      168   6th episode total bed days
.
EPIACST7  DIM       2        2      172   7th episode account status
EPIATYP7  DIM       1        1      174   7th episode Accommodation type
EPIQTYP7  DIM       1        1      175   7th episode qualification status
EPIABDP7  DIM       2        2      176   7th episode period to date bed days
EPIABDY7  DIM       3        3      178   7th episode year to date bed days
EPIABDA7  DIM       4        4      181   7th episode total bed days
.
EPISDATE  DIM       8        8      185   Separation date (ddmmccyy)
EPISTIME  DIM       4        4      193   Separation time
EPISTYPE  DIM       1        1      197   Separation type
EPISTRFR  DIM       4        4      198   Separation transfer/trans. destinatn
EPISREFL  DIM       4        4      202   Separation referral
EPICAVAL  DIM       1        1      206   Carer Availability
EPISACST  DIM       2        2      207   Separation account status/class
EPISATYP  DIM       1        1      209   Separation Accommodation type
EPISCTYP  DIM       1        1      210   Care type
EPNEWCOB  DIM       4        4      211   Country of birth code
EPABRGNL  DIM       1        1      215   Aboriginality
EPADCRTN  DIM       1        1      216   Criterion for admission
EPIINLOS  DIM       1        1      217   Intended LOS
EPHLTHFD  DIM       3        3      218   Health insurance fund
EPILINSR  DIM       1        1      221   Level of Insurance
EPIMNTLS  DIM       1        1      222   Mental health legal status
EPIPRGFS  DIM       1        1      223   Program funding source
EPISPFDA  DIM       1        1      224   Funding arrangement
EPICTTYP  DIM       1        1      225   Contract Type
EPICTROL  DIM       1        1      226   Contract Role
EPICTRID  DIM       4        4      227   Contract/Spoke Identifier
EPIPDCLD  DIM       2        2      231   Contract leave days (MTD)
EPIYDCLD  DIM       2        2      233   Contract leave days (YTD)
EPITLCLD  DIM       2        2      235   Total contract leave days
EPIUSERF  DIM       1        1      237   User flag
.SP3      DIM       3        3      338   3 spaces
.
.End of Record                      241
.
FILENAME  DIM       8
URNO      DIM       8
RECCNT    FORM      5
.
PRGID     INIT      "PRTPRSE2"
PRGNAM    INIT      "Print PRS/2 E2 Record"
VERSION   INIT      "V12.00.00"
.
ML0000    CALL      DISPHEAD
          MOVE      ZERO,RECCNT
          DISPLAY   *P1:4,*EF,"PRS/2 Filename : ";
ML1000    KEYIN     *P18:4,*EL,*V2LON,FILENAME;
.
          PACK      FILENAME,FILENAME,SP8
          MATCH     SP8,FILENAME
          GOTO      ML9999 IF EQUAL
.
          STRIP     FILENAME
          MOVE      "/XMT",KEY4
          PACK      KEY12,FILENAME,KEY4
          DISPLAY   *P18:4,*EL,*V2LON,*+,FILENAME,".XMT";
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMP1,KEY12
          TRAPCLR   IO
          IF        OVRCD=1
            DISPLAY   *P1:24,*EL,*B,"Filename not found.  "
            CALL      HITENTER
            GOTO      ML1000
          ENDIF
.
          DISPLAY   *P1:23,*V2LON,*BLINKON,"Loading Tempfile ...":
                    *P1:24,*HOFF,"Loading : ";
.
          MOVE      "isbuild ",KEY8
          MOVE      " 240 U9-16",KEY10
          PACK      KEY26,KEY8,FILENAME,KEY10,SP30
          STRIP     KEY26
          EXECUTE   KEY26,TASKID
          OPEN      TEMP2,FILENAME
.
ML2000    READ      TEMP1,SEQ;E2,UNIQKEY,EPIURNO,EPISITID,EPIMEDI:
                              EPIMCSFX,EPISEX,EPIMSTAT,EPIBDATE,EPIPOST:
                              EPISUBRB,EPIADATR,EPIATIME,EPIATYPE,EPIASRCE:
                              EPITSRCE,EPILVMTD,EPILVTOT,EPILVYTD,EPIACST1:
                              EPIATYP1,EPIQTYP1,EPIABDP1,EPIABDY1,EPIABDA1:
                              EPIACST2,EPIATYP2,EPIQTYP2,EPIABDP2,EPIABDY2:
                              EPIABDA2,EPIACST3,EPIATYP3,EPIQTYP3,EPIABDP3:
                              EPIABDY3,EPIABDA3,EPIACST4,EPIATYP4,EPIQTYP4:
                              EPIABDP4,EPIABDY4,EPIABDA4,EPIACST5,EPIATYP5:
                              EPIQTYP5,EPIABDP5,EPIABDY5,EPIABDA5,EPIACST6:
                              EPIATYP6,EPIQTYP6,EPIABDP6,EPIABDY6,EPIABDA6:
                              EPIACST7,EPIATYP7,EPIQTYP7,EPIABDP7,EPIABDY7:
                              EPIABDA7,EPISDATE,EPISTIME,EPISTYPE,EPISTRFR:
                              EPISREFL,EPICAVAL,EPISACST,EPISATYP,EPISCTYP:
                              EPNEWCOB,EPABRGNL,EPADCRTN,EPIINLOS,EPHLTHFD:
                              EPILINSR,EPIMNTLS,EPIPRGFS,EPISPFDA,EPICTTYP:
                              EPICTROL,EPICTRID,EPIPDCLD,EPIYDCLD,EPITLCLD:
                              EPIUSERF,SP3
          GOTO      ML3000 IF OVER
.
          MATCH     "E2",E2
          GOTO      ML2000 IF NOT EQUAL
.
          ADD       ONE,RECCNT
          IF        RECCNT%10=1
            DISPLAY   *P11:24,*V2LON,RECCNT;
          ENDIF
.
          PACK      KEY8,EPIURNO
          RESET     KEY8
          MOVE      ZERO,OVRCD
          READ      TEMP2,KEY8;ANS
          GOTO      ML2000 IF NOT OVER
.
          WRITE     TEMP2,KEY8;E2,UNIQKEY,EPIURNO,EPISITID,EPIMEDI:
                               EPIMCSFX,EPISEX,EPIMSTAT,EPIBDATE,EPIPOST:
                               EPISUBRB,EPIADATR,EPIATIME,EPIATYPE,EPIASRCE:
                               EPITSRCE,EPILVMTD,EPILVTOT,EPILVYTD,EPIACST1:
                               EPIATYP1,EPIQTYP1,EPIABDP1,EPIABDY1,EPIABDA1:
                               EPIACST2,EPIATYP2,EPIQTYP2,EPIABDP2,EPIABDY2:
                               EPIABDA2,EPIACST3,EPIATYP3,EPIQTYP3,EPIABDP3:
                               EPIABDY3,EPIABDA3,EPIACST4,EPIATYP4,EPIQTYP4:
                               EPIABDP4,EPIABDY4,EPIABDA4,EPIACST5,EPIATYP5:
                               EPIQTYP5,EPIABDP5,EPIABDY5,EPIABDA5,EPIACST6:
                               EPIATYP6,EPIQTYP6,EPIABDP6,EPIABDY6,EPIABDA6:
                               EPIACST7,EPIATYP7,EPIQTYP7,EPIABDP7,EPIABDY7:
                               EPIABDA7,EPISDATE,EPISTIME,EPISTYPE,EPISTRFR:
                               EPISREFL,EPICAVAL,EPISACST,EPISATYP,EPISCTYP:
                               EPNEWCOB,EPABRGNL,EPADCRTN,EPIINLOS,EPHLTHFD:
                               EPILINSR,EPIMNTLS,EPIPRGFS,EPISPFDA,EPICTTYP:
                               EPICTROL,EPICTRID,EPIPDCLD,EPIYDCLD,EPITLCLD:
                               EPIUSERF,SP3
          GOTO      ML2000
.
ML3000    DISPLAY   *P1:23,*EF,*B:
                    *P1:24,"Records loaded : ",*V2LON,RECCNT,".  ";
          CALL      HITENTER
.
          MOVE      ZERO,RECCNT
          DISPLAY   *P1:4,*EF,"U/R No : ";
ML4000    KEYIN     *P10:4,*EL,*V2LON,URNO;
.
          MATCH     SP8,URNO
          GOTO      ML9000 IF EQUAL
          GOTO      ML9000 IF EOS
.
          PACK      KEY8,URNO
          RESET     KEY8
          MOVE      ZERO,OVRCD
          READ      TEMP2,KEY8;E2,UNIQKEY,EPIURNO,EPISITID,EPIMEDI:
                               EPIMCSFX,EPISEX,EPIMSTAT,EPIBDATE,EPIPOST:
                               EPISUBRB,EPIADATR,EPIATIME,EPIATYPE,EPIASRCE:
                               EPITSRCE,EPILVMTD,EPILVTOT,EPILVYTD,EPIACST1:
                               EPIATYP1,EPIQTYP1,EPIABDP1,EPIABDY1,EPIABDA1:
                               EPIACST2,EPIATYP2,EPIQTYP2,EPIABDP2,EPIABDY2:
                               EPIABDA2,EPIACST3,EPIATYP3,EPIQTYP3,EPIABDP3:
                               EPIABDY3,EPIABDA3,EPIACST4,EPIATYP4,EPIQTYP4:
                               EPIABDP4,EPIABDY4,EPIABDA4,EPIACST5,EPIATYP5:
                               EPIQTYP5,EPIABDP5,EPIABDY5,EPIABDA5,EPIACST6:
                               EPIATYP6,EPIQTYP6,EPIABDP6,EPIABDY6,EPIABDA6:
                               EPIACST7,EPIATYP7,EPIQTYP7,EPIABDP7,EPIABDY7:
                               EPIABDA7,EPISDATE,EPISTIME,EPISTYPE,EPISTRFR:
                               EPISREFL,EPICAVAL,EPISACST,EPISATYP,EPISCTYP:
                               EPNEWCOB,EPABRGNL,EPADCRTN,EPIINLOS,EPHLTHFD:
                               EPILINSR,EPIMNTLS,EPIPRGFS,EPISPFDA,EPICTTYP:
                               EPICTROL,EPICTRID,EPIPDCLD,EPIYDCLD,EPITLCLD:
                               EPIUSERF,SP3
          GOTO      ML5000 IF NOT OVER
.
          DISPLAY   *P1:24,*EL,*B,"U/R number not found.  ";
          CALL      HITENTER
          GOTO      ML4000
.
ML5000    ADD       ONE,RECCNT
          DISPLAY   *P1:24,*V2LON,"Printing ...",*W1;
          PRINT     *N
          PRINT     *1,"Unique key - episode no / admin no",*40,": ",UNIQKEY
          PRINT     *1,"U/R number",*40,": ",EPIURNO,*N
.
          PRINT     *1,"Site id",*40,": ",EPISITID
          PRINT     *1,"Medicare number",*40,": ",EPIMEDI
          PRINT     *1,"Medicare suffix",*40,": ",EPIMCSFX
          PRINT     *1,"Sex",*40,": ",EPISEX
          PRINT     *1,"Marital status",*40,": ",EPIMSTAT
          PRINT     *1,"Date of birth (ddmmccyy)",*40,": ",EPIBDATE
          PRINT     *1,"Postcode",*40,": ",EPIPOST
          PRINT     *1,"Suburb/locality",*40,": ",EPISUBRB,*N
.
          PRINT     *1,"Admission date (ddmmccyy)",*40,": ",EPIADATR
          PRINT     *1,"Admission time",*40,": ",EPIATIME
          PRINT     *1,"Admission type",*40,": ",EPIATYPE
          PRINT     *1,"Admission source",*40,": ",EPIASRCE,*N
.
          PRINT     *1,"Transfer source code",*40,": ",EPITSRCE
          PRINT     *1,"Month to date leave days",*40,": ",EPILVMTD
          PRINT     *1,"Year to date leave days",*40,": ",EPILVYTD
          PRINT     *1,"Total leave days",*40,": ",EPILVTOT,*N
.
          PRINT     *1,"1st episode account status",*40,": ",EPIACST1
          PRINT     *1,"1st episode accommodation type",*40,": ",EPIATYP1
          PRINT     *1,"1st episode qualification status",*40,": ",EPIQTYP1
          PRINT     *1,"1st episode period to date bed days",*40,": ",EPIABDP1
          PRINT     *1,"1st episode year to date bed days",*40,": ",EPIABDY1
          PRINT     *1,"1st episode total bed days",*40,": ",EPIABDA1,*N
.
          PRINT     *1,"2nd episode account status",*40,": ",EPIACST2
          PRINT     *1,"2nd episode accommodation type",*40,": ",EPIATYP2
          PRINT     *1,"2nd episode qualification status",*40,": ",EPIQTYP2
          PRINT     *1,"2nd episode period to date bed days",*40,": ",EPIABDP2
          PRINT     *1,"2nd episode year to date bed days",*40,": ",EPIABDY2
          PRINT     *1,"2nd episode total bed days",*40,": ",EPIABDA2,*N
.
          PRINT     *1,"3rd episode account status",*40,": ",EPIACST3
          PRINT     *1,"3rd episode accommodation type",*40,": ",EPIATYP3
          PRINT     *1,"3rd episode qualification status",*40,": ",EPIQTYP3
          PRINT     *1,"3rd episode period to date bed days",*40,": ",EPIABDP3
          PRINT     *1,"3rd episode year to date bed days",*40,": ",EPIABDY3
          PRINT     *1,"3rd episode total bed days",*40,": ",EPIABDA3,*N
.
          PRINT     *1,"4th episode account status",*40,": ",EPIACST4
          PRINT     *1,"4th episode accommodation type",*40,": ",EPIATYP4
          PRINT     *1,"4th episode qualification status",*40,": ",EPIQTYP4
          PRINT     *1,"4th episode period to date bed days",*40,": ",EPIABDP4
          PRINT     *1,"4th episode year to date bed days",*40,": ",EPIABDY4
          PRINT     *1,"4th episode total bed days",*40,": ",EPIABDA4,*N
.
          PRINT     *1,"5th episode account status",*40,": ",EPIACST5
          PRINT     *1,"5th episode accommodation type",*40,": ",EPIATYP5
          PRINT     *1,"5th episode qualification status",*40,": ",EPIQTYP5
          PRINT     *1,"5th episode period to date bed days",*40,": ",EPIABDP5
          PRINT     *1,"5th episode year to date bed days",*40,": ",EPIABDY5
          PRINT     *1,"5th episode total bed days",*40,": ",EPIABDA5,*N
.
          PRINT     *1,"6th episode account status",*40,": ",EPIACST6
          PRINT     *1,"6th episode accommodation type",*40,": ",EPIATYP6
          PRINT     *1,"6th episode qualification status",*40,": ",EPIQTYP6
          PRINT     *1,"6th episode period to date bed days",*40,": ",EPIABDP6
          PRINT     *1,"6th episode year to date bed days",*40,": ",EPIABDY6
          PRINT     *1,"6th episode total bed days",*40,": ",EPIABDA6,*N
.
          PRINT     *1,"7th episode account status",*40,": ",EPIACST7
          PRINT     *1,"7th episode accommodation type",*40,": ",EPIATYP7
          PRINT     *1,"7th episode qualification status",*40,": ",EPIQTYP7
          PRINT     *1,"7th episode period to date bed days",*40,": ",EPIABDP7
          PRINT     *1,"7th episode year to date bed days",*40,": ",EPIABDY7
          PRINT     *1,"7th episode total bed days",*40,": ",EPIABDA7,*N
.
          PRINT     *1,"Separation date (ddmmccyy)",*40,": ",EPISDATE
          PRINT     *1,"Separation time",*40,": ",EPISTIME
          PRINT     *1,"Separation type",*40,": ",EPISTYPE
          PRINT     *1,"Separation transfer/trans. destinatn",*40,": ",EPISTRFR
          PRINT     *1,"Separation referral",*40,": ",EPISREFL
          PRINT     *1,"Carer availability",*40,": ",EPICAVAL
          PRINT     *1,"Separation account status/class",*40,": ",EPISACST
          PRINT     *1,"Separation accommodation type",*40,": ",EPISATYP
          PRINT     *1,"Care type",*40,": ",EPISCTYP,*N
.
          PRINT     *1,"Country of birth code",*40,": ",EPNEWCOB
          PRINT     *1,"Aboriginality",*40,": ",EPABRGNL
          PRINT     *1,"Criterion for admission",*40,": ",EPADCRTN
          PRINT     *1,"Intended LOS",*40,": ",EPIINLOS
          PRINT     *1,"Health insurance fund",*40,": ",EPHLTHFD
          PRINT     *1,"Level of Insurance",*40,": ",EPILINSR
          PRINT     *1,"Mental health legal status",*40,": ",EPIMNTLS
          PRINT     *1,"Program funding source",*40,": ",EPIPRGFS,*N
.
          PRINT     *1,"Funding arrangement",*40,": ",EPISPFDA
          PRINT     *1,"Contract type",*40,": ",EPICTTYP
          PRINT     *1,"Contract role",*40,": ",EPICTROL
          PRINT     *1,"Contract/spoke identifier",*40,": ",EPICTRID
          PRINT     *1,"Contract leave days (MTD)",*40,": ",EPIPDCLD
          PRINT     *1,"Contract leave days (YTD)",*40,": ",EPIYDCLD
          PRINT     *1,"Total contract leave days",*40,": ",EPITLCLD,*N
.
          PRINT     *1,"User flag",*40,": ",EPIUSERF,*N
          CALL      UND80
          DISPLAY   *P1:24,*EL;
          GOTO      ML4000
.
ML9000    DISPLAY   *P1:24,*EL,*B,"Items printed : ",*V2LON,RECCNT,*HOFF,".  ";
          CALL      HITENTER
.
          CLOSE     TEMP2
          MOVE      "iserase ",KEY8
          PACK      KEY16,KEY8,FILENAME,SP30
          STRIP     KEY16
          EXECUTE   KEY16,TASKID
.
ML9999    CHAIN     PGM
.
          INC       STD001IO
+
.

