.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINSVAKY
.   Routine   :   KSIVAA00 Keyin Service Code        
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIVAA00 TOPIC     "SIVACOD "
          MOVE      UNDLN70,SIVACOD 
          KEYIN     *PCCOL:CVERT,*DV,SIVACOD:                                   
                    *PCCOL:CVERT,*V2LON,SIVACOD:                                
                    *PCCOL:CVERT,*DV,SIVACOD 
.
          ENDSET    SIVACOD 
          APPEND    SP70,SIVACOD 
          RESET     SIVACOD 
.
          MATCH     SP70,SIVACOD 
          GOTO      KSIVAA90 IF EQUAL
.
          CMATCH    EXITCHAR,SIVACOD 
          GOTO      KSIVAA95 IF EQUAL
.
          CMATCH    QUEST,SIVACOD 
          GOTO      KSIVAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSIVAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIVACOD 
          APPEND    SP70,SIVACOD 
          RESET     SIVACOD 
.
          MATCH     SP70,SIVACOD 
          GOTO      KSIVAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIVACOD                                 
KSIVAA10
          PACK      KEY4,SIVACOD                                                
          CALL      RASIVA1 
          BRANCH    OVRCD,KSIVAA80
          BRANCH    CKEYTYP,KSIVAA75
          CALL      RDSIVA1 
KSIVAA70
          MOVE      ZERO,EXIT
          GOTO      KSIVAA99
KSIVAA75
          MOVE      "Service Code Already Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KSIVAA00
KSIVAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIVAA99,KSIVAA99
          MOVE      "Service Code Does Not Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KSIVAA00
KSIVAA90
          MOVE      ONE,EXIT
          GOTO      KSIVAA99
KSIVAA95
          MOVE      TWO,EXIT
KSIVAA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINSVAKY
.   Routine   :   HSIVAA00 Supplier Code Keyin 
.   Return    :           
.-------------------------------------------------------------------------------
HSIVAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "35",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIVAA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIVAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Service Code"       
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          MOVE      STDCOL02,STDCOL03
          ADD       "34",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Cost Centre"        
.
          MOVE      STDCOL03,STDCOL04
          ADD       "13",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Product Group"      
.
          MOVE      STDCOL04,STDCOL05
          ADD       "15",STDCOL05
HSIVAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIVACOD 
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          CALL      RSSIVA1 
HSIVAA10
          CALL      RKSIVA1 
          BRANCH    OVRCD,HSIVAA15
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSIVAA12
          CALL      HSIVAA60
          BRANCH    OVRCD,HSIVAA10
HSIVAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIVACOD 
          DISPLAY   *PSTDCOL02:STDROW,SIVADES 
          DISPLAY   *PSTDCOL03:STDROW,SIVACST 
          DISPLAY   *PSTDCOL04:STDROW,SIVAPRD 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIVAA10 IF NOT EQUAL
HSIVAA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIVAA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIVAA30,HSIVAA35,HSIVAA40,HSIVAA45,HSIVAA04:
                              HSIVAA91,HSIVAA50
          GOTO      HSIVAA92
HSIVAA30
          CALL      RKSIVA1 
          BRANCH    OVRCD,HSIVAA85
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          CALL      RPSIVA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIVAA10
HSIVAA35
          MOVE      ST1,KEY4 
          CALL      RDSIVA1 
          CALL      RPSIVA1 
          BRANCH    OVRCD,HSIVAA85
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIVAA36
          CALL      RPSIVA1 
          BRANCH    OVRCD,HSIVAA37
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIVAA36 IF NOT EQUAL
HSIVAA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIVAA10
HSIVAA40
          MOVE      ST1,KEY4 
          CALL      RDSIVA1 
          CALL      RPSIVA1 
          BRANCH    OVRCD,HSIVAA85
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIVAA08
HSIVAA45
          CALL      RKSIVA1 
          BRANCH    OVRCD,HSIVAA85
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIVA1 
HSIVAA46
          CALL      RPSIVA1 
          BRANCH    OVRCD,HSIVAA47
          PACK      KEY4,SIVACOD,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIVAA46 IF NOT EQUAL
HSIVAA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIVAA10
HSIVAA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIVAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIVAA08
HSIVAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIVAA08
HSIVAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIVAA61 IF EQUAL
          MATCH     SCHFLD01,SIVACOD 
          GOTO      HSIVAA72 IF NOT EQUAL
HSIVAA61
          MATCH     SP70,SCHFLD02
          GOTO      HSIVAA62 IF EQUAL
          MATCH     SCHFLD02,SIVADES 
          GOTO      HSIVAA72 IF NOT EQUAL
HSIVAA62
          MATCH     SP70,SCHFLD03
          GOTO      HSIVAA63 IF EQUAL
          MATCH     SCHFLD03,SIVACST 
          GOTO      HSIVAA72 IF NOT EQUAL
HSIVAA63
          MATCH     SP70,SCHFLD04
          GOTO      HSIVAA64 IF EQUAL
          MATCH     SCHFLD04,SIVAPRD 
          GOTO      HSIVAA72 IF NOT EQUAL
HSIVAA64
HSIVAA65
HSIVAA66
HSIVAA67
HSIVAA68
HSIVAA69
HSIVAA70
          GOTO      HSIVAA75
HSIVAA72  MOVE      ONE,OVRCD
HSIVAA75  RETURN
HSIVAA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,SIVACOD                                                
          CALL      RDSIVA1 
HSIVAA90
.                                                                               
          BEEP
          GOTO      HSIVAA20
HSIVAA91
          MOVE      SP70,SIVADES 
          MOVE      SP70,SIVACST 
          MOVE      SP70,SIVAPRD 
          MOVE      SP70,SIVAPN  
          MOVE      SP70,SIVASUT 
          MOVE      ZERO,SIVALED 
          MOVE      ZERO,SIVAQTY 
          MOVE      ZERO,SIVAAMT 
          MOVE      ZERO,SIVAGSTA
          MOVE      SP70,SIVAGST 
          MOVE      SP70,SIVAUR1 
          MOVE      SP70,SIVAUR2 
          MOVE      SP70,SIVAUD1 
          MOVE      SP70,SIVAUD2 
          MOVE      SP70,SIVAUY1 
          MOVE      SP70,SIVAUY2 
          MOVE      SP70,SIVASPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,SIVACOD 
          GOTO      HSIVAA96
HSIVAA92
          MOVE      SP70,KEY4 
          MOVE      SP70,SIVACOD 
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,SIVACOD                                                
HSIVAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIVAA99
          RETURN
