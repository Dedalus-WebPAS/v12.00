.------------------------------------------------------------
. ORDPR000                           
. Routine to print Order Form Details 
.
. Mods:
.
.----------------------------------------------------------------------------
. V11.03.01 03/11/2023  Peter Vela      TSK 0934820
.           Added linked practice from REHCCTO in
.           PRCPT000
. V11.00.02 17/11/2020  Thanh T         TSK 0878747
.           Added GETFL236 for multiple birth details
. V11.00.01 06/04/2020  Thanh T         TSK 0879163                   
.           Changed GETFL006 for Sex category.                        
.           Added GETFL235 for sex long description                   
.----------------------------------------------------------------------------
. V10.13.01 20/12/2018  Don Nguyen      TSK 0860557
.                       Added more spaces to clear VARIABLE (300 chars)
. V10.11.02 03/01/2018  Ania P          TSK 0850218
.                       Squeeze PTMXMCCD to remove random spaces
. V10.11.01 22/12/2017  Ania P          TSK 0850218
.                       Added PTMXMCCD
. V10.10.01 23.03.2017  Richa Phogat    TSK 0832066                
.                     Changed DVA Card colour to be collected from
.                     PMCDDVAC.PMSPX2FD instead of PMPXDVAC.PMIMA1FD        
. V10.03.01 25.11.2013  B.G.Ackland    CAR 289483
.                     Fix Printing Order by HCP fields 215-231
.         05.04.2013  Brian Ackland  CAR 283694
.                     Add Hospital as field 109
.         25/06/2012  Brian Ackland  CAR 
.                     Printing Order Forms for Cabrini New Template Fields
.         10/05/2012  Brian Ackland  CAR 265085
.                     Enhanced for Printing Notes and Obsevations
.------------------------------------------------------------
ORDPR000  MATCH     SP70,STATNCOD
          GOTO      ORDPR999 IF EQUAL
          PACK      KEY6,STATNCOD,SP70
          CALL      RDIBTH1
          BRANCH    OVRCD,ORDPR999
.
          CALL      OPNPRINT                   * open the spool file
.
          MOVE      ZERO,HTMLOUTF              * Set HTML Page Output Flag to False
          MOVE      ONE,CURRROW
.
          PACK      KEY12,STATNCOD,SP70
          CALL      RSIBDET1                   * position on the details file
          CALL      RKIBDET1
          BRANCH    OVRCD,ORDPR990
.
          MATCH     STATNCOD,IBDTSCOD           * match stationary codes
          GOTO      ORDPR990 IF NOT EQUAL
.
          MOVE      IBDTROW,LASTROW
.
          COMPARE   CURRROW,IBDTROW            * compare rows
          GOTO      ORDPR200 IF EQUAL
.
.------ print new-lines until current row equals the one read in ------
.
ORDPR050  PRINT     *N;
          ADD       ONE,CURRROW
.
          COMPARE   CURRROW,IBDTROW            * compare rows
          GOTO      ORDPR200 IF EQUAL
.
          GOTO      ORDPR050
.
.------ read through the details file ------
.
ORDPR100  CALL      RKIBDET1
          BRANCH    OVRCD,ORDPR900
.
          MATCH     STATNCOD,IBDTSCOD           * match stationary codes
          GOTO      ORDPR900 IF NOT EQUAL
.
          MOVE      IBDTROW,LASTROW
.
          COMPARE   CURRROW,IBDTROW            * compare rows
          GOTO      ORDPR200 IF EQUAL
.
.------ print new-lines until current row equals the one read in ------
.
ORDPR110  PRINT     *N;
          ADD       ONE,CURRROW
.
          COMPARE   CURRROW,IBDTROW            * compare rows
          GOTO      ORDPR200 IF EQUAL
.
          GOTO      ORDPR110
.
.------ branch on the field type ------
.
ORDPR200  BRANCH    IBDTINDC,ORDPR300,ORDPR400
.
.------ the field is a text field ------
.
ORDPR300  RESET     IBDTTXFL,IBDTPLEN
          LENSET    IBDTTXFL
          RESET     IBDTTXFL
          PRINT     *IBDTCOL,*+,IBDTTXFL;
          GOTO      ORDPR100
.
.------ the field is a data field ------
.
ORDPR400  PACK      VARIABLE,SP70,SP70,SP70,SP70,SP70
          CALL      GETFL000
          BRANCH    EXIT,ORDPR100
.
.------ print the variable ------
.
ORDPR760  PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      ORDPR100
.
.------ end of order form reached ------
.
ORDPR900  MOVE      FALSE,EXIT
.
.------ print new-lines until the end of page is reached ------
.
ORDPR910  PRINT     *N;
          ADD       ONE,LASTROW
.
          COMPARE   LASTROW,IBTHLENG          * test page length
          GOTO      ORDPR998 IF EQUAL
.
          GOTO      ORDPR910
.
.------ no details on file ------
.
ORDPR990  MOVE      TRUE,EXIT
.
ORDPR998  IF        HTMLOUTF=1
            CALL      HTMLPE00
            CALL      CLSPRINT                  * close the spool file
            MATCH     "S",SELPRINT
            IF        @EQUAL
              MOVE      WBSCSCHD,KEY8
              CALL      RDWBSC1
              IF        OVRCD=0
                MOVE      THREE,WBSCOTYP
                CALL      UPWBSC1
              ENDIF
            ENDIF
          ELSE
            CALL      CLSPRINT                  * close the spool file
          ENDIF

.
ORDPR999  RETURN
.----------------------------------------------------------------------------------------------------
. Get Field to Print
.----------------------------------------------------------------------------------------------------
GETFL000  MOVE      IBDTTXFL,DIM5
          MOVE      DIM5,FORM5           * Patient Details
          BRANCH    FORM5,GETFL001,GETFL002,GETFL003,GETFL004,GETFL005: * 5
                          GETFL006,GETFL007,GETFL008,GETFL009,GETFL010: * 10
                          GETFL011,GETFL012,GETFL013,GETFL014,GETFL015: * 15
                          GETFL016,GETFL017,GETFL018,GETFL019,GETFL020: * 20
                          GETFL021,GETFL022
.
          SUB       "100",FORM5          * Visit Details
          BRANCH    FORM5,GETFL101,GETFL102,GETFL103,GETFL104,GETFL105: * 105
                          GETFL106,GETFL107,GETFL108,GETFL109,GETFL110:
                          GETFL111,GETFL112,GETFL113,GETFL114,GETFL115:
                          GETFL116,GETFL117,GETFL118,GETFL119,GETFL120:
                          GETFL121,GETFL122,GETFL123,GETFL124,GETFL125:
                          GETFL126,GETFL127,GETFL128,GETFL129,GETFL130:
                          GETFL131,GETFL132,GETFL133,GETFL134
.
          SUB       "100",FORM5          * Order Details
          BRANCH    FORM5,GETFL201,GETFL202,GETFL203,GETFL204,GETFL205: * 205
                          GETFL206,GETFL207,GETFL208,GETFL209,GETFL210:
                          GETFL211,GETFL212,GETFL213,GETFL214,GETFL215: * 215
                          GETFL216,GETFL217,GETFL218,GETFL219,GETFL220:
                          GETFL221,GETFL222,GETFL223,GETFL224,GETFL225: * 225  
                          GETFL226,GETFL227,GETFL228,GETFL229,GETFL230:
                          GETFL231,GETFL232,GETFL233,GETFL234,GETFL235: * 235
                          GETFL236 
.
          GOTO      GETFL920                 * Nothing to print
.
GETFL001  MOVE      ONE,HTMLOUTF             * Set HTML Page Output Flag True
          CALL      HTMLPS00                 * Print Heading for HTML Page Output
          GOTO      GETFL920
.
GETFL002  MOVE      PSNAME,VARIABLE          * Surname
          GOTO      GETFL900
.
GETFL003  MOVE      PGNAME,VARIABLE          * Given name
          GOTO      GETFL900
.
GETFL004  MOVE      PTITL,VARIABLE
          GOTO      GETFL900

GETFL005  MOVE      PSNAME,PACSNAME
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      GETFL900
.
GETFL006  MOVE      ZERO,ANS                 * Sex
          MOVE      PSEX,DSEXCHAR
          CALL      SEXDSP00         
          MOVE      DSEXASC1,VARIABLE
          GOTO      GETFL900
.
GETFL007  UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY   * Birth date
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL008  CALL      LABELAGE
          MOVE      XAGE,VARIABLE           * Age
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      GETFL900
.
GETFL009  MOVE      PURNO,VARIABLE           * U/R number
          MOVE      EIGHT,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      GETFL900
.
GETFL010  MOVE      PADD1,VARIABLE           * Address line 1
          GOTO      GETFL900
.
GETFL011  MOVE      PADD2,VARIABLE           * Address line 2
          GOTO      GETFL900
.
GETFL012  MOVE      PSUBRB,VARIABLE          * Address Line 3
          GOTO      GETFL900
.
GETFL013  MOVE      PADD4,VARIABLE           * Address Line 4
          GOTO      GETFL900
.
GETFL014  MOVE      PPOST,VARIABLE           * Postcode
          GOTO      GETFL900
.
GETFL015  MOVE      PTELEP,VARIABLE          * Private telephone
          GOTO      GETFL900
.
GETFL016  MOVE      PTELEB,VARIABLE          * Buiness telephone
          GOTO      GETFL900
.
GETFL017  SQUEEZE   PTMXMCCD
          PACK      VARIABLE,PMEDI,SLASH,PTMXMCCD     * Medicare number/Ref
          GOTO      GETFL900
.
GETFL018  MOVE      PPENNO,VARIABLE          * Pension number
.
GETFL019  MOVE      PCONT,VARIABLE           * Country of Birth
          GOTO      GETFL900
.
GETFL020  PACK      KEY5,ANSC,SP1,PCONT,SP70 * Country of Birth Description 
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      PCONT,VARIABLE
          ELSE
            MOVE      TDESC,VARIABLE
          ENDIF
          GOTO      GETFL900

GETFL021  MOVE      PREG,VARIABLE           * Religion
          GOTO      GETFL900
.
GETFL022  PACK      KEY5,ANSR,SP1,PREG,SP70 * Religion Description 
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      PCONT,VARIABLE
          ELSE
            MOVE      TDESC,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL101  UNPACK    PVIDATE,CCENT,CYEAR,CMON,CDAY   * Visit Date
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL102  MOVE      SP70,KEY5
          LOAD      KEY5,PVITYPE,EMVITIME,OBATIME,ATIME
          MOVE      KEY5,VARIABLE
          GOTO      GETFL900
.
GETFL103  BRANCH    PVITYPE,GETFL920,GETFL920
          MOVE      AWARD,VARIABLE
          GOTO      GETFL900
.
GETFL104  PACK      KEY6,AWARD,SP70
          CALL      RDWARD1
          BRANCH    OVRCD,GETFL920
          MOVE      WBDESC,VARIABLE
          GOTO      GETFL900
.
GETFL105  BRANCH    PVITYPE,GETFL920,GETFL920
          MOVE      ABED,VARIABLE
          GOTO      GETFL900
.
GETFL106  CALL      GETLOC00
          MOVE      KEY50,VARIABLE
          GOTO      GETFL900
.
GETFL107  MOVE      DPVIBILL,VARIABLE               * Visit No
          GOTO      GETFL900
.
GETFL108  PACK      KEY6,AWARD,ABED,SP70
          CALL      RDWARD1
          BRANCH    OVRCD,GETFL920
          MOVE      WBDESC,VARIABLE
          GOTO      GETFL900
.
GETFL109  MOVE      PMVXMHOS,VARIABLE
          GOTO      GETFL900
.
GETFL110  
          GOTO      GETFL900
.
GETFL111  MOVE      ONE,DIM1                  * Concession Card Type Code 
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      GETFL900
.
GETFL112  MOVE      ONE,DIM1                  * Concession Card Type Description 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      GETFL900
.
GETFL113  MOVE      ONE,DIM1                  * Concession Card Number 
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      GETFL900
.
GETFL114  MOVE      ONE,DIM1                  * Concession Card Expiry Date 
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL115  MOVE      TWO,DIM1                  * Safety Net Card Type Code 
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      GETFL900
.
GETFL116  MOVE      TWO,DIM1                  * Safety Net Card Type Description 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      GETFL900
.
GETFL117  MOVE      TWO,DIM1                  * Safert Net Card Number
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      GETFL900
.
GETFL118  MOVE      TWO,DIM1                  * Safety Net Card Expiry Date 
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL119  MOVE      THREE,DIM1                * DVA Card Type Code
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      GETFL900
.
GETFL120  MOVE      THREE,DIM1                * DVA Card Type Description
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      GETFL900
.
GETFL121  MOVE      THREE,DIM1                * DVA Card Number 
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      GETFL900
.
GETFL122  MOVE      THREE,DIM1                * DVA Card Expiry Date
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL123  MOVE      FOUR,DIM1                * Pension Card Type Code
          CALL      GCCARD00
          MOVE      PMCDCTYP,VARIABLE
          GOTO      GETFL900
.
GETFL124  MOVE      FOUR,DIM1                * Pension Card Type Description 
          CALL      GCCARD00
          MOVE      SP70,VARIABLE
          MATCH     SP70,PMCDCTYP
          IF        !@EQUAL & !@EOS
            MOVE      "ct",DIM2
            PACK      KEY5,DIM2,PMCDCTYP,SP10
            CALL      RDCODE1
            IF        OVRCD=0
              MOVE      TDESC,VARIABLE
            ENDIF
          ENDIF
          GOTO      GETFL900
.
GETFL125  MOVE      FOUR,DIM1                * Pension Card Number
          CALL      GCCARD00
          MOVE      PMCDCNUM,VARIABLE
          GOTO      GETFL900
.
GETFL126  MOVE      FOUR,DIM1                * Pension Card Expiry Date 
          CALL      GCCARD00
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL127  MOVE      ACLAIM,CLAIMCOD          * Compensable/Heath Fund Name 
          IF        PVITYPE=1
            MOVE      EMVICOMP,CLAIMCOD          * Compensable/Heath Fund Name
          ENDIF
          IF        PVITYPE=2
            MOVE      OBACOMP,CLAIMCOD          * Compensable/Heath Fund Name
          ENDIF
          CALL      CMPH0000
          MOVE      CLMDET1,VARIABLE
          GOTO      GETFL900
.
GETFL128  MOVE      ACLAIM,CLAIMCOD          * Compensable/Heath Fund Number 
          IF        PVITYPE=1
            MOVE      EMVICOMP,CLAIMCOD          * Compensable/Heath Fund Name
          ENDIF
          IF        PVITYPE=2
            MOVE      OBACOMP,CLAIMCOD          * Compensable/Heath Fund Name
          ENDIF
          CALL      CMPH0000
          MOVE      CLMDET2,VARIABLE
          GOTO      GETFL900
.
GETFL129  CALL      GMCARD00                 * Multiple Card Type Code
          MOVE      PMCDCTYP,VARIABLE
          GOTO      GETFL900
.
GETFL130  CALL      GMCARD00                 * Multiple Card Type Description
          MOVE      TDESC,VARIABLE
          GOTO      GETFL900
.
GETFL131  CALL      GMCARD00                 * Multiple Card Type Expiry date
          MATCH     PMCDEXDT,SP70
          GOTO      GETFL900 IF EQUAL
.
          UNPACK    PMCDEXDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL132  LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
          PACK      KEY10,KEY10,SP70
          MOVE      KEY10,VARIABLE
          GOTO      GETFL900
.
GETFL133  LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
          PACK      KEY10,KEY10,SP70
          MATCH     SP70,KEY10
          IF        @EQUAL
            MOVE      SP70,VARIABLE
            GOTO      GETFL900
          ENDIF
          MATCH     KEY10,PMHCHCPC
          IF        !@EQUAL
            CALL      RDPMHCP1
          ENDIF
          MOVE      PMHCPRV1,VARIABLE
          GOTO      GETFL900

GETFL134  LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
          PACK      KEY10,KEY10,SP70
          MATCH     SP70,KEY10
          IF        @EQUAL
            MOVE      SP70,VARIABLE
            GOTO      GETFL900
          ENDIF
          MATCH     KEY10,PMHCHCPC
          IF        !@EQUAL
            CALL      RDPMHCP1
          ENDIF
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      GETFL900
.
GETFL201  UNPACK    REHARDT,CCENT,CYEAR,CMON,CDAY   * Visit Date
          CALL      PACDATE
          IF        IBDTPLEN=8
            MOVE      CPDATE,VARIABLE
          ELSE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      GETFL900
.
GETFL202  MOVE      REHARTM,VARIABLE
          GOTO      GETFL900
.
GETFL203  MOVE      REHARUN,VARIABLE
          GOTO      GETFL900
.
GETFL204  CALL      PRTTST00   * Output Test Details
          GOTO      GETFL920
.
GETFL205  CALL      PRTHEB00   * Output Additional Information
          GOTO      GETFL920
.
GETFL206  CALL      PRCPT000   * Print Copy Too
          GOTO      GETFL920
.
GETFL207  MOVE      REHDRCI,VARIABLE
          GOTO      GETFL900
.
GETFL208  CALL      PRTTDS00   * Output Test Details with Diagnostic Service
          GOTO      GETFL920
.
GETFL209  UNPACK    PTCNRMIC,KEY5,KEY7
          MOVE      KEY7,VARIABLE
          GOTO      GETFL900
.
GETFL210  MOVE      RELBLCD,VARIABLE
          GOTO      GETFL900
.
GETFL211  MOVE      RELBDES,VARIABLE
          GOTO      GETFL900
.
GETFL212  MOVE      MSHSEQ03,VARIABLE
          GOTO      GETFL900
.
GETFL213  MOVE      MSHSEQ04,VARIABLE
          GOTO      GETFL900
.
GETFL214  MOVE      REHAUCS,VARIABLE
          GOTO      GETFL900
.
GETFL215  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCHCPC,VARIABLE
          GOTO      GETFL900
.
GETFL216  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCSNAM,VARIABLE
          GOTO      GETFL900
.
GETFL217  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCGNAM,VARIABLE
          GOTO      GETFL900
.
GETFL218  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCTITL,VARIABLE
          GOTO      GETFL900
.
GETFL219  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCPRV1,VARIABLE
          GOTO      GETFL900
.
GETFL220  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCADR1,VARIABLE
          GOTO      GETFL900
.
GETFL221  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCADR2,VARIABLE
          GOTO      GETFL900
.
GETFL222  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCADR3,VARIABLE
          GOTO      GETFL900
.
GETFL223  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCADR4,VARIABLE
          GOTO      GETFL900
.
GETFL224  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCADR5,VARIABLE
          GOTO      GETFL900
.
GETFL225  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCADR6,VARIABLE
          GOTO      GETFL900
.
GETFL226  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCPOST,VARIABLE
          GOTO      GETFL900
.
GETFL227  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCSEML,VARIABLE
          GOTO      GETFL900
.
GETFL228  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCSTEL,VARIABLE
          GOTO      GETFL900
.
GETFL229  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCPAGR,VARIABLE
          GOTO      GETFL900
.
GETFL230  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCPAGN,VARIABLE
          GOTO      GETFL900
.
GETFL231  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME
          MOVE      PACFNAME,VARIABLE
          GOTO      GETFL900
.
GETFL232  MOVE      SP70,VARIABLE
          MATCH     SP70,WBSEDOC
          IF        @EQUAL
            PACK      KEY10,ORDERHCP,SP70
            MATCH     SP70,ORDERHCP
            IF        @EQUAL
              LOAD      KEY10,PVITYPE,EMVIDOCT,OBADOCT,ADOCTA
            ENDIF
          ELSE
            PACK      KEY10,WBSEDOC,SP70
          ENDIF
          CALL      RDPMHCP1
          BRANCH    OVRCD,GETFL900
          MOVE      PMHCFAXN,VARIABLE
          GOTO      GETFL900
.
GETFL233  MOVE      FORMTYPE,VARIABLE
          GOTO      GETFL900
.
GETFL234  MOVE      WBSENAM,VARIABLE
          GOTO      GETFL900
.     
.----- format patient sex long description ------     
.     
GETFL235  MOVE      PSEX,DSEXCHAR     
          CALL      SEXDSP00	  
          MOVE      DSEXLDES,VARIABLE        * Get sex long description	    
          GOTO      GETFL900	  
.
.----- format multiple birth details ------
.
GETFL236  MOVE      URNUMBER,MBIRURNO
          CALL      MULBIR00                 * Get multlple birth details
          MOVE      MBIRTYOR,VARIABLE
          GOTO      GETFL900
.
.
GETFL900  RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
          MOVE      ZERO,EXIT
          GOTO      GETFL999
.
.------ formatting for Form fields and right justified variables ------
.
GETFL910  COMPARE   ZERO,PRNTSTRT          * don't bump if printing full length
          GOTO      GETFL999 IF EQUAL
          BUMP      VARIABLE,PRNTSTRT      * bump to starting position
          MOVE      ZERO,EXIT
          GOTO      GETFL999
.
GETFL920  MOVE      ONE,EXIT
.
GETFL999  RETURN
.------------------------------------------------------------
. Get Location String
.------------------------------------------------------------
GETLOC00  MOVE      SP70,KEY50
          BRANCH    PVITYPE,GETLOC10,GETLOC20,GETLOC30
          GOTO      GETLOC99
.
GETLOC10  MOVE      "Emergency",KEY50
          GOTO      GETLOC99
.
GETLOC20  MOVE      "Outpatient",KEY50
          GOTO      GETLOC99
.
GETLOC30  BRANCH    ASTAT,GETLOC31,GETLOC32,GETLOC33,GETLOC34,GETLOC35
GETLOC31  MOVE      "Pre-admission for ",KEY18
          PACK      KEY6,PTMIXWRD,PTMIEBED,SP70
          CALL      RDWARD1
          IF        OVRCD=1
            MOVE      PTMIXWRD,WBDESC
          ENDIF
          PACK      KEY50,KEY18,AWARD,SLASH,WBDESC
          GOTO      GETLOC99
.
GETLOC32  PACK      KEY6,AWARD,ABED,SP70
          CALL      RDWARD1
          IF        OVRCD=1
            MOVE      AWARD,WBDESC
          ENDIF
          PACK      KEY50,AWARD,SLASH,WBDESC
          GOTO      GETLOC99
.
GETLOC33  MOVE      "Discharged",KEY50
          GOTO      GETLOC99
.
GETLOC34  MOVE      "On Leave",KEY50
          GOTO      GETLOC99
.
GETLOC35  MOVE      "Cancelled",KEY50
          GOTO      GETLOC99
.
GETLOC99  RETURN
.
PRTHEB00  MOVE      ZERO,F3
          PACK      KEY20,REHARDT,REHARTM,REHARUN,SP70
          CALL      RSREHB1
PRTHEB10  CALL      RKREHB1
          BRANCH    OVRCD,PRTHEB99
          MATCH     REHARDT,REHBRDT
          GOTO      PRTHEB99 IF NOT EQUAL
          MATCH     REHARTM,REHBRTM
          GOTO      PRTHEB99 IF NOT EQUAL
          MATCH     REHARUN,REHBRUN
          GOTO      PRTHEB99 IF NOT EQUAL
.
          IF        F3>0
            PRINT     *N;
          ENDIF
          ADD       ONE,F3
          STRIP     REHBTXT
          PRINT     *+,REHBTXT;
          GOTO      PRTHEB10
.
PRTHEB99  RETURN
.
PRCPT000  MOVE      ZERO,F3
          PACK      KEY19,REHARDT,REHARTM,REHARUN,SP70
          CALL      RSREHC1
PRCPT100  CALL      RKREHC1
          BRANCH    OVRCD,PRCPT999
          MATCH     REHARDT,REHCRDT
          GOTO      PRCPT999 IF NOT EQUAL
          MATCH     REHARTM,REHCRTM
          GOTO      PRCPT999 IF NOT EQUAL
          MATCH     REHARUN,REHCRUN
          GOTO      PRCPT999 IF NOT EQUAL
.
          SCAN      "^",REHCCTO
          GOTO      PRCPT100 IF NOT EQUAL
          MOVEFPTR  REHCCTO,LENGTH
          SUB       ONE,LENGTH
          IF        LENGTH>0
            RESET     REHCCTO
            SFORMAT   VAR,LENGTH
            MOVE      REHCCTO,VAR
          ELSE
            GOTO      PRCPT100
          ENDIF
.          
          PACK      KEY10,VAR,SP70
          SFORMAT   VAR,127
          CALL      RDPMHCP1
          IF        OVRCD <> 1
            MOVE      PMHCSNAM,PACSNAME
            MOVE      PMHCGNAM,PACGNAME
            MOVE      PMHCTITL,PACTITLE
            MOVE      TWO,PACFRMT
            CALL      PACNAME
            MATCH     SP70,PMHCPRV1
            IF        @EQUAL
              SCAN      "^",REHCCTO
              BUMP      REHCCTO
              SCAN      "^",REHCCTO
              IF        @EQUAL 
                BUMP      REHCCTO
                MOVE      REHCCTO,PMHCPRV1
                PACK      PMHCPRV1,PMHCPRV1,SP70
.
                MATCH     SP70,PMHCPRV1
                GOTO      PRCPT500 IF EQUAL
                GOTO      PRCPT500 IF EOS
              ELSE
PRCPT500        CALL      GPRAC000
              ENDIF
            ENDIF
            IF        F3>0
              PRINT     *N;
            ENDIF
            ADD       ONE,F3
            IF        HTMLOUTF=1
              PRINT     *+,PMHCPRV1,SP1,PACFNAME,"<br>";
            ELSE
              PRINT     *+,PMHCPRV1,SP1,PACFNAME;
            ENDIF
          ENDIF
          GOTO      PRCPT100
.
PRCPT999  RETURN
.
GPRAC000  PACK      KEY20,PMHCHCPC,SP70
          CALL      RSPMHCL1
GPRAC100  CALL      RKPMHCL1                * read link table to get practice(s)
          BRANCH    OVRCD,GPRAC999
          MATCH     PMHCHCPC,PMHLHCPC
          GOTO      GPRAC999 IF NOT EQUAL   * no more practices
          MATCH     "0",PMHLSTAT
          GOTO      GPRAC100 IF NOT EQUAL
          MOVE      PMHLPRV1,PMHCPRV1
GPRAC999  RETURN
.------------------------------------------------------------
. Print Tests Requested for the Laboratory
.------------------------------------------------------------
PRTTST00  MOVE      ZERO,F3
          MOVE      ONE,SERVCNT                 * initialise count
          WHILE     SERVCNT <= SERVEND
            UNPACK    SERVICEC[SERVCNT],SERVDSSC,SERVCODE,SERVDESC,SERVLABC
            MATCH     RELBLCD,SERVLABC
            IF        @EQUAL
              IF        F3>0
                PRINT     *N;
              ENDIF
              ADD       ONE,F3
              IF        HTMLOUTF=1
                PRINT     *+,SERVDESC,"<br>";
              ELSE
                PRINT     *+,SERVDESC;
              ENDIF
            ENDIF
            ADD       ONE,SERVCNT 
          DO
PRTTST99  RETURN
.------------------------------------------------------------
. Print Tests Requested for the Laboratory with Diagnostic Service
.------------------------------------------------------------
PRTTDS00  MOVE      ZERO,F3
          MOVE      ONE,SERVCNT                 * initialise count
          WHILE     SERVCNT <= SERVEND
            UNPACK    SERVICEC[SERVCNT],SERVDSSC,SERVCODE,SERVDESC,SERVLABC
            MATCH     RELBLCD,SERVLABC
            IF        @EQUAL
              MOVE      SERVDSSC,HL7COD
              MOVE      "0074",HL7TAB
              PACK      KEY14,HL7TAB,HL7COD
              CALL      RDHLCO1
              IF        OVRCD=1
                MOVE      HL7COD,HLCODES
              ENDIF
              STRIP     HLCODES
              STRIP     SERVDESC
              IF        F3>0
                PRINT     *N;
              ENDIF
              ADD       ONE,F3
              IF        HTMLOUTF=1
                PRINT     *+,HLCODES," - ",*+,SERVDESC,"<br>";
              ELSE
                PRINT     *+,HLCODES," - ",*+,SERVDESC;
              ENDIF
            ENDIF
            ADD       ONE,SERVCNT 
          DO
PRTTDS99  RETURN
.------------------------------------------------------------
. HTML Page Start
.------------------------------------------------------------
HTMLPS00  MOVE      STATNCOD,KEY6
          STRIP     KEY6
          PRINT     "<html>":
                    *N,"<head>":
                    *N,"<script type=text/javascript src=../js/printLayout.js></script>":
                    *N,"<script type=text/javascript src=../js/print",*+,KEY6,".js></script>":
                    *N,"<link rel=stylesheet href=../html/printLayout.css type=text/css>":
                    *N,"<link rel=stylesheet href=../html/print",*+,KEY6,".css type=text/css>":
                    *N,"</head>":
                    *N,"<body>"
HTMLPS99  RETURN
.------------------------------------------------------------
. HTML Page End
.------------------------------------------------------------
HTMLPE00  PRINT     "</body>"
HTMLPE99  RETURN
+
.--------------------------------------------------------------------
.         Get Multiple Card Type
.--------------------------------------------------------------------
GMCARD00  MOVE      "ct",DIM2
          PACK      KEY19,PURNO,SP70
          CALL      RSPMCCD1
GMCARD20  CALL      RKPMCCD1
          BRANCH    OVRCD,GMCARD80
.
          MATCH     PURNO,PMCDURNO
          GOTO      GMCARD80 IF NOT EQUAL
.
          PACK      KEY5,DIM2,PMCDCTYP
          CALL      RDCODE1
          BRANCH    OVRCD,GMCARD20
.
          MATCH     TCINDC6,IBDTPIND             * Check Print Indicator
          GOTO      GMCARD20 IF NOT EQUAL
.
          GOTO      GMCARD99
.
GMCARD80  MOVE      SP70,PMCDCNUM
          MOVE      SP70,PMCDCTYP
          MOVE      SP70,PMCDEXDT
          MOVE      SP70,TDESC
          GOTO      GMCARD99
.
GMCARD99  RETURN
+
.--------------------------------------------------------------------
. Get the patients compensable details if any.
.--------------------------------------------------------------------
. REQUIRES: CLAIMCOD - Claim Code
.           ADMISSNO - Admission number
.
. RETURNS : CLMDET1 = If private the patients health fund name
.                     or W/C, TAC, DVA if compensable
.                     or NILL if not compensable and not private
.           CLMDET2 = If private the patients health fund member number
.                     or W/C, TAC claim numbers, DVA number and (Card Colour)
.                        if compensable
.                     or blank if not compensable and not private
.--------------------------------------------------------------------
CMPH0000  MOVE      SP70,CLMDET1
          MOVE      SP70,CLMDET2
.
          MATCH     SP70,CLAIMCOD
          GOTO      CMPH9999 IF EQUAL
.
          PACK      KEY5,ANSC,ANSL,CLAIMCOD,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,CMPH9999
.
          MATCH     "3",TCINDC5                  * Self insured
          GOTO      CMPH9000 IF EQUAL
.
.------ see what type of claim we have if any exists ------
.
          MOVE      ZERO,FORM2
CMPH1000  ADD       ONE,FORM2
          COMPARE   SIX,FORM2
          GOTO      CMPH5000 IF NOT LESS
.
          LOAD      ANS,FORM2,TCINDC1,TCINDC2,TCINDC3:
                    TCINDC4,TCINDC5
.
          CMATCH    "W",ANS                      * Work Cover
          GOTO      CMPH2000 IF EQUAL
.
          CMATCH    "M",ANS                      * TAC
          GOTO      CMPH3000 IF EQUAL
.
          MATCH    "V",ANS                      * VET
          GOTO      CMPH4000 IF EQUAL
.
          GOTO      CMPH1000
.
CMPH2000  OPEN      PATWC1A1,"patwc1af"          * Work Cover
          MOVE      "W/C",CLMDET1
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDWCOM1
          BRANCH    OVRCD,CMPH9999
.
          MOVE      WCCLMNO,CLMDET2
          GOTO      CMPH9999
.
CMPH3000  OPEN      PATWMAB1,"patwmabf"          * TAC
          MOVE      "TAC",CLMDET1
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDWMAB1
          BRANCH    OVRCD,CMPH9999
.
          MOVE      MREFNO,CLMDET2
          GOTO      CMPH9999
.
CMPH4000  OPEN      PATWVET1,"patwvetf"          * VET
          MOVE      "DVA",CLMDET1
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDWVET1
          BRANCH    OVRCD,CMPH9999
.
          MOVE      SP70,TDESC
          MOVE      THREE,DIM1                * DVA Card Colour 
          CALL      GCCARD00
          MATCH     SP70,PMCDDVAC
          IF        !@EQUAL
            PACK      KEY5,ANSD,ANSX,PMCDDVAC,SP70
            CALL      RDCODE1
            IF        OVRCD=1
              MOVE      PMCDDVAC,TDESC
            ENDIF
          ENDIF
.
          MOVE      TDESC,DIM1
.
          CLEAR     CLMDET2
          STRIP     VCLMNO
          APPEND    VCLMNO,CLMDET2
          APPEND    " (",CLMDET2
          APPEND    DIM1,CLMDET2
          APPEND    ")",CLMDET2
          RESET     CLMDET2
          GOTO      CMPH9999
.
CMPH5000  MATCH     SP70,PFUNDH
          GOTO      CMPH9999 IF EQUAL
.
          PACK      KEY14,PFUNDH,ZERO4,SP70      * Display health fund
          CALL      RDFUND1
          IF        OVRCD=1
            MOVE      PFUNDH,HFNAME
          ENDIF
.
          MOVE      HFNAME,CLMDET1
          MOVE      PFNDMM,CLMDET2
          GOTO      CMPH9999
.
CMPH9000  MOVE      "NIL",CLMDET1                * Self insured
          MOVE      SP70,CLMDET2
.
CMPH9999  RETURN
+
.--------------------------------------------------------------------
. Get concession card details
. DIM1 = 1 - Concession Card
.        2 - Safety Net Card
.        3 - DVA Card
.        4 - Pension Card
.--------------------------------------------------------------------
GCCARD00  MOVE      "ct",DIM2
          PACK      KEY19,PURNO,SP70
          CALL      RSPMCCD1
GCCARD20  CALL      RKPMCCD1
          BRANCH    OVRCD,GCCARD80
.
          MATCH     PURNO,PMCDURNO
          GOTO      GCCARD80 IF NOT EQUAL
.
          PACK      KEY5,DIM2,PMCDCTYP
          CALL      RDCODE1
          BRANCH    OVRCD,GCCARD20
.
          MATCH     DIM1,TCINDC1
          GOTO      GCCARD99 IF EQUAL
.
          GOTO      GCCARD20
.
GCCARD80  MOVE      SP70,PMCDCNUM
          MOVE      SP70,PMCDCTYP
          MOVE      SP70,PMCDEXDT
          MOVE      SP70,PMCDDVAC
          GOTO      GCCARD99
.
GCCARD99  RETURN
.
