.------------------------------------------------------------------------
. Legal status header and detail Fields
.------------------------------------------------------------------------
. Inputs  -  Valid record from the mehhlsaf and mehdlsaf
. Outputs -  Field specified by FLDITMNO & DIM127 for any parameters
.
. Include's needed - MEHHLSFD
.                    MEHDLSFD
.                    PMSHCPFD
. Maintenance :-     
.----------------------------------------------------------------------------
. V11.05.02 20.12.2024 DA Sarkies      TSK 0954547
.           Commented out <cat> tags to prevent browser incompatibility
. V11.05.01 26.11.2024  Ebon Clements  Task 0954547
.           Added <cat-c> start and end tag to category=XX tag
.----------------------------------------------------------------------------
. V10.14.01 12/08/2019  Thanh T.        TSK 0878422
.           Added DLSF3100 
.----------------------------------------------------------------------------
.         V10.13.01 14/08/2018 Tracey Nguyen    TSK 0852969
.                   Added HLSF4200 to call CODITM00 for MHHLSREF
.         V10.11.01 19/10/2017  J.Tan    TSK 0843390
.                   Added MHHLS036 - Responsible DHB
.         V10.06.01 16/03/2015  Don Nguyen    CAR 306757
.                   Added HLSF4000 - LSREF000
.         V10.03.02 12/10/2012  Mike Laming   CAR 272373
.                   Restore HLSF2200 for Responsible Clinician, create WA vers
.                   as HLSF3900
.         V10.03.01 23/11/2011 Peter Vela CAR 255389
.                   Added multihospital validation to TEAM0000 and HCPT0000
.         V10.02.03 18/10/2011 Peter Vela CAR 253188
.                   Added semicolons to date tags
.         V10.02.02 05/10/2011 Peter Vela CAR 252425
.                   Added semicolon at HLSF0200 
.         V10.02.01 08/09/2011 J.Tan     CAR 242151 
.                   Added new fields for WA
.         V10.00.04 29/09/2010  Peter Vela     CAR 230994
.                   Fixed Submit of MHDLS021
.         V10.00.03 20/08/2010  Mike Laming    CAR 195158
.                   Add new cgi flag if any MH Details without End Dates
.         V10.00.02 16/08/2010  Mike Laming    CAR 195158
.                   Add new fields to SMHHLS00 & MVMHHL00 to read input data
.         V10.00.01 23/04/2010  Mike Laming    CAR 195158
.                   Remove test code for 9.12 to 10.00 versions
.         V9.12.01  30/11/2009  Mike Laming    CAR 195158
.                   Add new fields for MEHHLSFD & MEHDLSFD changes - for v9.13
.         V9.10.01  26/05/2008  J.Tan          CAR 166690
.                   Added End Date and Time for mehdlsaf file
.         V9.09.01  03/04/2008  Ebon Clements  CAR 164653
.                   Resindential organisation now type D
.         V9.09.01  31/01/2008  Mike Laming    CAR 152286
.                   Change PATEORFD fields' prefix to PTER (from PTEO -is ICD10)
.              29/03/06 V9.05.01 J.Tan    
.                       Fixed resident name and selection list for MH Ref.Source
.------------------------------------------------------------------------
.   Clear Legal status header fields
.------------------------------------------------------------------------
CLRHLS00  MOVE      SP70,MHHLURNO
          MOVE      SP70,MHHLUNIQ
          MOVE      SP70,MHHLSDAT
          MOVE      SP70,MHHLSTIM
          MOVE      SP70,MHHLEDAT
          MOVE      SP70,MHHLETIM
          MOVE      SP70,MHHLSTAT
          MOVE      SP70,MHHLSREF
          MOVE      SP70,MHHLORCD
          MOVE      SP70,MHHLHCPC
          MOVE      SP70,MHHLRNAM
          MOVE      SP70,MHHLRAD1
          MOVE      SP70,MHHLRAD2
          MOVE      SP70,MHHLRAD3
          MOVE      SP70,MHHLRAD4
          MOVE      SP70,MHHLRPOS
          MOVE      SP70,MHHLRTEL
          MOVE      SP70,MHHLLAWY
          MOVE      SP70,MHHLCURR
          MOVE      SP70,MHHLPRIS
          MOVE      SP70,MHHLESDT
          MOVE      SP70,MHHLMDAT 
          MOVE      SP70,MHHLMTIM 
          MOVE      SP70,MHHLMUID 
          MOVE      SP70,MHHLRSCL
          MOVE      SP70,MHHLCSTM
          MOVE      SP70,MHHLDUAO
          MOVE      SP70,MHHLKWRK
          MOVE      SP70,MHHLLAWT
          MOVE      SP70,MHHLUDFL
          MOVE      SP70,MHHLUDDT
          MOVE      SP70,MHHLCOMM
          MOVE      SP70,MHHLRODT
          MOVE      SP70,MHHLROTM
          MOVE      SP70,MHHLAMDT
          MOVE      SP70,MHHLAMTM
          MOVE      SP70,MHHLOREF
          MOVE      SP70,MHHLRCLI
          MOVE      SP70,MHHLRCLR
          MOVE      SP70,MHHLRDHB
.
CLRHLS99  RETURN
+
.------------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for Legal status Header table
.------------------------------------------------------------------------
CMHHLS00  MOVE      Z70,MHHLS001
          MOVE      Z70,MHHLS002
          MOVE      Z70,MHHLS003
          MOVE      Z70,MHHLS004
          MOVE      Z70,MHHLS005
          MOVE      Z70,MHHLS006
          MOVE      Z70,MHHLS007
          MOVE      Z70,MHHLS008
          MOVE      Z70,MHHLS009
          MOVE      Z70,MHHLS010
          MOVE      Z70,MHHLS011
          MOVE      Z70,MHHLS012
          MOVE      Z70,MHHLS013
          MOVE      Z70,MHHLS014
          MOVE      Z70,MHHLS015
          MOVE      Z70,MHHLS016
          MOVE      Z70,MHHLS017
          MOVE      Z70,MHHLS019
          MOVE      Z70,MHHLS020
          MOVE      Z70,MHHLS021
          MOVE      Z70,MHHLS022
          MOVE      Z70,MHHLS023
          MOVE      Z70,MHHLS024
          MOVE      Z70,MHHLS025
          MOVE      Z70,MHHLS026
          MOVE      Z70,MHHLS027
          MOVE      Z70,MHHLS028
          MOVE      Z70,MHHLS029
          MOVE      Z70,MHHLS030
          MOVE      Z70,MHHLS031
          MOVE      Z70,MHHLS032
          MOVE      Z70,MHHLS033
          MOVE      Z70,MHHLS034
          MOVE      Z70,MHHLS035
          MOVE      Z70,MHHLS036
CMHHLS99  RETURN
.        
.------------------------------------------------------------------------
.   Clear Legal status detail fields
.------------------------------------------------------------------------
CLRDLS00  MOVE      SP70,MHDLURNO
          MOVE      SP70,MHDLUNIQ
          MOVE      SP70,MHDLSDAT
          MOVE      SP70,MHDLSTIM
          MOVE      SP70,MHDLSCOD
          MOVE      SP70,MHDLSTAT
          MOVE      SP70,MHDLRDAT
          MOVE      SP70,MHDLRTIM
          MOVE      SP70,MHDLHCPC
          MOVE      SP70,MHDLCASE
          MOVE      SP70,MHDLPOCC
          MOVE      SP70,MHDLREMD
          MOVE      SP70,MHDLDRIV
          MOVE      SP70,MHDLRESD
          MOVE      SP70,MHDLRCOD
          MOVE      SP70,MHDLACTV
          MOVE      SP70,MHDLCMNT
          MOVE      SP70,MHDLMDAT 
          MOVE      SP70,MHDLMTIM 
          MOVE      SP70,MHDLMUID 
          MOVE      SP70,MHDLSENT
          MOVE      SP70,MHDLEDAT
          MOVE      SP70,MHDLETIM
          MOVE      SP70,MHDLSULS
          MOVE      SP70,MHDLSLSD
          MOVE      SP70,MHDLRPDT
          MOVE      SP70,MHDLCNSD
          MOVE      SP70,MHDLTRDT
          MOVE      SP70,MHDLLWCD
          MOVE      SP70,MHDLCTCD
          MOVE      SP70,MHDLCMN2
          MOVE      SP70,MHDLDOCG
          MOVE      SP70,MHDLSPSY
          MOVE      SP70,MHDLRESP
          MOVE      SP70,MHDLLDOC
.
CLRDLS99  RETURN
+
.------------------------------------------------------------------------
.   Clear Parameters for Legal status Details table
.------------------------------------------------------------------------
CMHDLS00  MOVE      Z70,MHDLS001
          MOVE      Z70,MHDLS002
          MOVE      Z70,MHDLS003
          MOVE      Z70,MHDLS004
          MOVE      Z70,MHDLS005
          MOVE      Z70,MHDLS006
          MOVE      Z70,MHDLS007
          MOVE      Z70,MHDLS008
          MOVE      Z70,MHDLS009
          MOVE      Z70,MHDLS010
          MOVE      Z70,MHDLS011
          MOVE      Z70,MHDLS012
          MOVE      Z70,MHDLS013
          MOVE      Z70,MHDLS014
          MOVE      Z70,MHDLS015
          MOVE      Z70,MHDLS016
          MOVE      Z70,MHDLS017
          MOVE      Z70,MHDLS018
          MOVE      Z70,MHDLS019
          MOVE      Z70,MHDLS020
          MOVE      Z70,MHDLS021
          MOVE      Z70,MHDLS022
          MOVE      Z70,MHDLS023
          MOVE      Z70,MHDLS024
          MOVE      Z70,MHDLS025
          MOVE      Z70,MHDLS026
          MOVE      Z70,MHDLS027
          MOVE      Z70,MHDLS028
          MOVE      Z70,MHDLS029
          MOVE      Z70,MHDLS030
CMHDLS99  RETURN
+
.------------------------------------------------------------------------
.         Legal status header fields
.------------------------------------------------------------------------
HLSF0000  BRANCH    FLDITMNO,HLSF0100,HLSF0200,HLSF0300,HLSF0400,HLSF0500:
                             HLSF0600,HLSF0700,HLSF0800,HLSF0900,HLSF1000:
                             HLSF1100,HLSF1200,HLSF1300,HLSF1400,HLSF1500:
                             HLSF1600,HLSF1700,HLSF1800,HLSF1900,HLSF2000:
                             HLSF2100,HLSF2200,HLSF2300,HLSF2400,HLSF2500:
                             HLSF2600,HLSF2700,HLSF2800,HLSF2900,HLSF3000:
                             HLSF3100,HLSF3200,HLSF3300,HLSF3400,HLSF3500:
                             HLSF3600,HLSF3700,HLSF3800,HLSF3900,HLSF4000:
                             HLSF4100,HLSF4200
.
          WRITE     HTMLFILE;"Invalid IBA Tag HLSF0000";
          GOTO      HLSF9999
.
HLSF0100  WRITE     HTMLFILE;MHHLUNIQ;
          GOTO      HLSF9999
.
HLSF0200  MATCH     SP70,MHHLSDAT
          GOTO      HLSF9999 IF EQUAL
.
          UNPACK    MHHLSDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      HLSF9999
.
HLSF0300  WRITE     HTMLFILE;MHHLSTIM;
          GOTO      HLSF9999
.
HLSF0400  MATCH     SP70,MHHLEDAT
          GOTO      HLSF9999 IF EQUAL
.
          UNPACK    MHHLEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      HLSF9999
.
HLSF0500  WRITE     HTMLFILE;MHHLETIM;
          GOTO      HLSF9999
.
HLSF0600  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,HLSF0610
.
          MATCH     SP70,MHHLSTAT
          IF        @EQUAL
           WRITE     HTMLFILE;"0";   * Active
          ELSE
           WRITE     HTMLFILE;MHHLSTAT;
          ENDIF
          GOTO      HLSF9999
.
HLSF0610  MATCH     "1",MHHLSTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"<font color=#FF0000><b>":
                                 "Inactive</font></b>"
          ELSE
            WRITE     HTMLFILE;"Active";
          ENDIF
          GOTO      HLSF9999
.
HLSF0700  MOVE      "S ",CATEGORY
          MOVE      MHHLSREF,CODE
          CALL      CODREF00
          GOTO      HLSF9999
.
HLSF0800  WRITE     HTMLFILE;MHHLRNAM;
          GOTO      HLSF9999
.
HLSF0900  WRITE     HTMLFILE;MHHLRAD1;
          GOTO      HLSF9999
.
HLSF1000  WRITE     HTMLFILE;MHHLRAD2;
          GOTO      HLSF9999
.
HLSF1100  WRITE     HTMLFILE;MHHLRAD3;
          GOTO      HLSF9999
.
HLSF1200  WRITE     HTMLFILE;MHHLRAD4;
          GOTO      HLSF9999
.
HLSF1300  WRITE     HTMLFILE;MHHLRPOS;
          GOTO      HLSF9999
.
HLSF1400  WRITE     HTMLFILE;MHHLRTEL;
          GOTO      HLSF9999
.
HLSF1500  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,HLSF1510,HLSF1520
          PACK      KEY7,ANSL,MHHLLAWY,SP70
          CALL      RDPTEOR1
          BRANCH    OVRCD,HLSF9999
          WRITE     HTMLFILE;PTERNAME;
          GOTO      HLSF9999
.
HLSF1510  WRITE     HTMLFILE;MHHLLAWY;
          GOTO      HLSF9999
.
.         Lawyer
.
HLSF1520  MOVE      "L",KEY1
          PACK      KEY7,KEY1,SP70
          CALL      RSPTEOR1
HLSF1530  CALL      RKPTEOR1
          BRANCH    OVRCD,HLSF9999
          MATCH     KEY1,PTERTYPE
          GOTO      HLSF9999 IF NOT EQUAL
          MATCH     "1",PTERSTAT
          GOTO      HLSF1530 IF EQUAL      * not active
.
          MOVE      PTERNAME,KEY20
          PACK      KEY8,QUOTE,PTERCODE,QUOTE
          MATCH     MHHLLAWY,PTERCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>",KEY20:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY20:
                               "</option>";
          ENDIF
          GOTO      HLSF1530
.
.         External Organisation for Public hospital and External agency
.
HLSF1600  UNPACK    DIM127,DIM1,KEY1,DIM127
          TYPE      KEY1
          GOTO      HLSF1620 IF NOT EQUAL
.
          MOVE      KEY1,F1
          BRANCH    F1,HLSF1610
          GOTO      HLSF9999
.
HLSF1610  WRITE     HTMLFILE;MHHLORCD;
          GOTO      HLSF9999
.
HLSF1620  PACK      KEY7,KEY1,SP70
          CALL      RSPTEOR1
HLSF1630  CALL      RKPTEOR1
          BRANCH    OVRCD,HLSF9999
          MATCH     KEY1,PTERTYPE
          GOTO      HLSF9999 IF NOT EQUAL
          MATCH     "1",PTERSTAT
          GOTO      HLSF1630 IF EQUAL      * not active
.
          MOVE      PTERNAME,KEY20
          PACK      KEY8,QUOTE,PTERCODE,QUOTE
          MATCH     PTERCODE,MHHLORCD
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>",KEY20:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY20:
                               "</option>";
          ENDIF
          GOTO      HLSF1630
.
HLSF1700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF1710
          PACK      KEY10,MHHLHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,HLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HLSF9999
.
HLSF1710  WRITE     HTMLFILE;MHHLHCPC;
          GOTO      HLSF9999
.
HLSF1800  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,HLSF1810
          MATCH     "1",MHHLCURR
          IF        @EQUAL
            WRITE     HTMLFILE;"1";
          ELSE
            WRITE     HTMLFILE;"0";
          ENDIF
          GOTO      HLSF9999
.
HLSF1810  MATCH     "1",MHHLCURR
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      HLSF9999
.
HLSF1900  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,HLSF1910
          MATCH     "1",MHHLPRIS
          IF        @EQUAL
            WRITE     HTMLFILE;"1";
          ELSE
            WRITE     HTMLFILE;"0";
          ENDIF
          GOTO      HLSF9999
.
HLSF1910  MATCH     "1",MHHLPRIS
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      HLSF9999
.
HLSF2000  MATCH     SP70,MHHLESDT
          GOTO      HLSF9999 IF EQUAL
.
          UNPACK    MHHLESDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      HLSF9999
.
HLSF2100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          BRANCH    F1,HLSF2150
.
          WRITE     HTMLFILE;MHHLORCD;       * external organisation code
          GOTO      HLSF9999                 * for public hospital referral
.
HLSF2150  PACK      KEY5,MHHLORCD,SP70
          CALL      RDPTVAD1
          BRANCH    OVRCD,HLSF9999
.
          WRITE     HTMLFILE;PTVADESC;
          GOTO      HLSF9999
.
HLSF2200  UNPACK    DIM127,D1,KEY1,DIM127   * Responsible Clinician
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF2210,HLSF2220
.
          PACK      KEY10,MHHLRSCL,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,HLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HLSF9999
.
HLSF2210  WRITE     HTMLFILE;MHHLRSCL;
          GOTO      HLSF9999
.
HLSF2220  MOVE      MHHLRSCL,D10
          PACK      KEY20,MHHLCSTM,SP70
          CALL      HCPT0000                   * selection of teams for a hcp
          GOTO      HLSF9999
.
HLSF2300  UNPACK    DIM127,D1,KEY1,DIM127   * Case Team (linked to Respon.Clin)
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF2310,HLSF2320
.
          MATCH     SP70,MHHLCSTM
          GOTO      HLSF9999 IF EQUAL
          MOVE      "Unknown Case Team",ALCADESC
          PACK      KEY10,MHHLCSTM,SP10
          CALL      RDALCAS1
          WRITE     HTMLFILE;ALCADESC;
          GOTO      HLSF9999
.
HLSF2310  WRITE     HTMLFILE;MHHLCSTM;
          GOTO      HLSF9999
.
HLSF2320  CALL      TEAM0000                * Selection of teams
          GOTO      HLSF9999
.
HLSF2400  UNPACK    DIM127,D1,KEY1,DIM127   * Duly Authorised Officer
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF2410
          PACK      KEY10,MHHLDUAO,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,HLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HLSF9999
.
HLSF2410  WRITE     HTMLFILE;MHHLDUAO;
          GOTO      HLSF9999
.
HLSF2500  UNPACK    DIM127,D1,KEY1,DIM127   * Key Worker (all Active HCPs)
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF2510
          PACK      KEY10,MHHLKWRK,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,HLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HLSF9999
.
HLSF2510  WRITE     HTMLFILE;MHHLKWRK;
          GOTO      HLSF9999
.
HLSF2600  WRITE     HTMLFILE;MHHLLAWT;      * Lawyer Free Text field
          GOTO      HLSF9999
.
HLSF2700  UNPACK    DIM127,DIM1,KEY1,DIM127 * "Unfit to Drive" flag
          MOVE      KEY1,F1
          BRANCH    F1,HLSF2710
          MATCH     "1",MHHLUDFL
          IF        @EQUAL
            WRITE     HTMLFILE;"1";
          ELSE
            WRITE     HTMLFILE;"0";
          ENDIF
          GOTO      HLSF9999
.
HLSF2710  MATCH     "1",MHHLUDFL
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      HLSF9999
.
HLSF2800  MATCH     SP70,MHHLUDDT           *"Unfit" Date Client Notified
          GOTO      HLSF9999 IF EQUAL
.
          UNPACK    MHHLUDDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      HLSF9999
.
HLSF2900  WRITE     HTMLFILE;MHHLCOMM;      * Comments text
          GOTO      HLSF9999
.
HLSF3000  MOVE      "N",KEY1                * Check for Active LS Details
          PACK      KEY32,MHHLURNO,MHHLUNIQ,SP30
          CALL      RSMHDLS1
HLSF3010  CALL      RKMHDLS1
          BRANCH    OVRCD,HLSF3090
          MATCH     MHHLURNO,MHDLURNO
          GOTO      HLSF3090 IF NOT EQUAL
          MATCH     MHHLUNIQ,MHDLUNIQ
          GOTO      HLSF3090 IF NOT EQUAL
          MATCH     "0",MHDLACTV            * "0"=Active, "1"=Inactive
          GOTO      HLSF3010 IF NOT EQUAL
          MOVE      "Y",KEY1
HLSF3090  WRITE     HTMLFILE;KEY1;          * N=No, Y=Yes
          GOTO      HLSF9999
.
HLSF3100  MOVE      "N",KEY1                * Check Details without End Date
          PACK      KEY32,MHHLURNO,MHHLUNIQ,SP30
          CALL      RSMHDLS1
HLSF3110  CALL      RKMHDLS1
          BRANCH    OVRCD,HLSF3190
          MATCH     MHHLURNO,MHDLURNO
          GOTO      HLSF3190 IF NOT EQUAL
          MATCH     MHHLUNIQ,MHDLUNIQ
          GOTO      HLSF3190 IF NOT EQUAL
          MATCH     SP8,MHDLEDAT
          GOTO      HLSF3110 IF NOT EQUAL
          MOVE      "Y",KEY1
HLSF3190  WRITE     HTMLFILE;KEY1;          * N=No, Y=Yes
          GOTO      HLSF9999
.
HLSF3200  MATCH     SP70,MHHLRODT
          GOTO      HLSF9999 IF EQUAL
.
          UNPACK    MHHLRODT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      HLSF9999
.
HLSF3300  WRITE     HTMLFILE;MHHLROTM;
          GOTO      HLSF9999
.
HLSF3400  MATCH     SP70,MHHLAMDT
          GOTO      HLSF9999 IF EQUAL
.
          UNPACK    MHHLAMDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      HLSF9999
.
HLSF3500  WRITE     HTMLFILE;MHHLAMTM;
          GOTO      HLSF9999
.
HLSF3600  MOVE      "tm",CATEGORY            * Origin of Referral
          MOVE      MHHLOREF,CODE
          CALL      CODITM00
          GOTO      HLSF9999
.
HLSF3700  UNPACK    DIM127,D1,KEY1,DIM127   * Ref.Clinician (all Active HCPs)
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF3710
          PACK      KEY10,MHHLRCLI,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,HLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HLSF9999
.
HLSF3710  WRITE     HTMLFILE;MHHLRCLI;
          GOTO      HLSF9999
.
HLSF3800  MOVE      "rm",CATEGORY            * Referring clinician role
          MOVE      MHHLRCLR,CODE
          CALL      CODITM00
          GOTO      HLSF9999
.
HLSF3900  UNPACK    DIM127,D1,KEY1,DIM127   * WA ver. of Responsible Clinician
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HLSF3910,HLSF3920
.
          MOVE      MHHLRSCL,DOCTCODE
          CALL      DOCDET00
          GOTO      HLSF9999
.
HLSF3910  WRITE     HTMLFILE;MHHLRSCL;
          GOTO      HLSF9999
.
HLSF3920  MOVE      MHHLRSCL,D10
          PACK      KEY20,MHHLCSTM,SP70
          CALL      HCPT0000                * selection of teams for a hcp
          GOTO      HLSF9999
.
HLSF4000  CALL      LSREF000
          GOTO      HLSF9999
.
HLSF4100  MOVE      "dh",CATEGORY           * Responsible DHB
          MOVE      MHHLRDHB,CODE
          CALL      CODITM00
          GOTO      HLSF9999
.
HLSF4200  MOVE      "S ",CATEGORY           * Ref Source 
          MOVE      MHHLSREF,CODE
          CALL      CODITM00
          GOTO      HLSF9999
.
HLSF9999  RETURN
+
.------------------------------------------------------------
.         Selection of team
.------------------------------------------------------------
TEAM0000  MOVE      SP70,KEY10
          CALL      RSALCAS1
TEAM1000  CALL      RKALCAS1
          BRANCH    OVRCD,TEAM9999
.
          IF        IBCNMHOS=ONE
            MATCH     WBSEHOSP,ALCAHOSP
            GOTO      TEAM1000 IF NOT EQUAL
          ENDIF
.
          MATCH     MHHLCSTM,ALCATEAM
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",ALCATEAM," selected>":
                               ALCADESC,"</option>"
          ELSE
            WRITE    HTMLFILE;"<option value=",ALCATEAM,">",ALCADESC,"</option>"
          ENDIF
          GOTO      TEAM1000
.
TEAM9999  RETURN
+
.------------------------------------------------------------
.         Codes selections for MH Referral source
.------------------------------------------------------------
CODREF00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CODREF10,CODREF20
          CALL      GETCOD00
          WRITE     HTMLFILE;TDESC;
          GOTO      CODREF99
.
CODREF10  PACK      CODE,CODE,SP70
          MATCH     SP70,CODE
          GOTO      CODREF99 IF EQUAL
          WRITE     HTMLFILE;CODE;
          GOTO      CODREF99
.
CODREF20  CALL      REFSEL00
          GOTO      CODREF99
.
CODREF99  RETURN
+
.------------------------------------------------------------
.         Referral selections 
.------------------------------------------------------------
REFSEL00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
REFSEL10  CALL      RDKCODE2
          BRANCH    OVRCD,REFSEL99
          MATCH     CATEGORY,TCODE
          GOTO      REFSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      REFSEL10 IF EQUAL
          MATCH     SP1,TCINDC7
          GOTO      REFSEL10 IF EQUAL     * Not MH Ref.Source
.
          PACK      KEY25,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6
          PACK      KEY30,QUOTE,ACODE,KEY25,QUOTE
          MATCH     CODE,ACODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY30," selected>":
                               TDESC,"</option>"
          ELSE
            MATCH     "I",PTCOACTV
            GOTO      REFSEL10 IF EQUAL
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,REFSEL10
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=",KEY30,">",TDESC,"</option>"
          ENDIF
          GOTO      REFSEL10
.
REFSEL99  RETURN
+
.------------------------------------------------------------
.         Legal Status Detail fields
.------------------------------------------------------------
DLSF0000  BRANCH    FLDITMNO,DLSF0100,DLSF0200,DLSF0300,DLSF0400,DLSF0500:
                             DLSF0600,DLSF0700,DLSF0800,DLSF0900,DLSF1000:
                             DLSF1100,DLSF1200,DLSF1300,DLSF1400,DLSF1500:
                             DLSF1600,DLSF1700,DLSF1800,DLSF1900,DLSF2000:
                             DLSF2100,DLSF2200,DLSF2300,DLSF2400,DLSF2500:
                             DLSF2600,DLSF2700,DLSF2800,DLSF2900,DLSF3000:
                             DLSF3100
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      DLSF9999
.
DLSF0100  WRITE     HTMLFILE;MHDLUNIQ;
          GOTO      DLSF9999
.
DLSF0200  MATCH     SP70,MHDLSDAT
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLSDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF0300  WRITE     HTMLFILE;MHDLSTIM;
          GOTO      DLSF9999
.
DLSF0400  MOVE      "LS",CATEGORY
          MOVE      MHDLSCOD,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF0500  MOVE      "LR",CATEGORY
          MOVE      MHDLSTAT,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF0600  MATCH     SP70,MHDLRDAT
          GOTO      DLSF9999 IF EQUAL 
.
          UNPACK    MHDLRDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF0700  WRITE     HTMLFILE;MHDLRTIM;
          GOTO      DLSF9999
.
.         HCP code
.
DLSF0800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,DLSF0810
          PACK      KEY10,MHDLHCPC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      DLSF9999
.
DLSF0810  WRITE     HTMLFILE;MHDLHCPC;
          GOTO      DLSF9999
.
DLSF0900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,DLSF0910,DLSF0920
          PACK      KEY10,MHDLCASE,SP70
          CALL      RDALCAS1
          BRANCH    OVRCD,DLSF9999
          WRITE     HTMLFILE;ALCADESC;
          GOTO      DLSF9999
.
DLSF0910  WRITE     HTMLFILE;MHDLCASE;
          GOTO      DLSF9999
.
DLSF0920  MOVE      MHDLHCPC,D10
          CALL      HCPT0000                   * selection of teams for a hcp
          GOTO      HCPT1000
.
DLSF1000  MOVE      "PO",CATEGORY
          MOVE      MHDLPOCC,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF1100  MATCH     SP70,MHDLREMD
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLREMD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF1200  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,DLSF1210
          MATCH     "1",MHDLDRIV
          IF        @EQUAL
            WRITE     HTMLFILE;"1";
          ELSE
            WRITE     HTMLFILE;"0";
          ENDIF
          GOTO      DLSF9999
.
DLSF1210  MATCH     "1",MHDLDRIV
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      DLSF9999
.
DLSF1300  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,DLSF1310
          MATCH     "1",MHDLRESD
          IF        @EQUAL
            WRITE     HTMLFILE;"1";
          ELSE
            WRITE     HTMLFILE;"0";
          ENDIF
          GOTO      DLSF9999
.
DLSF1310  MATCH     "1",MHDLRESD
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      DLSF9999
.
DLSF1400  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,DLSF1410,DLSF1420
          PACK      KEY7,ANSD,MHDLRCOD,SP70
          CALL      RDPTEOR1
          BRANCH    OVRCD,DLSF9999
          WRITE     HTMLFILE;PTERNAME;
          GOTO      DLSF9999
.
DLSF1410  WRITE     HTMLFILE;MHDLRCOD;
          GOTO      DLSF9999
.
DLSF1420  MOVE      "D",KEY1
          PACK      KEY7,KEY1,SP70
          CALL      RSPTEOR1
DLSF1430  CALL      RKPTEOR1
          BRANCH    OVRCD,DLSF9999
          MATCH     KEY1,PTERTYPE
          GOTO      DLSF9999 IF NOT EQUAL
          MATCH     "1",PTERSTAT
          GOTO      DLSF1430 IF EQUAL      * not active
.
          MOVE      PTERNAME,KEY20
          PACK      KEY8,QUOTE,PTERCODE,QUOTE
          MATCH     MHDLRCOD,PTERCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>",KEY20:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY20:
                               "</option>";
          ENDIF
          GOTO      DLSF1430
.
DLSF1500  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,DLSF1510
.
          MATCH     SP70,MHDLACTV
          IF        @EQUAL
           WRITE     HTMLFILE;"0";   * Active
          ELSE
           WRITE     HTMLFILE;MHDLACTV;
          ENDIF
          GOTO      DLSF9999
.
DLSF1510  MATCH     "1",MHDLACTV
          IF        @EQUAL
            WRITE     HTMLFILE;"Inactive";
          ELSE
            WRITE     HTMLFILE;"Active";
          ENDIF
          GOTO      DLSF9999
.
DLSF1600  WRITE     HTMLFILE;MHDLCMNT;
          GOTO      DLSF9999
.
DLSF1700  MATCH     SP70,MHDLEDAT
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF1800  WRITE     HTMLFILE;MHDLETIM;
          GOTO      DLSF9999
.
DLSF1900  MOVE      "LS",CATEGORY           * Supp.Legal Status
          MOVE      MHDLSULS,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF2000  MATCH     SP70,MHDLSLSD
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLSLSD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF2100  MATCH     SP70,MHDLRPDT
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLRPDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF2200  MATCH     SP70,MHDLCNSD
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLCNSD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF2300  MATCH     SP70,MHDLTRDT
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLTRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF2400  MATCH     SP70,MHDLLWCD
          GOTO      DLSF9999 IF EQUAL
.
          UNPACK    MHDLLWCD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      DLSF9999
.
DLSF2500  MOVE      "xy",CATEGORY           * Supp.Legal Status Cat."xy"
          MOVE      MHDLCTCD,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF2600  WRITE     HTMLFILE;MHDLCMN2;
          GOTO      DLSF9999
.
DLSF2700  MOVE      "to",CATEGORY           * Pt Documentation Given
          MOVE      MHDLDOCG,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF2800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,DLSF2810
          PACK      KEY10,MHDLSPSY,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      DLSF9999
.
DLSF2810  WRITE     HTMLFILE;MHDLSPSY;
          GOTO      DLSF9999
.
DLSF2900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,DLSF2910
          PACK      KEY10,MHDLRESP,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      DLSF9999
.
DLSF2910  WRITE     HTMLFILE;MHDLRESP;
          GOTO      DLSF9999
.
DLSF3000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,DLSF3010
          PACK      KEY10,MHDLLDOC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,DLSF9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      DLSF9999
.
DLSF3010  WRITE     HTMLFILE;MHDLLDOC;
          GOTO      DLSF9999
.
DLSF3100  MOVE      "PO",CATEGORY
          MOVE      SP70,CODE
          CALL      CODITM00
          GOTO      DLSF9999
.
DLSF9999  RETURN
+
.------------------------------------------------------------
.         Selection of teams for a doctor
.------------------------------------------------------------
HCPT0000  PACK      KEY20,D10,SP70
          CALL      RSALCTM2
HCPT1000  CALL      RKALCTM2
          BRANCH    OVRCD,HCPT9999
          MATCH     D10,ALCTHCPC          * same hcp?
          GOTO      HCPT9999 IF NOT EQUAL
.
          PACK      KEY10,ALCTTEAM,SP70
          CALL      RDALCAS1
          BRANCH    OVRCD,HCPT1000
.
          IF        IBCNMHOS=ONE
            MATCH     WBSEHOSP,ALCAHOSP
            GOTO      HCPT1000 IF NOT EQUAL
          ENDIF
.
          MOVE      ALCADESC,KEY20
          PACK      KEY12,QUOTE,ALCATEAM,QUOTE
          MATCH     KEY20,ALCATEAM
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY12," selected>",KEY20:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY12,">",KEY20:
                               "</option>";
          ENDIF
          GOTO       HCPT1000
HCPT9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for LS header table
.------------------------------------------------------------
SMHHLS00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          PACK      QRYDATA,QRYDATA,SP70
          BRANCH    F3,SMHHLS01,SMHHLS02,SMHHLS03,SMHHLS04,SMHHLS05:
                       SMHHLS06,SMHHLS07,SMHHLS08,SMHHLS09,SMHHLS10:
                       SMHHLS11,SMHHLS12,SMHHLS13,SMHHLS14,SMHHLS15:
                       SMHHLS16,SMHHLS17,SMHHLS18,SMHHLS19,SMHHLS20:
                       SMHHLS21,SMHHLS22,SMHHLS23,SMHHLS24,SMHHLS25:
                       SMHHLS26,SMHHLS27,SMHHLS28,SMHHLS29,SMHHLS30:
                       SMHHLS31,SMHHLS32,SMHHLS33,SMHHLS34,SMHHLS35:
                       SMHHLS36
.
          MOVE      ONE,EXIT
          GOTO      SMHHLS99
.
SMHHLS01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,MHHLS001
          PACK      MHHLS001,MHHLS001,SP70
          GOTO      SMHHLS99
.
SMHHLS02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHHLS002,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHHLS99
.
SMHHLS03  MOVE      QRYDATA,MHHLS003
          GOTO      SMHHLS99
.
SMHHLS04  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHHLS004,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHHLS99
.
SMHHLS05  MOVE      QRYDATA,MHHLS005
          GOTO      SMHHLS99
.
SMHHLS06  MOVE      QRYDATA,MHHLS006
          GOTO      SMHHLS99
.
SMHHLS07  MOVE      QRYDATA,MHHLS007
          GOTO      SMHHLS99
.
SMHHLS08  MOVE      QRYDATA,MHHLS008
          GOTO      SMHHLS99
.
SMHHLS09  MOVE      QRYDATA,MHHLS009
          GOTO      SMHHLS99
.
SMHHLS10  MOVE      QRYDATA,MHHLS010
          GOTO      SMHHLS99
.
SMHHLS11  MOVE      QRYDATA,MHHLS011
          GOTO      SMHHLS99
.
SMHHLS12  MOVE      QRYDATA,MHHLS012
          GOTO      SMHHLS99
.
SMHHLS13  MOVE      QRYDATA,MHHLS013
          GOTO      SMHHLS99
.
SMHHLS14  MOVE      QRYDATA,MHHLS014
          GOTO      SMHHLS99
.
SMHHLS15  MOVE      QRYDATA,MHHLS015
          GOTO      SMHHLS99
.
SMHHLS16  MOVE      QRYDATA,MHHLS016
          GOTO      SMHHLS99
.
SMHHLS17  MOVE      QRYDATA,MHHLS017
          GOTO      SMHHLS99
.
SMHHLS18  MOVE      QRYDATA,MHHLS018
          GOTO      SMHHLS99
.
SMHHLS19  MOVE      QRYDATA,MHHLS019
          GOTO      SMHHLS99
.
SMHHLS20  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHHLS020,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHHLS99
.
SMHHLS21  MOVE      QRYDATA,MHHLS021
          GOTO      SMHHLS99
.
SMHHLS22  MOVE      QRYDATA,MHHLS022
          GOTO      SMHHLS99
.
SMHHLS23  MOVE      QRYDATA,MHHLS023
          GOTO      SMHHLS99
.
SMHHLS24  MOVE      QRYDATA,MHHLS024
          GOTO      SMHHLS99
.
SMHHLS25  MOVE      QRYDATA,MHHLS025
          GOTO      SMHHLS99
.
SMHHLS26  MOVE      QRYDATA,MHHLS026
          GOTO      SMHHLS99
.
SMHHLS27  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHHLS027,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHHLS99
.
SMHHLS28  MOVE      QRYDATA,MHHLS028
          GOTO      SMHHLS99
.
SMHHLS29  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHHLS029,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHHLS30  MOVE      QRYDATA,MHHLS030
          GOTO      SMHDLS99
.
SMHHLS31  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHHLS031,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHHLS32  MOVE      QRYDATA,MHHLS032
          GOTO      SMHDLS99
.
SMHHLS33  MOVE      QRYDATA,MHHLS033
          GOTO      SMHDLS99
.
SMHHLS34  MOVE      QRYDATA,MHHLS034
          GOTO      SMHDLS99
.
SMHHLS35  MOVE      QRYDATA,MHHLS035
          GOTO      SMHDLS99
.
SMHHLS36  MOVE      QRYDATA,MHHLS036
          GOTO      SMHDLS99
.
SMHHLS99  RETURN
+
.------------------------------------------------------------
.   Set Parameters for LS details table
.------------------------------------------------------------
SMHDLS00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          PACK      QRYDATA,QRYDATA,SP70
          MOVE      KEY3,F3
          BRANCH    F3,SMHDLS01,SMHDLS02,SMHDLS03,SMHDLS04,SMHDLS05:
                       SMHDLS06,SMHDLS07,SMHDLS08,SMHDLS09,SMHDLS10:
                       SMHDLS11,SMHDLS12,SMHDLS13,SMHDLS14,SMHDLS15:
                       SMHDLS16,SMHDLS17,SMHDLS18,SMHDLS19,SMHDLS20:
                       SMHDLS21,SMHDLS22,SMHDLS23,SMHDLS24,SMHDLS25:
                       SMHDLS26,SMHDLS27,SMHDLS28,SMHDLS29,SMHDLS30
.
          MOVE      ONE,EXIT
          GOTO      SMHDLS99
.
SMHDLS01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,MHDLS001
          GOTO      SMHDLS99
.
SMHDLS02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS002,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS03  MOVE      QRYDATA,MHDLS003
          GOTO      SMHDLS99
.
SMHDLS04  MOVE      QRYDATA,MHDLS004
          GOTO      SMHDLS99
.
SMHDLS05  MOVE      QRYDATA,MHDLS005
          GOTO      SMHDLS99
.
SMHDLS06  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS006,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS07  MOVE      QRYDATA,MHDLS007
          GOTO      SMHDLS99
.
SMHDLS08  MOVE      QRYDATA,MHDLS008
          GOTO      SMHDLS99
.
SMHDLS09  MOVE      QRYDATA,MHDLS009
          GOTO      SMHDLS99
.
SMHDLS10  MOVE      QRYDATA,MHDLS010
          GOTO      SMHDLS99
.
SMHDLS11  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS011,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS12  MOVE      QRYDATA,MHDLS012
          GOTO      SMHDLS99
.
SMHDLS13  MOVE      QRYDATA,MHDLS013
          GOTO      SMHDLS99
.
SMHDLS14  MOVE      QRYDATA,MHDLS014
          GOTO      SMHDLS99
.
SMHDLS15  MOVE      QRYDATA,MHDLS015
          GOTO      SMHDLS99
.
SMHDLS16  MOVE      QRYDATA,MHDLS016
          GOTO      SMHDLS99
.
SMHDLS17  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS017,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS18  MOVE      QRYDATA,MHDLS018
          GOTO      SMHDLS99
.
SMHDLS19  MOVE      QRYDATA,MHDLS019
          GOTO      SMHDLS99
.
SMHDLS20  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS020,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS21  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS021,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS22  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS022,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS23  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS023,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS24  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MHDLS024,CCENT,CYEAR,CMON,CDAY
          GOTO      SMHDLS99
.
SMHDLS25  MOVE      QRYDATA,MHDLS025
          GOTO      SMHDLS99
.
SMHDLS26  MOVE      QRYDATA,MHDLS026
          GOTO      SMHDLS99
.
SMHDLS27  MOVE      QRYDATA,MHDLS027
          GOTO      SMHDLS99
.
SMHDLS28  MOVE      QRYDATA,MHDLS028
          GOTO      SMHDLS99
.
SMHDLS29  MOVE      QRYDATA,MHDLS029
          GOTO      SMHDLS99
.
SMHDLS30  MOVE      QRYDATA,MHDLS030
          GOTO      SMHDLS99
.
SMHDLS99  RETURN
+
.------------------------------------------------------------
.  Update Header file
.------------------------------------------------------------
MVMHHL00  MATCH     MHHLS002,Z70
          IF        !@EQUAL
            MOVE      MHHLS002,MHHLSDAT
          ENDIF
.
          MATCH     MHHLS003,Z70
          IF        !@EQUAL
            MOVE      MHHLS003,MHHLSTIM
          ENDIF
.
          MATCH     MHHLS004,Z70
          IF        !@EQUAL
            MOVE      MHHLS004,MHHLEDAT
          ENDIF
.
          MATCH     MHHLS005,Z70
          IF        !@EQUAL
            MOVE      MHHLS005,MHHLETIM
          ENDIF
.
          MATCH     MHHLS006,Z70
          IF        !@EQUAL
            MOVE      MHHLS006,MHHLSTAT
          ENDIF
.
          MATCH     MHHLS007,Z70
          IF        !@EQUAL
            MOVE      MHHLS007,MHHLSREF
          ENDIF
.
          MATCH     MHHLS008,Z70
          IF        !@EQUAL
            MOVE      MHHLS008,MHHLRNAM
          ENDIF
.
          MATCH     MHHLS009,Z70
          IF        !@EQUAL
            MOVE      MHHLS009,MHHLRAD1
          ENDIF
.
          MATCH     MHHLS010,Z70
          IF        !@EQUAL
            MOVE      MHHLS010,MHHLRAD2
          ENDIF
.
          MATCH     MHHLS011,Z70
          IF        !@EQUAL
            MOVE      MHHLS011,MHHLRAD3
          ENDIF
.
          MATCH     MHHLS012,Z70
          IF        !@EQUAL
            MOVE      MHHLS012,MHHLRAD4
          ENDIF
.
          MATCH     MHHLS013,Z70
          IF        !@EQUAL
            MOVE      MHHLS013,MHHLRPOS
          ENDIF
.
          MATCH     MHHLS014,Z70
          IF        !@EQUAL
            MOVE      MHHLS014,MHHLRTEL
          ENDIF
.
          MATCH     MHHLS015,Z70
          IF        !@EQUAL
            MOVE      MHHLS015,MHHLLAWY
          ENDIF
.
          MATCH     MHHLS016,Z70
          IF        !@EQUAL
            MOVE      MHHLS016,MHHLORCD
          ENDIF
.
          MATCH     MHHLS017,Z70
          IF        !@EQUAL
            MOVE      MHHLS017,MHHLHCPC
          ENDIF
.
          MATCH     MHHLS018,Z70
          IF        !@EQUAL
            MOVE      MHHLS018,MHHLCURR
          ENDIF
.
          MATCH     MHHLS019,Z70
          IF        !@EQUAL
            MOVE      MHHLS019,MHHLPRIS
          ENDIF
.
          MATCH     MHHLS020,Z70
          IF        !@EQUAL
            MOVE      MHHLS020,MHHLESDT
          ENDIF
.
          MATCH     MHHLS021,Z70
          IF        !@EQUAL
            PACK      MHHLRSCL,MHHLS021,SP20
          ENDIF
.
          MATCH     MHHLS022,Z70
          IF        !@EQUAL
            PACK      MHHLCSTM,MHHLS022,SP20
          ENDIF
.
          MATCH     MHHLS023,Z70
          IF        !@EQUAL
            PACK      MHHLDUAO,MHHLS023,SP20
          ENDIF
.
          MATCH     MHHLS024,Z70
          IF        !@EQUAL
            PACK      MHHLKWRK,MHHLS024,SP20
          ENDIF
.
          MATCH     MHHLS025,Z70
          IF        !@EQUAL
            PACK      MHHLLAWT,MHHLS025,SP70
          ENDIF
.
          MATCH     MHHLS026,Z70
          IF        !@EQUAL
            PACK      MHHLUDFL,MHHLS026,SP20
          ENDIF
.
          MATCH     MHHLS027,Z70
          IF        !@EQUAL
            PACK      MHHLUDDT,MHHLS027,SP20
          ENDIF
.
          MATCH     MHHLS028,Z70
          IF        !@EQUAL
            PACK      MHHLCOMM,MHHLS028,SP70,SP70
          ENDIF
.
          MATCH     MHHLS029,Z70
          IF        !@EQUAL
            MOVE      MHHLS029,MHHLRODT
          ENDIF
.
          MATCH     MHHLS030,Z70
          IF        !@EQUAL
            MOVE      MHHLS030,MHHLROTM
          ENDIF
.
          MATCH     MHHLS031,Z70
          IF        !@EQUAL
            MOVE      MHHLS031,MHHLAMDT
          ENDIF
.
          MATCH     MHHLS032,Z70
          IF        !@EQUAL
            MOVE      MHHLS032,MHHLAMTM
          ENDIF
.
          MATCH     MHHLS033,Z70
          IF        !@EQUAL
            PACK      MHHLOREF,MHHLS033,SP70
          ENDIF
.
          MATCH     MHHLS034,Z70
          IF        !@EQUAL
            PACK      MHHLRCLI,MHHLS034,SP70
          ENDIF
.
          MATCH     MHHLS035,Z70
          IF        !@EQUAL
            PACK      MHHLRCLR,MHHLS035,SP70
          ENDIF
.
          MATCH     MHHLS036,Z70
          IF        !@EQUAL
            PACK      MHHLRDHB,MHHLS036,SP70
          ENDIF
.
MVMHHL99  RETURN
.
.------------------------------------------------------------
.  Update Details file
.------------------------------------------------------------
MVMHDL00  MATCH     MHDLS001,Z70
          IF        !@EQUAL
            MOVE      MHDLS001,MHDLUNIQ
          ENDIF
.
          MATCH     MHDLS002,Z70
          IF        !@EQUAL
            MOVE      MHDLS002,MHDLSDAT
          ENDIF
.
          MATCH     MHDLS003,Z70
          IF        !@EQUAL
            MOVE      MHDLS003,MHDLSTIM
          ENDIF
.
          MATCH     MHDLS004,Z70
          IF        !@EQUAL
            MOVE      MHDLS004,MHDLSCOD
          ENDIF
.
          MATCH     MHDLS005,Z70
          IF        !@EQUAL
            MOVE      MHDLS005,MHDLSTAT
          ENDIF
.
          MATCH     MHDLS006,Z70
          IF        !@EQUAL
            MOVE      MHDLS006,MHDLRDAT
          ENDIF
.
          MATCH     MHDLS007,Z70
          IF        !@EQUAL
            MOVE      MHDLS007,MHDLRTIM
          ENDIF
.
          MATCH     MHDLS008,Z70
          IF        !@EQUAL
            MOVE      MHDLS008,MHDLHCPC
          ENDIF
.
          MATCH     MHDLS009,Z70
          IF        !@EQUAL
            MOVE      MHDLS009,MHDLCASE
          ENDIF
.
          MATCH     MHDLS010,Z70
          IF        !@EQUAL
            MOVE      MHDLS010,MHDLPOCC
          ENDIF
.
          MATCH     MHDLS011,Z70
          IF        !@EQUAL
            MOVE      MHDLS011,MHDLREMD
          ENDIF
.
          MATCH     MHDLS012,Z70
          IF        !@EQUAL
            MOVE      MHDLS012,MHDLDRIV
          ENDIF
.
          MATCH     MHDLS013,Z70
          IF        !@EQUAL
            MOVE      MHDLS013,MHDLRESD
          ENDIF
.
          MATCH     MHDLS014,Z70
          IF        !@EQUAL
            MOVE      MHDLS014,MHDLRCOD
          ENDIF
.
          MATCH     MHDLS015,Z70
          IF        !@EQUAL
            MOVE      MHDLS015,MHDLACTV
          ENDIF
.
          MATCH     MHDLS016,Z70
          IF        !@EQUAL
            MOVE      MHDLS016,MHDLCMNT
          ENDIF
.
          MATCH     MHDLS017,Z70
          IF        !@EQUAL
            MOVE      MHDLS017,MHDLEDAT
          ENDIF
.
          MATCH     MHDLS018,Z70
          IF        !@EQUAL
            MOVE      MHDLS018,MHDLETIM
          ENDIF
.
          MATCH     MHDLS019,Z70
          IF        !@EQUAL
            PACK      MHDLSULS,MHDLS019,SP10
          ENDIF
.
          MATCH     MHDLS020,Z70
          IF        !@EQUAL
            PACK      MHDLSLSD,MHDLS020,SP10
          ENDIF
.
          MATCH     MHDLS021,Z70
          IF        !@EQUAL
            PACK      MHDLRPDT,MHDLS021,SP10
          ENDIF
.
          MATCH     MHDLS022,Z70
          IF        !@EQUAL
            PACK      MHDLCNSD,MHDLS022,SP10
          ENDIF
.
          MATCH     MHDLS023,Z70
          IF        !@EQUAL
            PACK      MHDLTRDT,MHDLS023,SP10
          ENDIF
.
          MATCH     MHDLS024,Z70
          IF        !@EQUAL
            PACK      MHDLLWCD,MHDLS024,SP10
          ENDIF
.
          MATCH     MHDLS025,Z70
          IF        !@EQUAL
            PACK      MHDLCTCD,MHDLS025,SP10
          ENDIF
.
          MATCH     MHDLS026,Z70
          IF        !@EQUAL
            PACK      MHDLCMN2,MHDLS026,SP70,SP70
          ENDIF
.
          MATCH     MHDLS027,Z70
          IF        !@EQUAL
            PACK      MHDLDOCG,MHDLS027,SP10
          ENDIF
.
          MATCH     MHDLS028,Z70
          IF        !@EQUAL
            PACK      MHDLSPSY,MHDLS028,SP10
          ENDIF
.
          MATCH     MHDLS029,Z70
          IF        !@EQUAL
            PACK      MHDLRESP,MHDLS029,SP10
          ENDIF
.
          MATCH     MHDLS030,Z70
          IF        !@EQUAL
            PACK      MHDLLDOC,MHDLS030,SP10
          ENDIF
.
MVMHDL99  RETURN
+
.-------------------------------------------------------------
. LSREF000 - Search for current open Inpatient MH Referral and
.            current open Legal Status
.-------------------------------------------------------------
LSREF000  OPEN      MEHHLSA2,"mehhlsaf"
.
          PACK      KEY32,URNUMBER,Z70
          CALL      RSMHHLS2
LSREF100  CALL      RPMHHLS2
          BRANCH    OVRCD,LSREF999
.
          MATCH     URNUMBER,MHHLURNO
          GOTO      LSREF999 IF NOT EQUAL
.
          MATCH     SP70,MHHLOREF
          GOTO      LSREF100 IF EQUAL
.
          PACK      KEY5,CATtm,MHHLOREF,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,LSREF100
.
          MATCH     ANSI,TCINDC1
          GOTO      LSREF100 IF NOT EQUAL
.
          MATCH     "1",MHHLSTAT
          GOTO      LSREF100 IF EQUAL
.
          MATCH     SP70,MHHLEDAT
          GOTO      LSREF100 IF NOT EQUAL
.
          PACK      KEY32,MHHLURNO,MHHLUNIQ,Z70
          CALL      RSMHDLS1
LSREF200  CALL      RPMHDLS1
          BRANCH    OVRCD,LSREF999
.
          MATCH     MHHLURNO,MHDLURNO
          GOTO      LSREF999 IF NOT EQUAL
.
          MATCH     MHHLUNIQ,MHDLUNIQ
          GOTO      LSREF999 IF NOT EQUAL
.
          MATCH     SP70,MHDLEDAT
          GOTO      LSREF200 IF NOT EQUAL
.
          WRITE     HTMLFILE;MHDLURNO,MHDLUNIQ,MHDLSDAT,MHDLSTIM;
          GOTO      LSREF999
.
LSREF999  RETURN
+
