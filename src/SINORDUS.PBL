.------------------------------------------------------------
. V9.04.01 11.04.2005 Peter Vela CAR 59696
.          Changed commodity code from DIM 5 to DIM 6
. VF.00.00 05.11.1998 Sandra Barcham
.          Year 2000 compliance
.------------------------------------------------------------
.  Include  file - SINORDUS.PBL Update Purchase Order Usage Files
.
.  Usage File Update
.  -----------------
.  SINCGBFD   Commodity Usage
.  SINCIHFD   Catalog Usage Usage
.  SINSUAFD   Product Group Masterfile
.  SINSUBFD   Product Group Usage
.  APSSUBFD   Supplier Usage
.---------------------------------------------------
.  Required Input
.  --------------
.  Record Read from the SINCIA file (Catalog)
.  Current Period in SIPEYEAR and SIPEPER
.  Amount   of Usage Adjustment SIUSCST
.  Quantity of Usage Adjustment SIUSQTY
.
.  Files Required to be Open
.  ------------------------- 
.  SINCCBA1
.  SINCCEA1
.  SINCCFA1
.  SINCGBA1
.  SINCIHA1
.  SINSUAA1
.  SINSUBA1
.
.  Field Used Update
.  -----------------
.  SIPASUP  - Supplier Code
.  SIPCPRD  - Product Group
.  SISACOMM - Commodity Group
.  SIPCCAT  - Catalog
.  SIPCWAR  - Warehouse
.  SICACODE - Cost Centre
.  SIPEYEAR - Year
.  SIPEPER  - Period
.
.---------------------------------------------------
SINORDUS   PACK     KEY5,SIPCPRD
           CALL     RDSISA1
           IF       OVRCD=1
             MOVE     SP70,SISACOMM
           ENDIF
           PACK     KEY6,SIPEYEAR,SIPEPER
           REP      " 0",KEY6
.
. Commodity
.----------
SINOUS10   PACK     KEY12,SISACOMM,KEY6                                *C-59696
           UNPACK   KEY12,SIGBCOM,SIGBDAT                              *C-59696
           CALL     RLSIGB1
           BRANCH   OVRCD,SINOUS15,SINOUS10
           ADD      SIUSCST,SIGBPAM
           CALL     UPSIGB1
           CALL     UUSIGB1
           GOTO     SINOUS20
.
SINOUS15   MOVE     SIUSCST,SIGBPAM
           MOVE     ZERO,SIGBUBD
           MOVE     ZERO,SIGBUAM
           MOVE     ZERO,SIGBPBD
           MOVE     ZERO,SIGBRAM
           MOVE     ZERO,SIGBRBD
           MOVE     SP70,SIGBSPA
           CALL     WRSIGB1
.
. Product Group
.---------------
SINOUS20   PACK     KEY11,SIPCPRD,KEY6
           UNPACK   KEY11,SISBSUB,SISBDAT
           CALL     RLSISB1
           BRANCH   OVRCD,SINOUS25,SINOUS20
           ADD      SIUSCST,SISBPAM
           CALL     UPSISB1
           CALL     UUSISB1
           GOTO     SINOUS30
SINOUS25   MOVE     SIUSCST,SISBPAM
           MOVE     ZERO,SISBUBD
           MOVE     ZERO,SISBUAM
           MOVE     ZERO,SISBPBD
           MOVE     ZERO,SISBRAM
           MOVE     ZERO,SISBRBD
           MOVE     SP70,SISBSPA
           CALL     WRSISB1
.
. Catalog/Warehouse Usage
.------------------------
SINOUS30   PACK     KEY18,SIPCCAT,SIPCWAR,KEY6
           UNPACK   KEY18,SIIHCAT,SIIHWAR,SIIHDAT
           CALL     RLSIIH1
           BRANCH   OVRCD,SINOUS35,SINOUS30
           ADD      SIUSCST,SIIHPAM
           ADD      SIUSQTY,SIIHPQT
           CALL     UPSIIH1
           CALL     UUSIIH1
           GOTO     SINOUS40
SINOUS35
           MOVE     SIUSCST,SIIHPAM
           MOVE     SIUSQTY,SIIHPQT
           MOVE     ZERO,SIIHUQT
           MOVE     ZERO,SIIHUAM
           MOVE     ZERO,SIIHRQT
           MOVE     ZERO,SIIHRAM
           MOVE     SP70,SIIHSPA
           CALL     WRSIIH1
.
. Supplier 
.---------
SINOUS40   MATCH    SP70,SIPASUP
           GOTO     SINOUS50 IF EQUAL
.
           PACK     KEY11,SIPASUP,KEY6
           UNPACK   KEY11,APSBSUP,APSBDAT
           CALL     RLAPSB1
           BRANCH   OVRCD,SINOUS45,SINOUS40
           ADD      SIUSCST,APSBPAM
           CALL     UPAPSB1
           CALL     UUAPSB1
           GOTO     SINOUS50
.
SINOUS45   MOVE     SIUSCST,APSBPAM
           MOVE     ZERO,APSBIBD
           MOVE     ZERO,APSBIAM
           MOVE     ZERO,APSBPBD
           MOVE     ZERO,APSBRAM
           MOVE     ZERO,APSBRBD
           MOVE     SP70,APSBSPA
           CALL     WRAPSB1
.
SINOUS50   RETURN
