.**************************************************************************
.*  GPAC0000  :  Get Personal Responsible for Account details             *
.*  Modifications :                                                       *
.*                                                                        *
.*  V11.00.01  02/04/2020  J.Tan             TSK 0868813                  *
.*             Changed PKNAME to DIM80                                    *
.*  V10.07.01  30/01/2017  Jill Parkinson TSK 0831185                     *
.*             Removed @ symbol and changed to Parent of                  *
.**************************************************************************
GPAC0000  PACK      PKNAME,SP70,SP10
          UNPACK    SP70,PKADD1,PKADD2 
          UNPACK    SP70,PKADD4,PKSUBR
          UNPACK    SP70,PKPOST,PKTELEP 
          UNPACK    SP70,PKTELEB,PKRELP
.
          COMPARE   ONE,CSRESP                   * Using 'Self' for P.R.A. ?
          GOTO      GPAC9999 IF NOT EQUAL
.
          COMPARE   ONE,PTCNPAOF                 * Using 'Parent of' option?
          GOTO      GPAC0500 IF NOT EQUAL
.
          COMPARE   PSAGE,PTCNAGEC               * Child?
          GOTO      GPAC0500 IF LESS             * No
.
          CALL      PAOF0000                     * setup 'parent of' details
          GOTO      GPAC9999
.
GPAC0500  MOVE      SP1,ANS
          MOVE      PGNAME,ANS
.
          MATCH     SP4,PTITL
          GOTO      GPAC1000 IF EQUAL
          PACK      PKNAME,PTITL,SP1,ANS,DOT,PTMASNAM,SP70
          GOTO      GPAC2000
.
GPAC1000  PACK      PKNAME,ANS,DOT,PTMASNAM,SP70
.
GPAC2000  PACK      PKADD1,PADD1,SP30,SP10
          PACK      PKADD2,PADD2,SP30,SP10
          PACK      PKSUBR,PSUBRB,SP30,SP10
          PACK      PKADD4,PADD4,SP30,SP10
          PACK      PKPOST,PPOST,SP4,SP10
          PACK      PKTELEP,PTELEP,SP70
          PACK      PKTELEB,PTELEB,SP70
          MOVE      "SELF",PKRELP
.
GPAC9999  RETURN
.**************************************************************************
.*  PAOF0000  :  Setup 'Parent of' as Person Responsible for Account
.*  Note         This is done by storing "Parent of " as
.*               the first character of PKNAME, and defaulting PKRELP
.*               to "PARENT".
.**************************************************************************
PAOF0000  MOVE      SP1,ANS
          MOVE      PGNAME,ANS

PAOF1000  CLEAR     PKNAME
          APPEND    "Parent of ",PKNAME
          APPEND    ANS,PKNAME
          APPEND    DOT,PKNAME
          APPEND    PTMASNAM,PKNAME
          APPEND    SP70,PKNAME
          APPEND    SP10,PKNAME
          RESET     PKNAME
.
PAOF2000  PACK      PKADD1,PADD1,SP30,SP10
          PACK      PKADD2,PADD2,SP30,SP10
          PACK      PKSUBR,PSUBRB,SP20,SP10
          PACK      PKADD4,PADD4,SP30,SP10
          PACK      PKPOST,PPOST,SP4,SP10
          PACK      PKTELEP,PTELEP,SP70
          PACK      PKTELEB,PTELEB,SP70
          MOVE      "PARENT",PKRELP
.
PAOF9999  RETURN
.**************************************************************************
.*  ZKIN0000  :  Initialize Next of Kin Variables     Called by: GADM0000 *
.**************************************************************************
ZKIN0000  MOVE      SP20,PNKNAME
          PACK      PNKADD1,SP30,SP10
          PACK      PNKADD2,SP30,SP10
          PACK      PNKSUBR,SP30,SP10
          MOVE      SP8,PNKPOST
          PACK      PNKADD4,SP30,SP10
          MOVE      SP20,PNKTELP
          MOVE      SP20,PNKTELB
          MOVE      SP10,PNKRELP
.
          PACK      PKNAME,SP70,SP10
          PACK      PKADD1,SP30,SP10
          PACK      PKADD2,SP30,SP10
          PACK      PKSUBR,SP30,SP10
          PACK      PKADD4,SP30,SP10
          MOVE      SP8,PKPOST
          MOVE      SP20,PKTELEP
          MOVE      SP20,PKTELEB
          MOVE      SP20,PKRELP
ZKIN9999  RETURN
