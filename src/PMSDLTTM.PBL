. *----------------------------------------------------------------------
. * Include Name  :   PMSDLTTM.PBL
. *
. * Function      :   CGI variables for PMSDLTTM - pmsdltaf.dat
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V9.09.00  15.10.2007 Ebon Clements CAR 151931
.            Created Include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for doctors letter selections
.------------------------------------------------------------------------
CPPMDS00  MOVE      Z70,PMDLT001
          MOVE      Z70,PMDLT002
          MOVE      Z70,PMDLT003
          MOVE      Z70,PMDLT004
          MOVE      Z70,PMDLT005
          MOVE      Z70,PMDLT006
          MOVE      Z70,PMDLT007
          MOVE      Z70,PMDLT008
          MOVE      Z70,PMDLT009
          MOVE      Z70,PMDLT010
          MOVE      Z70,PMDLT011
          MOVE      Z70,PMDLT012
          MOVE      Z70,PMDLT013
          MOVE      Z70,PMDLT014
          MOVE      Z70,PMDLT015
          MOVE      Z70,PMDLT016
          MOVE      Z70,PMDLT017
          MOVE      Z70,PMDLT018
          MOVE      Z70,PMDLT019
          MOVE      Z70,PMDLT020
          MOVE      Z70,PMDLT021
          MOVE      Z70,PMDLT022
          MOVE      Z70,PMDLT023
          MOVE      Z70,PMDLT024
.
CPPMDS99  RETURN
.
.------------------------------------------------------------
. Doctors letter selection file tags
.------------------------------------------------------------
PMDS0000  BRANCH    FLDITMNO,PMDS0010,PMDS0020,PMDS0030,PMDS0040,PMDS0050:
                             PMDS0060,PMDS0070,PMDS0080,PMDS0090,PMDS0100:
                             PMDS0110,PMDS0120,PMDS0130,PMDS0140,PMDS0150:
                             PMDS0160,PMDS0170,PMDS0180,PMDS0190,PMDS0200:
                             PMDS0210,PMDS0220,PMDS0230,PMDS0240,PMDS0250
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMDS9999
.
PMDS0010  WRITE     HTMLFILE;PMDSSELI;
          GOTO      PMDS9999
.
PMDS0020  WRITE     HTMLFILE;PMDSDESC;
          GOTO      PMDS9999
.
PMDS0030  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMDS0031
.
          PACK      KEY10,PMDSHCPF,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PMDS9999
.
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      PMDS9999
.
PMDS0031  WRITE     HTMLFILE;PMDSHCPF;
          GOTO      PMDS9999
.
PMDS0040  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMDS0041
.         
          PACK      KEY10,PMDSHCPT,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PMDS9999
.
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      PMDS9999
.
PMDS0041  WRITE     HTMLFILE;PMDSHCPT;
          GOTO      PMDS9999
.
PMDS0050  MOVE      "DT",CATEGORY
          MOVE      PMDSPSFR,CODE
          CALL      CODITM00
          GOTO      PMDS9999
.
PMDS0060  MOVE      "DT",CATEGORY
          MOVE      PMDSPSTO,CODE
          CALL      CODITM00
          GOTO      PMDS9999
.
PMDS0070  MOVE      "DT",CATEGORY
          MOVE      PMDSASFR,CODE
          CALL      CODITM00
          GOTO      PMDS9999
.
PMDS0080  MOVE      "DT",CATEGORY
          MOVE      PMDSASTO,CODE
          CALL      CODITM00
          GOTO      PMDS9999
.
PMDS0090  CALL      HOSSEL00                * Hospital Code
          GOTO      PMDS9999
.
PMDS0100  MOVE      "CZ",CATEGORY
          MOVE      PMDSPREF,CODE
          CALL      CODITM00
          GOTO      PMDS9999
.
PMDS0110  MATCH     PMDSFADF,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSFADF,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0120  MATCH     PMDSFADT,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSFADT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0130  MATCH     PMDSLADF,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSLADF,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0140  MATCH     PMDSLADT,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSLADT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0150  WRITE     HTMLFILE;PMDSHCST;
          GOTO      PMDS9999
.
PMDS0160  MOVE      "AT",CATEGORY
          MOVE      PMDSATYP,CODE
          CALL      CODITM00
          GOTO      PMDS9999
.
PMDS0170  WRITE     HTMLFILE;PMDSYACF;
          GOTO      PMDS9999
. 
PMDS0180  WRITE     HTMLFILE;PMDSYACT;
          GOTO      PMDS9999
. 
PMDS0190  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMDS0191
.         
          PACK      KEY5,PMDSINSC,SP70
          CALL      RDINSR1
          BRANCH    OVRCD,PMDS9999
.
          WRITE     HTMLFILE;INAME;
          GOTO      PMDS9999
.         
PMDS0191  WRITE     HTMLFILE;PMDSINSC;
          GOTO      PMDS9999
.
PMDS0200  MATCH     PMDSIDFF,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSIDFF,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0210  MATCH     PMDSIDFT,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSIDFT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0220  MATCH     PMDSIDTF,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSIDTF,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0230  MATCH     PMDSIDTT,SP70
          GOTO      PMDS9999 IF EQUAL
.
          UNPACK    PMDSIDTT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDS9999
.
PMDS0240  WRITE     HTMLFILE;PMDSACTV;
          GOTO      PMDS9999
.
PMDS0250  CALL      DSLT0000            
          GOTO      PMDS9999
.
PMDS9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for doctors letter selections
.------------------------------------------------------------
SPPMD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMD001,SPPMD002,SPPMD003,SPPMD004,SPPMD005:
                       SPPMD006,SPPMD007,SPPMD008,SPPMD009,SPPMD010:
                       SPPMD011,SPPMD012,SPPMD013,SPPMD014,SPPMD015:
                       SPPMD016,SPPMD017,SPPMD018,SPPMD019,SPPMD020:
                       SPPMD021,SPPMD022,SPPMD023,SPPMD024
.
          MOVE      ONE,EXIT
          GOTO      SPPMD999 
.
SPPMD001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMDLT001
          PACK      PMDLT001,PMDLT001,SP70
          GOTO      SPPMD999
.
SPPMD002  MOVE      QRYDATA,PMDLT002
          GOTO      SPPMD999
.
SPPMD003  MOVE      QRYDATA,PMDLT003
          GOTO      SPPMD999
.
SPPMD004  MOVE      QRYDATA,PMDLT004
          GOTO      SPPMD999
.
SPPMD005  MOVE      QRYDATA,PMDLT005
          GOTO      SPPMD999
.
SPPMD006  MOVE      QRYDATA,PMDLT006
          GOTO      SPPMD999
.
SPPMD007  MOVE      QRYDATA,PMDLT007
          GOTO      SPPMD999
.
SPPMD008  MOVE      QRYDATA,PMDLT008
          GOTO      SPPMD999
.
SPPMD009  MOVE      QRYDATA,PMDLT009
          GOTO      SPPMD999
.
SPPMD010  MOVE      QRYDATA,PMDLT010
          GOTO      SPPMD999
.
SPPMD011  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT011,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD012  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT012,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD013  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT013,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD014  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT014,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD015  MOVE      QRYDATA,PMDLT015
          GOTO      SPPMD999
.
SPPMD016  MOVE      QRYDATA,PMDLT016
          GOTO      SPPMD999
.
SPPMD017  MOVE      QRYDATA,PMDLT017
          GOTO      SPPMD999
.
SPPMD018  MOVE      QRYDATA,PMDLT018
          GOTO      SPPMD999
.
SPPMD019  MOVE      QRYDATA,PMDLT019
          GOTO      SPPMD999
.
SPPMD020  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT020,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD021  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT021,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD022  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT022,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD023  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMDLT023,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMD999
.
SPPMD024  MOVE      QRYDATA,PMDLT024
          GOTO      SPPMD999
.
SPPMD999  RETURN
.
.------------------------------------------------------------
.  Update doctors letter selections file
.------------------------------------------------------------
MVPMDS00  MATCH     PMDLT001,Z70
          IF        !@EQUAL
            MOVE      PMDLT001,PMDSSELI
          ENDIF
.
          MATCH     PMDLT002,Z70
          IF        !@EQUAL
            MOVE      PMDLT002,PMDSDESC
          ENDIF
.
          MATCH     PMDLT003,Z70
          IF        !@EQUAL
            MOVE      PMDLT003,PMDSHCPF
          ENDIF
.
          MATCH     PMDLT004,Z70
          IF        !@EQUAL
            MOVE      PMDLT004,PMDSHCPT
          ENDIF
.
          MATCH     PMDLT005,Z70
          IF        !@EQUAL
            MOVE      PMDLT005,PMDSPSFR
          ENDIF
.
          MATCH     PMDLT006,Z70
          IF        !@EQUAL
            MOVE      PMDLT006,PMDSPSTO
          ENDIF
.
          MATCH     PMDLT007,Z70
          IF        !@EQUAL
            MOVE      PMDLT007,PMDSASFR
          ENDIF
.
          MATCH     PMDLT008,Z70
          IF        !@EQUAL
            MOVE      PMDLT008,PMDSASTO
          ENDIF
.
          MATCH     PMDLT009,Z70
          IF        !@EQUAL
            MOVE      PMDLT009,PMDSHOSP
          ENDIF
.
          MATCH     PMDLT010,Z70
          IF        !@EQUAL
            MOVE      PMDLT010,PMDSPREF
          ENDIF
.
          MATCH     PMDLT011,Z70
          IF        !@EQUAL
            MOVE      PMDLT011,PMDSFADF
          ENDIF
.
          MATCH     PMDLT012,Z70
          IF        !@EQUAL
            MOVE      PMDLT012,PMDSFADT
          ENDIF
.
          MATCH     PMDLT013,Z70
          IF        !@EQUAL
            MOVE      PMDLT013,PMDSLADF
          ENDIF
.
          MATCH     PMDLT014,Z70
          IF        !@EQUAL
            MOVE      PMDLT014,PMDSLADT
          ENDIF
.
          MATCH     PMDLT015,Z70
          IF        !@EQUAL
            MOVE      PMDLT015,PMDSHCST
          ENDIF
.
          MATCH     PMDLT016,Z70
          IF        !@EQUAL
            MOVE      PMDLT016,PMDSATYP
          ENDIF
.
          MATCH     PMDLT017,Z70
          IF        !@EQUAL
            MOVE      PMDLT017,PMDSYACF
          ENDIF
.
          MATCH     PMDLT018,Z70
          IF        !@EQUAL
            MOVE      PMDLT018,PMDSYACT
          ENDIF
.
          MATCH     PMDLT019,Z70
          IF        !@EQUAL
            MOVE      PMDLT019,PMDSINSC
          ENDIF
.
          MATCH     PMDLT020,Z70
          IF        !@EQUAL
            MOVE      PMDLT020,PMDSIDFF
          ENDIF
.
          MATCH     PMDLT021,Z70
          IF        !@EQUAL
            MOVE      PMDLT021,PMDSIDFT
          ENDIF
.
          MATCH     PMDLT022,Z70
          IF        !@EQUAL
            MOVE      PMDLT022,PMDSIDTF
          ENDIF
.
          MATCH     PMDLT023,Z70
          IF        !@EQUAL
            MOVE      PMDLT023,PMDSIDTT
          ENDIF
.
          MATCH     PMDLT024,Z70
          IF        !@EQUAL
            MOVE      PMDLT024,PMDSACTV
          ENDIF
.
MVPMDS99  RETURN

.------------------------------------------------------------
. Hospital Selection List
.------------------------------------------------------------
HOSSEL00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MATCH     SP70,PMDSHOSP
          GOTO      HOSSEL20 IF EQUAL
.
          PACK      KEY3,PMDSHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,HOSSEL20
.
          BRANCH    F1,HOSSEL10,HOSSEL20
          WRITE     HTMLFILE;PTHSHOSP;
          GOTO      HOSSEL99
.
HOSSEL10  WRITE     HTMLFILE;PTHSNAME;
          GOTO      HOSSEL99
.
HOSSEL20  CALL      HHSL0000
.
HOSSEL99  RETURN
.------------------------------------------------------------
. Hospital Selection
.------------------------------------------------------------
HHSL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
HHSL0100  CALL      RKPTHSP1
          BRANCH    OVRCD,HHSL9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
          MATCH     PMDSHOSP,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      HHSL0100
.
HHSL9999  RETURN
.
.           
.------------------------------------------------------------
.  Clear doctors letter selections file
.------------------------------------------------------------
CLPMDS00  MOVE      SP70,PMDSSELI
          MOVE      SP70,PMDSDESC
          MOVE      SP70,PMDSHCPF
          MOVE      SP70,PMDSHCPT
          MOVE      SP70,PMDSPSFR
          MOVE      SP70,PMDSPSTO
          MOVE      SP70,PMDSASFR
          MOVE      SP70,PMDSASTO
          MOVE      SP70,PMDSHOSP
          MOVE      SP70,PMDSPREF
          MOVE      SP70,PMDSFADF
          MOVE      SP70,PMDSFADT
          MOVE      SP70,PMDSLADF
          MOVE      SP70,PMDSLADT
          MOVE      SP70,PMDSHCST
          MOVE      SP70,PMDSATYP
          MOVE      SP70,PMDSYACF
          MOVE      SP70,PMDSYACT
          MOVE      SP70,PMDSINSC
          MOVE      SP70,PMDSIDFF
          MOVE      SP70,PMDSIDFT
          MOVE      SP70,PMDSIDTF
          MOVE      SP70,PMDSIDTT
          MOVE      SP70,PMDSACTV
          MOVE      SP70,PMDSSPAR
.
CLPMDS99  RETURN
.
.------------------------------------------------------------
. List of doctors letter selections
.------------------------------------------------------------
DSLT0000  MOVE      SP70,KEY4
          CALL      RSPMDLT1
DSLT1000  CALL      RKPMDLT1
          BRANCH    OVRCD,DSLT9999
.
          CLEAR     HTMLLINK
          APPEND    "javascript:UpdateItem('",HTMLLINK
          APPEND    PMDSSELI,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
.
          MOVE      "DT",CATEGORY
          MOVE      PMDSPSFR,CODE
          CALL      GETCOD00
          MOVE      TDESC,KEY20
.
          MOVE      "DT",CATEGORY
          MOVE      PMDSPSTO,CODE
          CALL      GETCOD00
.
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",PMDSSELI,"#",":
                             "#"",PMDSDESC,"#",":
                             "#"",KEY20,"#",":
                             "#"",TDESC,"#");"
.
          GOTO      DSLT1000
.
DSLT9999  RETURN
