.******************************************************************************
.* System         : Patient                                                   *
.*                                                                            *
.* Include Name   : PATPRLAB.PBL                                              *
.*                                                                            *
.* Author         : Krusty the Clown                                          *
.*                                                                            *
.* Function       : To print the patient labels using data from Patient       *
.*                  master and admission files                                *
.*                                                                            *
.* Modifications  :                                                           *
.******************************************************************************
.*       V11.01.01  14/02/2022  Ebon Clements    TSK 0911639                  *
.*                  Print 8 characters for U/R barcode on STVLABEL            *
.*                  WLINEZ16,D8                                               *
.******************************************************************************
.*       V10.14.01  15/02/2019  Thanh T.         TSK 0869660                  *
.*                  Changed STVLABEL for STV label truncating issue           *
.******************************************************************************
.*       V10.12.01  06/03/2018  Steve Armstrong  TSK 0853233                  *
.*                  Mods to STV PMI label to move DoB, Age and Claim Code     *
.*                  fields slightly to the left.                              *
.******************************************************************************
.*       V10.10.02  11/07/2017  Ebon Clements    TSK 0841035                  *
.*                  Removed check for LABELINP/33 for STV labels.             *
.*       V10.10.01  29/06/2017  Steve Armstrong  TSK 0841035                  *
.*                  Added check for LABELINP/33 for STV labels.               *
.******************************************************************************
.*       V10.08.01  10/09/2015  Steve Armstrong  TSK 0817740                  *
.*                  Mods to create GP labels for STV for both PMI and I/P.    *
.******************************************************************************
.*       V10.06.05  10/09/2015  Steve Armstrong  CAR 315321                   *
.*                  Mods to remove Marital Status and Religion fields from    *
.*                  STV PMI labels.                                           *
.*       V10.06.04  01/09/2015  Steve Armstrong  CAR 321211                   *
.*                  Fixed printing of I/P PMI labels for STV.                 *
.*       V10.06.03  15/07/2015  Steve Armstrong  CAR 315999                   *
.*                  Mods to handle printing of Wrist Band Labels (Screen "02")*
.*                  for STV Layout (25).                                      *
.*       V10.06.02  17/04/2015  Don Nguyen       CAR 303612                   *
.*                  Restored order in which WLINEZ18 was layed out previously *
.*       V10.06.01  31/03/2015  Don Nguyen       CAR 303612                   *
.*                  Modified ROYAL000 - Added WLINEZ19 for Aboriginality      *
.******************************************************************************
.*       V10.05.01  17/07/2014  Steve Armstrong  CAR 294204                   *
.*                  Added printing for label type 26 (SJOGIP00) for           *
.*                  SJOG Geelong labels.                                      *
.******************************************************************************
.*       V10.03.02  03/10/2013  Steve Armstrong  CAR 288277                   *
.*                  Mods for alternate STV PMI Zebra label format - added     *
.*                  further test for "LABELPMI".                              *
.*       V10.03.01  15/08/2013  Steve Armstrong  CAR 288277                   *
.*                  Mods for alternate STV PMI Zebra label format             *
.******************************************************************************
.*        V9.06.01  06/06/2006  Steve Armstrong  CAR 107577                   *
.*                  Changed the font size for U/R on STV labels from 35,38 to *
.*                  30,25 and changed the horizontal position of the U/R from *
.*                  155 to 170.                                               *
.******************************************************************************
.*        V9.02.12  27/06/2002  Bronko                                        *
.*                  changed the size of the UR number being printer for St V  *
.*        V9.02.11  10/06/2002  Bronko                                        *
.*                  changed Address label to print UR number as well          *
.*        V9.02.10  25/05/2002  Bronko                                        *
.*                  Fixed Patient Address Label                               *
.*        V9.02.09  21/04/2002  Bronko                                        *
.*                  Mods for STV PMI labels on go live                        *
.*        V9.02.08  18/04/2002  Tonii                                         *
.*                  Mods for STV PMI labels                                   *
.*        V9.02.07  03/04/2002  Bronko Sosic                                  *
.*                  Added STVLAB03 to print Address labels for St Vincent's   *
.*        V9.02.06  07/03/2002  Tonii                                         *
.*                  Added STVLAB02 to print nutrition labels for St Vincent's *
.*        V9.02.05  30/01/2002  Tonii                                         *
.*                  RCH LABELS - new layout for PMI labels                    *
.*                  - mods to print new fields added in PATSETLB              *
.*        V9.02.04  03/11/2001  Tonii                                         *
.*                   St VINCENT LABELS                                        *
.*                  - Fixed printing of St Vincent labels, batch printing now *
.*                    faster, moved "0" to NOCOPIES after print job           *
.*                  02/11/2001  Bronko Sosic                                  *
.*                   RCH LABELS                                               *
.*                  - Inserted "*" after the barcode CMDLINE                  *
.*        V9.02.03  26/10/2001  Tonii                                         *
.*                  Mods to print WRCHURNO and not PURNO                      *
.*        V9.02.02  05/09/2001  Tonii                                         *
.*                  Added new layout 26, for Royal Children's                 *
.*        V9.02.01  13/08/2001  Tonii                                         *
.*                  Added new layout 25, for St Vincent's                     *
.*        V5.08.03  22/11/2000  Greg Horvat                                   *
.*                  Recompiled for LABELINP - Commented out any code to do    *
.*                  with Hong Kong or Mt Alvernia                             *
.*        V5.08.02  29/09/2000  Dean Cramer                                   *
.*                  Recompiled for changes to DXPATMAS via LABELINP           *
.*        V5.08.B01 25/02/2000  Greg Horvat      SRF 637565                   *
.*                  Recompiled for DADMDETS - Changes for 4 character DRGs    *
.*        V5.07.02  24/08/1999  Greg Horvat                                   *
.*                  Recompiled for DADMDETS - Fixed I*C                       *
.*        V5.07.01  07/07/1999  Greg Horvat      99/00 PRS2 Mods              *
.*                  - Recompiled for DADMDETS - Changed to display contrt vars*
.*                  - Replaced certain variables & with KEY variables         *
.*                  08/10/1998  Glenn Berry      5.07 changes                 *
.******************************************************************************
.*        V5.05.01  14/10/1997  Steve Armstrong                               *
.*                  Mods for Wrist Band Labels                                *
.******************************************************************************
.*        V5.02.01  03/01/1995  Graeme Williams   SRF 134242                  *
.*                  Added inpatient label for Greenslopes (layout 19)         *
.*        V5.02.02  17/01/1995  Whirlpool     SRF134197                       *
.*                  fixed bolding on PORT MAC                                 *
.*        V5.02.03  28/04/1995  Greg Horvat      SRF 136165                   *
.*                  Added inpatient label for St. Lukes - layout 20           *
.*        V5.03.01  07/06/1995  Greg Horvat                                   *
.*                  Added inpatient label for Coast Health Care - layout 21   *
.*        V5.03.02  14/06/1995  Greg Horvat      SRF 136820                   *
.*                  Added inpatient label for St. Vincents Bath - layout 22   *
.*        V5.03.03  26/07/1995  Greg Horvat                                   *
.*                  Added inpatient label for Mersey - layout 23              *
.*        V5.04.00  16/07/1996  Steve Armstrong  SRF 641467                   *
.*                  Added inpatient label for Mercy Dunedin - layout 24       *
.*        V5.04.01  03/02/1997  Howellsy                                      *
.*                  Added Screen Painted Labels                               *
.*                                                                            *
.******************************************************************************
.
. ------- LINE-UP PRINT -------
.
PRTLINUP  CALL      SETLINUP
          DISPLAY   *P1:24,*EL,*P20:24,*V2LON," ** Generating Line-Up **";
          LOAD      NOLABEL,LABCOS,ONE,TWO,THREE
.
. ---- The following Label Types have Arm Bands : ---
. 2  - Mercy
. 4  - S.A.W.M.
. 11 - West Gippsland 
. 18 - Port Macquarie
. 23 - Mersey
.
          BRANCH    CTYPLAB,CNTLNUP,ARMBAND,CNTLNUP,ARMBAND,CNTLNUP:
                            CNTLNUP,CNTLNUP,CNTLNUP,CNTLNUP,CNTLNUP:
                            ARMBAND,CNTLNUP,CNTLNUP,CNTLNUP,CNTLNUP:
                            CNTLNUP,CNTLNUP,ARMBAND,CNTLNUP,CNTLNUP:
                            CNTLNUP,CNTLNUP,ARMBAND,CNTLNUP,CNTLNUP:
                            CNTLNUP
          GOTO      CNTLNUP
.
ARMBAND   LOAD      NOLABEL,LABCOS,ONE,ONE,TWO
CNTLNUP   CALL      PATPRLAB
          RETURN
.
.*********************************************************************
.         print the labels
.         Para's  : ADATE         spaces means do PMI labels
.                   ADATE         asterisks means do line up
.*********************************************************************
PATPRLAB  MOVE      ZERO,ENDFLG
          MATCH     SP8,ADATE
          GOTO      PATPR100 IF EQUAL       * doing PMI labels
          MATCH     "********",ADATE
          GOTO      PATPR200 IF EQUAL       * doing line up - normal
          IF        CTYPLAB = 26
            GOTO      PATPR100
          ENDIF
.
. inpatient labels
.
          COMPARE   TWENTY7,CTYPLAB
          GOTO      PATPR200 IF EQUAL
.
          IF        CTYPLAB <> 25
            PROC      LABELINP
          ELSE
            MOVE      ONE,EXIT
          ENDIF
          COMPARE   ZERO,EXIT
          RETURN    IF EQUAL                * labels printed / 0 labels selected
          GOTO      PATPR200                * do normal labels
.
. pmi labels
.
PATPR100  IF        CTYPLAB <> 26 
            PROC      LABELPMI
          ELSE
            GOTO      PATPR200
          ENDIF
          COMPARE   ZERO,EXIT
          RETURN    IF EQUAL                * labels printed / 0 labels selected
.
          MOVE      ZERO,EXIT               * clear exit status
          IF        CTYPLAB = 15
            CALL      SETLBML3
          ELSE
            CALL      SETLBML4         * Set up U/R Labels
          ENDIF
          COMPARE   ONE,EXIT
          RETURN    IF EQUAL                * cancel selected from setlbml4
.
PATPR200  DISPLAY   *P1:24,*EL,*V2LON,"***  Printing Labels  ***";
          CALL      OPNPRINT
NOOPNLAB  COMPARE   ZERO,NOLABEL
          GOTO      ENDLABS IF EQUAL
.
.################################################################
.   START OF PRINTING LABELS
.################################################################
.
          COMPARE   TWENTY7,CTYPLAB
          GOTO      CNTLAB IF EQUAL
.
          COMPARE   TEN3,CTYPLAB
          GOTO      DUDLAB IF EQUAL      * Dudley label
.
          BRANCH    CSIZLAB,SMLLAB,WIDLAB
.
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "*** Size of LABELS not SET.....Contact I.B.A ***",*W5;
          GOTO      ENDLABS
.
SMLLAB    MOVE      "37",TABPOS2
          MOVE      "73",TABPOS3
          GOTO      CNTLAB
.
WIDLAB    MOVE      "42",TABPOS2
          MOVE      "83",TABPOS3
          GOTO      CNTLAB
.
DUDLAB    MOVE      "32",TABPOS2
          MOVE      "63",TABPOS3
          MOVE      "94",TABPOS4
.
. ---- The following Label Types have Arm Bands : ---
. 2  - Mercy
. 4  - S.A.W.M.
. 11 - West Gippsland
. 18 - Port Macquarie 
. 23 - Mersey
.
CNTLAB    BRANCH    CTYPLAB,PATPRLB1,FMLABEL,PATPRLB1,FMLABEL,PATPRLB1:
                            PATPRLB1,PATPRLB1,PATPRLB1,ACWBLABL,PATPRLB1:
                            WGWBLABL,PATPRLB1,PATPRLB1,PATPRLB1,PATPRLB1:
                            PATPRLB1,PATPRLB1,PMWBLABL,PATPRLB1,PATPRLB1:
                            PATPRLB1,PATPRLB1,MERBLABL,PATPRLB1,PATPRLB1:
                            PATPRLB1,PATPRLB1
.
          BRANCH    LABCOS,FLABEL1,FLABEL2,FLABEL3
.
.        First line of labels : 1 label across page
.
FLABEL1   PRINT     *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N:
                    *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 2 labels across page
.
FLABEL2   PRINT     *1,WFLINE1,*TABPOS2,WLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WLINE3,*N:
                    *TABPOS2,WLINE4,*N:
                    *1,WFLINE1,*TABPOS2,WLINE5,*N:
                    *1,WFLINE2,*TABPOS2,WLINE6,*N:
                    *1,WFLINE3,*TABPOS2,WLINE7,*N:
                    *TABPOS2,WLINE8,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
.        First line of labels : 3 labels across page
.
FLABEL3   PRINT     *1,WFLINE1,*TABPOS2,WLINE1,*TABPOS3,WLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2:
                    *TABPOS3,WLINE2,*TABPOS3,WLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3,*N:
                    *TABPOS2,WLINE4,*TABPOS3,WLINE4,*N:
                    *1,WFLINE1,*TABPOS2,WLINE5,*TABPOS3,WLINE5,*N:
                    *1,WFLINE2,*TABPOS2,WLINE6,*TABPOS3,WLINE6,*N:
                    *1,WFLINE3,*TABPOS2,WLINE7,*TABPOS3,WLINE7,*N:
                    *TABPOS2,WLINE8,*TABPOS3,WLINE8,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
FMLABEL   BRANCH    LABCOS,MLABEL1,MLABEL2,MLABEL3
.
.        First line of labels : 1 label across page
.
MLABEL1   PRINT     *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N,*N:
                    *N,*1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 2 labels across page
.
MLABEL2   PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*N:
                    *N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 3 labels across page
.
MLABEL3   PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,WLINE1:
                    *TABPOS3,WLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2:
                    *TABPOS3,WLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WLINE3,*N:
                    *TABPOS3,WLINE4,*N:
                    *TABPOS3,WLINE5,*N
           SUB      ONE,NOLABEL
           GOTO     PATPRLB1
.
PMWBLABL  BRANCH    LABCOS,PLABEL1,PLABEL2,PLABEL3    
.
.        First line of labels : 1 label across page
.
PLABEL1   PRINT     *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N:
                    *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 2 labels across page
.
PLABEL2   PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*N:
                    *N,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 3 labels across page
.
PLABEL3   UNPACK    WLINE1,KEY20,KEY13
          UNPACK    WLINE8,KEY15,KEY18
          PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,KEY20,KEY13:
                    *TABPOS3,SP20,KEY13,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2:
                    *TABPOS3,WLINE2,*TABPOS3,WLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WLINE3,*N:
                    *TABPOS3,WLINE4,*N:
                    *TABPOS3,WLINE5,*N:
                    *TABPOS3,WLINE6,*N:
                    *TABPOS3,WLINE7,*N:
                    *TABPOS3,KEY15,KEY18,*TABPOS3,SP10,SP5,KEY18,*N
           SUB      ONE,NOLABEL
           GOTO     PATPRLB1
.
. ----- Mersey Labels -----
.
MERBLABL  BRANCH    LABCOS,ELABEL1,ELABEL2,ELABEL3    
.
.        First line of labels : 1 label across page
.
ELABEL1   PRINT     *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N:
                    *1,WFLINE1,*N:
                    *1,WFLINE2,*N,*1,WFLINE3,*N,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 2 labels across page
.
ELABEL2   PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*N:
                    *N,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 3 labels across page
.
ELABEL3   UNPACK    WLINE1,KEY20,KEY13
          UNPACK    WLINE8,KEY15,KEY18
          PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,KEY20,KEY13:
                    *TABPOS3,SP20,KEY13,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2:
                    *TABPOS3,WLINE2,*TABPOS3,WLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WLINE3,*N:
                    *TABPOS3,WLINE4,*N:
                    *TABPOS3,WLINE5,*N:
                    *TABPOS3,WLINE6,*N:
                    *TABPOS3,WLINE7,*N:
                    *TABPOS3,KEY15,KEY18,*TABPOS3,SP10,SP5,KEY18,*N
           SUB      ONE,NOLABEL
           GOTO     PATPRLB1
.
.
.-----  Anne Caudle Wrist band label -----
.
ACWBLABL  BRANCH    LABCOS,ACWBLAB1,ACWBLAB2,ACWBLAB3
.
.        First line of labels : 1 label across page
.
ACWBLAB1  PRINT     *1,WFLINE9,*N:
                    *1,WFLINE10,*N,*N,*N,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 2 labels across page
.
ACWBLAB2  PRINT     *1,WFLINE9,*TABPOS2,WFLINE9,*N:
                    *1,WFLINE10,*TABPOS2,WFLINE10,*N:
                    *N,*N,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 3 labels across page
.
ACWBLAB3  PRINT     *1,WFLINE9,*TABPOS2,WFLINE9,*TABPOS3,WFLINE9:
                    *N:
                    *1,WFLINE10,*TABPOS2,WFLINE10:
                    *TABPOS3,WFLINE10,*N,*N,*N,*N,*N,*N,*N
           GOTO     PATPRLB1
.
.-----  West Gippsland Wrist band label -----
.
WGWBLABL  BRANCH    LABCOS,WGWBLAB1,WGWBLAB2,WGWBLAB3
.
.        First line of labels : 1 label across page
.
WGWBLAB1  PRINT     CPI17,BOLD$ON,*1,"-------------------------------------":
                    *N,*1,"! ",WGLINE1," !": 
                    *N,*1,"! ",WGLINE2," !": 
                    *N,*1,"! ",WGLINE3," !":
                    *N,*1,"-------------------------------------":
                    CPI10,BOLD$OFF,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 2 label across page
.
WGWBLAB2  PRINT     CPI17,BOLD$ON,*1,"-------------------------------------":
                    CPI10,*C,*TABPOS2,CPI17,"---------------------------------":
                          "----":
                    *N,*1,"! ",WGLINE1," !",CPI10,*C,*TABPOS2,CPI17,"! ":
                          WGLINE1," !": 
                    *N,*1,"! ",WGLINE2," !",CPI10,*C,*TABPOS2,CPI17,"! ":
                          WGLINE2," !": 
                    *N,*1,"! ",WGLINE3," !",CPI10,*C,*TABPOS2,CPI17,"! ":
                          WGLINE3," !":
                    *N,*1,"-------------------------------------",CPI10:
                       *C,*TABPOS2,CPI17,"-----------------------------------":
                       "--":
                    CPI10,BOLD$OFF,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.        First line of labels : 3 label across page
.
WGWBLAB3  PRINT     CPI17,BOLD$ON,*1,"-------------------------------------":
                    CPI10,*C,*TABPOS2,CPI17,"--------------------------------":
                          "-----",CPI10,*C,*TABPOS3,CPI17,"------------------":
                          "---------------":
                    *N,*1,"! ",WGLINE1," !",CPI10,*C,*TABPOS2,CPI17,"! ":
                          WGLINE1," !",CPI10,*C,*TABPOS3,CPI17,"! ",WGLINE1:
                          " !": 
                    *N,*1,"! ",WGLINE2," !",CPI10,*C,*TABPOS2,CPI17,"! ":
                          WGLINE2," !",CPI10,*C,*TABPOS3,CPI17,"! ",WGLINE2:
                          " !": 
                    *N,*1,"! ",WGLINE3," !",CPI10,*C,*TABPOS2,CPI17,"! ":
                          WGLINE3," !",CPI10,*C,*TABPOS3,CPI17,"! ",WGLINE3:
                          "! ":
                    *N,*1,"-------------------------------------",CPI10:
                          *C,*TABPOS2,CPI17,"-------------------------------":
                          "------",CPI10,*C,*TABPOS3,CPI17,"----------------":
                          "---------------------",CPI10,BOLD$OFF,*N,*N,*N,*N
          GOTO      PATPRLB1
.
.          Loop over the number of labels still to print
.
PATPRLB1  COMPARE   ZERO,NOLABEL
          GOTO      ENDLABS IF EQUAL
.         GOTO      ENDLABS IF LESS
          COMPARE   NOLABEL,LABCOS
          GOTO      CONT IF LESS
          MOVE      NOLABEL,LABCOS
.
CONT      BRANCH    CTYPLAB,PRLAB1,PRLAB2,PRLAB2,PRLAB2,PRLAB3:
                            PRLAB4,PRLAB7,PRLAB8,PRLAB9,PRLAB10:
                            PRLAB11,PRLAB1,PRLAB13,PRLAB0,PRLAB15:
                            PRLAB16,PRLAB17,PRLAB18,PRLAB2,PRLAB20:
                            PRLAB21,PRLAB22,PRLAB23,PRLAB24,PRLAB25:
                            PRLAB26,PRLAB27
.
PRLAB0    BRANCH    LABCOS,LABEL1,LABEL2,LABEL3
          RETURN
.
PRLAB1    BRANCH    LABCOS,LLABEL1,LLABEL2,LLABEL3
          RETURN
.
PRLAB2    BRANCH    LABCOS,MLAB10,MLAB20,MLAB30
          RETURN
.
PRLAB3    BRANCH    LABCOS,BLAB10,BLAB20,BLAB30
          RETURN
.
. ------- Wellington Format -------
.
PRLAB4    BRANCH    LABCOS,NZLABEL1,NZLABEL2,NZLABEL3
          RETURN
.
. ------- Southland/New Zealand Format -------
.
PRLAB7    BRANCH    LABCOS,SLLABEL1,SLLABEL2,SLLABEL3
          RETURN
.
PRLAB8    BRANCH    LABCOS,BELABEL1,BELABEL2,BELABEL3
          RETURN
.
PRLAB9    BRANCH    LABCOS,ACLABEL1,ACLABEL2,ACLABEL3
          RETURN
.
PRLAB10   BRANCH    LABCOS,HKLABEL1,HKLABEL2,HKLABEL3
          RETURN
.
.------ West Gippsland format ------
.
PRLAB11   BRANCH    LABCOS,WGLABEL1,WGLABEL2,WGLABEL3
          RETURN
.
.------ Dudley format ------
.
PRLAB13   BRANCH    LABCOS,DULABEL1,DULABEL2,DULABEL3
          RETURN
.
.------ Hawkes Bay format ------
.
PRLAB15   BRANCH    LABCOS,HBLABEL1,HBLABEL2,HBLABEL3
          RETURN
.
.------ Mt Alvernia format -----
.
PRLAB16   BRANCH    LABCOS,MALABEL1,MALABEL2,MALABEL3
          RETURN
.
.------ Taranaki format ------
.
PRLAB17   BRANCH    LABCOS,TALABEL1,TALABEL2,TALABEL3
          RETURN
.
.------ Port Macquarie format ------
.
PRLAB18   UNPACK    WLINE1,KEY20,KEY13
          UNPACK    WLINE7,KEY24,KEY9                   * Portion of line bold
          BRANCH    LABCOS,PMLABEL1,PMLABEL2,PMLABEL3 
          RETURN
.
. ----- St. Lukes Format -----
.
PRLAB20   BRANCH    LABCOS,LLABEL1,LLABEL2
          RETURN
.
. ----- Coast Health Care Format ------
.
PRLAB21   BRANCH    LABCOS,COLABEL1,COLABEL2,COLABEL3
          RETURN
.
. ----- St. Lukes Format -----
.
PRLAB22   BRANCH    LABCOS,LLABEL1,LLABEL2,LLABEL3
          RETURN
.
.------ Mersey Format ------
.
PRLAB23   UNPACK    WLINE1,KEY20,KEY13
          UNPACK    WLINE7,KEY24,KEY9       * Portion of line bold
          BRANCH    LABCOS,MELABEL1,MELABEL2,MELABEL3 
          RETURN
.
.------ Mercy Dunedin Format ----
.
PRLAB24   BRANCH    LABCOS,MDLABEL1,MDLABEL2
          RETURN
.
.------ St Vincent's Format ----
.
PRLAB25   GOTO      STVLABEL 
.
.------ Royal Children's ----
.
PRLAB26   GOTO      ROYAL000 
.
.------ SJOG Geelong ----
.
PRLAB27   GOTO      SJOGIP00
+
LABEL1    PRINT     *1,WLINE1,*N:
                    *1,WLINE2,*1,WLINE2,*N:
                    *1,WLINE3,*N:
                    *1,WLINE4,*N:
                    *1,WLINE5,*N:
                    *1,WLINE6,*N:
                    *1,WLINE7,*N:
                    *1,WLINE8,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
LABEL2    PRINT     *1,WLINE1,*TABPOS2,WLINE1,*N:
                    *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2,*N:
                    *1,WLINE3,*TABPOS2,WLINE3,*N:
                    *1,WLINE4,*TABPOS2,WLINE4,*N:
                    *1,WLINE5,*TABPOS2,WLINE5,*N:
                    *1,WLINE6,*TABPOS2,WLINE6,*N:
                    *1,WLINE7,*TABPOS2,WLINE7,*N:
                    *1,WLINE8,*TABPOS2,WLINE8,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
LABEL3    PRINT     *1,WLINE1,*TABPOS2,WLINE1,*TABPOS3,WLINE1,*N:
                    *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2:
                              *TABPOS3,WLINE2,*TABPOS3,WLINE2,*N:
                    *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3,*N:
                    *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4,*N:
                    *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5,*N:
                    *1,WLINE6,*TABPOS2,WLINE6,*TABPOS3,WLINE6,*N:
                    *1,WLINE7,*TABPOS2,WLINE7,*TABPOS3,WLINE7,*N:
                    *1,WLINE8,*TABPOS2,WLINE8,*TABPOS3,WLINE8,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
LLABEL1   PRINT     *1,WLINE1A,*N:
                    *1,WLINE2A,*N:
                    *1,WLINE3A,*N:
                    *1,WLINE4A,*N:
                    *1,WLINE5A,*N:
                    *1,WLINE6A,*N:
                    *1,WLINE7A,*N:
                    *1,WLINE8A,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
LLABEL2   PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*N:
                    *1,WLINE6A,*TABPOS2,WLINE6A,*N:
                    *1,WLINE7A,*TABPOS2,WLINE7A,*N:
                    *1,WLINE8A,*TABPOS2,WLINE8A,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
LLABEL3   PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*TABPOS3,WLINE5A,*N:
                    *1,WLINE6A,*TABPOS2,WLINE6A,*TABPOS3,WLINE6A,*N:
                    *1,WLINE7A,*TABPOS2,WLINE7A,*TABPOS3,WLINE7A,*N:
                    *1,WLINE8A,*TABPOS2,WLINE8A,*TABPOS3,WLINE8A,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
MLAB10    PRINT     *1,WLINE1,*1,WLINE1,*N:
                    *1,WLINE2,*N:
                    *1,WLINE3,*N:
                    *1,WLINE4,*N:
                    *1,WLINE5,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
MLAB20    PRINT     *1,WLINE1,*1,WLINE1,*TABPOS2,WLINE1,*TABPOS2,WLINE1,*N:
                    *1,WLINE2,*TABPOS2,WLINE2,*N:
                    *1,WLINE3,*TABPOS2,WLINE3,*N:
                    *1,WLINE4,*TABPOS2,WLINE4,*N:
                    *1,WLINE5,*TABPOS2,WLINE5,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
MLAB30    PRINT     *1,WLINE1,*1,WLINE1,*TABPOS2,WLINE1,*TABPOS2,WLINE1:
                              *TABPOS3,WLINE1,*TABPOS3,WLINE1,*N:
                    *1,WLINE2,*TABPOS2,WLINE2,*TABPOS3,WLINE2,*N:
                    *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3,*N:
                    *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4,*N:
                    *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
BLAB10    PRINT     *1,WLINE1,*N:
                    *1,WLINE2,*N:
                    *1,WLINE3,*N:
                    *1,WLINE4,*N:
                    *1,WLINE5,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
BLAB20    PRINT     *1,WLINE1,*TABPOS2,WLINE1,*N:
                    *1,WLINE2,*TABPOS2,WLINE2,*N:
                    *1,WLINE3,*TABPOS2,WLINE3,*N:
                    *1,WLINE4,*TABPOS2,WLINE4,*N:
                    *1,WLINE5,*TABPOS2,WLINE5,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
BLAB30    PRINT     *1,WLINE1,*TABPOS2,WLINE1,*TABPOS3,WLINE1,*N:
                    *1,WLINE2,*TABPOS2,WLINE2,*TABPOS3,WLINE2,*N:
                    *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3,*N:
                    *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4,*N:
                    *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
NZLABEL   BRANCH    LABCOS,NZLABEL1,NZLABEL2,NZLABEL3
.
NZLABEL1  PRINT     *1,WLINE1A,*N:
                    *1,WLINE2A,*N:
                    *1,WLINE3A,*N:
                    *1,WLINE4A,*N:
                    *1,WLINE5A,*N 
.
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
NZLABEL2  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*N 
.
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
NZLABEL3  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*TABPOS3,WLINE5A,*N 
.
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*******************************************************************************
.*        Southland/New Zealand Format                                         *
.*******************************************************************************
.
SLLABEL1  PRINT     *1,WLINE1,*N:                           * 1 across page
                    *1,WLINE2,*N:
                    *1,WLINE3,*N,*N:
                    *1,WLINE4,*N:
                    *1,WLINE5,*C,*F;
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
SLLABEL2  PRINT     *1,WLINE1,*35,WLINE1,*N:                * 2 across page
                    *1,WLINE2,*35,WLINE2,*N:
                    *1,WLINE3,*35,WLINE3,*N,*N:
                    *1,WLINE4,*35,WLINE4,*N:
                    *1,WLINE5,*35,WLINE5,*C,*F;
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
SLLABEL3  PRINT     *1,WLINE1,*35,WLINE1,*69,WLINE1,*N:     * 3 across page
                    *1,WLINE2,*35,WLINE2,*69,WLINE2,*N:
                    *1,WLINE3,*35,WLINE3,*69,WLINE3,*N,*N:
                    *1,WLINE4,*35,WLINE4,*69,WLINE4,*N:
                    *1,WLINE5,*35,WLINE5,*69,WLINE5,*C,*F;
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.
.***********************************************************************
.*        Bundoora Extended care format                               *
.***********************************************************************
.
BELABEL1  PRINT     *N:
                    *1,WFLINE1,*N:                           * 1 across page
                    *1,WFLINE2,*N:
                    *1,WFLINE3,*N:
                    *1,WFLINE4,*N:
                    *1,WFLINE5,*N:
                    *1,WFLINE6,*N:
                    *1,WFLINE7,*N:
                    *1,WFLINE8,*C,*N;
                
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
BELABEL2  PRINT     *N:
                    *1,WFLINE1,*TABPOS2,WFLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*N:
                    *1,WFLINE4,*TABPOS2,WFLINE4,*N:
                    *1,WFLINE5,*TABPOS2,WFLINE5,*N:
                    *1,WFLINE6,*TABPOS2,WFLINE6,*N:
                    *1,WFLINE7,*TABPOS2,WFLINE7,*N:
                    *1,WFLINE8,*TABPOS2,WFLINE8,*C,*N;
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
BELABEL3  PRINT     *N:
                    *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,WFLINE1,*N:
                    *1,WFLINE2,*TABPOS2,WFLINE2,*TABPOS3,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WFLINE3,*N:
                    *1,WFLINE4,*TABPOS2,WFLINE4,*TABPOS3,WFLINE4,*N:
                    *1,WFLINE5,*TABPOS2,WFLINE5,*TABPOS3,WFLINE5,*N:
                    *1,WFLINE6,*TABPOS2,WFLINE6,*TABPOS3,WFLINE6,*N:
                    *1,WFLINE7,*TABPOS2,WFLINE7,*TABPOS3,WFLINE7,*N:
                    *1,WFLINE8,*TABPOS2,WFLINE8,*TABPOS3,WFLINE8,*C,*N;
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.***********************************************************************
.*        ANNE CAUDLE CENTRE care format                               *
.***********************************************************************
.
ACLABEL1  PRINT     *1,WFLINE1,*1,WFLINE1,*N:            * 1 across page
                    *1,WLINE2A,*1,WFLINE2,*N:
                    *1,WFLINE3,*N:
                    *1,WFLINE4,*N:
                    *1,WFLINE5,*N:
                    *1,WFLINE6,*N:
                    *1,WFLINE7,*N:
                    *1,WFLINE8,*C,*N,*N;
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
ACLABEL2  PRINT     *1,WFLINE1,*1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS2,WFLINE1,*N:
                    *1,WLINE2A,*1,WFLINE2,*TABPOS2,WLINE2A,*TABPOS2,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*N:
                    *1,WFLINE4,*TABPOS2,WFLINE4,*N:
                    *1,WFLINE5,*TABPOS2,WFLINE5,*N:
                    *1,WFLINE6,*TABPOS2,WFLINE6,*N:
                    *1,WFLINE7,*TABPOS2,WFLINE7,*N:
                    *1,WFLINE8,*TABPOS2,WFLINE8,*C,*N,*N;
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
ACLABEL3  PRINT     *1,WFLINE1,*1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS2,WFLINE1:
                    *TABPOS3,WFLINE1,*TABPOS3,WFLINE1,*N:
                    *1,WLINE2A,*1,WFLINE2,*TABPOS2,WLINE2A,*TABPOS2,WFLINE2:
                    *TABPOS3,WLINE2A,*TABPOS3,WFLINE2,*N:
                    *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WFLINE3,*N:
                    *1,WFLINE4,*TABPOS2,WFLINE4,*TABPOS3,WFLINE4,*N:
                    *1,WFLINE5,*TABPOS2,WFLINE5,*TABPOS3,WFLINE5,*N:
                    *1,WFLINE6,*TABPOS2,WFLINE6,*TABPOS3,WFLINE6,*N:
                    *1,WFLINE7,*TABPOS2,WFLINE7,*TABPOS3,WFLINE7,*N:
                    *1,WFLINE8,*TABPOS2,WFLINE8,*TABPOS3,WFLINE8,*C,*N,*N;
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
.         Hong Kong Labels
.*********************************************************************
HKLABEL1  PRINT     *1,*+,WLINE1
          PRINT     *1,*+,WLINE2
          PRINT     *1,*+,WLINE3
          PRINT     *1,*+,WLINE4
          PRINT     *1,*+,WLINE5
          PRINT     *N;
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
HKLABEL2  PRINT     *1,*+,WLINE1,*27,*+,WLINE1
          PRINT     *1,*+,WLINE2,*27,*+,WLINE2
          PRINT     *1,*+,WLINE3,*27,*+,WLINE3
          PRINT     *1,*+,WLINE4,*27,*+,WLINE4
          PRINT     *1,*+,WLINE5,*27,*+,WLINE5
          PRINT     *N;
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
HKLABEL3  PRINT     *1,*+,WLINE1,*27,*+,WLINE1,*53,*+,WLINE1
          PRINT     *1,*+,WLINE2,*27,*+,WLINE2,*53,*+,WLINE2
          PRINT     *1,*+,WLINE3,*27,*+,WLINE3,*53,*+,WLINE3
          PRINT     *1,*+,WLINE4,*27,*+,WLINE4,*53,*+,WLINE4
          PRINT     *1,*+,WLINE5,*27,*+,WLINE5,*53,*+,WLINE5
          PRINT     *N;
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
.         West Gippsland Labels
.*********************************************************************
WGLABEL1  PRINT     *1,BOLD$ON,BOLDSURN,BOLD$OFF," UR:",BOLD$ON,BOLDUR:
                    *N,*1,BOLD$OFF,WLINE2A:
                    *N,*1,ADMLINE,SP2,BOLD$ON,AWARD,BOLD$OFF,SP1,ADOC13:
                    *N,*1,ADD121,SP1,BOLD$ON,PSEX,BOLD$OFF,SP1,PMSTAT,SP1:
                       RELDESC:
                    *N,*1,LN5DIM30,SP1,BOLD$ON,PSAGE,BOLD$OFF:
                    *N,*1,WLINE6A,*N,*N,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
WGLABEL2  PRINT     *1,BOLD$ON,BOLDSURN,BOLD$OFF," UR:",BOLD$ON,BOLDUR:
                    *C,*TABPOS2,BOLDSURN,BOLD$OFF," UR:",BOLD$ON,BOLDUR:
                    *N,*1,BOLD$OFF,WLINE2A,*C,*TABPOS2,WLINE2A:
                    *N,*1,ADMLINE,SP2,BOLD$ON,AWARD,BOLD$OFF,SP1,ADOC13:
                    *C,*TABPOS2,ADMLINE,SP2,BOLD$ON,AWARD,BOLD$OFF,SP1,ADOC13:
                    *N,*1,ADD121,SP1,BOLD$ON,PSEX,BOLD$OFF,SP1,PMSTAT,SP1:
                       RELDESC:
                    *C,*TABPOS2,ADD121,SP1,BOLD$ON,PSEX,BOLD$OFF,SP1,PMSTAT:
                       SP1,RELDESC:
                    *N,*1,LN5DIM30,SP1,BOLD$ON,PSAGE,BOLD$OFF:
                    *C,*TABPOS2,LN5DIM30,SP1,BOLD$ON,PSAGE,BOLD$OFF:
                    *N,*1,WLINE6A,*C,*TABPOS2,WLINE6A,*N,*N,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
WGLABEL3  PRINT     *1,BOLD$ON,BOLDSURN,BOLD$OFF," UR:",BOLD$ON,BOLDUR:
                    *C,*TABPOS2,BOLDSURN,BOLD$OFF," UR:",BOLD$ON,BOLDUR:
                    *C,*TABPOS3,BOLDSURN,BOLD$OFF," UR:",BOLD$ON,BOLDUR:
                    *N,*1,BOLD$OFF,WLINE2A,*C,*TABPOS2,WLINE2A,*C,*TABPOS3:
                       WLINE2A:
                    *N,*1,ADMLINE,SP2,BOLD$ON,AWARD,BOLD$OFF,SP1,ADOC13:
                    *C,*TABPOS2,ADMLINE,SP2,BOLD$ON,AWARD,BOLD$OFF,SP1,ADOC13:
                    *C,*TABPOS3,ADMLINE,SP2,BOLD$ON,AWARD,BOLD$OFF,SP1,ADOC13:
                    *N,*1,ADD121,SP1,BOLD$ON,PSEX,BOLD$OFF,SP1,PMSTAT,SP1:
                       RELDESC:
                    *C,*TABPOS2,ADD121,SP1,BOLD$ON,PSEX,BOLD$OFF,SP1,PMSTAT,SP1:
                       RELDESC:
                    *C,*TABPOS3,ADD121,SP1,BOLD$ON,PSEX,BOLD$OFF,SP1,PMSTAT,SP1:
                       RELDESC:
                    *N,*1,LN5DIM30,SP1,BOLD$ON,PSAGE,BOLD$OFF:
                    *C,*TABPOS2,LN5DIM30,SP1,BOLD$ON,PSAGE,BOLD$OFF:
                    *C,*TABPOS3,LN5DIM30,SP1,BOLD$ON,PSAGE,BOLD$OFF:
                    *N,*1,WLINE6A,*C,*TABPOS2,WLINE6A,*C,*TABPOS3,WLINE6A:
                    *N,*N,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
.         Dudley Labels
.*********************************************************************
.
DULABEL1  PRINT     *1,WLINE1A,*TABPOS4,WLINE1,*N:
                    *1,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS4,WLINE2,*N:
                    *1,WLINE4A,*N:
                    *1,WLINE5A,*N:
                    *1,WLINE6A,*N:
                    *1,WLINE7A,*N:
                    *1,WLINE8A,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
DULABEL2  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS4,WLINE1,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS4,WLINE2,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*N:
                    *1,WLINE6A,*TABPOS2,WLINE6A,*N:
                    *1,WLINE7A,*TABPOS2,WLINE7A,*N:
                    *1,WLINE8A,*TABPOS2,WLINE8A,*N
.
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
DULABEL3  PRINT     *1,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A:
                    *TABPOS4,WLINE1,*N:
                    *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A,*N:
                    *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A:
                    *TABPOS4,WLINE2,*N:
                    *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A,*N:
                    *1,WLINE5A,*TABPOS2,WLINE5A,*TABPOS3,WLINE5A,*N:
                    *1,WLINE6A,*TABPOS2,WLINE6A,*TABPOS3,WLINE6A,*N:
                    *1,WLINE7A,*TABPOS2,WLINE7A,*TABPOS3,WLINE7A,*N:
                    *1,WLINE8A,*TABPOS2,WLINE8A,*TABPOS3,WLINE8A,*N
.
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
.         Hawkes Bay Labels
.*********************************************************************
.
HBLABEL1  PRINT     *1,WLINE1
          PRINT     *1,WLINE2
          PRINT     *1,WLINE3
          PRINT     *1,WLINE4
          PRINT     *1,WLINE5,*N 
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
HBLABEL2  PRINT     *1,WLINE1,*TABPOS2,WLINE1
          PRINT     *1,WLINE2,*TABPOS2,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
HBLABEL3  PRINT     *1,WLINE1,*TABPOS2,WLINE1,*TABPOS3,WLINE1
          PRINT     *1,WLINE2,*TABPOS2,WLINE2,*TABPOS3,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
.         Mt Alvernia Lables 
.*********************************************************************
.
MALABEL1  PRINT     *1,*CPI12,WLINE1A
          PRINT     *1,WLINE2A
          PRINT     *1,WLINE3A
          PRINT     *1,WLINE4A
          PRINT     *1,WLINE5A,*N 
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
MALABEL2  PRINT     *1,*CPI12,WLINE1A,*TABPOS2,WLINE1A
          PRINT     *1,WLINE2A,*TABPOS2,WLINE2A
          PRINT     *1,WLINE3A,*TABPOS2,WLINE3A
          PRINT     *1,WLINE4A,*TABPOS2,WLINE4A
          PRINT     *1,WLINE5A,*TABPOS2,WLINE5A,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
MALABEL3  PRINT     *1,*CPI12,WLINE1A,*TABPOS2,WLINE1A,*TABPOS3,WLINE1A
          PRINT     *1,WLINE2A,*TABPOS2,WLINE2A,*TABPOS3,WLINE2A
          PRINT     *1,WLINE3A,*TABPOS2,WLINE3A,*TABPOS3,WLINE3A
          PRINT     *1,WLINE4A,*TABPOS2,WLINE4A,*TABPOS3,WLINE4A
          PRINT     *1,WLINE5A,*TABPOS2,WLINE5A,*TABPOS3,WLINE5A,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
. Taranaki Labels
.*********************************************************************
TALABEL1  PRINT     *1,WFLINE1
          PRINT     *1,WFLINE2
          PRINT     *1,WFLINE3
          PRINT     *1,WFLINE4
          PRINT     *1,WFLINE5,*N 
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
TALABEL2  PRINT     *1,WFLINE1,*TABPOS2,WFLINE1
          PRINT     *1,WFLINE2,*TABPOS2,WFLINE2
          PRINT     *1,WFLINE3,*TABPOS2,WFLINE3
          PRINT     *1,WFLINE4,*TABPOS2,WFLINE4
          PRINT     *1,WFLINE5,*TABPOS2,WFLINE5,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
TALABEL3  PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,WFLINE1
          PRINT     *1,WFLINE2,*TABPOS2,WFLINE2,*TABPOS3,WFLINE2
          PRINT     *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WFLINE3
          PRINT     *1,WFLINE4,*TABPOS2,WFLINE4,*TABPOS3,WFLINE4
          PRINT     *1,WFLINE5,*TABPOS2,WFLINE5,*TABPOS3,WFLINE5,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
.
.*********************************************************************
. Port Macquarie Labels
.*********************************************************************
PMLABEL1  PRINT     *1,KEY20,KEY13,*1,SP20,KEY13
          PRINT     *1,WLINE2,*1,WLINE2
          PRINT     *1,WLINE3
          PRINT     *1,WLINE4
          PRINT     *1,WLINE5
          PRINT     *1,WLINE6
          PRINT     *1,KEY24,KEY9,*1,KEY24
          PRINT     *1,WLINE8,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
PMLABEL2  PRINT     *1,KEY20,KEY13,*1,SP20,KEY13,*TABPOS2,KEY20,KEY13:
                    *TABPOS2,SP20,KEY13
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6
          PRINT     *1,KEY24,KEY9,*1,KEY24,*TABPOS2,KEY24,KEY9:
                    *TABPOS2,KEY24
          PRINT     *1,WLINE8,*TABPOS2,WLINE8,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
PMLABEL3  PRINT     *1,KEY20,KEY13,*1,SP20,KEY13,*TABPOS2,KEY20,KEY13:
                    *TABPOS2,SP20,KEY13,*TABPOS3,KEY20,KEY13:
                    *TABPOS3,SP20,KEY13
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2:
                    *TABPOS3,WLINE2,*TABPOS3,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6,*TABPOS3,WLINE6
          PRINT     *1,KEY24,KEY9,*1,KEY24,*TABPOS2,KEY24,KEY9:
                    *TABPOS2,KEY24,*TABPOS3,KEY24,KEY9:
                    *TABPOS3,KEY24
          PRINT     *1,WLINE8,*TABPOS2,WLINE8,*TABPOS3,WLINE8,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
+
.******************************************************************************
.*                                 COLABEL?                                   *
.*                      Print Coast Health Care Labels                        *
.******************************************************************************
COLABEL1  PRINT     *1,WFLINE1
          PRINT     *1,WFLINE2
          PRINT     *1,WFLINE3
          PRINT     *1,WFLINE4
          PRINT     *1,WFLINE5,*N 
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
COLABEL2  PRINT     *1,WFLINE1,*TABPOS2,WFLINE1
          PRINT     *1,WFLINE2,*TABPOS2,WFLINE2
          PRINT     *1,WFLINE3,*TABPOS2,WFLINE3
          PRINT     *1,WFLINE4,*TABPOS2,WFLINE4
          PRINT     *1,WFLINE5,*TABPOS2,WFLINE5,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
COLABEL3  PRINT     *1,WFLINE1,*TABPOS2,WFLINE1,*TABPOS3,WFLINE1
          PRINT     *1,WFLINE2,*TABPOS2,WFLINE2,*TABPOS3,WFLINE2
          PRINT     *1,WFLINE3,*TABPOS2,WFLINE3,*TABPOS3,WFLINE3
          PRINT     *1,WFLINE4,*TABPOS2,WFLINE4,*TABPOS3,WFLINE4
          PRINT     *1,WFLINE5,*TABPOS2,WFLINE5,*TABPOS3,WFLINE5,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
+
.******************************************************************************
.*                                 MELABEL?                                   *
.*                            Print Mersey Labels                             *
.******************************************************************************
MELABEL1  PRINT     *1,KEY20,KEY13,*1,SP20,KEY13
          PRINT     *1,WLINE2,*1,WLINE2
          PRINT     *1,WLINE3
          PRINT     *1,WLINE4
          PRINT     *1,WLINE5
          PRINT     *1,WLINE6
          PRINT     *1,KEY24,KEY9,*1,KEY24
          PRINT     *1,WLINE8,*N
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
MELABEL2  PRINT     *1,KEY20,KEY13,*1,SP20,KEY13,*TABPOS2,KEY20,KEY13:
                    *TABPOS2,SP20,KEY13
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6
          PRINT     *1,KEY24,KEY9,*1,KEY24,*TABPOS2,KEY24,KEY9:
                    *TABPOS2,KEY24
          PRINT     *1,WLINE8,*TABPOS2,WLINE8,*N
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
.
MELABEL3  PRINT     *1,KEY20,KEY13,*1,SP20,KEY13,*TABPOS2,KEY20,KEY13:
                    *TABPOS2,SP20,KEY13,*TABPOS3,KEY20,KEY13:
                    *TABPOS3,SP20,KEY13
          PRINT     *1,WLINE2,*1,WLINE2,*TABPOS2,WLINE2,*TABPOS2,WLINE2:
                    *TABPOS3,WLINE2,*TABPOS3,WLINE2
          PRINT     *1,WLINE3,*TABPOS2,WLINE3,*TABPOS3,WLINE3
          PRINT     *1,WLINE4,*TABPOS2,WLINE4,*TABPOS3,WLINE4
          PRINT     *1,WLINE5,*TABPOS2,WLINE5,*TABPOS3,WLINE5
          PRINT     *1,WLINE6,*TABPOS2,WLINE6,*TABPOS3,WLINE6
          PRINT     *1,KEY24,KEY9,*1,KEY24,*TABPOS2,KEY24,KEY9:
                    *TABPOS2,KEY24,*TABPOS3,KEY24,KEY9:
                    *TABPOS3,KEY24
          PRINT     *1,WLINE8,*TABPOS2,WLINE8,*TABPOS3,WLINE8,*N
          SUB       THREE,NOLABEL
          GOTO      PATPRLB1
+
.****************************************************************************
.*        Mercy Dunedin Labels                                              *
.****************************************************************************
.
MDLABEL1  PRINT     *1,*CPI12,BOLD$ON,WLINE1A,BOLD$OFF,*N:
                    *1,WLINE2A,*N:
                    *1,WLINE3A,*N:
                    *1,WLINE4A,*N:
                    *1,WLINE5A,*N,*CPI10
          SUB       ONE,NOLABEL
          GOTO      PATPRLB1
.
MDLABEL2  PRINT     *1,*CPI12,BOLD$ON,WLINE1A,BOLD$OFF,*C,*44:
                    BOLD$ON,WLINE1A,BOLD$OFF,*N:
                    *1,WLINE2A,*44,WLINE2A,*N:
                    *1,WLINE3A,*44,WLINE3A,*N:
                    *1,WLINE4A,*44,WLINE4A,*N:
                    *1,WLINE5A,*44,WLINE5A,*N,*CPI10
          SUB       TWO,NOLABEL
          GOTO      PATPRLB1
+
.****************************************************************************
.*        St Vincent Hospital Labels                                        *
.****************************************************************************
.
STVLABEL  BRANCH    ZEBRAFLG,STVLAB01:           * I/P Labels
                             STVLAB02:           * Nutrition Labels
                             STVLAB03:           * Address Labels
                             STVLAB01            * PMI Labels
          GOTO      STVLAB99
.
.         I/P Label
.
STVLAB01  MATCH     "LABELINP",IBLPLAPR          * I/P PMI label ?
          IF        @EQUAL
......      MATCH     "33",IBLPLASC              * yes - Final Adm. label ?
......      GOTO      STVLABA1 IF EQUAL          * yes - print I/P Zebra label
.
            MATCH     "01",IBLPLASC              * yes - I/P label ?
            GOTO      STVLABA1 IF EQUAL          * yes - print I/P Zebra label
.
            MATCH     "02",IBLPLASC              * no - GP label ?
            GOTO      STVLAB05 IF EQUAL          * yes - print GP Zebra label
          ENDIF
.
          MATCH     "LABELPMI",IBLPLAPR          * PMI label ?
          IF        @EQUAL
            MATCH     "01",IBLPLASC              * yes - using main PMI label ?
            GOTO      STVLABA1 IF EQUAL          * yes - print Zebra label
.
            MATCH     "03",IBLPLASC              * no - screen "03" ? (817740)
            GOTO      STVLAB05 IF EQUAL          * yes - print GP Zebra label
.
            MATCH     "02",IBLPLASC              * no - using wrist band label ?
            GOTO      STVLAB04 IF NOT EQUAL      * no - print alternate label
          ENDIF
.
.         Print Wrist Band Zebra label
.
          MOVE      WLINEZ2,KEY8
          MOVE      WLINEZ16,D8     
          PRINT     *1,ZXA:
                    *N,"^FT128,2675^A0,22,20",ZFD,KEY8,ZFS:        * int. line
                    *N,"^FT035,2652^BY2,2^B3N,N,120,N",ZFD,D8,ZFS: *b'code
                    *N,"^FT112,2500^A0B,55,70",ZFD,WLINEZ20,ZFS:   * surname
                    *N,"^FT182,2500^A0B,55,70",ZFD,WLINEZ21,ZFS:   * title/gname
                    *N,"^FT252,2500^A0B,55,70",ZFD,WLINEZ15,ZFS:   * ur/dob
                    *N,"^PQ",ZCOPY:
                    *N,ZXZ
          GOTO      STVLAB99
.
.         Print PMI Zebra label
.
STVLABA1  PRINT     *1,ZXA:
                    *N,ZBARCOD,WLINEZ16:
                    *N,"^FO170,007^A0,30,25",ZFD,WLINEZ1,ZFS:
..                    *N,"^FO155,007^A0,24,26",ZFD,WLINEZ1,ZFS:
                    *N,"^FO001,037^A0,25,25",ZFD,WLINEZ2,ZFS:
                    *N,"^FO236,062^A0,18,18",ZFD,WLINEZ5,ZFS:
                    *N,"^FO242,060^A0,20,18",ZFD,WLINEZ7,ZFS:
                    *N,"^FO001,060^A0,25,25",ZFD,WLINEZ3,ZFS:
                    *N,"^FO220,042^A0,18,18",ZFD,WLINEZ4,ZFS:
                    *N,"^FO001,096^A0,18,18",ZFD,WLINEZ8,ZFS:
                    *N,"^FO210,096^A0,18,18",ZFD,WLINEZ14,ZFS:
                    *N,"^FO001,112^A0,18,18",ZFD,WLINEZ17,ZFS:
                    *N,"^FO001,128^A0,18,18",ZFD,WLINEZ9,ZFS:
                    *N,"^FO180,145^A0,20,18",ZFD,WLINEZ13,ZFS:
                    *N,"^FO001,150^A0,15,18",ZFD,WLINEZ11,ZFS:
                    *N,"^FO162,078^A0,20,18",ZFD,WLINEZ6,ZFS:
                    *N,"^PQ",ZCOPY:
                    *N,ZXZ
          GOTO      STVLAB99
.
.         Nutrition Label
.
STVLAB02  PRINT     *1,ZXA:
                    *N,"^FO001,037^A0,20,20",ZFD,WLINEZ1,ZFS:
                    *N,"^FO001,062^A0,20,20",ZFD,WLINEZ2,ZFS: 
                    *N,"^FO001,087^A0,20,20",ZFD,WLINEZ3,ZFS: 
                    *N,"^FO001,112^A0,20,20",ZFD,WLINEZ4,ZFS: 
                    *N,"^FO001,137^A0,20,20",ZFD,WLINEZ5,ZFS: 
                    *N,"^PQ",ZCOPY:
                    *N,ZXZ
          GOTO      STVLAB99
.
.         Address Label
.
STVLAB03  PRINT     *1,ZXA:
                    *N,"^FO170,007^A0,30,25",ZFD,WLINEZ6,ZFS:
..                    *N,"^FO155,007^A0,24,26",ZFD,WLINEZ6,ZFS:
                    *N,"^FO001,037^A0,20,20",ZFD,WLINEZ1,ZFS:
                    *N,"^FO001,062^A0,20,20",ZFD,WLINEZ2,ZFS: 
                    *N,"^FO001,087^A0,20,20",ZFD,WLINEZ3,ZFS: 
                    *N,"^FO001,112^A0,20,20",ZFD,WLINEZ4,ZFS: 
                    *N,"^FO001,137^A0,20,20",ZFD,WLINEZ5,ZFS: 
                    *N,"^PQ",ZCOPY:
                    *N,ZXZ
          GOTO      STVLAB99
.
.         PMI Label
.
STVLAB04  PRINT     *1,ZXA:
                    *N,ZBARCOD,WLINEZ16:
                    *N,"^FO170,007^A0N,30,25",ZFD,WLINEZ1,ZFS:
                    *N,"^FO001,040^A0N,40,25",ZFD,WLINEZ2,ZFS:
                    *N,"^FO001,075^A0N,40,25",ZFD,WLINEZ3,ZFS:
                    *N,"^FO001,125^A0N,40,25",ZFD,WLINEZ6,ZFS:
                    *N,"^PQ",ZCOPY:
                    *N,ZXZ
.
.         GP Label
.
STVLAB05  PRINT     *1,ZXA:
                    *N,"^FO001,037^A0,20,20",ZFD,WLINEZ15,ZFS:
                    *N,"^FO001,062^A0,20,20",ZFD,WLINEZ1,ZFS
.
          IF        PRTOPT1 = 0 & PRTOPT2 = 0
            PRINT     *1,"^FO001,087^A0,20,20",ZFD,WLINEZ3,ZFS:
                      *N,"^FO001,112^A0,20,20",ZFD,WLINEZ5,ZFS
          ENDIF
.
          IF        PRTOPT1 = 1 & PRTOPT2 = 0
            PRINT     *1,"^FO001,087^A0,20,20",ZFD,WLINEZ2,ZFS:
                      *N,"^FO001,112^A0,20,20",ZFD,WLINEZ3,ZFS:
                      *N,"^FO001,137^A0,20,20",ZFD,WLINEZ5,ZFS
          ENDIF
.
          IF        PRTOPT1 = 0 & PRTOPT2 = 1
            PRINT     *1,"^FO001,087^A0,20,20",ZFD,WLINEZ3,ZFS:
                      *N,"^FO001,112^A0,20,20",ZFD,WLINEZ4,ZFS:
                      *N,"^FO001,137^A0,20,20",ZFD,WLINEZ5,ZFS
          ENDIF
.
          IF        PRTOPT1 = 1 & PRTOPT2 = 1
            PRINT     *1,"^FO001,087^A0,20,20",ZFD,WLINEZ2,ZFS:
                      *N,"^FO001,112^A0,20,20",ZFD,WLINEZ3,ZFS:
                      *N,"^FO001,137^A0,20,20",ZFD,WLINEZ4,ZFS:
                      *N,"^FO001,162^A0,20,20",ZFD,WLINEZ5,ZFS
          ENDIF
.
.         If a fax number was found, then print this inside square brackets,
.         otherwise don't print anything.
.
          MATCH     SP70,WLINEZ20
          IF        !@EQUAL
            ASSIGN    (PRTOPT1+PRTOPT2),FORM1
            IF        FORM1 = 0
              PRINT     *1,"^FO050,137^A0,20,20",ZFD,WLINEZ20,ZFS
            ELSE
              IF        FORM1 = 1
                PRINT     *1,"^FO050,162^A0,20,20",ZFD,WLINEZ20,ZFS
              ELSE
                PRINT     *1,"^FO050,187^A0,20,20",ZFD,WLINEZ20,ZFS
              ENDIF
            ENDIF
          ENDIF
.
          PRINT     *1,"^PQ",ZCOPY:
                    *N,ZXZ
.
STVLAB99  MOVE      ZERO,NOCOPIES
          GOTO      ENDLABS 
+
.****************************************************************************
.*        Royal Children's Labels                                           *
.* NB: This routine prints 3 or more labels only, single and double labels  *
.*     are printed using routines in RCHLABEL.PBL                           *
.****************************************************************************
.
ROYAL000  MOVE      ONE,LINE   
          MOVE      THREE,COUNTER             * Start Counter
.
          PRINT     *1,RESET,MARGIN
          IF        VALUE >=3 
ROYAL100    IF        COUNTER <= VALUE 
              IF        LINE = 9
                PRINT     *1,RESET,MARGIN    
                MOVE      ONE,LINE
              ENDIF
.
              PRINT     *1,ESC,"&l6D":
                        *1,HPA10FNT,HPLINE1A,WLINEZ2:
                        *1,HPA10FNT,HPLINE1B,WLINEZ2:
                        *1,HPA10FNT,HPLINE1C,WLINEZ2:
                        *1,HPLINE4A,HPA14FNT,WRCHURNO,HPA10FNT,WRCHFLAG: 
                        *1,HPLINE4B,HPA14FNT,WRCHURNO,HPA10FNT,WRCHFLAG: 
                        *1,HPLINE4C,HPA14FNT,WRCHURNO,HPA10FNT,WRCHFLAG:  
                        *1,HPA10FNT 
              PRINT     *1,HPLINE1A,WLINEZ3:
                        *1,HPLINE1B,WLINEZ3:
                        *1,HPLINE1C,WLINEZ3
              PRINT     *1,ESC,"*p-32Y":
                        *1,HPLINE4A,HPBARCOD,WRCHURNT:
                        *1,HPLINE4B,HPBARCOD,WRCHURNT:
                        *1,HPLINE4C,HPBARCOD,WRCHURNT 
              PRINT     *1,HPA10FNT,ESC,"*p-12Y":
                        *1,ESC,"&l8D",HPA07FNT:
                        *1,ESC,"*p+10Y":
                        *1,HPLINE4A,HPBARCOD,WRCHURNT:
                        *1,HPLINE4B,HPBARCOD,WRCHURNT:
                        *1,HPLINE4C,HPBARCOD,WRCHURNT:
                        *1,HPA07FNT,HPLINE1A,WLINEZ4:
                        *1,HPLINE1B,WLINEZ4:
                        *1,HPLINE1C,WLINEZ4:
                        *1,ESC,"*p+34Y":
                        *1,HPLINE1A,WLINEZ5:
                        *1,HPLINE1B,WLINEZ5:
                        *1,HPLINE1C,WLINEZ5:
                        *1,HPLINE4A,HPA08FNT,WLINEZ8,HPA07FNT:
                        *1,HPLINE4B,HPA08FNT,WLINEZ8,HPA07FNT:
                        *1,HPLINE4C,HPA08FNT,WLINEZ8,HPA07FNT:
                        *1,HPLINE7A,WLINEZ17:
                        *1,HPLINE7B,WLINEZ17:
                        *1,HPLINE7C,WLINEZ17:
                        *1,ESC,"*p+30Y":
                        *1,HPLINE1A,WLINEZ6:
                        *1,HPLINE1B,WLINEZ6:
                        *1,HPLINE1C,WLINEZ6:
                        *1,HPLINE4A,WLINEZ9:
                        *1,HPLINE4B,WLINEZ9:
                        *1,HPLINE4C,WLINEZ9:
                        *1,ESC,"*p+30Y":
                        *1,HPLINE1A,WLINEZ7:
                        *1,HPLINE1B,WLINEZ7:
                        *1,HPLINE1C,WLINEZ7:
                        *1,HPLINE4A,WLINEZ19:
                        *1,HPLINE4B,WLINEZ19:
                        *1,HPLINE4C,WLINEZ19
              PRINT     *1,ESC,"*p+10Y":
                        *1,HPLINE1A,WLINEZ18:
                        *1,HPLINE4A,WLINEZ10:
                        *1,HPLINE1B,WLINEZ18:
                        *1,HPLINE4B,WLINEZ10:
                        *1,HPLINE1C,WLINEZ18:
                        *1,HPLINE4C,WLINEZ10:
                        *1,ESC,"*p+30Y":
                        *1,HPLINE1A,WLINEZ11:
                        *1,HPLINE1B,WLINEZ11:
                        *1,HPLINE1C,WLINEZ11:
                        *1,HPLINE4A,WLINEZ12:
                        *1,HPLINE4B,WLINEZ12:
                        *1,HPLINE4C,WLINEZ12:
                        *1,ESC,"*p+30Y":
                        *1,HPLINE1A,WLINEZ13:
                        *1,HPLINE1B,WLINEZ13:
                        *1,HPLINE1C,WLINEZ13:
                        *1,HPLINE4A,WLINEZ14:
                        *1,HPLINE4B,WLINEZ14:
                        *1,HPLINE4C,WLINEZ14:
                        *1,HPLINE6A,WLINEZ16:
                        *1,HPLINE6B,WLINEZ16:
                        *1,HPLINE6C,WLINEZ16:
                        *1,ESC,"*p+70Y" 
              ADD       THREE,COUNTER
              ADD       ONE,LINE
              GOTO      ROYAL100
            ELSE
              ASSIGN    VALUE%3,REMAINDR
              COMPARE   ZERO,REMAINDR
              GOTO      ROYAL900 IF EQUAL
.
              IF        REMAINDR = 1
                CALL      SINGLE00
              ELSE
                CALL      DOUBLE00
              ENDIF
            ENDIF
          ELSE
            IF        VALUE = 1
              CALL      SINGLE00
            ELSE
              CALL      DOUBLE00
            ENDIF
          ENDIF
.
ROYAL900  PRINT     *1,RESET
          MOVE      ZERO,COUNTER       * Reset Counter
.
          GOTO      ENDLABS
.
.****************************************************************************
.*        SJOG Geelong Labels                                               *
.****************************************************************************
.
SJOGIP00  CALL      PRTSJOGL                * (in SJOGLABL)
.
          GOTO      ENDLABS
.
.*********************************************************************
.
. ------- Finished printing -------
.
ENDLABS   COMPARE   ONE,ENDFLG
          GOTO      ENDLB9 IF EQUAL
.
          COMPARE   ZERO,ADLABEL          * no additional blank labels to print
          GOTO      ENDLB9 IF EQUAL
          MOVE      CADDLAB,NOLABEL
          MOVE      CLABPG,LABCOS
.
.         PACK      WLINE1,SP30,SP10
.         PACK      WLINE2,SP30,SP10
.         PACK      WLINE3,SP30,SP10
.         PACK      WLINE4,SP30,SP10
.         PACK      WLINE5,SP30,SP10
.         PACK      WLINE6,SP30,SP10
.         PACK      WLINE7,SP30,SP10
.         PACK      WLINE8,SP30,SP10
.
.         PACK      WFLINE1,SP30,SP10
.         PACK      WFLINE2,SP30,SP10
.         PACK      WFLINE3,SP30,SP10
.         PACK      WFLINE4,SP30,SP10
.         PACK      WFLINE5,SP30,SP10
.         PACK      WFLINE6,SP30,SP10
.         PACK      WFLINE7,SP30,SP10
.         PACK      WFLINE8,SP30,SP10
.
.         PACK      WLINE1A,SP30,SP10
.         PACK      WLINE2A,SP30,SP10
.         PACK      WLINE3A,SP30,SP10
.         PACK      WLINE4A,SP30,SP10
.         PACK      WLINE5A,SP30,SP10
.         PACK      WLINE6A,SP30,SP10
.         PACK      WLINE7A,SP30,SP10
.         PACK      WLINE8A,SP30,SP10
.
          MOVE      ONE,ENDFLG
          GOTO      PATPRLB1
.
ENDLB9    CALL      WRISTBND                     * Do any Wristbands
          CALL      CLSPRINT
          RETURN
...............................................................................
WRISTBND  COMPARE   "17",CTYPLAB                 * Taranaki?
          CALL      WRISTLAB IF EQUAL
.
          COMPARE   "21",CTYPLAB                 * Coast health care
          CALL      WRISTLAB IF EQUAL
.
          RETURN
.
+
.----- Taranaki & Coast Health Care Wrist Bands -----
.
WRISTLAB  PRINT     *1,WGLINE1
          PRINT     *1,WGLINE2
          PRINT     *1,WGLINE3,*N
          RETURN
.
.
.-------  Routines for patient (U/R) labels  ------
.
.**********************************************************************
.*     SETLBML3 - Set up labels for U/R Number labels.     05/11/90   *
.*                for Hawkes Bay                                      *
.**********************************************************************
SETLBML3  MOVE      ZERO,EXIT
.
.         Line One
.
SETLB310  PACK      WLINE1,SP30,SP10
          MOVE      PSNAME,KEY19
          PACK      WLINE1,KEY19,SP1,PTITL,PURNO
          RESET     WLINE1
.
.         Line Two
.
          PACK      WLINE2,SP30,SP10
          MOVE      PGNAME,KEY17
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            PACK      WLINE2,KEY17,SP1,PSEX,SP1,PSAGECON,PSAGETYP,SP1,CPDATE
          ELSE
            PACK      WLINE2,KEY17,SP1,PSEX,SP1,PSAGE,SP1,CPDATE
          ENDIF
.
          RESET     WLINE2
.
.          Line Three
.
          PACK      WLINE3,SP30,SP10
          CLEAR     WLINE3
.
          APPEND    PADD1,WLINE3             * Patient's Address
          CALL      FINND3
.
          APPEND    ", ",WLINE3
          APPEND    PADD2,WLINE3
          CALL      FINND3
.
          APPEND    ", ",WLINE3
          APPEND    PSUBRB,WLINE3
          CALL      FINND3
.
          RESET     WLINE3
.
.          Line Four
.
          MOVE      WLINE1,WLINE1A
          MOVE      WLINE2,WLINE2A
          MOVE      WLINE3,WLINE3A
          CALL      GLLN0000                  * keyin fourth line
          MOVE      WLINE4A,WLINE4
          PACK      WLINE5,SP30,SP30
          BRANCH    EXIT,SETLB999             * cancel chosen
          GOTO      SETLB399
.
FINND3    CMATCH    SP1,WLINE3
          RETURN    IF NOT EQUAL
          BUMP      WLINE3,-1
          GOTO      FINND3 IF NOT EOS
          RESET     WLINE3
.
.
SETLB399  RETURN
+
.**********************************************************************
.*     SETLBML4 - Set up labels for U/R Number labels.     29/11/89   *
.*                                                  L.P. SRF 102919   *
.**********************************************************************
SETLBML4  MOVE      ZERO,EXIT
          BRANCH    CTYPLAB,SETLB100,SETLB999,SETLB999,SETLB999,SETLB999:
                            SETLB100,SETLB999,SETLB999,SETLB999,SETLB999:
                            SETLB999,SETLB999,SETLB999,SETLB999,SETLB999:
                            SETLB100,SETLB200,SETLB100,SETLB100,SETLB100:
                            SETLB200,SETLB100,SETLB100,SETLB999
.
SETLB100  PACK      WLINE1A,SP30,SP10
          CLEAR     WLINE1A
.
          APPEND    PSNAME,WLINE1A            * Patient's Surname
          RESET     WLINE1A,15
.
          APPEND    SP1,WLINE1A               * Patient's Title
          APPEND    PTITL,WLINE1A
.
          UNPACK    SP12,XCENT,XYEAR,XMON,XDAY      * Patient's Birth Date
          UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          REP       " 0",XDAY
          REP       " 0",XMON
          REP       " 0",XYEAR
          REP       " 0",XCENT
          APPEND    SP1,WLINE1A
          APPEND    XDAY,WLINE1A
          APPEND    SLASH,WLINE1A
          APPEND    XMON,WLINE1A
          APPEND    SLASH,WLINE1A
          APPEND    XYEAR,WLINE1A
          RESET     WLINE1A,29
.
          APPEND    PURNO,WLINE1A             * U/R No.
          RESET     WLINE1A
.
.          Line Two
.
          PACK      WLINE2A,SP30,SP10
          CLEAR     WLINE2A
.
          APPEND    PGNAME,WLINE2A            * Patient's Given Name
          RESET     WLINE2A,23
.
          APPEND    SP1,WLINE2A               * Patient's Sex
          APPEND    PSEX,WLINE2A
.
          APPEND    SP1,WLINE2A               * Patient's Age
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            APPEND    PSAGECON,WLINE2A
            APPEND    PSAGETYP,WLINE2A
          ELSE
            APPEND    PSAGE,WLINE2A
          ENDIF
.
.          Line Three
.
          PACK      WLINE3A,SP30,SP10
          CLEAR     WLINE3A
.
          APPEND    PADD1,WLINE3A             * Patient's Address
          CALL      FINND3A
.
          APPEND    SP1,WLINE3A
          APPEND    PADD2,WLINE3A
          CALL      FINND3A
.
          APPEND    SP1,WLINE3A
          APPEND    PSUBRB,WLINE3A
          CALL      FINND3A
.
RESETL3   RESET     WLINE3A
.
.          Line Four
.
          BRANCH    CTYPLAB,SETLB300,SETLB300,SETLB300,SETLB300,SETLB300:
                            SETLB200,SETLB300,SETLB300,SETLB300,SETLB300:
                            SETLB300,SETLB300,SETLB300,SETLB300,SETLB200:
                            SETLB200,SETLB200,SETLB200,SETLB200,SETLB200:
                            SETLB200,SETLB200,SETLB200
.
SETLB200  CALL      GLLN0000                  * keyin fourth line
          BRANCH    EXIT,SETLB999             * cancel chosen
          IF        CTYPLAB = 15
            MOVE      WLINE1A,WLINE1
            MOVE      WLINE2A,WLINE2
            MOVE      WLINE3A,WLINE3
            MOVE      WLINE4A,WLINE4
            MOVE      WLINE5A,WLINE5
          ENDIF
          IF        CTYPLAB=17 | CTYPLAB=21
            MOVE      WLINE4A,WFLINE4         * Taranaki
          ENDIF
          GOTO      SETLB999
.
SETLB300  PACK      WLINE4A,SP30,SP10
          CLEAR     WLINE4A
.
          PACK      KEY2,PINITHOS             * Hospital Unique ID
          CALL      RDHOSP2
          BRANCH    OVRCD,SETLINE5
.
          RESET     WLINE4A,29                * Hospital I.D.
          APPEND    HOSCODE,WLINE4A
.
.          Line Five
.
SETLINE5  PACK      WLINE5A,SP30,SP10
          CLEAR     WLINE5A
          RETURN
.
FINND3A   CMATCH    SP1,WLINE3A
          RETURN    IF NOT EQUAL
          BUMP      WLINE3A,-1
          GOTO      FINND3A IF NOT EOS
          RESET     WLINE3A
.
SETLB999  RETURN
+
.************************************************************************
.*                         GLLN0000                                     *
.*         Get the last line of the label                               *
.*                   called by : SELB0000                               *
.************************************************************************
GLLN0000  BRANCH    PTCNFFLL,GLLN0100       * using last line
          MOVE      SP30,WLINE4A
          MOVE      SP30,WLINE5A
          MOVE      FALSE,EXIT
          GOTO      GLLN9999
.
GLLN0100  IF        CTYPLAB=17 | CTYPLAB=21
            DISPLAY   *P16:7,*V2LON,"Label to print :",*HOFF:   * Taranaki
                      *P16:9,WFLINE1:
                      *P16:10,WFLINE2:
                      *P16:11,WFLINE3;
            MOVE      SP30,WFLINE5               * No GP for U/R Label!!
.
          ELSE
            IF        CTYPLAB = 19
              DISPLAY   *P16:7,*V2LON,"Label to print :",*HOFF:
                        *P16:9,WLINE1:
                        *P16:10,WLINE2:
                        *P16:11,WLINE3:
                        *P16:13,WLINE5;
            ELSE
              DISPLAY   *P16:7,*V2LON,"Label to print :",*HOFF:
                        *P16:9,WLINE1A:
                        *P16:10,WLINE2A:
                        *P16:11,WLINE3A;
            ENDIF
          ENDIF
.
GLLN0500  IF        CTYPLAB = 19
            DISPLAY   *P14:12,*V2LON,"1",*HOFF,DOT,UNDLN30,UNDLN3;
            KEYIN     *P16:12,*V2LON,WLINE4,*P16:12,*DV,WLINE4;
            PACK      WLINE4,WLINE4,SP30,SP10
          ELSE
            DISPLAY   *P14:12,*V2LON,"1",*HOFF,DOT,UNDLN30,UNDLN8;
            KEYIN     *P16:12,*V2LON,WLINE4A,*P16:12,*DV,WLINE4A;
            PACK      WLINE4A,WLINE4A,SP30,SP30
          ENDIF
.
GLLN1000  PACK      WLINE5A,SP30,SP30
          CALL      MAINQST                 * select item ,post or cancel?
          COMPARE   "-1",CCITEM             * was cancel chosen?
          GOTO      GLLN5000 IF EQUAL
.
          MOVE      FALSE,EXIT
          COMPARE   ZERO,CCITEM             * was post chosen?
          GOTO      GLLN9999 IF EQUAL
.
          COMPARE   ONE,CCITEM              * was item chosen?
          GOTO      GLLN0500 IF EQUAL
          BEEP
          GOTO      GLLN1000
.
GLLN5000  MOVE      TRUE,EXIT             * cancel
.
GLLN9999  MOVE      WLINE4A,KEY40
          RETURN
.
+
.
.-------  Screen Painter Includes  -------
.
..          INC       LABELINP
..          INC       LABELPMI
.
+
