.*----------------------------------------------------------------------
.* Include Name  :   PATVADCK.PBL
.*
.* Function      :   Validate transfer source code
.*
.* Parameters    :   TRNSCODE - Transfer code to validate
.*                   TRNSDATE - Transfer code date
.*
.* Returns       :   EXIT    0 - OK                           
.*                           1 - Error invalid code or invalide date range
.*
.*----------------------------------------------------------------------
. Modifications Done :
.
. V9.03.00  24/03/2004  Ebon Clements CAR 18703
.                       Created include           
.*----------------------------------------------------------------------
CVAD0000  MOVE      ZERO,EXIT
.
          MATCH     SP70,TRNSCODE           * No transfer source code so exit
          GOTO      CVAD9999 IF EQUAL
.
          PACK      KEY5,TRNSCODE,SP70
          CALL      RDPTVAD1
          BRANCH    OVRCD,CVAD9000
.
          MATCH     PTVASDAT,TRNSDATE       * Transfer source start date
          GOTO      CVAD9200 IF LESS
.
          MATCH     SP70,PTVAEDAT           * Still active if no end date
          GOTO      CVAD5000 IF EQUAL
.
          MATCH     PTVAEDAT,TRNSDATE       * Transfer source end date
          GOTO      CVAD9300 IF NOT LESS
.
CVAD5000  MOVE      ZERO,EXIT               * Valid transfer source code
          GOTO      CVAD9999
.
CVAD9000  CLEAR     WEBTITLE
          APPEND    "Invalid Transfer Source - ",WEBTITLE
          APPEND    KEY5,WEBTITLE
          RESET     WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CVAD9999
.
CVAD9100  CLEAR     WEBTITLE
          APPEND    "Inactive Transfer Source - ",WEBTITLE
          APPEND    KEY5,WEBTITLE
          RESET     WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CVAD9999
.
CVAD9200  CLEAR     WEBTITLE 
          APPEND    " This Transfer Source code is not valid - ",WEBTITLE
          APPEND    " Start date has not been reached. - ",WEBTITLE
          APPEND    KEY5,WEBTITLE
          RESET     WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CVAD9999
.
CVAD9300  CLEAR     WEBTITLE
          APPEND    " This Transfer Source code is not valid - ",WEBTITLE
          APPEND    " End date has been reached. - ",WEBTITLE
          APPEND    KEY5,WEBTITLE
          RESET     WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CVAD9999
.
CVAD9999  RETURN
