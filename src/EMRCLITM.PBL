.
.  ****************************************************************************
.  *                                                                          *
.  *     Include Name : EMRCLITM.INC                                          *
.  *                                                                          *
.  *     Function     : CGI Definition include for EMR Clinic information     *
.  *                    file                                                  *  
.  *                                                                          *
.  *--------------------------------------------------------------------------*
.  Mods:
.
.  V11.00.01  22/01/2021  Ebon Clements TSK 0892761
.                         Added semi colon to date tags
.  V10.06.01  17/03/2015  Peter Vela    CAR 282090
.                         Added tag for Relative Contacted desc EMRC5400
.  V10.03.01  25/02/2013  Ania P        CAR 281201
.                         Changed MOVE MTHNAM3,SP70 to PACK MTHNAM3,SP70
.  V9.12.01   01/06/2009  Saroeun Soeur CAR 197930
.             created cgi varaibles for EMRCLIFD
.
.------------------------------------------------------------------------------
.         Clear Parameters for EMRCLIFD
.------------------------------------------------------------------------------
.
CPAR0000  MOVE      Z70,EMRCL001        * Ordered Field 1 (X-Ray)
          MOVE      Z70,EMRCL002        * Ordered Field 2 (CT Scan)
          MOVE      Z70,EMRCL003        * Ordered Field 3 (U/S)
          MOVE      Z70,EMRCL004        * Ordered Field 4 (MRI)
          MOVE      Z70,EMRCL005        * Ordered Field 5 (Nuclear Medicine)
          MOVE      Z70,EMRCL006        * Ordered Field 6 (LMO Contacted)
          MOVE      Z70,EMRCL007        * Ordered Field 7 (Speciality/Other Hospital Contacted)
          MOVE      Z70,EMRCL008        * Ordered Field 8
          MOVE      Z70,EMRCL009        * Ordered Field 9
          MOVE      Z70,EMRCL010        * Ordered Field 10
          MOVE      Z70,EMRCL011        * Patient Returned Field 1 (X-Ray)
          MOVE      Z70,EMRCL012        * Patient Returned Field 2 (CT Scan)
          MOVE      Z70,EMRCL013        * Patient Returned field 3 (U/S)
          MOVE      Z70,EMRCL014        * Patient Returned Field 4 (MRI)
          MOVE      Z70,EMRCL015        * Patient Returned Field 5 (Nuclear Medicine)
          MOVE      Z70,EMRCL016        * Patient Returned Field 6
          MOVE      Z70,EMRCL017        * Patient Returned Field 7
          MOVE      Z70,EMRCL018        * Patient Returned Field 8
          MOVE      Z70,EMRCL019        * Patient Returned Field 9
          MOVE      Z70,EMRCL020        * Patient Returned Field 10
          MOVE      Z70,EMRCL021        * Report Seen Field 1 (X-Ray)
          MOVE      Z70,EMRCL022        * Report Seen Field 2 (CT Scan)
          MOVE      Z70,EMRCL023        * Report Seen Field 3 (U/S)
          MOVE      Z70,EMRCL024        * Report Seen Field 4 (MRI)
          MOVE      Z70,EMRCL025        * Report Seen Field 5 (Nuclear Medicine)
          MOVE      Z70,EMRCL026        * Report Seen Field 6
          MOVE      Z70,EMRCL027        * Report Seen Field 7
          MOVE      Z70,EMRCL028        * Report Seen Field 8
          MOVE      Z70,EMRCL029        * Report Seen Field 9
          MOVE      Z70,EMRCL030        * Report Seen Field 10
          MOVE      Z70,EMRCL031        * Pathology Company (Cat PQ)
          MOVE      Z70,EMRCL032        * LMO Contacted Free Format Description
          MOVE      Z70,EMRCL033        * LMO Contacted HCP Code
          MOVE      Z70,EMRCL034        * LMO Contacted Via Coded Field
          MOVE      Z70,EMRCL035        * Relative Contacted Code (From Relationship File(pmsrelaf))
          MOVE      Z70,EMRCL036        * Relative Contacted Free Format Description
          MOVE      Z70,EMRCL037        * Relative Contacted Time
          MOVE      Z70,EMRCL038        * Speciality/Other Hos Contacted Free
          MOVE      Z70,EMRCL039        * Speciality/Other Hos Via Coded Field
          MOVE      Z70,EMRCL040        * Time Speciality/Other Hos Contacted
          MOVE      Z70,EMRCL041        * Patient Review Date (CCYYMMDD)
          MOVE      Z70,EMRCL042        * Reason For Review (Free Format)
          MOVE      Z70,EMRCL043        * User who Created Record
          MOVE      Z70,EMRCL044        * Date Record Created
          MOVE      Z70,EMRCL045        * Time Record Created
          MOVE      Z70,EMRCL046        * User Who Updated Record
          MOVE      Z70,EMRCL047        * Date Record Updated
          MOVE      Z70,EMRCL048        * Time Record Updated
.
CPAR9999  RETURN
+
.------------------------------------------------------------------------------
.         Set Parameters for EMRCLIFD
.------------------------------------------------------------------------------
SPAR0000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPAR0001,SPAR0002,SPAR0003,SPAR0004,SPAR0005:
                       SPAR0006,SPAR0007,SPAR0008,SPAR0009,SPAR0010:
                       SPAR0011,SPAR0012,SPAR0013,SPAR0014,SPAR0015:
                       SPAR0016,SPAR0017,SPAR0018,SPAR0019,SPAR0020:
                       SPAR0021,SPAR0022,SPAR0023,SPAR0024,SPAR0025:
                       SPAR0026,SPAR0027,SPAR0028,SPAR0029,SPAR0030:
                       SPAR0031,SPAR0032,SPAR0033,SPAR0034,SPAR0035:
                       SPAR0036,SPAR0037,SPAR0038,SPAR0039,SPAR0040:
                       SPAR0041,SPAR0042,SPAR0043,SPAR0044,SPAR0045:
                       SPAR0046,SPAR0047,SPAR0048
.
          GOTO      SPAR9999
.
SPAR0001   MOVE      QRYDATA,EMRCL001
          GOTO      SPAR9999
.
SPAR0002   MOVE      QRYDATA,EMRCL002
          GOTO      SPAR9999
.
SPAR0003   MOVE      QRYDATA,EMRCL003
          GOTO      SPAR9999
.
SPAR0004   MOVE      QRYDATA,EMRCL004
          GOTO      SPAR9999
.
SPAR0005   MOVE      QRYDATA,EMRCL005
          GOTO      SPAR9999
.
SPAR0006   MOVE      QRYDATA,EMRCL006
          GOTO      SPAR9999
.
SPAR0007   MOVE      QRYDATA,EMRCL007
          GOTO      SPAR9999
.
SPAR0008   MOVE      QRYDATA,EMRCL008
          GOTO      SPAR9999
.
SPAR0009   MOVE      QRYDATA,EMRCL009
          GOTO      SPAR9999
.
SPAR0010   MOVE      QRYDATA,EMRCL010
          GOTO      SPAR9999
.
SPAR0011   MOVE      QRYDATA,EMRCL011
          GOTO      SPAR9999
.
SPAR0012   MOVE      QRYDATA,EMRCL012
          GOTO      SPAR9999
.
SPAR0013   MOVE      QRYDATA,EMRCL013
          GOTO      SPAR9999
.
SPAR0014   MOVE      QRYDATA,EMRCL014
          GOTO      SPAR9999
.
SPAR0015   MOVE      QRYDATA,EMRCL015
          GOTO      SPAR9999
.
SPAR0016   MOVE      QRYDATA,EMRCL016
          GOTO      SPAR9999
.
SPAR0017   MOVE      QRYDATA,EMRCL017
          GOTO      SPAR9999
.
SPAR0018   MOVE      QRYDATA,EMRCL018
          GOTO      SPAR9999
.
SPAR0019   MOVE      QRYDATA,EMRCL019
          GOTO      SPAR9999
.
SPAR0020   MOVE      QRYDATA,EMRCL020
          GOTO      SPAR9999
.
SPAR0021   MOVE      QRYDATA,EMRCL021
          GOTO      SPAR9999
.
SPAR0022   MOVE      QRYDATA,EMRCL022
          GOTO      SPAR9999
.
SPAR0023   MOVE      QRYDATA,EMRCL023
          GOTO      SPAR9999
.
SPAR0024   MOVE      QRYDATA,EMRCL024
          GOTO      SPAR9999
.
SPAR0025   MOVE      QRYDATA,EMRCL025
          GOTO      SPAR9999
.
SPAR0026   MOVE      QRYDATA,EMRCL026
          GOTO      SPAR9999
.
.
SPAR0027   MOVE      QRYDATA,EMRCL027
          GOTO      SPAR9999
.
SPAR0028   MOVE      QRYDATA,EMRCL028
          GOTO      SPAR9999
.
SPAR0029   MOVE      QRYDATA,EMRCL029
          GOTO      SPAR9999
.
SPAR0030   MOVE      QRYDATA,EMRCL030
          GOTO      SPAR9999
.
SPAR0031   MOVE      QRYDATA,EMRCL031
          GOTO      SPAR9999
.
SPAR0032   MOVE      QRYDATA,EMRCL032
          GOTO      SPAR9999
.
SPAR0033   MOVE      QRYDATA,EMRCL033
          GOTO      SPAR9999
.
SPAR0034   MOVE      QRYDATA,EMRCL034
          GOTO      SPAR9999
.
SPAR0035   MOVE      QRYDATA,EMRCL035
          GOTO      SPAR9999
.
SPAR0036   MOVE      QRYDATA,EMRCL036
          GOTO      SPAR9999
.
SPAR0037   MOVE      QRYDATA,EMRCL037
          GOTO      SPAR9999
.
SPAR0038   MOVE      QRYDATA,EMRCL038
          GOTO      SPAR9999
.
SPAR0039  MOVE      QRYDATA,EMRCL039
          GOTO      SPAR9999
.
SPAR0040  MOVE      QRYDATA,EMRCL040
          GOTO      SPAR9999
.
SPAR0041  MATCH     QRYDATA,SP70
          IF        @EQUAL
            GOTO    SPAR9999
          ENDIF
.
          MOVE      ZERO,MONTH2
          UNPACK    QRYDATA,DAY,ANS,MONTH,ANS,CENT,YEAR2
          CALL      MONNUM00
          PACK      EMRCL041,CENT,YEAR2,MONTH2,DAY
          REP       " 0",EMRCL041
.
          COMPARE   MONTH2,ZERO
          IF        @EQUAL
            REP     "0 ",EMRCL041
          ENDIF
          GOTO      SPAR9999  
.
SPAR0042  MOVE      QRYDATA,EMRCL042
          GOTO      SPAR9999
.
SPAR0043  MOVE      QRYDATA,EMRCL043
          GOTO      SPAR9999
.
SPAR0044  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMRCL044,CCENT,CYEAR,CMON,CDAY
          GOTO      SPAR9999
 
.
SPAR0045   MOVE      QRYDATA,EMRCL045
           GOTO      SPAR9999
.
SPAR0046   MOVE      QRYDATA,EMRCL046
           GOTO      SPAR9999
.
.
SPAR0047  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMRCL047,CCENT,CYEAR,CMON,CDAY
          GOTO      SPAR9999
.
SPAR0048  MOVE      QRYDATA,EMRCL048
          GOTO      SPAR9999
.
SPAR9999  RETURN
+
.------------------------------------------------------------
.  Update EMRCLIFD file variables
.------------------------------------------------------------
.
UPAR0000  MATCH     Z70,EMRCL001
          IF        !@EQUAL
            MOVE      EMRCL001,EMCIOR01
          ENDIF
.
          MATCH     Z70,EMRCL002
          IF        !@EQUAL
            MOVE      EMRCL002,EMCIOR02
          ENDIF
.
          MATCH     Z70,EMRCL003
          IF        !@EQUAL
            MOVE      EMRCL003,EMCIOR03
          ENDIF
.
          MATCH     Z70,EMRCL004
          IF        !@EQUAL
            MOVE      EMRCL004,EMCIOR04
          ENDIF
.
          MATCH     Z70,EMRCL005
          IF        !@EQUAL
            MOVE      EMRCL005,EMCIOR05
          ENDIF
.
          MATCH     Z70,EMRCL006
          IF        !@EQUAL
            MOVE      EMRCL006,EMCIOR06
          ENDIF
.
          MATCH     Z70,EMRCL007
          IF        !@EQUAL
            MOVE      EMRCL007,EMCIOR07
          ENDIF
.
          MATCH     Z70,EMRCL008
          IF        !@EQUAL
            MOVE      EMRCL008,EMCIOR08
          ENDIF
.
          MATCH     Z70,EMRCL009
          IF        !@EQUAL
            MOVE      EMRCL009,EMCIOR09
          ENDIF
.
          MATCH     Z70,EMRCL010
          IF        !@EQUAL
            MOVE      EMRCL010,EMCIOR10
          ENDIF
.
          MATCH     Z70,EMRCL011
          IF        !@EQUAL
            MOVE      EMRCL011,EMCIPR01
          ENDIF
.
          MATCH     Z70,EMRCL012
          IF        !@EQUAL
            MOVE      EMRCL012,EMCIPR02
          ENDIF
.
          MATCH     Z70,EMRCL013
          IF        !@EQUAL
            MOVE      EMRCL013,EMCIPR03
          ENDIF
.
          MATCH     Z70,EMRCL014
          IF        !@EQUAL
            MOVE      EMRCL014,EMCIPR04
          ENDIF
.
          MATCH     Z70,EMRCL015
          IF        !@EQUAL
            MOVE      EMRCL015,EMCIPR05
          ENDIF
.
          MATCH     Z70,EMRCL016
          IF        !@EQUAL
            MOVE      EMRCL016,EMCIPR06
          ENDIF
.
          MATCH     Z70,EMRCL017
          IF        !@EQUAL
            MOVE      EMRCL017,EMCIPR07
          ENDIF
.
          MATCH     Z70,EMRCL018
          IF        !@EQUAL
            MOVE      EMRCL018,EMCIPR08
          ENDIF
.
          MATCH     Z70,EMRCL019
          IF        !@EQUAL
            MOVE      EMRCL019,EMCIPR09
          ENDIF
.
          MATCH     Z70,EMRCL020
          IF        !@EQUAL
            MOVE      EMRCL020,EMCIPR10
          ENDIF
.
          MATCH     Z70,EMRCL021
          IF        !@EQUAL
            MOVE      EMRCL021,EMCIRS01
          ENDIF
.
          MATCH     Z70,EMRCL022
          IF        !@EQUAL
            MOVE      EMRCL022,EMCIRS02
          ENDIF
.
          MATCH     Z70,EMRCL023
          IF        !@EQUAL
            MOVE      EMRCL023,EMCIRS03
          ENDIF
.
          MATCH     Z70,EMRCL024
          IF        !@EQUAL
            MOVE      EMRCL024,EMCIRS04
          ENDIF
.
          MATCH     Z70,EMRCL025
          IF        !@EQUAL
            MOVE      EMRCL025,EMCIRS05
          ENDIF
.
          MATCH     Z70,EMRCL026
          IF        !@EQUAL
            MOVE      EMRCL026,EMCIRS06
          ENDIF
.
          MATCH     Z70,EMRCL027
          IF        !@EQUAL
            MOVE      EMRCL027,EMCIRS07
          ENDIF
.
          MATCH     Z70,EMRCL028
          IF        !@EQUAL
            MOVE      EMRCL028,EMCIRS08
          ENDIF
.
          MATCH     Z70,EMRCL029
          IF        !@EQUAL
            MOVE      EMRCL029,EMCIRS09
          ENDIF
.
          MATCH     Z70,EMRCL030
          IF        !@EQUAL
            MOVE      EMRCL030,EMCIRS10
          ENDIF
.
          MATCH     Z70,EMRCL031
          IF        !@EQUAL
            MOVE      EMRCL031,EMCIPCOM
          ENDIF
.
          MATCH     Z70,EMRCL032
          IF        !@EQUAL
            MOVE      EMRCL032,EMCILMDS
          ENDIF
.
          MATCH     Z70,EMRCL033
          IF        !@EQUAL
            MOVE      EMRCL033,EMCILMCD
          ENDIF
.
          MATCH     Z70,EMRCL034
          IF        !@EQUAL
            MOVE      EMRCL034,EMCILMCF
          ENDIF
.
          MATCH     Z70,EMRCL035
          IF        !@EQUAL
            MOVE      EMRCL035,EMCIRCCD
          ENDIF
.
          MATCH     Z70,EMRCL036
          IF        !@EQUAL
            MOVE      EMRCL036,EMCIRCFF
          ENDIF
.
          MATCH     Z70,EMRCL037
          IF        !@EQUAL
            MOVE      EMRCL037,EMCIRCTM
          ENDIF
.
          MATCH     Z70,EMRCL038
          IF        !@EQUAL
            MOVE      EMRCL038,EMCISCFF
          ENDIF
.
          MATCH     Z70,EMRCL039
          IF        !@EQUAL
            MOVE      EMRCL039,EMCISCVC
          ENDIF
.
          MATCH     Z70,EMRCL040
          IF        !@EQUAL
            MOVE      EMRCL040,EMCITSCT
          ENDIF
.
          MATCH     Z70,EMRCL041
          IF        !@EQUAL
            MOVE      EMRCL041,EMCIPRDT
          ENDIF
.
          MATCH     Z70,EMRCL042
          IF        !@EQUAL
            MOVE      EMRCL042,EMCIRRFF
          ENDIF
.
          MATCH     Z70,EMRCL043
          IF        !@EQUAL
            MOVE      EMRCL043,EMCIUWCR
          ENDIF
.
          MATCH     Z70,EMRCL044
          IF        !@EQUAL
            MOVE      EMRCL044,EMCIRCDT
          ENDIF
.
          MATCH     Z70,EMRCL045
          IF        !@EQUAL
            MOVE      EMRCL045,EMCITRCD
          ENDIF
.
          MATCH     Z70,EMRCL046
          IF        !@EQUAL
            MOVE      EMRCL046,EMCIUUPD
          ENDIF
.
          MATCH     Z70,EMRCL047
          IF        !@EQUAL
            MOVE      EMRCL047,EMCIRUDT
          ENDIF
.
          MATCH     Z70,EMRCL048
          IF        !@EQUAL
            MOVE      EMRCL048,EMCITRUP
          ENDIF
.
UPAR9999  RETURN
+
.------------------------------------------------------------------------------
EMRC0000  BRANCH    FLDITMNO,EMRC0100,EMRC0200,EMRC0300,EMRC0400,EMRC0500:
                             EMRC0600,EMRC0700,EMRC0800,EMRC0900,EMRC1000:
                             EMRC1100,EMRC1200,EMRC1300,EMRC1400,EMRC1500:
                             EMRC1600,EMRC1700,EMRC1800,EMRC1900,EMRC2000:
                             EMRC2100,EMRC2200,EMRC2300,EMRC2400,EMRC2500:
                             EMRC2600,EMRC2700,EMRC2800,EMRC2900,EMRC3000:
                             EMRC3100,EMRC3200,EMRC3300,EMRC3400,EMRC3500:
                             EMRC3600,EMRC3700,EMRC3800,EMRC3900,EMRC4000:
                             EMRC4100,EMRC4200,EMRC4300,EMRC4400,EMRC4500:
                             EMRC4600,EMRC4700,EMRC4800,EMRC4900,EMRC5000: 
                             EMRC5100,EMRC5200,EMRC5300,EMRC5400
.
          WRITE     HTMLFILE;"Invaild IBA Tag";
          GOTO      EMRC9999
.
EMRC0100  WRITE     HTMLFILE;EMCIOR01;   * Ordered Field 1 (X-Ray)
          GOTO      EMRC9999
.
EMRC0200  WRITE     HTMLFILE;EMCIOR02;   * Ordered Field 2 (CT Scan)
          GOTO      EMRC9999
.
EMRC0300  WRITE     HTMLFILE;EMCIOR03;   * Ordered Field 3 (U/S)
          GOTO      EMRC9999
.
EMRC0400  WRITE     HTMLFILE;EMCIOR04;   * Ordered Field 4 (MRI)
          GOTO      EMRC9999
.
EMRC0500  WRITE     HTMLFILE;EMCIOR05;   * Ordered Field 5 (Nuclear Medicine)
          GOTO      EMRC9999
.
EMRC0600  WRITE     HTMLFILE;EMCIOR06;   * Ordered Field 6 (LMO Contacted)
          GOTO      EMRC9999

EMRC0700  WRITE     HTMLFILE;EMCIOR07;   * Ordered Field 7 (Speciality/Other Hospital Contacted)
          GOTO      EMRC9999
.
EMRC0800  WRITE     HTMLFILE;EMCIOR08;   * Ordered Field 8
          GOTO      EMRC9999
.
EMRC0900  WRITE     HTMLFILE;EMCIOR09;   * Ordered Field 9
          GOTO      EMRC9999
.
EMRC1000  WRITE     HTMLFILE;EMCIOR10;   * Ordered Field 10
          GOTO      EMRC9999
.
EMRC1100  WRITE     HTMLFILE;EMCIPR01;  * Patient Returned Field 1 (X-Ray)
          GOTO      EMRC9999
.
EMRC1200  WRITE     HTMLFILE;EMCIPR02;   * Patient Returned Field 2 (CT Scan)
          GOTO      EMRC9999
.
EMRC1300  WRITE     HTMLFILE;EMCIPR03;   * Patient Returned field 3 (U/S)
          GOTO      EMRC9999
.
EMRC1400  WRITE     HTMLFILE;EMCIPR04;   * Patient Returned Field 4 (MRI)
          GOTO      EMRC9999
.
EMRC1500  WRITE     HTMLFILE;EMCIPR05;   * Patient Returned Field 5 (Nuclear Medicine)
          GOTO      EMRC9999
.
EMRC1600  WRITE     HTMLFILE;EMCIPR06;   * Patient Returned Field 6
          GOTO      EMRC9999
.
EMRC1700  WRITE     HTMLFILE;EMCIPR07;   * Patient Returned Field 7
          GOTO      EMRC9999
.
EMRC1800  WRITE     HTMLFILE;EMCIPR08;   * Patient Returned Field 8
          GOTO      EMRC9999
.
EMRC1900  WRITE     HTMLFILE;EMCIPR09;   * Patient Returned Field 9
          GOTO      EMRC9999
.
EMRC2000  WRITE     HTMLFILE;EMCIPR10;   * Patient Returned Field 10
          GOTO      EMRC9999
.
EMRC2100  WRITE     HTMLFILE;EMCIRS01;   * Report Seen Field 1 (X-Ray)
          GOTO      EMRC9999
.
EMRC2200  WRITE     HTMLFILE;EMCIRS02;   * Report Seen Field 2 (CT Scan)
          GOTO      EMRC9999
.
EMRC2300  WRITE     HTMLFILE;EMCIRS03;   * Report Seen Field 3 (U/S)
          GOTO      EMRC9999
.
EMRC2400  WRITE     HTMLFILE;EMCIRS04;   * Report Seen Field 4 (MRI)
          GOTO      EMRC9999
.
EMRC2500  WRITE     HTMLFILE;EMCIRS05;   * Report Seen Field 5 (Nuclear Medicine)
          GOTO      EMRC9999
.
EMRC2600  WRITE     HTMLFILE;EMCIRS06;   * Report Seen Field 6 
          GOTO      EMRC9999
.
EMRC2700  WRITE     HTMLFILE;EMCIRS07;   * Report Seen Field 7 
          GOTO      EMRC9999
.
EMRC2800  WRITE     HTMLFILE;EMCIRS08;   * Report Seen Field 8 
          GOTO      EMRC9999
.
EMRC2900  WRITE     HTMLFILE;EMCIRS09;   * Report Seen Field 9 
          GOTO      EMRC9999
.
EMRC3000  WRITE     HTMLFILE;EMCIRS10;   * Report Seen Field 10 
          GOTO      EMRC9999
.
EMRC3100  WRITE     HTMLFILE;EMCIPCOM;   * Pathology Company (Cat PQ)
          GOTO      EMRC9999
.
EMRC3200  WRITE     HTMLFILE;EMCILMDS;   * LMO Contacted Free Format Description
          GOTO      EMRC9999
.
EMRC3300  WRITE     HTMLFILE;EMCILMCD;   * LMO Contacted HCP Code
          GOTO      EMRC9999
.
EMRC3400  WRITE     HTMLFILE;EMCILMCF;   * LMO Contacted Via Coded Field
          GOTO      EMRC9999
.
EMRC3500  WRITE     HTMLFILE;EMCIRCCD;   * Relative Contacted Code (From Relationship File(pmsrelaf))
          GOTO      EMRC9999
.
EMRC3600  WRITE     HTMLFILE;EMCIRCFF;   * Relative Contacted Free Format Description
          GOTO      EMRC9999
.
EMRC3700  WRITE     HTMLFILE;EMCIRCTM;   * Relative Contacted Time
          GOTO      EMRC9999
.
EMRC3800  WRITE     HTMLFILE;EMCISCFF;   * Speciality/Other Hos Contacted Free
          GOTO      EMRC9999
.
EMRC3900  WRITE     HTMLFILE;EMCISCVC;   * Speciality/Other Hos Via Coded Field
          GOTO      EMRC9999
.
EMRC4000  WRITE     HTMLFILE;EMCITSCT;   * Time Speciality/Other Hos Contacted
          GOTO      EMRC9999
.
EMRC4100  MATCH     SP70,EMCIPRDT        * Patient Review Date (CCYYMMDD)
          GOTO      EMRC9999 IF EQUAL
.
          PACK      MTHNAM3,SP70
          UNPACK    EMCIPRDT,CCENT,CYEAR,CMON,CDAY
          MATCH     "00",CMON
          GOTO      EMRC9999 IF EQUAL
          MATCH     "00",CDAY
          GOTO      EMRC9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
.
          GOTO      EMRC9999
.
EMRC4200  WRITE     HTMLFILE;EMCIRRFF;   * Reason For Review (Free Format)
          GOTO      EMRC9999
.
EMRC4300  WRITE     HTMLFILE;EMCIUWCR;   * User who Created Record
          GOTO      EMRC9999
.
EMRC4400  MATCH     SP70,EMCIRCDT        * Date Record Created
          GOTO      EMRC9999 IF EQUAL
.
          UNPACK    EMCIRCDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
.
          GOTO      EMRC9999
.
EMRC4500  WRITE     HTMLFILE;EMCITRCD;   * Time Record Created
          GOTO      EMRC9999
.
EMRC4600  WRITE     HTMLFILE;EMCIUUPD;   * User Who Updated Record
          GOTO      EMRC9999
.
EMRC4700  MATCH     SP70,EMCIRUDT        * Date Record Updated
          GOTO      EMRC9999 IF EQUAL
.
          UNPACK    EMCIRUDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
.
          GOTO      EMRC9999
.
EMRC4800  WRITE     HTMLFILE;EMCITRUP;   * Time Record Updated
          GOTO      EMRC9999
.
EMRC4900  MOVE      "PQ",CATEGORY        * list Pathology Company
          MOVE      EMCIPCOM,CODE
          CALL      CODITM00
          GOTO      EMRC9999
.
EMRC5000  CALL      RELD0000            * relationship dropdown list
          GOTO      EMRC9999
.
EMRC5100  MOVE      "CZ",CATEGORY
          MOVE      EMCILMCF,CODE
          CALL      CODITM00
          GOTO      EMRC9999
.
EMRC5200  MOVE      "CZ",CATEGORY
          MOVE      EMCISCVC,CODE
          CALL      CODITM00
          GOTO      EMRC9999
.
EMRC5300  PACK      DOCFNAME,SP70
          PACK      KEY10,EMCILMCD,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,EMRC9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      EMRC9999         
.
EMRC5400  MATCH     SP70,EMCIRCCD
          GOTO      EMRC9999 IF EQUAL
.
          PACK      KEY10,EMCIRCCD,SP70
          CALL      RDPMREL1
          IF        OVRCD=0
            WRITE     HTMLFILE;PMRLDESC;
          ELSE
            WRITE     HTMLFILE;EMCIRCCD;
          ENDIF
          GOTO      EMRC9999
.
EMRC9999  RETURN
+
.----------------------------------------------------
.         RELD0000 - relationship dropdown list
.----------------------------------------------------
.
RELD0000  PACK      KEY10,SP70
          CALL      RSPMREL1
RELD1000  CALL      RKPMREL1
          BRANCH    OVRCD,RELD9999
.
          MATCH     PMRLRELS,EMCIRCCD
          IF        @EQUAL
            WRITE     HTMLFILE;"<option selected value=#"",PMRLRELS,"#">",PMRLDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PMRLRELS,"#">",PMRLDESC,"</option>"
          ENDIF
.          
          GOTO      RELD1000
.
RELD9999  RETURN
+
.--------------------------------------------------------------
.        CLRC0000 - clear clinic information variables
.--------------------------------------------------------------
.
CLRC0000  MOVE      SP70,EMCIOR01
          MOVE      SP70,EMCIOR02
          MOVE      SP70,EMCIOR03
          MOVE      SP70,EMCIOR04
          MOVE      SP70,EMCIOR05
          MOVE      SP70,EMCIOR06
          MOVE      SP70,EMCIOR07
          MOVE      SP70,EMCIOR08
          MOVE      SP70,EMCIOR09
          MOVE      SP70,EMCIOR10
          MOVE      SP70,EMCIPR01
          MOVE      SP70,EMCIPR02
          MOVE      SP70,EMCIPR03
          MOVE      SP70,EMCIPR04
          MOVE      SP70,EMCIPR05
          MOVE      SP70,EMCIPR06
          MOVE      SP70,EMCIPR07
          MOVE      SP70,EMCIPR08
          MOVE      SP70,EMCIPR09
          MOVE      SP70,EMCIPR10
          MOVE      SP70,EMCIRS01
          MOVE      SP70,EMCIRS02
          MOVE      SP70,EMCIRS03
          MOVE      SP70,EMCIRS04
          MOVE      SP70,EMCIRS05
          MOVE      SP70,EMCIRS06
          MOVE      SP70,EMCIRS07
          MOVE      SP70,EMCIPR08
          MOVE      SP70,EMCIPR09
          MOVE      SP70,EMCIPR10
          MOVE      SP70,EMCIRS01
          MOVE      SP70,EMCIRS02
          MOVE      SP70,EMCIRS03
          MOVE      SP70,EMCIRS04
          MOVE      SP70,EMCIRS05
          MOVE      SP70,EMCIRS06
          MOVE      SP70,EMCIRS07
          MOVE      SP70,EMCIRS08
          MOVE      SP70,EMCIRS09
          MOVE      SP70,EMCIRS10
          MOVE      SP70,EMCIPCOM
          MOVE      SP70,EMCILMDS
          MOVE      SP70,EMCILMCD
          MOVE      SP70,EMCILMCF
          MOVE      SP70,EMCIRCCD
          MOVE      SP70,EMCIRCFF
          MOVE      SP70,EMCIRCTM
          MOVE      SP70,EMCISCFF
          MOVE      SP70,EMCISCVC
          MOVE      SP70,EMCITSCT
          MOVE      SP70,EMCIPRDT
          MOVE      SP70,EMCIRRFF
          MOVE      SP70,EMCIUWCR
          MOVE      SP70,EMCIRCDT
          MOVE      SP70,EMCITRCD
          MOVE      SP70,EMCIUUPD
          MOVE      SP70,EMCIRUDT
          MOVE      SP70,EMCITRUP
.
CLRC9999  RETURN


     
