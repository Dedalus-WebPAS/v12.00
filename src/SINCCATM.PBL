. *----------------------------------------------------------------------
. * Include Name  :   SINCCATM.PBL
. *
. * Function      :   CGI variable functions for SINCCAFD - sinccaaf.dat
. *
. * Modifications :
. *
. * V9.04.00 25/02/2005 Lina Vo                  CAR 56404
. *          Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear parameters for the cost centre file
.------------------------------------------------------------------------
CPSCCA00  MOVE      Z70,SICCA001
          MOVE      Z70,SICCA002
          MOVE      Z70,SICCA003
          MOVE      Z70,SICCA004
          MOVE      Z70,SICCA005
          MOVE      Z70,SICCA006
          MOVE      Z70,SICCA007
          MOVE      Z70,SICCA008
          MOVE      Z70,SICCA009
          MOVE      Z70,SICCA010
          MOVE      Z70,SICCA011
          MOVE      Z70,SICCA012
          MOVE      Z70,SICCA013
          MOVE      Z70,SICCA014
          MOVE      Z70,SICCA015
          MOVE      Z70,SICCA016
          MOVE      Z70,SICCA017
          MOVE      Z70,SICCA018
          MOVE      Z70,SICCA019
          MOVE      Z70,SICCA020
          MOVE      Z70,SICCA021
.
CPSCCA99  RETURN
.
.------------------------------------------------------------
. cost centre file standard tags
.------------------------------------------------------------
SCCA0000  BRANCH    FLDITMNO,SCCA0010,SCCA0020,SCCA0030,SCCA0040,SCCA0050:
                             SCCA0060,SCCA0070,SCCA0080,SCCA0090,SCCA0100:
                             SCCA0110,SCCA0120,SCCA0130,SCCA0140,SCCA0150:
                             SCCA0160,SCCA0170,SCCA0180,SCCA0190,SCCA0200:
                             SCCA0210
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      SCCA9999
.
SCCA0010  WRITE     HTMLFILE;SICACODE;  
          GOTO      SCCA9999
.
SCCA0020  WRITE     HTMLFILE;SICADESC;  
          GOTO      SCCA9999
.
SCCA0030  WRITE     HTMLFILE;SICATELE;  
          GOTO      SCCA9999
.
SCCA0040  WRITE     HTMLFILE;SICACONT;
          GOTO      SCCA9999
.
SCCA0050  WRITE     HTMLFILE;SICAGL;
          GOTO      SCCA9999
.
SCCA0060  WRITE     HTMLFILE;SICAIMPD;
          GOTO      SCCA9999
.
SCCA0070  WRITE     HTMLFILE;SICADAD1;
          GOTO      SCCA9999
.
SCCA0080  WRITE     HTMLFILE;SICADAD2;
          GOTO      SCCA9999
.
SCCA0090  WRITE     HTMLFILE;SICADAD3;
          GOTO      SCCA9999
.         
SCCA0100  WRITE     HTMLFILE;SICALOC;
          GOTO      SCCA9999
.
SCCA0110  WRITE     HTMLFILE;SICAMES;
          GOTO      SCCA9999
.
SCCA0120  WRITE     HTMLFILE;SICAUR1;
          GOTO      SCCA9999
.
SCCA0130  WRITE     HTMLFILE;SICAUR2;
          GOTO      SCCA9999
.
SCCA0140  MATCH     SICAUD1,SP70
          GOTO      SCCA9999 IF EQUAL
.
          UNPACK    SICAUD1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SCCA9999
.         
SCCA0150  MATCH     SICAUD2,SP70
          GOTO      SCCA9999 IF EQUAL
.
          UNPACK    SICAUD2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      SCCA9999
.
SCCA0160  MOVE      "ca1",KEY3
          PACK      KEY6,KEY3,SICAUC1,SP10
          CALL      RDSICA1
          BRANCH    OVRCD,SCCA9999
          WRITE     HTMLFILE;SICDDESC;
          GOTO      SCCA9999
.
SCCA0170  MOVE      "ca2",KEY3
          PACK      KEY6,KEY3,SICAUC2,SP10
          CALL      RDSICA1
          BRANCH    OVRCD,SCCA9999
          WRITE     HTMLFILE;SICDDESC;
          GOTO      SCCA9999
.
SCCA0180  WRITE     HTMLFILE;SICAUY1;
          GOTO      SCCA9999
.
SCCA0190  WRITE     HTMLFILE;SICAUY2;
          GOTO      SCCA9999
.
SCCA0200  WRITE     HTMLFILE;SICARID;
          GOTO      SCCA9999
.
SCCA0210  WRITE     HTMLFILE;SICAPACC;
          GOTO      SCCA9999
.
SCCA9999  RETURN
.------------------------------------------------------------
.   Set Parameters for the cost centre file
.------------------------------------------------------------
SPCCA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPCCA010,SPCCA020,SPCCA030,SPCCA040,SPCCA050:
                       SPCCA060,SPCCA070,SPCCA080,SPCCA090,SPCCA100:
                       SPCCA110,SPCCA120,SPCCA130,SPCCA140,SPCCA150:
                       SPCCA160,SPCCA170,SPCCA180,SPCCA190,SPCCA200:
                       SPCCA210
.
          MOVE      ONE,EXIT
          GOTO      SPCCA999
.
SPCCA010  MOVE      QRYDATA,SICCA001
          GOTO      SPCCA999
.
SPCCA020  MOVE      QRYDATA,SICCA002
          GOTO      SPCCA999
.
SPCCA030  MOVE      QRYDATA,SICCA003
          GOTO      SPCCA999
.
SPCCA040  MOVE      QRYDATA,SICCA004
          GOTO      SPCCA999
.
SPCCA050  MOVE      QRYDATA,SICCA005
          GOTO      SPCCA999
.
SPCCA060  MOVE      QRYDATA,SICCA006
          GOTO      SPCCA999
.
SPCCA070  MOVE      QRYDATA,SICCA007
          GOTO      SPCCA999
.
SPCCA080  MOVE      QRYDATA,SICCA008
          GOTO      SPCCA999
.
SPCCA090  MOVE      QRYDATA,SICCA009
          GOTO      SPCCA999
.
SPCCA100  MOVE      QRYDATA,SICCA010
          GOTO      SPCCA999
.
SPCCA110  MOVE      QRYDATA,SICCA011
          GOTO      SPCCA999
.
SPCCA120  MOVE      QRYDATA,SICCA012
          GOTO      SPCCA999
.
SPCCA130  MOVE      QRYDATA,SICCA013
          GOTO      SPCCA999
.
SPCCA140  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SICCA014,CCENT,CYEAR,CMON,CDAY
          GOTO      SPCCA999
.
SPCCA150  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      SICCA015,CCENT,CYEAR,CMON,CDAY
          GOTO      SPCCA999
.
SPCCA160  MOVE      QRYDATA,SICCA016
          GOTO      SPCCA999
.
SPCCA170  MOVE      QRYDATA,SICCA017
          GOTO      SPCCA999
.
SPCCA180  MOVE      QRYDATA,SICCA018
          GOTO      SPCCA999
.
SPCCA190  MOVE      QRYDATA,SICCA019
          GOTO      SPCCA999
.
SPCCA200  MOVE      QRYDATA,SICCA020
          GOTO      SPCCA999
.
SPCCA210  MOVE      QRYDATA,SICCA021
          GOTO      SPCCA999
.
SPCCA999  RETURN
.
.------------------------------------------------------------
.  Update item details file
.------------------------------------------------------------
MVSCCA00  MATCH     SICCA001,Z70
          IF        !@EQUAL
            MOVE      SICCA001,SICACODE
          ENDIF
.
          MATCH     SICCA002,Z70
          IF        !@EQUAL
            MOVE      SICCA002,SICADESC
          ENDIF
.
          MATCH     SICCA003,Z70
          IF        !@EQUAL
            MOVE      SICCA003,SICATELE
          ENDIF
.
          MATCH     SICCA004,Z70
          IF        !@EQUAL
            MOVE      SICCA004,SICACONT
          ENDIF
.
          MATCH     SICCA005,Z70
          IF        !@EQUAL
            MOVE      SICCA005,SICAGL
          ENDIF
.
          MATCH     SICCA006,Z70
          IF        !@EQUAL
            MOVE      SICCA006,SICAIMPD
          ENDIF
.
          MATCH     SICCA007,Z70
          IF        !@EQUAL
            MOVE      SICCA007,SICADAD1
          ENDIF
.
          MATCH     SICCA008,Z70
          IF        !@EQUAL
            MOVE      SICCA008,SICADAD2
          ENDIF
.
          MATCH     SICCA009,Z70
          IF        !@EQUAL
            MOVE      SICCA009,SICADAD3
          ENDIF
.
          MATCH     SICCA010,Z70
          IF        !@EQUAL
            MOVE      SICCA010,SICALOC
          ENDIF
.
          MATCH     SICCA011,Z70
          IF        !@EQUAL
            MOVE      SICCA011,SICAMES
          ENDIF
.
          MATCH     SICCA012,Z70
          IF        !@EQUAL
            MOVE      SICCA012,SICAUR1
          ENDIF
.
          MATCH     SICCA013,Z70
          IF        !@EQUAL
            MOVE      SICCA013,SICAUR2
          ENDIF
.
          MATCH     SICCA014,Z70
          IF        !@EQUAL
            MOVE      SICCA014,SICAUD1
          ENDIF
.
          MATCH     SICCA015,Z70
          IF        !@EQUAL
            MOVE      SICCA015,SICAUD2
          ENDIF
.
          MATCH     SICCA016,Z70
          IF        !@EQUAL
            MOVE      SICCA016,SICAUC1
          ENDIF
.
          MATCH     SICCA017,Z70
          IF        !@EQUAL
            MOVE      SICCA017,SICAUC2
          ENDIF
.
          MATCH     SICCA018,Z70
          IF        !@EQUAL
            MOVE      SICCA018,SICAUY1
          ENDIF
.
          MATCH     SICCA019,Z70
          IF        !@EQUAL
            MOVE      SICCA019,SICAUY2
          ENDIF
.
          MATCH     SICCA020,Z70
          IF        !@EQUAL
            MOVE      SICCA020,SICARID
          ENDIF
.
          MATCH     SICCA021,Z70
          IF        !@EQUAL
            MOVE      SICCA021,SICAPACC
          ENDIF
.
MVSCCA99  RETURN
.
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLSCCA00  MOVE      SP70,SICACODE  
          MOVE      SP70,SICADESC 
          MOVE      SP70,SICATELE
          MOVE      SP70,SICACONT        
          MOVE      SP70,SICAGL  
          MOVE      SP70,SICAIMPD  
          MOVE      SP70,SICADAD1  
          MOVE      SP70,SICADAD2  
          MOVE      SP70,SICADAD3  
          MOVE      ZERO,SICALOC  
          MOVE      SP70,SICAMES  
          MOVE      SP70,SICAUR1  
          MOVE      SP70,SICAUR2  
          MOVE      SP70,SICAUD1  
          MOVE      SP70,SICAUD2  
          MOVE      SP70,SICAUC1  
          MOVE      SP70,SICAUC2 
          MOVE      SP70,SICAUY1  
          MOVE      SP70,SICAUY2  
          MOVE      SP70,SICARID  
          MOVE      SP70,SICAPACC  
          MOVE      SP70,SICASPA  
.
CLSCCA99  RETURN
