.******************************************************************************
.*      PROGRAM NAME:   IBAOUT98                                              *
.*      FUNCTION:       SYSTEM PARAMETER MAINTENANCE                          *
.*      AUTHOR :        MALCOLM HAYSE (I.B.A)                                 *
.*      MODIFICATIONS:                                                        *
.*       V11.03.01  14/06/2023  Bella Turco       TSK 0933691                 *
.*                  Fixed misspelling of Stationary                           *
.*       V10.05.02  19/12/2014  Ebon Clements     CAR 261630                  *
.*                  Removed port number from temp file name                   *
.*       V10.05.01  29/07/2014  Steve Armstrong   CAR 294204                  *
.*                  Added new SJOG Geelong label type (HOLABLAY = 15)         *
.******************************************************************************
.*        V9.04.02  28/01/2005  Steve Armstrong  CAR 59137                    *
.*                  Mods to change OTCNA04M to OTCNA05M.                      *
.*        V9.04.01  22/09/2004  Steve Armstrong   CAR 53573                   *
.*                  Added OTCNDGCL to determine if always sending clinic      *
.*                  id in O/P broadcast messages.                             *
.******************************************************************************
.*        V9.03.02  24/06/2004  Steve Armstrong   CAR 51167                   *
.*                  Added OTCNA04M for PAS-CIS HL7 Interface                  *
.*        V9.03.01  01/07/2003  Ebon Clements CAR 40978                       *
.*                  Added OTCNCREV for converting cancelled and rescheduled   *
.*                  slots back to review slots.                               *
.******************************************************************************
.*        V9.02.03  16/11/2001  Steve Armstrong                               *
.*                  Added OTCNDGOB                                            *
.*        V9.02.02  27/09/2001  Mike Laming  2001 RCH                         *
.*                  Add an 'Interface Engine' Option to the IBA Screens       *
.*                  Menu to allow updating of Datagate Flags on 'controlf'    *
.*        V9.02.01  13/08/2001  Tonii                                         *
.*                  Added new layout 14, for St Vincent's                     *
.******************************************************************************
.*        V5.08.B01 16/04/2000  Davin                                         *
.*                  Added OTCNOTIH & OTCNOTIT for user defined invoice        *
.*                  headers/tails                                             *
.*        V5.07.03  21/12/1999  Steve Armstrong   SRF 634167                  *
.*                  Change prompt for allowing zero U/R's to not use double   *
.*                  negative.                                                 *
.*        V5.07.02  29/10/1999  Jill Habasque                                 *
.*                  Added OTCNRQDF - default code for cat RQ in EOC01         *
.*        V5.07.01  01/10/1999  Andrew Peel                                   *
.*                  Fixed IBA Screen 1 - type of rescheduling clinic          *
.*        V5.05.01  14/11/1997  Nick                                          *
.*                  Added OTCNORFL - Prompt for "Outpatient Referral" in EOC01*
.*        V5.04.05  23/02/1997  Greg Horvat                                   *
.*                  Added a label layout for WGH Consultancies                *
.*        V5.04.04  16/11/1996  Greg Horvat      SRF 617349                   *
.*                  Added a label layout for MBF                              *
.*        V5.04.03  22/10/1996  Steve Armstrong  SRF 641086  Quote 960517     *
.*                  Mods for STH App/Mailing label layouts                    *
.*        V5.04.02  12/08/1996  Greg Horvat      SRF 615571 (Rebound)         *
.*                  Fixed ? option on outpatient labels                       *
.*        V5.04.01  05/06/1996  Greg Horvat      SRF 615571                   *
.*                  Added a label layout for Joondalup                        *
.*                                                                            *
.*        V5.03.09  24/01/1996    Matt           (SUHT mods)                  *
.*                  Added OTCNGLCU - Using Global Clinic Update?              *
.*        V5.03.08  24/01/1996    Matt           (SUHT mods)                  *
.*                  Added OTCNLTPR - Printing letters from IBAOUT66.          *
.*        V5.03.07  08/01/1996    Howellsy       (SUHT mods)                  *
.*                  Added OTCNMBFR - Allow booking from Referral Program      *
.*                  16/01/1996    Matt           (SUHT mods)                  *
.*                  Added OTCNCSRF - Cat. For OUT Source of Referral.         *
.*        V5.03.06  04/01/1996  Greg Horvat                                   *
.*                  Removed the menu program, security key, IBA screen        *
.*                  password & data directory keyins & changed to use a       *
.*                  standard keyin for the IBA screen security password       *
.*        V5.03.05  21/11/1995    Justin Coates  (SUHT mods)                  *
.*                  Added OTCNURDS,OTCNUBKT,OTCNSRBU (IBA Screen 4)           *
.*        V5.03.04  20/10/1995    Justin Coates  (SUHT mods)                  *
.*                  Added OTCNURVS,OTCNOVBK,OTCNXTSF,OTCNNCOC  (IBA Screen 4) *
.*        V5.03.03  21/08/1995  MATT          SRF 611297                      *
.*                  Fixed keyin position for reapp Source of Referral         *
.*        V5.03.02  05/06/1995  Max White     SRF 441306 / Quote 440068       *
.*                  Added OTCNCTAR - Clear transport alloc. in reappointments?*
.*        V5.03.01  04/01/1995  Max White     SRF 440959                      *
.*                  Added OTCNCCON - Using OCACCONS for CMDS Consultant Code? *
.******************************************************************************
+
          INC       STD001FD
          INC       STDHLPDF
          INC       IBACONFD/INC
          INC       IBASEQFD/INC
          INC       IBATMHFD/INC
          INC       OUTCONFD/INC
          INC       PATCONFD/INC
          INC       PATCODFD/INC
          INC       TFILEVAR/INC
          INC       WEBERRFD/INC
.
ADESC     DIM       20
ANDESC    DIM       20
APTLABEL  DIM       20
FAMPTLBL  DIM       20
FORMATOP  DIM       20
.
BOXHDR    DIM       80
CMDLINE   DIM       80
.
DSRBUD    DIM       13
DSRBU0    INIT      "No,  warning "
DSRBU1    INIT      "Yes, HITENTER"
DSRBU2    INIT      "Yes, prompt  "
.
CASE0     INIT      "Set case notes on input attendees"
CASE1     INIT      "Do not set case notes            "
CASETYPE  DIM       33
CATRQ     INIT      "RQ"
.
CODE      DIM       2
CODECB    INIT      "CB"            * Cancelled session reason
CODECL    INIT      "CL"            * Compensation/Claim Type code
CODECS    INIT      "CS"            * Source code
CODECV    INIT      "CV"            * Visit Type code
CODEU1    INIT      "U1"            * User Defined Code 1
CODEO1    INIT      "O1"            * O/P User Defined Code 1
CODEO2    INIT      "O2"            * O/P User Defined Code 2
CODEO3    INIT      "O3"            * O/P User Defined Code 3
CODEO4    INIT      "O4"            * O/P User Defined Code 4
CODES     INIT      "S "            * Source code
COL       FORM      2
COMDESC1  INIT      "Wordprocessor"
COMDESC2  INIT      "Free Format  "
COUNT     FORM      2
.
DANS1     DIM       3
DANS2     DIM       3
DANS3     DIM       3
DANS4     DIM       3
DANS5     DIM       3
DANS6     DIM       3
DANS7     DIM       3
DANS8     DIM       3
DANS9     DIM       3
DANS10    DIM       3
DANS11    DIM       3
DANS12    DIM       3
DANS13    DIM       3
DANS14    DIM       3
DANS15    DIM       3
DANS16    DIM       3
DANS17    DIM       3
DANS18    DIM       3
DANS19    DIM       3
DANS20    DIM       3
DANS71    DIM       3                                                  *I-90202
DANS72    DIM       3                                                  *I-90202
DANS73    DIM       3                                                  *I-90202
DANS74    DIM       3                                                  *I-90202
DANS75    DIM       3                                                  *I-90202
DANS76    DIM       3                                                  *I-90202
DANS77    DIM       3
DANSX     DIM       3
DBOOKSCR  DIM       20
DBOOKSC0  INIT      "One Screen          "
DBOOKSC1  INIT      "Two Screens         "
DCOMDESC  DIM       13
DDIAG     DIM       20
DDIAG0    INIT      "Free Format         "
DDIAG1    INIT      "MBS                 "
DDIAG2    INIT      "ICD9                "
DESCO1    DIM       20
DESCO2    DIM       20
DESCO3    DIM       20
DESCO4    DIM       20
DESCAAE   DIM       20
DESCDCS   DIM       20
DESCREA   DIM       20
DESCRVC   DIM       20
DFEESI    DIM       15
DFEESI0   INIT      "Misc group code"
DFEESI1   INIT      "Clinic id      "
DFTYPE    DIM       8
DFTYPE0   INIT      "PATNIPA1"
DFTYPE1   INIT      "OUTBCHA1"
DHOS0     INIT      "Unknown                     "
DHOS1     INIT      "Modbury                     "
DHOS2     INIT      "St.Andrews Rockhampton      "
DHOS3     INIT      "Wellington                  "
DHOS4     INIT      "New Zealand                 "
DHOS5     INIT      "Whakatane                   "
DHOS6     INIT      "Hong Kong                   "
DHOS7     INIT      "Bay of Plenty               "
DHOS8     INIT      "Dudley                      "
DHOS9     INIT      "Hawkes Bay                  "
SOUTHERN  INIT      "Southern                    "
TARANAKI  INIT      "Taranaki                    "
DHOS11    INIT      "Greenslopes                 "
DHOS12    INIT      "Joondalup                   "
DHOS13    INIT      "MBF                         "
DHOS14    INIT      "WGH Consultancies           "
DHOS15    INIT      "St Vincent's Hospital       "
DHOS16    INIT      "SJOG Geelong                "
DHOS20    INIT      "Full Given Names"
DHOS21    INIT      "Initials Only   "
DHOS25    INIT      "Do Not Display    "
DHOS26    INIT      "Login Description "
DHOS27    INIT      "User Defined Field"
DIM3      DIM       3
DIM3A     DIM       3
DIM3B     DIM       3
DIM3C     DIM       3
DIM5      DIM       5
DIM7      DIM       7
DIM9      DIM       9 
DIM9A     DIM       9 
DIM9B     DIM       9 
DIM16     DIM       16
DIM40     DIM       40
DIM40A    DIM       40
DIM40B    DIM       40
DLABLAY   DIM       30
DLSIZE    DIM       30
DLSIZE1   INIT      "Small (37 Char Separation)  "
DLSIZE2   INIT      "Wide  (42 Char Separation)  "
DR49A     DIM       20
DR49A0    INIT      "Standard"
DR49A1    INIT      "Dudley"
DRESCH    DIM       20
DRESCH0   INIT      "Modbury    "
DRESCH1   INIT      "Wellington "
DRESCH2   INIT      "Southampton"
.
FIELD     FORM      2
FORM2A    FORM      2
FORM8     FORM      8
.
.
LAYOUT    DIM       20
LAYTYP1   INIT      "Modbury"
LAYTYP2   INIT      "User Defined"
.
OPTION2   FORM      2
PASS      DIM       8
.
QUOTE101  DIM       3         * value for quote screen 1, field 1
QUOTE102  DIM       3         * value for quote screen 1, field 2
QUOTE103  DIM       3         * value for quote screen 1, field 3
QUOTE104  DIM       3         * value for quote screen 1, field 4
QUOTE105  DIM       3         * value for quote screen 1, field 5
QUOTE106  DIM       3         * value for quote screen 1, field 6
QUOTE107  DIM       3         * value for quote screen 1, field 7
QUOTE108  DIM       3         * value for quote screen 1, field 8
QUOTE109  DIM       3         * value for quote screen 1, field 9
QUOTE110  DIM       3         * value for quote screen 1, field 10
QUOTE111  DIM       3         * value for quote screen 1, field 11
QUOTE112  DIM       3         * value for quote screen 1, field 12
QUOTE113  DIM       3         * value for quote screen 1, field 13
QUOTE114  DIM       3         * value for quote screen 1, field 14
QUOTE115  DIM       3         * value for quote screen 1, field 15
QUOTE116  DIM       3         * value for quote screen 1, field 16
.
REPFLAG   FORM      1         * 1 = means entered security code
RHB1      INIT      "Bill for standard rate per day"
RHB2      INIT      "Bill for every visit per day"
RQDFDESC  DIM       30
.
SAVVERT   FORM      3
SDESC     DIM       20
SP40      INIT      "                                        "
.
TRDESC    DIM       20
.
VERT      FORM      2
TMPCODE1  IFILE     SQL, FIXED=39, KEY="U1-8"
TMPCODE2  IFILE     SQL, FIXED=39, KEY="U9-38,1-8"
TEMPCODE  DIM       8
TEMPDESC  DIM       30
TEMPNAME  DIM       8
TEMPINDX  INIT      " 39 U1-8 U9-38,1-8"
.
PRGID     INIT      "IBAOUT98"
PRGNAM    INIT      "Outpatients Parameter Maintenance"
VERSION   INIT      "V12.00.00"
.
.*********************************************************************
.                   ML0000
.         MAINLINE CODE
.*********************************************************************
ML0000    CALL      INIT0000
.
ML0500    CALL      MENU0000
          BRANCH    EXIT,ML9999
          BRANCH    OPTION,ML1000,ML2000,ML3000,ML4000,ML5000,ML6000
.
ML1000    CALL      DISPAUD                 * audit screen
          MOVE      ONE,OVRCD
          CALL      UPAUD
          BRANCH    OVRCD,ML0500
          CALL      WRAUD
          GOTO      ML0500
.
ML2000    CALL      USRA0000                * Hosp screen 1
          GOTO      ML0500
.
ML3000    CALL      USRB0000                * Hosp screen 2
          GOTO      ML0500
.
ML4000    CALL      USRC0000                * Hosp screen 3
          GOTO      ML0500
.
ML5000    CALL      USRD0000                * hosp screen 4
          GOTO      ML0500
.    
.         IBA screens
.
ML6000    CALL      IBASECUR                * Keyin IBA screen security passwd
          BRANCH    EXIT,ML0500
.
          CALL      PIBA0000
          GOTO      ML0500
.
ML9999    CHAIN     PGM
+
.*********************************************************************
.                   INIT0000
.         Initialization
.*********************************************************************
INIT0000  CALL      DISPHEAD
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P64:24,"ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          MOVE      ZERO,REPFLAG
.
          CALL      TFILENAM * Get temp file name in create
          MOVE      TFILNAME,TEMPNAME
.
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          MOVE      "13",HTOP
          MOVE      "23",HBOT
          PACK      BOXHDR,SP30,SP30,SP30
.
INIT9999  RETURN
+
.*********************************************************************
.*                  MENU0000                    Called by : ML0500   *
.*        Display the available options                              *
.*********************************************************************
MENU0000  HLINE     *G37,2,57,80
          MOVE      ZERO,REPFLAG
          DISPLAY   *P1:3,*EF,*V2LON:
                    *P1:4,"0",*P1:5,"1",*P1:6,"2",*P1:7,"3",*P1:8,"4",*P1:9,"5":
                    *P1:10,"6":
                    *HOFF,*P2:4,". Exit":
                    *P2:5,". Audits":
                    *P2:6,". User Controlled Screen 1":
                    *P2:7,". User Controlled Screen 2":
                    *P2:8,". User Controlled Screen 3":
                    *P2:9,". User Controlled Screen 4":
                    *P2:10,". IBA screens":
                    *P1:12,"Select option : "
.
MENU1000  KEYIN     *P17:12,*DV,UNDLN2:
                    *P17:12,*V2LON,OPTION:
                    *P17:12,*DV,OPTION
.
          COMPARE   ZERO,OPTION
          GOTO      MENU9100 IF EQUAL       * exit
.
          BRANCH    OPTION,MENU9000,MENU9000,MENU9000,MENU9000,MENU9000,MENU9000
.
          BEEP
          GOTO      MENU1000
.
MENU9000  MOVE      ZERO,EXIT
          GOTO      MENU9999
.
MENU9100  MOVE      ONE,EXIT
          CALL      KILL0000
.
MENU9999  RETURN
+
.*********************************************************************
.         display AUDIT screen
.*********************************************************************
DISPAUD   READ      CONTROLF,THIRTY1;*51,HOAUDA,HOAUDB,HOAUDC,HOAUDD,HOAUDE:
                                         HOAUDF,HOAUDG,HOAUDH,HOAUDI,HOAUDJ:
                                         HOAUDK,HOAUDL,HOAUDM,HOAUDN,HOAUDO:
                                         HOAUDP,HOAUDQ,HOAUDR,HOAUDS,HOAUDT:
                                         HOAUDU,HOAUDV,HOAUDW,HOAUDX,HOAUDY:
                                         HOAUDZ
          DISPLAY   *P1:3,*EF:
                    *P1:4," 1. O/P Bookings       :":
                    *P1:5," 2. O/P Booking Details:":
                    *P1:6," 3. Audit C (Not Used) :":
                    *P1:7," 4. Audit D (Not used) :":
                    *P1:8," 5. Audit E (Not used) :":
                    *P1:9," 6. Audit F (Not used) :":
                    *P1:10," 7. Audit G (Not used) :":
                    *P1:11," 8. Audit H (Not used) :":
                    *P1:12," 9. O/P Clinic ID's    :":
                    *P1:13,"10. Audit J (Not used) :":
                    *P1:14,"11. Audit K (Not used) :":
                    *P1:15,"12. Audit L (Not used) :":
                    *P1:16,"13. O/P Clinic Master  :":
                    *P41:4,"14. O/P Non-Attendees  :":
                    *P41:5,"15. Audit O (Not Used) :":
                    *P41:6,"16. O/P Public Holiday :":
                    *P41:7,"17. Audit Q (Not used) :":
                    *P41:8,"18. Audit R (Not used) :":
                    *P41:9,"19. Audit S (Not used) :":
                    *P41:10,"20. O/P Clinic Types   :":
                    *P41:11,"21. Audit U (Not used) :":
                    *P41:12,"22. Audit V (Not used) :":
                    *P41:13,"23. Audit W (Not used) :":
                    *P41:14,"24. Extra Screen Detail:":
                    *P41:15,"25. Audit Y (Not used) :":
                    *P41:16,"26. Audit Z (Not used) :"
.
          MOVE      ZERO,FORM2
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
.
AUDLOOP1  ADD       ONE,FORM2
          ADD       ONE,CVERT
          COMPARE   "27",FORM2
          RETURN    IF EQUAL
.
          COMPARE   "17",CVERT
          GOTO      AUDPRNT1 IF LESS
.
          MOVE      FOUR,CVERT
          MOVE      "66",CCOL
.
AUDPRNT1  LOAD      FIELD,FORM2,HOAUDA,HOAUDB,HOAUDC,HOAUDD,HOAUDE:
                                HOAUDF,HOAUDG,HOAUDH,HOAUDI,HOAUDJ:
                                HOAUDK,HOAUDL,HOAUDM,HOAUDN,HOAUDO:
                                HOAUDP,HOAUDQ,HOAUDR,HOAUDS,HOAUDT:
                                HOAUDU,HOAUDV,HOAUDW,HOAUDX,HOAUDY,HOAUDZ
          MOVE      DYES,DANSX
          LOAD      DANSX,FIELD,DNO
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX;
          GOTO      AUDLOOP1
.
UPAUD     CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANCEL IF LESS
.
          MOVE      CCITEM,FIELD
          COMPARE   TWENTY7,FIELD
          GOTO      EKAUD IF NOT LESS
.
          MOVE      THREE,CVERT
          MOVE      TWENTY6,CCOL
          ADD       FIELD,CVERT
          COMPARE   TEN7,CVERT
          GOTO      KAUDUP IF LESS
.
          MOVE      "66",CCOL
          SUB       "13",CVERT
.
KAUDUP    KEYIN     *PCCOL:CVERT,*DV,UNDLN3,*PCCOL:CVERT,*V2LON,ANS;
          CMATCH    ANSY,ANS
          GOTO      KAUDYES IF EQUAL
          GOTO      KAUDNO
EKAUD     BEEP
          GOTO      UPAUD
.
KAUDYES   MOVE      DYES,DANSX
          MOVE      ZERO,FORM1
          GOTO      KCHGAUD
.
KAUDNO    MOVE      DNO,DANSX
          MOVE      ONE,FORM1
.
KCHGAUD   STORE     FORM1,FIELD,HOAUDA,HOAUDB,HOAUDC,HOAUDD,HOAUDE:
                                HOAUDF,HOAUDG,HOAUDH,HOAUDI,HOAUDJ:
                                HOAUDK,HOAUDL,HOAUDM,HOAUDN,HOAUDO:
                                HOAUDP,HOAUDQ,HOAUDR,HOAUDS,HOAUDT:
                                HOAUDU,HOAUDV,HOAUDW,HOAUDX,HOAUDY,HOAUDZ
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX
          MOVE      ZERO,OVRCD
          GOTO      UPAUD
.
.*********************************************************************
.*                  USRA0000                    Called by : ML2000   *
.*        Process Hospital screen 1                                  *
.*********************************************************************
USRA0000  CALL      DISPUSR1                * hosp screen 1
          CALL      UPUSR1
          BRANCH    OVRCD,USRA9999
          CALL      WRUSR1
USRA9999  RETURN
+
.*********************************************************************
.*                  USRB0000                    Called by : ML3000   *
.*        Process Hospital screen 2                                  *
.*********************************************************************
USRB0000  CALL      DISPUSR2                * hosp screen 2
          CALL      UPUSR2
          BRANCH    OVRCD,USRB9999
          CALL      WRUSR2
USRB9999  RETURN
+
.*********************************************************************
.*                  USRC0000                    Called by : ML4000   *
.*        Process Hospital screen 3                                  *
.*********************************************************************
USRC0000  CALL      DISPUSR3                * hosp screen 3
          CALL      UPUSR3
          BRANCH    OVRCD,USRC9999
          CALL      WRUSR3
USRC9999  RETURN
+
.*********************************************************************
.*                  USRD0000                    Called by : ML5000   *
.*        Process Hospital screen 4                                  *
.*********************************************************************
USRD0000  CALL      DISPUSR4                * hosp screen 3
          CALL      UPUSR4
          BRANCH    OVRCD,USRD9999
          CALL      WRUSR4
USRD9999  RETURN
+
.*********************************************************************
.*                  PIBA0000                    Called by : ML3000   *
.*        Controls all inputs for IBA controlled screens             *
.*********************************************************************
PIBA0000  HLINE     *G37,2,57,80
          DISPLAY   *P57:2,*V2LON,"- IBA screens ",*P1:3,*EF,*V2LON:
                    *P1:4,"0",*P1:5,"1",*P1:6,"2",*P1:7,"3",*P1:8,"4":
                    *P1:9,"5",*P1:10,"6",*P1:11,"7",*HOFF:             *C-90202
                    *P2:04,". Exit":
                    *P2:05,". Screen 1":
                    *P2:06,". Screen 2":
                    *P2:07,". Screen 3":
                    *P2:08,". Screen 4":
                    *P2:09,". Special Screen 1":
                    *P2:10,". Special Screen 2":
                    *P2:11,". Interface Engine Set Up":                *I-90202
                    *P1:13,"Select option : "                          *C-90202
.
PIBA0500  KEYIN     *P17:13,*V2LON,OPTION2:                            *C-90202
                    *P17:13,*DV,OPTION2                                *C-90202
.
          COMPARE   ZERO,OPTION2
          GOTO      PIBA9999 IF EQUAL
.
          BRANCH    OPTION2,PIBA1000,PIBA2000,PIBA3000,PIBA4000,PIBA5000:
                            PIBA6000,PIBA7000                          *C-90202
.
          BEEP
          GOTO      PIBA0500
.
PIBA1000  CALL      DISPIBA1                * screen 1
          CALL      UPIBA1
          BRANCH    OVRCD,PIBA0000
          CALL      WRIBA1
          GOTO      PIBA0000
.
PIBA2000  CALL      DIBB0000                * screen 2
          CALL      UIBB0000
          BRANCH    OVRCD,PIBA0000
          CALL      WIBB0000
          GOTO      PIBA0000
.
PIBA3000  CALL      DIBC0000                * screen 3
          CALL      UIBC0000
          BRANCH    OVRCD,PIBA0000
          CALL      WIBC0000
          GOTO      PIBA0000
.
PIBA4000  CALL      DIBD0000                * screen 4
          CALL      UIBD0000
          BRANCH    OVRCD,PIBA0000
          CALL      WIBD0000
          GOTO      PIBA0000
.
PIBA5000  CALL      DISPQTE1                * display quote screen 1
          CALL      UPIBAQ1                 * update the values
          BRANCH    OVRCD,PIBA0000          * no updates made
          CALL      WRIBAQ1                 * write new information
          GOTO      PIBA0000                * go back to menu
.
PIBA6000  CALL      DISPQTE2                * display quote screen 1
          CALL      UPIBAQ2                 * update the values
          BRANCH    OVRCD,PIBA0000          * no updates made
          CALL      WRIBAQ2                 * write new information
          GOTO      PIBA0000                * go back to menu
.
PIBA7000  CALL      GIBA0000                * display quote screen 1
          GOTO      PIBA0000                * go back to menu
.
PIBA9999  RETURN
+
.*****************************************************************************
.*                        GIBA0000                 Called by: PIBA0000       *
.*             Display the Interface Engine menu                             *
.*****************************************************************************
.
GIBA0000  HLINE     *G37,2,57,80
          DISPLAY   *P57:2,*V2LON,"- Interface Engine ":
                    *P1:3,*EF:
                    *P1:4,*V2LON,"0",*HOFF,". Exit":
                    *P1:5,*V2LON,"1",*HOFF,". Broadcast - ":
                                 "Transmissions To other Systems":
                    *P1:6,*V2LON,"2",*HOFF,". Broadcast - PAS to CIS":
                    *P1:8,"Select option :"
.
GIBA0500  KEYIN     *P17:8,*V2LON,OPTION2:
                    *P17:8,*DV,OPTION2
.
          COMPARE   ZERO,OPTION2
          GOTO      GIBA9999 IF EQUAL
.
          BRANCH    OPTION2,GIBA1000,GIBA2000
.
          BEEP
          GOTO      GIBA0500
.
GIBA1000  CALL      IDGP0000                * display screen 1
          CALL      UDGP0000                * update the values
          BRANCH    OVRCD,GIBA0000          * no updates made
          CALL      WDGP0000                * write new information
          GOTO      GIBA0000                * go back to menu
.
GIBA2000  CALL      ICIS0000                * display screen 1
          CALL      UCIS0000                * update the values
          BRANCH    OVRCD,GIBA0000          * no updates made
          CALL      WCIS0000                * write new information
          GOTO      GIBA0000                * go back to menu
.
GIBA9999  RETURN
+
.------------------------------------------------------------------------------
.          USER SCREEN1
.------------------------------------------------------------------------------
.
DISPUSR1  READ      CONTROLF,THIRTY1;*89,HOLPAGE,HOLPRNT,HOLSIZE,HOPMR3:
                                     HORVCODE,HOAAESCD,HOLABLAY,*117,HOSRCM:
                                     HOSREAP,*134,HWORDPRO,HOVIEWCM:
                                     *138,HOMR3L,HOMR3COD,*147,OTCNCASE:
                                     HOLABBOK,*214,OTCNPSTC,OTCNNDAY
          READ      CONTROLF,THIRTY2;*37,OTCNFAML,OTCNOPCR
.
          MOVE      SP20,DESCRVC
          MATCH     SP3,HORVCODE
          GOTO      DU1A IF EQUAL
.
          PACK      KEY5,CODECV,HORVCODE
          CALL      RDCODE1
          BRANCH    OVRCD,DU1A
.
          MOVE      TDESC,DESCRVC
.
DU1A      MOVE      SP20,DESCAAE
          MATCH     SP3,HOAAESCD
          GOTO      DU1B IF EQUAL
.
          PACK      KEY5,CODES,HOAAESCD
          CALL      RDCODE1
          BRANCH    OVRCD,DU1B
.
          MOVE      TDESC,DESCAAE
.
DU1B      MOVE      SP20,DESCREA
          MATCH     SP3,HOSREAP
          GOTO      DU1C IF EQUAL
.
          PACK      KEY5,CODES,HOSREAP
          CALL      RDCODE1
          BRANCH    OVRCD,DU1C
.
          MOVE      TDESC,DESCREA
.
DU1C      MOVE      DNO,DANS1
          LOAD      DANS1,HOSRCM,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,HOPMR3,DYES,DNO
.
          LOAD      DLSIZE,HOLSIZE,DLSIZE1,DLSIZE2
.
          MOVE      DHOS0,DLABLAY
          LOAD      DLABLAY,HOLABLAY,DHOS1,DHOS2,DHOS3,DHOS4,DHOS5,DHOS6:
                                     DHOS8,DHOS9,TARANAKI,DHOS11,DHOS12:
                                     DHOS13,DHOS14,DHOS15,DHOS16
.
          MOVE      SP20,DCOMDESC
          LOAD      DCOMDESC,HWORDPRO,COMDESC1,COMDESC2
.
          MOVE      DNO,DANS2
          LOAD      DANS2,HOVIEWCM,DYES,DNO
.
          MOVE      LAYTYP1,LAYOUT
          LOAD      LAYOUT,HOMR3L,LAYTYP2
.
          MOVE      CASE0,CASETYPE
          LOAD      CASETYPE,OTCNCASE,CASE1
.
          MOVE      DNO,DANS4
          LOAD      DANS4,HOLABBOK,DYES,DNO
.
          MOVE      DHOS20,FAMPTLBL
          LOAD      FAMPTLBL,OTCNFAML,DHOS21
.
          MOVE      DHOS25,FORMATOP
          LOAD      FORMATOP,OTCNOPCR,DHOS26,DHOS27
.
.
.------------------------------------------------------------------------------
.         Display user screen 1
.------------------------------------------------------------------------------
.
DISPUS1X  DISPLAY   *P57:2,*V2LON,"- User Screen 1 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. No.of Labels across page          :":
                    *P1:5," 2. Default no.of Labels to print     :":
                    *P1:6," 3. Label Size                        :":
                    *P1:7," 4. Layout of Label                   :":
                    *P1:8," 5. Using MR-3 Forms ?                :":
                    *P1:9," 6. Default Visit Type                :":
                    *P1:10," 7. A & E Attendance Source Code      :":
                    *P1:11," 8. Source of Referral Mandatory (Y/N):":
                    *P1:12," 9. Re-appointment Source of Referral :":
                    *P1:13,"10. Comments for IBAOUT66             :":
                    *P1:14,"11. Disp Comments in View a Clinic ?  :":
                    *P1:15,"12. MR3 Layout                        :":
                    *P1:16,"13. User Defined Stationery Code (MR3):":
                    *P1:17,"14. Setting of case notes indicator   :":
                    *P1:18,"15. Print Labels/Id Sheets in Bookings:":
                    *P1:19,"16. Appointment Mailing Label Format  :":
                    *P1:20,"17. Operator Id for Canc/Resch Visits :"
          MOVE         "20",CVERT
          MOVE         "17",FORM2
          IF           OTCNPSTC = 1
            ADD          ONE,CVERT
            ADD          ONE,FORM2
            DISPLAY      *P1:CVERT,FORM2,". No. Days cutoff for 1-2 class post:" 
          ENDIF
        
          DISPLAY      *P43:4,*V2LON,HOLPAGE:
                    *P41:5,HOLPRNT:
                    *P43:6,HOLSIZE,*P47:6,DLSIZE:
                    *P42:7,HOLABLAY,*P47:7,DLABLAY:
                    *P41:8,DANS3:
                    *P41:9,HORVCODE,*P47:9,DESCRVC:
                    *P41:10,HOAAESCD,*P47:10,DESCAAE:
                    *P41:11,DANS1:
                    *P41:12,HOSREAP,*P47:12,DESCREA:
                    *P41:13,HWORDPRO,*P47:13,DCOMDESC:
                    *P41:14,DANS2:
                    *P41:15,HOMR3L,*P47:15,LAYOUT:
                    *P41:16,HOMR3COD:
                    *P41:17,OTCNCASE,*P47:17,CASETYPE:
                    *P41:18,DANS4:
                    *P41:19,FAMPTLBL:
                    *P41:20,FORMATOP
          MOVE         "20",CVERT
          IF           OTCNPSTC = 1
            ADD          ONE,CVERT
            DISPLAY      *P41:CVERT,*V2LON,OTCNNDAY
          ENDIF
.
          RETURN
.
.------------------------------------------------------------------------------
.         Select Field
.------------------------------------------------------------------------------
.
UPUSR1    CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,KUSR11,KUSR12,KUSR13,KUSR14,KUSR15:
                           KUSR16,KUSR17,KUSR18,KUSR19,KUSR110:
                           KUSR111,KUSR112,KUSR113,KUSR114,KUSR115:
                           KUSR116,KUSR118
.
          IF        CCITEM > FORM2
            BEEP   
            GOTO      UPUSR1
          ENDIF
          MOVE      ZERO,COUNT
          SUB       TEN7,CCITEM
          MOVE      ZERO,FORM2A
.
UPUSR10   ADD       ONE,COUNT
          LOAD      FORM1,COUNT,OTCNPSTC
          ADD       FORM1,FORM2A
          IF        FORM2A = CCITEM
            MOVE      TWENTY1,CVERT
            BRANCH    COUNT,KUSR117
            BEEP   
            GOTO      UPUSR1
          ENDIF
          GOTO      UPUSR10
.
.------------------------------------------------------------------------------
.         No.of labels across a page
.------------------------------------------------------------------------------
.
KUSR11    KEYIN     *P43:4,*EL,*V2LON,HOLPAGE
          COMPARE   FOUR,HOLPAGE
          GOTO      EKUSR11 IF NOT LESS
          DISPLAY   *P43:4,*EL,*V2LON,HOLPAGE
          GOTO      UPUSR1
.
EKUSR11   DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "** Invalid Number of Labels ** ";
          CALL      HITENTER
          DISPLAY   *P41:24,*EL;
          GOTO      KUSR11
.
.------------------------------------------------------------------------------
.         Default no.of labels to print
.------------------------------------------------------------------------------
.
KUSR12    KEYIN     *P41:5,*EL,*V2LON,HOLPRNT
          DISPLAY   *P41:5,*EL,*V2LON,HOLPRNT
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Size of Labels
.------------------------------------------------------------------------------
.
KUSR13    DISPLAY   *P1:24,*EL,*V2LON,ONE,*HOFF:
                    " = ",DLSIZE1,*V2LON,TWO,*HOFF," = ",DLSIZE2
.
          KEYIN     *P43:6,*EL,*V2LON,HOLSIZE,*P1:24,*EL;
          BRANCH    HOLSIZE,OKUSR13,OKUSR13
          BEEP
          GOTO      KUSR13
.
OKUSR13   LOAD      DLSIZE,HOLSIZE,DLSIZE1,DLSIZE2
          DISPLAY   *P47:6,*V2LON,DLSIZE
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Layout type for labels
.------------------------------------------------------------------------------
.
KUSR14    KEYIN     *P42:7,*EL,*V2LON,*JR,DIM2:
                    *P42:7,*DV,DIM2
          MATCH     " ?",DIM2
          GOTO      KUSR14Q IF EQUAL
          TYPE      DIM2
          GOTO      KUSR14B IF EQUAL
KUSR14A   BEEP
          GOTO      KUSR14
.
KUSR14B   MOVE      DIM2,HOLABLAY
          COMPARE   SEVEN,HOLABLAY
          GOTO      KUSR14B1 IF NOT EQUAL
.
KUSR14B1  BRANCH    HOLABLAY,KUSR14C,KUSR14C,KUSR14C,KUSR14C,KUSR14C:
                             KUSR14C,KUSR14C,KUSR14C,KUSR14C,KUSR14C:
                             KUSR14C,KUSR14C,KUSR14C,KUSR14C,KUSR14C
          GOTO      KUSR14A
.
KUSR14C   LOAD      DLABLAY,HOLABLAY,DHOS1,DHOS2,DHOS3,DHOS4,DHOS5,DHOS6:
                                     DHOS8,DHOS9,TARANAKI,DHOS11,DHOS12:
                                     DHOS13,DHOS14,DHOS15,DHOS16
          DISPLAY   *P47:7,*V2LON,DLABLAY
          GOTO      UPUSR1
.
KUSR14Q   DISPLAY   *P1:3,*EF:
                    *P20:3,*V2LON,*ULON," Label Layouts for Hospitals ",*HOFF:
                    *P2:5,*V2LON,"1",*HOFF," = ",DHOS1:
                    *P2:6,*V2LON,"2",*HOFF," = ",DHOS2:
                    *P2:7,*V2LON,"3",*HOFF," = ",DHOS3:
                    *P2:8,*V2LON,"4",*HOFF," = ",DHOS4:
                    *P2:9,*V2LON,"5",*HOFF," = ",DHOS5:
                    *P2:10,*V2LON,"6",*HOFF," = ",DHOS6:
                    *P2:11,*V2LON,"7",*HOFF," = ",DHOS8:
                    *P2:12,*V2LON,"8",*HOFF," = ",DHOS9:
                    *P2:13,*V2LON,"9",*HOFF," = ",TARANAKI:
                    *P1:14,*V2LON,"10",*HOFF," = ",DHOS11:
                    *P1:15,*V2LON,"11",*HOFF," = ",DHOS12:
                    *P1:16,*V2LON,"12",*HOFF," = ",DHOS13:
                    *P1:17,*V2LON,"13",*HOFF," = ",DHOS14: 
                    *P1:18,*V2LON,"14",*HOFF," = ",DHOS15: 
                    *P1:19,*V2LON,"15",*HOFF," = ",DHOS16: 
                    *P1:24,*EL;
          CALL      HITENTER
          CALL      DISPUS1X
          GOTO      KUSR14
.
.------------------------------------------------------------------------------
.          Using MR3 ?
.------------------------------------------------------------------------------
.
KUSR15    KEYIN     *P41:8,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR15Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR15N IF EQUAL
          BEEP
          GOTO      KUSR15
.
KUSR15Y   MOVE      ONE,HOPMR3
          GOTO      KUSR15DS
.
KUSR15N   MOVE      TWO,HOPMR3
.
KUSR15DS  LOAD      DANSX,HOPMR3,DYES,DNO
          DISPLAY   *P41:8,*EL,*V2LON,DANSX
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Default visit type
.------------------------------------------------------------------------------
KUSR16    MOVE      NINE,EVERT
          MOVE      "41",ECOL
          MOVE      CODECV,CODE
          MOVE      HORVCODE,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,HORVCODE
          BRANCH    EXIT,UPUSR1:
                         CANCEL
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         A & E attendance source code
.------------------------------------------------------------------------------
KUSR17    MOVE      TEN,EVERT
          MOVE      "41",ECOL
          MOVE      CODES,CODE
          MOVE      HOAAESCD,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,HOAAESCD
          BRANCH    EXIT,UPUSR1:
                         CANCEL
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Source of Referral Mandatory ?
.------------------------------------------------------------------------------
KUSR18    MOVE      "11",CVERT
          MOVE      "41",CCOL
          CALL      KYN0000
          MOVE      EXIT,HOSRCM
          MOVE      DANS1,DANSX
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Re-appointments source of referral
.------------------------------------------------------------------------------
KUSR19    MOVE      TEN2,EVERT
          MOVE      "41",CCOL
          MOVE      "41",ECOL
          MOVE      CODES,CODE
          MOVE      HOSREAP,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,HOSREAP
          BRANCH    EXIT,UPUSR1:
                         CANCEL
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Comments - Wordprocessor or Free Format
.------------------------------------------------------------------------------
.
KUSR110   DISPLAY   *P1:24,*V2LON,ONE,*HOFF," = ",COMDESC1,SP1:
                    *V2LON,TWO,*HOFF," = ",COMDESC2;
KUSR110A  KEYIN     *P41:13,*V2LON,*EL,HWORDPRO;
          BRANCH    HWORDPRO,KUSR110Z,KUSR110Z
          BEEP
          GOTO      KUSR110A
KUSR110Z  MOVE      SP20,DCOMDESC
          LOAD      DCOMDESC,HWORDPRO,COMDESC1,COMDESC2
          DISPLAY   *P1:24,*EL,*P47:13,*V2LON,DCOMDESC;
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Source of Referral Mandatory ?
.------------------------------------------------------------------------------
KUSR111   MOVE      "41",CCOL
          MOVE      "14",CVERT
          CALL      KYN0000
          MOVE      EXIT,HOVIEWCM
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         MR3 Layout
.------------------------------------------------------------------------------
.
KUSR112   MOVE      ZERO,HOMR3L
          MOVE      SP20,LAYOUT
          DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Modbury, ",*V2LON,ONE:
                           *HOFF," = User Defined";
          DISPLAY   *P41:15,*EL,UNDLN1;
          KEYIN     *P41:15,*V2LON,*RV,HOMR3L;
          DISPLAY   *P41:15,*V2LON,HOMR3L;
.
          COMPARE   ZERO,HOMR3L
          GOTO      KUSR112Y IF EQUAL
.
          BRANCH    HOMR3L,KUSR112Y
.
          BEEP
          GOTO      KUSR112
.
KUSR112Y  MOVE      LAYTYP1,LAYOUT
          LOAD      LAYOUT,HOMR3L,LAYTYP2
          DISPLAY   *P47:15,*V2LON,LAYOUT;
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         User Defined Stationary Code
.------------------------------------------------------------------------------
.
KUSR113   MOVE      SP6,HOMR3COD
          DISPLAY   *P41:16,*EL,UNDLN6;
          KEYIN     *P41:16,*V2LON,*RV,HOMR3COD;
          DISPLAY   *P41:16,*V2LON,HOMR3COD;
.
          ENDSET    HOMR3COD
          APPEND    SP6,HOMR3COD
          RESET     HOMR3COD
.
          MATCH     SP6,HOMR3COD
          GOTO      KUSR113Y IF EQUAL
.
          MOVE      HOMR3COD,KEY6
          CALL      RDIBTH1
          BRANCH    OVRCD,KUSR113N
.
          COMPARE   ONE,IBTHSTFM
          GOTO      KUSR113Y IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,"Stationery is an invalid type - Hit <":
                           *V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          GOTO      KUSR113
.
KUSR113Y  MOVE      ZERO,OVRCD
          GOTO      UPUSR1
.
KUSR113N  DISPLAY   *P1:24,*EL,*B,"Stationery Code not on file - Hit <":
                           *V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          GOTO      KUSR113
.
.------------------------------------------------------------------------------
.         Setting of case notes indicator ?
.------------------------------------------------------------------------------
.
KUSR114   MOVE      ZERO,OTCNCASE
          PACK      CASETYPE,SP30,SP3
.
          DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = ",CASE0,", ":
                               *V2LON,"1",*HOFF," = ",CASE1
.
KUSR114R  KEYIN     *P41:17,*EL,*DV,UNDLN1,*P41:17,*V2LON,OTCNCASE
          COMPARE   ZERO,OTCNCASE
          GOTO      KUSR114C IF EQUAL
          BRANCH    OTCNCASE,KUSR114C
          BEEP
          GOTO      KUSR114R
.
KUSR114C  MOVE      CASE0,CASETYPE
          LOAD      CASETYPE,OTCNCASE,CASE1
          DISPLAY   *P41:17,*V2LON,OTCNCASE,*P47:17,CASETYPE
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.          Print Labels and Id Sheets in Bookings 
.------------------------------------------------------------------------------
.
KUSR115    KEYIN     *P41:18,*EL,*V2LON,ANS
           CMATCH    ANSY,ANS
           GOTO      KUSR115Y IF EQUAL
           CMATCH    ANSN,ANS
           GOTO      KUSR115N IF EQUAL
           BEEP
           GOTO      KUSR115
.
KUSR115Y   MOVE      ONE,HOLABBOK
           GOTO      KUSR115DS
.
KUSR115N   MOVE      TWO,HOLABBOK
.
KUSR115DS LOAD      DANSX,HOLABBOK,DYES,DNO
          DISPLAY   *P41:18,*EL,*V2LON,DANSX
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.        Keyin Format for Appointment Mailing Labels 
.------------------------------------------------------------------------------
KUSR116   MOVE      "19",CVERT
          MOVE      "Appoint. Mailing Label Format",BOXHDR
          CALL      LDFORM00                * Load Format Types
          MOVE      "41",CCOL
          PROC      GENCODKY
          BRANCH    EXIT,UPUSR1
          MOVE      TEMPCODE,OTCNFAML
.
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.        Keyin display for Operator Id for Canc/Resch Visits
.------------------------------------------------------------------------------
KUSR118   MOVE      "20",CVERT
          MOVE      "Operator Id for Canc/Resch Visits",BOXHDR
          CALL      LDOPER00                * Load Format Types
          MOVE      "41",CCOL
          PROC      GENCODKY
          BRANCH    EXIT,UPUSR1
          MOVE      TEMPCODE,OTCNOPCR
.
          GOTO      UPUSR1
.
.********************************************************************
.*  LDFORM00  :  Load format Types Into Temp File                      *
.*                                                                  *
.********************************************************************
.
LDFORM00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHOS20,DHOS21
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDOPER00  :  Load format Types Into Temp File                      *
.*                                                                  *
.********************************************************************
.
LDOPER00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHOS25,DHOS26,DHOS27
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*                    BUILD000 - Build a New Temp File              *
.********************************************************************
.
BUILD000  CALL      KILL0000
.
          PACK      CMDLINE,SP70
          CLEAR     CMDLINE
          APPEND    "isbuild ",CMDLINE
          APPEND    TEMPNAME,CMDLINE
          APPEND    TEMPINDX,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      TMPCODE1,TEMPNAME
          OPEN      TMPCODE2,TEMPNAME
.
          RETURN
.
.********************************************************************
.*                    KILL0000 - Kills the Old Temp File            *
.********************************************************************
.
KILL0000  CLOSE     TMPCODE1
          PACK      CMDLINE,SP70
          CLEAR     CMDLINE
          APPEND    "iserase ",CMDLINE
          APPEND    TEMPNAME,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          RETURN
.
.
.********************************************************************
.*                    Temp File I/O Routines                        *
.********************************************************************
.
WRTEMP1  RESET     KEY8
         WRITE     TMPCODE1,KEY8;TEMPCODE,TEMPDESC
         RETURN
.
RDATEMP1 RESET     KEY8
         READ      TMPCODE1,KEY8;ANS
         RETURN
.
RDSTEMP1 RESET     KEY8
         READ      TMPCODE1,KEY8;;
         RETURN
.
RDTEMP1  MOVE      ZERO,OVRCD
         RESET     KEY8
         READ      TMPCODE1,KEY8;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDKTEMP1 MOVE      ZERO,OVRCD
         READKS    TMPCODE1;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDPTEMP1 MOVE      ZERO,OVRCD
         READKP    TMPCODE1;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
.
RDATEMP2 RESET     KEY38
         READ      TMPCODE2,KEY38;ANS
         RETURN
.
RDSTEMP2 RESET     KEY38
         READ      TMPCODE2,KEY38;;
         RETURN
.
RDTEMP2  MOVE      ZERO,OVRCD
         RESET     KEY38
         READ      TMPCODE2,KEY38;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDKTEMP2 MOVE      ZERO,OVRCD
         READKS    TMPCODE2;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDPTEMP2 MOVE      ZERO,OVRCD
         READKP    TMPCODE2;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
.------------------------------------------------------------------------------
.        Keyin number of days cutoff between 1st and 2nd class postage
.------------------------------------------------------------------------------
.
KUSR117   KEYIN     *P41:CVERT,*EL,*V2LON,OTCNNDAY
          GOTO      UPUSR1
.
.------------------------------------------------------------------------------
.         Actual keyin routine for codes file entries
.------------------------------------------------------------------------------
.
KCODE     MOVE      SP3,ACODE
          KEYIN     *P41:CVERT,*EL,*DV,UNDLN3:
                    *P41:CVERT,*V2LON,ACODE:
                    *P41:CVERT,*DV,ACODE
.
          ENDSET    ACODE
          APPEND    SP3,ACODE
          RESET     ACODE
.
          MATCH     SP3,ACODE
          GOTO      OVERCOND IF EQUAL
.
          CMATCH    EXITCHAR,ACODE
          GOTO      OVERCOND IF EQUAL
.
          CMATCH    QUEST,ACODE
          GOTO      KSACODE IF NOT EQUAL
.
          MOVE      CVERT,SAVVERT
          CALL      PATCODDS
          MOVE      SAVVERT,CVERT
          CALL      DISPUS1X            *** REDISPLAY SCREEN
          GOTO      KCODE
.
KSACODE   PACK      KEY5,CODE,ACODE
          CALL      RDCODE1
          BRANCH    OVRCD,NOCODE
.
          DISPLAY   *P47:CVERT,*EL,*V2LON,TDESC
          RETURN
.
NOCODE    DISPLAY   *P47:CVERT,*B,*V2LON,"** Invalid Code **",*W:
                    *P47:CVERT,*EL
          GOTO      KCODE
.
.
.
POST      MOVE      ZERO,OVRCD
          RETURN
CANCEL    MOVE      ONE,OVRCD
          RETURN
.
WRAUD     WRITAB    CONTROLF,THIRTY1;*51,HOAUDA,HOAUDB,HOAUDC,HOAUDD,HOAUDE:
                                         HOAUDF,HOAUDG,HOAUDH,HOAUDI,HOAUDJ:
                                         HOAUDK,HOAUDL,HOAUDM,HOAUDN,HOAUDO:
                                         HOAUDP,HOAUDQ,HOAUDR,HOAUDS,HOAUDT:
                                         HOAUDU,HOAUDV,HOAUDW,HOAUDX,HOAUDY:
                                         HOAUDZ
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.        USER SCREEN 1
.
WRUSR1    WRITAB    CONTROLF,THIRTY1;*89,HOLPAGE,HOLPRNT,HOLSIZE,HOPMR3:
                                     HORVCODE,HOAAESCD,HOLABLAY,*117,HOSRCM:
                                     HOSREAP,*134,HWORDPRO,HOVIEWCM:
                                     *138,HOMR3L,HOMR3COD,*147,OTCNCASE:
                                     HOLABBOK,*215,OTCNNDAY
          WRITAB    CONTROLF,THIRTY2;*37,OTCNFAML,OTCNOPCR
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.------------------------------------------------------------------------------
.          USER SCREEN2
.------------------------------------------------------------------------------
.
DISPUSR2  READ      CONTROLF,THIRTY1;*103,HOAUSR1,HOAUSRD1,HOAUSRM1:
                                     *126,HOUSR1,HOUSR2,HOUSR3,HOUSR4:
                                     HOUSMAN1,HOUSMAN2,HOUSMAN3,HOUSMAN4
          MOVE      DNO,DANS1
          LOAD      DANS1,HOAUSR1,DYES,DNO
.
DU21A     MOVE      DNO,DANS2
          LOAD      DANS2,HOAUSRM1,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,HOUSR1,DYES,DNO
.
          MOVE      SP20,DESCO1
.
          PACK      KEY5,CODEO1,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,DU22A
.
          MOVE      TDESC,DESCO1
.
DU22A     MOVE      DNO,DANS4
          LOAD      DANS4,HOUSMAN1,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,HOUSR2,DYES,DNO
.
          MOVE      SP20,DESCO2
.
          PACK      KEY5,CODEO2,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,DU23A
.
          MOVE      TDESC,DESCO2
.
DU23A     MOVE      DNO,DANS6
          LOAD      DANS6,HOUSMAN2,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,HOUSR3,DYES,DNO
.
          MOVE      SP20,DESCO3
.
          PACK      KEY5,CODEO3,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,DU24A
.
          MOVE      TDESC,DESCO3
.
DU24A     MOVE      DNO,DANS8
          LOAD      DANS8,HOUSMAN3,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,HOUSR4,DYES,DNO
.
          MOVE      SP20,DESCO4
.
          PACK      KEY5,CODEO4,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,DU25A
.
          MOVE      TDESC,DESCO4
.
DU25A     MOVE      DNO,DANS10
          LOAD      DANS10,HOUSMAN4,DYES,DNO
.
DISPUS2X  DISPLAY   *P57:2,*V2LON,"- User Screen 2 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using User Defined Code1 - U1(Y/N):":
                    *P1:5," 2.                   Description     :":
                    *P1:6," 3.                   Mandatory  (Y/N):":
                    *P1:7," 4. Using User Defined Code2 - O1(Y/N):":
                    *P1:8," 5.                   Description     :":
                    *P1:9," 6.                   Mandatory  (Y/N):":
                    *P1:10," 7. Using User Defined Code3 - O2(Y/N):":
                    *P1:11," 8.                   Description     :":
                    *P1:12," 9.                   Mandatory  (Y/N):":
                    *P1:13,"10. Using User Defined Code4 - O3(Y/N):":
                    *P1:14,"11.                   Description     :":
                    *P1:15,"12.                   Mandatory  (Y/N):":
                    *P1:16,"13. Using User Defined Code5 - O4(Y/N):":
                    *P1:17,"14.                   Description     :":
                    *P1:18,"15.                   Mandatory  (Y/N):":
                    *P41:4,*V2LON,DANS1,*P41:5,HOAUSRD1,*P41:6,DANS2:
                    *P41:7,DANS3,*P41:8,DESCO1,*P41:9,DANS4:
                    *P41:10,DANS5,*P41:11,DESCO2,*P41:12,DANS6:
                    *P41:13,DANS7,*P41:14,DESCO3,*P41:15,DANS8:
                    *P41:16,DANS9,*P41:17,DESCO4,*P41:18,DANS10
          RETURN
.
.------------------------------------------------------------------------------
.         Select Field
.------------------------------------------------------------------------------
UPUSR2    CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,KUSR21,KUSR22,KUSR23,KUSR24,KUSR25:
                           KUSR26,KUSR27,KUSR28,KUSR29,KUSR210:
                           KUSR211,KUSR212,KUSR213,KUSR214,KUSR215
          BEEP
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          Using User defined field 1 - CODE U1
.------------------------------------------------------------------------------
.
KUSR21    KEYIN     *P41:4,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR21Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR21N IF EQUAL
          BEEP
          GOTO      KUSR21
.
KUSR21Y   MOVE      ONE,HOAUSR1
          GOTO      KUSR21D
.
KUSR21N   MOVE      TWO,HOAUSR1
.
KUSR21D   LOAD      DANSX,HOAUSR1,DYES,DNO
          DISPLAY   *P41:4,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.         User defined field 1 (CAT U1) description
.------------------------------------------------------------------------------
.
KUSR22    MOVE      SP20,HOAUSRD1
          KEYIN     *P41:5,*EL,*V2LON,HOAUSRD1
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          User defined field 1 - mandatory ?
.------------------------------------------------------------------------------
.
KUSR23    KEYIN     *P41:6,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR23Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR23N IF EQUAL
          BEEP
          GOTO      KUSR23
.
KUSR23Y   MOVE      ONE,HOAUSRM1
          GOTO      KUSR23D
.
KUSR23N   MOVE      TWO,HOAUSRM1
.
KUSR23D   LOAD      DANSX,HOAUSRM1,DYES,DNO
          DISPLAY   *P41:6,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          Using User defined field 2 - CODE O1
.------------------------------------------------------------------------------
.
KUSR24    KEYIN     *P41:7,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR24Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR24N IF EQUAL
          BEEP
          GOTO      KUSR24
.
KUSR24Y   MOVE      ONE,HOUSR1
          GOTO      KUSR24D
.
KUSR24N   MOVE      TWO,HOUSR1
.
KUSR24D   LOAD      DANSX,HOUSR1,DYES,DNO
          DISPLAY   *P41:7,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.         User defined field 2 (CAT O1) description
.------------------------------------------------------------------------------
.
KUSR25    MOVE      SP20,DESCO1
          KEYIN     *P41:8,*EL,*V2LON,DESCO1
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          User defined field 2 - mandatory ?
.------------------------------------------------------------------------------
.
KUSR26    KEYIN     *P41:9,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR26Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR26N IF EQUAL
          BEEP
          GOTO      KUSR26
.
KUSR26Y   MOVE      ONE,HOUSMAN1
          GOTO      KUSR26D
.
KUSR26N   MOVE      TWO,HOUSMAN1
.
KUSR26D   LOAD      DANSX,HOUSMAN1,DYES,DNO
          DISPLAY   *P41:9,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          Using User defined field 3 - CODE O2
.------------------------------------------------------------------------------
.
KUSR27    KEYIN     *P41:10,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR27Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR27N IF EQUAL
          BEEP
          GOTO      KUSR27
.
KUSR27Y   MOVE      ONE,HOUSR2
          GOTO      KUSR27D
.
KUSR27N   MOVE      TWO,HOUSR2
.
KUSR27D   LOAD      DANSX,HOUSR2,DYES,DNO
          DISPLAY   *P41:10,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.         User defined field 3 (CAT O2) description
.------------------------------------------------------------------------------
.
KUSR28    MOVE      SP20,DESCO2
          KEYIN     *P41:11,*EL,*V2LON,DESCO2
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          User defined field 3 - mandatory ?
.------------------------------------------------------------------------------
.
KUSR29    KEYIN     *P41:12,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR29Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR29N IF EQUAL
          BEEP
          GOTO      KUSR29
.
KUSR29Y   MOVE      ONE,HOUSMAN2
          GOTO      KUSR29D
.
KUSR29N   MOVE      TWO,HOUSMAN2
.
KUSR29D   LOAD      DANSX,HOUSMAN2,DYES,DNO
          DISPLAY   *P41:12,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          Using User defined field 4 - CODE O3
.------------------------------------------------------------------------------
.
KUSR210   KEYIN     *P41:13,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR210Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR210N IF EQUAL
          BEEP
          GOTO      KUSR210
.
KUSR210Y  MOVE      ONE,HOUSR3
          GOTO      KUSR210D
.
KUSR210N  MOVE      TWO,HOUSR3
.
KUSR210D  LOAD      DANSX,HOUSR3,DYES,DNO
          DISPLAY   *P41:13,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.         User defined field 4 (CAT O3) description
.------------------------------------------------------------------------------
.
KUSR211   MOVE      SP20,DESCO3
          KEYIN     *P41:14,*EL,*V2LON,DESCO3
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          User defined field 4 - mandatory ?
.------------------------------------------------------------------------------
.
KUSR212   KEYIN     *P41:15,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR212Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR212N IF EQUAL
          BEEP
          GOTO      KUSR212
.
KUSR212Y  MOVE      ONE,HOUSMAN3
          GOTO      KUSR212D
.
KUSR212N  MOVE      TWO,HOUSMAN3
.
KUSR212D  LOAD      DANSX,HOUSMAN3,DYES,DNO
          DISPLAY   *P41:15,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          Using User defined field 5 - CODE O4
.------------------------------------------------------------------------------
.
KUSR213   KEYIN     *P41:16,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR213Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR213N IF EQUAL
          BEEP
          GOTO      KUSR213
.
KUSR213Y  MOVE      ONE,HOUSR4
          GOTO      KUSR213D
.
KUSR213N  MOVE      TWO,HOUSR4
.
KUSR213D  LOAD      DANSX,HOUSR4,DYES,DNO
          DISPLAY   *P41:16,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.         User defined field 5 (CAT O4) description
.------------------------------------------------------------------------------
.
KUSR214   MOVE      SP20,DESCO4
          KEYIN     *P41:17,*EL,*V2LON,DESCO4
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          User defined field 5 - mandatory ?
.------------------------------------------------------------------------------
.
KUSR215   KEYIN     *P41:18,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR215Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR215N IF EQUAL
          BEEP
          GOTO      KUSR215
.
KUSR215Y  MOVE      ONE,HOUSMAN4
          GOTO      KUSR215D
.
KUSR215N  MOVE      TWO,HOUSMAN4
.
KUSR215D  LOAD      DANSX,HOUSMAN4,DYES,DNO
          DISPLAY   *P41:18,*EL,*V2LON,DANSX
          GOTO      UPUSR2
.
.        USER SCREEN 2
.
WRUSR2    WRITAB    CONTROLF,THIRTY1;*103,HOAUSR1,HOAUSRD1,HOAUSRM1:
                                     *126,HOUSR1,HOUSR2,HOUSR3,HOUSR4:
                                     HOUSMAN1,HOUSMAN2,HOUSMAN3,HOUSMAN4
          PACK      KEY5,CODEU1,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,WRUSR21
.
          MOVE      HOAUSRD1,TDESC
          CALL      UPCODE1
.
WRUSR21   PACK      KEY5,CODEO1,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,WRUSR22
.
          MOVE      DESCO1,TDESC
          CALL      UPCODE1
.
WRUSR22   PACK      KEY5,CODEO2,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,WRUSR23
.
          MOVE      DESCO2,TDESC
          CALL      UPCODE1
.
WRUSR23   PACK      KEY5,CODEO3,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,WRUSR24
.
          MOVE      DESCO3,TDESC
          CALL      UPCODE1
.
WRUSR24   PACK      KEY5,CODEO4,SP3
          CALL      RDCODE1
          BRANCH    OVRCD,WRUSR25
.
          MOVE      DESCO4,TDESC
          CALL      UPCODE1
.
WRUSR25   DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.*********************************************************************
.         DISPLAY USER SCREEN 3
.*********************************************************************
DISPUSR3  READ      CONTROLF,THIRTY1;*158,OTCNUPVS,OTCNUBRD,OTCNUDPT,OTCNDDCI:
                                     *162,OTCNIATT
          READ      CONTROLF,THIRTY2;*34,OTCNWBIL,*35,OTCNVBIL,*39,OTCNCCON:
                                     *54,OTCNRQDF,*57,OTCNOTIH,*63,OTCNOTIT
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OTCNUPVS,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,OTCNUBRD,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,OTCNUDPT,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,OTCNDDCI,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,OTCNIATT,DYES,DNO
.
          PACK      DIM40A,SP20,SP20
          LOAD      DIM40A,OTCNWBIL,RHB1,RHB2
.
          PACK      DIM40B,SP20,SP20
          LOAD      DIM40B,OTCNVBIL,RHB1,RHB2
.
          MOVE      DNO,DANS8
          LOAD      DANS8,OTCNCCON,DYES,DNO
.
          MOVE      "Invalid Code",RQDFDESC
          PACK      KEY5,CATRQ,OTCNRQDF
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,RQDFDESC
          ENDIF
.
          DISPLAY   *P57:2,*V2LON,"- User Screen 3 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using previous no. of visits (Y/N):":
                    *P1:5," 2. Using board                  (Y/N):":
                    *P1:6," 3. Using category AC variable   (Y/N):":
                    *P1:7," 4. Default dept to clin. indic. (Y/N):":
                    *P1:8," 5. Invoicing when attending     (Y/N):":
                    *P1:9," 6. Rehabilitation Workcare Billing   :":
                    *P1:10," 7. Rehabilitation DVA Billing        :":
                    *P1:11," 8. Using OP CMDS Consultant Code(Y/N):":
                    *P1:12," 9. Default code for Cat RQ in EOC01  :":
                    *P1:13,"10. User Defined OUT Invoice Header   :":
                    *P1:14,"11. User Defined OUT Invoice Tail     :":
                    *P41:4,*V2LON,DANS1:
                    *P41:5,DANS2:
                    *P41:6,DANS3:
                    *P41:7,DANS4:
                    *P41:8,DANS5:
                    *P41:9,*V2LON,OTCNWBIL,*HOFF,SP3,DIM40A:
                    *P41:10,*V2LON,OTCNVBIL,*HOFF,SP3,DIM40B:
                    *P41:11,*V2LON,DANS8:
                    *P41:12,*V2LON,OTCNRQDF,*HOFF,SP3,RQDFDESC:
                    *P41:13,*V2LON,OTCNOTIH:
                    *P41:14,*V2LON,OTCNOTIT
          RETURN
.
.*********************************************************************
.         Select Field
.*********************************************************************
UPUSR3    CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,KUSR3010,KUSR3020,KUSR3030,KUSR3040,KUSR3050:
                           KUSR3060,KUSR3070,KUSR3080,KUSR3090,KUSR3100:
                           KUSR3110
          BEEP
          GOTO      UPUSR2
.
.------------------------------------------------------------------------------
.          Using previous number of visits ?
.------------------------------------------------------------------------------
.
KUSR3010  MOVE      "41",CCOL                * column for keyin
          MOVE      FOUR,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNUPVS            * set answer
          GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.          Using board ?
.------------------------------------------------------------------------------
.
KUSR3020  MOVE      "41",CCOL                * column for keyin
          MOVE      FIVE,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNUBRD            * set answer
          GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.          Using department ?
.------------------------------------------------------------------------------
.
KUSR3030  MOVE      "41",CCOL                * column for keyin
          MOVE      SIX,CVERT                * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNUDPT            * set answer
          GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.          Default department to the clinical indicator ?
.------------------------------------------------------------------------------
.
KUSR3040  MOVE      "41",CCOL                * column for keyin
          MOVE      SEVEN,CVERT              * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNDDCI            * set answer
          GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.          Invoicing when attending ?
.------------------------------------------------------------------------------
.
KUSR3050  MOVE      "41",CCOL                * column for keyin
          MOVE      EIGHT,CVERT              * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNIATT            * set answer
          GOTO      UPUSR3
.
.------------------------------------------------------------------------------
. Rehabilitation Workcare Billing
.------------------------------------------------------------------------------
KUSR3060  MOVE      "41",CCOL    
          MOVE      "9",CVERT     
          DISPLAY   *P1:24,*V2LON,"1",*HOFF,"=",RHB1,SP2:
                           *V2LON,"2",*HOFF,"=",RHB2
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,OTCNWBIL
.
          COMPARE   "0",OTCNWBIL
          IF        @EQUAL
            BEEP
            GOTO      KUSR3060
          ENDIF
.
          BRANCH    OTCNWBIL,KUSR3062,KUSR3062
          GOTO      KUSR3066
KUSR3062  LOAD      DIM40,OTCNWBIL,RHB1,RHB2
          DISPLAY   *P45:CVERT,DIM40
          GOTO      UPUSR3
.
KUSR3066  BEEP
          GOTO      KUSR3060
.
.------------------------------------------------------------------------------
. Rehabilitation DVA Billing
.------------------------------------------------------------------------------
KUSR3070  MOVE      "41",CCOL    
          MOVE      "10",CVERT     
          DISPLAY   *P1:24,*V2LON,"1",*HOFF,"=",RHB1,SP2:
                           *V2LON,"2",*HOFF,"=",RHB2
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,OTCNVBIL
.
          COMPARE   "0",OTCNVBIL
          IF        @EQUAL
            BEEP
            GOTO      KUSR3070
          ENDIF
.
          BRANCH    OTCNVBIL,KUSR3072,KUSR3072
          GOTO      KUSR3076
KUSR3072  LOAD      DIM40,OTCNVBIL,RHB1,RHB2
          DISPLAY   *P45:CVERT,DIM40
          GOTO      UPUSR3
.
KUSR3076  BEEP
          GOTO      KUSR3070
.
.------------------------------------------------------------------------------
.          Using Outpatient Clinic CMDS Consultant Code ?
.------------------------------------------------------------------------------
.
KUSR3080  MOVE      "41",CCOL                * column for keyin
          MOVE      TEN1,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCCON            * set answer
          GOTO      UPUSR3
.
KUSR3090  MOVE      "41",ECOL
          MOVE      "12",EVERT
          MOVE      CATRQ,CODE
          MOVE      ONE,CKYIMAND
          CALL      PATCODKY
          IF        EXIT=2
            GOTO      KUSR3090
          ENDIF
.
          MOVE      ACODE,OTCNRQDF
          MOVE      TDESC,RQDFDESC
          DISPLAY   *P41:12,*V2LON,OTCNRQDF,*HOFF,SP3,RQDFDESC
          GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.         User Defined OUT Invoice Header Code
.------------------------------------------------------------------------------
.
KUSR3100  MOVE      SP6,IBTHSCOD
          MOVE      ZERO,CKEYTYP
          MOVE      "41",CCOL
          MOVE      "13",CVERT
.
          CALL      KIBTHA00
          BRANCH    EXIT,KUSR3100,KUSR3105
.
          COMPARE   NINE,IBTHSTFM                * correct type ?
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an invalid type.  ";
            CALL      HITENTER
            GOTO      KUSR3100
          ENDIF
.
          MOVE      IBTHSCOD,OTCNOTIH
KUSR3105  GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.         User Defined OUT Invoice Tail Code
.------------------------------------------------------------------------------
.
KUSR3110  MOVE      SP6,IBTHSCOD
          MOVE      ZERO,CKEYTYP
          MOVE      "41",CCOL
          MOVE      "14",CVERT
.
          CALL      KIBTHA00
          BRANCH    EXIT,KUSR3110,KUSR3115
.
          COMPARE   TEN,IBTHSTFM                * correct type ?
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an invalid type.  ";
            CALL      HITENTER
            GOTO      KUSR3110
          ENDIF
.
          MOVE      IBTHSCOD,OTCNOTIT
KUSR3115  GOTO      UPUSR3
.
.------------------------------------------------------------------------------
.         Post user screen 3 parameters
.------------------------------------------------------------------------------
.
WRUSR3    WRITAB    CONTROLF,THIRTY1;*158,OTCNUPVS,OTCNUBRD,OTCNUDPT,OTCNDDCI:
                                     *162,OTCNIATT
          WRITAB    CONTROLF,THIRTY2;*34,OTCNWBIL,*35,OTCNVBIL,*39,OTCNCCON:
                                     *54,OTCNRQDF,*57,OTCNOTIH,*63,OTCNOTIT
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.*********************************************************************
.         DISPLAY USER SCREEN 4
.*********************************************************************
DISPUSR4  READ      CONTROLF,THIRTY1;*186,OTCNRBDR,OTCNCSRR,OTCNCPCR,OTCNCPAR:
                                 OTCNCPIR,OTCNCRSR,OTCNCCER,OTCNCDPR,OTCNCARR:
                                 OTCNCU1R,OTCNCU2R,OTCNCU3R,OTCNCU4R,OTCNCCMR:
                                 *219,OTCNIVUR,OTCNBKBD
          READ      CONTROLF,THIRTY2;*30,OTCNMVBR,*40,OTCNCTAR,*48,OTCNMBFR:
                                 *53,OTCNORFL
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OTCNRBDR,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,OTCNCSRR,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,OTCNCPCR,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,OTCNCPAR,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,OTCNCPIR,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,OTCNCRSR,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,OTCNCCER,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,OTCNCDPR,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,OTCNCARR,DYES,DNO
.
          MOVE      DNO,DANS10
          LOAD      DANS10,OTCNCU1R,DYES,DNO
.
          MOVE      DNO,DANS11
          LOAD      DANS11,OTCNCU2R,DYES,DNO
.
          MOVE      DNO,DANS12
          LOAD      DANS12,OTCNCU3R,DYES,DNO
.
          MOVE      DNO,DANS13
          LOAD      DANS13,OTCNCU4R,DYES,DNO
.
          MOVE      DNO,DANS14
          LOAD      DANS14,OTCNCCMR,DYES,DNO
.
          MOVE      DNO,DANS15
          LOAD      DANS15,OTCNIVUR,DYES,DNO
.
          MOVE      DNO,DANS16
          LOAD      DANS16,OTCNBKBD,DYES,DNO
.
          MOVE      DNO,DANS18
          LOAD      DANS18,OTCNCTAR,DYES,DNO
.
          MOVE      DNO,DANS19
          LOAD      DANS19,OTCNMBFR,DYES,DNO
.
          MOVE      DNO,DANS20
          LOAD      DANS20,OTCNORFL,DYES,DNO
.
          DISPLAY   *P57:2,*V2LON,"- User Screen 4 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Re-input booking details in reappointments (Y/N):":
                    *P1:5," 2. Clear source of refferal in reappointments (Y/N):":
                    *P1:6," 3. Clear patient class in reappointments      (Y/N):":
                    *P1:7," 4. Clear patient category in reappointments   (Y/N):":
                    *P1:8," 5. Clear priority in reappointments           (Y/N):":
                    *P1:9," 6. Clear resident status in reappointments    (Y/N):":
                    *P1:10," 7. Clear comp eligibility in reappointments   (Y/N):":
                    *P1:11," 8. Clear departments in reappointments        (Y/N):":
                    *P1:12," 9. Clear area in reappointments               (Y/N):":
                    *P1:13,"10. Clear user def field 1 in reappointments   (Y/N):":
                    *P1:14,"11. Clear user def field 2 in reappointments   (Y/N):":
                    *P1:15,"12. Clear user def field 3 in reappointments   (Y/N):":
                    *P1:16,"13. Clear user def field 4 in reappointments   (Y/N):":
                    *P1:17,"14. Clear comments in reappointments           (Y/N):":
                    *P1:18,"15. Display zero amount of invoices in IBAOUT20(Y/N):":
                    *P1:19,"16. Using Booking Date Audit                   (Y/N):":
                    *P1:20,"17. Maximum number of visits to block reappoint     :":
                    *P1:21,"18. Clear transport alloc. in reappointments   (Y/N):":
                    *P1:22,"19. Allow Booking from Referral Program        (Y/N):":
                    *P1:23,"20. Prompt for #"Outpatient Referral#" in EOC01  (Y/N):":
                    *P55:4,*V2LON,DANS1:
                    *P55:5,DANS2:
                    *P55:6,DANS3:
                    *P55:7,DANS4:
                    *P55:8,DANS5:
                    *P55:9,DANS6:
                    *P55:10,DANS7:
                    *P55:11,DANS8:
                    *P55:12,DANS9:
                    *P55:13,DANS10:
                    *P55:14,DANS11:
                    *P55:15,DANS12:
                    *P55:16,DANS13:
                    *P55:17,DANS14:
                    *P55:18,DANS15:
                    *P55:19,DANS16:
                    *P55:20,OTCNMVBR:
                    *P55:21,DANS18:
                    *P55:22,DANS19:
                    *P55:23,DANS20
          RETURN
.
.
.*********************************************************************
.         Select Field
.*********************************************************************
UPUSR4    CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,KUSR4010,KUSR4020,KUSR4030,KUSR4040,KUSR4050:
                           KUSR4060,KUSR4070,KUSR4080,KUSR4090,KUSR4100:
                           KUSR4110,KUSR4120,KUSR4130,KUSR4140,KUSR4150:
                           KUSR4160,KUSR4170,KUSR4180,KUSR4190,KUSR4200
          BEEP
          GOTO      UPUSR4
.
.------------------------------------------------------------------------------
.         Re-input booking details in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4010  MOVE      "55",CCOL                * column for keyin
          MOVE      FOUR,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNRBDR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Sorce of refferal in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4020  MOVE      "55",CCOL                * column for keyin
          MOVE      FIVE,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCSRR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Patient classifaction in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4030  MOVE      "55",CCOL                * column for keyin
          MOVE      SIX,CVERT                * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCPCR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Patient category in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4040  MOVE      "55",CCOL                * column for keyin
          MOVE      SEVEN,CVERT              * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCPAR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Priority in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4050  MOVE      "55",CCOL                * column for keyin
          MOVE      EIGHT,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCPIR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Resident status in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4060  MOVE      "55",CCOL                * column for keyin
          MOVE      NINE,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCRSR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Compensation eligibility in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4070  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCCER            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Department in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4080  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN1,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCDPR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Area in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4090  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN2,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCARR            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear  User defined field 1 in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4100  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN3,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCU1R            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear  User defined field 2 in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4110  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN4,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCU2R            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear  User defined field 3 in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4120  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN5,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCU3R            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear  User defined field 4 in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4130  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN6,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCU4R            * set answer
          GOTO      UPUSR4 
.
.
.------------------------------------------------------------------------------
.         Clear Comments in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4140  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN7,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCCMR            * set answer
          GOTO      UPUSR4 
.
.------------------------------------------------------------------------------
.         Display zero amount of invoices in IBAOUT20 ?
.------------------------------------------------------------------------------
.
KUSR4150  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN8,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNIVUR            * set answer
          GOTO      UPUSR4 
.
.------------------------------------------------------------------------------
.         Using Booking Date Audit ?            
.------------------------------------------------------------------------------
.
KUSR4160  MOVE      "55",CCOL                * column for keyin
          MOVE      TEN9,CVERT               * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNBKBD            * set answer
          GOTO      UPUSR4 
.
.------------------------------------------------------------------------------
.         MAXIMUM NUMBER OF VISITS TO BLOCK REAPPOINT
.------------------------------------------------------------------------------
.
KUSR4170  KEYIN     *P55:20,*V2LON,OTCNMVBR  
          GOTO      UPUSR4
.
.------------------------------------------------------------------------------
.         Clear transport allocation in reappointments ?
.------------------------------------------------------------------------------
.
KUSR4180  MOVE      "55",CCOL                * column for keyin
          MOVE      TWENTY1,CVERT            * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNCTAR            * set answer
          GOTO      UPUSR4 
.
.------------------------------------------------------------------------------
.         Allow Booking from Referral Program ?          
.------------------------------------------------------------------------------
.
KUSR4190  MOVE      "55",CCOL                * column for keyin
          MOVE      TWENTY2,CVERT            * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNMBFR            * set answer
          GOTO      UPUSR4 
.
.------------------------------------------------------------------------------
.         Keyin Referral Type in EOC01 ?                 
.------------------------------------------------------------------------------
.
KUSR4200  MOVE      "55",CCOL                * column for keyin
          MOVE      TWENTY3,CVERT            * row for keyin
          CALL      KYN0000                  * keyin a Y (1) or N (0)
          MOVE      EXIT,OTCNORFL            * set answer
          GOTO      UPUSR4 
.
.------------------------------------------------------------------------------
.         Post user screen 4 parameters
.------------------------------------------------------------------------------
.
WRUSR4    WRITAB    CONTROLF,THIRTY1;*186,OTCNRBDR,OTCNCSRR,OTCNCPCR,OTCNCPAR:
                                 OTCNCPIR,OTCNCRSR,OTCNCCER,OTCNCDPR,OTCNCARR:
                                 OTCNCU1R,OTCNCU2R,OTCNCU3R,OTCNCU4R,OTCNCCMR:
                                 *219,OTCNIVUR,OTCNBKBD
          WRITAB    CONTROLF,THIRTY2;*30,OTCNMVBR,*40,OTCNCTAR,*48,OTCNMBFR:
                                 *53,OTCNORFL
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.
.*********************************************************************
.         display IBA controlled screen 1
.*********************************************************************
DISPIBA1  READ      CONTROLF,THIRTY1;*121,HSCROPT,HDIAFLG,HLOGRSCH,HLOGCANL:
                                     HRSCHCLI,*136,HADDLABS:
                                     *145,OTCNLGCS,OTCNURCS,*149,OTCNOPSS:
                                     *152,OTCNIPRC,*163,OTCNFTYP,OTCNCFEE:
                                     *165,OTCNMINM,*173,OTCNNBOK,*183,OTCNNSID
.
          MOVE      DBOOKSC0,DBOOKSCR
          LOAD      DBOOKSCR,HSCROPT,DBOOKSC1
.
          MOVE      DDIAG0,DDIAG
          LOAD      DDIAG,HDIAFLG,DDIAG1,DDIAG2
.
          MOVE      DNO,DANS1
          LOAD      DANS1,HLOGRSCH,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,HLOGCANL,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,OTCNLGCS,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,OTCNURCS,DYES,DNO
.
          MOVE      DRESCH0,DRESCH
          LOAD      DRESCH,HRSCHCLI,DRESCH1,DRESCH2
.
          MOVE      DNO,DANS5
          LOAD      DANS5,OTCNOPSS,DYES
.
          MOVE      DNO,DANS6
          LOAD      DANS6,OTCNIPRC,DYES
.
          MOVE      DFTYPE0,DFTYPE
          LOAD      DFTYPE,OTCNFTYP,DFTYPE1
.
          MOVE      DFEESI0,DFEESI
          LOAD      DFEESI,OTCNCFEE,DFEESI1
.
          MOVE      DNO,DANS7
          LOAD      DANS7,OTCNNBOK,DYES
.
          MOVE      DNO,DANS8
          LOAD      DANS8,OTCNNSID,DYES
.
          DISPLAY   *P57:2,*V2LON,"- I.B.A Screen 1 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. (No longer used)                            :":
                    *P1:5," 2. (No longer used)                            :":
                    *P1:6," 3. (No longer used)                            :":
                    *P1:7," 4. (No longer used)                            :":
                    *P1:8," 5. Booking Screen Layout                       :":
                    *P1:9," 6. Type of Diagnosis                           :":
                    *P1:10," 7. Keep Log of Rescheduled Bookings ?    (Y/N) :":
                    *P1:11," 8. Keep Log of Cancelled Bookings ?      (Y/N) :":
                    *P1:12," 9. Type of Rescheduling Clinics                :":
                    *P1:13,"10. Number of Additional Blank Labels to Print  :":
                    *P1:14,"11. Keep Log of Cancelled Sessions ?      (Y/N) :":
                    *P1:15,"12. Using reason for session cancellation?(Y/N) :":
                    *P1:16,"13. Open sessions in Clinic Master Maint.?(Y/N) :":
                    *P1:17,"14. Using Input Procedure codes screen ?  (Y/N) :":
                    *P1:18,"15. Type of outpatient charging to be used      :":
                    *P1:19,"16. Standard charge on fees invoiced report     :":
                    *P1:20,"17. Minimum visit no. for manual input (OUT68)  :":
                    *P1:21,"18. Using non-booked attendees in IBAOUT66 (Y/N):":
                    *P1:22,"19. IBAOUT66 Non Site Dependant ?          (Y/N):":
                    *P51:8,*V2LON,HSCROPT,*P55:8,DBOOKSCR:
                    *P51:9,HDIAFLG,*P55:9,DDIAG,*P51:10,DANS1:
                    *P51:11,DANS2,*P51:12,HRSCHCLI,*P55:12,DRESCH:
                    *P51:13,HADDLABS:
                    *P51:14,DANS3,*P51:15,DANS4,*P51:16,DANS5,*P51:17,DANS6:
                    *P51:18,OTCNFTYP,*P55:18,DFTYPE:
                    *P51:19,OTCNCFEE,*P55:19,DFEESI:
                    *P51:20,OTCNMINM,*P51:21,DANS7,*P51:22,DANS8
          RETURN
.
.*********************************************************************
.         update the fields in IBA screen 1
.*********************************************************************
UPIBA1    CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,KIBA11,KIBA12,KIBA13,KIBA14,KIBA15:
                           KIBA16,KIBA17,KIBA18,KIBA19,KIBA110:
                           KIBA111,KIBA112,KIBA113,KIBA114,KIBA115:
                           KIBA116,KIBA117,KIBA118,KIBA119
KEYI1BP   BEEP
          GOTO      UPIBA1
.
KIBA11    GOTO      UPIBA1
.
KIBA12    GOTO      UPIBA1
.
KIBA13    GOTO      UPIBA1
.
KIBA14    GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         BOOKING SCREEN LAYOUT
.------------------------------------------------------------------------------
.
KIBA15    DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF:
                    " = ",DBOOKSC0,*V2LON,ONE,*HOFF," = ",DBOOKSC1
.
          KEYIN     *P51:8,*EL,*V2LON,HSCROPT,*P1:24,*EL;
          COMPARE   ZERO,HSCROPT
          GOTO      OKIBA15 IF EQUAL
          BRANCH    HSCROPT,OKIBA15
          BEEP
          GOTO      KIBA15
.
OKIBA15   MOVE      DBOOKSC0,DBOOKSCR
          LOAD      DBOOKSCR,HSCROPT,DBOOKSC1
          DISPLAY   *P55:8,*V2LON,DBOOKSCR
          GOTO      UPIBA1
.------------------------------------------------------------------------------
.         TYPE OF DIAGNOSIS
.------------------------------------------------------------------------------
.
KIBA16    DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF:
                    " = ",DDIAG0,*V2LON,ONE,*HOFF," = ",DDIAG1:
                    *V2LON,TWO,*HOFF," = ",DDIAG2
.
          KEYIN     *P51:9,*EL,*V2LON,HDIAFLG,*P1:24,*EL;
          COMPARE   ZERO,HDIAFLG
          GOTO      OKIBA16 IF EQUAL
          BRANCH    HDIAFLG,OKIBA16,OKIBA16
          BEEP
          GOTO      KIBA16
.
OKIBA16   MOVE      DDIAG0,DDIAG
          LOAD      DDIAG,HDIAFLG,DDIAG1,DDIAG2
          DISPLAY   *P55:9,*V2LON,DDIAG
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.          KEEP LOG OF RESCHEDULED BOOKINGS
.------------------------------------------------------------------------------
.
KIBA17    KEYIN     *P51:10,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KIBA17Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KIBA17N IF EQUAL
          BEEP
          GOTO      KIBA17
.
KIBA17Y   MOVE      ONE,HLOGRSCH
          GOTO      KIBA17D
.
KIBA17N   MOVE      TWO,HLOGRSCH
.
KIBA17D   LOAD      DANSX,HLOGRSCH,DYES,DNO
          DISPLAY   *P51:10,*EL,*V2LON,DANSX
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.          KEEP LOG OF CANCELLED BOOKINGS
.------------------------------------------------------------------------------
.
KIBA18    KEYIN     *P51:11,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KIBA18Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KIBA18N IF EQUAL
          BEEP
          GOTO      KIBA18
.
KIBA18Y   MOVE      ONE,HLOGCANL
          GOTO      KIBA18D
.
KIBA18N   MOVE      TWO,HLOGCANL
.
KIBA18D   LOAD      DANSX,HLOGCANL,DYES,DNO
          DISPLAY   *P51:11,*EL,*V2LON,DANSX
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         TYPE OF RESCHEDULING
.------------------------------------------------------------------------------
.
KIBA19    DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = ",DRESCH0,", ":
                    *V2LON,ONE,*HOFF," = ",DRESCH1,", ":
                    *V2LON,TWO,*HOFF," = ",DRESCH2
.
          KEYIN     *P51:12,*EL,*V2LON,HRSCHCLI,*P1:24,*EL;
          COMPARE   ZERO,HRSCHCLI
          GOTO      OKIBA19 IF EQUAL
          BRANCH    HRSCHCLI,OKIBA19,OKIBA19
.
          BEEP
          GOTO      KIBA19
.
OKIBA19   MOVE      DRESCH0,DRESCH
          LOAD      DRESCH,HRSCHCLI,DRESCH1,DRESCH2
          DISPLAY   *P55:12,*V2LON,DRESCH
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         NUMBER OF ADDITIONAL BLANK LABELS TO PRINT
.------------------------------------------------------------------------------
.
KIBA110   KEYIN     *P51:13,*EL,*V2LON,HADDLABS
          DISPLAY   *P51:13,*EL,*V2LON,HADDLABS
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.          KEEP LOG OF CANCELLED SESSIONS
.------------------------------------------------------------------------------
.
KIBA111   MOVE      "51",CCOL
          MOVE      "14",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNLGCS
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         USING REASON FOR CANCELLED SESSIONS ?
.------------------------------------------------------------------------------
.
KIBA112   MOVE      "51",CCOL
          MOVE      "15",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNURCS
          GOTO      UPIBA1
.
.-------------------------------------------------------------------------------
.         CHANGE OPEN SESSION IN CLINIC MASTER MAINTENANCE ?
.-------------------------------------------------------------------------------
KIBA113   MOVE      "51",CCOL
          MOVE      "16",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNOPSS
          GOTO      UPIBA1                  * go back to select prompt
.
.-------------------------------------------------------------------------------
.         Using Keyin Procedure codes screen?
.-------------------------------------------------------------------------------
.
KIBA114   MOVE      "51",CCOL
          MOVE      "17",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNIPRC 
          GOTO      UPIBA1                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         TYPE OF OUTPATIENT CHARGING
.------------------------------------------------------------------------------
.
KIBA115   DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF:
                    " = ",DFTYPE0,", ",*V2LON,ONE,*HOFF," = ",DFTYPE1
.
          KEYIN     *P51:18,*EL,*V2LON,OTCNFTYP,*P1:24,*EL;
.
          COMPARE   ZERO,OTCNFTYP
          GOTO      OKIBA115 IF EQUAL
.
          BRANCH    OTCNFTYP,OKIBA115
.
          BEEP
          GOTO      KIBA115
.
OKIBA115  MOVE      DFTYPE0,DFTYPE
          LOAD      DFTYPE,OTCNFTYP,DFTYPE1
.
          DISPLAY   *P51:18,*V2LON,OTCNFTYP,*P55:18,DFTYPE
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         STANDARD CHARGE ON THE FEES INVOICED REPORT
.------------------------------------------------------------------------------
.
KIBA116   DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF:
                    " = ",DFEESI0,", ",*V2LON,ONE,*HOFF," = ",DFEESI1
.
          KEYIN     *P51:19,*EL,*V2LON,OTCNCFEE,*P1:24,*EL;
.
          COMPARE   ZERO,OTCNCFEE
          GOTO      OKIBA116 IF EQUAL
.
          BRANCH    OTCNCFEE,OKIBA116
.
          BEEP
          GOTO      KIBA116
.
OKIBA116  MOVE      DFEESI0,DFEESI
          LOAD      DFEESI,OTCNCFEE,DFEESI1
          DISPLAY   *P51:19,*V2LON,OTCNCFEE,*P55:19,DFEESI
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         MINIMUM OUTPATIENT NUMBER FOR MANUAL INPUT
.------------------------------------------------------------------------------
.
KIBA117   KEYIN     *P51:20,*DV,UNDLN8:
                    *P51:20,*V2LON,OTCNMINM:
                    *P51:20,*DV,OTCNMINM
          GOTO      UPIBA1
.
.------------------------------------------------------------------------------
.         Using non-booked attendees in OUT66 ?
.------------------------------------------------------------------------------
KIBA118   MOVE      "51",CCOL               * column
          MOVE      "21",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNNBOK           * set value
          GOTO      UPIBA1                  * go back to select prompt
.
.-------------------------------------------------------------------------------
.         Using Keyin Procedure codes screen?
.-------------------------------------------------------------------------------
.
KIBA119   MOVE      "51",CCOL
          MOVE      "22",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNNSID 
          GOTO      UPIBA1                  * go back to select prompt
.
.*********************************************************************
.         WRITE IBA SCREEN 1
.*********************************************************************
WRIBA1    WRITAB    CONTROLF,THIRTY1;*121,HSCROPT,HDIAFLG,HLOGRSCH,HLOGCANL:
                    HRSCHCLI,*136,HADDLABS,*145,OTCNLGCS,OTCNURCS:
                    *149,OTCNOPSS,*152,OTCNIPRC,*163,OTCNFTYP,OTCNCFEE:
                    *165,OTCNMINM,*173,OTCNNBOK,*183,OTCNNSID
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.*********************************************************************
.                   DIBB0000
.         display IBA controlled screen 2
.*********************************************************************
DIBB0000  READ      CONTROLF,THIRTY1;*174,OTCNULET,OTCNLSRF,OTCNDHAB,OTCNLABB:
                    OTCNDSCH,OTCNDCRE,OTCNNWVW,*185,OTCNSQO2:
                    *201,OTCNRECI,OTCNUARF,OTCNPZIN,OTCNR49A:
                    *206,OTCNAPTL,OTCNCCIM,OTCNALQR,*210,OTCNPCXB,OTCNDCXB:
                    *214,OTCNPSTC,*218,OTCNLHIA,*221,OTCNDCST
          READ      CONTROLF,THIRTY2;*49,OTCNCSRF
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OTCNULET,DYES
          MOVE      SP20,TDESC
          MATCH     SP2,OTCNCSRF
          IF        @EQUAL
            PACK      OTCNCSRF,ANSS,SP1
          ENDIF
          MATCH     SP3,OTCNLSRF
          IF        !@EQUAL
            MOVE      "Invalid code",TDESC
            PACK      KEY5,OTCNCSRF,OTCNLSRF
            CALL      RDCODE1
            MOVE      TDESC,DESCO1
          ENDIF
          MOVE      DNO,DANS3
          LOAD      DANS3,OTCNDHAB,DYES
          MOVE      DNO,DANS4
          LOAD      DANS4,OTCNLABB,DYES
          MOVE      DNO,DANS5
          LOAD      DANS5,OTCNDSCH,DYES
          MOVE      DNO,DANS6
          LOAD      DANS6,OTCNDCRE,DYES
          MOVE      DNO,DANS7
          LOAD      DANS7,OTCNNWVW,DYES
          MOVE      DNO,DANS8
          LOAD      DANS8,OTCNSQO2,DYES
          MOVE      DNO,DANS9
          LOAD      DANS9,OTCNRECI,DYES
          MOVE      DNO,DANS10
          LOAD      DANS10,OTCNUARF,DYES
          MOVE      DNO,DANS11
          LOAD      DANS11,OTCNPZIN,DYES
.
          MOVE      DR49A0,DR49A
          LOAD      DR49A,OTCNR49A,DR49A1
          MOVE      DHOS7,APTLABEL
          LOAD      APTLABEL,OTCNAPTL,DHOS6,TARANAKI,SOUTHERN,DHOS14
          MOVE      DNO,DANS12
          LOAD      DANS12,OTCNCCIM,DYES
          MOVE      DNO,DANS13
          LOAD      DANS13,OTCNALQR,DYES
          MOVE      DNO,DANS14
          LOAD      DANS14,OTCNPCXB,DYES
          MOVE      DNO,DANS16
          LOAD      DANS16,OTCNPSTC,DYES
          MOVE      DNO,DANS17
          LOAD      DANS17,OTCNLHIA,DYES
          MOVE      DNO,DANS18
          LOAD      DANS18,OTCNDCST,DYES
.
          DISPLAY   *P57:2,*V2LON,"- I.B.A Screen 2 ",*P1:3,*EF,*HOFF:
                    *P1:04," 1. Using Referral Letters                      :":
                    *P1:05," 2. Cat & Code for Letters 'Source of Referral' :":
                    *P1:06," 3. Display History at time of Booking          :":
                    *P1:07," 4. Print Labels at time of Booking             :":
                    *P1:08," 5. Discharge patient option available          :":
                    *P1:09," 6. Display cancellation reason in enquires     :":
                    *P1:10," 7. New format for view clinics                 :":
                    *P1:11," 8. Supress '?' on user defined cat 'O2' (Y/N)? :":
                    *P1:12," 9. Enter Clinic Id in Re-appointments   (Y/N)? :":
                    *P1:13,"10. Using Attendance Register file       (Y/N)? :":
                    *P1:14,"11. Print Zero Total Invoices            (Y/N)? :":
                    *P1:15,"12. Clinic List Format for OUT49 and OUT66      :":
                    *P1:16,"13. Appointment Label format                    :":
                    *P1:17,"14. Change Clinic Id option available in OUT03  :":
                    *P1:18,"15. Ask to Print Labels etc in re-appointments  :":
                    *P1:19,"16. Check for Possible Cross Bookings           :":
                    *P1:20,"17. No. of Days for Inp. Cross Booking Check    :":
                    *P1:21,"18. Default Clinic time from Id/Date            :":
                    *P1:22,"19. Using Postage Classes in IBAOUT71 (Dudley)? :":
                    *P1:23,"20. Keeping a letter history audit    (Dudley)? :":
                    *P58:05,DESCO1,*P58:15,DR49A,*V2LON:
                    *P51:04,DANS1,*P51:05,OTCNCSRF,SLASH,OTCNLSRF:
                    *P51:06,DANS3,*P51:07,DANS4:
                    *P51:08,DANS5,*P51:09,DANS6,*P51:10,DANS7,*P51:11,DANS8:
                    *P51:12,DANS9,*P51:13,DANS10,*P51:14,DANS11:
                    *P51:15,OTCNR49A,*P51:16,APTLABEL,*P51:17,DANS12:
                    *P51:18,DANS13:
                    *P51:19,DANS14:
                    *P51:20,OTCNDCXB:
                    *P51:21,DANS18:
                    *P51:22,DANS16:
                    *P51:23,DANS17
          RETURN
.
.*********************************************************************
.                   UIBB0000
.         update the fields in IBA screen 2
.*********************************************************************
UIBB0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,UIBB0100,UIBB0200,UIBB0300,UIBB0400,UIBB0500:
                           UIBB0600,UIBB0700,UIBB0800,UIBB0900,UIBB1000:
                           UIBB1100,UIBB1200,UIBB1300,UIBB1400,UIBB1500:
                           UIBB1600,UIBB1700,UIBB1800,UIBB1900,UIBB2000
KEYI2BP   BEEP
          GOTO      UIBB0000
.
.------------------------------------------------------------------------------
.         Using Referral letters ?
.------------------------------------------------------------------------------
UIBB0100  MOVE      "51",CCOL               * column
          MOVE      "04",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNULET           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.--------------------------------------------------------------------
.         Referral letters 'Source of Referral' code
.--------------------------------------------------------------------
UIBB0200  MOVE      "51",ECOL
          MOVE      "05",EVERT
          MOVE      ONE,CNEWDS
          MOVE      ONE,CKYIMAND            * is mandatory
          MOVE      OTCNCSRF,CKYIDEF3       * default value
.
          CALL      PATCATKY
          BRANCH    EXIT,UIBB0200,CANCEL
          MOVE      TCODE,OTCNCSRF
          MOVE      OTCNCSRF,CODE
.
          MOVE      "54",ECOL
          MOVE      "05",EVERT
          MOVE      OTCNLSRF,CKYIDEF3       * default value
          CALL      PATCODKY
          BRANCH    EXIT,UIBB0200:          * nothing
                         CANCEL             * exitchar
          MOVE      ACODE,OTCNLSRF          * set the value
          MOVE      TDESC,DESCO1            * set the value
          DISPLAY   *P54:05,*V2LON,OTCNLSRF,*HOFF,SP1,DESCO1
          GOTO      UIBB0000
.
.--------------------------------------------------------------------
.         Display patient history when booking ?
.--------------------------------------------------------------------
UIBB0300  MOVE      "51",CCOL
          MOVE      "06",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNDHAB           * set parameter
          GOTO      UIBB0000
.
.--------------------------------------------------------------------
.         Print Mailing/Appointment labels when booking ?
.--------------------------------------------------------------------
UIBB0400  MOVE      "51",CCOL
          MOVE      "07",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNLABB           * set parameter
          GOTO      UIBB0000
.
.------------------------------------------------------------------------------
.         Using Discharge screen ?
.------------------------------------------------------------------------------
UIBB0500  MOVE      "51",CCOL               * column
          MOVE      "08",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNDSCH           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Display cancellation reason in enquires ?
.------------------------------------------------------------------------------
UIBB0600  MOVE      "51",CCOL               * column
          MOVE      "09",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNDCRE           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         New format for display in view clinics
.------------------------------------------------------------------------------
UIBB0700  MOVE      "51",CCOL               * column
          MOVE      "10",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNNWVW           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Supress "?" on user defined cat 'O2'
.------------------------------------------------------------------------------
UIBB0800  MOVE      "51",CCOL               * column
          MOVE      "11",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNSQO2           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Enter Clinic Id in re-appointments  
.------------------------------------------------------------------------------
UIBB0900  MOVE      "51",CCOL               * column
          MOVE      "12",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNRECI           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Using Attendance register file
.------------------------------------------------------------------------------
UIBB1000  MOVE      "51",CCOL               * column
          MOVE      "13",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNUARF           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Print Zero Total Invoices
.------------------------------------------------------------------------------
UIBB1100  MOVE      "51",CCOL               * column
          MOVE      "14",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNPZIN           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Report format for Daily Clinic listing (IBAOUT49 & IBAOUT66)
.------------------------------------------------------------------------------
UIBB1200  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF:
                    "=",DR49A0,", ",*V2LON,ONE,*HOFF,"=",DR49A1;
.
          KEYIN     *P51:15,*EL,*V2LON,OTCNR49A,*P1:24,*EL;
.
          IF        OTCNR49A < 0 | OTCNR49A > 1
            BEEP
            GOTO      UIBB1200
          ENDIF
.
          MOVE      DR49A0,DR49A
          LOAD      DR49A,OTCNR49A,DR49A1
          DISPLAY   *P51:15,*V2LON,OTCNR49A,*HOFF,*P55:15,DR49A
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Appointment label format
.------------------------------------------------------------------------------
UIBB1300  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,"=B.O.P. ":
                    *V2LON,ONE,*HOFF,"=HK ":
                    *V2LON,"2",*HOFF,"=Taranaki ":
                    *V2LON,"3",*HOFF,"=Southern ":
                    *V2LON,"4",*HOFF,"=WGH Consultancies";
          KEYIN     *P51:16,*DV,UNDLN2,*EL:
                    *P51:16,*V2LON,OTCNAPTL:
                    *P51:16,*DV,OTCNAPTL
.
          COMPARE   ZERO,OTCNAPTL
          GOTO      UIBB1310 IF EQUAL       * valid
          BRANCH    OTCNAPTL,UIBB1310,UIBB1310,UIBB1310,UIBB1310
          BEEP
          GOTO      UIBB1300
.
UIBB1310  MOVE      DHOS7,APTLABEL
          LOAD      APTLABEL,OTCNAPTL,DHOS6,TARANAKI,SOUTHERN,DHOS14
          DISPLAY   *P51:16,*V2LON,APTLABEL
          GOTO      UIBB0000
.
.------------------------------------------------------------------------------
.         Change clinic Id option available in OUT03 ?
.------------------------------------------------------------------------------
UIBB1400  MOVE      "51",CCOL               * column
          MOVE      "17",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNCCIM           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Ask to print labels etc in re-appointments ?
.------------------------------------------------------------------------------
UIBB1500  MOVE      "51",CCOL               * column
          MOVE      "18",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNALQR           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Check for Possible Cross Bookings (Y/N)        
.------------------------------------------------------------------------------
UIBB1600  MOVE      "51",CCOL               * column
          MOVE      "19",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNPCXB           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         No Days for Inp. Cross Booking Check           
.------------------------------------------------------------------------------
UIBB1700  MOVE      "51",CCOL               * column
          MOVE      "20",CVERT              * row
          KEYIN     *PCCOL:CVERT,*DV,UNDLN2,*EL:
                    *PCCOL:CVERT,*V2LON,OTCNDCXB:
                    *PCCOL:CVERT,*DV,OTCNDCXB
.
          COMPARE   ONE,OTCNDCXB
          IF        @LESS
            BEEP
            GOTO      UIBB1700
          ENDIF
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Defalut clinic start time
.------------------------------------------------------------------------------
UIBB1800  MOVE      "51",CCOL
          MOVE      "21",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNDCST
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Using Postage classes in IBAOUT71 for Dudley 
.------------------------------------------------------------------------------
UIBB1900  MOVE      "51",CCOL               * column
          MOVE      "22",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNPSTC           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.------------------------------------------------------------------------------
.         Keeping a letter history audit        Dudley 
.------------------------------------------------------------------------------
UIBB2000  MOVE      "51",CCOL               * column
          MOVE      "23",CVERT              * row
          CALL      KYN0000                 * keyin Yes/No
          MOVE      EXIT,OTCNLHIA           * set value
          GOTO      UIBB0000                  * go back to select prompt
.
.
.*********************************************************************
.         write IBA controlled screen 2
.*********************************************************************
WIBB0000  WRITAB    CONTROLF,THIRTY1;*174,OTCNULET,OTCNLSRF,OTCNDHAB,OTCNLABB:
                    OTCNDSCH,OTCNDCRE,OTCNNWVW,*185,OTCNSQO2:
                    *201,OTCNRECI,OTCNUARF,OTCNPZIN,OTCNR49A:
                    *206,OTCNAPTL,OTCNCCIM,OTCNALQR:
                    *210,OTCNPCXB,OTCNDCXB,*214,OTCNPSTC:
                    *218,OTCNLHIA,*221,OTCNDCST
          WRITAB    CONTROLF,THIRTY2;*49,OTCNCSRF
          RETURN
+
.*********************************************************************
.         Display IBA screen 3
.*********************************************************************
DIBC0000  DISPLAY   *P57:2,*V2LON,"- I.B.A Screen 3 ",*P1:3,*EF
          READ      CONTROLF,THIRTY1;*213,OTCNAXCU,*222,OTCNRCVT,OTCNACRU:
                                     *224,OTCNGNUR,OTCNSLET:
                                     *226,OTCNRAPA,*227,OTCNUWDA:
                                     *237,OTCNXTPL,*245,OTCNCSLD:
                                     *248,OTCNAP12,*249,OTCNCLVE
          READ      CONTROLF,THIRTY2;*1,OTCNGPLB:
                                     *2,OTCNRCLI:
                                     *4,OTCNCTYP:
                                     *16,OTCNCLIN,*28,OTCNZEUR:
                                     *33,OTCNOPC4,*36,OTCNGSES
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OTCNRCVT,DYES
          MOVE      DNO,DANS2
          LOAD      DANS2,OTCNACRU,DYES
          MOVE      DNO,DANS3
          LOAD      DANS3,OTCNGNUR,DYES
          MOVE      DNO,DANS4
          LOAD      DANS4,OTCNSLET,DYES
          MOVE      DNO,DANS5
          LOAD      DANS5,OTCNRAPA,DYES
          MOVE      DNO,DANS6
          LOAD      DANS6,OTCNUWDA,DYES
          MOVE      DNO,DANS7
          LOAD      DANS7,OTCNXTPL,DYES
          MOVE      SP20,TDESC
          PACK      KEY5,CODECB,OTCNCSLD
          CALL      RDCODE1
          MOVE      TDESC,DIM16 
          MOVE      DNO,DANS8
          LOAD      DANS8,OTCNAP12,DYES
          MOVE      DNO,DANS10
          LOAD      DANS10,OTCNCLVE,DYES
          MOVE      DNO,DANS11
          LOAD      DANS11,OTCNAXCU,DYES
          MOVE      DNO,DANS12
          LOAD      DANS12,OTCNGPLB,DYES
          MOVE      DNO,DANS13
          LOAD      DANS13,OTCNRCLI,DYES
          MOVE      DYES,DANS14
          LOAD      DANS14,OTCNZEUR,DNO
          MOVE      DNO,DANS15
          LOAD      DANS15,OTCNOPC4,DYES
          MOVE      DNO,DANS16
          LOAD      DANS16,OTCNGSES,DYES
.
          DISPLAY   *P1:04," 1. Reschedule by Visit type also":
                    *P1:05," 2. Att'd, Re-app, Cancel, Resch, Disch. a booking by UR":
                    *P1:06," 3. Generate U/R Number in IBAOUT33  (Y/N)":
                    *P1:07," 4. Use standard letters in IBAOUT71 (Y/N)":
                    *P1:08," 5. Using Re-Appointment File        (Y/N)":
                    *P1:09," 6. Using Ward Attenders in Clinic Master (Y/N)":
                    *P1:10," 7. Using Extra Session Template in IBAOUT03 (Y/N)":
                    *P1:11," 8. Default Cancelled Session Reason for IBAOUT03 ":
                    *P1:12," 9. Using 12 hour time on Appointment Label       ":
                    *P1:13,"10. Using Clinic Leave feature ":
                    *P1:14,"11. Print All comments for U/R option in OUT72    ":
                    *P1:15,"12. Using GP Labels? (Y/N)                        ":
                    *P1:16,"13. Renaming Clinic Type & Id in Rehab? (Y/N)     ":
                    *P1:17,"14. New Definition for 'Clinic Type'              ":
                    *P1:18,"15. New Definition for 'Clinic Id'                ":
                    *P1:19,"16. Allow zero UR bookings in IBAOUT66 (Y/N)      ":
                    *P1:20,"17. Using OPCS4 coding (Y/N)":
                    *P1:21,"18. Using Group Sessions (Y/N)":
                    *P58:04,": ",*V2LON,DANS1,*HOFF:
                    *P58:05,": ",*V2LON,DANS2,*HOFF:
                    *P58:06,": ",*V2LON,DANS3,*HOFF:
                    *P58:07,": ",*V2LON,DANS4,*HOFF:
                    *P58:08,": ",*V2LON,DANS5,*HOFF:
                    *P58:09,": ",*V2LON,DANS6,*HOFF:
                    *P58:10,": ",*V2LON,DANS7,*HOFF:
                    *P58:11,": ",*V2LON,OTCNCSLD,*HOFF,SP1,DIM16:
                    *P58:12,": ",*V2LON,DANS8,*HOFF:
                    *P58:13,": ",*V2LON,DANS10,*HOFF:
                    *P58:14,": ",*V2LON,DANS11,*HOFF:
                    *P58:15,": ",*V2LON,DANS12,*HOFF:
                    *P58:16,": ",*V2LON,DANS13,*HOFF:
                    *P58:17,": ",*V2LON,OTCNCTYP,*HOFF:
                    *P58:18,": ",*V2LON,OTCNCLIN,*HOFF:
                    *P58:19,": ",*V2LON,DANS14,*HOFF:
                    *P58:20,": ",*V2LON,DANS15,*HOFF:
                    *P58:21,": ",*V2LON,DANS16,*HOFF
.
DIBC9999  RETURN
+
.*********************************************************************
.         Update values on IBA screen 3
.*********************************************************************
UIBC0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,UIBC0100,UIBC0200,UIBC0300,UIBC0400,UIBC0500:
                           UIBC0600,UIBC0700,UIBC0800,UIBC0900,UIBC1000:
                           UIBC1100,UIBC1200,UIBC1300,UIBC1400,UIBC1500:
                           UIBC1600,UIBC1700,UIBC1800
.
          BEEP
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         reschedule by visit type also ??
.------------------------------------------------------------------------------
UIBC0100  MOVE      "60",CCOL
          MOVE      "04",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNRCVT
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         attend, cancel, reschedule single booking by UR ??
.------------------------------------------------------------------------------
UIBC0200  MOVE      "60",CCOL
          MOVE      "05",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNACRU
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Generate U/R number in IBAOUT33 ?
.------------------------------------------------------------------------------
UIBC0300  MOVE      "60",CCOL
          MOVE      "6",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNGNUR
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Use standard letter option in OUT71
.------------------------------------------------------------------------------
UIBC0400  MOVE      "60",CCOL
          MOVE      "7",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNSLET
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Write to the Re-Appointment File   
.------------------------------------------------------------------------------
UIBC0500  MOVE      "60",CCOL
          MOVE      "8",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNRAPA
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Using ward attenders in the clinic master
.------------------------------------------------------------------------------
UIBC0600  MOVE      "60",CCOL
          MOVE      "9",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNUWDA
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Using the easy session template in IBAOUT03?
.------------------------------------------------------------------------------
UIBC0700  MOVE      "60",CCOL
          MOVE      "10",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNXTPL
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Default Cancelled Session Reason          
.------------------------------------------------------------------------------
UIBC0800  MOVE      TEN1,EVERT
          MOVE      "60",ECOL
          DISPLAY   *PECOL:EVERT,*EL
          MOVE      "CB",CODE
          MOVE      OTCNCSLD,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,OTCNCSLD
          BRANCH    EXIT,UPIBAQ1:
                         CANCEL
          MOVE      TDESC,DIM16
          DISPLAY   *P64:EVERT,DIM16
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Using 24 Hr Time on Appointment Label
.------------------------------------------------------------------------------
UIBC0900  MOVE      "60",CCOL
          MOVE      "12",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNAP12
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Using Clinic Leave feature?              
.------------------------------------------------------------------------------
UIBC1000  MOVE      "60",CCOL
          MOVE      "13",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNCLVE
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Print All comments for a UR for extra screens
.------------------------------------------------------------------------------
UIBC1100  MOVE      "60",CCOL
          MOVE      "14",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNAXCU
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Using GP Labels?
.------------------------------------------------------------------------------
UIBC1200  MOVE      "60",CCOL
          MOVE      "15",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNGPLB
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Rename Clinic Type & Id?
.------------------------------------------------------------------------------
UIBC1300  MOVE      "60",CCOL
          MOVE      "16",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNRCLI
          BRANCH    EXIT,UIBC0000
          UNPACK    SP30,OTCNCTYP,OTCNCLIN   * clear
          DISPLAY   *P60:17,*EL;
          DISPLAY   *P60:18,*EL;
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         New Definition for Clinic Type 
.------------------------------------------------------------------------------
UIBC1400  MOVE      "60",CCOL
          MOVE      "17",CVERT
          COMPARE   "1",OTCNRCLI             * rename?
          GOTO      UIBC1490 IF NOT EQUAL
          KEYIN     *PCCOL:CVERT,*V2LON,OTCNCTYP
          GOTO      UIBC0000
UIBC1490  DISPLAY   *P1:24,*EL,*B,"Rename option is switched off. ";
          CALL      HITENTER
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         New Definition for Clinic Id
.------------------------------------------------------------------------------
UIBC1500  MOVE      "60",CCOL
          MOVE      "18",CVERT
          COMPARE   "1",OTCNRCLI             * rename?
          GOTO      UIBC1590 IF NOT EQUAL
          KEYIN     *PCCOL:CVERT,*V2LON,OTCNCLIN
          GOTO      UIBC0000
UIBC1590  DISPLAY   *P1:24,*EL,*B,"Rename option is switched off. ";
          CALL      HITENTER
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Don't allow Zero U/R bookings in IBAOUT66
.------------------------------------------------------------------------------
UIBC1600  MOVE      "60",CCOL
          MOVE      "19",CVERT
          CALL      KYN0000
.
.         Change setting around since prompt has been changed
.
          IF        EXIT = 1
            MOVE      ZERO,OTCNZEUR
          ELSE
            MOVE      ONE,OTCNZEUR
          ENDIF
          GOTO      UIBC0000
.
.
.------------------------------------------------------------------------------
.         Using OPCS4 Coding ?
.------------------------------------------------------------------------------
UIBC1700  MOVE      "60",CCOL
          MOVE      "20",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNOPC4
          GOTO      UIBC0000
.
.------------------------------------------------------------------------------
.         Using Group Sessions ?
.------------------------------------------------------------------------------
UIBC1800  MOVE      "60",CCOL
          MOVE      "21",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNGSES
          GOTO      UIBC0000
.
.*********************************************************************
.         write IBA controlled screen 3
.*********************************************************************
WIBC0000  WRITAB    CONTROLF,THIRTY1;*213,OTCNAXCU,*222,OTCNRCVT,OTCNACRU:
                                     *224,OTCNGNUR,OTCNSLET:
                                     *226,OTCNRAPA,*227,OTCNUWDA:
                                     *237,OTCNXTPL,*245,OTCNCSLD:
                                     *248,OTCNAP12,*249,OTCNCLVE
          WRITAB    CONTROLF,THIRTY2;*1,OTCNGPLB:
                                     *2,OTCNRCLI:
                                     *4,OTCNCTYP:
                                     *16,OTCNCLIN,*28,OTCNZEUR:
                                     *33,OTCNOPC4,*36,OTCNGSES
.
WIBC9999  RETURN
+
.*********************************************************************
.*                  DISPQTE1                    Called by : PIBA3000 * 
.*        Display the IBA quote screen 1                             *
.********************************************************************* 
DISPQTE1  READ      CONTROLF,THIRTY1;*150,OTCNOPIS,*151,OTCNCS54,*153,OTCNAVIS:
                    OTCNSTVT,OTCNSUPX,OTCNIR66,OTCNRUSE:
                    *184,OTCNDCMB,*200,OTCNUDDC,*205,OTCNXDBS,*228,OTCNMSIR:
                    OTCNDCLR,OTCNHSPS,OTCNPMIR,OTCNDBRS,OTCNDACL,*238,OTCNGLVT:
                    *239,OTCNOCRD,*242,OTCNOCDD
.
          MOVE      DNO,QUOTE101
          LOAD      QUOTE101,OTCNOPIS,DYES 
          MOVE      DNO,QUOTE102
          LOAD      QUOTE102,OTCNCS54,DYES 
          MOVE      DNO,QUOTE103
          LOAD      QUOTE103,OTCNAVIS,DYES 
          MOVE      DNO,QUOTE104
          LOAD      QUOTE104,OTCNSTVT,DYES 
          MOVE      DNO,QUOTE105
          LOAD      QUOTE105,OTCNSUPX,DYES 
          MOVE      DNO,QUOTE106
          LOAD      QUOTE106,OTCNIR66,DYES 
          MOVE      DNO,QUOTE107
          LOAD      QUOTE107,OTCNRUSE,DYES
          MOVE      DNO,QUOTE108
          LOAD      QUOTE108,OTCNDCMB,DYES
          MOVE      DNO,QUOTE109
          LOAD      QUOTE109,OTCNUDDC,DYES
          MOVE      DNO,QUOTE110
          LOAD      QUOTE110,OTCNXDBS,DYES
          MOVE      DNO,QUOTE111
          LOAD      QUOTE111,OTCNMSIR,DYES
          MOVE      DNO,QUOTE112
          LOAD      QUOTE112,OTCNDCLR,DYES
          MOVE      DNO,QUOTE113
          LOAD      QUOTE113,OTCNHSPS,DYES
          MOVE      DNO,QUOTE114
          LOAD      QUOTE114,OTCNPMIR,DYES
          MOVE      DNO,QUOTE115
          LOAD      QUOTE115,OTCNDBRS,DYES
          MOVE      SP20,TDESC
          MATCH     SP3,OTCNDACL
          IF        !@EQUAL
            MOVE      "CL",CODE
            PACK      KEY5,CODE,OTCNDACL
            CALL      RDCODE1
            MOVE      TDESC,DIM9
          ENDIF
          MOVE      TDESC,DIM9
          MOVE      DNO,QUOTE116
          LOAD      QUOTE116,OTCNGLVT,DYES
.
          MOVE      SP20,TDESC
          MATCH     SP3,OTCNOCRD
          IF        !@EQUAL
            MOVE      "OZ",CODE
            PACK      KEY5,CODE,OTCNOCRD
            CALL      RDCODE1
          ENDIF
          MOVE      TDESC,DIM9A
.
          MOVE      SP20,TDESC
          MATCH     SP3,OTCNOCDD
          IF        !@EQUAL
            MOVE      "OZ",CODE
            PACK      KEY5,CODE,OTCNOCDD
            CALL      RDCODE1
          ENDIF
          MOVE      TDESC,DIM9B
.
.         display the screen
.
          DISPLAY   *P57:2,*V2LON,"- Special Screen 1 ",*P1:3,*EF:
                    *P5:3,*ULON,"Quote",*P11:3,"  Date  ",*HOFF:
                    *P1:4," 1. ",*V2LON,*P5:4," 6522",*P11:4,"09/10/90",*HOFF:
                    *P20:4,"Open Session when inserting new masters (Y/N): ":
                    *P1:5," 2. ",*V2LON,*P5:5," 6836",*P11:5,"15/01/91",*HOFF:
                    *P20:5,"Printing Cancelled clinics in IBAOUT54? (Y/N): ":
                    *P1:6," 3. ",*V2LON,*P5:6," 6994",*P11:6,"01/08/91",*HOFF:
                    *P20:6,"Allocate visit type when booking        (Y/N): ":
                    *P1:7," 4. ",*V2LON,*P5:7," 6994",*P11:7,"01/08/91",*HOFF:
                    *P20:7,"Slot times visit type controlled        (Y/N): ":
                    *P1:8," 5. ",*V2LON,*P5:8," 6994",*P11:8,"01/08/91",*HOFF:
                    *P20:8,"Suppress extended slots on displays     (Y/N): ":
                    *P1:9," 6. ",*V2LON,*P5:9," 7108",*P11:9,"01/10/91",*HOFF:
                    *P20:9,"Input referral details in IBAOUT66      (Y/N): ":
                    *P1:10," 7. ",*V2LON,*P5:10," 7034",*P11:10:
                           "04/10/91",*HOFF:
                    *P20:10,"RUS Automated Outpatient Proc Extract   (Y/N): ":
                    *P1:11," 8. ",*V2LON,*P5:11," 7077",*P11:11:
                           "20/05/91",*HOFF:
                    *P20:11,"Display Patient History Booking Time    (Y/N): ":
                    *P1:12," 9. ",*V2LON,*P5:12," 7390",*P11:12:
                           "12/11/92",*HOFF:
                    *P20:12,"Using Default Doctor Code   OUT03/OUT66 (Y/N): ":
                    *P1:13,"10. ",*V2LON,*P5:13," 7415 09/12/92",*HOFF:
                    *P20:13,"Extra details for Daily Bkng Sched out39(Y/N): ":
                    *P1:14,"11. ",*V2LON,*P5:14,"440003 06/1993",*HOFF:
                    *P20:14,"Using Month search in Reappointments    (Y/N): ":
                    *P1:15,"12. ",*V2LON,*P5:15,"440003 06/1993",*HOFF:
                    *P20:15,"Default Clinic ID  on Reappointment     (Y/N): ":
                    *P1:16,"13. ",*V2LON,*P5:16,"440003 06/1993",*HOFF:
                    *P20:16,"Using Hospital in search Reappointments (Y/N): ":
                    *P1:17,"14. ",*V2LON,*P5:17,"440003 06/1993",*HOFF:
                    *P20:17,"Not having PMI Screens in Reappointments(Y/N): ":
                    *P1:18,"15. ",*V2LON,*P5:18,"440003 06/1993",*HOFF:
                    *P20:18,"Using Diff Booking/Reappointment Screens(Y/N): ":
                    *P1:19,"16. ",*V2LON,*P5:19,"440003 06/1993",*HOFF:
                    *P20:19,"Default Administrative Category (Cat CL)     : ":
                    *P1:20,"17. ",*V2LON,*P5:20,"440004 07/1993",*HOFF:
                    *P20:20,"Select Group Labels by Visit Type ?     (Y/N): ":
                    *P1:21,"18. ",*V2LON,*P5:21,"440256 09/1993",*HOFF:
                    *P20:21,"Outcome Reappointment default code   (Cat OZ): ":
                    *P1:22,"19. ",*V2LON,*P5:22,"440256 09/1993",*HOFF:
                    *P20:22,"Outcome Discharge default code       (Cat OZ): "
.
.         display the values
.
          DISPLAY   *V2LON:
                    *P67:04,QUOTE101,*P67:05,QUOTE102,*P67:06,QUOTE103:
                    *P67:07,QUOTE104,*P67:08,QUOTE105,*P67:09,QUOTE106:
                    *P67:10,QUOTE107,*P67:11,QUOTE108,*P67:12,QUOTE109:
                    *P67:13,QUOTE110,*P67:14,QUOTE111,*P67:15,QUOTE112:
                    *P67:16,QUOTE113,*P67:17,QUOTE114,*P67:18,QUOTE115:
                    *P67:19,*V2LON,OTCNDACL,*HOFF,SP1,DIM9:
                    *P67:20,*V2LON,QUOTE116:
                    *P67:21,*V2LON,OTCNOCRD,*HOFF,SP1,DIM9A:
                    *P67:22,*V2LON,OTCNOCDD,*HOFF,SP1,DIM9B
.
          RETURN
.
.********************************************************************* 
.*                  UPIBAQ1                     Called by : DOIBAQ1  * 
.*        Update the values on quote screen 1                        *
.********************************************************************* 
UPIBAQ1   CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,UQTA0100,UQTA0200,UQTA0300,UQTA0400,UQTA0500:
                           UQTA0600,UQTA0700,UQTA0800,UQTA0900,UQTA1000:
                           UQTA1100,UQTA1200,UQTA1300,UQTA1400,UQTA1500:
                           UQTA1600,UQTA1700,UQTA1800,UQTA1900
.
          BEEP
          GOTO      UPIBAQ1                 * invalid item selected
.
.         OPTION 01 open sessions when inserting new masters ?
.
UQTA0100  MOVE      "67",CCOL
          MOVE      "4",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNOPIS
          GOTO      UPIBAQ1 
.
.         OPTION 02 printing cancelled clinics in IBAOUT54 ?
.
UQTA0200  MOVE      "67",CCOL
          MOVE      "5",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNCS54
          GOTO      UPIBAQ1 
.
.         OPTION 03 - allocate visit type when booking ?
.
UQTA0300  MOVE      "67",CCOL
          MOVE      "6",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNAVIS
          GOTO      UPIBAQ1 
.
.         OPTION 04 - slot times visit type controlled ?
.
UQTA0400  MOVE      "67",CCOL
          MOVE      "7",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNSTVT
          GOTO      UPIBAQ1 
.
.         OPTION 05 - suppress extended slots on display ? 
.
UQTA0500  MOVE      "67",CCOL
          MOVE      "8",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNSUPX
          GOTO      UPIBAQ1 
.
.         OPTION 06 - input referral details in IBAOUT66 ? 
.
UQTA0600  MOVE      "67",CCOL
          MOVE      "9",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNIR66
          GOTO      UPIBAQ1 
.
.         OPTION 07 - RUS Automated OP Procedure extract ?
.
UQTA0700  MOVE      "67",CCOL
          MOVE      "10",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNRUSE
          GOTO      UPIBAQ1 
.
.         OPTION 08 - Display Comments at time of Booking ?
.
UQTA0800  MOVE      "67",CCOL
          MOVE      "11",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNDCMB
          GOTO      UPIBAQ1 
.
.         OPTION 09 - Using Default doctor code in OUT03 / OUT66
.
UQTA0900  MOVE      "67",CCOL
          MOVE      "12",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNUDDC
          GOTO      UPIBAQ1 
.
.         OPTION 10 - Extra details for Daily Booking Schedule (Out39)
.
UQTA1000  MOVE      "67",CCOL
          MOVE      "13",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNXDBS
          GOTO      UPIBAQ1 
.
.------------------------------------------------------------------------------
.         Using month search in re-appointments    
.------------------------------------------------------------------------------
UQTA1100  MOVE      "67",CCOL
          MOVE      "14",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNMSIR
          GOTO      UPIBAQ1 
.
.------------------------------------------------------------------------------
.         Default clini-id in reappointments       
.------------------------------------------------------------------------------
UQTA1200  MOVE      "67",CCOL
          MOVE      "15",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNDCLR
          GOTO      UPIBAQ1 
.
.------------------------------------------------------------------------------
.         Use Hospital in search criteria for reappointments
.------------------------------------------------------------------------------
UQTA1300  MOVE      "67",CCOL
          MOVE      "16",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNHSPS
          GOTO      UPIBAQ1       
.
.------------------------------------------------------------------------------
.         Not Using PMI screens in reappointments      
.------------------------------------------------------------------------------
UQTA1400  MOVE      "67",CCOL
          MOVE      "17",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNPMIR
          GOTO      UPIBAQ1       
.
.------------------------------------------------------------------------------
.         Using different Booking/Reappointment Screens
.------------------------------------------------------------------------------
UQTA1500  MOVE      "67",CCOL
          MOVE      "18",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNDBRS
          GOTO      UPIBAQ1       
.
.------------------------------------------------------------------------------
.         Default Administrative Category CL        
.------------------------------------------------------------------------------
UQTA1600  MOVE      TEN9,EVERT
          MOVE      "67",ECOL
          DISPLAY   *PECOL:EVERT,*EL
          MOVE      "CL",CODE
          MOVE      OTCNDACL,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,OTCNDACL
          BRANCH    EXIT,UPIBAQ1:
                         CANCEL
          MOVE      TDESC,DIM9
          DISPLAY   *P71:EVERT,DIM9 
          GOTO      UPIBAQ1       
.
.------------------------------------------------------------------------------
.         Select Group Labels by Visit Type ?            
.------------------------------------------------------------------------------
UQTA1700  MOVE      "67",CCOL
          MOVE      "20",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNGLVT
          GOTO      UPIBAQ1       
.
.
.------------------------------------------------------------------------------
.         Default Outcome for Reappointments        
.------------------------------------------------------------------------------
UQTA1800  MOVE      "21",EVERT
          MOVE      "67",ECOL
          DISPLAY   *PECOL:EVERT,*EL
          MOVE      "OZ",CODE
          MOVE      OTCNOCRD,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,OTCNOCRD
          BRANCH    EXIT,UPIBAQ1:
                         CANCEL
          MOVE      TDESC,DIM9A
          DISPLAY   *P71:EVERT,DIM9A
          GOTO      UPIBAQ1       
.
.------------------------------------------------------------------------------
.         Default Outcome for discharges            
.------------------------------------------------------------------------------
UQTA1900  MOVE      "22",EVERT
          MOVE      "67",ECOL
          DISPLAY   *PECOL:EVERT,*EL
          MOVE      "OZ",CODE
          MOVE      OTCNOCDD,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          MOVE      ACODE,OTCNOCDD
          BRANCH    EXIT,UPIBAQ1:
                         CANCEL
          MOVE      TDESC,DIM9B
          DISPLAY   *P71:EVERT,DIM9B
          GOTO      UPIBAQ1       
.
+
.********************************************************************* 
.*                  WRIBAQ1                     Called by : DOIBAQ1  * 
.*        Write the new values for quote screen 1                    *
.********************************************************************* 
WRIBAQ1   WRITAB    CONTROLF,THIRTY1;*150,OTCNOPIS,*151,OTCNCS54,*153,OTCNAVIS:
                    OTCNSTVT,OTCNSUPX,OTCNIR66,OTCNRUSE:
                    *184,OTCNDCMB,*200,OTCNUDDC,*205,OTCNXDBS,*228,OTCNMSIR:
                    OTCNDCLR,OTCNHSPS,OTCNPMIR,OTCNDBRS,OTCNDACL,*238,OTCNGLVT:
                    *239,OTCNOCRD,*242,OTCNOCDD
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WRIBAQ19  RETURN
+
+
.*********************************************************************
.*                  DISPQTE2                    Called by : PIBA5000 * 
.*        Display the IBA quote screen 2                             *
.********************************************************************* 
DISPQTE2  READ      CONTROLF,THIRTY2;*2,OTCNUBLR,*32,OTCNDBTM
.
          MOVE      DNO,QUOTE101
          LOAD      QUOTE101,OTCNUBLR,DYES 
          MOVE      DNO,QUOTE102
          LOAD      QUOTE102,OTCNDBTM,DYES 
.
.         display the screen
.
          DISPLAY   *P57:2,*V2LON,"- Special Screen 2 ",*P1:3,*EF:
                    *P5:3,*ULON,"Quote",*P11:3,"  Date  ",*HOFF:
                    *P1:4," 1. ",*V2LON,*P5:4," 7855",*P11:4,"22/06/94",*HOFF:
                    *P20:4,"Using Block Reappointments (Y/N)             ":
                     "       : ":
                    *P1:5," 2. ",*V2LON,*P5:5," 8016",*P11:5,"31/08/94",*HOFF:
                    *P20:5,"Extract bookings using time field in IBAOUT39":
                     " (Y/N) : " 
.
.         display the values
.
          DISPLAY   *V2LON:
                    *P74:04,QUOTE101:
                    *P74:05,QUOTE102
.
          RETURN
.
.********************************************************************* 
.*                  UPIBAQ2                     Called by : DOIBAQ1  * 
.*        Update the values on quote screen 2                        *
.********************************************************************* 
UPIBAQ2   CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,UQTB0100,UQTB0200
.
          BEEP
          GOTO      UPIBAQ2                 * invalid item selected
.
.         OPTION 01 open sessions when inserting new masters ?
.
UQTB0100  MOVE      "74",CCOL
          MOVE      "4",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNUBLR
          GOTO      UPIBAQ2 
.
.         OPTION 02 Extract bookings using Clinic Start Time in IBAOUT39 ?
.
UQTB0200  MOVE      "74",CCOL
          MOVE      "5",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNDBTM
          GOTO      UPIBAQ2 
.
+
.********************************************************************* 
.*                  WRIBAQ2                     Called by : DOIBAQ2  * 
.*        Write the new values for quote screen 2                    *
.********************************************************************* 
WRIBAQ2   WRITAB    CONTROLF,THIRTY2;*2,OTCNUBLR,*32,OTCNDBTM
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WRIBAQ29  RETURN
.
+
.*********************************************************************
.                   KYN0000
.         Yes/No standard keyin
.*********************************************************************
KYN0000  KEYIN      *PCCOL:CVERT,*DV,SP3:    * clear previous display
                    *PCCOL:CVERT,*DV,UNDLN1:
                    *PCCOL:CVERT,*V2LON,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KYN9000 IF EQUAL         * yes, invalid
.
          REP       "Y1y1N0n0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KYN9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DNO,DANS1                * assume answer was "No "
          LOAD      DANS1,EXIT,DYES,DNO      * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DANS1
          GOTO      KYN9999
.
KYN9000   BEEP
          GOTO      KYN0000
.
KYN9999   RETURN
+
.*********************************************************************
.         Display IBA screen 4
.*********************************************************************
DIBD0000  DISPLAY   *P57:2,*V2LON,"- I.B.A Screen 4 ",*P1:3,*EF
          READ      CONTROLF,THIRTY2;*41,OTCNURVS,OTCNOVBK,OTCNXTSF,OTCNNCOC:
                                     OTCNURDS,OTCNUBKT,OTCNSRBU,*51,OTCNLTPR:
                                     OTCNGLCU,*108,OTCNCREV
.
          MOVE      DNO,DANS1
          LOAD      DANS1,OTCNURVS,DYES
          MOVE      DNO,DANS2
          LOAD      DANS2,OTCNOVBK,DYES
          MOVE      DNO,DANS3
          LOAD      DANS3,OTCNXTSF,DYES
          MOVE      DNO,DANS4
          LOAD      DANS4,OTCNNCOC,DYES
          MOVE      DNO,DANS5
          LOAD      DANS5,OTCNURDS,DYES
          MOVE      DNO,DANS6
          LOAD      DANS6,OTCNUBKT,DYES
          MOVE      DSRBU0,DSRBUD
          LOAD      DSRBUD,OTCNSRBU,DSRBU1,DSRBU2
          MOVE      DNO,DANS7
          LOAD      DANS7,OTCNLTPR,DYES
          MOVE      DNO,DANS8
          LOAD      DANS8,OTCNGLCU,DYES
          MOVE      DNO,DANS9
          LOAD      DANS9,OTCNCREV,DYES
.
          DISPLAY   *P1:04," 1. Using Reserved Slots (Y/N)               ":
                    *P1:05," 2. Using Overbooking Rules (Y/N)            ":
                    *P1:06," 3. Using Extra Staff (Y/N)                  ":
                    *P1:07," 4. Using Non-Consultant Clinics (Y/N)       ":
                    *P1:08," 5. Using Reduced Clinics (Y/N)              ":
                    *P1:09," 6. Using Outpatients Tests (Y/N)            ":
                    *P1:10," 7. See Referral letters when booking by U/R ":
                    *P1:11," 8. Print Letters From IBAOUT66 (Y/N)        ":
                    *P1:12," 9. Using Global Clinic Update (Y/N)         ":
                    *P1:13,"10. Change Cancelled/Rescheduled slots to ":
                            "Reviews (Y/N) ":
                    *P58:04,": ",*V2LON,DANS1,*HOFF:
                    *P58:05,": ",*V2LON,DANS2,*HOFF:
                    *P58:06,": ",*V2LON,DANS3,*HOFF:
                    *P58:07,": ",*V2LON,DANS4,*HOFF:
                    *P58:08,": ",*V2LON,DANS5,*HOFF:
                    *P58:09,": ",*V2LON,DANS6,*HOFF:
                    *P58:10,": ",*V2LON,OTCNSRBU,*HOFF,*P65:10,DSRBUD:
                    *P58:11,": ",*V2LON,DANS7,*HOFF:
                    *P58:12,": ",*V2LON,DANS8,*HOFF:
                    *P58:13,": ",*V2LON,DANS9,*HOFF
.
DIBD9999  RETURN
+
.*********************************************************************
.         Update values on IBA screen 4
.*********************************************************************
UIBD0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL           * post selected
          GOTO      CANCEL IF LESS          * cancel selected
.
          BRANCH    CCITEM,UIBD0100,UIBD0200,UIBD0300,UIBD0400,UIBD0500:
                           UIBD0600,UIBD0700,UIBD0800,UIBD0900,UIBD1000
.
          BEEP
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         using reserved slots ??
.------------------------------------------------------------------------------
UIBD0100  MOVE      "60",CCOL
          MOVE      "04",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNURVS
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         using overbooking rules ??
.------------------------------------------------------------------------------
UIBD0200  MOVE      "60",CCOL
          MOVE      "05",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNOVBK
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         using extra staff ??
.------------------------------------------------------------------------------
UIBD0300  MOVE      "60",CCOL
          MOVE      "6",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNXTSF
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         using non-consultant clinics ??
.------------------------------------------------------------------------------
UIBD0400  MOVE      "60",CCOL
          MOVE      "7",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNNCOC
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         using reduced clinics ??
.------------------------------------------------------------------------------
UIBD0500  MOVE      "60",CCOL
          MOVE      "8",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNURDS
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         using outpatient tests ??
.------------------------------------------------------------------------------
UIBD0600  MOVE      "60",CCOL
          MOVE      "9",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNUBKT
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         display referral letters when booking by U/R ??
.------------------------------------------------------------------------------
UIBD0700  MOVE      "60",CCOL
          MOVE      "10",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,OTCNSRBU
          COMPARE   ZERO,OTCNSRBU
          GOTO      UIBD0750 IF EQUAL
          BRANCH    OTCNSRBU,UIBD0750,UIBD0750
          BEEP
          GOTO      UIBD0700
.
UIBD0750  MOVE      DSRBU0,DSRBUD
          LOAD      DSRBUD,OTCNSRBU,DSRBU1,DSRBU2
          DISPLAY   *P60:10,*V2LON,OTCNSRBU,*HOFF,*P65:10,DSRBUD
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         Printing letters in OUT66 ?
.------------------------------------------------------------------------------
UIBD0800  MOVE      "60",CCOL
          MOVE      "11",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNLTPR
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         Printing letters in OUT66 ?
.------------------------------------------------------------------------------
UIBD0900  MOVE      "60",CCOL
          MOVE      "12",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNGLCU
          GOTO      UIBD0000
.
.------------------------------------------------------------------------------
.         Change cancelled and rescheduled slot back to review types
.------------------------------------------------------------------------------
UIBD1000  MOVE      "60",CCOL
          MOVE      "13",CVERT
          CALL      KYN0000
          MOVE      EXIT,OTCNCREV
          GOTO      UIBD0000
.
.*********************************************************************
.         write IBA screen 4
.*********************************************************************
WIBD0000  DISPLAY   *P57:2,*V2LON,"- I.B.A Screen 4 ",*P1:3,*EF
          WRITAB    CONTROLF,THIRTY2;*41,OTCNURVS,OTCNOVBK,OTCNXTSF,OTCNNCOC:
                                     OTCNURDS,OTCNUBKT,OTCNSRBU,*51,OTCNLTPR:
                                     OTCNGLCU,*108,OTCNCREV
WIBD9999  RETURN
+
. ----------------------------------------- Start of additional code    I-90202
.**********************************************************************
.*                            IDGP0000                                *
.*                     Display Interface Engine screen                *
.**********************************************************************
.
IDGP0000  READ      CONTROLF,THIRTY1;*250,OTCNDGCL
          READ      CONTROLF,THIRTY2;*102,OTCNDGON,*103,OTCNDGOR:
                                     *104,OTCNDGOC,*105,OTCNDGOD:
                                     *106,OTCNDGOA,*107,OTCNDGOB
.
          MOVE      DNO,DANS71
          LOAD      DANS71,OTCNDGON,DYES,DNO
.
          MOVE      DNO,DANS72
          LOAD      DANS72,OTCNDGOA,DYES,DNO
.
          MOVE      DNO,DANS73
          LOAD      DANS73,OTCNDGOR,DYES,DNO
.
          MOVE      DNO,DANS74
          LOAD      DANS74,OTCNDGOC,DYES,DNO
.
          MOVE      DNO,DANS75
          LOAD      DANS75,OTCNDGOD,DYES,DNO
.
          MOVE      DNO,DANS76
          LOAD      DANS76,OTCNDGOB,DYES,DNO
.
          MOVE      DNO,DANS77
          LOAD      DANS77,OTCNDGCL,DYES,DNO
.
          DISPLAY   *P56:2,*V2LON," - Interface Engine ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Send message CON after O/P New Appointment ?":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Send message COA after O/P Confirm Appointment ?":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Send message COR after O/P Re-sched Appointment ?":
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "Send message COC after O/P Cancel Appointment ?":
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "Send message COD after O/P DNA (Did not attend) ?":
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "Send message COB after O/P Booking Detail Change?":
                    *P1:10,*V2LON," 7",*HOFF,". ":
                    "Always send clinic id in O/P messages ?":
                    *P57:04,": ",*V2LON,DANS71,*HOFF:
                    *P57:05,": ",*V2LON,DANS72,*HOFF:
                    *P57:06,": ",*V2LON,DANS73,*HOFF:
                    *P57:07,": ",*V2LON,DANS74,*HOFF:
                    *P57:08,": ",*V2LON,DANS75,*HOFF:
                    *P57:09,": ",*V2LON,DANS76,*HOFF:
                    *P57:10,": ",*V2LON,DANS77,*HOFF
.
IDGP9999  RETURN
+
.**********************************************************************
.*                            ICIS0000                                *
.*                     Display PAS-CIS Interface Screen               *
.**********************************************************************
.
ICIS0000  READ      CONTROLF,THIRTY2;*110,OTCNA05M
.
          MOVE      DNO,DANS71
          LOAD      DANS71,OTCNA05M,DYES,DNO
.
          DISPLAY   *P56:2,*V2LON," - PAS-CIS Interface ",*P1:3,*EF:
                    *P1:4,*V2LON," 1",*HOFF,". ":
                    "Send A05 message after O/P New Appointment ?":
                    *P57:04,": ",*V2LON,DANS71,*HOFF
.
ICIS9999  RETURN
+
.***********************************************************************
.*  UDGP0000  :  Status Adjustment Fields
.***********************************************************************
UDGP0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      UDGP9999 IF EQUAL
          GOTO      UDGP9000 IF LESS
.
          MOVE      "59",CCOL
          BRANCH    CCITEM,UDGP0100:
                           UDGP0200:
                           UDGP0300:
                           UDGP0400:
                           UDGP0500:
                           UDGP0600:
                           UDGP0700
.
          BEEP
          GOTO      UDGP0000
.
. Write subsidary system after O/P New Appointment?
.
UDGP0100  MOVE      "4",CVERT
          MOVE      OTCNDGON,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGON
          GOTO      UDGP0000
.
. Write subsidary system after O/P Confirm Appointment?
.
UDGP0200  MOVE      "5",CVERT
          MOVE      OTCNDGOA,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGOA
          GOTO      UDGP0000
.
. Write subsidary system after O/P Re-schedule Appointment?
.
UDGP0300  MOVE      "6",CVERT
          MOVE      OTCNDGOR,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGOR
          GOTO      UDGP0000
.
. Write subsidary system after O/P Cancel Appointment?
.
UDGP0400  MOVE      "7",CVERT
          MOVE      OTCNDGOC,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGOC
          GOTO      UDGP0000
.
. Write subsidary system after O/P DNA "Did Not Attend"?
.
UDGP0500  MOVE      "8",CVERT
          MOVE      OTCNDGOD,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGOD
          GOTO      UDGP0000
.
. Write subsidary system after O/P  Booking Detail Change
.
UDGP0600  MOVE      "9",CVERT
          MOVE      OTCNDGOB,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGOB
          GOTO      UDGP0000
.
. Always send clinic id in O/P broadcast messages
.
UDGP0700  MOVE      "10",CVERT
          MOVE      OTCNDGCL,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNDGCL
          GOTO      UDGP0000
.
UDGP9000  MOVE      TRUE,EXIT
.
UDGP9999  MOVE      EXIT,OVRCD
          RETURN
+
.***********************************************************************
.*  UCIS0000  :  Status Adjustment Fields
.***********************************************************************
.
UCIS0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      UCIS9999 IF EQUAL
          GOTO      UCIS9000 IF LESS
.
          MOVE      "59",CCOL
          BRANCH    CCITEM,UCIS0100
.
          BEEP
          GOTO      UCIS0000
.
.         Send HL7 A05 after new O/P appointment?
.
UCIS0100  MOVE      "4",CVERT
          MOVE      OTCNA05M,ANS
          CALL      KYN0000
          MOVE      EXIT,OTCNA05M
          GOTO      UCIS0000
.
UCIS9000  MOVE      TRUE,EXIT
.
UCIS9999  MOVE      EXIT,OVRCD
          RETURN
+
.**********************************************************************
.*                            WDGP0000                                *
.*                      Write Interface Engine set uP                 *
.**********************************************************************
.
WDGP0000  WRITAB    CONTROLF,THIRTY1;*250,OTCNDGCL
          WRITAB    CONTROLF,THIRTY2;*102,OTCNDGON,*103,OTCNDGOR:
                                     *104,OTCNDGOC,*105,OTCNDGOD:
                                     *106,OTCNDGOA,*107,OTCNDGOB
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
. ----------------------------------------- End of additional code      I-90202
.**********************************************************************
.*                            WCIS0000                                *
.*                      Write PAS-CIS Interface                       *
.**********************************************************************
.
WCIS0000  WRITAB    CONTROLF,THIRTY2;*110,OTCNA05M
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
+
          INC       STD001IO
          INC       STDHLPCD
          INC       IBASECUR                * Keyin IBA screen security passwd
          INC       IBATMHKY
          INC       PATCATKY
          INC       PATCODKY
          INC       TFILENAM
          INC       GENCODKY
          INC       IBATMHIO/INC
          INC       IBASEQIO/INC
          INC       PATCODIO/INC
q
          INC       WEBERRIO/INC

.............................................................................
