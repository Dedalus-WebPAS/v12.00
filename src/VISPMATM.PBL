. *----------------------------------------------------------------------
. * Include Name  :   VISPMATM.PBL
. *
. * Function      :   CGI variables for VISPMAFD - vispmaaf.dat
. *
. * Modifications :
. * V9.08.00  22/11/2006  Mike Laming   CAR 103368
. *           CCPS EDI Extract - ported from 9.07
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for visit based payer account details file
.------------------------------------------------------------------------
.
CPVSPM00  MOVE      Z70,VSPMA001
          MOVE      Z70,VSPMA002
          MOVE      Z70,VSPMA003
          MOVE      Z70,VSPMA004
          MOVE      Z70,VSPMA005
          MOVE      Z70,VSPMA006
          MOVE      Z70,VSPMA007
          MOVE      Z70,VSPMA008
          MOVE      Z70,VSPMA009
          MOVE      Z70,VSPMA010
          MOVE      Z70,VSPMA011
          MOVE      Z70,VSPMA012
          MOVE      Z70,VSPMA013
          MOVE      Z70,VSPMA014
.
CPVSPM99  RETURN
.
CLVISPMA  UNPACK    SP70,VSPMVISN,VSPMPAYC,VSPMMACN
          UNPACK    SP70,VSPMMNAM
          UNPACK    SP70,VSPMRLTP,VSPMMPID,VSPMMPIT,VSPMMAD1
          UNPACK    SP70,VSPMMAD2,VSPMMAD3
          UNPACK    SP70,VSPMMAD4,VSPMMPCD
          UNPACK    SP70,VSPMCDAT,VSPMCTIM,VSPMCUID
          UNPACK    SP70,VSPMUDAT,VSPMUTIM,VSPMUUID,VSPMSPAR
          MOVE      ZERO,VSPMEAMT
          MOVE      ZERO,VSPMEPEC
.
          MOVE      "CCPS  ",VSPMPAYC       * CCPS default
.
CLVSPM99  RETURN
.
.------------------------------------------------------------
. Add visit based payor Account info file
.------------------------------------------------------------
VSPM0000  BRANCH    FLDITMNO,VSPM0010,VSPM0020,VSPM0030,VSPM0040,VSPM0050:
                             VSPM0060,VSPM0070,VSPM0080,VSPM0090,VSPM0100:
                             VSPM0110,VSPM0120,VSPM0130,VSPM0140
.         
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      VSPM9999
.
VSPM0010  WRITE     HTMLFILE;VSPMVISN;
          GOTO      VSPM9999
.
VSPM0020  WRITE     HTMLFILE;VSPMPAYC;
          GOTO      VSPM9999
.
VSPM0030  WRITE     HTMLFILE;VSPMMACN;
          GOTO      VSPM9999
.
VSPM0040  WRITE     HTMLFILE;VSPMMNAM;
          GOTO      VSPM9999
.
VSPM0050  MOVE      "RL",CATEGORY
          MOVE      VSPMRLTP,CODE
          CALL      CODITM00
          GOTO      VSPM9999
.
VSPM0060  WRITE     HTMLFILE;VSPMMPID;
          GOTO      VSPM9999
.
VSPM0070  MOVE      "AI",CATEGORY
          MOVE      VSPMMPIT,CODE
          CALL      CODITM00
          GOTO      VSPM9999
.
VSPM0080  WRITE     HTMLFILE;VSPMMAD1;
          GOTO      VSPM9999
.
VSPM0090  WRITE     HTMLFILE;VSPMMAD2;
          GOTO      VSPM9999
.
VSPM0100  WRITE     HTMLFILE;VSPMMAD3;
          GOTO      VSPM9999
.
VSPM0110  WRITE     HTMLFILE;VSPMMAD4;
          GOTO      VSPM9999
.
VSPM0120  WRITE     HTMLFILE;VSPMMPCD;
          GOTO      VSPM9999
.
VSPM0130  WRITE     HTMLFILE;VSPMEAMT;
          GOTO      VSPM9999
.
VSPM0140  WRITE     HTMLFILE;VSPMEPEC;
          GOTO      VSPM9999
.
VSPM9999  RETURN
.
.
.
.------------------------------------------------------------
.   Set Parameters for visit based payer account details file
.------------------------------------------------------------
SPVSPM00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3 
          MOVE      KEY3,F3    
          BRANCH    F3,SPVSPM01,SPVSPM02,SPVSPM03,SPVSPM04,SPVSPM05:
                       SPVSPM06,SPVSPM07,SPVSPM08,SPVSPM09,SPVSPM10:
                       SPVSPM11,SPVSPM12,SPVSPM13,SPVSPM14
.
          MOVE      ONE,EXIT
          GOTO      SPVSPM99
.
SPVSPM01  PACK      VSPMA001,QRYDATA,SP70
          GOTO      SPVSPM99   
.         
SPVSPM02  PACK      VSPMA002,QRYDATA,SP70
          GOTO      SPVSPM99   
.
SPVSPM03  PACK      VSPMA003,QRYDATA,SP70
          GOTO      SPVSPM99
.
SPVSPM04  MOVE      QRYDATA,VSPMA004
          GOTO      SPVSPM99
.
SPVSPM05  MOVE      QRYDATA,VSPMA005
          GOTO      SPVSPM99
.
SPVSPM06  MOVE      QRYDATA,VSPMA006
          GOTO      SPVSPM99
.
SPVSPM07  MOVE      QRYDATA,VSPMA007
          GOTO      SPVSPM99
.
SPVSPM08  MOVE      QRYDATA,VSPMA008
          GOTO      SPVSPM99
.
SPVSPM09  MOVE      QRYDATA,VSPMA009
          GOTO      SPVSPM99
.
SPVSPM10  MOVE      QRYDATA,VSPMA010
          GOTO      SPVSPM99
.
SPVSPM11  MOVE      QRYDATA,VSPMA011
          GOTO      SPVSPM99
.
SPVSPM12  MOVE      QRYDATA,VSPMA012
          GOTO      SPVSPM99
.
SPVSPM13  MOVE      QRYDATA,VSPMA013
          GOTO      SPVSPM99
.
SPVSPM14  MOVE      QRYDATA,VSPMA014
          GOTO      SPVSPM99
.
SPVSPM99  RETURN
.
.------------------------------------------------------------
.  Update visit based payer account details file
.------------------------------------------------------------
MVVSPM00  MATCH     VSPMA001,Z70
          IF        !@EQUAL
            MOVE      VSPMA001,VSPMVISN
          ENDIF
.
          MATCH     VSPMA002,Z70
          IF        !@EQUAL
            MOVE      VSPMA002,VSPMPAYC
          ENDIF
.
          MATCH     VSPMA003,Z70
          IF        !@EQUAL
            MOVE      VSPMA003,VSPMMACN
          ENDIF
.
          MATCH     VSPMA004,Z70
          IF        !@EQUAL
            MOVE      VSPMA004,VSPMMNAM
          ENDIF
.
          MATCH     VSPMA005,Z70
          IF        !@EQUAL
            MOVE      VSPMA005,VSPMRLTP
          ENDIF
.
          MATCH     VSPMA006,Z70
          IF        !@EQUAL
            MOVE      VSPMA006,VSPMMPID
          ENDIF
.
          MATCH     VSPMA007,Z70
          IF        !@EQUAL
            MOVE      VSPMA007,VSPMMPIT
          ENDIF
.
          MATCH     VSPMA008,Z70
          IF        !@EQUAL
            MOVE      VSPMA008,VSPMMAD1
          ENDIF
.
          MATCH     VSPMA009,Z70
          IF        !@EQUAL
            MOVE      VSPMA009,VSPMMAD2
          ENDIF
.
          MATCH     VSPMA010,Z70
          IF        !@EQUAL
            MOVE      VSPMA010,VSPMMAD3
          ENDIF
.
          MATCH     VSPMA011,Z70
          IF        !@EQUAL
            MOVE      VSPMA011,VSPMMAD4
          ENDIF
.
          MATCH     VSPMA012,Z70
          IF        !@EQUAL
            MOVE      VSPMA012,VSPMMPCD
          ENDIF
.
          MATCH     VSPMA013,Z70
          IF        !@EQUAL
            MOVE      VSPMA013,VSPMEAMT
          ENDIF
.
          MATCH     VSPMA014,Z70
          IF        !@EQUAL
            MOVE      VSPMA014,VSPMEPEC
          ENDIF
.
MVVSPM99  RETURN
