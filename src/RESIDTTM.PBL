. Modifications
.   V11.02.01 02/08/2022  Bella Turco    TSK 0921957
.             Replaced default 10 records (NORECORD) with system parameter
.             PTCNNRTD & called NOMORE00 to display 'No more records' message
.    V9.10.00 21/07/2008  Jill Habasque CAR 174243
.             New include
.
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
REID0000  BRANCH    FLDITMNO,REID0100,REID0200,REID0300,REID0400,REID0500:
                             REID0600,REID0700,REID0800,REID0900,REID1000:
                             REID1100,REID1200,REID1300,REID1400,REID1500:
                             REID1600,REID1700,REID1800,REID1900,REID2000:
                             REID2100,REID2200,REID2300,REID2400,REID2500

          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      REID9999
.
REID0100  MOVE      "dg",CATEGORY
          MOVE      REIDRTYP,CODE
          CALL      CODITM00
          GOTO      REID9999
.
REID0200  WRITE     HTMLFILE;REIDITEM;
          GOTO      REID9999
.
REID0300  WRITE     HTMLFILE;REIDIDES;
          GOTO      REID9999
.
REID0400  WRITE     HTMLFILE;REIDRRAN;
          GOTO      REID9999
.
REID0500  WRITE     HTMLFILE;REIDRRTY;
          GOTO      REID9999
.
REID0600  WRITE     HTMLFILE;REIDLRRM;
          GOTO      REID9999
.
REID0700  WRITE     HTMLFILE;REIDHRRM;
          GOTO      REID9999
.
REID0800  WRITE     HTMLFILE;REIDLRRF;
          GOTO      REID9999
.
REID0900  WRITE     HTMLFILE;REIDHRRF;
          GOTO      REID9999
.
REID1000  WRITE     HTMLFILE;REIDRRDE;
          GOTO      REID9999
.
REID1100  WRITE     HTMLFILE;REIDUMEA;
          GOTO      REID9999
.
REID1200  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. creator
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,REID1210
          WRITE     HTMLFILE;REIDWEBC;
          GOTO      REID9999
.
REID1210  PACK      KEY10,REIDWEBC,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,REID9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      REID9999
.
REID1300  UNPACK    REIDDATC,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,REIDDATC
          GOTO      REID9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      REID9999
.
REID1400  MATCH     REIDTIMC,SP70             * Time Record created
          GOTO      REID9999 IF EQUAL
          WRITE     HTMLFILE;REIDTIMC
          GOTO      REID9999
.
REID1500  UNPACK    DIM127,D1,KEY1,DIM127     * .0   Web User ID rec. updated
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,REID1510
          WRITE     HTMLFILE;REIDWEBU;
          GOTO      REID9999
.
REID1510  PACK      KEY10,REIDWEBU,SP70       * .1
          CALL      RDWBSE1
          BRANCH    OVRCD,REID9999
          WRITE     HTMLFILE;WBSENAM;
          GOTO      REID9999
.
REID1600  UNPACK    REIDDATU,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,REIDDATU
          GOTO      REID9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      REID9999
.
REID1700  MATCH     REIDTIMU,SP70             * Time Record updated
          GOTO      REID9999 IF EQUAL
          WRITE     HTMLFILE;REIDTIMU
          GOTO      REID9999
.
REID1800  CALL      RIDTB000                  * List by item code
          GOTO      REID9999
.
REID1900  CALL      PREVGR00             * Link to Prev group of codes
          GOTO      REID9999
.
REID2000  CALL      NEXTGR00             * Link to Next group of codes
          GOTO      REID9999
.
REID2100  CALL      RIITB000             * List by item description
          GOTO      REID9999
.
REID2200  WRITE     HTMLFILE;REIDRITY;
          GOTO      REID9999
.
REID2300  MOVE      "dg",CATEGORY
          MOVE      RESULTTY,CODE
          CALL      CODITM00
          GOTO      REID9999
.
REID2400  CALL      RIITD000             * List by cat dg code
          GOTO      REID9999
.
REID2500  WRITE     HTMLFILE;REIDIORD;
          GOTO      REID9999
.
REID9999  RETURN
.------------------------------------------------------------
.   Set Parameters for residtaf file
.------------------------------------------------------------
SREID000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SREID010,SREID020,SREID030,SREID040,SREID050:
                       SREID060,SREID070,SREID080,SREID090,SREID100:
                       SREID110,SREID120,SREID130
.                      
          MOVE      ONE,EXIT
          GOTO      SREID999
.
SREID010  MOVE      QRYDATA,REIDT001
          GOTO      SREID999
.
SREID020  SQUEEZE   QRYDATA
          MOVE      QRYDATA,F3
          MOVE      F3,REIDT002
          REP       " 0",REIDT002
          GOTO      SREID999
.
SREID030  MOVE      QRYDATA,REIDT003
          GOTO      SREID999
.
SREID040  MOVE      QRYDATA,REIDT004
          GOTO      SREID999
.
SREID050  MOVE      QRYDATA,REIDT005
          GOTO      SREID999
.
SREID060  MOVE      QRYDATA,REIDT006
          GOTO      SREID999
.
SREID070  MOVE      QRYDATA,REIDT007
          GOTO      SREID999
.
SREID080  MOVE      QRYDATA,REIDT008
          GOTO      SREID999
.
SREID090  MOVE      QRYDATA,REIDT009
          GOTO      SREID999
.
SREID100  MOVE      QRYDATA,REIDT010
          GOTO      SREID999
.
SREID110  MOVE      QRYDATA,REIDT011
          GOTO      SREID999
.
SREID120  MOVE      QRYDATA,REIDT012
          GOTO      SREID999
.
SREID130  MOVE      QRYDATA,REIDT013
          GOTO      SREID999
.
SREID999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters 
.------------------------------------------------------------
CREID000  MOVE      Z70,REIDT001
          MOVE      Z70,REIDT002
          MOVE      Z70,REIDT003
          MOVE      Z70,REIDT004 
          MOVE      Z70,REIDT005
          MOVE      Z70,REIDT006
          MOVE      Z70,REIDT007
          MOVE      Z70,REIDT008
          MOVE      Z70,REIDT009
          MOVE      Z70,REIDT010
          MOVE      Z70,REIDT011
          MOVE      Z70,REIDT012
          MOVE      Z70,REIDT013
.
          RETURN
.
.------------------------------------------------------------
.  Move cgis to file variables
.------------------------------------------------------------
MVREID00  MATCH     REIDT001,Z70  
          IF        !@EQUAL
            PACK       REIDRTYP,REIDT001,SP70
          ENDIF
.
          MATCH     REIDT002,Z70
          IF        !@EQUAL
            PACK      REIDIORD,REIDT002,SP70
            REP       " 0",REIDIORD
          ENDIF
.
          MATCH     REIDT003,Z70
          IF        !@EQUAL
            PACK      REIDITEM,REIDT003,SP70
          ENDIF
.
          MATCH     REIDT004,Z70   
          IF        !@EQUAL
            PACK      REIDIDES,REIDT004,SP70
          ENDIF
.
          MATCH     REIDT005,Z70
          IF        !@EQUAL
            PACK      REIDRRAN,REIDT005,SP70
          ENDIF
.
          MATCH     REIDT006,Z70
          IF        !@EQUAL
            PACK      REIDRRTY,REIDT006,SP70
          ENDIF
.
          MATCH     REIDT007,Z70   
          IF        !@EQUAL
            MOVE      REIDT007,REIDLRRM
          ENDIF
.
          MATCH     REIDT008,Z70
          IF        !@EQUAL
            MOVE      REIDT008,REIDHRRM
          ENDIF
.
          MATCH     REIDT009,Z70
          IF        !@EQUAL
            MOVE      REIDT009,REIDLRRF
          ENDIF
.
          MATCH     REIDT010,Z70
          IF        !@EQUAL
            MOVE      REIDT010,REIDHRRF
          ENDIF
.
          MATCH     REIDT011,Z70
          IF        !@EQUAL
            PACK      REIDRRDE,REIDT011,SP70
          ENDIF
.
          MATCH     REIDT012,Z70
          IF        !@EQUAL
            PACK      REIDUMEA,REIDT012,SP70
          ENDIF
.
          MATCH     REIDT013,Z70
          IF        !@EQUAL
            PACK      REIDRITY,REIDT013,SP70
          ENDIF
.
MVREID99  RETURN
+
.------------------------------------------------------------
. Table of Result Item Details - List by result type
.------------------------------------------------------------
RIDTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      RDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY18,STARTKEY,SP70
          CALL      RSREIDT2
          IF        OVRCD=0
            CALL      RPREIDT2
          ENDIF
RIDTB100  CALL      RKREIDT2
          BRANCH    OVRCD,RIDTB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      RIDTB100
          ENDIF
.
          CALL      RDROW000      * Display Result Detail Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      RIDTB100 IF NOT EQUAL
          GOTO      RIDTB999
.
RIDTB900  CALL      NOMORE00      * Diplay No More Records Message
.
RIDTB999  RETURN
+
.------------------------------------------------------------
. Result Item Detail Maintenance (TABLE HEADING)
.------------------------------------------------------------
RDHED000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=30%>":
                             "Item Order</td>":
                             "<td class=HeadingCell width=30%>":
                             "Test Item Code</td>":
                             "<td class=HeadingCell width=15%>":
                             "Test Item Description</td>":
                             "<td class=HeadingCell width=20%>":
                             "Result Type</td>":
                             "<td class=HeadingCell width=25%>":
                             "Reference Range</td>":
                             "</tr>"
.
RDHED999  RETURN
.------------------------------------------------------------
. Result Item Detail Maintenance (TABLE ROW)
.------------------------------------------------------------
RDROW000  MATCH     SP70,REIDIDES
          IF        @EQUAL
            MOVE      "&nbsp;",KEY30
          ELSE
            MOVE      REIDIDES,KEY30
          ENDIF
.
          PACK      KEY5,CATdg,REIDRTYP,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            PACK      TDESC,SP70
          ENDIF
.
          MOVE      "No             ",REFRDESC
          MATCH     "1",REIDRRAN
          IF        @EQUAL
            MOVE      "Yes            ",REFRDESC
          ENDIF
          MATCH     "2",REIDRRAN
          IF        @EQUAL
            MOVE      "Gender Specific",REFRDESC
          ENDIF
          MATCH     "3",REIDRRAN
          IF        @EQUAL
            MOVE      "Age Specific   ",REFRDESC
          ENDIF
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail01":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&reidt001=",REIDRTYP:
                             "&reidt002=",REIDIORD,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             REIDIORD,"</td>":
                             "<td>",REIDITEM,"&nbsp;</td>":
                             "<td>",REIDIDES,"&nbsp;</td>":
                             "<td>",TDESC,"&nbsp;</td>":
                             "<td>",REFRDESC,"&nbsp;</td>":
                             "</tr>"
.
          GOTO      RDROW999
.
RDROW999 RETURN
.
.-----------------------------------------------------------
. Link to Next Group
.-----------------------------------------------------------
NEXTGR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          REP       " +",STARTKEY
          REP       "'~",STARTKEY
.
          WRITE     HTMLFILE;"cliweb11.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY;
.
          REP       "+ ",STARTKEY
          REP       "~'",STARTKEY
.
NEXTGR99  RETURN
.-------------------------------------------------------------
. Link to Prev Group
.-------------------------------------------------------------
PREVGR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          REP       " +",STARTKEY
          REP       "'~",STARTKEY
.
          WRITE     HTMLFILE;"cliweb11.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY;
.
          REP       "+ ",STARTKEY
          REP       "~'",STARTKEY
.
PREVGR99  RETURN
+
.------------------------------------------------------------
. Table of Result Item Details - List by Item Description
.------------------------------------------------------------
RIITB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      RDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY56,STARTKEY,SP70
          CALL      RSREIDT3
          IF        OVRCD=0
            CALL      RPREIDT3
          ENDIF
RIITB100  CALL      RKREIDT3
          BRANCH    OVRCD,RIITB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      RIITB100
          ENDIF
.
          CALL      RDROW000      * Display Result Detail Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      RIITB100 IF NOT EQUAL
          GOTO      RIITB999
.
RIITB900  CALL      NOMORE00      * Display No More Records Message
.
RIITB999  RETURN
+
.------------------------------------------------------------
. Table of Result Item Details - List by Cat dg code
.------------------------------------------------------------
RIITD000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      RDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,STARTKEY,SP70
          CALL      RSREIDT1
          IF        OVRCD=0
            CALL      RPREIDT1
          ENDIF
RIITD100  CALL      RKREIDT1
          BRANCH    OVRCD,RIITD900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      RIITD100
          ENDIF
.
          CALL      RDROW000      * Display Result Detail Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      RIITD100 IF NOT EQUAL
          GOTO      RIITD999
.
RIITD900  CALL      NOMORE00      * Display No More Records Message
.
RIITD999  RETURN
+
