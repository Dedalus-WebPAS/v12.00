. *----------------------------------------------------------------------
. * Include Name  :   EMRURGTM.PBL
. *
. * Function      :   CGI variables for EMRURGFD - emrurgaf.dat
. *
. * Includes Needed : EMRURGFD - ABF EMR URG Classification tab
. *                   EMRURGIO - IO for ABF EMR URG Classification tab
. * Modifications :
. *
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for ABF EMR URG Classification tab
.------------------------------------------------------------------------
.
CLRURG00  MOVE      SP70,ERURG001
          MOVE      SP70,ERURG002
          MOVE      SP70,ERURG003
          MOVE      SP70,ERURG004
          MOVE      SP70,ERURG005
          MOVE      SP70,ERURG006
          MOVE      SP70,ERURG007
          RETURN
.
.------------------------------------------------------------------------
. ABF EMR URG Classification fields Tag
.------------------------------------------------------------------------
ERUR0000  BRANCH    FLDITMNO,ERUR0010,ERUR0020,ERUR0030,ERUR0040,ERUR0050:
                             ERUR0060,ERUR0070
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      ERUR9999
.
ERUR0010  MATCH     EMUREDAT,SP70       * Effective End Date
          GOTO      ERUR9999 IF EQUAL
.
          UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,ERUR0011
          WRITE     HTMLFILE;EMUREDAT;
          GOTO      ERUR9999
.
ERUR0011  UNPACK    EMUREDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ERUR9999
.
ERUR0020  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,ERUR0021
.
          PACK      TDESC,SP70
          PACK      KEY5,CATED,EMURESTA,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,ERUR9999
          WRITE     HTMLFILE;TDESC;
          GOTO      ERUR9999
.
ERUR0021  WRITE     HTMLFILE;EMURESTA;      * Episode End Status Cat ED
          GOTO      ERUR9999
.
ERUR0030  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,ERUR0031
.
          PACK      TDESC,SP70
          PACK      KEY5,CATAA,EMURTRIA,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,ERUR9999
          WRITE     HTMLFILE;TDESC;
          GOTO      ERUR9999
.
ERUR0031  WRITE     HTMLFILE;EMURTRIA;      * Triage Code Cat AA
          GOTO      ERUR9999
.
ERUR0040  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      KEY1,F1
          BRANCH    F1,ERUR0041
.
          PACK      TDESC,SP70
          MATCH     EMURVTYP,SP70
          GOTO      ERUR004A IF EQUAL
          PACK      KEY5,CATee,EMURVTYP,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,ERUR9999
ERUR004A  WRITE     HTMLFILE;TDESC;
          GOTO      ERUR9999
.
ERUR0041  WRITE     HTMLFILE;EMURVTYP;      * Type of Visit Cat ee
          GOTO      ERUR9999
.
ERUR0050  WRITE     HTMLFILE;EMURMDBC;      * MDB Code
          GOTO      ERUR9999
.
ERUR0060  WRITE     HTMLFILE;EMURURGV;      * URG Value
          GOTO      ERUR9999
.
ERUR0070  WRITE     HTMLFILE;EMURURGD;      * URG Description
          GOTO      ERUR9999
.
ERUR9999  RETURN
.
.------------------------------------------------------------
. Set Parameters for ABF EMR URG Classification PW
.------------------------------------------------------------
SPURG000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPURG001,SPURG002,SPURG003,SPURG004,SPURG005:
                       SPURG006,SPURG007
.
          MOVE      ONE,EXIT
          GOTO      SPURG999
.
SPURG001  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00              * Set CMON from MTHNAM3
          PACK      ERURG001,CCENT,CYEAR,CMON,CDAY
          GOTO      SPURG999
.
SPURG002  MOVE      QRYDATA,ERURG002
          PACK      ERURG002,ERURG002,SP70
          GOTO      SPURG999
.
SPURG003  MOVE      QRYDATA,ERURG003
          PACK      ERURG003,ERURG003,SP70
          GOTO      SPURG999
.
SPURG004  MOVE      QRYDATA,ERURG004
          PACK      ERURG004,ERURG004,SP70
          GOTO      SPURG999
.
SPURG005  MOVE      QRYDATA,ERURG005
          PACK      ERURG005,ERURG005,SP70
          GOTO      SPURG999
.
SPURG006  MOVE      QRYDATA,ERURG006
          PACK      ERURG006,ERURG006,SP70
          GOTO      SPURG999
.
SPURG007  MOVE      QRYDATA,ERURG007
          PACK      ERURG007,ERURG007,SP70
          GOTO      SPURG999
.
SPURG999  RETURN
.
.-----------------------------------------------------------------------------
.         Move work variables to ABF EMR URG Classification tab file variables
.-----------------------------------------------------------------------------
MVERUR00  MATCH     ERURG001,SP70
          IF        !@EQUAL
            MOVE      ERURG001,EMUREDAT
          ENDIF
.
          MATCH     ERURG002,SP70
          IF        !@EQUAL
            MOVE      ERURG002,EMURESTA
          ENDIF
.
          MATCH     ERURG003,SP70
          IF        !@EQUAL
            MOVE      ERURG003,EMURTRIA
          ENDIF
.
          MATCH     ERURG004,SP70
          IF        !@EQUAL
            MOVE      ERURG004,EMURVTYP
          ENDIF
.
          MATCH     ERURG005,SP70
          IF        !@EQUAL
            MOVE      ERURG005,EMURMDBC
          ENDIF
.
          MATCH     ERURG006,SP70
          IF        !@EQUAL
            MOVE      ERURG006,EMURURGV
          ENDIF
.
          MATCH     ERURG007,SP70
          IF        !@EQUAL
            MOVE      ERURG007,EMURURGD
          ENDIF
.
MVERUR99  RETURN
