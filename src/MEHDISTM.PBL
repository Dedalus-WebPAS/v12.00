.----------------------------------------------------------------------
. Program       : MEHDISTM
.
. Function      : Output Mental Health Discharge Variables           
.
. Modifications :
.----------------------------------------------------------------------
.  V10.06.01  16/03/2015  Don Nguyen        CAR 306757
.                         Added RETURN to SETMDS99
.                         Fixed goto for SETMDS01 to be SETMDS99
.   V9.02.01  09/11/2002  Peter Vela    SRF 22731
.                         Debugged for Mental Health Discharge Screen
.   V9.02.00  25/10/2002  Jill Habasque - Created
.----------------------------------------------------------------------
.
.
.------------------------------------------------------------
. Discharge Details 
.------------------------------------------------------------
MHDS0000  BRANCH    FLDITMNO,MHDS0100,MHDS0200,MHDS0300,MHDS0400,MHDS0500:
                             MHDS0600,MHDS0700,MHDS0800,MHDS0900,MHDS1000:
                             MHDS1100,MHDS1200,MHDS1300,MHDS1400,MHDS1500:
                             MHDS1600,MHDS1700,MHDS1800,MHDS1900,MHDS2000:
                             MHDS2100,MHDS2200,MHDS2300,MHDS2400,MHDS2500
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      MHDS9999
.
MHDS0100  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          WRITE     HTMLFILE;LINKPRG,".pbl?":
                             "&reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&urnumber=",URNUMBER:
                             "&admissno=",ADMISSNO;
          GOTO      MHDS9999
.
MHDS0200  WRITE     HTMLFILE;MHDSADMN;
          GOTO      MHDS9999
.
MHDS0300  WRITE     HTMLFILE;MHDSADD1;
          GOTO      MHDS9999
.
MHDS0400  WRITE     HTMLFILE;MHDSADD2;
          GOTO      MHDS9999
.
MHDS0500  WRITE     HTMLFILE;MHDSSUBR; 
          GOTO      MHDS9999
.
MHDS0600  WRITE     HTMLFILE;MHDSADD4; 
          GOTO      MHDS9999
.
MHDS0700  WRITE     HTMLFILE;MHDSPOST; 
          GOTO      MHDS9999
.
MHDS0800  WRITE     HTMLFILE;MHDSSPR1; 
          GOTO      MHDS9999
.
MHDS0900  MOVE      "AY",CATEGORY
          PACK      CODE,MHDSACTY,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS1000  MOVE      "RE",CATEGORY
          PACK      CODE,MHDSREFT,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS1100  MOVE      "SW",CATEGORY
          PACK      CODE,MHDSSTAY,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS1200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDS1210
          WRITE     HTMLFILE;MHDSLDOM;
          GOTO      MHDS9999
.
MHDS1210  COMPARE   ONE,MHDSLDOM
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDSLDOM
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDS9999
.
MHDS1300  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDS1310
          WRITE     HTMLFILE;MHDSLGP;
          GOTO      MHDS9999
.
MHDS1310  COMPARE   ONE,MHDSLGP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDSLGP
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDS9999
.
MHDS1400  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDS1410
          WRITE     HTMLFILE;MHDSTRST;
          GOTO      MHDS9999
.
MHDS1410  COMPARE   ONE,MHDSTRST
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDSTRST
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDS9999
.
MHDS1500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDS1510
          WRITE     HTMLFILE;MHDSDOHN;
          GOTO      MHDS9999
.
MHDS1510  COMPARE   ONE,MHDSDOHN
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDSDOHN
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDS9999
.
MHDS1600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDS1610
          WRITE     HTMLFILE;MHDSOUTP;
          GOTO      MHDS9999
.
MHDS1610  COMPARE   ONE,MHDSOUTP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDSOUTP
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDS9999
.
MHDS1700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,MHDS1710
          WRITE     HTMLFILE;MHDSCSRG;
          GOTO      MHDS9999
.
MHDS1710  COMPARE   ONE,MHDSCSRG
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
          COMPARE   TWO,MHDSCSRG
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      MHDS9999
.
MHDS1800  MATCH     MHDSCSDT,SP70
          GOTO      MHDS9999 IF EQUAL
          UNPACK    MHDSCSDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      MHDS9999
.
MHDS1900  MOVE      "FU",CATEGORY
          PACK      CODE,MHDSCFUT,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS2000  MATCH     MHDSCFUD,SP70
          GOTO      MHDS9999 IF EQUAL
          UNPACK    MHDSCFUD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      MHDS9999
.
MHDS2100  MOVE      "W5",CATEGORY
          PACK      CODE,MHDSUSR1,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS2200  MOVE      "W6",CATEGORY
          PACK      CODE,MHDSUSR2,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS2300  MOVE      "W7",CATEGORY
          PACK      CODE,MHDSUSR3,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS2400  MOVE      "W8",CATEGORY
          PACK      CODE,MHDSUSR4,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS2500  MOVE      "W9",CATEGORY
          PACK      CODE,MHDSUSR5,SP70
          CALL      CODITM00
          GOTO      MHDS9999
.
MHDS9999  RETURN
+
.------------------------------------------------------------
. Clear cgi variables
.------------------------------------------------------------
CLRMDS00  MOVE      Z70,MEHDS001
          MOVE      Z70,MEHDS002
          MOVE      Z70,MEHDS003
          MOVE      Z70,MEHDS004
          MOVE      Z70,MEHDS005
          MOVE      Z70,MEHDS006
          MOVE      Z70,MEHDS007
          MOVE      Z70,MEHDS008
          MOVE      Z70,MEHDS009
          MOVE      Z70,MEHDS010
          MOVE      ZERO,MEHDS011
          MOVE      ZERO,MEHDS012
          MOVE      ZERO,MEHDS013
          MOVE      ZERO,MEHDS014
          MOVE      ZERO,MEHDS015
          MOVE      ZERO,MEHDS016
          MOVE      Z70,MEHDS017
          MOVE      Z70,MEHDS018
          MOVE      Z70,MEHDS019
          MOVE      Z70,MEHDS020
          MOVE      Z70,MEHDS021
          MOVE      Z70,MEHDS022
          MOVE      Z70,MEHDS023
          MOVE      Z70,MEHDS024
.
CLRMDS99  RETURN
+
.------------------------------------------------------------
.   Set Parameters for mental health  discharge table
.------------------------------------------------------------
SETMDS00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
.
          BRANCH    F3,SETMDS01,SETMDS02,SETMDS03,SETMDS04,SETMDS05:
                       SETMDS06,SETMDS07,SETMDS08,SETMDS09,SETMDS10:
                       SETMDS11,SETMDS12,SETMDS13,SETMDS14,SETMDS15:
                       SETMDS16,SETMDS17,SETMDS18,SETMDS19,SETMDS20:
                       SETMDS21,SETMDS22,SETMDS23,SETMDS24
.
          MOVE      ONE,EXIT
          GOTO      SETMDS99
.
SETMDS01  SQUEEZE   QRYDATA
          MOVE      QRYDATA,MEHDS001
          PACK      MEHDS001,MEHDS001,SP70
          GOTO      SETMDS99
.
SETMDS02  MOVE      QRYDATA,MEHDS002
          GOTO      SETMDS99
.
SETMDS03  MOVE      QRYDATA,MEHDS003
          GOTO      SETMDS99
.
SETMDS04  MOVE      QRYDATA,MEHDS004
          GOTO      SETMDS99
.
SETMDS05  MOVE      QRYDATA,MEHDS005
          GOTO      SETMDS99
.
SETMDS06  MOVE      QRYDATA,MEHDS006 
          GOTO      SETMDS99
.
SETMDS07  MOVE      QRYDATA,MEHDS007
          GOTO      SETMDS99
.
SETMDS08  MOVE      QRYDATA,MEHDS008
          GOTO      SETMDS99
.
SETMDS09  MOVE      QRYDATA,MEHDS009
          GOTO      SETMDS99
.
SETMDS10  MOVE      QRYDATA,MEHDS010
          GOTO      SETMDS99
.
SETMDS11  MOVE      QRYDATA,MEHDS011
          GOTO      SETMDS99
.
SETMDS12  MOVE      QRYDATA,MEHDS012
          GOTO      SETMDS99
.
SETMDS13  MOVE      QRYDATA,MEHDS013
          GOTO      SETMDS99
.
SETMDS14  MOVE      QRYDATA,MEHDS014
          GOTO      SETMDS99
.
SETMDS15  MOVE      QRYDATA,MEHDS015
          GOTO      SETMDS99
.
SETMDS16  MOVE      QRYDATA,MEHDS016
          GOTO      SETMDS99
.
SETMDS17  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDS017,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDS99
.
SETMDS18  MOVE      QRYDATA,MEHDS018
          GOTO      SETMDS99
.
SETMDS19  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      MEHDS019,CCENT,CYEAR,CMON,CDAY
          GOTO      SETMDS99
.
SETMDS20  MOVE      QRYDATA,MEHDS020
          GOTO      SETMDS99
.
SETMDS21  MOVE      QRYDATA,MEHDS021
          GOTO      SETMDS99
.
SETMDS22  MOVE      QRYDATA,MEHDS022
          GOTO      SETMDS99
.
SETMDS23  MOVE      QRYDATA,MEHDS023
          GOTO      SETMDS99
.
SETMDS24  MOVE      QRYDATA,MEHDS024
          GOTO      SETMDS99
.
.SETMDS24  MOVE      QRYDATA,MEHDS024
.          GOTO      SETMDS99
.
SETMDS99  RETURN
+
.------------------------------------------------------------
.   Move cgi's into file variables               
.------------------------------------------------------------
.
MVDIS000  MATCH     Z70,MEHDS002
          IF        !@EQUAL
            MOVE      MEHDS002,MHDSADD1
          ENDIF
.
          MATCH     Z70,MEHDS003
          IF        !@EQUAL
            MOVE      MEHDS003,MHDSADD2
          ENDIF
.
          MATCH     Z70,MEHDS004
          IF        !@EQUAL
            MOVE      MEHDS004,MHDSSUBR
          ENDIF
.
          MATCH     Z70,MEHDS005
          IF        !@EQUAL
            MOVE      MEHDS005,MHDSADD4
          ENDIF
.
          MATCH     Z70,MEHDS006
          IF        !@EQUAL
            MOVE      MEHDS006,MHDSPOST
          ENDIF
.
          MATCH     Z70,MEHDS007
          IF        !@EQUAL
            MOVE      MEHDS007,MHDSSPR1
          ENDIF
.
          MATCH     Z70,MEHDS008
          IF        !@EQUAL
            MOVE      MEHDS008,MHDSACTY
          ENDIF
.
          MATCH     Z70,MEHDS009
          IF        !@EQUAL
            MOVE      MEHDS009,MHDSREFT
          ENDIF
.
          MATCH     Z70,MEHDS010
          IF        !@EQUAL
            MOVE      MEHDS010,MHDSSTAY
          ENDIF
.
          COMPARE   ZERO,MEHDS011
          IF        !@EQUAL
            MOVE      MEHDS011,MHDSLDOM
          ENDIF
.
          COMPARE   ZERO,MEHDS012
          IF        !@EQUAL
            MOVE      MEHDS012,MHDSLGP
          ENDIF
.
          COMPARE   ZERO,MEHDS013
          IF        !@EQUAL
            MOVE      MEHDS013,MHDSTRST
          ENDIF
.
          COMPARE   ZERO,MEHDS014
          IF        !@EQUAL
            MOVE      MEHDS014,MHDSDOHN
          ENDIF
.
          COMPARE   ZERO,MEHDS015
          IF        !@EQUAL
            MOVE      MEHDS015,MHDSOUTP
          ENDIF
.
          COMPARE   ZERO,MEHDS016
          IF        !@EQUAL
            MOVE      MEHDS016,MHDSCSRG
          ENDIF
.
          MATCH     Z70,MEHDS017
          IF        !@EQUAL
            MOVE      MEHDS017,MHDSCSDT
          ENDIF
.
          MATCH     Z70,MEHDS018
          IF        !@EQUAL
            MOVE      MEHDS018,MHDSCFUT
          ENDIF
.
          MATCH     Z70,MEHDS019
          IF        !@EQUAL
            MOVE      MEHDS019,MHDSCFUD
          ENDIF
.
          MATCH     Z70,MEHDS020 
          IF        !@EQUAL
            MOVE      MEHDS020,MHDSUSR1
          ENDIF
.
          MATCH     Z70,MEHDS021
          IF        !@EQUAL
            MOVE      MEHDS021,MHDSUSR2
          ENDIF
.
          MATCH     Z70,MEHDS022
          IF        !@EQUAL
            MOVE      MEHDS022,MHDSUSR3
          ENDIF
.
          MATCH     Z70,MEHDS023
          IF        !@EQUAL
            MOVE      MEHDS023,MHDSUSR4
          ENDIF
.
          MATCH     Z70,MEHDS024
          IF        !@EQUAL
            MOVE      MEHDS024,MHDSUSR5
          ENDIF
.
MVDIS999  RETURN                  
