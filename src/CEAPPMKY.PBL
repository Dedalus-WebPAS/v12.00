.---------------------------------------------------------------------------
.   System    :   Casemix Expense Analysis           
.   Include   :   CEAPPMKY
.   Routine   :   HCEPPA00 Payment Model       
.   Return    :           
.-------------------------------------------------------------------------------
HCEPPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HCEPPA04
          CALL      GSCRN000
          BRANCH    EXIT,HCEPPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Model"              
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "35",STDCOL03
HCEPPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CEPPIND 
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          CALL      RSCEPP1 
HCEPPA10
          CALL      RKCEPP1 
          BRANCH    OVRCD,HCEPPA15
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HCEPPA12
          CALL      HCEPPA60
          BRANCH    OVRCD,HCEPPA10
HCEPPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY1,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CEPPIND 
          DISPLAY   *PSTDCOL02:STDROW,CEPPDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCEPPA10 IF NOT EQUAL
HCEPPA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCEPPA20
          CALL      HSCRI000
          BRANCH    EXIT,HCEPPA30,HCEPPA35,HCEPPA40,HCEPPA45,HCEPPA04:
                              HCEPPA91,HCEPPA50
          GOTO      HCEPPA92
HCEPPA30
          CALL      RKCEPP1 
          BRANCH    OVRCD,HCEPPA85
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          CALL      RPCEPP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCEPPA10
HCEPPA35
          MOVE      ST1,KEY1 
          CALL      RDCEPP1 
          CALL      RPCEPP1 
          BRANCH    OVRCD,HCEPPA85
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCEPPA36
          CALL      RPCEPP1 
          BRANCH    OVRCD,HCEPPA37
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCEPPA36 IF NOT EQUAL
HCEPPA37
          MOVE      ZERO,XITEMNO
          GOTO      HCEPPA10
HCEPPA40
          MOVE      ST1,KEY1 
          CALL      RDCEPP1 
          CALL      RPCEPP1 
          BRANCH    OVRCD,HCEPPA85
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCEPPA08
HCEPPA45
          CALL      RKCEPP1 
          BRANCH    OVRCD,HCEPPA85
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY1,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCEPP1 
HCEPPA46
          CALL      RPCEPP1 
          BRANCH    OVRCD,HCEPPA47
          PACK      KEY1,CEPPIND,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCEPPA46 IF NOT EQUAL
HCEPPA47
          MOVE      ZERO,XITEMNO
          GOTO      HCEPPA10
HCEPPA50  COMPARE   ZERO,CSEARCH
          GOTO      HCEPPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCEPPA08
HCEPPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCEPPA08
HCEPPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCEPPA61 IF EQUAL
          MATCH     SCHFLD01,CEPPIND 
          GOTO      HCEPPA72 IF NOT EQUAL
HCEPPA61
          MATCH     SP70,SCHFLD02
          GOTO      HCEPPA62 IF EQUAL
          MATCH     SCHFLD02,CEPPDES 
          GOTO      HCEPPA72 IF NOT EQUAL
HCEPPA62
HCEPPA63
HCEPPA64
HCEPPA65
HCEPPA66
HCEPPA67
HCEPPA68
HCEPPA69
HCEPPA70
          GOTO      HCEPPA75
HCEPPA72  MOVE      ONE,OVRCD
HCEPPA75  RETURN
HCEPPA85
          LOAD      KEY1,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY1,CEPPIND                                                
          CALL      RDCEPP1 
HCEPPA90
.                                                                               
          BEEP
          GOTO      HCEPPA20
HCEPPA91
          MOVE      SP70,CEPPDES 
          MOVE      ZERO,CEPPNURF
          MOVE      ZERO,CEPPTHEF
          MOVE      ZERO,CEPPPHAF
          MOVE      ZERO,CEPPICUF
          MOVE      ZERO,CEPPALLF
          MOVE      ZERO,CEPPMSSF
          MOVE      ZERO,CEPPTAXF
          MOVE      ZERO,CEPPOVHF
          MOVE      ZERO,CEPPCATF
          MOVE      ZERO,CEPPDEPF
          MOVE      ZERO,CEPPOTHF
          MOVE      ZERO,CEPPNURV
          MOVE      ZERO,CEPPTHEV
          MOVE      ZERO,CEPPPHAV
          MOVE      ZERO,CEPPICUV
          MOVE      ZERO,CEPPALLV
          MOVE      ZERO,CEPPMSSV
          MOVE      ZERO,CEPPTAXV
          MOVE      ZERO,CEPPOVHV
          MOVE      ZERO,CEPPCATV
          MOVE      ZERO,CEPPDEPV
          MOVE      ZERO,CEPPOTHV
          MOVE      ZERO,CEPPPRO 
          MOVE      ZERO,CEPPICU 
          MOVE      ZERO,CEPPINCI
          MOVE      ZERO,CEPPUTH 
          MOVE      ZERO,CEPPB01 
          MOVE      ZERO,CEPPB02 
          MOVE      ZERO,CEPPB03 
          MOVE      ZERO,CEPPB04 
          MOVE      ZERO,CEPPB05 
          MOVE      ZERO,CEPPB06 
          MOVE      ZERO,CEPPB07 
          MOVE      ZERO,CEPPB08 
          MOVE      ZERO,CEPPB09 
          MOVE      ZERO,CEPPB10 
          MOVE      ZERO,CEPPB11 
          MOVE      ZERO,CEPPB12 
          MOVE      ZERO,CEPPB13 
          MOVE      ZERO,CEPPB14 
          MOVE      ZERO,CEPPB15 
          MOVE      SP70,CEPPSPA 
          MOVE      SP70,KEY1 
          MOVE      SP70,CEPPIND 
          GOTO      HCEPPA96
HCEPPA92
          MOVE      SP70,KEY1 
          MOVE      SP70,CEPPIND 
          LOAD      KEY1,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY1,CEPPIND                                                
HCEPPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCEPPA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Casemix Expense Analysis           
.   Include   :   CEAPPMKY
.   Routine   :   KCEPPA00 Keyin Model Code          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCEPPA00 TOPIC     "CEPPIND "
          MOVE      UNDLN70,CEPPIND 
          KEYIN     *PCCOL:CVERT,*DV,CEPPIND:                                   
                    *PCCOL:CVERT,*V2LON,CEPPIND:                                
                    *PCCOL:CVERT,*DV,CEPPIND 
.
          ENDSET    CEPPIND 
          APPEND    SP70,CEPPIND 
          RESET     CEPPIND 
.
          MATCH     SP70,CEPPIND 
          GOTO      KCEPPA90 IF EQUAL
.
          CMATCH    EXITCHAR,CEPPIND 
          GOTO      KCEPPA95 IF EQUAL
.
          CMATCH    QUEST,CEPPIND 
          GOTO      KCEPPA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCEPPA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CEPPIND 
          APPEND    SP70,CEPPIND 
          RESET     CEPPIND 
.
          MATCH     SP70,CEPPIND 
          GOTO      KCEPPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CEPPIND                                 
KCEPPA10
          PACK      KEY1,CEPPIND                                                
          CALL      RACEPP1 
          BRANCH    OVRCD,KCEPPA80
          BRANCH    CKEYTYP,KCEPPA75
          CALL      RDCEPP1 
KCEPPA70
          MOVE      ZERO,EXIT
          GOTO      KCEPPA99
KCEPPA75
          MOVE      "Model Code Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KCEPPA00
KCEPPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCEPPA99,KCEPPA99
          MOVE      "Model Code Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KCEPPA00
KCEPPA90
          MOVE      ONE,EXIT
          GOTO      KCEPPA99
KCEPPA95
          MOVE      TWO,EXIT
KCEPPA99 TOPIC    PRGID
          RETURN
