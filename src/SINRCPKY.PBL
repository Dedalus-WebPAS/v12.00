.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINRCPKY
.   Routine   :   KSIRPA00 Keyin Purchase Order      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIRPA00 TOPIC     "SIRPPON "
          MOVE      UNDLN70,SIRPPON 
          KEYIN     *PCCOL:CVERT,*DV,SIRPPON:                                   
                    *PCCOL:CVERT,*V2LON,*JR,SIRPPON:                            
                    *PCCOL:CVERT,*DV,SIRPPON 
.
          ENDSET    SIRPPON 
          APPEND    SP70,SIRPPON 
          RESET     SIRPPON 
.
          MATCH     SP70,SIRPPON 
          GOTO      KSIRPA90 IF EQUAL
.
          ENDSET    SIRPPON 
          CMATCH    EXITCHAR,SIRPPON 
          GOTO      KSIRPA95 IF EQUAL
.
          CMATCH    QUEST,SIRPPON 
          GOTO      KSIRPA10 IF NOT EQUAL
.
          MOVE      CCOL,MYCOL
          MOVE      CVERT,MYVERT
          MOVE      CCITEM,SCCITEM
          CALL      HSIRPA00
          MOVE      SCCITEM,CCITEM
          MOVE      MYCOL,CCOL
          MOVE      MYVERT,CVERT
.
          PACK      SIRPPON,SIRPPON,SP70
          MATCH     SP70,SIRPPON 
          GOTO      KSIRPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIRPPON                                 
KSIRPA10
          RESET     SIRPPON 
          PACK      KEY7,SIRPPON                                                
          CALL      RASIRP1 
          BRANCH    OVRCD,KSIRPA80
          BRANCH    CKEYTYP,KSIRPA75
          CALL      RDSIRP1 
KSIRPA70
          MOVE      ZERO,EXIT
          GOTO      KSIRPA99
KSIRPA75
          MOVE      "Purchase Order Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KSIRPA00
KSIRPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIRPA99,KSIRPA99
          MOVE      "Purchase Order Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KSIRPA00
KSIRPA90
          MOVE      ONE,EXIT
          GOTO      KSIRPA99
KSIRPA95
          MOVE      TWO,EXIT
KSIRPA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINRCPKY
.   Routine   :   HSIRPA00 Lookup for sinrcpaf 
.   Return    :           
.-------------------------------------------------------------------------------
HSIRPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "06",HTOP
            MOVE      "20",HBOT
            MOVE      "50",HLEF
            MOVE      "70",HRIG
          ENDIF
HSIRPA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIRPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Order No."          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
HSIRPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIRPPON 
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          CALL      RSSIRP1 
HSIRPA10
          CALL      RKSIRP1 
          BRANCH    OVRCD,HSIRPA15
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSIRPA12
          CALL      HSIRPA60
          BRANCH    OVRCD,HSIRPA10
HSIRPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY7,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIRPPON     
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIRPA10 IF NOT EQUAL
HSIRPA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIRPA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIRPA30,HSIRPA35,HSIRPA40,HSIRPA45,HSIRPA04:
                              HSIRPA91,HSIRPA50
          GOTO      HSIRPA92
HSIRPA30
          CALL      RKSIRP1 
          BRANCH    OVRCD,HSIRPA85
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          CALL      RPSIRP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIRPA10
HSIRPA35
          MOVE      ST1,KEY7 
          CALL      RDSIRP1 
          CALL      RPSIRP1 
          BRANCH    OVRCD,HSIRPA85
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIRPA36
          CALL      RPSIRP1 
          BRANCH    OVRCD,HSIRPA37
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIRPA36 IF NOT EQUAL
HSIRPA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIRPA10
HSIRPA40
          MOVE      ST1,KEY7 
          CALL      RDSIRP1 
          CALL      RPSIRP1 
          BRANCH    OVRCD,HSIRPA85
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIRPA08
HSIRPA45
          CALL      RKSIRP1 
          BRANCH    OVRCD,HSIRPA85
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY7,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIRP1 
HSIRPA46
          CALL      RPSIRP1 
          BRANCH    OVRCD,HSIRPA47
          PACK      KEY7,SIRPPON,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIRPA46 IF NOT EQUAL
HSIRPA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIRPA10
HSIRPA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIRPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIRPA08
HSIRPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIRPA08
HSIRPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIRPA61 IF EQUAL
          MATCH     SCHFLD01,SIRPPON     
          GOTO      HSIRPA72 IF NOT EQUAL
HSIRPA61
HSIRPA62
HSIRPA63
HSIRPA64
HSIRPA65
HSIRPA66
HSIRPA67
HSIRPA68
HSIRPA69
HSIRPA70
          GOTO      HSIRPA75
HSIRPA72  MOVE      ONE,OVRCD
HSIRPA75  RETURN
HSIRPA85
          LOAD      KEY7,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY7,SIRPPON                                                
          CALL      RDSIRP1 
HSIRPA90
.                                                                               
          BEEP
          GOTO      HSIRPA20
HSIRPA91
          MOVE      SP70,SIRPSPA 
          MOVE      SP70,KEY7 
          MOVE      SP70,SIRPPON 
          GOTO      HSIRPA96
HSIRPA92
          MOVE      SP70,KEY7 
          MOVE      SP70,SIRPPON 
          LOAD      KEY7,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY7,SIRPPON                                                
HSIRPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIRPA99
          RETURN
