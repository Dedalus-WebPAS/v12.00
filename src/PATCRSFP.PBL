.*******************************************************************************
.*                                                                             *
.*      PATCRSFP.PBL - User Defined Cancer Registration Stationery Form print  *
.*      ------------                                                           *
.*                                                                             *
.*      This include assumes the IBATMDFD & IBATMHFD, files have been read     *
.*      with a valid stationery code.                                          *
.*      PATCRDFD & PATCRGFD also needs to be read.                             *
.*                                                                             *
.*      This must be done each time this include is called.                    *
.*                                                                             *
.*      Need to include GETALTID in the server the uses this include.          *
.*                                                                             *
.*      Also the PATMA1FD, PATMI1FD & PATDSCFD must have been read in with a   *
.*      valid admission.                                                       *
.*                                                                             *
.*      This include (CNPRN000) was copied and merged from PATWEB70 & MRTWEB02 *
.*                                                                             *
.*      Modifications      :                                                   *
.*        V11.04.01  27/11/2023  Peter Vela     TSK 0935874                    *
.*                   Added validation for PTCNUNET = 3                         *
.*-----------------------------------------------------------------------------*
.*        V11.02.01  21/01/2022  Jacob Jackson   TSK 0864505                   *
.*                   Add preferred name option fields -                        *
.*                   CNPRN592, CNPRN593, CNPRN594, CNPRN595, CNPRN596          *
.*        V11.00.01  03/04/2020  Thanh T         TSK 0879163                   *
.*                   Changed CNPRN411, CNPRN503 and CNPRN504 for Sex category  *
.*-----------------------------------------------------------------------------*
.*        V10.09.01  10/01/2017  Nicole Torrisi  TSK 0829851                   *
.*                   Added GOTO at end of CNPRN411 - PSEX                      *
.*                   Added CNPRN590 - Separation Date and CNPRN591 -           *
.*                   Separation Destination                                    *
.*        V10.04.00  20/02/2014  Don Nguyen      CAR 291879                    *
.*                   Added variable 189 (CNPRN589) - IHI Number.               *
.*                   Created new include.                                      *
.******************************************************************************
.
.------------------------------------------------------------------------------
.                          CNPRN000    
.  Routine to print the Cancer Registration
.------------------------------------------------------------------------------
CNPRN000  CALL      OPNPRINT                * open the spool file
.
          MATCH     "1",OPCNPLIN
          IF        !@EQUAL
            PRINT     *N;                   * Don't print a blank line at
          ENDIF                             * the start of theatre forms
.                                           * cancer forms
          MOVE      ONE,CURRROW
.
          PACK      KEY12,STATNCOD,SP70
          CALL      RSIBDET1                * position on the details file
          CALL      RKIBDET1
          BRANCH    OVRCD,CNPRN990
.
          MATCH     STATNCOD,IBDTSCOD       * match stationary codes
          GOTO      CNPRN990 IF NOT EQUAL
.
          MOVE      IBDTROW,LASTROW
.
          COMPARE   CURRROW,IBDTROW         * compare rows
          GOTO      CNPRN200 IF EQUAL
.
.------ print new-lines until current row equals the one read in ------
.
CNPRN050  PRINT     *N;
          ADD       ONE,CURRROW
.
          COMPARE   CURRROW,IBDTROW         * compare rows
          GOTO      CNPRN200 IF EQUAL
.
          GOTO      CNPRN050
.
.------ read through the details file ------
.
CNPRN100  CALL      RKIBDET1
          BRANCH    OVRCD,CNPRN900
.
          MATCH     STATNCOD,IBDTSCOD       * match stationary codes
          GOTO      CNPRN900 IF NOT EQUAL
.
          MOVE      IBDTROW,LASTROW
.
          COMPARE   CURRROW,IBDTROW         * compare rows
          GOTO      CNPRN200 IF EQUAL
.
.------ print new-lines until current row equals the one read in ------
.
CNPRN110  PRINT     *N;
          ADD       ONE,CURRROW
.
          COMPARE   CURRROW,IBDTROW         * compare rows
          GOTO      CNPRN200 IF EQUAL
.
          GOTO      CNPRN110
.
.------ branch on the field type ------
.
CNPRN200  BRANCH    IBDTINDC,CNPRN300,CNPRN400
.
.------ the field is a text field ------
.
CNPRN300  RESET     IBDTTXFL,IBDTPLEN
          LENSET    IBDTTXFL
          RESET     IBDTTXFL
          PRINT     *IBDTCOL,*+,IBDTTXFL;
          GOTO      CNPRN100
.
.------ the field is a data field ------
.
CNPRN400  MOVE      IBDTTXFL,DIM5
          MOVE      DIM5,FORM5
.
          PACK      VARIABLE,SP70,SP70   * Clear here
.
          BRANCH    FORM5,CNPRN401,CNPRN402,CNPRN403,CNPRN404,CNPRN405: * 5
                          CNPRN406,CNPRN407,CNPRN408,CNPRN409,CNPRN410: * 10
                          CNPRN411,CNPRN412,CNPRN413,CNPRN414,CNPRN415: * 15
                          CNPRN416,CNPRN417,CNPRN418,CNPRN419,CNPRN420: * 20
                          CNPRN421,CNPRN422,CNPRN423,CNPRN424,CNPRN425: * 25
                          CNPRN426,CNPRN427,CNPRN428,CNPRN429,CNPRN430: * 30
                          CNPRN431,CNPRN432,CNPRN433,CNPRN434,CNPRN435: * 35
                          CNPRN436,CNPRN437,CNPRN438,CNPRN439,CNPRN440: * 40
                          CNPRN441,CNPRN442,CNPRN443,CNPRN444,CNPRN445: * 45
                          CNPRN446,CNPRN447,CNPRN448,CNPRN449,CNPRN450: * 50
                          CNPRN451,CNPRN452,CNPRN453,CNPRN454,CNPRN455: * 55
                          CNPRN456,CNPRN457,CNPRN458,CNPRN459,CNPRN460: * 60
                          CNPRN461,CNPRN462,CNPRN463,CNPRN464,CNPRN465: * 65
                          CNPRN466,CNPRN467,CNPRN468,CNPRN469,CNPRN470: * 70
                          CNPRN471,CNPRN472,CNPRN473,CNPRN474,CNPRN475: * 75
                          CNPRN476,CNPRN477,CNPRN478,CNPRN479,CNPRN480: * 80
                          CNPRN481,CNPRN482,CNPRN483,CNPRN484,CNPRN485: * 85
                          CNPRN486,CNPRN487,CNPRN488,CNPRN489,CNPRN490: * 90
                          CNPRN491,CNPRN492,CNPRN493,CNPRN494,CNPRN495: * 95
                          CNPRN496,CNPRN497,CNPRN498,CNPRN499,CNPRN500: * 100
                          CNPRN501,CNPRN502,CNPRN503,CNPRN504,CNPRN505: * 105
                          CNPRN506,CNPRN507,CNPRN508,CNPRN509,CNPRN510: * 110
                          CNPRN511,CNPRN512,CNPRN513,CNPRN514,CNPRN515: * 115
                          CNPRN516,CNPRN517,CNPRN518,CNPRN519,CNPRN520: * 120
                          CNPRN521,CNPRN522,CNPRN523,CNPRN524,CNPRN525: * 125
                          CNPRN526,CNPRN527,CNPRN528,CNPRN529,CNPRN530: * 130
                          CNPRN531,CNPRN532,CNPRN533,CNPRN534,CNPRN535: * 135
                          CNPRN536,CNPRN537,CNPRN538,CNPRN539,CNPRN540: * 140
                          CNPRN541,CNPRN542,CNPRN543,CNPRN544,CNPRN545: * 145
                          CNPRN546,CNPRN547,CNPRN548,CNPRN549,CNPRN550: * 150
                          CNPRN551,CNPRN552,CNPRN553,CNPRN554,CNPRN555: * 155
                          CNPRN556,CNPRN557,CNPRN558,CNPRN559,CNPRN560: * 160
                          CNPRN561,CNPRN562,CNPRN563,CNPRN564,CNPRN565: * 165
                          CNPRN566,CNPRN567,CNPRN568,CNPRN569,CNPRN570: * 170
                          CNPRN571,CNPRN572,CNPRN573,CNPRN574,CNPRN575: * 175
                          CNPRN576,CNPRN577,CNPRN578,CNPRN579,CNPRN580: * 180
                          CNPRN581,CNPRN582,CNPRN583,CNPRN584,CNPRN585: * 185
                          CNPRN586,CNPRN587,CNPRN588,CNPRN589,CNPRN590: * 190
                          CNPRN591,CNPRN592,CNPRN593,CNPRN594,CNPRN595: * 195
                          CNPRN596
.
          GOTO      CNPRN100
.
.------ format the Registration number ------
.
CNPRN401  MOVE      PTCDCNRG,VARIABLE
          MOVE      TEN,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ format the U/R number ------
.
CNPRN402  MOVE      PURNO,VARIABLE
          MOVE      EIGHT,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ format the patients name ------
.
CNPRN403  MOVE      TWO,PACFRMT
          MOVE      PSNAME,PACSNAME
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          CALL      PACNAME                      * pack the patients name
          MOVE      PACFNAME,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients surname ------
.
CNPRN404  MOVE      PSNAME,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients given name ------
.
CNPRN405  MOVE      PGNAME,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients title ------
.
CNPRN406  MOVE      PTITL,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients address line 1 ------
.
CNPRN407  MOVE      PADD1,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients address line 2 ------
.
CNPRN408  MOVE      PADD2,VARIABLE
          GOTO      CNPRN740
.
.------ format the suburb ------
.
CNPRN409  MOVE      PSUBRB,VARIABLE
          GOTO      CNPRN740
.
.------ format the post code ------
.
CNPRN410  MOVE      PPOST,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients sex description ------
.
CNPRN411  MOVE      SP70,VARIABLE
          MOVE      PSEX,DSEXCHAR
          CALL      SEXDSP00    
          MOVE      DSEXASC1,VARIABLE
          GOTO      CNPRN740
.
CNPRN412  UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ format the patients age ------
.
CNPRN413  MOVE      PSAGE,VARIABLE
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ format Admission ------
.
CNPRN414  PACK      VARIABLE,ADMISSNO,SP70
          GOTO      CNPRN740
.
.------ format Multiple Primaries (patcrgaf) ------
.
CNPRN415  MOVE      PTCRMULT,VARIABLE
          GOTO      CNPRN740
.
.------ format LOS in NZ Yrs (patcrgaf) ------
.
CNPRN416  MOVE      PTCRSTAY,VARIABLE
          MOVE      TWO,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ format Converted Record (patcrgaf) ------
.
CNPRN417  MATCH     "1",PTCRVERT
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Primary Site (patcrgaf) ------
.
CNPRN418  MOVE      PTCRPRIM,VARIABLE
          GOTO      CNPRN740
.
.------ format Primary Site Desc (patcrgaf) ------
.
CNPRN419  PACK      KEY9,PTCRPRIM,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Histological Site (patcrgaf) ------
.
CNPRN420  MOVE      PTCRHIST,VARIABLE
          GOTO      CNPRN740
.
.------ format Histological Site Desc(patcrgaf) ------
.
CNPRN421  PACK      KEY9,PTCRHIST,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Date of 1st Admission (patcrdaf) ------
.
CNPRN422  UNPACK    PTCDADTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ format Date of 1st Diag (patcrdaf) ------
.
CNPRN423  UNPACK    PTCDDDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ format Date of Tumour Recurrence (patcrdaf) ------
.
CNPRN424  UNPACK    PTCDTMRC,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ format Date Metastic Spread (patcrdaf) ------
.
CNPRN425  UNPACK    PTCDMTSP,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ format Unkown Primary Y/N (patcrdaf) ------
.
CNPRN426  COMPARE   ONE,PTCDUKPR
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Primary Site (patcrdaf) ------
.
CNPRN427  MOVE      PTCDPRMM,VARIABLE
          GOTO      CNPRN740
.
.------ format Primary Site Desc(patcrdaf) ------
.
CNPRN428  PACK      KEY9,PTCDPRMM,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Histololgical Site (patcrdaf) ------
.
CNPRN429  MOVE      PTCDHTYP,VARIABLE
          GOTO      CNPRN740
.
.------ format Histololgical Site Desc(patcrdaf) ------
.
CNPRN430  PACK      KEY9,PTCDHTYP,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Metastatic Type 1 (patcrdaf) ------
.
CNPRN431  MOVE      PTCDMET1,VARIABLE
          GOTO      CNPRN740
.
.------ format Metastatic Type 1 Desc(patcrdaf) ------
.
CNPRN432  PACK      KEY9,PTCDMET1,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Metastatic Type 2 (patcrdaf) ------
.
CNPRN433  MOVE      PTCDMET2,VARIABLE
          GOTO      CNPRN740
.
.------ format Metastatic Type 2 Desc(patcrdaf) ------
.
CNPRN434  PACK      KEY9,PTCDMET2,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Metastatic Type 3 (patcrdaf) ------
.
CNPRN435  MOVE      PTCDMET3,VARIABLE
          GOTO      CNPRN740
.
.------ format Metastatic Type 3 Desc(patcrdaf) ------
.
CNPRN436  PACK      KEY9,PTCDMET3,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ format Laterality Cat LY (patcrdaf) ------
.
CNPRN437  MOVE      "LY",CATEGORY
          MOVE      PTCDLATR,CODE
          CALL      GETCOD00
          MOVE      TDESC,VARIABLE
          GOTO      CNPRN740
.
.------ format Staging Cat SG (patcrdaf) ------
.
CNPRN438  MOVE      "SG",CATEGORY
          MOVE      PTCDSTAG,CODE
          CALL      GETCOD00
          MOVE      TDESC,VARIABLE
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 1 (patcrdaf) ------
.
CNPRN439  MATCH     "1",PTCDBT01
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 2 (patcrdaf) ------
.
CNPRN440  MATCH     "1",PTCDBT02
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 3 (patcrdaf) ------
.
CNPRN441  MATCH     "1",PTCDBT03
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 4 (patcrdaf) ------
.
CNPRN442  MATCH     "1",PTCDBT04
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 5 (patcrdaf) ------
.
CNPRN443  MATCH     "1",PTCDBT05
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 6 (patcrdaf) ------
.
CNPRN444  MATCH     "1",PTCDBT06
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 7 (patcrdaf) ------
.
CNPRN445  MATCH     "1",PTCDBT07
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 8 (patcrdaf) ------
.
CNPRN446  MATCH     "1",PTCDBT08
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 9 (patcrdaf) ------
.
CNPRN447  MATCH     "1",PTCDBT09
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (this facility) 10 (patcrdaf) ------
.
CNPRN448  MATCH     "1",PTCDBT10
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Other Diag (this facility) (patcrdaf) ------
.
CNPRN449  MOVE      PTCDOTDG,VARIABLE
          GOTO      CNPRN740
.
.------ format Readmission Flag (patcrdaf) ------
.
CNPRN450  COMPARE   ONE,PTCDRFLG
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Pathology Code (patcrdaf) ------
.
CNPRN451  MOVE      PTCDPATH,VARIABLE
          GOTO      CNPRN740
.
.------ format Pathology Code Desc(patcrdaf) ------
.
CNPRN452  PACK      KEY9,PTCDPATH,SP70
          CALL      RDICD1
          BRANCH    OVRCD,CNPRN100
.
          PACK      VARIABLE,DDESC,SP70
          GOTO      CNPRN740
.
.------ Cancer Diagnosed Prior to Admission (patcrdaf) ------
.
CNPRN453  MATCH     "0",PTCDDGPR
          IF        @EQUAL
            MOVE      "No",VARIABLE
            GOTO      CNPRN740
          ENDIF
          MATCH     "1",PTCDDGPR
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
            GOTO      CNPRN740
          ENDIF
          MATCH     "2",PTCDDGPR
          IF        @EQUAL
            MOVE      "Unknown",VARIABLE
            GOTO      CNPRN740
          ENDIF
          GOTO      CNPRN740
.
.------ Facility Previously Diagnosed at (patcrdaf) ------
.
CNPRN454  MOVE      PTCDFCPR,VARIABLE
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 1 (patcrdaf) ------
.
CNPRN455  MATCH     "1",PTCDBO01
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 2 (patcrdaf) ------
.
CNPRN456  MATCH     "1",PTCDBO02
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 3 (patcrdaf) ------
.
CNPRN457  MATCH     "1",PTCDBO03
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 4 (patcrdaf) ------
.
CNPRN458  MATCH     "1",PTCDBO04
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 5 (patcrdaf) ------
.
CNPRN459  MATCH     "1",PTCDBO05
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 6 (patcrdaf) ------
.
CNPRN460  MATCH     "1",PTCDBO06
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 7 (patcrdaf) ------
.
CNPRN461  MATCH     "1",PTCDBO07
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 8 (patcrdaf) ------
.
CNPRN462  MATCH     "1",PTCDBO08
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ format Basis for Diag (oth facility) 9 (patcrdaf) ------
.
CNPRN463  MATCH     "1",PTCDBO09
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Other Diagnosis (other facility) (patcrdaf) ------
.
CNPRN464  MOVE      PTCDDGOT,VARIABLE
          GOTO      CNPRN740
.
.------ Cancer Diagnosed on Autopsy only (patcrdaf) ------
.
CNPRN465  COMPARE   ONE,PTCDAUTP
          IF        @EQUAL
            MOVE      "Yes",VARIABLE
          ELSE
            MOVE      "No",VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Breslow Thickness (patcrdaf) ------
.
CNPRN466  MOVE      PTCDBRLW,VARIABLE
          MOVE      FOUR,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ format Melanoma Invasion level Cat IL (patcrdaf) ------
.
CNPRN467  MOVE      "IL",CATEGORY
          MOVE      PTCDMLIN,CODE
          CALL      GETCOD00
          MOVE      TDESC,VARIABLE
          GOTO      CNPRN740
.
.------ format Reporting Lab Cat LB (patcrdaf) ------
.
CNPRN468  MOVE      "LB",CATEGORY
          MOVE      PTCDRPLB,CODE
          CALL      GETCOD00
          MOVE      TDESC,VARIABLE
          GOTO      CNPRN740
.
.------ Breast Tumour Size (patcrdaf) ------
.
CNPRN469  MOVE      PTCDBTSZ,VARIABLE
          MOVE      FOUR,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ Clarks Level (patcrdaf) ------
.
CNPRN470  MOVE      PTCDCKLV,VARIABLE
          GOTO      CNPRN740
.
.------ Gleason Score (patcrdaf) ------
.
CNPRN471  MOVE      PTCDGLSC,VARIABLE
          MOVE      FOUR,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      CNPRN750
.
.------ Comments (patcrdaf) ------
.
CNPRN472  MOVE      PTCDCOMM,VARIABLE
          GOTO      CNPRN740
.
.------ Date Extracted (patcrdaf) ------
.
CNPRN473  UNPACK    PTCDDTEX,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ Date Record Created (patcrdaf) ------
.
CNPRN474  UNPACK    PTCDDTRC,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ Time Record Created (patcrdaf) ------
.
CNPRN475  MOVE      PTCDTMCR,VARIABLE
          GOTO      CNPRN740
.
.------ User who created record (patcrdaf) ------
.
CNPRN476  PACK      KEY10,PTCDUSCR,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,CNPRN100

          MOVE      WBSENAM,VARIABLE
          GOTO      CNPRN740
.
.------ Date Record Updated (patcrdaf) ------
.
CNPRN477  UNPACK    PTCDDTUP,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      CNPRN740
.
.------ Time Record Updated (patcrdaf) ------
.
CNPRN478  MOVE      PTCDTMUP,VARIABLE
          GOTO      CNPRN740
.
.------ User who last updated record (patcrdaf) ------
.
CNPRN479  PACK      KEY10,PTCDUSUP,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,CNPRN100

          MOVE      WBSENAM,VARIABLE
          GOTO      CNPRN740
.
.------ format Basis of Diagnois Cat BD (patcrdaf) ------
.
CNPRN480  MOVE      "BD",CATEGORY
          MOVE      PTCDBSDG,CODE
          CALL      GETCOD00
          MOVE      TDESC,VARIABLE
          GOTO      CNPRN740
.
.------ Medicare Number ------                                         *I-53464
.
CNPRN481  MOVE      PMEDI,VARIABLE
          GOTO      CNPRN740
.
.------ Medicare Reference Numbr ------                                *I-53464
.
CNPRN482  MOVE      PTMXMCCD,VARIABLE
          GOTO      CNPRN740
.
.------ Patient Address State ------                                   *I-53464
.
CNPRN483  MOVE      PADD4,VARIABLE
          GOTO      CNPRN740
.
.------ Country of Birth Code ------                                   *I-53464
.
CNPRN484  MOVE      PCONT,VARIABLE
          GOTO      CNPRN740
.
.------ Country of Birth Description ------                            *I-53464
.
CNPRN485  PACK      KEY5,ANSC,SP1,PCONT,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      PCONT,VARIABLE
          ELSE
            MOVE      TDESC,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Indigenous Status Code ------                                  *I-53464
.
CNPRN486  MOVE      PMPXABRG,VARIABLE
          GOTO      CNPRN740
.
.------ Indigenous Status Description ------                           *I-53464
.
CNPRN487  PACK      KEY5,ANSV,ANSA,PMPXABRG,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      PMPXABRG,VARIABLE
          ELSE
            MOVE      TDESC,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Attending Doctor Formatted Name ------                         *I-53464
.
CNPRN488  PACK      VARIABLE,SP30,SP30,SP30,SP30,SP7
          MATCH     SP6,ADOCTA
          GOTO      CNPRN740 IF EQUAL
.
          MOVE      ADOCTA,KEY6
          CALL      RDDOCT1                  * read the doctors file
          BRANCH    OVRCD,CNPRN740
.
          STRIP     DTITL
          STRIP     DGNAME
          STRIP     DSNAME
          MOVE      DTITL,FMTTITLE
          MOVE      DGNAME,FMTGNAME
          MOVE      DSNAME,FMTSNAME
          CALL      DOCNM000
          PACK      VARIABLE,DOCFNAME
          RESET     DTITL
          RESET     DGNAME
          RESET     DSNAME
.
          GOTO      CNPRN740
.
.------  Local GP (HCP) Formatted Name ------                          *I-53464
.
CNPRN489  PACK      VARIABLE,SP30,SP30,SP30,SP30,SP7
          MATCH     SP8,PMPXRHC1
          GOTO      CNPRN740 IF EQUAL
.
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1                  * read the HCP file
          BRANCH    OVRCD,CNPRN740
.
          STRIP     PMHCTITL
          STRIP     PMHCGNAM
          STRIP     PMHCSNAM
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          PACK      VARIABLE,DOCFNAME
          RESET     PMHCTITL
          RESET     PMHCGNAM
          RESET     PMHCSNAM
.
          GOTO      CNPRN740
.
.------  Local GP (HCP) Address Line 1 ------                          *I-53464
.
CNPRN490  MOVE      SP70,PMHCADR1              * HCP address line 1
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR1,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) Address Line 2 ------                          *I-53464
.
CNPRN491  MOVE      SP70,PMHCADR2              * HCP address line 2
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR2,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) Address Line 3 ------                          *I-53464
.
CNPRN492  MOVE      SP70,PMHCADR3              * HCP address line 3
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR3,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) Address Line 4 ------                          *I-53464
.
CNPRN493  MOVE      SP70,PMHCADR4              * HCP address line 4
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR4,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) Address Line 5 ------                          *I-53464
.
CNPRN494  MOVE      SP70,PMHCADR5              * HCP address line 5
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR5,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) Address Line 6 ------                          *I-53464
.
CNPRN495  MOVE      SP70,PMHCADR6              * HCP address line 6
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCADR6,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) Post Code ------                               *I-53464
.
CNPRN496  MOVE      SP70,PMHCPOST              * HCP Post Code
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCPOST,VARIABLE
          GOTO      CNPRN740
.
.------  Local GP (HCP) State ------                                   *I-53464
.
CNPRN497  MOVE      SP70,PMHCSTAT              * HCP State
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          MOVE      PMHCSTAT,VARIABLE
          GOTO      CNPRN740
.
.------  Date of Death ------                                          *I-53464
.
CNPRN498  UNPACK    PDECDTE,CCENT,CYEAR,CMON,CDAY
          PACK      VARIABLE,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          GOTO      CNPRN740
.
.------ NOK Mobile Number      (pmspx2af) ------
.
CNPRN499  MOVE      PMPXKMOB,VARIABLE
          GOTO      CNPRN740
.
.------ Emergency Contact Mobile Number (pmspx2af) ------
.
CNPRN500  MOVE      PMPXCMOB,VARIABLE
          GOTO      CNPRN740
.
.------ Nearest Relative Mobile Number (pmspx2af) ------
.
CNPRN501  MOVE      PMPXRMOB,VARIABLE
          GOTO      CNPRN740
.
.         Singapore HRN
.
CNPRN502  PROC      GETALTID
          GOTO      CNPRN740
.
.------ Gender - Male Flag
.
CNPRN503  MOVE      SP70,VARIABLE
          MOVE      PSEX,VARIABLE
          GOTO      CNPRN740
.
.------ Gender - Female Flag
.
CNPRN504  MOVE      SP70,VARIABLE
          MOVE      PSEX,VARIABLE
          GOTO      CNPRN740
.
.------ Marital Status - Single
.
CNPRN505  MOVE      SP70,VARIABLE
          MATCH     SP3,PMSTAT
          IF        !@EQUAL
            PACK      KEY5,ANSM,SP1,PMSTAT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "1",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Marital Status - Married
.
CNPRN506  MOVE      SP70,VARIABLE
          MATCH     SP3,PMSTAT
          IF        !@EQUAL
            PACK      KEY5,ANSM,SP1,PMSTAT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "2",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Marital Status - Divorced
.
CNPRN507  MOVE      SP70,VARIABLE
          MATCH     SP3,PMSTAT
          IF        !@EQUAL
            PACK      KEY5,ANSM,SP1,PMSTAT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "4",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Marital Status - Separated
.
CNPRN508  MOVE      SP70,VARIABLE
          MATCH     SP3,PMSTAT
          IF        !@EQUAL
            PACK      KEY5,ANSM,SP1,PMSTAT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "5",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Marital Status - Widowed
.
CNPRN509  MOVE      SP70,VARIABLE
          MATCH     SP3,PMSTAT
          IF        !@EQUAL
            PACK      KEY5,ANSM,SP1,PMSTAT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "3",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Marital Status - Others
.
CNPRN510  MOVE      SP70,VARIABLE
          MATCH     SP3,PMSTAT
          IF        !@EQUAL
            PACK      KEY5,ANSM,SP1,PMSTAT
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      THCSCOD,ANS
              TYPE      ANS
              IF        @EQUAL
                MOVE      ANS,FORM1
                IF        FORM1 < 1 | FORM1 > 5
                  MOVE      ANSX,VARIABLE
                ENDIF
              ELSE
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - Singapore
.
CNPRN511  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "01",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - Malaysia
.
CNPRN512  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "02",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - China
.
CNPRN513  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "30",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - Indonesia
.
CNPRN514  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "03",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - India
.
CNPRN515  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "15",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - Pakistan
.
CNPRN516  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "16",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Country of Birth - Others
.
CNPRN517  MOVE      SP70,VARIABLE
          MATCH     SP3,PCONT
          IF        !@EQUAL
            PACK      KEY5,ANSC,SP1,PCONT
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      THCSCOD,DIM2
              TYPE      DIM2
              IF        @EQUAL
                MOVE      DIM2,FORM2
                IF        FORM2 <> 1 & FORM2 <> 2 & FORM2 <> 3 & FORM2 <> 15 & FORM2 <> 16 & FORM2 <> 30
                  MOVE      ANSX,VARIABLE
                ENDIF
              ELSE
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Ethnic Group (Race) - Chinese
.
CNPRN518  MOVE      SP70,VARIABLE
          MATCH     SP3,PUSR5
          IF        !@EQUAL
            PACK      KEY5,ANSP,FIVE,PUSR5
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "C",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Ethnic Group (Race) - Malay
.
CNPRN519  MOVE      SP70,VARIABLE
          MATCH     SP3,PUSR5
          IF        !@EQUAL
            PACK      KEY5,ANSP,FIVE,PUSR5
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "M",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Ethnic Group (Race) - Indian
.
CNPRN520  MOVE      SP70,VARIABLE
          MATCH     SP3,PUSR5
          IF        !@EQUAL
            PACK      KEY5,ANSP,FIVE,PUSR5
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     "I",THCSCOD
              IF        @EQUAL
                MOVE      ANSX,VARIABLE
              ENDIF
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Ethnic Group (Race) - Others
.
CNPRN521  MOVE      SP70,VARIABLE
          MATCH     SP3,PUSR5
          IF        !@EQUAL
            PACK      KEY5,ANSP,FIVE,PUSR5
            CALL      RDCODE1
            IF        OVRCD = 0
              MATCH     ANSC,THCSCOD             * Chinese ?
              GOTO      CNPRN740 IF EQUAL        * yes - ignore
.
              MATCH     ANSM,THCSCOD             * Malay ?
              GOTO      CNPRN740 IF EQUAL        * yes - ignore
.
              MATCH     ANSI,THCSCOD             * Indian ?
              GOTO      CNPRN740 IF EQUAL        * yes - ignore
.
              MOVE      ANSX,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Death Certificate Only
.
CNPRN522  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD1
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Clinical Only
.
CNPRN523  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD2
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Clinical Investigation
.
CNPRN524  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD3
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Specified Tumour Marker
.
CNPRN525  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD4
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Cytology
.
CNPRN526  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD5
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Cytology Lab No.
.
CNPRN527  MOVE      PTCDBOL5,VARIABLE
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Metastasis
.
CNPRN528  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD6
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Metastasis Lab No.
.
CNPRN529  MOVE      PTCDBOL6,VARIABLE
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Primary Tumour
.
CNPRN530  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDBOD7
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Basis for Diagnosis - Primary Tumour Lab No.
.
CNPRN531  MOVE      PTCDBOL7,VARIABLE
          GOTO      CNPRN740
.
.------ Grade/Differentiation - Well
.
CNPRN532  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD01
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - Moderate
.
CNPRN533  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD02
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - Poor
.
CNPRN534  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD03
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - Undifferentiated
.
CNPRN535  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD04
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - T-Cell
.
CNPRN536  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD05
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - B-Cell
.
CNPRN537  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD06
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - Null Cell
.
CNPRN538  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD07
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - NK Cell
.
CNPRN539  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD08
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Grade/Differentiation - N.O.S
.
CNPRN540  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDGD09
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Present Status - Alive
.
CNPRN541  MOVE      SP70,VARIABLE
          COMPARE   ZERO,PCEASE
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Present Status - Dead
.
CNPRN542  MOVE      SP70,VARIABLE
          COMPARE   ONE,PCEASE
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Present Status - Place of Death
.
CNPRN543  MOVE      SP70,VARIABLE
          COMPARE   ONE,PCEASE
          IF        @EQUAL
            MOVE      PTCDPLOD,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Present Status - Cause of Death Line 1
.
CNPRN544  MOVE      SP70,VARIABLE
          COMPARE   ONE,PCEASE
          IF        @EQUAL
            MOVE      PTCDCOD1,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Present Status - Cause of Death Line 2
.
CNPRN545  MOVE      SP70,VARIABLE
          COMPARE   ONE,PCEASE
          IF        @EQUAL
            MOVE      PTCDCOD2,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Clinical Stage - T
.
CNPRN546  MOVE      PTCDCSGT,VARIABLE
          GOTO      CNPRN740
.
.------ Clinical Stage - N
.
CNPRN547  MOVE      PTCDCSGN,VARIABLE
          GOTO      CNPRN740
.
.------ Clinical Stage - M
.
CNPRN548  MOVE      PTCDCSGM,VARIABLE
          GOTO      CNPRN740
.
.------ Clinical Stage - Stage Grouping
.
CNPRN549  MOVE      PTCDCSSG,VARIABLE
          GOTO      CNPRN740
.
.------ Clinical Stage - Classification Manual
.
CNPRN550  MOVE      PTCDCSCM,VARIABLE
          GOTO      CNPRN740
.
.------ Treatment - No Treatment
.
CNPRN551  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTNON
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Surgery
.
CNPRN552  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTSUR
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Surgery Initiation Date
.
CNPRN553  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDTSDT
          IF        !@EQUAL
            UNPACK    PTCDTSDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Radiotherapy
.
CNPRN554  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTRAD
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Radiotherapy Initiation Date
.
CNPRN555  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDTRDT
          IF        !@EQUAL
            UNPACK    PTCDTRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Chemotherapy
.
CNPRN556  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTCHM
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Chemotherapy Initiation Date
.
CNPRN557  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDTCDT
          IF        !@EQUAL
            UNPACK    PTCDTCDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Hormones
.
CNPRN558  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTHOR
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Hormone Initiation Date
.
CNPRN559  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDTHDT
          IF        !@EQUAL
            UNPACK    PTCDTHDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Biological/Other
.
CNPRN560  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTBIO
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treatment - Biological/Other Initiation Date
.
CNPRN561  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDTBDT
          IF        !@EQUAL
            UNPACK    PTCDTBDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------  Date of First Relapse
.
CNPRN562  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDRLDT
          IF        !@EQUAL
            UNPACK    PTCDRLDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Source of Notification - SN
.
CNPRN563  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDSNT1
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Source of Notification - OR
.
CNPRN564  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDSNT2
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Source of Notification - RS
.
CNPRN565  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDSNT3
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Date of Notification
.
CNPRN566  MOVE      SP70,VARIABLE
          MATCH     SP8,PTCDNTDT
          IF        !@EQUAL
            UNPACK    PTCDNTDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Notifying Doctor Code
.
CNPRN567  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCN
          IF        !@EQUAL
            MOVE      PTCDDOCN,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Notifying Doctor Formatted Name 
.
CNPRN568  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCN
          IF        !@EQUAL
            MOVE      PTCDDOCN,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCSNAM,PACSNAME
              MOVE      PMHCGNAM,PACGNAME
              MOVE      PMHCTITL,PACTITLE
              MOVE      TWO,PACFRMT
              CALL      PACNAME
              MOVE      PACFNAME,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Notifying Hospital
.
CNPRN569  MOVE      CONAME,VARIABLE
          GOTO      CNPRN740
.
.------ Notifying Doctor Surname 
.
CNPRN570  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCN
          IF        !@EQUAL
            MOVE      PTCDDOCN,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCSNAM,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Notifying Doctor Given Names 
.
CNPRN571  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCN
          IF        !@EQUAL
            MOVE      PTCDDOCN,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCGNAM,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Notifying Doctor Title 
.
CNPRN572  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCN
          IF        !@EQUAL
            MOVE      PTCDDOCN,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCTITL,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Notifying Department/Clinic
.
CNPRN573  MOVE      PTCDNDCL,VARIABLE
          GOTO      CNPRN740
.
.------ Treating Hospital - Same
.
CNPRN574  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTSAB
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treating Hospital - Other
.
CNPRN575  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTOTH
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Treating Hospital - Other Description
.
CNPRN576  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDTOTH
          IF        @EQUAL
            MOVE      PTCDTHOS,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Resident Status - Singapore Citizen
.
CNPRN577  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDRST1
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Resident Status - Singapore PR
.
CNPRN578  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDRST2
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Resident Status - Malaysia
.
CNPRN579  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDRST3
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Resident Status - Indonesia
.
CNPRN580  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDRST4
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Resident Status - Other
.
CNPRN581  MOVE      SP70,VARIABLE
          MATCH     "1",PTCDRST5
          IF        @EQUAL
            MOVE      ANSX,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Consultant Code
.
CNPRN582  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCC
          IF        !@EQUAL
            MOVE      PTCDDOCC,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Consultant Formatted Name 
.
CNPRN583  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCC
          IF        !@EQUAL
            MOVE      PTCDDOCC,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCSNAM,PACSNAME
              MOVE      PMHCGNAM,PACGNAME
              MOVE      PMHCTITL,PACTITLE
              MOVE      TWO,PACFRMT
              CALL      PACNAME
              MOVE      PACFNAME,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Consultant Surname 
.
CNPRN584  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCC
          IF        !@EQUAL
            MOVE      PTCDDOCC,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCSNAM,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Consultant Given Names 
.
CNPRN585  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCC
          IF        !@EQUAL
            MOVE      PTCDDOCC,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCGNAM,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Consultant Title 
.
CNPRN586  MOVE      SP70,VARIABLE
          MATCH     SP10,PTCDDOCC
          IF        !@EQUAL
            MOVE      PTCDDOCC,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 0
              MOVE      PMHCTITL,VARIABLE
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------ Hospital ID ------
.
CNPRN587  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          IF        IBCNMHOS<>1
            GOTO      CNPRN740
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL & !@EOS
            PACK      KEY3,PMVXMHOS,SP70
            CALL      RDPTHSP1
            MOVE      PTHSHOSP,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
.------ Hospital Name/Description ------
.
CNPRN588  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          IF        IBCNMHOS<>1
            MOVE      CNAME,VARIABLE
            GOTO      CNPRN740
          ENDIF
          MATCH     SP70,PMVXMHOS
          IF        !@EQUAL & !@EOS
            PACK      KEY3,PMVXMHOS,SP70
            CALL      RDPTHSP1
            MOVE      PTHSNAME,VARIABLE
          ELSE
            MOVE      CNAME,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
CNPRN589  PACK      VARIABLE,SP70
          MATCH     "1",PTCNUNET
          IF        @EQUAL
            CALL      GTIHINUM
            MOVE      IHINUMBR,VARIABLE       * IHI Number
          ELSE
            MATCH     "3",PTCNUNET
            IF        @EQUAL
              CALL      GTIHINUM                   * IHI Number
              LJUSTIFY  IHINUMBR
              UNPACK    IHINUMBR,DIM4,DIM4A,DIM4B,DIM4C
              PACK      VARIABLE,DIM4,SP1,DIM4A,SP1,DIM4B,SP1,DIM4C
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
CNPRN590  PACK      VARIABLE,SP70
          MATCH     SP8,DDATE
          IF        !@EQUAL
            UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
CNPRN591  PACK      KEY5,ANSD,ANSD,DDEST,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      DDEST,VARIABLE
          ELSE
            MOVE      TDESC,VARIABLE
          ENDIF
          GOTO      CNPRN740
.
CNPRN592  PACK      VARIABLE,PMPXPFSN,SP70   * Preferred Surname
          GOTO      CNPRN740
.
CNPRN593  PACK      VARIABLE,PMPXPFGN,SP70   * Preferred Given Name
          GOTO      CNPRN740
.
CNPRN594  PACK      VARIABLE,PSNAME,SP70     * Pref Surname instead of Actual SN
          MATCH     "1",PTCNPFSN
          IF        @EQUAL
            MATCH     SP70,PMPXPFSN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFSN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
CNPRN595  PACK      VARIABLE,PGNAME,SP70     * Pref GN instead of Actual GN
          MATCH     "1",PTCNPFGN
          IF        @EQUAL
            MATCH     SP70,PMPXPFGN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFGN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
CNPRN596  PACK      VARIABLE,PTMASNAM,SP70   * Pref Surname instead of 40char SN
          MATCH     "1",PTCNPFSN
          IF        @EQUAL
            MATCH     SP70,PMPXPFSN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFSN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      CNPRN740
.
.------- Print Vars --------
.
CNPRN740  RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
          PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      CNPRN100
.
.------ formatting for Form fields and right justified variables ------
.
CNPRN750  COMPARE   ZERO,PRNTSTRT          * don't bump if printing full length
          GOTO      CNPRN760 IF EQUAL
.
          BUMP      VARIABLE,PRNTSTRT      * bump to starting position
.
.------ print the variable ------
.
CNPRN760  PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      CNPRN100
.
.------ end of medical record request form reached ------
.
CNPRN900  MOVE      FALSE,EXIT
.
.------ print new-lines until the end of page is reached ------
.
CNPRN910  PRINT     *N;
          ADD       ONE,LASTROW
.
          COMPARE   LASTROW,IBTHLENG          * test page length
          GOTO      CNPRN999 IF EQUAL
.
          GOTO      CNPRN910
.
.------ no details on file ------
.
CNPRN990  MOVE      TRUE,EXIT
.
CNPRN999  CALL      CLSPRINT                  * close the spool file
          RETURN
+
