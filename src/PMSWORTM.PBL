. *----------------------------------------------------------------------
. * Include Name  :   PMSWORTM.INC
. *
. * Function      :   Patient Working Diagnosis File CGI Variable
. *                   Common Functions
. *
. * Modifications :
. *
. * V9.09.01  Ebon Clements         CAR 142954
. *           Added PMSWO019
. * V9.08.00  Ebon Clements         CAR 132858
. *           Added Added PMSWO006 to PMSWO018
. * V9.03.00  Ebon Clements         CAR 44795
. *           Created Include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear CGI Parameters for PMSWORFD
.------------------------------------------------------------------------
CPPMWO00  MOVE      Z70,PMSWO001
          MOVE      Z70,PMSWO002
          MOVE      Z70,PMSWO003
          MOVE      Z70,PMSWO004
          MOVE      Z70,PMSWO005
          MOVE      Z70,PMSWO006
          MOVE      Z70,PMSWO007
          MOVE      Z70,PMSWO008
          MOVE      Z70,PMSWO009
          MOVE      Z70,PMSWO010
          MOVE      Z70,PMSWO011
          MOVE      Z70,PMSWO012
          MOVE      Z70,PMSWO013
          MOVE      Z70,PMSWO014
          MOVE      Z70,PMSWO015
          MOVE      Z70,PMSWO016
          MOVE      Z70,PMSWO017
          MOVE      Z70,PMSWO018
          MOVE      Z70,PMSWO019
.
          MOVE      ZERO,WDIGFLAG           * Set update record to No
.
CPPMWO99  RETURN
.
.
.------------------------------------------------------------
.   Set Parameters for PMSWORFD
.------------------------------------------------------------
SPPMWO00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMWO01,SPPMWO02,SPPMWO03,SPPMWO04,SPPMWO05:
                       SPPMWO06,SPPMWO07,SPPMWO08,SPPMWO09,SPPMWO10:
                       SPPMWO11,SPPMWO12,SPPMWO13,SPPMWO14,SPPMWO15:
                       SPPMWO16,SPPMWO17,SPPMWO18,SPPMWO19
.
          MOVE      ONE,EXIT
          GOTO      SPPMWO99
.
SPPMWO01  MOVE      QRYDATA,PMSWO001
          GOTO      SPPMWO90
.
SPPMWO02  MOVE      QRYDATA,PMSWO002
          GOTO      SPPMWO90
.
SPPMWO03  MOVE      QRYDATA,PMSWO003
          GOTO      SPPMWO90
.
SPPMWO04  MOVE      QRYDATA,PMSWO004
          GOTO      SPPMWO90
.
SPPMWO05  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSWO005,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMWO90
.
SPPMWO06  MOVE      QRYDATA,PMSWO006  
          GOTO      SPPMWO90
.
SPPMWO07  MOVE      QRYDATA,PMSWO007  
          GOTO      SPPMWO90
.
SPPMWO08  MOVE      QRYDATA,PMSWO008  
          GOTO      SPPMWO90
.
SPPMWO09  MOVE      QRYDATA,PMSWO009  
          GOTO      SPPMWO90
.
SPPMWO10  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSWO010,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMWO90
.
SPPMWO11  MOVE      QRYDATA,PMSWO011  
          GOTO      SPPMWO90
.
SPPMWO12  MOVE      QRYDATA,PMSWO012  
          GOTO      SPPMWO90
.
SPPMWO13  MOVE      QRYDATA,PMSWO013  
          GOTO      SPPMWO90
.
SPPMWO14  MOVE      QRYDATA,PMSWO014  
          GOTO      SPPMWO90
.
SPPMWO15  MOVE      QRYDATA,PMSWO015  
          GOTO      SPPMWO90
.
SPPMWO16  MOVE      QRYDATA,PMSWO016  
          GOTO      SPPMWO90
.
SPPMWO17  MOVE      QRYDATA,PMSWO017  
          GOTO      SPPMWO90
.
SPPMWO18  MOVE      QRYDATA,PMSWO018  
          GOTO      SPPMWO90
.
SPPMWO19  MOVE      QRYDATA,PMSWO019  
          GOTO      SPPMWO90
.
SPPMWO90  MOVE      ONE,WDIGFLAG            * Set update file flag to yes
          GOTO      SPPMWO99
.
SPPMWO99  RETURN
.------------------------------------------------------------
. Add PMSWORFD Fields
.------------------------------------------------------------
PMWO0000  BRANCH    FLDITMNO,PMWO0100,PMWO0200,PMWO0300,PMWO0400,PMWO0500:
                             PMWO0600,PMWO0700,PMWO0800,PMWO0900,PMWO1000:
                             PMWO1100,PMWO1200,PMWO1300,PMWO1400,PMWO1500:
                             PMWO1600,PMWO1700,PMWO1800,PMWO1900,PMWO2000:
                             PMWO2100,PMWO2200,PMWO2300,PMWO2400,PMWO2500:
                             PMWO2600
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMWO9999
.
PMWO0100  WRITE     HTMLFILE;PMWOADMN;
          GOTO      PMWO9999
.
PMWO0200  WRITE     HTMLFILE;PMWOWDI1;
          GOTO      PMWO9999
.
PMWO0300  WRITE     HTMLFILE;PMWOWDI2;
          GOTO      PMWO9999
.
PMWO0400  WRITE     HTMLFILE;PMWOWDI3;
          GOTO      PMWO9999
.
PMWO0500  MATCH     PMWOEDAT,SP70
          GOTO      PMWO9999 IF EQUAL
.
          UNPACK    PMWOEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMWO9999
.
PMWO0600  MATCH     PMWOCDAT,SP70
          GOTO      PMWO9999 IF EQUAL
.
          UNPACK    PMWOCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMWO9999
.
PMWO0700  WRITE     HTMLFILE;PMWOCTIM;
          GOTO      PMWO9999
.
PMWO0800  PACK      KEY10,PMWOCUID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,PMWO9999
.
          WRITE     HTMLFILE;WBSENAM; 
          GOTO      PMWO9999
.
PMWO0900  MATCH     PMWOUDAT,SP70
          GOTO      PMWO9999 IF EQUAL
.         
          UNPACK    PMWOUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMWO9999
.
PMWO1000  WRITE     HTMLFILE;PMWOUTIM;
          GOTO      PMWO9999
.
PMWO1100  PACK      KEY10,PMWOUUID,SP70
          CALL      RDWBSE1
          BRANCH    OVRCD,PMWO9999
.
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMWO9999
.
PMWO1200  STRIP     PMWOWDI1
          MOVELPTR  PMWOWDI1,LENGTH
          SFORMAT   VAR,LENGTH
          MOVE      PMWOWDI1,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          STRIP     PMWOWDI2
          MOVELPTR  PMWOWDI2,LENGTH
          SFORMAT   VAR,LENGTH
          MOVE      PMWOWDI2,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          STRIP     PMWOWDI3
          MOVELPTR  PMWOWDI3,LENGTH
          SFORMAT   VAR,LENGTH
          MOVE      PMWOWDI3,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          GOTO      PMWO9999
.
PMWO1300  WRITE     HTMLFILE;PMWOEDTM;
          GOTO      PMWO9999
.
PMWO1400  MOVE      "vi",CATEGORY
          MOVE      PMWODPST,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO1500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMWO1510
.
          PACK      KEY10,PMWOCORD,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PMWO9999
.
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      PMWO9999
.
PMWO1510  WRITE     HTMLFILE;PMWOCORD;
          GOTO      PMWO9999
.
PMWO1600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMWO1610
.
          PACK      KEY5,PMWODDES,SP70
          CALL      RDPTVAD1
          BRANCH    OVRCD,PMWO9999
.
          WRITE     HTMLFILE;PTVADESC;
          GOTO      PMWO9999
.
PMWO1610  WRITE     HTMLFILE;PMWODDES;
          GOTO      PMWO9999
.
PMWO1700  MATCH     PMWODTRN,SP70
          GOTO      PMWO9999 IF EQUAL
.         
          UNPACK    PMWODTRN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMWO9999
.
PMWO1800  MOVE      "va",CATEGORY
          MOVE      PMWOUDF1,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO1900  MOVE      "vb",CATEGORY
          MOVE      PMWOUDF2,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2000  MOVE      "vc",CATEGORY
          MOVE      PMWOUDF3,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2100  MOVE      "vd",CATEGORY
          MOVE      PMWOUDF4,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2200  MOVE      "ve",CATEGORY
          MOVE      PMWOUDF5,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2300  MOVE      "vf",CATEGORY
          MOVE      PMWOUDF6,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2400  MOVE      "vg",CATEGORY
          MOVE      PMWOUDF7,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2500  MOVE      "vh",CATEGORY
          MOVE      PMWOUDF8,CODE
          CALL      CODITM00
          GOTO      PMWO9999
.
PMWO2600  WRITE     HTMLFILE;PMWOCEXT;
          GOTO      PMWO9999
.
PMWO9999  RETURN
.
.------------------------------------------------------------
. Clear file variables for PMSWORFD
.------------------------------------------------------------
CLPMWO00  MOVE      SP70,PMWOADMN 
          MOVE      SP70,PMWOWDI1 
          MOVE      SP70,PMWOWDI2 
          MOVE      SP70,PMWOWDI3 
          MOVE      SP70,PMWOEDAT 
          MOVE      SP70,PMWOCDAT 
          MOVE      SP70,PMWOCTIM 
          MOVE      SP70,PMWOCUID 
          MOVE      SP70,PMWOUDAT 
          MOVE      SP70,PMWOUTIM 
          MOVE      SP70,PMWOUUID 
          MOVE      SP70,PMWOEDTM
          MOVE      SP70,PMWODPST
          MOVE      SP70,PMWOCORD
          MOVE      SP70,PMWODDES
          MOVE      SP70,PMWODTRN
          MOVE      SP70,PMWOUDF1
          MOVE      SP70,PMWOUDF2
          MOVE      SP70,PMWOUDF3
          MOVE      SP70,PMWOUDF4
          MOVE      SP70,PMWOUDF5
          MOVE      SP70,PMWOUDF6
          MOVE      SP70,PMWOUDF7
          MOVE      SP70,PMWOUDF8
          MOVE      SP70,PMWOCEXT
          MOVE      SP70,PMWOSPAR 
.
CLPMWO99  RETURN 
.
.------------------------------------------------------------
.  Update PMSWORFD file
.------------------------------------------------------------
MVPMWO00  MATCH     PMSWO001,Z70
          IF        !@EQUAL
            MOVE      PMSWO001,PMWOADMN
          ENDIF
.
          MATCH     PMSWO002,Z70
          IF        !@EQUAL
            MOVE      PMSWO002,PMWOWDI1
          ENDIF
.
          MATCH     PMSWO003,Z70
          IF        !@EQUAL
            MOVE      PMSWO003,PMWOWDI2
          ENDIF
.
          MATCH     PMSWO004,Z70
          IF        !@EQUAL
            MOVE      PMSWO004,PMWOWDI3
          ENDIF
.
          MATCH     PMSWO005,Z70
          IF        !@EQUAL
            MOVE      PMSWO005,PMWOEDAT
          ENDIF
.
          MATCH     PMSWO006,Z70
          IF        !@EQUAL
            MOVE      PMSWO006,PMWOEDTM
          ENDIF
.
          MATCH     PMSWO007,Z70
          IF        !@EQUAL
            MOVE      PMSWO007,PMWODPST
          ENDIF
.
          MATCH     PMSWO008,Z70
          IF        !@EQUAL
            MOVE      PMSWO008,PMWOCORD
          ENDIF
.
          MATCH     PMSWO009,Z70
          IF        !@EQUAL
            MOVE      PMSWO009,PMWODDES
          ENDIF
.
          MATCH     PMSWO010,Z70
          IF        !@EQUAL
            MOVE      PMSWO010,PMWODTRN
          ENDIF
.
          MATCH     PMSWO011,Z70
          IF        !@EQUAL
            MOVE      PMSWO011,PMWOUDF1
          ENDIF
.
          MATCH     PMSWO012,Z70
          IF        !@EQUAL
            MOVE      PMSWO012,PMWOUDF2
          ENDIF
.
          MATCH     PMSWO013,Z70
          IF        !@EQUAL
            MOVE      PMSWO013,PMWOUDF3
          ENDIF
.
          MATCH     PMSWO014,Z70
          IF        !@EQUAL
            MOVE      PMSWO014,PMWOUDF4
          ENDIF
.
          MATCH     PMSWO015,Z70
          IF        !@EQUAL
            MOVE      PMSWO015,PMWOUDF5
          ENDIF
.
          MATCH     PMSWO016,Z70
          IF        !@EQUAL
            MOVE      PMSWO016,PMWOUDF6
          ENDIF
.
          MATCH     PMSWO017,Z70
          IF        !@EQUAL
            MOVE      PMSWO017,PMWOUDF7
          ENDIF
.
          MATCH     PMSWO018,Z70
          IF        !@EQUAL
            MOVE      PMSWO018,PMWOUDF8
          ENDIF
.
          MATCH     PMSWO019,Z70
          IF        !@EQUAL
            MOVE      PMSWO019,PMWOCEXT
          ENDIF
.
MVPMWO99  RETURN
