.************************************************************************
. * Modifications :
. *
. * V10.14.02 04/03/2019  Richa Phogat   TSK 0869551
. *           Added CLMF9400 to display Verbal Consent Gained By HCP-PMWXVHCP
. * V10.14.01 20/02/2019  Ken Bell       TSK 0869548
. *           Added ACDLST00 to Display Injury Diagnosis on ACC Enquiry
.************************************************************************
. * V10.13.01 26/11/2018  Don Nguyen     TSK 0853817
. *           Added Claim Status description for 'Cancelled' (CLMF8700)
. * V10.11.01 24/11/2017  Richa Phogat   TSK 0847509
. *           Added code to display spaces when nothing is selected for
. *           • Involved Moving Vehicle on Public Road Y/N’ - pmwxmovv
. *           • Accident in NZ - pmwainz
.************************************************************************
. * V10.09.01 29/11/2016  Jill Parkinson TSK 0822329
. *           Added new 10.09 fields - Gradual Process Injury, Admitted to 
. *           hospital, Verbal Consent, Approving HCP, Purchase order number
. * V10.08.01 24/08/2016  Ebon Clements TSK 0323341
. *           Added ACC claim status description tag - CLMF8700
.************************************************************************
. * V10.06.01 10.04.2014 Steve Armstrong  CAR 313849
. *           Moved CLPMSWX1 to external routine
.************************************************************************
. * V10.05.01 10.09.2014 J.Tan          CAR 274958
. *           Added Employer code (ptclm083)
.************************************************************************
. * V10.03.01 10.10.2012 Patrick Adair  CAR 273294
. *           Addedd Code to allow insurance code display for TAC records
.************************************************************************
. * V10.02.01 07.09.2011 Saroeun Soeur  CAR 243942
. *           CODINS00 - added PTINACTV check to only display actives
.************************************************************************
. * V10.01.02 13/01/2011 Ebon Clements  CAR 236087
. *           Added defence force claim tags - CLMF8400
. * V10.01.01 10/11/2010 Jill Parkinson CAR 233259
. *           Added CHOSTYP check for MACDAT
.************************************************************************
. * V9.10.01 01/05/2008  Mike Laming   CAR 153670
. *          Added logic for PMWXTPRO (ptclm081) for NZ ACC 
.************************************************************************
. * V9.09.01 01/06/2007 Janet George               
. *          Added tags to CLMF0000 to display additional ACC fields          
. *    ..    06/07/2007  Mike Laming   CAR 142179
. *          Added OPEN for PATIN1A1 at CODINS00 (fix I*C in PATWEB71)
. *    ..    29/06/2007 J.Tan          CAR 144062
. *          Fixed I*C on Insurance file
. * V9.08.01 20/03/2007 Neelkamal Pyla CAR 116317
. *          Added CLMF5100,CLMF5200 tags to CLMF0000 to display the comments 
. * V9.07.01 11/09/2006 Peter Vela    CAR 118226
. *          Added PTWVAUTH, PTWVDATE veteran affairs variables.
. * V9.02.08 28/07/2004 Jill Habasque CAR 50611
. *          Added new ACC fields
. * V9.02.07 28/04/2003 Peter Vela CAR 41539
. *          Fixed undefined global label MISF9999
. * V9.02.06 07/05/2003 J.Tan  CAR 38851
. *          Default TAC accident date to 19010101
. * V9.02.05 22/04/2003 J.Tan  CAR 20009
. *          Added Civil Tort claim fields
. * V9.02.04 08/04/2003 Ebon Clements            CAR 37959
. *          Changed CLMF0800 selection list to have values 1 and 0 no Y and N
. * V9.02.03 19/03/2003 Ebon Clements            SRF 37270
. *          Changed CLMF1300 to not output date if MACDAT is blank
. * V9.02.02 26/02/2003 J.Tan                    SRF 21078
. *          Mods for extension workers compensation details
. * V9.02.01 28/10/2002 Pat Dirito               SRF 23689
. *          Cleaned up bad code.
.************************************************************************
. Claim Details 
.************************************************************************
CLMF0000  BRANCH    FLDITMNO,CLMF0100,CLMF0200,CLMF0300,CLMF0400,CLMF0500:
                             CLMF0600,CLMF0700,CLMF0800,CLMF0900,CLMF1000:
                             CLMF1100,CLMF1200,CLMF1300,CLMF1400,CLMF1500:
                             CLMF1600,CLMF1700,CLMF1800,CLMF1900,CLMF2000:
                             CLMF2100,CLMF2200,CLMF2300,CLMF2400,CLMF2500:
                             CLMF2600,CLMF2700,CLMF2800,CLMF2900,CLMF3000:
                             CLMF3100,CLMF3200,CLMF3300,CLMF3400,CLMF3500:
                             CLMF3600,CLMF3700,CLMF3800,CLMF3900,CLMF4000:
                             CLMF4100,CLMF4200,CLMF4300,CLMF4400,CLMF4500:
                             CLMF4600,CLMF4700,CLMF4800,CLMF4900,CLMF5000:
                             CLMF5100,CLMF5200,CLMF5300,CLMF5400,CLMF5500:
                             CLMF5600,CLMF5700,CLMF5800,CLMF5900,CLMF6000:
                             CLMF6100,CLMF6200,CLMF6300,CLMF6400,CLMF6500:
                             CLMF6600,CLMF6700,CLMF6800,CLMF6900,CLMF7000:
                             CLMF7100,CLMF7200,CLMF7300,CLMF7400,CLMF7500:
                             CLMF7600,CLMF7700,CLMF7800,CLMF7900,CLMF8000:
                             CLMF8100,CLMF8200,CLMF8300,CLMF8400,CLMF8500:
                             CLMF8600,CLMF8700,CLMF8800,CLMF8900,CLMF9000:
                             CLMF9100,CLMF9200,CLMF9300,CLMF9400
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CLMF9999
.
CLMF0100  MATCH     SP70,WCENAME
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCENAME;
          GOTO      CLMF9999
.
CLMF0200  MATCH     SP70,WCEADD1
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCEADD1; 
          GOTO      CLMF9999
.
CLMF0300  MATCH     SP70,WCEADD2
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCEADD2;
          GOTO      CLMF9999
.
CLMF0400  MATCH     SP70,WCEADD3
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCEADD3;
          GOTO      CLMF9999
.
CLMF0500  MATCH     SP70,WCEPOST
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCEPOST; 
          GOTO      CLMF9999
.
CLMF0600  MATCH     SP70,WCETELE
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCETELE;  
          GOTO      CLMF9999
.
CLMF0700  MATCH     SP70,WCACDAT  
          GOTO      CLMF9999 IF EQUAL
          UNPACK    WCACDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
.
CLMF0800  UNPACK    DIM127,D1,KEY1,DIM127    
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF0810,CLMF0820
          WRITE     HTMLFILE;WCACCPT;
          GOTO      CLMF9999
CLMF0810  COMPARE   "1",WCACCPT 
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF0820  IF        WCACCPT=1
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
.
CLMF0900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF0910,CLMF0920
          WRITE     HTMLFILE;WCICODE;
          GOTO      CLMF9999
.
CLMF0910  OPEN      PATIN1A1,"patin1af"
          PACK      KEY6,WCICODE
          CALL      RDINSR1
          IF        OVRCD=0
            WRITE     HTMLFILE;INAME;
          ELSE
            WRITE     HTMLFILE;WCICODE;
          ENDIF
          GOTO      CLMF9999
.
.   Display Selection List for health fund
.
CLMF0920  CALL      CODINS00 
          GOTO      CLMF9999
.
CLMF1000  MATCH     SP70,WCCLMNO
          GOTO      CLMF9999 IF EQUAL 
          WRITE     HTMLFILE;WCCLMNO;
          GOTO      CLMF9999
.
CLMF1100  MATCH     SP70,VCLMNO
          GOTO      CLMF9999 IF EQUAL 
          WRITE     HTMLFILE;VCLMNO;
          GOTO      CLMF9999
.
CLMF1200  MATCH     SP70,MREFNO
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MREFNO;
          GOTO      CLMF9999
.
CLMF1300  READ      CONTROLF,TEN3;*245,CHOSTYP
          MATCH     SP70,MACDAT
          IF        @EQUAL
            IF        CHOSTYP=1
              MOVE      "19010101",MACDAT
            ELSE
              GOTO      CLMF9999
            ENDIF
          ENDIF 
          UNPACK    MACDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
.
CLMF1400  MATCH     SP70,MPOLIC
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MPOLIC;
          GOTO      CLMF9999
.
CLMF1500  MATCH     SP70,MCREGO
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MCREGO;
          GOTO      CLMF9999
.
CLMF1600  MATCH     SP70,MOTHDET1
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MOTHDET1;
          GOTO      CLMF9999
.
CLMF1700  MATCH     SP70,MOTHDET2
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MOTHDET2;
          GOTO      CLMF9999
.
CLMF1800  MATCH     SP70,MOTHDET3
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MOTHDET3;
          GOTO      CLMF9999
.
CLMF1900  MATCH     SP70,MMDTRANS
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MMDTRANS;
          GOTO      CLMF9999
.
CLMF2000  WRITE     HTMLFILE;MDPINDIC;
          GOTO      CLMF9999
.
CLMF2100  MATCH     SP70,MENGAGED
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MENGAGED;
          GOTO      CLMF9999
.
CLMF2200  MATCH     SP70,MPINJURE
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MPINJURE;
          GOTO      CLMF9999
.
CLMF2300  MATCH     SP70,MMECHSEV
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MMECHSEV;
          GOTO      CLMF9999
.
CLMF2400  MATCH     SP70,MREGNSEV
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MREGNSEV;
          GOTO      CLMF9999
.
CLMF2500  MATCH     SP70,MSNAME
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MSNAME;
          GOTO      CLMF9999
.
CLMF2600  MATCH     SP70,MSTELE
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MSTELE;
          GOTO      CLMF9999
.
CLMF2700  MATCH     SP70,MACLOC
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;MACLOC;
          GOTO      CLMF9999
.
CLMF2800  MATCH     SP70,WCEADD4
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCEADD4;
          GOTO      CLMF9999
.
CLMF2900  WRITE     HTMLFILE;PTWMTACF;
          GOTO      CLMF9999
.
CLMF3000  MATCH     SP70,PTWMTYPE
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PTWMTYPE;
          GOTO      CLMF9999
.
CLMF3100  MOVE      "RA",CATEGORY
          MOVE      PTWMTYPE,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF3200  WRITE     HTMLFILE;PMWXCNAM;
          GOTO      CLMF9999
.  
CLMF3300  MOVE      "IK",CATEGORY
          MOVE      PMWXCINJ,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF3400  MOVE      "IJ",CATEGORY
          MOVE      PMWXICOD,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF3500  WRITE     HTMLFILE;PMWXALOC;
          GOTO      CLMF9999
.
CLMF3600  WRITE     HTMLFILE;PMCTSNAM;
          GOTO      CLMF9999
.
CLMF3700  WRITE     HTMLFILE;PMCTSAD1;
          GOTO      CLMF9999
.
CLMF3800  WRITE     HTMLFILE;PMCTSAD2;
          GOTO      CLMF9999
.
CLMF3900  WRITE     HTMLFILE;PMCTSAD3;
          GOTO      CLMF9999
.
CLMF4000  WRITE     HTMLFILE;PMCTSAD4;
          GOTO      CLMF9999
.
CLMF4100  WRITE     HTMLFILE;PMCTSPCO;
          GOTO      CLMF9999
.
CLMF4200  WRITE     HTMLFILE;PMCTSPHN;
          GOTO      CLMF9999
.
CLMF4300  WRITE     HTMLFILE;PMCTCONT;
          GOTO      CLMF9999
.
CLMF4400  WRITE     HTMLFILE;PMCTREFN;
          GOTO      CLMF9999
.
CLMF4500  MOVE      "IQ",CATEGORY
          MOVE      PMWXACCF,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF4600  MOVE      "IP",CATEGORY 
          MOVE      PMWXPLIN,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF4700  MOVE      "IO",CATEGORY 
          MOVE      PMWXACTI,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF4800  MATCH     SP70,PMWXADTE
          GOTO      CLMF9999 IF EQUAL
          UNPACK    PMWXADTE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
.
CLMF4900  WRITE     HTMLFILE;PTWVAUTH;
          GOTO      CLMF9999
.
CLMF5000  MATCH     SP70,PTWVDATE
          GOTO      CLMF9999 IF EQUAL
          UNPACK    PTWVDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
.
CLMF5100  MATCH     SP70,WCCOMN1
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCCOMN1;
          GOTO      CLMF9999

CLMF5200  MATCH     SP70,WCCOMN2
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;WCCOMN2;
          GOTO      CLMF9999
.
CLMF5300  MATCH     SP70,PMWXATME
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXATME;
          GOTO      CLMF9999
.
CLMF5400  MOVE      "IM",CATEGORY
          MOVE      PMWXACLC,CODE
          CALL      CODITM00
          GOTO      CLMF9999
. 
CLMF5500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF5510,CLMF5520
          WRITE     HTMLFILE;PMWXAINZ;
          GOTO      CLMF9999
.
CLMF5510  MATCH     "1",PMWXAINZ
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE      
           MATCH      "0",PMWXAINZ
           IF         @EQUAL
              WRITE     HTMLFILE;"No";
           ELSE
             WRITE      HTMLFILE;PMWXAINZ;
           ENDIF
          ENDIF     
          GOTO      CLMF9999 
.         
CLMF5520  MATCH     "1",PMWXAINZ
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            MATCH    "0",PMWXAINZ
            IF       @EQUAL
              WRITE    HTMLFILE;"<option value=0 selected>":
                                "No</option>":
                                "<option value=1>": 
                                "Yes</option>";
            ELSE
              WRITE    HTMLFILE;"<option value=0>":
                                "No</option>":
                                "<option value=1>":
                                "Yes</option>";
            ENDIF
          ENDIF
          GOTO      CLMF9999
.
CLMF5600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF5610,CLMF5620
          WRITE     HTMLFILE;PMWXMOVV;
          GOTO      CLMF9999
.
CLMF5610  MATCH     "1",PMWXMOVV
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
           MATCH      "0",PMWXMOVV
           IF         @EQUAL
             WRITE     HTMLFILE;"No";
           ELSE
             WRITE      HTMLFILE;PMWXMOVV;
           ENDIF
          ENDIF
          GOTO      CLMF9999
.
CLMF5620  MATCH     "1",PMWXMOVV
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            MATCH    "0",PMWXMOVV
            IF       @EQUAL
              WRITE    HTMLFILE;"<option value=0 selected>":
                                "No</option>":
                                "<option value=1>":
                                "Yes</option>";
            ELSE
              WRITE    HTMLFILE;"<option value=0>":
                                "No</option>":
                                "<option value=1>":
                                "Yes</option>";
            ENDIF
          ENDIF
          GOTO      CLMF9999
.  
CLMF5700  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF5710,CLMF5720
          WRITE     HTMLFILE;PMWXSPTI;
          GOTO      CLMF9999
.
CLMF5710  MATCH     "1",PMWXSPTI
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF5720  MATCH     "1",PMWXSPTI
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
.
CLMF5800  MOVE      "IB",CATEGORY
          MOVE      PMWXSPRT,CODE
          CALL      CODITM00  
          GOTO      CLMF9999
.
CLMF5900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF5910,CLMF5920
          WRITE     HTMLFILE;PMWXRECI;
          GOTO      CLMF9999
.
CLMF5910  MATCH     "1",PMWXRECI
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF5920  MATCH     "1",PMWXRECI
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
. 
CLMF6000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF6010,CLMF6020
          WRITE     HTMLFILE;PMWXTRIC;
          GOTO      CLMF9999
.
CLMF6010  MATCH     "1",PMWXTRIC
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF6020  MATCH     "1",PMWXTRIC
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
. 
CLMF6100  MOVE      "IF",CATEGORY
          MOVE      PMWXESTA,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF6200  MATCH     SP70,PMWXPDDT
          GOTO      CLMF9999 IF EQUAL
          UNPACK    PMWXPDDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
.
CLMF6300  MATCH     SP70,PMWXARG1
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXARG1;
          GOTO      CLMF9999
. 
CLMF6400  MATCH     SP70,PMWXARG2
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXARG2;
          GOTO      CLMF9999
.
CLMF6500  MATCH     SP70,PMWXARSN
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXARSN;
          GOTO      CLMF9999
.
CLMF6600  MATCH     SP70,PMWXARTL
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXARTL;
          GOTO      CLMF9999
.
CLMF6700  MATCH     SP70,PMWXARRP
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXARRP;
          GOTO      CLMF9999
.
CLMF6800  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF6810,CLMF6820
          WRITE     HTMLFILE;PMWXASST;
          GOTO      CLMF9999
.         
CLMF6810  MATCH     "1",PMWXASST
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF6820  MATCH     "1",PMWXASST
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
.
CLMF6900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF6910,CLMF6920
          WRITE     HTMLFILE;PMWXNEED;
          GOTO      CLMF9999
.
CLMF6910  MATCH     "1",PMWXNEED
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF6920  MATCH     "1",PMWXNEED
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
. 
CLMF7000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF7010,CLMF7020
          WRITE     HTMLFILE;PMWXCONT;
          GOTO      CLMF9999
.
CLMF7010  MATCH     "1",PMWXCONT
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF7020  MATCH     "1",PMWXCONT
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
.
CLMF7100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF7110,CLMF7120
          WRITE     HTMLFILE;PMWXALTW;
          GOTO      CLMF9999
.
CLMF7110  MATCH     "1",PMWXALTW
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF7120  MATCH     "1",PMWXALTW
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=1 selected>":
                              "Yes</option>":
                              "<option value=0>":
                              "No</option>";
          ELSE
            WRITE    HTMLFILE;"<option value=0 selected>":
                              "No</option>":
                              "<option value=1>":
                              "Yes</option>";
          ENDIF
          GOTO      CLMF9999
.
CLMF7200  MOVE      "IH",CATEGORY
          MOVE      PMWXTYPA,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF7300  MATCH     SP70,PMWXSALT
          GOTO      CLMF9999 IF EQUAL
          UNPACK    PMWXSALT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
. 
CLMF7400  MATCH     SP70,PMWXHPDA
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXHPDA;
          GOTO      CLMF9999
.
CLMF7500  MATCH     SP70,PMWXUNFD
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXUNFD;
          GOTO      CLMF9999
.
CLMF7600  MOVE      "UI",CATEGORY
          MOVE      PMWXUNFT,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF7700  MATCH     SP70,PMWXFISD
          GOTO      CLMF9999 IF EQUAL
          UNPACK    PMWXFISD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
. 
CLMF7800  MATCH     SP70,PMWXRNWD
          GOTO      CLMF9999 IF EQUAL
          UNPACK    PMWXRNWD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CLMF9999
.
CLMF7900  MATCH     SP70,PMWXCSTA
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXCSTA;
          GOTO      CLMF9999
.
CLMF8000  MOVE      "IX",CATEGORY
          MOVE      PMWXTWRK,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF8100  MATCH     SP70,PMWXOEST
          GOTO      CLMF9999 IF EQUAL
          WRITE     HTMLFILE;PMWXOEST;
          GOTO      CLMF9999
.
CLMF8200  MOVE      "IM",CATEGORY
          MOVE      PMWXACLC,CODE
          CALL      CODITM00
          GOTO      CLMF9999
.
CLMF8300  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF8350
          PACK      KEY6,PMWXTPRO,SP6
          CALL      RDDOCT1
          BRANCH    OVRCD,CLMF9999
          MOVE      DTITL,FMTTITLE
          MOVE      DGNAME,FMTGNAME
          MOVE      DSNAME,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      CLMF9999
.
CLMF8350  WRITE     HTMLFILE;PMWXTPRO;
          GOTO      CLMF9999
.
CLMF8400  UNPACK    DIM127,D1,KEY3,DIM127
          MOVE      KEY3,FLDITMNO
          CALL      PMEX0000
          GOTO      CLMF9999
.                                                                   * Car 273294
CLMF8500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF8510,CLMF8520
          WRITE     HTMLFILE;PTWMICDE;
          GOTO      CLMF9999
.
CLMF8510  OPEN      PATIN1A1,"patin1af"
          PACK      KEY6,PTWMICDE
          CALL      RDINSR1
          IF        OVRCD=0
            WRITE     HTMLFILE;INAME;
          ELSE
            WRITE     HTMLFILE;PTWMICDE;
          ENDIF
          GOTO      CLMF9999
.
.   Display Selection List for TAC
.
CLMF8520  CALL      CODTAC00
          GOTO      CLMF9999
.
CLMF8600  CALL      XORG0000            * External organasation for Employer
          GOTO      CLMF9999
.
CLMF8700  MATCH     SP70,PMWXCSTA
          GOTO      CLMF9999 IF EQUAL
.
          MATCH     "0",PMWXCSTA
          IF        @EQUAL
            WRITE     HTMLFILE;"Existing";
            GOTO      CLMF9999
          ENDIF
.
          MATCH     "1",PMWXCSTA
          IF        @EQUAL
            WRITE     HTMLFILE;"Parked";
            GOTO      CLMF9999
          ENDIF
.
          MATCH     "2",PMWXCSTA
          IF        @EQUAL
            WRITE     HTMLFILE;"Completed";
            GOTO      CLMF9999
          ENDIF
.
          MATCH     "3",PMWXCSTA
          IF        @EQUAL
            WRITE     HTMLFILE;"Cancelled";
            GOTO      CLMF9999
          ENDIF
          GOTO      CLMF9999
.
CLMF8800  UNPACK    DIM127,D1,KEY1,DIM127  * Gradual process injury
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF8810
          WRITE     HTMLFILE;PMWXGRAD;
          GOTO      CLMF9999
.
CLMF8810  MATCH     "1",PMWXGRAD
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF8900  UNPACK    DIM127,D1,KEY1,DIM127   * admitted to hosp Y/N
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF8910
          WRITE     HTMLFILE;PMWXAHOS;
          GOTO      CLMF9999
.
CLMF8910  MATCH     "1",PMWXAHOS
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF9000  UNPACK    DIM127,D1,KEY1,DIM127    * verbal consent gained Y/N
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF9010
          WRITE     HTMLFILE;PMWXVCON;
          GOTO      CLMF9999
.
CLMF9010  MATCH     "1",PMWXVCON
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      CLMF9999
.
CLMF9100  PACK      GENPCODE,PMWXAPPR,SP70
          CALL      HCPDET00                * Approving hcp details
          GOTO      CLMF9999
.
CLMF9200  WRITE     HTMLFILE;PMWXPORD;   * Acc purchase order number
          GOTO      CLMF9999
.
CLMF9300  CALL      ACDLST00             * Acc Diagnosis List for NZ
          GOTO      CLMF9999
.
CLMF9400  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CLMF9450
          PACK      KEY6,PMWXVHCP,SP6
          CALL      RDDOCT1
          BRANCH    OVRCD,CLMF9999
          MOVE      DTITL,FMTTITLE
          MOVE      DGNAME,FMTGNAME
          MOVE      DSNAME,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      CLMF9999
.
CLMF9450  WRITE     HTMLFILE;PMWXVHCP;
          GOTO      CLMF9999
.
CLMF9999  RETURN
+
.------------------------------------------------------------
. Table of mutliple diagnosis codes
.------------------------------------------------------------
ACDLST00  WRITE     HTMLFILE;"<tr><td class=DataLabel>Diagnosis Codes</td>";

          MOVE      ZERO,F3
          PACK      KEY23,WCCLMNO,SP70
          CALL      RSACDIA1
ACDLST10  CALL      RKACDIA1
          BRANCH    OVRCD,ACDLST90
.
. For Same Claim Number
          MATCH     WCCLMNO,ACDIACCN
          GOTO      ACDLST90 IF NOT EQUAL
.
. Diagnisis Description
          PACK      KEY9,ACDIDIAG,SP70
          CALL      RDEMICD1
          BRANCH    OVRCD,ACDLST10
          MATCH     EMICDESC,SP70
          REP       "'`",EMICDESC
          REP       "#"`",EMICDESC
          GOTO      ACDLST90 IF EQUAL
.
. Blank Label in Row 2+
          COMPARE   ZERO,F3
          GOTO      ACDLST20 IF EQUAL
          WRITE     HTMLFILE;"</tr>"
          WRITE     HTMLFILE;"<tr><td class=DataLabel></td>";
.
. Display the Diagnosis
ACDLST20  WRITE     HTMLFILE;"<td class=DataField>",EMICDESC,"</td>";
.
. Allows up to 999 rows
          ADD       ONE,F3
          COMPARE   "999",F1
          GOTO      ACDLST90 IF EQUAL
.
          GOTO      ACDLST10
.
. Finish last Table Row
ACDLST90  WRITE     HTMLFILE;"</tr>"
.
ACDLST99  RETURN
.------------------------------------------------------------
.         External organisation for Employer
.------------------------------------------------------------
XORG0000  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,XORG1000,XORG3000
.
          WRITE     HTMLFILE;PMWXECOD;
          GOTO      XORG9999
.
XORG1000  MOVE      "Employer Code not found",KEY30     * get Employer code
          PACK      KEY7,ANSE,PMWXECOD
          CALL      RDPTEOR1
          BRANCH    OVRCD,XORG2000
          MOVE      PTERNAME,KEY30
XORG2000  WRITE     HTMLFILE;KEY30
          GOTO      XORG9999
.
XORG3000  PACK      KEY7,ANSE,SP10               * create Employer code list
          CALL      RSPTEOR1
XORG4000  CALL      RKPTEOR1
          BRANCH    OVRCD,XORG9999
.
          MATCH     ANSE,PTERTYPE
          GOTO      XORG9999 IF NOT EQUAL
.
          CLEAR     KEY40,
          APPEND    "(",KEY40
          APPEND    PTERCODE,KEY40
          APPEND    ")  ",KEY40
          APPEND    PTERNAME,KEY40
          RESET     KEY40
          MOVE      PTERNAME,KEY30
          PACK      KEY8,QUOTE,PTERCODE,QUOTE
          MATCH     PMWXECOD,PTERCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               KEY40,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY40,"</option>"
          ENDIF
          GOTO      XORG4000
.
XORG9999  RETURN
+
.------------------------------------------------------------
. Add Selection Options to Form (Insurance Codes)
.------------------------------------------------------------
CODINS00  PACK      KEY6,SP70
          OPEN      PATIN1A1,"patin1af"
          CALL      RDSINSR1
CODINS10  CALL      RDKINSR1
          BRANCH    OVRCD,CODINS99
          MATCH     SP70,ICODE
          GOTO      CODINS10 IF EQUAL
.
          MATCH     "1",PTINACTV
          GOTO      CODINS10 IF EQUAL
.
          PACK      KEY8,QUOTE,ICODE,QUOTE
          MATCH     ICODE,WCICODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               INAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",INAME,"</option>"
          ENDIF
          GOTO      CODINS10
CODINS99  RETURN
+
.------------------------------------------------------------
. Add Selection Options to Form (Insurance Codes for TAC Record)      Car 273294
.------------------------------------------------------------
CODTAC00  PACK      KEY6,SP70
          OPEN      PATIN1A1,"patin1af"
          CALL      RDSINSR1
CODTAC10  CALL      RDKINSR1
          BRANCH    OVRCD,CODTAC99
          MATCH     SP70,ICODE
          GOTO      CODTAC10 IF EQUAL
.
          MATCH     "1",PTINACTV
          GOTO      CODTAC10 IF EQUAL
.
          PACK      KEY8,QUOTE,ICODE,QUOTE
          MATCH     ICODE,PTWMICDE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               INAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",INAME,"</option>"
          ENDIF
          GOTO      CODTAC10
CODTAC99  RETURN
+
.******************************************************************************
.*                                  WRPORD00                                  *
.*   Write/Update a record on pmswx1af for NZ - ACC Purchase Order Number     *
.*   This is collected on the admission page instead of the ACC Details Page  *
.******************************************************************************
WRPORD00  MATCH     Z70,ACCPORDN
          GOTO      WRPORD99 IF EQUAL
.
          CALL      CLPMSWX1
.
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDPMWX11
          IF        OVRCD=1
            PACK      PMWXPORD,ACCPORDN,SP70
            PACK      PMWXVISN,ADMISSNO,SP70
            MOVE      PMWXVISN,KEY8
            CALL      RAPMWX11
            IF        OVRCD=1
              CALL      IBACLOCK
              PACK      PMWXCDTE,CCC,CYY,CMM,CDD       * Current Date
              REP       " 0",PMWXCDTE
              MOVE      CTIMEIS,PMWXCTIM               * Current Time
              MOVE      USERID,PMWXWEBC                * Current WebID
              CALL      WRPMWX11
            ENDIF
          ELSE
            PACK      PMWXPORD,ACCPORDN
            CALL      IBACLOCK
            PACK      PMWXLUPD,CCC,CYY,CMM,CDD       * Current Date
            REP       " 0",PMWXLUPD
            MOVE      CTIMEIS,PMWXLUPT               * Current Time
            MOVE      USERID,PMWXWEBU                * Current WebID
            CALL      UPPMWX11
          ENDIF
.
WRPORD99  RETURN
+

