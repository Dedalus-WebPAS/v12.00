.------------------------------------------------------------
.  Standard Coded Field Option 
.  
.  Parameters    CODE ,CATAGORY & CATACTIV
.
.                CATACTIV is a cgi var. This is common to all web services
.                and is controlled in IBAWEBCD. A value of 1 will only display
.                active category codes in the selection list. This can be 
.                turned on in a menu cgi or hard coded in the main line.
.                A value of 2 will show active and inactive codes in the 
.                selection lists.
.
.  Tag Parameter 0=Description
.                1=Code
.                2=Selection List
.                3=Code with Indicators and User Defined Fields
.                4=Selection List With A Default Code Selected (PTCDDEFT)
.                  This will not select the code in the parameter CODE
.                  (Use for Add Screens)
.                5=Selection List With A Default Code Selected (PTCDDEFT)
.                  This will select the code in the parameter CODE if it is
.                  not blank (Use for Update Screens)
.                6=Selection List (with code displayed)
.                7=Selection List (with HDP displayed)
.                8=Description of Category
.
.                9=Next subset of tags .9.X
.                  .1=Include/Exclude codes with indicator, or high priority
.                  .2=Selection List using long description
.                  .3= Long Description
.                  .4= Selection List With A Default Code Selected (PTCDDEFT)
.                      This will not select the code in the parameter CODE
.                      (Use for Add Screens) - Long description
.                  .5= Selection List With A Default Code Selected (PTCDDEFT)
.                      This will select the code in the parameter CODE if it is
.                      not blank (Use for Update Screens) - Long description
.                  .6=Include/Exclude codes with indicator with a default
.                     selected (PTCDDEFT). This will select the code in the
.                     parameter CODE if it is not blank
.                  .7=Selection List (with code displayed) 
.                     With A Default Code Selected (PTCDDEFT) 
.                     This will select the code in the parameter CODE if it is
.                     not blank (Use for Update Screens)
.                  .8=As option 2, but produces all the variables in the cat cod
.                  
.
.  Modifications:
.
.  V11.05.02 19.12.2024  DA Sarkies     Task 0954547
.            Commented out the <cat></cat> Tags to prevent browser
.            incompatibility but are still readable.
.  V11.05.01 26.11.2024  Ebon Clements  Task 0954292
.            Added <cat-c> start and end tag to category=XX tag
.  V11.03.01 01.02.2023  DA Sarkies    tsk   0913260
.            Created a function that returs a select list containing all values
.            for a cat code dropdown.
.  V11.00.01 12/03/2020  Jill Parkinson Task 0879163
.            Added High Priority first tag -  .9.1.XX
.  V10.15.01 08/10/2019  Peter Vela     TSK 0881934
.            Added User Defined Fields 2 - 14 to GETCOD00, CODITM30
.  V10.13.03 05/09/2018  J.Tan          TSK 0848506
.            Fixed incorrect GOTO UCDSEL10 in LCDFSL00 routine, it should be
.            LCDFSL10 (Long description Update screen)
.  V10.13.02 04/09/2018  Don Nguyen     TSK 0853011
.            Corrected indicator outputs (TCINDC22-TCINDC41) where applicable
.  V10.13.01 03/08/2018  Don Nguyen     TSK 0853011
.            Modified applicable routines to cater for the additions of new
.            Indicators (TCINDC22-TCINDC41) & new Associated Numbers
.            (PTCDASC6-PTCDAS15).
.  V10.09.01 05/01/2017  Don Nguyen     TSK 0814332
.            Added clear for PTCDASC1 - PTCDASC5 in GETCOD00
.  V10.08.01 02/09/2016  Ebon Clements  TSK 0320806
.            Added CATACTIV = 2 - Include inactive codes in selection list
.  V10.07.01 06/10/2015  Ebon Clements  CAR 316633
.            Added PTCDASC2 - PTCDASC5 to code with indicators 
.  V10.06.02 18/09/2015  Peter Vela     CAR 321618
.            Added .9.7 - Selection List (with code displayed) with default 
.            functionality
.  V10.06.01 19/05/2015  Nicole Torrisi CAR 312772
.            Added .9.3 - Long Description
.  V10.04.02 03/04/2014  Don Nguyen     CAR 296928
.            Modified GETCOD00 to also clear THCSCOD & TCFORM6
.  V10.04.01 17/01/2013  Ebon Clements  CAR 285465
.            Added associated number 1 to  code with indicators - CODITM30
.  V10.03.09 20/11/2013  Ebon Clements  CAR 212716
.            Added CATACTIV - Only display active category codes
.  V10.03.08 18/11/2013  Don Nguyen     CAR 293848
.            Modified CODEXD00 so that it does not always output the default 
.            option for matching include/exclude conditions.
.            Also added new Include/Exclude option 3 (Ind AA = blank or AA = C).
.  V10.03.07 24/07/2013  Ebon Clements  CAR 288172
.            Added clear of long description - GETCOD00
.  V10.03.06 13/06/2013  Ebon Clements  CAR 286359
.            Fixed incorrect GOTO in loops - LCDFSL00 and LCODDF00
.            Removed CODIND00 as it was no longer used
.  V10.03.05 16/05/2013  Ebon Clements  CAR 284882
.            Added include/exculde code with indicators and default - CODEXD00
.  V10.03.04 24/04/2013  Don Nguyen     CAR 284059
.            Modified CODITM30 to output value that matches the selection lists
.  V10.03.03 13/09/2012  Don Nguyen     CAR 270231
.            Changed CDDSEL00 to make it possible to display selection list
.            options without the code value.
.  V10.03.02 15/05/2012  Ebon Clements  CAR 264932
.            Fixed value in selected code - CDDSEL10
.  V10.03.01 21/02/2012  Saroeun Soeur  CAR 234857
.            CODEXC10 - prevent default ACODE from being listed/selected
.            thats not linked
.  V10.02.01 03/10/2011  Peter McMullen CAR 242023
.            Added Acive/Inactive ind to Code selection lists 
.  V10.00.01 17/05/2010  Ebon Clements  CAR 220289
.            Added indicators TCINDC12 to TCINDC21
.  V9.12.02  14/12/2009  Saroeun Soeur  CAR 212154
.            LCDFSL00 -(tag 9.4) Selection List With A Default Code 
.                      Selected (PTCDDEFT)
.
.            LCODDF00 -(tag.9.5) Selection List With A Default Code 
.                      Selected (PTCDDEFT) defaults to selected use 
.                      value if one exist 
.  V9.12.01  26/08/2009  Peter McMullen CAR 171901
.              remove MAPCAT00 call
.  V9.10.02 18/09/2008 J.Tan         CAR 172904
.              Added selection codes for a selected HDP Equivalent
.  V9.10.01 15/05/2007 Jill Habasque CAR 161608
.             Added option 9.2 - Selection List using long description   
.  V9.08.01 19/10/2006 Ebon Clements CAR 119559
.             Added option 9.1 - Include/Exclude cat codes with indicator
.  V9.07.01 24/07/2006 Ebon Clements CAR 99899
.             Added option 8 - description of category
.  V9.05.01 09/03/2006 Ebon Clements CAR 78533
.             Added hospital specific functionality for cat codes
.  11.05.2005 Jill Habasque CAR 60914
.             Add Tag Parameter 7=Selection List (with HDP)                 
.  12.02.2004 Lina Vo       CAR 44132
.             Add Tag Parameter 6=Selection List (with code)                 
.  03.06.2003 Jill Habasque SRF 38102
.             Moved active check to be only if the code is not selected      
.             Ebon Clements
.             Added output of TCFORM6
.  16.09.2002 Ebon Clements SRF 19400
.             Added PTCDNHCP to be output for option 3 (code with indicators)
.             and selection list options
.  07.12.2001 Jill Habasque
.             Added THCSCOD to be output for option 3 (code with indicators)
.
.  06.08.2001 B.G.Ackland
.             Map Category to THCSCOD
.
.  06.08.2001 B.G.Ackland
.             Fix Match for Spaces in Code Field (GETCOD00)
.
.  13.06.2001 B.G.Ackland
.             Added Indicator 11 to Code/Indicator Output Option
.
.------------------------------------------------------------
CODITM00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CODITM10,CODITM20,CODITM30,CODITM40,CODITM50:
                       CODITM60,CODITM70,CODITM80,CODITM90
          CALL      GETCOD00
          WRITE     HTMLFILE;TDESC;
          GOTO      CODITM99
.
CODITM10  PACK      CODE,CODE,SP70
          MATCH     SP70,CODE
          GOTO      CODITM99 IF EQUAL
          WRITE     HTMLFILE;CODE;
          GOTO      CODITM99
.
CODITM20  CALL      CODSEL00
          GOTO      CODITM99
.
CODITM30  CALL      GETCOD00
          PACK      KEY300,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                           TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                           TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                           TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                           TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                           PTCOACTV,PTCDASC1,PTCDASC2,PTCDASC3,PTCDASC4:
                           PTCDASC5,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                           TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                           TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                           TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                           TCINDC41,PTCDASC6,PTCDASC7,PTCDASC8,PTCDASC9:
                           PTCDAS10,PTCDAS11,PTCDAS12,PTCDAS13,PTCDAS14:
                           PTCDAS15,PTCDUDF2,PTCDUDF3,PTCDUDF4,PTCDUDF5:
                           PTCDUDF6,PTCDUDF7,PTCDUDF8,PTCDUDF9,PTCDUD10:
                           PTCDUD11,PTCDUD12,PTCDUD13,PTCDUD14,SP70,SP70,SP70
          WRITE     HTMLFILE;ACODE,KEY300;
          GOTO      CODITM99
.
CODITM40  CALL      DCDSEL00        * Selection list with default code selected
          GOTO      CODITM99
.
CODITM50  CALL      UCDSEL00        * Selection list with default code selected
          GOTO      CODITM99        * if the variable CODE is blank
.
CODITM60  CALL      CDDSEL00        * Code Displayed in Selection List.
          GOTO      CODITM99
.
CODITM70  CALL      HDPSEL00        * HDP Displayed in Selection List.
          GOTO      CODITM99
.
CODITM80  PACK      CATEGORY,CATEGORY,SP70
          MATCH     SP70,CATEGORY                * Category Description
          GOTO      CODITM99 IF EQUAL
.
          PACK      KEY5,CATEGORY
          CALL      RDCODE1
          IF        OVRCD=1
            CLEAR     TDESC
            APPEND    "Invalid Category ",TDESC
            APPEND    CATEGORY,TDESC
            RESET     TDESC
          ENDIF
.
          WRITE     HTMLFILE;TDESC;
          GOTO      CODITM99
.
CODITM90  UNPACK    DIM127,D1,KEY1,DIM127   * Second subset of tags from .9
          MOVE      ZERO,F1 
          MOVE      KEY1,F1
          BRANCH    F1,CODITM91,CODITM92,CODITM93,CODITM94,CODITM95:
                       CODITM96,CODITM97,CODITM98
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CODITM99
.
CODITM91  CALL      CODEXC00        * Include/Excludes code with indicator
          GOTO      CODITM99
.
CODITM92  CALL      LCODSL00        * Selection List with long desc
          GOTO      CODITM99
.
CODITM93  CALL      GETCOD00
          WRITE     HTMLFILE;PTCDLDES;
          GOTO      CODITM99
.
CODITM94  CALL      LCODDF00        * long description with default as set by
          GOTO      CODITM99        * IT maintaince Default code
.
CODITM95  CALL      LCDFSL00        * long description with default as set by
          GOTO      CODITM99        * IT maintaince Default value if no 
.                                   * value is selected
CODITM96  CALL      CODEXD00        * Include/Excludes code with indicator
          GOTO      CODITM99        * Default selected if CODE is blank
.
CODITM97  CALL      UDDSEL00        * Code Displayed in Selection List.
          GOTO      CODITM99
.
CODITM98  CALL      CODGTA00        * As with option 2, but gets all of the
          GOTO      CODITM99          options
.
CODITM99  RETURN
.------------------------------------------------------------
. Get Code Description
.------------------------------------------------------------
GETCOD00  MOVE      SP70,TDESC
          MOVE      SP70,ACODE
          MOVE      SP70,THCSCOD
          MOVE      SP70,PTCDLDES
          MOVE      ZERO,TCFORM6
.
          UNPACK    SP70,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                         TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                         TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                         TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                         TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                         TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                         TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                         TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                         TCINDC41,PTCOACTV,PTCDNHCP,PTCDGRPV,PTCDHOSS
.
          UNPACK    SP70,PTCDASC1,PTCDASC2,PTCDASC3,PTCDASC4,PTCDASC5
          UNPACK    SP70,PTCDASC6,PTCDASC7,PTCDASC8,PTCDASC9,PTCDAS10
          UNPACK    SP70,PTCDAS11,PTCDAS12,PTCDAS13,PTCDAS14,PTCDAS15
          UNPACK    SP70,PTCDUDF2,PTCDUDF3,PTCDUDF4,PTCDUDF5,PTCDUDF6
          UNPACK    SP70,PTCDUDF7,PTCDUDF8,PTCDUDF9,PTCDUD10,PTCDUD11
          UNPACK    SP70,PTCDUD12,PTCDUD13,PTCDUD14
.
          MATCH     SP70,CODE
          GOTO      GETCOD99 IF EQUAL
.
          PACK      KEY5,CATEGORY,CODE
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      SP70,TDESC
            MOVE      SP70,ACODE
            MOVE      SP70,THCSCOD
            MOVE      SP70,PTCDLDES
            MOVE      ZERO,TCFORM6
            UNPACK    SP70,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                           TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                           TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                           TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                           TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                           TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                           TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                           TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                           TCINDC41,PTCOACTV,PTCDNHCP,PTCDGRPV,PTCDHOSS
            UNPACK    SP70,PTCDASC1,PTCDASC2,PTCDASC3,PTCDASC4,PTCDASC5
            UNPACK    SP70,PTCDASC6,PTCDASC7,PTCDASC8,PTCDASC9,PTCDAS10
            UNPACK    SP70,PTCDAS11,PTCDAS12,PTCDAS13,PTCDAS14,PTCDAS15
            UNPACK    SP70,PTCDUDF2,PTCDUDF3,PTCDUDF4,PTCDUDF5,PTCDUDF6
            UNPACK    SP70,PTCDUDF7,PTCDUDF8,PTCDUDF9,PTCDUD10,PTCDUD11
            UNPACK    SP70,PTCDUD12,PTCDUD13,PTCDUD14
          ENDIF
GETCOD99  RETURN
.------------------------------------------------------------
. Add Selection Options to Form (code value)
.------------------------------------------------------------
CODSEL00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.  
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
CODSEL10  CALL      RDKCODE2
          BRANCH    OVRCD,CODSEL99
          MATCH     CATEGORY,TCODE
          GOTO      CODSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      CODSEL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
                          
.
          MATCH     CODE,ACODE
          IF        @EQUAL
            IF        CATACTIV=1
              MATCH     "I",PTCOACTV               * Display active only
              GOTO      CODSEL10 IF EQUAL
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               TDESC,"</option>"
          ELSE
            IF        CATACTIV<>2
              MATCH     "I",PTCOACTV
              GOTO      CODSEL10 IF EQUAL
            ENDIF
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,CODSEL10
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",TDESC:
                               "</option>"
          ENDIF
          GOTO      CODSEL10
CODSEL99  RETURN
.------------------------------------------------------------
. Add Selection Options to Form (code value)
.------------------------------------------------------------
LCODSL00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
LCODSL10  CALL      RDKCODE2
          BRANCH    OVRCD,LCODSL99
          MATCH     CATEGORY,TCODE
          GOTO      LCODSL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      LCODSL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
          MATCH     CODE,ACODE
          IF        @EQUAL
            IF        CATACTIV=1
              MATCH     "I",PTCOACTV               * Display active only
              GOTO      LCODSL10 IF EQUAL
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               PTCDLDES,"</option>"
          ELSE
            IF        CATACTIV<>2
              MATCH     "I",PTCOACTV
              GOTO      LCODSL10 IF EQUAL
            ENDIF
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,LCODSL10
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",PTCDLDES:
                               "</option>"
          ENDIF
          GOTO      LCODSL10
LCODSL99  RETURN
+
.-------------------------------------------------------------------
. Add Selection Options to Form (code value) - Default selected Code
. if variable CODE is blank
.-------------------------------------------------------------------
LCDFSL00  MOVE      ZERO,FORM1
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
LCDFSL10  CALL      RDKCODE2
          BRANCH    OVRCD,LCDFSL99
          MATCH     CATEGORY,TCODE
          GOTO      LCDFSL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      LCDFSL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          BRANCH    FORM1,LCDFSL40     * Only 1 code can be selected in list
.
          IF        CATACTIV=1
            MATCH     "I",PTCOACTV               * Display active only
            GOTO      LCDFSL10 IF EQUAL
          ENDIF
.
          MATCH     SP70,CODE
          IF        !@EQUAL
            MATCH     CODE,ACODE
            IF        @EQUAL
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":

                                 PTCDLDES,"</option>"
              GOTO      LCDFSL10
            ENDIF
            GOTO        LCDFSL40
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,LCDFSL10
            ENDIF
          ENDIF
.
          MATCH     "1",PTCDDEFT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               PTCDLDES,"</option>"
            MOVE      ONE,FORM1
            GOTO      LCDFSL10
          ENDIF
.
LCDFSL40  IF        CATACTIV<>2
            MATCH     "I",PTCOACTV
            GOTO      LCDFSL10 IF EQUAL
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,LCDFSL10
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",PTCDLDES:
                             "</option>"
.
          GOTO      LCDFSL10
LCDFSL99  RETURN
+
.------------------------------------------------------------
.         LCODDF00 - Selection Options to Form (default value)
.------------------------------------------------------------
LCODDF00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
LCODDF10  CALL      RDKCODE2
          BRANCH    OVRCD,LCODDF99
          MATCH     CATEGORY,TCODE
          GOTO      LCODDF99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      LCODDF10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          MATCH     "1",PTCDDEFT
          IF        @EQUAL
            IF        CATACTIV=1
              MATCH     "I",PTCOACTV               * Display active only
              GOTO      LCODDF10 IF EQUAL
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               PTCDLDES,"</option>"
          ELSE
            IF        CATACTIV<>2
              MATCH     "I",PTCOACTV
              GOTO      LCODDF10 IF EQUAL
            ENDIF
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,LCODDF10
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",PTCDLDES:
                               "</option>"
          ENDIF
          GOTO      LCODDF10
LCODDF99  RETURN
+
.-------------------------------------------------------------------
. Add Selection Options to Form (code value) - Default selected Code
.-------------------------------------------------------------------
DCDSEL00  MOVE      ZERO,FORM1
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
DCDSEL10  CALL      RDKCODE2
          BRANCH    OVRCD,DCDSEL99
          MATCH     CATEGORY,TCODE
          GOTO      DCDSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      DCDSEL10 IF EQUAL
          MATCH     "I",PTCOACTV
          GOTO      DCDSEL10 IF EQUAL
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,DCDSEL10
            ENDIF
          ENDIF
.
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          BRANCH    FORM1,DCDSEL40     * Only 1 code can be selected in list
.
          MATCH     "1",PTCDDEFT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               TDESC,"</option>"
            MOVE      ONE,FORM1
            GOTO      DCDSEL10
          ENDIF
.
DCDSEL40  WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",TDESC,"</option>"
.
          GOTO      DCDSEL10
DCDSEL99  RETURN
.
.-------------------------------------------------------------------
. Add Selection Options to Form (code value) - Default selected Code
. if variable CODE is blank
.-------------------------------------------------------------------
UCDSEL00  MOVE      ZERO,FORM1
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
UCDSEL10  CALL      RDKCODE2
          BRANCH    OVRCD,UCDSEL99
          MATCH     CATEGORY,TCODE
          GOTO      UCDSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      UCDSEL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          BRANCH    FORM1,UCDSEL40     * Only 1 code can be selected in list
.
          IF        CATACTIV=1
            MATCH     "I",PTCOACTV               * Display active only
            GOTO      UCDSEL10 IF EQUAL
          ENDIF
.
          MATCH     SP70,CODE
          IF        !@EQUAL
            MATCH     CODE,ACODE
            IF        @EQUAL
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 TDESC,"</option>"
              GOTO      UCDSEL10
            ENDIF
            GOTO        UCDSEL40
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,UCDSEL10
            ENDIF
          ENDIF
.
          MATCH     "1",PTCDDEFT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               TDESC,"</option>"
            MOVE      ONE,FORM1
            GOTO      UCDSEL10
          ENDIF
.
UCDSEL40  IF        CATACTIV<>2
            MATCH     "I",PTCOACTV
            GOTO      UCDSEL10 IF EQUAL
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,UCDSEL10
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",TDESC:
                             "</option>"
.
          GOTO      UCDSEL10
UCDSEL99  RETURN
.------------------------------------------------------------
. Selection List with Code Displayed           
.------------------------------------------------------------
CDDSEL00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.  
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE1
CDDSEL10  CALL      RDKCODE1
          BRANCH    OVRCD,CDDSEL99
          MATCH     CATEGORY,TCODE
          GOTO      CDDSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      CDDSEL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
          MATCH     CODE,ACODE
          IF        @EQUAL
            IF        CATACTIV=1
              MATCH     "I",PTCOACTV               * Display active only
              GOTO      CDDSEL10 IF EQUAL
            ENDIF
.
            IF        F1=1
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 TDESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 "(",ACODE,") ",TDESC,"</option>"
            ENDIF
          ELSE
            IF        CATACTIV<>2
              MATCH     "I",PTCOACTV
              GOTO      CDDSEL10 IF EQUAL
            ENDIF
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,CDDSEL10
              ENDIF
            ENDIF
.
            IF        F1=1
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">":
                                 TDESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">":
                                 "(",ACODE,") ",TDESC,"</option>"
            ENDIF
          ENDIF
          GOTO      CDDSEL10
.
CDDSEL99  RETURN
.------------------------------------------------------------
. Selection List with HDP Displayed
.------------------------------------------------------------
HDPSEL00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE1
HDPSEL10  CALL      RDKCODE1
          BRANCH    OVRCD,HDPSEL99
          MATCH     CATEGORY,TCODE
          GOTO      HDPSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      HDPSEL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
          MATCH     CODE,ACODE
          IF        @EQUAL
            IF        CATACTIV=1
              MATCH     "I",PTCOACTV               * Display active only
              GOTO      HDPSEL10 IF EQUAL
            ENDIF

            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               "(",THCSCOD,") ",TDESC,"</option>"
          ELSE
            IF        CATACTIV<>2
              MATCH     "I",PTCOACTV
              GOTO      HDPSEL10 IF EQUAL
            ENDIF
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,HDPSEL10
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">":
                               "(",THCSCOD,") ",TDESC,"</option>"
          ENDIF
          GOTO      HDPSEL10
.
HDPSEL99  RETURN
.
.------------------------------------------------------------
. Include/Exclude codes with indicator
. PATWEBXX.XX.XXX.9.1.AA.B.C   
.         AA = Indicator Number
.         AA = 99 for HDP Equivalent
.          B = 0 - Only display codes with Ind AA blank
.              1 - Only display codes with Ind AA = C   
.              2 - Exclude codes with Ind AA = C.
.              3 - High priority first Ind AA = C.
.              4 - Not high priority,displays below  Ind AA = C.
.          C = Indicator Value
.------------------------------------------------------------
CODEXC00  UNPACK    DIM127,D1,KEY2,DIM127        * Indicator Number (F2)
          MOVE      ZERO,F2
          MOVE      KEY2,F2
.
          UNPACK    DIM127,D1,KEY1,DIM127        * Include / Exclude (F1)
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          UNPACK    SP70,KEY4,KEY1
          IF        F2=99
            UNPACK    DIM127,D1,KEY4             * Indicator Value (KEY4)
          ELSE
            IF        F1<>0
              UNPACK    DIM127,D1,KEY1,DIM127    * Indicator Value (KEY1)
            ENDIF
          ENDIF
.
          MOVE      "0",ANS         * selected code already output 0=No
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          IF        F1=3|F1=4
            WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",PTCDLDES:
                               "#" map=#"",THCSCOD,"#"></cat-c>-->"
          ELSE
            WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                               "#" map=#"",THCSCOD,"#"></cat-c>-->"
          ENDIF
.
CODEXC05  PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
CODEXC10  CALL      RDKCODE2
          BRANCH    OVRCD,CODEXC90
          MATCH     CATEGORY,TCODE
          GOTO      CODEXC90 IF NOT EQUAL
.
          MATCH     SP70,ACODE
          GOTO      CODEXC10 IF EQUAL
.
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          MATCH     CODE,ACODE
          GOTO      CODEXC20 IF NOT EQUAL
.
.         prevent default ACODE from being listed/selected if not available
.         linked to the hospital
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,CODEXC10
            ENDIF
          ENDIF
.
          IF        CATACTIV=1
            MATCH     "I",PTCOACTV               * Display active only
            GOTO      CODEXC10 IF EQUAL
          ENDIF
.
          LOAD      D1,F2,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                        TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                        TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                        TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                        TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                        TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                        TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                        TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                        TCINDC41
.
          IF        F1=3
            MATCH     KEY1,D1                  * Only display if ind F2=KEY1
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
.
          IF        F1=4
            MATCH     KEY1,D1                  * Only display if ind F2=KEY1
            GOTO      CODEXC10 IF EQUAL
          ENDIF
.
          IF        F1=3|F1=4
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               PTCDLDES,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                               TDESC,"</option>"
          ENDIF
          GOTO      CODEXC10
.
CODEXC20  IF        CATACTIV<>2
            MATCH     "I",PTCOACTV
            GOTO      CODEXC10 IF EQUAL
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,CODEXC10
            ENDIF
          ENDIF
.
          COMPARE   "99",F2
          GOTO      CODEXC40 IF EQUAL        * Checking HDP Equivalent
.
          LOAD      D1,F2,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                          TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                          TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          IF        F1=0  
            MATCH     SP1,D1                   * Only display if ind F2 blank
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
.
          IF        F1=1  
            MATCH     KEY1,D1                  * Only display if ind F2=KEY1
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
.
          IF        F1=2    
            MATCH     KEY1,D1                  * Skip if ind F2=KEY1
            GOTO      CODEXC10 IF EQUAL
          ENDIF
          IF        F1=3  
            MATCH     KEY1,D1                  * Only display if ind F2=KEY1
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
          IF        F1=4    
            MATCH     KEY1,D1                  * Skip if ind F2=KEY1
            GOTO      CODEXC10 IF EQUAL
          ENDIF
.
          GOTO      CODEXC60
.
CODEXC40  IF        F1=0
            MATCH     SP70,KEY4                * Only display if ind F2 blank
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
.
          IF        F1=1
            MATCH     KEY4,THCSCOD             * Only display if ind F2=KEY4
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
.
          IF        F1=2
            MATCH     KEY4,THCSCOD             * Skip if ind F2=KEY4
            GOTO      CODEXC10 IF EQUAL
          ENDIF
.
          IF        F1=3
            MATCH     KEY4,THCSCOD             * Only display if ind F2=KEY4
            GOTO      CODEXC10 IF NOT EQUAL
          ENDIF
.
          IF        F1=4
            MATCH     KEY4,THCSCOD             * Skip if ind F2=KEY4
            GOTO      CODEXC10 IF EQUAL
          ENDIF
.
CODEXC60  IF        F1=3|F1=4
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",PTCDLDES:
                               "</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",TDESC:
                               "</option>"
          ENDIF
          GOTO      CODEXC10
.
CODEXC90  IF        F1=3
            MOVE     FOUR,F1
            GOTO     CODEXC05
          ENDIF
.
CODEXC99  RETURN
.
.------------------------------------------------------------
. Include/Exclude codes with indicator with default selected.
. The default code will be selected if CODE is blank
. PATWEBXX.XX.XXX.9.6.AA.B.C
.         AA = Indicator Number
.         AA = 99 for HDP Equivalent
.          B = 0 - Only display codes with Ind AA blank
.              1 - Only display codes with Ind AA = C
.              2 - Exclude codes with Ind AA = C.
.              3 - Only display codes where Ind AA = blank or AA = C
.          C = Indicator Value
.------------------------------------------------------------
CODEXD00  UNPACK    DIM127,D1,KEY2,DIM127        * Indicator Number (F2)
          MOVE      ZERO,F2
          MOVE      KEY2,F2
.
          UNPACK    DIM127,D1,KEY1,DIM127        * Include / Exclude (F1)
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          UNPACK    SP70,KEY4,KEY1
          IF        F2=99
            UNPACK    DIM127,D1,KEY4             * Indicator Value (KEY4)
          ELSE
            IF        F1<>0
              UNPACK    DIM127,D1,KEY1,DIM127    * Indicator Value (KEY1)
            ENDIF
          ENDIF
.
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
CODEXD10  CALL      RDKCODE2
          BRANCH    OVRCD,CODEXD99
          MATCH     CATEGORY,TCODE
          GOTO      CODEXD99 IF NOT EQUAL
.
          MATCH     SP70,ACODE
          GOTO      CODEXD10 IF EQUAL
.
          PACK      KEY55,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          TCINDC22,TCINDC23,TCINDC24,TCINDC25,TCINDC26:
                          TCINDC27,TCINDC28,TCINDC29,TCINDC30,TCINDC31:
                          TCINDC32,TCINDC33,TCINDC34,TCINDC35,TCINDC36:
                          TCINDC37,TCINDC38,TCINDC39,TCINDC40,TCINDC41
.
          PACK      KEY60,QUOTE,ACODE,KEY55,QUOTE
.
          MATCH     SP70,CODE
          IF        @EQUAL
            LOAD      D1,F2,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                          TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                          TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
            COMPARE   "99",F2     * Checking HDP Equivalent
            IF        !@EQUAL
	      IF        F1=0
                MATCH     SP1,D1                 * Only display if ind F2 blank
                GOTO      CODEXD10 IF NOT EQUAL
              ENDIF
.
              IF        F1=1
                MATCH     KEY1,D1                * Only display if ind F2=KEY1
                GOTO      CODEXD10 IF NOT EQUAL
              ENDIF
.
              IF        F1=2
                MATCH     KEY1,D1                * Skip if ind F2=KEY1
                GOTO      CODEXD10 IF EQUAL
              ENDIF
.
              IF        F1=3
                MATCH     SP1,D1
                GOTO      CODEXD12 IF EQUAL      * Display if blank
.
                MATCH     KEY1,D1                * Only display if ind F2=KEY1
                GOTO      CODEXD10 IF NOT EQUAL
              ENDIF
            ELSE
              IF        F1=0
                MATCH     SP70,KEY4              * Only display if ind F2 blank
                GOTO      CODEXD10 IF NOT EQUAL
              ENDIF
.
              IF        F1=1
                MATCH     KEY4,THCSCOD           * Only display if ind F2=KEY4
                GOTO      CODEXD10 IF NOT EQUAL
              ENDIF
.
              IF        F1=2
                MATCH     KEY4,THCSCOD           * Skip if ind F2=KEY4
                GOTO      CODEXD10 IF EQUAL
              ENDIF
.
              IF        F1=3
                MATCH     SP70,KEY4
                GOTO      CODEXD12 IF EQUAL      * Display if blank
.
                MATCH     KEY4,THCSCOD           * Only display if ind F2=KEY1
                GOTO      CODEXD10 IF NOT EQUAL
              ENDIF
            ENDIF
.
CODEXD12    MATCH     "1",PTCDDEFT          * Select default code
            GOTO      CODEXD15 IF EQUAL
          ENDIF
.
          MATCH     CODE,ACODE
          GOTO      CODEXD20 IF NOT EQUAL
.
.         prevent default ACODE from being listed/selected if not available
.         linked to the hospital
.
CODEXD15  IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,CODEXD10
            ENDIF
          ENDIF
.
          IF        CATACTIV=1
            MATCH     "I",PTCOACTV               * Display active only
            GOTO      CODEXD10 IF EQUAL
          ENDIF
.
          WRITE     HTMLFILE;"<option value=",KEY60," selected>":
                             TDESC,"</option>"
          GOTO      CODEXD10
.
.
.
CODEXD20  IF        CATACTIV<>2
            MATCH     "I",PTCOACTV
            GOTO      CODEXD10 IF EQUAL
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,CODEXD10
            ENDIF
          ENDIF
.
          COMPARE   "99",F2
          GOTO      CODEXD40 IF EQUAL        * Checking HDP Equivalent
.
          LOAD      D1,F2,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                          TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                          TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          IF        F1=0
            MATCH     SP1,D1                   * Only display if ind F2 blank
            GOTO      CODEXD10 IF NOT EQUAL
          ENDIF
.
          IF        F1=1
            MATCH     KEY1,D1                  * Only display if ind F2=KEY1
            GOTO      CODEXD10 IF NOT EQUAL
          ENDIF
.
          IF        F1=2
            MATCH     KEY1,D1                  * Skip if ind F2=KEY1
            GOTO      CODEXD10 IF EQUAL
          ENDIF
.
          IF        F1=3
            MATCH     SP1,D1
            GOTO      CODEXD60 IF EQUAL      * Display if blank
.
            MATCH     KEY1,D1                * Only display if ind F2=KEY1
            GOTO      CODEXD10 IF NOT EQUAL
          ENDIF

          GOTO      CODEXD60
.
CODEXD40  IF        F1=0
            MATCH     SP70,KEY4                * Only display if ind F2 blank
            GOTO      CODEXD10 IF NOT EQUAL
          ENDIF
.
          IF        F1=1
            MATCH     KEY4,THCSCOD             * Only display if ind F2=KEY4
            GOTO      CODEXD10 IF NOT EQUAL
          ENDIF
.
          IF        F1=2
            MATCH     KEY4,THCSCOD             * Skip if ind F2=KEY4
            GOTO      CODEXD10 IF EQUAL
          ENDIF
.
          IF        F1=3
            MATCH     SP70,KEY4
            GOTO      CODEXD60 IF EQUAL        * Display if blank
.
            MATCH     KEY4,THCSCOD             * Only display if ind F2=KEY4
            GOTO      CODEXD10 IF NOT EQUAL
          ENDIF
.
CODEXD60  WRITE     HTMLFILE;"<option value=",KEY60,">",TDESC,"</option>"
          GOTO      CODEXD10
.
CODEXD99  RETURN
.
.------------------------------------------------------------
. Selection List with Code Displayed
. With A Default Code Selected (PTCDDEFT)
. This will select the code in the parameter CODE if it is
. not blank (Use for Update Screens)
.------------------------------------------------------------
UDDSEL00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
.
          MOVE      ZERO,FORM1
          MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
UDDSEL10  CALL      RDKCODE2
          BRANCH    OVRCD,UDDSEL99
          MATCH     CATEGORY,TCODE
          GOTO      UDDSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      UDDSEL10 IF EQUAL
          PACK      KEY60,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                          TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                          TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                          PTCOACTV,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
.
          BRANCH    FORM1,UDDSEL40     * Only 1 code can be selected in list
.
          IF        CATACTIV=1
            MATCH     "I",PTCOACTV               * Display active only
            GOTO      UDDSEL10 IF EQUAL
          ENDIF
.
          MATCH     SP70,CODE
          IF        !@EQUAL
            MATCH     CODE,ACODE
            IF        @EQUAL
              IF        F1=1
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 TDESC,"</option>"
              ELSE
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 "(",ACODE,") ",TDESC,"</option>"
              ENDIF

              GOTO      UDDSEL10
            ENDIF
            GOTO        UDDSEL40
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,UDDSEL10
            ENDIF
          ENDIF
.
          MATCH     "1",PTCDDEFT
          IF        @EQUAL
            IF        F1=1
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 TDESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#" selected>":
                                 "(",ACODE,") ",TDESC,"</option>"
            ENDIF
            MOVE      ONE,FORM1
            GOTO      UDDSEL10
          ENDIF
.
UDDSEL40  IF        CATACTIV<>2
            MATCH     "I",PTCOACTV
            GOTO      UDDSEL10 IF EQUAL
          ENDIF
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,UDDSEL10
            ENDIF
          ENDIF
.
          IF        F1=1
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">",TDESC:
                               "</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY60,"#">":
                               "(",ACODE,") ",TDESC,"</option>"
          ENDIF
.
          GOTO      UDDSEL10
UDDSEL99  RETURN
.
.------------------------------------------------------------
. Add Selection Options to Form (with full value)
.------------------------------------------------------------
.
CODGTA00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
CODGTA10  CALL      RDKCODE2
          BRANCH    OVRCD,CODGTA99
          MATCH     CATEGORY,TCODE
          GOTO      CODGTA99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      CODGTA10 IF EQUAL
          PACK      KEY300,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                           TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                           TCINDC11,THCSCOD,PTCDNHCP,TCFORM6:
                           TCINDC12,TCINDC13,TCINDC14,TCINDC15,TCINDC16:
                           TCINDC17,TCINDC18,TCINDC19,TCINDC20,TCINDC21:
                           PTCOACTV,PTCDASC1,PTCDASC2,PTCDASC3,PTCDASC4:
                           PTCDASC5,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                           TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                           TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                           TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                           TCINDC41,PTCDASC6,PTCDASC7,PTCDASC8,PTCDASC9:
                           PTCDAS10,PTCDAS11,PTCDAS12,PTCDAS13,PTCDAS14:
                           PTCDAS15,PTCDUDF2,PTCDUDF3,PTCDUDF4,PTCDUDF5:
                           PTCDUDF6,PTCDUDF7,PTCDUDF8,PTCDUDF9,PTCDUD10:
                           PTCDUD11,PTCDUD12,PTCDUD13,PTCDUD14,SP70,SP70,SP70
.
          MATCH     CODE,ACODE
          IF        @EQUAL
            IF        CATACTIV=1
              MATCH     "I",PTCOACTV               * Display active only
              GOTO      CODGTA10 IF EQUAL
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY300,"#" selected>":
                               TDESC,"</option>"
          ELSE
            IF        CATACTIV<>2
              MATCH     "I",PTCOACTV
              GOTO      CODGTA10 IF EQUAL
            ENDIF
.
            IF        IBCNMHOS=1
              MATCH    "1",PTCDHOSS
              IF       @EQUAL
                PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
                CALL     RDMLCOD1
                BRANCH   OVRCD,CODGTA10
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",ACODE,KEY300,"#">",TDESC:
                               "</option>"
          ENDIF
          GOTO      CODGTA10
CODGTA99  RETURN

