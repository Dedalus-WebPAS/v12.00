.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
LDCF0000  BRANCH    FLDITMNO,LDCF0100,LDCF0200
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      LDCF9999
.
LDCF0100  CALL      LDCNAM00
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      LDCF9999
.
LDCF0200  WRITE     HTMLFILE;LDCODE;
          GOTO      LDCF9999
.
LDCF9999  RETURN
.
.------------------------------------------------------------
. Short Format Doctor Name in Title Text
.------------------------------------------------------------
LDCSNM00  CLEAR     DISPNAME
          MOVE      SP70,DOCFNAME
          PACK      NAME35,LDTITL,SP70
          CALL      NAMSTR00
          MOVE      LDGNAME,KEY1
          PACK      NAME35,KEY1,SP70
          CALL      NAMSTR00
          PACK      NAME35,LDSNAME,SP70
          CALL      NAMSTR00
          APPEND    SP70,DISPNAME
          RESET     DISPNAME
          MOVE      DISPNAME,DOCFNAME
          STRIP     DOCFNAME
          RETURN
.------------------------------------------------------------
. Format Doctor Name in Title Text
.------------------------------------------------------------
LDCNAM00  CLEAR     DISPNAME
          MOVE      SP70,DOCFNAME
          PACK      NAME35,LDTITL,SP70
          CALL      NAMSTR00
          PACK      NAME35,LDGNAME,SP70
          CALL      LDCGIV00
          PACK      NAME35,LDSNAME,SP70
          CALL      NAMSTR00
          APPEND    SP70,DISPNAME
          RESET     DISPNAME
          MOVE      DISPNAME,DOCFNAME
          STRIP     DOCFNAME
          RETURN
.-------------------------------------------------
. Format Doctors Given Name 
.-------------------------------------------------
LDCGIV00  CMATCH    SP1,NAME35               * Remove Leading Blanks
          IF        @EQUAL
            BUMP      NAME35
            GOTO      LDCGIV00 IF NOT EOS
            GOTO      LDCGIV99               * entire name if blank
          ENDIF
          PACK      KEY35,NAME35,SP30        * reset form pointer
          MOVE      KEY35,NAME35
.
          SCAN      SP1,NAME35             * Locate the blank
          GOTO      LDCGIV20 IF NOT EQUAL
          BUMP      NAME35,-1              * go back 1 to end of name
          MOVEFPTR  NAME35,CCITEM          * another handly form field
          RESET     NAME35                 * reset the form pointer
          SETLPTR   NAME35,CCITEM          * set logical length to end of name
.
.         Save this name
.
          UNPACK    NAME35,KEY1,KEY50
          REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNAME
          STRIP     KEY50
          APPEND    KEY50,DISPNAME
          APPEND    SP1,DISPNAME
.
.         Check for any more names
.
          SETLPTR   NAME35,35              * reset logical length
          ADD       ONE,CCITEM             * position of 1st blank
          RESET     NAME35,CCITEM          * reset to this point
          PACK      KEY35,NAME35,SP70      * reset form pointer
          MOVE      KEY35,NAME35

LDCGIV10  CMATCH    SP1,NAME35               * Remove Leading Blanks
          IF        @EQUAL
            BUMP      NAME35
            GOTO      LDCGIV10 IF NOT EOS
            GOTO      LDCGIV99               * entire name if blank
          ENDIF
          PACK      KEY35,NAME35,SP30        * reset form pointer
          MOVE      KEY35,NAME35
.
          SCAN      SP1,NAME35             * Locate the blank
          GOTO      LDCGIV20 IF NOT EQUAL
          BUMP      NAME35,-1              * go back 1 to end of name
          MOVEFPTR  NAME35,CCITEM          * another handly form field
          RESET     NAME35                 * reset the form pointer
          SETLPTR   NAME35,CCITEM          * set logical length to end of name
.
.         Save this Initial
.
          UNPACK    NAME35,KEY1,KEY50
          APPEND    KEY1,DISPNAME
          APPEND    SP1,DISPNAME
.
          GOTO      LDCGIV99
.
.         Rest of the string is one name
.
LDCGIV20  UNPACK    NAME35,KEY1,KEY50
          REP       DOWNCASE,KEY50
          APPEND    KEY1,DISPNAME
          STRIP     KEY50
          APPEND    KEY50,DISPNAME
          APPEND    SP1,DISPNAME
.
LDCGIV99  RETURN
.------------------------------------------------------------
. Get Doctor Details 
.------------------------------------------------------------
LDCDET00  UNPACK    DIM127,D1,FLDITEM,DIM127
          MOVE      FLDITEM,FLDITMNO
          MATCH     SP70,DOCTCODE
          GOTO      LDCDET90 IF EQUAL
          MOVE      DOCTCODE,KEY6
          CALL      RDLGDOC1
          BRANCH    OVRCD,LDCDET90
          CALL      LDCF0000
          GOTO      LDCDET99
.
LDCDET90  CALL      LDCPAR00    * Get Rid of Parameters
.
LDCDET99  RETURN
.------------------------------------------------------------
. Get Rid of Parameters in Template
.------------------------------------------------------------
LDCPAR00  BRANCH    FLDITMNO,LDCPAR10,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99: *10
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99: *20
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR99,LDCPAR20,LDCPAR20,LDCPAR20: *30
                             LDCPAR20,LDCPAR20,LDCPAR20,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR20,LDCPAR99,LDCPAR99,LDCPAR10: *40
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99: 
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99: *50
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99: *60
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99: *70
                             LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99,LDCPAR99:
                             LDCPAR99,LDCPAR99
          GOTO      LDCPAR99
. Server Link
LDCPAR10  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          GOTO      LDCPAR99
. Code 0,1,2
LDCPAR20  UNPACK    DIM127,D1,ANS,DIM127
          GOTO      LDCPAR99
LDCPAR99  RETURN
.
