.--------------------------------------------------------
. Modifications
. V9.03.01   08.10.2003 Ebon Clements CAR 43994 
.            Fixed check box cgi variables
. V9.02.01   18.09.2001 Ebon Clements 
.            Moved standard routines from program to TM
.--------------------------------------------------------
.--------------------------------------------------------
. This file has the routine that will output the variables
. of file apsmasaf.dat(APSMASFD.INC) to the HTML page
.--------------------------------------------------------
.
APSM0000  BRANCH    FLDITMNO,APSM0100,APSM0200,APSM0300,APSM0400,APSM0500:
                             APSM0600,APSM0700,APSM0800,APSM0900,APSM1000:
                             APSM1100,APSM1200,APSM1300,APSM1400,APSM1500:
                             APSM1600,APSM1700,APSM1800,APSM1900,APSM2000:
                             APSM2100,APSM2200,APSM2300,APSM2400,APSM2500:
                             APSM2600,APSM2700,APSM2800,APSM2900,APSM3000:
                             APSM3100,APSM3200,APSM3300,APSM3400,APSM3500:
                             APSM3600,APSM3700,APSM3800,APSM3900,APSM4000:
                             APSM4100,APSM4200,APSM4300,APSM4400,APSM4500:
                             APSM4600,APSM4700,APSM4800,APSM4900; 
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      APSM9999
.
APSM0100  WRITE     HTMLFILE;APMACRD;
          GOTO      APSM9999
.
APSM0200  CALL      CRDTYP00
          GOTO      APSM9999
.
APSM0300  WRITE     HTMLFILE;APMASKY;
          GOTO      APSM9999
.
APSM0400  WRITE     HTMLFILE;APMACN1;
          GOTO      APSM9999
.
APSM0500  WRITE     HTMLFILE;APMACN2;
          GOTO      APSM9999
.
APSM0600  WRITE     HTMLFILE;APMACA1;
          GOTO      APSM9999
.
APSM0700  WRITE     HTMLFILE;APMACA2;
          GOTO      APSM9999
.
APSM0800  WRITE     HTMLFILE;APMACA3;
          GOTO      APSM9999
.
APSM0900  WRITE     HTMLFILE;APMACPC;
          GOTO      APSM9999
.
APSM1000  WRITE     HTMLFILE;APMACTEL;
          GOTO      APSM9999
.
APSM1100  WRITE     HTMLFILE;APMACFAX;
          GOTO      APSM9999
.
APSM1200  WRITE     HTMLFILE;APMACMOD;
          GOTO      APSM9999
.
APSM1300  WRITE     HTMLFILE;APMACEDI;
          GOTO      APSM9999
.
APSM1400  WRITE     HTMLFILE;APMACON;
          GOTO      APSM9999
.
APSM1500  WRITE     HTMLFILE;APMASN1;
          GOTO      APSM9999
.
APSM1600  WRITE     HTMLFILE;APMASN2;
          GOTO      APSM9999
.
APSM1700  WRITE     HTMLFILE;APMASA1;
          GOTO      APSM9999
.
APSM1800  WRITE     HTMLFILE;APMASA2;
          GOTO      APSM9999
.
APSM1900  WRITE     HTMLFILE;APMASA3;
          GOTO      APSM9999
.
APSM2000  WRITE     HTMLFILE;APMASPC;
          GOTO      APSM9999
.
APSM2100  WRITE     HTMLFILE;APMASTEL;
          GOTO      APSM9999
.
APSM2200  WRITE     HTMLFILE;APMASFAX;
          GOTO      APSM9999
.
APSM2300  WRITE     HTMLFILE;APMASMOD;
          GOTO      APSM9999
.
APSM2400  WRITE     HTMLFILE;APMASEDI;
          GOTO      APSM9999
.
APSM2500  WRITE     HTMLFILE;APMASCON;
          GOTO      APSM9999
.
APSM2600  WRITE     HTMLFILE;APMABSB;
          GOTO      APSM9999
.
APSM2700  WRITE     HTMLFILE;APMABAC;
          GOTO      APSM9999
.
APSM2800  WRITE     HTMLFILE;APMAPNM;
          GOTO      APSM9999
.
APSM2900  WRITE     HTMLFILE;APMAPPT;
          GOTO      APSM9999
.
APSM3000  WRITE     HTMLFILE;APMAPOT;
          GOTO      APSM9999
.
APSM3100  WRITE     HTMLFILE;APMAHOR;
          GOTO      APSM9999  
.
APSM3200  WRITE     HTMLFILE;APMAHIN;
          GOTO      APSM9999
.
APSM3300  WRITE     HTMLFILE;APMAHCR;
          GOTO      APSM9999  
.
APSM3400  WRITE     HTMLFILE;APMAHPY;
          GOTO      APSM9999
.
APSM3500  WRITE     HTMLFILE;APMAPMT;
          GOTO      APSM9999
. 
APSM3600  WRITE     HTMLFILE;APMAGMT;
          GOTO      APSM9999
.
APSM3700  WRITE     HTMLFILE;APMAPPD;
          GOTO      APSM9999
.
APSM3800  CALL      DEFTRM00
          GOTO      APSM9999
.
APSM3900  WRITE     HTMLFILE;APMAUR1;
          GOTO      APSM9999
.
APSM4000  WRITE     HTMLFILE;APMAUR2;
          GOTO      APSM9999
.                             
APSM4100  MATCH     SP70,APMAUD1
          GOTO      APSM9999 IF EQUAL
.
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY
.
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      APSM9999
.
APSM4200  MATCH     SP70,APMAUD2
          GOTO      APSM9999 IF EQUAL
.
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      APSM9999
.
APSM4300  MOVE      "a1",CATEGORY
          MOVE      APMAUC1,CODE
          CALL      FMSITM00 
          GOTO      APSM9999
.
APSM4400  MOVE      "a2",CATEGORY
          MOVE      APMAUC2,CODE
          CALL      FMSITM00 
          GOTO      APSM9999
.
APSM4500  WRITE     HTMLFILE;APMAGREG;
          GOTO      APSM9999
.                           
APSM4600  WRITE     HTMLFILE;APMAUY2;
          GOTO      APSM9999
.
APSM4700  WRITE     HTMLFILE;APMADIS;
          GOTO      APSM9999
.
APSM4800  WRITE     HTMLFILE;APMATSE;
          GOTO      APSM9999
.
APSM4900  WRITE     HTMLFILE;APMAABN;
          GOTO      APSM9999
.
APSM9999  RETURN
.
.-------------------------------------------------------------------------------
.  Set Parameters for Option 1: Creditor/Supplier Services
.-------------------------------------------------------------------------------
STMAS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STMAS001,STMAS002,STMAS003,STMAS004,STMAS005:
                       STMAS006,STMAS007,STMAS008,STMAS009,STMAS010:
                       STMAS011,STMAS012,STMAS013,STMAS014,STMAS015:
                       STMAS016,STMAS017,STMAS018,STMAS019,STMAS020:
                       STMAS021,STMAS022,STMAS023,STMAS024,STMAS025:
                       STMAS026,STMAS027,STMAS028,STMAS029,STMAS030:
                       STMAS031,STMAS032,STMAS033,STMAS034,STMAS035:
                       STMAS036,STMAS037,STMAS038,STMAS039,STMAS040:
                       STMAS041,STMAS042,STMAS043,STMAS044,STMAS045:
                       STMAS046,STMAS047,STMAS048,STMAS049
.
          MOVE      ONE,EXIT
          GOTO      STMAS999
.
STMAS001  MOVE      QRYDATA,APMAS001
          PACK      APMAS001,APMAS001,SP70  * Creditor/Supplier Code
          GOTO      STMAS999
.
STMAS002  MOVE      QRYDATA,APMAS002
          PACK      APMAS002,APMAS002,SP70  * Creditor/Supplier Type
          GOTO      STMAS999
.
STMAS003  MOVE      QRYDATA,APMAS003
          PACK      APMAS003,APMAS003,SP70  * Creditor/Supplier Sort Key
          GOTO      STMAS999
.
STMAS004  MOVE      QRYDATA,APMAS004
          GOTO      STMAS999
.
STMAS005  MOVE      QRYDATA,APMAS005
          GOTO      STMAS999
.
STMAS006  MOVE      QRYDATA,APMAS006
          GOTO      STMAS999
.
STMAS007  MOVE      QRYDATA,APMAS007
          GOTO      STMAS999
.
STMAS008  MOVE      QRYDATA,APMAS008
          GOTO      STMAS999
.
STMAS009  MOVE      QRYDATA,APMAS009
          GOTO      STMAS999
.
STMAS010  MOVE      QRYDATA,APMAS010
          GOTO      STMAS999
.
STMAS011  MOVE      QRYDATA,APMAS011
          GOTO      STMAS999
.
STMAS012  MOVE      QRYDATA,APMAS012
          GOTO      STMAS999
.
STMAS013  MOVE      QRYDATA,APMAS013
          GOTO      STMAS999
.
STMAS014  MOVE      QRYDATA,APMAS014
          GOTO      STMAS999
.
STMAS015  MOVE      QRYDATA,APMAS015
          GOTO      STMAS999
.
STMAS016  MOVE      QRYDATA,APMAS016
          GOTO      STMAS999
.
STMAS017  MOVE      QRYDATA,APMAS017
          GOTO      STMAS999
.
STMAS018  MOVE      QRYDATA,APMAS018
          GOTO      STMAS999
.
STMAS019  MOVE      QRYDATA,APMAS019
          GOTO      STMAS999
.
STMAS020  MOVE      QRYDATA,APMAS020
          GOTO      STMAS999
.
STMAS021  MOVE      QRYDATA,APMAS021
          GOTO      STMAS999
.
STMAS022  MOVE      QRYDATA,APMAS022
          GOTO      STMAS999
.
STMAS023  MOVE      QRYDATA,APMAS023
          GOTO      STMAS999
.
STMAS024  MOVE      QRYDATA,APMAS024
          GOTO      STMAS999
.
STMAS025  MOVE      QRYDATA,APMAS025
          GOTO      STMAS999
.
STMAS026  MOVE      QRYDATA,APMAS026
          GOTO      STMAS999
.
STMAS027  MOVE      QRYDATA,APMAS027
          GOTO      STMAS999
.
STMAS028  MOVE      QRYDATA,APMAS028
          GOTO      STMAS999
.
STMAS029  MOVE      QRYDATA,APMAS029
          GOTO      STMAS999
.
STMAS030  MOVE      QRYDATA,APMAS030
          GOTO      STMAS999
.
STMAS031  MOVE      QRYDATA,APMAS031
          GOTO      STMAS999
.
STMAS032  MOVE      QRYDATA,APMAS032
          GOTO      STMAS999
.
STMAS033  MOVE      QRYDATA,APMAS033
          GOTO      STMAS999
.
STMAS034  MOVE      QRYDATA,APMAS034
          GOTO      STMAS999
.
STMAS035  MOVE      QRYDATA,APMAS035
          GOTO      STMAS999
.
STMAS036  MOVE      QRYDATA,APMAS036
          GOTO      STMAS999
.
STMAS037  MOVE      QRYDATA,APMAS037
          GOTO      STMAS999
.
STMAS038  MOVE      QRYDATA,APMAS038
          GOTO      STMAS999
.
STMAS039  MOVE      QRYDATA,APMAS039
          GOTO      STMAS999
.
STMAS040  MOVE      QRYDATA,APMAS040
          GOTO      STMAS999
.
STMAS041  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      APMAS041,CCENT,CYEAR,CMON,CDAY
          GOTO      STMAS999
.
STMAS042  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      APMAS042,CCENT,CYEAR,CMON,CDAY
          GOTO      STMAS999
.
STMAS043  MOVE      QRYDATA,APMAS043
          GOTO      STMAS999
.
STMAS044  MOVE      QRYDATA,APMAS044
          GOTO      STMAS999
.
STMAS045  MOVE      QRYDATA,APMAS045
          GOTO      STMAS999
.
STMAS046  MOVE      QRYDATA,APMAS046
          GOTO      STMAS999
.
STMAS047  MOVE      QRYDATA,APMAS047
          GOTO      STMAS999
.
STMAS048  MOVE      QRYDATA,APMAS048
          GOTO      STMAS999
.
STMAS049  MOVE      QRYDATA,APMAS049
          GOTO      STMAS999
.
STMAS999  RETURN
.
.-------------------------------------------------------------------------------
. Clear cgi variables for APSMASFD
.-------------------------------------------------------------------------------
CLAPMS00  MOVE      Z70,APMAS001
          MOVE      Z70,APMAS002
          MOVE      Z70,APMAS003
          MOVE      Z70,APMAS004
          MOVE      Z70,APMAS005
          MOVE      Z70,APMAS006
          MOVE      Z70,APMAS007
          MOVE      Z70,APMAS008
          MOVE      Z70,APMAS009
          MOVE      Z70,APMAS010
          MOVE      Z70,APMAS011
          MOVE      Z70,APMAS012
          MOVE      Z70,APMAS013
          MOVE      Z70,APMAS014
          MOVE      Z70,APMAS015
          MOVE      Z70,APMAS016
          MOVE      Z70,APMAS017
          MOVE      Z70,APMAS018
          MOVE      Z70,APMAS019
          MOVE      Z70,APMAS020
          MOVE      Z70,APMAS021
          MOVE      Z70,APMAS022
          MOVE      Z70,APMAS023
          MOVE      Z70,APMAS024
          MOVE      Z70,APMAS025
          MOVE      Z70,APMAS026
          MOVE      Z70,APMAS027
          MOVE      Z70,APMAS028
          MOVE      Z70,APMAS029
          MOVE      Z70,APMAS030
          MOVE      Z70,APMAS031
          MOVE      Z70,APMAS032
          MOVE      Z70,APMAS033
          MOVE      Z70,APMAS034
          MOVE      Z70,APMAS035
          MOVE      Z70,APMAS036
          MOVE      Z70,APMAS037
          MOVE      Z70,APMAS038
          MOVE      Z70,APMAS039
          MOVE      Z70,APMAS040
          MOVE      Z70,APMAS041
          MOVE      Z70,APMAS042
          MOVE      Z70,APMAS043
          MOVE      Z70,APMAS044
          MOVE      Z70,APMAS045
          MOVE      Z70,APMAS046
          MOVE      Z70,APMAS047
          MOVE      Z70,APMAS048
          MOVE      Z70,APMAS049
.
CLAPMS99  RETURN
.----------------------------------------------------------
.   move supplier CGI parameters to creditor fields
.----------------------------------------------------------
SAVAPS00  MATCH     Z70,APMAS001
          IF        !@EQUAL
            MOVE      APMAS001,APMACRD
          ENDIF
.
          MATCH     Z70,APMAS002
          IF        !@EQUAL
            MOVE      APMAS002,APMATYP
          ENDIF
.
          MATCH     Z70,APMAS003
          IF        !@EQUAL
            MOVE      APMAS003,APMASKY
          ENDIF
.
          MATCH     Z70,APMAS004
          IF        !@EQUAL
            MOVE      APMAS004,APMACN1
          ENDIF
.
          MATCH     Z70,APMAS005
          IF        !@EQUAL
            MOVE      APMAS005,APMACN2
          ENDIF
.
          MATCH     Z70,APMAS006
          IF        !@EQUAL
            MOVE      APMAS006,APMACA1
          ENDIF
.
          MATCH     Z70,APMAS007
          IF        !@EQUAL
            MOVE      APMAS007,APMACA2
          ENDIF
.
          MATCH     Z70,APMAS008
          IF        !@EQUAL
            MOVE      APMAS008,APMACA3
          ENDIF
.
          MATCH     Z70,APMAS009
          IF        !@EQUAL
            MOVE      APMAS009,APMACPC
          ENDIF
.
          MATCH     Z70,APMAS010
          IF        !@EQUAL
            MOVE      APMAS010,APMACTEL
          ENDIF
.
          MATCH     Z70,APMAS011
          IF        !@EQUAL
            MOVE      APMAS011,APMACFAX
          ENDIF
.
          MATCH     Z70,APMAS012
          IF        !@EQUAL
            MOVE      APMAS012,APMACMOD
          ENDIF
.
          MATCH     Z70,APMAS013
          IF        !@EQUAL
            MOVE      APMAS013,APMACEDI
          ENDIF
.
          MATCH     Z70,APMAS014
          IF        !@EQUAL
            MOVE      APMAS014,APMACON
          ENDIF
.
          MATCH     Z70,APMAS015
          IF        !@EQUAL
            MOVE      APMAS015,APMASN1
          ENDIF
.
          MATCH     Z70,APMAS016
          IF        !@EQUAL
            MOVE      APMAS016,APMASN2
          ENDIF
.
          MATCH     Z70,APMAS017
          IF        !@EQUAL
            MOVE      APMAS017,APMASA1
          ENDIF
.
          MATCH     Z70,APMAS018
          IF        !@EQUAL
            MOVE      APMAS018,APMASA2
          ENDIF
.
          MATCH     Z70,APMAS019
          IF        !@EQUAL
            MOVE      APMAS019,APMASA3
          ENDIF
.
          MATCH     Z70,APMAS020
          IF        !@EQUAL
            MOVE      APMAS020,APMASPC
          ENDIF
.
          MATCH     Z70,APMAS021
          IF        !@EQUAL
            MOVE      APMAS021,APMASTEL
          ENDIF
.
          MATCH     Z70,APMAS022
          IF        !@EQUAL
            MOVE      APMAS022,APMASFAX
          ENDIF
.
          MATCH     Z70,APMAS023
          IF        !@EQUAL
            MOVE      APMAS023,APMASMOD
          ENDIF
.
          MATCH     Z70,APMAS024
          IF        !@EQUAL
            MOVE      APMAS024,APMASEDI
          ENDIF
.
          MATCH     Z70,APMAS025
          IF        !@EQUAL
            MOVE      APMAS025,APMASCON
          ENDIF
.
          MATCH     Z70,APMAS026
          IF        !@EQUAL
            MOVE      APMAS026,APMABSB
          ENDIF
.  
          MATCH     Z70,APMAS027
          IF        !@EQUAL
            MOVE      APMAS027,APMABAC
          ENDIF
.  
          MATCH     Z70,APMAS028
          IF        !@EQUAL
            MOVE      APMAS028,APMAPNM
          ENDIF
.  
          MATCH     Z70,APMAS029
          IF        !@EQUAL
            MOVE      APMAS029,APMAPPT
          ENDIF
.  
          MATCH     Z70,APMAS030
          IF        !@EQUAL
            MOVE      APMAS030,APMAPOT
          ENDIF
.  
          MATCH     Z70,APMAS031
          IF        !@EQUAL
            MOVE      APMAS031,APMAHOR
          ENDIF
.  
          MATCH     Z70,APMAS032
          IF        !@EQUAL
            MOVE      APMAS032,APMAHIN
          ENDIF
.  
          MATCH     Z70,APMAS033
          IF        !@EQUAL
            MOVE      APMAS033,APMAHCR
          ENDIF
.  
          MATCH     Z70,APMAS034
          IF        !@EQUAL
            MOVE      APMAS034,APMAHPY
          ENDIF
.  
          MATCH     Z70,APMAS035
          IF        !@EQUAL
            MOVE      APMAS035,APMAPMT
          ENDIF
.  
          MATCH     Z70,APMAS036
          IF        !@EQUAL
            MOVE      APMAS036,APMAGMT
          ENDIF
.  
          MATCH     Z70,APMAS037
          IF        !@EQUAL
            MOVE      APMAS037,APMAPPD
          ENDIF
.  
          MATCH     Z70,APMAS038
          IF        !@EQUAL
            MOVE      APMAS038,APMADTM
          ENDIF
.  
          MATCH     Z70,APMAS039
          IF        !@EQUAL
            MOVE      APMAS039,APMAUR1
          ENDIF
.  
          MATCH     Z70,APMAS040
          IF        !@EQUAL
            MOVE      APMAS040,APMAUR2
          ENDIF
.  
          MATCH     Z70,APMAS041
          IF        !@EQUAL
            MOVE      APMAS041,APMAUD1
          ENDIF
.  
          MATCH     Z70,APMAS042
          IF        !@EQUAL
            MOVE      APMAS042,APMAUD2
          ENDIF
.   
          MATCH     Z70,APMAS043
          IF        !@EQUAL
            MOVE      APMAS043,APMAUC1
          ENDIF
.   
          MATCH     Z70,APMAS044
          IF        !@EQUAL
            MOVE      APMAS044,APMAUC2
          ENDIF
.   
          MATCH     Z70,APMAS045
          IF        !@EQUAL
            MOVE      APMAS045,APMAGREG
          ENDIF
.   
          MATCH     Z70,APMAS046
          IF        !@EQUAL
            MOVE      APMAS046,APMAUY2
          ENDIF
.   
          MATCH     Z70,APMAS047
          IF        !@EQUAL
            MOVE      APMAS047,APMADIS
          ENDIF
.   
          MATCH     Z70,APMAS048
          IF        !@EQUAL
            MOVE      APMAS048,APMATSE
          ENDIF
.   
          MATCH     Z70,APMAS049
          IF        !@EQUAL
            MOVE      APMAS049,APMAABN
          ENDIF
.   
SAVAPS99  RETURN
.
.****************************************************************************
. CRDTYP00 - Selection list of creditor types                               *
.****************************************************************************
CRDTYP00  PACK      KEY3,SP70
          CALL      RSAPCT1
CRDTYP30  CALL      RKAPCT1
          BRANCH    OVRCD,CRDTYP99
.
          PACK      KEY6,QUOTE,APCTCODE,QUOTE
          MATCH     APMATYP,APCTCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY6," selected>":
                              APCTDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY6,">",APCTDESC,"</option>"
          ENDIF
          GOTO      CRDTYP30
.
CRDTYP99  RETURN
.
.****************************************************************************
. DEFTRM00 - Selection list of payment terms                                *
.****************************************************************************
DEFTRM00  MOVE      ZERO,F1
          PACK      KEY2,SP70
          CALL      RSAPPP1
DEFTRM30  CALL      RKAPPP1
          BRANCH    OVRCD,DEFTRM99
.
          PACK      KEY6,QUOTE,APPPTER,QUOTE
          MATCH     APMADTM,APPPTER
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY6," selected>":
                              APPPDES,"</option>"
          ELSE
            MATCH     SP70,APMADTM     * If no term are set set to first record
            IF        @EQUAL
              IF        F1=0
                WRITE     HTMLFILE;"<option value=",KEY6," selected>":
                                  APPPDES,"</option>"
                MOVE      ONE,F1
                GOTO      DEFTRM30
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=",KEY6,">",APPPDES,"</option>"
          ENDIF
          GOTO      DEFTRM30
.
DEFTRM99  RETURN
