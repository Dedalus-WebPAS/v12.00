.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINIMPKY
.   Routine   :   KSIIMA00 Keyin Catalog             
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIIMA00 TOPIC     "NATOCODE "
          MOVE      "63",SECTOR
          READ      CONTROLF,SECTOR;*67,INCOCATE,*141,INCNNATO
          MOVE      SP70,NATOCODE 
          MOVE      SP70,SIIMCAT 
          COMPARE   ZERO,INCOCATE
          GOTO      KSIIMA01 IF NOT EQUAL
.
          KEYIN     *PCCOL:CVERT,*V2LON,NATOCODE
.
          ENDSET    NATOCODE 
          APPEND    SP70,NATOCODE 
          RESET     NATOCODE 
          REP       UPPLOW,NATOCODE
.
          IF        ETOEXIT=0
            MATCH     SP70,NATOCODE 
            IF        @EQUAL
              MOVE      ONE,EXIT
              GOTO      KSIIMA99
            ENDIF
          ELSE
            MATCH     ANSE,NATOCODE 
            IF        @EQUAL
              MOVE      TWO,EXIT
              GOTO      KSIIMA99
            ENDIF
          ENDIF
.
          CMATCH    EXITCHAR,NATOCODE 
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KSIIMA99
          ENDIF
.
          CMATCH    QUEST,NATOCODE 
          GOTO      KSIIMA10 IF NOT EQUAL
          GOTO      KSIIMA02
.
KSIIMA01 
          MOVE      SP70,NATOCODE 
          KEYIN     *PCCOL:CVERT,*V2LON,*JR,NATOCODE
.
          ENDSET    NATOCODE 
          APPEND    SP70,NATOCODE 
          RESET     NATOCODE 
          REP       UPPLOW,NATOCODE
.
          IF        ETOEXIT=0
            MATCH     SP70,NATOCODE 
            IF        @EQUAL
              MOVE      ONE,EXIT
              GOTO      KSIIMA99
            ENDIF
          ENDIF
.
          ENDSET    NATOCODE 
          CMATCH    EXITCHAR,NATOCODE 
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KSIIMA99
          ENDIF
.
          IF        ETOEXIT=1
            MATCH     ANSE,NATOCODE 
            IF        @EQUAL
              MOVE      TWO,EXIT
              GOTO      KSIIMA99
            ENDIF
          ENDIF
.
          CMATCH    QUEST,NATOCODE 
          GOTO      KSIIMA02 IF EQUAL
          RESET     NATOCODE 
.
          TYPE      NATOCODE
          IF        !@EQUAL & CKEYTYP=1
            DISPLAY   *P1:24,*EL,"Entry is not numeric.  ";
            CALL      HITENTER
            GOTO      KSIIMA00
          ENDIF
          GOTO      KSIIMA10
.
KSIIMA02  MOVE      CCITEM,SCCITEM
          MATCH     DEFLTWH,SP70
          IF        @EQUAL
            CALL      HSIIMA00               * Normal Catalog Lookup
          ELSE
            MOVE      DEFLTWH,KEY5
            CALL      RDSIWA1
            CALL      HSIIMA00             * Normal Catalog Lookup
          ENDIF
          BRANCH    EXIT,KSIIMA00,KSIIMA00
.
          IF        CKEYTYP=1 | CKEYTYP=2
            GOTO      KSIIMA00
          ENDIF
.
          MOVE      SCCITEM,CCITEM
.
          MATCH     SP70,NATOCODE 
          GOTO      KSIIMA00 IF EQUAL
.
          GOTO      KSIIMA80
KSIIMA10
          IF        INCOCATE<>0
            UNPACK    NATOCODE,KEY3,SIIMCAT
          ELSE
            UNPACK    NATOCODE,SIIMCAT,KEY3
          ENDIF
.
          PACK      KEY12,SIIMCST,SIIMCAT
          MATCH     KEY3,SP3          * Check if too large for Catalog - Nato?
          IF        @EQUAL  
            CALL      RASIIM1 
          ELSE
            IF        INCNNATO<>1 | CKEYTYP=1 
              MOVE      "Entry too long for a Catalog Code - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KSIIMA00
            ELSE
              MOVE      ONE,OVRCD     * Simulate for Nato Lookup
            ENDIF
          ENDIF
.
. ------- OVRCD=1 if not found on catalog file or if > 7 chars keyed in and
. ------- Nato Codes are being used.
          IF        OVRCD=1
            CALL      CKNATO00               * Check Nato File
            BRANCH    EXIT,KSIIMA00
            BRANCH    CKEYTYP,KSIIMA99,KSIIMA99  * Insert mode - OK
          ELSE
            IF        CKEYTYP=1
              MOVE      "Catalog Code Already Exists - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KSIIMA00
            ENDIF
          ENDIF
.
. ------- Sinciaaf record must exist as in modify mode
KSIIMA80  PACK      KEY12,SIIMCST,SIIMCAT
          CALL      RDSIIM1 
          MOVE      ZERO,EXIT
          GOTO      KSIIMA99
.
KSIIMA99  DISPLAY   *PCCOL:CVERT,*V2LON,SIIMCAT,SP3
          MOVE      ZERO,ETOEXIT
         TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
. Check if SIIANAT is from the Nato File.
.-------------------------------------------------------------------------------
CKNATO00  MOVE      ZERO,EXIT
.
          MOVE      NATOCODE,KEY10
.
          SQUEEZE   KEY10
          PACK      KEY17,KEY10,SP70
          RESET     KEY10
          MOVE      KEY17,KEY10
.
          IF        INCNNATO=0
            IF        CKEYTYP<>1 & CKEYTYP<>2
              MOVE      "Catalog Does Not Exist - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
            ENDIF
            GOTO      CKNATO99
          ENDIF
.
          MOVE      SP70,SINANAT
          CALL      RSSINA2
          CALL      RKSINA2
          MATCH     SINANAT,KEY10
          IF        OVRCD=1 | !@EQUAL
            IF CKEYTYP<>1 & CKEYTYP<>2
              MOVE      "Catalog or Nato Code Does Not Exist - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      CKNATO99
            ENDIF
            IF        INCOCATE<>0
              UNPACK    NATOCODE,KEY3,SIIMCAT
            ELSE
              UNPACK    NATOCODE,SIIMCAT,KEY3
            ENDIF
          ELSE 
            IF        CKEYTYP=1 | CKEYTYP=2
              MOVE      "Nato Code Already Exists - ",DISPMSG
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      CKNATO99
            ENDIF
            MOVE      SINACAT,SIIMCAT
          ENDIF
.
CKNATO99  RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINIMPKY
.   Routine   :   HSIIMA00 By Catalog          
.   Return    :           
.-------------------------------------------------------------------------------
HSIIMA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "20",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIIMA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIIMA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Catalog Code"       
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 9",STDCOL02
          MOVE      STDCOL02,STDCOL03
          ADD       "60",STDCOL03
HSIIMA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIIMCAT 
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          PACK      SAVKEY80,SIIMCST,SIIMCAT,SP70                               
          SETLPTR   SAVKEY80,5                                                  
          CALL      RSSIIM1 
HSIIMA10
          CALL      RKSIIM1 
          BRANCH    OVRCD,HSIIMA15
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSIIMA12
          CALL      HSIIMA60
          BRANCH    OVRCD,HSIIMA10
HSIIMA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY12,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          CALL      ESIIMA00
          DISPLAY   *PSTDCOL01:STDROW,SIIMCAT 
          DISPLAY   *PSTDCOL02:STDROW,SIIADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIIMA10 IF NOT EQUAL
HSIIMA15
          UNPACK    SAVKEY80,SIIMCST,SIIMCAT                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIIMA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIIMA30,HSIIMA35,HSIIMA40,HSIIMA45,HSIIMA04:
                              HSIIMA91,HSIIMA50
          GOTO      HSIIMA92
HSIIMA30
          CALL      RKSIIM1 
          BRANCH    OVRCD,HSIIMA85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA85 IF NOT EQUAL                                       
          CALL      RPSIIM1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMA10
HSIIMA35
          MOVE      ST1,KEY12
          CALL      RDSIIM1 
          CALL      RPSIIM1 
          BRANCH    OVRCD,HSIIMA85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA85 IF NOT EQUAL                                       
          MATCH     SP70,SIIMCAT                                                
          GOTO      HSIIMA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIIMA36
          CALL      RPSIIM1 
          BRANCH    OVRCD,HSIIMA37
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIIMA36 IF NOT EQUAL
HSIIMA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIIMA10
HSIIMA40
          MOVE      ST1,KEY12
          CALL      RDSIIM1 
          CALL      RPSIIM1 
          BRANCH    OVRCD,HSIIMA85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMA08
HSIIMA45
          CALL      RKSIIM1 
          BRANCH    OVRCD,HSIIMA85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY12,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIIM1 
HSIIMA46
          CALL      RPSIIM1 
          BRANCH    OVRCD,HSIIMA47
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          MATCH     SAVKEY80,KEY12                                              
          GOTO      HSIIMA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIIMA46 IF NOT EQUAL
HSIIMA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIIMA10
HSIIMA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIIMA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMA08
HSIIMA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMA08
HSIIMA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIIMA61 IF EQUAL
          MATCH     SCHFLD01,SIIMCAT 
          GOTO      HSIIMA72 IF NOT EQUAL
HSIIMA61
          MATCH     SP70,SCHFLD02
          GOTO      HSIIMA62 IF EQUAL
          MATCH     SCHFLD02,SIIADES 
          GOTO      HSIIMA72 IF NOT EQUAL
HSIIMA62
HSIIMA63
HSIIMA64
HSIIMA65
HSIIMA66
HSIIMA67
HSIIMA68
HSIIMA69
HSIIMA70
          GOTO      HSIIMA75
HSIIMA72  MOVE      ONE,OVRCD
HSIIMA75  RETURN
HSIIMA85
          LOAD      KEY12,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY12,SIIMCST,SIIMCAT                                       
          CALL      RDSIIM1 
HSIIMA90
          UNPACK    SAVKEY80,SIIMCST,SIIMCAT
          BEEP
          GOTO      HSIIMA20
HSIIMA91
          MOVE      SP70,SIIMSEQ 
          MOVE      ZERO,SIIMMAX 
          MOVE      ZERO,SIIMREQ 
          MOVE      ZERO,SIIMQOH 
          MOVE      SP70,SIIMUR1 
          MOVE      SP70,SIIMUR2 
          MOVE      SP70,SIIMUD1 
          MOVE      SP70,SIIMUD2 
          MOVE      SP70,SIIMUC1 
          MOVE      SP70,SIIMUC2 
          MOVE      SP70,SIIMUY1 
          MOVE      SP70,SIIMUY2 
          MOVE      SP70,SIIMWAR 
          MOVE      SP70,SIIMSPA 
          MOVE      SP70,KEY12
          MOVE      SP70,SIIMCAT 
          GOTO      HSIIMA96
HSIIMA92
          MOVE      SP70,KEY12
          MOVE      SP70,SIIMCAT 
          LOAD      KEY12,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY12,SIIMCST,SIIMCAT                                       
HSIIMA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIIMA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINIMPKY
.   Routine   :   HSIIMB00 By Nato Code        
.   Return    :           
.-------------------------------------------------------------------------------
HSIIMB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "20",HLEF
            MOVE      "80",HRIG
          ENDIF
HSIIMB04
          CALL      GSCRN000
          BRANCH    EXIT,HSIIMB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Nato Code "        
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Catalog"        
          MOVE      STDCOL02,STDCOL03
          ADD       "49",STDCOL03
HSIIMB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIIMCAT 
          MOVE      SP70,SINANAT 
          UNPACK    SP70,KEY9,KEY7,KEY1
          MOVE      "1",KEY1
          PACK      KEY17,KEY9,KEY1,KEY7                        
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                               
          PACK      SAVKEY80,SIIMCST,SIIMCAT,SINANAT                            
          SETLPTR   SAVKEY80,5                                                  
          CALL      RSIM0000                 
HSIIMB10
          CALL      RKIM0000
          BRANCH    OVRCD,HSIIMB15
          PACK      KEY12,SIIMCST,SIIMCAT
          PACK      KEY17,SINANAT,SIIMCAT
          BRANCH    CSEARCH,HSIIMB12
          CALL      HSIIMB60
          BRANCH    OVRCD,HSIIMB10
HSIIMB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          PACK      KEY22,KEY12,SINANAT
          STORE     KEY22,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          CALL      ESIIMA00
          DISPLAY   *PSTDCOL01:STDROW,SINANAT 
          DISPLAY   *PSTDCOL02:STDROW,SIIMCAT 
          DISPLAY   *PSTDCOL03:STDROW,SIIADES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIIMB10 IF NOT EQUAL
HSIIMB15
          UNPACK    SAVKEY80,SIIMCST,SIIMCAT,SINANAT
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIIMB20
          CALL      HSCRI000
          BRANCH    EXIT,HSIIMB30,HSIIMB35,HSIIMB40,HSIIMB45,HSIIMB04:
                              HSIIMB91,HSIIMB50
          GOTO      HSIIMB92
HSIIMB30
          CALL      RKIM0000
          BRANCH    OVRCD,HSIIMB85
          PACK      KEY12,SIIMCST,SIIMCAT
          PACK      KEY17,SINANAT,SIIMCAT
          CALL      RPIM0000
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMB10
HSIIMB35
          UNPACK    ST1,KEY12,SINANAT
          UNPACK    KEY12,SIIMCST,SIIMCAT
          PACK      KEY17,SINANAT,SIIMCAT
          CALL      RDSIIM1 
          CALL      RDSINA2 
          CALL      RPIM0000
          BRANCH    OVRCD,HSIIMB85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          PACK      KEY17,SINANAT,SIIMCAT,SP70                                  
          MATCH     SP70,SIIMCAT                                                
          GOTO      HSIIMB85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIIMB36
          CALL      RPIM0000
          BRANCH    OVRCD,HSIIMB37
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          PACK      KEY17,SINANAT,SIIMCAT,SP70                                  
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIIMB36 IF NOT EQUAL
HSIIMB37
          MOVE      ZERO,XITEMNO
          GOTO      HSIIMB10
HSIIMB40
          UNPACK    ST1,KEY12,SINANAT
          UNPACK    KEY12,SIIMCST,SIIMCAT
          PACK      KEY17,SINANAT,SIIMCAT
          CALL      RDSIIM1 
          CALL      RDSINA2 
          CALL      RPIM0000
          BRANCH    OVRCD,HSIIMB85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          PACK      KEY17,SINANAT,SIIMCAT,SP70                                  
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMB08
HSIIMB45
          CALL      RKIM0000
          BRANCH    OVRCD,HSIIMB85
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          PACK      KEY17,SINANAT,SIIMCAT,SP70                                  
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          PACK      KEY17,Z70
          CALL      RSSINA2 
HSIIMB46  CALL      RPIM0000
          BRANCH    OVRCD,HSIIMB47
          PACK      KEY12,SIIMCST,SIIMCAT,SP70                                  
          PACK      KEY17,SINANAT,SIIMCAT,SP70                                  
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIIMB46 IF NOT EQUAL
HSIIMB47
          MOVE      ZERO,XITEMNO
          GOTO      HSIIMB10
HSIIMB50  COMPARE   ZERO,CSEARCH
          GOTO      HSIIMB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMB08
HSIIMB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIIMB08
HSIIMB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIIMB61 IF EQUAL
          MATCH     SCHFLD01,SIIMCAT 
          GOTO      HSIIMB72 IF NOT EQUAL
HSIIMB61
          MATCH     SP70,SCHFLD02
          GOTO      HSIIMB62 IF EQUAL
          MATCH     SCHFLD02,SIIADES 
          GOTO      HSIIMB72 IF NOT EQUAL
HSIIMB62
HSIIMB63
HSIIMB64
HSIIMB65
HSIIMB66
HSIIMB67
HSIIMB68
HSIIMB69
HSIIMB70
          GOTO      HSIIMB75
HSIIMB72  MOVE      ONE,OVRCD
HSIIMB75  RETURN
HSIIMB85
          LOAD      KEY22,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY22,KEY12,SINANAT                                         
          UNPACK    KEY12,SIIMCST,SIIMCAT                                       
          PACK      KEY17,SINANAT,SIIMCAT                                       
          CALL      RDIM0000
HSIIMB90
          UNPACK    SAVKEY80,SIIMCST,SIIMCAT,SINANAT
          BEEP
          GOTO      HSIIMB20
HSIIMB91
          MOVE      SP70,SIIMSEQ 
          MOVE      ZERO,SIIMMAX 
          MOVE      ZERO,SIIMREQ 
          MOVE      ZERO,SIIMQOH 
          MOVE      SP70,SIIMUR1 
          MOVE      SP70,SIIMUR2 
          MOVE      SP70,SIIMUD1 
          MOVE      SP70,SIIMUD2 
          MOVE      SP70,SIIMUC1 
          MOVE      SP70,SIIMUC2 
          MOVE      SP70,SIIMUY1 
          MOVE      SP70,SIIMUY2 
          MOVE      SP70,SIIMWAR 
          MOVE      SP70,SIIMSPA 
          MOVE      SP70,KEY12
          MOVE      SP70,SIIMCAT 
          GOTO      HSIIMB96
HSIIMB92
          MOVE      SP70,KEY12
          MOVE      SP70,SIIMCAT 
          LOAD      KEY22,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY22,KEY12,SINANAT                                         
          UNPACK    KEY12,SIIMCST,SIIMCAT                                       
          PACK      KEY17,SINANAT,SIIMCAT
HSIIMB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIIMB99
          RETURN
.
ESIIMA00
          MOVE      SP70,SIIADES
          PACK      KEY7,SIIMCAT,SP70
          CALL      RDSIIA1
          RETURN
.---------------------------------------------------------------
. Special Positional Read
.---------------------------------------------------------------
RSIM0000  CALL      RSSINA2
RSIM1000  CALL      RKSINA2
          BRANCH    OVRCD,RSIM9999
.
          MOVE      SAVKEY80,KEY5
          PACK      KEY12,KEY5,SINACAT,SP70
          CALL      RDSIIM1
          BRANCH    OVRCD,RSIM1000
.
          MATCH     SP70,DEFLTWH
          IF        !@EQUAL
            PACK      KEY12,SINACAT,DEFLTWH
            CALL      RDSIIE1
            BRANCH    OVRCD,RSIM1000
          ENDIF
          CALL      RPSINA2
.
RSIM9999  RETURN
.---------------------------------------------------------------
. Special Read
.---------------------------------------------------------------
RDIM0000  CALL      RDSINA2
          BRANCH    OVRCD,RDIM9999
.
          CALL      RDSIIM1
          BRANCH    OVRCD,RDIM9999
.
          MATCH     SINACAT,SIIMCAT
          IF        !@EQUAL 
            MOVE      ONE,OVRCD
          ENDIF
.
RDIM9999  RETURN
.---------------------------------------------------------------
. Special Read Forward
.---------------------------------------------------------------
RKIM0000  CALL      RKSINA2
          BRANCH    OVRCD,RKIM9999
.
          MOVE      SAVKEY80,KEY5
          PACK      KEY12,KEY5,SINACAT,SP70                                  
          CALL      RDSIIM1
          BRANCH    OVRCD,RKIM0000
.
          MATCH     SP70,DEFLTWH
          IF        !@EQUAL
            PACK      KEY12,SINACAT,DEFLTWH
            CALL      RDSIIE1
            BRANCH    OVRCD,RKIM0000
          ENDIF
.
RKIM9999  RETURN
.---------------------------------------------------------------
. Special Read Backward
.---------------------------------------------------------------
RPIM0000  CALL      RPSINA2
          BRANCH    OVRCD,RPIM9999
.
          MATCH     SINANAT,SP70
          IF        @EQUAL
            MOVE      ONE,OVRCD
            GOTO      RPIM9999
          ENDIF
.
          MOVE      SAVKEY80,KEY5
          PACK      KEY12,KEY5,SINACAT,SP70                                  
          CALL      RDSIIM1
          BRANCH    OVRCD,RPIM0000
.
          MATCH     SP70,DEFLTWH
          IF        !@EQUAL
            PACK      KEY12,SINACAT,DEFLTWH
            CALL      RDSIIE1
            BRANCH    OVRCD,RPIM0000
          ENDIF
.
RPIM9999  RETURN
