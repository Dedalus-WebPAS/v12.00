. *----------------------------------------------------------------------
. *
. * Function      :   CGI functions for EMROCIFD - emrociaf.dat
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.09.00  29/11/2016  Ebon Clements     TSK 0814745
.             Created include               
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for other clinical information
.------------------------------------------------------------------------
CPEMOC00  MOVE      Z70,EMOCI001
          MOVE      Z70,EMOCI002
          MOVE      Z70,EMOCI003
          MOVE      Z70,EMOCI004
          MOVE      Z70,EMOCI005
          MOVE      Z70,EMOCI006
          MOVE      Z70,EMOCI007
          MOVE      Z70,EMOCI008
          MOVE      Z70,EMOCI009
          MOVE      Z70,EMOCI010
          MOVE      Z70,EMOCI011
          MOVE      Z70,EMOCI012
          MOVE      Z70,EMOCI013
.
CPEMOC99  RETURN
.
.------------------------------------------------------------
. Tags for other clinical information                
.------------------------------------------------------------
EMOC0000  BRANCH    FLDITMNO,EMOC0010,EMOC0020,EMOC0030,EMOC0040,EMOC0050:
                             EMOC0060,EMOC0070,EMOC0080,EMOC0090,EMOC0100:
                             EMOC0110,EMOC0120,EMOC0130,EMOC0140,EMOC0150:
                             EMOC0160,EMOC0170,EMOC0180,EMOC0190
                            
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMOC9999
.
EMOC0010  WRITE     HTMLFILE;EMOCVISN;
          GOTO      EMOC9999
.
EMOC0020  WRITE     HTMLFILE;EMOCCNTR;
          GOTO      EMOC9999
.
EMOC0030  MOVE      "ty",CATEGORY
          MOVE      EMOCTYPE,CODE
          CALL      CODITM00
          GOTO      EMOC9999
.
EMOC0040  WRITE     HTMLFILE;EMOCORDR;
          GOTO      EMOC9999
.
EMOC0050  MATCH     EMOCCTOD,SP70
          GOTO      EMOC9999 IF EQUAL
.
          UNPACK    EMOCCTOD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMOC9999
.
EMOC0060  WRITE     HTMLFILE;EMOCCTOT;
          GOTO      EMOC9999
.
EMOC0070  WRITE     HTMLFILE;EMOCPRET;
          GOTO      EMOC9999
.
EMOC0080  MATCH     EMOCCTRD,SP70
          GOTO      EMOC9999 IF EQUAL
.
          UNPACK    EMOCCTRD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMOC9999
.
EMOC0090  WRITE     HTMLFILE;EMOCCTRT;
          GOTO      EMOC9999
.
EMOC0100  WRITE     HTMLFILE;EMOCRSFL;
          GOTO      EMOC9999
.
EMOC0110  MATCH     EMOCCTSD,SP70
          GOTO      EMOC9999 IF EQUAL
.
          UNPACK    EMOCCTSD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMOC9999
.
EMOC0120  WRITE     HTMLFILE;EMOCCTST;
          GOTO      EMOC9999
.
EMOC0130  MOVE      "PQ",CATEGORY
          MOVE      EMOCPCCD,CODE
          CALL      CODITM00
          GOTO      EMOC9999
.
EMOC0140  MATCH     SP70,EMOCCUID
          GOTO      EMOC9999 IF EQUAL
.
          PACK      KEY10,EMOCCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMOCCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMOC9999
.
EMOC0150  MATCH     EMOCCDAT,SP70
          GOTO      EMOC9999 IF EQUAL
.
          UNPACK    EMOCCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMOC9999
.
EMOC0160  WRITE     HTMLFILE;EMOCCTIM;
          GOTO      EMOC9999
.
EMOC0170  MATCH     SP70,EMOCUUID
          GOTO      EMOC9999 IF EQUAL
.
          PACK      KEY10,EMOCUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMOCUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMOC9999
.
EMOC0180  MATCH     EMOCUTIM,SP70
          GOTO      EMOC9999 IF EQUAL
.
          UNPACK    EMOCUTIM,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMOC9999
.
EMOC0190  WRITE     HTMLFILE;EMOCUTIM;
          GOTO      EMOC9999
.
EMOC9999  RETURN
.
.------------------------------------------------------------
. Set Parameters for other clinical information 
.------------------------------------------------------------
SPEMC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMC001,SPEMC002,SPEMC003,SPEMC004,SPEMC005:
                       SPEMC006,SPEMC007,SPEMC008,SPEMC009,SPEMC010:
                       SPEMC011,SPEMC012,SPEMC013
.
          MOVE      ONE,EXIT
          GOTO      SPEMC999
.
SPEMC001  PACK      EMOCI001,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC002  PACK      EMOCI002,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC003  PACK      EMOCI003,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC004  PACK      EMOCI004,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC005  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      EMOCI005,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMC999
.
SPEMC006  PACK      EMOCI006,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC007  PACK      EMOCI007,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC008  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      EMOCI008,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMC999
.
SPEMC009  PACK      EMOCI009,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC010  PACK      EMOCI010,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC011  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      EMOCI011,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMC999
.
SPEMC012  PACK      EMOCI012,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC013  PACK      EMOCI013,QRYDATA,SP70
          GOTO      SPEMC999
.
SPEMC999  RETURN
.
.------------------------------------------------------------
.  Update for other clinical information file vars
.------------------------------------------------------------
MVEMOC00  MATCH     EMOCI001,Z70
          IF        !@EQUAL
            MOVE      EMOCI001,EMOCVISN
          ENDIF
.
          MATCH     EMOCI002,Z70
          IF        !@EQUAL
            MOVE      EMOCI002,EMOCCNTR
          ENDIF
.
          MATCH     EMOCI003,Z70
          IF        !@EQUAL
            MOVE      EMOCI003,EMOCTYPE
          ENDIF
.
          MATCH     EMOCI004,Z70
          IF        !@EQUAL
            MOVE      EMOCI004,EMOCORDR
          ENDIF
.
          MATCH     EMOCI005,Z70
          IF        !@EQUAL
            MOVE      EMOCI005,EMOCCTOD
          ENDIF
.
          MATCH     EMOCI006,Z70
          IF        !@EQUAL
            MOVE      EMOCI006,EMOCCTOT
          ENDIF
.
          MATCH     EMOCI007,Z70
          IF        !@EQUAL
            MOVE      EMOCI007,EMOCPRET
          ENDIF
.
          MATCH     EMOCI008,Z70
          IF        !@EQUAL
            MOVE      EMOCI008,EMOCCTRD
          ENDIF
.
          MATCH     EMOCI009,Z70
          IF        !@EQUAL
            MOVE      EMOCI009,EMOCCTRT
          ENDIF
.
          MATCH     EMOCI010,Z70
          IF        !@EQUAL
            MOVE      EMOCI010,EMOCRSFL
          ENDIF
.
          MATCH     EMOCI011,Z70
          IF        !@EQUAL
            MOVE      EMOCI011,EMOCCTSD
          ENDIF
.
          MATCH     EMOCI012,Z70
          IF        !@EQUAL
            MOVE      EMOCI012,EMOCCTST
          ENDIF
.
          MATCH     EMOCI013,Z70
          IF        !@EQUAL
            MOVE      EMOCI013,EMOCPCCD
          ENDIF
.
MVEMOC99  RETURN

