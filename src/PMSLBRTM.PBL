. *----------------------------------------------------------------------
. * Include Name  :   PMSLBRTM.PBL
. *
. * Function      :   CGI variables for PMSLBRFD - pmslbraf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.00.00  19/07/2010  Jill Parkinson CAR 222551
.             Created include
.------------------------------------------------------------------------
.   Clear Parameters for labour details table
.------------------------------------------------------------------------
.         
CPPMLB00  MOVE      Z70,PMLBR001
          MOVE      Z70,PMLBR002
          MOVE      Z70,PMLBR003
          MOVE      Z70,PMLBR004
          MOVE      Z70,PMLBR005
          MOVE      Z70,PMLBR006
          MOVE      Z70,PMLBR007
          MOVE      Z70,PMLBR008
          MOVE      Z70,PMLBR009
          MOVE      Z70,PMLBR010
          MOVE      Z70,PMLBR011
          MOVE      Z70,PMLBR012
          MOVE      Z70,PMLBR013
          MOVE      Z70,PMLBR014
          MOVE      Z70,PMLBR015
          MOVE      Z70,PMLBR016
          MOVE      Z70,PMLBR017
          MOVE      Z70,PMLBR018
          MOVE      Z70,PMLBR019
          MOVE      Z70,PMLBR020
          MOVE      Z70,PMLBR021
          MOVE      Z70,PMLBR022
          MOVE      Z70,PMLBR023
          MOVE      Z70,PMLBR024
          MOVE      Z70,PMLBR025
          MOVE      Z70,PMLBR026
          MOVE      Z70,PMLBR027
          MOVE      Z70,PMLBR028
          MOVE      Z70,PMLBR029
          MOVE      Z70,PMLBR030
          MOVE      Z70,PMLBR031
          MOVE      Z70,PMLBR032
          MOVE      Z70,PMLBR033
          MOVE      Z70,PMLBR034
          MOVE      Z70,PMLBR035
          MOVE      Z70,PMLBR036
          MOVE      Z70,PMLBR037
          MOVE      Z70,PMLBR038
          MOVE      Z70,PMLBR039
          MOVE      Z70,PMLBR040
.
CPPMLB99  RETURN
+
.------------------------------------------------------------------------
.   Clear file variables for labour details table
.------------------------------------------------------------------------
CLPMLB00  MOVE      SP70,PMLBUNIQ  * Pregnancy Unique Id
          MOVE      SP70,PMLBADMN  * Admission Number
          MOVE      SP70,PMLBCNTR  * Counter
          MOVE      SP70,PMLBAUDC  * Audit Counter
          MOVE      SP70,PMLBONSL  * Onset of Labour (Cat LH)
          MOVE      SP70,PMLBDATL  * Date of onset (CCYYMMDD)
          MOVE      SP70,PMLBTIML  * Time of onset (hh:mm:ss)
          MOVE      SP70,PMLBMIN1  * Minutes of 1st Stage of Labour
          MOVE      SP70,PMLBDAT2  * Date of 2nd Stage (CCYYMMDD)
          MOVE      SP70,PMLBTIM2  * Time of 2nd Stage (hh:mm:ss)
          MOVE      SP70,PMLBMIN2  * Minutes of 2nd Stage Labour
          MOVE      SP70,PMLBDATR  * Date of Rupture of Membranes
          MOVE      SP70,PMLBINDI  * Indication of Induction (ICD code)
          MOVE      SP70,PMLBINDF  * Ind of Induction Free Format
          MOVE      SP70,PMLBINDO  * Ind of Operative Delivery (ICD code
          MOVE      SP70,PMLBINOF  * Ind of Operative Free Format
          MOVE      SP70,PMLBANLG  * Analgesia for Labour Ind (Cat LJ)
          MOVE      SP70,PMLBPOSD  * Position of Delivery (Cat LK)
          MOVE      SP70,PMLBCOLL  * Colour of Liquor (Cat LM)
          MOVE      SP70,PMLBPRES  * Presentation (Cat LV)
          MOVE      SP70,PMLBMEMB  * Membranes (Cat LX)
          MOVE      SP70,PMLBNVES  * Number of Cord Vessels
          MOVE      SP70,PMLBTYPB  * Type of Birth (Cat LZ)
          MOVE      SP70,PMLBPROP  * Prophylactice Oxytocin 3rd (Cat ma)
          MOVE      SP70,PMLBMAN3  * Management of 3rd Stage (Cat mb)
          MOVE      SP70,PMLBPLAC  * Placenta (Cat mc)
          MOVE      SP70,PMLBMPLA  * Manual Removal of Placenta (Cat md)
          MOVE      SP70,PMLBEPIS  * Episotomy Indicator (Cat me)
          MOVE      SP70,PMLBPERI  * Perineal Laceration Ind (Cat mf)
          MOVE      SP70,PMLBPERT  * Perineal Degree/Type (Cat mg)
          MOVE      SP70,PMLBPERR  * Perineal Repair (Cat mh)
          MOVE      SP70,PMLBBLDL  * Estimated Blood Loss (mls)
          MOVE      SP70,PMLBBLTR  * Blood Product Transfusion (Cat mi)
          MOVE      SP70,PMLBDLIC  * Disc of Lead Intrapartum Carer (MJ)
          MOVE      SP70,PMLBDMID  * Delivery Midwife (pmshcpaf)
          MOVE      SP70,PMLBDDOC  * Delivery Doctor (pmshcpaf)
          MOVE      SP70,PMLBDANA  * Delivery Anaesthetist (pmshcpaf)
          MOVE      SP70,PMLBNUMB  * Number of babies this birth
          MOVE      SP70,PMLBMIDR  * Midwife at Discharge (pmshcpaf)
          MOVE      SP70,PMLBWEBC  * Web User Id created (websecaf)
          MOVE      SP70,PMLBDATC  * Date Created (CCYYMMDD)
          MOVE      SP70,PMLBTIMC  * Time Created (hh:mm:ss)
          MOVE      SP70,PMLBWEBU  * Web User Id Updated (websecaf)
          MOVE      SP70,PMLBDATU  * Date Updated (CCYYMMDD)
          MOVE      SP70,PMLBTIMU  * Time Updated (hh:mm:ss)
          MOVE      SP70,PMLBRECS  * Record status 1=Deleted
          MOVE      SP70,PMLBWEBD  * Web User Id Deleted (websecaf)
          MOVE      SP70,PMLBDATD  * Date Deleted (CCYYMMDD)
          MOVE      SP70,PMLBTIMD  * Time Deleted (hh:mm:ss)
          MOVE      SP70,PMLBREAS  * Reason for Change (FY)
          MOVE      SP70,PMLBSPAR  * Spare
.
CLPMLB99  RETURN
+
.------------------------------------------------------------
. Output labour details
.------------------------------------------------------------
PMLB0000  BRANCH    FLDITMNO,PMLB0010,PMLB0020,PMLB0030,PMLB0040,PMLB0050:
                             PMLB0060,PMLB0070,PMLB0080,PMLB0090,PMLB0100:
                             PMLB0110,PMLB0120,PMLB0130,PMLB0140,PMLB0150:
                             PMLB0160,PMLB0170,PMLB0180,PMLB0190,PMLB0200:
                             PMLB0210,PMLB0220,PMLB0230,PMLB0240,PMLB0250:
                             PMLB0260,PMLB0270,PMLB0280,PMLB0290,PMLB0300:
                             PMLB0310,PMLB0320,PMLB0330,PMLB0340,PMLB0350:
                             PMLB0360,PMLB0370,PMLB0380,PMLB0390,PMLB0400:
                             PMLB0410,PMLB0420,PMLB0430,PMLB0440,PMLB0450:
                             PMLB0460,PMLB0470,PMLB0480,PMLB0490,PMLB0500:
                             PMLB0510,PMLB0520,PMLB0530,PMLB0540
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMLB9999
.
PMLB0010  WRITE     HTMLFILE;PMLBUNIQ;      * Pregnancy Unique Id
          GOTO      PMLB9999
.
PMLB0020  WRITE     HTMLFILE;PMLBADMN;      * Admission Number
          GOTO      PMLB9999
.
PMLB0030  MOVE      "LH",CATEGORY           * Onset of Labour
          MOVE      PMLBONSL,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0040  MATCH     PMLBDATL,SP70           * Date of onset of labour
          GOTO      PMLB9999 IF EQUAL
          UNPACK    PMLBDATL,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMLB9999
.
PMLB0050  WRITE     HTMLFILE;PMLBTIML;      * Onset Time 
          GOTO      PMLB9999
.
PMLB0060  WRITE     HTMLFILE;PMLBMIN1;      * Minutes of 1st stage
          GOTO      PMLB9999
.
PMLB0070  MATCH     PMLBDAT2,SP70           * Date of stage 2 onset of labour
          GOTO      PMLB9999 IF EQUAL
          UNPACK    PMLBDAT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMLB9999
.
PMLB0080  WRITE     HTMLFILE;PMLBTIM2;      * Onset Time
          GOTO      PMLB9999
.
PMLB0090  WRITE     HTMLFILE;PMLBMIN2;      * Minutes of 2nd stage
          GOTO      PMLB9999
.
PMLB0100  MATCH     PMLBDATR,SP70           * Date of rupture of membranes
          GOTO      PMLB9999 IF EQUAL
          UNPACK    PMLBDATR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMLB9999
.
PMLB0110  WRITE     HTMLFILE;PMLBINDI;      * Induction ICD Code
          GOTO      PMLB9999
.
PMLB0120  WRITE     HTMLFILE;PMLBINDF;      * Induction Free Format
          GOTO      PMLB9999
.
PMLB0130  WRITE     HTMLFILE;PMLBINDO;      * Operative ICD Code
          GOTO      PMLB9999
.
PMLB0140  WRITE     HTMLFILE;PMLBINOF;      * Operative Free Format
          GOTO      PMLB9999
.
PMLB0150  MOVE      "LJ",CATEGORY           * Analgesia for Labour (LJ)
          MOVE      PMLBANLG,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0160  MOVE      "LK",CATEGORY           * Position of Delivery (LK)
          MOVE      PMLBPOSD,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0170  MOVE      "LM",CATEGORY           * Colour of Liquor     (LM)
          MOVE      PMLBCOLL,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0180  MOVE      "LV",CATEGORY           * Presentation (LV)
          MOVE      PMLBPRES,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0190  MOVE      "LX",CATEGORY           * Membranes (LX)
          MOVE      PMLBMEMB,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0200  WRITE     HTMLFILE;PMLBNVES;      * Number of cord vessels
          GOTO      PMLB9999
.
PMLB0210  MOVE      "LZ",CATEGORY           * Type of Birth (LZ)
          MOVE      PMLBTYPB,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0220  MOVE      "ma",CATEGORY           * Prophylactic Oxytocin (ma)
          MOVE      PMLBPROP,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0230  MOVE      "mb",CATEGORY           * Management of 3rd Stage(mb)
          MOVE      PMLBMAN3,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0240  MOVE      "mc",CATEGORY           * Placenta(mc)
          MOVE      PMLBPLAC,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0250  MOVE      "md",CATEGORY           * Manual removal of Placenta(md)
          MOVE      PMLBMPLA,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0260  MOVE      "me",CATEGORY           * Episotomy(me)
          MOVE      PMLBEPIS,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0270  MOVE      "mf",CATEGORY           * Perineal Laceration (mf)
          MOVE      PMLBPERI,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0280  MOVE      "mg",CATEGORY           * Perineal Degree/Type (mg)
          MOVE      PMLBPERT,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0290  MOVE      "mh",CATEGORY           * Perineal Repair (mh)
          MOVE      PMLBPERR,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0300  WRITE     HTMLFILE;PMLBBLDL;      * Est Blood Loss (mls)
          GOTO      PMLB9999
.
PMLB0310  MOVE      "mi",CATEGORY           * Blood Product (mi)
          MOVE      PMLBBLTR,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0320  MOVE      "mj",CATEGORY           * Disc of lead (mj)
          MOVE      PMLBDLIC,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0330  MOVE      PMLBDMID,GENPCODE      * Delivery Midwife
          CALL      HCPDET00
          GOTO      PMLB9999
.
PMLB0340  MOVE      PMLBDDOC,GENPCODE      * Delivery Doctor 
          CALL      HCPDET00
          GOTO      PMLB9999
.
PMLB0350  MOVE      PMLBDANA,GENPCODE      * Delivery Anaesthetist
          CALL      HCPDET00
          GOTO      PMLB9999
.
PMLB0360  WRITE     HTMLFILE;PMLBNUMB;      * Number of Babies this birth
          GOTO      PMLB9999
.
PMLB0370  MOVE      PMLBMIDR,GENPCODE      * Discharge Midwife
          CALL      HCPDET00
          GOTO      PMLB9999
.
PMLB0380  WRITE     HTMLFILE;PMLBCNTR;      * Counter
          GOTO      PMLB9999
.
PMLB0390  PACK      KEY10,PMLBWEBC,SP70
          CALL      RDWBSE1
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMLB9999
.
PMLB0400  MATCH     PMLBDATC,SP70
          GOTO      PMLB9999 IF EQUAL
          UNPACK    PMLBDATC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMLB9999
.
PMLB0410  WRITE     HTMLFILE;PMLBTIMC;
          GOTO      PMLB9999
.
PMLB0420  PACK      KEY10,PMLBWEBU,SP70
          CALL      RDWBSE1
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMLB9999
.
PMLB0430  MATCH     PMLBDATU,SP70
          GOTO      PMLB9999 IF EQUAL
          UNPACK    PMLBDATU,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMLB9999
.
PMLB0440  WRITE     HTMLFILE;PMLBTIMU;
          GOTO      PMLB9999
.
PMLB0450  WRITE     HTMLFILE;PMLBRECS;
          GOTO      PMLB9999
.
PMLB0460  PACK      KEY10,PMLBWEBD,SP70
          CALL      RDWBSE1
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMLB9999
.
PMLB0470  MATCH     PMLBDATD,SP70
          GOTO      PMLB9999 IF EQUAL
          UNPACK    PMLBDATD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMLB9999
.
PMLB0480  WRITE     HTMLFILE;PMLBTIMD;
          GOTO      PMLB9999
.
PMLB0490  CALL      LBRLS000
          GOTO      PMLB9999
.
PMLB0500  WRITE     HTMLFILE;PMLBCNTR;
          GOTO      PMLB9999
.
PMLB0510  WRITE     HTMLFILE;PMLBAUDC;      * Audit Counter
          GOTO      PMLB9999
.
PMLB0520  CALL      LBRA0000                * Audit List
          GOTO      PMLB9999
.
PMLB0530  MOVE      "FY",CATEGORY           * Reason for Change (FY)
          MOVE      PMLBREAS,CODE
          CALL      CODITM00
          GOTO      PMLB9999
.
PMLB0540  PACK      KEY10,PREGUNIQ,SP70
          CALL      RDPMINC1
          IF        OVRCD=1
            WRITE     HTMLFILE;ZERO;        * complete
          ELSE
            WRITE     HTMLFILE;ONE;         * incomplete
          ENDIF
          GOTO      PMLB9999
.
PMLB9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Labour Details table
.------------------------------------------------------------
SPMLB000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMLB001,SPMLB002,SPMLB003,SPMLB004,SPMLB005:
                       SPMLB006,SPMLB007,SPMLB008,SPMLB009,SPMLB010:
                       SPMLB011,SPMLB012,SPMLB013,SPMLB014,SPMLB015:
                       SPMLB016,SPMLB017,SPMLB018,SPMLB019,SPMLB020:
                       SPMLB021,SPMLB022,SPMLB023,SPMLB024,SPMLB025:
                       SPMLB026,SPMLB027,SPMLB028,SPMLB029,SPMLB030:
                       SPMLB031,SPMLB032,SPMLB033,SPMLB034,SPMLB035:
                       SPMLB036,SPMLB037,SPMLB038,SPMLB039,SPMLB040
.
          MOVE      ONE,EXIT
          GOTO      SPMLB999
. 
SPMLB001  PACK      PMLBR001,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB002  PACK      PMLBR002,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB003  PACK      PMLBR003,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB004  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMLBR004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMLB999
.
SPMLB005  PACK      PMLBR005,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB006  PACK      PMLBR006,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB007  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMLBR007,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMLB999
.
SPMLB008  PACK      PMLBR008,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB009  PACK      PMLBR009,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB010  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMLBR010,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMLB999
.
SPMLB011  PACK      PMLBR011,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB012  PACK      PMLBR012,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB013  PACK      PMLBR013,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB014  PACK      PMLBR014,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB015  PACK      PMLBR015,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB016  PACK      PMLBR016,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB017  PACK      PMLBR017,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB018  PACK      PMLBR018,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB019  PACK      PMLBR019,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB020  PACK      PMLBR020,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB021  PACK      PMLBR021,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB022  PACK      PMLBR022,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB023  PACK      PMLBR023,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB024  PACK      PMLBR024,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB025  PACK      PMLBR025,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB026  PACK      PMLBR026,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB027  PACK      PMLBR027,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB028  PACK      PMLBR028,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB029  PACK      PMLBR029,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB030  PACK      PMLBR030,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB031  PACK      PMLBR031,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB032  PACK      PMLBR032,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB033  PACK      PMLBR033,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB034  PACK      PMLBR034,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB035  PACK      PMLBR035,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB036  PACK      PMLBR036,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB037  PACK      PMLBR037,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB038  PACK      PMLBR038,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB039  PACK      PMLBR039,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB040  PACK      PMLBR040,QRYDATA,SP70
          GOTO      SPMLB999
.
SPMLB999  RETURN
+
.------------------------------------------------------------
.  Update labour details file
.------------------------------------------------------------
MVPMLB00  MATCH     PMLBR001,Z70
          IF        !@EQUAL
            MOVE      PMLBR001,PMLBUNIQ
          ENDIF
.
          MATCH     PMLBR002,Z70
          IF        !@EQUAL
            MOVE      PMLBR002,PMLBADMN
          ENDIF
.
          MATCH     PMLBR003,Z70
          IF        !@EQUAL
            MOVE      PMLBR003,PMLBONSL
          ENDIF
.
          MATCH     PMLBR004,Z70
          IF        !@EQUAL
            MOVE      PMLBR004,PMLBDATL
          ENDIF
.
          MATCH     PMLBR005,Z70
          IF        !@EQUAL
            MOVE      PMLBR005,PMLBTIML
          ENDIF
.
          MATCH     PMLBR006,Z70
          IF        !@EQUAL
            MOVE      PMLBR006,PMLBMIN1
          ENDIF
.
          MATCH     PMLBR007,Z70
          IF        !@EQUAL
            MOVE      PMLBR007,PMLBDAT2
          ENDIF
.
          MATCH     PMLBR008,Z70
          IF        !@EQUAL
            MOVE      PMLBR008,PMLBTIM2
          ENDIF
.
          MATCH     PMLBR009,Z70
          IF        !@EQUAL
            MOVE      PMLBR009,PMLBMIN2
          ENDIF
.
          MATCH     PMLBR010,Z70
          IF        !@EQUAL
            MOVE      PMLBR010,PMLBDATR
          ENDIF
.
          MATCH     PMLBR011,Z70
          IF        !@EQUAL
            MOVE      PMLBR011,PMLBINDI
          ENDIF
.
          MATCH     PMLBR012,Z70
          IF        !@EQUAL
            MOVE      PMLBR012,PMLBINDF
          ENDIF
.
          MATCH     PMLBR013,Z70
          IF        !@EQUAL
            MOVE      PMLBR013,PMLBINDO
          ENDIF
.
          MATCH     PMLBR014,Z70
          IF        !@EQUAL
            MOVE      PMLBR014,PMLBINOF
          ENDIF
.
          MATCH     PMLBR015,Z70
          IF        !@EQUAL
            MOVE      PMLBR015,PMLBANLG
          ENDIF
.
          MATCH     PMLBR016,Z70
          IF        !@EQUAL
            MOVE      PMLBR016,PMLBPOSD
          ENDIF
.
          MATCH     PMLBR017,Z70
          IF        !@EQUAL
            MOVE      PMLBR017,PMLBCOLL
          ENDIF
.
          MATCH     PMLBR018,Z70
          IF        !@EQUAL
            MOVE      PMLBR018,PMLBPRES
          ENDIF
.
          MATCH     PMLBR019,Z70
          IF        !@EQUAL
            MOVE      PMLBR019,PMLBMEMB
          ENDIF
.
          MATCH     PMLBR020,Z70
          IF        !@EQUAL
            MOVE      PMLBR020,PMLBNVES
          ENDIF
.
          MATCH     PMLBR021,Z70
          IF        !@EQUAL
            MOVE      PMLBR021,PMLBTYPB
          ENDIF
.
          MATCH     PMLBR022,Z70
          IF        !@EQUAL
            MOVE      PMLBR022,PMLBPROP
          ENDIF
.
          MATCH     PMLBR023,Z70
          IF        !@EQUAL
            MOVE      PMLBR023,PMLBMAN3
          ENDIF
.
          MATCH     PMLBR024,Z70
          IF        !@EQUAL
            MOVE      PMLBR024,PMLBPLAC
          ENDIF
.
          MATCH     PMLBR025,Z70
          IF        !@EQUAL
            MOVE      PMLBR025,PMLBMPLA
          ENDIF
.
          MATCH     PMLBR026,Z70
          IF        !@EQUAL
            MOVE      PMLBR026,PMLBEPIS
          ENDIF
.
          MATCH     PMLBR027,Z70
          IF        !@EQUAL
            MOVE      PMLBR027,PMLBPERI
          ENDIF
.
          MATCH     PMLBR028,Z70
          IF        !@EQUAL
            MOVE      PMLBR028,PMLBPERT
          ENDIF
.
          MATCH     PMLBR029,Z70
          IF        !@EQUAL
            MOVE      PMLBR029,PMLBPERR
          ENDIF
.
          MATCH     PMLBR030,Z70
          IF        !@EQUAL
            MOVE      PMLBR030,PMLBBLDL
          ENDIF
.
          MATCH     PMLBR031,Z70
          IF        !@EQUAL
            MOVE      PMLBR031,PMLBBLTR
          ENDIF
.
          MATCH     PMLBR032,Z70
          IF        !@EQUAL
            MOVE      PMLBR032,PMLBDLIC
          ENDIF
.
          MATCH     PMLBR033,Z70
          IF        !@EQUAL
            MOVE      PMLBR033,PMLBDMID
          ENDIF
.
          MATCH     PMLBR034,Z70
          IF        !@EQUAL
            MOVE      PMLBR034,PMLBDDOC
          ENDIF
.
          MATCH     PMLBR035,Z70
          IF        !@EQUAL
            MOVE      PMLBR035,PMLBDANA
          ENDIF
.
          MATCH     PMLBR036,Z70
          IF        !@EQUAL
            MOVE      PMLBR036,PMLBNUMB
          ENDIF
.
          MATCH     PMLBR037,Z70
          IF        !@EQUAL
            MOVE      PMLBR037,PMLBMIDR
          ENDIF
.
          MATCH     PMLBR038,Z70
          IF        !@EQUAL
            MOVE      PMLBR038,PMLBCNTR
          ENDIF
.
          MATCH     PMLBR039,Z70
          IF        !@EQUAL
            MOVE      PMLBR039,PMLBAUDC
          ENDIF
.
          MATCH     PMLBR040,Z70
          IF        !@EQUAL
            MOVE      PMLBR040,PMLBREAS
          ENDIF
.
MVPMLB99  RETURN
+
.------------------------------------------------------------
.   List of labour detail records
.------------------------------------------------------------
LBRLS000  MOVE      ZERO, SAVECNTR
          PACK      KEY24,PREGUNIQ,Z70
          CALL      RSPMLBR1
LBRLS100  CALL      RPPMLBR1
          BRANCH    OVRCD,LBRLS999
.
          MATCH     PREGUNIQ,PMLBUNIQ
          GOTO      LBRLS999 IF NOT EQUAL
.
          MATCH     SAVECNTR,PMLBCNTR
          GOTO      LBRLS100 IF EQUAL
.
LBRLS200  PACK      SAVECNTR,PMLBCNTR
          CLEAR     HTMLLINK
          APPEND    "javascript:ViewDetails('",HTMLLINK
          APPEND    PMLBUNIQ,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMLBADMN,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMLBCNTR,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMLBAUDC,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
          CLEAR     HTMLLNK2
          APPEND    "javascript:AuditDetails('",HTMLLNK2
          APPEND    PMLBUNIQ,HTMLLNK2
          APPEND    "','",HTMLLNK2
          APPEND    PMLBADMN,HTMLLNK2
          APPEND    "','",HTMLLNK2
          APPEND    PMLBCNTR,HTMLLNK2
          APPEND    "','",HTMLLNK2
          APPEND    PMLBAUDC,HTMLLNK2
          APPEND    "')",HTMLLNK2
          RESET     HTMLLNK2
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",PMLBUNIQ,"#",":
                             "#"",PMLBADMN,"#",":
                             "#"",PMLBCNTR,"#",":
                             "#"",PMLBONSL,"#",":
                             "#"",PMLBDATL,"#",":
                             "#"",PMLBTIML,"#",":
                             "#"",HTMLLNK2,"#");"
.
          GOTO      LBRLS100
.
LBRLS999  RETURN
+
.------------------------------------------------------------
.   List of Audit records on pmslbraf
.------------------------------------------------------------
LBRA0000  MATCH     SP70,PREGUNIQ
          GOTO      LBRA9999 IF EQUAL
.
          PACK      KEY24,PREGUNIQ,Z70
          CALL      RSPMLBR1
LBRA0100  CALL      RPPMLBR1
          BRANCH    OVRCD,LBRA9999
.
          MATCH     PREGUNIQ,PMLBUNIQ
          GOTO      LBRA9999 IF NOT EQUAL
.
          PACK      CURRUNIQ,PMLBUNIQ
          CLEAR     HTMLLINK
          APPEND    "javascript:ViewDetails('",HTMLLINK
          APPEND    PMLBUNIQ,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMLBADMN,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMLBCNTR,HTMLLINK
          APPEND    "','",HTMLLINK
          APPEND    PMLBAUDC,HTMLLINK
          APPEND    "')",HTMLLINK
          RESET     HTMLLINK
          WRITE     HTMLFILE;"t.addRow(#"",HTMLLINK,"#",":
                             "#"",PMLBUNIQ,"#",":
                             "#"",PMLBADMN,"#",":
                             "#"",PMLBCNTR,"#",":
                             "#"",PMLBONSL,"#",":
                             "#"",PMLBDATL,"#",":
                             "#"",PMLBTIML,"#");"
.
          GOTO      LBRA0100
.
LBRA9999  RETURN
+

