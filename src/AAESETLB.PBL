.******************************************************************************
.*                                                                            *
.*   AAESETLB.PBL - Set up variables for Labels                               *
.*                                                                            *
.*   Modifications:                                                           *
.*       V10.12.01  19/01/2018  Richa Phogat     CAR 0825792                  *
.*                  Modified ASLB4000 to read pmshcpaf if EMCNURSE = 1        *
.******************************************************************************
.*       V10.06.02  10/09/2015  Steve Armstrong  CAR 315321                   *
.*                  Mods to remove Marital Status and Religion fields from    *
.*                  STV PMI labels.                                           *
.*       V10.06.01  15/07/2015  Steve Armstrong  CAR 315999                   *
.*                  Mods to handle printing of Wrist Band labels (Screen "03")*
.*                  for STV Layout (25).                                      *
.******************************************************************************
.*       V10.05.01  31/07/2014 Steve Armstrong  CAR 294204                    *
.*                  Mods to handle SJOG Geelong barcode labels.               *
.*                  Also replaced HETYPLAB with AECNLABL.                     *
.******************************************************************************
.*       V10.03.02  10/10/2013 Steve Armstrong  CAR 288277                    *
.*                  Mods to add alternate PMI label format for STV Zebra      *
.*                  barcode labels.                                           *
.*       V10.03.01  29/11/2011 Jill Parkinson CAR 249362                      *
.*                  Changed alert key                                         *
.******************************************************************************
.*       V9.04.03   18/08/2005  Peter Vela        CAR 71987                   *
.*                  Changed PLOCDOC to PMPXRHC1 in Hawkes Bay EMR Labels      *
.*       V9.04.02   23/06/2005  Steve Armstrong   CAR 64477                   *
.*                  Mods to add staff full name to Ballarat Triage Label      *
.*                  Also changed printing or presenting complaint to print    *
.*                  2 lines of 30 chars instead of 2 lines of 35 chars.       *
.*                  (WLIN1BHS & WLIN2BHS).                                    *
.*       V9.04.01   12.04.2005 Ebon Clements CAR 58443                        *
.*                  Changed HETYPLAB = 4 to Ballarat from Hong Kong           *
.******************************************************************************
.*       V9.03.02   11/06/2004  Mike Laming   CAR 49016  July 2004 PRS/2      *
.*                  - Add Sex Description routine SEXDSC00 with Code "R" -    *
.*                  "Intersex" added                                          *
.*       V9.03.01   16/02/2003 Jill Habasque                                  *
.*                  Changed HWK layout to use emr variables (instead of aae)  *
.******************************************************************************
.*       V9.02.03   10.06.2002 Bronko sosic                                   *
.*                  Added Secong Address Line for St Vincent's                *
.*       V9.02.02   22.04.2002 B.G.Ackland                                    *
.*                  Added new layout 9, for St Vincent's                      *
.*       V9.02.01   13/08/2001  Tonii                                         *
.*                  Added new layout 9, for St Vincent's                      *
.******************************************************************************
.*       V5.08.02   02/10/2000  Ebon Clements                                 *
.*                  Display date of birth correctly on Emergency label        *
.*       V5.08.01   28/08/2000  Tonii                                         *
.*                  Mods to accept Unknown and Indeterminate for patient sex  *
.*                  description                                               *
.******************************************************************************
.*            V5.07     06/10/98  Jim Stathopoulos                            *
.*                      507 Changes                                           *
.******************************************************************************
.*            V5.01 06/04/89 J.Tan                                            *
.*                  Mods to print Epworth labels.  SRF 5793                   *
.*            V5.02 20/04/89 K.Peak                                           *
.*                  Mods to print Epworth labels.  SRF 100252                 *
.*            V5.03 21/04/89 K.Peak                                           *
.*                  Mods to print Modbury labels.  SRF 4857                   *
.*         V5.01.01 07/08/89  S. O'Gorman                                     *
.*                  Added Labels for NZ                                       *
.*         V5.01.02 11/09/89  S. O'Gorman                                     *
.*                  Added Attending Date to Line 5 of NZ Label                *
.*         V5.01.03 15/03/90  E.Phan  Quote 6650                              *
.*                  Added Southland/New Zealand Label Format                  *
.*         V5.01.04 22/03/90  E.Phan  Quote 6650                              *
.*                  Did actual formatting of Southland/New Zealand Labels.    *
.*                  Note that HOLSIZE is not used in this option.             *
.*         V5.01.05 26/03/90  Steve O'Gorman  SRF 104339                      *
.*                  Checked for EOS on BUMP -1 while formatting PADD1         *
.*         V5.01.06 30/05/90  J.Tan           SRF 105084                      *
.*                  Fixed case notes                                          *
.*        V5.01.07  05/11/1992    Justin Coates  (HONG KONG changes)          *
.*                  Added Label type 4 - Hong Kong                            *
.*        V5.01.08  15/10/1993    Gabrielle     (Hawkes Bay changes)          *
.*                  Added Label type 5 -  Hawkes Bay                          *
.*        V5.01.09  25/05/1994    Rob Leonard   (Taranaki changes)            *
.*                  Added Label type 6 -  Taranaki                            *
.*        V5.01.10  14/06/1994    Rob Leonard   SRF 129259                    *
.*                  Extended surname for Hawkes Bay Label layout              *
.*        V5.01.11  08/07/1994    Rob Leonard   SRF 129741 (QUOTE)            *
.*                  Option for all labels to print age in years, months or    *
.*                  weeks                                                     *
.*        V5.01.12  03/11/1994    Rob Leonard                                 *
.*                  Added Label type 7 - Port Macquarie                       *
.*        V5.01.13  20/01/1994    Whirlpool                                   *
.*                  changed hawkes bay labels to print gp from the master file*
.*        V5.01.14  23/01/1994    Whirlpool                                   *
.*                  chamged hawkes bay labels back - make up your mind !!     *
.*        V5.03.01  27/07/1994   Greg Horvat                                  *
.*                  Added layout 8 - Mersey                                   *
.*        V5.03.02  04/08/1995   ROD              SRF 640501  &  610524       *
.*                  Fix Calc of age when current date                         *
.*                                                                            *
.******************************************************************************
.*                                                                            *
.*   This routine is used setting up labels for the printing routine.         *
.*                                                                            *
.*   Variables required :                                                     *
.*                  AECNLABL - Format of Label to use                         *
.*                  PATMASTF variables                                        *
.*                  AAEDETAF variables                                        *
.*                                                                            *
.******************************************************************************
.*        AAESETLB - Set up values for labels                                 *
.******************************************************************************
.
AAESETLB  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,EIGHTY;*229,PTCNDATE
.
          BRANCH    AECNLABL,LABEL10,LABELWTN,ASLB3000,ASLB4000,ASLB5000:
                             ASLB6000,ASLB7000,ASLB8000,ASLB9000,SJOGG000
.
.-------------------------------------------------------------------------------
.         Modbury
.-------------------------------------------------------------------------------
.           First line of label
.
          MOVE      PSNAME,DIM17
          MOVE      SP3,DCASE
          BRANCH    PCASE,YCASE
          GOTO      NCASE
.
YCASE     MOVE      "*",DCASE
.
NCASE     PACK      WFLINE1,SP30,SP10
          APPEND    DIM17,WFLINE1
          APPEND    SP1,WFLINE1
          APPEND    PTITL,WFLINE1
.
          RESET     WFLINE1,24
          APPEND    PSEX,WFLINE1
          APPEND    " UR:",WFLINE1
          APPEND    EMVIURNO,WFLINE1
          APPEND    DCASE,WFLINE1
          RESET     WFLINE1
.
.          second line of label
.
          UNPACK    SP20,WCDESC,VADESC,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
          PACK      KEY5,CODECL,EMVICOMP
          CALL      RDCODE1
.
          MOVE      ZERO,FORM2
GETCLA4   ADD       ONE,FORM2
          COMPARE   SIX,FORM2
          GOTO      ENDCLMA IF NOT LESS
.
          LOAD      ANS,FORM2,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
.
          CMATCH    "W",ANS
          GOTO      CLWCOA IF EQUAL
          CMATCH    "M",ANS
          GOTO      CLMABA IF EQUAL
.
          GOTO      GETCLA4
.
CLWCOA    MOVE      "WC ",WCDESC
          GOTO      GETCLA4
.
CLMABA    MOVE      " VA",VADESC
          GOTO      GETCLA4
.
ENDCLMA   PACK      WFLINE2,SP30,SP10
.
          CLEAR     WFLINE2
          APPEND    PGNAME,WFLINE2
          RESET     WFLINE2,22
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          PACK      WFLINE3,SP1,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          APPEND    WFLINE3,WFLINE2
          APPEND    VADESC,WFLINE2
          APPEND    WCDESC,WFLINE2
          APPEND    SP20,WFLINE2
          RESET     WFLINE2
.
.         third line of label
.
          PACK      WFLINE3,SP30,SP10
          CLEAR     WFLINE3
          APPEND    PADD1,WFLINE3
          CALL      FINENDF3
          APPEND    SP1,WFLINE3
          APPEND    PADD2,WFLINE3
          CALL      FINENDF3
          APPEND    SP1,WFLINE3
          APPEND    PPOST,WFLINE3
          APPEND    SP10,WFLINE3
          RESET     WFLINE3
.
.         Fourth line of label
.
          PACK      WFLINE4,SP30,SP10
          CLEAR     WFLINE4
          APPEND    ADADOCT,WFLINE4
          APPEND    SP1,WFLINE4
.
          MOVE      ADADOCT,KEY6
          CALL      RDDOCT1
          BRANCH    OVRCD,EWFLINE4
.
          MOVE      DGNAME,ANS
          APPEND    ANS,WFLINE4
          APPEND    DOT,WFLINE4
          APPEND    DSNAME,WFLINE4
.
EWFLINE4  CALL      FINENDF4
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEA,ADACLASS
          CALL      RDCODE1
.
          BRANCH    HESYST,PRVLABL
.
          MOVE      TCINDC1,FORM1
          LOAD      DIM2L,FORM1,ANSHP,ANSPP
.
          APPEND    SP5,WFLINE4
          RESET     WFLINE4,30
          APPEND    " Type:",WFLINE4        *** PATIENT TYPE
          APPEND    DIM2L,WFLINE4
          APPEND    SP10,WFLINE4
          RESET     WFLINE4
.
.          Fifth line of label
.
          PACK      WFLINE5,SP30,SP10
          CLEAR     WFLINE5
          APPEND    "Medi:",WFLINE5
          APPEND    PMEDI,WFLINE5
          APPEND    SP15,WFLINE5
          RESET     WFLINE5,25
          APPEND    "A&E:",WFLINE5
          APPEND    ADANUMB,WFLINE5
          APPEND    SP10,WFLINE5
          RESET     WFLINE5
          RETURN
.
.    private hospitals
.
PRVLABL   APPEND    SP5,WFLINE4
          RESET     WFLINE4,29
          APPEND    " Type:",WFLINE4        *** PATIENT TYPE
          APPEND    ADACLASS,WFLINE4        *** CODE PRINTED
          APPEND    SP10,WFLINE4
          RESET     WFLINE4
.
.          Fifth line of label
.
          UNPACK    ADADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          PACK      WFLINE5,SP30,SP10
          CLEAR     WFLINE5
          APPEND    "Pres: ",WFLINE5
          APPEND    CPCDATE,WFLINE5
          APPEND    " Age: ",WFLINE5
.
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            APPEND    PSAGECON,WFLINE5
            APPEND    PSAGETYP,WFLINE5
          ELSE
            APPEND    PSAGE,WFLINE5
          ENDIF
.
          RESET     WFLINE5,25
          APPEND    "A&E:",WFLINE5
          APPEND    ADANUMB,WFLINE5
          RESET     WFLINE5
          RETURN
.
.         Epworth
.
LABEL10   MOVE      SP3,DCASE
          BRANCH    PCASE,LABEL20
          GOTO      LABEL30
.
LABEL20   MOVE      "*",DCASE
.
LABEL30   PACK      WFLINE1,SP30,SP10
          CLEAR     WFLINE1
          APPEND    PSNAME,WFLINE1
          CALL      FINENDF1
          APPEND    SP1,WFLINE1
          APPEND    PGNAME,WFLINE1
          RESET     WFLINE1,34
          APPEND    PTITL,WFLINE1
          RESET     WFLINE1
.
          PACK      WFLINE2,SP30,SP10
          CLEAR     WFLINE2
          APPEND    "DOB:",WFLINE2
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          PACK      WFLINE3,SP1,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          APPEND    WFLINE3,WFLINE2
          RESET     WFLINE2,18
          APPEND    PSEX,WFLINE2
          RESET     WFLINE2,22
          APPEND    "U/R:",WFLINE2
          APPEND    EMVIURNO,WFLINE2
          APPEND    DCASE,WFLINE2
          RESET     WFLINE2
.
          PACK      WFLINE3,SP30,SP10
          CLEAR     WFLINE3
          APPEND    PADD1,WFLINE3
          RESET     WFLINE3,27
          APPEND    EMVICOMP,WFLINE3
          RESET     WFLINE3,32
          APPEND    ADAUSR1,WFLINE3
          RESET     WFLINE3
.
          PACK      WFLINE4,SP30,SP10
          CLEAR     WFLINE4
          APPEND    PADD2,WFLINE4
          RESET     WFLINE4,27
          APPEND    PREG,WFLINE4
          RESET     WFLINE4
.
          PACK      WFLINE5,SP30,SP10
          CLEAR     WFLINE5
          APPEND    PSUBRB,WFLINE5
          RESET     WFLINE5,18
          APPEND    PPOST,WFLINE5
          RESET     WFLINE5
.
          UNPACK    ADADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          PACK      WFLINE6,SP30,SP10
          CLEAR     WFLINE6
          APPEND    "Presented: ",WFLINE6
          APPEND    CPCDATE,WFLINE6
          RESET     WFLINE6,26
          APPEND    "A&E:",WFLINE6
          APPEND    ADANUMB,WFLINE6
          RESET     WFLINE6
          RETURN
.
.-------------------------------------------------------------------------------
.         Wellington (NZ) AAE Labels
.-------------------------------------------------------------------------------
.          Line 1
.
LABELWTN  PACK      WFLINE1,SP30,SP10
          CLEAR     WFLINE1
.
          APPEND    PSNAME,WFLINE1            * Patient's Surname
          RESET     WFLINE1,16
.
          APPEND    PTITL,WFLINE1             * Patients Title
.
          UNPACK    SP10,XCENT,XYEAR,XMON,XDAY      * Patient's Birth Date
          UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          REP       " 0",XDAY
          REP       " 0",XMON
          REP       " 0",XYEAR
          REP       " 0",XCENT
          APPEND    SP1,WFLINE1
          APPEND    XDAY,WFLINE1
          APPEND    SLASH,WFLINE1
          APPEND    XMON,WFLINE1
          APPEND    SLASH,WFLINE1
          APPEND    XCENT,WFLINE1
          APPEND    XYEAR,WFLINE1
.
          APPEND    SP1,WFLINE1               * Admission Number
          APPEND    EMVIURNO,WFLINE1
          RESET     WFLINE1
.
.          Line Two
.
          PACK      WFLINE2,SP30,SP10
          CLEAR     WFLINE2
.
          APPEND    PGNAME,WFLINE2            * Patients Given Name
          RESET     WFLINE2,22
.
          APPEND    SP1,WFLINE2               * Patients Sex
          APPEND    PSEX,WFLINE2
.
          APPEND    SP1,WFLINE2               * Patient's Age
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            REP       " 0",AGEDATE            * srf 610524 & 640501
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            APPEND    PSAGECON,WFLINE2
            APPEND    PSAGETYP,WFLINE2
          ELSE
            APPEND    PSAGE,WFLINE2
          ENDIF
.
          APPEND    SP7,WFLINE2
          APPEND    "A&E",WFLINE2
          RESET     WFLINE2
.
.          Line Three
.
          PACK      WFLINE3,SP30,SP10
          CLEAR     WFLINE3
.
          APPEND    PADD1,WFLINE3             * Patient's Address
          CALL      FINENDF3
.
          APPEND    SP1,WFLINE3
          APPEND    PADD2,WFLINE3
          CALL      FINENDF3
.
          APPEND    SP1,WFLINE3
          APPEND    PSUBRB,WFLINE3
          CALL      FINENDF3
.
          APPEND    SP1,WFLINE3
          APPEND    ADAPOST,WFLINE3
          RESET     WFLINE3
.
.          Line Four
.
          PACK      WFLINE4,SP30,SP10
          CLEAR     WFLINE4
.
          APPEND    SP3,WFLINE4
          APPEND    "A/E :",WFLINE4
.
          APPEND    ADANUMB,WFLINE4
          RESET     WFLINE4
.
.          Line Five
.
          PACK      WFLINE5,SP30,SP10
          CLEAR     WFLINE5
.
          APPEND    SP5,WFLINE5
.
          MOVE      SP4,THCSCOD
          PACK      KEY5,CODEU1,ADAUSR1
          CALL      RDCODE1
          APPEND    SP1,WFLINE5               * Area
          APPEND    THCSCOD,WFLINE5
          RESET     WFLINE5,8
.
          APPEND    SP30,WFLINE5
          RESET     WFLINE5,28
.
          UNPACK    SP30,CDAY,CMON,CYEAR,CCENT
          UNPACK    ADADATE,CCENT,CYEAR,CMON,CDAY
.
          MATCH     SP2,CDAY
          GOTO      NOAAEDTE IF EQUAL
.
          APPEND    CDAY,WFLINE5
          APPEND    SLASH,WFLINE5
          APPEND    CMON,WFLINE5
          APPEND    SLASH,WFLINE5
          APPEND    CCENT,WFLINE5
          APPEND    CYEAR,WFLINE5
NOAAEDTE  RESET     WFLINE5
          RETURN
.
.-------------------------------------------------------------------------------
.         Southland/New Zealand Labels
.-------------------------------------------------------------------------------
. ------- Line 1 -------
.
ASLB3000  PACK      WLINE1,SP20,SP20        * Clear print line
          CLEAR     WLINE1                  * Reset form pointer to 0
          APPEND    SP1,WLINE1              * 1 space to start with
          APPEND    PSNAME,WLINE1           * Surname
          RESET     WLINE1,16               * Reset to position 16
          APPEND    SP1,WLINE1              * Space in between
          APPEND    PTITL,WLINE1            * Title
          APPEND    SP1,WLINE1              * Space in between
          APPEND    "UR:",WLINE1            * Heading desc
          RESET     PURNO,3                  * Set pointer to 1st char of U/R
          APPEND    PURNO,WLINE1            * U/R number
          RESET     WLINE1                  * Reset form pointer to 1
.
. ------- Line 2 -------
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY * Set up birthdate components
          PACK      WLINE2,SP20,SP20        * Clear print line
          CLEAR     WLINE2                  * Reset form pointer to 0
          APPEND    SP1,WLINE2              * 1 space to start with
          APPEND    PGNAME,WLINE2           * Given Name
          RESET     WLINE2,16               * Reset to position 16
          APPEND    SP1,WLINE2              * Space in between
          APPEND    PSEX,WLINE2             * Sex (1 char)
          APPEND    SP1,WLINE2              * Space in between
          APPEND    CDAY,WLINE2             * Birth day
          APPEND    SLASH,WLINE2            * Date separator
          APPEND    CMON,WLINE2             * Birth month
          APPEND    SLASH,WLINE2            * Date separator
          APPEND    CCENT,WLINE2            * Birth century
          APPEND    CYEAR,WLINE2            * Birth year
          APPEND    SP1,WLINE2              * Space in between
.
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            PACK      DIM4,PSAGECON,PSAGETYP
            SQUEEZE   DIM4
            APPEND    DIM4,WLINE2
          ELSE
            APPEND    PSAGE,WLINE2          * Age
          ENDIF
.
          RESET     WLINE2                  * Reset form pointer to 1
.
. ------- Line 3 -------
.
          PACK      WLINE3,SP20,SP20        * Clear print line
          CLEAR     WLINE3                  * Reset form pointer to 0
          APPEND    SP1,WLINE3              * 1 space to start with
          APPEND    "A&E ",WLINE3           * Description
          APPEND    ADANUMB,WLINE3          * Event number
          APPEND    SP1,WLINE3              * Space in between
          APPEND    PMPXRHC1,WLINE3          * Local Doctor
          RESET     WLINE3,31               * Set to last char of label
          APPEND    SP1,WLINE3              * Final char is a space
          RESET     WLINE3                  * Reset form pointer to 1
.
. ------- Line 4 -------
.
          PACK      WLINE4,SP20,SP20        * Clear print line
          CLEAR     WLINE4                  * Reset form pointer to 0
          APPEND    SP1,WLINE4              * 1 space to start with
          APPEND    PADD1,WLINE4            * 1st line of address
          ENDSET    WLINE4                  * Set pointer to end of line
ASLB3400  CMATCH    SP1,WLINE4              * Is this a space ?
          GOTO      ASLB3410 IF NOT EQUAL   * No - found end of address
          BUMP      WLINE4,-1               * Move pointer back 1 char
          GOTO      ASLB3405 IF EOS
          GOTO      ASLB3400                * Test for end of address
ASLB3405  RESET     WLINE4,1                * If PADD1 is Blank
          GOTO      ASLB3415
ASLB3410  APPEND    ",",WLINE4              * Comma between both parts of addr
          APPEND    SP1,WLINE4              * Space in between
ASLB3415  APPEND    PADD2,WLINE4            * 2nd line of address
          RESET     WLINE4,31               * Set to last char of label
          APPEND    SP1,WLINE4              * Final char is a space
          RESET     WLINE4                  * Reset form pointer to 1
.
. ------- Line 5 -------
.
          PACK      WLINE5,SP20,SP20        * Clear print line
          CLEAR     WLINE5                  * Reset form pointer to 0
          APPEND    SP1,WLINE5              * 1 space to start with
          APPEND    PSUBRB,WLINE5           * Suburb
          APPEND    SP3,WLINE5              * Spaces in between
          APPEND    "PH:",WLINE5            * Heading desc
          APPEND    PTELEP,WLINE5           * Private Telephone
          RESET     WLINE5,31               * Set to last char of label
          APPEND    SP1,WLINE5              * Final char is a space
          RESET     WLINE5                  * Reset form pointer to 1
.
ASLB3999  RETURN                             * Finished Southland Labels
.
.-------------------------------------------------------------------------------
. Ballarat
.-------------------------------------------------------------------------------
ASLB4000  .
.         Format the visit date (eg, Monday, January 24, 2005 14:11)
.
          PACK      WLINE1D,SP30,SP5               * initialise visit field
.
.         Get the day name
.
          UNPACK    EMVIDATE,CCENT,CYEAR,CMON,CDAY
          CALL      DAYOFWEK                     * get day of week
          IF        EXIT = 1
            MOVE      SP20,DAYDESC               * error getting dow,leave blank
          ELSE
            LOAD      DAYDESC,WEEKDAY,DMON,DTUE,DWED,DTHU,DFRI,DSAT,DSUN
          ENDIF
.
          MOVE      DAYDESC,WLINE1D                * load day of week
          STRIP     WLINE1D                        * remove trailing blanks
          ENDSET    WLINE1D
          APPEND    ", ",WLINE1D
.
.         Get the month name
.
          MOVE      CMON,FORM2
          LOAD      MONTHDES,FORM2,MJAN,MFEB,MMAR,MAPR,MMAY,MJUN,MJUL,MAUG:
                                   MSEP,MOCT,MNOV,MDEC
.
          APPEND    MONTHDES,WLINE1D               * load month name
          RESET     WLINE1D
          STRIP     WLINE1D                        * remove trailing blanks
          ENDSET    WLINE1D
          APPEND    SP1,WLINE1D
.
.         If the first character of the day is "0" (as "04"), then only load
.         the second number.
.
          MOVE      CDAY,ANS
          MATCH     "0",ANS                      * 1st char. of day "0" ?
          IF        @EQUAL
            UNPACK    CDAY,ANS,ANS               * yes - get 2nd char. only
            APPEND    ANS,WLINE1D                  * load day
          ELSE
            APPEND    CDAY,WLINE1D                 * load day with both chars.
          ENDIF
.
          APPEND    ", ",WLINE1D
          APPEND    CCENT,WLINE1D                  * load year
          APPEND    CYEAR,WLINE1D
          APPEND    SP1,WLINE1D
.
          MOVE      EMVITIME,DIM5                * load time
          APPEND    DIM5,WLINE1D
          RESET     WLINE1D,35
.
.         Load comment lines 1 & 2.  Each of the data fields is 50 characters
.         long.  Load these into two 35 character fields for printing.
.
          MOVE      EMVICOM1,WLIN1BHS
          MOVE      EMVICOM1,DIM50
          STRIP     DIM50
          MOVELPTR  DIM50,FORM2
          IF        FORM2 < 31
            MOVE      EMVICOM2,WLIN2BHS
          ELSE
            BUMP      DIM50,30
            MOVE      DIM50,WLIN2BHS
            STRIP     WLIN2BHS
            ENDSET    WLIN2BHS
            APPEND    SP1,WLIN2BHS
            APPEND    EMVICOM2,WLIN2BHS
            RESET     WLIN2BHS
          ENDIF
.
          MOVE      SP30,WLINEZ4
.         C-0825792 CONTROL.EMCNURSE = 0 - Use oprnuraf for Nurse
          MATCH     "1",EMCNURSE                 * Use pmshcpaf for OT Nurse?
          GOTO      ASLB4100 IF EQUAL            * Yes
.
          MOVE      EMVITRNS,KEY6
          CALL      RDOPNUR1
          IF        OVRCD = 0
            MOVE      OPNRSNAM,WLINEZ4
            STRIP     WLINEZ4
            ENDSET    WLINEZ4
            APPEND    COMMA,WLINEZ4
            APPEND    SP1,WLINEZ4
            APPEND    OPNRGNAM,WLINEZ4
            RESET     WLINEZ4
          ENDIF
          GOTO      ASLB4900
.
.         C-0825792 CONTROL.EMCNURSE = 1 - Use pmshcpaf for Nurse
ASLB4100  PACK      KEY10,EMVITRNS,SP70
          CALL      RDPMHCP1
          IF        OVRCD = 0
            MOVE      PMHCSNAM,WLINEZ4
            STRIP     WLINEZ4
            ENDSET    WLINEZ4
            APPEND    COMMA,WLINEZ4
            APPEND    SP1,WLINEZ4
            APPEND    PMHCGNAM,WLINEZ4
            RESET     WLINEZ4
          ENDIF
.
ASLB4900  UNPACK    NOLABEL,DIM1,ZCOPY
          REP       " 0",ZCOPY
.
ALSB4999  RETURN
.
.-------------------------------------------------------------------------------
.         Hawkes Bay format
.-------------------------------------------------------------------------------
ASLB5000  PACK      WLINE1A,SP30,SP10        * Ensure Lines are clear
          PACK      WLINE2A,SP30,SP10
          PACK      WFLINE3,SP30,SP20
          PACK      WLINE3A,SP30,SP10
          PACK      WLINE4A,SP30,SP10
.
.         Line 1
ASLB5100  MOVE      PSNAME,DIM14             * Surname
          PACK      WLINE1A,DIM14 
.
          RESET     WLINE1A,15               * Title
          APPEND    PTITL,WLINE1A
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY   * Date of Birth
          PACK      DIM10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          REP       " 0",DIM10
          RESET     WLINE1A,20
          APPEND    DIM10,WLINE1A
.
          RESET     WLINE1A,30               * UR No
          APPEND    EMVIURNO,WLINE1A
          RESET     WLINE1A
.
.         Line 2
ASLB5200  MOVE      PGNAME,DIM14             * Given Name
          PACK      WLINE2A,DIM14
.
          RESET     WLINE2A,15               * Title
          APPEND    PSEX,WLINE2A
.
          RESET     WLINE2A,18               * Age
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            APPEND    PSAGECON,WLINE2A
            APPEND    PSAGETYP,WLINE2A
          ELSE
            APPEND    PSAGE,WLINE2A
          ENDIF
.
          MOVE      "A&E",DIM3,
          RESET     WLINE2A,26               * A&E
          APPEND    DIM3,WLINE2A
          RESET     WLINE2A
.
.         Line 3
ASLB5300  PACK      WFLINE3,SP30,SP10        * Address Line 1
          CLEAR     WFLINE3
          APPEND    PADD1,WFLINE3
.
          CALL      FINENDF3
          MOVE      ",",DIM1
          APPEND    DIM1,WFLINE3
          APPEND    SP1,WFLINE3
          APPEND    PADD2,WFLINE3            * Address Line 2
          RESET     WFLINE3
          PACK      WLINE3A,WFLINE3
          RESET     WLINE3A
.
.         Line 4
ASLB5400  MOVE      "A/E:",WLINE4A           * A&E Number
          RESET     WLINE4A,5
          APPEND    DEMVIADM,WLINE4A
.
          RESET     WLINE4A,10               * Doctor
          MOVE      "GP:",DIM3
          RESET     WLINE4A,14
          APPEND    DIM3,WLINE4A
          APPEND    PMPXRHC1,WLINE4A 
.
          UNPACK    EMVIDATE,CCENT,CYEAR,CMON,CDAY    * A&E Date
          PACK      DIM10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          RESET     WLINE4A,27
          APPEND    SP1,WLINE4A
          APPEND    DIM10,WLINE4A
          RESET     WLINE4A
.
ALSB5999  RETURN
.
.-------------------------------------------------------------------------------
.         Taranaki format
.-------------------------------------------------------------------------------
ASLB6000  PACK      WLINE1A,SP30,SP10        * Ensure Lines are clear
          PACK      WLINE2A,SP30,SP10
          PACK      WFLINE3,SP30,SP20
          PACK      WLINE3A,SP30,SP10
          PACK      WLINE4A,SP30,SP10
          PACK      WLINE5A,SP30,SP10
.
.-------- Line 1 --------------
.
ASLB6100  MOVE      PSNAME,DIM15             * Surname
          PACK      WLINE1A,DIM15 
.
          RESET     WLINE1A,16               * Title
          APPEND    PTITL,WLINE1A
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY   * Date of Birth
          PACK      DIM10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          REP       " 0",DIM10
          RESET     WLINE1A,21
          APPEND    DIM10,WLINE1A
.
          RESET     WLINE1A,30               * UR No
          APPEND    EMVIURNO,WLINE1A
          RESET     WLINE1A
.
.-------- Line 2 -------------
.
ASLB6200  MOVE      PGNAME,DIM15             * Given Name
          PACK      WLINE2A,DIM15
.
          RESET     WLINE2A,16
          APPEND    ADANUMB,WLINE2A          * AAE Number
.
          RESET     WLINE2A,27               * Sex
          APPEND    PSEX,WLINE2A
.
          RESET     WLINE2A,31               * Age
          IF        PTCNDATE=1
            CALL      IBACLOCK
            PACK      AGEDATE,CCC,CYY,CMM,CDD
            CALL      CALCAGE
            REP       UPPLOW,PSAGETYP
            APPEND    PSAGECON,WLINE2A
            APPEND    PSAGETYP,WLINE2A
          ELSE
            APPEND    PSAGE,WLINE2A
          ENDIF
.
.-------- Line 3 ---------------
.
ASLB6300  PACK      WFLINE3,SP30,SP10        * Address Line 1
          CLEAR     WFLINE3
          MOVE      PADD1,DIM15
          APPEND    DIM15,WFLINE3
.
          CALL      FINENDF3
          APPEND    ",",WFLINE3
          RESET     WFLINE3,17
          MOVE      PADD2,DIM15
          APPEND    DIM15,WFLINE3            * Address Line 2
          CALL      FINENDF3
          APPEND    ",",WFLINE3
          RESET     WFLINE3,34
          MOVE      PPOST,DIM4               * Post code
          APPEND    DIM4,WFLINE3
          RESET     WFLINE3
          PACK      WLINE3A,WFLINE3
          RESET     WLINE3A
.
.-------- Line 4 -----------------
.
ASLB6400  MOVE      "PH:",WLINE4A           * Private Phone Number
          RESET     WLINE4A,4
          APPEND    PTELEP,WLINE4A
.
          RESET     WLINE4A,15              * GP
          APPEND    "GP:",WLINE4A
          MOVE      SP30,PMHCSNAM
          OPEN      PMSHCPA1,"pmshcpaf"
.
          PACK      KEY10,PMPXRHC1,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            GOTO      ASLB6405
          ENDIF          
.
          PACK      KEY10,AEDARFGP,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,ASLB6410
.
ASLB6405  MOVE      PMHCSNAM,DIM12
          APPEND    DIM12,WLINE4A
.
ASLB6410  UNPACK    ADADATE,CCENT,CYEAR,CMON,CDAY    * A&E Date
          PACK      DIM10,CDAY,SLASH,CMON,SLASH,CCENT,CYEAR
          REP       " 0",DIM10
          RESET     WLINE4A,30
          APPEND    DIM10,WLINE4A
          RESET     WLINE4A
.
.-------- Line 5 ---------------
.
ASLB6500  MOVE      "ACCIDENT & EMERGENCY",WLINE5A
.
          OPEN       PATALRT1,"patalrtf"
          PACK      KEY16,PURNO,SP20
          CALL      RSPTALR1
.
ASLB6510  CALL      RKPTALR1                * check for alerts
          BRANCH    OVRCD,ASLB6999
.
          MATCH     PURNO,PTALURNO
          GOTO      ASLB6999 IF NOT EQUAL
.
          PACK      KEY5,PTALCATG,PTALCODE
          CALL      RDCODE1
          BRANCH    OVRCD,ASLB6510
.
          MATCH     ANSN,TCINDC1
          GOTO      ASLB6510 IF EQUAL
.
          RESET     WLINE5A,26
          APPEND    "*ALERT*",WLINE5A 
.
ASLB6999  RETURN
+
.-------------------------------------------------------------------------------
.         Port Macquarie format
.-------------------------------------------------------------------------------
ASLB7000
.-------- Line 1 -------------
.
          MOVE      "EMERGENCY DEPT ",WLINE1
          RESET     WLINE1,21
          APPEND    " UR:",WLINE1
          APPEND    EMVIURNO,WLINE1
          RESET     WLINE1
.
.-------- Line 2 -------------
.
          PACK      WLINE2,SP20,SP20        * clear line
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY  * unpack birthdate
          CALL      PACDATE
          REP       " 0",CPDATE             * formatted date of birth
          MOVE      PSNAME,WLINE2           * patients surname
          RESET     WLINE2,20
          APPEND    " DOB:",WLINE2
          APPEND    CPDATE,WLINE2           * add the date of birth
          RESET     WLINE2
.
.-------- Line 3 -------------
.
          PACK      WLINE3,SP20,SP20        * clear line
          MOVE      PGNAME,WLINE3           * given name
          RESET     WLINE3,20
          APPEND    "  ED:",WLINE3          * append Admission number field
          APPEND    ADANUMB,WLINE3          * add admission number
          RESET     WLINE3
.
.-------- Line 4 -------------
.
          PACK      WLINE4,SP20,SP20        * clear line
          MOVE      PADD1,WLINE4            * address line 1
          RESET     WLINE4
.
.-------- Line 5 -------------
.
          PACK      WLINE5,SP20,SP20        * clear line
          MOVE      PADD2,WLINE5            * address line 2
          RESET     WLINE5,29
          APPEND    PPOST,WLINE5            * add the post code
          RESET     WLINE5
.
.-------- Line 6 ------------
.
          PACK      WLINE6,SP20,SP20        * clear line
          MOVE      "MEDI: ",WLINE6         * add medicare field
          RESET     WLINE6,6
.
          MATCH     SP10,PMEDI
          GOTO      ASLBS10C IF EQUAL       * no medicare number
.
          UNPACK    PMEDI,C4YEAR,KEY5,ANS   * split into required parts
          APPEND    C4YEAR,WLINE6           * add first 4 numbers
          APPEND    "-",WLINE6
          APPEND    KEY5,WLINE6             * add next 5 numbers
          APPEND    "-",WLINE6
          APPEND    ANS,WLINE6              * add last number
.
ASLBS10C  RESET     WLINE6,19
          APPEND    "  HF: ",WLINE6         * add health fund field
          APPEND    PFUNDH,WLINE6           * health fund
.
          MATCH     SP8,PFNDTB
          GOTO      ASLBS10D IF EQUAL       * no table
.
          RESET     WLINE6,27
          APPEND    "/",WLINE6
          APPEND    PFNDTB,WLINE6           * health fund table
.
ASLBS10D  RESET     WLINE6
.
.-------- Line 7 ------------
.
          PACK      WLINE7,SP20,SP20        * clear line
          MOVE      "DVA: ",WLINE7
          RESET     WLINE7,5
          APPEND    PREPAT,WLINE8           * add repatriation number
          RESET     WLINE7
.
.-------- Line 8 -----------
.
          PACK      WLINE8,SP20,SP20
          MOVE      ADADOCT,KEY6            * attending doctor
          MOVE      SP30,DSNAME
          MOVE      SP30,DGNAME
          CALL      RDDOCT1                 * read doctor file
          RESET     WLINE8,14
          APPEND    " DR: ",WLINE8          * add doc field desc
          MOVE      DGNAME,ANS              * get initial
          APPEND    ANS,WLINE8              * add initial
          APPEND    SP1,WLINE8
          APPEND    DSNAME,WLINE8           * add surname
          RESET     WLINE8
.
          RETURN
+
.******************************************************************************
.*                                 ASLB8000                                   *
.*                            Label 8 for Mersey                              *
.******************************************************************************
ASLB8000
.
. ----- Line 1 -----
.
          MOVE      "EMERGENCY DEPT ",WLINE1
          RESET     WLINE1,21
          APPEND    " UR:",WLINE1
          APPEND    EMVIURNO,WLINE1
          RESET     WLINE1
.
. ----- Line 2 -----
.
          PACK      WLINE2,SP20,SP20        * clear line
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY  * unpack birthdate
          CALL      PACDATE
          REP       " 0",CPCDATE             * formatted date of birth
          MOVE      PSNAME,WLINE2           * patients surname
          RESET     WLINE2,20
          APPEND    " DOB:",WLINE2
          APPEND    CPCDATE,WLINE2           * add the date of birth
          RESET     WLINE2
.
. ----- Line 3 -----
.
          PACK      WLINE3,SP20,SP20        * clear line
          MOVE      PGNAME,WLINE3           * given name
          RESET     WLINE3,20
          APPEND    "  ED:",WLINE3          * append Admission number field
          APPEND    ADANUMB,WLINE3          * add admission number
          RESET     WLINE3
.
. ----- Line 4 -----
.
          PACK      WLINE4,SP20,SP20        * clear line
          MOVE      PADD1,WLINE4            * address line 1
          RESET     WLINE4
.
. ----- Line 5 -----
.
          PACK      WLINE5,SP20,SP20        * clear line
          MOVE      PSUBRB,WLINE5           * suburb
          RESET     WLINE5,29
          APPEND    PPOST,WLINE5            * add the post code
          RESET     WLINE5
.
. ----- Line 6 -----
.
          PACK      WLINE6,SP20,SP20        * clear line
          MOVE      "MEDI: ",WLINE6         * add medicare field
          RESET     WLINE6,6
.
          MATCH     SP10,PMEDI
          GOTO      ASLBS10E IF EQUAL       * no medicare number
.
          UNPACK    PMEDI,C4YEAR,KEY5,ANS   * split into required parts
          APPEND    C4YEAR,WLINE6           * add first 4 numbers
          APPEND    "-",WLINE6
          APPEND    KEY5,WLINE6             * add next 5 numbers
          APPEND    "-",WLINE6
          APPEND    ANS,WLINE6              * add last number
.
ASLBS10E  RESET     WLINE6,19
          APPEND    "  HF: ",WLINE6         * add health fund field
          APPEND    PFUNDH,WLINE6           * health fund
.
          MATCH     SP8,PFNDTB
          GOTO      ASLBS10F IF EQUAL       * no table
.
          RESET     WLINE6,27
          APPEND    "/",WLINE6
          APPEND    PFNDTB,WLINE6           * health fund table
.
ASLBS10F  RESET     WLINE6
.
. ----- Line 7 -----
.
          PACK      WLINE7,SP20,SP20        * clear line
          MOVE      "DVA: ",WLINE7
          RESET     WLINE7,5
          APPEND    PREPAT,WLINE8           * add repatriation number
          RESET     WLINE7
.
. ----- Line 8 -----
.
          PACK      WLINE8,SP20,SP20
.          MOVE      ADADOCT,KEY6            * attending doctor
.          MOVE      SP30,DSNAME
.          MOVE      SP30,DGNAME
.          CALL      RDDOCT1                 * read doctor file
.          RESET     WLINE8,14
.          APPEND    " DR: ",WLINE8          * add doc field desc
.          MOVE      DGNAME,ANS              * get initial
.          APPEND    ANS,WLINE8              * add initial
.          APPEND    SP1,WLINE8
.          APPEND    DSNAME,WLINE8           * add surname
          RESET     WLINE8
.
          RETURN
.
+
.******************************************************************************
.*                                 ASLB9000                                   *
.*                       Label  9 for St Vincent's Hospital                   *
.******************************************************************************
.
ASLB9000  MATCH     "LABELEMR01",LABELTYP        * screen "01" ?
          GOTO      ASLB9050 IF EQUAL            * yes
.
          MATCH     "LABELEMR03",LABELTYP        * screen "03" ?
          GOTO      ASLB9100 IF NOT EQUAL        * use alt. PMI label
.
.         Set New Wrist Band variables
.
.         Load DOB
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      "DOB: ",WLINEZ15
          ENDSET    WLINEZ15
          APPEND    CPCDATE,WLINEZ15
          APPEND    "      UR: ",WLINEZ15
.
.         Load U/R for printing, barcode and barcode interpretation line
.
          APPEND    PURNO,WLINEZ15
          RESET     WLINEZ15
          MOVE      PURNO,WLINEZ2
.
.         Load Surname
.
          MOVE      PTMASNAM,WLINEZ20
          STRIP     WLINEZ20
.
.         Load Title and First Given Name
.
          UNPACK    PTITL,ANS,KEY3
          REP       UPPTOLOW,KEY3
          PACK      WLINEZ21,ANS,KEY3
          STRIP     WLINEZ21
          UNPACK    PMPXFNAM,ANS,KEY39
          REP       UPPTOLOW,KEY39
          ENDSET    WLINEZ21
          APPEND    SP1,WLINEZ21
          APPEND    ANS,WLINEZ21
          APPEND    KEY39,WLINEZ21
          RESET     WLINEZ21
          STRIP     WLINEZ21
.
.         Load No. of Labels
.
          UNPACK    NOLABEL,DIM1,ZCOPY
          REP       " 0",ZCOPY
.
          GOTO      ASLB9999
.
.         Set Standard PMI variables
.
ASLB9050  PACK      WLINEZ1,SP20,SP20
          PACK      WLINEZ2,SP20,SP20
          PACK      WLINEZ3,SP20,SP20
          PACK      WLINEZ4,SP20,SP20
          PACK      WLINEZ5,SP20,SP20
          PACK      WLINEZ6,SP20,SP20
          PACK      WLINEZ7,SP20,SP20
          PACK      WLINEZ8,SP20,SP20
          PACK      WLINEZ9,SP20,SP20
          PACK      WLINEZ10,SP20,SP20
          PACK      WLINEZ11,SP20,SP20
          PACK      WLINEZ12,SP20,SP20
          PACK      WLINEZ13,SP20,SP20
          PACK      WLINEZ14,SP20,SP20
          PACK      WLINEZ17,SP20,SP20
. 
          MOVE      PURNO,WLINEZ1
          RESET     WLINEZ1,8
.
          MOVE      PSNAME,WLINEZ2
          RESET     WLINEZ2,16
.
          MOVE      PGNAME,WLINEZ3
          RESET     WLINEZ3,20
.
          MOVE      PTITL,WLINEZ4
          RESET     WLINEZ4,4
.
          MOVE      PSEX,WLINEZ5
          RESET     WLINEZ5,6
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      WLINEZ6,SP20,SP20
          MOVE      "DoB:",WLINEZ6
          ENDSET    WLINEZ6
          APPEND    CPCDATE,WLINEZ6
          RESET     WLINEZ6,14
.
          PACK      WLINEZ7,SP20,SP20
          MOVE      "yr",DIM2
          PACK      WLINEZ7,PSAGE,DIM2
          RESET     WLINEZ7,5
.
          PACK      WLINEZ8,SP20,SP20
          MOVE      PADD1,WLINEZ8
          RESET     WLINEZ8,25
.
          PACK      WLINEZ17,SP20,SP20
          MOVE      PADD2,WLINEZ17
          RESET     WLINEZ17,25
.
          PACK      WLINEZ9,SP20,SP20
          STRIP     PSUBRB
          STRIP     PPOST
          PACK      WLINEZ9,PSUBRB,SP1,PPOST
          RESET     WLINEZ9,25
.
          CALL      IBACLOCK
          PACK      WLINEZ11,SP20,SP20
          PACK      CURRDATE,CDD,SLASH,CMM,SLASH,CYY
          REP       " 0",CURRDATE
          MOVE      "(Printed ",WLINEZ11
          ENDSET    WLINEZ11
          APPEND    CURRDATE,WLINEZ11
          APPEND    ")",WLINEZ11
.
          PACK      WLINEZ13,SP20,SP20
          MOVE      PTELEP,WLINEZ13
          RESET     WLINEZ13,12
.
          PACK      WLINEZ14,SP20,SP20
          PACK      WLINEZ14,ZEP,EMVICLAS,EMVICOMP
          ENDSET    WLINEZ14
. 
          MOVE      PURNO,WLINEZ16
          RESET     WLINEZ16,8
          APPEND    ZFS,WLINEZ16
.
          UNPACK    NOLABEL,DIM1,ZCOPY
          REP       " 0",ZCOPY
.
          GOTO      ASLB9999
.
.         Alternate PMI Zebra Label
.
.         U/R
.
ASLB9100  MOVE      PURNO,WLINEZ1
.
.         Surname
.
          MOVE      PSNAME,WLINEZ2
          SETLPTR   WLINEZ2,16
.
.         Given Name (Uppercase first letter of each name, rest in lowercase)
.
          CLEAR     WLINEZ3
          MOVE      PGNAME,ANS
ASLB9200  APPEND    ANS,WLINEZ3
          BUMP      PGNAME
          GOTO      ASLB9400 IF EOS
.
          MOVE      PGNAME,ANS
          MATCH     SP1,ANS
          GOTO      ASLB9300 IF EQUAL
.
          REP       "AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz",ANS
          GOTO      ASLB9200
.
ASLB9300  MOVE      PGNAME,ANS
          APPEND    ANS,WLINEZ3
          BUMP      PGNAME
          GOTO      ASLB9400 IF EOS
.
          MATCH     SP1,PGNAME
          GOTO      ASLB9300 IF EQUAL
          MOVE      PGNAME,ANS
          GOTO      ASLB9200
.
ASLB9400  RESET     PGNAME
          RESET     WLINEZ3
          SETLPTR   WLINEZ3,20
.
.         Date of Birth
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      "DOB: ",WLINEZ6
          ENDSET    WLINEZ6
          APPEND    CPCDATE,WLINEZ6
          RESET     WLINEZ6
          SETLPTR   WLINEZ6,15
.
.         U/R for barcode
.
          MOVE      PURNO,WLINEZ16
          ENDSET    WLINEZ16
          APPEND    ZFS,WLINEZ16
          RESET     WLINEZ16
          SETLPTR   WLINEZ16,11
.
.         No. of Labels
.
          UNPACK    NOLABEL,DIM1,ZCOPY
          REP       " 0",ZCOPY
.
ASLB9999  RETURN
+
.******************************************************************************
.*                                 SJOGG000                                   *
.* Label Type 10 for SJOG Geelong                                             *
.******************************************************************************
.
SJOGG000  MOVE      ONE,SJOGFLAG                 * set flag for ED label
.
          CALL      SETSJOGL                     * in SJOGLABL.PBL
.
          RETURN
+
.*******************************************************************************
.*        LINUPAAE - Subroutine to set up a lineup print                       *
.*******************************************************************************
.
LINUPAAE  BRANCH    AECNLABL,SETLIN10,SETLIN20,SETLIN30,SETLIN40,SETLIN50:
                             SETLIN60,SETLIN70,SETLIN80,SETLIN90,SETLIN90
.
.         Modbury
.
          MOVE      "XXXXXXXXXXXXXXXXXXXX XXXX X U/R:99999999",WFLINE1
          MOVE      "XXXXXXXXXXXXXXXXXXXXX 99/99/1999 XXXXXXX",WFLINE2
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",WFLINE3
          MOVE      "XXXXXX XXXXXXXXXXXXXXXXXXXXXXXX Type: XX",WFLINE4
          MOVE      "Medi:XXXXXXXXXXXXX          A&E:99999999",WFLINE5
          RETURN
.
.         Epworth
.
SETLIN10  MOVE      "XXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXX XXXX",WFLINE1
          MOVE      "DOB:99/99/99      X   U/R:99999999      ",WFLINE2
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXX  XXX  XXX     ",WFLINE3
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXX  XXX          ",WFLINE4
          MOVE      "XXXXXXXXXXXXXXX   XXXX                  ",WFLINE5
          MOVE      "Presented: 99/99/99         A&E:99999999",WFLINE6
          RETURN
.
.         Wellington
.
SETLIN20  MOVE      "XXXXXXXXXXXXXXX XXXX99/99/9999 XXXXXXXX",WFLINE1
          MOVE      "XXXXXXXXXXXXXXXXXXXXXX X XXX        A&E",WFLINE2
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",WFLINE3
          MOVE      "   A/E:99999999                     XXX",WFLINE4
          MOVE      "     XXX                    XXX XXX XXX",WFLINE5
          RETURN
.
.         Southland
.
SETLIN30  MOVE      " XXXXXXXXXXXXXXX XXXX UR:XXXXXX  ",WLINE1
          MOVE      " XXXXXXXXXXXXXXX X 99/99/99 XXX  ",WLINE2
          MOVE      " A&E XXXXXXXX XXXXXXXXXXXXXXXXX  ",WLINE3
          MOVE      " XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  ",WLINE4
          MOVE      " XXXXXXXXXXXXXXX   PH:XXXXXXXXX  ",WLINE5
          RETURN
.
.         Hong Kong format
.
SETLIN40  MOVE      "XXXXXXXXXX XXXXXXXXXXXX  ",WLINE1
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXX ",WLINE2
          MOVE      "XXXXXX       XX/XX/XXXX  ",WLINE3
          MOVE      "XXXXXXXX                 ",WLINE4
          MOVE      "                         ",WLINE5
          RETURN
.
.         Hawkes Bay 
.
SETLIN50  MOVE      "XXXXXXXXXXXXXXXXXXX 99/99/99  XXXXXXXX",WLINE1A
          MOVE      "XXXXXXXXXXXXXX X  XXXX    A&E         ",WLINE2A
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",WLINE3A
          MOVE      "A/E: XXXXXXXX GP: XXXXXXXXXXX 99/99/99",WLINE4A
          MOVE      "                                      ",WLINE5A
          RETURN
.
.         Taranaki
.
SETLIN60  MOVE      "XXXXXXXXXXXXXXX XXXX 99/99/99 99999999",WLINE1A
          MOVE      "XXXXXXXXXXXXXXX 99999999  X   999     ",WLINE2A
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",WLINE3A
          MOVE      "PH:99999999   GP:XXXXXXXXXXXX 99/99/99",WLINE4A
          MOVE      "ACCIDENT & EMERGENCY     *ALERT*      ",WLINE5A
          RETURN
.
.         Port Macquarie
.
SETLIN70  MOVE      "EMERGENCY DEPT        UR: 9999999",WLINE1
          MOVE      "XXXXXXXXXXXXXXXXXXX  DOB:99/99/99",WLINE2
          MOVE      "XXXXXXXXXXXXXXXXXXX   ED: 9999999",WLINE3
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXX         ",WLINE4
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXX     XXXX",WLINE5
          MOVE      "MEDI:  9999-99999-9  HF: XXXXXX  ",WLINE6
          MOVE      "DVA: 9999999999                  ",WLINE7
          MOVE      "            DR: X XXXXXXXXXXXXXXX",WLINE8
          RETURN
.
.         Mersey
.
SETLIN80  MOVE      "EMERGENCY DEPT        UR:99999999",WLINE1
          MOVE      "XXXXXXXXXXXXXXXXXXX  DOB:99/99/99",WLINE2
          MOVE      "XXXXXXXXXXXXXXXXXXX   ED:99999999",WLINE3
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXX         ",WLINE4
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXX     XXXX",WLINE5
          MOVE      "MEDI:  9999-99999-9  HF: XXXXXX  ",WLINE6
          MOVE      "DVA: 9999999999                  ",WLINE7
          MOVE      "                                 ",WLINE8
          RETURN
.
.         St Vincent's
.
SETLIN90  MOVE      "XXXXXXX",WLINEZ1
          MOVE      "XXXXXXXXXXXXXXXX",WLINEZ2
          MOVE      "XXXXXXXXXXXXXXXXXXXX",WLINEZ3
          MOVE      "XXXX",WLINEZ4
          MOVE      "XXXXXX",WLINEZ5
          MOVE      "DoB:99/99/9999",WLINEZ6
          MOVE      "999yr",WLINEZ7
          MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXX",WLINEZ8
          MOVE      "XXXXXXXXXXXXXXXXXXXX 9999",WLINEZ9
          MOVE      "XXXXXXXXXXX",WLINEZ10
          MOVE      "(Printed 99/99/99)",WLINEZ11
          MOVE      "(X)",WLINEZ12
          MOVE      "99999999999",WLINEZ13
          MOVE      "XXXXXXXX",WLINEZ14
          RETURN
.
.-------------------------------------------------------------------------------
.         Subroutine to find the end of the string in WFLINE1
.-------------------------------------------------------------------------------
.
FINENDF1  CMATCH    SP1,WFLINE1
          RETURN    IF NOT EQUAL
          BUMP      WFLINE1,-1
          GOTO      FINENDF1 IF NOT EOS
.
          RESET     WFLINE1
          RETURN
.
.          Subroutine to find the end of the string in WFLINE2
.
FINENDF2  CMATCH    SP1,WFLINE2
          RETURN    IF NOT EQUAL
          BUMP      WFLINE2,-1
          GOTO      FINENDF2 IF NOT EOS
.
          RESET     WFLINE2
          RETURN
.
.          Subroutine to find the end of the string in WFLINE3
.
FINENDF3  CMATCH    SP1,WFLINE3
          RETURN    IF NOT EQUAL
          BUMP      WFLINE3,-1
          GOTO      FINENDF3 IF NOT EOS
.
          RESET     WFLINE3
          RETURN
.
.          Subroutine to find the end of the string in WFLINE4
.
FINENDF4  CMATCH    SP1,WFLINE4
          RETURN    IF NOT EQUAL
          BUMP      WFLINE4,-1
          GOTO      FINENDF4 IF NOT EOS
.
          RESET     WFLINE4
          RETURN
.
.*********************************************************************
.         get the Hong Kong Id for a patient
.         Returns : WLINE1        the first label line
.*********************************************************************
          DEFPROC   AELBHK00
.
          INC       PATNIDFD/INC
DIM10     DIM       10
.
          MOVE      PTMXCHNM,DIM10          * truncate chinese name
          PACK      PNGNAME,SP20,SP20
          OPEN      PATNIDA1,"patnidaf"
          PACK      KEY10,CHOSINDX,PURNO
          MOVE      SP20,PTNINMPI           * clear the field
          CALL      RDPTNID1
          CLOSE     PATNIDA1
.
          PACK      PNGNAME,PTNINMPI,SP30
          SQUEEZE   PNGNAME
.
          PACK      WLINE1,DIM10,SP1,PNGNAME,SP30
          GOTO      AELBHK99
.
          INC       PATNIDIO/INC
          INC       IBAOVRIO/INC
.
AELBHK99  ENDPROC
+
