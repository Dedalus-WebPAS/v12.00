.
.         INC       WATMESIO.INC
.
.         FILE  I/O REQUESTS FOR WAITING LISTS MESSAGE FILE.
.
.OVRCD  FORM            1             0 = NOT OVER
.                                     1 = OVER
.
.KEY21    DIM          21             KEY FOR WATMESA1 
. 
.         NOTE  OVRCD = 1   RECORD DOES NOT EXIST
.                       2   RECORD IS LOCKED
.
RDAMESA1 RESET     KEY21
         MOVE      ZERO,OVRCD
         READ      WATMESA1,KEY21;ANS
         GOTO      OVERCOND IF OVER
         RETURN  
.
RDSMESA1 RESET     KEY21
         READ      WATMESA1,KEY21;;
         RETURN  
.
RDMESA1  MOVE      ZERO,OVRCD
         RESET     KEY21
         READ      WATMESA1,KEY21;WAURNO,WAPROC,DWACNT,DWACNT2,WATEXT,WASPARE
         GOTO      OVERCOND IF OVER
         MOVE      DWACNT,WACNT
         MOVE      DWACNT2,WACNT2
         RETURN  
.
RDKMESA1 MOVE      ZERO,OVRCD
         READKS    WATMESA1;WAURNO,WAPROC,DWACNT,DWACNT2,WATEXT,WASPARE
         GOTO      OVERCOND IF OVER
         MOVE      DWACNT,WACNT
         MOVE      DWACNT2,WACNT2
         RETURN  
.
WRMESA1  RESET     KEY21
         MOVE      WACNT,DWACNT
         MOVE      WACNT2,DWACNT2
         WRITE     WATMESA1,KEY21;WAURNO,WAPROC,DWACNT,DWACNT2,WATEXT,WASPARE
.
         RETURN
.
UPMESA1  MOVE      WACNT,DWACNT
         MOVE      WACNT2,DWACNT2
         UPDATE    WATMESA1;WAURNO,WAPROC,DWACNT,DWACNT2,WATEXT,WASPARE
.
         RETURN  
.
DEMESA1  RESET     KEY21
         DELETE    WATMESA1,KEY21
         RETURN
.
