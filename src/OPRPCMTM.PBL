. Program        : OPRPCMTM.PBL
.
. Function       : CGI variable functions & tags for Theatre Doctor's Preference
.                  Comments
.
. Modifications  :
.------------------------------------------------------------------------
. V11.04.01 26/02/2024  Thanh T.       TSK 0923560
.           Added OPPC0060 section
. V10.15.01 29/11/2019  Peter Vela     TSK 0871644
.           Created Include
.------------------------------------------------------------------------
.   Clear Parameters 
.----------------------------------------------------------------------
CLOPPC00  MOVE      Z70,OPPCM001
          MOVE      Z70,OPPCM002
          MOVE      Z70,OPPCM003
          MOVE      Z70,OPPCM004
          MOVE      Z70,OPPCM005
.
CLOPPC99  RETURN
.------------------------------------------------------------
. Tags for Theatre Doctor's Preference Comments
.------------------------------------------------------------
OPPC0000  BRANCH    FLDITMNO,OPPC0010,OPPC0020,OPPC0030,OPPC0040,OPPC0050:
                             OPPC0060
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      OPPC9999
.
OPPC0010  WRITE     HTMLFILE;OPPCCODE;        * Doctor's code
          GOTO      OPPC9999 
.
OPPC0020  WRITE     HTMLFILE;OPPCPREF;        * Doctor's code
          GOTO      OPPC9999
.
OPPC0030  MOVE      "OG",CATEGORY             * Group/Class Type (Cat OG)
          PACK      CODE,OPPCCLSS,SP70
          CALL      CODITM00
          GOTO      OPPC9999
.
OPPC0040  WRITE     HTMLFILE;OPPCLINE;        * Line Number
          GOTO      OPPC9999
.
OPPC0050  WRITE     HTMLFILE;OPPCDESC;        * Line description
          GOTO      OPPC9999
.
OPPC0060  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,OPPC0061,OPPC0062
.
          MATCH     SP70,OPPCHOSP
          GOTO      OPPC9999 IF EQUAL
.
          PACK      KEY3,OPPCHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,OPPC0061
.
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      OPPC9999
.
OPPC0061  WRITE     HTMLFILE;OPPCHOSP;
          GOTO      OPPC9999
.
OPPC0062  MOVE      WBSEHOSP,DEFTHOSP
          CALL      HSPSEL00
          GOTO      OPPC9999
.
OPPC9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Theatre Doctor's Preference Comments
.------------------------------------------------------------
SOPPC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SOPPC001,SOPPC002,SOPPC003,SOPPC004,SOPPC005
.
          MOVE      ONE,EXIT
          GOTO      SOPPC999
.
SOPPC001  PACK      OPPCM001,QRYDATA,SP70
          GOTO      SOPPC999
.
SOPPC002  PACK      OPPCM002,QRYDATA,SP70
          GOTO      SOPPC999
.
SOPPC003  PACK      OPPCM003,QRYDATA,SP70
          GOTO      SOPPC999
.
SOPPC004  PACK      OPPCM004,QRYDATA,SP70
          RJUSTIFY  OPPCM004
          GOTO      SOPPC999
.
SOPPC005  PACK      OPPCM005,QRYDATA,SP70
          GOTO      SOPPC999
.
SOPPC999  RETURN
.
.------------------------------------------------------------
. Update file variables for Theatre Doctor's Preference Comments
.------------------------------------------------------------
MVOPPC00  MATCH     OPPCM001,Z70
          IF        !@EQUAL
            MOVE      OPPCM001,OPPCCODE
          ENDIF
.
          MATCH     OPPCM002,Z70
          IF        !@EQUAL
            MOVE      OPPCM002,OPPCPREF
          ENDIF
.
          MATCH     OPPCM003,Z70
          IF        !@EQUAL
            MOVE      OPPCM003,OPPCCLSS
          ENDIF
.
          MATCH     OPPCM004,Z70
          IF        !@EQUAL
            MOVE      OPPCM004,OPPCLINE
          ENDIF
.
          MATCH     OPPCM005,Z70
          IF        !@EQUAL
            MOVE      OPPCM005,OPPCDESC
          ENDIF
.
          MOVE      HOSPCODE,OPPCHOSP
.
MVOPPC99  RETURN
