. *----------------------------------------------------------------------
. * Include Name  :   PATQMHTM.PBL
. *
. * Function      :   CGI variables for PATQMHFD - patqmhaf.dat
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V9.11.01   28.10.2009  Jill Parkinson CAR 174079
.             Created include
.
.  V12.00.01  22/05/2025  J.Tan          TSK 0955096
.             Added Alphanumeric visit number changes
. *----------------------------------------------------------------------
.------------------------------------------------------------
. Clear file variables
.------------------------------------------------------------
CLRPTQMH  MOVE      ZEROVISN,PTQMADMN
          PACK      PTQMTOUA,SP70
          PACK      PTQMEMPS,SP70
          PACK      PTQMPSNS,SP70
          PACK      PTQMPRMS,SP70
          PACK      PTQMRTFC,SP70
          PACK      PTQMMLSI,SP70
          PACK      PTQMPSNT,SP70
.
          RETURN    
+         
.------------------------------------------------------------
. Clear cgi vars 
.------------------------------------------------------------
CPPTQM00  MOVE      Z70,PTQMH001
          MOVE      Z70,PTQMH002
          MOVE      Z70,PTQMH003
          MOVE      Z70,PTQMH004
          MOVE      Z70,PTQMH005
          MOVE      Z70,PTQMH006
          MOVE      Z70,PTQMH007
          MOVE      Z70,PTQMH008
.
          RETURN    
+         
.------------------------------------------------------------
. Set cgi vars
.------------------------------------------------------------
SPQMH000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPQMH001,SPQMH002,SPQMH003,SPQMH004,SPQMH005:
                       SPQMH006,SPQMH007,SPQMH008
.
          MOVE      ONE,EXIT
          GOTO      SPQMH999
.
SPQMH001  PACK      PTQMH001,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH002  PACK      PTQMH002,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH003  PACK      PTQMH003,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH004  PACK      PTQMH004,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH005  PACK      PTQMH005,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH006  PACK      PTQMH006,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH007  PACK      PTQMH007,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH008  PACK      PTQMH008,QRYDATA,SP70
          GOTO      SPQMH999
.
SPQMH999  RETURN
+
.------------------------------------------------------------
. Update QLD MH file
.------------------------------------------------------------
MVPTQM00  MATCH     PTQMH001,Z70
          IF        !@EQUAL
            MOVE      PTQMH001,PTQMADMN
          ENDIF
.
          MATCH     PTQMH002,Z70
          IF        !@EQUAL
            MOVE      PTQMH002,PTQMTOUA
          ENDIF
.
          MATCH     PTQMH003,Z70
          IF        !@EQUAL
            MOVE      PTQMH003,PTQMEMPS
          ENDIF
.
          MATCH     PTQMH004,Z70
          IF        !@EQUAL
            MOVE      PTQMH004,PTQMPSNS
          ENDIF
.
          MATCH     PTQMH005,Z70
          IF        !@EQUAL
            MOVE      PTQMH005,PTQMPRMS
          ENDIF
.
          MATCH     PTQMH006,Z70
          IF        !@EQUAL
            MOVE      PTQMH006,PTQMRTFC
          ENDIF
.
          MATCH     PTQMH007,Z70
          IF        !@EQUAL
            MOVE      PTQMH007,PTQMMLSI
          ENDIF
.
          MATCH     PTQMH008,Z70
          IF        !@EQUAL
            MOVE      PTQMH008,PTQMPSNT
          ENDIF
.
          RETURN
+
.------------------------------------------------------------
. Output QLD MH file
.------------------------------------------------------------
QMHD0000  BRANCH    FLDITMNO,QMHD0010,QMHD0020,QMHD0030,QMHD0040,QMHD0050:
                             QMHD0060,QMHD0070,QMHD0080
.         
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      QMHD9999
.
QMHD0010  WRITE     HTMLFILE;PTQMADMN;
          GOTO      QMHD9999
.
QMHD0020  WRITE     HTMLFILE;PTQMTOUA;
          GOTO      QMHD9999
.
QMHD0030  WRITE     HTMLFILE;PTQMEMPS;
          GOTO      QMHD9999
.
QMHD0040  WRITE     HTMLFILE;PTQMPSNS;
          GOTO      QMHD9999
.
QMHD0050  WRITE     HTMLFILE;PTQMPRMS;
          GOTO      QMHD9999
.
QMHD0060  WRITE     HTMLFILE;PTQMRTFC;
          GOTO      QMHD9999
.
QMHD0070  WRITE     HTMLFILE;PTQMMLSI;
          GOTO      QMHD9999
.
QMHD0080  WRITE     HTMLFILE;PTQMPSNT;
          GOTO      QMHD9999
.
QMHD9999  RETURN
+
