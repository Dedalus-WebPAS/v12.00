. Modifications
.   V11.05.01 26.11.2024  Ebon Clements  Task 0954547
.             Added <cat-c> start and end tag to category=XX tag
.   V11.04.01 25/06/2024 J.Tan           TSK 0942917
.             Added variables for Keyin Misc/Theatre GST and Keyin Misc.Amount
.   V11.02.02 03/10/2022 J.Tan           TSK 0900069
.             Fixed updating Reason for Admission on Comments line 5
.             Mod for Selection of Fees Estimate bed type (TCFORM6=1 and 2)
.   V11.02.02 13/07/2022 J.Tan           TSK 0900069
.             Mod HEA layout to store Reason for Admission on Comments line 5
.   V11.02.01 11/02/2022 J.Tan    TSK 0910723
.             Mod for SJOG IFC
.   V11.01.01 04/06/2021  J.Tan          TSK 0896226
.             Mod for SJOG IFC/Fees Estimate layout
.   V10.15.02 22/01/2020  J.Tan          TSK 0826834
.             Mod for SJOG IFC/Fees Estimate to print 'Basic Cover' header
.   V10.15.01 15/11/2019  J.Tan          TSK 0826834
.             Mod for SJOG IFC/Fees Estimate
.   V10.13.01 05/12/2018  Don Nguyen     TSK 0838558
.             Added temp file (FEDCOMAF) creation/deletion code
.   V10.08.01 11/04/2016  J.Tan   CAR 313842
.             Added PMSFD030 for 'Use Basic Cover rate'
.   V10.03.03 25/09/2013  J.Tan   CAR 251004
.             Added PMSFD029 for Adm.type used for Accommodation charge
.   V10.03.02 16/08/2013 Davin          CAR 289111
.             Changed pmsfd026 to be numeric (fund excess)
.   V10.03.01 25/02/2013 Ania P         CAR 281021
.             Removed unnecessary modification of constants.
.   V10.00.01 08/08/2010  Davin         CAR 221046
.             Added misamt01-misamt06
.    V9.10.02 16/04/2010 J.Tan          CAR 188189
.             Added Doctor code
.    V9.10.01 30/06/2008 Ebon Clements  CAR 160213
.             Added PMFDXCSS to PMFDCUID 
.    V9.09.02 30/11/2007 Peter Vela     CAR 151897
.             Added Fee Estimation Comments functionality
.    V9.09.01 21/11/2007 J.Tan          CAR 151897
.             Added tags for Multiple bed type/no of days stay
.    V9.08.01 16/01/2007 Peter Vela     CAR 128097
.             Added tag for Casemix Code
.    V9.03.02 10/08/2004 Lina Vo        CAR 51011
.             Fixed Night Stay to show value rather than blank when zero.
.    V9.03.01 30/03/2004 Lina Vo        CAR 47832
.             Fixed Display tags of Health Fund and Table.
.   V10.11.01 04/01/2017  J.Tan   TSK 0844301
.             Added array of items variables
.
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
PMFD0000  BRANCH    FLDITMNO,PMFD0100,PMFD0200,PMFD0300,PMFD0400,PMFD0500:
                             PMFD0600,PMFD0700,PMFD0800,PMFD0900,PMFD1000:
                             PMFD1100,PMFD1200,PMFD1300,PMFD1400,PMFD1500:
                             PMFD1600,PMFD1700,PMFD1800,PMFD1900,PMFD2000:
                             PMFD2100,PMFD2200,PMFD2300,PMFD2400,PMFD2500:
                             PMFD2600,PMFD2700,PMFD2800,PMFD2900,PMFD3000:
                             PMFD3100,PMFD3200,PMFD3300,PMFD3400,PMFD3500

          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMFD9999
.
PMFD0100  WRITE     HTMLFILE;PMFDQUOT;
          GOTO      PMFD9999
.
PMFD0200  MATCH     SP70,PMFDURNO
          GOTO      PMFD9999 IF EQUAL
          WRITE     HTMLFILE;PMFDURNO;
          GOTO      PMFD9999
.
PMFD0300  WRITE     HTMLFILE;PMFDNONS;
          GOTO      PMFD9999
.
PMFD0400  UNPACK    PMFDADAT,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMFDADAT
          GOTO      PMFD9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          GOTO      PMFD9999
.
PMFD0500  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMFD0510,PMFD0520
          WRITE     HTMLFILE;PMFDHFUN;
          GOTO      PMFD9999
.
PMFD0510  PACK      KEY14,PMFDHFUN,ZERO8,SP10
          CALL      RDFUND1
          IF        OVRCD=0
            WRITE     HTMLFILE;HFNAME;      * Description of Fund
          ELSE
            WRITE     HTMLFILE;PMFDHFUN;    * Fund code
          ENDIF
          GOTO      PMFD9999
.
PMFD0520  PACK      KEY14,SP70
          CALL      RDSFUND1
PMFD0525  CALL      RDKFUND1
          BRANCH    OVRCD,PMFD9999
.
          MATCH     HCODE,PMFDHFUN
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",HCODE,"#" selected> ":
                               HCODE,": ",HFNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",HCODE,"#"> ":
                               HCODE,": ",HFNAME,"</option>"
          ENDIF
          GOTO      PMFD0525
.
PMFD0600  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMFD0650
.
          WRITE     HTMLFILE;PMFDHFTB;
          GOTO      PMFD9999
.
PMFD0650  MATCH     "2",PTCNIFCL
          IF        @EQUAL
            MATCH     "1",PMFDUBAS
            IF        @EQUAL
              WRITE     HTMLFILE;"Using Default Cover Rate";
              GOTO      PMFD9999
            ENDIF
          ENDIF
.
          PACK      KEY14,PMFDHFUN,PMFDHFTB,SP10
          CALL      RDFUND1
          IF        OVRCD=0
            WRITE     HTMLFILE;HFNAME;      * Description of Table
          ELSE
            WRITE     HTMLFILE;PMFDHFTB;    * Table code
          ENDIF
          GOTO      PMFD9999
.
PMFD0700  OPEN      PATCMCA1,"patcmcaf"
          PACK      KEY9,PMFDCMCD,SP70
          CALL      RDPTCMC1
          BRANCH    OVRCD,PMFD9999
.
          WRITE     HTMLFILE;PTCADES1;
          GOTO      PMFD9999
.
PMFD0800  MOVE      "CL",CATEGORY
          MOVE      PMFDCLTY,CODE
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD0900  MOVE      "BT",CATEGORY
          MOVE      PMFDBDTY,CODE
          CALL      SFBT0000
          BRANCH    EXIT,PMFD9999
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD1000  MOVE      "A ",CATEGORY
          MOVE      PMFDATYP,CODE
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD1100  COMPARE   "1",PMFDAGST
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PMFD9999
.
PMFD1200  WRITE     HTMLFILE;PMFDCMCD;      
          GOTO      PMFD9999
.
PMFD1300  MOVE      "BT",CATEGORY
          MOVE      PMFDBDT2,CODE
          CALL      SFBT0000            * Bed type for Fees Estimate
          BRANCH    EXIT,PMFD9999
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD1400  MOVE      "BT",CATEGORY
          MOVE      PMFDBDT3,CODE
          CALL      SFBT0000            * Bed type for Fees Estimate
          BRANCH    EXIT,PMFD9999
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD1500  MOVE      "BT",CATEGORY
          MOVE      PMFDBDT4,CODE
          CALL      SFBT0000            * Bed type for Fees Estimate
          BRANCH    EXIT,PMFD9999
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD1600  MOVE      "BT",CATEGORY
          MOVE      PMFDBDT5,CODE
          CALL      SFBT0000            * Bed type for Fees Estimate
          BRANCH    EXIT,PMFD9999
          CALL      CODITM00
          GOTO      PMFD9999
.
PMFD1700  WRITE     HTMLFILE;PMFDNDS2;
          GOTO      PMFD9999
.
PMFD1800  WRITE     HTMLFILE;PMFDNDS3;
          GOTO      PMFD9999
.
PMFD1900  WRITE     HTMLFILE;PMFDNDS4;
          GOTO      PMFD9999
.
PMFD2000  WRITE     HTMLFILE;PMFDNDS5;
          GOTO      PMFD9999
.
PMFD2100  WRITE     HTMLFILE;PMFDCMN1;
          GOTO      PMFD9999
.
PMFD2200  WRITE     HTMLFILE;PMFDCMN2;
          GOTO      PMFD9999
.
PMFD2300  WRITE     HTMLFILE;PMFDCMN3;
          GOTO      PMFD9999
.
PMFD2400  WRITE     HTMLFILE;PMFDCMN4;
          GOTO      PMFD9999
.
PMFD2500  WRITE     HTMLFILE;PMFDCMN5;
          GOTO      PMFD9999
.
PMFD2600  WRITE     HTMLFILE;PMFDXCSS;
          GOTO      PMFD9999
.
PMFD2700  UNPACK    PMFDEXPD,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMFDEXPD
          GOTO      PMFD9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMFD9999
.
PMFD2800  UNPACK    PMFDCDAT,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PMFDCDAT
          GOTO      PMFD9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMFD9999
.
PMFD2900  WRITE     HTMLFILE;PMFDCTIM;
          GOTO      PMFD9999
.
PMFD3000  MATCH     SP70,PMFDCUID
          GOTO      PMFD9999 IF EQUAL
          PACK      KEY10,PMFDCUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMFDCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMFD9999
.
PMFD3100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMFD3110
          PACK      KEY10,PMFDDOCT,SP30
          CALL      RDPMHCP1
          BRANCH    OVRCD,PMFD9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      PMFD9999
.
PMFD3110  WRITE     HTMLFILE;PMFDDOCT;
          GOTO      PMFD9999
.
PMFD3200  WRITE     HTMLFILE;PMFDACHR;
          GOTO      PMFD9999
.
PMFD3300  WRITE     HTMLFILE;PMFDUBAS;
          GOTO      PMFD9999
.
PMFD3400  OPEN      PATCMCA1,"patcmcaf"
          PACK      KEY9,PMFDCMCD,SP70
          CALL      RDPTCMC1
          BRANCH    OVRCD,PMFD9999
.
          WRITE     HTMLFILE;PTCAELOS;
          GOTO      PMFD9999
.
PMFD3500  MOVE      ZERO,F1
          PACK      KEY5,ANSC,ANSL,PMFDCLTY,SP70
          CALL      RDCODE1
          IF        OVRCD=0
            MATCH     "3",TCINDC5
            IF        @EQUAL
              MOVE      ONE,F1              * Self Insured patient
            ENDIF
          ENDIF
          WRITE     HTMLFILE;F1;
          GOTO      PMFD9999
.
PMFD9999  RETURN
.------------------------------------------------------------
.   Selection of Fees Estimate bed types
.------------------------------------------------------------
SFBT0000  MOVE      ZERO,EXIT
          MOVE      DIM127,DIM127A
          UNPACK    DIM127A,D1,KEY1,DIM127A
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          COMPARE   TWO,F1
          GOTO      SFBT8000 IF NOT EQUAL
.
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>"
.
          MOVE      "BT",KEY2
          PACK      PTCDKEY2,KEY2,SP70
          CALL      RDSCODE2
SFBT2000  CALL      RDKCODE2
          BRANCH    OVRCD,SFBT9000
          MATCH     KEY2,TCODE
          GOTO      SFBT9000 IF NOT EQUAL
.
          MATCH     SP70,ACODE
          GOTO      SFBT2000 IF EQUAL
.
          MATCH     "I",PTCOACTV
          GOTO      SFBT2000 IF EQUAL      * In-active
.
          IF        IBCNMHOS=1
            MATCH    "1",PTCDHOSS
            IF       @EQUAL
              PACK     KEY8,WBSEHOSP,TCODE,ACODE,SP70
              CALL     RDMLCOD1
              BRANCH   OVRCD,SFBT2000
            ENDIF
          ENDIF
.
          COMPARE   TWO,TCFORM6
          GOTO      SFBT4000 IF EQUAL      * other bed type with additional fee
.
          COMPARE   ONE,TCFORM6
          GOTO      SFBT2000 IF NOT EQUAL  * not a valid fees estimates bedtype
.
SFBT4000  PACK      KEY30,QUOTE,ACODE,KEY25,QUOTE
.
.         F1=1, first Bed type default to Private bed type
.
          MATCH     CODE,ACODE
          IF        @EQUAL
            MOVE      ZERO,F1
            WRITE     HTMLFILE;"<option value=",KEY30," selected>":
                               TDESC,"</option>"
            GOTO      SFBT2000
          ENDIF
.
          WRITE     HTMLFILE;"<option value=",KEY30,">",TDESC,"</option>"
          GOTO      SFBT2000
.
SFBT8000  MOVE      ZERO,EXIT
          GOTO      SFBT9999
.
SFBT9000  MOVE      ONE,EXIT
SFBT9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for pmsfedaf file
.------------------------------------------------------------
SPMFD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMFD010,SPMFD020,SPMFD030,SPMFD040,SPMFD050:
                       SPMFD060,SPMFD070,SPMFD080,SPMFD090,SPMFD100:
                       SPMFD110,SPMFD120,SPMFD130,SPMFD140,SPMFD150: 
                       SPMFD160,SPMFD170,SPMFD180,SPMFD190,SPMFD200:
                       SPMFD999,SPMFD999,SPMFD999,SPMFD999,SPMFD999:
                       SPMFD260,SPMFD270,SPMFD280,SPMFD290,SPMFD300
.                      
          MOVE      ONE,EXIT
          GOTO      SPMFD999
.
SPMFD010  MOVE      QRYDATA,PMSFD001
          GOTO      SPMFD999
.
SPMFD020  MOVE      QRYDATA,PMSFD002
          GOTO      SPMFD999
.
SPMFD030  MOVE      QRYDATA,PMSFD003
          GOTO      SPMFD999
.
SPMFD040  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSFD004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMFD999
.
SPMFD050  MOVE      QRYDATA,PMSFD005
          GOTO      SPMFD999
.
SPMFD060  MOVE      QRYDATA,PMSFD006
          GOTO      SPMFD999
.
SPMFD070  MOVE      QRYDATA,PMSFD007
          GOTO      SPMFD999
.
SPMFD080  MOVE      QRYDATA,PMSFD008
          GOTO      SPMFD999
.
SPMFD090  MOVE      QRYDATA,PMSFD009
          GOTO      SPMFD999
.
SPMFD100  MOVE      QRYDATA,PMSFD010
          GOTO      SPMFD999
.
SPMFD110  MOVE      QRYDATA,PMSFD011
          GOTO      SPMFD999
.
SPMFD120  MOVE      QRYDATA,PMSFD012
          GOTO      SPMFD999
.
SPMFD130  MOVE      QRYDATA,PMSFD013
          GOTO      SPMFD999
.
SPMFD140  MOVE      QRYDATA,PMSFD014
          GOTO      SPMFD999
.
SPMFD150  MOVE      QRYDATA,PMSFD015
          GOTO      SPMFD999
.
SPMFD160  MOVE      QRYDATA,PMSFD016
          GOTO      SPMFD999
.
SPMFD170  MOVE      QRYDATA,PMSFD017
          GOTO      SPMFD999
.
SPMFD180  MOVE      QRYDATA,PMSFD018
          GOTO      SPMFD999
.
SPMFD190  MOVE      QRYDATA,PMSFD019
          GOTO      SPMFD999
.
SPMFD200  CALL      GETFED00
          GOTO      SPMFD999
.
SPMFD260  MOVE      QRYDATA,PMSFD026
          GOTO      SPMFD999
.
SPMFD270  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMSFD027,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMFD999
.
SPMFD280  MOVE      QRYDATA,PMSFD028
          GOTO      SPMFD999
.
SPMFD290  MOVE      QRYDATA,PMSFD029
          GOTO      SPMFD999
.
SPMFD300  MOVE      QRYDATA,PMSFD030
          GOTO      SPMFD999
.
SPMFD999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters 
.------------------------------------------------------------
CPMFD000  MOVE      Z70,PMSFD001
          MOVE      Z70,PMSFD002
          MOVE      Z70,PMSFD003
          MOVE      Z70,PMSFD004 
          MOVE      Z70,PMSFD005
          MOVE      Z70,PMSFD006
          MOVE      Z70,PMSFD007
          MOVE      Z70,PMSFD008
          MOVE      Z70,PMSFD009
          MOVE      Z70,PMSFD010
          MOVE      Z70,PMSFD011
          MOVE      Z70,PMSFD012
          MOVE      Z70,PMSFD013
          MOVE      Z70,PMSFD014
          MOVE      Z70,PMSFD015
          MOVE      Z70,PMSFD016
          MOVE      Z70,PMSFD017
          MOVE      Z70,PMSFD018
          MOVE      Z70,PMSFD019
          MOVE      Z70,PMSFD021
          MOVE      Z70,PMSFD022
          MOVE      Z70,PMSFD023
          MOVE      Z70,PMSFD024
          MOVE      Z70,PMSFD025
          MOVE      ZERO,PMSFD026
          MOVE      Z70,PMSFD027
          MOVE      Z70,PMSFD028
          MOVE      Z70,PMSFD029
          MOVE      Z70,PMSFD030
.
          MOVE      ONE,F3
          WHILE     F3 <= 99
            MOVE      Z70,MISAMT[F3]
            MOVE      Z70,MISCHG[F3]
            MOVE      ZERO,MISQUA[F3]
            MOVE      Z70,GSTAPM[F3]
            MOVE      Z70,GSTCOM[F3]
            MOVE      Z70,THEFEE[F3]
            MOVE      ZERO,THEQUA[F3]
            MOVE      Z70,GSTAPL[F3]
            MOVE      Z70,GSTCOD[F3]
.
            MOVE      Z70,GSTTKY[F3]
            MOVE      Z70,GSTTAP[F3]
            MOVE      Z70,GSTTCD[F3]
.
            MOVE      Z70,KEYAMT[F3]
            MOVE      Z70,GSTMKY[F3]
            MOVE      Z70,GSTMAP[F3]
            MOVE      Z70,GSTMCD[F3]
            ADD       ONE,F3
          DO
.
          RETURN
.
.------------------------------------------------------------
.  Update 
.------------------------------------------------------------
UPPMFD00  MATCH     PMSFD001,Z70  
          IF        !@EQUAL
            MOVE       PMSFD001,PMFDQUOT
          ENDIF
.
          MATCH     PMSFD002,Z70
          IF        !@EQUAL
            MOVE      PMSFD002,PMFDURNO
          ENDIF
.
          MATCH     PMSFD003,Z70   
          IF        !@EQUAL
            MOVE      PMSFD003,PMFDNONS
          ELSE
            MOVE      ZERO,PMFDNONS
          ENDIF
.
          MATCH     PMSFD004,Z70
          IF        !@EQUAL
            MOVE      PMSFD004,PMFDADAT
          ENDIF
.
          MATCH     PMSFD005,Z70
          IF        !@EQUAL
            PACK      PMFDHFUN,PMSFD005,SP70
          ENDIF
.
          MATCH     PMSFD006,Z70   
          IF        !@EQUAL
            PACK      PMFDHFTB,PMSFD006,SP70
          ENDIF
.
          MATCH     PMSFD007,Z70
          IF        !@EQUAL
            PACK      PMFDCMCD,PMSFD007,SP70
          ENDIF
.
          MATCH     PMSFD008,Z70
          IF        !@EQUAL
            PACK      PMFDCLTY,PMSFD008,SP70
          ENDIF
.
          MATCH     PMSFD009,Z70
          IF        !@EQUAL
            PACK      PMFDBDTY,PMSFD009,SP70
          ENDIF
.
          MATCH     PMSFD010,Z70
          IF        !@EQUAL
            PACK      PMFDATYP,PMSFD010,SP70
          ENDIF
.
          MATCH     PMSFD011,Z70
          IF        !@EQUAL
            MOVE      PMSFD011,PMFDAGST
          ELSE
            MOVE      ZERO,PMFDAGST
          ENDIF
.
          MATCH     PMSFD012,Z70
          IF        !@EQUAL
            PACK      PMFDBDT2,PMSFD012,SP70
          ENDIF
.
          MATCH     PMSFD013,Z70
          IF        !@EQUAL
            PACK      PMFDBDT3,PMSFD013,SP70
          ENDIF
.
          MATCH     PMSFD014,Z70
          IF        !@EQUAL
            PACK      PMFDBDT4,PMSFD014,SP70
          ENDIF
.
          MATCH     PMSFD015,Z70
          IF        !@EQUAL
            PACK      PMFDBDT5,PMSFD015,SP70
          ENDIF
.
          MATCH     PMSFD016,Z70   
          IF        !@EQUAL
            MOVE      PMSFD016,PMFDNDS2
          ELSE
            MOVE      ZERO,PMFDNDS2
          ENDIF
.
          MATCH     PMSFD017,Z70   
          IF        !@EQUAL
            MOVE      PMSFD017,PMFDNDS3
          ELSE
            MOVE      ZERO,PMFDNDS3
          ENDIF
.
          MATCH     PMSFD018,Z70   
          IF        !@EQUAL
            MOVE      PMSFD018,PMFDNDS4
          ELSE
            MOVE      ZERO,PMFDNDS4
          ENDIF
.
          MATCH     PMSFD019,Z70   
          IF        !@EQUAL
            MOVE      PMSFD019,PMFDNDS5
          ELSE
            MOVE      ZERO,PMFDNDS5
          ENDIF
.
          CALL      ADDFED00
.
.         HEA fees estimate layout will have Reason for Admission stored in
.         Comment line 5
.
          MATCH     "1",PTCNIFCL
          IF        @EQUAL
            PACK      PMFDCMN5,REASADMN,SP70
          ENDIF
.
          MOVE     PMSFD026,PMFDXCSS 
.
          MATCH     PMSFD027,Z70
          IF        !@EQUAL
            PACK      PMFDEXPD,PMSFD027,SP70
          ENDIF
.
          MATCH     PMSFD028,Z70
          IF        !@EQUAL
            PACK      PMFDDOCT,PMSFD028,SP70
          ENDIF
.
          MATCH     PMSFD029,Z70
          IF        !@EQUAL
            PACK      PMFDACHR,PMSFD029,SP70
          ENDIF
.
          MATCH     PMSFD030,Z70
          IF        !@EQUAL
            PACK      PMFDUBAS,PMSFD030,SP70
          ENDIF
.
UPPMFD99  CLOSE     FEDCOMAF,DELETE
          RETURN
+
.-------------------------------------------------------------------
.   Add Fee Estimation text
.------------------------------------------------------------------
ADDFED00  COMPARE   ZERO,FEDCOMFL     * No Comments in Update Ignore
          GOTO      ADDFED99 IF EQUAL
          MOVE      ZERO,F3
          MOVE      SP70,PMSFD021
          MOVE      SP70,PMSFD022
          MOVE      SP70,PMSFD023
          MOVE      SP70,PMSFD024
.
.   HEA fees estimate layout will have Reason for Admission stored in
.   Comment line 5
.
          MATCH     "1",PTCNIFCL      * HEA Fees Estimate Layout
          IF        !@EQUAL
            MOVE      SP70,PMSFD025
          ENDIF
.
ADDFED10  ADD       ONE,F3
          MOVE      SP70,DIM70
          READ      FEDCOMAF,SEQ;DIM70
          GOTO      ADDFED80 IF OVER
          MATCH     "1",PTCNIFCL      * HEA Fees Estimate Layout
          IF        @EQUAL
            STORE     DIM70,F3,PMSFD021,PMSFD022,PMSFD023,PMSFD024
          ELSE
            STORE     DIM70,F3,PMSFD021,PMSFD022,PMSFD023,PMSFD024,PMSFD025
          ENDIF
          GOTO      ADDFED10
.
ADDFED80  MOVE      PMSFD021,PMFDCMN1
          MOVE      PMSFD022,PMFDCMN2
          MOVE      PMSFD023,PMFDCMN3
          MOVE      PMSFD024,PMFDCMN4
.
          MATCH     "1",PTCNIFCL      * HEA Fees Estimate Layout
          GOTO      ADDFED99 IF EQUAL
.
          MOVE      PMSFD025,PMFDCMN5
.
ADDFED99  RETURN
.------------------------------------------------------------
.   Set Parameters for Misc.items
.------------------------------------------------------------
SMCHG000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      MISCHG[F2],QRYDATA,SP70
SMCHG999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Misc.items quantity
.------------------------------------------------------------
SMQUA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          SQUEEZE   QRYDATA
          MOVE      QRYDATA,MISQUA[F2]
SMQUA999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Keyin Misc.items GST 
.------------------------------------------------------------
SGAMK000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      GSTMKY[F2],QRYDATA,SP70
SGAMK999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Misc.items GST Applicable
.------------------------------------------------------------
SGAPM000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      GSTAPM[F2],QRYDATA,SP70
SGAPM999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Misc.items GST CODE
.------------------------------------------------------------
SMGST000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      GSTCOM[F2],QRYDATA,SP70
SMGST999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Theatre fee code
.------------------------------------------------------------
STFEE000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      THEFEE[F2],QRYDATA,SP70
          PACK      KEY9,QRYDATA,SP70
STFEE999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Theatre fee quantity
.------------------------------------------------------------
STQUA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          SQUEEZE   QRYDATA
          MOVE      QRYDATA,THEQUA[F2]
STQUA999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Keyin Theatre fee GST
.------------------------------------------------------------
SGATK000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      GSTTKY[F2],QRYDATA,SP70
SGATK999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Theatre fee GST Applicable
.------------------------------------------------------------
SGAPL000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      GSTAPL[F2],QRYDATA,SP70
SGAPL999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for Theatre fee GST Code
.------------------------------------------------------------
SGCOD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          PACK      GSTCOD[F2],QRYDATA,SP70
SGCOD999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Keyin Misc.items amount
.------------------------------------------------------------
SKAMT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          SQUEEZE   QRYDATA
          MOVE      QRYDATA,KEYAMT[F2]
SKAMT999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for Misc.items amount
.------------------------------------------------------------
SMAMT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY6,KEY2
          MOVE      KEY2,F2
          SQUEEZE   QRYDATA
          MOVE      QRYDATA,MISAMT[F2]
SMAMT999  RETURN
+
.*******************************************************************************
.                 Get Fee Estimation Comments
.*******************************************************************************
GETFED00  PREP      FEDCOMAF,FEDCOMNM
          MOVE      ONE,F3
          WRITE     FEDCOMAF,SEQ;QRYDATA
          MOVE      ONE,FEDCOMFL
.
GETFED10  READ      CONFFILE,SEQ;QRYNAME,QRYDATA
          GOTO      GETFED90 IF OVER
          MATCH     SP70,QRYNAME
          GOTO      GETFED80 IF NOT EQUAL
          MATCH     SP70,QRYDATA
          GOTO      GETFED10 IF EQUAL
          GOTO      GETFED10 IF EOS
          ADD       ONE,F3
          WRITE     FEDCOMAF,SEQ;QRYDATA
          GOTO      GETFED10
.
GETFED80  MOVE      ONE,TEXTAREA                 * Flag for Next CGI Parameter
GETFED90  MOVE      F3,LASTFEDP
          OPEN      FEDCOMAF,FEDCOMNM
GETFED99  RETURN
