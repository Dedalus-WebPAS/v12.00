.---------------------------------------------------------------------------
. CSIWSA - check security for a Warehouse
.          Requires: PASSCODE (user id)
.                    SIWAWAR  (Warehouse Code)
.          Returns : OVRCD=1 if no access to that warehouse
.---------------------------------------------------------------------------
CSIWSA00  PACK      KEY9,PASSCODE,SP70
          CALL      RDSIWS1
          IF        OVRCD=1
            PACK      KEY9,PASSCODE,SIWAWAR,SP70
            CALL      RDSIWS1
          ENDIF
.
CSIWSA99  RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINWSEKY
.   Routine   :   KSIWSA00 Keyin Warehouse Code and Check Security
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSIWSA00 TOPIC     "SIWAWAR"
          DISPLAY   *PCCOL:CVERT,*V2LON,SIWAWAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,SIWAWAR
.
          ENDSET    SIWAWAR
          APPEND    SP70,SIWAWAR
          RESET     SIWAWAR
.
          MATCH     SP70,SIWAWAR
          GOTO      KSIWSA90 IF EQUAL
.
          CMATCH    EXITCHAR,SIWAWAR
          GOTO      KSIWSA95 IF EQUAL
.
          CMATCH    QUEST,SIWAWAR
          GOTO      KSIWSA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSIWSA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SIWAWAR
          APPEND    SP70,SIWAWAR
          RESET     SIWAWAR
.
          MATCH     SP70,SIWAWAR
          GOTO      KSIWSA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SIWAWAR                                
KSIWSA10
          PACK      KEY5,SIWAWAR                                               
          CALL      RASIWA1 
          BRANCH    OVRCD,KSIWSA80
          BRANCH    CKEYTYP,KSIWSA75
          CALL      RDSIWA1
.
          CALL      CSIWSA00           * check security
          IF        OVRCD=1
            MOVE      "You Have No Access To That Warehouse - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KSIWSA00
          ENDIF
KSIWSA70
          MOVE      ZERO,EXIT
          GOTO      KSIWSA99
KSIWSA75
          MOVE      "Warehouse Already Exists - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSIWSA00
KSIWSA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSIWSA99,KSIWSA99
          MOVE      "Warehouse Does Not Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KSIWSA00
KSIWSA90
          MOVE      ONE,EXIT
          GOTO      KSIWSA99
KSIWSA95
          MOVE      TWO,EXIT
KSIWSA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Supply and Inventory               
.   Include   :   SINWSEKY
.   Routine   :   HSIWSA00 Warehouse           
.   Return    :           
.-------------------------------------------------------------------------------
HSIWSA00
          MOVE      ZERO,CSCRSIZ
          MOVE      "10",HTOP
          MOVE      "24",HBOT
          MOVE      "01",HLEF
          MOVE      "80",HRIG
HSIWSA04
          CALL      GSCRN000
          BRANCH    EXIT,HSIWSA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"W/H"                
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "41",STDCOL03
HSIWSA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SIWAWAR
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          CALL      RSSIWA1 
HSIWSA10
          CALL      RKSIWA1 
          BRANCH    OVRCD,HSIWSA15
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA10
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HSIWSA12
          CALL      HSIWSA60
          BRANCH    OVRCD,HSIWSA10
HSIWSA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SIWAWAR
          DISPLAY   *PSTDCOL02:STDROW,SIWADES
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSIWSA10 IF NOT EQUAL
HSIWSA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSIWSA20
          CALL      HSCRI000
          BRANCH    EXIT,HSIWSA30,HSIWSA35,HSIWSA40,HSIWSA45,HSIWSA04:
                              HSIWSA91,HSIWSA50
          GOTO      HSIWSA92
HSIWSA30
          CALL      RKSIWA1 
          BRANCH    OVRCD,HSIWSA85
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA30
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          CALL      RPSIWA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWSA10
HSIWSA35
          MOVE      ST1,KEY5 
          CALL      RDSIWA1 
HSIWSA3A  CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWSA85
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA3A
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSIWSA36
          CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWSA37
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA36
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIWSA36 IF NOT EQUAL
HSIWSA37
          MOVE      ZERO,XITEMNO
          GOTO      HSIWSA10
HSIWSA40
          MOVE      ST1,KEY5 
          CALL      RDSIWA1 
HSIWSA4A  CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWSA85
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA4A
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWSA08
HSIWSA45
          CALL      RKSIWA1 
          BRANCH    OVRCD,HSIWSA85
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA45
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY5,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSIWA1 
HSIWSA46
          CALL      RPSIWA1 
          BRANCH    OVRCD,HSIWSA47
.
          CALL      CSIWSA00           * check security
          BRANCH    OVRCD,HSIWSA46
          PACK      KEY5,SIWAWAR,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSIWSA46 IF NOT EQUAL
HSIWSA47
          MOVE      ZERO,XITEMNO
          GOTO      HSIWSA10
HSIWSA50  COMPARE   ZERO,CSEARCH
          GOTO      HSIWSA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWSA08
HSIWSA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSIWSA08
HSIWSA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSIWSA61 IF EQUAL
          MATCH     SCHFLD01,SIWAWAR
          GOTO      HSIWSA72 IF NOT EQUAL
HSIWSA61
          MATCH     SP70,SCHFLD02
          GOTO      HSIWSA62 IF EQUAL
          MATCH     SCHFLD02,SIWADES
          GOTO      HSIWSA72 IF NOT EQUAL
HSIWSA62
HSIWSA63
HSIWSA64
HSIWSA65
HSIWSA66
HSIWSA67
HSIWSA68
HSIWSA69
HSIWSA70
          GOTO      HSIWSA75
HSIWSA72  MOVE      ONE,OVRCD
HSIWSA75  RETURN
HSIWSA85
          LOAD      KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SIWAWAR                                               
          CALL      RDSIWA1 
HSIWSA90
.                                                                               
          BEEP
          GOTO      HSIWSA20
HSIWSA91
          MOVE      SP70,SIWADES
          MOVE      ZERO,SIWATYP
          MOVE      ZERO,SIWACTY
          MOVE      ZERO,SIWAPTY  
          MOVE      SP70,SIWALED
          MOVE      SP70,SIWAIACC
          MOVE      SP70,SIWAPACC
          MOVE      SP70,SIWADISS
          MOVE      SP70,SIWARESP 
          MOVE      SP70,SIWAUR1 
          MOVE      SP70,SIWAMUAC 
          MOVE      ZERO,SIWANAT  
          MOVE      SP70,SIWAUD1 
          MOVE      SP70,SIWAUD2 
          MOVE      SP70,SIWAUC1 
          MOVE      SP70,SIWAUC2 
          MOVE      SP70,SIWAUY1 
          MOVE      SP70,SIWAUY2 
          MOVE      ZERO,SIWAPIC  
          MOVE      ZERO,SIWAPA1  
          MOVE      ZERO,SIWAPA2  
          MOVE      ZERO,SIWAPA3  
          MOVE      ZERO,SIWAPA4  
          MOVE      SP70,SIWANPO  
          MOVE      SP70,SIWASTA 
          MOVE      SP70,SIWAPSH 
          MOVE      SP70,KEY5 
          MOVE      SP70,SIWAWAR
          GOTO      HSIWSA96
HSIWSA92
          MOVE      SP70,KEY5 
          MOVE      SP70,SIWAWAR
          LOAD      KEY5,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SIWAWAR                                               
HSIWSA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSIWSA99
          RETURN
