.***********************************************************************
.*                          PATTMADS                                   *
.***********************************************************************
PATTMADS  DISPLAY   *P1:4,*EF,*P30:4,*V2LON,*ULON,"Team Codes"          
          MOVE      FIVE,CVERT
          MOVE      ONE,CCOL
.
          MOVE      SP6,KEY6
          CALL      RSPTTMA1                         * positional read
.
.  -----  read through group file  -----
.
PTTMA100   CALL      RKPTTMA1                         * read next record
           BRANCH    OVRCD,PTTMA800                    * end of file reached
.
PTTMA200   MOVE      PTTADESC,DIM30
.
.  -----  display codes and descriptions  -----
.
.
          DISPLAY   *PCCOL:CVERT,*V2LON,PTTATEAM,*HOFF,SP2,DIM30
          ADD       ONE,CVERT
          COMPARE   TWENTY3,CVERT                     *enough room on screen
          GOTO      PTTMA100 IF LESS                  *Yes
.
          COMPARE   FORTY,CCOL
          GOTO      PTTMA500 IF EQUAL
.
          MOVE      FORTY,CCOL
          MOVE      FIVE,CVERT
          GOTO      PTTMA100
.
.
.         Screen is full.Ask user what they want to do
.
PTTMA500  KEYIN     *P1:24,*EL," (",*V2LON,"C",*HOFF,")ontinue, (":
                    *V2LON,"N",*HOFF,")ext Screen, (":
                    *V2LON,"F",*HOFF,")irst Screen : ",*V2LON,ANS;
.
          REP       UPPLOW,ANS                        * upper or lower case
          CMATCH    ANSC,ANS                           *continue
          GOTO      PTTMA800 IF EQUAL                  *Yes
.
          CMATCH    ANSF,ANS                           *first screen  
          GOTO      PATTMADS IF EQUAL                  *Yes  
.        
.         Anything else assume next screen
.
          MOVE      FIVE,CVERT                         *start at top of screen
          MOVE      ONE,CCOL
          DISPLAY   *P1:CVERT,*EF;                     *erase current screen
          GOTO      PTTMA100                           *get next record
.
.         Finished displaying file
.
PTTMA800  MOVE      FALSE,EXIT                         *data was displayed
          MOVE      ZERO,OVRCD
          GOTO      PTTMA999
.
.         No data on file
.
PTTMA900  DISPLAY   *P1:24,*EL,*B,"No data currently on file.   ";
          BEEP
          CALL      HITENTER
          MOVE      TRUE,EXIT                          *no data on file
.
PTTMA999  RETURN
.
.
