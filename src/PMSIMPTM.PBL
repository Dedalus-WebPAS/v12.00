. *-----------------------------------------------------------------------------
. * Include Name  :  PMSIMPTM.PBL
. *
. * Function      :  CGI Variables for PMSIMPFD - pmsimpaf
. *
. * Mods
. * V10.12.01 04/04/2018 Tracey Nguyen     TSK 0841644
. *           Added Impairment Group Code (PMIMGCDE/PMIMP013)          
. * V10.03.01 04/05/2012 Davin             CAR 260600
. *           Added HDP Equivalent
. * V10.03.00 05/03/2012 Patrick Adair     CAR 257776
. *           Created include
. *-----------------------------------------------------------------------------
.-------------------------------------------------------------------------------
. Clear Impairment Code Parameters
.-------------------------------------------------------------------------------
CPPMIM00  MOVE      Z70,PMIMP001
          MOVE      Z70,PMIMP002
          MOVE      Z70,PMIMP003
          MOVE      Z70,PMIMP004
          MOVE      Z70,PMIMP005
          MOVE      Z70,PMIMP012
          MOVE      Z70,PMIMP013
.
CPPMIM99  RETURN
.
.-------------------------------------------------------------------------------
. Set Impairment Code Parameters
.-------------------------------------------------------------------------------
SPPMIM00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMIM01,SPPMIM02,SPPMIM03,SPPMIM04,SPPMIM05:
                       SPPMIM99,SPPMIM99,SPPMIM99,SPPMIM99,SPPMIM99:
                       SPPMIM99,SPPMIM12,SPPMIM13
          GOTO      SPPMIM99
.
SPPMIM01  PACK      PMIMP001,QRYDATA,SP70
          GOTO      SPPMIM99
.
SPPMIM02  PACK      PMIMP002,QRYDATA,SP70
          GOTO      SPPMIM99
.
SPPMIM03  PACK      PMIMP003,QRYDATA,SP70
          GOTO      SPPMIM99
.
SPPMIM04  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMIMP004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMIM99
.
SPPMIM05  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMIMP005,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMIM99
.
SPPMIM12  PACK      PMIMP012,QRYDATA,SP70
          GOTO      SPPMIM99
.
SPPMIM13  PACK      PMIMP013,QRYDATA,SP70
          GOTO      SPPMIM99
.
SPPMIM99  RETURN
.
.-------------------------------------------------------------------------------
. Output Impairment Code tags
.-------------------------------------------------------------------------------
PMIM0000  BRANCH    FLDITMNO,PMIM0100,PMIM0200,PMIM0300,PMIM0400,PMIM0500:
                             PMIM0600,PMIM0700,PMIM0800,PMIM0900,PMIM1000:
                             PMIM1100,PMIM1200,PMIM1300
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMIM9999
.
PMIM0100  WRITE     HTMLFILE;PMIMCODE;
          GOTO      PMIM9999
.
PMIM0200  WRITE     HTMLFILE;PMIMDESC;
          GOTO      PMIM9999
.
PMIM0300  WRITE     HTMLFILE;PMIMACTV;
          GOTO      PMIM9999
.
PMIM0400  MATCH     PMIMDACT,SP70
          GOTO      PMIM9999 IF EQUAL
          UNPACK    PMIMDACT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMIM9999
.
PMIM0500  MATCH     PMIMDIAC,SP70
          GOTO      PMIM9999 IF EQUAL
          UNPACK    PMIMDIAC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDIAC,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDIAC;
          GOTO      PMIM9999
.
PMIM0600  WRITE     HTMLFILE;PMIMCUID;
          GOTO      PMIM9999
.
PMIM0700  MATCH     PMIMCDAT,SP70
          GOTO      PMIM9999 IF EQUAL
          UNPACK    PMIMCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPCDAT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPCDAT;
          GOTO      PMIM9999
.
PMIM0800  WRITE     HTMLFILE;PMIMCTIM;
          GOTO      PMIM9999
.
PMIM0900  WRITE     HTMLFILE;PMIMUUID;
          GOTO      PMIM9999
.
PMIM1000  MATCH     PMIMUDAT,SP70
          GOTO      PMIM9999 IF EQUAL
          UNPACK    PMIMUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPUDAT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPUDAT;
          GOTO      PMIM9999
.
PMIM1100  WRITE     HTMLFILE;PMIMUTIM;
          GOTO      PMIM9999
.
PMIM1200  WRITE     HTMLFILE;PMIMHDPE;
          GOTO      PMIM9999
.
PMIM1300  WRITE     HTMLFILE;PMIMGCDE;
          GOTO      PMIM9999
.
PMIM9999  RETURN
.
.-------------------------------------------------------------------------------
. Move Impairment Code cgi variables to file variables
.-------------------------------------------------------------------------------
MVPMIM00  MATCH     Z70,PMIMP001
          IF        !@EQUAL
            MOVE      PMIMP001,PMIMCODE
          ENDIF
.
          MATCH     Z70,PMIMP002
          IF        !@EQUAL
            MOVE      PMIMP002,PMIMDESC
          ENDIF
.
          MATCH     Z70,PMIMP003
          IF        !@EQUAL
            MOVE      PMIMP003,PMIMACTV
          ENDIF
.
          MATCH     Z70,PMIMP004
          IF        !@EQUAL
            MOVE      PMIMP004,PMIMDACT
          ENDIF
.
          MATCH     Z70,PMIMP005
          IF        !@EQUAL
            MOVE      PMIMP005,PMIMDIAC
          ENDIF
.
          MATCH     Z70,PMIMP012
          IF        !@EQUAL
            MOVE      PMIMP012,PMIMHDPE
          ENDIF
.
          MATCH     Z70,PMIMP013
          IF        !@EQUAL
            MOVE      PMIMP013,PMIMGCDE
          ENDIF
.
MVPMIM99  RETURN
.
.-------------------------------------------------------------------------------
. Clear Impairment Code file variables
.-------------------------------------------------------------------------------
CLPMIM00  MOVE      SP70,PMIMCODE
          MOVE      SP70,PMIMDESC
          MOVE      SP70,PMIMACTV
          MOVE      SP70,PMIMDACT
          MOVE      SP70,PMIMDIAC
          MOVE      SP70,PMIMCUID
          MOVE      SP70,PMIMCDAT
          MOVE      SP70,PMIMCTIM
          MOVE      SP70,PMIMUUID
          MOVE      SP70,PMIMUDAT
          MOVE      SP70,PMIMUTIM
          MOVE      SP70,PMIMHDPE
          MOVE      SP70,PMIMGCDE
.
CLPMIM99  RETURN
