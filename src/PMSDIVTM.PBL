. *----------------------------------------------------------------------
. * Include Name  :   PMSDIVTM.PBL
. *
. * Function      :   CGI variables for PMSDIVFD - pmsdivaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.02.01  04/07/2011  Davin         CAR 240723
.             Created include
.------------------------------------------------------------------------
.   Clear parameters for divisions file
.------------------------------------------------------------------------
CPPMDI00  MOVE      Z70,PMDIV001
          MOVE      Z70,PMDIV002
          MOVE      Z70,PMDIV003
          MOVE      Z70,PMDIV004
          MOVE      Z70,PMDIV005
CPPMDI99  RETURN
.------------------------------------------------------------
. Tags for divisions table
.------------------------------------------------------------
PMDI0000  BRANCH    FLDITMNO,PMDI0010,PMDI0020,PMDI0030,PMDI0040,PMDI0050:
                             PMDI0060,PMDI0070,PMDI0080,PMDI0090,PMDI0100:
                             PMDI0110
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMDI9999
.
PMDI0010  WRITE     HTMLFILE;PMDIHOSP;
          GOTO      PMDI9999
.
PMDI0020  MOVE      "dv",CATEGORY
          MOVE      PMDIDIVN,CODE
          CALL      CODITM00
          GOTO      PMDI9999
.
PMDI0030  MOVE      "AC",CATEGORY
          MOVE      PMDIUNIT,CODE
          CALL      CODITM00
          GOTO      PMDI9999
.
PMDI0040  WRITE     HTMLFILE;PMDITEAM;
          GOTO      PMDI9999
.
PMDI0050  WRITE     HTMLFILE;PMDIACTV;
          GOTO      PMDI9999
.
PMDI0060  MATCH     SP70,PMDICUID
          GOTO      PMDI9999 IF EQUAL
.
          PACK      KEY10,PMDICUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMDICUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMDI9999
.
PMDI0070  MATCH     PMDICDAT,SP70
          GOTO      PMDI9999 IF EQUAL
.
          UNPACK    PMDICDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDI9999
.
PMDI0080  WRITE     HTMLFILE;PMDICTIM;
          GOTO      PMDI9999
.
PMDI0090  MATCH     SP70,PMDIUUID
          GOTO      PMDI9999 IF EQUAL
.
          PACK      KEY10,PMDIUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMDIUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMDI9999
.
PMDI0100  MATCH     PMDIUDAT,SP70
          GOTO      PMDI9999 IF EQUAL
.
          UNPACK    PMDIUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMDI9999
.
PMDI0110  WRITE     HTMLFILE;PMDIUTIM;
          GOTO      PMDI9999
.
PMDI9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for divisions
.------------------------------------------------------------
SPPMD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMD001,SPPMD002,SPPMD003,SPPMD004,SPPMD005
.
          MOVE      ONE,EXIT
          GOTO      SPPMD999
.
SPPMD001  MOVE      QRYDATA,PMDIV001
          GOTO      SPPMD999
.
SPPMD002  MOVE      QRYDATA,PMDIV002
          GOTO      SPPMD999
.
SPPMD003  MOVE      QRYDATA,PMDIV003
          GOTO      SPPMD999
.
SPPMD004  MOVE      QRYDATA,PMDIV004
          GOTO      SPPMD999
.
SPPMD005  MOVE      QRYDATA,PMDIV005
          GOTO      SPPMD999
.
SPPMD999  RETURN
.
.------------------------------------------------------------
.  Update divisions details
.------------------------------------------------------------
MVPMDI00  MATCH     PMDIV001,Z70
          IF        !@EQUAL
            MOVE      PMDIV001,PMDIHOSP
          ENDIF
.
          MATCH     PMDIV002,Z70
          IF        !@EQUAL
            MOVE      PMDIV002,PMDIDIVN
          ENDIF
.
          MATCH     PMDIV003,Z70
          IF        !@EQUAL
            MOVE      PMDIV003,PMDIUNIT
          ENDIF
.
          MATCH     PMDIV004,Z70
          IF        !@EQUAL
            MOVE      PMDIV004,PMDITEAM
          ENDIF
.
          MATCH     "2",PMDIV005
          IF        @EQUAL
            MOVE      ZERO,PMDIACTV       * active
          ELSE
            MOVE      ONE,PMDIACTV        * not active
          ENDIF
.
MVPMDI99  RETURN
.
.------------------------------------------------------------
.  Clear divisions details
.------------------------------------------------------------
CLPMDI00  MOVE      SP70,PMDIHOSP
          MOVE      SP70,PMDIDIVN
          MOVE      SP70,PMDIUNIT
          MOVE      SP70,PMDITEAM
          MOVE      SP70,PMDIACTV
          MOVE      SP70,PMDICUID
          MOVE      SP70,PMDICDAT
          MOVE      SP70,PMDICTIM
          MOVE      SP70,PMDIUUID
          MOVE      SP70,PMDIUDAT
          MOVE      SP70,PMDIUTIM
          MOVE      SP70,PMDISPAR
CLPMDI99  RETURN 
+
