. *----------------------------------------------------------------------
. * Include Name  :   ALLENCTM.PBL
. *
. * Function      :   CGI variables for ALLENCFD - allencaf.dat
. *
. * Modifications :
. *
. *----------------------------------------------------------------------
. * V11.04.01 15.07.2024  Alina Bhari    TSK 0947847
. *           Correctly saved the direct Units and Indirect Units          
. *           - SPALE011,SPALE013                                          
. * V11.01.03 22.11.2021  DA Sarkies     TSK 0912909
. *           Fixed code where Occassion of service is loaded and passed to
. *           front end.
. * V11.01.02 17.11.2021  DA Sarkies     TSK 0912909
. *           Added goto to line to go to correct section
. * V11.01.01 04.11.2021  DA Sarkies     TSK 0912909
. *           Added third variable to SRVITM80 to retrieve values to determine
. *           whether Family/Whanau is set. Added variable to SRVITM00 to pass
. *           through to set Family/Whanau value. Added function to pass
. *           value to set the Family/Whanau
. * V11.00.01 11/02/2020  Ebon Clements  TSK 0902780
. *           Added semicolon to ALEN0920 
. * V10.14.02 06/08/2019  Peter Vela     TSK 0876649
. *           Added read of original userid after tag display in ALEN0720 
. * V10.14.01 12/06/2019  Ebon Clements  TSK 0875686
. *           Added ALENSDEP tag without defaults - ALEN0930
. * V10.12.01 23/03/2018  Thanh T.       TSK 0854273
. *           Fixed issue with updating a contact record where occassion
. *           of service code has been made inactive
. *----------------------------------------------------------------------
. * V10.10.01 17/05/2015  Ania P         CAR 266089
. *           Added ALENC128
. * V10.08.01 15/11/2016  Nicole Torrisi CAR 0815159
. *           Changed ALENC097 - ALENC106 to DIM from FORM
. * V10.04.01 14/03/2014  Don Nguyen    CAR 285773
. *           Modified ALEN0910 - default to WBSEDALL (websecaf)
. * V10.03.01 06/09/2013  Don Nguyen    CAR 285773
. *           Added ALEN0910 - Service Departments list (Cat CG)
. *           Added SPALE127 (ALENC127) - Service Department (Cat CG)
. *           Modified SRVITM00 to use ALENSDEP if populated
. * V10.02.01 29/06/2011  Ebon Clements CAR 243794
. *           Added ALENRHOS to ALENSRVD
. *----------------------------------------------------------------------
. * V9.12.02  13/11/2009  Saroeun Soeur CAR 207550
. *            added ALEN0850 tag - selection dropdown for Cat "zF"
. * V9.12.01  25/09/2009  Mike Laming  CAR 173274
. *           Added routines to set Y/N indicators for Encounter attached Notes,
. *           Medications, Interventions & Supplies
. * V9.11.01  06/04/2009  Mike Laming  CAR 191906
. *           Changed ALENC011 to ALENC014 to Dim 6 (from Form 6)
. * V9.09.02  22/04/2008  Mike Laming  CAR 152286
. *           Added logic for Allied Health Notes RedButton at ALEN0000
. * V9.09.01  12.02.2008 J.Tan         CAR 135498
. *           Fixed Location service
. * V9.08.01  16.04.2007 Ebon Clements CAR 135533
. *           Added ALENPURC and ALENCONT
. * V9.07.02  16/08/2006 Ebon Clements CAR 110311
. *           Added ALENCREF
. * V9.07.01  02/08/2006 Ebon Clements CAR 113925
. *           Added ALENREVD
. * V9.05.B02 18.01.2005 Ebon Clements CAR 76341
. *          Added ALENC117 separate SACS episode
. * V9.05.B01 19.12.2005 Ebon Clements CAR 76341
. *          Fixed set of ALITENCN in ALEN0780 as it is now used as a DIM 8
. * V9.02.06 02.02.2001 Ebon Clements
. *          Added code to display inactive services in the selection lists
. *          if the code is on file
. * V9.02.05 24.12.2001 Ebon Clements
. *          Added tags to display items      
. * V9.02.04 15.12.2001 Ebon Clements
. *          Mods to service selection list
. * V9.02.03 24.10.2001 Ebon Clements
. *          Added VACS flag to service type selection list    
. * V9.02.02 22.10.2001 Ebon Clements
. *          Pack ALENC010 with SP70 when cgi variables are set
. * V9.02.01 03.10.2001 Ebon Clements
. *          Fixed right justify alenc008 for linked visit number
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
.   Clear Parameters for allied health encounter table file
.------------------------------------------------------------------------
.
CPALEN00  MOVE      Z70,ALENC001
          MOVE      Z70,ALENC002
          MOVE      Z70,ALENC003
          MOVE      Z70,ALENC004
          MOVE      Z70,ALENC005
          MOVE      Z70,ALENC006
          MOVE      Z70,ALENC007
          MOVE      Z70,ALENC008
          MOVE      Z70,ALENC009
          MOVE      Z70,ALENC010
          MOVE      Z70,ALENC011
          MOVE      Z70,ALENC012
          MOVE      Z70,ALENC013
          MOVE      Z70,ALENC014
          MOVE      Z70,ALENC015
          MOVE      Z70,ALENC016
          MOVE      Z70,ALENC017
          MOVE      Z70,ALENC018
          MOVE      Z70,ALENC019
          MOVE      Z70,ALENC020
          MOVE      Z70,ALENC021
          MOVE      Z70,ALENC022
          MOVE      Z70,ALENC023
          MOVE      Z70,ALENC024
          MOVE      Z70,ALENC025
          MOVE      Z70,ALENC026
          MOVE      Z70,ALENC027
          MOVE      Z70,ALENC028
          MOVE      Z70,ALENC029
          MOVE      Z70,ALENC030
          MOVE      Z70,ALENC031
          MOVE      Z70,ALENC032
          MOVE      Z70,ALENC033
          MOVE      Z70,ALENC034
          MOVE      Z70,ALENC035
          MOVE      Z70,ALENC036
          MOVE      Z70,ALENC037
          MOVE      Z70,ALENC038
          MOVE      Z70,ALENC039
          MOVE      Z70,ALENC040
          MOVE      Z70,ALENC041
          MOVE      Z70,ALENC042
          MOVE      Z70,ALENC043
          MOVE      Z70,ALENC044
          MOVE      Z70,ALENC045
          MOVE      Z70,ALENC046
          MOVE      Z70,ALENC047
          MOVE      Z70,ALENC048
          MOVE      Z70,ALENC049
          MOVE      Z70,ALENC050
          MOVE      Z70,ALENC051
          MOVE      Z70,ALENC052
          MOVE      Z70,ALENC053
          MOVE      Z70,ALENC054
          MOVE      Z70,ALENC055
          MOVE      Z70,ALENC056
          MOVE      Z70,ALENC057
          MOVE      Z70,ALENC058
          MOVE      Z70,ALENC059
          MOVE      Z70,ALENC060
          MOVE      Z70,ALENC061
          MOVE      Z70,ALENC062
          MOVE      Z70,ALENC063
          MOVE      Z70,ALENC064
          MOVE      Z70,ALENC065
          MOVE      Z70,ALENC066
          MOVE      Z70,ALENC067
          MOVE      Z70,ALENC068
          MOVE      Z70,ALENC069
          MOVE      Z70,ALENC070
          MOVE      Z70,ALENC071
          MOVE      Z70,ALENC072
          MOVE      Z70,ALENC073
          MOVE      Z70,ALENC074
          MOVE      Z70,ALENC075
          MOVE      Z70,ALENC076
          MOVE      Z70,ALENC077
          MOVE      Z70,ALENC078
          MOVE      Z70,ALENC079
          MOVE      Z70,ALENC080
          MOVE      Z70,ALENC081
          MOVE      Z70,ALENC082
          MOVE      Z70,ALENC083
          MOVE      Z70,ALENC084
          MOVE      Z70,ALENC085
          MOVE      Z70,ALENC086
          MOVE      ZERO,ALENC087
          MOVE      ZERO,ALENC088
          MOVE      ZERO,ALENC089
          MOVE      ZERO,ALENC090
          MOVE      ZERO,ALENC091
          MOVE      ZERO,ALENC092
          MOVE      ZERO,ALENC093
          MOVE      ZERO,ALENC094
          MOVE      ZERO,ALENC095
          MOVE      ZERO,ALENC096
          MOVE      Z70,ALENC097
          MOVE      Z70,ALENC098
          MOVE      Z70,ALENC099
          MOVE      Z70,ALENC100
          MOVE      Z70,ALENC101
          MOVE      Z70,ALENC102
          MOVE      Z70,ALENC103
          MOVE      Z70,ALENC104
          MOVE      Z70,ALENC105
          MOVE      Z70,ALENC106
          MOVE      Z70,ALENC107
          MOVE      Z70,ALENC108
          MOVE      Z70,ALENC109
          MOVE      Z70,ALENC110
          MOVE      Z70,ALENC111
          MOVE      Z70,ALENC112
          MOVE      Z70,ALENC113
          MOVE      Z70,ALENC114
          MOVE      Z70,ALENC115
          MOVE      Z70,ALENC116
          MOVE      Z70,ALENC117
          MOVE      Z70,ALENC118
          MOVE      Z70,ALENC119
          MOVE      Z70,ALENC120
          MOVE      Z70,ALENC121
          MOVE      Z70,ALENC122
          MOVE      Z70,ALENC123
          MOVE      Z70,ALENC124
          MOVE      Z70,ALENC125
          MOVE      Z70,ALENC126
          MOVE      Z70,ALENC127
          MOVE      Z70,ALENC128
.
CPALEN99  RETURN
.------------------------------------------------------------
. Add allied health services encounter table file
.------------------------------------------------------------
ALEN0000  BRANCH    FLDITMNO,ALEN0010,ALEN0020,ALEN0030,ALEN0040,ALEN0050:
                             ALEN0060,ALEN0070,ALEN0080,ALEN0090,ALEN0100:
                             ALEN0110,ALEN0120,ALEN0130,ALEN0140,ALEN0150:
                             ALEN0160,ALEN0170,ALEN0180,ALEN0190,ALEN0200:
                             ALEN0210,ALEN0220,ALEN0230,ALEN0240,ALEN0250:
                             ALEN0260,ALEN0270,ALEN0280,ALEN0290,ALEN0300:
                             ALEN0310,ALEN0320,ALEN0330,ALEN0340,ALEN0350:
                             ALEN0360,ALEN0370,ALEN0380,ALEN0390,ALEN0400:
                             ALEN0410,ALEN0420,ALEN0430,ALEN0440,ALEN0450:
                             ALEN0460,ALEN0470,ALEN0480,ALEN0490,ALEN0500:
                             ALEN0510,ALEN0520,ALEN0530,ALEN0540,ALEN0550:
                             ALEN0560,ALEN0570,ALEN0580,ALEN0590,ALEN0600:
                             ALEN0610,ALEN0620,ALEN0630,ALEN0640,ALEN0650:
                             ALEN0660,ALEN0670,ALEN0680,ALEN0690,ALEN0700:
                             ALEN0710,ALEN0720,ALEN0730,ALEN0740,ALEN0750:
                             ALEN0760,ALEN0770,ALEN0780,ALEN0790,ALEN0800:
                             ALEN0810,ALEN0820,ALEN0830,ALEN0840,ALEN0850:
                             ALEN0860,ALEN0870,ALEN0880,ALEN0890,ALEN0900:
                             ALEN0910,ALEN0920,ALEN0930
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      ALEN9999
.
ALEN0010  WRITE     HTMLFILE;ALENVISN;
          GOTO      ALEN9999
.
ALEN0020  WRITE     HTMLFILE;ALENENCT;
          GOTO      ALEN9999
.
ALEN0030  UNPACK    DIM127,D1,KEY1,DIM127    * Clinic Type of Referral
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALEN0031,ALEN0032
          PACK      KEY12,WBSESIT,ALENCLIN,SP70
          CALL      RDCTYA1                  * Read Clinic Type File
          BRANCH    OVRCD,ALEN9999
          WRITE     HTMLFILE;OCTDESC;        * Descprition
          GOTO      ALEN9999
ALEN0031  WRITE     HTMLFILE;ALENCLIN;       * Code
          GOTO      ALEN9999 
ALEN0032  CALL      AENCTY00
          GOTO      ALEN9999 
.
ALEN0040  MOVE      ALENHCP,GENPCODE
          CALL      HCPDET00
          GOTO      ALEN9999
.
ALEN0050  MATCH     ALENSDAT,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENSDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0060  WRITE     HTMLFILE;ALENSTIM;
          GOTO      ALEN9999
.
ALEN0070  MOVE      "LD",CATEGORY
          MOVE      ALENLOCA,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0080  WRITE     HTMLFILE;ALENLINK;
          GOTO      ALEN9999
.
ALEN0090  MOVE      "GI",CATEGORY
          MOVE      ALENTYPE,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0100  CALL      SRVITM00
          GOTO      ALEN9999
.
ALEN0110  WRITE     HTMLFILE;ALENDIUN;
          GOTO      ALEN9999
.
ALEN0120  WRITE     HTMLFILE;ALENDBUN;
          GOTO      ALEN9999
.
ALEN0130  WRITE     HTMLFILE;ALENINUN;
          GOTO      ALEN9999
.
ALEN0140  WRITE     HTMLFILE;ALENIBUN;
          GOTO      ALEN9999
.
ALEN0150  MOVE      "GB",CATEGORY
          MOVE      ALENBULK,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0160  WRITE     HTMLFILE;ALENRSTA;
          GOTO      ALEN9999
.
ALEN0170  MATCH     ALENUDT1,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENUDT1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0180  WRITE     HTMLFILE;ALENUTM1;
          GOTO      ALEN9999
.
ALEN0190  MATCH     ALENUDT2,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENUDT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0200  WRITE     HTMLFILE;ALENUTM2;
          GOTO      ALEN9999
.
ALEN0210  MATCH     ALENUDT3,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENUDT3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0220  WRITE     HTMLFILE;ALENUTM3;
          GOTO      ALEN9999
.
ALEN0230  MATCH     ALENUDT4,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENUDT4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0240  WRITE     HTMLFILE;ALENUTM4;
          GOTO      ALEN9999
.
ALEN0250  MOVE      ALENUHC1,GENPCODE
          CALL      HCPDET00
          GOTO      ALEN9999
.
ALEN0260  MOVE      ALENUHC2,GENPCODE
          CALL      HCPDET00
          GOTO      ALEN9999
.
ALEN0270  MOVE      ALENUHC3,GENPCODE
          CALL      HCPDET00
          GOTO      ALEN9999
.
ALEN0280  MOVE      ALENUHC4,GENPCODE
          CALL      HCPDET00
          GOTO      ALEN9999
.
ALEN0290  MOVE      ALENUDI1,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALEN9999
.
ALEN0300  MOVE      ALENUDI2,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALEN9999
.
ALEN0310  MOVE      ALENUDI3,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALEN9999
.
ALEN0320  WRITE     HTMLFILE;ALENUDI4;
          GOTO      ALEN9999
.
ALEN0330  WRITE     HTMLFILE;ALENUDI5;
          GOTO      ALEN9999
.
ALEN0340  WRITE     HTMLFILE;ALENUDI6;
          GOTO      ALEN9999
.
ALEN0350  MOVE      NO,YESNO
          MATCH     "1",ALENUYN1
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0360  MOVE      NO,YESNO
          MATCH     "1",ALENUYN2
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0370  MOVE      NO,YESNO
          MATCH     "1",ALENUYN3
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0380  MOVE      NO,YESNO
          MATCH     "1",ALENUYN4
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0390  MOVE      NO,YESNO
          MATCH     "1",ALENUYN5
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0400  MOVE      NO,YESNO
          MATCH     "1",ALENUYN6
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0410  MOVE      NO,YESNO
          MATCH     "1",ALENUYN7
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0420  MOVE      NO,YESNO
          MATCH     "1",ALENUYN8
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0430  MOVE      NO,YESNO
          MATCH     "1",ALENUYN9
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0440  WRITE     HTMLFILE;ALENUFF1;
          GOTO      ALEN9999
.
ALEN0450  WRITE     HTMLFILE;ALENUFF2;
          GOTO      ALEN9999
.
ALEN0460  WRITE     HTMLFILE;ALENUFF3;
          GOTO      ALEN9999
.
ALEN0470  UNPACK    DIM127,D1,KEY2,DIM127
          MOVE      KEY2,F2
          LOAD      CODE,F2,ALENUC01,ALENUC02,ALENUC03,ALENUC04,ALENUC05:
                            ALENUC06,ALENUC07,ALENUC08,ALENUC09,ALENUC10:
                            ALENUC11,ALENUC12,ALENUC13,ALENUC14,ALENUC15:
                            ALENUC16,ALENUC17,ALENUC18,ALENUC19,ALENUC20:
                            ALENUC21,ALENUC22,ALENUC23,ALENUC24,ALENUC25:
                            ALENUC26,ALENUC27,ALENUC28,ALENUC29,ALENUC30:
                            ALENUC31,ALENUC32,ALENUC33,ALENUC34,ALENUC35:
                            ALENUC36,ALENUC37,ALENUC38,ALENUC39,ALENUC40
.
          LOAD      CATEGORY,F2,ALENC201,ALENC202,ALENC203,ALENC204,ALENC205:
                                ALENC206,ALENC207,ALENC208,ALENC209,ALENC210:
                                ALENC211,ALENC212,ALENC213,ALENC214,ALENC215:
                                ALENC216,ALENC217,ALENC218,ALENC219,ALENC220:
                                ALENC221,ALENC222,ALENC223,ALENC224,ALENC225:
                                ALENC226,ALENC227,ALENC228,ALENC229,ALENC230:
                                ALENC231,ALENC232,ALENC233,ALENC234,ALENC235:
                                ALENC236,ALENC237,ALENC238,ALENC239,ALENC240
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0480  WRITE     HTMLFILE;ALENUF01;
          GOTO      ALEN9999
.
ALEN0490  WRITE     HTMLFILE;ALENUF02;
          GOTO      ALEN9999
.
ALEN0500  WRITE     HTMLFILE;ALENUF03;
          GOTO      ALEN9999
.
ALEN0510  WRITE     HTMLFILE;ALENUF04;
          GOTO      ALEN9999
.
ALEN0520  WRITE     HTMLFILE;ALENUF05;
          GOTO      ALEN9999
.
ALEN0530  WRITE     HTMLFILE;ALENUF06;
          GOTO      ALEN9999
.
ALEN0540  WRITE     HTMLFILE;ALENUF07;
          GOTO      ALEN9999
.
ALEN0550  WRITE     HTMLFILE;ALENUF08;
          GOTO      ALEN9999
.
ALEN0560  WRITE     HTMLFILE;ALENUF09;
          GOTO      ALEN9999
.
ALEN0570  WRITE     HTMLFILE;ALENUF10;
          GOTO      ALEN9999
.
ALEN0580  WRITE     HTMLFILE;ALENUF11;
          GOTO      ALEN9999
.
ALEN0590  WRITE     HTMLFILE;ALENUF12;
          GOTO      ALEN9999
.
ALEN0600  WRITE     HTMLFILE;ALENUF13;
          GOTO      ALEN9999
.
ALEN0610  WRITE     HTMLFILE;ALENUF14;
          GOTO      ALEN9999
.
ALEN0620  WRITE     HTMLFILE;ALENUF15;
          GOTO      ALEN9999
.
ALEN0630  WRITE     HTMLFILE;ALENUF16;
          GOTO      ALEN9999
.
ALEN0640  WRITE     HTMLFILE;ALENUF17;
          GOTO      ALEN9999
.
ALEN0650  WRITE     HTMLFILE;ALENUF18;
          GOTO      ALEN9999
.
ALEN0660  WRITE     HTMLFILE;ALENUF19;
          GOTO      ALEN9999
.
ALEN0670  WRITE     HTMLFILE;ALENUF20;
          GOTO      ALEN9999
.
ALEN0680  WRITE     HTMLFILE;ALENCMT1
          GOTO      ALEN9999
.
ALEN0690  WRITE     HTMLFILE;ALENCMT2
          GOTO      ALEN9999
.
ALEN0700  MATCH     ALENCDAT,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0710  WRITE     HTMLFILE;ALENCTIM;
          GOTO      ALEN9999
.
ALEN0720  PACK      KEY10,ALENCUID,SP70
          CALL      RDWBSE1
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALEN9999
.
ALEN0730  MATCH     ALENUDAT,SP70
          GOTO      ALEN9999 IF EQUAL
          UNPACK    ALENUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0740  WRITE     HTMLFILE;ALENUTIM;
          GOTO      ALEN9999
.
ALEN0750  WRITE     HTMLFILE;ALENUUID;
          GOTO      ALEN9999
.
ALEN0760  MOVE      "CL",CATEGORY
          MOVE      ALENCOMP,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0770  WRITE     HTMLFILE;ALENUNIQ;
          GOTO      ALEN9999
.
ALEN0780  UNPACK    DIM127,D1,KEY1,DIM127             * Code or Description
          UNPACK    DIM127,D1,KEY2,DIM127             * Item Number
          MOVE      ZERO,F1
          MOVE      ZERO,F2
          MOVE      KEY1,F1
          MOVE      KEY2,F2
.
          MOVE      ALENVISN,ALITVISN
          MOVE      ALENENCT,ALITENCN
          PACK      KEY18,ALITVISN,ALITENCN,F2,SP70
          CALL      RDALITM1
          BRANCH    OVRCD,ALEN9999
.
          BRANCH    F1,ALEN0785
.
          WRITE     HTMLFILE;ALITITMN;
          GOTO      ALEN9999
.
ALEN0785  PACK      KEY22,SP1,ZERO,ALITITMN,Z70
          CALL      RSPRIT1
          CALL      RPPRIT1
          BRANCH    OVRCD,ALEN9999
.
          COMPARE   ZERO,PRITFLAG
          GOTO      ALEN9999 IF NOT EQUAL
.
          MATCH     ALITITMN,PRITITMN
          GOTO      ALEN9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PRITDESC;
          GOTO      ALEN9999
.
ALEN0790  MOVE      NO,YESNO
          MATCH     "1",ALENSSAC
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF     
          WRITE     HTMLFILE;YESNO;
          GOTO      ALEN9999
.
ALEN0800  MATCH     ALENREVD,SP70
          GOTO      ALEN9999 IF EQUAL
.
          UNPACK    ALENREVD,CCENT,CYEAR,CMON,CDAY    
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALEN9999
.
ALEN0810  WRITE     HTMLFILE;ALENCREF;
          GOTO      ALEN9999
.
ALEN0820  MOVE      "HP",CATEGORY
          MOVE      ALENPURC,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0830  MOVE      "gb",CATEGORY
          MOVE      ALENCONT,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0840  MOVE      "0",KEY1                * set RedButton indicator
          MOVE      "001",KEY3
          PACK      KEY25,ALENVISN,ALENENCT,KEY3,SP70
          CALL      ENCNOT00                * see if Notes exist
          WRITE     HTMLFILE;ENCNOTES;
          GOTO      ALEN9999
.
ALEN0850  MOVE      "zF",CATEGORY
          MOVE      ALENC078,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0860  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALEN0861
.
          PACK      KEY5,ALENRHOS,SP70
          CALL      RDPTVAD1
          IF        OVRCD=1
            MOVE      ALENRHOS,PTVADESC
          ENDIF
.
          WRITE     HTMLFILE;PTVADESC;

          GOTO      ALEN9999
.
ALEN0861  WRITE     HTMLFILE;ALENRHOS;
          GOTO      ALEN9999
.
ALEN0870  MOVE      "CC",CATEGORY
          MOVE      ALENCART,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0880  MOVE      "SI",CATEGORY
          MOVE      ALENSTRA,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0890  MOVE      "OZ",CATEGORY
          MOVE      ALENOUTC,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0900  MOVE      "sd",CATEGORY
          MOVE      ALENSRVD,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0910  MOVE      "CG",CATEGORY
          MATCH     SP70,ALENSDEP
          IF        !@EQUAL
            MOVE      ALENSDEP,CODE
          ELSE
            MATCH     SP70,WBSEDALL
            IF        !@EQUAL
              MOVE      WBSEDALL,CODE
            ELSE
              MOVE      ALREDEPT,CODE
            ENDIF
          ENDIF
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN0920  WRITE     HTMLFILE;ALENACCN;
          GOTO      ALEN9999
.
ALEN0930  MOVE      "CG",CATEGORY
          MOVE      ALENSDEP,CODE
          CALL      CODITM00
          GOTO      ALEN9999
.
ALEN9999  RETURN
.
.------------------------------------------------------------
. Clinic Type List
.------------------------------------------------------------
AENCTY00  PACK      KEY42,WBSESIT,SP70
          CALL      RDSCTYA2
AENCTY10  CALL      RDKCTYA2
          BRANCH    OVRCD,AENCTY99
          MATCH     OCTSITE,WBSESIT
          GOTO      AENCTY99 IF NOT EQUAL
          MATCH     OCTGRP,ALREDEPT
          GOTO      AENCTY10 IF NOT EQUAL
          MATCH     "1",OCTACT
          GOTO      AENCTY10 IF EQUAL
.
          MATCH     ALENCLIN,OCTCTYP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",OCTCTYP,"#" selected>":
                               OCTDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",OCTCTYP,"#">":
                               OCTDESC,"</option>"
          ENDIF
          GOTO      AENCTY10
.
AENCTY99  RETURN
.------------------------------------------------------------
.   Set Parameters for allied health services encounter table file
.------------------------------------------------------------
SPALE000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPALE001,SPALE002,SPALE003,SPALE004,SPALE005:
                       SPALE006,SPALE007,SPALE008,SPALE009,SPALE010:
                       SPALE011,SPALE012,SPALE013,SPALE014,SPALE015:
                       SPALE016,SPALE017,SPALE018,SPALE019,SPALE020:
                       SPALE021,SPALE022,SPALE023,SPALE024,SPALE025:
                       SPALE026,SPALE027,SPALE028,SPALE029,SPALE030:
                       SPALE031,SPALE032,SPALE033,SPALE034,SPALE035:
                       SPALE036,SPALE037,SPALE038,SPALE039,SPALE040:
                       SPALE041,SPALE042,SPALE043,SPALE044,SPALE045:
                       SPALE046,SPALE047,SPALE048,SPALE049,SPALE050:
                       SPALE051,SPALE052,SPALE053,SPALE054,SPALE055:
                       SPALE056,SPALE057,SPALE058,SPALE059,SPALE060:
                       SPALE061,SPALE062,SPALE063,SPALE064,SPALE065:
                       SPALE066,SPALE067,SPALE068,SPALE069,SPALE070:
                       SPALE071,SPALE072,SPALE073,SPALE074,SPALE075:
                       SPALE076,SPALE077,SPALE078,SPALE079,SPALE080:
                       SPALE081,SPALE082,SPALE083,SPALE084,SPALE085:
                       SPALE086,SPALE087,SPALE088,SPALE089,SPALE090:
                       SPALE091,SPALE092,SPALE093,SPALE094,SPALE095:
                       SPALE096,SPALE097,SPALE098,SPALE099,SPALE100:
                       SPALE101,SPALE102,SPALE103,SPALE104,SPALE105:
                       SPALE106,SPALE107,SPALE108,SPALE109,SPALE110:
                       SPALE111,SPALE112,SPALE113,SPALE114,SPALE115:
                       SPALE116,SPALE117,SPALE118,SPALE119,SPALE120:
                       SPALE121,SPALE122,SPALE123,SPALE124,SPALE125:
                       SPALE126,SPALE127,SPALE128
.
          MOVE      ONE,EXIT
          GOTO      SPALE0999
.
SPALE001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,ALENC001
          PACK      ALENC001,ALENC001,SP70
          GOTO      SPALE999
.
SPALE002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,ALENC002
          PACK      ALENC002,ALENC002,SP70
          GOTO      SPALE999
.
SPALE003  SQUEEZE   QRYDATA
          MOVE      QRYDATA,ALENC003
          PACK      ALENC003,ALENC003,SP70
          GOTO      SPALE999
.
SPALE004  MOVE      QRYDATA,ALENC004
          GOTO      SPALE999
.
SPALE005  MATCH     SP70,QRYDATA
          GOTO      SPALR999 IF EQUAL
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC005,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPALR999
.
SPALE006  MOVE      QRYDATA,ALENC006
          GOTO      SPALE999
.
SPALE007  MOVE      QRYDATA,ALENC007
          PACK      ALENC007,ALENC007,SP70
          GOTO      SPALE999
.
SPALE008  
.         SQUEEZE   QRYDATA
          MOVE      QRYDATA,ALENC008
          PACK      ALENC008,ALENC008,SP70
          GOTO      SPALE999
.
SPALE009  MOVE      QRYDATA,ALENC009
          GOTO      SPALE999
.
SPALE010  MOVE      QRYDATA,ALENC010
          PACK      ALENC010,ALENC010,SP70
          GOTO      SPALE999
.
SPALE011  MOVE      QRYDATA,ALENC011
          STRIP     ALENC011
          GOTO      SPALE999
.
SPALE012  MOVE      QRYDATA,ALENC012
          GOTO      SPALE999
.
SPALE013  MOVE      QRYDATA,ALENC013
          STRIP     ALENC013
          GOTO      SPALE999
.
SPALE014  MOVE      QRYDATA,ALENC014
          GOTO      SPALE999
.
SPALE015  MOVE      QRYDATA,ALENC015
          GOTO      SPALE999
.
SPALE016  MOVE      QRYDATA,ALENC016
          GOTO      SPALE999
.
SPALE017  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC017,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALE018  MOVE      QRYDATA,ALENC018
          GOTO      SPALE999
.
SPALE019  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC019,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALE020  MOVE      QRYDATA,ALENC020
          GOTO      SPALE999
.
SPALE021  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC021,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALE022  MOVE      QRYDATA,ALENC022
          GOTO      SPALE999
.
SPALE023  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC023,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALE024  MOVE      QRYDATA,ALENC024
          GOTO      SPALE999
.
SPALE025  MOVE      QRYDATA,ALENC025
          GOTO      SPALE999
.
SPALE026  MOVE      QRYDATA,ALENC026
          GOTO      SPALE999
.
SPALE027  MOVE      QRYDATA,ALENC027
          GOTO      SPALE999
.
SPALE028  MOVE      QRYDATA,ALENC028
          GOTO      SPALE999
.
SPALE029  MOVE      QRYDATA,ALENC029
          GOTO      SPALE999
.
SPALE030  MOVE      QRYDATA,ALENC030
          GOTO      SPALE999
.
SPALE031  MOVE      QRYDATA,ALENC031
          GOTO      SPALE999
.
SPALE032  MOVE      QRYDATA,ALENC032
          GOTO      SPALE999
.
SPALE033  MOVE      QRYDATA,ALENC033
          GOTO      SPALE999
.
SPALE034  MOVE      QRYDATA,ALENC034
          GOTO      SPALE999
.
SPALE035  MOVE      QRYDATA,ALENC035
          GOTO      SPALE999
.
SPALE036  MOVE      QRYDATA,ALENC036
          GOTO      SPALE999
.
SPALE037  MOVE      QRYDATA,ALENC037
          GOTO      SPALE999
.
SPALE038  MOVE      QRYDATA,ALENC038
          GOTO      SPALE999
.
SPALE039  MOVE      QRYDATA,ALENC039
          GOTO      SPALE999
.
SPALE040  MOVE      QRYDATA,ALENC040
          GOTO      SPALE999
.
SPALE041  MOVE      QRYDATA,ALENC041
          GOTO      SPALE999
.
SPALE042  MOVE      QRYDATA,ALENC042
          GOTO      SPALE999
.
SPALE043  MOVE      QRYDATA,ALENC043
          GOTO      SPALE999
.
SPALE044  MOVE      QRYDATA,ALENC044
          GOTO      SPALE999
.
SPALE045  MOVE      QRYDATA,ALENC045
          GOTO      SPALE999
.
SPALE046  MOVE      QRYDATA,ALENC046
          GOTO      SPALE999
.
SPALE047  MOVE      QRYDATA,ALENC047
          GOTO      SPALE999
.
SPALE048  MOVE      QRYDATA,ALENC048
          GOTO      SPALE999
.
SPALE049  MOVE      QRYDATA,ALENC049
          GOTO      SPALE999
.
SPALE050  MOVE      QRYDATA,ALENC050
          GOTO      SPALE999
.
SPALE051  MOVE      QRYDATA,ALENC051
          GOTO      SPALE999
.
SPALE052  MOVE      QRYDATA,ALENC052
          GOTO      SPALE999
.
SPALE053  MOVE      QRYDATA,ALENC053
          GOTO      SPALE999
.
SPALE054  MOVE      QRYDATA,ALENC054
          GOTO      SPALE999
.
SPALE055  MOVE      QRYDATA,ALENC055
          GOTO      SPALE999
.
SPALE056  MOVE      QRYDATA,ALENC056
          GOTO      SPALE999
.
SPALE057  MOVE      QRYDATA,ALENC057
          GOTO      SPALE999
.
SPALE058  MOVE      QRYDATA,ALENC058
          GOTO      SPALE999
.
SPALE059  MOVE      QRYDATA,ALENC059
          GOTO      SPALE999
.
SPALE060  MOVE      QRYDATA,ALENC060
          GOTO      SPALE999
.
SPALE061  MOVE      QRYDATA,ALENC061
          GOTO      SPALE999
.
SPALE062  MOVE      QRYDATA,ALENC062
          GOTO      SPALE999
.
SPALE063  MOVE      QRYDATA,ALENC063
          GOTO      SPALE999
.
SPALE064  MOVE      QRYDATA,ALENC064
          GOTO      SPALE999
.
SPALE065  MOVE      QRYDATA,ALENC065
          GOTO      SPALE999
.
SPALE066  MOVE      QRYDATA,ALENC066
          GOTO      SPALE999
.
SPALE067  MOVE      QRYDATA,ALENC067
          GOTO      SPALE999
.
SPALE068  MOVE      QRYDATA,ALENC068
          GOTO      SPALE999
.
SPALE069  MOVE      QRYDATA,ALENC069
          GOTO      SPALE999
.
SPALE070  MOVE      QRYDATA,ALENC070
          GOTO      SPALE999
.
SPALE071  MOVE      QRYDATA,ALENC071
          GOTO      SPALE999
.
SPALE072  MOVE      QRYDATA,ALENC072
          GOTO      SPALE999
.
SPALE073  MOVE      QRYDATA,ALENC073
          GOTO      SPALE999
.
SPALE074  MOVE      QRYDATA,ALENC074
          GOTO      SPALE999
.
SPALE075  MOVE      QRYDATA,ALENC075
          GOTO      SPALE999
.
SPALE076  MOVE      QRYDATA,ALENC076
          GOTO      SPALE999
.
SPALE077  MOVE      QRYDATA,ALENC077
          GOTO      SPALE999
.
SPALE078  MOVE      QRYDATA,ALENC078
          GOTO      SPALE999
.
SPALE079  MOVE      QRYDATA,ALENC079
          GOTO      SPALE999
.
SPALE080  MOVE      QRYDATA,ALENC080
          GOTO      SPALE999
.
SPALE081  MOVE      QRYDATA,ALENC081
          GOTO      SPALE999
.
SPALE082  MOVE      QRYDATA,ALENC082
          GOTO      SPALE999
.
SPALE083  MOVE      QRYDATA,ALENC083
          GOTO      SPALE999
.
SPALE084  MOVE      QRYDATA,ALENC084
          GOTO      SPALE999
.
SPALE085  MOVE      QRYDATA,ALENC085
          GOTO      SPALE999
.
SPALE086  MOVE      QRYDATA,ALENC086
          GOTO      SPALE999
.
SPALE087  MOVE      QRYDATA,ALENC087
          GOTO      SPALE999
.
SPALE088  MOVE      QRYDATA,ALENC088
          GOTO      SPALE999
.
SPALE089  MOVE      QRYDATA,ALENC089
          GOTO      SPALE999
.
SPALE090  MOVE      QRYDATA,ALENC090
          GOTO      SPALE999
.
SPALE091  MOVE      QRYDATA,ALENC091
          GOTO      SPALE999
.
SPALE092  MOVE      QRYDATA,ALENC092
          GOTO      SPALE999
.
SPALE093  MOVE      QRYDATA,ALENC093
          GOTO      SPALE999
.
SPALE094  MOVE      QRYDATA,ALENC094
          GOTO      SPALE999
.
SPALE095  MOVE      QRYDATA,ALENC095
          GOTO      SPALE999
.
SPALE096  MOVE      QRYDATA,ALENC096
          GOTO      SPALE999
.
SPALE097  MOVE      QRYDATA,ALENC097
          GOTO      SPALE999
.
SPALE098  MOVE      QRYDATA,ALENC098
          GOTO      SPALE999
.
SPALE099  MOVE      QRYDATA,ALENC099
          GOTO      SPALE999
.
SPALE100  MOVE      QRYDATA,ALENC100
          GOTO      SPALE999
.
SPALE101  MOVE      QRYDATA,ALENC101
          GOTO      SPALE999
.
SPALE102  MOVE      QRYDATA,ALENC102
          GOTO      SPALE999
.
SPALE103  MOVE      QRYDATA,ALENC103
          GOTO      SPALE999
.
SPALE104  MOVE      QRYDATA,ALENC104
          GOTO      SPALE999
.
SPALE105  MOVE      QRYDATA,ALENC105
          GOTO      SPALE999
.
SPALE106  MOVE      QRYDATA,ALENC106
          GOTO      SPALE999
.
SPALE107  MOVE      QRYDATA,ALENC107
          GOTO      SPALE999
.
SPALE108  MOVE      QRYDATA,ALENC108
          GOTO      SPALE999
.
SPALE109  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC109,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALE110  MOVE      QRYDATA,ALENC110
          GOTO      SPALE999
.
SPALE111  MOVE      QRYDATA,ALENC111
          GOTO      SPALE999
.
SPALE112  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC112,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALE113  MOVE      QRYDATA,ALENC113
          GOTO      SPALE999
.
SPALE114  MOVE      QRYDATA,ALENC114
          GOTO      SPALE999
.
SPALE115  MOVE      QRYDATA,ALENC115
          GOTO      SPALE999
.
SPALE116  MOVE      QRYDATA,ALENC116
          GOTO      SPALE999
.
SPALE117  MOVE      QRYDATA,ALENC117
          GOTO      SPALE999
.
SPALE118  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALENC118,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
. 
SPALE119  MOVE      QRYDATA,ALENC119
          GOTO      SPALE999
.
SPALE120  MOVE      QRYDATA,ALENC120
          GOTO      SPALE999
.
SPALE121  MOVE      QRYDATA,ALENC121
          GOTO      SPALE999
.
SPALE122  MOVE      QRYDATA,ALENC122
          GOTO      SPALE999
.
SPALE123  MOVE      QRYDATA,ALENC123
          GOTO      SPALE999
.
SPALE124  MOVE      QRYDATA,ALENC124
          GOTO      SPALE999
.
SPALE125  MOVE      QRYDATA,ALENC125
          GOTO      SPALE999
.
SPALE126  MOVE      QRYDATA,ALENC126
          GOTO      SPALE999
.
SPALE127  MOVE      QRYDATA,ALENC127
          GOTO      SPALE999
.
SPALE128  MOVE      QRYDATA,ALENC128
          GOTO      SPALE999
.
SPALE999  RETURN
.------------------------------------------------------------
.  Update allied health services encounter table file
.------------------------------------------------------------
MVALEN00  MATCH     ALENC001,Z70
          IF        !@EQUAL
            MOVE      ALENC001,ALENVISN
          ENDIF
.
          MATCH     ALENC002,Z70
          IF        !@EQUAL
            MOVE      ALENC002,ALENENCT
          ENDIF
.
          MATCH     ALENC003,Z70
          IF        !@EQUAL
            MOVE      ALENC003,ALENCLIN
          ENDIF
.
          MATCH     ALENC004,Z70
          IF        !@EQUAL
            MOVE      ALENC004,ALENHCP 
          ENDIF
.
          MATCH     ALENC005,Z70
          IF        !@EQUAL
            MOVE      ALENC005,ALENSDAT
          ENDIF
.
          MATCH     ALENC006,Z70
          IF        !@EQUAL
            MOVE      ALENC006,ALENSTIM
          ENDIF
.
          MATCH     ALENC007,Z70
          IF        !@EQUAL
            MOVE      ALENC007,ALENLOCA
          ENDIF
.
          MATCH     ALENC008,Z70
          IF        !@EQUAL
            MOVE      ALENC008,ALENLINK
          ENDIF
.
          MATCH     ALENC009,Z70
          IF        !@EQUAL
            MOVE      ALENC009,ALENTYPE
          ENDIF
.
          MATCH     ALENC010,Z70
          IF        !@EQUAL
            MOVE      ALENC010,ALENSERV
          ENDIF
.
          MATCH     ALENC011,Z70
          IF        !@EQUAL
            MOVE      ALENC011,ALENDIUN
          ENDIF
.
          MATCH     ALENC012,Z70
          IF        !@EQUAL
            MOVE      ALENC012,ALENDBUN
          ENDIF
.
          MATCH     ALENC013,Z70
          IF        !@EQUAL
            MOVE      ALENC013,ALENINUN
          ENDIF
.
          MATCH     ALENC014,Z70
          IF        !@EQUAL
            MOVE      ALENC014,ALENIBUN
          ENDIF
.
          MATCH     ALENC015,Z70
          IF        !@EQUAL
            MOVE      ALENC015,ALENBULK
          ENDIF
.
          MATCH     ALENC016,Z70
          IF        !@EQUAL
            MOVE      ALENC016,ALENRSTA
          ENDIF
.
          MATCH     ALENC017,Z70
          IF        !@EQUAL
            MOVE      ALENC017,ALENUDT1
          ENDIF
.
          MATCH     ALENC018,Z70
          IF        !@EQUAL
            MOVE      ALENC018,ALENUTM1
          ENDIF
.
          MATCH     ALENC019,Z70
          IF        !@EQUAL
            MOVE      ALENC019,ALENUDT2
          ENDIF
.
          MATCH     ALENC020,Z70
          IF        !@EQUAL
            MOVE      ALENC020,ALENUTM2
          ENDIF
.
          MATCH     ALENC021,Z70
          IF        !@EQUAL
            MOVE      ALENC021,ALENUDT3
          ENDIF
.
          MATCH     ALENC022,Z70
          IF        !@EQUAL
            MOVE      ALENC022,ALENUTM3
          ENDIF
.
          MATCH     ALENC023,Z70
          IF        !@EQUAL
            MOVE      ALENC023,ALENUDT4
          ENDIF
.
          MATCH     ALENC024,Z70
          IF        !@EQUAL
            MOVE      ALENC024,ALENUTM4
          ENDIF
.
          MATCH     ALENC025,Z70
          IF        !@EQUAL
            MOVE      ALENC025,ALENUHC1
          ENDIF
.
          MATCH     ALENC026,Z70
          IF        !@EQUAL
            MOVE      ALENC026,ALENUHC2
          ENDIF
.
          MATCH     ALENC027,Z70
          IF        !@EQUAL
            MOVE      ALENC027,ALENUHC3
          ENDIF
.
          MATCH     ALENC028,Z70
          IF        !@EQUAL
            MOVE      ALENC028,ALENUHC4
          ENDIF
.
          MATCH     ALENC029,Z70
          IF        !@EQUAL
            MOVE      ALENC029,ALENUDI1
          ENDIF
.
          MATCH     ALENC030,Z70
          IF        !@EQUAL
            MOVE      ALENC030,ALENUDI2
          ENDIF
.
          MATCH     ALENC031,Z70
          IF        !@EQUAL
            MOVE      ALENC031,ALENUDI3
          ENDIF
.
          MATCH     ALENC032,Z70
          IF        !@EQUAL
            MOVE      ALENC032,ALENUDI4
          ENDIF
.
          MATCH     ALENC033,Z70
          IF        !@EQUAL
            MOVE      ALENC033,ALENUDI5
          ENDIF
.
          MATCH     ALENC034,Z70
          IF        !@EQUAL
            MOVE      ALENC034,ALENUDI6
          ENDIF
.
          MATCH     ALENC035,Z70
          IF        !@EQUAL
            MOVE      ALENC035,ALENUYN1
          ENDIF
.
          MATCH     ALENC036,Z70
          IF        !@EQUAL
            MOVE      ALENC036,ALENUYN2
          ENDIF
.
          MATCH     ALENC037,Z70
          IF        !@EQUAL
            MOVE      ALENC037,ALENUYN3
          ENDIF
.
          MATCH     ALENC038,Z70
          IF        !@EQUAL
            MOVE      ALENC038,ALENUYN4
          ENDIF
.
          MATCH     ALENC039,Z70
          IF        !@EQUAL
            MOVE      ALENC039,ALENUYN5
          ENDIF
.
          MATCH     ALENC040,Z70
          IF        !@EQUAL
            MOVE      ALENC040,ALENUYN6
          ENDIF
.
          MATCH     ALENC041,Z70
          IF        !@EQUAL
            MOVE      ALENC041,ALENUYN7
          ENDIF
.
          MATCH     ALENC042,Z70
          IF        !@EQUAL
            MOVE      ALENC042,ALENUYN8
          ENDIF
.
          MATCH     ALENC043,Z70
          IF        !@EQUAL
            MOVE      ALENC043,ALENUYN9
          ENDIF
.
          MATCH     ALENC044,Z70
          IF        !@EQUAL
            MOVE      ALENC044,ALENUFF1
          ENDIF
.
          MATCH     ALENC045,Z70
          IF        !@EQUAL
            MOVE      ALENC045,ALENUFF2
          ENDIF
.
          MATCH     ALENC046,Z70
          IF        !@EQUAL
            MOVE      ALENC046,ALENUFF3
          ENDIF
.
          MATCH     ALENC047,Z70
          IF        !@EQUAL
            MOVE      ALENC047,ALENUC01
          ENDIF
.
          MATCH     ALENC048,Z70
          IF        !@EQUAL
            MOVE      ALENC048,ALENUC02
          ENDIF
.
          MATCH     ALENC049,Z70
          IF        !@EQUAL
            MOVE      ALENC049,ALENUC03
          ENDIF
.
          MATCH     ALENC050,Z70
          IF        !@EQUAL
            MOVE      ALENC050,ALENUC04
          ENDIF
.
          MATCH     ALENC051,Z70
          IF        !@EQUAL
            MOVE      ALENC051,ALENUC05
          ENDIF
.
          MATCH     ALENC052,Z70
          IF        !@EQUAL
            MOVE      ALENC052,ALENUC06
          ENDIF
.
          MATCH     ALENC053,Z70
          IF        !@EQUAL
            MOVE      ALENC053,ALENUC07
          ENDIF
.
          MATCH     ALENC054,Z70
          IF        !@EQUAL
            MOVE      ALENC054,ALENUC08
          ENDIF
.
          MATCH     ALENC055,Z70
          IF        !@EQUAL
            MOVE      ALENC055,ALENUC09
          ENDIF
.
          MATCH     ALENC056,Z70
          IF        !@EQUAL
            MOVE      ALENC056,ALENUC10
          ENDIF
.
          MATCH     ALENC057,Z70
          IF        !@EQUAL
            MOVE      ALENC057,ALENUC11
          ENDIF
.
          MATCH     ALENC058,Z70
          IF        !@EQUAL
            MOVE      ALENC058,ALENUC12
          ENDIF
.
          MATCH     ALENC059,Z70
          IF        !@EQUAL
            MOVE      ALENC059,ALENUC13
          ENDIF
.
          MATCH     ALENC060,Z70
          IF        !@EQUAL
            MOVE      ALENC060,ALENUC14
          ENDIF
.
          MATCH     ALENC061,Z70
          IF        !@EQUAL
            MOVE      ALENC061,ALENUC15
          ENDIF
.
          MATCH     ALENC062,Z70
          IF        !@EQUAL
            MOVE      ALENC062,ALENUC16
          ENDIF
.
          MATCH     ALENC063,Z70
          IF        !@EQUAL
            MOVE      ALENC063,ALENUC17
          ENDIF
.
          MATCH     ALENC064,Z70
          IF        !@EQUAL
            MOVE      ALENC064,ALENUC18
          ENDIF
.
          MATCH     ALENC065,Z70
          IF        !@EQUAL
            MOVE      ALENC065,ALENUC19
          ENDIF
.
          MATCH     ALENC066,Z70
          IF        !@EQUAL
            MOVE      ALENC066,ALENUC20
          ENDIF
.
          MATCH     ALENC067,Z70
          IF        !@EQUAL
            MOVE      ALENC067,ALENUC21
          ENDIF
.
          MATCH     ALENC068,Z70
          IF        !@EQUAL
            MOVE      ALENC068,ALENUC22
          ENDIF
.
          MATCH     ALENC069,Z70
          IF        !@EQUAL
            MOVE      ALENC069,ALENUC23
          ENDIF
.
          MATCH     ALENC070,Z70
          IF        !@EQUAL
            MOVE      ALENC070,ALENUC24
          ENDIF
.
          MATCH     ALENC071,Z70
          IF        !@EQUAL
            MOVE      ALENC071,ALENUC25
          ENDIF
.
          MATCH     ALENC072,Z70
          IF        !@EQUAL
            MOVE      ALENC072,ALENUC26
          ENDIF
.
          MATCH     ALENC073,Z70
          IF        !@EQUAL
            MOVE      ALENC073,ALENUC27
          ENDIF
.
          MATCH     ALENC074,Z70
          IF        !@EQUAL
            MOVE      ALENC074,ALENUC28
          ENDIF
.
          MATCH     ALENC075,Z70
          IF        !@EQUAL
            MOVE      ALENC075,ALENUC29
          ENDIF
.
          MATCH     ALENC076,Z70
          IF        !@EQUAL
            MOVE      ALENC076,ALENUC30
          ENDIF
.
          MATCH     ALENC077,Z70
          IF        !@EQUAL
            MOVE      ALENC077,ALENUC31
          ENDIF
.
          MATCH     ALENC078,Z70
          IF        !@EQUAL
            MOVE      ALENC078,ALENUC32
          ENDIF
.
          MATCH     ALENC079,Z70
          IF        !@EQUAL
            MOVE      ALENC079,ALENUC33
          ENDIF
.
          MATCH     ALENC080,Z70
          IF        !@EQUAL
            MOVE      ALENC080,ALENUC34
          ENDIF
.
          MATCH     ALENC081,Z70
          IF        !@EQUAL
            MOVE      ALENC081,ALENUC35
          ENDIF
.
          MATCH     ALENC082,Z70
          IF        !@EQUAL
            MOVE      ALENC082,ALENUC36
          ENDIF
.
          MATCH     ALENC083,Z70
          IF        !@EQUAL
            MOVE      ALENC083,ALENUC37
          ENDIF
.
          MATCH     ALENC084,Z70
          IF        !@EQUAL
            MOVE      ALENC084,ALENUC38
          ENDIF
.
          MATCH     ALENC085,Z70
          IF        !@EQUAL
            MOVE      ALENC085,ALENUC39
          ENDIF
.
          MATCH     ALENC086,Z70
          IF        !@EQUAL
            MOVE      ALENC086,ALENUC40
          ENDIF
.
          COMPARE   ALENC087,ZERO
          IF        !@EQUAL
            MOVE      ALENC087,ALENUF01
          ENDIF
.
          COMPARE   ALENC088,ZERO
          IF        !@EQUAL
            MOVE      ALENC088,ALENUF02
          ENDIF
.
          COMPARE   ALENC089,ZERO
          IF        !@EQUAL
            MOVE      ALENC089,ALENUF03
          ENDIF
.
          COMPARE   ALENC090,ZERO
          IF        !@EQUAL
            MOVE      ALENC090,ALENUF04
          ENDIF
.
          COMPARE   ALENC091,ZERO
          IF        !@EQUAL
            MOVE      ALENC091,ALENUF05
          ENDIF
.
          COMPARE   ALENC092,ZERO
          IF        !@EQUAL
            MOVE      ALENC092,ALENUF06
          ENDIF
.
          COMPARE   ALENC093,ZERO
          IF        !@EQUAL
            MOVE      ALENC093,ALENUF07
          ENDIF
.
          COMPARE   ALENC094,ZERO
          IF        !@EQUAL
            MOVE      ALENC094,ALENUF08
          ENDIF
.
          COMPARE   ALENC095,ZERO
          IF        !@EQUAL
            MOVE      ALENC095,ALENUF09
          ENDIF
.
          COMPARE   ALENC096,ZERO
          IF        !@EQUAL
            MOVE      ALENC096,ALENUF10
          ENDIF
.
          MATCH     ALENC097,Z70
          IF        !@EQUAL
            MOVE      ALENC097,ALENUF11
          ENDIF
.
          MATCH     ALENC098,Z70
          IF        !@EQUAL
            MOVE      ALENC098,ALENUF12
          ENDIF
.
          MATCH     ALENC099,Z70
          IF        !@EQUAL
            MOVE      ALENC099,ALENUF13
          ENDIF
.
          MATCH     ALENC100,Z70
          IF        !@EQUAL
            MOVE      ALENC100,ALENUF14
          ENDIF
.
          MATCH     ALENC101,Z70
          IF        !@EQUAL
            MOVE      ALENC101,ALENUF15
          ENDIF
.
          MATCH     ALENC102,Z70
          IF        !@EQUAL
            MOVE      ALENC102,ALENUF16
          ENDIF
.
          MATCH     ALENC103,Z70
          IF        !@EQUAL
            MOVE      ALENC103,ALENUF17
          ENDIF
.
          MATCH     ALENC104,Z70
          IF        !@EQUAL
            MOVE      ALENC104,ALENUF18
          ENDIF
.
          MATCH     ALENC105,Z70
          IF        !@EQUAL
            MOVE      ALENC105,ALENUF19
          ENDIF
.
          MATCH     ALENC106,Z70
          IF        !@EQUAL
            MOVE      ALENC106,ALENUF20
          ENDIF
.
          MATCH     ALENC107,Z70
          IF        !@EQUAL
            MOVE      ALENC107,ALENCMT1
          ENDIF
.
          MATCH     ALENC108,Z70
          IF        !@EQUAL
            MOVE      ALENC108,ALENCMT2
          ENDIF
.
          MATCH     ALENC109,Z70
          IF        !@EQUAL
            MOVE      ALENC109,ALENCDAT
          ENDIF
.
          MATCH     ALENC110,Z70
          IF        !@EQUAL
            MOVE      ALENC110,ALENCTIM
          ENDIF
.
          MATCH     ALENC111,Z70
          IF        !@EQUAL
            MOVE      ALENC111,ALENCUID
          ENDIF
.
          MATCH     ALENC112,Z70
          IF        !@EQUAL
            MOVE      ALENC112,ALENUDAT
          ENDIF
.
          MATCH     ALENC113,Z70
          IF        !@EQUAL
            MOVE      ALENC113,ALENUTIM
          ENDIF
.
          MATCH     ALENC114,Z70
          IF        !@EQUAL
            MOVE      ALENC114,ALENUUID
          ENDIF
.
          MATCH     ALENC115,Z70
          IF        !@EQUAL
            MOVE      ALENC115,ALENCOMP
          ENDIF
.
          MATCH     ALENC116,Z70
          IF        !@EQUAL
            MOVE      ALENC116,ALENUNIQ
          ENDIF
.
          MATCH     ALENC117,Z70
          IF        !@EQUAL
            MOVE      ALENC117,ALENSSAC
          ENDIF
.
          MATCH     ALENC118,Z70
          IF        !@EQUAL
            MOVE      ALENC118,ALENREVD
          ENDIF
.
          MATCH     ALENC119,Z70
          IF        !@EQUAL
            MOVE      ALENC119,ALENCREF
          ENDIF
.
          MATCH     ALENC120,Z70
          IF        !@EQUAL
            MOVE      ALENC120,ALENPURC
          ENDIF
.
          MATCH     ALENC121,Z70
          IF        !@EQUAL
            MOVE      ALENC121,ALENCONT
          ENDIF
.
          MATCH     ALENC122,Z70
          IF        !@EQUAL
            MOVE      ALENC122,ALENRHOS
          ENDIF
.
          MATCH     ALENC123,Z70
          IF        !@EQUAL
            MOVE      ALENC123,ALENCART
          ENDIF
.
          MATCH     ALENC124,Z70
          IF        !@EQUAL
            MOVE      ALENC124,ALENSTRA
          ENDIF
.
          MATCH     ALENC125,Z70
          IF        !@EQUAL
            MOVE      ALENC125,ALENOUTC
          ENDIF
.
          MATCH     ALENC126,Z70
          IF        !@EQUAL
            MOVE      ALENC126,ALENSRVD
          ENDIF
.
          MATCH     ALENC127,Z70
          IF        !@EQUAL
            MOVE      ALENC127,ALENSDEP     * Service Department (Cat CG)
          ENDIF
.
          MATCH     ALENC128,Z70
          IF        !@EQUAL
            MOVE      ALENC128,ALENACCN 
          ENDIF
.
MVALEN99  RETURN
.------------------------------------------------------------
. Service Code Selection for a given Department 
.------------------------------------------------------------
SRVITM00  UNPACK    DIM127,ANS,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,SRVITM10,SRVITM20
.
          MATCH     SP70,ALENSDEP
          IF        !@EQUAL
            PACK      KEY9,ALENSDEP,ALENSERV,SP70
          ELSE
            PACK      KEY9,ALREDEPT,ALENSERV,SP70
          ENDIF
          CALL      RDALSER1
          IF        OVRCD=0
            MATCH     "3",KEY1
            IF        @EQUAL
              WRITE     HTMLFILE;ALSRMHDP;
            ELSE
              WRITE     HTMLFILE;ALSRDESC;
            ENDIF
          ENDIF
          GOTO      SRVITM99
.
SRVITM10  WRITE     HTMLFILE;ALENSERV;
          GOTO      SRVITM99
.
SRVITM20  MOVE      SP70,KEY1
          UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      TWO,SERVFLAG
          MOVE      KEY1,SERVFLAG
. 
          PACK      KEY9,ALREDEPT,ALENSERV,SP70
          CALL      RDALSER1
          BRANCH    OVRCD,SRVITM25
.
          MATCH     "1",ALSRACTV
          IF        !@EQUAL
            PACK      KEY9,QUOTE,ALSRSERV,ALSRVACS,QUOTE  * Add VACS Flag
            WRITE     HTMLFILE;"<option value=",KEY9," selected>":
                               ALSRDESC,"</option>"
          ENDIF
.
SRVITM25  PACK      KEY9,ALREDEPT,SP70
          CALL      RSALSER1
          GOTO      SRVITM80
.
SRVITM80  CALL      RKALSER1
          BRANCH    OVRCD,SRVITM99
.
          MATCH     ALSRDEPT,ALREDEPT
          GOTO      SRVITM99 IF NOT EQUAL
          MATCH     "1",ALSRACTV
          GOTO      SRVITM80 IF NOT EQUAL
.
          IF        SERVFLAG = 0
            MATCH     "1",ALSRNURA
            GOTO      SRVITM80 IF EQUAL
          ENDIF
.
          IF        SERVFLAG = 1
            MATCH     "1",ALSRNURA
            GOTO      SRVITM80 IF NOT EQUAL
          ENDIF
.
.         *Add VACS Flag     
          MOVE      SP70,KEY15
          PACK      KEY15,QUOTE,ALSRSERV,ALSRVACS,SP1,ALSRMHDP,QUOTE 
.
          MATCH     ALENSERV,ALSRSERV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY15," selected>":
                               ALSRDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY15,">":
                               ALSRDESC,"</option>"
          ENDIF
          GOTO      SRVITM80
.
SRVITM99  RETURN
.
.---------------------------------------------------------------------------
.                                  ENCNOT00
.                          Set Encounter Notes Indicator
.---------------------------------------------------------------------------
ENCNOT00  MOVE      ZERO,ENCNOTES
.
....      MOVE      "001",KEY3
....      PACK      KEY25,ALENVISN,ALENENCT,KEY3,SP70
          CALL      RSALMDT1
ENCNOT10  CALL      RKALMDT1
          BRANCH    OVRCD,ENCNOT99
.
          MATCH     ALENVISN,ALMDVISN
          GOTO      ENCNOT99 IF NOT EQUAL
.
          MATCH     ALENENCT,ALMDENCN
          GOTO      ENCNOT99 IF NOT EQUAL
.
          MATCH     "001",ALMDTYPE
          GOTO      ENCNOT10 IF NOT EQUAL
.
          MATCH     "1",ALMDDELT
          GOTO      ENCNOT10 IF EQUAL
.
          MOVE      ONE,ENCNOTES
.
ENCNOT99  RETURN
.
.---------------------------------------------------------------------------
.                                  ENCMED00
.                          Set Encounter Medications Indicator
.---------------------------------------------------------------------------
ENCMED00  MOVE      ZERO,ENCMEDIC
.
....      PACK      KEY24,ENCOUTKY,Z70           * Medications
          CALL      RSALEMD1
          CALL      RPALEMD1
          BRANCH    OVRCD,ENCMED99
.
          MATCH     ADMISSNO,ALEMVISN
          GOTO      ENCMED99 IF NOT EQUAL
.
          MATCH     ALENENCT,ALEMENCT
          GOTO      ENCMED99 IF NOT EQUAL
.
          MOVE      ONE,ENCMEDIC                 * a Medication found
.
ENCMED99  RETURN
.
.---------------------------------------------------------------------------
.                                  ENCINT00
.                          Set Encounter Interventions Indicator
.---------------------------------------------------------------------------
ENCINT00  MOVE      ZERO,ENCINTEV
.
....      PACK      KEY24,ENCOUTKY,Z70      * Interventions
          CALL      RSALITV1
          CALL      RPALITV1
          BRANCH    OVRCD,ENCINT99
.
          MATCH     ADMISSNO,ALIVVISN
          GOTO      ENCINT99 IF NOT EQUAL
.
          MATCH     ALENENCT,ALIVENCT
          GOTO      ENCINT99 IF NOT EQUAL
.
          MOVE      ONE,ENCINTEV
.
ENCINT99  RETURN
.
.---------------------------------------------------------------------------
.                                  ENCSUP00
.                          Set Encounter Supplies Indicator
.---------------------------------------------------------------------------
ENCSUP00  MOVE      ZERO,ENCSUPLY
.
....      PACK      KEY24,ENCOUTKY,Z70           * Supplies
          CALL      RSALSUP1
          CALL      RPALSUP1
          BRANCH    OVRCD,ENCSUP99
.
          MATCH     ADMISSNO,ALSPVISN
          GOTO      ENCSUP99 IF NOT EQUAL
.
          MATCH     ALENENCT,ALSPENCT
          GOTO      ENCSUP99 IF NOT EQUAL
.
          MOVE      ONE,ENCSUPLY
.
ENCSUP99  RETURN
.
