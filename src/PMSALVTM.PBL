. *----------------------------------------------------------------------
. * Include Name  :   PMSALVTM.PBL
. *
. * Function      :   CGI Variables for PMSALVFD - pmsalvaf
. *
. * Mods          :
. *
. *       V11.02.01 05/04/2022 Alina Bhari   TSK 0912792
. *                Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
. Clear Parameters for alternative table 
.------------------------------------------------------------------------
CLRAVB00  MOVE      Z70,PMALV001
          MOVE      Z70,PMALV002
          MOVE      Z70,PMALV003
          MOVE      Z70,PMALV004
          MOVE      Z70,PMALV005
          MOVE      Z70,PMALV006
          MOVE      Z70,PMALV007
          MOVE      Z70,PMALV008
.
CLRAVB99  RETURN
.
.------------------------------------------------------------
. Set Parameters 
.------------------------------------------------------------
SMALVB00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SMALVB01,SMALVB02,SMALVB03,SMALVB04,SMALVB05:
                    SMALVB06,SMALVB07,SMALVB08
          GOTO      SMALVB99
.Webpas Visit Number
SMALVB01  PACK      PMALV001,QRYDATA,SP70
          GOTO      SMALVB99
.Alternate visit ID
SMALVB02  PACK      PMALV002,QRYDATA,SP70
          GOTO      SMALVB99
.Record Type
SMALVB03  PACK      PMALV003,QRYDATA,SP70
          GOTO      SMALVB99
.Date created ccyymmdd
SMALVB04  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00           *Set Cmon from MTHNAM3
          PACK      PMALV004,CCENT,CYEAR,CMON,CDAY
          GOTO      SMALVB99
.Time hh:mm:ss
SMALVB05  PACK      PMALV005,QRYDATA,SP70
          GOTO      SMALVB99
.UserID
SMALVB06  PACK      PMALV006,QRYDATA,SP70
          GOTO      SMALVB99
.Action
SMALVB07  PACK      PMALV007,QRYDATA,SP70
          GOTO      SMALVB99
.Comments
SMALVB08  PACK      PMALV008,QRYDATA,SP70
          GOTO      SMALVB99
.
SMALVB99  RETURN
.
.------------------------------------------------------------
. Output tags 
.------------------------------------------------------------
PALV0000  BRANCH    FLDITMNO,PALV0100,PALV0200,PALV0300,PALV0400,PALV0500:
                             PALV0600,PALV0700,PALV0800
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PALV9999
.
PALV0100  WRITE     HTMLFILE;PMVAVISN;
          GOTO      PALV9999
.
PALV0200  WRITE     HTMLFILE;PMVAAVIS;
          GOTO      PALV9999
.
PALV0300  MATCH     SP70,PMVATYPE
          IF        @EQUAL
            WRITE     HTMLFILE;"External ID";
          ENDIF
.
          MATCH     " 1",PMVATYPE
          IF        @EQUAL
            WRITE     HTMLFILE;"External ID";
          ENDIF
.
          MATCH     " M",PMVATYPE
          IF        @EQUAL
            WRITE     HTMLFILE;"MOSAIQ Visit";
          ENDIF
.
          GOTO      PALV9999
.
PALV0400  MATCH     SP70,PMVADATE
          GOTO      PALV9999 IF EQUAL 
          UNPACK    PMVADATE,CCENT,CYEAR,CMON,CDAY  * From Date in (DD MON CCYY)
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      PMVADATE,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;PMVADATE;
          GOTO      PALV9999
.
PALV0500  WRITE     HTMLFILE;PMVATIME;
          GOTO      PALV9999
.
PALV0600  WRITE     HTMLFILE;PMVACUID;
          GOTO      PALV9999
.
PALV0700  WRITE     HTMLFILE;PMVAACTN;
          GOTO      PALV9999
.
PALV0800  WRITE     HTMLFILE;PMVACOMM;
          GOTO      PALV9999
.
PALV9999  RETURN

.
.------------------------------------------------------------
. Move cgi variables to file variables 
.------------------------------------------------------------
MVALVB00  MATCH     Z70,PMALV001
          IF        !@EQUAL
            MOVE      PMALV001,PMVAVISN
          ENDIF      
.
          MATCH     Z70,PMALV002
          IF        !@EQUAL
            MOVE      PMALV002,PMVAAVIS
          ENDIF 
.
          MATCH     Z70,PMALV003
          IF        !@EQUAL
            MOVE      PMALV003,PMVATYPE
          ENDIF
.
          MATCH     Z70,PMALV004
          IF        !@EQUAL
            MOVE      PMALV004,PMVADATE
          ENDIF
.
          MATCH     Z70,PMALV005
          IF        !@EQUAL
            MOVE      PMALV005,PMVATIME
          ENDIF
.
          MATCH     Z70,PMALV006
          IF        !@EQUAL
            MOVE      PMALV006,PMVACUID
          ENDIF
.
          MATCH     Z70,PMALV007
          IF        !@EQUAL
            MOVE      PMALV007,PMVAACTN
          ENDIF
.
          MATCH     Z70,PMALV008
          IF        !@EQUAL
            MOVE      PMALV008,PMVACOMM
          ENDIF
.
MVALVB99  RETURN
.
