.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.01.00  15.02.2000 Charles Handaya
.           Validate ledger code
.           srf 637631
.-------------------------------------------------------
. VF.00.01  29.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
.-------------------------------------------------------
ALLEDGER  FORM      1
CHECKGL   DIM       12
CHECKSIN  DIM       5
CSTRING   DIM       35
CSTRLEN   FORM      2
CSUBJIND  FORM      "0"
DIVIDERS  FORM      1
FROMGL    DIM       12
FRGLDESC  DIM       30
FROMSIN   DIM       6                                                  *C-59696
NEWITEM   FORM      1
PRCODESC  DIM       40
REPTSEQ   FORM      1
TOGL      DIM       12
TOGLDESC  DIM       30
TOSIN     DIM       6                                                  *C-59696
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASUB43
.   Function      :   Print Commodity/Subjective Links to GL  
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       FMSAMAFD/INC
          INC       FMSCONFD/INC
          INC       FMSLMAFD/INC
          INC       FMSSBAFD/INC
          INC       SINCGAFD/INC
          INC       SINCONFD/INC
          INC       SINLTTFD/INC
          INC       SINSUAFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMGLDS  DIM      12 * Scr 00 Fld     4
TOGLDS    DIM      12 * Scr 00 Fld     5
FROMSIND  DIM       6 * Scr 00 Fld     6
TOSIND    DIM       6 * Scr 00 Fld     7
DIVIDERD  DIM       3 * Scr 00 Fld     8
REPTSEQD  DIM       1 * Scr 00 Fld     9
SEQDESC   DIM      31 * Scr 00 Fld    12
FRSINDES  DIM      30 * Scr 00 Fld    13
TOSINDES  DIM      30 * Scr 00 Fld    14
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASUB43"
PRGNAM    INIT      "Print Commodity/Subjective Links to GL  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RDCON000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA2,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA3,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA4,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA2,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA1,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA2,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA3,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Options                       
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Options                       
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      SETACC00
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Options                       
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMGLDS
          MOVE      SP70,TOGLDS  
          MOVE      SP70,FROMSIND
          MOVE      SP70,TOSIND  
          MOVE      SP70,DIVIDERD
          MOVE      SP70,REPTSEQD
          MOVE      SP70,FMLALEDG
          MOVE      SP70,FMLADESC
          MOVE      SP70,SEQDESC 
          MOVE      SP70,FRSINDES
          MOVE      SP70,TOSINDES
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Options                       
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Options                       
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Options                       
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Options                       
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Options                       
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMGLDS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TOGLDS,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      FROMSIND,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      TOSIND,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DIVIDERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      REPTSEQD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      FMLALEDG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      SEQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      FRSINDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      TOSINDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Options                       
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L006,SF00L006:
                            SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      REPT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      KFGL0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMGLDS,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      KTGL0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      TOGLDS,VAR       
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FRSINDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      KFCS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMSIND,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FRSINDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOSINDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      KTCS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      TOSIND,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOSINDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,DIVIDERD
          CALL      SETDIV00
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DIVIDERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SEQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      KSEQ0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SEQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMLADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      KFMLA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FMLALEDG,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMLADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read controlf file data and open gl files
.----------------------------------------------------------------------
RDCON000
          MOVE      "23",SECTOR
          READ      CONTROLF,SECTOR;*95,HACCNT
          MOVE      "24",SECTOR
          READ      CONTROLF,SECTOR;*135,HACCDATA
.
          IF        HACCNT<>1
            BEEP
            CLEAR     DISPMSG
            APPEND    "ERROR - GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
.
.---- accounting system active ----
.
          CLOSE     CONTROLF           * get gl control file if possible
          MOVE      "controlf.txt",KEY12
          PACK      KEY80,HACCDATA,KEY12
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CONTROLF,KEY80
          TRAPCLR   IO
          IF        OVRCD=1
            OPEN      CONTROLF,"controlf"
          ENDIF
.
          CALL      RDFMCO50           * Read Account Code Parameters
          CALL      RDFMCO51
          CALL      RDFMCO52
          CALL      RDFMCO65
          CLOSE     CONTROLF
          OPEN      CONTROLF,"controlf"
.
          MOVE      "fmsamaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSAMAA1,KEY80
          OPEN      FMSAMAA2,KEY80
          OPEN      FMSAMAA3,KEY80
          OPEN      FMSAMAA4,KEY80
.
          MOVE      "fmssbaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSSBAA1,KEY80
          OPEN      FMSSBAA2,KEY80
.
          MOVE      "fmslmaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMAA1,KEY80
.
          MOVE      FMSUUD3A,CSTRLEN
          MOVE      SIX,CSUBJIND
.
RDCON999  RETURN

.----------------------------------------------------------------------
. Set Accept
.----------------------------------------------------------------------
SETACC00  MOVE      ONE,ACCEPT
.
SETACC99  RETURN
.----------------------------------------------------------------------
. Set Divider Variable
.----------------------------------------------------------------------
SETDIV00  MOVE      DIVIDERD,DIVIDERS
.
SETDIV99  RETURN
.----------------------------------------------------------------------
. Create Report
.----------------------------------------------------------------------
REPT0000  MOVE      TRUE,NEWITEM
          CLOCK     TIME,CTIMEIS
          MATCH     FMLALEDG,SP70
          IF        @EQUAL
            MOVE      TRUE,ALLEDGER
          ELSE
            MOVE      FALSE,ALLEDGER
          ENDIF
          DISPLAY   *P01:24,"Ledger: ",*V2LON,*P09:24,FMLALEDG,*HOFF:
                    *P13:24,"GL Sub: ",*V2LON,*P21:24,FROMGL,*HOFF:
                    *P35:24,"Comm/Subj.: ",*V2LON,*P47:24,FROMSIN
          IF        REPTSEQ=1
            CALL      REPGL000     * GL Report Sequence
          ELSE
            CALL      REPCS000     * Commodity/Subjective Sequence
          ENDIF
.
          PRINT     "--------------------------       End of Report       ":
                    "--------------------------"
          MOVE      "Report Completed - ",DISPMSG
          CALL      MESSAGE1
.
REPT9999  RETURN
.----------------------------------------------------------------------
. GL Report Sequence
.----------------------------------------------------------------------
REPGL000  MOVE      SP70,CHECKGL
          PACK      KEY20,FMLALEDG,FROMGL,SP70                         *C-59696
          CALL      RSSILT2
REPGL100  CALL      RKSILT2
          BRANCH    OVRCD,REPGL999
.
          IF        ALLEDGER=FALSE
            MATCH     FMLALEDG,SILTLED
            GOTO      REPGL999 IF NOT EQUAL
            MATCH     SILTSUB,TOGL
            GOTO      REPGL999 IF LESS
          ELSE
            MATCH     SILTSUB,TOGL
            GOTO      REPGL100 IF LESS
          ENDIF
.
          MATCH     FROMSIN,SILTCOD
          GOTO      REPGL100 IF LESS
.
          MATCH     SILTCOD,TOSIN
          GOTO      REPGL100 IF LESS
.
          MATCH     CHECKGL,SP70
          IF        @EQUAL
            MOVE      SILTSUB,CHECKGL
          ENDIF
.
          CALL      PDIV0000
          CALL      GDESC000       * Get Description
          CALL      PDATA000
          GOTO      REPGL100
.
REPGL999  RETURN
.----------------------------------------------------------------------
. Comm/Subj Report Sequence
.----------------------------------------------------------------------
REPCS000  MOVE      SP70,CHECKSIN
          PACK      KEY20,FMLALEDG,FROMSIN,SP70                        *C-59696
          CALL      RSSILT3
REPCS100  CALL      RKSILT3
          BRANCH    OVRCD,REPCS999
.
          IF        ALLEDGER=FALSE
            MATCH     FMLALEDG,SILTLED
            GOTO      REPGL999 IF NOT EQUAL
            MATCH     SILTCOD,TOSIN
            GOTO      REPCS999 IF LESS
          ELSE
            MATCH     SILTCOD,TOSIN
            GOTO      REPCS100 IF LESS
          ENDIF
.
          MATCH     FROMGL,SILTSUB
          GOTO      REPCS100 IF LESS
.
          MATCH     SILTSUB,TOGL
          GOTO      REPCS100 IF LESS
.
          MATCH     CHECKGL,SP70
          IF        @EQUAL
            MOVE      SILTCOD,CHECKSIN
          ENDIF
.
          CALL      PDIV0000
          CALL      GDESC000       * Get Description
          MOVE      TRUE,NEWITEM  * Print All Data Always
          CALL      PDATA000
          GOTO      REPCS100
.
REPCS999  RETURN
.----------------------------------------------------------------------
. Print Divider
.----------------------------------------------------------------------
PDIV0000
          MATCH     CHECKGL,SILTSUB
          IF        !@EQUAL
            IF        DIVIDERS=1 & CLNO < 56
              CALL      UND80
            ENDIF
            MOVE      SILTSUB,CHECKGL
            MOVE      TRUE,NEWITEM
          ENDIF
.
PDIV9999  RETURN
.----------------------------------------------------------------------
. Print Data
.----------------------------------------------------------------------
PDATA000
          IF        CPAGENO<1 | CLNO > 56
            CALL      PHEAD000
          ENDIF
.
          IF        NEWITEM=1
            PRINT     *01,SILTLED:
                      *09,SILTSUB:
                      *24,SILTCOD:
                      *31,PRCODESC
          ELSE
            PRINT     *24,SILTCOD:
                      *31,PRCODESC
          ENDIF
          DISPLAY   *V2LON,*P09:24,SILTLED,*P21:24,SILTSUB,*P47:24,SILTCOD
          ADD       ONE,CLNO
          MOVE      FALSE,NEWITEM
.
PDATA999  RETURN
.----------------------------------------------------------------------
. Print Header
.----------------------------------------------------------------------
PHEAD000
          CALL      HEAD80
          PRINT     *N:
                    *01,"Ledger  ":
                    *09,"GL Subjective  ":
                    *24,"Commodity/Product Group Link                    ",*N:
                    *01,"------  ":
                    *09,"-------------  ":
                    *24,"------------------------------------------------"
          MOVE      FIVE,CLNO
          MOVE      TRUE,NEWITEM
.
PHEAD999  RETURN
.----------------------------------------------------------------------
. Get Description
.----------------------------------------------------------------------
GDESC000
          PACK      KEY5,SILTCOD,SP70
          CALL      RDSISA1
          IF        OVRCD=0
            MOVE      SISADESC,PRCODESC
          ELSE
            PACK      KEY6,SILTCOD,SP70                                *C-59696
            CALL      RDSIGA1
            IF        OVRCD=0
              MOVE      SIGADES,PRCODESC
            ELSE
              MOVE      SP70,PRCODESC
            ENDIF
          ENDIF
.
GDESC999  RETURN
.----------------------------------------------------------------------
. Keyin From GL Code
.----------------------------------------------------------------------
KFGL0000
          CALL      KSBAFM00
          IF        EXIT=2
            GOTO      KFGL9999
          ENDIF
.
          IF        EXIT=1
            MOVE      "Start       ",FROMGLDS
            MOVE      SP70,FROMGL
            MOVE      SP70,FRGLDESC
            MOVE      SP70,FMLADESC
          ELSE
            MOVE      FMSASUBJ,FROMGL
            MOVE      FMSASUBJ,FROMGLDS
            MOVE      FMSADESC,FRGLDESC
          ENDIF
.
          IF        ACCEPT<>1
            MATCH     FROMGL,TOGL
            IF        @LESS
              MOVE      "'From' must be less than the 'To' GL Code - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KFGL0000
            ENDIF
          ENDIF
.
KFGL9999  RETURN
.----------------------------------------------------------------------
. Keyin To GL Code
.----------------------------------------------------------------------
KTGL0000
          CALL      KSBAFM00
          IF        EXIT=2
            GOTO      KTGL9999
          ENDIF
.
          IF        EXIT=1
            MOVE      "End         ",TOGLDS
            MOVE      "zzzzzzzzzzzz",TOGL
            MOVE      SP70,TOGLDESC
            MOVE      SP70,FMLADESC
          ELSE
            MOVE      FMSASUBJ,TOGL
            MOVE      FMSASUBJ,TOGLDS
            MOVE      FMSADESC,TOGLDESC
          ENDIF
.
          MATCH     FROMGL,TOGL
          IF        @LESS
            MOVE      "'From' must be less than the 'To' GL Code - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KTGL0000
          ENDIF
.
.
KTGL9999  RETURN
.----------------------------------------------------------------------
. Keyin From Comm/Subj. Code
.----------------------------------------------------------------------
KFCS0000  KEYIN     *PCCOL:CVERT,*V2LON,FROMSIND
          PACK      FROMSIND,FROMSIND,SP70
.
. ------- Check for exitchar
          MATCH     EXITCHAR,FROMSIND
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KFCS9999
          ENDIF
.
. ------- Check for Space
          MATCH     SP70,FROMSIND
          IF        @EQUAL
            MOVE      "Start",FROMSIND
            MOVE      SP70,FROMSIN
            MOVE      SP70,FRSINDES
            GOTO      KFCS9999
          ENDIF
.
.-------- Check for Valid SIN Comm/Subj Code
          PACK      KEY8,FMLALEDG,FROMSIND                             *C-59696
          CALL      RDSILT1
          IF        OVRCD<>0
            MOVE      "Code does not exist - ",DISPMSG
            CALL      MESSAGE1
            MOVE      SP70,FROMSIND
            GOTO      KFCS0000
          ENDIF
.
          IF        ACCEPT<>1
            MATCH     FROMSIND,TOSIN
            IF        @LESS
             MOVE      "'From' must be less than 'To' Comm/Subj Code - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KFCS0000
            ENDIF
          ENDIF
.
          MOVE      FROMSIND,FROMSIN
          CALL      GDESC000
          MOVE      PRCODESC,FRSINDES
.
KFCS9999  RETURN
.----------------------------------------------------------------------
. Keyin To Comm/Subj. Code
.----------------------------------------------------------------------
KTCS0000  KEYIN     *PCCOL:CVERT,*V2LON,TOSIND
          PACK      TOSIND,TOSIND,SP70
.
. ------- Check for Space
          MATCH     SP70,TOSIND
          IF        @EQUAL
            MOVE      "End  ",TOSIND
            MOVE      "zzzzz",TOSIN
            GOTO      KTCS9999
          ENDIF
.
. ------- Check for exitchar
          MATCH     EXITCHAR,TOSIND
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KTCS9999
          ENDIF
.
.-------- Check for Valid SIN Comm/Subj Code
          PACK      KEY8,FMLALEDG,TOSIND                               *C-59696
          CALL      RDSILT1
          IF        OVRCD<>0
            MOVE      "Code does not exist - ",DISPMSG
            CALL      MESSAGE1
            MOVE      SP70,TOSIND
            GOTO      KTCS0000
          ENDIF
.
          MATCH     FROMSIN,TOSIND
          IF        @LESS
            MOVE      "'From' must be less than 'To' Comm/Subj Code - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KTCS0000
          ENDIF
.
          MOVE      TOSIND,TOSIN
          CALL      GDESC000
          MOVE      PRCODESC,TOSINDES
.
KTCS9999  RETURN
.----------------------------------------------------------------------
. Keyin Report Sequence
.----------------------------------------------------------------------
KSEQ0000
          KEYIN     *PCCOL:CVERT,*V2LON,REPTSEQD
          PACK      REPTSEQD,REPTSEQD,SP70
.
. ------- Check for Space
          MATCH     SP70,REPTSEQD
          IF        @EQUAL
            MOVE      ONE,REPTSEQ
            GOTO      KSEQ9999
          ENDIF
.
. ------- Check for exitchar
          MATCH     EXITCHAR,REPTSEQD
          GOTO      KSEQ9999 IF EQUAL
.
          REP       "gGcC",REPTSEQD
          MATCH     ANSG,REPTSEQD
          IF        !@EQUAL
            MATCH     ANSC,REPTSEQD
            IF        !@EQUAL
              MOVE      "Invalid Option - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KSEQ0000
            ELSE
              MOVE      "Commodity/Subjective Code Order",SEQDESC
            ENDIF
          ELSE
            MOVE      "G/L Subjective Code Order      ",SEQDESC
          ENDIF
.
          MOVE      REPTSEQD,ANS
          REP       "G1C2",ANS
          MOVE      ANS,REPTSEQ     1 or 2
.
KSEQ9999  RETURN
.----------------------------------------------------------------------
. Keyin Ledger Code
.----------------------------------------------------------------------
KFMLA000  MOVE      ZERO,CKEYTYP            * srf 637631
          CALL      KFMLAA00
          IF        EXIT=2
            GOTO      KFMLA999
          ENDIF
.
          IF        EXIT=1
            MOVE      "All Ledgers                             ",FMLADESC
          ENDIF
.
KFMLA999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       FMSAMAIO/INC
          INC       FMSCONIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMAKY    
          INC       FMSSBAIO/INC
          INC       FMSSBAKY    
          INC       GETSTRCD    
          INC       SINCGAIO/INC
          INC       SINLTTIO/INC
          INC       SINLTTKY    
          INC       SINSUAIO/INC
.
          INC       STDGENCD
.
