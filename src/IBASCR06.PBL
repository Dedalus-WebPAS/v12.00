.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. Modifications :
.
. C2.00.02 08.06.2000  Sandra Barcham
.          Open scrmasaf to stop I * C          
. C2.00.01 09.09.1999  Sandra Barcham
.          Change ITEMNO to XITEMNO for PATITMFD
.-------------------------------------------------------
. V6.00.10 11.01.1994 B.G.Ackland
.          Update with lastest File Changes
.
. V6.00.11 06.05.1997 B.G.Ackland
.          Don't Open Function Files for Normal Screen Transfer
.
.-------------------------------------------------------
SAVEPID   DIM       8
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASCR06
.   Function      :   Transfer Program Details                
.   Generated  On :   08/06/2000
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SCRFDTFD/INC
          INC       SCRFLDFD/INC
          INC       SCRFMAFD/INC
          INC       SCRINCFD/INC
          INC       SCRMASFD/INC
          INC       SCROPNFD/INC
          INC       SCRPRGFD/INC
          INC       SCRTAGFD/INC
          INC       SCRTRNDF    
          INC       SCRVCMFD/INC
          INC       SCRVERFD/INC
          INC       SCRWPDFD/INC
          INC       SYSCOMFD/INC
          INC       SYSFILFD/INC
          INC       SYSFLDFD/INC
          INC       SYSHVRFD/INC
          INC       SYSIDXFD/INC
          INC       SYSKVRFD/INC
          INC       SYSSCFFD/INC
.=========================
.Local Variable Definition
.-------------------------
DIRPATH   DIM      40 * Scr 00 Fld     3
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASCR06"
PRGNAM    INIT      "Transfer Program Details                "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC01L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening scrfdtaf";
          OPEN      SCRFDTA1,"scrfdtaf"
          DISPLAY   *P56:24,"Opening scrfldaf";
          OPEN      SCRFLDA1,"scrfldaf"
          DISPLAY   *P56:24,"Opening scrfldaf";
          OPEN      SCRFLDA2,"scrfldaf"
          DISPLAY   *P56:24,"Opening scrfldaf";
          OPEN      SCRFLDA3,"scrfldaf"
          DISPLAY   *P56:24,"Opening scrfmaaf";
          OPEN      SCRFMAA1,"scrfmaaf"
          DISPLAY   *P56:24,"Opening scrfmaaf";
          OPEN      SCRFMAA2,"scrfmaaf"
          DISPLAY   *P56:24,"Opening scrincaf";
          OPEN      SCRINCA1,"scrincaf"
          DISPLAY   *P56:24,"Opening scrmasaf";
          OPEN      SCRMASA1,"scrmasaf"
          DISPLAY   *P56:24,"Opening scropnaf";
          OPEN      SCROPNA1,"scropnaf"
          DISPLAY   *P56:24,"Opening scrprgaf";
          OPEN      SCRPRGA1,"scrprgaf"
          DISPLAY   *P56:24,"Opening scrtagaf";
          OPEN      SCRTAGA1,"scrtagaf"
          DISPLAY   *P56:24,"Opening scrvcmaf";
          OPEN      SCRVCMA1,"scrvcmaf"
          DISPLAY   *P56:24,"Opening scrveraf";
          OPEN      SCRVERA1,"scrveraf"
          DISPLAY   *P56:24,"Opening scrwpdaf";
          OPEN      SCRWPDA1,"scrwpdaf"
          DISPLAY   *P56:24,"Opening syscomaf";
          OPEN      SYSCOMA1,"syscomaf"
          DISPLAY   *P56:24,"Opening sysfilaf";
          OPEN      SYSFILA1,"sysfilaf"
          DISPLAY   *P56:24,"Opening sysfilaf";
          OPEN      SYSFILA2,"sysfilaf"
          DISPLAY   *P56:24,"Opening sysfldaf";
          OPEN      SYSFLDA1,"sysfldaf"
          DISPLAY   *P56:24,"Opening sysfldaf";
          OPEN      SYSFLDA2,"sysfldaf"
          DISPLAY   *P56:24,"Opening syshvraf";
          OPEN      SYSHVRA1,"syshvraf"
          DISPLAY   *P56:24,"Opening sysidxaf";
          OPEN      SYSIDXA1,"sysidxaf"
          DISPLAY   *P56:24,"Opening syskvraf";
          OPEN      SYSKVRA1,"syskvraf"
          DISPLAY   *P56:24,"Opening sysscfaf";
          OPEN      SYSSCFA1,"sysscfaf"
          DISPLAY   *P56:24,"Opening sysscfaf";
          OPEN      SYSSCFA2,"sysscfaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Transfer Program Details           
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Available Selections               
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Transfer Complete Program          
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * System Transfer                    
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Transfer a Function                
          ENDIF
          RETURN
.--------------------------------
. Screen - Transfer Program Details           
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transfer Program Details           
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,SCPRPID 
          MOVE      SP70,SCPRNAM 
          MOVE      SP70,DIRPATH 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transfer Program Details           
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transfer Program Details           
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transfer Program Details           
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transfer Program Details           
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transfer Program Details           
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L101,PS00L102,PS00L103,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      SCPRPID,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SCPRNAM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Transfer Program Details           
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L006,SF00L102,SF00L006:
                            SF00L103,SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L020,SF00L102,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SCPRNAM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPROG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SCPRPID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCPRNAM,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          STRIP     DIRPATH 
          SFORMAT   VAR,SCPSLEN
          MOVE      DIRPATH,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,DIRPATH 
          SFORMAT   VAR,127
          ENDSET    DIRPATH 
          APPEND    SP70,DIRPATH 
          RESET     DIRPATH 
          CMATCH    EXITCHAR,DIRPATH 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,DIRPATH 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
          ENDIF
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL      SCPRTR00
          GOTO      SF00L001
.
SF00L104
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Available Selections               
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Available Selections               
.-------------------------------------------------------
CF01L000  COMPARE   ZERO,ACCEPT
              GOTO      CF01L999 IF EQUAL
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Available Selections               
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Available Selections               
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Available Selections               
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Available Selections               
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Available Selections               
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Available Selections               
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL      SC00L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L105
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Transfer Complete Program          
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transfer Complete Program          
.-------------------------------------------------------
CF02L000  COMPARE   ZERO,ACCEPT
              GOTO      CF02L999 IF EQUAL
          MOVE      SP70,SCPRPID 
          MOVE      SP70,SCPRNAM 
          MOVE      SP70,DIRPATH 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transfer Complete Program          
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transfer Complete Program          
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transfer Complete Program          
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transfer Complete Program          
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transfer Complete Program          
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L101,PS02L102,PS02L103,PS02L999:
                            PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      SCPRPID,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      SCPRNAM,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Transfer Complete Program          
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L006,SF02L102,SF02L006:
                            SF02L103,SF02L104
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L020,SF02L102,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SCPRNAM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPROG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L101
            ENDIF
            BRANCH    EXIT,SF02L101,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      SCPRPID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCPRNAM,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L102
          CALL     SELECTED
          STRIP     DIRPATH 
          SFORMAT   VAR,SCPSLEN
          MOVE      DIRPATH,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,DIRPATH 
          SFORMAT   VAR,127
          ENDSET    DIRPATH 
          APPEND    SP70,DIRPATH 
          RESET     DIRPATH 
          CMATCH    EXITCHAR,DIRPATH 
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,DIRPATH 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L102
            ENDIF
          ENDIF
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L103
          CALL      SCPRTR00
          GOTO      SF02L001
.
SF02L104
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - System Transfer                    
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : System Transfer                    
.-------------------------------------------------------
CF03L000  COMPARE   ZERO,ACCEPT
              GOTO      CF03L999 IF EQUAL
          MOVE      SP70,SYSCSYS 
          MOVE      SP70,SYSCDES 
          MOVE      SP70,DIRPATH 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for System Transfer                    
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : System Transfer                    
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : System Transfer                    
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : System Transfer                    
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : System Transfer                    
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L999:
                            PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      SYSCSYS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SYSCDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : System Transfer                    
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L006,SF03L102,SF03L006:
                            SF03L103,SF03L104
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L020,SF03L102,SF03L020:
                            SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SYSCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSYSCA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
            BRANCH    EXIT,SF03L101,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SYSCSYS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SYSCDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L102
          CALL     SELECTED
          STRIP     DIRPATH 
          SFORMAT   VAR,SCPSLEN
          MOVE      DIRPATH,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,DIRPATH 
          SFORMAT   VAR,127
          ENDSET    DIRPATH 
          APPEND    SP70,DIRPATH 
          RESET     DIRPATH 
          CMATCH    EXITCHAR,DIRPATH 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,DIRPATH 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L102
            ENDIF
          ENDIF
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L103
          CALL      SCPRTR00
          GOTO      SF03L001
.
SF03L104
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Transfer a Function                
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transfer a Function                
.-------------------------------------------------------
CF04L000  COMPARE   ZERO,ACCEPT
              GOTO      CF04L999 IF EQUAL
          MOVE      SP70,SCFMFID 
          MOVE      SP70,SCFMDES 
          MOVE      SP70,DIRPATH 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transfer a Function                
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transfer a Function                
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transfer a Function                
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transfer a Function                
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transfer a Function                
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L101,PS04L102,PS04L103,PS04L999:
                            PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      SCFMFID,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      SCFMDES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Transfer a Function                
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L101,SF04L006,SF04L102,SF04L006:
                            SF04L103,SF04L104
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L101,SF04L020,SF04L102,SF04L020:
                            SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SCFMDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      CLRPID00
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSCFMA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L101
            ENDIF
            BRANCH    EXIT,SF04L101,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      SCFMFID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCFMDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L102
          CALL     SELECTED
          STRIP     DIRPATH 
          SFORMAT   VAR,SCPSLEN
          MOVE      DIRPATH,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,DIRPATH 
          SFORMAT   VAR,127
          ENDSET    DIRPATH 
          APPEND    SP70,DIRPATH 
          RESET     DIRPATH 
          CMATCH    EXITCHAR,DIRPATH 
          GOTO      SF04L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,DIRPATH 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L102
            ENDIF
          ENDIF
          MOVE      DIRPATH,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L103
          CALL      SCPRTR00
          GOTO      SF04L001
.
SF04L104
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
EPROG000  MOVE     TWO,CKEYTYP
          CALL     KSCPRA00
          BRANCH   EXIT,EPROG999,EPROG999
EPROG999  RETURN
.------------------------------------
. Transfer Program Details
.------------------------------------
SCPRTR00  CALL      TRANOPEN
          MATCH     "03",SCRID
          IF        @EQUAL
            CALL      SYSTRN00
            GOTO      SCPRTR99
          ENDIF
          MATCH     "04",SCRID
          IF        @EQUAL
            CALL      FUNTRN00
            GOTO      SCPRTR99
          ENDIF
.
          MOVE      SCPRPID,SAVEPID
          SQUEEZE   SAVEPID
          MOVE      SCPRPID,KEY8
          CALL      RDSCPR1
          BRANCH    OVRCD,SCPRTR10
          CALL      PRGTRN00
          GOTO      SCPRTR99
.
SCPRTR10  CALL      RKSCPR1
          BRANCH    OVRCD,SCPRTR99
          MATCH     SAVEPID,SCPRPID
          GOTO      SCPRTR99 IF NOT EQUAL
.
          DISPLAY   *P1:24,*EL,"Program : ",SCPRPID
.
          CALL      PRGTRN00
          GOTO      SCPRTR10
.
SCPRTR99  BEEP
          MOVE      "Transfer Complete - ",DISPMSG
          CALL      MESSAGE1
          CALL      TRANCLOS
          RETURN
.
.         Selections
.
PRGTRN00  PACK      KEY13,SCPRPID,SP70
          CALL      RSSCSL1
PRGTRN10
          CALL      RKSCSL1
          BRANCH    OVRCD,PRGTRN12
          MATCH     SCPRPID,SCSLPID
          GOTO      PRGTRN12 IF NOT EQUAL
          PACK      KEY13,SCSLPID,SCSLSID,SCSLSEL
          CALL      RATASL1
          IF        OVRCD=0
            CALL      UPTASL1
          ELSE
            CALL      WRTASL1
          ENDIF
          GOTO      PRGTRN10
.
.         Positions
.
PRGTRN12
          PACK      KEY15,SCPRPID,SP70
          CALL      RSSCPS1
PRGTRN14
          CALL      RKSCPS1
          BRANCH    OVRCD,PRGTRN16
          MATCH     SCPRPID,SCPSPID
          GOTO      PRGTRN16 IF NOT EQUAL
          PACK      KEY15,SCPSPID,SCPSSID,SCPSROW,SCPSCOL
          CALL      RATAPS1
          IF        OVRCD=0
            CALL      UPTAPS1
          ELSE
            CALL      WRTAPS1
          ENDIF
          GOTO      PRGTRN14
.
.         Background
.
PRGTRN16
          PACK      KEY12,SCPRPID,SP70
          CALL      RSSCSB1
PRGTRN18
          CALL      RKSCSB1
          BRANCH    OVRCD,PRGTRN20
          MATCH     SCPRPID,SCSBPID
          GOTO      PRGTRN20 IF NOT EQUAL
          PACK      KEY12,SCSBPID,SCSBSID,SCSBLIN
          CALL      RATASB1
          IF        OVRCD=0
            CALL      UPTASB1
          ELSE
            CALL      WRTASB1
          ENDIF
          GOTO      PRGTRN18
.
.         Screen Master Record
.
PRGTRN20
          PACK      KEY10,SCPRPID,SP70
          CALL      RSSCMA1
PRGTRN22
          CALL      RKSCMA1
          BRANCH    OVRCD,PRGTRN24
          MATCH     SCPRPID,SCMAPID
          GOTO      PRGTRN24 IF NOT EQUAL
          PACK      KEY10,SCMAPID,SCMASID
          CALL      RATAMA1
          IF        OVRCD=0
            CALL      UPTAMA1
          ELSE
            CALL      WRTAMA1
          ENDIF
          MATCH     "00",SCRID
          GOTO      PRGTRN22 IF EQUAL
          MOVE      SCMACBF,KEY8
          CALL      CHKFUN00
.
          MOVE      SCMACAF,KEY8
          CALL      CHKFUN00
.
          GOTO      PRGTRN22
.
.         Field Records
.
PRGTRN24  PACK      KEY15,SCPRPID,SP70
          CALL      RSSCFL1
PRGTRN26
          CALL      RKSCFL1
          BRANCH    OVRCD,PRGTRN28
          MATCH     SCPRPID,SCFLPID
          GOTO      PRGTRN28 IF NOT EQUAL
          PACK      KEY15,SCFLPID,SCFLSID,SCFLFNO
          CALL      RATAFL1
          IF        OVRCD=0
            CALL      UPTAFL1
          ELSE
            CALL      WRTAFL1
          ENDIF
          MATCH     "00",SCRID
          GOTO      PRGTRN26 IF EQUAL
          MOVE      SCFLCAL,KEY8
          CALL      CHKFUN00
          GOTO      PRGTRN26
.
.         Program Master Rcord
.
PRGTRN28
          PACK      KEY8,SCPRPID
          CALL      RATAPR1
          IF        OVRCD=0
            CALL      UPTAPR1
          ELSE
            CALL      WRTAPR1
          ENDIF
.
          MATCH     "00",SCRID
          GOTO      PRGTRN99 IF EQUAL
.
.         Includes
.
          PACK      KEY21,SCPRPID,SP70
          CALL      RSSCIN1
PRGTRN30
          CALL      RKSCIN1
          BRANCH    OVRCD,PRGTRN32
          MATCH     SCPRPID,SCINPID
          GOTO      PRGTRN32 IF NOT EQUAL
          PACK      KEY21,SCINPID,SCINTYP,SCININC
          CALL      RATAIN1
          IF        OVRCD=0
            CALL      UPTAIN1
          ELSE
            CALL      WRTAIN1
          ENDIF
          GOTO      PRGTRN30
.
.         Opens
.
PRGTRN32
          PACK      KEY16,SCPRPID,SP70
          CALL      RSSCOP1
PRGTRN34
          CALL      RKSCOP1
          BRANCH    OVRCD,PRGTRN36
          MATCH     SCPRPID,SCOPPID
          GOTO      PRGTRN36 IF NOT EQUAL
          PACK      KEY16,SCOPPID,SCOPFIL
          CALL      RATAOP1
          IF        OVRCD=0
            CALL      UPTAOP1
          ELSE
            CALL      WRTAOP1
          ENDIF
          GOTO      PRGTRN34
.
.         Tags
.
PRGTRN36
          PACK      KEY15,SCPRPID,SP70
          CALL      RSSCTA1
PRGTRN38
          CALL      RKSCTA1
          BRANCH    OVRCD,PRGTRN40
          MATCH     SCPRPID,SCTAPID
          GOTO      PRGTRN40 IF NOT EQUAL
          PACK      KEY15,SCTAPID,SCTASID,SCTAFNO
          CALL      RATATA1
          IF        OVRCD=0
            CALL      UPTATA1
          ELSE
            CALL      WRTATA1
          ENDIF
          MATCH     "00",SCRID
          GOTO      PRGTRN38 IF EQUAL
          MOVE      SCTACBD,KEY8
          CALL      CHKFUN00
          MOVE      SCTACAD,KEY8
          CALL      CHKFUN00
          MOVE      SCTACBK,KEY8
          CALL      CHKFUN00
          MOVE      SCTACAK,KEY8
          CALL      CHKFUN00
          GOTO      PRGTRN38
.
PRGTRN40
.
PRGTRN44
.
.         WP Details
.
PRGTRN48
          PACK      KEY15,SCPRPID,SP70
          CALL      RSSCWP1
PRGTRN50
          CALL      RKSCWP1
          BRANCH    OVRCD,PRGTRN52
          MATCH     SCPRPID,SCWPPID
          GOTO      PRGTRN52 IF NOT EQUAL
          PACK      KEY15,SCWPPID,SCWPSID,SCWPITM
          CALL      RATAWP1
          IF        OVRCD=0
            CALL      UPTAWP1
          ELSE
            CALL      WRTAWP1
          ENDIF
          GOTO      PRGTRN50
.
PRGTRN52
.
PRGTRN99
          RETURN
.----------------------------------------
. Transfer Function Details
.----------------------------------------
FUNTRN00
.
. Function Master Record
.
          PACK      KEY16,SCFMFID,SCFMPID
          CALL      RATAFM1
          IF        OVRCD=0
            CALL      UPTAFM1
          ELSE
            CALL      WRTAFM1
          ENDIF
.
.         Function Details
.
          PACK      KEY21,SCFMFID,SCFMPID,SP70
          CALL      RSSCFD1
FUNTRN10
          CALL      RKSCFD1
          BRANCH    OVRCD,FUNTRN99
          MATCH     SCFMFID,SCFDFID
          GOTO      FUNTRN99 IF NOT EQUAL
          MATCH     SCFMPID,SCFDPID
          GOTO      FUNTRN99 IF NOT EQUAL
          PACK      KEY21,SCFDFID,SCFDPID,SCFDLIN
          CALL      RATAFD1
          IF        OVRCD=0
            CALL      UPTAFD1
          ELSE
            CALL      WRTAFD1
          ENDIF
          GOTO      FUNTRN10
.
FUNTRN99  RETURN
.
.----------------------------------------
. Transfer System Details
.----------------------------------------
SYSTRN00
.
. System Master Record
.
          PACK      KEY2,SYSCSYS
          CALL      RATBSC1
          IF        OVRCD=0
            CALL      UPTBSC1
          ELSE
            CALL      WRTBSC1
          ENDIF
.
.         Comments
.
          PACK      KEY10,SYSCSYS,SP70
          CALL      RSSYCM1
SYSTRN10
          CALL      RKSYCM1
          BRANCH    OVRCD,SYSTRN12
          MATCH     SYSCSYS,SYCMSYS
          GOTO      SYSTRN12 IF NOT EQUAL
          PACK      KEY10,SYCMSYS,SYCMFIL,SYCMFLD,SYCMUNIQ
          CALL      RATBCM1
          IF        OVRCD=0
            CALL      UPTBCM1
          ELSE
            CALL      WRTBCM1
          ENDIF
          GOTO      SYSTRN10
.
.         Files
.
SYSTRN12
          PACK      KEY4,SYSCSYS,SP70
          CALL      RSSYFI1
SYSTRN14
          CALL      RKSYFI1
          BRANCH    OVRCD,SYSTRN16
          MATCH     SYSCSYS,SYFISYS
          GOTO      SYSTRN16 IF NOT EQUAL
          PACK      KEY4,SYFISYS,SYFIFIL
          CALL      RATBFI1
          IF        OVRCD=0
            CALL      UPTBFI1
          ELSE
            CALL      WRTBFI1
          ENDIF
          GOTO      SYSTRN14
.
.         Fields
.
SYSTRN16
          PACK      KEY8,SYSCSYS,SP70
          CALL      RSSYFL1
SYSTRN18
          CALL      RKSYFL1
          BRANCH    OVRCD,SYSTRN20
          MATCH     SYSCSYS,SYFLSYS
          GOTO      SYSTRN20 IF NOT EQUAL
          PACK      KEY8,SYFLSYS,SYFLFIL,SYFLNUM
          CALL      RATBFL1
          IF        OVRCD=0
            CALL      UPTBFL1
          ELSE
            CALL      WRTBFL1
          ENDIF
          GOTO      SYSTRN18
.
.         Help
.
SYSTRN20
          PACK      KEY5,SYSCSYS,SP70
          CALL      RSSYHV1
SYSTRN22
          CALL      RKSYHV1
          BRANCH    OVRCD,SYSTRN24
          MATCH     SYSCSYS,SYHVSYS
          GOTO      SYSTRN24 IF NOT EQUAL
          PACK      KEY5,SYHVSYS,SYHVFIL,SYHVHID
          CALL      RATBHV1
          IF        OVRCD=0
            CALL      UPTBHV1
          ELSE
            CALL      WRTBHV1
          ENDIF
          GOTO      SYSTRN22
.
.         Indexs
.
SYSTRN24
          PACK      KEY5,SYSCSYS,SP70
          CALL      RSSYID1
SYSTRN26
          CALL      RKSYID1
          BRANCH    OVRCD,SYSTRN28
          MATCH     SYSCSYS,SYIDSYS
          GOTO      SYSTRN28 IF NOT EQUAL
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX
          CALL      RATBID1
          IF        OVRCD=0
            CALL      UPTBID1
          ELSE
            CALL      WRTBID1
          ENDIF
          GOTO      SYSTRN26
.
.         Keyins
.
SYSTRN28
          PACK      KEY5,SYSCSYS,SP70
          CALL      RSSYKV1
SYSTRN30
          CALL      RKSYKV1
          BRANCH    OVRCD,SYSTRN99
          MATCH     SYSCSYS,SYKVSYS
          GOTO      SYSTRN99 IF NOT EQUAL
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID
          CALL      RATBKV1
          IF        OVRCD=0
            CALL      UPTBKV1
          ELSE
            CALL      WRTBKV1
          ENDIF
          GOTO      SYSTRN30
.
SYSTRN99  RETURN
.
.----------------------------------------------
. Open Transfer To Files
.----------------------------------------------
TRANOPEN
.
          MATCH     "00",SCRID
          IF        !@EQUAL
            MOVE      DIRPATH,KEY50
            STRIP     KEY50
            ENDSET    KEY50
            APPEND    "scrfmaaf",KEY50
            RESET     KEY50
            OPEN      TRAFMAA1,KEY50
.
            MOVE      DIRPATH,KEY50
            STRIP     KEY50
            ENDSET    KEY50
            APPEND    "scrfdtaf",KEY50
            RESET     KEY50
            OPEN      TRAFDTA1,KEY50
.
            MOVE      DIRPATH,KEY50
            STRIP     KEY50
            ENDSET    KEY50
            APPEND    "scrincaf",KEY50
            RESET     KEY50
            OPEN      TRAINCA1,KEY50
.
            MOVE      DIRPATH,KEY50
            STRIP     KEY50
            ENDSET    KEY50
            APPEND    "scropnaf",KEY50
            RESET     KEY50
            OPEN      TRAOPNA1,KEY50
.
            MOVE      DIRPATH,KEY50
            STRIP     KEY50
            ENDSET    KEY50
            APPEND    "scrtagaf",KEY50
            RESET     KEY50
            OPEN      TRATAGA1,KEY50
.
            MOVE      DIRPATH,KEY50
            STRIP     KEY50
            ENDSET    KEY50
            APPEND    "scrwpdaf",KEY50
            RESET     KEY50
            OPEN      TRAWPDA1,KEY50
          ENDIF
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "scrfldaf",KEY50
          RESET     KEY50
          OPEN      TRAFLDA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "scrmasaf",KEY50
          RESET     KEY50
          OPEN      TRAMASA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "scrprgaf",KEY50
          RESET     KEY50
          OPEN      TRAPRGA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "scrpstaf",KEY50
          RESET     KEY50
          OPEN      TRAPSTA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "scrsbgaf",KEY50
          RESET     KEY50
          OPEN      TRASBGA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "scrsltaf",KEY50
          RESET     KEY50
          OPEN      TRASLTA1,KEY50
.
          MATCH     "03",SCRID
          GOTO      TRANOP99 IF NOT EQUAL
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "syscomaf",KEY50
          RESET     KEY50
          OPEN      TRBCOMA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "sysfilaf",KEY50
          RESET     KEY50
          OPEN      TRBFILA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "sysfldaf",KEY50
          RESET     KEY50
          OPEN      TRBFLDA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "syshvraf",KEY50
          RESET     KEY50
          OPEN      TRBHVRA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "sysidxaf",KEY50
          RESET     KEY50
          OPEN      TRBIDXA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "syskvraf",KEY50
          RESET     KEY50
          OPEN      TRBKVRA1,KEY50
.
          MOVE      DIRPATH,KEY50
          STRIP     KEY50
          ENDSET    KEY50
          APPEND    "sysscfaf",KEY50
          RESET     KEY50
          OPEN      TRBSCFA1,KEY50
.
TRANOP99  RETURN
.
TRANCLOS  CLOSE     TRAFMAA1
          CLOSE     TRAFDTA1
          CLOSE     TRAFLDA1
          CLOSE     TRAINCA1
          CLOSE     TRAITMA1
          CLOSE     TRAMASA1
          CLOSE     TRAOPNA1
          CLOSE     TRAPRGA1
          CLOSE     TRAPSTA1
          CLOSE     TRASBGA1
          CLOSE     TRASLTA1
          CLOSE     TRATAGA1
          CLOSE     TRAWPDA1
          MATCH     "03",SCRID
          GOTO      TRANCL99 IF NOT EQUAL
          CLOSE     TRBCOMA1
          CLOSE     TRBFILA1
          CLOSE     TRBFLDA1
          CLOSE     TRBHVRA1
          CLOSE     TRBIDXA1
          CLOSE     TRBKVRA1
          CLOSE     TRBSCFA1
TRANCL99  RETURN
.---------------------------------------
. Check for Function Transfer KEY8
.---------------------------------------
CHKFUN00  MATCH     SP70,KEY8
          IF        !@EQUAL
            PACK      KEY16,KEY8,SCPRPID
            CALL      RDSCFM1
            IF        OVRCD=0
              CALL      FUNTRN00
            ELSE
              PACK      KEY16,KEY8,SP70
              CALL      RDSCFM1
              IF        OVRCD=0
                CALL      FUNTRN00
              ENDIF
            ENDIF
          ENDIF
          RETURN
CLRPID00  MOVE    SP70,SCFMPID
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SCRFDTIO/INC
          INC       SCRFLDIO/INC
          INC       SCRFMAIO/INC
          INC       SCRFMAKY    
          INC       SCRINCIO/INC
          INC       SCRMASIO/INC
          INC       SCROPNIO/INC
          INC       SCRPRGIO/INC
          INC       SCRPRGKY    
          INC       SCRTAGIO/INC
          INC       SCRTRNCD    
          INC       SCRVCMIO/INC
          INC       SCRVERIO/INC
          INC       SCRWPDIO/INC
          INC       SYSCOMIO/INC
          INC       SYSFILIO/INC
          INC       SYSFLDIO/INC
          INC       SYSHVRIO/INC
          INC       SYSIDXIO/INC
          INC       SYSKVRIO/INC
          INC       SYSSCFIO/INC
          INC       SYSSCFKY    
.
          INC       STDGENCD
.
