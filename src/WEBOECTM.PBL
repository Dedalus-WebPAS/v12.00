. Modifications
.   V11.00.01 24/08/2020 Peter Vela    CAR 0895969
.             Created Include
.
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
WBOC0000  BRANCH    FLDITMNO,WBOC0100,WBOC0200,WBOC0300,WBOC0400,WBOC0500:
                             WBOC0600,WBOC0700,WBOC0800,WBOC0900,WBOC1000:
                             WBOC1100,WBOC1200,WBOC1300,WBOC1400,WBOC1500

          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      WBOC9999
.
WBOC0100  WRITE     HTMLFILE;WBOCVISN;
          GOTO      WBOC9999
.
WBOC0200  WRITE     HTMLFILE;WBOCCNTR;
          GOTO      WBOC9999
.
WBOC0300  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          MATCH     SP70,WBOCSTAT
          GOTO      WBOC9999 IF EQUAL
          BRANCH    F1,WBOC0310
          WRITE     HTMLFILE;WBOCSTAT;
          GOTO      WBOC9999
WBOC0310  PACK      DSWOECST,SP70
          MOVE      WBOCSTAT,F2
          LOAD      DSWOECST,F2,DSPWBOC1,DSPWBOC2,DSPWBOC3,DSPWBOC4,DSPWBOC5:
                                DSPWBOC6,DSPWBOC7
          MATCH     " 0",WBOCSTAT
          IF        @EQUAL
            MOVE      DSPWBOC0,DSWOECST
          ENDIF
          WRITE     HTMLFILE;DSWOECST
          GOTO      WBOC9999
.
WBOC0400  WRITE     HTMLFILE;WBOCURNO;
          GOTO      WBOC9999
.
WBOC0500  WRITE     HTMLFILE;WBOCARID;
          GOTO      WBOC9999
.
WBOC0600  WRITE     HTMLFILE;WBOCTRID;
          GOTO      WBOC9999
.
WBOC0700  UNPACK    WBOCRQDT,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOCRQDT
          GOTO      WBOC9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOC9999
.
WBOC0800  WRITE     HTMLFILE;WBOCETYP;
          GOTO      WBOC9999
.
WBOC0900  WRITE     HTMLFILE;WBOCERRC;
          GOTO      WBOC9999
.
WBOC1000  WRITE     HTMLFILE;WBOCERRD;
          GOTO      WBOC9999
.
WBOC1100  UNPACK    WBOCCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOCCDTE
          GOTO      WBOC9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOC9999
.
WBOC1200  WRITE     HTMLFILE;WBOCCTIM;
          GOTO      WBOC9999
.
WBOC1300  UNPACK    WBOCUDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOCUDTE
          GOTO      WBOC9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOC9999
.
WBOC1400  WRITE     HTMLFILE;WBOCUTIM;
          GOTO      WBOC9999
.
WBOC1500  WRITE     HTMLFILE;WBOCHOSP;
          GOTO      WBOC9999
.
WBOC9999  RETURN
.------------------------------------------------------------
.   Set Parameters for weboecaf file
.------------------------------------------------------------
SWBOC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SWBOC010,SWBOC020,SWBOC030,SWBOC040,SWBOC050:
                       SWBOC060,SWBOC070,SWBOC080,SWBOC090,SWBOC100:
                       SWBOC110,SWBOC120,SWBOC130,SWBOC140,SWBOC150
.                      
          MOVE      ONE,EXIT
          GOTO      SWBOC999
.
SWBOC010  MOVE      QRYDATA,WEBOC001
          GOTO      SWBOC999
.
SWBOC020  MOVE      QRYDATA,WEBOC002
          GOTO      SWBOC999
.
SWBOC030  MOVE      QRYDATA,WEBOC003
          GOTO      SWBOC999
.
SWBOC040  MOVE      QRYDATA,WEBOC004
          GOTO      SWBOC999
.
SWBOC050  MOVE      QRYDATA,WEBOC005
          GOTO      SWBOC999
.
SWBOC060  MOVE      QRYDATA,WEBOC006
          GOTO      SWBOC999
.
SWBOC070  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOC007,CCENT,CYEAR,CMON,CDAY
          GOTO      SWBOC999
.
SWBOC080  MOVE      QRYDATA,WEBOC008
          GOTO      SWBOC999
.
SWBOC090  MOVE      QRYDATA,WEBOC009
          GOTO      SWBOC999
.
SWBOC100  MOVE      QRYDATA,WEBOC010
          GOTO      SWBOC999
.
SWBOC110  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOC011,CCENT,CYEAR,CMON,CDAY 
          GOTO      SWBOC999
.
SWBOC120  MOVE      QRYDATA,WEBOC012
          GOTO      SWBOC999
.
SWBOC130  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOC013,CCENT,CYEAR,CMON,CDAY
          GOTO      SWBOC999
.
SWBOC140  MOVE      QRYDATA,WEBOC014
          GOTO      SWBOC999
.
SWBOC150  MOVE      QRYDATA,WEBOC015
          GOTO      SWBOC999
.
SWBOC999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters 
.------------------------------------------------------------
CWBOC000  MOVE      Z70,WEBOC001
          MOVE      Z70,WEBOC002
          MOVE      Z70,WEBOC003
          MOVE      Z70,WEBOC004 
          MOVE      Z70,WEBOC005
          MOVE      Z70,WEBOC006
          MOVE      Z70,WEBOC007
          MOVE      Z70,WEBOC008
          MOVE      Z70,WEBOC009
          MOVE      Z70,WEBOC010
          MOVE      Z70,WEBOC011
          MOVE      Z70,WEBOC012
          MOVE      Z70,WEBOC013
          MOVE      Z70,WEBOC014
          MOVE      Z70,WEBOC015
.
          RETURN
.
.------------------------------------------------------------
.  Update 
.------------------------------------------------------------
UPWBOC00  MATCH     WEBOC001,Z70  
          IF        !@EQUAL
            MOVE       WEBOC001,WBOCVISN
          ENDIF
.
          MATCH     WEBOC002,Z70
          IF        !@EQUAL
            MOVE      WEBOC002,WBOCCNTR
          ENDIF
.
          MATCH     WEBOC003,Z70   
          IF        !@EQUAL
            MOVE      WEBOC003,WBOCSTAT
          ENDIF
.
          MATCH     WEBOC004,Z70
          IF        !@EQUAL
            MOVE      WEBOC004,WBOCURNO
          ENDIF
.
          MATCH     WEBOC005,Z70
          IF        !@EQUAL
            MOVE      WEBOC005,WBOCARID
          ENDIF
.
          MATCH     WEBOC006,Z70   
          IF        !@EQUAL
            MOVE      WEBOC006,WBOCTRID
          ENDIF
.
          MATCH     WEBOC007,Z70
          IF        !@EQUAL
            MOVE      WEBOC007,WBOCRQDT
          ENDIF
.
          MATCH     WEBOC008,Z70
          IF        !@EQUAL
            MOVE      WEBOC008,WBOCETYP
          ENDIF
.
          MATCH     WEBOC009,Z70
          IF        !@EQUAL
            MOVE      WEBOC009,WBOCERRC
          ENDIF
.
          MATCH     WEBOC010,Z70
          IF        !@EQUAL
            MOVE      WEBOC010,WBOCERRD
          ENDIF
.
          MATCH     WEBOC011,Z70
          IF        !@EQUAL
            MOVE      WEBOC011,WBOCCDTE
          ENDIF
.
          MATCH     WEBOC012,Z70
          IF        !@EQUAL
            MOVE      WEBOC012,WBOCCTIM
          ENDIF
.
          MATCH     WEBOC013,Z70
          IF        !@EQUAL
            MOVE      WEBOC013,WBOCUDTE
          ENDIF
.
          MATCH     WEBOC014,Z70
          IF        !@EQUAL
            MOVE      WEBOC014,WBOCUTIM
          ENDIF
.
          MATCH     WEBOC015,Z70
          IF        !@EQUAL
            MOVE      WEBOC015,WBOCHOSP
          ENDIF
.
UPWBOC99  RETURN
+
