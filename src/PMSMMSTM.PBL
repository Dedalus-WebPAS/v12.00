. *-----------------------------------------------------------------------------
. * Include Name  :  PMSMMSTM.PBL
. *
. * Function      :  CGI Variables for PMSMMSFD - pmsmmsaf
. *
. * Mods          :
. * V10.06.01 17/03/2012   Patrick Adair     CAR 271541
. *                        Updated with new Assessment fields
. * V10.03.00 15/03/2012   Patrick Adair     CAR 257776
. *                        Created include
. *-----------------------------------------------------------------------------
.-------------------------------------------------------------------------------
. Clear Mini Mental State Examination Parameters
.-------------------------------------------------------------------------------
CPPMMS00  MOVE      Z70,PMMMS001
          MOVE      Z70,PMMMS002
          MOVE      Z70,PMMMS003
          MOVE      Z70,PMMMS004
          MOVE      Z70,PMMMS005
          MOVE      Z70,PMMMS006
          MOVE      Z70,PMMMS007
          MOVE      Z70,PMMMS008
          MOVE      Z70,PMMMS009
          MOVE      Z70,PMMMS010
          MOVE      Z70,PMMMS011
          MOVE      Z70,PMMMS012
          MOVE      Z70,PMMMS013
          MOVE      Z70,PMMMS014
          MOVE      Z70,PMMMS015
          MOVE      Z70,PMMMS016
          MOVE      Z70,PMMMS017
          MOVE      Z70,PMMMS018
          MOVE      Z70,PMMMS019
          MOVE      Z70,PMMMS020
          MOVE      Z70,PMMMS021
          MOVE      Z70,PMMMS022
          MOVE      Z70,PMMMS023
          MOVE      Z70,PMMMS024
          MOVE      Z70,PMMMS025
          MOVE      Z70,PMMMS026
          MOVE      Z70,PMMMS027
.
CPPMMS99  RETURN
.
.-------------------------------------------------------------------------------
. Set Mini Mental State Examination Parameters
.-------------------------------------------------------------------------------
SPPMMS00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMMS01,SPPMMS02,SPPMMS03,SPPMMS04,SPPMMS05:
                       SPPMMS06,SPPMMS07,SPPMMS08,SPPMMS09,SPPMMS10:
                       SPPMMS11,SPPMMS12,SPPMMS13,SPPMMS14,SPPMMS15:
                       SPPMMS16,SPPMMS17,SPPMMS18,SPPMMS19,SPPMMS20:
                       SPPMMS21,SPPMMS22,SPPMMS23,SPPMMS24,SPPMMS25:
                       SPPMMS26,SPPMMS27
          GOTO      SPPMMS99
.
SPPMMS01  PACK      PMMMS001,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMMMS002,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMMS99
.
SPPMMS03  PACK      PMMMS003,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS04  PACK      PMMMS004,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS05  PACK      PMMMS005,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS06  PACK      PMMMS006,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS07  PACK      PMMMS007,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS08  PACK      PMMMS008,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS09  PACK      PMMMS009,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS10  PACK      PMMMS010,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS11  PACK      PMMMS011,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS12  PACK      PMMMS012,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS13  PACK      PMMMS013,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS14  PACK      PMMMS014,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS15  PACK      PMMMS015,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS16  PACK      PMMMS016,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS17  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMMMS017,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMMS99
.
SPPMMS18  PACK      PMMMS018,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS19  PACK      PMMMS019,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS20  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMMMS020,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMMS99
.
SPPMMS21  PACK      PMMMS021,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS22  PACK      PMMMS022,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS23  PACK      PMMMS023,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS24  PACK      PMMMS024,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS25  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMMMS025,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMMS99
.
SPPMMS26  PACK      PMMMS026,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS27  PACK      PMMMS027,QRYDATA,SP70
          GOTO      SPPMMS99
.
SPPMMS99  RETURN
.
.-------------------------------------------------------------------------------
. Output Mini Mental State Examination tags
.-------------------------------------------------------------------------------
PMMS0000  BRANCH    FLDITMNO,PMMS0100,PMMS0200,PMMS0300,PMMS0400,PMMS0500:
                             PMMS0600,PMMS0700,PMMS0800,PMMS0900,PMMS1000:
                             PMMS1100,PMMS1200,PMMS1300,PMMS1400,PMMS1500:
                             PMMS1600,PMMS1700,PMMS1800,PMMS1900,PMMS2000:
                             PMMS2100,PMMS2200,PMMS2300,PMMS2400,PMMS2500:
                             PMMS2600,PMMS2700,PMMS2800,PMMS2900
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMMS9999
.
PMMS0100  WRITE     HTMLFILE;PMMMVISN;
          GOTO      PMMS9999
.
PMMS0200  MATCH     PMMMADAT,SP70
          GOTO      PMMS9999 IF EQUAL
          UNPACK    PMMMADAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMMS9999
.
PMMS0300  WRITE     HTMLFILE;PMMMATIM;
          GOTO      PMMS9999
.
PMMS0400  WRITE     HTMLFILE;PMMMORT1;
          GOTO      PMMS9999
.
PMMS0500  WRITE     HTMLFILE;PMMMORT2;
          GOTO      PMMS9999
.
PMMS0600  WRITE     HTMLFILE;PMMMREG1;
          GOTO      PMMS9999
.
PMMS0700  WRITE     HTMLFILE;PMMMREG2;
          GOTO      PMMS9999
.
PMMS0800  WRITE     HTMLFILE;PMMMATTN;
          GOTO      PMMS9999
.
PMMS0900  WRITE     HTMLFILE;PMMMRECL;
          GOTO      PMMS9999
.
PMMS1000  WRITE     HTMLFILE;PMMMLNG1;
          GOTO      PMMS9999
.
PMMS1100  WRITE     HTMLFILE;PMMMLNG2;
          GOTO      PMMS9999
.
PMMS1200  WRITE     HTMLFILE;PMMMLNG3;
          GOTO      PMMS9999
.
PMMS1300  WRITE     HTMLFILE;PMMMLNG4;
          GOTO      PMMS9999
.
PMMS1400  WRITE     HTMLFILE;PMMMLNG5;
          GOTO      PMMS9999
.
PMMS1500  WRITE     HTMLFILE;PMMMLNG6;
          GOTO      PMMS9999
.
PMMS1600  WRITE     HTMLFILE;PMMMLCNS;
          GOTO      PMMS9999
.
PMMS1700  WRITE     HTMLFILE;VISITDTE;
          GOTO      PMMS9999
.
PMMS1800  WRITE     HTMLFILE;VISITTME;
          GOTO      PMMS9999
.
PMMS1900  MATCH     PMMMCDAT,SP70
          GOTO      PMMS9999 IF EQUAL
          UNPACK    PMMMCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMMS9999
.
PMMS2000  WRITE     HTMLFILE;PMMMCTIM;
          GOTO      PMMS9999
.
PMMS2100  WRITE     HTMLFILE;PMMMCUID;
          GOTO      PMMS9999
.
PMMS2200  MATCH     PMMMUDAT,SP70
          GOTO      PMMS9999 IF EQUAL
          UNPACK    PMMMUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMMS9999
.
PMMS2300  WRITE     HTMLFILE;PMMMUTIM;
          GOTO      PMMS9999
.
PMMS2400  WRITE     HTMLFILE;PMMMUUID;
          GOTO      PMMS9999
.
PMMS2500  WRITE     HTMLFILE;PMMMDELF;
          GOTO      PMMS9999
.
PMMS2600  WRITE     HTMLFILE;PMMMDUID;
          GOTO      PMMS9999
.
PMMS2700  MATCH     PMMMDDTE,SP70
          GOTO      PMMS9999 IF EQUAL
          UNPACK    PMMMDDTE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          PACK      DISPDACT,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          WRITE     HTMLFILE;DISPDACT;
          GOTO      PMMS9999
.
PMMS2800  WRITE     HTMLFILE;PMMMDTME;
          GOTO      PMMS9999
.
PMMS2900  MOVE      "AW",CATEGORY
          MOVE      PMMMDRES,CODE
          CALL      CODITM00
          GOTO      PMMS9999
.
PMMS9999  RETURN
.
.-------------------------------------------------------------------------------
. Move Mini Mental State Examination cgi variables to file variables
.-------------------------------------------------------------------------------
MVPMMS00  MATCH     Z70,ADMISSNO
          IF        !@EQUAL
            MOVE      ADMISSNO,PMMMVISN
          ENDIF
.
          MATCH     Z70,PMMMS002
          IF        !@EQUAL
            MOVE      PMMMS002,PMMMADAT
          ENDIF
.
          MATCH     Z70,PMMMS003
          IF        !@EQUAL
            MOVE      PMMMS003,PMMMATIM
          ENDIF
.
          MATCH     Z70,PMMMS004
          IF        !@EQUAL
            MOVE      PMMMS004,PMMMORT1
          ENDIF
.
          MATCH     Z70,PMMMS005
          IF        !@EQUAL
            MOVE      PMMMS005,PMMMORT2
          ENDIF
.
          MATCH     Z70,PMMMS006
          IF        !@EQUAL
            MOVE      PMMMS006,PMMMREG1
          ENDIF
.
          MATCH     Z70,PMMMS007
          IF        !@EQUAL
            MOVE      PMMMS007,PMMMREG2
          ENDIF
.
          MATCH     Z70,PMMMS008
          IF        !@EQUAL
            MOVE      PMMMS008,PMMMATTN
          ENDIF
.
          MATCH     Z70,PMMMS009
          IF        !@EQUAL
            MOVE      PMMMS009,PMMMRECL
          ENDIF
.
          MATCH     Z70,PMMMS010
          IF        !@EQUAL
            MOVE      PMMMS010,PMMMLNG1
          ENDIF
.
          MATCH     Z70,PMMMS011
          IF        !@EQUAL
            MOVE      PMMMS011,PMMMLNG2
          ENDIF
.
          MATCH     Z70,PMMMS012
          IF        !@EQUAL
            MOVE      PMMMS012,PMMMLNG3
          ENDIF
.
          MATCH     Z70,PMMMS013
          IF        !@EQUAL
            MOVE      PMMMS013,PMMMLNG4
          ENDIF
.
          MATCH     Z70,PMMMS014
          IF        !@EQUAL
            MOVE      PMMMS014,PMMMLNG5
          ENDIF
.
          MATCH     Z70,PMMMS015
          IF        !@EQUAL
            MOVE      PMMMS015,PMMMLNG6
          ENDIF
.
          MATCH     Z70,PMMMS016
          IF        !@EQUAL
            MOVE      PMMMS016,PMMMLCNS
          ENDIF
.
          MATCH     Z70,PMMMS017
          IF        !@EQUAL
            MOVE      PMMMS017,PMMMCDAT
          ENDIF
.
          MATCH     Z70,PMMMS018
          IF        !@EQUAL
            MOVE      PMMMS018,PMMMCTIM
          ENDIF
.
          MATCH     Z70,PMMMS019
          IF        !@EQUAL
            MOVE      PMMMS019,PMMMCUID
          ENDIF
.
          MATCH     Z70,PMMMS020
          IF        !@EQUAL
            MOVE      PMMMS020,PMMMUDAT
          ENDIF
.
          MATCH     Z70,PMMMS021
          IF        !@EQUAL
            MOVE      PMMMS021,PMMMUTIM
          ENDIF
.
          MATCH     Z70,PMMMS022
          IF        !@EQUAL
            MOVE      PMMMS022,PMMMUUID
          ENDIF
.
          MATCH     Z70,PMMMS023
          IF        !@EQUAL
            MOVE      PMMMS023,PMMMDELF
          ENDIF
.
          MATCH     Z70,PMMMS024
          IF        !@EQUAL
            MOVE      PMMMS024,PMMMDUID
          ENDIF
.
          MATCH     Z70,PMMMS025
          IF        !@EQUAL
            MOVE      PMMMS025,PMMMDDTE
          ENDIF
.
          MATCH     Z70,PMMMS026
          IF        !@EQUAL
            MOVE      PMMMS026,PMMMDTME
          ENDIF
.
          MATCH     Z70,PMMMS027
          IF        !@EQUAL
            MOVE      PMMMS027,PMMMDRES
          ENDIF
.
MVPMMS99  RETURN
.
.-------------------------------------------------------------------------------
. Clear Mini Mental State Examination file variables
.-------------------------------------------------------------------------------
CLPMMS00  MOVE      SP70,PMMMVISN
          MOVE      SP70,PMMMADAT
          MOVE      SP70,PMMMATIM
          MOVE      SP70,PMMMORT1
          MOVE      SP70,PMMMORT2
          MOVE      SP70,PMMMREG1
          MOVE      SP70,PMMMREG2
          MOVE      SP70,PMMMATTN
          MOVE      SP70,PMMMRECL
          MOVE      SP70,PMMMLNG1
          MOVE      SP70,PMMMLNG2
          MOVE      SP70,PMMMLNG3
          MOVE      SP70,PMMMLNG4
          MOVE      SP70,PMMMLNG5
          MOVE      SP70,PMMMLNG6
          MOVE      SP70,PMMMLCNS
          MOVE      SP70,PMMMCDAT
          MOVE      SP70,PMMMCTIM
          MOVE      SP70,PMMMCUID
          MOVE      SP70,PMMMUDAT
          MOVE      SP70,PMMMUTIM
          MOVE      SP70,PMMMUUID
          MOVE      SP70,PMMMDELF
          MOVE      SP70,PMMMDUID
          MOVE      SP70,PMMMDDTE
          MOVE      SP70,PMMMDTME
          MOVE      SP70,PMMMDRES
.
CLPMMS99  RETURN
