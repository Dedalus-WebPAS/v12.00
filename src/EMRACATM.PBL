. *----------------------------------------------------------------------
. * Include Name  :   EMRACATM.PBL
. *
. * Function      :   CGI Variables for EMRACAFD - emracaaf
. *
. * Mods          :
. *
. *       V11.01.00 24/05/2021 DA Sarkies        TSK 0905305
. *                Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------------------
CPEMAA00  MOVE      Z70,EMACA001
          MOVE      Z70,EMACA002
          MOVE      Z70,EMACA003
          MOVE      ZERO,EMACA004
          MOVE      ZERO,EMACA005
          MOVE      ZERO,EMACA006
          MOVE      ZERO,EMACA007
          MOVE      ZERO,EMACA008
          MOVE      ZERO,EMACA009
          MOVE      ZERO,EMACA010
          MOVE      ZERO,EMACA011
          MOVE      Z70,EMACA012 
.
CPEMAA99  RETURN
.
.------------------------------------------------------------
. Set variables for AECC Coefficents for Age Group
.------------------------------------------------------------
SPEMRA00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMRA01,SPEMRA02,SPEMRA03,SPEMRA04,SPEMRA05,SPEMRA06:
                    SPEMRA07,SPEMRA08,SPEMRA09,SPEMRA10,SPEMRA11,SPEMRA12
          GOTO      SPEMRA99
.
SPEMRA01  PACK      EMACA001,QRYDATA,SP70
          GOTO      SPEMRA99
.
SPEMRA02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00 
          PACK      EMACA002,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMRA99
.
SPEMRA03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00 
          PACK      EMACA003,CCENT,CYEAR,CMON,CDAY,SP70
          GOTO      SPEMRA99
.
SPEMRA04  MOVE      QRYDATA,EMACA004
          GOTO      SPEMRA99
.
SPEMRA05  MOVE      QRYDATA,EMACA005
          GOTO      SPEMRA99
.
SPEMRA06  MOVE      QRYDATA,EMACA006
          GOTO      SPEMRA99
.
SPEMRA07  MOVE      QRYDATA,EMACA007
          GOTO      SPEMRA99
.
SPEMRA08  MOVE      QRYDATA,EMACA008
          GOTO      SPEMRA99
.
SPEMRA09  MOVE      QRYDATA,EMACA009
          GOTO      SPEMRA99
.
SPEMRA10  MOVE      QRYDATA,EMACA010
          GOTO      SPEMRA99
.
SPEMRA11  MOVE      QRYDATA,EMACA011
          GOTO      SPEMRA99
.
SPEMRA12  PACK      EMACA012,QRYDATA,SP70
          GOTO      SPEMRA99
.
SPEMRA99  RETURN
.
.------------------------------------------------------------
. Tags for AECC Coefficients for Age Group
.------------------------------------------------------------
EMAA0000  BRANCH    FLDITMNO,EMAA0100,EMAA0200,EMAA0300,EMAA0400:
                    EMAA0500,EMAA0600,EMAA0700,EMAA0800,EMAA0900,EMAA1000:
                    EMAA1100,EMAA1200,EMAA1300,EMAA1400,EMAA1500,EMAA1600:
                    EMAA1700,EMAA1800
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMAA9999
.
EMAA0100  WRITE     HTMLFILE;EMAACODE;
          GOTO      EMAA9999
.
EMAA0200  MATCH     EMAAFDAT,SP70             * effective date from
          GOTO      EMAA9999 IF EQUAL
          UNPACK    EMAAFDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAA9999
.
EMAA0300  MATCH     EMAATDAT,SP70             * effective date to
          GOTO      EMAA9999 IF EQUAL
          UNPACK    EMAATDAT,CYEAR,CCENT,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CYEAR,CCENT;
          GOTO      EMAA9999
.
EMAA0400  WRITE     HTMLFILE;EMAAAG04;
          GOTO      EMAA9999
.
EMAA0500  WRITE     HTMLFILE;EMAAAG59;
          GOTO      EMAA9999
.
EMAA0600  WRITE     HTMLFILE;EMAAAG14;
          GOTO      EMAA9999
.
EMAA0700  WRITE     HTMLFILE;EMAAAG69;
          GOTO      EMAA9999
.
EMAA0800  WRITE     HTMLFILE;EMAAAG74;
          GOTO      EMAA9999
.
EMAA0900  WRITE     HTMLFILE;EMAAAG79;
          GOTO      EMAA9999
.
EMAA1000  WRITE     HTMLFILE;EMAAAG84;
          GOTO      EMAA9999
.
EMAA1100  WRITE     HTMLFILE;EMAAAG85;
          GOTO      EMAA9999
.
EMAA1200  MATCH     EMAACDAT,SP70             * Date record created
          GOTO      EMAA9999 IF EQUAL
          UNPACK    EMAACDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAA9999
.
EMAA1300  WRITE     HTMLFILE;EMAACTIM;
          GOTO      EMAA9999
.
EMAA1400  WRITE     HTMLFILE;EMAACUID;
          GOTO      EMAA9999
.
EMAA1500  MATCH     EMAAUDAT,SP70             * Update date record
          GOTO      EMAA9999 IF EQUAL
          UNPACK    EMAAUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAA9999
.
EMAA1600  WRITE     HTMLFILE;EMAAUTIM;
          GOTO      EMAA9999
.
EMAA1700  WRITE     HTMLFILE;EMAAUUID;
          GOTO      EMAA9999
.
EMAA1800  WRITE     HTMLFILE;EMAAAFLG;
          GOTO      EMAA9999
.
EMAA9999  RETURN
.
.------------------------------------------------------------
. Moved cgi variables to file variables
.------------------------------------------------------------
MVEMAA00  MATCH     Z70,EMACA001
          IF        !@EQUAL
            MOVE      EMACA001,EMAACODE
          ENDIF       
.
          MATCH     Z70,EMACA002
          IF        !@EQUAL
            MOVE      EMACA002,EMAAFDAT
          ENDIF       
.
          MATCH     Z70,EMACA003
          IF        !@EQUAL
            MOVE      EMACA003,EMAATDAT
          ENDIF       
.
          COMPARE   ZERO,EMACA004
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG04
            MOVE      EMACA004,EMAAAG04
          ENDIF       
.
          COMPARE   ZERO,EMACA005
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG59
            MOVE      EMACA005,EMAAAG59
          ENDIF       
.
          COMPARE   ZERO,EMACA006
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG14
            MOVE      EMACA006,EMAAAG14
          ENDIF       
.
          COMPARE   ZERO,EMACA007
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG69
            MOVE      EMACA007,EMAAAG69
          ENDIF       
.
          COMPARE   ZERO,EMACA008
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG74
            MOVE      EMACA008,EMAAAG74
          ENDIF       
.
          COMPARE   ZERO,EMACA009
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG79
            MOVE      EMACA009,EMAAAG79
          ENDIF       
.
          COMPARE   ZERO,EMACA010
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG84
            MOVE      EMACA010,EMAAAG84
          ENDIF       
.
          COMPARE   ZERO,EMACA011
          IF        !@EQUAL
            MOVE      ZERO,EMAAAG85
            MOVE      EMACA011,EMAAAG85
          ENDIF       
.
          MATCH     Z70,EMACA012
          IF        !@EQUAL
            MOVE      EMACA012,EMAAAFLG
          ENDIF       
.
MVEMAA99  RETURN
