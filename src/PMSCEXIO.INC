.
. PMSCEXIO    
. --------
. Filename     : pmscexaf.dat
.
RSPMCEX1  RESET     KEY14                                                       
          READ      PMSCEXA1,KEY14;;                                            
          RETURN
.
RAPMCEX1  RESET     KEY14                                                       
          MOVE      ZERO,OVRCD
          READ      PMSCEXA1,KEY14;ANS                                          
          GOTO      OVERCOND IF OVER
          RETURN
.
RDPMCEX1  RESET     KEY14                                                       
          MOVE      ZERO,OVRCD
          READ      PMSCEXA1,KEY14;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                                   PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                                   PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                                   PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                                   PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                                   PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                                   PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:
                                   PMCELAN2,PMCESPAR                            
          GOTO      OVERCOND IF OVER
          RETURN
.
RKPMCEX1  MOVE      ZERO,OVRCD                                                  
          READKS    PMSCEXA1;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          GOTO      OVERCOND IF OVER
          RETURN
.
RPPMCEX1  MOVE      ZERO,OVRCD                                                  
          READKP    PMSCEXA1;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          GOTO      OVERCOND IF OVER
          RETURN
.
UPPMCEX1  MOVE      ZERO,OVRCD                                                  
          UPDATE    PMSCEXA1;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          GOTO      UPDFLOCK IF LOCKED
          RETURN
.
WRPMCEX1  RESET     KEY14                                                       
          WRITE     PMSCEXA1,KEY14;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                                   PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                                   PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                                   PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                                   PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                                   PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                                   PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:
                                   PMCELAN2,PMCESPAR                            
          RETURN
.
DEPMCEX1  RESET     KEY14                                                       
          DELETE    PMSCEXA1,KEY14                                              
          RETURN
.
RLPMCEX1  RESET     KEY14                                                       
          MOVE      ZERO,OVRCD
          READL     PMSCEXA1,KEY14;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                                   PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                                   PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                                   PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                                   PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                                   PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                                   PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:
                                   PMCELAN2,PMCESPAR                            
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
KLPMCEX1  MOVE      ZERO,OVRCD                                                  
          READLKS   PMSCEXA1;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
PLPMCEX1  MOVE      ZERO,OVRCD                                                  
          READLKP   PMSCEXA1;PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
UUPMCEX1  RESET     KEY14                                                       
          UNLOCK    PMSCEXA1                                                    
          RETURN
.
.**************************************
. WAssff - Write Audit Record           
. Requires - AUDTTYPE 1=write 
.                     2=before change
.                     3=after change
.                     4=delete
.**************************************
WAPMCE00
          MOVE      "  118",AUDTSECT
          MOVE      "167",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          COMPARE   ONE,AUDTFLAG
          GOTO      WAPMCE99 IF NOT EQUAL
.
          PACK      PMCEAUDD,CCC,CYY,CMM,CDD
          REP       " 0",PMCEAUDD
          CLOCK     TIME,PMCEAUDT
          MOVE      PORT,PMCEAUDP
          LOAD      PMCEAUDR,AUDTTYPE,ANSA,ANSB,ANSC,ANSD
          MOVE      ONE,PMCEAUDS
          MOVE      PASSCODE,PMCEAUDO
          PACK      KEY19,PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR
          MOVE      KEY19,AUDTSKEY
          CALL      AWPMCEX
WAPMCE99  RETURN
.**************************************
. DAssff - Delete Before Change Audit 
.**************************************
DAPMCE00
          MOVE      "  118",AUDTSECT
          MOVE      "167",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          COMPARE   ONE,AUDTFLAG
          GOTO      DAPMCE99 IF NOT EQUAL
.
          MOVE      AUDTSKEY,KEY19
          CALL      ADPMCEX
DAPMCE99  RETURN
ASPMCEX   RESET     KEY19                                                       
          READ      PMSAUDCE,KEY19;;                                            
          RETURN
.
AKPMCEX                                                                         
          MOVE      ZERO,OVRCD
          READKS    PMSAUDCE;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:      
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          GOTO      OVERCOND IF OVER
          RETURN
.
AUPMCEX                                                                         
          UPDATE    PMSAUDCE;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:      
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          RETURN
.
AWPMCEX   RESET     KEY19                                                       
          WRITE     PMSAUDCE,KEY19;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:      
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:      
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:      
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:      
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:      
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:      
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCELAN1:      
                             PMCELAN2,PMCESPAR                                  
          RETURN
.
ADPMCEX   RESET     KEY19                                                       
          DELETE    PMSAUDCE,KEY19;                                             
          RETURN
.
. Manual create for PMSAUDC2 index
.
ASPMCEX2  RESET     KEY33
          READ      PMSAUDC2,KEY33;;
          RETURN
.
AKPMCEX2  MOVE      ZERO,OVRCD
          READKS    PMSAUDC2;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCESPAR
          GOTO      OVERCOND IF OVER
          RETURN
.
APPMCEX2  MOVE      ZERO,OVRCD
          READKP    PMSAUDC2;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCESPAR
          GOTO      OVERCOND IF OVER
          RETURN
.
ADPMCEX2  RESET     KEY33
          MOVE      ZERO,OVRCD
          READ      PMSAUDC2,KEY33;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCESPAR
          GOTO      OVERCOND IF OVER
          RETURN
.
AUPMCEX2  UPDATE    PMSAUDC2;PMCEAUDD,PMCEAUDT,PMCEAUDP,PMCEAUDR,PMCEAUDS:
                    PMCEAUDO,PMCEURNO,PMCETYPE,PMCECNTR,PMCETITL,PMCESNAM:
                             PMCEGNAM,PMCEGNM2,PMCEADD1,PMCEADD2,PMCEADD3:
                             PMCEADD4,PMCEPOST,PMCETELP,PMCETELB,PMCETELM:
                             PMCERELP,PMCEEMAI,PMCECDAT,PMCECTIM,PMCECUID:
                             PMCEUDAT,PMCEUTIM,PMCEUUID,PMCESLET,PMCEACTV:
                             PMCECONT,PMCEDINA,PMCETPID,PMCEWPID,PMCESSMS:
                             PMCECMED,PMCECREF,PMCECDOB,PMCEFTXT,PMCESPAR
          RETURN

