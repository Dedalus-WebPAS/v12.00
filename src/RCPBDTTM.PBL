. *----------------------------------------------------------------------
. * Include Name  :   RCPBDTTM.PBL
. *
. * Function      :   CGI variable functions for RCPBDTFD - rcpbdtaf.dat
. *
. * Modifications :
. *
. *V11.00.01 29/10/2020  J.Tan                   TSK 0896343
. *          Mod set Card type to blank for EFTPOS Type = Cash
. *V10.07.01 16/11/2015  J.Tan                   CAR 303942
. *          Added Payment code
. * V9.12.01 20/07/2009  Mike Laming             CAR 187485
. *          Change size of RCBDPAYD, RCBDDRAW, RCBDSTRF - Remove RCBDMONM
. * V9.03.01 15/12/2003 Lina Vo                  CAR 44073
. *          Removed Name & Address Fields.
. * V9.03.00 26/11/2003 Ebon Clements            CAR 44095
. *          Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear parameters for the bank details file
.------------------------------------------------------------------------
CPRCBT00  MOVE      Z70,RCPBT001
          MOVE      Z70,RCPBT002
          MOVE      Z70,RCPBT003
          MOVE      Z70,RCPBT004
          MOVE      Z70,RCPBT005
          MOVE      Z70,RCPBT006
          MOVE      Z70,RCPBT007
          MOVE      Z70,RCPBT008
          MOVE      Z70,RCPBT009
          MOVE      Z70,RCPBT010
          MOVE      Z70,RCPBT011
          MOVE      Z70,RCPBT012
          MOVE      Z70,RCPBT013
          MOVE      Z70,RCPBT014
          MOVE      Z70,RCPBT015
          MOVE      Z70,RCPBT016
          MOVE      Z70,RCPBT017
          MOVE      Z70,RCPBT018
          MOVE      Z70,RCPBT019
          MOVE      Z70,RCPBT020
          MOVE      Z70,RCPBT021
          MOVE      Z70,RCPBT022
          MOVE      Z70,RCPBT023
.
CPRCBT99  RETURN
.------------------------------------------------------------
. Bank details file standard tags
.------------------------------------------------------------
RCBT0000  BRANCH    FLDITMNO,RCBT0010,RCBT0020,RCBT0030,RCBT0040,RCBT0050:
                             RCBT0060,RCBT0070,RCBT0080,RCBT0090,RCBT0100:
                             RCBT0110,RCBT0120,RCBT0130,RCBT0140,RCBT0150:
                             RCBT0160,RCBT0170,RCBT0180,RCBT0190,RCBT0200:
                             RCBT0210,RCBT0220,RCBT0230
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      RCBT9999
.
RCBT0010  MATCH     RCBDTDAT,SP70
          GOTO      RCBT9999 IF EQUAL
.
          UNPACK    RCBDTDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RCBT9999
.
RCBT0020  WRITE     HTMLFILE;RCBDRECN;
          GOTO      RCBT9999
.
RCBT0030  WRITE     HTMLFILE;RCBDUNIQ;
          GOTO      RCBT9999
.
RCBT0040  WRITE     HTMLFILE;RCBDMHOS;
          GOTO      RCBT9999
.
RCBT0050  WRITE     HTMLFILE;RCBDMDHS;
          GOTO      RCBT9999
.
RCBT0060  WRITE     HTMLFILE;RCBDPTYP;
          GOTO      RCBT9999
.
RCBT0070  WRITE     HTMLFILE;RCBDPAMT;
          GOTO      RCBT9999
.
RCBT0080  WRITE     HTMLFILE;RCBDPAYD;
          GOTO      RCBT9999
.
RCBT0090  WRITE     HTMLFILE;RCBDCHQN;
          GOTO      RCBT9999
.
RCBT0100  WRITE     HTMLFILE;RCBDDRAW;
          GOTO      RCBT9999
.
RCBT0110  WRITE     HTMLFILE;RCBDBANK;
          GOTO      RCBT9999
.
RCBT0120  WRITE     HTMLFILE;RCBDBRCH;
          GOTO      RCBT9999
.
RCBT0130  WRITE     HTMLFILE;RCBDCRDT;
          GOTO      RCBT9999
.
RCBT0140  WRITE     HTMLFILE;RCBDSTRF;
          GOTO      RCBT9999
.
RCBT0150  WRITE     HTMLFILE;"Invalid IBA Tag";
....      WRITE     HTMLFILE;RCBDMONM;
          GOTO      RCBT9999
.
RCBT0160  WRITE     HTMLFILE;RCBDEFTT;
          GOTO      RCBT9999
.
RCBT0170  MATCH     RCBDCDAT,SP70
          GOTO      RCBT9999 IF EQUAL
.
          UNPACK    RCBDCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RCBT9999
.
RCBT0180  WRITE     HTMLFILE;RCBDCTIM;
          GOTO      RCBT9999
.
RCBT0190  MATCH     SP70,RCBDCUID
          GOTO      RCBT9999 IF EQUAL
.
          PACK      KEY10,RCBDCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      RCBDCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      RCBT9999
.
RCBT0200  MATCH     RCBDUDAT,SP70
          GOTO      RCBT9999 IF EQUAL
.
          UNPACK    RCBDUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      RCBT9999
.
RCBT0210  WRITE     HTMLFILE;RCBDUTIM;
          GOTO      RCBT9999
.
RCBT0220  MATCH     SP70,RCBDUUID
          GOTO      RCBT9999 IF EQUAL
.         
          PACK      KEY10,RCBDUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      RCBDUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      RCBT9999
.
RCBT0230  MOVE      "Py",CATEGORY
          MOVE      RCBDPCOD,CODE
          CALL      CODITM00
          GOTO      RCBT9999
.
RCBT9999  RETURN
.------------------------------------------------------------
.   Set Parameters for the bank header file
.------------------------------------------------------------
SPRCT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPRCT010,SPRCT020,SPRCT030,SPRCT040,SPRCT050:
                       SPRCT060,SPRCT070,SPRCT080,SPRCT090,SPRCT100:
                       SPRCT110,SPRCT120,SPRCT130,SPRCT140,SPRCT150:
                       SPRCT160,SPRCT170,SPRCT180,SPRCT190,SPRCT200:
                       SPRCT210,SPRCT220,SPRCT230
.
          MOVE      ONE,EXIT
          GOTO      SPRCT999
.
SPRCT010  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      RCPBT001,CCENT,CYEAR,CMON,CDAY
          GOTO      SPRCT999
.
SPRCT020  MOVE      QRYDATA,RCPBT002
          GOTO      SPRCT999
.
SPRCT030  MOVE      QRYDATA,RCPBT003
          GOTO      SPRCT999
.
SPRCT040  MOVE      QRYDATA,RCPBT004
          GOTO      SPRCT999
.
SPRCT050  MOVE      QRYDATA,RCPBT005
          GOTO      SPRCT999
.
SPRCT060  MOVE      QRYDATA,RCPBT006
          GOTO      SPRCT999
.
SPRCT070  MOVE      QRYDATA,RCPBT007
          GOTO      SPRCT999
.
SPRCT080  MOVE      QRYDATA,RCPBT008
          GOTO      SPRCT999
.
SPRCT090  MOVE      QRYDATA,RCPBT009
          GOTO      SPRCT999
.
SPRCT100  MOVE      QRYDATA,RCPBT010
          GOTO      SPRCT999
.
SPRCT110  MOVE      QRYDATA,RCPBT011
          GOTO      SPRCT999
.
SPRCT120  MOVE      QRYDATA,RCPBT012
          GOTO      SPRCT999
.
SPRCT130  MOVE      QRYDATA,RCPBT013
          GOTO      SPRCT999
.
SPRCT140  MOVE      QRYDATA,RCPBT014
          GOTO      SPRCT999
.
SPRCT150  MOVE      QRYDATA,RCPBT015 
          GOTO      SPRCT999
.
SPRCT160  MOVE      QRYDATA,RCPBT016
          GOTO      SPRCT999
.
SPRCT170  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      RCPBT017,CCENT,CYEAR,CMON,CDAY
          GOTO      SPRCT999
.
SPRCT180  MOVE      QRYDATA,RCPBT018
          GOTO      SPRCT999
.
SPRCT190  MOVE      QRYDATA,RCPBT019
          GOTO      SPRCT999
.
SPRCT200  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      RCPBT020,CCENT,CYEAR,CMON,CDAY
          GOTO      SPRCT999
.
SPRCT210  MOVE      QRYDATA,RCPBT021
          GOTO      SPRCT999
.
SPRCT220  MOVE      QRYDATA,RCPBT022
          GOTO      SPRCT999
.
SPRCT230  MOVE      QRYDATA,RCPBT023
          GOTO      SPRCT999
.
SPRCT999  RETURN
.
.------------------------------------------------------------
.  Update bank details file
.------------------------------------------------------------
MVRCBT00  MATCH     RCPBT001,Z70
          IF        !@EQUAL
            MOVE      RCPBT001,RCBDTDAT
          ENDIF
.
          MATCH     RCPBT002,Z70
          IF        !@EQUAL
            MOVE      RCPBT002,RCBDRECN
          ENDIF
.
          MATCH     RCPBT003,Z70
          IF        !@EQUAL
            MOVE      RCPBT003,RCBDUNIQ
          ENDIF
.
          MATCH     RCPBT004,Z70
          IF        !@EQUAL
            MOVE      RCPBT004,RCBDMHOS
          ENDIF
.
          MATCH     RCPBT005,Z70
          IF        !@EQUAL
            MOVE      RCPBT005,RCBDMDHS
          ENDIF
.
          MATCH     RCPBT006,Z70
          IF        !@EQUAL
            MOVE      RCPBT006,RCBDPTYP
          ENDIF
.
          MATCH     RCPBT007,Z70
          IF        !@EQUAL
            MOVE      RCPBT007,RCBDPAMT
          ENDIF
.
          MATCH     RCPBT008,Z70
          IF        !@EQUAL
            MOVE      RCPBT008,RCBDPAYD
          ENDIF
.
          MATCH     RCPBT009,Z70
          IF        !@EQUAL
            MOVE      RCPBT009,RCBDCHQN
          ENDIF
.
          MATCH     RCPBT010,Z70
          IF        !@EQUAL
            MOVE      RCPBT010,RCBDDRAW
          ENDIF
.
          MATCH     RCPBT011,Z70
          IF        !@EQUAL
            MOVE      RCPBT011,RCBDBANK
          ENDIF
.
          MATCH     RCPBT012,Z70
          IF        !@EQUAL
            MOVE      RCPBT012,RCBDBRCH
          ENDIF
.
          MATCH     RCPBT013,Z70
          IF        !@EQUAL
            MOVE      RCPBT013,RCBDCRDT
          ENDIF
.
          MATCH     RCPBT014,Z70
          IF        !@EQUAL
            MOVE      RCPBT014,RCBDSTRF
          ENDIF
.
....      MATCH     RCPBT015,Z70                                      *D-187485
....      IF        !@EQUAL
....        MOVE      RCPBT015,RCBDMONM
....      ENDIF
.
.         Card type = blank for EFTPOS Type = Cash
.
          MATCH     RCPBT016,Z70
          IF        !@EQUAL
            MOVE      RCPBT016,RCBDEFTT
            MATCH     "1",RCBDEFTT
            IF        @EQUAL
              MATCH     RCPBT013,Z70
              IF        @EQUAL
                MOVE      SP70,RCBDCRDT
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     RCPBT017,Z70
          IF        !@EQUAL
            MOVE      RCPBT017,RCBDCDAT
          ENDIF
.
          MATCH     RCPBT018,Z70
          IF        !@EQUAL
            MOVE      RCPBT018,RCBDCTIM
          ENDIF
.
          MATCH     RCPBT019,Z70
          IF        !@EQUAL
            MOVE      RCPBT019,RCBDCUID
          ENDIF
.
          MATCH     RCPBT020,Z70
          IF        !@EQUAL
            MOVE      RCPBT020,RCBDUDAT
          ENDIF
.
          MATCH     RCPBT021,Z70
          IF        !@EQUAL
            MOVE      RCPBT021,RCBDUTIM
          ENDIF
.
          MATCH     RCPBT022,Z70
          IF        !@EQUAL
            MOVE      RCPBT022,RCBDUUID
          ENDIF
.
          MATCH     RCPBT023,Z70
          IF        !@EQUAL
            MOVE      RCPBT023,RCBDPCOD
          ENDIF
.
MVRCBT99  RETURN
.
.------------------------------------------------------------
.  Clear bank details file
.------------------------------------------------------------
CLRPBT00  MOVE      SP70,RCBDTDAT
          MOVE      SP70,RCBDRECN
          MOVE      SP70,RCBDUNIQ
          MOVE      SP70,RCBDMHOS
          MOVE      SP70,RCBDMDHS
          MOVE      SP70,RCBDPTYP
          MOVE      ZERO,RCBDPAMT
          MOVE      SP70,RCBDPAYD
          MOVE      SP70,RCBDCHQN
          MOVE      SP70,RCBDDRAW
          MOVE      SP70,RCBDBANK
          MOVE      SP70,RCBDBRCH
          MOVE      SP70,RCBDCRDT
          MOVE      SP70,RCBDSTRF
....      MOVE      SP70,RCBDMONM                                     *D-187485
          MOVE      SP70,RCBDEFTT
          MOVE      SP70,RCBDCDAT
          MOVE      SP70,RCBDCTIM
          MOVE      SP70,RCBDCUID
          MOVE      SP70,RCBDUDAT
          MOVE      SP70,RCBDUTIM
          MOVE      SP70,RCBDUUID
          MOVE      SP70,RCBDPCOD
          MOVE      SP70,RCBDSPAR
.
CLRCBT99  RETURN
.------------------------------------------------------------
.  Move Temporary bank detail fields to bank details fields
.------------------------------------------------------------
MVTMBT00  MOVE      TMBDTDAT,RCBDTDAT
          MOVE      TMBDRECN,RCBDRECN
          MOVE      TMBDUNIQ,RCBDUNIQ
          MOVE      TMBDMHOS,RCBDMHOS
          MOVE      TMBDMDHS,RCBDMDHS
          MOVE      TMBDPTYP,RCBDPTYP
          MOVE      TMBDPAMT,RCBDPAMT
          MOVE      TMBDPAYD,RCBDPAYD
          MOVE      TMBDCHQN,RCBDCHQN
          MOVE      TMBDDRAW,RCBDDRAW
          MOVE      TMBDBANK,RCBDBANK
          MOVE      TMBDBRCH,RCBDBRCH
          MOVE      TMBDCRDT,RCBDCRDT
          MOVE      TMBDSTRF,RCBDSTRF
....      MOVE      TMBDMONM,RCBDMONM                                 *D-187485
          MOVE      TMBDEFTT,RCBDEFTT
          MOVE      TMBDCDAT,RCBDCDAT
          MOVE      TMBDCTIM,RCBDCTIM
          MOVE      TMBDCUID,RCBDCUID
          MOVE      TMBDUDAT,RCBDUDAT
          MOVE      TMBDUTIM,RCBDUTIM
          MOVE      TMBDUUID,RCBDUUID
          MOVE      TMBDPCOD,RCBDPCOD
          MOVE      SP70,RCBDSPAR
.
MVTMBT99  RETURN
.------------------------------------------------------------
.  Move bank detail fields to Temporary bank details fields
.------------------------------------------------------------
MVRLBT00  MOVE      RCBDTDAT,TMBDTDAT
          MOVE      RCBDRECN,TMBDRECN
          MOVE      RCBDUNIQ,TMBDUNIQ
          MOVE      RCBDMHOS,TMBDMHOS
          MOVE      RCBDMDHS,TMBDMDHS
          MOVE      RCBDPTYP,TMBDPTYP
          MOVE      RCBDPAMT,TMBDPAMT
          MOVE      RCBDPAYD,TMBDPAYD
          MOVE      RCBDCHQN,TMBDCHQN
          MOVE      RCBDDRAW,TMBDDRAW
          MOVE      RCBDBANK,TMBDBANK
          MOVE      RCBDBRCH,TMBDBRCH
          MOVE      RCBDCRDT,TMBDCRDT
          MOVE      RCBDSTRF,TMBDSTRF
....      MOVE      RCBDMONM,TMBDMONM                                 *D-187485
          MOVE      RCBDEFTT,TMBDEFTT
          MOVE      RCBDCDAT,TMBDCDAT
          MOVE      RCBDCTIM,TMBDCTIM
          MOVE      RCBDCUID,TMBDCUID
          MOVE      RCBDUDAT,TMBDUDAT
          MOVE      RCBDUTIM,TMBDUTIM
          MOVE      RCBDUUID,TMBDUUID
          MOVE      RCBDPCOD,TMBDPCOD
          MOVE      SP70,RCBDSPAR
.
MVRLBT99  RETURN
