. *----------------------------------------------------------------------
. * Include Name  :   PMSTEMTM.PBL
. *
. * Function      :   CGI variables for PMSTEMFD - pmstemaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.02.00  02/06/2011  Davin         CAR 240723
.             Created include
.------------------------------------------------------------------------
.   Clear parameters for teams file
.------------------------------------------------------------------------
CPPMTE00  MOVE      Z70,PMTEM001
          MOVE      Z70,PMTEM002
          MOVE      Z70,PMTEM003
CPPMTE99  RETURN
.------------------------------------------------------------
. Tags for teams table
.------------------------------------------------------------
PMTE0000  BRANCH    FLDITMNO,PMTE0010,PMTE0020,PMTE0030,PMTE0040,PMTE0050:
                             PMTE0060,PMTE0070,PMTE0080,PMTE0090
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMTE9999
.
PMTE0010  WRITE     HTMLFILE;PMTMTEAM;
          GOTO      PMTE9999
.
PMTE0020  WRITE     HTMLFILE;PMTMDESC;
          GOTO      PMTE9999
.
PMTE0030  WRITE     HTMLFILE;PMTMACTV;
          GOTO      PMTE9999
.
PMTE0040  MATCH     SP70,PMTMCUID
          GOTO      PMTE9999 IF EQUAL
.
          PACK      KEY10,PMTMCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMTMCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMTE9999
.
PMTE0050  MATCH     PMTMCDAT,SP70
          GOTO      PMTE9999 IF EQUAL
.
          UNPACK    PMTMCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMTE9999
.
PMTE0060  WRITE     HTMLFILE;PMTMCTIM;
          GOTO      PMTE9999
.
PMTE0070  MATCH     SP70,PMTMUUID
          GOTO      PMTE9999 IF EQUAL
.
          PACK      KEY10,PMTMUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMTMUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMTE9999
.
PMTE0080  MATCH     PMTMUDAT,SP70
          GOTO      PMTE9999 IF EQUAL
.
          UNPACK    PMTMUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMTE9999
.
PMTE0090  WRITE     HTMLFILE;PMTMUTIM;
          GOTO      PMTE9999
.
PMTE9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for teams
.------------------------------------------------------------
SPPMT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMT001,SPPMT002,SPPMT003
.
          MOVE      ONE,EXIT
          GOTO      SPPMT999
.
SPPMT001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMTEM001
          PACK      PMTEM001,PMTEM001,SP70
          GOTO      SPPMT999
.
SPPMT002  MOVE      QRYDATA,PMTEM002
          GOTO      SPPMT999
.
SPPMT003  MOVE      QRYDATA,PMTEM003
          GOTO      SPPMT999
.
SPPMT999  RETURN
.
.------------------------------------------------------------
.  Update team details
.------------------------------------------------------------
MVPMTE00  MATCH     PMTEM001,Z70
          IF        !@EQUAL
            MOVE      PMTEM001,PMTMTEAM
          ENDIF
.
          MATCH     PMTEM002,Z70
          IF        !@EQUAL
            MOVE      PMTEM002,PMTMDESC
          ENDIF
.
          MATCH     "2",PMTEM003
          IF        @EQUAL
            MOVE      ZERO,PMTMACTV       * active
          ELSE
            MOVE      ONE,PMTMACTV        * not active
          ENDIF
.
MVPMTE99  RETURN
.
.------------------------------------------------------------
.  Clear team details
.------------------------------------------------------------
CLPMTE00  MOVE      SP70,PMTMTEAM
          MOVE      SP70,PMTMDESC
          MOVE      SP70,PMTMACTV
          MOVE      SP70,PMTMCUID
          MOVE      SP70,PMTMCDAT
          MOVE      SP70,PMTMCTIM
          MOVE      SP70,PMTMUUID
          MOVE      SP70,PMTMUDAT
          MOVE      SP70,PMTMUTIM
          MOVE      SP70,PMTMSPAR
CLPMTE99  RETURN 
+
