.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSKVRKY
.   Routine   :   HSYKVA00 Keyin Routine Help  
.   Return    :   SYID    
.-------------------------------------------------------------------------------
HSYKVA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYKVA04 IF NOT EQUAL
          MOVE      "18",HTOP
          MOVE      "24",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYKVA04
          CALL      GSCRN000
          BRANCH    EXIT,HSYKVA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"I.D."               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "21",STDCOL03
HSYKVA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SYKVRID 
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          PACK      SAVKEY80,SYKVSYS,SYKVFIL,SYKVRID,SP70                       
          SETLPTR   SAVKEY80,4                                                  
          CALL      RSSYKV1 
HSYKVA10
          CALL      RKSYKV1 
          BRANCH    OVRCD,HSYKVA15
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSYKVA12
          CALL      HSYKVA60
          BRANCH    OVRCD,HSYKVA10
HSYKVA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYKVRID 
          DISPLAY   *PSTDCOL02:STDROW,SYKVKDES
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYKVA10 IF NOT EQUAL
HSYKVA15
          UNPACK    SAVKEY80,SYKVSYS,SYKVFIL,SYKVRID                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYKVA20
          CALL      HSCRI000
          BRANCH    EXIT,HSYKVA30,HSYKVA35,HSYKVA40,HSYKVA45,HSYKVA04:
                              HSYKVA91,HSYKVA50
          GOTO      HSYKVA92
HSYKVA30
          CALL      RKSYKV1 
          BRANCH    OVRCD,HSYKVA85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA85 IF NOT EQUAL                                       
          CALL      RPSYKV1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVA10
HSYKVA35
          MOVE      ST1,KEY5 
          CALL      RDSYKV1 
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVA85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA85 IF NOT EQUAL                                       
          MATCH     SP70,SYKVRID                                                
          GOTO      HSYKVA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYKVA36
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVA37
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYKVA36 IF NOT EQUAL
HSYKVA37
          MOVE      ZERO,XITEMNO
          GOTO      HSYKVA10
HSYKVA40
          MOVE      ST1,KEY5 
          CALL      RDSYKV1 
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVA85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVA08
HSYKVA45
          CALL      RKSYKV1 
          BRANCH    OVRCD,HSYKVA85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY5,SAVKEY80,Z70                                           
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYKV1 
HSYKVA46
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVA47
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYKVA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYKVA46 IF NOT EQUAL
HSYKVA47
          MOVE      ZERO,XITEMNO
          GOTO      HSYKVA10
HSYKVA50  COMPARE   ZERO,CSEARCH
          GOTO      HSYKVA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVA08
HSYKVA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVA08
HSYKVA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYKVA61 IF EQUAL
          MATCH     SCHFLD01,SYKVRID 
          GOTO      HSYKVA72 IF NOT EQUAL
HSYKVA61
          MATCH     SP70,SCHFLD02
          GOTO      HSYKVA62 IF EQUAL
          MATCH     SCHFLD02,SYKVKDES
          GOTO      HSYKVA72 IF NOT EQUAL
HSYKVA62
HSYKVA63
HSYKVA64
HSYKVA65
HSYKVA66
HSYKVA67
HSYKVA68
HSYKVA69
HSYKVA70
          GOTO      HSYKVA75
HSYKVA72  MOVE      ONE,OVRCD
HSYKVA75  RETURN
HSYKVA85
          LOAD      KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYKVSYS,SYKVFIL,SYKVRID                                
          CALL      RDSYKV1 
HSYKVA90
          UNPACK    SAVKEY80,SYKVSYS,SYKVFIL,SYKVRID                            
          BEEP
          GOTO      HSYKVA20
HSYKVA91
          MOVE      SP70,SYKVKFLD
          MOVE      SP70,SYKVKDES
          MOVE      ZERO,SYKVKTYP
          MOVE      SP70,SYKVIDX 
          MOVE      SP70,SYKVHID 
          MOVE      SP70,SYKVSPAR
          MOVE      SP70,KEY5 
          MOVE      SP70,SYKVRID 
          GOTO      HSYKVA96
HSYKVA92
          MOVE      SP70,KEY5 
          MOVE      SP70,SYKVRID 
          LOAD      KEY5,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYKVSYS,SYKVFIL,SYKVRID                                
HSYKVA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYKVA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSKVRKY
.   Routine   :   HSYKVB00 Keyin Routine       
.   Return    :   SYKVRID 
.-------------------------------------------------------------------------------
HSYKVB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYKVB04 IF NOT EQUAL
          MOVE      "10",HTOP
          MOVE      "24",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYKVB04
          CALL      GSCRN000
          BRANCH    EXIT,HSYKVB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Sys"                
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 4",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Fil"                
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 4",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Rid"                
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 4",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL04,STDCOL05
          ADD       "30",STDCOL05
HSYKVB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          PACK      KEY5,SP70                                                   
.                                                                               
.                                                                               
          CALL      RSSYKV1 
HSYKVB10
          CALL      RKSYKV1 
          BRANCH    OVRCD,HSYKVB15
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
          BRANCH    CSEARCH,HSYKVB12
          CALL      HSYKVB60
          BRANCH    OVRCD,HSYKVB10
HSYKVB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYKVSYS 
          DISPLAY   *PSTDCOL02:STDROW,SYKVFIL 
          DISPLAY   *PSTDCOL03:STDROW,SYKVRID 
          DISPLAY   *PSTDCOL04:STDROW,SYKVKDES
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYKVB10 IF NOT EQUAL
HSYKVB15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYKVB20
          CALL      HSCRI000
          BRANCH    EXIT,HSYKVB30,HSYKVB35,HSYKVB40,HSYKVB45,HSYKVB04:
                              HSYKVB91,HSYKVB50
          GOTO      HSYKVB92
HSYKVB30
          CALL      RKSYKV1 
          BRANCH    OVRCD,HSYKVB85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
.                                                                               
.                                                                               
          CALL      RPSYKV1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVB10
HSYKVB35
          MOVE      ST1,KEY5 
          CALL      RDSYKV1 
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVB85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYKVB36
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVB37
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYKVB36 IF NOT EQUAL
HSYKVB37
          MOVE      ZERO,XITEMNO
          GOTO      HSYKVB10
HSYKVB40
          MOVE      ST1,KEY5 
          CALL      RDSYKV1 
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVB85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVB08
HSYKVB45
          CALL      RKSYKV1 
          BRANCH    OVRCD,HSYKVB85
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY5,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYKV1 
HSYKVB46
          CALL      RPSYKV1 
          BRANCH    OVRCD,HSYKVB47
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID,SP70                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYKVB46 IF NOT EQUAL
HSYKVB47
          MOVE      ZERO,XITEMNO
          GOTO      HSYKVB10
HSYKVB50  COMPARE   ZERO,CSEARCH
          GOTO      HSYKVB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVB08
HSYKVB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYKVB08
HSYKVB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYKVB61 IF EQUAL
          MATCH     SCHFLD01,SYKVSYS 
          GOTO      HSYKVB72 IF NOT EQUAL
HSYKVB61
          MATCH     SP70,SCHFLD02
          GOTO      HSYKVB62 IF EQUAL
          MATCH     SCHFLD02,SYKVFIL 
          GOTO      HSYKVB72 IF NOT EQUAL
HSYKVB62
          MATCH     SP70,SCHFLD03
          GOTO      HSYKVB63 IF EQUAL
          MATCH     SCHFLD03,SYKVRID 
          GOTO      HSYKVB72 IF NOT EQUAL
HSYKVB63
          MATCH     SP70,SCHFLD04
          GOTO      HSYKVB64 IF EQUAL
          MATCH     SCHFLD04,SYKVKDES
          GOTO      HSYKVB72 IF NOT EQUAL
HSYKVB64
HSYKVB65
HSYKVB66
HSYKVB67
HSYKVB68
HSYKVB69
HSYKVB70
          GOTO      HSYKVB75
HSYKVB72  MOVE      ONE,OVRCD
HSYKVB75  RETURN
HSYKVB85
          LOAD      KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYKVSYS,SYKVFIL,SYKVRID                                
          CALL      RDSYKV1 
HSYKVB90
.                                                                               
          BEEP
          GOTO      HSYKVB20
HSYKVB91
          MOVE      SP70,SYKVKFLD
          MOVE      SP70,SYKVKDES
          MOVE      ZERO,SYKVKTYP
          MOVE      SP70,SYKVIDX 
          MOVE      SP70,SYKVHID 
          MOVE      SP70,SYKVSPAR
          MOVE      SP70,KEY5 
          GOTO      HSYKVB96
HSYKVB92
          MOVE      SP70,KEY5 
          LOAD      KEY5,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYKVSYS,SYKVFIL,SYKVRID                                
HSYKVB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYKVB99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSKVRKY
.   Routine   :   KSYKVA00 Keyin Keyin Routine I.D.  
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYKVA00 TOPIC     "SYKVRID "
          MOVE      UNDLN70,SYKVRID 
          KEYIN     *PCCOL:CVERT,*DV,SYKVRID:                                   
                    *PCCOL:CVERT,*V2LON,SYKVRID:                                
                    *PCCOL:CVERT,*DV,SYKVRID 
.
          ENDSET    SYKVRID 
          APPEND    SP70,SYKVRID 
          RESET     SYKVRID 
.
          MATCH     SP70,SYKVRID 
          GOTO      KSYKVA90 IF EQUAL
.
          CMATCH    EXITCHAR,SYKVRID 
          GOTO      KSYKVA95 IF EQUAL
.
          CMATCH    QUEST,SYKVRID 
          GOTO      KSYKVA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYKVA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SYKVRID 
          APPEND    SP70,SYKVRID 
          RESET     SYKVRID 
.
          MATCH     SP70,SYKVRID 
          GOTO      KSYKVA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SYKVRID                                 
KSYKVA10
          PACK      KEY5,SYKVSYS,SYKVFIL,SYKVRID                                
          CALL      RASYKV1 
          BRANCH    OVRCD,KSYKVA80
          BRANCH    CKEYTYP,KSYKVA75
          CALL      RDSYKV1 
KSYKVA70
          MOVE      ZERO,EXIT
          GOTO      KSYKVA99
KSYKVA75
          MOVE      "Keyin Routine I.D. Already Exist - ",DISPMSG                                    
          CALL      MESSAGE1
          GOTO      KSYKVA00
KSYKVA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYKVA99,KSYKVA99
          MOVE      "Keyin Routine I.D. Does Not Exist - ",DISPMSG                                   
          CALL      MESSAGE1
          GOTO      KSYKVA00
KSYKVA90
          MOVE      ONE,EXIT
          GOTO      KSYKVA99
KSYKVA95
          MOVE      TWO,EXIT
KSYKVA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSKVRKY
.   Routine   :   KSYKVB00 Keyin Routine             
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYKVB00 TOPIC     "SYKVRID "
          MOVE      UNDLN70,KEY5    
          KEYIN     *PCCOL:CVERT,*DV,KEY5:                                      
                    *PCCOL:CVERT,*V2LON,KEY5:                                   
                    *PCCOL:CVERT,*DV,KEY5    
.
          ENDSET    KEY5    
          APPEND    SP70,KEY5    
          RESET     KEY5    
.
          MATCH     SP70,KEY5    
          GOTO      KSYKVB90 IF EQUAL
.
          CMATCH    EXITCHAR,KEY5    
          GOTO      KSYKVB95 IF EQUAL
.
          CMATCH    QUEST,KEY5    
          GOTO      KSYKVB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYKVB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    KEY5    
          APPEND    SP70,KEY5    
          RESET     KEY5    
.
          MATCH     SP70,KEY5    
          GOTO      KSYKVB00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,KEY5                                    
KSYKVB10
          CALL      RASYKV1 
          BRANCH    OVRCD,KSYKVB80
          BRANCH    CKEYTYP,KSYKVB75
          CALL      RDSYKV1 
KSYKVB70
          MOVE      ZERO,EXIT
          GOTO      KSYKVB99
KSYKVB75
          MOVE      "Routine Already Exist - ",DISPMSG                                               
          CALL      MESSAGE1
          GOTO      KSYKVB00
KSYKVB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYKVB99,KSYKVB99
          MOVE      "Routine Does Not Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KSYKVB00
KSYKVB90
          MOVE      ONE,EXIT
          GOTO      KSYKVB99
KSYKVB95
          MOVE      TWO,EXIT
KSYKVB99 TOPIC    PRGID
          RETURN
