.
.------------------------------------------------------------
. External Call to Read File Name for SYS/FILE/IDX Keyin
.------------------------------------------------------------
ESYIDB00  PACK      KEY4,SYIDSYS,SYIDFIL
          CALL      RDSYFI1
          IF        OVRCD=1
            MOVE      "Invalid System/File",SYFIDES
          ENDIF
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSIDXKY
.   Routine   :   HSYIDA00 File Index Help     
.   Return    :   SYHV    
.-------------------------------------------------------------------------------
HSYIDA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYIDA04 IF NOT EQUAL
          MOVE      " 3",HTOP
          MOVE      "15",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYIDA04
          CALL      GSCRN000
          BRANCH    EXIT,HSYIDA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Index"              
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Seg 1"              
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 6",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"to 6"               
.
          MOVE      STDCOL04,STDCOL05
          ADD       " 6",STDCOL05
          MOVE      STDCOL05,STDCOL06
          ADD       " 6",STDCOL06
          MOVE      STDCOL06,STDCOL07
          ADD       " 6",STDCOL07
          MOVE      STDCOL07,STDCOL08
          ADD       " 6",STDCOL08
          MOVE      STDCOL08,STDCOL09
          ADD       " 6",STDCOL09
HSYIDA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SYIDIDX 
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          PACK      SAVKEY80,SYIDSYS,SYIDFIL,SYIDIDX,SP70                       
          SETLPTR   SAVKEY80,4                                                  
          CALL      RSSYID1 
HSYIDA10
          CALL      RKSYID1 
          BRANCH    OVRCD,HSYIDA15
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSYIDA12
          CALL      HSYIDA60
          BRANCH    OVRCD,HSYIDA10
HSYIDA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYIDIDX 
          DISPLAY   *PSTDCOL02:STDROW,SYIDDES 
          DISPLAY   *PSTDCOL03:STDROW,SYIDFL1 
          DISPLAY   *PSTDCOL04:STDROW,SYIDFL2 
          DISPLAY   *PSTDCOL05:STDROW,SYIDFL3 
          DISPLAY   *PSTDCOL06:STDROW,SYIDFL4 
          DISPLAY   *PSTDCOL07:STDROW,SYIDFL5 
          DISPLAY   *PSTDCOL08:STDROW,SYIDFL6 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYIDA10 IF NOT EQUAL
HSYIDA15
          UNPACK    SAVKEY80,SYIDSYS,SYIDFIL,SYIDIDX                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYIDA20
          CALL      HSCRI000
          BRANCH    EXIT,HSYIDA30,HSYIDA35,HSYIDA40,HSYIDA45,HSYIDA04:
                              HSYIDA91,HSYIDA50
          GOTO      HSYIDA92
HSYIDA30
          CALL      RKSYID1 
          BRANCH    OVRCD,HSYIDA85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA85 IF NOT EQUAL                                       
          CALL      RPSYID1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDA10
HSYIDA35
          MOVE      ST1,KEY5 
          CALL      RDSYID1 
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDA85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA85 IF NOT EQUAL                                       
          MATCH     SP70,SYIDIDX                                                
          GOTO      HSYIDA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYIDA36
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDA37
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYIDA36 IF NOT EQUAL
HSYIDA37
          MOVE      ZERO,XITEMNO
          GOTO      HSYIDA10
HSYIDA40
          MOVE      ST1,KEY5 
          CALL      RDSYID1 
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDA85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDA08
HSYIDA45
          CALL      RKSYID1 
          BRANCH    OVRCD,HSYIDA85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY5,SAVKEY80,Z70                                           
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYID1 
HSYIDA46
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDA47
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          MATCH     SAVKEY80,KEY5                                               
          GOTO      HSYIDA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYIDA46 IF NOT EQUAL
HSYIDA47
          MOVE      ZERO,XITEMNO
          GOTO      HSYIDA10
HSYIDA50  COMPARE   ZERO,CSEARCH
          GOTO      HSYIDA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          KEYIN     *PSTDCOL05:STDROW,*V2LON,SCHFLD05
          RESET     SCHFLD05
          KEYIN     *PSTDCOL06:STDROW,*V2LON,SCHFLD06
          RESET     SCHFLD06
          KEYIN     *PSTDCOL07:STDROW,*V2LON,SCHFLD07
          RESET     SCHFLD07
          KEYIN     *PSTDCOL08:STDROW,*V2LON,SCHFLD08
          RESET     SCHFLD08
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDA08
HSYIDA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDA08
HSYIDA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYIDA61 IF EQUAL
          MATCH     SCHFLD01,SYIDIDX 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA61
          MATCH     SP70,SCHFLD02
          GOTO      HSYIDA62 IF EQUAL
          MATCH     SCHFLD02,SYIDDES 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA62
          MATCH     SP70,SCHFLD03
          GOTO      HSYIDA63 IF EQUAL
          MATCH     SCHFLD03,SYIDFL1 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA63
          MATCH     SP70,SCHFLD04
          GOTO      HSYIDA64 IF EQUAL
          MATCH     SCHFLD04,SYIDFL2 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA64
          MATCH     SP70,SCHFLD05
          GOTO      HSYIDA65 IF EQUAL
          MATCH     SCHFLD05,SYIDFL3 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA65
          MATCH     SP70,SCHFLD06
          GOTO      HSYIDA66 IF EQUAL
          MATCH     SCHFLD06,SYIDFL4 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA66
          MATCH     SP70,SCHFLD07
          GOTO      HSYIDA67 IF EQUAL
          MATCH     SCHFLD07,SYIDFL5 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA67
          MATCH     SP70,SCHFLD08
          GOTO      HSYIDA68 IF EQUAL
          MATCH     SCHFLD08,SYIDFL6 
          GOTO      HSYIDA72 IF NOT EQUAL
HSYIDA68
HSYIDA69
HSYIDA70
          GOTO      HSYIDA75
HSYIDA72  MOVE      ONE,OVRCD
HSYIDA75  RETURN
HSYIDA85
          LOAD      KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYIDSYS,SYIDFIL,SYIDIDX                                
          CALL      RDSYID1 
HSYIDA90
          UNPACK    SAVKEY80,SYIDSYS,SYIDFIL,SYIDIDX                            
          BEEP
          GOTO      HSYIDA20
HSYIDA91
          MOVE      SP70,SYIDDES 
          MOVE      SP70,SYIDFL1 
          MOVE      SP70,SYIDFL2 
          MOVE      SP70,SYIDFL3 
          MOVE      SP70,SYIDFL4 
          MOVE      SP70,SYIDFL5 
          MOVE      SP70,SYIDFL6 
          MOVE      SP70,SYIDFL7 
          MOVE      SP70,SYIDFL8 
          MOVE      SP70,SYIDSPA 
          MOVE      SP70,KEY5 
          MOVE      SP70,SYIDIDX 
          GOTO      HSYIDA96
HSYIDA92
          MOVE      SP70,KEY5 
          MOVE      SP70,SYIDIDX 
          LOAD      KEY5,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYIDSYS,SYIDFIL,SYIDIDX                                
HSYIDA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYIDA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSIDXKY
.   Routine   :   HSYIDB00 Index               
.   Return    :   SYIDIDX 
.-------------------------------------------------------------------------------
HSYIDB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSYIDB04 IF NOT EQUAL
          MOVE      "10",HTOP
          MOVE      "24",HBOT
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          ENDIF
HSYIDB04
          CALL      GSCRN000
          BRANCH    EXIT,HSYIDB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Sys"                
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 4",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Fil"                
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 4",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Idx"                
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 4",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"File Name"          
.
          MOVE      STDCOL04,STDCOL05
          ADD       "30",STDCOL05
HSYIDB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          PACK      KEY5,SP70                                                   
.                                                                               
.                                                                               
          CALL      RSSYID1 
HSYIDB10
          CALL      RKSYID1 
          BRANCH    OVRCD,HSYIDB15
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
          BRANCH    CSEARCH,HSYIDB12
          CALL      HSYIDB60
          BRANCH    OVRCD,HSYIDB10
HSYIDB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SYIDSYS 
          DISPLAY   *PSTDCOL02:STDROW,SYIDFIL 
          DISPLAY   *PSTDCOL03:STDROW,SYIDIDX 
          CALL      ESYIDB00
          DISPLAY   *PSTDCOL04:STDROW,SYFIDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSYIDB10 IF NOT EQUAL
HSYIDB15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSYIDB20
          CALL      HSCRI000
          BRANCH    EXIT,HSYIDB30,HSYIDB35,HSYIDB40,HSYIDB45,HSYIDB04:
                              HSYIDB91,HSYIDB50
          GOTO      HSYIDB92
HSYIDB30
          CALL      RKSYID1 
          BRANCH    OVRCD,HSYIDB85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
.                                                                               
.                                                                               
          CALL      RPSYID1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDB10
HSYIDB35
          MOVE      ST1,KEY5 
          CALL      RDSYID1 
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDB85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSYIDB36
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDB37
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYIDB36 IF NOT EQUAL
HSYIDB37
          MOVE      ZERO,XITEMNO
          GOTO      HSYIDB10
HSYIDB40
          MOVE      ST1,KEY5 
          CALL      RDSYID1 
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDB85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDB08
HSYIDB45
          CALL      RKSYID1 
          BRANCH    OVRCD,HSYIDB85
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY5,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSYID1 
HSYIDB46
          CALL      RPSYID1 
          BRANCH    OVRCD,HSYIDB47
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX,SP70                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSYIDB46 IF NOT EQUAL
HSYIDB47
          MOVE      ZERO,XITEMNO
          GOTO      HSYIDB10
HSYIDB50  COMPARE   ZERO,CSEARCH
          GOTO      HSYIDB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDB08
HSYIDB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSYIDB08
HSYIDB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSYIDB61 IF EQUAL
          MATCH     SCHFLD01,SYIDSYS 
          GOTO      HSYIDB72 IF NOT EQUAL
HSYIDB61
          MATCH     SP70,SCHFLD02
          GOTO      HSYIDB62 IF EQUAL
          MATCH     SCHFLD02,SYIDFIL 
          GOTO      HSYIDB72 IF NOT EQUAL
HSYIDB62
          MATCH     SP70,SCHFLD03
          GOTO      HSYIDB63 IF EQUAL
          MATCH     SCHFLD03,SYIDIDX 
          GOTO      HSYIDB72 IF NOT EQUAL
HSYIDB63
          MATCH     SP70,SCHFLD04
          GOTO      HSYIDB64 IF EQUAL
          MATCH     SCHFLD04,SYFIDES 
          GOTO      HSYIDB72 IF NOT EQUAL
HSYIDB64
HSYIDB65
HSYIDB66
HSYIDB67
HSYIDB68
HSYIDB69
HSYIDB70
          GOTO      HSYIDB75
HSYIDB72  MOVE      ONE,OVRCD
HSYIDB75  RETURN
HSYIDB85
          LOAD      KEY5,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYIDSYS,SYIDFIL,SYIDIDX                                
          CALL      RDSYID1 
HSYIDB90
.                                                                               
          BEEP
          GOTO      HSYIDB20
HSYIDB91
          MOVE      SP70,SYIDDES 
          MOVE      SP70,SYIDFL1 
          MOVE      SP70,SYIDFL2 
          MOVE      SP70,SYIDFL3 
          MOVE      SP70,SYIDFL4 
          MOVE      SP70,SYIDFL5 
          MOVE      SP70,SYIDFL6 
          MOVE      SP70,SYIDFL7 
          MOVE      SP70,SYIDFL8 
          MOVE      SP70,SYIDSPA 
          MOVE      SP70,KEY5 
          GOTO      HSYIDB96
HSYIDB92
          MOVE      SP70,KEY5 
          LOAD      KEY5,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY5,SYIDSYS,SYIDFIL,SYIDIDX                                
HSYIDB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSYIDB99
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSIDXKY
.   Routine   :   KSYIDA00 Keyin Index               
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYIDA00 TOPIC     "SYIDIDX "
          MOVE      UNDLN70,SYIDIDX 
          KEYIN     *PCCOL:CVERT,*DV,SYIDIDX:                                   
                    *PCCOL:CVERT,*V2LON,SYIDIDX:                                
                    *PCCOL:CVERT,*DV,SYIDIDX 
.
          ENDSET    SYIDIDX 
          APPEND    SP70,SYIDIDX 
          RESET     SYIDIDX 
.
          MATCH     SP70,SYIDIDX 
          GOTO      KSYIDA90 IF EQUAL
.
          CMATCH    EXITCHAR,SYIDIDX 
          GOTO      KSYIDA95 IF EQUAL
.
          CMATCH    QUEST,SYIDIDX 
          GOTO      KSYIDA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYIDA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SYIDIDX 
          APPEND    SP70,SYIDIDX 
          RESET     SYIDIDX 
.
          MATCH     SP70,SYIDIDX 
          GOTO      KSYIDA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SYIDIDX                                 
KSYIDA10
          PACK      KEY5,SYIDSYS,SYIDFIL,SYIDIDX                                
          CALL      RASYID1 
          BRANCH    OVRCD,KSYIDA80
          BRANCH    CKEYTYP,KSYIDA75
          CALL      RDSYID1 
KSYIDA70
          MOVE      ZERO,EXIT
          GOTO      KSYIDA99
KSYIDA75
          MOVE      "Index Already Exist - ",DISPMSG                                                 
          CALL      MESSAGE1
          GOTO      KSYIDA00
KSYIDA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYIDA99,KSYIDA99
          MOVE      "Index Does Not Exist - ",DISPMSG                                                
          CALL      MESSAGE1
          GOTO      KSYIDA00
KSYIDA90
          MOVE      ONE,EXIT
          GOTO      KSYIDA99
KSYIDA95
          MOVE      TWO,EXIT
KSYIDA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   System Control                     
.   Include   :   SYSIDXKY
.   Routine   :   KSYIDB00 Keyin Sys/File/Index      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSYIDB00 TOPIC     "SYIDIDX "
          MOVE      UNDLN70,KEY5    
          KEYIN     *PCCOL:CVERT,*DV,KEY5:                                      
                    *PCCOL:CVERT,*V2LON,KEY5:                                   
                    *PCCOL:CVERT,*DV,KEY5    
.
          ENDSET    KEY5    
          APPEND    SP70,KEY5    
          RESET     KEY5    
.
          MATCH     SP70,KEY5    
          GOTO      KSYIDB90 IF EQUAL
.
          CMATCH    EXITCHAR,KEY5    
          GOTO      KSYIDB95 IF EQUAL
.
          CMATCH    QUEST,KEY5    
          GOTO      KSYIDB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSYIDB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    KEY5    
          APPEND    SP70,KEY5    
          RESET     KEY5    
.
          MATCH     SP70,KEY5    
          GOTO      KSYIDB00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,KEY5                                    
KSYIDB10
          CALL      RASYID1 
          BRANCH    OVRCD,KSYIDB80
          BRANCH    CKEYTYP,KSYIDB75
          CALL      RDSYID1 
KSYIDB70
          MOVE      ZERO,EXIT
          GOTO      KSYIDB99
KSYIDB75
          MOVE      "Sys/File/Index Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KSYIDB00
KSYIDB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSYIDB99,KSYIDB99
          MOVE      "Sys/File/Index Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KSYIDB00
KSYIDB90
          MOVE      ONE,EXIT
          GOTO      KSYIDB99
KSYIDB95
          MOVE      TWO,EXIT
KSYIDB99 TOPIC    PRGID
          RETURN
