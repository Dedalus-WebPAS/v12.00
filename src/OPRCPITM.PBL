.----------------------------------------------------------------------
. Modifications
.
. V10.10.01  30/05/2017  Peter Vela    TSK 0837660
.            Created include
.
.------------------------------------------------------------------------
.   Clear Parameters for Theatre Complications Table
.------------------------------------------------------------------------
CLRCPI00  MOVE      SP70,OPCPI001
          MOVE      SP70,OPCPI002
          MOVE      SP70,OPCPI003
          PACK      OPCPI004,SP70,SP70,SP70
          MOVE      SP70,OPCPI005
          MOVE      SP70,OPCPI006
          MOVE      SP70,OPCPI007
          MOVE      SP70,OPCPI008
          MOVE      SP70,OPCPI009
          MOVE      SP70,OPCPI010
          MOVE      SP70,OPCPI011
          MOVE      SP70,OPCPI012
.
CLRCPI99  RETURN
+
.------------------------------------------------------------
. Output Theatre Complications Field
.------------------------------------------------------------
OPCI0000  BRANCH    FLDITMNO,OPCI0100,OPCI0200,OPCI0300,OPCI0400,OPCI0500:
                             OPCI0600,OPCI0700,OPCI0800,OPCI0900,OPCI1000:
                             OPCI1100,OPCI1200
.
OPCI0100  WRITE     HTMLFILE;OPCIUNIQ;
          GOTO      OPCI9999
.
OPCI0200  MOVE      "cM",CATEGORY
          MOVE      OPCICOMP,CODE
          CALL      CODITM00
          GOTO      OPCI9999
.
OPCI0300  WRITE     HTMLFILE;OPCICNTR;
          GOTO      OPCI9999
.
OPCI0400  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          UNPACK    OPCICOMM,KEY99,KEY1,KEY100
          IF        F1=1
            WRITE     HTMLFILE;KEY100;
          ELSE
            WRITE     HTMLFILE;KEY99;
          ENDIF
          GOTO      OPCI9999
.
OPCI0500  MATCH     SP70,OPCICDAT
          GOTO      OPCI9999 IF EQUAL
          UNPACK    OPCICDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPCI9999
.
OPCI0600  WRITE     HTMLFILE;OPCICTIM;
          GOTO      OPCI9999
.
OPCI0700  WRITE     HTMLFILE;OPCICUID;
          GOTO      OPCI9999
.
OPCI0800  MATCH     SP70,OPCIUDAT
          GOTO      OPCI9999 IF EQUAL
          UNPACK    OPCIUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OPCI9999
.
OPCI0900  WRITE     HTMLFILE;OPCIUTIM;
          GOTO      OPCI9999
.
OPCI1000  WRITE     HTMLFILE;OPCIUUID;
          GOTO      OPCI9999
.
OPCI1100  WRITE     HTMLFILE;OPCIDELT;
          GOTO      OPCI9999
.
OPCI1200  WRITE     HTMLFILE;OPCIUDEL;
          GOTO      OPCI9999
.
OPCI9999  RETURN
+
.------------------------------------------------------------
.   Set Parameters for theatre complications table
.------------------------------------------------------------
SOPCPI00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SOPCPI01,SOPCPI02,SOPCPI03,SOPCPI04,SOPCPI05:
                       SOPCPI06,SOPCPI07,SOPCPI08,SOPCPI09,SOPCPI10:
                       SOPCPI11,SOPCPI12
.
          MOVE      ONE,EXIT
          GOTO      SOPCPI99
.
SOPCPI01  MOVE      QRYDATA,OPCPI001
          GOTO      SOPCPI99
.
SOPCPI02  MOVE      QRYDATA,OPCPI002
          GOTO      SOPCPI99
.
SOPCPI03  MOVE      QRYDATA,OPCPI003
          GOTO      SOPCPI99
.
SOPCPI04  MOVE      QRYDATA,OPCPI004
          GOTO      SOPCPI99
.
SOPCPI05  MATCH     SP70,QRYDATA
          GOTO      SOPCPI99 IF EQUAL
          GOTO      SOPCPI99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPCPI005,CCENT,CYEAR,CMON,CDAY
          GOTO      SOPCPI99
.
SOPCPI06  MOVE      QRYDATA,OPCPI006
          GOTO      SOPCPI99
.
SOPCPI07  MOVE      QRYDATA,OPCPI007
          GOTO      SOPCPI99
.
SOPCPI08  MATCH     SP70,QRYDATA
          GOTO      SOPCPI99 IF EQUAL
          GOTO      SOPCPI99 IF EOS
.
          UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      OPCPI008,CCENT,CYEAR,CMON,CDAY
          GOTO      SOPCPI99
.
SOPCPI09  MOVE      QRYDATA,OPCPI009
          GOTO      SOPCPI99
.
SOPCPI10  MOVE      QRYDATA,OPCPI010
          GOTO      SOPCPI99
.
SOPCPI11  MOVE      QRYDATA,OPCPI011
          GOTO      SOPCPI99
.
SOPCPI12  MOVE      QRYDATA,OPCPI012
          GOTO      SOPCPI99
.
SOPCPI99  RETURN
+
.------------------------------------------------------------------------
.         Move work variables to theatre complications file variables
.------------------------------------------------------------------------
MVOPRCPI  PACK      OPCIUNIQ,OPCPI001,SP70
          PACK      OPCICOMP,OPCPI002,SP70
          PACK      OPCICNTR,OPCPI003,SP70
          PACK      OPCICOMM,OPCPI004,SP70,SP70,SP70
          RETURN
+
