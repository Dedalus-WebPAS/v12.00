. *----------------------------------------------------------------------
. * Include Name  :   PMSARVTM.PBL
. *
. * Function      :   CGI variables functions for PMSARVFD - pmsarvaf.dat
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V10.03.03  12/11/2013  Ebon Clements     CAR 291974
.             Added Start/End date validations to PMAVHS00
.  V10.03.02  11/11/2013  Ebon Clements     CAR 291974
.             Changed category of PMARBTYP
.  V10.03.01  28/10/2013  Ebon Clements     CAR 291974
.             Changed category of PMARRSTA
.  V10.03.00  20/09/2013  Ebon Clements     CAR 275205
.             Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear Parameters for admission request review file
.------------------------------------------------------------------------
CPPMAV00  MOVE      Z70,PMARV001
          MOVE      Z70,PMARV002
          MOVE      Z70,PMARV003
          MOVE      Z70,PMARV004
          MOVE      Z70,PMARV005
          MOVE      Z70,PMARV006
          MOVE      Z70,PMARV007
          MOVE      Z70,PMARV008
          MOVE      Z70,PMARV009
          MOVE      Z70,PMARV010
          MOVE      Z70,PMARV011
          MOVE      Z70,PMARV012
          MOVE      Z70,PMARV013
          MOVE      Z70,PMARV014
          MOVE      Z70,PMARV015
          MOVE      Z70,PMARV016
          MOVE      Z70,PMARV017
          MOVE      Z70,PMARV018
          MOVE      Z70,PMARV019
          MOVE      Z70,PMARV020
          MOVE      Z70,PMARV021
          MOVE      Z70,PMARV022
          MOVE      Z70,PMARV023
          MOVE      Z70,PMARV024
          MOVE      Z70,PMARV025
          MOVE      Z70,PMARV026
          MOVE      Z70,PMARV027
          MOVE      Z70,PMARV028
          MOVE      Z70,PMARV029
          MOVE      Z70,PMARV030
          MOVE      Z70,PMARV031
          MOVE      Z70,PMARV032
          MOVE      Z70,PMARV033
          MOVE      Z70,PMARV034
          MOVE      Z70,PMARV035
          MOVE      Z70,PMARV036
          MOVE      Z70,PMARV037
          MOVE      Z70,PMARV038
.
CPPMAV99  RETURN
.
.------------------------------------------------------------
. Tags for admission request review file
.------------------------------------------------------------
PMAV0000  BRANCH    FLDITMNO,PMAV0010,PMAV0020,PMAV0030,PMAV0040,PMAV0050:
                             PMAV0060,PMAV0070,PMAV0080,PMAV0090,PMAV0100:
                             PMAV0110,PMAV0120,PMAV0130,PMAV0140,PMAV0150:
                             PMAV0160,PMAV0170,PMAV0180,PMAV0190,PMAV0200:
                             PMAV0210,PMAV0220,PMAV0230,PMAV0240,PMAV0250:
                             PMAV0260,PMAV0270,PMAV0280,PMAV0290,PMAV0300:
                             PMAV0310,PMAV0320,PMAV0330,PMAV0340,PMAV0350:
                             PMAV0360,PMAV0370,PMAV0380,PMAV0390,PMAV0400:
                             PMAV0410,PMAV0420,PMAV0430,PMAV0440
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMAV9999
.
PMAV0010  WRITE     HTMLFILE;PMAVREQN;
          GOTO      PMAV9999
.
PMAV0020  WRITE     HTMLFILE;PMAVRTYP;
          GOTO      PMAV9999
.
PMAV0030  WRITE     HTMLFILE;PMAVCNTR;
          GOTO      PMAV9999
.
PMAV0040  MATCH     SP70,PMAVDATR
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVDATR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0050  WRITE     HTMLFILE;PMAVTIMR;
          GOTO      PMAV9999
.
PMAV0060  WRITE     HTMLFILE;PMAVURNO;
          GOTO      PMAV9999
.
PMAV0070  WRITE     HTMLFILE;PMAVVISN;
          GOTO      PMAV9999
.
PMAV0080  MATCH     "001",PMAVRTYP
          IF        @EQUAL
            MOVE      "ym",CATEGORY
          ENDIF
          MATCH     "002",PMAVRTYP
          IF        @EQUAL
            MOVE      "yl",CATEGORY
          ENDIF
          MOVE      PMAVRSTA,CODE
          CALL      CODITM00
          GOTO      PMAV9999
.
PMAV0090  MOVE      "yj",CATEGORY
          MOVE      PMAVBTYP,CODE
          CALL      CODITM00
          GOTO      PMAV9999
.
PMAV0100  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAV0101
.
          MATCH     "0",PMAVPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"No";
          ENDIF
.
          MATCH     "1",PMAVPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ENDIF
.
          MATCH     "2",PMAVPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"Unknown";
          ENDIF
          GOTO      PMAV9999
.
PMAV0101  MATCH     "0",PMAVPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"0#" selected >No</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"0#">No</option>"
          ENDIF
.
          MATCH     "1",PMAVPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"1#" selected >Yes</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"1#">Yes</option>"
          ENDIF
.
          MATCH     "2",PMAVPSAH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"2#" selected >Unknown</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"2#">Unknown</option>"
          ENDIF
          GOTO      PMAV9999
. 
PMAV0110  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAV0111,PMAV0112
.
          PACK      KEY10,PMAVHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMAV9999
.
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      PMAV9999
.
PMAV0111  WRITE     HTMLFILE;PMAVHOSP;
          GOTO      PMAV9999
.
PMAV0112  MOVE      PMAVHOSP,DIM3
          CALL      PMAVHS00
          GOTO      PMAV9999
.
PMAV0120  WRITE     HTMLFILE;PMAVASAS;
          GOTO      PMAV9999
.
PMAV0130  MATCH     SP70,PMAVRSED
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVRSED,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0140  MATCH     SP70,PMAVDAT1
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVDAT1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0150  MATCH     SP70,PMAVDAT2
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVDAT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0160  MATCH     SP70,PMAVDAT3
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVDAT3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0170  MATCH     SP70,PMAVDAT4
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVDAT4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0180  MATCH     SP70,PMAVDAT5
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVDAT5,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0190  WRITE     HTMLFILE;PMAVTIM1;
          GOTO      PMAV9999
.
PMAV0200  WRITE     HTMLFILE;PMAVTIM2;
          GOTO      PMAV9999
.
PMAV0210  WRITE     HTMLFILE;PMAVTIM3;
          GOTO      PMAV9999
.
PMAV0220  WRITE     HTMLFILE;PMAVTIM4;
          GOTO      PMAV9999
.
PMAV0230  WRITE     HTMLFILE;PMAVTIM5;
          GOTO      PMAV9999
.
PMAV0240  WRITE     HTMLFILE;PMAVYN01;
          GOTO      PMAV9999
.
PMAV0250  WRITE     HTMLFILE;PMAVYN02;
          GOTO      PMAV9999
.
PMAV0260  WRITE     HTMLFILE;PMAVYN03;
          GOTO      PMAV9999
.
PMAV0270  WRITE     HTMLFILE;PMAVYN04;
          GOTO      PMAV9999
.
PMAV0280  WRITE     HTMLFILE;PMAVYN05;
          GOTO      PMAV9999
.
PMAV0290  WRITE     HTMLFILE;PMAVHCP1;
          GOTO      PMAV9999
.
PMAV0300  WRITE     HTMLFILE;PMAVHCP2;
          GOTO      PMAV9999
.
PMAV0310  WRITE     HTMLFILE;PMAVHCP3;
          GOTO      PMAV9999
.
PMAV0320  WRITE     HTMLFILE;PMAVHCP4;
          GOTO      PMAV9999
.
PMAV0330  WRITE     HTMLFILE;PMAVHCP5;
          GOTO      PMAV9999
.
PMAV0340  WRITE     HTMLFILE;PMAVUDC1;
          GOTO      PMAV9999
.
PMAV0350  WRITE     HTMLFILE;PMAVUDC2;
          GOTO      PMAV9999
.
PMAV0360  WRITE     HTMLFILE;PMAVUDC3;
          GOTO      PMAV9999
.
PMAV0370  WRITE     HTMLFILE;PMAVUDC4;
          GOTO      PMAV9999
.
PMAV0380  WRITE     HTMLFILE;PMAVUDC5;
          GOTO      PMAV9999
.
PMAV0390  MATCH     PMAVCDAT,SP70
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0400  WRITE     HTMLFILE;PMAVCTIM;
          GOTO      PMAV9999
.
PMAV0410  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAV0411
.
          MATCH     SP70,PMAVCUID
          GOTO      PMAV9999 IF EQUAL
.
          PACK      KEY10,PMAVCUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMAVCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMAV9999
.
PMAV0411  WRITE     HTMLFILE;PMAVCUID;
          GOTO      PMAV9999
.
PMAV0420  MATCH     PMAVUDAT,SP70
          GOTO      PMAV9999 IF EQUAL
.
          UNPACK    PMAVUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAV9999
.
PMAV0430  WRITE     HTMLFILE;PMAVUTIM;
          GOTO      PMAV9999
.
PMAV0440  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMAV0441
.
          MATCH     SP70,PMAVUUID
          GOTO      PMAV9999 IF EQUAL
.
          PACK      KEY10,PMAVUUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      PMAVUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMAV9999
.
PMAV0441  WRITE     HTMLFILE;PMAVUUID;
          GOTO      PMAV9999
.
PMAV9999  RETURN
.
.------------------------------------------------------------
. Set Parameters for the admission request review file
.------------------------------------------------------------
SPMAV000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPMAV001,SPMAV002,SPMAV003,SPMAV004,SPMAV005:
                       SPMAV006,SPMAV007,SPMAV008,SPMAV009,SPMAV010:
                       SPMAV011,SPMAV012,SPMAV013,SPMAV014,SPMAV015:
                       SPMAV016,SPMAV017,SPMAV018,SPMAV019,SPMAV020:
                       SPMAV021,SPMAV022,SPMAV023,SPMAV024,SPMAV025:
                       SPMAV026,SPMAV027,SPMAV028,SPMAV029,SPMAV030:
                       SPMAV031,SPMAV032,SPMAV033,SPMAV034,SPMAV035:
                       SPMAV036,SPMAV037,SPMAV038
          MOVE      ONE,EXIT
          GOTO      SPMAV999
.
SPMAV001  PACK      PMARV001,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV002  PACK      PMARV002,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV003  PACK      PMARV003,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV004  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV005  PACK      PMARV005,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV006  PACK      PMARV006,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV007  PACK      PMARV007,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV008  PACK      PMARV008,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV009  PACK      PMARV009,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV010  PACK      PMARV010,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV011  PACK      PMARV011,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV012  PACK      PMARV012,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV013  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV013,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV014  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV014,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV015  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV015,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV016  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV016,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV017  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV017,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV018  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMARV018,CCENT,CYEAR,CMON,CDAY
          GOTO      SPMAV999
.
SPMAV019  PACK      PMARV019,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV020  PACK      PMARV020,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV021  PACK      PMARV021,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV022  PACK      PMARV022,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV023  PACK      PMARV023,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV024  PACK      PMARV024,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV025  PACK      PMARV025,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV026  PACK      PMARV026,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV027  PACK      PMARV027,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV028  PACK      PMARV028,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV029  PACK      PMARV029,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV030  PACK      PMARV030,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV031  PACK      PMARV031,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV032  PACK      PMARV032,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV033  PACK      PMARV033,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV034  PACK      PMARV034,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV035  PACK      PMARV035,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV036  PACK      PMARV036,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV037  PACK      PMARV037,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV038  PACK      PMARV038,QRYDATA,SP70
          GOTO      SPMAV999
.
SPMAV999  RETURN
.
.------------------------------------------------------------
.  Update admission request request file
.------------------------------------------------------------
MVPMAV00  MATCH     PMARV001,Z70
          IF        !@EQUAL
            MOVE      PMARV001,PMAVREQN
          ENDIF
.
          MATCH     PMARV002,Z70
          IF        !@EQUAL
            MOVE      PMARV002,PMAVRTYP
          ENDIF
.
          MATCH     PMARV003,Z70
          IF        !@EQUAL
            MOVE      PMARV003,PMAVCNTR
          ENDIF
.
          MATCH     PMARV004,Z70
          IF        !@EQUAL
            MOVE      PMARV004,PMAVDATR
          ENDIF
.
          MATCH     PMARV005,Z70
          IF        !@EQUAL
            MOVE      PMARV005,PMAVTIMR
          ENDIF
.
          MATCH     PMARV006,Z70
          IF        !@EQUAL
            MOVE      PMARV006,PMAVURNO
          ENDIF
.
          MATCH     PMARV007,Z70
          IF        !@EQUAL
            MOVE      PMARV007,PMAVVISN
          ENDIF
.
          MATCH     PMARV008,Z70
          IF        !@EQUAL
            MOVE      PMARV008,PMAVRSTA
          ENDIF
.
          MATCH     PMARV009,Z70
          IF        !@EQUAL
            MOVE      PMARV009,PMAVBTYP
          ENDIF
.
          MATCH     PMARV010,Z70
          IF        !@EQUAL
            MOVE      PMARV010,PMAVPSAH
          ENDIF
.
          MATCH     PMARV011,Z70
          IF        !@EQUAL
            MOVE      PMARV011,PMAVHOSP
          ENDIF
.
          MATCH     PMARV012,Z70
          IF        !@EQUAL
            SQUEEZE   PMARV012
            MOVE      ZERO,F4
            MOVE      PMARV012,F4
            MOVE      F4,PMAVASAS
          ENDIF
.
          MATCH     PMARV013,Z70
          IF        !@EQUAL
            MOVE      PMARV013,PMAVRSED
          ENDIF
.
          MATCH     PMARV014,Z70
          IF        !@EQUAL
            MOVE      PMARV014,PMAVDAT1
          ENDIF
.
          MATCH     PMARV015,Z70
          IF        !@EQUAL
            MOVE      PMARV015,PMAVDAT2
          ENDIF
.
          MATCH     PMARV016,Z70
          IF        !@EQUAL
            MOVE      PMARV016,PMAVDAT3
          ENDIF
.
          MATCH     PMARV017,Z70
          IF        !@EQUAL
            MOVE      PMARV017,PMAVDAT4
          ENDIF
.
          MATCH     PMARV018,Z70
          IF        !@EQUAL
            MOVE      PMARV018,PMAVDAT5
          ENDIF
.
          MATCH     PMARV019,Z70
          IF        !@EQUAL
            MOVE      PMARV019,PMAVTIM1
          ENDIF
.
          MATCH     PMARV020,Z70
          IF        !@EQUAL
            MOVE      PMARV020,PMAVTIM2
          ENDIF
.
          MATCH     PMARV021,Z70
          IF        !@EQUAL
            MOVE      PMARV021,PMAVTIM3
          ENDIF
.
          MATCH     PMARV022,Z70
          IF        !@EQUAL
            MOVE      PMARV022,PMAVTIM4
          ENDIF
.
          MATCH     PMARV023,Z70
          IF        !@EQUAL
            MOVE      PMARV023,PMAVTIM5
          ENDIF
.
          MATCH     PMARV024,Z70
          IF        !@EQUAL
            MOVE      PMARV024,PMAVYN01
          ENDIF
.
          MATCH     PMARV025,Z70
          IF        !@EQUAL
            MOVE      PMARV025,PMAVYN02
          ENDIF
.
          MATCH     PMARV026,Z70
          IF        !@EQUAL
            MOVE      PMARV026,PMAVYN03
          ENDIF
.
          MATCH     PMARV027,Z70
          IF        !@EQUAL
            MOVE      PMARV027,PMAVYN04
          ENDIF
.
          MATCH     PMARV028,Z70
          IF        !@EQUAL
            MOVE      PMARV028,PMAVYN05
          ENDIF
.
          MATCH     PMARV029,Z70
          IF        !@EQUAL
            MOVE      PMARV029,PMAVHCP1
          ENDIF
.
          MATCH     PMARV030,Z70
          IF        !@EQUAL
            MOVE      PMARV030,PMAVHCP2
          ENDIF
.
          MATCH     PMARV031,Z70
          IF        !@EQUAL
            MOVE      PMARV031,PMAVHCP3
          ENDIF
.
          MATCH     PMARV032,Z70
          IF        !@EQUAL
            MOVE      PMARV032,PMAVHCP4
          ENDIF
.
          MATCH     PMARV033,Z70
          IF        !@EQUAL
            MOVE      PMARV033,PMAVHCP5
          ENDIF
.
          MATCH     PMARV034,Z70
          IF        !@EQUAL
            MOVE      PMARV034,PMAVUDC1
          ENDIF
.
          MATCH     PMARV035,Z70
          IF        !@EQUAL
            MOVE      PMARV035,PMAVUDC2
          ENDIF
.
          MATCH     PMARV036,Z70
          IF        !@EQUAL
            MOVE      PMARV036,PMAVUDC3
          ENDIF
.
          MATCH     PMARV037,Z70
          IF        !@EQUAL
            MOVE      PMARV037,PMAVUDC4
          ENDIF
.
          MATCH     PMARV038,Z70
          IF        !@EQUAL
            MOVE      PMARV038,PMAVUDC5
          ENDIF
.
MVPMAV99  RETURN
.
.------------------------------------------------------------
. Select list of linked hospital for a HCP
.------------------------------------------------------------
PMAVHS00  MATCH     SP70,PMARRESC
          GOTO      PMAVHS99 IF EQUAL
.
          MOVE      ZERO,F1                 * Hospital on file not displayed
          CALL      IBACLOCK
          PACK      DIM8,CCC,CYY,CMM,CDD
          REP       " 0",DIM8
.
          PACK      KEY10,PMARRESC,SP70
          CALL      RDPMHCP1
          BRANCH    OVRCD,PMAVHS99
.
          MATCH     "1",PMHCHOSS            * Hospital Specific HCP
          GOTO      PMAVHS50 IF NOT EQUAL
.
          PACK      KEY13,PMARRESC,SP70
          CALL      RSMLHCP2                * positional read
PMAVHS10  CALL      RKMLHCP2                * read a record
          BRANCH    OVRCD,PMAVHS90
.
          MATCH     MLHCHCPC,PMARRESC
          GOTO      PMAVHS90 IF NOT EQUAL
.
          MATCH     "1",MLHCACTV            * skip inactive codes
          GOTO      PMAVHS10 IF EQUAL
.
          MATCH     MLHCSDAT,DIM8
          GOTO      PMAVHS10 IF LESS
.
          MATCH     SP70,MLHCEDAT
          IF        !@EQUAL & !@EOS
            MATCH     DIM8,MLHCEDAT
            GOTO      PMAVHS10 IF LESS
          ENDIF
.
          PACK      KEY3,MLHCHOSP,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMAVHS10
.
          MATCH     PTHSHOSP,DIM3
          IF        @EQUAL
            MOVE      ONE,F1                * Hospital on file displayed
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                               PTHSNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#">":
                               PTHSNAME,"</option>"
          ENDIF
          GOTO      PMAVHS10
.
PMAVHS50  PACK      KEY3,SP70
          CALL      RSPTHSP1                * positional read
PMAVHS60  CALL      RKPTHSP1                * read a record
          BRANCH    OVRCD,PMAVHS90
.
          MATCH     PTHSHOSP,DIM3
          IF        @EQUAL
            MOVE      ONE,F1                * Hospital on file displayed
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                               PTHSNAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#">":
                               PTHSNAME,"</option>"
          ENDIF
.
          GOTO      PMAVHS60
.
PMAVHS90  BRANCH    F1,PMAVHS99             * Has hospital on file been listed
.
          PACK      KEY3,DIM3,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,PMAVHS99
.
          WRITE     HTMLFILE;"<option value=#"",PTHSHOSP,"#" selected>":
                             PTHSNAME,"</option>"
.
PMAVHS99  RETURN
