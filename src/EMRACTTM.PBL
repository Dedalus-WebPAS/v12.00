. *----------------------------------------------------------------------
. * Include Name  :   EMRACTTM.PBL
. *
. * Function      :   CGI Variables for EMRACTFD - emractaf
. *
. * Mods          :
. *
. *       V11.02.01 01.04.2022 DA Sarkies        TSK 0918429 
. *                Fixed malformed code by removing SP70
. *       V11.01.01 20/05/2021 Tony Hui          TSK 0905305 
. *                Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------------------
. Clear CGI Variables 
.------------------------------------------------------------------------
CLEMAT00  MOVE      Z70,EMACT001
          MOVE      Z70,EMACT002
          MOVE      Z70,EMACT003
          MOVE      Z70,EMACT004
          MOVE      Z70,EMACT005
          MOVE      Z70,EMACT006
          MOVE      Z70,EMACT007
          MOVE      Z70,EMACT008
          MOVE      Z70,EMACT009
          MOVE      Z70,EMACT010
          MOVE      Z70,EMACT011
          MOVE      Z70,EMACT012
          MOVE      Z70,EMACT013
          MOVE      Z70,EMACT014
.
CLEMAT99  RETURN
.
.------------------------------------------------------------
. Set CGI Variables for AAEC Co-Efficient Codes Maintenance
.------------------------------------------------------------
SPEMAT00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPEMAT01,SPEMAT02,SPEMAT03,SPEMAT04,SPEMAT05:
                       SPEMAT06,SPEMAT07,SPEMAT08,SPEMAT09,SPEMAT10:
                       SPEMAT11,SPEMAT12,SPEMAT13,SPEMAT14
          GOTO      SPEMAT99
.
SPEMAT01  PACK      EMACT001,QRYDATA,SP70
          GOTO      SPEMAT99
.
SPEMAT02  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMACT002,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEMAT99
.
SPEMAT03  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      EMACT003,CCENT,CYEAR,CMON,CDAY
          GOTO      SPEMAT99
.
SPEMAT04  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT004
          GOTO      SPEMAT99
.
SPEMAT05  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT005
          GOTO      SPEMAT99
.
SPEMAT06  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT006
          GOTO      SPEMAT99
.
SPEMAT07  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT007
          GOTO      SPEMAT99
.
SPEMAT08  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT008
          GOTO      SPEMAT99
.
SPEMAT09  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT009
          GOTO      SPEMAT99
.
SPEMAT10  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT010
          GOTO      SPEMAT99
.
SPEMAT11  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT011
          GOTO      SPEMAT99
.
SPEMAT12  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT012
          GOTO      SPEMAT99
.
SPEMAT13  SQUEEZE   QRYDATA
          MOVE      ZERO,F3P6
          MOVE      QRYDATA,F3P6
          MOVE      F3P6,EMACT013
          GOTO      SPEMAT99
.
SPEMAT14  PACK      EMACT014,QRYDATA,SP70
          GOTO      SPEMAT99
.
SPEMAT99  RETURN
.
.------------------------------------------------------
. Output Tags for AAEC Co-Efficient Codes Maintenance
.------------------------------------------------------
EMAT0000  BRANCH    FLDITMNO,EMAT0010,EMAT0020,EMAT0030,EMAT0040,EMAT0050:
			     EMAT0060,EMAT0070,EMAT0080,EMAT0090,EMAT0100:
                             EMAT0110,EMAT0120,EMAT0130,EMAT0140,EMAT0150:
                             EMAT0160,EMAT0170,EMAT0180,EMAT0190,EMAT0200:
                             EMAT0205
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      EMAT9999
.
EMAT0010  WRITE     HTMLFILE;EMATCODE;
          GOTO      EMAT9999
.
EMAT0020  MATCH     EMATFDAT,SP70
          GOTO      EMAT9999 IF EQUAL
.
	  UNPACK    EMATFDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAT9999
.
EMAT0030  MATCH     EMATTDAT,SP70
	  GOTO      EMAT9999 IF EQUAL
.
	  UNPACK    EMATTDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAT9999
.
EMAT0040  WRITE     HTMLFILE;EMATADMF;
          GOTO      EMAT9999
.
EMAT0050  WRITE     HTMLFILE;EMATDSDC;
	  GOTO      EMAT9999
.
EMAT0060  WRITE     HTMLFILE;EMATRABA;
          GOTO      EMAT9999
.
EMAT0070  WRITE     HTMLFILE;EMATRTAH;
          GOTO      EMAT9999
.
EMAT0080  WRITE     HTMLFILE;EMATABAM;
          GOTO      EMAT9999
.
EMAT0090  WRITE     HTMLFILE;EMATTCT1;
          GOTO      EMAT9999
.
EMAT0100  WRITE     HTMLFILE;EMATTCT2;
          GOTO      EMAT9999
.
EMAT0110  WRITE     HTMLFILE;EMATTCT3;
          GOTO      EMAT9999
.
EMAT0120  WRITE     HTMLFILE;EMATTCT4;
          GOTO      EMAT9999
.
EMAT0130  WRITE     HTMLFILE;EMATTCT5;
          GOTO      EMAT9999
.
EMAT0140  MATCH     EMATCDAT,SP70
          GOTO      EMAT9999 IF EQUAL
.
          UNPACK    EMATCDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAT9999
.
EMAT0150  WRITE     HTMLFILE;EMATCTIM;
          GOTO      EMAT9999
.
EMAT0160  MATCH     SP70,EMATCUID
          GOTO      EMAT9999 IF EQUAL
.
          PACK      KEY10,EMATCUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMATCUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMAT9999 
.
EMAT0170  MATCH     EMATUDAT,SP70
          GOTO      EMAT9999 IF EQUAL
.
          UNPACK    EMATUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      EMAT9999
.
EMAT0180  WRITE     HTMLFILE;EMATUTIM;
          GOTO      EMAT9999
.
EMAT0190  MATCH     SP70,EMATUUID
          GOTO      EMAT9999 IF EQUAL
.
          PACK      KEY10,EMATUUID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      EMATUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
          GOTO      EMAT9999
.
EMAT0200  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,EMAT0205
.
          MATCH     "1",EMATAFLG
          IF        @EQUAL
            WRITE     HTMLFILE;"Inactive";
          ELSE
            WRITE     HTMLFILE;"Active";
          ENDIF
.
EMAT0205  WRITE     HTMLFILE;EMATAFLG;
          GOTO      EMAT9999 
.
EMAT9999  RETURN
.
.--------------------------------------------------------------
. Update File Variables for AAEC Co-Efficient Codes Maintenance
.--------------------------------------------------------------
MVEMAT00  MATCH     Z70,EMACT001
          IF        !@EQUAL
            MOVE      EMACT001,EMATCODE
          ENDIF       
.
          MATCH     Z70,EMACT002
          IF        !@EQUAL
            MOVE      EMACT002,EMATFDAT
          ENDIF
.
          MATCH     Z70,EMACT003
          IF        !@EQUAL
            MOVE      EMACT003,EMATTDAT
          ENDIF
.
          MATCH     Z70,EMACT004
          IF        !@EQUAL
            MOVE      EMACT004,EMATADMF
          ENDIF
.
          MATCH     Z70,EMACT005
          IF        !@EQUAL
            MOVE      EMACT005,EMATDSDC
          ENDIF
.
          MATCH     Z70,EMACT006
          IF        !@EQUAL
            MOVE      EMACT006,EMATRABA
          ENDIF
.
          MATCH     Z70,EMACT007
          IF        !@EQUAL
            MOVE      EMACT007,EMATRTAH
          ENDIF
.
          MATCH     Z70,EMACT008
          IF        !@EQUAL
            MOVE      EMACT008,EMATABAM
          ENDIF
.
          MATCH     Z70,EMACT009
          IF        !@EQUAL
            MOVE      EMACT009,EMATTCT1
          ENDIF
.
          MATCH     Z70,EMACT010
          IF        !@EQUAL
            MOVE      EMACT010,EMATTCT2
          ENDIF
.
          MATCH     Z70,EMACT011
          IF        !@EQUAL
            MOVE      EMACT011,EMATTCT3
          ENDIF
.
          MATCH     Z70,EMACT012
          IF        !@EQUAL
            MOVE      EMACT012,EMATTCT4
          ENDIF
.
          MATCH     Z70,EMACT013
          IF        !@EQUAL
            MOVE      EMACT013,EMATTCT5
          ENDIF
.
          MATCH     Z70,EMACT014
          IF        !@EQUAL
            MOVE      EMACT014,EMATAFLG
          ENDIF
.
MVEMAT99  RETURN
