.
. PATFIMIO    
. --------
. Filename     : patfimaf.dat
.
RSPTFIM1  RESET     KEY24                                                       
          READ      PATFIMA1,KEY24;;                                            
          RETURN
.
RAPTFIM1  RESET     KEY24                                                       
          MOVE      ZERO,OVRCD
          READ      PATFIMA1,KEY24;ANS                                          
          GOTO      OVERCOND IF OVER
          RETURN
.
RDPTFIM1  RESET     KEY24                                                       
          MOVE      ZERO,OVRCD
          READ      PATFIMA1,KEY24;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      OVERCOND IF OVER
          RETURN
.
RKPTFIM1  MOVE      ZERO,OVRCD                                                  
          READKS    PATFIMA1;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:      
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      OVERCOND IF OVER
          RETURN
.
RPPTFIM1  MOVE      ZERO,OVRCD                                                  
          READKP    PATFIMA1;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:      
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      OVERCOND IF OVER
          RETURN
.
UPPTFIM1  MOVE      ZERO,OVRCD                                                  
          UPDATE    PATFIMA1;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:      
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      UPDFLOCK IF LOCKED
          RETURN
.
WRPTFIM1  RESET     KEY24                                                       
          WRITE     PATFIMA1,KEY24;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          RETURN
.
DEPTFIM1  RESET     KEY24                                                       
          DELETE    PATFIMA1,KEY24                                              
          RETURN
.
RLPTFIM1  RESET     KEY24                                                       
          MOVE      ZERO,OVRCD
          READL     PATFIMA1,KEY24;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
KLPTFIM1  MOVE      ZERO,OVRCD                                                  
          READLKS   PATFIMA1;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:      
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
PLPTFIM1  MOVE      ZERO,OVRCD                                                  
          READLKP   PATFIMA1;PTFIVISN,PTFIDATE,PTFITIME,PTFITYPE,PTFIEATS:      
                        PTFIEATG,PTFIEATC,PTFIGRMS,PTFIGRMG,PTFIGRMC,PTFIBTHS:  
                        PTFIBTHG,PTFIBTHC,PTFIUPBS,PTFIUPBG,PTFIUPBC,PTFILWBS:  
                        PTFILWBG,PTFILWBC,PTFITLTS,PTFITLTG,PTFITLTC,PTFIBLMS:  
                        PTFIBLMG,PTFIBLMC,PTFIBWMS,PTFIBWMG,PTFIBWMC,PTFITBDS:  
                        PTFITBDG,PTFITBDC,PTFITTLS,PTFITTLG,PTFITTLC,PTFITBTS:  
                        PTFITBTG,PTFITBTC,PTFILOCD,PTFILOCS,PTFILOCG,PTFILOCC:  
                        PTFISTRS,PTFISTRG,PTFISTRC,PTFICOCD,PTFICOMS,PTFICOMG:  
                        PTFICOMC,PTFIEXCD,PTFIEXPS,PTFIEXPG,PTFIEXPC,PTFISCIS:  
                        PTFISCIG,PTFISCIC,PTFIPRBS,PTFIPRBG,PTFIPRBC,PTFIMEMS:  
                        PTFIMEMG,PTFIMEMC,PTFIASES,PTFIASCD,PTFIASDN,PTFINSCD:  
                        PTFINSID,PTFINSDT,PTFINSTM,PTFIPHCD,PTFIPHDT,PTFIPHTM:  
                        PTFIOTCD,PTFIOTDT,PTFIOTTM,PTFIDELT,PTFICUID,PTFICDAT:  
                        PTFICTIM,PTFIUUID,PTFIUDAT,PTFIUTIM,PTFIDUID,PTFIDDAT:  
                        PTFIDTIM,PTFIIMPC,PTFICPLT,PTFIFUID,PTFIFDTE,PTFIFTME:  
                        PTFIDRES,PTFISPAR                                       
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
UUPTFIM1  RESET     KEY24                                                       
          UNLOCK    PATFIMA1                                                    
          RETURN
.
