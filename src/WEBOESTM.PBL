. Modifications
.   V11.00.01 24/08/2020 Peter Vela    TSK 0895969
.             Created Include
.
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
WBOS0000  BRANCH    FLDITMNO,WBOS0100,WBOS0200,WBOS0300,WBOS0400,WBOS0500:
                             WBOS0600,WBOS0700,WBOS0800,WBOS0900,WBOS1000:
                             WBOS1100,WBOS1200,WBOS1300,WBOS1400,WBOS1500:
                             WBOS1600,WBOS1700,WBOS1800,WBOS1900,WBOS2000:
                             WBOS2100,WBOS2200,WBOS2300,WBOS2400,WBOS2500:
                             WBOS2600,WBOS2700,WBOS2800,WBOS2900,WBOS3000:
                             WBOS3100,WBOS3200,WBOS3300,WBOS3400,WBOS3500:
                             WBOS3600,WBOS3700,WBOS3800,WBOS3900,WBOS4000:
                             WBOS4100,WBOS4200,WBOS4300,WBOS4400,WBOS4500

          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      WBOS9999
.
WBOS0100  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSVISN;
          GOTO      WBOS9999
.
WBOS0200  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCNTR;
          GOTO      WBOS9999
.
WBOS0300  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSSCNT;
          GOTO      WBOS9999
.
WBOS0400  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSRTYP;
          GOTO      WBOS9999
.
WBOS0500  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSITEM;
          GOTO      WBOS9999
.
WBOS0600  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSQUAN;
          GOTO      WBOS9999
.
WBOS0700  MOVE      "  1",KEY3
          CALL      RWES0000
          UNPACK    WBOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSPDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS0800  MOVE      "  1",KEY3
          CALL      RWES0000
          UNPACK    WBOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSCDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS0900  MOVE      "  1",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCTIM;
          GOTO      WBOS9999
.
WBOS1000  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSVISN;
          GOTO      WBOS9999
.
WBOS1100  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCNTR;
          GOTO      WBOS9999
.
WBOS1200  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSSCNT;
          GOTO      WBOS9999
.
WBOS1300  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSRTYP;
          GOTO      WBOS9999
.
WBOS1400  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSITEM;
          GOTO      WBOS9999
.
WBOS1500  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSQUAN;
          GOTO      WBOS9999
.
WBOS1600  MOVE      "  2",KEY3
          CALL      RWES0000
          UNPACK    WBOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSPDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS1700  MOVE      "  2",KEY3
          CALL      RWES0000
          UNPACK    WBOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSCDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS1800  MOVE      "  2",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCTIM;
          GOTO      WBOS9999
.
WBOS1900  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSVISN;
          GOTO      WBOS9999
.
WBOS2000  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCNTR;
          GOTO      WBOS9999
.
WBOS2100  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSSCNT;
          GOTO      WBOS9999
.
WBOS2200  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSRTYP;
          GOTO      WBOS9999
.
WBOS2300  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSITEM;
          GOTO      WBOS9999
.
WBOS2400  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSQUAN;
          GOTO      WBOS9999
.
WBOS2500  MOVE      "  3",KEY3
          CALL      RWES0000
          UNPACK    WBOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSPDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS2600  MOVE      "  3",KEY3
          CALL      RWES0000
          UNPACK    WBOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSCDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS2700  MOVE      "  3",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCTIM;
          GOTO      WBOS9999
.
WBOS2800  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSVISN;
          GOTO      WBOS9999
.
WBOS2900  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCNTR;
          GOTO      WBOS9999
.
WBOS3000  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSSCNT;
          GOTO      WBOS9999
.
WBOS3100  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSRTYP;
          GOTO      WBOS9999
.
WBOS3200  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSITEM;
          GOTO      WBOS9999
.
WBOS3300  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSQUAN;
          GOTO      WBOS9999
.
WBOS3400  MOVE      "  4",KEY3
          CALL      RWES0000
          UNPACK    WBOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSPDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS3500  MOVE      "  4",KEY3
          CALL      RWES0000
          UNPACK    WBOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSCDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS3600  MOVE      "  4",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCTIM;
          GOTO      WBOS9999
.
WBOS3700  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSVISN;
          GOTO      WBOS9999
.
WBOS3800  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCNTR;
          GOTO      WBOS9999
.
WBOS3900  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSSCNT;
          GOTO      WBOS9999
.
WBOS4000  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSRTYP;
          GOTO      WBOS9999
.
WBOS4100  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSITEM;
          GOTO      WBOS9999
.
WBOS4200  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSQUAN;
          GOTO      WBOS9999
.
WBOS4300  MOVE      "  5",KEY3
          CALL      RWES0000
          UNPACK    WBOSPDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSPDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS4400  MOVE      "  5",KEY3
          CALL      RWES0000
          UNPACK    WBOSCDTE,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,WBOSCDTE
          GOTO      WBOS9999 IF EQUAL
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WBOS9999
.
WBOS4500  MOVE      "  5",KEY3
          CALL      RWES0000
          WRITE     HTMLFILE;WBOSCTIM;
          GOTO      WBOS9999
.
WBOS9999  RETURN
.
.------------------------------------------------------------
.   Read pmsoesaf file with report counter input
.------------------------------------------------------------
RWES0000  PACK      KEY11,ADMISSNO,KEY3,SP70
          CALL      RDWBOES1
          IF        OVRCD=1
            CALL      CLWEBOES
          ENDIF
.
RWES9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for weboecaf file
.------------------------------------------------------------
SWBOS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY3A,KEY2,KEY3
          MOVE      KEY2,F2
          MOVE      KEY3,F3
          BRANCH    F3,SWBOS010,SWBOS020,SWBOS030,SWBOS040,SWBOS050:
                       SWBOS060,SWBOS070,SWBOS080,SWBOS090
.                      
          MOVE      ONE,EXIT
          GOTO      SWBOS999
.
SWBOS010  MOVE      QRYDATA,WEBOS001[F2]
          GOTO      SWBOS999
.
SWBOS020  MOVE      QRYDATA,WEBOS002[F2]
          GOTO      SWBOS999
.
SWBOS030  MOVE      QRYDATA,WEBOS003[F2]
          GOTO      SWBOS999
.
SWBOS040  MOVE      QRYDATA,WEBOS004[F2]
          GOTO      SWBOS999
.
SWBOS050  MOVE      QRYDATA,WEBOS005[F2]
          GOTO      SWBOS999
.
SWBOS060  MOVE      QRYDATA,WEBOS006[F2]
          GOTO      SWBOS999
.
SWBOS070  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOS007[F2],CCENT,CYEAR,CMON,CDAY
          GOTO      SWBOS999
.
SWBOS080  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      WEBOS008[F2],CCENT,CYEAR,CMON,CDAY
          GOTO      SWBOS999
.
SWBOS090  MOVE      QRYDATA,WEBOS009[F2]
          GOTO      SWBOS999
.
SWBOS999  RETURN
.
.------------------------------------------------------------
.   Clear Parameters 
.------------------------------------------------------------
CWBOS000  MOVE      ONE,F2
.
          WHILE     F2 <= 50
            MOVE      Z70,WEBOS001[F2]
            MOVE      Z70,WEBOS002[F2]
            MOVE      Z70,WEBOS003[F2]
            MOVE      Z70,WEBOS004[F2]
            MOVE      Z70,WEBOS005[F2]
            MOVE      Z70,WEBOS006[F2]
            MOVE      Z70,WEBOS007[F2]
            MOVE      Z70,WEBOS008[F2]
            MOVE      Z70,WEBOS009[F2]
            ADD       ONE,F2
          DO
.
          RETURN
.
.------------------------------------------------------------
.  Update 
.------------------------------------------------------------
UPWBOS00  MATCH     WEBOS001[F2],Z70  
          IF        !@EQUAL
            MOVE      WEBOS001[F2],WBOSVISN
          ENDIF
.
          MATCH     WEBOS002[F2],Z70
          IF        !@EQUAL
            MOVE      WEBOS002[F2],WBOSCNTR
          ENDIF
.
          MATCH     WEBOS003[F2],Z70   
          IF        !@EQUAL
            MOVE      WEBOS003[F2],WBOSSCNT
          ENDIF
.
          MATCH     WEBOS004[F2],Z70
          IF        !@EQUAL
            MOVE      WEBOS004[F2],WBOSRTYP
          ENDIF
.
          MATCH     WEBOS005[F2],Z70
          IF        !@EQUAL
            MOVE      WEBOS005[F2],WBOSITEM
          ENDIF
.
          MATCH     WEBOS006[F2],Z70   
          IF        !@EQUAL
            MOVE      WEBOS006[F2],WBOSQUAN
          ENDIF
.
          MATCH     WEBOS007[F2],Z70
          IF        !@EQUAL
            MOVE      WEBOS007[F2],WBOSPDTE
          ENDIF
.
          MATCH     WEBOS008[F2],Z70
          IF        !@EQUAL
            MOVE      WEBOS008[F2],WBOSCDTE
          ENDIF
.
          MATCH     WEBOS009[F2],Z70
          IF        !@EQUAL
            MOVE      WEBOS009[F2],WBOSCTIM
          ENDIF
.
UPWBOS99  RETURN
+
