.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.03.01 08.03.2013 Sandra Barcham  281021
.           Stopped unpacking SP70
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 14.11.2000 Charles Handaya
.           Recompiled for SINCIAKY changes
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.01  20.06.2000 Sandra Barcham
.           Fix problem displaying catalogs
.-------------------------------------------------------
. VF.00.02  12.01.2000 Charles Handaya
.           Packed KEYs with SP70
.           05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           10.11.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.01  02.11.1999 Sandra Barcham
.           Change locked message to use X
.-------------------------------------------------------
ENDCST    DIM       5
STRCST    DIM       5
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN07
.   Function      :   Imprest Maintenance                     
.   Generated  On :   08/03/2013
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIFFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINIMPFD/INC
          INC       SINNATFD/INC
          INC       SINTMPDF/INC
.=========================
.Local Variable Definition
.-------------------------
WHOLEQTY  FORM     12 * Scr 00 Fld     4
UDC1DESC  DIM      30 * Scr 00 Fld    24
UDC2DESC  DIM      30 * Scr 00 Fld    25
FROMCST   DIM      40 * Scr 02 Fld    12
TOCST     DIM      40 * Scr 02 Fld    13
SEQUNUM   DIM       4 * Scr 02 Fld    14
CONFIRM   FORM      1 * Scr 02 Fld    16
ORIGCATA  DIM       7 * Scr 03 Fld     1
REPLCATA  DIM       7 * Scr 03 Fld     2
ORIGDESC  DIM      60 * Scr 03 Fld     3
REPLDESC  DIM      60 * Scr 03 Fld     4
.
.    Multi Item Key Fields Scr 04 Fld     4
.-------------------------------------------------------
SIIM2NAM  INIT      "SIIM2"
SIIM2LEN  FORM      "125"
SIIM2IDX  INIT      "DC1-5 UC6-10"
SIIM2FNM  DIM       8  * Filename
SIIM2AFL  FORM      1  * End Accept Mode
SIIM2END  FORM      1  * End Display
SIIM2SNO  FORM      5  * Number of Items on the Screen
SIIM2NXT  DIM         10
SIIM2FL1  IFILE     SQL, FIXED=125,  KEY="D1-5"
SIIM2FL2  IFILE     SQL, FIXED=125, KEY="U6-10"
SIIM2CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN07"
PRGNAM    INIT      "Imprest Maintenance                     "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC01L000
          CLOSE     SIIM2FL2
          CLOSE     SIIM2FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   24",AUDTSECT
          MOVE      "204",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudim";
            OPEN      SINAUDIM,"sinaudim"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA1,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA2,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA3,"sinimpaf"
.--------------------------------------------------------
. Initialise Batch Screen Cost Centre                        
.--------------------------------------------------------
          MOVE     ZERO,SIIM2SNO
          MOVE     "04    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIM2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Imprest Maintenance                
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Menu                               
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Delete Catalog from a range        
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Replace Catalog on All Imprests    
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Add a Catalog to a range of Cost Ce
          ENDIF
          RETURN
.--------------------------------
. Screen - Imprest Maintenance                
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Imprest Maintenance                
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,SIIMCST 
          MOVE      SP70,SIIMCAT 
          MOVE      SP70,SIIMSEQ 
          MOVE      ZERO,WHOLEQTY
          MOVE      SP70,SIIMUR1 
          MOVE      SP70,SIIMUR2 
          MOVE      SP70,SIIMUD1 
          MOVE      SP70,SIIMUD2 
          MOVE      SP70,SIIMUC1 
          MOVE      SP70,SIIMUC2 
          MOVE      SP70,SIIMUY1 
          MOVE      SP70,SIIMUY2 
          MOVE      SP70,SICADESC
          MOVE      SP70,SICATELE
          MOVE      SP70,SICACONT
          MOVE      SP70,SICAIMPD
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIAISS 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Imprest Maintenance                
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SICADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIMCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY00L120
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIAISS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ECATA000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      SIIMCAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Imprest Maintenance                
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Imprest Maintenance                
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Imprest Maintenance                
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Imprest Maintenance                
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L110:
                            PS00L111,PS00L112,PS00L113,PS00L114:
                            PS00L115,PS00L116,PS00L117,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L118:
                            PS00L119
          GOTO     PS00L999
.
PS00L101
          MOVE      SIIMSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SIIMUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SIIMUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SIIMUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SIIMUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIMUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIMUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      SICAIMPD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Imprest Maintenance                
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L101,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L110:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L111,SF00L112,SF00L113,SF00L006:
                            SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L101,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L110:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,SIIMSEQ: 
                    *PCCOL:CVERT
          ENDSET    SIIMSEQ 
          CMATCH    EXITCHAR,SIIMSEQ 
          GOTO      SF00L990 IF EQUAL
          RESET     SIIMSEQ 
          IF        SCPSMAN=1
            MATCH     SP70,SIIMSEQ 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
          ENDIF
          MOVE      SIIMSEQ,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMAX0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL     SELECTED
          STRIP     SIIMUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIMUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIMUR1 
          SFORMAT   VAR,127
          ENDSET    SIIMUR1 
          APPEND    SP70,SIIMUR1 
          RESET     SIIMUR1 
          CMATCH    EXITCHAR,SIIMUR1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIMUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
          ENDIF
          MOVE      SIIMUR1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          STRIP     SIIMUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIMUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIMUR2 
          SFORMAT   VAR,127
          ENDSET    SIIMUR2 
          APPEND    SP70,SIIMUR2 
          RESET     SIIMUR2 
          CMATCH    EXITCHAR,SIIMUR2 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIMUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
          ENDIF
          MOVE      SIIMUR2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIIMUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIIMUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIIMUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIIMUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUDC1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIIMUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUDC2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIIMUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIMUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIMUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIMUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIMUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L112
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L113
          CALL      CANC0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Menu                               
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Menu                               
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Menu                               
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Menu                               
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Menu                               
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Menu                               
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Menu                               
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Menu                               
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L105
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL      SC00L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L105
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Delete Catalog from a range        
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Delete Catalog from a range        
.-------------------------------------------------------
CF02L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,FROMCST 
          MOVE      SP70,TOCST   
          MOVE      SP70,SEQUNUM 
          MOVE      ZERO,WHOLEQTY
          MOVE      ZERO,CONFIRM 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Delete Catalog from a range        
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "1",CKEYTYP
          CALL      GCATA000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ONE,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Delete Catalog from a range        
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Delete Catalog from a range        
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Delete Catalog from a range        
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Delete Catalog from a range        
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L101,PS02L102:
                            PS02L103,PS02L104,PS02L105,PS02L106
          GOTO     PS02L999
.
PS02L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      TOCST,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SEQUNUM,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CONFIRM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Delete Catalog from a range        
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L104:
                            SF02L006,SF02L105,SF02L106,SF02L107
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L104:
                            SF02L020,SF02L105,SF02L106,SF02L107
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      PALL0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DALL0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L104
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCST   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCST,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L105
          CALL     SELECTED
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,SEQUNUM: 
                    *PCCOL:CVERT
          ENDSET    SEQUNUM 
          CMATCH    EXITCHAR,SEQUNUM 
          GOTO      SF02L990 IF EQUAL
          RESET     SEQUNUM 
          IF        SCPSMAN=1
            MATCH     SP70,SEQUNUM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
          ENDIF
          MOVE      SEQUNUM,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMAX0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
            BRANCH    EXIT,SF02L106,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L107
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CONFIRM 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CONFIRM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Replace Catalog on All Imprests    
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Replace Catalog on All Imprests    
.-------------------------------------------------------
CF03L000  COMPARE   ZERO,ACCEPT
              GOTO      CF03L999 IF EQUAL
          MOVE      SP70,ORIGCATA
          MOVE      SP70,REPLCATA
          MOVE      SP70,ORIGDESC
          MOVE      SP70,REPLDESC
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Replace Catalog on All Imprests    
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ORIGDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KORGC000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      ORIGCATA,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ORIGDESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY03L120
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,REPLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KREPC000
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      REPLCATA,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      REPLDESC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Replace Catalog on All Imprests    
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Replace Catalog on All Imprests    
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Replace Catalog on All Imprests    
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Replace Catalog on All Imprests    
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      ORIGDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      REPLDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Replace Catalog on All Imprests    
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L101:
                            SF03L102
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      REPLC000
          MOVE      ONE,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Add a Catalog to a range of Cost Ce
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Add a Catalog to a range of Cost Ce
.-------------------------------------------------------
CF04L000  COMPARE   ZERO,ACCEPT
              GOTO      CF04L999 IF EQUAL
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIAISS 
          MOVE      SP70,SIIMCST 
          MOVE      SP70,SICADESC
          MOVE      SP70,SIIMSEQ 
          MOVE      ZERO,WHOLEQTY
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Add a Catalog to a range of Cost Ce
.--------------------------------------------------------
KY04L000
.
KY04L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIAISS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATA000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     4 Cost Centre                        
.---------------------------------------------------------
          UNPACK    SP70,SIIMCAT,SIIMCST
          PACK      SIIM2FNM,ANST,SIIM2NAM,PORT
          REP       " 0",SIIM2FNM
          MOVE      ZERO,SIIM2AFL
          CLOSE     SIIM2FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIM2FL1,SIIM2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIM2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIM2FNM,SP1,SIIM2LEN,SP1,SIIM2IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      SIIM2FL1,SIIM2FNM
          OPEN      SIIM2FL2,SIIM2FNM
          PACK      KEY12,SIIACAT,SP70
          MOVE      KEY12,SAVKEY80
          SETLPTR   SAVKEY80,7 
          CALL      RDSIIM2 
          IF        OVRCD=0
            CALL      RPSIIM2 
          ENDIF
LM04L100
          CALL      RKSIIM2 
          BRANCH    OVRCD,LM04L105
          PACK      KEY12,SIIMCAT,SIIMCST
          MATCH     SAVKEY80,KEY12   
          GOTO      LM04L105 IF NOT EQUAL
          RESET     KEY12,8
          MOVE      KEY12,KEY5
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TASIIM22
          IF        OVRCD=0
            CALL      TUSIIM22
          ELSE
            CALL      TWSIIM22
          ENDIF
          GOTO     LM04L100
LM04L105
          MOVE     SP70,KEY5   
          CALL     TSSIIM22
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
SM04L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM04L010 IF EQUAL
SM04L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM04L010,SM04L010,SM04L010,SM04L101:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010
SM04L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM04L007
          MATCH     PRGID,SCPSPID
          GOTO      SM04L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM04L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM04L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM04L006 IF NOT EQUAL
          GOTO      SM04L005
SM04L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM04L010
          BRANCH    STDGSFLG,SM04L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM04L900
          MATCH     PRGID,SCPSPID
          GOTO      SM04L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM04L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM04L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM04L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L102,SM04L103,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010
          GOTO      SM04L010
.
SM04L101
          MOVE     ZERO,SIIM2AFL
          CALL      KSICAA00
          MOVE      SICACODE,SIIMCST
          BRANCH    EXIT,SM04L990,SM04L990
          PACK     KEY12,SIIMCAT,SIIMCST                                                           
          RESET    KEY12,8
          MOVE     KEY12,KEY5
          CALL      TASIIM22
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM04L101
          ENDIF
          CALL      REDITM00
          MOVE      SIIMCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM04L010
.
SM04L102
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,SIIMSEQ: 
                    *PCCOL:CVERT
          ENDSET    SIIMSEQ 
          CMATCH    EXITCHAR,SIIMSEQ 
          GOTO      SM04L990 IF EQUAL
          RESET     SIIMSEQ 
          IF        SCPSMAN=1
            MATCH     SP70,SIIMSEQ 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM04L102
            ENDIF
          ENDIF
          MOVE      SIIMSEQ,VAR      
          CALL      DISPITEM
          GOTO     SM04L010
.
SM04L103
          MOVE      "0",CKEYTYP
          CALL      EMAX0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM04L103
            ENDIF
            BRANCH    EXIT,SM04L103,SM04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM04L990 IF EQUAL
          ENDIF
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     SM04L010
SM04L900
          MATCH    "SIIM2",NAMSSFFI
          IF       @EQUAL
            PACK     KEY12,SIIMCAT,SIIMCST
            RESET    KEY12,8
            MOVE     KEY12,KEY5
            CALL      TASIIM22
            IF        OVRCD=0
              CALL      TUSIIM22
            ELSE
              CALL      TWSIIM22
            ENDIF
            GOTO      SM04L999
          ENDIF
          GOTO      SM04L999
SM04L990
          MATCH    "SIIM2",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,SIIM2AFL
          ENDIF
SM04L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,SIIM2CNT
          MOVE     ZERO,SIIM2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L101:
                            DP04L102,DP04L103,DP04L104,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010
          GOTO      DP04L010
.
DP04L101
          IF        SIIM2END=0
            CALL      TKSIIM22
            IF        OVRCD=1
              MOVE      ONE,SIIM2END
            ELSE
              MOVE      ZERO,SIIM2END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUSIIM22
          CALL      REDITM00
              MOVE      SIIMCST,VAR      
              CALL      DISPITEM
            ENDIF
          ENDIF
          IF        SIIM2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        SIIM2END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        SIIM2END=0
            MOVE      SIIMSEQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        SIIM2END=0
            MOVE      WHOLEQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "SIIM2",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          CALL     CT04L000
          MATCH    "SIIM2",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          MOVE     SP70,KEY5   
          CALL     TSSIIM22 * Start
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          CALL     CT04L000
          MATCH    "SIIM2",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY5,Z70
          CALL     TSSIIM22
          IF       OVRCD=1
            CALL     TPSIIM22 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIM2SNO
            CALL     TPSIIM22
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
PP04L100
          MATCH    "SIIM2",NAMSSFFI
          GOTO     PP04L115 IF NOT EQUAL
PP04L105
          MOVE     SP70,SIIM2NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIIM21
          CALL     TKSIIM21 * First on Page
          MOVE     KEY5,SIIM2NXT
          CALL     TSSIIM22
          CALL     TPSIIM22 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP04L999
          ENDIF
.
          CALL     CT04L000
.
. Position and Display Page
.--------------------------
PP04L110
          MOVE     SIIM2NXT,KEY5   
          CALL     TSSIIM22
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIM2SNO
            CALL     TPSIIM22
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "SIIM2",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          MOVE     SP70,SIIM2NXT
          PACK     KEY5,Z70
          CALL     TSSIIM21
          CALL     TPSIIM21
          MOVE     KEY5,SIIM2NXT
          CALL     TSSIIM22
          CALL     TKSIIM22
          IF       OVRCD=1
            BEEP
            GOTO      NP04L999
          ENDIF
.
          CALL     CT04L000
.
. Position and Display Page
.--------------------------
NP04L110
          MOVE     SIIM2NXT,KEY5   
          CALL     TSSIIM22
          CALL     DP04L000
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
          MATCH    "SIIM2",NAMSSFFI
          GOTO     CT04L115 IF NOT EQUAL
CT04L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIIM21
          CALL     TKSIIM21
          BRANCH   OVRCD,CT04L110
          CALL     TRSIIM22
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUSIIM22
          GOTO     CT04L105
CT04L110
          GOTO     CT04L999
CT04L115
CT04L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP04L000
          CALL     CT04L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP04L999
          MATCH    PRGID,SCPSPID
          GOTO     CP04L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP04L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP04L010,CP04L010,CP04L010,CP04L100:
                            CP04L100,CP04L100,CP04L100,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010
.
CP04L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP04L010
CP04L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD04L000
          CALL      CP04L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD04L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD04L000
          MATCH     PRGID,SCPSPID
          GOTO      AD04L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD04L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD04L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM04L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "SIIM2",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,SIIM2AFL
            GOTO      AD04L010 IF EQUAL
            CALL      FP04L000
            GOTO      AD04L999
          ENDIF
AD04L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL04L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL04L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL04L900,DL04L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL04L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "SIIM2",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRSIIM21
            IF        OVRCD=0
              CALL      TDSIIM22
            ELSE
              BEEP
              GOTO      DL04L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSSIIM21
            CALL      TKSIIM21
            MOVE     KEY5,SIIM2NXT
            CALL      CT04L000
            MOVE      SIIM2NXT,KEY5   
            CALL      TSSIIM22
            CALL      TPSIIM22
            CALL      DP04L000
            GOTO      DL04L005
          ENDIF
DL04L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL04L005
DL04L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Cost Centre                        
.---------------------------------------------------------
TSSIIM21  RESET     KEY5
          READ      SIIM2FL1,KEY5;;
          RETURN
.
TSSIIM22  RESET     KEY5   
          READ      SIIM2FL2,KEY5;;
          RETURN
.
TASIIM22  RESET     KEY5   
          MOVE      ZERO,OVRCD
          READ      SIIM2FL2,KEY5;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDSIIM21  RESET     KEY5
          DELETE    SIIM2FL1,KEY5
          RETURN
.
TDSIIM22  RESET     KEY5
          DELETE    SIIM2FL2,KEY5
          RETURN
.
TKSIIM21  MOVE      ZERO,OVRCD
          READKS    SIIM2FL1;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKSIIM22  MOVE      ZERO,OVRCD
          READKS    SIIM2FL2;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIIM21  MOVE      ZERO,OVRCD
          READKP    SIIM2FL1;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIIM22  MOVE      ZERO,OVRCD
          READKP    SIIM2FL2;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIIM21  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      SIIM2FL1,KEY5;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIIM22  RESET     KEY5   
          MOVE      ZERO,OVRCD
          READ      SIIM2FL2,KEY5;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUSIIM21  UPDATE    SIIM2FL1;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          RETURN
.
TUSIIM22
          UPDATE    SIIM2FL2;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          RETURN
.
TWSIIM22  RESET     KEY5   
          WRITE     SIIM2FL2,KEY5;SCTMROW,SCTMCOL,KEY5:
                        SIIMCST,SIIMCAT,SIIMSEQ,SIIMMAX,SIIMREQ:
                        SIIMQOH,SIIMUR1,SIIMUR2,SIIMUD1,SIIMUD2,SIIMUC1:
                        SIIMUC2,SIIMUY1,SIIMUY2,SIIMWAR,SIIMSPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L101,PS04L102,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Add a Catalog to a range of Cost Ce
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L101:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L102:
                            SF04L103,SF04L006,SF04L104,SF04L105:
                            SF04L106,SF04L107,SF04L108,SF04L109:
                            SF04L110
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L101:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          MOVE      "SIIM2",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRSIIM21
            BRANCH    OVRCD,SF04L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF04L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF04L001 IF NOT EQUAL
            CALL      SM04L000 * Change Line
          ELSE
            IF        SIIM2AFL=0
              MOVE      "SIIM2",NAMSSFFI
              MOVE     "    4",ITMSSFFI
              CALL      AD04L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L102
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L103
          CALL      POSTB000
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L104
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      AD04L000
          GOTO     SF04L001
.
SF04L107
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      DL04L000
          GOTO     SF04L001
.
SF04L108
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L109
          MOVE      "SIIM2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
.
SF04L110
          CALL      DITEM000
          GOTO      SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
ECOST000  MATCH     SP70,DEFTCST   * Default Cost Center
          GOTO      ECOST100 IF NOT EQUAL
ECOST010  MOVE      ZERO,CKEYTYP
          CALL      KSICAA00
          BRANCH    EXIT,ECOST999,ECOST999
          MOVE      SICACODE,SIIMCST
          MOVE      SICACODE,DEFTCST
          IF       SICALOC=1
            BEEP
            MOVE     "Cost Centre Not Available for Requisitions - ",DISPMSG
            CALL     MESSAGE1
            GOTO     ECOST010
          ENDIF
          MATCH    SP70,SICAMES
          IF       !(@EQUAL)
            BEEP
            MOVE     SICAMES,DISPMSG
            CALL     MESSAGE1
          ENDIF
          GOTO      ECOST999
ECOST100  MOVE      DEFTCST,KEY5
          CALL      RDSICA1
          BRANCH    OVRCD,ECOST010
          MOVE      SICACODE,SIIMCST
          MOVE      SICACODE,DEFTCST
ECOST999  RETURN
.
ECATA000  MOVE      ZERO,CKEYTYP
          CALL      KSIIAA00
          MOVE      SIIACAT,SIIMCAT
          BRANCH    EXIT,ECATA990,ECATA990
.
          READ      CONTROLF,SIXTY3;*132,INCOSIN7
          PACK      INCOSIN7,INCOSIN7,SP10
          REP       " 0",INCOSIN7
.
          MATCH     "1",INCOSIN7                   * srf 121952  quote 7648
          IF        !@EQUAL & SIIANON=1
            BEEP
            MOVE      "Catalog Must be a Stocked Item. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      ECATA000
          ENDIF
.
          IF        SIIASUS=1|SIIASUS=3
            BEEP
            MOVE      "Catalog has been Suspended. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      ECATA000
          ENDIF
.
.         MATCH     "  1",SCSLSEL           * selection other than 1, dont write
.         GOTO      ECATA800 IF NOT EQUAL   * to audit file.
.
          PACK      KEY12,SIIMCST,SIIMCAT,SP70
          CALL      RASIIM1
          BRANCH    OVRCD,ECATA800
.
ECATA100  PACK      KEY12,SIIMCST,SIIMCAT,SP70
          CALL      RLSIIM1
          BRANCH    OVRCD,ECATA999,ECATA200
          MOVE      TWO,AUDTTYPE
          CALL      WASIIM00          * Write Before Audit
.
          MOVE      SIIMMAX,WHOLEQTY
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "im1",KEY6
          APPEND    SIIMUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "im2",KEY6
          APPEND    SIIMUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ECATA999
.
ECATA200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECATA100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECATA000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ECATA200 IF NOT EQUAL
          GOTO      ECATA000
ECATA990  MOVE      SP70,DEFTCST
          GOTO      ECATA999
.
ECATA800  MOVE      "   0",SIIMSEQ  * Keyin Sequence
          MOVE      "0",SIIMMAX     * Maximum Order Qty
          MOVE      "0",WHOLEQTY    * Maximum Order Qty
          MOVE      "0",SIIMREQ     * Quantity Requiried
          MOVE      "0",SIIMQOH     * Quantity On Hand
          MOVE      SP70,SIIMUR1    * User Def Ref 1
          MOVE      SP70,SIIMUR2    * User Def Ref 2
          MOVE      SP70,SIIMUD1    * User Def Date 1
          MOVE      SP70,SIIMUD2    * User Def Date 2
          MOVE      SP70,SIIMUC1    * User Def Code 1
          MOVE      SP70,SIIMUC2    * User Def Code 2
          MOVE      "0",SIIMUY1     * User Def Y/N 1
          MOVE      "0",SIIMUY2     * User Def Y/N 2
ECATA999  RETURN
EMAX0000  MOVE      SIIMMAX,WHOLEQTY
          IF        ACCEPT=1
            MOVE      ZERO,WHOLEQTY
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,WHOLEQTY
          IF        WHOLEQTY<0
            BEEP
            MOVE      "Quantity Must be Positive - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EMAX0000
          ENDIF
          MOVE      WHOLEQTY,SIIMMAX
          RETURN
.----------------------------------------------
. Enter Code
.----------------------------------------------
EUDC1000  MOVE        ZERO,CKEYTYP
          MOVE        "im1",SICDCATA
          MOVE        SP70,UDC1DESC
          CALL        KSICDB00
          BRANCH      EXIT,EUDC1999,EUDC1999
          MOVE        SICDCODE,SIIMUC1
          MOVE        SICDDESC,UDC1DESC
.
EUDC1999  RETURN
.
.----------------------------------------------
. Enter Code
.----------------------------------------------
EUDC2000  MOVE        ZERO,CKEYTYP
          MOVE        "im2",SICDCATA
          MOVE        SP70,UDC2DESC
          CALL        KSICDB00
          BRANCH      EXIT,EUDC2999,EUDC1999
          MOVE        SICDCODE,SIIMUC2
          MOVE        SICDDESC,UDC2DESC
.
EUDC2999  RETURN
.
POST0000  PACK     KEY12,SIIMCST,SIIMCAT
          CALL     RASIIM1
          IF       OVRCD=0
            CALL     UPSIIM1
            MOVE     THREE,AUDTTYPE
            CALL     WASIIM00                 * Audit Change
            CALL     UUSIIM1                  * Unlock
          ELSE
            CALL     WRSIIM1
            MOVE     ONE,AUDTTYPE
            CALL     WASIIM00                 * Audit Add
          ENDIF
          RETURN

DELT0000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          SUB      ONE,CEXIT
          BRANCH   CEXIT,DELT9000,DELT9100
.
          PACK     KEY12,SIIMCST,SIIMCAT,SP70
          CALL     RASIIM1
          IF       OVRCD=0
            CALL     DASIIM00                 * Delete Before Audit
            MOVE     FOUR,AUDTTYPE
            CALL     WASIIM00                 * Delete Audit
            CALL     DESIIM1
          ENDIF
          MOVE     TWO,EXIT
          GOTO     DELT9999
.
DELT9000  MOVE     ONE,EXIT
          GOTO     DELT9999
.
DELT9100  CALL     CANC0000
          MOVE     TWO,EXIT
          GOTO     DELT9999
.
DELT9999  RETURN
CANC0000  PACK     KEY12,SIIMCST,SIIMCAT,SP70
          CALL     RASIIM1
          IF       OVRCD=0
            CALL     DASIIM00                 * Delete Before Audit
            CALL     UUSIIM1                  * Unlovk
          ENDIF
          RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.------------------------------------------------------------
. Save Catalog to a Range of Cost Centres
.------------------------------------------------------------
PALL0000  DISPLAY  *P1:18,*EF
          HLINE    *G37,18,1,80
          PACK     KEY5,STRCST,SP70
          CALL     RDSICA1
          IF       OVRCD=0
            CALL     RPSICA1
          ENDIF
PALL1000  CALL     RKSICA1
          BRANCH   OVRCD,PALL9000       * End of File
          MATCH    SICACODE,ENDCST      * End of Range
          GOTO     PALL9000 IF LESS
          MATCH    "0000000",SICAIMPD   * No Imprest Ignore
          GOTO     PALL1000 IF EQUAL
          MATCH    SP70,SICAIMPD        * No Imprest Ignore
          GOTO     PALL1000 IF EQUAL
.
          PACK     KEY12,SICACODE,SIIACAT,SP70
          CALL     RDSIIM1
          COMPARE  ONE,OVRCD
          GOTO     PALL1000 IF NOT EQUAL
.
          CALL     ADDITM00
.
          GOTO     PALL1000
PALL9000
PALL9999  RETURN
.------------------------------------------------------------
. Add Imprest Item
.------------------------------------------------------------
ADDITM00  COMPARE   ZERO,CONFIRM
          GOTO      ADDITM50 IF EQUAL
.
          DISPLAY   *P1:19,*EF:
                    *P1:20,"Cost Centre : ",*V2LON,SICACODE,*HOFF,SP1,SICADESC:
                    *P1:21,"Sequence    : ",*V2LON,SEQUNUM,*HOFF:
                    *P1:22,"Max Qty     : ",*V2LON,WHOLEQTY
          KEYIN     *P1:24,"Insert Catalog (Y/N) ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     "N",ANS
          GOTO      ADDITM99 IF EQUAL
          MATCH     "Y",ANS
          GOTO      ADDITM00 IF NOT EQUAL
.
ADDITM50  PACK      KEY12,SICACODE,SIIACAT,SP70
          CALL      RDSIIM1
          COMPARE   ONE,OVRCD
          GOTO      ADDITM99 IF NOT EQUAL
.
          UNPACK    KEY12,SIIMCST,SIIMCAT
          MOVE      WHOLEQTY,SIIMMAX
          MOVE      SEQUNUM,SIIMSEQ
          CALL      CLRITM00
          CALL      WRSIIM1
          MOVE      ONE,AUDTTYPE
          CALL      WASIIM00                 * Audit Add
.
ADDITM99  RETURN
.
CLRITM00  MOVE      "0",SIIMREQ     * Quantity Requiried
          MOVE      "0",SIIMQOH     * Quantity On Hand
          MOVE      SP70,SIIMUR1    * User Def Ref 1
          MOVE      SP70,SIIMUR2    * User Def Ref 2
          MOVE      SP70,SIIMUD1    * User Def Date 1
          MOVE      SP70,SIIMUD2    * User Def Date 2
          MOVE      SP70,SIIMUC1    * User Def Code 1
          MOVE      SP70,SIIMUC2    * User Def Code 2
          MOVE      "0",SIIMUY1     * User Def Y/N 1
          MOVE      "0",SIIMUY2     * User Def Y/N 2
          MOVE      SP70,SIIMSPA
          RETURN
.
.-------------------------------------------------------------
. Delete All
.-------------------------------------------------------------
DALL0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DALL1000,DALL9000,DALL9100
.
DALL1000  CALL     DRAN0000            * Delete
          MOVE     TWO,EXIT            * Restart Screen
          GOTO     DALL9999
DALL9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DALL9999
DALL9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DALL9999
DALL9999  RETURN
.------------------------------------------------------------
. Delete Catalog from a Range of Cost Centres
.------------------------------------------------------------
DRAN0000  DISPLAY  *P1:18,*EF
          HLINE     *G37,18,1,80
          PACK     KEY5,STRCST,SP70
          CALL     RDSICA1
          IF       OVRCD=0
            CALL     RPSICA1
          ENDIF
DRAN1000  CALL     RKSICA1
          BRANCH   OVRCD,DRAN9000       * End of File
          MATCH    SICACODE,ENDCST      * End of Range
          GOTO     DRAN9000 IF LESS
          PACK     KEY12,SICACODE,SIIACAT,SP70
          CALL     RDSIIM1
          BRANCH   OVRCD,DRAN1000
          CALL     DELITM00
          GOTO     DRAN1000
.
DRAN9000
DRAN9999  RETURN
.------------------------------------------------------------
. Delete Imprest Item
.------------------------------------------------------------
DELITM00  COMPARE   ZERO,CONFIRM
          GOTO      DELITM50 IF EQUAL
          DISPLAY   *P1:19,*EF:
                    *P1:20,"Cost Centre : ",*V2LON,SICACODE,*HOFF,SP1,SICADESC:
                    *P1:21,"Sequence    : ",*V2LON,SIIMSEQ,*HOFF:
                    *P1:22,"Max Qty     : ",*V2LON,SIIMMAX
          KEYIN     *P1:24,"Delete Catalog from Cost Centre (Y/N) ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     "N",ANS
          GOTO      DELITM99 IF EQUAL
          MATCH     "Y",ANS
          GOTO      DELITM00 IF NOT EQUAL
.
DELITM50  PACK      KEY12,SICACODE,SIIACAT,SP70
          CALL      RLSIIM1
          BRANCH    OVRCD,DELITM99,DELITM80
          CALL      DESIIM1
          MOVE      FOUR,AUDTTYPE
          CALL      WASIIM00                 * Delete Audit
          GOTO      DELITM99
.
DELITM80  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      DELITM50 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      DELITM99 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      DELITM80 IF NOT EQUAL
.
DELITM99  RETURN
.
.------------------------------------------------------------
. Enter Catalog for Bulk Update
.------------------------------------------------------------
GCATA000  MOVE      ZERO,CKEYTYP
          CALL      KSIIAA00
          MOVE      SIIACAT,SIIMCAT
          BRANCH    EXIT,GCATA999,GCATA999
.
          MOVE      "63",SECTOR
          READ      CONTROLF,SECTOR;*132,INCOSIN7
          PACK      INCOSIN7,INCOSIN7,SP10
          REP       " 0",INCOSIN7
.
          MATCH     "1",INCOSIN7                   * srf 121952  quote 7648
          IF        !@EQUAL & SIIANON=1
            BEEP
            MOVE      "Catalog Must be a Stocked Item. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      GCATA000
          ENDIF
.
          IF        SIIASUS=1|SIIASUS=3
            BEEP
            MOVE      "Warning - Catalog has been Suspended. - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
.
          MOVE      ZERO,EXIT
          MOVE      ONE,OVRCD
          MOVE      "0000",SEQUNUM  * Keyin Sequence
          MOVE      "0000",SIIMSEQ  * Keyin Sequence
          MOVE      "0",SIIMMAX     * Maximum Order Qty
          MOVE      "0",WHOLEQTY    * Maximum Order Qty
          MOVE      "0",SIIMREQ     * Quantity Requiried
          MOVE      "0",SIIMQOH     * Quantity On Hand
          MOVE      SP70,SIIMUR1    * User Def Ref 1
          MOVE      SP70,SIIMUR2    * User Def Ref 2
          MOVE      SP70,SIIMUD1    * User Def Date 1
          MOVE      SP70,SIIMUD2    * User Def Date 2
          MOVE      SP70,SIIMUC1    * User Def Code 1
          MOVE      SP70,SIIMUC2    * User Def Code 2
          MOVE      "0",SIIMUY1     * User Def Y/N 1
          MOVE      "0",SIIMUY2     * User Def Y/N 2
.
GCATA999  RETURN
.--------------------------------------------------
. Enter Range
.
.  Return Values
.        FROMCST  Code & Description for Start of Range
.        TOCST    Code & Description for End of Range
.        STRCST   Code for Start of Range
.        ENDCST   Code for End of Range
.--------------------------------------------------
RCOST000   MOVE     "   12",FLDID
           CALL     GETPOSIT
           CALL     KSICAA00
           BRANCH   EXIT,RCOST100,RCOST999
           MOVE     SICACODE,STRCST
           PACK     FROMCST,SICACODE,SP1,SICADESC
           GOTO     RCOST140
RCOST100   MOVE     "Start             ",FROMCST
           MOVE     SP70,STRCST
.
RCOST140   MOVE     FROMCST,VAR
           CALL     DISPITEM
.
RCOST150   MOVE     "   13",FLDID
           CALL     GETPOSIT
           CALL     KSICAA00
           BRANCH   EXIT,RCOST200,RCOST999
           MOVE     SICACODE,ENDCST
           PACK     TOCST,SICACODE,SP1,SICADESC
           MATCH    STRCST,ENDCST
           GOTO     RCOST999 IF EQUAL
           GOTO     RCOST999 IF NOT LESS
           BEEP
           MOVE     "To Cost Centre Must Be > From Cost Centre - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCOST000
.
RCOST200   MOVE     "Finish             ",TOCST
           MOVE     Z70,ENDCST
.
RCOST999   MOVE     "   12",FLDID
           CALL     GETPOSIT
           RETURN
.
.
KORGC000  MOVE      ZERO,CKEYTYPE
          CALL      KSIIAA00
          BRANCH    EXIT,KORGC999,KORGC999
.
          PACK      KEY5,SIIACAT,SP70
          CALL      RDSIIA1
          BRANCH    OVRCD,KORGC800
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIM2
          CALL      RKSIIM2
          BRANCH    OVRCD,KORGC820
.
          MATCH     SIIACAT,SIIMCAT
          GOTO      KORGC820 IF NOT EQUAL
.
          MOVE      SIIACAT,ORIGCATA
          MOVE      SIIADES,ORIGDESC
          GOTO      KORGC999
.
KORGC800  BEEP
          MOVE      "Invalid Catalog Code - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KORGC000
.
KORGC820  BEEP
          MOVE      "Catalog is NOT Currently on Imprest - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KORGC000
.
KORGC999  RETURN

.
KREPC000  MOVE      ZERO,CKEYTYPE
          CALL      KSIIAA00
          BRANCH    EXIT,KREPC999,KREPC999
.
          PACK      KEY5,SIIACAT,SP70
          CALL      RDSIIA1
          BRANCH    OVRCD,KREPC800
.
          READ      CONTROLF,SIXTY3;*132,INCOSIN7
          MATCH     "1",INCOSIN7
          IF        !@EQUAL & SIIANON=1
            BEEP
            MOVE      "Catalog Must be a Stocked Item - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KREPC000
          ENDIF
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIM2
          CALL      RKSIIM2
          BRANCH    OVRCD,KREPC100
.
          MATCH     SIIACAT,SIIMCAT
          GOTO      KREPC820 IF EQUAL
.
KREPC100  MOVE      SIIACAT,REPLCATA
          MOVE      SIIADES,REPLDESC
          GOTO      KREPC999
.
KREPC800  BEEP
          MOVE      "Invalid Catalog Code - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KREPC000
.
KREPC820  BEEP
          MOVE      "Catalog is Already on Imprest - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KREPC000
.
KREPC999  RETURN

.
REPLC000  PACK      KEY12,ORIGCATA,SP70
          CALL      RSSIIM2
.
          CALL      RKSIIM2
          BRANCH    OVRCD,REPLC999
.
          MATCH     ORIGCATA,SIIMCAT
          GOTO      REPLC999 IF NOT EQUAL
.
          MOVE      REPLCATA,SIIMCAT
          CALL      UPSIIM2
          GOTO      REPLC000
.
REPLC999  RETURN

REDITM00   MOVE      SIIMCST,KEY5
           CALL      RDSICA1
           MOVE      SIIMMAX,WHOLEQTY
           RETURN
.--------------------------------------------------------
.          Save Batch Screen
.--------------------------------------------------------
.       1. Delete all Related Batch Items
.       2. Loop Through & add Posted Batch Items
.  zzzz   = Match Segment of Key
.  KEY12  = Key to File being Written too
.
.--------------------------------------------------------
POSTB000  PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIM2
POSTB100  CALL      RKSIIM2
          BRANCH    OVRCD,POSTB200
          MATCH     SIIMCAT,SIIACAT
          GOTO      POSTB200 IF NOT EQUAL
          PACK      KEY12,SIIMCAT,SIIMCST,SP70
          CALL      DESIIM2
          GOTO      POSTB100
.
POSTB200  MOVE      SP70,KEY5
          CALL      TRSIIM21
          COMPARE   ZERO,OVRCD
          GOTO      POSTB310 IF EQUAL
.
POSTB300  CALL      TKSIIM21
          BRANCH    OVRCD,POSTB999
POSTB310  PACK      KEY12,SIIACAT,SIIMCST,SP70
          UNPACK    KEY12,SIIMCAT,SIIMCST
          CALL      RASIIM2
          IF        OVRCD=0
            CALL      UPSIIM2
..            MOVE      THREE,AUDTTYPE
..            CALL      WASIIM00          * Audit Change
          ELSE
            CALL      WRSIIM2
..            MOVE      ONE,AUDTTYPE
..            CALL      WASIIM00          * Audit Add
          ENDIF
          GOTO      POSTB300
.
POSTB999  RETURN
.
.------------------------------------------------------------
. Delete Item
.------------------------------------------------------------
DITEM000  MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DITEM005  CALL      MDELQ000
          BRANCH    EXIT,DITEM900,DITEM900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DITEM100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "SIIM2",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL,SP70
            CALL      TRSIIM21
            IF        OVRCD=0
              CALL      TDSIIM22
.              PACK      KEY12,SIIMCAT,SIIMCST,SP70
.              CALL      RDTMCW1
.              IF        OVRCD=0
.                CALL      DETMCW1
.              ENDIF
            ELSE
              BEEP
              GOTO      DITEM005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSSIIM21
            CALL      TKSIIM21
            MOVE     KEY3,SIIM2NXT
            CALL      CT04L000
            MOVE      SIIM2NXT,KEY3
            CALL      TSSIIM22
            CALL      TPSIIM22
            CALL      DP04L000
            GOTO      DITEM005
          ENDIF
DITEM100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DITEM005
DITEM900  CALL      MESSAGE3
          RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIFIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINIMPIO/INC
          INC       SINNATIO/INC
.
          INC       STDGENCD
.
