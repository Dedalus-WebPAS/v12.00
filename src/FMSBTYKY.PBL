.-------------------------------------------------------------------------------
.   Routine   :   KBTYFM00 Keyin Budget Type
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
ABTYFM00  MOVE      "1",CKEYTYP        * insert
          GOTO      KBTYFM10
.
KBTYFM00  MOVE      "0",CKEYTYP        * modify
          GOTO      KBTYFM10
.
KBTYFM10  
          CALL      KFMBTA00
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSBTYKY
.   Routine   :   KFMBTA00 Keyin Budget Type         
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMBTA00 TOPIC     "FMBTCODE"
          MOVE      UNDLN70,FMBTCODE
          KEYIN     *PCCOL:CVERT,*DV,FMBTCODE:                                  
                    *PCCOL:CVERT,*V2LON,FMBTCODE:                               
                    *PCCOL:CVERT,*DV,FMBTCODE
.
          ENDSET    FMBTCODE
          APPEND    SP70,FMBTCODE
          RESET     FMBTCODE
.
          MATCH     SP70,FMBTCODE
          GOTO      KFMBTA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMBTCODE
          GOTO      KFMBTA95 IF EQUAL
.
          CMATCH    QUEST,FMBTCODE
          GOTO      KFMBTA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMBTA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMBTCODE
          APPEND    SP70,FMBTCODE
          RESET     FMBTCODE
.
          MATCH     SP70,FMBTCODE
          GOTO      KFMBTA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMBTCODE                                
KFMBTA10
          PACK      KEY4,FMBTCODE                                               
          CALL      RAFMBT1 
          BRANCH    OVRCD,KFMBTA80
          BRANCH    CKEYTYP,KFMBTA75
          CALL      RDFMBT1 
KFMBTA70
          MOVE      ZERO,EXIT
          GOTO      KFMBTA99
KFMBTA75
          MOVE      "Budget Type Already Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KFMBTA00
KFMBTA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMBTA99,KFMBTA99
          MOVE      "Budget Type Does Not Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KFMBTA00
KFMBTA90
          MOVE      ONE,EXIT
          GOTO      KFMBTA99
KFMBTA95
          MOVE      TWO,EXIT
KFMBTA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSBTYKY
.   Routine   :   HFMBTA00 Main Help Routine   
.   Return    :           
.-------------------------------------------------------------------------------
HFMBTA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMBTA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMBTA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Budget Type"        
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          MOVE      STDCOL02,STDCOL03
          ADD       "37",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Fin Year"           
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 4",STDCOL04
HFMBTA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMBTCODE
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          CALL      RSFMBT1 
HFMBTA10
          CALL      RKFMBT1 
          BRANCH    OVRCD,HFMBTA15
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HFMBTA12
          CALL      HFMBTA60
          BRANCH    OVRCD,HFMBTA10
HFMBTA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMBTCODE
          DISPLAY   *PSTDCOL02:STDROW,FMBTDESC
          DISPLAY   *PSTDCOL03:STDROW,FMBTYEAR
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMBTA10 IF NOT EQUAL
HFMBTA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMBTA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMBTA30,HFMBTA35,HFMBTA40,HFMBTA45,HFMBTA04:
                              HFMBTA91,HFMBTA50
          GOTO      HFMBTA92
HFMBTA30
          CALL      RKFMBT1 
          BRANCH    OVRCD,HFMBTA85
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          CALL      RPFMBT1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBTA10
HFMBTA35
          MOVE      ST1,KEY4 
          CALL      RDFMBT1 
          CALL      RPFMBT1 
          BRANCH    OVRCD,HFMBTA85
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMBTA36
          CALL      RPFMBT1 
          BRANCH    OVRCD,HFMBTA37
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMBTA36 IF NOT EQUAL
HFMBTA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMBTA10
HFMBTA40
          MOVE      ST1,KEY4 
          CALL      RDFMBT1 
          CALL      RPFMBT1 
          BRANCH    OVRCD,HFMBTA85
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBTA08
HFMBTA45
          CALL      RKFMBT1 
          BRANCH    OVRCD,HFMBTA85
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMBT1 
HFMBTA46
          CALL      RPFMBT1 
          BRANCH    OVRCD,HFMBTA47
          PACK      KEY4,FMBTCODE,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMBTA46 IF NOT EQUAL
HFMBTA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMBTA10
HFMBTA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMBTA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBTA08
HFMBTA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBTA08
HFMBTA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMBTA61 IF EQUAL
          MATCH     SCHFLD01,FMBTCODE
          GOTO      HFMBTA72 IF NOT EQUAL
HFMBTA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMBTA62 IF EQUAL
          MATCH     SCHFLD02,FMBTDESC
          GOTO      HFMBTA72 IF NOT EQUAL
HFMBTA62
          MATCH     SP70,SCHFLD03
          GOTO      HFMBTA63 IF EQUAL
          MATCH     SCHFLD03,FMBTYEAR
          GOTO      HFMBTA72 IF NOT EQUAL
HFMBTA63
HFMBTA64
HFMBTA65
HFMBTA66
HFMBTA67
HFMBTA68
HFMBTA69
HFMBTA70
          GOTO      HFMBTA75
HFMBTA72  MOVE      ONE,OVRCD
HFMBTA75  RETURN
HFMBTA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,FMBTCODE                                               
          CALL      RDFMBT1 
HFMBTA90
.                                                                               
          BEEP
          GOTO      HFMBTA20
HFMBTA91
          MOVE      SP70,FMBTDESC
          MOVE      SP70,FMBTYEAR
          MOVE      SP70,FMBTSTAT
          MOVE      SP70,FMBTSPAR
          MOVE      SP70,KEY4 
          MOVE      SP70,FMBTCODE
          GOTO      HFMBTA96
HFMBTA92
          MOVE      SP70,KEY4 
          MOVE      SP70,FMBTCODE
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,FMBTCODE                                               
HFMBTA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMBTA99
          RETURN
