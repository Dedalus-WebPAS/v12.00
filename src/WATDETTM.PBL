.----------------------------------------------------------------------
. Program       : WATDETTM
.
. Function      : Waiting List fields for Theatre Booking Server
.
. Modifications  :
.----------------------------------------------------------------------
. V12.00.01 21/05/2025  Ebon Clements    TSK 0955096
.           Alphanueric visit number changes
. V11.02.02 09/02/2022  Thanh T          TSK 0889899
.           Added calls to display WMDESC2 and WMDESC3 in OPRWEB01
. V11.02.01 09/02/2022  Thanh T          TSK 0889899
.           Added WMDESC2 - Procedure Description 2
.                  WMDESC3 - Procedure Description 3
.----------------------------------------------------------------------
. V10.05.02 17/17/2014  Peter Vela       CAR 304784
.           Added tag for unformatted WMDATE1
.V10.05.01  26/09/2014  Steve Armstrong  CAR 306586
.           Fixed clearing of DIM 80 variables in CLWATDET.
.           Also added clearing of new fields
.           (WTWMASSR, WTWMACPR & WTWMPDSC).
. V9.07.01  19/09/2006  Mike Laming   CAR 111288
.           Add routine CLWATDET - moved from OPRWEB01 & OPRWEB06
. V9.04.01  26/10/2005 Mike Laming   CAR 52354
.           Add all missing Waiting List variables from tag 61 to 95,
.           change all Lables from WTRExxxx to WRDExxxx (and in OPRWEB01 & 06)
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.     Clear all the Waiting List Procedure
.     (Key vars WMCNT and WTWMUNIQ are not Initialised here)
.     Note - any changes to these variables also required in WATTRETM.PBL
.            and CLWATTR1.PBL
.----------------------------------------------------------------------
CLWATDET  MOVE      ZERO,WMTIME
          MOVE      SP70,WMURNO
          MOVE      SP70,WMCODE
          PACK      WMDESC,SP70,SP70
          PACK      WMREASON,SP70,SP70
          MOVE      ZERO,WMSTAT
          MOVE      SP70,WMDATE1
          MOVE      SP70,WMDATE2
          MOVE      SP70,WMDATE3
          MOVE      SP70,WMDATE4
          MOVE      SP70,WMREMOVE
          MOVE      SP70,WMUNIT
          MOVE      SP70,WMDOCTOR
          MOVE      ZERO,WMSTAY
          MOVE      SP70,WMPTY
          MOVE      SP70,WMNOTICE
          MOVE      SP70,WMPTYPE
          MOVE      SP70,WMPCAT
          MOVE      SP70,WMUDEF1
          MOVE      SP70,WMUDEF2
          MOVE      SP70,WMUDEF3
          MOVE      SP70,WMUDEF4
          MOVE      ZEROVISN,WMBOOK
          MOVE      SP70,WMKEYDT
          MOVE      SP70,WTWMPORT
          MOVE      SP70,WTWMREAD
          MOVE      SP70,WTWMDEDA
          MOVE      ZERO,WTWMSENT
          MOVE      SP70,WTWMCLSS
          MOVE      SP70,WTWMDTAD
          MOVE      SP70,WTWMACAT
          MOVE      SP70,WTWMGADD
          MOVE      SP70,WTWMDABD
          MOVE      SP70,WTWMEATY
          MOVE      SP70,WTWMADMC
          MOVE      SP70,WTWMECRA
          MOVE      SP70,WTWMGPFA
          MOVE      SP70,WTWMRFGP
          MOVE      SP70,WTWMGPPC
          MOVE      SP70,WTWMNAFR
          MOVE      SP70,WTWMNATO
          MOVE      SP70,WTWMGPPT
          MOVE      SP70,WTWMDOFR
          MOVE      SP70,WTWMOPER
          MOVE      SP70,WTWMIHSP
          MOVE      SP70,WTWMVLSF
          MOVE      SP70,WTWMPRO2
          MOVE      SP70,WTWMPRO3
          MOVE      SP70,WTWMTRPA
          MOVE      SP70,WMUDEF5
          MOVE      SP70,WMUDEF6
          MOVE      SP70,WMUDEF7
          MOVE      SP70,WMUDEF8
          MOVE      "     0",WTWMRANK
          MOVE      SP70,WTWMSRCR
          MOVE      SP70,WTWMDRSA
          MOVE      SP70,WTWMDOSA
          MOVE      SP70,WTWMPHSP
          MOVE      SP70,WTWMBSCD
          MOVE      SP70,WTWMRSFL
          MOVE      SP70,WTWMECNT
          MOVE      SP70,WTWMCSST
          MOVE      SP70,WTWMCSDT
          MOVE      SP70,WTWMASSR
          MOVE      SP70,WTWMACPR
          PACK      WTWMPDSC,SP70,SP70
          MOVE      SP70,WTWMRADT
          PACK      WMDESC2,SP70,SP70
          PACK      WMDESC3,SP70,SP70
          MOVE      SP70,WTWMSPAR
.
          RETURN
.------------------------------------------------------------
. Add Field
.------------------------------------------------------------
WTDE0000  BRANCH    FLDITMNO,WTDE0100,WTDE0200,WTDE0300,WTDE0400,WTDE0500:
                             WTDE0600,WTDE0700,WTDE0800,WTDE0900,WTDE1000: * 10
                             WTDE1100,WTDE1200,WTDE1300,WTDE1400,WTDE1500:
                             WTDE1600,WTDE1700,WTDE1800,WTDE1900,WTDE2000: * 20
                             WTDE2100,WTDE2200,WTDE2300,WTDE2400,WTDE2500:
                             WTDE2600,WTDE2700,WTDE2800,WTDE2900,WTDE3000: * 30
                             WTDE3100,WTDE3200,WTDE3300,WTDE3400,WTDE3500:
                             WTDE3600,WTDE3700,WTDE3800,WTDE3900,WTDE4000: * 40
                             WTDE4100,WTDE4200,WTDE4300,WTDE4400,WTDE4500:
                             WTDE4600,WTDE4700,WTDE4800,WTDE4900,WTDE5000: * 50
                             WTDE5100,WTDE5200,WTDE5300,WTDE5400,WTDE5500:
                             WTDE5600,WTDE5700,WTDE5800,WTDE5900,WTDE6000: * 60
                             WTDE6100,WTDE0099,WTDE0099,WTDE0099,WTDE0099:
                             WTDE0099,WTDE0099,WTDE0099,WTDE0099,WTDE0099: * 70
                             WTDE0099,WTDE0099,WTDE0099,WTDE0099,WTDE7500:
                             WTDE0099,WTDE0099,WTDE0099,WTDE0099,WTDE0099: * 80
                             WTDE8100,WTDE0099,WTDE0099,WTDE0099,WTDE0099:
                             WTDE0099,WTDE0099,WTDE8800,WTDE8900,WTDE9000: * 90
                             WTDE9100,WTDE0099,WTDE9300,WTDE9400,WTDE9500:
                             WTDE9600,WTDE9700,WTDE9800
.
WTDE0099  MOVE      "Invalid IBA Tag WATDETTM ",KEY25
          WRITE     HTMLFILE;KEY25;
          GOTO      WTDE9999
.
WTDE0100  PACK      KEY19,WMURNO,WMCODE,WMCNT
          WRITE     HTMLFILE;KEY19;
          GOTO      WTDE9999
.
WTDE0200  WRITE     HTMLFILE;WMURNO;
          GOTO      WTDE9999
.
WTDE0300  WRITE     HTMLFILE;WMCODE;
          GOTO      WTDE9999
.
WTDE0400  WRITE     HTMLFILE;WMCNT;
          GOTO      WTDE9999
.
WTDE0500  WRITE     HTMLFILE;WMTIME;
          GOTO      WTDE9999
.
WTDE0600  MATCH     SP70,WMDESC
          GOTO      WTDE9999 IF EQUAL
          STRIP     WMDESC
          MOVELPTR  WMDESC,F3
          SFORMAT   VAR,F3
          MOVE      WMDESC,VAR
          WRITE     HTMLFILE;VAR;
          SFORMAT   VAR,127
          GOTO      WTDE9999
.
WTDE0700  MATCH     SP70,WMREASON
          GOTO      WTDE9999 IF EQUAL
          STRIP     WMREASON
          MOVELPTR  WMREASON,F3
          SFORMAT   VAR,F3
          MOVE      WMREASON,VAR
          WRITE     HTMLFILE;VAR;
          SFORMAT   VAR,127
          GOTO      WTDE9999
.
WTDE0800  BRANCH    WMSTAT,WTDE0810,WTDE0820,WTDE0830,WTDE0840,WTDE0850:
                           WTDE0860,WTDE0870,WTDE0880
WTDE0810  WRITE     HTMLFILE;"Unscheduled";
          GOTO      WTDE9999
WTDE0820  WRITE     HTMLFILE;"Scheduled";
          GOTO      WTDE9999
WTDE0830  WRITE     HTMLFILE;"Pre-Admitted";
          GOTO      WTDE9999
WTDE0840  WRITE     HTMLFILE;"Admitted";
          GOTO      WTDE9999
WTDE0850  WRITE     HTMLFILE;"Discharged";
          GOTO      WTDE9999
WTDE0860  WRITE     HTMLFILE;"Removed from Waiting List";
          GOTO      WTDE9999
WTDE0870  WRITE     HTMLFILE;"Performed";
          GOTO      WTDE9999
WTDE0880  WRITE     HTMLFILE;"Not Performed";
          GOTO      WTDE9999
.
WTDE0900  MATCH     SP70,WMDATE1
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WMDATE1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE1000  MATCH     SP70,WMDATE2
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WMDATE2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE1100  MATCH     SP70,WMDATE3
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WMDATE3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE1200  MATCH     SP70,WMDATE4
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WMDATE4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE1300  MOVE      "WR",CATEGORY
          MOVE      WMREMOVE,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE1400  MOVE      "WU",CATEGORY
          MOVE      WMUNIT,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE1500  MOVE      WMDOCTOR,DOCTCODE
          CALL      DOCDET00
          GOTO      WTDE9999
.
WTDE1600  WRITE     HTMLFILE;WMSTAY;
          GOTO      WTDE9999
.
WTDE1700  MOVE      "TP",CATEGORY
          MOVE      WMPTY,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE1800  MOVE      "WS",CATEGORY
          MOVE      WMNOTICE,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE1900  MOVE      "T ",CATEGORY
          MOVE      WMPTYPE,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE2000  MOVE      "A ",CATEGORY
          MOVE      WMPCAT,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE2100  MOVE      "W1",CATEGORY
          MOVE      WMUDEF1,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE2200  MOVE      "W2",CATEGORY
          MOVE      WMUDEF2,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE2300  MOVE      "W3",CATEGORY
          MOVE      WMUDEF3,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE2400  MOVE      "W4",CATEGORY
          MOVE      WMUDEF4,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE2500  WRITE     HTMLFILE;WMBOOK;
          GOTO      WTDE9999
.
WTDE2600  MATCH     SP70,WMKEYDT
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WMKEYDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE2700  MATCH     SP70,WTWMREAD
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMREAD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE2800  MATCH     SP70,WTWMDEDA
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMDEDA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE2900  WRITE     HTMLFILE;WTWMUNIQ;
          GOTO      WTDE9999
.
WTDE3000  WRITE     HTMLFILE;WTWMSENT;
          GOTO      WTDE9999
.
WTDE3100  MOVE      "P ",CATEGORY
          MOVE      WTWMCLSS,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE3200  MATCH     SP70,WTWMDTAD
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMDTAD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE3300  MOVE      "CL",CATEGORY
          MOVE      WTWMACAT,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE3400  MATCH     SP70,WTWMGADD
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMGADD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE3500  MATCH     SP70,WTWMDABD
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMDABD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE3600  MOVE      "CC",CATEGORY
          MOVE      WTWMEATY,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE3700  MOVE      "WA",CATEGORY
          MOVE      WTWMADMC,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE3800  WRITE     HTMLFILE;WTWMECRA;
          GOTO      WTDE9999
.
WTDE3900  WRITE     HTMLFILE;WTWMGPFA;
          GOTO      WTDE9999
.
WTDE4000  MOVE      WTWMRFGP,GENPCODE
..          CALL      GPCDET00
          GOTO      WTDE9999
.
WTDE4100  WRITE     HTMLFILE;WTWMGPPC;
          GOTO      WTDE9999
.
WTDE4200  WRITE     HTMLFILE;WTWMGPPC;
          GOTO      WTDE9999
.
WTDE4300  MATCH     SP70,WTWMNAFR
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMNAFR,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE4400  MATCH     SP70,WTWMNATO
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMNATO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE4500  WRITE     HTMLFILE;WTWMGPPT;
          GOTO      WTDE9999
.
WTDE4600  MOVE      "DA",CATEGORY
          MOVE      WTWMDOFR,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE4700  WRITE     HTMLFILE;WTWMOPER;
          GOTO      WTDE9999
.
WTDE4800  WRITE     HTMLFILE;WTWMIHSP;
          GOTO      WTDE9999
.
WTDE4900  WRITE     HTMLFILE;WTWMVLSF;
          GOTO      WTDE9999
.
WTDE5000  WRITE     HTMLFILE;WTWMPRO2;
          GOTO      WTDE9999
.
WTDE5100  WRITE     HTMLFILE;WTWMPRO3;
          GOTO      WTDE9999
.
WTDE5200  MATCH     SP70,WTWMTRPA
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMTRPA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE5300  MOVE      "X5",CATEGORY
          MOVE      WMUDEF5,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE5400  MOVE      "X6",CATEGORY
          MOVE      WMUDEF6,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE5500  MOVE      "X7",CATEGORY
          MOVE      WMUDEF7,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE5600  MOVE      "X8",CATEGORY
          MOVE      WMUDEF8,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE5700  WRITE     HTMLFILE;WTWMRANK;
          GOTO      WTDE9999
.
WTDE5800  MOVE      "S ",CATEGORY
          MOVE      WTWMSRCR,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE5900  CALL      WATCOM00
          GOTO      WTDE9999
.
WTDE6000  PACK      DFLTWARD,SP70
          CALL      WSEL0000
          GOTO      WTDE9999
.
WTDE6100  CALL      WATCOM00
          GOTO      WTDE9999
.
WTDE6200  GOTO      WTDE9999
.
WTDE6300  GOTO      WTDE9999
.
WTDE6400  GOTO      WTDE9999
.
WTDE6500  GOTO      WTDE9999
.
WTDE6600  GOTO      WTDE9999
.
WTDE6700  GOTO      WTDE9999
.
WTDE6800  GOTO      WTDE9999
.
WTDE6900  GOTO      WTDE9999
.
WTDE7000  GOTO      WTDE9999
.
WTDE7100  GOTO      WTDE9999
.
WTDE7200  GOTO      WTDE9999
.
WTDE7300  GOTO      WTDE9999
.
WTDE7400  GOTO      WTDE9999
.
WTDE7500  WRITE     HTMLFILE;WMSTAT;
          GOTO      WTDE9999
.
WTDE7600  GOTO      WTDE9999
.
WTDE7700  GOTO      WTDE9999
.
WTDE7800  GOTO      WTDE9999
.
WTDE7900  GOTO      WTDE9999
.
WTDE8000  GOTO      WTDE9999
.
WTDE8100  MATCH     ZEROVISN,WMBOOK
          GOTO      WTDE9999 IF EQUAL
.
          MOVE      WMBOOK,KEY8             * Pre Admitted/Admitted/Discharged
          CALL      RDMISS1
          BRANCH    OVRCD,WTDE9999
.
          COMPARE   "1",ASTAT               * Pre Admitted Only
          GOTO      WTDE9999 IF EQUAL
.
          COMPARE   "5",ASTAT               * Cancelled
          GOTO       WTDE9999 IF EQUAL
.
          UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE8200  GOTO      WTDE9999
.
WTDE8300  GOTO      WTDE9999
.
WTDE8400  GOTO      WTDE9999
.
WTDE8500  GOTO      WTDE9999
.
WTDE8600  GOTO      WTDE9999
.
WTDE8700  GOTO      WTDE9999
.
WTDE8800  MATCH     SP70,WTWMDRSA
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMDRSA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE8900  MATCH     SP70,WTWMDOSA
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMDOSA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE9000  MOVE      "HP",CATEGORY
          MOVE      WTWMPHSP,CODE
          CALL      CODITM00
          GOTO      WTDE9999
.
WTDE9100  WRITE     HTMLFILE;WTWMECNT;
          GOTO      WTDE9999
.
WTDE9200  GOTO      WTDE9999
.
WTDE9300  MOVE      "No",DIM3
          MATCH     "Y",WTWMCSST
          IF        @EQUAL
            MOVE      "Yes",DIM3
          ENDIF
          WRITE     HTMLFILE;DIM3;
          GOTO      WTDE9999
.
WTDE9400  MATCH     SP70,WTWMCSDT
          GOTO      WTDE9999 IF EQUAL
          UNPACK    WTWMCSDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      WTDE9999
.
WTDE9500  GOTO      WTDE9999
.
WTDE9600  WRITE     HTMLFILE;WMDATE1;
          GOTO      WTDE9999
.
WTDE9700  MATCH     SP70,WMDESC2
          GOTO      WTDE9999 IF EQUAL
          STRIP     WMDESC2
          WRITE     HTMLFILE;*+,WmDESC2
          RESET     WMDESC2
          GOTO      WTDE9999
.
WTDE9800  MATCH     SP70,WMDESC3
          GOTO      WTDE9999 IF EQUAL
          STRIP     WMDESC3
          WRITE     HTMLFILE;*+,WMDESC3
          RESET     WMDESC3
          GOTO      WTDE9999
.
WTDE9999  RETURN
.
.------------------------------------------------------------
. Display Comments
.------------------------------------------------------------
WATCOM00  PACK      KEY21,WMURNO,WMCODE,WMCNT,SP70
          CALL      RDSMESA1
WATCOM10  CALL      RDKMESA1
          BRANCH    OVRCD,WATCOM99
          MATCH     WMURNO,WAURNO
          GOTO      WATCOM99 IF NOT EQUAL
          MATCH     WMCODE,WAPROC
          GOTO      WATCOM99 IF NOT EQUAL
          COMPARE   WMCNT,WACNT
          GOTO      WATCOM99 IF NOT EQUAL
          STRIP     WATEXT
          MOVELPTR  WATEXT,F3
          IF        F3>0
            SFORMAT   VAR,F3
          ELSE
            SFORMAT   VAR,1
          ENDIF
          MOVE      WATEXT,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
.
          GOTO      WATCOM10
WATCOM99  RETURN
.
