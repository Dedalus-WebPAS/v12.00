. *----------------------------------------------------------------------
. * Include Name  :   PMSPYRTM.PBL
. *
. * Function      :   Common CGI functions for Payers details File
. *
. * Modifications :
. *
. * V10.03.00 03/06/2013 J.Tan          CAR 283618
. *           Created Include
. *----------------------------------------------------------------------
.------------------------------------------------------------------------
.   Clear CGI Parameters for PMSPYRFD
.------------------------------------------------------------------------
CPPMPY00  MOVE      Z70,PMPYR001
          MOVE      Z70,PMPYR002
          MOVE      Z70,PMPYR003
          MOVE      Z70,PMPYR004
          MOVE      Z70,PMPYR005
          MOVE      Z70,PMPYR006
          MOVE      Z70,PMPYR007
          MOVE      Z70,PMPYR008
          MOVE      Z70,PMPYR009
          MOVE      Z70,PMPYR010
          MOVE      Z70,PMPYR011
          MOVE      Z70,PMPYR012
          MOVE      Z70,PMPYR013
          MOVE      Z70,PMPYR014
          MOVE      Z70,PMPYR015
          MOVE      Z70,PMPYR016
          MOVE      Z70,PMPYR017
          MOVE      Z70,PMPYR018
          MOVE      Z70,PMPYR019
.
CPPMPY99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for PMSPYRFD
.------------------------------------------------------------
SPPMPY00  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPPMPY01,SPPMPY02,SPPMPY03,SPPMPY04,SPPMPY05:
                       SPPMPY06,SPPMPY07,SPPMPY08,SPPMPY09,SPPMPY10:
                       SPPMPY11,SPPMPY12,SPPMPY13,SPPMPY14,SPPMPY15:
                       SPPMPY16,SPPMPY17,SPPMPY18,SPPMPY19
.
          MOVE      ONE,EXIT
          GOTO      SPPMPY99
.
SPPMPY01  PACK      PMPYR001,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY02  PACK      PMPYR002,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY03  PACK      PMPYR003,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY04  PACK      PMPYR004,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY05  PACK      PMPYR005,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY06  PACK      PMPYR006,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY07  PACK      PMPYR007,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY08  PACK      PMPYR008,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY09  PACK      PMPYR009,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY10  PACK      PMPYR010,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY11  PACK      PMPYR011,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY12  PACK      PMPYR012,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY13  PACK      PMPYR013,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY14  PACK      PMPYR014,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY15  PACK      PMPYR015,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY16  PACK      PMPYR016,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY17  PACK      PMPYR017,QRYDATA,SP70
          GOTO      SPPMPY99
.
SPPMPY18  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00            * Set CMON from MTHNAM3
          PACK      PMPYR018,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMPY99
.
SPPMPY19  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00            * Set CMON from MTHNAM3
          PACK      PMPYR019,CCENT,CYEAR,CMON,CDAY
          GOTO      SPPMPY99
.
SPPMPY99  RETURN
.
.------------------------------------------------------------
. Output PMSPYRFD Fields
.------------------------------------------------------------
PMPYE000  BRANCH    FLDITMNO,PMPYE010,PMPYE020,PMPYE030,PMPYE040,PMPYE050:
                             PMPYE060,PMPYE070,PMPYE080,PMPYE090,PMPYE100:
                             PMPYE110,PMPYE120,PMPYE130,PMPYE140,PMPYE150:
                             PMPYE160,PMPYE170,PMPYE180,PMPYE190
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMPYE999
.
PMPYE010  WRITE     HTMLFILE;PMPYURNO;           * U/R Number
          GOTO      PMPYE999
.
PMPYE020  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,PMPYE021
          WRITE     HTMLFILE;PMPYDEFT;           * default
          GOTO      PMPYE999
.
PMPYE021  MOVE      "No ",KEY3
          MATCH     "1",PMPYDEFT
          IF        @EQUAL
            MOVE      "Yes",KEY3
          ENDIF
          WRITE     HTMLFILE;KEY3;               * default
          GOTO      PMPYE999
.
PMPYE030  MOVE      "CL",CATEGORY                * claim code
          MOVE      PMPYCLTY,CODE
          CALL      CODITM00
          GOTO      PMPYE999
.
PMPYE040  WRITE     HTMLFILE;PMPYTITL;           * Title
          GOTO      PMPYE999
.
PMPYE050  WRITE     HTMLFILE;PMPYSNAM;           * Surname
          GOTO      PMPYE999
.
PMPYE060  WRITE     HTMLFILE;PMPYGNAM;           * Given name
          GOTO      PMPYE999
.
PMPYE070  WRITE     HTMLFILE;PMPYSGNM;           * Second Given name
          GOTO      PMPYE999
.
PMPYE080  WRITE     HTMLFILE;PMPYADD1;           * Address 1
          GOTO      PMPYE999
.
PMPYE090  WRITE     HTMLFILE;PMPYADD2;           * Address 2
          GOTO      PMPYE999
.
PMPYE100  WRITE     HTMLFILE;PMPYADD3;           * Address 3
          GOTO      PMPYE999
.
PMPYE110  WRITE     HTMLFILE;PMPYADD4;           * Address 4
          GOTO      PMPYE999
.
PMPYE120  WRITE     HTMLFILE;PMPYPOST;           * Postcode
          GOTO      PMPYE999
.
PMPYE130  WRITE     HTMLFILE;PMPYRELP;           * Relationship
          GOTO      PMPYE999
.
PMPYE140  WRITE     HTMLFILE;PMPYTELP;           * Private phone
          GOTO      PMPYE999
.
PMPYE150  WRITE     HTMLFILE;PMPYTELB;           * Business phone
          GOTO      PMPYE999
.
PMPYE160  WRITE     HTMLFILE;PMPYTELM;           * Mobile phone
          GOTO      PMPYE999
.
PMPYE170  WRITE     HTMLFILE;PMPYEMAI;           * Email Address
          GOTO      PMPYE999
.
PMPYE180  MATCH     SP70,PMPYEFDT                * Effective date
          GOTO      PMPYE999 IF EQUAL
.
          UNPACK    PMPYEFDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMPYE999
.
PMPYE190  MATCH     SP70,PMPYETDT                * Effective to date
          GOTO      PMPYE999 IF EQUAL
.
          UNPACK    PMPYETDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMPYE999
.
PMPYE999  RETURN
.
.------------------------------------------------------------
.  Update PMSPYRFD file
.------------------------------------------------------------
MVPMPY00  MATCH     PMPYR001,Z70
          IF        !@EQUAL
            MOVE      PMPYR001,PMPYURNO
          ENDIF
.
          MATCH     PMPYR002,Z70
          IF        !@EQUAL
            MOVE      PMPYR002,PMPYDEFT
          ENDIF
.
          MATCH     PMPYR003,Z70
          IF        !@EQUAL
            MOVE      PMPYR003,PMPYCLTY
          ENDIF
.
          MATCH     PMPYR004,Z70
          IF        !@EQUAL
            MOVE      PMPYR004,PMPYTITL
          ENDIF
.
          MATCH     PMPYR005,Z70
          IF        !@EQUAL
            MOVE      PMPYR005,PMPYSNAM
          ENDIF
.
          MATCH     PMPYR006,Z70
          IF        !@EQUAL
            MOVE      PMPYR006,PMPYGNAM
          ENDIF
.
          MATCH     PMPYR007,Z70
          IF        !@EQUAL
            MOVE      PMPYR007,PMPYSGNM
          ENDIF
.
          MATCH     PMPYR008,Z70
          IF        !@EQUAL
            MOVE      PMPYR008,PMPYADD1
          ENDIF
.
          MATCH     PMPYR009,Z70
          IF        !@EQUAL
            MOVE      PMPYR009,PMPYADD2
          ENDIF
.
          MATCH     PMPYR010,Z70
          IF        !@EQUAL
            MOVE      PMPYR010,PMPYADD3
          ENDIF
.
          MATCH     PMPYR011,Z70
          IF        !@EQUAL
            MOVE      PMPYR011,PMPYADD4
          ENDIF
.
          MATCH     PMPYR012,Z70
          IF        !@EQUAL
            MOVE      PMPYR012,PMPYPOST
          ENDIF
.
          MATCH     PMPYR013,Z70
          IF        !@EQUAL
            MOVE      PMPYR013,PMPYRELP
          ENDIF
.
          MATCH     PMPYR014,Z70
          IF        !@EQUAL
            MOVE      PMPYR014,PMPYTELP
          ENDIF
.
          MATCH     PMPYR015,Z70
          IF        !@EQUAL
            MOVE      PMPYR015,PMPYTELB
          ENDIF
.
          MATCH     PMPYR016,Z70
          IF        !@EQUAL
            MOVE      PMPYR016,PMPYTELM
          ENDIF
.
          MATCH     PMPYR017,Z70
          IF        !@EQUAL
            MOVE      PMPYR017,PMPYEMAI
          ENDIF
.
          MATCH     PMPYR018,Z70
          IF        !@EQUAL
            MOVE      PMPYR018,PMPYEFDT
          ENDIF
.
          MATCH     PMPYR019,Z70
          IF        !@EQUAL
            MOVE      PMPYR019,PMPYETDT
          ENDIF
.
          MOVE      SP70,PMPYSPAR
.
MVPMPY99  RETURN
+
