.******************************************************************************
.*                                                                            *
.*      PRIHFCF.PBL - User Defined Health Fund Claim Form Stationery          *
.*      -----------                                                           *
.*                                                                            *
.*      This include assumes the IBATMDFD, IBATMHFD, files have been read with*
.*      a valid stationery code. This must be done each time this include is  *
.*      called.                                                               *
.*      Also the PATMA1FD, PATMI1FD & PATDSCFD must have been read in with a  *
.*      valid admission.                                                      *
.*                                                                            *
.*      This include was initially copied from PATSHT6.                       *
.*                                                                            *
.*      Modifications      :                                                  *
.*                                                                            *
.*----------------------------------------------------------------------------*
.*       V11.04.01  08/10/2024  J.Tan           TSK 0952630                   *
.*                  Fixed printing Item amount with quantity                  *
.*       V11.02.01  24/01/2022  Jacob Jackson   TSK 0864505                   *
.*                  Added preferred name field options -                      *
.*                  PPFC5910, PPFC5920, PPFC5930, PPFC5940, PPFC5950          *
.*       V11.00.01  06/04/2020  Thanh T         TSK 0879163                   *
.*                  Changed PPFC4280, PPFC4290 for Sex category.              *
.*                  Added PPFC5900 for sex long description                   *
.*----------------------------------------------------------------------------*
.*       V10.13.01  27/07/2018  Tracey Nguyen  TSK 0848506                    *
.*                  Replaced RDDOCT1 with RDPMHCP1 and associated table fields*
.*       V10.10.01  23/03/2017  Peter Vela     TSK 0835025                    *
.*                  Added 1st, 2nd, 3rd, 4th Item Time                        *
.*       V10.04.01  24/01/2013  Patrick Adair  CAR 265844                     *
.*                  Add new fields for PRA State, Full Address and Mobile     *
.*                  Add new fields for Patient Full Address                   * 
.*       V10.03.01  22/05/2013  J.Tan          CAR 275330                     *
.*                  Mods to print unlimited number of items                   *
.*        V9.12.04  18/02/2010  Peter Vela     CAR 216465                     *
.*                  Added item quantity                                       *
.*        V9.12.03  07/10/2009  Peter Vela     CAR 205008                     *
.*                  Fixed item service date                                   *
.*                  Fixed item amount                                         *
.*                  Fixed patient age                                         *
.*        V9.12.02  01/10/2009  Peter Vela     CAR 203243                     *
.*                  Added Medical Practice Service Doctor Provider Number     *
.*        V9.12.01  15/09/2009  Peter Vela     CAR 205008                     *
.*                  Created include. Private Practice Stationery Template     *
.*                  Variables. Private Practice National Claim Form           *
.******************************************************************************
+
. ---- Print Lineup for Private Practice Health Fund Claim Form ----
.
LNUPPFCF  PROC      LPFC0000
          RETURN
+
. ---- Print Health Fund Claim Form ----
.
PRVHFCF   PROC      PPFC0000
          RETURN
+
.*******************************************************************************
.*                                 LHFC0000                                    *
.*                    Print Line Up Priv Prac Health Fund Claim Form           *
.*******************************************************************************
.
          DEFPROC   LPFC0000
.
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
.
VARIABLE  DIM       127
+
LPFC0000  OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
.
          PACK      KEY6,STATNCOD           * re-read header file
          CALL      RDIBTH1
.
          PACK      KEY12,STATNCOD,SP20     * re-read first detail field
          CALL      RSIBDET1
          CALL      RKIBDET1
.
          CALL      OPNPRINT                * Open spool file
          MOVE      ONE,CURRROW             * Initialize current row counter
LPFC0500  COMPARE   CURRROW,IBDTROW         * Current row up to required row ?
          GOTO      LPFC2000 IF EQUAL       * Yes - print data
          PRINT     *N;                     * Else print 1 extra line
          ADD       ONE,CURRROW             * Increment counter
          GOTO      LPFC0500                * Check counter again
.
. ----- Read through the details file -----
.
LPFC1000  CALL      RKIBDET1                * Read next detail record
          BRANCH    OVRCD,LPFC9000          * No more records - pad out form
.
          MATCH     STATNCOD,IBDTSCOD       * Same form ?
          GOTO      LPFC9000 IF NOT EQUAL   * No - pad out rest of form
.
LPFC1500  COMPARE   CURRROW,IBDTROW         * Are we at the required row ?
          GOTO      LPFC2000 IF EQUAL       * Yes - print data
          PRINT     *N;                     * Else pad out to required row
          ADD       ONE,CURRROW             * One more row printed
          GOTO      LPFC1500                * Check row count
.
. ----- Print actual data lines -----
.
LPFC2000  BRANCH    IBDTINDC,LPFC3000:      * Text field
                             LPFC4000       * Data field
.
. ----- Print text field -----
.
LPFC3000  RESET     IBDTTXFL,IBDTPLEN
          LENSET    IBDTTXFL
          RESET     IBDTTXFL
          PRINT     *IBDTCOL,*+,IBDTTXFL;   * Print data
          MOVE      IBDTROW,CURRROW         * Row printed is current row
          GOTO      LPFC1000                * Read next record
.
. ----- Print data field -----
.
LPFC4000  MOVE      IBDTTXFL,KEY5           * Data number 1st 3 chars of field
          MOVE      KEY5,FORM5              * Move to a FORM field for BRANCH
.
          PACK      VARIABLE,SP30,SP30,SP30,SP30,SP30
          BRANCH    FORM5,LPFC4180,LPFC4120,LPFC4080,LPFC4170,LPFC4170:   *   5
                          LPFC5020,LPFC4170,LPFC4170,LPFC5020,LPFC5040:   *  10
                          LPFC4060,LPFC4160,LPFC4150,LPFC4210,LPFC4160:   *  15
                          LPFC4060,LPFC4140,LPFC4060,LPFC5020,LPFC4130:   *  20
                          LPFC4130,LPFC4020,LPFC5000,LPFC5000,LPFC5000:   *  25
                          LPFC4060,LPFC4030,LPFC4030,LPFC4030,LPFC4080:   *  30
                          LPFC4170,LPFC4100,LPFC4170,LPFC4110,LPFC4080:   *  35
                          LPFC4170,LPFC4080,LPFC4215,LPFC4160,LPFC4160:   *  40
                          LPFC4160,LPFC4060,LPFC4130,LPFC4100,LPFC4120:   *  45
                          LPFC4050,LPFC4180,LPFC4080,LPFC4215,LPFC4150:   *  50
                          LPFC4180,LPFC4180,LPFC4180,LPFC4180,LPFC4100:   *  55
                          LPFC4050,LPFC4150,LPFC4080,LPFC4215,LPFC4150:   *  60
                          LPFC4180,LPFC4180,LPFC4180,LPFC4180,LPFC4100:   *  65
                          LPFC4020,LPFC4200,LPFC4050,LPFC4050,LPFC4150:   *  70
                          LPFC4080,LPFC4150,LPFC4050,LPFC4150,LPFC4050:   *  75
                          LPFC4150,LPFC4050,LPFC4150,LPFC4050,LPFC4060:   *  80
                          LPFC4200,LPFC4160,LPFC4160,LPFC4160,LPFC4060:   *  85
                          LPFC4130,LPFC4130,LPFC4120,LPFC4170,LPFC5040:   *  90
                          LPFC4050,LPFC4150,LPFC4050,LPFC4150,LPFC4050:   *  95
                          LPFC4150,LPFC4020,LPFC4030,LPFC4030,LPFC4030:   * 100
                          LPFC4010,LPFC4040,LPFC4040,LPFC4060,LPFC4050:   * 105
                          LPFC4150,LPFC4050,LPFC4150,LPFC4050,LPFC4150:   * 110
                          LPFC4100,LPFC4170,LPFC4100,LPFC4140,LPFC4140:   * 115
                          LPFC4140,LPFC4140,LPFC4140,LPFC4140,LPFC4140:   * 120
                          LPFC4140,LPFC4140,LPFC4140,LPFC4140,LPFC4140:   * 125
                          LPFC4110,LPFC4140,LPFC4050,LPFC4150,LPFC4100:   * 130
                          LPFC4030,LPFC4150,LPFC4050,LPFC4150,LPFC4010:   * 135
                          LPFC4140,LPFC4170,LPFC4110,LPFC4140,LPFC4050:   * 140
                          LPFC4150,LPFC4100,LPFC4030,LPFC4150,LPFC4050:   * 145
                          LPFC4150,LPFC4010,LPFC4140,LPFC4170,LPFC4110:   * 150
                          LPFC4140,LPFC4050,LPFC4150,LPFC4100,LPFC4030:   * 155
                          LPFC4150,LPFC4050,LPFC4150,LPFC4010,LPFC4140:   * 160
                          LPFC4170,LPFC4110,LPFC4140,LPFC4050,LPFC4150:   * 165
                          LPFC4100,LPFC4030,LPFC4150,LPFC4050,LPFC4150:   * 170
                          LPFC4010,LPFC4140,LPFC4170,LPFC4120,LPFC4120:   * 175
                          LPFC4120,LPFC4120,LPFC5025,LPFC5025,LPFC5025:   * 180
                          LPFC5025,LPFC4180,LPFC4225,LPFC4180,LPFC4150:   * 185
                          LPFC4020,LPFC4020,LPFC4020,LPFC4020
.
          GOTO      LPFC1000                                           *C-57547
.
. ----- Date - MM/DD/YY -----
.
LPFC4010  MOVE      "99/99/99",VARIABLE
          GOTO      LPFC7000
.
. ----- Date - MM/DD/CCYY -----
.
LPFC4020  MOVE      "99/99/9999",VARIABLE
          GOTO      LPFC7000
.
. ----- Time - 99:99 -----                                             *C-57547
.
LPFC4025  MOVE      "99:99",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 1 -----
.
LPFC4030  MOVE      "X",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 2 -----
.
LPFC4040  MOVE      "XX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 3 -----
.
LPFC4050  MOVE      "XXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 4 -----
.
LPFC4060  MOVE      "XXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 5 -----
.
LPFC4070  MOVE      "XXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 6 -----
.
LPFC4080  MOVE      "XXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 7 -----
.
LPFC4090  MOVE      "XXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 8 -----
.
LPFC4100  MOVE      "XXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 9 -----
.
LPFC4110  MOVE      "XXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 10 -----
.
LPFC4120  MOVE      "XXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 12 -----
.
LPFC4130  MOVE      "XXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 15 -----
.
LPFC4140  MOVE      "XXXXXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 20 -----
.
LPFC4150  MOVE      "XXXXXXXXXXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 25 -----
.
LPFC4160  MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 30 -----
.
LPFC4170  MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 35 -----
.
LPFC4180  MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 40 -----
.
LPFC4190  MOVE      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 50 -----
.
LPFC4200  CLEAR     VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          RESET     VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 65 -----
.
LPFC4210  CLEAR     VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          RESET     VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 60 -----                                   *I-57547
.
LPFC4215  CLEAR     VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          RESET     VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 70 -----
.
LPFC4220  CLEAR     VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          RESET     VARIABLE
          GOTO      LPFC7000
.
. ----- Alpha Numeric - Dim 80 -----                                   *I-57547
.
LPFC4225  CLEAR     VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          APPEND    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",VARIABLE
          RESET     VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 1 -----
.
LPFC4990  MOVE      "9",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 2 -----
.
LPFC5000  MOVE      "99",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 3 -----
.
LPFC5010  MOVE      "999",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 4 -----
.
LPFC5020  MOVE      "9999",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 5 -----
.
LPFC5025  MOVE      "99999",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 6 -----
.
LPFC5030  MOVE      "999999",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 8 -----
.
LPFC5040  MOVE      "99999999",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 8.2 -----
.
LPFC5050  MOVE      "99999999.99",VARIABLE
          GOTO      LPFC7000
.
. ----- Numeric - Form 6.2 -----
.
LPFC5060  MOVE      "999999.99",VARIABLE
          GOTO      LPFC7000
.
. ----- Time - 99:99:99 -----
.
LPFC5070  MOVE      "99:99:99",VARIABLE
          GOTO      LPFC7000
.
. ----- Format the variable -----
.
LPFC7000  RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
          PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      LPFC1000                * Read next record
.
. ----- End of HFCF, Print new lines until the end of page is reached -----
.
LPFC9000  COMPARE   CURRROW,IBTHLENG        * Test page length
          GOTO      LPFC9999 IF LESS
.
          PRINT     *N;
          ADD       ONE,CURRROW
          GOTO      LPFC9000
.
LPFC9999  CALL      CLSPRINT                * Close the spool file
          GOTO      ENDLPFCF
.
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
          INC       IBAOVRIO/INC
.
ENDLPFCF  ENDPROC                           * Finished
+
.*******************************************************************************
.*                                  PPFC0000                                   *
.*                        Print Health Fund Claim Form                         *
.*******************************************************************************
.
          DEFPROC   PPFC0000
.
          INC       OPRCONFD/INC
          INC       OPRDEAFD/INC
          INC       OPRDECFD/INC
          INC       PATDTRFD/INC
          INC       PATDADFD/INC
          INC       PATECDFD/INC
          INC       PATECOFD/INC
          INC       PATICDFD/INC
          INC       PATICOFD/INC
          INC       PATICUFD/INC
          INC       PATPGRFD/INC
          INC       PATMMBFD/INC
          INC       PATTRNFD/INC
          INC       PATVADFD/INC
          INC       PATHFCVR/INC
          INC       IBATMHFD/INC
          INC       IBATMDFD/INC
          INC       IBAVARFD/INC
+
ITEMBTCH  FORM      3
ITEMCOUN  FORM      3
ITMKEY22  DIM       22[999]
ITEMCNUM  FORM      3
.
PRIDTRCN  FORM      3
VARIABLE  DIM       127
.
SP27      INIT      "                           "
SP100     INIT      "                                                  ":
                    "                                                  "
ZED10     INIT      "zzzzzzzzzz"
+
PPFC0000  OPEN      PATDADA1,"patdadaf"
          OPEN      PATDTRA1,"patdtraf"
          OPEN      PATECDA1,"patecdaf"
          OPEN      PATECDA2,"patecdaf"
          OPEN      PATECOA1,"patecoaf"
          OPEN      PATECOA2,"patecoaf"
          OPEN      PATICUA1,"paticuaf"
          OPEN      PATMMBS1,"patmmbsf"
          OPEN      PATTRAN2,"pattranf"
          OPEN      PATVADA1,"patvadaf"
          OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
          CALL      IBACLOCK                * get current date - century
.                                             required for transfer dates
          CALL      OPNPRINT                * Open spool file
.
.         CALL      OPICO1
.         CALL      OPICD1
.
.         MOVE      ZERO,OVRCD
.         TRAP      OVERCOND IF IO
.         OPEN      OPRDETA2,"oprdetaf"
.         TRAPCLR   IO
.         MOVE      OVRCD,OPRFOUND
.         BRANCH    OVRCD,PPFC0100
.
          OPEN      OPRDETC1,"oprdetcf"
.
          MOVE      ONE,ITEMCOUN
          CALL      SETI0000                * Set up array of item index records
.
PPFC0100  MOVE      ZERO,DSCHFLAG           * initialise discharge flag
          MOVE      ZERO,SAVRATE            *     "      saved daily rate
          MOVE      SP1,SAVACOM             *     "      saved accomm. code
          MOVE      ZERO,FRSTFLAG           *     "      loop flag
          MOVE      ONE,CPAGENO             *     "      page count
.         MOVE      SP30,SAVKEY30
.         MOVE      ZERO,DTGTNTRD           * Dont get next tran record - no
.
          MOVE      ZERO,TRANFLAG           * set to no transfer fields found
          MOVE      ZERO,MMBSFLAG           * set to no transfer fields found
          MOVE      ZERO,SERVFLAG           * set to no transfer fields found
.         MOVE      ZERO,COUNT
          MOVE      ZERO,THETIMES           * set to no Theater times  *C-V-015
          MOVE      ZERO,BABYFLAG           * set to 6 when finished   *I-62428
          MOVE      SP30,PREVSTTM           * MBS theatre time         *C-V-015
.
.         MOVE      ZERO,DAYCLAIM[1]
.         MOVE      ZERO,DAYCLAIM[2]
.         MOVE      ZERO,DAYCLAIM[3]
.         MOVE      ZERO,DAYCLAIM[4]
.
          PACK      KEY6,STATNCOD           * re-read header file
          CALL      RDIBTH1
.
          PACK      KEY12,STATNCOD,SP20     * re-read first detail field
          CALL      RSIBDET1
          CALL      RKIBDET1
.
PPFC0200  MOVE      ONE,CURRROW             * Initialize current row counter
PPFC0500  COMPARE   CURRROW,IBDTROW         * Current row up to required row ?
          GOTO      PPFC2000 IF EQUAL       * Yes - print data
          PRINT     *N;                     * Else print 1 extra line
          ADD       ONE,CURRROW             * Increment counter
          GOTO      PPFC0500                * Check counter again
.
. ----- Read through the details file -----
.
PPFC1000  CALL      RKIBDET1                * Read next detail record
          BRANCH    OVRCD,PPFC9000          * No more records - pad out form
.
          MATCH     STATNCOD,IBDTSCOD       * Same form ?
          GOTO      PPFC9000 IF NOT EQUAL   * No - pad out rest of form
.
PPFC1500  COMPARE   CURRROW,IBDTROW         * Are we at the required row ?
          GOTO      PPFC2000 IF EQUAL       * Yes - print data
          PRINT     *N;                     * Else pad out to required row
          ADD       ONE,CURRROW             * One more row printed
          GOTO      PPFC1500                * Check row count
.
. ----- Print actual data lines -----
.
PPFC2000  BRANCH    IBDTINDC,PPFC3000:      * Text field
                             PPFC4000       * Data field
.
. ----- Print text field -----
.
PPFC3000  RESET     IBDTTXFL,IBDTPLEN
          LENSET    IBDTTXFL
          RESET     IBDTTXFL
          PRINT     *IBDTCOL,*+,IBDTTXFL;   * Print data
          MOVE      IBDTROW,CURRROW         * Row printed is current row
          GOTO      PPFC1000                * Read next record
.
. ----- Print data field -----
.
PPFC4000  MOVE      IBDTTXFL,KEY5           * Data number 1st 3 chars of field
          MOVE      KEY5,FORM5              * Move to a FORM field for BRANCH
.
          PACK      VARIABLE,SP100,SP27     * Initialize variable
          BRANCH    FORM5,PPFC4010,PPFC4020,PPFC4030,PPFC4040,PPFC4050:   *   5
                          PPFC4060,PPFC4070,PPFC4080,PPFC4090,PPFC4100:   *  10
                          PPFC4110,PPFC4120,PPFC4130,PPFC4140,PPFC4150:   *  15
                          PPFC4160,PPFC4170,PPFC4180,PPFC4190,PPFC4200:   *  20
                          PPFC4210,PPFC4220,PPFC4230,PPFC4240,PPFC4250:   *  25
                          PPFC4260,PPFC4270,PPFC4280,PPFC4290,PPFC4300:   *  30
                          PPFC4310,PPFC4320,PPFC4330,PPFC4340,PPFC4350:   *  35
                          PPFC4360,PPFC4370,PPFC4380,PPFC4390,PPFC4400:   *  40
                          PPFC4410,PPFC4420,PPFC4430,PPFC4440,PPFC4450:   *  45
                          PPFC4460,PPFC4470,PPFC4480,PPFC4490,PPFC4500:   *  50
                          PPFC4510,PPFC4520,PPFC4530,PPFC4540,PPFC4550:   *  55
                          PPFC4560,PPFC4570,PPFC4580,PPFC4590,PPFC4600:   *  60
                          PPFC4610,PPFC4620,PPFC4630,PPFC4640,PPFC4650:   *  65
                          PPFC4660,PPFC4670,PPFC4680,PPFC4690,PPFC4700:   *  70
                          PPFC4710,PPFC4720,PPFC4730,PPFC4740,PPFC4750:   *  75
                          PPFC4760,PPFC4770,PPFC4780,PPFC4790,PPFC4800:   *  80
                          PPFC4810,PPFC4820,PPFC4830,PPFC4840,PPFC4850:   *  85
                          PPFC4860,PPFC4870,PPFC4880,PPFC4890,PPFC4900:   *  90
                          PPFC4910,PPFC4920,PPFC4930,PPFC4940,PPFC4950:   *  95
                          PPFC4960,PPFC4970,PPFC4980,PPFC4990,PPFC5000:   * 100
                          PPFC5010,PPFC5020,PPFC5030,PPFC5040,PPFC5050:   * 105
                          PPFC5060,PPFC5070,PPFC5080,PPFC5090,PPFC5100:   * 110
                          PPFC5110,PPFC5120,PPFC5130,PPFC5140,PPFC5150:   * 115
                          PPFC5160,PPFC5170,PPFC5180,PPFC5190,PPFC5200:   * 120
                          PPFC5210,PPFC5220,PPFC5230,PPFC5240,PPFC5250:   * 125
                          PPFC5260,PPFC5270,PPFC5280,PPFC5290,PPFC5300:   * 130
                          PPFC5310,PPFC5320,PPFC5330,PPFC5340,PPFC5350:   * 135
                          PPFC5360,PPFC5370,PPFC5380,PPFC5390,PPFC5400:   * 140
                          PPFC5410,PPFC5420,PPFC5430,PPFC5440,PPFC5450:   * 145
                          PPFC5460,PPFC5470,PPFC5480,PPFC5490,PPFC5500:   * 150
                          PPFC5510,PPFC5520,PPFC5530,PPFC5540,PPFC5550:   * 155
                          PPFC5560,PPFC5570,PPFC5580,PPFC5590,PPFC5600:   * 160
                          PPFC5610,PPFC5620,PPFC5630,PPFC5640,PPFC5650:   * 165
                          PPFC5660,PPFC5670,PPFC5680,PPFC5690,PPFC5700:   * 170
                          PPFC5710,PPFC5720,PPFC5730,PPFC5740,PPFC5750:   * 175
                          PPFC5760,PPFC5770,PPFC5780,PPFC5790,PPFC5800:   * 180
                          PPFC5810,PPFC5820,PPFC5820,PPFC5840,PPFC5850:
                          PPFC5860,PPFC5870,PPFC5880,PPFC5890,PPFC5900:   * 190
                          PPFC5910,PPFC5920,PPFC5930,PPFC5940,PPFC5950    * 195
.
          GOTO            PPFC1000                                     *C-57547
.
. ----- Hospital Name -----
.
PPFC4010  MOVE      CNAME,VARIABLE
.         IF        IBCNMHOS=1
.           PACK      VARIABLE,PTHSNAME,SP70
.         ENDIF
          GOTO      PPFC7500
.
. ----- Hospital approval number -----
.
PPFC4020  MOVE      CAPPRVNO,VARIABLE
.         IF        IBCNMHOS=1
.           PACK      VARIABLE,PTHSAPPR,SP70
.         ENDIF     
          GOTO      PPFC7500
.
. ----- Hospital file number -----
.         
PPFC4030  MOVE      CFILENO,VARIABLE
          GOTO      PPFC7500
.
. ----- Hospital address line 1 -----
.         
PPFC4040  MOVE      CHADD1,VARIABLE
          GOTO      PPFC7500
.
. ----- Hospital address line 2 -----
.
PPFC4050  MOVE      CHADD2,VARIABLE
          GOTO      PPFC7500
.
. ----- Hospital postcode -----
.
PPFC4060  MOVE      CHPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- Hospital postal address line 1 -----
.
PPFC4070  MOVE      CHPADD1,VARIABLE
          GOTO      PPFC7500
.
. ----- Hospital postal address line 2 -----
.
PPFC4080  MOVE      CHPADD2,VARIABLE
          GOTO      PPFC7500
.
. ----- Hospital postal postcode -----
.
PPFC4090  MOVE      CHPPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient U/R number -----
.
PPFC4100  MOVE      PURNO,VARIABLE
          MOVE      EIGHT,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PPFC8000
.
. ----- Patient title -----                   
.
PPFC4110  MOVE      PTITL,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient given name -----
.
PPFC4120  MOVE      PGNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient surname -----
.
PPFC4130  MOVE      PSNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Formatted patient's name -----
.
PPFC4140  MOVE      PSNAME,PACSNAME
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME                 * Format patient's name
          MOVE      PACFNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient address line 1 -----
.
PPFC4150  MOVE      PADD1,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient address line 2 -----
.
PPFC4160  MOVE      PADD2,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient address line 3 (suburb) -----
.         
PPFC4170  MOVE      PSUBRB,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient address line 4 -----
.
PPFC4180  MOVE      PADD4,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient postcode -----
.         
PPFC4190  MOVE      PPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient home telephone -----
.
PPFC4200  MOVE      PTELEP,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient work telephone -----
.
PPFC4210  MOVE      PTELEB,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient birth date -----
.
PPFC4220  UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * Format patient's birth date
          MOVE      CPCDATE,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient day of birth -----
. 
PPFC4230  UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          MOVE      XDAY,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient month of birth -----
.
PPFC4240  UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          MOVE      XMON,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient year of birth -----
.
PPFC4250  UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          IF        IBDTPLEN = 2
            MOVE      XYEAR,VARIABLE
          ELSE
            PACK      VARIABLE,XCENT,XYEAR
          ENDIF
          GOTO      PPFC7500
.
. ----- Patient age at admission -----
.
PPFC4260  MATCH     SP70,PRHRRDAT
          IF        !@EQUAL & !@EOS
            PACK      AGEDATE,PRHRRDAT
          ELSE
            PACK      AGEDATE,CCC,CYY,CMM,CDD
          ENDIF
          CALL      CALCAGE                 * Calculate patients age at admin
          MOVE      PSAGEYRS,VARIABLE     * > 1 year old, use years
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PPFC8000
.
. ----- Patient sex -----
.         
PPFC4270  MOVE      PSEX,VARIABLE
          GOTO      PPFC7500
.
. ----- 'X' if male -----
.
PPFC4280  MOVE      PSEX,VARIABLE
          GOTO      PPFC7500
.
. ----- 'X' if female -----
.           
PPFC4290  MOVE      PSEX,VARIABLE 
          GOTO      PPFC7500
.
. ----- Health fund code -----
.
PPFC4300  MOVE      PFUNDH,VARIABLE
          GOTO      PPFC7500
.
. ----- Health fund code description -----
.
PPFC4310  PACK      KEY14,PFUNDH,ZERO4,SP10
          CALL      RDFUND1                 * Read the health fund file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
          MOVE      HFNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Health fund table code -----
.
PPFC4320  MOVE      PFNDTB,VARIABLE
          GOTO      PPFC7500
.
. ----- Health fund table code description -----
.
PPFC4330  PACK      KEY14,PFUNDH,PFNDTB,SP10
          CALL      RDFUND1                 * Read the health fund file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF     
          MOVE      HFNAME,VARIABLE         
          GOTO      PPFC7500
.
. ----- Health fund membership number -----
.
PPFC4340  MOVE      PFNDMM,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice code -----
.
PPFC4350  MOVE      PRPRCODE,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice description -----
.
PPFC4360  MOVE      PRPRDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Primary Doctor Code -----
.
PPFC4370  MOVE      PRPRPDOC,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Primary Doctor Description -----
.
PPFC4380  MATCH     SP70,PRPRPDOC
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRPRPDOC,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME               * Format doctors name
          MOVE      PACFNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Address Line 1 -----
.
PPFC4390  MOVE      PRPRADD1,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Address Line 2 -----
.
PPFC4400  MOVE      PRPRADD2,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Address Line 3 -----
.
PPFC4410  MOVE      PRPRADD3,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Postcode -----
.
PPFC4420  MOVE      PRPRPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Telephone -----
.
PPFC4430  MOVE      PRPRTELP,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice MCI -----
.
PPFC4440  MOVE      PRPRPMCI,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Payee Name Provider Number -----
.
PPFC4450  MOVE      PRPRPYEE,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Register Code -----
.
PPFC4460  MOVE      PRPRREGI,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Register Description -----
.
PPFC4470  MATCH     SP70,PRPRREGI
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY3,PRPRREGI,SP70
          CALL      RDREGA1
          IF        OVRCD=0
            MOVE      REGDESC,VARIABLE
          ENDIF
.
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Code -----
.
PPFC4480  MOVE      PRHRDOCT,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Description -----
.
PPFC4490  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME               * Format doctors name
          MOVE      PACFNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Telephone -----
.
PPFC4500  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF     
.
          MOVE      PMHCSTEL,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Address 1 -----
.
PPFC4510  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR1,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Address 2 -----
.
PPFC4520  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR2,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Address 3 -----
.
PPFC4530  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR3,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Address 4 -----
.
PPFC4540  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR4,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Postcode -----
.
PPFC4550  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Patient Indicator Code -----
.         
PPFC4560  MOVE      PRHRPIND,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Patient Indicator Description -----
.
PPFC4570  MATCH     SP70,PRHRPIND
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSG,ANSI,PRHRPIND,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Code -----
.
PPFC4580  MOVE      PRHRREFD,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Description -----
.
PPFC4590  MATCH     SP70,PRHRREFD 
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.         
          PACK      KEY10,PRHRREFD,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF     
.           
          MOVE      PMHCSNAM,PACSNAME
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCTITL,PACTITLE
          MOVE      TWO,PACFRMT
          CALL      PACNAME               * Format doctors name
          MOVE      PACFNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Telephone -----
.         
PPFC4600  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRREFD,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCSTEL,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Address 1 -----
.
PPFC4610  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.         
          PACK      KEY10,PRHRREFD,SP70    
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.         
          MOVE      PMHCADR1,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Address 2 -----
.
PPFC4620  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRREFD,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR2,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Address 3 -----
.
PPFC4630  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRREFD,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR3,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Address 4 -----
.
PPFC4640  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRREFD,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCADR4,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Referring Doctor Postcode -----
.
PPFC4650  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRREFD,SP70      
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF     
.         
          MOVE      PMHCPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- Referral date -----
. 
PPFC4660  UNPACK    PRHRRDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PPFC7500
.
. ----- Referral Details -----
.
PPFC4670  MOVE      PRHRREFT,VARIABLE
          GOTO      PPFC7500
.
. ----- Message Code -----
.
PPFC4680  MOVE      PRHRMESS,VARIABLE
          GOTO      PPFC7500
.
. ----- Bulk Bill Code -----
.
PPFC4690  MOVE      PRHRBULK,VARIABLE   
          GOTO      PPFC7500
.
. ----- Bulk Bill Description -----
.
PPFC4700  MATCH     SP70,PRHRBULK
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSG,ANSB,PRHRBULK,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Fund/Insurance Co./Govt Code -----
.
PPFC4710  MOVE      PRHRBCOD,VARIABLE
          GOTO      PPFC7500
.
. ----- Operation Codes -----
.
PPFC4720  MOVE      PRHROCOD,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 1 code -----
.
PPFC4730  MOVE      PRHRUDF1,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 1 description -----
.
PPFC4740  MATCH     SP70,PRHRUDF1
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSG,ONE,PRHRUDF1,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 2 code -----
.
PPFC4750  MOVE      PRHRUDF2,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 2 description -----
.
PPFC4760  MATCH     SP70,PRHRUDF2
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSG,TWO,PRHRUDF2,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 3 code -----
.
PPFC4770  MOVE      PRHRUDF3,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 3 description -----
.
PPFC4780  MATCH     SP70,PRHRUDF3
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSG,THREE,PRHRUDF3,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 4 code -----
.
PPFC4790  MOVE      PRHRUDF4,VARIABLE
          GOTO      PPFC7500
.
. ----- User Defined Field 4 description -----
.
PPFC4800  MATCH     SP70,PRHRUDF4
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSG,FOUR,PRHRUDF4,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Name of Person Responsible for A/C -----
.
PPFC4810  MOVE      PRHRNAME,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Address Line 1 -----
.
PPFC4820  MOVE      PRHRADD1,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Address Line 2 -----
.
PPFC4830  MOVE      PRHRADD2,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Address Line 3 -----
.
PPFC4840  MOVE      PRHRADD3,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Postcode -----
.
PPFC4850  MOVE      PRHRPOST,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Private Telephone -----
.
PPFC4860  MOVE      PRHRTELP,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Business Telephone -----
.
PPFC4870  MOVE      PRHRTELB,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Relationship Code -----
.
PPFC4880  MOVE      PRHRRELP,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Relationship Description  -----
.         
PPFC4890  MATCH     SP70,PRHRRELP
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.         
          PACK      KEY10,PRHRRELP,SP70
          CALL      RDPMREL1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      PMRLDESC,VARIABLE 
          GOTO      PPFC7500
.
. ----- Unique Claims Number -----
.
PPFC4900  MOVE      PRHRUNCL,VARIABLE
          GOTO      PPFC7500
.
. ----- Admission Class Code -----
.
PPFC4910  MOVE      PRHRADMN,VARIABLE
          GOTO      PPFC7500
.
. ----- Admission Class Description -----
.
PPFC4920  MATCH     SP70,PRHRADMN
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSP,SP1,PRHRADMN,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Referral Period Code -----
.
PPFC4930  MOVE      PRHRRFPD,VARIABLE
          GOTO      PPFC7500
.
. ----- Referral Period Description -----
. 
PPFC4940  MATCH     SP70,PRHRRFPD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.         
          PACK      KEY5,ANSR,ANSF,PRHRRFPD,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Claim Code -----
.
PPFC4950  MOVE      PRHDCLAM,VARIABLE
          GOTO      PPFC7500
.
. ----- Claim Code Description -----
.
PPFC4960  MATCH     SP70,PRHDCLAM
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSC,ANSL,PRHDCLAM,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Accident date -----
.
PPFC4970  UNPACK    PRHDACCD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,VARIABLE
          GOTO      PPFC7500
.
. ----- X if DVA Patient -----
. 
PPFC4980  MATCH     SP70,PRHDCLAM
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.         
          PACK      KEY5,ANSC,ANSL,PRHDCLAM,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      ZERO,FORM1
          WHILE     FORM1 < 5
            ADD       ONE,FORM1
            LOAD      ANS,FORM1,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
            MATCH     ANSV,ANS                   * DVA code ?
            IF        @EQUAL
              MOVE      ANSX,VARIABLE
              GOTO      PPFC7500
            ENDIF
          DO
          GOTO      PPFC7500
.
. ----- X if Workcare Patient -----
.
PPFC4990  MATCH     SP70,PRHDCLAM
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSC,ANSL,PRHDCLAM,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      ZERO,FORM1
          WHILE     FORM1 < 5
            ADD       ONE,FORM1
            LOAD      ANS,FORM1,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
            MATCH     ANSW,ANS                   * DVA code ?
            IF        @EQUAL
              MOVE      ANSX,VARIABLE
              GOTO      PPFC7500
            ENDIF
          DO
          GOTO      PPFC7500
.
. ----- X if TAC Patient -----
.
PPFC5000  MATCH     SP70,PRHDCLAM
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSC,ANSL,PRHDCLAM,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      ZERO,FORM1
          WHILE     FORM1 < 5
            ADD       ONE,FORM1
            LOAD      ANS,FORM1,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5
            MATCH     ANSM,ANS                   * DVA code ?
            IF        @EQUAL
              MOVE      ANSX,VARIABLE
              GOTO      PPFC7500
            ENDIF
          DO
          GOTO      PPFC7500
.
. ----- Current date -----
.
PPFC5010  
.         REP       " 0",CDATE
.         MOVE      CDATE,VARIABLE
          PACK      VARIABLE,CDD,SLASH,CMM,SLASH,CYY
          REP       " 0",VARIABLE
          GOTO      PPFC7500
.
. ----- Current day -----
.
PPFC5020  MOVE      CDD,VARIABLE
          REP       " 0",VARIABLE
          MOVE      TWO,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PPFC8000
.
. ----- Current month -----
.
PPFC5030  MOVE      CMM,VARIABLE
          REP       " 0",VARIABLE
          MOVE      TWO,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      PPFC8000
.
. ----- Current year -----
.
PPFC5040  IF        IBDTPLEN = 2
            MOVE      CYY,VARIABLE
            MOVE      TWO,PRNTSTRT
            SUB       IBDTPLEN,PRNTSTRT
          ELSE
            PACK      VARIABLE,CCC,CYY
            REP       " 0",VARIABLE
            MOVE      FOUR,PRNTSTRT
            SUB       IBDTPLEN,PRNTSTRT
          ENDIF
          GOTO      PPFC8000
.
. ----- Patient Marital Status
.
PPFC5050  MOVE      PMSTAT,VARIABLE
          GOTO      PPFC7500
.
. ----- Marital Status Description -----
.
PPFC5060  MATCH     SP70,PMSTAT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.         
          PACK      KEY5,ANSM,SP1,PMSTAT,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.         
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient Country of Birth
.
PPFC5070  MOVE      PCONT,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient Country of Birth Description -----
.
PPFC5080  MATCH     SP70,PCONT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSC,SP1,PCONT,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
. ----- Language at Home
.
PPFC5090  MOVE      PMPXLNG1,VARIABLE
          GOTO      PPFC7500
.
. ----- Language at Home Description -----
.
PPFC5100  MATCH     SP70,PMPXLNG1
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY5,ANSL,ANSA,PMPXLNG1,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PPFC7500
.
          MOVE      TDESC,VARIABLE
          GOTO      PPFC7500
.
PPFC5110  CLOCK     TIME,VARIABLE
          GOTO      PPFC7500
.
PPFC5120  MOVE      WBSENAM,VARIABLE
          GOTO      PPFC7500
.
. ----- Invoice Number
.
PPFC5130  MOVE      PRINNUMB,VARIABLE
          GOTO      PPFC7500
.
. ----- Invoice Total
.
PPFC5140  MOVE      PRINITOT,VARIABLE
          GOTO      PPFC7500
.
. ----- Amount Paid by Patient
.
PPFC5150  MOVE      PRINPAMT,VARIABLE
          GOTO      PPFC7500
.
. ----- Amount Paid by Health Fund
.
PPFC5160  MOVE      PRINHAMT,VARIABLE
          GOTO      PPFC7500
.
. ----- Amount Paid by Insurer
.
PPFC5170  MOVE      PRINIAMT,VARIABLE
          GOTO      PPFC7500
.
. ----- Amount Paid by Medicare
.
PPFC5180  MOVE      PRINMAMT,VARIABLE
          GOTO      PPFC7500
.
. ----- Amount Paid by Vet Affairs
.
PPFC5190  MOVE      PRINVAMT,VARIABLE
          GOTO      PPFC7500
.
. ----- Other Amount Paid
.
PPFC5200  MOVE      PRINOTHA,VARIABLE
          GOTO      PPFC7500
.
. ----- Journal Amount 
.
PPFC5210  MOVE      PRINJAMT,VARIABLE
          GOTO      PPFC7500
.
. ----- Cash Pending
.
PPFC5220  MOVE      PRINPEND,VARIABLE
          GOTO      PPFC7500
.
. ----- GST Amount
.
PPFC5230  MOVE      PRINGSTA,VARIABLE
          GOTO      PPFC7500
.
. ----- GST Journal Amount
.
PPFC5240  MOVE      PRINGSTJ,VARIABLE
          GOTO      PPFC7500
.
. ----- Credit Note Total
.
PPFC5250  MOVE      PRINCNTT,VARIABLE
          GOTO      PPFC7500
.
. ----- 1st Item Code ------
.
PPFC5260  MOVE      ONE,ITEMCNUM
          MOVE      ONE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Sub Item Number------
.
PPFC5270  MOVE      ONE,ITEMCNUM
          MOVE      TWO,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Set Code ------
.
PPFC5280  MOVE      ONE,ITEMCNUM
          MOVE      THREE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Set Code Description ------
.
PPFC5290  MOVE      ONE,ITEMCNUM
          MOVE      FOUR,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Receipt Number ------
.
PPFC5300  MOVE      ONE,ITEMCNUM
          MOVE      FIVE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Payment Method Code ------
.
PPFC5310  MOVE      ONE,ITEMCNUM
          MOVE      SIX,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Payment Method Description ------
.
PPFC5320  MOVE      ONE,ITEMCNUM
          MOVE      SEVEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Transaction Type ------
.
PPFC5330  MOVE      ONE,ITEMCNUM
          MOVE      EIGHT,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Transaction Type Description ------
.
PPFC5340  MOVE      ONE,ITEMCNUM
          MOVE      NINE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Date ------
.
PPFC5350  MOVE      ONE,ITEMCNUM
          MOVE      TEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Amount ------
.
PPFC5360  MOVE      ONE,ITEMCNUM
          MOVE      TEN1,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 1st Item Description ------
.
PPFC5370  MOVE      ONE,ITEMCNUM
          MOVE      TEN2,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Code ------
.
PPFC5380  MOVE      TWO,ITEMCNUM
          MOVE      ONE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
. 
. ----- 2nd Item Sub Item Number------
.
PPFC5390  MOVE      TWO,ITEMCNUM
          MOVE      TWO,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
. 
. ----- 2nd Item Set Code ------
.
PPFC5400  MOVE      TWO,ITEMCNUM
          MOVE      THREE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Set Code Description ------
.
PPFC5410  MOVE      TWO,ITEMCNUM
          MOVE      FOUR,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Receipt Number ------
.
PPFC5420  MOVE      TWO,ITEMCNUM
          MOVE      FIVE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Payment Method Code ------
.
PPFC5430  MOVE      TWO,ITEMCNUM
          MOVE      SIX,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Payment Method Description ------
.
PPFC5440  MOVE      TWO,ITEMCNUM
          MOVE      SEVEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Transaction Type ------
.
PPFC5450  MOVE      TWO,ITEMCNUM
          MOVE      EIGHT,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Transaction Type Description ------
.
PPFC5460  MOVE      TWO,ITEMCNUM
          MOVE      NINE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Date ------
.
PPFC5470  MOVE      TWO,ITEMCNUM
          MOVE      TEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Amount ------
.
PPFC5480  MOVE      TWO,ITEMCNUM
          MOVE      TEN1,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd Item Description ------
.
PPFC5490  MOVE      TWO,ITEMCNUM
          MOVE      TEN2,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Code ------
.
PPFC5500  MOVE      THREE,ITEMCNUM
          MOVE      ONE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Sub Item Number------
.
PPFC5510  MOVE      THREE,ITEMCNUM
          MOVE      TWO,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Set Code ------
.
PPFC5520  MOVE      THREE,ITEMCNUM
          MOVE      THREE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Set Code Description ------
.
PPFC5530  MOVE      THREE,ITEMCNUM
          MOVE      FOUR,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Receipt Number ------
.
PPFC5540  MOVE      THREE,ITEMCNUM
          MOVE      FIVE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Payment Method Code ------
.
PPFC5550  MOVE      THREE,ITEMCNUM
          MOVE      SIX,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Payment Method Description ------
.
PPFC5560  MOVE      THREE,ITEMCNUM
          MOVE      SEVEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Transaction Type ------
.
PPFC5570  MOVE      THREE,ITEMCNUM
          MOVE      EIGHT,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Transaction Type Description ------
.
PPFC5580  MOVE      THREE,ITEMCNUM
          MOVE      NINE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Date ------
.
PPFC5590  MOVE      THREE,ITEMCNUM
          MOVE      TEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Amount ------
.
PPFC5600  MOVE      THREE,ITEMCNUM
          MOVE      TEN1,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd Item Description ------
.
PPFC5610  MOVE      THREE,ITEMCNUM
          MOVE      TEN2,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Code ------
.
PPFC5620  MOVE      FOUR,ITEMCNUM
          MOVE      ONE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Sub Item Number------
.
PPFC5630  MOVE      FOUR,ITEMCNUM
          MOVE      TWO,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Set Code ------
.
PPFC5640  MOVE      FOUR,ITEMCNUM
          MOVE      THREE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Set Code Description ------
.
PPFC5650  MOVE      FOUR,ITEMCNUM
          MOVE      FOUR,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Receipt Number ------
.
PPFC5660  MOVE      FOUR,ITEMCNUM
          MOVE      FIVE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Payment Method Code ------
.
PPFC5670  MOVE      FOUR,ITEMCNUM
          MOVE      SIX,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Payment Method Description ------
.
PPFC5680  MOVE      FOUR,ITEMCNUM
          MOVE      SEVEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Transaction Type ------
.
PPFC5690  MOVE      FOUR,ITEMCNUM
          MOVE      EIGHT,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Transaction Type Description ------
.
PPFC5700  MOVE      FOUR,ITEMCNUM
          MOVE      NINE,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Date ------
.
PPFC5710  MOVE      FOUR,ITEMCNUM
          MOVE      TEN,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Amount ------
.
PPFC5720  MOVE      FOUR,ITEMCNUM
          MOVE      TEN1,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th Item Description ------
.
PPFC5730  MOVE      FOUR,ITEMCNUM
          MOVE      TEN2,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- Service Doctor Provider Number -----
.
PPFC5740  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRDOCT,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCPRV1,VARIABLE
          GOTO      PPFC7500
.
. ----- Referring Doctor Provider Number -----
.
PPFC5750  MATCH     SP70,PRHRREFD
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRHRREFD,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCPRV1,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Primary Doctor Provider Number -----
.
PPFC5760  MATCH     SP70,PRPRPDOC
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY10,PRPRPDOC,SP70
          CALL      RDPMHCP1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF
.
          MOVE      PMHCPRV1,VARIABLE
          GOTO      PPFC7500
.
. ----- Medical Practice Service Doctor Provider Number -----
.         
PPFC5770  MATCH     SP70,PRHRDOCT
          GOTO      PPFC7500 IF EQUAL
          GOTO      PPFC7500 IF EOS
.
          PACK      KEY22,PRHRPRAC,PRHRDOCT,PRINCLAM,PRHRPIND,SP70
          CALL      RDPRDO1               * Read the doctors file
          IF        OVRCD=1
            GOTO      PPFC7500
          ENDIF     
.
          MOVE      PRDOPROV,VARIABLE
          GOTO      PPFC7500  
.
. ----- 1st item quantity -----
.
PPFC5780  MOVE      ONE,ITEMCNUM
          MOVE      TEN3,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd item quantity -----
.
PPFC5790  MOVE      TWO,ITEMCNUM
          MOVE      TEN3,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd item quantity -----
.
PPFC5800  MOVE      THREE,ITEMCNUM
          MOVE      TEN3,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th item quantity -----
.
PPFC5810  MOVE      FOUR,ITEMCNUM
          MOVE      TEN3,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- PRA Address Line 4 -----
.
PPFC5820  MOVE      PRHRADD4,VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Full Address -----
.
PPFC5830  CLEAR     VARIABLE
          APPEND    PRHRADD3,VARIABLE
          RESET     VARIABLE
          STRIP     VARIABLE
          ENDSET    VARIABLE
          APPEND    SP1,VARIABLE
          APPEND    PRHRADD4,VARIABLE
          RESET     VARIABLE
          STRIP     VARIABLE
          ENDSET    VARIABLE
          APPEND    SP1,VARIABLE
          APPEND    PRHRPOST,VARIABLE
          RESET     VARIABLE
          STRIP     VARIABLE
          ENDSET    VARIABLE
          APPEND    SP70,VARIABLE
          RESET     VARIABLE
          GOTO      PPFC7500
.
. ----- PRA Mobile Phone -----
.
PPFC5840  MOVE      PRHRMPHN,VARIABLE
          GOTO      PPFC7500
.
. ----- Patient Full Address -----
.
PPFC5850  CLEAR     VARIABLE
          APPEND    PSUBRB,VARIABLE
          RESET     VARIABLE
          STRIP     VARIABLE
          ENDSET    VARIABLE
          APPEND    SP1,VARIABLE
          APPEND    PADD4,VARIABLE
          RESET     VARIABLE
          STRIP     VARIABLE
          ENDSET    VARIABLE
          APPEND    SP1,VARIABLE
          APPEND    PPOST,VARIABLE
          RESET     VARIABLE
          STRIP     VARIABLE
          ENDSET    VARIABLE
          APPEND    SP70,VARIABLE
          RESET     VARIABLE
          GOTO      PPFC7500
.
. ----- 1st item time -----
.
PPFC5860  MOVE      ONE,ITEMCNUM
          MOVE      TEN4,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 2nd item time -----
.
PPFC5870  MOVE      TWO,ITEMCNUM
          MOVE      TEN4,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 3rd item time -----
.
PPFC5880  MOVE      THREE,ITEMCNUM
          MOVE      TEN4,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.
. ----- 4th item time -----
.
PPFC5890  MOVE      FOUR,ITEMCNUM
          MOVE      TEN4,FORM2
          CALL      PRIDTR00
          GOTO      PPFC7500
.   
.----- format patient sex long description ------   
.   
PPFC5900  MOVE      PSEX,DSEXCHAR   
          CALL      SEXDSP00	
          MOVE      DSEXLDES,VARIABLE        * Get sex long description	  
          GOTO      PPFC7500	
.
PPFC5910  PACK      VARIABLE,PMPXPFSN,SP70   * Preferred Surname
          GOTO      PPFC7500
.
PPFC5920  PACK      VARIABLE,PMPXPFGN,SP70   * Preferred Given Name
          GOTO      PPFC7500
.
PPFC5930  PACK      VARIABLE,PSNAME,SP70     * Pref Surname instead of Actual SN
          MATCH     "1",PTCNPFSN
          IF        @EQUAL
            MATCH     SP70,PMPXPFSN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFSN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      PPFC7500
.
PPFC5940  PACK      VARIABLE,PGNAME,SP70     * Pref GN instead of Actual GN
          MATCH     "1",PTCNPFGN
          IF        @EQUAL
            MATCH     SP70,PMPXPFGN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFGN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      PPFC7500
.
PPFC5950  PACK      VARIABLE,PTMASNAM,SP70   * Pref Surname instead of 40char SN
          MATCH     "1",PTCNPFSN
          IF        @EQUAL
            MATCH     SP70,PMPXPFSN
            IF        !@EQUAL & !@EOS
              PACK      VARIABLE,PMPXPFSN,SP70,SP10
            ENDIF
          ENDIF
          GOTO      PPFC7500
.
. ----- Format the variable -----
.
PPFC7500  RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
          PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      PPFC1000                * Read next record
.
. ----- Formatting for form fields and right justified variables -----
.
PPFC8000  COMPARE   ZERO,PRNTSTRT           * Don't bump if printing full length
          GOTO      PPFC8500 IF EQUAL
.
          BUMP      VARIABLE,PRNTSTRT       * Bump to starting position
          RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
.
. ----- Print the variable -----
.
PPFC8500  PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      PPFC1000                * Read next record
.
. ----- End of HFCF, Print new lines until the end of page is reached -----
.
PPFC9000  COMPARE   CURRROW,IBTHLENG        * Test page length
          GOTO      PPFC9988 IF LESS
.
          PRINT     *N;
          ADD       ONE,CURRROW
          GOTO      PPFC9000
.
PPFC9988  BRANCH    ITEMBTCH,PPFC9999
.
          COMPARE   ITEMBTCH,ITEMCOUN
          GOTO      PPFC9999 IF NOT LESS
.
          ADD       ONE,ITEMCOUN
          GOTO      PPFC0100
.
PPFC9999  CALL      CLSPRINT                * Close the spool file
          GOTO      ENDPPFCF                * Finished
+
.*****************************************************************
. Loop through pridtraf and find item record. Input: ITEMCNUM FORM2
.*****************************************************************
PRIDTR00  MATCH     SP70,UNIQNUMB
          GOTO      PRIDTR99 IF EQUAL
          GOTO      PRIDTR99 IF EOS
.
          COMPARE   ZERO,INVOICEN
          GOTO      PRIDTR99 IF EQUAL
.
          MOVE      ZERO,PRIDTRCN
.
.         ITEMCOUN=1, print the first to four items
.         ITEMCOUN=2, print the fourth to eight items etc...
.
          MOVE      ITMKEY22[ITEMCOUN],KEY22
          IF        ITEMCOUN=1
            CALL      RSPRDT1
            CALL      RKPRDT1
            BRANCH    OVRCD,PRIDTR99
            GOTO      PRIDTR12
          ELSE
            CALL      RDPRDT1
            BRANCH    OVRCD,PRIDTR99
            GOTO      PRIDTR14
          ENDIF
.
PRIDTR10  CALL      RKPRDT1
          BRANCH    OVRCD,PRIDTR99
.
PRIDTR12  MATCH     DPRDTUNQ,UNIQNUMB
          GOTO      PRIDTR99 IF NOT EQUAL
.
          MOVE      SP70,DIM8
          MOVE      INVOICEN,DIM8
          MATCH     DIM8,PRDTINVN
          GOTO      PRIDTR99 IF NOT EQUAL
.
PRIDTR14  COMPARE   ONE,PRDTRTYP
          GOTO      PRIDTR10 IF NOT EQUAL
.
          ADD       ONE,PRIDTRCN
          COMPARE   ITEMCNUM,PRIDTRCN
          GOTO      PRIDTR10 IF NOT EQUAL
.
          BRANCH    FORM2,PRIDTR20,PRIDTR25,PRIDTR30,PRIDTR35,PRIDTR40:
                          PRIDTR45,PRIDTR50,PRIDTR55,PRIDTR60,PRIDTR65:
                          PRIDTR70,PRIDTR75,PRIDTR80,PRIDTR90
.
          GOTO      PRIDTR99
.
PRIDTR20  MOVE      PRDTITMN,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR25  MOVE      PRDTSUBN,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR30  MOVE      PRDTSETC,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR35  MATCH     SP70,PRDTSETC
          GOTO      PRIDTR99 IF EQUAL
          GOTO      PRIDTR99 IF EOS
.
          PACK      KEY5,ANSF,ANSI,PRDTSETC,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,PRIDTR99
.
          MOVE      TDESC,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR40  MOVE      PRDTRECN,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR45  MOVE      PRDTMETH,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR50  COMPARE   ZERO,PRDTMETH
          IF        @EQUAL
            MOVE      "Not Applicable",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          COMPARE   ONE,PRDTMETH
          IF        @EQUAL
            MOVE      "Cash",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          COMPARE   TWO,PRDTMETH
          IF        @EQUAL
            MOVE      "Cheque",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          COMPARE   THREE,PRDTMETH
          IF        @EQUAL
            MOVE      "Credit Card",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          COMPARE   FOUR,PRDTMETH
          IF        @EQUAL
            MOVE      "Merchant Card",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          COMPARE   FIVE,PRDTMETH
          IF        @EQUAL
            MOVE      "Money Order",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          GOTO      PRIDTR99
.
PRIDTR55  MOVE      PRDTTTYP,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR60  MATCH     "BD ",PRDTTTYP
          IF        @EQUAL
            MOVE      "Bad Debt",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          MATCH     "CR ",PRDTTTYP
          IF        @EQUAL
            MOVE      "Credit",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          MATCH     "WO ",PRDTTTYP
          IF        @EQUAL
            MOVE      "Write Off",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          MATCH     "PY ",PRDTTTYP
          IF        @EQUAL
            MOVE      "Payments",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          MATCH     "DB ",PRDTTTYP
          IF        @EQUAL
            MOVE      "Debit",VARIABLE
            GOTO      PRIDTR99
          ENDIF
.
          GOTO      PRIDTR99
.
PRIDTR65  UNPACK    PRDTSDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * Format patient's birth date
          MOVE      CPDATE,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR70  MOVE      SP70,DIM15
          MOVE      SP70,DIM9
          MOVE      ZERO,FORM12P2
          MOVE      PRDTAMNT,FORM12P2
          MOVE      FORM12P2,DIM15
          LJUSTIFY  DIM15
          MOVE      DIM15,DIM9
          RJUSTIFY  DIM9
          MOVE      DIM9,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR75  MOVE      PRDTDESC,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR80  MOVE      PRDTSERV,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR90  MOVE      PRDTSTIM,VARIABLE
          GOTO      PRIDTR99
.
PRIDTR99  RETURN
+
.*****************************************************************
.  Set up array of index keys of items 
.*****************************************************************
SETI0000  MOVE      ZERO,FORM2
          MOVE      ONE,ITEMBTCH
          PACK      ITMKEY22[ITEMBTCH],UNIQNUMB,INVOICEN,SP70
.
          PACK      KEY22,UNIQNUMB,INVOICEN,SP70
          CALL      RSPRDT1
SETI1000  CALL      RKPRDT1
          BRANCH    OVRCD,SETI9999
.
          MATCH     DPRDTUNQ,UNIQNUMB
          GOTO      SETI9999 IF NOT EQUAL
.
          MOVE      SP70,DIM8
          MOVE      INVOICEN,DIM8
          MATCH     DIM8,PRDTINVN
          GOTO      SETI9999 IF NOT EQUAL
.
          COMPARE   ONE,PRDTRTYP
          GOTO      SETI1000 IF NOT EQUAL     * Not an item record
.
          ADD       ONE,FORM2
          COMPARE   FIVE,FORM2
          GOTO      SETI1000 IF LESS
.
          MOVE      ONE,FORM2
          ADD       ONE,ITEMBTCH
          PACK      ITMKEY22[ITEMBTCH],DPRDTUNQ,PRDTINVN,DPRDTTRN,SP70
          GOTO      SETI1000
.
SETI9999  RETURN
+
.******************************************************************************
.         INC       GETDRG      
          INC       OPRDEAIO/INC
          INC       OPRDECIO/INC
          INC       PATDADIO/INC
          INC       PATDTRIO/INC
          INC       PATECDIO/INC
          INC       PATECOIO/INC
          INC       PATICDIO/INC
          INC       PATICOIO/INC
          INC       PATICUIO/INC
          INC       PATMMBIO/INC
          INC       PATPGRIO/INC
          INC       PATTRNIO/INC
          INC       PATVADIO/INC
          INC       IBAOVRIO/INC
          INC       IBATMHIO/INC
          INC       IBATMDIO/INC
          INC       IBAVARIO/INC
.
ENDPPFCF  ENDPROC
+
