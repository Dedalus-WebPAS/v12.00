.--------------------------------------------------
. Standard Histogram Display
.--------------------------------------------------
GPHISDIS  DISPLAY  *P1:3,*EF
          CALL     GPHISCSL     * Calculate Scale
          HLINE    *G37,3,1,80
          HLINE    *G37,5,1,80
          HLINE    *G37,21,1,80
          HLINE    *G37,23,1,80
          VLINE    *G39,14,4,20
          VLINE    *G39,67,4,20
          DISPLAY  *P1:4,*V2LON,GPHISRHD:
                   *P16:4,*V2LON,GPHISHED:
                   *P69:4,*V2LON,GPHISCHD
          MOVE     ZERO,GPHISCNT
          MOVE     ZERO,GPHISTOT
          REPEAT
            ADD      ONE,GPHISCNT
            ASSIGN   GPHISCNT+5,CVERT
            DISPLAY  *P1:CVERT,GPHISMIN," - "
            ADD      GPHISRAN,GPHISMIN
            ASSIGN   GPHISVAL[GPHISCNT]/GPHISSCL+15,HRIG
            MOVE     "16",HLEF
            IF       ((HRIG>15)&(HRIG<68))
              HLINE    *G44,CVERT,HLEF,HRIG
            ENDIF
            IF       (HRIG>67)
              HLINE    *G44,CVERT,HLEF,67
              DISPLAY  *P67:CVERT,"*"
            ENDIF
            DISPLAY  *P76:CVERT,GPHISVAL[GPHISCNT]
            ADD      GPHISVAL[GPHISCNT],GPHISTOT
          UNTIL    (GPHISCNT=15)
          DISPLAY  *P1:22,"Under : ",GPHISUND
          DISPLAY  *P33:22,"Over  : ",GPHISOVR
          DISPLAY  *P68:22,"Total : ",GPHISTOT
          RETURN
.--------------------------------------------------
. Calculate Scale for Histogram Display
.--------------------------------------------------
GPHISCSL  MOVE     ZERO,GPHISMAX
          MOVE     ONE,GPHISSCL
          MOVE     ZERO,GPHISCNT
          REPEAT
            ADD      ONE,GPHISCNT
            IF       GPHISVAL[GPHISCNT]>GPHISMAX
              MOVE     GPHISVAL[GPHISCNT],GPHISMAX
            ENDIF
          UNTIL    (GPHISCNT=15)
          IF       GPHISMAX>50
            ASSIGN   GPHISMAX/50,GPHISSCL
          ENDIF
          RETURN
.
