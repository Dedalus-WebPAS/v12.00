.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRINCKY
.   Routine   :   HSCINA00 Program Include     
.   Return    :   SCFMFID 
.-------------------------------------------------------------------------------
HSCINA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
          GOTO      HSCINA04 IF NOT EQUAL
          MOVE      "10",HTOP
          MOVE      "24",HBOT
          MOVE      "60",HLEF
          MOVE      "80",HRIG
          ENDIF
HSCINA04
          CALL      GSCRN000
          BRANCH    EXIT,HSCINA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Include Name"       
.
          MOVE      STDCOL01,STDCOL02
          ADD       "14",STDCOL02
HSCINA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,SCININC 
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          PACK      SAVKEY80,SCINPID,SCINTYP,SCININC,SP70                       
          SETLPTR   SAVKEY80,9                                                  
          CALL      RSSCIN1 
HSCINA10
          CALL      RKSCIN1 
          BRANCH    OVRCD,HSCINA15
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HSCINA12
          CALL      HSCINA60
          BRANCH    OVRCD,HSCINA10
HSCINA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY21,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,SCININC 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HSCINA10 IF NOT EQUAL
HSCINA15
          UNPACK    SAVKEY80,SCINPID,SCINTYP,SCININC                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HSCINA20
          CALL      HSCRI000
          BRANCH    EXIT,HSCINA30,HSCINA35,HSCINA40,HSCINA45,HSCINA04:
                              HSCINA91,HSCINA50
          GOTO      HSCINA92
HSCINA30
          CALL      RKSCIN1 
          BRANCH    OVRCD,HSCINA85
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA85 IF NOT EQUAL                                       
          CALL      RPSCIN1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCINA10
HSCINA35
          MOVE      ST1,KEY21
          CALL      RDSCIN1 
          CALL      RPSCIN1 
          BRANCH    OVRCD,HSCINA85
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA85 IF NOT EQUAL                                       
          MATCH     SP70,SCININC                                                
          GOTO      HSCINA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HSCINA36
          CALL      RPSCIN1 
          BRANCH    OVRCD,HSCINA37
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCINA36 IF NOT EQUAL
HSCINA37
          MOVE      ZERO,XITEMNO
          GOTO      HSCINA10
HSCINA40
          MOVE      ST1,KEY21
          CALL      RDSCIN1 
          CALL      RPSCIN1 
          BRANCH    OVRCD,HSCINA85
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCINA08
HSCINA45
          CALL      RKSCIN1 
          BRANCH    OVRCD,HSCINA85
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY21,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSSCIN1 
HSCINA46
          CALL      RPSCIN1 
          BRANCH    OVRCD,HSCINA47
          PACK      KEY21,SCINPID,SCINTYP,SCININC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HSCINA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HSCINA46 IF NOT EQUAL
HSCINA47
          MOVE      ZERO,XITEMNO
          GOTO      HSCINA10
HSCINA50  COMPARE   ZERO,CSEARCH
          GOTO      HSCINA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCINA08
HSCINA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HSCINA08
HSCINA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HSCINA61 IF EQUAL
          MATCH     SCHFLD01,SCININC 
          GOTO      HSCINA72 IF NOT EQUAL
HSCINA61
HSCINA62
HSCINA63
HSCINA64
HSCINA65
HSCINA66
HSCINA67
HSCINA68
HSCINA69
HSCINA70
          GOTO      HSCINA75
HSCINA72  MOVE      ONE,OVRCD
HSCINA75  RETURN
HSCINA85
          LOAD      KEY21,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY21,SCINPID,SCINTYP,SCININC                               
          CALL      RDSCIN1 
HSCINA90
          UNPACK    SAVKEY80,SCINPID,SCINTYP,SCININC                            
          BEEP
          GOTO      HSCINA20
HSCINA91
          MOVE      ZERO,SCINGEN 
          MOVE      SP70,SCINSPA 
          MOVE      SP70,KEY21
          MOVE      SP70,SCININC 
          GOTO      HSCINA96
HSCINA92
          MOVE      SP70,KEY21
          MOVE      SP70,SCININC 
          LOAD      KEY21,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY21,SCINPID,SCINTYP,SCININC                               
HSCINA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HSCINA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Screen System                      
.   Include   :   SCRINCKY
.   Routine   :   KSCINA00 Keyin Include             
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KSCINA00 TOPIC     "SCININC "
          MOVE      UNDLN70,SCININC 
          KEYIN     *PCCOL:CVERT,*DV,SCININC:                                   
                    *PCCOL:CVERT,*V2LON,SCININC:                                
                    *PCCOL:CVERT,*DV,SCININC 
.
          ENDSET    SCININC 
          APPEND    SP70,SCININC 
          RESET     SCININC 
.
          MATCH     SP70,SCININC 
          GOTO      KSCINA90 IF EQUAL
.
          CMATCH    EXITCHAR,SCININC 
          GOTO      KSCINA95 IF EQUAL
.
          CMATCH    QUEST,SCININC 
          GOTO      KSCINA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HSCINA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SCININC 
          APPEND    SP70,SCININC 
          RESET     SCININC 
.
          MATCH     SP70,SCININC 
          GOTO      KSCINA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SCININC                                 
KSCINA10
          PACK      KEY21,SCINPID,SCINTYP,SCININC                               
          CALL      RASCIN1 
          BRANCH    OVRCD,KSCINA80
          BRANCH    CKEYTYP,KSCINA75
          CALL      RDSCIN1 
KSCINA70
          MOVE      ZERO,EXIT
          GOTO      KSCINA99
KSCINA75
          MOVE      "Include Already Exist - ",DISPMSG                                               
          CALL      MESSAGE1
          GOTO      KSCINA00
KSCINA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KSCINA99,KSCINA99
          MOVE      "Include Does Not Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KSCINA00
KSCINA90
          MOVE      ONE,EXIT
          GOTO      KSCINA99
KSCINA95
          MOVE      TWO,EXIT
KSCINA99 TOPIC    PRGID
          RETURN
