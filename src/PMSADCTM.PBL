. *----------------------------------------------------------------------
. * Include Name  :   PMSADCTM.INC
. *
. * Function      :   CGI variables for PMSADCFD - pmsadcaf.dat
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V11.02.01  23.09.2022  Bella Turco              TSK 0921957
.             Added NOMORE00 - Display "No more records" at end of list
.             Added PTCNNRTD - Displays number of rows set by parameter value
.  V9.10.01   10/07/2008  Ebon Clements CAR 171718
.             Fixed goto functionality  - LISAD000
.  V9.09.00   26/10/2007  Jill Habasque CAR 153381
.             Created include
. *----------------------------------------------------------------------
.
.------------------------------------------------------------
.clear cgi vars for adverse outcome code details file
.------------------------------------------------------------
CPPMAC00  MOVE      Z70,PMADC001
          MOVE      Z70,PMADC002
          MOVE      Z70,PMADC003
          MOVE      Z70,PMADC004
          MOVE      Z70,PMADC005
          MOVE      Z70,PMADC006
          MOVE      Z70,PMADC007
          MOVE      Z70,PMADC008
          MOVE      Z70,PMADC009
          MOVE      Z70,PMADC010
          MOVE      Z70,PMADC011
          MOVE      Z70,PMADC012
          MOVE      Z70,PMADC013
          MOVE      Z70,PMADC014
          MOVE      Z70,PMADC015
          MOVE      Z70,PMADC016
          MOVE      Z70,PMADC017
          MOVE      Z70,PMADC018
.
CPPMAC99  RETURN
.------------------------------------------------------------
. Output Adverse outcome  details file
.------------------------------------------------------------
PMAC0000  BRANCH    FLDITMNO,PMAC0100,PMAC0200,PMAC0300,PMAC0400,PMAC0500:
                             PMAC0600,PMAC0700,PMAC0800,PMAC0900,PMAC1000:
                             PMAC1100,PMAC1200,PMAC1300,PMAC1400,PMAC1500:
                             PMAC1600,PMAC1700,PMAC1800,PMAC1900,PMAC2000:
                             PMAC2100,PMAC2200,PMAC2300,PMAC2400,PMAC2500:
                             PMAC2600,PMAC2700,PMAC2800
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PMAC9999
.
PMAC0100  WRITE     HTMLFILE;PMACCODE;
          GOTO      PMAC9999
.
PMAC0200  WRITE     HTMLFILE;PMACDESC;
          GOTO      PMAC9999
.
PMAC0300  WRITE     HTMLFILE;PMACACHS;
          GOTO      PMAC9999
.
PMAC0400  WRITE     HTMLFILE;PMACDECI;
          GOTO      PMAC9999
.
PMAC0500  MOVE      "IY",CATEGORY
          MOVE      PMACINFC,CODE
          CALL      CODITM00
          GOTO      PMAC9999
.
PMAC0600  WRITE     HTMLFILE;PMACSHRD;
          GOTO      PMAC9999
.
PMAC0700  WRITE     HTMLFILE;PMACVLD1;
          GOTO      PMAC9999
.
PMAC0800  WRITE     HTMLFILE;PMACVLD2;
          GOTO      PMAC9999
.
PMAC0900  WRITE     HTMLFILE;PMACVLD3;
          GOTO      PMAC9999
.
PMAC1000  WRITE     HTMLFILE;PMACVLD4;
          GOTO      PMAC9999
.
PMAC1100  WRITE     HTMLFILE;PMACVLD5;
          GOTO      PMAC9999
.
PMAC1200  WRITE     HTMLFILE;PMACVLD6;
          GOTO      PMAC9999
.
PMAC1300  WRITE     HTMLFILE;PMACVLD7;
          GOTO      PMAC9999
.
PMAC1400  WRITE     HTMLFILE;PMACVLD8;
          GOTO      PMAC9999
.
PMAC1500  WRITE     HTMLFILE;PMACVLD9;
          GOTO      PMAC9999
.
PMAC1600  WRITE     HTMLFILE;PMACVL10;
          GOTO      PMAC9999
.
PMAC1700  WRITE     HTMLFILE;PMACVLNA;
          GOTO      PMAC9999
.
PMAC1800  WRITE     HTMLFILE;PMACINAC;
          GOTO      PMAC9999
.
PMAC1900  PACK      KEY10,PMACWEBC,SP70
          CALL      RDWBSE1
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMAC9999
.
PMAC2000  MATCH     PMACDATC,SP70
          GOTO      PMAC9999 IF EQUAL
          UNPACK    PMACDATC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAC9999
.
PMAC2100  WRITE     HTMLFILE;PMACTIMC;
          GOTO      PMAC9999
.
PMAC2200  PACK      KEY10,PMACWEBU,SP70
          CALL      RDWBSE1 
          WRITE     HTMLFILE;WBSENAM;
          GOTO      PMAC9999
.
PMAC2300  MATCH     PMACDATU,SP70
          GOTO      PMAC9999 IF EQUAL
          UNPACK    PMACDATU,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMAC9999
.
PMAC2400  WRITE     HTMLFILE;PMACTIMU;
          GOTO      PMAC9999
.
PMAC2500  CALL      LISAD000
          GOTO      PMAC9999
.
PMAC2600  CALL      NEXTPR00     * Link to Next Set of Codes
          GOTO      PMAC9999
.
PMAC2700  CALL      PREVPR00     * Link to Prev Set of Codes
          GOTO      PMAC9999
.
PMAC2800  PACK      KEY9,PMADC001,SP3 
          CALL      RSPMAOD1
PMAC2810  CALL      RKPMAOD1
          BRANCH    OVRCD,PMAC9999
          MATCH     PMADC001,PMAOCODE
          GOTO      PMAC9999 IF NOT EQUAL
         
          STRIP     PMAOLINE
          MOVELPTR  PMAOLINE,LENGTH
.
          COMPARE   LENGTH,ZERO
          IF        @EQUAL
            MOVE      ONE,LENGTH
          ENDIF
.
          SFORMAT   VAR,LENGTH
          MOVE      PMAOLINE,VAR
          WRITE     HTMLFILE;VAR
          SFORMAT   VAR,127
          GOTO      PMAC2810
.
PMAC9999  RETURN
.
.------------------------------------------------------------
.   Set Parameters for adverse outcome codes table
.------------------------------------------------------------
SPADC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPADC001,SPADC002,SPADC003,SPADC004,SPADC005:
                       SPADC006,SPADC007,SPADC008,SPADC009,SPADC010:
                       SPADC011,SPADC012,SPADC013,SPADC014,SPADC015:
                       SPADC016,SPADC017,SPADC018
.
          MOVE      ONE,EXIT
          GOTO      SPADC999
.
SPADC001  PACK      PMADC001,QRYDATA,SP70
          GOTO      SPADC999
.
SPADC002  PACK      PMADC002,QRYDATA,SP70
          GOTO      SPADC999
.
SPADC003  PACK      PMADC003,QRYDATA,SP70
          GOTO      SPADC999
.
SPADC004  PACK      PMADC004,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC005  PACK      PMADC005,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC006  PACK      PMADC006,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC007  PACK      PMADC007,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC008  PACK      PMADC008,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC009  PACK      PMADC009,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC010  PACK      PMADC010,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC011  PACK      PMADC011,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC012  PACK      PMADC012,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC013  PACK      PMADC013,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC014  PACK      PMADC014,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC015  PACK      PMADC015,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC016  PACK      PMADC016,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC017  PACK      PMADC017,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC018  PACK      PMADC018,QRYDATA,SP70
          GOTO      SPPMC999
.
SPADC999  RETURN  
.
.------------------------------------------------------------
.  Update adverse outcome code details table file
.------------------------------------------------------------
MVPMAC00  MATCH     PMADC001,Z70
          IF        !@EQUAL
            MOVE      PMADC001,PMACCODE
          ENDIF
. 
          MATCH     PMADC002,Z70
          IF        !@EQUAL
            MOVE      PMADC002,PMACDESC
          ENDIF
.
          MATCH     PMADC003,Z70
          IF        !@EQUAL
            MOVE      PMADC003,PMACACHS
          ENDIF
.
          MATCH     PMADC004,Z70
          IF        !@EQUAL
            MOVE      PMADC004,PMACDECI
          ENDIF
.
          MATCH     PMADC005,Z70
          IF        !@EQUAL
            MOVE      PMADC005,PMACINFC
          ENDIF
.
          MATCH     PMADC006,Z70
          IF        !@EQUAL
            MOVE      PMADC006,PMACSHRD
          ENDIF
.
          MATCH     PMADC007,Z70
          IF        !@EQUAL
            MOVE      PMADC007,PMACVLD1
          ENDIF
.
          MATCH     PMADC008,Z70
          IF        !@EQUAL
            MOVE      PMADC008,PMACVLD2
          ENDIF
.
          MATCH     PMADC009,Z70
          IF        !@EQUAL
            MOVE      PMADC009,PMACVLD3
          ENDIF
.
          MATCH     PMADC010,Z70
          IF        !@EQUAL
            MOVE      PMADC010,PMACVLD4
          ENDIF
.
          MATCH     PMADC011,Z70
          IF        !@EQUAL
            MOVE      PMADC011,PMACVLD5
          ENDIF
.
          MATCH     PMADC012,Z70
          IF        !@EQUAL
            MOVE      PMADC012,PMACVLD6
          ENDIF
.
          MATCH     PMADC013,Z70
          IF        !@EQUAL
            MOVE      PMADC013,PMACVLD7
          ENDIF
.
          MATCH     PMADC014,Z70
          IF        !@EQUAL
            MOVE      PMADC014,PMACVLD8
          ENDIF
.
          MATCH     PMADC015,Z70
          IF        !@EQUAL
            MOVE      PMADC015,PMACVLD9
          ENDIF
.
          MATCH     PMADC016,Z70
          IF        !@EQUAL
            MOVE      PMADC016,PMACVL10
          ENDIF
.
          MATCH     PMADC017,Z70
          IF        !@EQUAL
            MOVE      PMADC017,PMACVLNA
          ENDIF
.
          MATCH     PMADC018,Z70
          IF        !@EQUAL
            MOVE      PMADC018,PMACINAC
          ENDIF
.
MVPMAC99  RETURN
.
.------------------------------------------------------------
.  Clear adverse outcome code details variables 
.------------------------------------------------------------
CLPMSADC  PACK      PMACCODE,SP70
          PACK      PMACDESC,SP70
          PACK      PMACACHS,SP70
          PACK      PMACDECI,SP70
          PACK      PMACINFC,SP70
          PACK      PMACSHRD,SP70
          PACK      PMACVLD1,SP70
          PACK      PMACVLD2,SP70
          PACK      PMACVLD3,SP70
          PACK      PMACVLD4,SP70
          PACK      PMACVLD5,SP70
          PACK      PMACVLD6,SP70
          PACK      PMACVLD7,SP70
          PACK      PMACVLD8,SP70
          PACK      PMACVLD9,SP70
          PACK      PMACVL10,SP70
          PACK      PMACVLNA,SP70
          PACK      PMACINAC,SP70
          PACK      PMACWEBC,SP70
          PACK      PMACDATC,SP70
          PACK      PMACTIMC,SP70
          PACK      PMACWEBU,SP70
          PACK      PMACDATU,SP70
          PACK      PMACTIMU,SP70
.
          RETURN
+

.------------------------------------------------------------------------------
.               Adverse Outcomes List
.------------------------------------------------------------------------------
LISAD000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      AOHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,STARTKEY,SP70
          CALL      RDPMADC1
          IF        OVRCD=0
            CALL      RPPMADC1
          ENDIF
.
LISAD100  CALL      RKPMADC1
          BRANCH    OVRCD,LISAD900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LISAD100
          ENDIF
.
          CALL      ADORW000    * Display Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LISAD100 IF NOT EQUAL
          GOTO      LISAD999
.
LISAD900  CALL      NOMORE00            * Display No More Records Message
.
LISAD999  RETURN
.------------------------------------------------------------
. Adverse Outcome Table Details (TABLE HEADING)
.------------------------------------------------------------
AOHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell>":
                               "Code</td>":
                               "<td class=HeadingCell>":
                               "Description</td>":
                             "</tr>"
.
AOHED999  RETURN
.------------------------------------------------------------
. Adverse Outcome Table Details  (TABLE ROW)
.------------------------------------------------------------
ADORW000  WRITE     HTMLFILE;"<tr><td nowrap>":
                             "<A HREF='javascript:ShowDetail":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pmadc001=",PMACCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif ":
                             "hspace=4 border=0 align=absmiddle></a>":
                             PMACCODE,"</td>":
                             "<td>",PMACDESC,"</td>":
                             "</tr>";
.
ADORW999 RETURN
.
.-----------------------------------------------------------
. Link to Next Group Codes
.-----------------------------------------------------------
NEXTPR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          WRITE     HTMLFILE;"patweb07.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY;
.
NEXTPR99  RETURN
.-----------------------------------------------------------
. Link to Prev Group Codes
.-----------------------------------------------------------
PREVPR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          WRITE     HTMLFILE;"patweb07.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY;
.
PREVPR99  RETURN
