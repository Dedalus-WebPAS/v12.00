<meta name="TemplateVersion" content="V11.03.02">
<meta name="TemplateHome" content="sjog-vic">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/emrweb0201004.js"></script>
<script type="text/javascript">
function validateMAGRAN() {
  if (isWhitespace(document.UpdateForm.emvis161.value)) {
    document.UpdateForm.dummy4.value="";    
    return;
  }

  a=trim(document.UpdateForm.emvis161.value);
  b=trim(document.UpdateForm.emvis161.defaultValue);
  if (a.toUpperCase() == b.toUpperCase())  { return;; }

  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=17" +
                    "&valdcode=" + a.toUpperCase().replace(/ /g,"+");

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);

    if (returnValue.status!=0) {
      document.UpdateForm.emvis161.value=document.UpdateForm.emvis161.defaultValue;
      document.UpdateForm.dummy4.value=document.UpdateForm.dummy4.defaultValue;
      document.UpdateForm.emvis161.focus();
      return;
    }
    ReturnValues=returnValue.return_value.split("|");
    document.UpdateForm.dummy4.value=trim(ReturnValues[1])+" "+trim(ReturnValues[0]);
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);

    returnValue.then(
      function (returnValue) {
        returnValue = ParseFetchData(returnValue);  // parse fetch() result

        if (returnValue.status!=0) {
          document.UpdateForm.emvis161.value=document.UpdateForm.emvis161.defaultValue;
          document.UpdateForm.dummy4.value=document.UpdateForm.dummy4.defaultValue;
          document.UpdateForm.emvis161.focus();
          return;
        }
        ReturnValues=returnValue.return_value.split("|");
        document.UpdateForm.dummy4.value=trim(ReturnValues[1])+" "+trim(ReturnValues[0]);
      }
    );
  }
}
function ReturnToMap(){
  if(parent.TogglePanel==null){
     parent.menu.location.href='emrweb01.pbl?reportno=1&template=1';
  }
  else{
     parent.TogglePanel();
  }
}
function UpdDoctor() {
  if (UpdateForm.emcndoct.value==1) {
    UpdEmrDoc(UpdateForm.emvis007);
  }
  else {
    UpdDoc(UpdateForm.emvis007);
  }
}
function SearchDoctor() {
  if (UpdateForm.emcndoct.value==1) {
    DoctorEmrSearchFrame(UpdateForm.emvis007,UpdateForm.dummy3);
  }
  else {
    DoctorSearchFrame(UpdateForm.emvis007,UpdateForm.dummy3);
  }
}

function PageLoadExtended()
{
   PageLoad();
   setFocus("btnUpdate");
   SetDischarged();
}

function setFocus(id)
{
  var  object = document.getElementById(id);

  if(object)
     object.focus();

}
function CheckTextLimit(TextArea) {
  if (!LimitText(TextArea,6,300)) {
    TextArea.onblur = null;  // clear to prevent infinite loop with alerts
    window.setTimeout(function () {
      TextArea.onblur = function() {
        prcom001TopFrame();
      }
    },100);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended();" 
      onunload="submitFormRedirect();">
<div id=PatientHeading style="height:25%;overflow:auto;"></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.199.008";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PageBodySection style="height:98%;overflow: auto;">
<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0"
 onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value="01">
<input type=hidden name=resavail value="0">
<input type=hidden name=template value="001">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=formactn value="C1">
<input type=hidden name=redirect value="emrweb02.pbl?reportno=1&template=4">
<input type=hidden name=updateky value="%EMRWEB02.01.404">
<input type=hidden name=updttype value="UPDAT">
<input type=hidden name=nextpage value=17>
<input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
<input type=hidden name=username>
<input type=hidden name=password>
<input type=hidden name=dummy1>
<input type=hidden name=dummy2>
<input type=hidden name=emvis004>
<input type=hidden name=emvis005>
<input type=hidden name=emvis135>
<input type=hidden name=emvis136>
<input type=hidden name=emvis137>
<input type=hidden name=emvis138>
<input type=hidden name=emvis147>
<input type=hidden name=emvis118 value="%EMRWEB02.01.003">
<input type=hidden name=savdesc1>
<input type=hidden name=savmanag>
<input type=hidden name=searchgn value="%EMRWEB02.01.009">
<input type=hidden name=searchsn value="%EMRWEB02.01.010">
<input type=hidden name=searchps value="%EMRWEB02.01.019">
<input type=hidden name=searchpd value="%EMRWEB02.01.020">
<input type=hidden name=discstat value="%EMRWEB02.01.147">
<input type=hidden name=emcndoct value="%EMRWEB02.01.455">
<input type=hidden name=webuseid value="%STANDARD.01.008">
<input type="hidden" name="updflag1" value="1" />
<input type="hidden" name="current_precom" id="current_precom" 
 value="%EMRWEB02.01.220.1" />
<input type=hidden name=arrvdate value="%EMRWEB02.01.101.0">
<input type=hidden name=arrvtime value="%EMRWEB02.01.102">

<table width=99% align=center border=0 cellspacing=0 cellpadding=0>
    <tr>
    <td colspan=2>
    <table width=100% align=center border=0 cellspacing=0 cellpadding=0>

      <tr valign=top>
        <td class=DataLabel width=27%>Presenting Complaint</td>
        <td>
          <input type=hidden name=emrviscat value="el">
          <input type="text" size=10 tabindex=7 name=test
           value="%EMRWEB02.01.220.0"
           class="NoAutoFocus"
           onblur="emvis060TopFrame();savePresentingComplaint();"
        onKeyUp='UpCase(this);getPresentCom(this,UpdateForm.emvis060,
                 UpdateForm.emrviscat);
           SetDirty();'>
          <select name=emvis060 class=SelectBig onblur="emvis060TopFrame();"
           onchange="SetDirty();">
            <option value="%EMRWEB02.01.220.1">%EMRWEB02.01.220.0</option>
          </select>
        </td>
      </tr>

      <tr>
        <td class=DataLabel>Location</td>
        <td><input type=hidden name=name_emvis006 title="Location"
             value="%EMRWEB02.01.106.0">
          <select class=SelectMed name=emvis006
            onchange='validateattendingdoctor(refreashTop);'/>
            <option value=" "></option>
            %EMRWEB02.01.106.2
          </select>
          <input type=text size=30 name=emvis149 title="Location Note"
           value="%EMRWEB02.01.136">
        </td>
      </tr>

    </table>
    </td>
    <td colspan=4>
    <textarea name=prcom001 id=prcom001 wrap=hard cols=50 rows=6
     style="overflow-y:hidden" title="Presenting Complaint Comments"
     onkeydown="CheckTextLimit(this);" onblur="prcom001TopFrame();"></textarea> 
    </td></tr>

<tr><td class=DataLabel>MAGRAN</td>
    <td>

      <input type=text size=6 maxlength=6 name=emvis161
       title="MAGRAN" value="%EMRWEB02.01.282.1"
       onblur="UpCase(this);validateMAGRAN();" >
      <input type=text size=18 name=dummy4 title="Doctor Name"
       readonly class=Readonly value="%EMRWEB02.01.282.0">
      <img src="../images/erase.gif" class=Icon
       onclick="clrFields(UpdateForm.emvis161,UpdateForm.dummy4);" />
      <img src="../images/SearchIcon.gif" class=Icon name="SearchIconGIF"
       onclick="NurseSearchFrame(UpdateForm.emvis161,UpdateForm.dummy4);">
      <input type="text" name=emvis162 size="11"
       value="%EMRWEB02.01.283" title="MAGRAN Date">
      <img src=../images/DateLookup.gif class=Icon
       date=document.UpdateForm.emvis162
       name="DateLookupGIF">
      <input type="text" name=emvis163 size="6" value="%EMRWEB02.01.284"
       onblur="checkTime(this,'Doctor Seen Time')">
      <img notab src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(UpdateForm.emvis162,UpdateForm.emvis163);" />
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(UpdateForm.emvis163);" name="TimeLookupGIF">
    </td>
    <td rowspan=4 class=DataLabel valign=top>Management Notes<br>
    <textarea name=vicmt002 rows=4 wrap=hard title="Management Notes" 
     onblur="SaveMgtNteBLANK(this);"
     onkeydown="LimitText(this,99,16930);"
     cols=60>%EMRWEB02.01.434.002</textarea>
    </td></tr>

<tr><td class=DataLabel>Doctor</td>
<td><input type=text size=6 maxlength=6 name=emvis007 title="Doctor Code"
         value="%EMRWEB02.01.107.001"
         onblur="UpdDoctor();">
        <input type=text size=18 name=dummy3 title="Doctor Name"
         readonly class=Readonly value="%EMRWEB02.01.107.003">
        <img src="../images/erase.gif" class=Icon
         id="DocDelBut" onclick="DelDoc();">
        <img src="../images/SearchIcon.gif" class=Icon
          onclick="SearchDoctor();">
        <input type=button class="button" value="Doctor Handover"
         onclick='DoctorData();'>
</td></tr>
<tr><td class=DataLabel> Treating Nurse </td>
    <td>
    <input type=hidden name=gnm>
    <input type=text size=6 name=emvis130 title="Nurse Code"
         onblur='UpdNur(UpdateForm.emvis130);' value="%EMRWEB02.01.164.1">
        <input type=text size=18 name=dummy5 title="Nurse Name" readonly
         class=Readonly value="%EMRWEB02.01.164.0">
        <img src="../images/erase.gif" class=Icon
         id="NurDelBut" onclick="DelNurse();">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="NurseSearchFrame(UpdateForm.emvis130,UpdateForm.dummy5)">
        <input type=button class="button"
         value="Nurse Handover" onclick='NurseData();'></td></tr>

<tr><td>Triage Nurse</td>
    <td><input type=text size=29 name=name_triage title="Triage Nurse" readonly 
         Class=Readonly value="%EMRWEB02.01.161.0">
    </td></tr>

<tr><td colspan=6 align=center>
    <input type=button class="button" 
           id="btnUpdate"
           name="btnUpdate"
           value="Update" 
     onclick="if (!isWhitespace(UpdateForm.arrvdate.value) &&
                  !isWhitespace(UpdateForm.emvis162.value) &&
                  !CheckDateRange(UpdateForm.arrvdate,UpdateForm.emvis162)) 
              {return;}
              tempDisable(this);validateattendingdoctor(onUpdate);" 
    />
    <input type=button class="button" value="Clinical" 
     onclick="PatientLink('emrweb02.pbl',1,100);"> 
    <input type=button class="button" value="Registration" 
     onclick="checkurno();">
    <input type=button class="button" value="Injury Data" name=injbuttn
     onclick="SmallFrameEmr('71');"> 
    <input type=button class="button" value="Outstanding" 
     onclick="SmallFrameEmr('51');"> 
    <input type=button class="button" value="Discharge" 
     onclick="checkUR(document.UpdateForm.discstat.value);"> 
    <input type=button class="button" value="Labels & Forms" 
     onclick="SmallFrameEmr('5');"> 
    <input type=button class=RedButton value="Return to Map" 
     onclick="ReturnToMap();">
    <input type=button class="button" value="Jump Queue" onclick="updateNext();">
    </td></tr>
</table>
</form>
</div>
<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=webuseid value="%STANDARD.01.008">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="11">
<input type=hidden name=checksub value="0">
<input type=hidden name=emvis147>
</form>
<form name=HiddenFields style="margin:0">
<input type=hidden name=InjuryIndicator value="%EMRWEB02.01.447">
<input type=hidden name=CheckUr value="%EMRWEB02.01.448">
<input type=hidden name=DoctorCode value="%EMRWEB02.01.107.001">
<input type=hidden name=NurseCode value="%EMRWEB02.01.164.1">
<input type=hidden name=Location value="%EMRWEB02.01.083">
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=Pres01 value="%EMRWEB02.01.104">
<input type=hidden name=Pres02 value="%EMRWEB02.01.105">
<input type=hidden name=Pres03 value="%EMRWEB02.01.174">
<input type=hidden name=Pres04 value="%EMRWEB02.01.175">
<input type=hidden name=Pres05 value="%EMRWEB02.01.176">
<input type=hidden name=Pres06 value="%EMRWEB02.01.177">
<input type=hidden name=linkadmn value="%EMRWEB02.01.081">
</form>
<script type="text/javascript">
 CTypeAdm="%EMRWEB02.01.252";
 if ( CTypeAdm == "Yes") {
   document.UpdateForm.emvis147.value=1; 
   document.PatientLinks.emvis147.value=1; }
 else { 
   document.UpdateForm.emvis147.value=0; 
   document.PatientLinks.emvis147.value=0; }
 ShowReg="%EMRWEB02.01.461";
 if(ShowReg=="1") {
   checkurno();
 }
 InjData="%EMRWEB02.01.188";
 if ( InjData =="1" ) {
    document.UpdateForm.injbuttn.className="RedButton";
 }
</script>
