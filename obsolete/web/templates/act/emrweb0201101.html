<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="act">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/emrweb0201101.js"></script>
<script type="text/javascript">
function init() {
  if (document.HiddenFields.DischargeComplete.value!=1) {
    PageLocation="?reportno=1&template=109" +
                 "&urnumber=" + PatientURN.replace(/ /g,"+") +
                 "&admissno=" + PatientVIS.replace(/ /g,"+")
    location.href="emrweb02.pbl" + PageLocation 
    return }
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if (top.content.location.href!=this.location.href) {
    top.content.location.href="emrweb02.pbl" + PageLocation }

  if (isWhitespace(document.HiddenFields.HospitalAdmission.value)) {
    if (!isWhitespace(document.HiddenFields.ExpectedUnit.value)) {
       alert('Patient must be admitted before Discharge.')
       DisableForm(document.UpdateForm) }}

  document.UpdateForm.brcom001.value=document.UpdateForm.dummy1.value + 
                                     document.UpdateForm.dummy2.value
 if(document.HiddenFields.ShowOutstanding.value=="1") {
  var linkurl = "../cgi-bin/emrweb02.pbl?reportno=1&template=051" +
                    "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+")+
                    "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+")
  Left=(document.body.clientWidth-600)/2
  DFrameLink(linkurl,0,Left,600,300);
 }
// this checks to see if it is being used outside the MAPVIEW
  if(top.location.pathname.match(/EmergencyMap/g)) {
    document.UpdateForm.mapvflag.value=1
  }
  setTimeout('defDepartureACT()',100);
}
function checkDateFunction() {
  if(isWhitespace(document.UpdateForm.emvis074.value)) {
    return;
  } else {
    checkDate(document.UpdateForm.emvis074,'Ward Allocated Date');
  }
}
function checkDept() {
  CheckDepartureACT();
  deceasedIndicator = document.UpdateForm.emvis026.value.substr(3,1);
  checkDeceasedEMR(deceasedIndicator);
}
function displayReferralFields() {
  if (document.UpdateForm.stfrefin.value != "1") {
    emvis174TitleDIV.innerHTML = "";
    emvis175TitleDIV.innerHTML = "";
    emvis176TitleDIV.innerHTML = "";
    emvis174FieldDIV.innerHTML = "";
    emvis175FieldDIV.innerHTML = "";
    emvis176FieldDIV.innerHTML = "";
    return;
  }
  displaycatRF();
}
function displaycatRF() {
    if (document.UpdateForm.emvis174.value.substr(3,1) == "N") {
      emvis175TitleDIV.innerHTML = emvis175TitleSPAN.innerHTML;
      emvis175FieldDIV.innerHTML = emvis175FieldSPAN.innerHTML;
    } else {
      emvis175TitleDIV.innerHTML = "";
      emvis175FieldDIV.innerHTML = "";
    }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);displayReferralFields();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Emergency Patient Discharge </td></tr>
</table>
<table width=95% align=center border=0 cellspacing=0 cellpadding=1>
<form name=UpdateForm action=emrweb02.pbl method=post>
 <input type=hidden name=reportno value="01">
 <input type=hidden name=template value="101">
 <input type=hidden name=formactn>
 <input type=hidden name=updttype>
 <input type=hidden name=emvis133>
 <input type=hidden name=admissno value="%EMRWEB02.01.081">
 <input type=hidden name=updateky value="%EMRWEB02.01.404">
 <input type=hidden name=urnumber value="%EMRWEB02.01.003">
 <input type=hidden name=emvis118 value="%EMRWEB02.01.003">
 <input type=hidden name=nextpage value="1">
 <input type=hidden name=redirect value="%EMRWEB02.01.001.emrweb01.01.001">
 <input type=hidden name=chkdot value="%EMRWEB02.01.107.001">
 <input type=hidden name=chknur value="%EMRWEB02.01.164.1">
 <input type=hidden name=dummy1
  value="%EMRWEB02.01.104%EMRWEB02.01.105%EMRWEB02.01.174">
 <input type=hidden name=dummy2
  value="%EMRWEB02.01.175%EMRWEB02.01.176%EMRWEB02.01.177">
 <input type=hidden name=waittime value="%EMRWEB02.01.701">
 <input type=hidden name=loadflag >
 <input type=hidden name=reloadfg value="%EMRWEB02.01.446">
 <input type=hidden name=efrbedty value="%EMRWEB02.01.506">
 <input type=hidden name=efradmis value="%EMRWEB02.01.508">
 <input type=hidden name=attdtype value="%EMRWEB02.01.213.3">
 <input type=hidden name=depttime value="%EMRWEB02.01.125">
 <input type=hidden name=deptdate value="%EMRWEB02.01.124.0">
 <input type=hidden name=ptdocsee value="%EMRWEB02.01.130.0 %EMRWEB02.01.131">
 <input type=hidden name=ptnursee value="%EMRWEB02.01.128.0 %EMRWEB02.01.129">
 <input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
 <input type=hidden name=mapvflag value="0">
 <input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime value="">
<input type="hidden" name="stfrefin" id="stfrefin"
 value="%EMRWEB02.01.919">

<!-- bronko
 <input type=hidden name=emvis004>
 <input type=hidden name=emvis005>
 <input type=hidden name=emvis135>
 <input type=hidden name=emvis136>
 <input type=hidden name=emvis137>
 <input type=hidden name=emvis138>
-->

<tr valign=top><td>
<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td><input type=text name=emvis060 max=3 size=3 value="%EMRWEB02.01.220.1"
       readonly class="Readonly">
        <input type=text name=v060name value="%EMRWEB02.01.220.0" readonly class="Readonly">
    </td>
    <td colspan=2><textarea name=brcom001 readonly cols=50 rows=4 class="Readonly"></textarea>
    </td></tr>

<tr><td class=DataLabel>Departure Date </td>
    <td width=30%><input type=text size=12 name=emvis024
         class="Mandatory Date" title="Departure Date" value="%STANDARD.01.015"
         onblur="ValDate(emvis024,emvis025);">
         <img notab src=../images/DateLookup.gif border=0 hspace=4
         align=absmiddle onclick="DateLookupFrame(emvis024);">
        <input class=Mandatory type=text name=emvis025
         size=8 value="%STANDARD.01.016" title="Time"
         onblur="ValTime(emvis024,emvis025);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onClick="SetCurrentDateTime(emvis024,emvis025);">
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(emvis025);">
    </td>
    <td class=DataLabel width=15%>Departure Destination</td>
    <td><select class=Mandatory name=emvis048
         title="Departure Destination" >
        <option></option>
        %EMRWEB02.01.208.2
        </select></td></tr>

<tr><td class=DataLabel>Departure Status</td>
    <td><select name=emvis026 onchange="checkDept();"
         class=Mandatory title="Departure Status">
        <option></option>
        %EMRWEB02.01.126.2
        </select></td>

    <td class=DataLabel width=15%>Referred to on Departure</td>
    <td><select class=Mandatory name=emvis051
         title="Referred to on Departure" >
        <option></option>
        %EMRWEB02.01.211.2
        </select></td></tr>
</table>

<div id=Departure></div>

<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel width=15%>Unit Request Date</td>
    <td class=DataLabel width=30%><select name=emvis073>
         %EMRWEB02.01.233.1
        </select>
    Time
    <input type="text" name=emvis083 size="8" value="%EMRWEB02.01.243"
     title="Unit Request Time">
    <img src="../images/DateTimeStamp.gif" class=Icon
     date=UpdateForm.emvis073 time=UpdateForm.emvis083>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.emvis083>
    </td>
    <td class=DataLabel width=15%>Ward Allocated Date</td>
    <td class=DataLabel><select name=emvis074 title="Ward Allocated Date"
         onchange="checkDateFunction();">
         %EMRWEB02.01.234.1
    </select>
    Time
   <input type="text" name=emvis084 size="8" title="Bed Ready Time" 
      value="%EMRWEB02.01.244">
    <img src="../images/DateTimeStamp.gif" class=Icon
     date=UpdateForm.emvis074 time=UpdateForm.emvis084>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.emvis084>
    </td></tr>

<tr><td class=DataLabel>Expected Unit</td>
    <td><select name=emvis134 class=SelectBig title="Expected Unit">
        <option></option>
        %EMRWEB02.01.173.2
        </select></td>
    <td class=DataLabel>Expected Ward</td>
    <td class=DataLabel>
    <select name=emvis116 class=SelectBig title="Expected Ward">
<option></option>
      %EMRWEB02.01.149.2
         </select>
    </td></tr>

<tr><td class=DataLabel>Date Ready for Dept</td>
    <td><select name=emvis071 title="Date Ready for Dept">
         %EMRWEB02.01.231.1
        </select>
    Time
    <input type="text" name=emvis081 size="8" value="%EMRWEB02.01.241"
     title="Ready Departure Time">
    <img src="../images/DateTimeStamp.gif" class=Icon
     date=UpdateForm.emvis071 time=UpdateForm.emvis081>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.emvis081>
        </td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    </tr>

<tr><td class=DataLabel>Primary Diagnosis</td>
    <td><input type=text name=dummy5 title="Primary Diagnosis"
         size=52 value="%EMRWEB02.01.187" class=ReadOnly readonly>
    </td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>

<tr>
     <td class=DataLabel>
       <div id="emvis174TitleDIV">
         %STANDARD.01.017.RF
       </div>
     </td>
     <td>
       <div id="emvis174FieldDIV">
       <select name="emvis174" tabindex=38 class="SelectMed"
        title="%STANDARD.01.017.RF" onchange="displaycatRF();">
         <option></option>
         %EMRWEB02.01.293.2
         </select>
       </div>
     </td>
     <td class=DataLabel>
       <div id="emvis176TitleDIV">
         Referral Date
       </div>
     </td>
     <td>
       <div id="emvis176FieldDIV">
         <input type=text size=12 name=emvis176 title="Referral Date"
          value="%EMRWEB02.01.295" tabindex=41
          onblur="checkDateSV(this,'Valid to');" >
         <img notab src="../images/DateLookup.gif" class="Icon"
           alt="Show Calendar" date="UpdateForm.emvis176">
       </div>
     </td>
     </tr>

<tr>
     <td class=DataLabel>
       <div id="emvis175TitleDIV">
         Referral Period (Months)
       </div>
     </td>
     <td>
       <div id="emvis175FieldDIV">
         <input type=text name=emvis175 title="Referral Period (Months)"
          class=Number size=15 maxlength=2 min=1 max=98
          value="%EMRWEB02.01.294"
       </div>
     </td>
     <td class=DataLabel></td>
     <td>

     </td>
     </tr>

<tr><td colspan=4 align=center><br>
    <input type=button value="Discharge" class="button" 
     title="Discharge Patient" onclick="PostDischargeACT()">
    <input type=button value="Update" class="button" 
     title="Update details (This will not discharge the patient)"
     onclick="PreDischargeACT()">
    <input type=button value="Cancel" class="button" 
     onclick='fnPatientLink("%EMRWEB02.01.003","%EMRWEB02.01.081");'>
</td></tr>
</table>
</form>
</table>

<span id=ShowDeparture style="display:none;">
<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel width=15%>Transfer Destination</td>
    <td width=30%><input type=text size=6 maxlength=6 name=emvis033
         title="Transfer Destination" value="%EMRWEB02.01.133.1"
         onchange="validateCode(9,emvis033,name_emvis033n);">
        <input type=text size=30 name=name_emvis033n readonly
         value="%EMRWEB02.01.133.0">
        <img src=../images/SearchIcon.gif 
         onClick="TransferSourceFrame(emvis033,name_emvis033n);">
        </td>
    <td class=DataLabel width=15%>Reason for Transfer</td>
    <td><select class=SelectBig name=emvis052>
        <option></option>
        %EMRWEB02.01.212.2
        </select></td></tr>

<tr><td class=DataLabel>Escort Source</td>
    <td><select class="Mandatory SelectBig" name=emvis050 title="Escort Source">
        <option></option>
         %EMRWEB02.01.210.2
        </select></td>
    <td class=DataLabel>Transport Mode</td>
    <td><select class=SelectBig name=emvis049>
        <option></option>
        %EMRWEB02.01.209.2
        </select></td></tr>
</table>
</span>

<span id="emvis175TitleSPAN" style="display:none">
         Referral Period (Months)
</span>
<span id="emvis175FieldSPAN" style="display:none">
         <input type=text name=emvis175 title="Referral Period (Months)"
          class=Number size=15 maxlength=2 min=1 max=98
          value="%EMRWEB02.01.294">
</span>
<span id="emvis020TitleSPAN" style="display:none">
Referring HCP
</span>

<form name=HiddenFields method=get>
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=HospitalAdmission value="%EMRWEB02.01.148">
<input type=hidden name=ExpectedUnit value="%EMRWEB02.01.173.1">
<input type=hidden name=ShowOutstanding value="%EMRWEB02.01.474">
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
<input type=hidden name=MenuType value="11">
</form>
<script type="text/javascript">
if ( document.UpdateForm.deptdate.value == "") {
  document.UpdateForm.deptdate.value="%EMRWEB02.01.233.0";
  document.UpdateForm.depttime.value="%EMRWEB02.01.243";
}
</script>
</body></html>
