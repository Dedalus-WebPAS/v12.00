<!-- Emergency Location Changed -->
<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="act">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="RefreshTime" content="120">
<script type="text/javascript" src="../js/SmallTable.js"></script>
<script type="text/javascript" src="../js/EmergencyMapSetupACT.js"></script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<!--
<body onload="PageLoad(event);document.test.doctor.focus()">
<form name=test method=get>
-->
<script type="text/javascript">
 var obj = new Map("paper.gif");
 immediate = 0
 emergency = 0
 urgent = 20
 semi = 50
 non = 110

<!-- Paste below from site file emrergencymap.txt-->
//  Location
//               Description, Code, left, top, right, bottom, Start Position Left, Top

// FORTH COLUMN                left,top,right,bottom,Start Position Left,Top
//obj.AddLocation("CDU 12        ","C12",753,370,1003,400,753,370);
obj.AddLocation("CDU 11        ","C11",753,340,1003,370,753,340);
obj.AddLocation("CDU 10        ","C10",753,310,1003,340,753,310);
obj.AddLocation("CDU 9         ","C09",753,280,1003,310,753,280);
obj.AddLocation("CDU 8         ","C08",753,250,1003,280,753,250);
obj.AddLocation("CDU 7         ","C07",753,220,1003,250,753,220);
obj.AddLocation("CDU 6         ","C06",753,190,1003,220,753,190);
obj.AddLocation("CDU 5         ","C05",753,160,1003,190,753,160);
obj.AddLocation("CDU 4         ","C04",753,130,1003,160,753,130);
obj.AddLocation("CDU 3         ","C03",753,100,1003,130,753,100);

// THIRD COLUMN                left,top,right,bottom,Start Position Left, Top
obj.AddLocation("CDU 2         ","C02",502,250,752,280,502,250);
obj.AddLocation("CDU 1         ","C01",502,220,752,250,502,220);
obj.AddLocation("Multi-Purpose ","MPR",502,190,752,220,502,190);
obj.AddLocation("Relative Room ","RR ",502,160,752,190,502,160);
obj.AddLocation("Resus. 2      ","R2 ",502,130,752,160,502,130);
obj.AddLocation("Resus. 1      ","R1 ",502,100,752,130,502,100);

// WAITING ROOM                left,top,right,bottom,Start Position Left, Top
obj.AddLocation("Waiting Room  ","WR ",251,0,1001,100,251,0,"WAIT");

// SECOND COLUMN               left,top,right,bottom,Start Position Left,Top
obj.AddLocation("Interview Room","IR ",251,400,501,430,251,400);
obj.AddLocation("Acute 10      ","A10",251,370,501,400,251,370);
obj.AddLocation("Acute 9       ","A09",251,340,501,370,251,340);
obj.AddLocation("Acute 8       ","A08",251,310,501,340,251,310);
obj.AddLocation("Acute 7       ","A07",251,280,501,310,251,280);
obj.AddLocation("Acute 6       ","A06",251,250,501,280,251,250);
obj.AddLocation("Acute 5       ","A05",251,220,501,250,251,220);
obj.AddLocation("Acute 4       ","A04",251,190,501,220,251,190);
obj.AddLocation("Acute 3       ","A03",251,160,501,190,251,160);
obj.AddLocation("Acute 2       ","A02",251,130,501,160,251,130);
obj.AddLocation("Acute 1       ","A01",251,100,501,130,251,100);

// FIRST COLUMN               left,top,right,bottom,Start Position Left,Top
obj.AddLocation("Procedure Room","PR ",1,400,250,430,1,400);
obj.AddLocation("Plaster 2     ","PL2",1,370,250,400,1,370);
obj.AddLocation("Plaster 1     ","PL1",1,340,250,370,1,340);
obj.AddLocation("Sub-Acute 14  ","S14",1,310,250,340,1,310);
obj.AddLocation("Sub-Acute 13  ","S13",1,280,250,310,1,280);
obj.AddLocation("Sub-Acute 12  ","S12",1,250,250,280,1,250);
obj.AddLocation("Sub-Acute 11  ","S11",1,220,250,250,1,220);
obj.AddLocation("Exam Room 3   ","E3 ",1,190,250,220,1,190);
obj.AddLocation("Exam Room 2   ","E2 ",1,160,250,190,1,160);
obj.AddLocation("Exam Room 1   ","E1 ",1,130,250,160,1,130);
obj.AddLocation("Eye Exam 4    ","EE4",1,100,250,130,1,100);
obj.AddLocation("Other         ","00 ",1,50,250,100,1,50,"HIDE");

<!-- Paste above from site file emergencymap.txt -->

//  Patients
//  Name, Location Code, U/R, Triage, Arrival, Time,Sex, Age, Complaint, Doctor
%EMRWEB01.01.006
//
// Output Map View
//
ShowMap(immediate,emergency,urgent,semi,non);
//
// Output Hall of Shame
//
 t = new Table(1,0,1,"100%","center","Incomplete Patients")
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 t.addColumn("Incomplete Patients","String",1,1,"left","EditIcon.gif","0",150)
 t.addColumn("Patients","String",2,2,"right","","",40)
//
// Add Rows to Table (Output from Web Server)
//
%EMRWEB01.01.032
 TableOutput(1,0)

SystemComments.innerHTML=
"<table width=100% border=1 cellspacing=0 cellpadding=3>" +
"<tr><td class=HeadingCell align=center>Emergency Department Notices</td></tr>"+
"<tr valign=top height=115><td>%EMRWEB01.01.031</td></tr></table>" ;

EmergencyCount.innerHTML=
"<table border=0 cellspacing=0 cellpadding=1 width=100%>" +
"<tr height=20><td>Total :</td><td><b>%EMRWEB01.01.007</td>" +
"    <td>Waiting</td><td><b>%EMRWEB01.01.009</td>" +
"    <td>Unseen</td><td><b>%EMRWEB01.01.010</td>" +
"<tr height=20><td>Inc Dr</td><td><b>%EMRWEB01.01.012</td>" +
"    <td>Nurse </td><td><b>%EMRWEB01.01.013</td>" +
"    <td>PSC </td><td><b>%EMRWEB01.01.014</td>" +
"</tr></table>"

//"<img src=../images/next1.gif class=Icon onclick=OtherLocations()></td>" +

if ("%EMRWEB01.01.037"=="O"){
BlackHole.innerHTML=
"<table border=0 cellspacing=2 cellpadding=4 width=100%>" +
"<tr height=40 valign=middle><td align=center>" +
"<class=Icon onclick=OtherLocations()></td>" +
"<td><font color=white size=2>Patients in Other Locations</td>" +
"<td><font color=white size=2>%EMRWEB01.01.011</td>" +
"</tr></table>"
}
else {
BlackHole.innerHTML=
"<table border=0 cellspacing=2 cellpadding=4 width=100%>" +
"<tr height=40 valign=middle><td align=center>" +
"<img src=../images/TrekIcon.gif class=Icon onclick=OtherLocations()></td>" +
"<td><font color=white size=2>Patients in Other Locations</td>" +
"<td><font color=white size=2>%EMRWEB01.01.011</td>" +
"</tr></table>"
}

EmergencyMenu.innerHTML=parent.MenuList.innerHTML 

//NextEmergency.innerHTML=
//"<table border=1 cellpadding=2 width=200 cellspacing=0>" +
//"<tr height=28><td bgcolor=#ffff00 align=center><b>NEXT</b></td>" +
//"<td class=DataField nowrap bgcolor=#ffff00>%EMRWEB01.01.015</td></tr>" +
//"<tr height=28><td class=DataLabel>Location</td>" +
//"<td class=DataField>" + '%EMRWEB01.01.017' + "</td></tr>" +
//"<tr><td class=DataLabel>Doctor</td>" +
//"<td><input type=text size=6 maxlength=6 name=doctor " +
//"onblur='updDoc(this);'></td></tr>" +
//"</table>"

</script>
<!--
</form>
-->

<script type="text/javascript">
function ShowPatientDetails(PatientNo) {
  if(!isWhitespace(obj.patients[PatientNo][4])) {
    PageLocation="?reportno=1&template=4" +
                 "&urnumber=" + obj.patients[PatientNo][0].replace(/ /g,"+") +
                 "&admissno=" + obj.patients[PatientNo][1].replace(/ /g,"+") 
  } else {
     PageLocation="?reportno=1&template=11" +
                  "&urnumber=" + obj.patients[PatientNo][0].replace(/ /g,"+") +
                  "&admissno=" + obj.patients[PatientNo][1].replace(/ /g,"+") 
  }
  globalLinkType=0;
  globalLinkUrl="../cgi-bin/emrweb02.pbl" + PageLocation
  top.content.location="../cgi-bin/emrweb02.pbl" + PageLocation
}
function OtherLocations() {
 if(top.content.location.search.substring(1,23)=="reportno=2&template=3"){
 if (IsDirtyTriage(top.content.UpdateForm)==true) { return; }} 
 url = "../cgi-bin/emrweb01.pbl?reportno=01&template=012" 
 parent.content.location=url
}
function SelectPatient(admissno) {
 url = "../cgi-bin/emrweb02.pbl?reportno=01&template=100" +
       "&admissno=" + admissno.replace(/ /g,"+") 
 parent.menu.EmergencyMenu.innerHTML=""
 EmergencyFrameLink(url,1,1,1004,525)
}
function updDoc(doctor) {
if(isWhitespace(doctor.value)){return;}
doctor=doctor.value.toUpperCase()
admissno='%EMRWEB01.01.021';
emcndoct='%EMRWEB01.01.040';
// validate doctor exists in patdo1af
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=3" +
                    "&valdcode=" + doctor.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {  return; }   

// validate doctor exists in emrdocaf
  if (emcndoct==1) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=11" +
                      "&valdcode=" + doctor.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) { return; }   
  }

  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=3" +
                    "&admissno=" + admissno +
                    "&doctcode=" + doctor +
                    "&updttype=ALDOC" +
                    "&updateky=1"
  var returnValue = RSExecute(serverURL);

  if(top.content.location.search.substring(1,22)=="reportno=1&template=4"){
    admissno=admissno - 0
    if (top.content.PatientLinks.admissno.value == admissno) {
        top.content.location.reload();
    }
  }

  location.reload();
}
function SelectDoctor(doctcode) {
 if(top.content.location.search.substring(1,23)=="reportno=2&template=3"){
 if (IsDirtyTriage(top.content.UpdateForm)==true) { return; }} 
  var url = "../cgi-bin/emrweb01.pbl?" +
            "reportno=1&template=16" +
            "&doctcode=" + doctcode.replace(/ /g,"+")
 parent.content.location=url
}
function IsDirtyTriage(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if ("text" == eElem.type || "textarea" == eElem.tagName)
    {
      if (eElem.value.replace(/ /g,"") != eElem.defaultValue.replace(/ /g,""))  {
      return true;}
    }
    else if ("checkbox" == eElem.type || "radio" == eElem.type)
    {
      if (eElem.checked != eElem.defaultChecked) return true;
    }
  }
  return false;
}
</script>
<form name=defPatientLink method=get>
<input type=hidden name=serverid value="emrweb02">
<input type=hidden name=reportno value="01">
<input type=hidden name=template value="100">
<input type=hidden name=nextseq value="%EMRWEB01.01.021">
<input type=hidden name=waiting> 
</form>
