<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="sing">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/outweb0203.js"></script>
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript">
function SubmitFinal() {
//
// Prompt confirmation question if this booking if part of a series
//
  p=document.UpdateForm
  p.valddate.value=p.clindate.value.substr(4,12);
  validateSuspension(p.urnumber,p.valddate,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 
if(document.UpdateForm.isseries.value=="1") {
  if(!confirm("This booking is part of a series. Do you wish to continue?")){
    return;
  } 
}
if(!CheckRefLetter()) {
  return;
}
if (validateMandatory(UpdateForm)) {
  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"))) {
    document.UpdateForm.nextpage.value="6";
  }
  if(UpdateForm.newslotk.value.substr(6,6)==UpdateForm.defclnid.value) {
    UpdateForm.submit() } 
  else {
    if (confirm("You have rescheduled this patient to another Clinic.\n"+
                " Click Ok to Continue")) {
      UpdateForm.submit() } } }
}
function init() {
  if (UpdateForm.outrshaf.value > 5) {
    alert("Patient has been Rescheduled > 5 times") }
  UpdateForm.redirect.value="outweb02.pbl?reportno=3&template=13" +
         "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
}
function SetPrinter(SelectList) {
 if (SelectList.className=="Mandatory SelectBig") {
     SelectList.className="SelectBig" }
 else {
     SelectList.className="Mandatory SelectBig" }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="AppFrameExit();">
Re-Schedule Appointment - %OUTWEB02.03.618.1 - %OUTWEB02.03.002
</span>
<div id=PageBodySection style="overflow: auto;">
<table cellspacing=0 cellpadding=2 border=0 width=95% align=center >

<form action=outweb02.pbl method=post name=UpdateForm
 onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value="4">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="5">
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=defclnty value="%OUTWEB02.03.308">
<input type=hidden name=defclnid value="%OUTWEB02.03.303.0">
<input type=hidden name=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=defvflag value="1">
<input type=hidden name=rsinntfg value="1">
<input type=hidden name=valddate>
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=isseries value="%OUTWEB02.03.618.0">
<input type=hidden name=refrwarn value="%OUTWEB02.03.630">
<input type=hidden name=refrexpr value="%OUTWEB02.03.631">
<input type=hidden name=refrdate value="%OUTWEB02.03.632">
<input type=hidden name=alrevisn value="%OUTWEB02.03.646">
<input type=hidden name=deftovrd value="">

<tr><td class=DataLabel>Clinic</td>
    <td colspan=3> 
    <input type=hidden name=newslotk value="%OUTWEB02.03.604.1">
    <input type=text size=30 name=clindesc title="Clinic" class=Mandatory 
     value="%OUTWEB02.03.604.3"> 
    <img src=../images/SearchIcon.gif class=Icon onClick="AppointSearch();">
    <img src="../images/LookupIcon.gif" class=Icon onClick="ClinicSearch();">
    </td></tr>

<tr><td class=DataLabel>Date</td>
    <td colspan=3>
    <input type=text size=30 name=clindate class=Mandatory title="Clinic"
    value="%OUTWEB02.03.604.2"></td></tr>

<tr><td class=DataLabel>Visit Type</td>
    <td><select name=outbb047 title="Visit Type" class="SelectBig Mandatory">
    <option></option>
    %OUTWEB02.03.329   
    </select></td></tr>

<tr><td class=DataLabel>Reason for Reschedule</td>
    <td><select name=outbb014 title="Reason for Reschedule"
    class="SelectBig Mandatory">
    <option></option>
    %OUTWEB02.03.333.2
   </select></td>
    <td class=DataLabel>Rescheduled</td>
    <td><input type=text class=DataField name=outrshaf readonly size=3 
    value="%OUTWEB02.03.602">Times</td></tr>

<tr><td width=28% class=DataLabel>Source of Referral</td>
    <td width=36%><select  name=outbb001 class="Mandatory SelectBig"
     title="Source of Referral">
    <option></option>
    %OUTWEB02.03.320.9.1.10.2.S
    </select></td>
    <td width=9% class=DataLabel>Unit</td>
    <td><select name=outbb022 class="SelectBig" title="Unit">
    <option></option>
    %OUTWEB02.03.341.5
    </select></td></tr>

<tr><td class=DataLabel>Special Arrangements</td>
    <td class=DataField colspan=3>
    <select name=outbb054 class=SelectBig>
    <option></option>
    %OUTWEB02.03.378.2
    </select></td></tr>

<tr><td class=DataLabel>Print Reschedule Letter</td>
    <td><input type=checkbox name=letprt06  value="1" checked 
         onclick="SetPrinter(UpdateForm.letpsl06);">
    <td class=DataLabel>Printer</td>
    <td><select name=letpsl06 class="Mandatory SelectBig" title="Printer">
    <option></option>
    %STANDARD.01.001.OUTWEB03.02
    </select></td></tr>

      <tr>
        <td>
          <table border=0 width=100% class=TableBody cellpadding=0
                 cellspacing=0>
            <tr><td class=DataLabel>Comments</td></tr>
            <tr><td colspan=6 align=left>
                <input type=button value="Add" class="button"
                 name="AddComm" id="AddComm"
                 onclick="tempDisable(this);AddComment();"></td></tr>
            <tr><td>&nbsp;</td></tr>
            <tr><td>&nbsp;</td></tr>
          </table>
        </td>
        <td colspan=6 align=left>
          <textarea wrap=hard name=outptcoa class=Readonly readonly
           rows=4 cols=70>%OUTWEB02.03.327.016.005</textarea>
        </td>
      </tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok"
    onclick="checkSlotReschedule(UpdateForm.newslotk.value,
    UpdateForm.urnumber.value,UpdateForm.admissno.value,SubmitFinal);">
    <input type=button class="button" Value="Cancel" onClick=AppFrameExit();>
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
</form>
