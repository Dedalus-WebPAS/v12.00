<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="sing">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb0205.js"></script>
<script type="text/javascript">
function SubmitFinal() {
  p=document.AddForm
  validateSuspension(p.urnumber,p.dateclin,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 
  setRedirect()
  if (validateMandatory(AddForm)) {
    AddForm.submit() }
}

//-----------------------------------------------------------------
// Function To check Referral Letters
//-----------------------------------------------------------------
function checkRefLetter(urnumber) {
  if (isWhitespace(urnumber)) return;;
  ReturnFunction="" ;
  for (var i=1; i < checkRefLetter.arguments.length; i++) {
   if (typeof(checkRefLetter.arguments[i]) == 'function') {
     ReturnFunction=checkRefLetter.arguments[i] } }
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=6" +
                  "&urnumber="+urnumber.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {

    if (ReturnValue[0] == 1) {    // Unbooked referral exists
 
      // Construct warning message
      if (isWhitespace(ReturnValue[1])) 
        { ReturnValue[1] = "Unknown Date"; }
      if (isWhitespace(ReturnValue[2])) 
        { ReturnValue[2] = "Unknown"; }
      if (isWhitespace(ReturnValue[3])) 
        { ReturnValue[3] = "Unknown"; }
      var message = "Warning : Referral Letter Exists for " + ReturnValue[1] +
                    "; Clinic Type " + ReturnValue[2] + "; Clinic Id " +
                    ReturnValue[3] + "\nClick OK to continue " +
                    "without selecting the letter, Cancel to select letter.";

      ans=confirm(message)
      if (!ans) { 
        UrNumber=document.AddForm.urnumber.value.replace(/ /g,"+");
        DFrameStart();
        document.getElementById('PopUpFrame').src="outweb01.pbl?reportno=4&template=006"+
                                    "&urnumber=" + UrNumber + "&lstunbfl=1";
        SearchFrameShow();
      }
    }
    if (typeof(ReturnFunction) == 'function') { ReturnFunction() } 
  }
}
function setRedirect() {
  strTemplate="" ;
  scrName="";
  checkInd=document.AddForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="041"; 
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043"; 
    scrName="VA";}

  checkInd=document.AddForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048"; 
    scrName="CT";}

  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}

function ClinicSearch() {
  cancelSlot(AddForm.newslotk.value,ClinicSearchLink)
}
function ClinicSearchLink() {
  window.ReturnFunction="" ;
  window.ReturnFunction=DisplayXCmbs;
  ClinicSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate)
}
function AppointSearch() {
  cancelSlot(AddForm.newslotk.value,AppointSearchLink)
}
function AppointSearchLink() {
  window.ReturnFunction="" ;
  window.ReturnFunction=DisplayXCmbs;
  AppointmentSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate);
}

function fnCancel() {
 if (isWhitespace(AddForm.newslotk.value)) {
   history.back(); }
 else {
   cancelSlot(AddForm.newslotk.value,SessionLink)
  }
}
function SessionLink() {
   if(AddForm.redirflg.value=="1") {
     SESSKEYS=AddForm.newslotk.value.substr(0,28).replace(/ /g,"+")
     location.href="outweb02.pbl?reportno=2&template=011&sesskeys="+SESSKEYS
   } else {
     SESSKEYS=AddForm.newslotk.value.substr(0,28).replace(/ /g,"+")
     location.href="outweb02.pbl?reportno=2&template=4&sesskeys="+SESSKEYS
   }
}
function valClaimCode() {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.outbb002.length; i++) {
//    alert(AddForm.outbb002.options[i].value.substr(0,3));
    if (document.AddForm.claimc.value==
        trim(document.AddForm.outbb002.options[i].value.substr(0,3))){
          document.AddForm.outbb002.selectedIndex=i;
    }
  }
}
</script>
</head>
%START.OF.PAGE
<div id=HeadingSection>
<body onload='PageLoad(event);valClaimCode();checkRefLetter("%OUTWEB02.05.003");DisplayXCmbs();'>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OUTWEB02.05.003";
PatientVIS="%OUTWEB02.05.081";
PatientNAM="%OUTWEB02.05.002";
PatientSTA="%OUTWEB02.05.086.078";
PatientALT="%OUTWEB02.05.084";
PatientSEX="%OUTWEB02.05.019";
PatientDOB="%OUTWEB02.05.020";
PatientAGE="%OUTWEB02.05.021";
PatientLOC="%OUTWEB02.05.083";
DoctorCOD="%OUTWEB02.05.082.003";
PatientPRI="%OUTWEB02.05.086.066.1";
PatientUNT="%OUTWEB02.05.066.0";
DoctorNAM="%OUTWEB02.05.082.002";
PatientAID="%OUTWEB02.05.086.090";
PatientIND="%OUTWEB02.05.086.091";
PatientCUR="%OUTWEB02.05.086.092";
PatientCLC="%OUTWEB02.05.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB02.05.086.094";
PatientCDM="%OUTWEB02.05.086.095";
PatientVDH="%OUTWEB02.05.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<table cellspacing=0 cellpadding=1 border=0 width=100% >
<tr><td class=HeadingCell align=center width=100% >
    Make New Appointment</td></tr>
</table>
<table cellspacing=0 cellpadding=0 border=0 width=90% align=center>
<form name=AddForm action=outweb02.pbl method=post>
<input type=hidden name=reportno value="06">
<input type=hidden name=template value="004">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="">
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=updatety value="5">
<input type=hidden name=bookflag value="">
<input type=hidden name=ptcnueoc value="%OUTWEB02.05.216">
<input type=hidden name=clinctyp value="%OUTWEB02.05.205.1">
<input type="hidden" name="claimc">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=refrlvis value="">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="%OUTWEB02.05.228">
<input type=hidden name=ptcnuebb value="">
<input type=hidden name=dateclin value="%OUTWEB02.05.104">
<input type=hidden name=nslotkey value="%OUTWEB02.05.166">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="%OUTWEB02.05.234">
<input type=hidden name=otheccar value="%OUTWEB02.05.241">
<input type=hidden name=redirflg value="%OUTWEB02.05.236">
<input type=hidden name=intrpreq value="%OUTWEB02.05.086.001.0">
<tr><td class=DataLabel width=15%>Clinic</td>
    <td class=DataField colspan=3>
    <input type=hidden name=newslotk value="%OUTWEB02.05.166" >
    <input type=text size=30 name=clindesc Title="Clinic" 
     value="%OUTWEB02.05.192" readonly class=Mandatory>
     <img src="../images/SearchIcon.gif" class=Icon onClick="AppointSearch();">
     <img src="../images/LookupIcon.gif" class=Icon onClick="ClinicSearch();">
    </td></tr>
<tr><td class=DataLabel>Date</td>
   <td class=DataField colspan=3>
   <input type=text size=35 name=clindate readonly  class=Mandatory title="date"
     value="%OUTWEB02.05.113 %OUTWEB02.05.104 %OUTWEB02.05.116">
    </td></tr>

<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField colspan=3>
    <select name=outbb047 title="Visit Type" class="Mandatory SelectBig"
     onChange="DisplayXCmbs();">
    <option></option>
    %OUTWEB02.05.199
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>                              
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 size=50 maxlength=50 
      value="">
</td></tr>     

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>

    <td class=DataField colspan=3>
    <input type=text size=12 name=outbb045 value=""
     onblur="validateCode(6,AddForm.outbb045,AddForm.outbb046);">
    <input type=text name=outbb046 size=70 maxlength=50
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(AddForm.outbb045,AddForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    </td></tr>

<tr>
<td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=12 name=outbb055 value=""
     onblur="validateCode(6,AddForm.outbb055,AddForm.outbb056);">
    <input type=text name=outbb056 size=70 maxlength=50 
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(AddForm.outbb055,AddForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    </td></tr>
<tr>
<td>&nbsp;</td>
<td class=DataField colspan=3>
     <input type=text size=12 name=outbb057 value=""
     onblur="validateCode(6,AddForm.outbb057,AddForm.outbb058);">
     <input type=text size=70 maxlength=50 name=outbb058 
      readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(AddForm.outbb057,AddForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    </td></tr>
<tr>
<td>&nbsp;</td>
<td class=DataField colspan=3>
    <input type=text size=12 name=outbb059 value=""
    onblur="validateCode(6,AddForm.outbb059,AddForm.outbb060);">
    <input type=text size=70 maxlength=50 name=outbb060 
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(AddForm.outbb059,AddForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 class=SelectBig>
        <option></option>
        %OUTWEB02.05.142.2
        </select></td>
    <td class=DataLabel>Priority</td>
    <td class=DataField><select name=outbb013 class=SelectBig>
	<option></option>
	%OUTWEB02.05.132.2
	</select>
    </td></tr>
<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField><select name=outbb002 class="Mandatory SelectBig"
        title="%STANDARD.01.017.CL">
        <option></option>
        %OUTWEB02.05.197.2
        </select></td>
    <td class=DataLabel>Unit</td>
    <td class=DataField><select name=outbb022 class="SelectBig"
                         title="Unit">
	<option></option>
	 %OUTWEB02.05.141.2
	</select></td></tr>

<tr><td class=DataLabel>Source of Referral</td>
    <td class=DataField><select name=outbb001 class="Mandatory SelectBig"
        title="Source of Referral">
        <option></option>
        %OUTWEB02.05.120.2
        </select></td>
    <td class=DataLabel>Reports Required</td>
    <td class=DataField><select name=outbb017 class=SelectBig>
        <option></option>
        %OUTWEB02.05.136.2</td></tr>

<tr><td class=DataLabel>Special Arrangements</td>
    <td class=DataField >
    <select name=outbb054 class=SelectBig>
    <option></option>
    %OUTWEB02.05.178.2
    </select></td>
    <td class=DataLabel>Attending HCP</td>
    <!--<td class=DataLabel>Referring GP</td>-->
    <td class=DataField> 
    <input type=hidden name=outbb029>
    <input type=hidden name=dummy1 value="6">
    <input type=text name=genpname readonly class=Mandatory
     title="Attending HCP"> 
    <img src="../images/SearchIcon.gif"
     onclick="HCPSearchFrame(outbb029,genpname,dummy1.value)">
    <img src="../images/erase.gif" align=absmiddle
     onClick="clrFields(outbb029,genpname);">
    </td></tr>

<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036></td></tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <textarea name=outptcom wrap=hard cols=70 rows=3></textarea>
    </td></tr>
</table>

<div id=ShowXCmbs></div>
<div id=ShowCarer></div>
<div id=ShowIntrp></div>

<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" 
    onclick="checkSlot(AddForm.newslotk.value,
            AddForm.urnumber.value,SubmitFinal);">
    <input type=button class="button" Value="Cancel" onClick='fnCancel()'>
    </td></tr>
</table>
</form>

<span id=extracmbs style="display:none">
<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 title="Item Type" value="MBS">
    <input type=text size=9 name=otbit002 title="Item Code" value=""
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=3 name=otbit003 title="Sub-Item Code" value=""
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
     onclick=PriMbsSearchFrame(otbit001,otbit002,otbit003,dumdate,mbsdesc1,dumInput,TypeDesc1)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit002,otbit003,mbsdesc1,mbsamnt1,otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 title="Provider Usage" 
     tabindex=91 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 title="Item Type 2" value="MBS">
    <input type=text size=9 name=otbit005 title="Item Code 2" value=""
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=3 name=otbit006 title="Sub-Item Code 2" value=""
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit004,otbit005,otbit006,dumdate,mbsdesc2,dumInput,TypeDesc2)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit005,otbit006,mbsdesc2,mbsamnt2,otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 title="Provider Usage 2"
     tabindex=92 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 title="Item Type 3" value="MBS">
    <input type=text size=9 name=otbit008 title="Item Code 3" value=""
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);">
    <input type=text size=3 name=otbit009 title="Sub-Item Code 3" value=""
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);">
    <input type=text size=30 name=mbsdesc3 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit007,otbit008,otbit009,dumdate,mbsdesc3,dumInput,TypeDesc3)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit008,otbit009,mbsdesc3,mbsamnt3,otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 title="Provider Usage 3"
     tabindex=93 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 title="Item Type 4" value="MBS">
    <input type=text size=9 name=otbit011 title="Item Code 4" value=""
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);">
    <input type=text size=3 name=otbit012 title="Sub-Item Code 4" value=""
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);">
    <input type=text size=30 name=mbsdesc4 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit010,otbit011,otbit012,dumdate,mbsdesc4,dumInput,TypeDesc4)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit011,otbit012,mbsdesc4,mbsamnt4,otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 title="Provider Usage 4"
     tabindex=94 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 title="Item Type 5" value="MBS">
    <input type=text size=9 name=otbit014 title="Item Code 5" value=""
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);">
    <input type=text size=3 name=otbit015 title="Sub-Item Code 5" value=""
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);">
    <input type=text size=30 name=mbsdesc5 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit013,otbit014,otbit015,dumdate,mbsdesc5,dumInput,TypeDesc5)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit014,otbit015,mbsdesc5,mbsamnt5,otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 title="Provider Usage 5"
     tabindex=95 value="">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload onclick="TemplateCmbs();">
    &nbsp;
    <select class="SelectBig" name=cmbstemp title="CMBS Template"
         onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB02.05.229
          </select></td>
    </tr>

<tr><td>Print Medicare Claims</td>
    <td><input type=checkbox value=1 name=claimprt>
    &nbsp;
    <select class="SelectBig" name=claimpsl title="Printer">
          <option></option>
          %STANDARD.01.001.OUTCLAIM.03
          </select></td>
    <tr>
</table>
</span>

<span id=sendcarer style="display:none">
<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField><input type=checkbox value=1 name=outbb065 checked>
    </td></tr>
</table>
</span>

<span id=dispintrp style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=1 align=center>
<tr><td class=DataLabel width=15%>Interpreter</td>
    <td class=DataField>
    <input type=text name=pmsvx053 size=50 maxlength=50></td></tr>
</table>
</span>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=MenuType value="%OUTWEB02.05.088">
<input type=hidden name=casekeys value="%OUTWEB02.05.166">
</form>

<script type="text/javascript">
DisplayIntrp();
</script>
