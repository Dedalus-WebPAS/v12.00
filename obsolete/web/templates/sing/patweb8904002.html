<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="sing">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/admission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function SubmitAdm() {
  if  (!validateMandatory(UpdateForm)) {
      return;
  }
    p=document.UpdateForm
    validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
    if(p.datefrom.value!='0'){
         alert("Error : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
               "\tPatient will not be admitted");
     return;
    }
//if (!isWhitespace(UpdateForm.ptmis013.value)) {
//    if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
//                        UpdateForm.funddesc,UpdateForm.tabldesc)) {
//       ans=confirm("Select another active health fund table? ");
//       if (ans==true) {
//          return;
//       }
//    }
//}

 if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
 }
    ans="True";
    CheckAdmitDate();
    if (ans==false){
       return;
    }
  setRedirectAdm();
  validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis004,
                           UpdateForm.ptmis005,UpdateForm.bedrqqry);
  SubmitHidden(UpdateForm);
}

function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
//  UpdateForm.ptmis024.selectedIndex=1
  selectUnit();
}
function selectUnit(){
  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value.substr(0,3)== 
                 document.UpdateForm.deftunit.value.substr(0,3)) {
        document.UpdateForm.ptmis024.selectedIndex=i } };
    if (isWhitespace(document.UpdateForm.deftunit)) {
      if (UpdateForm.ptmis024.length==2) {
          UpdateForm.ptmis024.selectedIndex=1; } }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();DisplayContract();
              document.UpdateForm.ptmis001.focus();valDoctorUnit();
              selectUnit();
              ValidateHCP(18,0,document.UpdateForm.ptvis028,
                               document.UpdateForm.doctnam1);">
<div id="PageHeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.04.003";
PatientVIS="%PATWEB89.04.081";
PatientNAM="%PATWEB89.04.002";
PatientSTA="%PATWEB89.04.086.078";
PatientALT="%PATWEB89.04.084";
PatientSEX="%PATWEB89.04.019";
PatientDOB="%PATWEB89.04.020";
PatientAGE="%PATWEB89.04.021";
PatientLOC="%PATWEB89.04.083";
PatientPRI="%PATWEB89.04.086.066.1";
PatientUNT="%PATWEB89.04.066.0";
DoctorCOD="%PATWEB89.04.082.003";
DoctorNAM="%PATWEB89.04.082.002";
PatientAID="%PATWEB89.04.086.090";
PatientIND="%PATWEB89.04.086.091";
PatientCUR="%PATWEB89.04.086.092";
PatientCLC="%PATWEB89.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.04.086.094";
PatientCDM="%PATWEB89.04.086.095";
PatientVDH="%PATWEB89.04.086.099.015";
InsertPatientHeader()
</script>
<span id=PatientMenu></span>
</div>
<div id=PageBodySection>
<table border=0 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<form name=linkForm action=patweb89.pbl method=POST>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.101">
</form>

<form name=UpdateForm method=post  action=patweb89.pbl>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="1"> 
<input type="hidden" name="updatety" value="2">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="redirect" value="%PATWEB89.04.001.patweb98.01.001">
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.101">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptmis073" value=" ">
<input type="hidden" name="ptmis075" value="N">
<input type="hidden" name="admisflg" value="1">
<input type="hidden" name="ptmas046" value="">
<input type="hidden" name="mvmedrec">
<input type="hidden" name="datefrom">
<input type="hidden" name="dateto">
<input type="hidden" name="exstward" value="%PATWEB89.04.195.1">
<input type="hidden" name="cfinan" value="%PATWEB89.04.932">
<input type="hidden" name=deftunit value="%PATWEB89.04.124.1">
<input type=hidden name=bedrqqry value="">

<tr><td class=HeadingCell align=center>
    Patient Admission Details</tr>
<tr>
<tr><td>
      <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
        <tr>
          <td class=DataLabel>Admission Date</td>
          <td class=DataLabel>
            <input type="text" size="12" tabindex=1
            name=ptmis001 value="%STANDARD.01.015"
            class=Mandatory title="Admission Date"
            onblur="checkDate(this,'Admission Date')">
     <img src=../images/DateLookup.gif border=0 hspace=4
        align=absmiddle onclick="DateLookupFrame(ptmis001);"> Time
     <input type=text name=ptmis002 tabindex=2 size=8
        value="%STANDARD.01.016" class=Mandatory title="Admission Time">
      <img src=../images/DateTimeStamp.gif border=0 hspace=4 align=absmiddle
         onClick="SetCurrentDateTime(null,ptmis002);">
     <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
        onclick="TimeLookupFrame(ptmis002);"> </td>
       <td>Admitting Point</td>
       <td>
         <select name=ptvis046 tabindex=12 class=Mandatory 
                 title="Admitting Point" onChange="defaultWard()">
           <option> </option>
            %PATWEB89.04.290.2
         </select></td></tr>
     <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P " class=Mandatory>
              <option> </option>
                 %PATWEB89.04.112.2
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
       <td>
         <input type=hidden name=bedstat1>
           <input type=hidden name=warddesc>
           <select name=ptmis004 tabindex=13 title="Ward" class=Mandatory>
            <option> </option>
            %PATWEB89.04.195.2
           </select>

         <input type=text name=ptmis005 maxlength=3 class=mandatory size=3
                value="%PATWEB89.04.194">
         <img src=../images/SearchIcon.gif border=0 vspace=1
         onClick="WardBedSearchFrame(ptmis004,warddesc,ptmis005,bedstat1);">
       </td>
     </tr>

      <tr><td class=DataLabel>Admission Source</td>
      <td>
         <select name=ptmis009 tabindex=4 onChange="DisplayTrnSrc()"
          class=Mandatory title='Admission Source'>
         <option> </option>
         %PATWEB89.04.110.2
          </select>
      </td>
      <td class=DataLabel>Admitting Doctor</td>
      <td>
           <input type="text" size=8 maxlength=6 name="ptmis007" tabindex=14
              value="%PATWEB89.04.108.003" class=Mandatory
              title="Admitting Doctor"
              onchange="UpCase(this);valDoctorUnit();">
           <input type=text readonly size=25 name=doctnam2 class=mandatory
              value="%PATWEB89.04.108.002">
           <img src="../images/SearchIcon.gif" 
              onClick="DoctorSearchFrame(ptmis007,doctnam2,valDoctorUnit)">
              </td></tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
      <td class=DataLabel>Unit</td>
      <td>
           <select name=ptmis024 tabindex=15 class=Mandatory title="Unit">
           <option> </option>
           %PATWEB89.04.124.2
           </select>
      </td></tr>

    <tr><td class=DataLabel>Criteria for Admission</td>
    <td>
       <select name=ptvis041 tabindex=8 class=Mandatory title="Criteria for Admission">
       <option> </option>
       %PATWEB89.04.244.2
       </select>
    </td>
         </tr>
          <tr><td class=DataLabel>Care Type</td>
          <td>
            <select name=ptmis012 tabindex=9 class=Mandatory title="Care Type">
            <option> </option>
               %PATWEB89.04.113.2
            </select>
   </td>
        <td class=DataLabel>Referring GP</td>
        <td>
        <input type="text" size=10 maxlength=10 name="ptvis028" tabindex=19
        value="%PATWEB89.04.231.1" 
           onblur="ValidateHCP(18,0,ptvis028,doctnam1);">
        <input type="text" size=25 readonly name="doctnam1"
        value="%PATWEB89.04.231.0">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
      </td></tr>
      <tr><td class=DataLabel> Intended Stay </td>
      <td>
       <select name=ptvis043 tabindex=10 class=Mandatory title="Intended Stay">
          <option> </option>
          %PATWEB89.04.246.2
        </select>
      </td>
      <td class=DataLabel>Foreign Patient Type</td>
      <td class=DataLabel>
         <select name=ptmis037 tabindex=19 title="Foreign Patient Type">
         <option> </option>
          %PATWEB89.04.133.2
         </select>
      </td>
        </tr>
       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030
         tabindex=11 title='Expected Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);" 
         value="%PATWEB89.04.129" tabindex=11>
        </td>
        </tr>
 
       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

   <tr> 
        <td class=DataLabel width=15%>Pref. Next of Kin
        <td><select name=ptvis087 tabindex=37 >
         %PATWEB89.04.298.006.2
       </td></tr>
   <tr>
        <td class=DataLabel> Emergency Contact
        <td><select name=ptvis088 tabindex=38 >
         %PATWEB89.04.298.007.2
       </td></tr>
 
       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

       <tr align=left>
         <td class=DataLabel>%STANDARD.01.017.CL</td>
         <td align=left>  
          <select name=ptmis027 tabindex=50 class=Mandatory 
                  title="%STANDARD.01.017.CL">
          <option> </option>
          %PATWEB89.04.126.9.1.10.2.X
          </select>
         </td>
       <td class=DataLabel>%STANDARD.01.017.A </td>
    <td>
      <select name=ptmis010 tabindex=51 class=Mandatory
      title="%STANDARD.01.017.A "
      onchange="DisplayContract()">
      <option> </option>
      %PATWEB89.04.111.5
      </select>
    </td>
    </tr>

     <tr><td class=DataLabel><div id=ContractHeading></div></td>
          <td><div id=ContractType></div></td>
          <td class=DataLabel><div id=Contrac1Heading></div></td>
          <td><div id=ContractRole></div></td>
     </tr>

     <tr><td class=DataLabel><div id=Contrac2Heading></div></td>
         <td><div id=ContractId></div></td>
     </tr>

      <tr align=left>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=53>
        </td>
        <td align=left> </td>
        <td align=left> </td>
        </td></tr>
        <tr align=left>
          <td colspan=4 align=center><br>
           <input type=button value="Admit" class="button" tabindex=54
            id="pat89sub"
            onClick="tempDisable(this);checkBedStatus(UpdateForm.ptmis004.value,
                 UpdateForm.ptmis005.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
           <input type=button value="Cancel" class="button" tabindex=55
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);"> 
</form>
      </table>
</td></tr>
</table>

<div id=SelectHeading></div>
<div id=SelectLocation></div>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.081">
<input type=hidden name=MenuType value="%PATWEB89.04.088">
<input type=hidden name=ptmis027 value="%PATWEB89.04.126.0">
<input type=hidden name=admisflg value="1">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=18
         onblur="checkDate(this,'ReferralDate')">
         <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
  <td><input type=text size=12 name=ptmis059 tabindex=19
         onblur="checkDate(this,'SpecConDate')">
    <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 size=8 maxlength=6 tabindex=20
    onChange=justifyRight(this);>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">
if ("%PATWEB89.04.905" == "1") {
  alert("Warning: Patient is currently admitted");
}
for (var i=0;i<document.UpdateForm.ptmis004.length;i++){
if (document.UpdateForm.ptmis004.options[i].value=="%PATWEB89.04.158"){
    document.UpdateForm.ptmis004.selectedIndex=i}};

MergePsy="%PATWEB89.04.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }
</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
 <td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=5
      value="%PATWEB89.04.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly value="%PATWEB89.04.193.1">
     <img src="../images/SearchIcon.gif"
      onClick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<!--<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>-->
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=contracthd style="display:none">
Contract Type
</span>

<span id=contracrhd style="display:none">
Contract Role
</span>

<span id=contracihd style="display:none">
 Contract Id
</span>

<span id=contractid style="display:none">
  <select name=ptasf003 title="Contract Spoke Id" class=Mandatory 
   tabindex=25>
  <option> </option>
   %PATWEB89.04.199.003
  </select>
</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.04.199.001" tabindex=26
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif"
   onClick="ContTypeAlert();">
</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.04.199.002"
   title="Contract Role" tabindex=27
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif"
   onClick="ContRoleAlert();">
</span>

<span id=blanklabel style="display:none">&nbsp;</span>
