<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="sing">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript">
function ClinicSearch() {
   if (!isWhitespace(UpdateForm.newslotk.value)) {
     cancelSlot(UpdateForm.newslotk.value,ClinicSearchLink)
   }
}
function ClinicSearchLink() {
 ClinicSearchFrame(UpdateForm.newslotk,UpdateForm.clindesc,UpdateForm.clindate,
                   UpdateForm.defclnty,UpdateForm.defclnid)
}
function AppointSearch() {
   if (!isWhitespace(UpdateForm.newslotk.value)) {
     cancelSlot(UpdateForm.newslotk.value,AppointSearchLink)
   }
}
function AppointSearchLink() {
AppointmentSearchFrame(UpdateForm.newslotk,UpdateForm.clindesc,
                       UpdateForm.clindate,UpdateForm.defclnty,
                       UpdateForm.defclnid,UpdateForm.defvisty);
}
function UpdateApp() {
  p=document.UpdateForm;
  validateSuspension(p.urnumber,p.dateclin,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 
  setRedirect()
  if (validateMandatory(UpdateForm)) {
    UpdateForm.submit() }
}
function setRedirect() {
  strTemplate="" ;
  scrName="";
  checkInd=document.UpdateForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="041";
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043";
    scrName="VA";}

  checkInd=document.UpdateForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048";
    scrName="CT";}

  if (strTemplate=="") {
    if ((document.UpdateForm.ptcnueoc.value==1) &&
        (document.UpdateForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.UpdateForm.nextpage.value="6"
      document.UpdateForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.UpdateForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    }
  }
  else {
    document.UpdateForm.nextpage.value="6"
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  }

  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.UpdateForm.nextpage.value="6";
  }
  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.UpdateForm.nextpage.value="6";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);makeCheck();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Appointment - %OUTWEB02.03.618.1 - %OUTWEB02.03.002
</span>
<div id=PageBodySection style="overflow: auto;">
<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<form action=outweb02.pbl method=post name=UpdateForm
 onsubmit='return validateMandatory(this);' >
<input type=hidden name=reportno value="04">
<input type=hidden name=template value="004">
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=casekeys value="%OUTWEB02.03.366" >
<input type=hidden name=updatety value="6">
<input type=hidden name=defclnty value="%OUTWEB02.03.308">
<input type=hidden name=defclnid value="%OUTWEB02.03.303.0">
<input type=hidden name=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="">
<input type=hidden name=ptcnueoc value="%OUTWEB02.03.616">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="%OUTWEB02.03.628">
<input type=hidden name=ptcnuebb value="">
<input type=hidden name=obacompd value="%OUTWEB02.03.321.3">
<input type=hidden name=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="%OUTWEB02.03.634">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=otheccar value="%OUTWEB02.03.641">
<input type=hidden name=outbb065 value="%OUTWEB02.03.327.001">
<input type=hidden name=intrpreq value="%OUTWEB02.03.086.001.0">

<tr><td width=15% class=DataLabel>Clinic</td>
 <td class=DataField>
<input type=hidden name=newslotk value="%OUTWEB02.03.366">
<input type=text size=30 name=clindesc readonly class = ReadOnly title="Clinic" class=Mandatory 
value="%OUTWEB02.03.303.1" >
</td>
  <td class = DataLabel> Date </td>
  <td class = DataField>
  <input type = text size = 35 name = clindate readonly class = ReadOnly class = Mandatory
   value = "%OUTWEB02.03.313 %OUTWEB02.03.304 at %OUTWEB02.03.316">
  </td>
</tr>
<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField>
    <select name=outbb047 title="Visit Type" class="SelectBig Mandatory">
    %OUTWEB02.03.399
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField>
    <input type=text name=pmsvx052 size=50 maxlength=50 
      value="%OUTWEB02.03.852">
</td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb045 value="%OUTWEB02.03.364"
     onblur="validateCode(6,UpdateForm.outbb045,UpdateForm.outbb046);">
    <input type=text name=outbb046 readonly class=Readonly size=75
     maxlength=50 value="%OUTWEB02.03.365">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb055 value="%OUTWEB02.03.379"
     onblur="validateCode(6,UpdateForm.outbb055,UpdateForm.outbb056);">
    <input type=text name=outbb056 readonly class=Readonly size=75 
                                maxlength=50 value="%OUTWEB02.03.380">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb057 value="%OUTWEB02.03.381"
     onblur="validateCode(6,UpdateForm.outbb057,UpdateForm.outbb058);">
    <input type=text size=75 maxlength=50 name=outbb058 readonly 
                               class=Readonly value="%OUTWEB02.03.382">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    </td></tr>
<tr><td>&nbsp;</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb059 value="%OUTWEB02.03.383"
     onblur="validateCode(6,UpdateForm.outbb059,UpdateForm.outbb060);">
   <input type=text size=75 maxlength=50 name=outbb060 readonly 
                               class=Readonly value="%OUTWEB02.03.384" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd9DisSrchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 class=SelectBig>
        <option value="   ">NO</option>
        %OUTWEB02.03.342.2
        </select></td>
    <td class=DataLabel>Priority</td>
    <td class=DataField><select name=outbb013 class=SelectBig>
	<option></option>
	%OUTWEB02.03.332.2
	</select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField><select name=outbb002 class="Mandatory SelectBig"
        title="%STANDARD.01.017.CL">
        <option></option>
        %OUTWEB02.03.321.9.1.10.2.X
        </select></td>
  <td class=DataLabel>Unit</td>
    <td class=DataField><select name=outbb022 class="SelectBig"
                         title="Unit">
      <option></option>
       %OUTWEB02.03.341.5
	</select></td></tr>

<tr><td class=DataLabel>Source of Referral</td>
    <td class=DataField><select name=outbb001 class="Mandatory SelectBig"
         title="Source of Referral">
        <option></option>
         %OUTWEB02.03.320.9.1.10.2.S
        </select></td>
    <td class=DataLabel>Reports Required</td>
    <td class=DataField><select name=outbb017 class=SelectBig>
        <option></option>
        %OUTWEB02.03.336.2
        </select></td>
     </tr>
<tr><td class=DataLabel>Special Arrangements</td>
    <td class=DataField><select name=outbb054 class=SelectBig>
    <option></option>
    %OUTWEB02.03.378.2
    </select></td>
    <td class=DataLabel>Attending HCP</td>
    <!--<td class=DataLabel>Referring GP</td>-->
    <td class=DataField>
    <input type=hidden name=outbb029 value='%OUTWEB02.03.390'>
    <input type=hidden name=dummy1 value="6"> 
    <input type=text readonly name=genpname  class=Mandatory 
     title="Attending HCP">
    <img src="../images/SearchIcon.gif"
     onclick="HCPSearchFrame(outbb029,genpname,dummy1.value)">
    <img src="../images/erase.gif" align=absmiddle
     onClick="clrFields(outbb029,genpname);">
    </td></tr>
<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036></td>
</tr>

      <tr>
        <td>
          <table border=0 width=100% class=TableBody cellpadding=0
                 cellspacing=0>
            <tr><td class=DataLabel>Comments</td></tr>
            <tr><td colspan=6 align=left>
                <input type=button value="Add" class="button"
                 name="AddComm" id="AddComm"
                 onclick="tempDisable(this);AddComment();"></td></tr>
            <tr><td>&nbsp;</td></tr>
            <tr><td>&nbsp;</td></tr>
          </table>
        </td>
        <td colspan=6 align=left>
          <textarea wrap=hard name=outptcoa class=Readonly readonly
           rows=4 cols=70>%OUTWEB02.03.327.016.005</textarea>
        </td>
      </tr>

</table>

<div id=ShowXCmbs></div>
<div id=ShowCarer></div>
<div id=ShowIntrp></div>

<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=5 align=center>
    <input type=button class="button" value="Ok"
     onclick="UpdateApp();">
    <input type=button class="button" value="Cancel" 
                                    onclick="DFrameCloseRefresh();">
    </td></tr>
</table>
</form>
</div>

<span id=extracmbs style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 title="Item Type"
     value="%OUTWEB02.03.624. 1.0">
    <input type=text size=9 name=otbit002 title="Item Code"
     value="%OUTWEB02.03.625. 1"
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=3 name=otbit003 title="Sub-Item Code"
     value="%OUTWEB02.03.626. 1"
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 value="%OUTWEB02.03.627. 1.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 value="%OUTWEB02.03.627. 1.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
     onclick=PriMbsSearchFrame(otbit001,otbit002,otbit003,dumdate,mbsdesc1,dumInput,TypeDesc1)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit002,otbit003,mbsdesc1,mbsamnt1,otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 title="Provider Usage" 
     tabindex=91 value="%OUTWEB02.03.635. 1">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 title="Item Type 2"
     value="%OUTWEB02.03.624. 2.0">
    <input type=text size=9 name=otbit005 title="Item Code 2"
     value="%OUTWEB02.03.625. 2"
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=3 name=otbit006 title="Sub-Item Code 2"
     value="%OUTWEB02.03.626. 2"
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 value="%OUTWEB02.03.627. 2.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 value="%OUTWEB02.03.627. 2.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit004,otbit005,otbit006,dumdate,mbsdesc2,dumInput,TypeDesc2)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit005,otbit006,mbsdesc2,mbsamnt2,otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 title="Provider Usage 2"
     tabindex=92 value="%OUTWEB02.03.635. 2">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 title="Item Type 3"
     value="%OUTWEB02.03.624. 3.0">
    <input type=text size=9 name=otbit008 title="Item Code 3"
     value="%OUTWEB02.03.625. 3"
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);" >
    <input type=text size=3 name=otbit009 title="Sub-Item Code 3"
     value="%OUTWEB02.03.626. 3"
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);" >
    <input type=text size=30 name=mbsdesc3 value="%OUTWEB02.03.627. 3.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 value="%OUTWEB02.03.627. 3.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit007,otbit008,otbit009,dumdate,mbsdesc3,dumInput,TypeDesc3)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit008,otbit009,mbsdesc3,mbsamnt3,otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 title="Provider Usage 3"
     tabindex=93 value="%OUTWEB02.03.635. 3">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 title="Item Type 4"
     value="%OUTWEB02.03.624. 4.0">
    <input type=text size=9 name=otbit011 title="Item Code 4"
     value="%OUTWEB02.03.625. 4"
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);" >
    <input type=text size=3 name=otbit012 title="Sub-Item Code 4"
     value="%OUTWEB02.03.626. 4"
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);" >
    <input type=text size=30 name=mbsdesc4 value="%OUTWEB02.03.627. 4.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 value="%OUTWEB02.03.627. 4.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit010,otbit011,otbit012,dumdate,mbsdesc4,dumInput,TypeDesc4)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit011,otbit012,mbsdesc4,mbsamnt4,otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 title="Provider Usage 4"
     tabindex=94 value="%OUTWEB02.03.635. 4">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 title="Item Type 5"
     value="%OUTWEB02.03.624. 5.0">
    <input type=text size=9 name=otbit014 title="Item Code 5"
     value="%OUTWEB02.03.625. 5"
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);" >
    <input type=text size=3 name=otbit015 title="Sub-Item Code 5"
     value="%OUTWEB02.03.626. 5"
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);" >
    <input type=text size=30 name=mbsdesc5 value="%OUTWEB02.03.627. 5.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 value="%OUTWEB02.03.627. 5.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit013,otbit014,otbit015,dumdate,mbsdesc5,dumInput,TypeDesc5)>
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(otbit014,otbit015,mbsdesc5,mbsamnt5,otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 title="Provider Usage 5"
     tabindex=95 value="%OUTWEB02.03.635. 5">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload onclick="TemplateCmbs();">
    &nbsp;
    <select class="SelectBig" name=cmbstemp title="CMBS Template"
         onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB02.03.629
          </select></td>
    </tr>

<tr><td>Print Medicare Claims</td>
    <td><input type=checkbox value=1 name=claimprt>
    &nbsp;
    <select class="SelectBig" name=claimpsl title="Printer">
          <option></option>
          %STANDARD.01.001.OUTCLAIM.03
          </select></td>
    </tr>
</table>
</span>

<span id=sendcarer style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField><input type=checkbox value=1 name=d_outbb065
                         onclick="SetCare();"></td>
    </tr>
</table>
</span>

<span id=dispintrp style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=1 align=center>
<tr><td class=DataLabel width=15%>Interpreter</td>
    <td class=DataField>
    <input type=text name=pmsvx053 size=50 maxlength=50            

      value="%OUTWEB02.03.853"> </td></tr>
</table>
</span>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
</form>
<script type = "text/javascript" language = javascript>

function init(){
 var title = '%OUTWEB02.03.348.003'
 var name  = '%OUTWEB02.03.348.004'
 var surname = '%OUTWEB02.03.348.005'

 UpdateForm.genpname.value = trim(title)+" "+trim(name)+" "+trim(surname);
}
function makeCheck()
{
 if ("%OUTWEB02.03.355" == "1") {
    UpdateForm.outbb036.checked = 1
}
}
DisplayXCmbs();
DisplayCarer();
DisplayIntrp();
ReferralNumber='%OUTWEB02.03.753.001';
ClinicHIC='%OUTWEB02.03.634';
UsingHIC='%STANDARD.01.025.000.132.0.1';
if (document.UpdateForm.clinindc.value=="P") {
  if(isWhitespace(ReferralNumber) && ClinicHIC=='1' && UsingHIC=='1') {
    alert("Warning - No referral linked to this visit.");
  }
}
</script>

