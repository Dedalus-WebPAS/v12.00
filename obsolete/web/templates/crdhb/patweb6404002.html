<meta name="TemplateVersion" content="V11.04.00">
<meta name="TemplateHome"    content="crdhb" />
<meta name="HelpFileName"    content="NoContextSet.html" />
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript">
function SelectSubmit() {
  clearFilter();
  document.SelectPeriod.submit();
}
// 01 : TAS : CWSNM-81 : Add Mobile column
function InitTable() {
  p = document.SelectPeriod;
  document.title="SMS Response Message Errors";
  t = new Table(1,0,2,"100%","center",40);
  t.addColumn("Patient","ImageText",17,17,"left","PatientFolder","0",120,18)
  t.addColumn("Visit","String",4,4,"left","","",40)
  if(p.ibcnmhos.value == "1") {
    t.addColumn("Hospital/Ward","String",22,22,"left","","",50)
  }
  else {
    t.addColumn("Ward","String",22,22,"left","","",50)
  }
  t.addColumn("Message Type","String",13,13,"left","","",50)
  t.addColumn("Contact Type","String",21,21,"left","","",70)
  t.addColumn("Date & Time Sent","DateTime",19,19,"left","","",70)
  t.addColumn("SMS Type","String",15,15,"left","","",50)
  t.addColumn("Mobile","String",9,9,"left","","",50) 
  t.addColumn("Error Message","String",14,14,"left","","",100)
  t.addColumn("Status","String",20,20,"left","","",70)
  AddTableRows();
  TableOutput(4,2);    // Sort by Date/Time
  t.sortTable(0,2);    // Name
}
function linkPatient(ur,vtype,key) {
  linkurl="patweb64.pbl?reportno=03&template=001" +
              "&urnumber="+ur.replace(/ /g,"+");
  if(vtype==" 2" || vtype==" 3") {
    linkurl+="&admissno="+key.replace(/ /g,"+");
  } else {
    linkurl+="&allvisit=1";
  }
  location.href=linkurl;
}
function reSendSMS(id,error) {
  linkurl="patweb64.pbl?reportno=05&template=001" +  
          "&messagid=" + id +
          "&errorkey=" + id + error;
  Left=(document.body.clientWidth-1000)/2;
  DFrameLink(linkurl,100,Left,1000,450);
}
function SetHospital() {
  p = document.SelectPeriod;
  if (p.ibcnmhos.value == "1") {
    HospHead.innerHTML = hosphead.innerHTML;
    HospOptn.innerHTML = hospoptn.innerHTML;
  }
  else {
    HospHead.innerHTML = "";
    HospOptn.innerHTML = hospblank.innerHTML;
  }
}

function SelectFilter() {
  var msgtyp = document.getElementById('filttype').value;
  if (msgtyp == 3) { //Inpatient admission type filter
    WardHead.innerHTML = wardhead.innerHTML;
    WardOptn.innerHTML = wardoptn.innerHTML;
    AdtpOptn.innerHTML = adtpoptn.innerHTML;

    WlutOptn.innerHTML = wlutblank.innerHTML;
    CltpOptn.innerHTML = cltpblank.innerHTML;
  }
  else if (msgtyp == 2) { //Outpatient clinic type filter
    CltpOptn.innerHTML = cltpoptn.innerHTML;

    WardHead.innerHTML = "";
    WardOptn.innerHTML = wardblank.innerHTML;
    AdtpOptn.innerHTML = adtpblank.innerHTML;
    WlutOptn.innerHTML = wlutblank.innerHTML;
    SetList();
  }
  else if (msgtyp == 9) { //Waiting list unit filter
    WlutOptn.innerHTML = wlutoptn.innerHTML;

    WardHead.innerHTML = "";
    WardOptn.innerHTML = wardblank.innerHTML;
    AdtpOptn.innerHTML = adtpblank.innerHTML;
    CltpOptn.innerHTML = cltpblank.innerHTML;
  }
  else {
    WardHead.innerHTML = "";
    WardOptn.innerHTML = wardblank.innerHTML;
    AdtpOptn.innerHTML = adtpblank.innerHTML;
    CltpOptn.innerHTML = cltpblank.innerHTML;
    WlutOptn.innerHTML = wlutblank.innerHTML;
  }
}

function clearFilter() {
  if (document.getElementById('filttype').value == 2) { //Outpatient
    document.getElementById('filtward').value = "";
    document.getElementById('filtadtp').value = "";
    document.getElementById('filtwlut').value = "";
  }

  if (document.getElementById('filttype').value == 3) { //Inpatient
    document.getElementById('filtcltp').value = "";
    document.getElementById('filtwlut').value = "";
  }

  if (document.getElementById('filttype').value == 9) { //Waiting list
    document.getElementById('filtward').value = "";
    document.getElementById('filtadtp').value = "";
    document.getElementById('filtcltp').value = "";
  }
}

function SetList() {
   p=SelectPeriod;
   p.filtcltp.options.length=1;
   SetClinicType(p.filtcltp,p.defctype.value,p.wbsesite.value);

}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetHospital();InitTable();SelectFilter();">
<div id="HeadingSection">
 <form name="SelectPeriod" action="patweb64.pbl" method="get" style="margin:0">
  <input type="hidden" name="reportno" value="04" />
  <input type="hidden" name="template" value="002" />
  <input type="hidden" name="viewtype" value="%PATWEB64.04.012" />
  <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
  <input type=hidden name=showflag value="%PATWEB64.04.024">
  <input type=hidden name=dfallhsp value="%PATWEB64.04.025">
  <input type=hidden name=wbsesite value="%STANDARD.01.023">
  <input type=hidden name=defctype value="%PATWEB64.04.027">

  <table cellpadding="3" bgcolor="#CCCCCC" border="0" width="100%">
   <tr><td class="DataLabel"><input type="button" value="<<" class=SmallButton
           onClick='location.href="%PATWEB64.04.017.002"' />
           %PATWEB64.04.013
           <input type="button" value=">>" class=SmallButton
                  onClick='location.href="%PATWEB64.04.016.002"' />
           <a href='javascript:SelectDateFrame();'>
              <img src="../images/DateLookup.gif" border="0"
                   alt="Select Date" align="absmiddle" /></a>
           <a href='javascript:SelectView("0");'>
              <img src="../images/DayIcon.gif" border="0"
                   alt="View Today" align="absmiddle" /></a>
           <a href='javascript:SelectView("1");'>
              <img src="../images/WeekIcon.gif" border="0"
                   alt="View This Week" align="absmiddle" /></a>
           <a href='javascript:SelectView("2");'>
              <img src="../images/MonthIcon.gif" border="0"
                   alt="View This Month" align="absmiddle" /></a></td>
       <td><div id=HospHead></div></td>
       <td><div id=HospOptn></div></td>
       <td class="DataLabel">Message Type
           <select name="filttype" class="SelectMed"
                   onchange="SelectSubmit();">
             <option value="  ">All</option>
             <option value=" 2">Outpatient</option>
             <option value=" 3">Inpatient</option>
             <option value=" 9">Waiting List</option>
           </select></td>

       <td><div id=WardHead></div></td>
       <td><div id=WardOptn></div></td>

       <td><div id=AdtpOptn></div></td>
       <td><div id=CltpOptn></div></td>
       <td><div id=WlutOptn></div></td>

       <td class="DataLabel">Status
           <select name="filtstat" class="SelectMed"
                   onchange="SelectSubmit();">
             <option value="  ">All</option>
             <option value=" 3">Error</option>
             <option value=" 4">Error Pocessed</option>
           </select></td>
   </tr>
  </table>
 </form>
</div>

<div id="TableLocation"></div>

<script type="text/javascript">
function AddTableRows() {
%PATWEB64.04.018
}
MessageType="%PATWEB64.04.014";
 for (var i=0; i < document.SelectPeriod.filttype.length; i++) {
  if (document.SelectPeriod.filttype.options[i].value==MessageType){
      document.SelectPeriod.filttype.selectedIndex=i;
  }
 }
MessageStatus="%PATWEB64.04.015";
 for (var i=0; i < document.SelectPeriod.filtstat.length; i++) {
  if (document.SelectPeriod.filtstat.options[i].value==MessageStatus){
      document.SelectPeriod.filtstat.selectedIndex=i;
  }
 }
</script>
<span id=hosphead style="display:none">
  <td class=DataLabel>Hospital</td>
</span>
<span id=hospoptn style="display:none">
  <td><select name=filthosp class="SelectMed" title="Hospital"
        onchange="SelectSubmit();">
        <option value="">All</option>
          %PATWEB64.04.022
        </select></td>
</span>
<span id=hospblank style="display:none">
<td><input type=hidden name=filthosp value=""></td>
</span>

<span id=wardhead style="display:none">
  <td class=DataLabel>Ward</td>
</span>

<span id=wardoptn style="display:none">
  <td><select name=filtward class="SelectMed" title="Ward"
             onchange="SelectSubmit();">
             <option value="">All</option>
               %PATWEB64.04.023
      </select>
  </td>
</span>



<span id=adtpoptn style="display:none">
      <td class=DataLabel>Health Speciality</td>
      <td><select name="filtadtp" title="Health Speciality" class="SelectMed"
           onchange="SelectSubmit();">
        <option value="">All</option>
        %PATWEB64.04.026
        </select>
      </td>
</span>

<span id=wlutoptn style="display:none">
      <td class=DataLabel>Waiting List Unit</td>
      <td><select name="filtwlut" title="Waiting List Unit" class="SelectMed"
           onchange="SelectSubmit();">
        <option value="">All</option>
        %PATWEB64.04.028
        </select>
      </td>
</span>

<span id=cltpblank style="display:none">
<td><input type=hidden name=filtcltp value=""></td>
</span>


<span id=wardblank style="display:none">
<td><input type=hidden name=filtward value=""></td>
</span>


<span id=adtpblank style="display:none">
<td><input type=hidden name=filtadtp value=""></td>
</span>

<span id=wlutblank style="display:none">
<td><input type=hidden name=filtwlut value=""></td>
</span>


<span id=cltpoptn style="display:none">
      <td class=DataLabel>Clinic Type</td>
      <td><select name="filtcltp" id=filtcltp title="Clinic Type" 
           class="SelectMed" onchange="SelectSubmit();">
        <option value="">All</option>
        </select>
      </td>
</span>
