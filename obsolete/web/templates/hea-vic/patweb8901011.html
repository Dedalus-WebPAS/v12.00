<meta name="TemplateVersion" content="V10.11.01">
<meta name="TemplateHome" content="hea-vic">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript" src="../js/eAdmissionReg.js"></script>
<script type="text/javascript">
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;

     if (UpdateForm.ptmis026.className=="Mandatory") {
       UpdateForm.ptmis026.className="OECRequired Mandatory";
       UpdateForm.mbsdesc1.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis026.className="OECRequired";  //Claim Type
       UpdateForm.mbsdesc1.className="OECRequired";  //Claim Type
     }

  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }
}

function validateItemCode(ItemType,ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription) {

  if (ItemType.value=="6") {
    validateMsc1(ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription);
  }
  if (ItemType.value=="3") {
    validateCode(4,ItemCode,ItemDescription);
  }

}

function mandatoryItemCode(ItemCode,DateofService,ServiceQuantity) {

  if(!isWhitespace(ItemCode.value)) {
    DateofService.className="Mandatory FutureDate";
    ServiceQuantity.className="Mandatory Integer";
  } else {
    DateofService.className="FutureDate";
    ServiceQuantity.className="Integer";
  }
}

function ItemCodeSearchFrame(ItemType,ItemCode,ItemDescription) {

  if (ItemType.value=="6") {
    MiscChargeSearchFrame(ItemCode,ItemDescription);
  }

  if (ItemType.value=="3") {
    MbsSearchFrame(ItemCode,ItemDescription);
  }
}

function chkDOS(datefield) {
  if(!isWhitespace(datefield.value)){
    if(!ChkDateTime(UpdateForm.ptmis001,null,datefield,null)){
      alert(datefield.title+" cannot be before Admission Date");
      return false;
    }
  }
  return true;
}
function SubmitAdm() {
  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  MandatoryOk=true;
  if (!validateMandatory(UpdateForm)) {
      return;
  }

    if (document.UpdateForm.oecchbox.checked==true) {
      if (!validateOECRequired(document.UpdateForm)) {
         return;
      }
      if (document.UpdateForm.ptmis027.value.substr(3,5).search("V")==-1) {
        if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
           return;
        }
      }
    }

  if (!isWhitespace(UpdateForm.ptmis013.value)) {
      if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                          UpdateForm.funddesc,UpdateForm.tabldesc)) {
         ans=confirm("Select another active health fund table? ");
         if (ans==true) {
            return;
         }
      }
  }

  if (UpdateForm.oes01007 != undefined) {

    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }

  }

  if(document.UpdateForm.oecchbox.checked == true) {
     document.UpdateForm.ptvis109.value="1";
  }

  HealthFundProgramIP(UpdateForm.urnumber,UpdateForm.ptmis010,
                      UpdateForm.ptmis027,UpdateForm.ptmis013,
                      UpdateForm.ptmis014,UpdateForm.ptmis001);
  if (MandatoryOk) {
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    postUpdateEAdmissionStatus();
    checkPrevPRFA();
    SubmitHidden(UpdateForm);
   }
}

function ShowOECFields() {
  if(document.UpdateForm.oecchbox.checked == true) {
    PreExistAilHdr.innerHTML=preexisthdr.innerHTML;
    PreExistAilmnt.innerHTML=preexistail.innerHTML;
    EmerAdmHdr.innerHTML=emeradmnhdr.innerHTML;
    EmerAdmssn.innerHTML=emeradmissn.innerHTML;
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
//    SwiPresIllHdr.innerHTML=swipresillhdr.innerHTML;
    SwiPresIll.innerHTML=swipresill.innerHTML;
    LongLine.innerHTML=longline.innerHTML;
    OESServices.innerHTML=oesservices.innerHTML;
  } else {
    PreExistAilHdr.innerHTML=blanklabel.innerHTML;
    PreExistAilmnt.innerHTML=blanklabel.innerHTML;
    EmerAdmHdr.innerHTML=blanklabel.innerHTML;
    EmerAdmssn.innerHTML=blanklabel.innerHTML;
    PresIllCodHdr.innerHTML=blanklabel.innerHTML;
    PresIllCod.innerHTML=blanklabel.innerHTML;
//    SwiPresIllHdr.innerHTML=blanklabel.innerHTML;
    SwiPresIll.innerHTML=blanklabel.innerHTML;
    LongLine.innerHTML=blanklabel.innerHTML;
    OESServices.innerHTML=blanklabel.innerHTML;
  }
}

function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) {
         return false } }
    }

    if (isWhitespace(document.UpdateForm.patsurnm.value)) {
      alertOEC(document.UpdateForm.patsurnm);
      return false;
    }

    if (isWhitespace(document.UpdateForm.patgivnm.value)) {
      alertOEC(document.UpdateForm.patgivnm);
      return false;
    }

    if (isWhitespace(document.UpdateForm.patntdob.value)) {
      alertOEC(document.UpdateForm.patntdob);
      return false;
    }

//  if (isWhitespace(document.UpdateForm.medicrdn.value)) {
//    alertOEC(document.UpdateForm.medicrdn);
//    return false;
//  }

//  if (isWhitespace(document.UpdateForm.medicrdr.value)) {
//    alertOEC(document.UpdateForm.medicrdr);
//    return false;
//  }

  return true;
}
function alertOEC(OECpmifield) {
  alert("Online Eligibility Details Incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}
function checkOECString (theField, s, emptyOK) {
if (checkOECString.arguments.length == 2) emptyOK = false;
 if ((emptyOK == true) && (isEmpty(theField.value))) return true;
 if (isWhitespace(theField.value))
   return warnOECEmpty (theField, s);
 else return true;
}
function warnOECEmpty (theField, s) {
 alert("Online Eligibility Details Incomplete. Request Not Processed.\n"
       + s + " is a required OEC field.\nPlease enter it now." )
 theField.focus()
 return false
}

function OECRequired() {
 if(document.UpdateForm.oecchbox.checked == true) {

     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="Mandatory") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="Mandatory") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";
     } else {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="Mandatory") {
       UpdateForm.funddesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.funddesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.tabldesc.className=="Mandatory") {
       UpdateForm.tabldesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.tabldesc.className="OECRequired";  //Health Fund Code
     }

     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber

  } else {

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="Mandatory";  //Diagnosis
     } else {
       UpdateForm.ptmis020.className="";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
       UpdateForm.funddesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.funddesc.className="";  //Health Fund
     }

     if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
       UpdateForm.tabldesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.tabldesc.className="";  //Health Fund
     }

     UpdateForm.ptmis030.className="Integer";    //Planned Length of Stay
     UpdateForm.ptvis076.className="";           //Discharge Inten
     UpdateForm.ptmis015.className="";           //Member Number
  }
}


function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
}
function selectUnit(){
  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value.substr(0,3)==
        document.UpdateForm.deftunit.value.substr(0,3)) {
      document.UpdateForm.ptmis024.selectedIndex=i;
    }
  };
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptvis028.className="Mandatory";  //referring gp
//   UpdateForm.genpprac.className="Mandatory";  //referring practice
     UpdateForm.genpname.className="Mandatory";  //referring gp desc
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
//   UpdateForm.ptmis005.className="Mandatory";  //bed
     UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     UpdateForm.ptvis093.className="Mandatory";  //Preferred Accom
     UpdateForm.ptvis022.className="Mandatory";  //Inform GP
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptvis028.className="";  //referring gp
//   UpdateForm.genpprac.className="";  //referring practice
     UpdateForm.genpname.className="";  //referring gp desc
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptvis041.className="";  //criteria for admission
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
//   UpdateForm.ptmis005.className="";  //bed
     UpdateForm.ptmis007.className="";  //Admitting Doctor
     UpdateForm.doctnam2.className="";  //Admitting Doctor description
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis027.className="";  //Financial Class
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis043.className="";  //Intended Stay
     UpdateForm.ptvis093.className="";  //Preferred Accom
     UpdateForm.ptvis022.className="";  //Inform GP
  }
}

function postUpdateEAdmissionStatus() {
  var admisnid = getQueryString('admisnid');

  if(!isWhitespace(admisnid)) {
    var xhr = createHttpObject();
    var url = "patweb14.pbl?reportno=07&websrvno=2&urnumber="
              +UpdateForm.urnumber.value.replace(/ /g,'+')
              +"&statcode=2&admisnid="+admisnid.replace(/ /g,'+')
              +"&admissno="+UpdateForm.admissno.value.replace(/ /g,'+');
    xhr.open('GET',url,false);
    xhr.send();
  }
}
function valReferGP(){
   p=document.UpdateForm;
   if (!isWhitespace(p.ptvis028.value)) {
      ReadDoc(18,0,p.ptvis028,p.genpname,p.ptvis029,p.genpprac,p.ptvis030,p.genpprov);
   }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);document.UpdateForm.ptmis001.focus();DisplayTrnSrc();
              valDoctorUnit();selectUnit();displayRegime();defaultWard();
              DisplayContractHEA();OnlinePreadmission();valReferGP();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=linkForm action=patweb89.pbl method=post>
<input type="hidden" name="reportno" value="1">
<input type="hidden" name="template" value="1">
<input type="hidden" name="urnumber" value="%PATWEB89.01.003">
<input type="hidden" name="admissno" value="%PATWEB89.01.101">
</form>

<form name=UpdateForm method=post action=patweb89.pbl>
<input type="hidden" name="reportno" value="2">
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="redirect" value="%PATWEB89.01.001.patweb98.01.001">
<input type="hidden" name="urnumber" value="%PATWEB89.01.003">
<input type="hidden" name="admissno" value="%PATWEB89.01.101">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="admitnow" value="1">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptmis004" value="0">
<input type="hidden" name="ptmas046" value="0">
<input type="hidden" name="mvmedrec">
<input type="hidden" name="dummy">
<input type="hidden" name="prevdeta" value="1">
<input type="hidden" name="cfinan"   value="%PATWEB89.01.932">
<input type="hidden" name="exstward" value="%PATWEB89.01.449.1">
<input type="hidden" name="deftunit" value="%PATWEB89.01.124.1">
<input type="hidden" name="prevprfa" value="%PATWEB89.01.999.045. 1">
<input type="hidden" name="prprfad1" value="%PATWEB89.01.999.045. 2">
<input type="hidden" name="prprfad2" value="%PATWEB89.01.999.045. 3">
<input type="hidden" name="prprfsub" value="%PATWEB89.01.999.045. 4">
<input type="hidden" name="prprfpos" value="%PATWEB89.01.999.045. 5">
<input type="hidden" name="prprfad4" value="%PATWEB89.01.999.045. 6">
<input type="hidden" name="prprfrel" value="%PATWEB89.01.999.045. 7">
<input type="hidden" name="prprfnam" value="%PATWEB89.01.999.045. 8">
<input type="hidden" name=ptcnelos value="%STANDARD.01.025.124.144.0.1">
<input type="hidden" name="ptvis109">
<input type="hidden" name="patsurnm"
       title="Patient Surname" value="%PATWEB89.01.009">
<input type="hidden" name="patgivnm"
       title="Patient Given Name" value="%PATWEB89.01.010">
<input type="hidden" name="patntdob"
       title="Patient Date of Birth" value="%PATWEB89.01.020">
<input type="hidden" name="medicrdn"
       title="Medicare Card Number" value="%PATWEB89.01.027">
<input type="hidden" name="medicrdr"
       title="Medicare Card Reference Number" value="%PATWEB89.01.649">

<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr>
  <td class=HeadingCell align=center>
    Patient Pre-Admission Details(from Inpatient Details)
  </td>
<tr>

<tr>
  <td>
    <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
    <tr>
      <td>&nbsp;</td><td>&nbsp;</td>
      <td align=left><b>Admit Now?</b></td>
      <td align=left>
        <input type="checkbox" name="admitbox" value="0" notab
         onclick='AdmitMandatory()';>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              <b>Patient OEC Consent</b>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              <input type="checkbox" name="oecchbox" value="0" notab
                     onclick='ShowOECFields();OECRequired();'>
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Admission Date</td>
      <td class=DataLabel><input type="text" size="12" tabindex=1
       name=ptmis001 value="%STANDARD.01.015" class=Mandatory 
       title="Admission Date" onblur="checkDate(this,'Admission Date');">
        <img src=../images/DateLookup.gif border=0 hspace=4
         align=absmiddle onclick="DateLookupFrame(ptmis001);"> 
         Time <input type=text name=ptmis002 tabindex=2 size=8
         value="%STANDARD.01.016" class=Mandatory title="Admission 
         Time">
        <img src=../images/DateTimeStamp.gif border=0 hspace=4 
         align=absmiddle onClick="SetCurrentDateTime(null,ptmis002);">
        <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
         onclick="TimeLookupFrame(ptmis002);"> 
      </td>
      <td>Admitting Point</td>
      <td><select name=ptvis046 tabindex=15 onChange="defaultWard()">
            <option></option>
            %PATWEB89.01.290.2
          </select>
          <input type="hidden" name='ptvis047' size=3>
      </td>
    </tr>

    <tr>
      <td class=DataLabel>%STANDARD.01.017.P </td>
      <td><select name=ptmis011 tabindex=3 title="%STANDARD.01.017.P ">
            <option> </option>
            %PATWEB89.01.112.2
          </select>
      </td>
      <td class=DataLabel>Ward / Bed </td>
      <td>
        <input type="hidden" name=bedstat1>
        <input type="hidden" name=ptmis005 title="Bed">
        <input type="hidden" name=warddesc>
        <select name=ptmis068 tabindex=16 title="Ward">
          <option> </option>
          %PATWEB89.01.449.2
        </select>
        <input type=text name=ptmis076 maxlength=3 size=3 
         title="Bed">
        <img src=../images/SearchIcon.gif border=0 vspace=1
         onClick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Admission Source</td>
      <td><select name=ptmis009 tabindex=3 onChange="DisplayTrnSrc()" 
           class=SelectBig>
            <option> </option>
            %PATWEB89.01.110.2
          </select>
      </td>
      <td class=DataLabel>Admitting Doctor</td>
      <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=17
           value="%PATWEB89.01.108.003" title='Admitting Doctor'
           onblur="UpCase(this);valDoctorUnit();">
          <input type=text readonly size=25 name=doctnam2
           value="%PATWEB89.01.108.002">
          <img src="../images/SearchIcon.gif"
           onClick="DoctorSearchFrame(ptmis007,doctnam2)">
      </td>
    </tr>

    <tr>
      <td><div id=TranSrcHeading></div></td>
      <td><div id=TranSrc></div></td>
      <td class=DataLabel>Unit</td>
      <td><select name=ptmis024 tabindex=18 title='Unit'>
            <option> </option>
            %PATWEB89.01.124.2
          </select>
      </td>
    <tr>

    <tr>
      <td align=left>No of days of hospitalisation</td>
      <td><input type=text name=ptmis031 
           title='No of days of hospitalisation'
           class=Integer size=5 maxlength=3 tabindex=5
           onblur="checkInteger(this,this.title);" value="%PATWEB89.01.130">
      </td>
      <td class=DataLabel>Diagnosis </td>
      <td><input type=text name="ptmis020" size=50 maxlength=80 tabindex=19
           value="%PATWEB89.01.121" title="Diagnosis">
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Provisional DRG</td>
      <td><input type=text name=ptmis066 size=5 maxlength=4 tabindex=6
           onblur="validateCode(5,ptmis066,drgdesc1);"
           value="%PATWEB89.01.140.0">
          <input type=text notab readonly name=drgdesc1 size=35 
           value="%PATWEB89.01.140.1">
          <img src="../images/SearchIcon.gif"
           onClick="DrgSearchFrame(ptmis066,drgdesc1)">
      </td>
      <td class=DataLabel>Criteria for Admission</td>
      <td><select name=ptvis041 tabindex=20 class=SelectBig
           title="Criteria for Admission">
            <option> </option>
            %PATWEB89.01.244.2
          </select>
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Care Type</td>
      <td><select name=ptmis012 tabindex=8 class=SelectBig 
           title="Care Type" onchange="displayRegime();">
            <option> </option>
            %PATWEB89.01.113.2
          </select>
      </td>
      <td class=DataLabel>Referring GP</td>
      <td><input type="text" size=10 maxlength=8 name="ptvis028" tabindex=21
           value="%PATWEB89.01.231.1" title="Referring GP"
           onchange="ReadDoc(18,0,ptvis028,genpname,ptvis029,genpprac,ptvis030,genpprov);">
          <input type="text" size=25 readonly name=genpname
           value="%PATWEB89.01.231.0">
          <img src="../images/SearchIcon.gif"
           onClick="GPHCPSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030,0)">
          <img src="../images/erase.gif" align=absmiddle onClick="clrFields(ptvis028,genpname);">
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Intended Stay </td>
      <td><select name=ptvis043 tabindex=9 title="Intended Stay">
            <option> </option>
            %PATWEB89.01.246.2
          </select>
      </td>
      <td class=DataLabel>Practice</td>
      <td><input type=text name=genpprac size=35 readonly
           value="%PATWEB89.01.232.0">
          <input type="hidden" name=ptvis029 value="%PATWEB89.01.232.1">
          <input type="hidden" name=ptvis030 value="%PATWEB89.01.233.1">
          <input type="hidden" name=genpprov value="">
          <img src="../images/SearchIcon.gif"
           onClick="GPHCGSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030)">
          <img src="../images/erase.gif" align=absmiddle onClick="clrFields(ptvis029,genpprac,ptvis030,genpprov);">
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Discharge Intention</td>
      <td><select name=ptvis076 tabindex=9 title="Care Type"> 
            <option> </option>
            %PATWEB89.01.292.2
          </select>
      </td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 tabindex=22 title="Inform GP">
          <option value="2"></option>
          <option value="0">No</option>
          <option value="1">Yes</option>
        </select>
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Preferred Accommodation</td>
      <td><select name=ptvis093 tabindex=9 title="Preferred Accommodation">
            <option> </option>
            %PATWEB89.01.298.012.2
          </select>
      </td>
      <td class=DataLabel><div id=PCEHRTitleDIV></div></td>
      <td>
        <select name=pmsvx125 tabindex=22 title="Upload to PCEHR">
        <option value=" "></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td>
    </tr>

    <tr>
      <td class=DataLabel>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099
           title="Program" tabindex=10 value="%PATWEB89.01.298.021.1"
           onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=11
           onchange="savePrgmcode();">
            <option> </option>
            %PATWEB89.01.298.021.2
          </select>
      </td>
      <td class=DataLabel> Planned Length of Stay</td>
      <td><input type=text size=5 maxlength=5 name=ptmis030
           tabindex=23 title='Expected Length of Stay' value="%PATWEB89.01.129"
           class=Integer onblur="checkInteger(this,this.value);">
      </td>
     </tr>

     <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td class=DataLabel>Religious Visit</td>
      <td><select name=ptmis017 tabindex=24>
            <option> </option>
            <option value="0">NO</option>
            <option value="1">YES</option>
          </select>
      </td>
    </tr>

    <tr align=left><td align=center colspan="4"><hr></td></tr>
 
    <tr align=left><td class=DataLabel>%STANDARD.01.017.CL</td>
      <td align=lefta>
        <select name=ptmis027 tabindex=30 
         title="%STANDARD.01.017.CL" onchange="setHF();">
          <option> </option>
          %PATWEB89.01.126.9.1.10.2.X
        </select>
      </td>
      <td class=DataLabel>Casepayment</td>
      <td>
        <select name=ptmis075 tabindex=40>
          <option value="0">NO</option>
          <option value="1">YES</option>
        </select>
      </td>
    </tr>

    <tr>
      <td class=DataLabel>%STANDARD.01.017.A </td>
      <td>
        <select name=ptmis010 tabindex=31 
         title="%STANDARD.01.017.A " onchange="DisplayContractHEA();">
          <option> </option>
          %PATWEB89.01.111.2
        </select>
      </td>
      <td class=DataLabel>Casemix Code</td>
      <td class=DataLabel>
        <input type=text name=ptmis073 size=10 maxlength=9 tabindex=41 value=""
         value="%PATWEB89.01.198.0" onblur="valCasemix();">
        <input type=text notab readonly name=cmixdesc1 size=35 value="">
        <img notab src="../images/SearchIcon.gif" 
         onClick="CmixSearchFrameLOS(ptmis073,cmixdesc1,ptmis030)">
      </td>
    </tr>

    <tr>
      <td class=DataLabel>Health Fund</td>
      <td class=DataLabel>
        <input type="hidden" name="ptmis013" value="%PATWEB89.01.114.0">
        <input type=text size=35 name="funddesc" maxlength="30"
         value="%PATWEB89.01.114.1" notab readonly> Table
        <input type="hidden" name="ptmis014" value="%PATWEB89.01.115.0">
        <input type="text" size=20 maxlength=30 name="tabldesc"
         value="%PATWEB89.01.115.1" notab readonly>
        <img src=../images/SearchIcon.gif border=0 hspace=0 align=absmiddle
         onClick="HealthFundSearchFrameNoFocus(ptmis013,funddesc,
                                               ptmis014,tabldesc);">
        <img src="../images/erase.gif" align=absmiddle 
         onClick="clrDoc(funddesc,tabldesc);clrDoc(ptmis013,ptmis014);">
      </td>
      <td>New Program</td>
      <td><input type="checkbox" name="addnewpg" tabindex=42 value="1"></td>
    </tr>

    <tr align=left>
      <td class=DataLabel>Member Number &nbsp; </td>
      <td class=DataLabel>
        <input type=text size=20 maxlength=19 
         value="%PATWEB89.01.116" name='ptmis015' tabindex=32>
      </td>
      <td align=left>Move Medical Record</td>
      <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=43>
      </td>
    </tr>

    <tr>
      <td align=left>3B Certificate No. days of hospitalisation</td>
      <td align=left>
        <input type=text name=ptmis082 title='3B No. days of hospitalisation'
         class=Integer size=5 maxlength=3 tabindex=33
         onblur="checkInteger(this,this.title);">
      </td>
      <td class=DataLabel>Continuous Billing</td>
      <td>
        <select name=ptmis081 tabindex=44>
          <option> </option>
          %PATWEB89.01.199.014.2
        </select>
      </td>
    </tr>

    <tr>
      <td class=DataLabel>GST Applicable</td>
      <td>
        <select name=ptmis074 tabindex=34>
          <option> </option>
          %PATWEB89.01.189.2
        </select>
      </td>
      <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td>
    </tr>

    <tr>
      <td><div id=UserNameHead></div></td>
      <td><div id=UserNameCode></div></td>
      <td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td>
    </tr>

    <tr>
      <td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td>
      <td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td>
    </tr>
        
    <tr>
      <td class=DataLabel><div id=Contrac2Heading></div></td>
      <td><div id=ContractId></div></td>
      <td class=DataLabel><div id=ProgramIDHeading></div></td>
      <td><div id=ProgramID></div></td>
    </tr>

    <tr>
      <td class=DataLabel><div id=ContractHeading></div></td>
      <td><div id=ContractType></div></td>
      <td class=DataLabel><div id=Contrac1Heading></div></td>
      <td><div id=ContractRole></div></td>
    </tr>

 <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=PreExistAilHdr></div></td>
      <td><div id=PreExistAilmnt></div></td>
      </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=EmerAdmHdr></div></td>
      <td><div id=EmerAdmssn></div></td>
      </tr>


    <tr align=left><td align=left> </td>
      <td align=right><div id=SwiPresIll></div></td>
      <td class=DataLabel><div id=PresIllCodHdr></div></td>
      <td><div id=PresIllCod></div></td>
      </tr>
  <tr><td align=center colspan="4"><div id=LongLine></div></td></tr>

  <tr><td align=center colspan="4"><div id=OESServices></div></td></tr>

    <tr>
      <td class=DataLabel> Admission Comments </td>
      <td colspan=6 align=left>
        <textarea wrap=hard name=adcommnt tabindex=38
         rows=3 cols=70>%PATWEB89.01.174</textarea>
      </td>
    </tr>

    <tr align=left>
      <td colspan=4 align=center><br>
        <input type=button value="Ok" class="button" tabindex=55 id="pat89sub"
         onClick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                         UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                         UpdateForm.ptmis030.value,UpdateForm.ptmis002.value,
                         UpdateForm.ptrgm001.value,UpdateForm.ptrgm002.value,
                         UpdateForm.ptrgm003.value,SubmitAdm,
                         UpdateForm.admitbox);">
        <input tabindex=56 type=button value="Cancel" class="button"
         onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
      </td>
    </tr>
    </table>
  </td>
</tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type="hidden" name=reportno value=1>
<input type="hidden" name=template value=004>
<input type="hidden" name=urnumber value="%PATWEB89.01.003">
<input type="hidden" name=admissno value="%PATWEB89.01.081">
<input type="hidden" name=MenuType value="%PATWEB89.01.088">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=18
         onblur="checkDate(this,'ReferralDate');">
         <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
  <td><input type=text size=12 name=ptmis059 tabindex=19
         onblur="checkDate(this,'SpecConDate');">
    <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 size=5 maxlength=4 tabindex=20>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<span id=PCEHRTitleSPAN style="display:none">
Upload to PCEHR
</span>

<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }

  if ((VariableNameExists('DescriptionPCEHR'))&&(DescriptionPCEHR!="")){
    document.getElementById("PCEHRTitleSPAN").innerHTML =
    "Upload to " + DescriptionPCEHR;
    document.UpdateForm.pmsvx125.title = "Upload to " + DescriptionPCEHR;
  }
  PCEHRTitleDIV.innerHTML=PCEHRTitleSPAN.innerHTML;

 StatInd10="%PATWEB89.01.891";
 PCEHR=StatInd10.substr(4,1).replace(/ /g,"0");
 if ((PCEHR == "1") || (PCEHR == "2")) {
   document.UpdateForm.pmsvx125.value="0";
 } else {
   if (PCEHR == "3") {
     document.UpdateForm.pmsvx125.value="1";
   } else {
     document.UpdateForm.pmsvx125.value="";
   }
 }
</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
 <td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=5
      value="%PATWEB89.01.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly value="%PATWEB89.010193.1">
     <img src="../images/SearchIcon.gif"
      onClick="TransferSourceFrame(trnsfsrc,trandesc)"></td>

</tr>
</span>
<span id=transferblank style="display:none">
   <input type="hidden" name=trnsfsrc>
</span>
<span id=regimehd1 style="display:none">
<td class=DataLabel>Regime Code 1</td>
</span>
<span id=regimecod1 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm001 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm001,dummy);">
    <img src="../images/erase.gif" onclick="clrFields(ptrgm001,dummy);">
</td>
</span>

<span id=regimehd2 style="display:none">
<td class=DataLabel>Regime Code 2</td>
</span>
<span id=regimecod2 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm002 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 2">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm002,dummy);">
    <img src="../images/erase.gif" onclick="clrFields(ptrgm002,dummy);">
</td>
</span>

<span id=regimehd3 style="display:none">
<td class=DataLabel>Regime Code 3</td>
</span>
<span id=regimecod3 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm003 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 3">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm003,dummy);">
    <img src="../images/erase.gif" onclick="clrFields(ptrgm003,dummy);">
</td>
</span>

<span id=regimeblank1 style="display:none">
<td><input type="hidden" name=ptrgm001 value=""></td>
</span>

<span id=regimeblank2 style="display:none">
<td><input type="hidden" name=ptrgm002 value=""></td>
</span>

<span id=regimeblank3 style="display:none">
<td><input type="hidden" name=ptrgm003 value=""></td>
</span>

<span id=usernamehd style="display:none">
<td class=DataLabel>User Name</td>
</span>

<span id=usernamcd style="display:none">
<td><input size=12 type=text name=username class=Mandatory title="UserName">
</td>
</span>

<span id=passwordhd style="display:none">
<td class=DataLabel>Password</td>
</span>

<span id=passwordcd style="display:none">
<td><input size=12 type=password name=password onblur="checkPass();" 
     class=Mandatory title="Password"></td>
</span>
<span id=contracthd style="display:none">
Contract Type
</span>

<span id=contracrhd style="display:none">
Contract Role
</span>

<span id=contracihd style="display:none">
 Contract Id
</span>

<span id=contractid style="display:none">
  <select name=ptasf003 title="Contract Spoke Id" class=Mandatory tabindex=35>
  <option> </option>
   %PATWEB89.01.199.003.0
  </select>
</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 size=2 maxlength=1  class=Mandatory
   value="%PATWEB89.01.199.001" tabindex=36
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif"
   onClick="ContTypeAlert();">
</span>

<span id=programhd style="display:none">
 %STANDARD.01.017.PK
</span>

<span id=programdt style="display:none">
  <select name=ptvis110 title="%STANDARD.01.017.PK" tabindex=45>
    <option> </option>
    %PATWEB89.01.298.033.2
  </select>
</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.01.199.002" tabindex=46
   title="Contract Role"
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif"
   onClick="ContRoleAlert();">
</span>

<span id=blanklabel style="display:none">&nbsp;</span>
<script type="text/javascript">
  function init() {
    setHF();

    for (var i=0;i<document.UpdateForm.ptvis022.length;i++) {
      if (document.UpdateForm.ptvis022.options[i].value=="%PATWEB89.01.225.0") {
        document.UpdateForm.ptvis022.selectedIndex=i
      }
    };

    RelVisit="%PATWEB89.01.118.1"
    if(RelVisit=="Yes"){
      RelVisit="1"
    }
    if(RelVisit=="No "){
      RelVisit="0";
    }
    for (var i =0 ; i < document.UpdateForm.ptmis017.length; i++) {
      if (document.UpdateForm.ptmis017.options[i].value==RelVisit.substr(0,1)) {
        document.UpdateForm.ptmis017.selectedIndex=i 
      }
    };
  }

  CasePaym="%PATWEB89.01.197.1"
  if(CasePaym=="Yes"){
    CasePaym="1"
  }
  if(CasePaym=="No "){
    CasePaym="0";
  }
  for (var i =0 ; i < document.UpdateForm.ptmis075.length; i++) {
    if (document.UpdateForm.ptmis075.options[i].value==CasePaym.substr(0,1)) {
      document.UpdateForm.ptmis075.selectedIndex=i 
    }
  };

  MergePsy="%PATWEB89.01.050";
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1";
  }
  if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0";
  }

</script>

<span id=preexisthdr style="display:none">
 <b>PEA Indicator</b>
</span>
<span id=emeradmnhdr style="display:none">
 <b>Emergency Admission</b>
</span>
<span id=presillcodhdr style="display:none">
 <b>Presenting Illness Code</b>
</span>
<span id=presillnumhdr style="display:none">
 <b>Presenting Illness Number (MBS)</b>
</span>

<span id=swipresillhdr style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=preexistail style="display:none">
  <select name=ptelg014 title="PEA Indicator" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>
<span id=emeradmissn style="display:none">
  <select name=ptelg033 title="Emergency Admission" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>
<span id=presillcod style="display:none">
  <select name=ptvis111 title="Presenting Illness" class="OECRequired">
  <option value=" "></option>
   %PATWEB89.01.298.034.2
  </select>
</span>

<span id=swipresill style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
 <input type="checkbox" name="presilsw" value="1" title="Presenting Illness MBS"
       onclick="switchPresIll();"> &nbsp; &nbsp;
</span>

<span id=presillnum style="display:none">
    <input type=text name=ptmis026 size=10 maxlength=9
     onblur='validateCode(4,ptmis026,mbsdesc1)' class="OECRequired">
    <input type=text notab readonly name=mbsdesc1 size=35
     class="OECRequired">
    <img notab src="../images/SearchIcon.gif"
     onClick="MbsSearchFrame(ptmis026,mbsdesc1)">
        <img src="../images/erase.gif" align=absmiddle
         onClick="clrFields(ptmis026,mbsdesc1);">
</span>

<span id=oesservices style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td><b>Date</b></td>
      <td><b>Type</b></td>
                   <td><b>Item / Description</b></td>
                   <td><b>Quantity</b></td></tr>
  <tr><td width=20%>
     <input type=text size=12 name=oes01007
      class="FutureDate" title="OES Service 1 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
      align=absmiddle onClick="SetCurrentDateTime(oes01007,null);">
     <img notab src=../images/DateLookup.gif border=0 hspace=4
      align=absmiddle onclick="DateLookupFrame(oes01007);">
                   </td>
                   <td width=12%>
    <select name=oes01004 title="Type"
     onchange="clrFields(oes01005,d_oes01005);
               mandatoryItemCode(document.UpdateForm.oes01005,
               document.UpdateForm.oes01007,
               document.UpdateForm.oes01006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
    <input type=text name=oes01005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes01004,
                              document.UpdateForm.oes01005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes01005);
             mandatoryItemCode(this,document.UpdateForm.oes01007,
                                    document.UpdateForm.oes01006);
             document.UpdateForm.oes01006.value=1;
             justifyRight(document.UpdateForm.oes01006);">
    <input type=text name=d_oes01005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                  document.UpdateForm.oes01005,
                                  document.UpdateForm.d_oes01005);">
    <img src="../images/erase.gif" onClick="clrFields(oes01005,d_oes01005);
                            mandatoryItemCode(document.UpdateForm.oes01005,
                                              document.UpdateForm.oes01007,
                                              document.UpdateForm.oes01006);">
                   </td>
                   <td>
    <input type=text name=oes01006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes02007
      class="FutureDate" title="OES Service 2 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
      align=absmiddle onClick="SetCurrentDateTime(oes02007,null);">
     <img notab src=../images/DateLookup.gif border=0 hspace=4
      align=absmiddle onclick="DateLookupFrame(oes02007);">
                   </td>
                   <td width=12%>
    <select name=oes02004 title="Type"
     onchange="clrFields(oes02005,d_oes02005);
               mandatoryItemCode(document.UpdateForm.oes02005,
               document.UpdateForm.oes02007,
               document.UpdateForm.oes02006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
   <input type=text name=oes02005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes02004,
                              document.UpdateForm.oes02005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes02005);
             mandatoryItemCode(this,document.UpdateForm.oes02007,
                                    document.UpdateForm.oes02006);
             document.UpdateForm.oes02006.value=1;
             justifyRight(document.UpdateForm.oes02006);">
    <input type=text name=d_oes02005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                  document.UpdateForm.oes02005,
                                  document.UpdateForm.d_oes02005);">
    <img src="../images/erase.gif" onClick="clrFields(oes02005,d_oes02005);
                            mandatoryItemCode(document.UpdateForm.oes02005,
                                              document.UpdateForm.oes02007,
                                              document.UpdateForm.oes02006);">
                   </td>
                   <td>
    <input type=text name=oes02006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes03007
      class="FutureDate" title="OES Service 3 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
      align=absmiddle onClick="SetCurrentDateTime(oes03007,null);">
     <img notab src=../images/DateLookup.gif border=0 hspace=4
      align=absmiddle onclick="DateLookupFrame(oes03007);">
                   </td>
                   <td width=12%>
    <select name=oes03004 title="Type"
     onchange="clrFields(oes03005,d_oes03005);
               mandatoryItemCode(document.UpdateForm.oes03005,
               document.UpdateForm.oes03007,
               document.UpdateForm.oes03006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
    <input type=text name=oes03005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes03004,
                              document.UpdateForm.oes03005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes03005);
             mandatoryItemCode(this,document.UpdateForm.oes03007,
                                    document.UpdateForm.oes03006);
             document.UpdateForm.oes03006.value=1;
             justifyRight(document.UpdateForm.oes03006);">
     <input type=text name=d_oes03005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                  document.UpdateForm.oes03005,
                                  document.UpdateForm.d_oes03005);">
    <img src="../images/erase.gif" onClick="clrFields(oes03005,d_oes03005);
                            mandatoryItemCode(document.UpdateForm.oes03005,
                                              document.UpdateForm.oes03007,
                                              document.UpdateForm.oes03006);">

                   </td>
                   <td>
    <input type=text name=oes03006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes04007
      class="FutureDate" title="OES Service 4 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
      align=absmiddle onClick="SetCurrentDateTime(oes04007,null);">
     <img notab src=../images/DateLookup.gif border=0 hspace=4
      align=absmiddle onclick="DateLookupFrame(oes04007);">
                   </td>
                   <td width=12%>
    <select name=oes04004 title="Type"
     onchange="clrFields(oes04005,d_oes04005);
               mandatoryItemCode(document.UpdateForm.oes04005,
               document.UpdateForm.oes04007,
               document.UpdateForm.oes04006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
    <input type=text name=oes04005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes04004,
                              document.UpdateForm.oes04005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes04005);
             mandatoryItemCode(this,document.UpdateForm.oes04007,
                                    document.UpdateForm.oes04006);
             document.UpdateForm.oes04006.value=1;
             justifyRight(document.UpdateForm.oes04006);">
    <input type=text name=d_oes04005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                  document.UpdateForm.oes04005,
                                  document.UpdateForm.d_oes04005);">
    <img src="../images/erase.gif" onClick="clrFields(oes04005,d_oes04005);
                            mandatoryItemCode(document.UpdateForm.oes04005,
                                              document.UpdateForm.oes04007,
                                              document.UpdateForm.oes04006);">
                   </td>
                   <td>
    <input type=text name=oes04006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes05007
      class="FutureDate" title="OES Service 5 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
      align=absmiddle onClick="SetCurrentDateTime(oes05007,null);">
     <img notab src=../images/DateLookup.gif border=0 hspace=4
      align=absmiddle onclick="DateLookupFrame(oes05007);">
                   </td>
                   <td width=12%>
   <select name=oes05004 title="Type"
     onchange="clrFields(oes05005,d_oes05005);
               mandatoryItemCode(document.UpdateForm.oes05005,
               document.UpdateForm.oes05007,
               document.UpdateForm.oes05006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
    <input type=text name=oes05005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes05004,
                              document.UpdateForm.oes05005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes05005);
             mandatoryItemCode(this,document.UpdateForm.oes05007,
                                    document.UpdateForm.oes05006);
             document.UpdateForm.oes05006.value=1;
             justifyRight(document.UpdateForm.oes05006);">
    <input type=text name=d_oes05005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                  document.UpdateForm.oes05005,
                                  document.UpdateForm.d_oes05005);">
    <img src="../images/erase.gif" onClick="clrFields(oes05005,d_oes05005);
                            mandatoryItemCode(document.UpdateForm.oes05005,
                                              document.UpdateForm.oes05007,
                                              document.UpdateForm.oes05006);">
                   </td>
                   <td>
    <input type=text name=oes05006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
</table>
</span>
<span id=longline style="display:none"><hr></span>
