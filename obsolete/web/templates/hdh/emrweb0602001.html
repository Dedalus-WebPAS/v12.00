<meta name="TemplateVersion" content="V10.15.00">
<meta name="TemplateHome" content="hdh">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript" src=../js/EmergencyCodingTable.js> </script>
<script type="text/javascript">
function sortSelect(selElem) {
  var tmpAry = new Array();
  for (var i=0;i<selElem.options.length;i++) {
    tmpAry[i] = new Array();
    tmpAry[i][0] = selElem.options[i].text;
    tmpAry[i][1] = selElem.options[i].value;
  }

  tmpAry.sort();

  while (selElem.options.length > 0) {
    selElem.options[0] = null;
  }

  for (var i=0;i<tmpAry.length;i++) {
    var op = new Option(tmpAry[i][0], tmpAry[i][1]);
    selElem.options[i] = op;
  }
  return;
}
function getDiagnosis(SearchField,ReturnSelect) {
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=1" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         ReturnSelect.options[ReturnSelect.options.length]=
          new Option(SelectValue[1],SelectValue[0]+' '+SelectValue[1]); } } }
  sortSelect(ReturnSelect);

  if (ReturnSelect.options[0]!= null ) {
    document.Dummy.d_emvcd033.value=ReturnSelect.options[0].text;
  }
  else
  {
    document.Dummy.d_emvcd033.value="";
  }

//  freedesc=ReturnValue[0].split(",");
//  if (freedesc[1]!=undefined) {
//    document.Dummy.d_emvcd033.value=trim(freedesc[1]) + " ";
//  } else {
//    document.Dummy.d_emvcd033.value="";
//  }
}
function newDiagnosis() {
  if (isWhitespace(document.Dummy.diagselt.value)) {
      alert("No Diagnosis selected !");
      return;;
  }
//
  document.AddDiagnosis.emvcd005.value=Dummy.diagselt.value.substring(0,9)
//
  if (document.AddDiagnosis.emvcd005.value.substr(0,4)=="Z099") {
      alert("Please enter an additional diagnosis for this patient !");
  }
//  document.AddDiagnosis.submit();

  document.AddDiagnosis.emvcd033.value=document.Dummy.d_emvcd033.value;

  SubmitHidden(AddDiagnosis);
}
function addDetail() {
    Left=(document.body.clientWidth-600)/2
    DFrameLink("emrweb05.pbl?reportno=7&template=5",100,Left,600,300)
}
function addMult(linkurl) {
   location.href=linkurl;
}
function ShowDetail(urnumber,recordky,type) {
    if (type == "001") {
      Template="003";
    }
    else if (type == "002" ) {
      Template="005";
    } else if (type == "003") {
      Template="007";
    } else if (type == "004") {
      Template="009";
    } else if (type == "005") {
      Template="011";
    } else {
      alert("Incorrect Type to determine template number");
      return
    }
    linkURL="emrweb06.pbl?reportno=2&template=" + Template +
            "&urnumber=" + urnumber.replace(/ /g,"+") +
            "&recordky=" + recordky.replace(/ /g,"+");
    Left=(document.body.clientWidth-590)/2
    DFrameLink(linkURL,100,Left,590,410)
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);initTables();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB06.02.003";
PatientVIS="%EMRWEB06.02.081";
PatientNAM="%EMRWEB06.02.002";
PatientSTA="%EMRWEB06.02.086.078";
PatientALT="%EMRWEB06.02.084";
PatientSEX="%EMRWEB06.02.019";
PatientDOB="%EMRWEB06.02.020";
PatientAGE="%EMRWEB06.02.021";
PatientLOC="%EMRWEB06.02.083";
PatientPRI="%EMRWEB06.02.086.066.1";
PatientUNT="%EMRWEB06.02.066.0";
DoctorCOD="%EMRWEB06.02.082.003";
DoctorNAM="%EMRWEB06.02.082.002";
PatientAID="%EMRWEB06.02.086.090";
PatientIND="%EMRWEB06.02.086.091";
PatientCUR="%EMRWEB06.02.086.092";
PatientCLC="%EMRWEB06.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%EMRWEB06.02.086.094";
PatientCDM="%EMRWEB06.02.086.095";
PatientVDH="%EMRWEB06.02.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<table border=0 cellspacing=0 cellpadding=0 width=100%>
<form name=Dummy onsubmit='return false;'>
<tr><td class=HeadingCell width=20% align=left>Diagnosis Summary</td>
    <td class=HeadingCell align=right>  
    Search
    <input type=text onKeyUp='getDiagnosis(this,Dummy.diagselt);'
     class=SelectBig tabindex=1>
    </td>
    <td class=HeadingCell>
    <select name=diagselt class=SelectXlrg tabindex=2 
     onchange="document.Dummy.d_emvcd033.value=trim(this.value.substring(9,80))+' ';">
    </select>
    <input type=button class="button" value="Add"
     onclick='newDiagnosis();' tabindex=3>
    </td></tr>
<tr>
    <td class=HeadingCell width=20% align=left>
    Diagnosis Free Format Description</td>
    <td class=HeadingCell></td>
    <td class=HeadingCell>
      <input type=text maxlength=100 size=91 tabindex=3 name="d_emvcd033">
    </td>
</tr>
</form>
<!--
    <input type=button value=Add class="button"
      onClick="addDetail();">
    </td></tr>
-->
</table>
<div id="TableLocation5" >
</div>

<script type="text/javascript">
function initTables() {
  initTable5();
}
//
function init() {
PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if(top.content.location.search.substring(1,23)!="reportno=1&template=16"&&
     top.content.location.search.substring(1,23)!="reportno=1&template=17"){
    if (top.content.location.search!=this.location.search) {
      if (top.content.location.search!=PageLocation) {
      top.content.location.href="emrweb02.pbl" + PageLocation } }
  }
}
//
// Table 5
//
function initTable5() {
 TB5 = new Table("TB5",1,0,1,"100%","center",TableLocation5);  
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 TB5.addColumn("Type","String",0,0,"center","","")
 TB5.addColumn("Description","String",18,18,"left","MaintenanceIcon.gif","10")
 TB5.addColumn("Send in Extract","String",6,6,"center","","")
 TB5.addColumn("User","String",7,7,"left","","")
//
// Add Rows to Table (Output from Web Server)
//
%EMRWEB06.02.134.TB5.005  
//
//
 OrderColumn=0;
 AscDsc=2;
 lastOrderColumn=OrderColumn;
 TableOutput(TB5,OrderColumn,AscDsc);
}
</script>
<form name=AddDiagnosis method=post action=emrweb06.pbl>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="002">
<input type=hidden name=updatety value="A">
<input type=hidden name=nextpage value="7">
<input type=hidden name=redirect value="%EMRWEB06.02.001.emrweb06.02.001">     
<input type=hidden name=urnumber value="%EMRWEB06.02.003">
<input type=hidden name=admissno value="%EMRWEB06.02.081">
<input type=hidden name=emvcd001 value="%EMRWEB06.02.081">
<input type=hidden name=emvcd002 value="005">
<input type=hidden name=emvcd004 value="5">
<input type=hidden name=emuty001 value="EMRD">
<input type=hidden name=emvcd005 value="">
<input type=hidden name=emvcd006 value="   ">
<input type=hidden name=emvcd031 value="1">
<input type=hidden name=emvcd033 value="">
</form>


<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB06.02.003">
<input type=hidden name=admissno value="%EMRWEB06.02.081">
<input type=hidden name=MenuType value="%EMRWEB06.02.088">
</form>

