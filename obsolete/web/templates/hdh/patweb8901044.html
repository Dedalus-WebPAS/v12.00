<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="hdh">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript" src="../js/preadmission.js">   </script>
<script type="text/javascript">
function SubmitAdm() {
  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
     return; 
  }

  if (!isWhitespace(UpdateForm.ptmis013.value)) {
     if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                         UpdateForm.funddesc,UpdateForm.tabldesc)) {
        ans=confirm("Select another active health fund table? ");
        if (ans==true) {
           return;
        } 
     } 
  }

  if (MandatoryOk) {
    UpdHealthFund();
    setRedirect();
    validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis068,
                             UpdateForm.ptmis076,UpdateForm.bedrqqry);
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    UpdateForm.ptmis009.disabled=false;
    UpdateForm.OKButton.disabled=true;
    SubmitHidden(UpdateForm);
    setTimeout('UpdateForm.OKButton.disabled=false',6000);
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
}
function DisplaySel() {
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if (top.content.location.href!=this.location.href) {
    top.content.location.href="emrweb02.pbl" + PageLocation }
for(var i=0;i<UpdateForm.ptmis009.length;i++) {
   if(trim(UpdateForm.ptmis009.options[i].value.substr(3,1))=="4"){
           UpdateForm.ptmis009.selectedIndex=i;
          }
   }
   for(var i=0;i<UpdateForm.ptmis010.length;i++) {
   if(trim(UpdateForm.ptmis010.options[i].value.substr(18,1))=="1"){
           UpdateForm.ptmis010.selectedIndex=i;
          }
   }
   for(var i=0;i<UpdateForm.ptmis012.length;i++) {
   if(trim(UpdateForm.ptmis012.options[i].value.substr(18,1))=="1"){
           UpdateForm.ptmis012.selectedIndex=i;
          }
   }
      for (var i =0 ; i < document.UpdateForm.ptmis011.length; i++) {
      if (document.UpdateForm.ptmis011.options[i].value.substr(18,1)=="1") {
         document.UpdateForm.ptmis011.selectedIndex=i 
         break;} };
   AdmitMandatory();
   for(var i=0;i<UpdateForm.ptmis068.length;i++) {
      if(UpdateForm.ptmis068.options[i].value==UpdateForm.exptward.value) {
           UpdateForm.ptmis068.selectedIndex=i;
          }
     }
  if(document.UpdateForm.emvistat.value!="2" &&
    document.UpdateForm.emvistat.value!="3") {
    return;
  }
  document.UpdateForm.ptmis001.value=document.UpdateForm.emvidate.value
  document.UpdateForm.ptmis002.value=document.UpdateForm.emvitime.value
  document.UpdateForm.ptmis020.value=document.UpdateForm.emvidiag.value
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
   UpdateForm.ptmis011.className="Mandatory";  //admission type
   UpdateForm.ptmis009.className="Mandatory";  //admission source
   UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
   UpdateForm.ptmis012.className="Mandatory";  //care type
   UpdateForm.ptmis068.className="Mandatory";  //ward
   UpdateForm.ptmis005.className="mandatory";  //bed
   UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
   UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
   UpdateForm.ptmis027.className="Mandatory";  //Financial Class
   UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
   UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
 } else {
   document.UpdateForm.admitbox.value="0";
   UpdateForm.ptmis011.className="";  //admission type
   UpdateForm.ptmis009.className="";  //admission source
   UpdateForm.ptvis041.className="";  //criteria for admission
   UpdateForm.ptmis012.className="";  //care type
   UpdateForm.ptmis068.className="";  //ward
   UpdateForm.ptmis005.className="";  //bed
   UpdateForm.ptmis007.className="";  //Admitting Doctor
   UpdateForm.doctnam2.className="";  //Admitting Doctor description
   UpdateForm.ptmis027.className="";  //Financial Class
   UpdateForm.ptmis010.className="";  //CMBS Class
   UpdateForm.ptvis043.className="";  //Intended Stay
 }
} 
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplaySel();document.UpdateForm.ptmis001.focus();
              valClaimCode();valDoctorUnit();setPST()">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >
<form name=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
</form>
<form name=UpdateForm method=post action=patweb89.pbl>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=emadmiss value="%PATWEB89.01.081">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value="001">
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="redirect">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="admitnow" value="1">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type=hidden name=ptmas046 value="0">
<input type="hidden" name="mvmedrec">
<input type="hidden" name="cfinan" value="%PATWEB89.01.932">
<input type=hidden name=exptward value="%PATWEB89.01.917">
<input type=hidden name=claimc value="">
<input type="hidden" name="exstward" value="%PATWEB89.01.449.1">
<input type=hidden name=emvistat value="%PATWEB89.01.447">
<input type=hidden name=emvidate value="%PATWEB89.01.401.0">
<input type=hidden name=emvitime value="%PATWEB89.01.402">
<input type=hidden name=emvidiag value="%PATWEB89.01.487">
<input type=hidden name=updhfund value="">
<input type=hidden name=pmihfund value="%PATWEB89.01.040.0">
<input type=hidden name=pmihftab value="%PATWEB89.01.041.0">
<input type=hidden name=pmihndmm value="%PATWEB89.01.042">
<input type=hidden name=ptcnpmhf id="ptcnpmhf"
     value="%STANDARD.01.025.124.157.0.1">
<input type=hidden name=bedrqqry value="">
<tr><td class=HeadingCell align=center>
    Patient Admission Details  </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr><td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" value="0" notab
           onclick='AdmitMandatory()';>
        </td></tr>
     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 tabindex=1 
             class="Mandatory Date" title="Admission Date" 
             value="%PATWEB89.01.935">
         <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis001);">     
          Time 
        <input class=Mandatory type=text name=ptmis002 size=8 tabindex=2
          value="%PATWEB89.01.936" title="Admission Time">
        <img notab src=../images/DateTimeStamp.gif border=0 hspace=4 
         align=absmiddle onClick="SetCurrentDateTime(null,ptmis002);">
        <img notab src=../images/TimeLookup.gif border=0 hspace=4
         align=absmiddle onclick="TimeLookupFrame(ptmis002);">
          </td>
       <td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1>
           <input type=hidden name=ptmis004>
           <input type=hidden name=ptmis005 title="Bed">
           <input type=hidden name=warddesc>
           <select name=ptmis068 tabindex=9 title="Ward">
            <option> </option>
            %PATWEB89.01.449.2
           </select>
           <input type=text name=ptmis076 readonly maxlength=3 size=3
                  title="Bed">
           <img notab src=../images/SearchIcon.gif border=0 vspace=1
            onClick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td></tr>

      <tr><td class=DataLabel>Admission Criteria</td>
          <td>
          <select name=ptvis041 tabindex=3 title="Criteria for Admission">
          <option> </option>
          %PATWEB89.01.244.2
          </select>
          </td>
          <td class=DataLabel>Attending Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=10
              title="Attending Doctor" value="%PATWEB89.01.916.003"
              onblur="UpCase(this);valDoctorUnit();">
              <input type=text readonly size=25 notab name=doctnam2
               title="Admitting Doctor" value="%PATWEB89.01.916.002">
              <img notab src="../images/SearchIcon.gif"
             onClick="DoctorSearchFrame(ptmis007,doctnam2)">
          </td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=4
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>
              <td class=DataLabel>Referring Doctor</td>
         <td><input type="text" size=10 maxlength=10 name="ptvis028" tabindex=11
               value="%PATWEB89.01.231.1"
               onblur="ValidateHCP(18,0,ptvis028,doctnam1);">
              <input type="text" size=25 name="doctnam1"
               value="%PATWEB89.01.231.0">
              <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
               </td></tr>

      <tr><td class=DataLabel>Admission Source</td>
          <td><select name=ptmis009 tabindex=5
               onchange="DisplayTrnSrc()" title="Admission Source">
               <option> </option>
               %PATWEB89.01.110.2
               </select></td>
          <td class=DataLabel>Admission Diagnosis </td>
          <td><input tabindex=12 type=text name="ptmis020" size=50 maxlength=80>
          </td></tr>

      <tr><td>
          <div id=TranSrcHeading></div>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>&nbsp;</td>
          <td class=DataLabel>&nbsp;</td>
          <td>&nbsp;</td>

      <tr><td class=DataLabel> Intended Length of Stay </td>
          <td class=DataLabel>
             <select name=ptvis043 tabindex=6 title="Intended Length of Stay">
             <option> </option>
              %PATWEB89.01.246.2
             </select>
        </td>
        <td class=DataLabel>Unplanned Theatre Visit</td>
        <td><select name=ptvis079 tabindex=13
            title="Unplanned Theatre Visit">
          <option> </option>
           %PATWEB89.01.295.2
          </select></td>
        </tr>

    <tr><td class=DataLabel>%STANDARD.01.017.KM</td>
        <td><select name=ptvis094 tabindex=7>
             <option></option>
             %PATWEB89.01.298.016.2
             </select></td>
        <td class=DataLabel>Usual Accommodation - Psych Only</td>
        <td><select name=ptvis095 tabindex=14
             title="Usual Accommodation - Psych Only">
             <option></option>
             %PATWEB89.01.298.017.2
             </select></td>
        </tr>

    <tr><td class=DataLabel>Discharge Intention on Admission</td>
        <td><select name=ptvis076 tabindex=8
             title="Discharge Intention on Admission">
            <option> </option>
             %PATWEB89.01.292.2
            </select></td>
        <td class=DataLabel>Unplanned Readmission</td>
        <td><select name=ptvis078 tabindex=14
             title="Unplanned Readmission">
            <option> </option>
             %PATWEB89.01.294.2
            </select></td>
        </tr>

  <tr><td>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099
         title="Program" tabindex=8 value="%PATWEB89.01.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=8
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.01.298.021.2
          </select></td>
      <td class=DataLabel>%STANDARD.01.017.LS</td>
      <td><select name=ptvis074 tabindex=14>
          <option></option>
          %PATWEB89.01.289.4
          </select>
      </td>
      </tr>


   <tr><td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=8>
          <option value="2">NO</option>
          <option value="1">YES</option>
         </select>
       </td>
       <td class=DataLabel> Planned Length of Stay</td>
       <td>
       <input type=text size=5 maxlength=5 name=ptmis030
        tabindex=10 title='Planned Length of Stay'
        class=Integer onblur="checkInteger(this,this.value);">
       </td>
       </tr>

     <tr align=left>
     <td align=center colspan="4">
     <hr>
     </td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td><select name=ptmis027 title="%STANDARD.01.017.CL"
            tabindex=15>
            <option> </option>
             %PATWEB89.01.915.2
           </select>
      </td>
    <td class=DataLabel>Health Fund</td>
        <input type="hidden" name="ptmis013" value="%PATWEB89.01.040.0">
    <td class=DataLabel colspan=2>
        <input type=text size=25 name="funddesc" maxlength="30"
         value="%PATWEB89.01.040.1" readonly>
         Level
        <input type="hidden" name="ptmis014" value="%PATWEB89.01.041.0">
        <input type="text" size=20 maxlength=30 name="tabldesc"
         value="%PATWEB89.01.041.1" readonly>
        <img src=../images/SearchIcon.gif border=0 hspace=0 align=absmiddle
         onClick="HealthFundSearchFrameNoFocus(ptmis013,funddesc,
                                               ptmis014,tabldesc);">
        <img src="../images/erase.gif" align=absmiddle
         onClick="clrFields(ptmis013,funddesc,ptmis014,tabldesc);">
    </td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 tabindex=16 onChange="setPST()"
               title="%STANDARD.01.017.A ">
              <option> </option>
                 %PATWEB89.01.111.2
              </select></td>
      <td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015 tabindex=21
       value="%PATWEB89.01.042">
      </td></tr>

<tr id="PST" style="display:none">
  <td>%STANDARD.01.035.YE</td>
  <td>
    <select class=Mandatory name="ptvis134" title="%STANDARD.01.035.YE">
      <option></option>
        %PATWEB89.01.298.060.2
    </select>
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>

     <tr><td class=DataLabel>Service Category</td>
          <td><select name=ptmis012 tabindex=17 title="Service Category">
              <option> </option>
               %PATWEB89.01.113.2
              </select></td>
         <td>No of days of hospitalisation</td>
         <td align=left>
           <input type=text name=ptmis031 title='No of days of hospitalisation'
            class=Integer size=5 maxlength=3 tabindex=22
            onblur=checkInteger(this,this.title)>
         </td></tr>

  <tr><td class=DataLabel>Casepayment Y/N</td>
      <td>
        <select name=ptmis075 tabindex=18>
        <option value="0">NO</option>
        <option value="1">YES</option>
        </select></td>
      <td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 tabindex=23>
          <option> </option>
           %PATWEB89.01.189.2
          </select>
        </td>
       </tr>

  <tr><td class=DataLabel>Casemix Code</td>
          <td class=DataLabel>
       <input type=text name=ptmis073 size=10 maxlength=9 tabindex=19 value=""
          onblur='validateCode(35,ptmis073,cmixdesc1)'>
          <input type=text notab readonly name=cmixdesc1 size=35 value="">
              <img notab src="../images/SearchIcon.gif"
               onClick="CmixSearchFrame(ptmis073,cmixdesc1)">
          </td>
      <td class=DataLabel>Palliative Care Status</td>
      <td><select name=ptvis077 tabindex=24 title="Palliative Care Status">
          <option> </option>
           %PATWEB89.01.293.2
          </select>
        </td>
      </tr>

<tr><td class=DataLabel> Admission Comments </td>
<td colspan=6 align=left>
<textarea wrap=hard name=adcommnt rows=2 cols=70 tabindex=24>
</textarea></td></tr>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=54 type=button value="Ok" class=button name=OKButton
        onClick="checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
       <input tabindex=55 type=button value="Cancel" class=button
             onclick='fnPatientLink("%PATWEB89.01.003","%PATWEB89.01.081");'>
     </form>
    </table>
</td></tr>
</table>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=19 
         title="Referral Date">
         <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 tabindex=20 
         title="Consultation Date">
         <img notab src=../images/DateLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6
         onChange=justifyRight(this);>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>


<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=5
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif"
      onClick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>




<script type="text/javascript">
MergePsy="%PATWEB89.01.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }
 if ("%PATWEB89.01.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.01.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
 if(!isWhitespace(document.UpdateForm.ptmis001.value)) {
    Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
    Dat=document.UpdateForm.ptmis001.value.substr(2)
    document.UpdateForm.ptmis001.value=Day + Dat
 }
</script>
