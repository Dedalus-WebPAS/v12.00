<meta name="TemplateVersion" content="V11.03.00">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript">
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;

     if (UpdateForm.ptmis026.className=="Mandatory") {
       UpdateForm.ptmis026.className="OECRequired Mandatory";
       UpdateForm.mbsdesc1.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis026.className="OECRequired";  //Claim Type
       UpdateForm.mbsdesc1.className="OECRequired";  //Claim Type
     }

  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;

     if (UpdateForm.ptmis026.className=="OECRequired Mandatory") {
       UpdateForm.ptmis026.className="Mandatory";  //Claim Type
       UpdateForm.mbsdesc1.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis026.className="";  //Claim Type
       UpdateForm.mbsdesc1.className="";  //Claim Type
     }
  }

}
function chkDOS(datefield) {
  if(!isWhitespace(datefield.value)){
    if(!ChkDateTime(UpdateForm.ptmis001,null,datefield,null)){
      alert(datefield.title+" cannot be before Admission Date");
      return false;
    }
  }
  return true;
}
function mandatoryItemCode(ItemCode,DateofService,ServiceQuantity) {

  if(!isWhitespace(ItemCode.value)) {
    DateofService.className="Mandatory FutureDate";
    ServiceQuantity.className="Mandatory Integer";
  } else {
    DateofService.className="FutureDate";
    ServiceQuantity.className="Integer";
  }

}
function ItemCodeSearchFrame(ItemType,ItemCode,ItemDescription) {

  if (ItemType.value=="6") {
    MiscChargeSearchFrame(ItemCode,ItemDescription);
  }

  if (ItemType.value=="3") {
    MbsSearchFrame(ItemCode,ItemDescription);
  }

}
function validateItemCode(ItemType,ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription) {

  if (ItemType.value=="6") {
    validateMsc1(ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription);
  }

    if (ItemType.value=="3") {
    validateCode(4,ItemCode,ItemDescription);
  }

}
function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) {
         return false } }
    }

    if (isWhitespace(document.UpdateForm.patsurnm.value)) {
      alertOEC(document.UpdateForm.patsurnm);
      return false;
    }

    if (isWhitespace(document.UpdateForm.patgivnm.value)) {
      alertOEC(document.UpdateForm.patgivnm);
      return false;
    }

    if (isWhitespace(document.UpdateForm.patntdob.value)) {
      alertOEC(document.UpdateForm.patntdob);
      return false;
    }


  return true;
}
function alertOEC(OECpmifield) {
  alert("Online Eligibility Details Incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}
function checkOECString (theField, s, emptyOK) {
if (checkOECString.arguments.length == 2) emptyOK = false;
 if ((emptyOK == true) && (isEmpty(theField.value))) return true;
 if (isWhitespace(theField.value))
   return warnOECEmpty (theField, s);
 else return true;
}
function warnOECEmpty (theField, s) {
 alert("Online Eligibility Details Incomplete. Request Not Processed.\n"
       + s + " is a required OEC field.\nPlease enter it now." )
 theField.focus()
 return false
}
function OECRequired() {
 if(document.UpdateForm.oecchbox.checked == true) {

     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="Mandatory") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="Mandatory") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";
     } else {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="Mandatory") {
       UpdateForm.funddesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.funddesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.tabldesc.className=="Mandatory") {
       UpdateForm.tabldesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.tabldesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.ptmis013.className=="Mandatory") {
       UpdateForm.ptmis013.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis013.className="OECRequired";  //Health Fund Code
     } 
     
     if (UpdateForm.ptmis014.className=="Mandatory") {
       UpdateForm.ptmis014.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis014.className="OECRequired";  //Health Fund Code
     } 

     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber

  } else {

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="Mandatory";  //Diagnosis
     } else {
       UpdateForm.ptmis020.className="";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
       UpdateForm.funddesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.funddesc.className="";  //Health Fund
     }

     if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
       UpdateForm.tabldesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.tabldesc.className="";  //Health Fund
     }

     if (UpdateForm.ptmis013.className=="OECRequired Mandatory") {
       UpdateForm.ptmis013.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis013.className="";  //Health Fund
     }

     if (UpdateForm.ptmis014.className=="OECRequired Mandatory") {
       UpdateForm.ptmis014.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis014.className="";  //Health Fund
     }

     UpdateForm.ptmis030.className="Integer";    //Planned Length of Stay
     UpdateForm.ptvis076.className="";           //Discharge Inten
     UpdateForm.ptmis015.className="";           //Member Number
  }
}
function ShowOECFields() {
  if(document.UpdateForm.oecchbox.checked == true) {
    PreExistAilHdr.innerHTML=preexisthdr.innerHTML;
    PreExistAilmnt.innerHTML=preexistail.innerHTML;
    EmerAdmHdr.innerHTML=emeradmnhdr.innerHTML;
    EmerAdmssn.innerHTML=emeradmissn.innerHTML;
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
//    SwiPresIllHdr.innerHTML=swipresillhdr.innerHTML;
    SwiPresIll.innerHTML=swipresill.innerHTML;
    LongLine.innerHTML=longline.innerHTML;
    OESServices.innerHTML=oesservices.innerHTML;
  } else {
    PreExistAilHdr.innerHTML=blanklabel.innerHTML;
    PreExistAilmnt.innerHTML=blanklabel.innerHTML;
    EmerAdmHdr.innerHTML=blanklabel.innerHTML;
    EmerAdmssn.innerHTML=blanklabel.innerHTML;
    PresIllCodHdr.innerHTML=blanklabel.innerHTML;
    PresIllCod.innerHTML=blanklabel.innerHTML;
//    SwiPresIllHdr.innerHTML=blanklabel.innerHTML;
    SwiPresIll.innerHTML=blanklabel.innerHTML;
    LongLine.innerHTML=blanklabel.innerHTML;
    OESServices.innerHTML=blanklabel.innerHTML;
  }
}
function checkBedStatus(wardcode,beddcode) {
  admissno=PatientLinks.admissno.value.replace(/ /g,"+")
//  if (isWhitespace(wardcode)) return;;
  ReturnFunction="" ;
  var admisdte="";
  var staydays="0";
  var admistme="";
  var ptrgm001="";
  var ptrgm002="";
  var ptrgm003="";
  for (var i=2; i < checkBedStatus.arguments.length; i++) {
   if (typeof(checkBedStatus.arguments[i]) == 'function') {
     ReturnFunction=checkBedStatus.arguments[i] } }

  // Receive optional parameters
  if (checkBedStatus.arguments.length >= 9) {
    admisdte=checkBedStatus.arguments[2].replace(/ /g,"+");
    staydays=checkBedStatus.arguments[3].replace(/ /g,"+");
    admistme=checkBedStatus.arguments[4].replace(/ /g,"+");
    ptrgm001=checkBedStatus.arguments[5].replace(/ /g,"+");
    ptrgm002=checkBedStatus.arguments[6].replace(/ /g,"+");
    ptrgm003=checkBedStatus.arguments[7].replace(/ /g,"+");
    prnxindi="0";
  }
  var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=1" +
                  "&wardcode="+wardcode.replace(/ /g,"+") +
                  "&beddcode="+beddcode.replace(/ /g,"+") +
                  "&admissno="+admissno.replace(/ /g,"+") +
                  "&admisdte="+admisdte.replace(/ /g,"+") +
                  "&admistme="+admistme.replace(/ /g,"+") +
                  "&staydays="+staydays.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {

    if (isWhitespace(document.UpdateForm.ptmis068.value)) {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
        return;
      }
    }

    if (isWhitespace(document.UpdateForm.ptmis076.value)) {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
        return;
      }
    }

    if (UpdateForm.pswdindc.value==0) {
      var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                      "&wardcode="+wardcode.replace(/ /g,"+") +
                      "&beddcode="+beddcode.replace(/ /g,"+") +
                      "&admissno="+admissno.replace(/ /g,"+") +
                      "&admisdte="+admisdte.replace(/ /g,"+") +
                      "&staydays="+staydays.replace(/ /g,"+") +
                      "&admistme="+admistme.replace(/ /g,"+") +
                      "&ptrgm001="+ptrgm001.replace(/ /g,"+") +
                      "&ptrgm002="+ptrgm002.replace(/ /g,"+") +
                      "&ptrgm003="+ptrgm003.replace(/ /g,"+") +
                      "&prnxindi="+prnxindi.replace(/ /g,"+")
      var returnValue = RSExecute(serverURL);
      if (returnValue.status==0) {
        if (returnValue.return_value==1) {
          if (!confirm("Warning: Pre-Adm/Admission will override a previous bed managment record.")) {
            return;
          }
        }
        prevretval=returnValue.return_value;
        prnxindi="1";
        var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                        "&wardcode="+wardcode.replace(/ /g,"+") +
                        "&beddcode="+beddcode.replace(/ /g,"+") +
                        "&admissno="+admissno.replace(/ /g,"+") +
                        "&admisdte="+admisdte.replace(/ /g,"+") +
                        "&staydays="+staydays.replace(/ /g,"+") +
                        "&admistme="+admistme.replace(/ /g,"+") +
                        "&ptrgm001="+ptrgm001.replace(/ /g,"+") +
                        "&ptrgm002="+ptrgm002.replace(/ /g,"+") +
                        "&ptrgm003="+ptrgm003.replace(/ /g,"+") +
                        "&prnxindi="+prnxindi.replace(/ /g,"+")
        var returnValue = RSExecute(serverURL);
        if (returnValue.status==0) {
          if (returnValue.return_value==1) {
            if (!confirm("Warning: Pre-Adm/Adm will override a following bed managment record.")) {
              return;
            }
          }

          if (prevretval==1 || returnValue.return_value==1) {
            UpdateForm.pswdindc.value="1";
            PasswordHead.innerHTML=passwordhd.innerHTML;
            PasswordCode.innerHTML=passwordcd.innerHTML;
            UserNameHead.innerHTML=usernamehd.innerHTML;
            UserNameCode.innerHTML=usernamcd.innerHTML;
            return;
          }
          if (typeof(ReturnFunction) == 'function') {
            ReturnFunction()
          }
        }
      }
    } else {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
      }
    }
  }
}
function SubmitAdm() {

   if (!CheckDateTimeRangeCAB(document.UpdateForm.emvidate,
                           document.UpdateForm.emvitime,
                           document.UpdateForm.ptmis001,
                           document.UpdateForm.ptmis002)) {
     alert("Admission Date and Time is prior to the Emergency Visit Attendance of "
         +  document.UpdateForm.emvidate.value + " and "
         +  document.UpdateForm.emvitime.value
         +  ". Please amend the admission date and time.");
      return;
   }

  if (!validateDepDateTime()) {return;}

  // Check if PMI 'Foundation' (PUYN2) value has been set; warn if not
  if (document.UpdateForm.alrtsind.value.substr(10,1) == '0') {
    alert("Mandatory PMI field - Foundation is missing.");
    return;
  }

  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
     return; 
  }

  if (document.UpdateForm.oecchbox.checked==true) {
    if (!validateOECRequired(document.UpdateForm)) {
       return;
    }
    if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
       return;
    }
  }

  if (!isWhitespace(UpdateForm.ptmis013.value)) {
     if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                         UpdateForm.funddesc,UpdateForm.tabldesc)) {
        ans=confirm("Select another active health fund table? ");
        if (ans==true) {
           return;
        } 
     } 
  }

  if (UpdateForm.oes01007!=undefined) {

    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }
  }

  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }

  if(document.UpdateForm.oecchbox.checked == true) {
     document.UpdateForm.ptvis109.value="1";
  }


  if (MandatoryOk) {
    setRedirect();
    validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis068,
                             UpdateForm.ptmis076,UpdateForm.bedrqqry);
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    UpdateForm.ptmis009.disabled=false;
    UpdateForm.OKButton.disabled=true;
    SubmitHidden(UpdateForm);
    setTimeout('UpdateForm.OKButton.disabled=false',6000);
   }
}

function CheckDateTimeRangeCAB(FromDate,FromTime,ToDate,ToTime) {
 FromDate=SetDateYYYYMMDD(FromDate.value);
 fyyyy = FromDate.substr(0,4);
 fmm = FromDate.substr(4,2);
 fdd = FromDate.substr(6,2);
 fhh = FromTime.value.substr(0,2);
 fmi = FromTime.value.substr(3,2);
 fse = FromTime.value.substr(6,2);
 from_date_time=new Date(fyyyy,parseInt(fmm,10)-1,fdd,fhh,fmi,fse);
//
 ToDate=SetDateYYYYMMDD(ToDate.value);
 tyyyy = ToDate.substr(0,4);
 tmm = ToDate.substr(4,2);
 tdd = ToDate.substr(6,2);
 thh = ToTime.value.substr(0,2);
 tmi = ToTime.value.substr(3,2);
 tse = ToTime.value.substr(6,2);
 to_date_time=new Date(tyyyy,parseInt(tmm,10)-1,tdd,thh,tmi,tse);
//
  if (from_date_time > to_date_time) {
    return false ;
  }
  if (trim(from_date_time) == trim(to_date_time)) {
    return false ;
  }
  return true;
}

function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
  UpdateForm.ptmis024.selectedIndex=1
}
function DisplaySel() {
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if (top.content.location.href!=this.location.href) {
    top.content.location.href="emrweb02.pbl" + PageLocation }
for(var i=0;i<UpdateForm.ptmis009.length;i++) {
   if(trim(UpdateForm.ptmis009.options[i].value.substr(13,1))=="E"){
           UpdateForm.ptmis009.selectedIndex=i;
          }
   }
      for (var i =0 ; i < document.UpdateForm.ptmis011.length; i++) {
      if (document.UpdateForm.ptmis011.options[i].value.substr(13,1)=="E") {
         document.UpdateForm.ptmis011.selectedIndex=i 
         break;} };
   AdmitMandatory();
   for(var i=0;i<UpdateForm.ptmis068.length;i++) {
      if(UpdateForm.ptmis068.options[i].value==UpdateForm.exptward.value) {
           UpdateForm.ptmis068.selectedIndex=i;
          }
     }
}
function AdmitMandatory() {
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
//     UpdateForm.ptvis022.className="Mandatory";  //Inform GP
  } 
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
function defaultDateTime() {
  if (!isWhitespace(document.UpdateForm.emviddat.value)) {
    document.UpdateForm.ptmis001.value = document.UpdateForm.emviddat.value; 
    document.UpdateForm.ptmis002.value = document.UpdateForm.emvidtim.value; 
  }
}
function validateDepDateTime() {

  if (!isWhitespace(document.UpdateForm.emviddat.value) &&
      !isWhitespace(document.UpdateForm.emvidtim.value)) {
    if(CheckDateTimeRange(document.UpdateForm.emviddat,
                          document.UpdateForm.emvidtim,
                          document.UpdateForm.ptmis001,
                          document.UpdateForm.ptmis002)) {
      return true;
    } else {
      alert("IP Admit Date and Time entered is invalid and must be greater " +
            "than or equal to the Discharge Date and Time.");
      return false;
    }
  } else {
    return true;
  }
}
function DateEdits() {
  if (!checkDate(document.UpdateForm.ptmis001,
                 document.UpdateForm.ptmis001.title)) {
    return;
  }

  validateMbsCode(4,
                  document.UpdateForm.ptmis026,
                  document.UpdateForm.mbsdesc1,
                  document.UpdateForm.ptmis001);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplaySel();document.UpdateForm.ptmis001.focus();
      setHF();valClaimCode();valDoctorUnit();displayRegime();
      defaultDateTime();ShowActiveProgramID();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm method=post action=patweb89.pbl style="margin:0">
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=emadmiss value="%PATWEB89.01.081">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value="001">
<input type=hidden name=updatety value="1">
<input type=hidden name=redirect>
<input type=hidden name=allocate value="1">
<input type=hidden name=chckname value="0">
<input type=hidden name=emradmit value="0">
<input type=hidden name=emradmis value="0">
<input type=hidden name=admitnow value="1">
<input type=hidden name=newbmand value="0">
<input type=hidden name=agebmand value="0">
<input type=hidden name=ptmas046 value="0">
<input type=hidden name=mvmedrec>
<input type=hidden name=cfinan value="%PATWEB89.01.932">
<input type=hidden name=admitbox value="1">
<input type=hidden name=exptward value="%PATWEB89.01.917">
<input type=hidden name=claimc value="">
<input type=hidden name=exstward value="%PATWEB89.01.449.1">
<input type=hidden name=emvidate value="%PATWEB89.01.401.0">
<input type=hidden name=emvitime value="%PATWEB89.01.402">
<input type=hidden name=dummy id=dummy>
<input type=hidden name=bdmnindc value="1">
<input type=hidden name=pswdindc value="0">
<input type=hidden name=ptvis109>
<input type=hidden name=patsurnm
       title="Patient Surname" value="%PATWEB89.01.009">
<input type=hidden name=patgivnm
       title="Patient Given Name" value="%PATWEB89.01.010">
<input type=hidden name=patntdob 
       title="Patient Date of Birth" value="%PATWEB89.01.020">
<input type=hidden name=medicrdn 
       title="Medicare Card Number" value="%PATWEB89.01.027">
<input type=hidden name=medicrdr 
       title="Medicare Card Reference Number" value="%PATWEB89.01.649">
<input type=hidden name=ipadmdat value="1">
<input type=hidden name=alrtsind id=alrtsind value="%PATWEB89.01.084">
<input type=hidden name=psex value="%PATWEB89.01.086.082">
<input type=hidden name=page value="%PATWEB89.01.938">
<input type=hidden name=bedrqqry value="">
<input type=hidden name=emviddat id=emviddat  value="%PATWEB89.01.424.0">
<input type=hidden name=emvidtim id=emvidtim  value="%PATWEB89.01.425">
<input type=hidden name=automvmr id=automvmr value="">
<input type=hidden name=atmrtoaw id=atmrtoaw value="1">

<input type=hidden name=ptcndigp id=ptcndigp
 value="%STANDARD.01.025.124.122.0.1">
<input type=hidden name=ptcndumh id=ptcndumh
 value="%STANDARD.01.025.124.240.0.1">

<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >
<tr><td class=HeadingCell align=center>
    Patient Admission Details  </td>
</tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>

     <tr><td>&nbsp;</td><td>&nbsp;</td>
         <td align=left></td>
        <td align=left>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <b>Patient OEC Consent</b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="checkbox" name="oecchbox" value="0" notab
           onclick='ShowOECFields();OECRequired();'>
        </td></tr>

     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 id=ptmis001 tabindex=1 
               class="Mandatory Date" title="Admission Date" 
               value="%PATWEB89.01.935"
               onblur="DateEdits();">
         <img notab src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(UpdateForm.ptmis001);">     
          Time 
         <input class=Mandatory type=text name=ptmis002 id=ptmis002 size=8 
          tabindex=2 value="%PATWEB89.01.936" title="Admission Time">
        <img notab src=../images/DateTimeStamp.gif class="Icon"
         onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);">
       <img notab src=../images/TimeLookup.gif class="Icon"
        onclick="TimeLookupFrame(UpdateForm.ptmis002);">
          </td>

       <td>Admitting Point</td>
       <td>
         <select name=ptvis046 tabindex=12
           title="Admitting Point" 
           onchange="defaultWard()">
           <option></option>
            %PATWEB89.01.290.2
         </select>
      </td>
      </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=ptmis004>
           <input type=hidden name=ptmis005 title="Bed">
           <input type=hidden name=warddesc id=warddesc>
           <select name=ptmis068 id=ptmis068 tabindex=13 title="Ward" 
            class=Mandatory>
            <option> </option>
            %PATWEB89.01.449.2
           </select>
           <input type=text name=ptmis076 id=ptmis076 readonly maxlength=3 
            size=3 title="Bed">
           <img notab src="../images/SearchIcon.gif" class=Icon
            onclick="WardBedSearchFrame(UpdateForm.ptmis068,
                     UpdateForm.warddesc,UpdateForm.ptmis076,
                     UpdateForm.bedstat1);">
          </td></tr>
          <tr><td class=DataLabel>Admission Source</td>
          <td><select name=ptmis009 tabindex=4 
               onchange="DisplayTrnSrc()" title="Admission Source">
               <option> </option>
               %PATWEB89.01.110.2
               </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name=ptmis007 id=ptmis007
               tabindex=13 title="Admitting Doctor" value="%PATWEB89.01.916.003"
              onblur="UpCase(this);valDoctorUnit();">
              <input type=text readonly size=25 notab name=doctnam2 id=doctnam2
               title="Admitting Doctor" value="%PATWEB89.01.916.002">
              <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DoctorSearchFrame(UpdateForm.ptmis007,
                      UpdateForm.doctnam2);">
          </td></tr>
          <tr><td>
          <div id=TranSrcHeading></div>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Unit</td>
          <td><select name=ptmis024 tabindex=14
               title="Unit">
              <option> </option>
                 %PATWEB89.01.914.2
              </select>    
          </td></tr>
         <tr><td align=left>Prior Days Hospitalisation</td>
         <td align=left>
           <input type=text name=ptmis031 title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=3 tabindex=6
            onblur="checkInteger(this,this.title);">
         </td>
          <td class=DataLabel>Diagnosis </td>
          <td><input tabindex=15 type=text name="ptmis020" size=50 maxlength=80>
          </td></tr>

     <tr><td class=DataLabel>Mode of Arrival</td>
         <td>
           <select name=ptvis054 tabindex=7>
             <option></option> %PATWEB89.01.257.2
           </select>
         </td>
         <td class=DataLabel>Provisional DRG</td>
         <td class=DataLabel>
          <input type=text name=ptmis066 id=ptmis066 size=5 maxlength=4 
           tabindex=16 onblur="validateCode(5,ptmis066,drgdesc1);">
          <input type=text notab readonly name=drgdesc1 id=drgdesc1 size=35 
           value="">
          <img notab src="../images/SearchIcon.gif" class=Icon
           title="Provisional DRG Search"
           onclick="DrgSearchFrame(UpdateForm.ptmis066,UpdateForm.drgdesc1);">
          <img src="../images/DiagnosisSearchIcon.gif" class=Icon
           title="Provisional DRG Search via MBS Code"
           onclick="DrgViaMBSSearchFrame(UpdateForm.ptmis066,
                    UpdateForm.ptmis026,UpdateForm.ptvis043,
                    UpdateForm.psex,UpdateForm.page)">
          </td></tr>

      <tr><td class=DataLabel>Admission Criteria</td>
          <td>
          <select name=ptvis041 tabindex=8 title="Criteria for Admission">
          <option> </option>
          %PATWEB89.01.244.2
          </select>
          </td>
         <td class=DataLabel> Diet Code </td>
        <td>
           <select name=ptmis028 tabindex=17>
           <option> </option>
            %PATWEB89.01.127.4
            </select>
         </td></tr>

     <tr><td class=DataLabel>Care Type</td>
         <td><select name=ptmis012 tabindex=9 title="Care Type"
               onchange="displayRegime();"> 
              <option> </option>
               %PATWEB89.01.113.2
              </select>
         </td>
        <td class=DataLabel>Referring GP</td>
        <td><input type="text" size=10 maxlength=10 tabindex=17
         name=ptvis028 id=ptvis028 value="%PATWEB89.01.884.001"
         title="Referring GP" class=Mandatory
onchange="ReadDoc(18,0,UpdateForm.ptvis028,UpdateForm.doctnam1,
          UpdateForm.ptvis029,UpdateForm.genpprac,
          UpdateForm.ptvis030,UpdateForm.genpprov);">
        <input type="text" size=25 name=doctnam1 id=doctnam1
         value="%PATWEB89.01.884.081" class=Mandatory title="Referring GP">
        <img src="../images/SearchIcon.gif" class=Icon
onclick="GPHCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,
         UpdateForm.genpprov,UpdateForm.ptvis029,
         UpdateForm.genpprac,UpdateForm.ptvis030,0);">
        </td>
      </tr>

      <tr><td class=DataLabel> Intended Stay </td>
          <td> <select name=ptvis043 tabindex=10 title="Intended Stay">
             <option> </option>
              %PATWEB89.01.246.2
             </select>
        </td>
        <td class=DataLabel>Practice</td>
        <td><input type="text" name=genpprac id=genpprac size=35 readonly
                   value="%PATWEB89.01.885.005">
      <input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.01.885.001">
      <input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.01.861">
      <input type=hidden name=genpprov id=genpprov>
      <img src="../images/SearchIcon.gif" class=Icon
         onclick="GPHCGSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,
                  UpdateForm.genpprov,UpdateForm.ptvis029,
                  UpdateForm.genpprac,UpdateForm.ptvis030);">
        <img src="../images/erase.gif" class=Icon
        onclick="clrFields(UpdateForm.ptvis029,UpdateForm.genpprac,
                 UpdateForm.ptvis030,UpdateForm.genpprov);">
        </td>
       </tr>

       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030
         tabindex=11 title='Planned Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);">
        </td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 id=ptvis022 tabindex=19 title="Inform GP">
        <option value=" "></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td>
       </tr>

       <tr><td class=DataLabel>Discharge Intention</td>
           <td><select name=ptvis076 tabindex=10 title="Care Type">
                 <option> </option>
                 %PATWEB89.01.292.2
               </select></td>
       <td class=DataLabel><div id=PCEHRTitleDIV></div></td>
       <td><select name=pmsvx125 tabindex=20 title="Upload to PCEHR">
           <option value=" "></option>
           <option value="0">No</option>
           <option value="1">Yes</option>
           </select>
        </td>
       </tr>

       <tr><td class=DataLabel>Palliative Care Status</td>
           <td><select name=ptvis077 tabindex=10 title="Care Type">
                 <option> </option>
                 %PATWEB89.01.293.4
               </select></td>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=20>
          <option value="2">No</option>
          <option value="1">Yes</option>
         </select>
       </td>
       </tr>

       <tr><td class=DataLabel>Preferred Accommodation</td>
          <td><select name=ptvis093 tabindex=11 title="Preferred Accommodation">
              <option> </option>
               %PATWEB89.01.298.012.2
              </select></td>

       <td>%STANDARD.01.017.U2</td>
         <td><select name=ptmis038 tabindex=22>
           <option></option>
            %PATWEB89.01.134.2
         </select></td>
       </tr>

       <tr><td class=DataLabel>Valuables Location</td>
           <td><input type="text" size=40 maxlength=40 name=ptvis020
                tabindex=11 >
           </td>
         <td width=15%> Informed Financial Consent
         <td><select name=ptvis086 tabindex=22 
          title="Informed Financial Consent">
          %PATWEB89.01.298.005.2
         </select></td>
       </tr>

<tr><td class=DataLabel>Admitting MBS</td>
    <td class=DataLabel>
    <input type=text name=ptmis026 id=ptmis026 size=10 maxlength=9 tabindex=11
     onblur="ValidateProvDRG(UpdateForm.ptmis026,UpdateForm.mbsdesc1,ptmis066,
                             UpdateForm.ptvis043,UpdateForm.psex,
                             UpdateForm.page,UpdateForm.ptmis001);">
    <input type=text notab readonly name=mbsdesc1 id=mbsdesc1 size=35>
    <img notab src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(UpdateForm.ptmis026,UpdateForm.mbsdesc1,
              UpdateForm.ptmis001);"> </td>
        <td class=DataLabel>Program</td>
        <td><input type=text size=8 maxlength=8 name=ptvis099
         title="Program" tabindex=22 value="%PATWEB89.01.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=166
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.01.298.021.2
          </select></td>
    </tr>
    <tr><td class="DataLabel"><div id="ProgramIdTitle"></div></td>
        <td class="DataField"><div id="ProgramIdField"></div></td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
        </tr>


       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

     <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
          <td><select name=ptmis027 title="%STANDARD.01.017.CL" 
               tabindex=50 onchange=setHF();>
                <option> </option>
                 %PATWEB89.01.915.2
              </select>
           </td>
         </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 tabindex=51  
               title="%STANDARD.01.017.A "> 
              <option> </option>
                 %PATWEB89.01.111.2
              </select></td>
    <td class=DataLabel>Continuous Billing</td>
    <td><select name=ptmis081 tabindex=27>
        <option> </option>
         %PATWEB89.01.199.014.2
        </select>
    </td>
</tr>

<tr>
    <td class=DataLabel>Health Fund </td>
    <td colspan=2><input type=text size=6 maxlength=6 name=ptmis013 id=ptmis013
         title="Health Fund" tabindex=52
         onchange="validateCode(16,document.UpdateForm.ptmis013,
                   UpdateForm.funddesc);
                   checkTableadm();" value="%PATWEB89.01.040.0">
        <input type=text size=25 maxlength=30 name=funddesc id=funddesc 
         class=readonly Readonly notab value="%PATWEB89.01.040.1">
    Level
        <input name=ptmis014 id=ptmis014 size=8 maxlength=8
         tabindex=52 value="%PATWEB89.01.041.0"
         title="Level"
         onblur="validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                 UpdateForm.funddesc,UpdateForm.tabldesc);">
        <input type="text" size=15 maxlength=17 name=tabldesc id=tabldesc
         class=readonly Readonly notab value="%PATWEB89.01.041.1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HealthFundSearchFrame(UpdateForm.ptmis013,
                  UpdateForm.funddesc,UpdateForm.ptmis014,
                  UpdateForm.tabldesc);">
        <img src="../images/erase.gif" class="Icon"
         onclick="clrDoc(UpdateForm.ptmis013,UpdateForm.ptmis014);
                  clrDoc(UpdateForm.funddesc,UpdateForm.tabldesc);
                  checkTableadm();">
    </td>
</tr>

  <tr><td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015 tabindex=52
       value="%PATWEB89.01.042">
      </td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=53>
        </td>

  <tr><td><div id=UserNameHead></div></td>
      <td><div id=UserNameCode></div></td>
      <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td></tr>

  <tr><td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td>
      <td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td></tr>

  <tr><td><div id=RegimeHead4></div></td>
      <td><div id=RegimeCode4></div></td>
      <td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td></tr>

  <tr><td class=DataLabel></td>
      <td></td>
      <td class=DataLabel><div id=PreExistAilHdr></div></td>
      <td><div id=PreExistAilmnt></div></td>
      </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=EmerAdmHdr></div></td>
      <td><div id=EmerAdmssn></div></td>
      </tr>

  <tr><td align=left></td>
      <td align=right><div id=SwiPresIll></div></td>
      <td class=DataLabel><div id=PresIllCodHdr></div></td>
      <td><div id=PresIllCod></div></td>
      </tr>

  <tr><td align=center colspan="4"><div id=LongLine></div></td>

  <tr><td align=center colspan="4"><div id=OESServices></div></td>

<!-- END HEALTH FUND STUFF -->

      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=54 type=button value="Ok" class=button name=OKButton
              onclick="checkBedStatus(UpdateForm.ptmis068.value,
                       UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                       UpdateForm.ptmis030.value,UpdateForm.ptmis002.value,
                       UpdateForm.ptrgm001.value,UpdateForm.ptrgm002.value,
                       UpdateForm.ptrgm003.value,SubmitAdm);">
       <input tabindex=55 type=button value="Cancel" class=button
             onclick='fnPatientLink("%PATWEB89.01.003","%PATWEB89.01.081");'>
    </table>
</td></tr>
</table>
</form>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<form name=linkForm action=patweb89.pbl method=post style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=19 
         title="Referral Date">
         <img notab src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(UpdateForm.ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=20 
         title="Consultation Date">
         <img notab src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(UpdateForm.ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6
         onchange="justifyRight(this);">grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>


<span id=transferhd style="display:none">
Transfer Source
</span>
<span id=transfersrc style="display:none">
<input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc 
     class=Mandatory title="Transfer Source" tabindex=5
     onchange="validateCode(9,UpdateForm.trnsfsrc,UpdateForm.trandesc);">
    <input type=text size=27 name=trandesc id=trandesc notab
     class=Readonly readonly>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="TransferSourceFrame(UpdateForm.trnsfsrc,UpdateForm.trandesc);">
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=PCEHRTitleSPAN style="display:none">
Upload to PCEHR
</span>

<script type="text/javascript">
 document.UpdateForm.ptmas046.value =
   document.UpdateForm.alrtsind.value.substr(10,1);

 if ("%PATWEB89.01.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.01.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if(!isWhitespace(document.UpdateForm.ptmis001.value)) {
   Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
   Dat=document.UpdateForm.ptmis001.value.substr(2)
   document.UpdateForm.ptmis001.value=Day + Dat
 }
  if ((VariableNameExists('ScreenLabelMyHRConsent'))&&
      (ScreenLabelMyHRConsent!="")){
    document.getElementById("PCEHRTitleSPAN").innerHTML =
    ScreenLabelMyHRConsent;
    document.UpdateForm.pmsvx125.title = ScreenLabelMyHRConsent;
  }
  PCEHRTitleDIV.innerHTML=PCEHRTitleSPAN.innerHTML;

 StatInd10="%PATWEB89.01.891";
 PCEHR=StatInd10.substr(4,1).replace(/ /g,"0");
 if ((PCEHR == "1") || (PCEHR == "2")) {
   document.UpdateForm.pmsvx125.value="0";
 } else {
   if (PCEHR == "3") {
     document.UpdateForm.pmsvx125.value="1";
   } else {
     document.UpdateForm.pmsvx125.value="";
   }
 }

var p = document.UpdateForm;
var informGP = "%PATWEB89.01.225.0";               //ptvis022
valInformGP(p.ptvis022,informGP,p.ptcndigp.value);

var VisMyHealthRec = trim("%PATWEB89.01.298.037"); //pmsvx125/ptvis115
valMYHR(p.pmsvx125,VisMyHealthRec,p.ptcndumh.value);
/*if (p.ptcndumh.value > 2){
      p.pmsvx125.className="Mandatory";}
   else{
      p.pmsvx125.className="";}
*/
</script>

<span id=regimehd1 style="display:none">
Regime Code 1
</span>
<span id=regimecod1 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm001 id=ptrgm001 tabindex=53 
     onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm001,UpdateForm.dummy);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.ptrgm001,UpdateForm.dummy);">
</span>

<span id=regimehd2 style="display:none">
Regime Code 2
</span>
<span id=regimecod2 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm002 id=ptrgm002 tabindex=53 
     onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 2">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm002,UpdateForm.dummy);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.ptrgm002,UpdateForm.dummy);">
</span>

<span id=regimehd3 style="display:none">
Regime Code 3
</span>
<span id=regimecod3 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm003 id=ptrgm003 tabindex=53
     onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 3">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm003,UpdateForm.dummy);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.ptrgm003,UpdateForm.dummy);">
</span>

<span id=regimeblank1 style="display:none">
<input type=hidden name=ptrgm001 value="">
</span>

<span id=regimeblank2 style="display:none">
<input type=hidden name=ptrgm002 value="">
</span>

<span id=regimeblank3 style="display:none">
<input type=hidden name=ptrgm003 value="">
</span>

<span id=usernamehd style="display:none">
User Name
</span>     
             
<span id=usernamcd style="display:none">
<input size=12 type=text name=username class=Mandatory title="UserName">
</span>

<span id=passwordhd style="display:none">
Password
</span>

<span id=passwordcd style="display:none">
<input size=12 type=Password name=password onblur="checkPass();"
     class=Mandatory title="Password">
</span>

<span id=regimeblank4 style="display:none">
<input type=hidden name=ptmis057 value="">
</span>

<span id=regimehd4 style="display:none">
%STANDARD.01.035.DA
</span>
<span id=regimecod4 style="display:none">
<select name=ptmis057 title="%STANDARD.01.035.DA">
   <option></option>
    %PATWEB89.01.148.2
   </select>
</span>

<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
</script>

<span id=preexisthdr style="display:none">
 <b>PEA Indicator</b>
</span>

<span id=emeradmnhdr style="display:none">
 <b>Emergency Admission</b>
</span>

<span id=presillcodhdr style="display:none">
 <b>Presenting Illness Code</b>
</span>

<span id=presillnumhdr style="display:none">
</span>

<span id=swipresillhdr style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=preexistail style="display:none">
  <select name=ptelg014 title="PEA Indicator" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=emeradmissn style="display:none">
  <select name=ptelg033 title="Emergency Admission" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=presillcod style="display:none">
  <select name=ptvis111 title="Presenting Illness" class="OECRequired">
  <option value=" "></option>
   %PATWEB89.01.298.034.2
  </select>
</span>

<span id=swipresill style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
 <input type="checkbox" name="presilsw" value="1" title="Presenting Illness MBS"
       onclick="switchPresIll();"> &nbsp; &nbsp;
</span>

<span id=presillnum style="display:none">
</span>

<span id=oesservices style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td><b>Date</b></td>
      <td><b>Type</b></td>
                   <td><b>Item / Description</b></td>
                   <td><b>Quantity</b></td></tr>
  <tr><td width=20%>
     <input type=text size=12 name=oes01007 id=oes01007
      class="FutureDate" title="OES Service 1 Date"
      onblur="checkDate(this,this.title);">
     <img notab src=../images/DateTimeStamp.gif class="Icon"
      onclick="SetCurrentDateTime(UpdateForm.oes01007,null);">
     <img notab src=../images/DateLookup.gif class="Icon"
      onclick="DateLookupFrame(UpdateForm.oes01007);">
                   </td>
                   <td width=12%>
    <select name=oes01004 title="Type"
     onchange="clrFields(UpdateForm.oes01005,UpdateForm.d_oes01005);
               mandatoryItemCode(document.UpdateForm.oes01005,
               document.UpdateForm.oes01007,
               document.UpdateForm.oes01006);">
     <option value="6">Misc.Item</option>
     </select>
                   </td>
                   <td>
    <input type=text name=oes01005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes01004,
                              document.UpdateForm.oes01005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes01005);
             mandatoryItemCode(this,document.UpdateForm.oes01007,
                                    document.UpdateForm.oes01006);
             document.UpdateForm.oes01006.value=1;
             justifyRight(document.UpdateForm.oes01006);">
    <input type=text name=d_oes01005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                  document.UpdateForm.oes01005,
                                  document.UpdateForm.d_oes01005);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.oes01005,UpdateForm.d_oes01005);
                            mandatoryItemCode(document.UpdateForm.oes01005,
                                              document.UpdateForm.oes01007,
                                              document.UpdateForm.oes01006);">
                   </td>
                   <td>
    <input type=text name=oes01006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes02007 id=oes02007
      class="FutureDate" title="OES Service 2 Date"
      onblur="checkDate(this,this.title);">
     <img notab src=../images/DateTimeStamp.gif class="Icon"
      onclick="SetCurrentDateTime(UpdateForm.oes02007,null);">
     <img notab src=../images/DateLookup.gif class="Icon"
      onclick="DateLookupFrame(UpdateForm.oes02007);">
                   </td>
                   <td width=12%>
    <select name=oes02004 title="Type"
     onchange="clrFields(UpdateForm.oes02005,UpdateForm.d_oes02005);
               mandatoryItemCode(document.UpdateForm.oes02005,
               document.UpdateForm.oes02007,
               document.UpdateForm.oes02006);">
     <option value="6">Misc.Item</option>
     </select>
                   </td>
                   <td>
    <input type=text name=oes02005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes02004,
                              document.UpdateForm.oes02005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes02005);
             mandatoryItemCode(this,document.UpdateForm.oes02007,
                                    document.UpdateForm.oes02006);
             document.UpdateForm.oes02006.value=1;
             justifyRight(document.UpdateForm.oes02006);">
    <input type=text name=d_oes02005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                  document.UpdateForm.oes02005,
                                  document.UpdateForm.d_oes02005);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.oes02005,UpdateForm.d_oes02005);
                            mandatoryItemCode(document.UpdateForm.oes02005,
                                              document.UpdateForm.oes02007,
                                              document.UpdateForm.oes02006);">
                   </td>
                   <td>
    <input type=text name=oes02006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes03007 id=oes03007
      class="FutureDate" title="OES Service 3 Date"
      onblur="checkDate(this,this.title);">
     <img notab src=../images/DateTimeStamp.gif class="Icon"
      onclick="SetCurrentDateTime(UpdateForm.oes03007,null);">
     <img notab src=../images/DateLookup.gif class="Icon"
      onclick="DateLookupFrame(UpdateForm.oes03007);">
                   </td>
                   <td width=12%>
    <select name=oes03004 title="Type"
     onchange="clrFields(oes03005,d_oes03005);
               mandatoryItemCode(document.UpdateForm.oes03005,
               document.UpdateForm.oes03007,
               document.UpdateForm.oes03006);">
     <option value="6">Misc.Item</option>
     </select>
                   </td>
                   <td>
    <input type=text name=oes03005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes03004,
                              document.UpdateForm.oes03005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes03005);
             mandatoryItemCode(this,document.UpdateForm.oes03007,
                                    document.UpdateForm.oes03006);
             document.UpdateForm.oes03006.value=1;
             justifyRight(document.UpdateForm.oes03006);">
    <input type=text name=d_oes03005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                  document.UpdateForm.oes03005,
                                  document.UpdateForm.d_oes03005);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.oes03005,UpdateForm.d_oes03005);
                            mandatoryItemCode(document.UpdateForm.oes03005,
                                              document.UpdateForm.oes03007,
                                              document.UpdateForm.oes03006);">
                   </td>
                   <td>
    <input type=text name=oes03006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes04007 id=oes04007
      class="FutureDate" title="OES Service 4 Date"
      onblur="checkDate(this,this.title);">
     <img notab src=../images/DateTimeStamp.gif class="Icon"
      onclick="SetCurrentDateTime(UpdateForm.oes04007,null);">
     <img notab src=../images/DateLookup.gif class="Icon"
      onclick="DateLookupFrame(UpdateForm.oes04007);">
                   </td>
                   <td width=12%>
    <select name=oes04004 title="Type"
     onchange="clrFields(UpdateForm.oes04005,UpdateForm.d_oes04005);
               mandatoryItemCode(document.UpdateForm.oes04005,
               document.UpdateForm.oes04007,
               document.UpdateForm.oes04006);">
     <option value="6">Misc.Item</option>
     </select>
                   </td>
                   <td>
    <input type=text name=oes04005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes04004,
                              document.UpdateForm.oes04005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes04005);
             mandatoryItemCode(this,document.UpdateForm.oes04007,
                                    document.UpdateForm.oes04006);
             document.UpdateForm.oes04006.value=1;
             justifyRight(document.UpdateForm.oes04006);">
    <input type=text name=d_oes04005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                  document.UpdateForm.oes04005,
                                  document.UpdateForm.d_oes04005);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.oes04005,UpdateForm.d_oes04005);
                            mandatoryItemCode(document.UpdateForm.oes04005,
                                              document.UpdateForm.oes04007,
                                              document.UpdateForm.oes04006);">
                   </td>
                   <td>
    <input type=text name=oes04006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes05007 id=oes05007
      class="FutureDate" title="OES Service 5 Date"
      onblur="checkDate(this,this.title);">
     <img notab src=../images/DateTimeStamp.gif class="Icon"
      onclick="SetCurrentDateTime(UpdateForm.oes05007,null);">
     <img notab src=../images/DateLookup.gif class="Icon"
      onclick="DateLookupFrame(UpdateForm.oes05007);">
                   </td>
                   <td width=12%>
    <select name=oes05004 title="Type"
     onchange="clrFields(UpdateForm.oes05005,UpdateForm.d_oes05005);
               mandatoryItemCode(document.UpdateForm.oes05005,
               document.UpdateForm.oes05007,
               document.UpdateForm.oes05006);">
     <option value="6">Misc.Item</option>
     </select>
                   </td>
                   <td>
    <input type=text name=oes05005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes05004,
                              document.UpdateForm.oes05005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes05005);
             mandatoryItemCode(this,document.UpdateForm.oes05007,
                                    document.UpdateForm.oes05006);
             document.UpdateForm.oes05006.value=1;
             justifyRight(document.UpdateForm.oes05006);">
    <input type=text name=d_oes05005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                  document.UpdateForm.oes05005,
                                  document.UpdateForm.d_oes05005);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.oes05005,UpdateForm.d_oes05005);
                            mandatoryItemCode(document.UpdateForm.oes05005,
                                              document.UpdateForm.oes05007,
                                              document.UpdateForm.oes05006);">
                   </td>
                   <td>
    <input type=text name=oes05006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
</table>
</span>

<span id=itemtype1misc style="display:none">
    <input type=text name=oes01005 title="Misc.Item 1" size=10 maxlength=10
     onblur="validateCode(40,UpdateForm.oes01005,UpdateForm.dummy);">
</span>

<span id=longline style="display:none"><hr></span>
<span id=blanklabel style="display:none">&nbsp;</span>

<span id="ShowProgramIdTitle" style="display:none">
 %STANDARD.01.035.PK
</span>

<span id="ShowProgramIdField" style="display:none">
  <select name=ptvis110 title="%STANDARD.01.035.PK" tabindex=12
   id="ptvis110" class="">
    <option> </option>
    %STANDARD.01.007.PK
  </select>
</span>
