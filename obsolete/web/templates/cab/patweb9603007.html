<meta name="TemplateVersion" content="V11.03.00">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<style type=text/css> 
.TransferOption {
position: relative; 
}
</style>
<script type="text/javascript">
function checkPass() {
  if (isWhitespace(document.pat96btf.username.value)) { return;; }
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=11" +
                    "&secureid=" + pat96btf.username.value.replace(/ /g,"+") +
                    "&securepw=" + pat96btf.password.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
  }
  else {
    document.pat96btf.username.value="";
    document.pat96btf.password.value="";
    document.pat96btf.username.focus();

  }
}
function checkBedStatus(wardcode,beddcode) {
  admissno=PatientLinks.admissno.value.replace(/ /g,"+")
//  if (isWhitespace(wardcode)) return;;
  ReturnFunction="" ;
  var admisdte="";
  var staydays="0";
  var admistme="";
  var ptrgm001="";
  var ptrgm002="";
  var ptrgm003="";
  var x="";
  var y="0";
  var z;
  var z1;
  var staydays="";
  for (var i=2; i < checkBedStatus.arguments.length; i++) {
   if (typeof(checkBedStatus.arguments[i]) == 'function') {
     ReturnFunction=checkBedStatus.arguments[i] } }

  // Receive optional parameters
  if (checkBedStatus.arguments.length >= 9) {
    admisdte=checkBedStatus.arguments[2].replace(/ /g,"+");

//    staydays=checkBedStatus.arguments[3].replace(/ /g,"+");
   
    if (pat96btf.trandate.value.substring(4,6)=="01") mon="Jan"
    if (pat96btf.trandate.value.substring(4,6)=="02") mon="Feb"
    if (pat96btf.trandate.value.substring(4,6)=="03") mon="Mar"
    if (pat96btf.trandate.value.substring(4,6)=="04") mon="Apr"
    if (pat96btf.trandate.value.substring(4,6)=="05") mon="May"
    if (pat96btf.trandate.value.substring(4,6)=="06") mon="Jun"
    if (pat96btf.trandate.value.substring(4,6)=="07") mon="Jul"
    if (pat96btf.trandate.value.substring(4,6)=="08") mon="Aug"
    if (pat96btf.trandate.value.substring(4,6)=="09") mon="Sep"
    if (pat96btf.trandate.value.substring(4,6)=="10") mon="Oct"
    if (pat96btf.trandate.value.substring(4,6)=="11") mon="Nov"
    if (pat96btf.trandate.value.substring(4,6)=="12") mon="Dec"
    pat96btf.convdate.value=pat96btf.trandate.value.substring(6,8) + " " +
                            mon + " " +
                            pat96btf.trandate.value.substring(0,4)
    z=days_between(pat96btf.trindate.value,pat96btf.convdate.value);
    z1=days_between(pat96btf.admndate.value,pat96btf.trindate.value);
    staydays=checkBedStatus.arguments[3]-z-z1;
    if (staydays<0) {
      staydays="0";
    }
    admistme=checkBedStatus.arguments[4].replace(/ /g,"+");
    ptrgm001=checkBedStatus.arguments[5].replace(/ /g,"+");
    ptrgm002=checkBedStatus.arguments[6].replace(/ /g,"+");
    ptrgm003=checkBedStatus.arguments[7].replace(/ /g,"+");
    prnxindi="0";
  }
  var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=1" +
                  "&wardcode="+wardcode.replace(/ /g,"+") +
                  "&beddcode="+beddcode.replace(/ /g,"+") +
                  "&admissno="+admissno.replace(/ /g,"+") +
                  "&admisdte="+x.replace(/ /g,"+") +
                  "&admistme="+admistme.replace(/ /g,"+") +
                  "&staydays="+y.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {

    if (isWhitespace(document.pat96btf.trntowrd.value)) {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
        return;
      }
    }

    if (isWhitespace(document.pat96btf.trntobed.value)) {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
        return;
      }
    }
    if (pat96btf.pswdindc.value==0) {
      var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                      "&wardcode="+wardcode.replace(/ /g,"+") +
                      "&beddcode="+beddcode.replace(/ /g,"+") +
                      "&admissno="+admissno.replace(/ /g,"+") +
                      "&admisdte="+admisdte.replace(/ /g,"+") +
                      "&staydays="+staydays+
                      "&admistme="+admistme.replace(/ /g,"+") +
                      "&ptrgm001="+ptrgm001.replace(/ /g,"+") +
                      "&ptrgm002="+ptrgm002.replace(/ /g,"+") +
                      "&ptrgm003="+ptrgm003.replace(/ /g,"+") +
                      "&prnxindi="+prnxindi.replace(/ /g,"+")
      var returnValue = RSExecute(serverURL);
      if (returnValue.status==0) {
        if (returnValue.return_value==1) {
          if (!confirm("Warning: Pre-Adm/Admission will override a previous bed managment record.")) {
            return;
          }
        }
        prevretval=returnValue.return_value;
        prnxindi="1";
        var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                        "&wardcode="+wardcode.replace(/ /g,"+") +
                        "&beddcode="+beddcode.replace(/ /g,"+") +
                        "&admissno="+admissno.replace(/ /g,"+") +
                        "&admisdte="+admisdte.replace(/ /g,"+") +
                        "&staydays="+staydays+
                        "&admistme="+admistme.replace(/ /g,"+") +
                        "&ptrgm001="+ptrgm001.replace(/ /g,"+") +
                        "&ptrgm002="+ptrgm002.replace(/ /g,"+") +
                        "&ptrgm003="+ptrgm003.replace(/ /g,"+") +
                        "&prnxindi="+prnxindi.replace(/ /g,"+")
        var returnValue = RSExecute(serverURL);
        if (returnValue.status==0) {
          if (returnValue.return_value==1) {
            if (!confirm("Warning: Pre-Adm/Adm will override a following bed managment record.")) {
              return;
            }
          }

          if (prevretval==1 || returnValue.return_value==1) {
            pat96btf.pswdindc.value="1";
            PasswordHead.innerHTML=passwordhd.innerHTML;
            PasswordCode.innerHTML=passwordcd.innerHTML;
            UserNameHead.innerHTML=usernamehd.innerHTML;
            UserNameCode.innerHTML=usernamcd.innerHTML;
            return;
          }
          if (typeof(ReturnFunction) == 'function') {
            ReturnFunction()
          }
//          } else {
//            if (typeof(ReturnFunction) == 'function') {
//              ReturnFunction()
//            }
//          }
        }
      }
    } else {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
      }
    }
  }
}
function SubmitTransfer() {
  if (validateMandatory(pat96btf)) {
    if(pat96btf.ptcnbedm.value=="1") {
      validateBedRequestUpdate(pat96btf.admissno,pat96btf.trntowrd,
                               pat96btf.trntobed,pat96btf.valdindc);
      WardbedreqUpdate(pat96btf.admissno,pat96btf.trntowrd,pat96btf.trntobed,
                       pat96btf.valdindc)
    }
    SetHousekeeping();
    SubmitHidden(pat96btf);
  }
}
function ShowHouse() {
  if(document.pat96btf.ptcnchot.value=="1") {
    Housekeeping1.innerHTML=Displayhousekeeping1.innerHTML;
    Housekeeping2.innerHTML=Displayhousekeeping2.innerHTML;
    Housekeeping3.innerHTML=Displayhousekeeping3.innerHTML;
    Housekeeping4.innerHTML=Displayhousekeeping4.innerHTML;
  }
}
function HouseMandatory() {
  if(document.pat96btf.notifyhs.value=="1") {
     document.pat96btf.pmhrd006.className="Mandatory"
     document.pat96btf.pmhrd006.disabled=false;
  } else {
     document.pat96btf.pmhrd006.selectedIndex=0;
     document.pat96btf.pmhrd006.className="Readonly"
     document.pat96btf.pmhrd006.disabled=true;
  }
}   
function SetHousekeeping() {
  if(document.pat96btf.ptcnchot.value=="1" &&
    document.pat96btf.notifyhs.value=="1") {
    i=document.pat96btf.trandate.selectedIndex;
    document.pat96btf.pmhrd004.value=document.pat96btf.trandate.options[i].text;
    document.pat96btf.pmhrd005.value=document.pat96btf.trantime.value;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowHouse();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB96.03.003";
PatientVIS="%PATWEB96.03.081";
PatientNAM="%PATWEB96.03.002";
PatientSTA="%PATWEB96.03.086.078";
PatientALT="%PATWEB96.03.084";
PatientSEX="%PATWEB96.03.019";
PatientDOB="%PATWEB96.03.020";
PatientAGE="%PATWEB96.03.021";
PatientLOC="%PATWEB96.03.083";
PatientPRI="%PATWEB96.03.086.066.1";
PatientUNT="%PATWEB96.03.066.0";
DoctorCOD="%PATWEB96.03.082.003";
DoctorNAM="%PATWEB96.03.082.002";
PatientAID="%PATWEB96.03.086.090";
PatientIND="%PATWEB96.03.086.091";
PatientCUR="%PATWEB96.03.086.092";
PatientCLC="%PATWEB96.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB96.03.086.094";
PatientCDM="%PATWEB96.03.086.095";
PatientVDH="%PATWEB96.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=pat96btf id=pat96btf style="margin:0" %PATWEB96.03.201.001
    <input type=hidden name=urnumber id=urnumber value="%PATWEB96.03.003">
    <input type=hidden name=admissno id=admissno value="%PATWEB96.03.081">
    <input type=hidden name=redirect id=redirect
     value="%PATWEB96.03.001.patweb96.03.004">
    <input type=hidden name=mhredirc id=mhredirc
     value="%PATWEB96.03.001.patweb89.07.001">
    <input type=hidden name=nextpage id=nextpage value="7">
    <input type=hidden name=trnleave id=trnleave value="0">
    <input type=hidden name=wbedswap id=wbedswap value="0">
    <input type=hidden name=bedstat1 id=bedstat1>
    <input type=hidden name=warddesc id=warddesc >
    <input type=hidden name=formactn id=formactn value="Transfer">
    <input type=hidden name=chngunit id=chngunit value="%PATWEB96.03.124.1">
    <input type=hidden name=wardcode id=wardcode value="%PATWEB96.03.105.1">
    <input type="hidden" name=bdmnindc id=bdmnindc value="1">
    <input type="hidden" name=pswdindc id=pswdindc value="0">
    <input type="hidden" name=expdleos id=expdleos value="%PATWEB96.03.129">
    <input type="hidden" name=admndate id=admndate value="%PATWEB96.03.102">
    <input type="hidden" name=ptrgm001 id=ptrgm001 value="%PATWEB96.03.229. 1">
    <input type="hidden" name=ptrgm002 id=ptrgm002 value="%PATWEB96.03.229. 2">
    <input type="hidden" name=ptrgm003 id=ptrgm003 value="%PATWEB96.03.229. 3">
    <input type="hidden" name=convdate id=convdate>
    <input type=hidden name=ptcnbedm id=ptcnbedm
     value="%STANDARD.01.025.112.106.0.1">
    <input type=hidden name=ptcnchot id=ptcnchot
     value="%STANDARD.01.025.114.138.0.1">
    <input type=hidden name=valdindc id=valdindc value="">

<table border=1 width=100% cellspacing=0 cellpadding=1 >
    <tr><td class=HeadingCell align=center colspan=2 width=100%>
        Bed Transfer & Leave Maintenance </td></tr>
</table>

<table border=0 width=100% cellspacing=1>
  <tr><td class=HeadingCell align=center colspan=2>Current Status</td>
      <td align=center class=HeadingCell colspan=2>Bed Transfer</td></tr>

   <tr><td class=DataLabel>Ward / Bed </td>      
       <td><input type=text size=25 readonly value="%PATWEB96.03.105.0">
       <input type=text size=15 name=beddcode id=beddcode readonly 
        value="%PATWEB96.03.106"></td>

        <td class=DataLabel> Ward / Bed</td>
        <td><select name=trntowrd id=trntowrd class=Mandatory title="Ward">
        <option></option>
        %PATWEB96.03.210
        </select>
        <input type=text name=trntobed id=trntobed maxlength=3 size=3>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="WardBedSearchFrame(pat96btf.trntowrd,
                                     pat96btf.warddesc,
                                     pat96btf.trntobed,
                                     pat96btf.bedstat1);">
        </td></tr>

   <tr><td class=DataLabel>Transfer In Date & Time </td>
       <td><input type=text name=trindate id=trindate size=11 readonly
            value="%PATWEB96.03.204" >
       <input type=text size=5 readonly value="%PATWEB96.03.205"></td>

        <td class=DataLabel>Transfer out Date & Time </td>
        <td><select name=trandate id=trandate class=Mandatory
             title="Transfer date">
        %PATWEB96.03.202
        </select>
        <input type=text size=8 name=trantime id=trantime class=Mandatory 
         title="Transfer Time" value="%STANDARD.01.016">
        <img src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(null,pat96btf.trantime);">
        <img src="../images/TimeLookup.gif" class=Icon
         onclick="TimeLookupFrame(pat96btf.trantime);"></td></tr>

   <tr><td class=DataLabel>Attending Doctor</td>
       <td><input type=text size=35 readonly value="%PATWEB96.03.108.002">
           </td>
       <td><div id="Housekeeping1"></div></td>
       <td><div id="Housekeeping2"></div></td>
       </tr>


   <tr><td class=DataLabel>%STANDARD.01.017.A </td>
        <td><input type=text readonly size=30 
             value="%PATWEB96.03.111.0"> </td>
        <td><div id="Housekeeping3"></div></td>
        <td><div id="Housekeeping4"></div></td>
        </tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CC</td>
       <td><input type=text readonly size=30 
           value="%PATWEB96.03.113.0"></td>
       <td align=center colspan=3>
       <input type=button value=Update class="button" id=btnUpdate
        onclick="tempDisable(this);
                 checkBedStatus(pat96btf.trntowrd.value,
                                pat96btf.trntobed.value,
                                pat96btf.trandate.value,
                                pat96btf.expdleos.value,
                                pat96btf.trantime.value,
                                pat96btf.ptrgm001.value,
                                pat96btf.ptrgm002.value,
                                pat96btf.ptrgm003.value,
                                SubmitTransfer);">
         <input type=button value=Swap class="button" id=btnSwap
          onclick="tempDisable(this);
                   document.pat96btf.wbedswap.value='1';
                   checkClosedBeds(pat96btf.wardcode.value,
                                   pat96btf.beddcode.value,
                                   pat96btf.trntowrd.value,
                                   pat96btf.trntobed.value,
                                   SubmitTransfer);">
         <input type=button value=Cancel class="button"
          onclick="PatientLinkTo('patweb96.pbl',3,4,0);">
       </td>
   </tr>

   <tr><td class=DataLabel>%STANDARD.01.017.AC</td>
       <td><input type=text readonly size=30 
           value="%PATWEB96.03.124.0"></td>
       <td><div id=UserNameHead></div></td>
       <td><div id=UserNameCode></div></td>
   </tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td><input type=text value="%PATWEB96.03.126.0"></td>
       <td><div id=PasswordHead></div></td>
       <td><div id=PasswordCode></div></td>
   </tr>

   <tr><td class=DataLabel>Health Fund</td>
       <input type="hidden" value="%PATWEB96.03.114.0">
       <td class=DataLabel colspan=2>
       <input type=text size=35 name="funddesc" id="funddesc" maxlength="30"
         value="%PATWEB96.03.114.1"> </td>
   </tr>

   <tr><td>Table</td>
       <td><input type="hidden" value="%PATWEB96.03.115.0">
           <input type="text" size=20 maxlength=30 name="tabldesc"
            id="tabldesc"
            value="%PATWEB96.03.115.1"></td>
   </tr>

</table>
</form>
</div>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB96.03.003">
<input type=hidden name=admissno value="%PATWEB96.03.081">
<input type=hidden name=MenuType value="%PATWEB96.03.088">
<input type=hidden name=alert001 value="">
</form>

<span id=usernamehd style="display:none">
<td class=DataLabel>User Name</td>
</span>

<span id=usernamcd style="display:none">
<td><input size=12 type=text name=username id=username class=Mandatory title="UserName">
</td>
</span>

<span id=passwordhd style="display:none">
<td class=DataLabel>Password</td>
</span>

<span id=passwordcd style="display:none">
<td><input size=12 type=password name=password id=password
     onblur="checkPass();" class=Mandatory
     title="Password"></td>
</span>

<div id="Displayhousekeeping1" style="display:none">
Notify Housekeeping
</div> 

<div id="Displayhousekeeping2" style="display:none">
  <select name=notifyhs id=notifyhs title="Notify Housekeeping"
   class=Mandatory onchange="HouseMandatory();">
  <option> </option>
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</div>

<div id="Displayhousekeeping3" style="display:none">
Housekeeping Status
</div>

<div id="Displayhousekeeping4" style="display:none">
    <input type=hidden name=pmhrd001 id=pmhrd001 value="%PATWEB96.03.599.004">
    <input type=hidden name=pmhrd002 id=pmhrd002 value="%PATWEB96.03.105.1">
    <input type=hidden name=pmhrd003 id=pmhrd003 value="%PATWEB96.03.106">
    <input type=hidden name=pmhrd004 id=pmhrd004 value="">
    <input type=hidden name=pmhrd005 id=pmhrd005 value="">
    <select name=pmhrd006 id=pmhrd006 title="Housekeeping Status"
     class=Readonly disabled>
      <option> </option>
      %STANDARD.01.007.BV
      </select>
</div>
