<meta name="TemplateVersion" content="V11.03.00">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/admission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function SubmitAdm() {
  // Check if PMI 'Foundation' (PUYN2) value has been set; warn if not
  if (document.UpdateForm.alrtsind.value.substr(10,1) == '0') {
    alert("Mandatory PMI field - Foundation is missing.");
    return;
  }

  if (!validateMandatory(UpdateForm)) {
    return;
  }

  p=document.UpdateForm
  validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
  if (p.datefrom.value!='0'){
    alert("Error : Patient has a Suspension record for period \n" +
          "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
          "\tPatient will not be admitted");
    return;
  }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
    if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                        UpdateForm.funddesc,UpdateForm.tabldesc)) {
      ans=confirm("Select another active health fund table? ");
      if (ans==true) {
        return;
      }
    }
  }
  if (document.UpdateForm.mvmedre1.checked == true) {
    document.UpdateForm.mvmedrec.value="1";
  } else {
    document.UpdateForm.mvmedrec.value="0";
  }
  if (document.UpdateForm.d_keepbktm.checked == true) {
    document.UpdateForm.keepbktm.value="1"; 
  } else {
    document.UpdateForm.keepbktm.value="0";
  }
  ans="True";
  CheckAdmitDate();
  if (ans==false){
    return;
  }

  setRedirectAdm();

//*T0885382-Start: Removed Casemix Code auto population
//var IntStayIndc1 = p.ptvis043.value.substr(3,1);
//
//if (IntStayIndc1 == "1") {  // Overnight
//  // Validate Casemix Code using Provisional DRG code
//  if (!isWhitespace(p.ptmis066.value)) {
//    ValidateCasemixCode(p.ptmis066.value,p.ptmis073,p.cmixdesc1);
//  }
//}
//else if (IntStayIndc1 == "2") {  // Same-day
//  // Validate Casemix Code using Admitting MBS code
//  if (!isWhitespace(p.ptmis026.value)) {
//    ValidateCasemixCode(p.ptmis026.value,p.ptmis073,p.cmixdesc1);
//  }
//}
//*T0885382-End

  validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis004,
                           UpdateForm.ptmis005,UpdateForm.bedrqqry);
  window.setTimeout(function () { SubmitHidden(UpdateForm); }, 500);
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
//  UpdateForm.ptmis024.selectedIndex=1
  selectUnit();
}
function selectUnit(){
  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value.substr(0,3)==
        document.UpdateForm.deftunit.value.substr(0,3)) {
      document.UpdateForm.ptmis024.selectedIndex=i; } };
    if (isWhitespace(document.UpdateForm.deftunit)) {
      if (UpdateForm.ptmis024.length==2) {
        UpdateForm.ptmis024.selectedIndex=1; } }
}
function valReferGP(){
   p=document.UpdateForm;
   if (!isWhitespace(p.ptvis028.value)) {
     ValidateHCP(18,0,p.ptvis028,p.doctnam1);
     ValidateHCG(70,0,p.ptvis029,p.ptvis028,p.genpprac,p.ptvis030);
   }
}
function DefaultPMIGP(pmigp,pmipr,pmicn) {
  p=document.UpdateForm;
  p.ptvis028.value = pmigp.value;
  p.ptvis029.value = pmipr.value;
  p.ptvis030.value = pmicn.value;
  ValidateHCP(18,0,p.ptvis028,p.doctnam1);
  ValidateHCG(70,0,p.ptvis029,p.ptvis028,p.genpprac,p.ptvis030);
}
function DateEdits() {
  if (!checkDate(document.UpdateForm.ptmis001,
                 document.UpdateForm.ptmis001.title)) {
    return;
  }

  validateMbsCode(4,
                  document.UpdateForm.ptmis026,
                  document.UpdateForm.mbsdesc1,
                  document.UpdateForm.ptmis001);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();DisplayContract();
              valDoctorUnit();selectUnit();setHF();
              document.UpdateForm.ptmis001.focus();displayRegime();
              displayBookingDet();valReferGP();ShowActiveProgramID();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.04.003";
PatientVIS="%PATWEB89.04.081";
PatientNAM="%PATWEB89.04.002";
PatientSTA="%PATWEB89.04.086.078";
PatientALT="%PATWEB89.04.084";
PatientSEX="%PATWEB89.04.019";
PatientDOB="%PATWEB89.04.020";
PatientAGE="%PATWEB89.04.021";
PatientLOC="%PATWEB89.04.083";
PatientPRI="%PATWEB89.04.086.066.1";
PatientUNT="%PATWEB89.04.066.0";
DoctorCOD="%PATWEB89.04.082.003";
DoctorNAM="%PATWEB89.04.082.002";
PatientAID="%PATWEB89.04.086.090";
PatientIND="%PATWEB89.04.086.091";
PatientCUR="%PATWEB89.04.086.092";
PatientCLC="%PATWEB89.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.04.086.094";
PatientCDM="%PATWEB89.04.086.095";
PatientVDH="%PATWEB89.04.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm method=post  action=patweb89.pbl>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="1"> 
<input type=hidden name=updatety value="2">
<input type=hidden name=allocate value="1">
<input type=hidden name=redirect value="%PATWEB89.04.001.patweb98.01.001">
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.101">
<input type=hidden name=chckname value="0">
<input type=hidden name=deftunit value="%PATWEB89.04.124.1">
<input type=hidden name=emradmit value="0">
<input type=hidden name=emradmis value="0">
<input type=hidden name=newbmand value="0">
<input type=hidden name=agebmand value="0">
<input type=hidden name=ptmis074 value="N">
<input type=hidden name=admisflg value="1">
<input type=hidden name=ptmas046 value="0">
<input type=hidden name=mvmedrec>
<input type=hidden name=exstward value="%PATWEB89.04.195.1">
<input type=hidden name=cfinan value="%PATWEB89.04.932">
<input type=hidden name=dummy id=dummy>
<input type=hidden name=bdmnindc value="1">
<input type=hidden name=pswdindc value="0">
<input type=hidden name=bookflag value="%PATWEB89.04.912.001">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=alrtsind id=alrtsind value="%PATWEB89.04.084">
<input type=hidden name=psex id=psex value="%PATWEB89.04.086.082">
<input type=hidden name=page id=page value="%PATWEB89.04.938">
<input type=hidden name=bedrqqry value="">

<input type=hidden name=ptcndigp id=ptcndigp
       value="%STANDARD.01.025.124.122.0.1">
<input type=hidden name=ptcndumh id=ptcndumh
       value="%STANDARD.01.025.124.240.0.1">

<table border=0 width=100% cellspacing=1 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Patient Admission Details</tr>
<tr>
<tr><td>
      <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
        <tr>
          <td class=DataLabel>Admission Date</td>
          <td class=DataLabel>
            <input type="text" size="12" tabindex=1
            name=ptmis001 id=ptmis001 value="%STANDARD.01.015"
            class=Mandatory title="Admission Date"
            onblur="DateEdits();">
     <img src=../images/DateLookup.gif class=Icon
        onclick="DateLookupFrame(ptmis001);"> Time
     <input type=text name=ptmis002 id=ptmis002 tabindex=2 size=8
        value="%STANDARD.01.016" class=Mandatory title="Admission Time">
      <img src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(null,ptmis002);">
     <img src=../images/TimeLookup.gif class=Icon
        onclick="TimeLookupFrame(ptmis002);">
        <div id=BookingDet></div></td>
       <input type=hidden name=keepbktm>
       <td>Admitting Point</td>
       <td><select name="ptvis046" tabindex=14 class=Mandatory 
            title='Admitting Point' onchange="defaultWard()">
           <option> </option>
            %PATWEB89.04.290.2
         </select></td></tr>
     <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P " class=Mandatory >
              <option> </option>
                 %PATWEB89.04.112.2
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
       <td>
         <input type=hidden name=bedstat1 id=bedstat1>
         <input type=hidden name=warddesc id=warddesc>
         <select name=ptmis004 id=ptmis004 tabindex=15 title="Ward" 
          class=Mandatory>
           <option> </option>
           %PATWEB89.04.195.2
         </select>
         <input type=text name=ptmis005 id=ptmis005 maxlength=3 class=mandatory 
          size=3 value="%PATWEB89.04.194">
         <img src=../images/SearchIcon.gif class=Icon
         onclick="WardBedSearchFrame(ptmis004,warddesc,ptmis005,bedstat1);">
       </td>
     </tr>

      <tr><td class=DataLabel>Admission Source</td>
      <td>
         <select name=ptmis009 tabindex=4 onchange="DisplayTrnSrc()"
          class=Mandatory title='Admission Source'>
         <option> </option>
         %PATWEB89.04.110.2
          </select>
      </td>
      <td class=DataLabel>Admitting Doctor</td>
      <td><input type="text" size=8 maxlength=6 name=ptmis007 id=ptmis007 
           tabindex=17 value="%PATWEB89.04.108.003" class=Mandatory
           title="Admitting Doctor" onchange="UpCase(this);valDoctorUnit();">
          <input type=text readonly size=25 name=doctnam2 id=doctnam2 
           class=mandatory value="%PATWEB89.04.108.002">
          <img src="../images/SearchIcon.gif" class=Icon
           onclick="DoctorSearchFrame(ptmis007,doctnam2,valDoctorUnit)">
      </td></tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Unit</td>
          <td>
            <select name=ptmis024 tabindex=18 class=Mandatory title="Unit">
              <option> </option>
              %PATWEB89.04.124.2
            </select>
          </td></tr>

      <tr><td align=left>Prior Days Hospitalisation</td>
         <td align=left>
           <input name=ptmis031 title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=3 value="%PATWEB89.04.130"
            onblur="checkInteger(this,this.value);" tabindex=6>
           <option></option>
           </select>
         </td>
          <td class=DataLabel>Diagnosis </td>
      <td>
          <input type=text name="ptmis020" size=50 maxlength=80 tabindex=19
        value="%PATWEB89.04.121">
      </td></tr>
       <tr><td>Mode of Arrival</td>
       <td>
         <select name=ptvis054 tabindex=7>
         <option></option> %PATWEB89.04.257.2
         </select>
       </td>
          <td class=DataLabel>Provisional DRG</td>
      <td>
        <input type=text name=ptmis066 id=ptmis066 size=5 maxlength=4 
         tabindex=20 onblur='validateCode(5,ptmis066,drgdesc1)'
         value="%PATWEB89.04.140.0">
        <input type=text readonly name=drgdesc1 id=drgdesc1 size=45
         value="%PATWEB89.04.140.1" notab>
        <img src="../images/SearchIcon.gif" class=Icon
         title="Provisional DRG Search"
         onclick="DrgSearchFrame(ptmis066,drgdesc1)">
        <img src="../images/DiagnosisSearchIcon.gif" class=Icon
         title="Provisional DRG Search via MBS Code"
         onclick="DrgViaMBSSearchFrame(ptmis066,ptmis026,ptvis043,psex,page)">
      </td></tr>
    <tr><td class=DataLabel>Criteria for Admission</td>
    <td>
       <select name=ptvis041 tabindex=8 class=Mandatory title="Criteria for Admission">
       <option> </option>
       %PATWEB89.04.244.2
       </select>
    </td>
         <td class=DataLabel> Diet Code </td>
        <td>
           <select name=ptmis028 tabindex=21>
           <option> </option>
            %PATWEB89.04.127.2
            </select>
         </td></tr>
          <tr><td class=DataLabel>Care Type</td>
          <td>
            <select name=ptmis012 tabindex=9 class=Mandatory title="Care Type"
             onchange="displayRegime();">
            <option> </option>
               %PATWEB89.04.113.2
            </select>
   </td>
        <td class=DataLabel>Referring GP</td>
        <td><input type="text" size=10 maxlength=10 name=ptvis028 id=ptvis028 
         tabindex=22 value="%PATWEB89.04.231.1" class=Mandatory
         title="Referring GP"
onchange="ReadDoc(18,0,ptvis028,doctnam1,ptvis029,genpprac,ptvis030,genpprov);">
        <input type="text" size=25 readonly name=doctnam1 id=doctnam1
         value="%PATWEB89.04.231.0" class=Mandatory title="Referring GP">
        <img src="../images/SearchIcon.gif" class=Icon
onclick="GPHCPSearchFrame(ptvis028,doctnam1,genpprov,ptvis029,genpprac,ptvis030,0);">
        <img src="../images/gphead.gif" class=Icon
         onclick="DefaultPMIGP(pmirefgp,pmirefpr,pmirefcn);"
         title="Default GP and Practice from PMI">
      <input type=hidden name=pmirefgp id=pmirefgp value="%PATWEB89.04.884.001">
      <input type=hidden name=pmirefpr id=pmirefpr value="%PATWEB89.04.885.001">
      <input type=hidden name=pmirefcn id=pmirefcn value="%PATWEB89.04.861">
        </td>
      </tr>

      <tr><td class=DataLabel> Intended Stay </td>
      <td>
       <select name=ptvis043 id=ptvis043 tabindex=9 class=Mandatory title="Intended Stay">
          <option> </option>
          %PATWEB89.04.246.2
        </select>
      </td>
        <td class=DataLabel>Practice</td>
        <td><input type="text" name=genpprac id=genpprac size=35 readonly
                     value="%PATWEB89.04.232.0">
        <input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.04.232.1">
        <input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.04.233.1">
        <input type=hidden name=genpprov id=genpprov>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="GPHCGSearchFrame(ptvis028,doctnam1,genpprov,ptvis029,genpprac,ptvis030)">
        <img src="../images/erase.gif" class=Icon
        onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);">
        </td>
       </tr>

       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=10 title='Expected Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);" 
         value="%PATWEB89.04.129" tabindex=11>
        </td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 tabindex=23 title="Inform GP" class="Mandatory">
         <option value=" "></option>
         <option value="0">No</option>
         <option value="1">Yes</option>
        </select></td>
       </tr>

       <tr><td class=DataLabel>Discharge Intention</td>
           <td><select name=ptvis076 tabindex=11 title="Care Type"> 
                 <option> </option>
                 %PATWEB89.04.292.2
               </select>
           </td>
       <td class=DataLabel><div id=PCEHRTitleDIV></div></td>
       <td><select name=pmsvx125 tabindex=24 title="Upload to PCEHR">
           <option value=" "></option>
           <option value="0">No</option>
           <option value="1">Yes</option>
           </select>
       </td>
       </tr>
 
       <tr><td class=DataLabel>Palliative Care Status</td>
           <td><select name=ptvis077 tabindex=12 title="Care Type"> 
                 <option> </option>
                 %PATWEB89.04.293.2
               </select>
           </td>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=24>
          <option value="2">No</option>
          <option value="1">Yes</option>
         </select>
       </td>
       </tr>

       <tr><td class=DataLabel>Preferred Accommodation</td>
           <td><select name=ptvis093 tabindex=13 
                title="Preferred Accommodation">
                <option> </option>
                 %PATWEB89.04.298.012.2
                </select></td>

       <td>%STANDARD.01.017.U2</td>
         <td><select name=ptmis038 tabindex=27>
           <option></option>
            %PATWEB89.04.134.5
         </select></td>
       </tr>

       <tr><td class=DataLabel>Valuables Location</td>
           <td><input type="text" size=40 maxlength=40 name=ptvis020 
                tabindex=13 value="%PATWEB89.04.223"></td>
         <td width=15%> Informed Financial Consent </td>
         <td><select name=ptvis086 tabindex=27 class=Mandatory title="Informed Financial Consent">
          %PATWEB89.04.298.005.2
         </select></td>
       </tr>

<tr><td class=DataLabel>Admitting MBS</td>
    <td class=DataLabel>
    <input type=text name=ptmis026 id=ptmis026 size=10 maxlength=9 tabindex=13
     value="%PATWEB89.04.125"
     onblur="ValidateProvDRG(ptmis026,mbsdesc1,ptmis066,
                             ptvis043,psex,page,ptmis001);">
    <input type=text notab readonly name=mbsdesc1 id=mbsdesc1 size=35
     value="%PATWEB89.04.180">
    <img notab src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(ptmis026,mbsdesc1,ptmis001)"> </td>
      <td class=DataLabel>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099
         title="Program" tabindex=27 value="%PATWEB89.04.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=166
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.04.298.021.2
          </select></td>
    </tr>
     <tr><td class="DataLabel"><div id="ProgramIdTitle"></div></td>
         <td class="DataField"><div id="ProgramIdField"></div></td>
         <td class="DataLabel"></td>
         <td class="DataField"></td>
         <td class="DataLabel"></td>
         <td class="DataField"></td>
         </tr>


       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>
       <tr align=left>
         <td class=DataLabel>%STANDARD.01.017.CL</td>
         <td align=left>  
          <select name=ptmis027 tabindex=40 class=Mandatory 
                  title="%STANDARD.01.017.CL" onchange=setHF();>
          <option> </option>
          %PATWEB89.04.126.9.1.10.2.X
          </select>
         </td>

      <td class=DataLabel>Casepayment</td>
      <td><select name=ptmis075 tabindex=46 title="Casepayment">
          <option> </option>
           %PATWEB89.04.197.2
           </select>
         </td></tr>


  <tr><td class=DataLabel>%STANDARD.01.017.A </td>
    <td>
      <select name=ptmis010 tabindex=41 class=Mandatory
      title="%STANDARD.01.017.A " onchange="DisplayContract();">
      <option> </option>
      %PATWEB89.04.111.2
      </select>
    </td>

      <td class=DataLabel>Casemix Code</td>
      <td class=DataLabel>
        <input type=text name=ptmis073 id=ptmis073 size=10 maxlength=9 
         tabindex=47 value="%PATWEB89.04.198.2"
         onblur='validateCode(35,ptmis073,cmixdesc1,dummy)'>
        <input type=text notab readonly name=cmixdesc1 id=cmixdesc1 size=35
         value="%PATWEB89.04.198.1">
        <img notab src="../images/SearchIcon.gif" class=Icon
         onclick="CmixSearchFrame(ptmis073,cmixdesc1)">
      </td></tr>

<tr>
    <td class=DataLabel>Health Fund </td>
    <td colspan=2><input type=text size=6 maxlength=6 name=ptmis013 id=ptmis013
         title="Health Fund" tabindex=42
         onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);
                   checkTableadm();" value="%PATWEB89.04.114.0">
        <input type=text size=25 maxlength=30 name=funddesc id=funddesc 
         class=readonly Readonly notab value="%PATWEB89.04.114.1">
    Level
        <input name=ptmis014 id=ptmis014 size=8 maxlength=8
         tabindex=43 value="%PATWEB89.04.115.0"
         title="Level"
         onblur="validateHFT(20,ptmis013,ptmis014,funddesc,tabldesc);">
        <input type="text" size=15 maxlength=17 name=tabldesc id=tabldesc
         class=readonly Readonly notab value="%PATWEB89.04.115.1" >
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HealthFundSearchFrame(ptmis013,funddesc,ptmis014,tabldesc);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrDoc(ptmis013,ptmis014);clrDoc(funddesc,tabldesc);
                  checkTableadm();">
    </td>
</tr>

      <tr align=left>
        <td class=DataLabel>Member Number &nbsp; </td>
        <td class=DataLabel>
          <input type=text size=20 maxlength=19 tabindex=44
                 value="%PATWEB89.04.116" name='ptmis015'>
        </td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=48>
        </td>
        <td align=left> </td>
        <td align=left> </td>
        </td></tr>
<tr><td class=DataLabel>Continuous Billing</td>
    <td><select name=ptmis081 tabindex=27>
        <option> </option>
         %PATWEB89.04.199.014.2
        </select>
    </td>
</tr>


  <tr><td class=DataLabel>GST Applicable</td>
    <td>
      <select name=ptmis074 tabindex=45 class=Mandatory
      title="GST Applicable">
      <option> </option>
      %PATWEB89.04.189.2
      </select></td>
      <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td></tr>

  <tr><td><div id=UserNameHead></div></td>
      <td><div id=UserNameCode></div></td>
      <td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td></tr>

  <tr><td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td>
      <td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td></tr>

  <tr><td class=DataLabel><div id=Contrac2Heading></div></td>
      <td><div id=ContractId></div></td>
      <td><div id=RegimeHead4></div></td>
      <td><div id=RegimeCode4></div></td>
      </tr>

  <tr><td class=DataLabel><div id=ContractHeading></div></td>
      <td><div id=ContractType></div></td>
      <td class=DataLabel><div id=Contrac1Heading></div></td>
      <td><div id=ContractRole></div></td>
      </tr>

        <tr align=left>
          <td colspan=4 align=center><br>
           <input type=button value="Admit" class="button" tabindex=50
            id="pat89sub"
            onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis004.value,
                       UpdateForm.ptmis005.value,UpdateForm.ptmis001.value,
                       UpdateForm.ptmis030.value,UpdateForm.ptmis002.value,
                       UpdateForm.ptrgm001.value,UpdateForm.ptrgm002.value,
                       UpdateForm.ptrgm003.value,SubmitAdm)";>
           <input type=button value="Cancel" class="button" tabindex=60
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);"> 
      </table>
</td></tr>
</table>
</form>

<div id=SelectHeading></div>
<div id=SelectLocation></div>
</div>

<form name=linkForm action=patweb89.pbl method=POST>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.101">
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.081">
<input type=hidden name=MenuType value="%PATWEB89.04.088">
<input type=hidden name=ptmis027 value="%PATWEB89.04.126.0">
<input type=hidden name=admisflg value="1">
<input type=hidden name=ptcnbman value="%STANDARD.01.025.112.107.0.1">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=18
         onblur="checkDate(this,'ReferralDate')">
         <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
  <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=19
         onblur="checkDate(this,'SpecConDate')">
    <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 size=5 maxlength=4 tabindex=20>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<span id=PCEHRTitleSPAN style="display:none">
Upload to PCEHR
</span>

<script type="text/javascript">
for (var i=0;i<document.UpdateForm.ptmis004.length;i++){
if (document.UpdateForm.ptmis004.options[i].value=="%PATWEB89.04.158"){
    document.UpdateForm.ptmis004.selectedIndex=i}};
/* 0894695
for (var i=0;i<document.UpdateForm.ptvis022.length;i++) {
  if (document.UpdateForm.ptvis022.options[i].value=="%PATWEB89.04.225.0"){
    document.UpdateForm.ptvis022.selectedIndex=i;
  }
}
*/
  CasePaym="%PATWEB89.04.197.1"
  if(CasePaym=="Yes"){
    CasePaym="1"
  }
 if(CasePaym=="No "){
    CasePaym="0";
  }
  for (var i =0 ; i < document.UpdateForm.ptmis075.length; i++) {
    if (document.UpdateForm.ptmis075.options[i].value==CasePaym.substr(0,1)) {
       document.UpdateForm.ptmis075.selectedIndex=i } };

  document.UpdateForm.ptmas046.value =
    document.UpdateForm.alrtsind.value.substr(10,1);

  RelVisit="%PATWEB89.04.118.1"
  if (RelVisit=="Yes") {
    RelVisit="1"
  }
  if (RelVisit=="No ") {
    RelVisit="0";
  }

  for (var i =0 ; i < document.UpdateForm.ptmis017.length; i++) {
    if (document.UpdateForm.ptmis017.options[i].value==RelVisit.substr(0,1)) {
       document.UpdateForm.ptmis017.selectedIndex=i } };

  if ((VariableNameExists('ScreenLabelMyHRConsent'))&&
      (ScreenLabelMyHRConsent!="")){
    document.getElementById("PCEHRTitleSPAN").innerHTML =
    ScreenLabelMyHRConsent;
    document.UpdateForm.pmsvx125.title = ScreenLabelMyHRConsent;
  }
  PCEHRTitleDIV.innerHTML=PCEHRTitleSPAN.innerHTML;

/* 0894695
 PCEHR=trim("%PATWEB89.04.298.037");
 for (var i=0;i<document.UpdateForm.pmsvx125.length;i++){
 if (document.UpdateForm.pmsvx125.options[i].value==PCEHR){
     document.UpdateForm.pmsvx125.selectedIndex=i}};
*/
var p = document.UpdateForm;

var informGP = "%PATWEB89.04.225.0";      //ptvis022
valInformGP2(p.ptvis022,informGP,p.ptcndigp.value);

var PCEHR = trim("%PATWEB89.04.298.037"); //pmsvx125/ptvis115
valMYHR2(p.pmsvx125,PCEHR,p.ptcndumh.value);
 if (p.ptcndumh.value > 2){
      p.pmsvx125.className="Mandatory";}
   else{
      p.pmsvx125.className="";}

</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
 <td><input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc 
      class=Mandatory title="Transfer Source" tabindex=5
      value="%PATWEB89.04.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc id=trandesc notab
      class=Readonly readonly value="%PATWEB89.04.193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=regimehd1 style="display:none">
<td class=DataLabel>Regime Code 1</td>
</span>
<span id=regimecod1 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm001 id=ptrgm001 tabindex=33 
     onblur=validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);
     value="%PATWEB89.04.973. 1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm001,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm001,dummy);">
</td>
</span>

<span id=regimehd2 style="display:none">
<td class=DataLabel>Regime Code 2</td>
</span>
<span id=regimecod2 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm002 id=ptrgm002 tabindex=33 
     onblur=validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);
     value="%PATWEB89.04.973. 2">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm002,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm002,dummy);">
</td>
</span>

<span id=regimehd3 style="display:none">
<td class=DataLabel>Regime Code 3</td>
</span>
<span id=regimecod3 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm003 id=ptrgm003 tabindex=33
     onblur=validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);
     value="%PATWEB89.04.973. 3">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm003,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm003,dummy);">
</td>
</span>

<span id=regimeblank1 style="display:none">
<td><input type=hidden name=ptrgm001 id=ptrgm001 value=""></td>
</span>

<span id=regimeblank2 style="display:none">
<td><input type=hidden name=ptrgm002 id=ptrgm002 value=""></td>
</span>

<span id=regimeblank3 style="display:none">
<td><input type=hidden name=ptrgm003 id=ptrgm003 value=""></td>
</span>

<span id=usernamehd style="display:none">
<td class=DataLabel>User Name</td>
</span>       
                       
<span id=usernamcd style="display:none">
<td><input size=12 type=text name=username class=Mandatory title="UserName">
</td>                  
</span>
             
<span id=passwordhd style="display:none">
<td class=DataLabel>Password</td>
</span>

<span id=passwordcd style="display:none">
<td><input size=12 type=password name=password onblur=checkPass(); class=Mandatory
     title="Password"></td>
</span>

<span id=contracthd style="display:none">
Contract Type
</span>

<span id=contracrhd style="display:none">
Contract Role
</span>

<span id=contracihd style="display:none">
 Contract Id
</span>

<span id=contractid style="display:none">
  <select name=ptasf003 title="Contract Spoke Id" class=Mandatory
   tabindex=25>
  <option> </option>
   %PATWEB89.04.199.003
  </select>
</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.04.199.001" tabindex=26
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContTypeAlert();">
</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.04.199.002"
   title="Contract Role" tabindex=27
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContRoleAlert();">
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<span id=regimeblank4 style="display:none">
<td><input type=hidden name=ptmis057 value=""></td>
</span>

<span id=regimehd4 style="display:none">
<td class=DataLabel>%STANDARD.01.035.DA</td>
</span>
<span id=regimecod4 style="display:none">
<td><select name=ptmis057 title="%STANDARD.01.035.DA">
   <option></option>
    %PATWEB89.04.148.2
   </select>
</td>
</span>
<span id=bookingdet style="display:none">
       <br>Expected Booking Time:<b>%PATWEB89.04.707</b>
       <input type=checkbox name=d_keepbktm value=1>Keep Booking Time</td>
</span>
<span id=nobookingdet style="display:none">
       <input type=hidden name=d_keepbktm value=0></td>
</span>

<span id="ShowProgramIdTitle" style="display:none">
 %STANDARD.01.035.PK
</span>

<span id="ShowProgramIdField" style="display:none">
  <select name=ptvis110 title="%STANDARD.01.035.PK" tabindex=15
   id="ptvis110" class="">
    <option> </option>
    %PATWEB89.04.298.033.2
  </select>
</span>

<script type="text/javascript">
if ("%PATWEB89.04.905" == "1") {
  alert("Warning: Patient is currently admitted");
}
</script>
