<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="pacific">
<meta name="HelpFileName" content="NoContextSet.html">
<script language="javascript" src="../js/allweb02.js"></script>
<script language="javascript" src="../js/allweb0203.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function SetPrinter(Nolabel,SelectList) {
 if (SelectList.className=="Mandatory SelectBig") {
     SelectList.className="SelectBig" }
 else {
     SelectList.className="Mandatory SelectBig" }

 if(Nolabel!=undefined) {
   if (Nolabel.className=="Mandatory") {
       Nolabel.className="" }
   else {
       Nolabel.className="Mandatory" }
   }
}
function SetList() {
  p=AddForm
  p.alref106.options.length=1;
  SetClinicType(p.alref106,p.defctype.value,p.alref119.value);
//
  SetList2();
}
function SetList2() {
  p=AddForm
  p.alref120.options.length=1;
  SetTypeClinic(p.alref120,p.deftclid.value,p.alref119.value,p.alref106.value);
}
//------------------------------------------------------------
// Set Link ACC Redirect and Return program after link ACC
//------------------------------------------------------------
function SetLinkACC(CurForm,ReturnCd) {
  if ((CurForm.ptcnueoc.value==1)&&(CurForm.alref035.value.substr(5,1)=='A')) {
       CurForm.redirect.value="eocweb01.pbl?reportno=01&template=006"
             + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
             + '&returncd=' + ReturnCd
             + "&admissno=";
  }
  if (CurForm.alref035.value.substr(3,1)=='W') {
       CurForm.redirect.value="patweb89.pbl?reportno=01&template=005"
             + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
             + '&returncd=' + ReturnCd
             + "&admissno=" + CurForm.admissno.value.replace(/ /g,"+")
  }
} //end SetLinkACC
function AddReferral(theForm) {
  window.PageAddForm=theForm
  theForm.target="PopUpFrame1";
  if (validateMandatory(theForm)) {
    SetLinkACC(theForm,"AH1");
    theForm.submit(); }
}
function valClaimCode() {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.alref035.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.alref035.options[i].value.substr(0,3))){
          document.AddForm.alref035.selectedIndex=i;
    }
  }
}
function SetSite() {
  p=AddForm
  var SetSite
  if(isWhitespace(p.alref119.value)) {
    SetSite=p.wbsesite.value;
  } else {
    SetSite=p.alref119.value;
  }
 for (var i =0 ; i < document.AddForm.alref119.length; i++) {
  if (document.AddForm.alref119.options[i].value==SetSite.substr(0,6)) {
       document.AddForm.alref119.selectedIndex=i } };
  SetList();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);valClaimCode();SetSite();DisplayTrnSrc();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
%ALLWEB02.03.125.0  Referral
</span>
<div id=PageBodySection style="overflow: auto;">
<table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
<form name=AddForm action="allweb02.pbl" method=post
 onsubmit='return validateMandatory(AddForm);' >
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="A">
<input type=hidden name=nextpage value="5">
<input type=hidden name=redirect value="%ALLWEB02.03.001.allweb02.02.001">
<input type=hidden name=urnumber value="%ALLWEB02.03.003">
<input type=hidden name=admissno value="%ALLWEB02.03.081">
<input type=hidden name=MenuType value="%ALLWEB02.03.088">
<input type=hidden name=deptcode value="%ALLWEB02.03.125.1">
<input type=hidden name=uservari value="%ALLWEB02.03.113">
<input type=hidden name=override value="2">
<input type=hidden name=mehrflag value="1">
<input type=hidden name=usermemr value="">
<input type=hidden name=alref089 value=" ">
<input type=hidden name=dummy>
<input type="hidden" name="mvmedrec">
<input type="hidden" name="claimc">
<input type=hidden name=ptcnueoc value="%ALLWEB02.03.203">
<input type=hidden name=sacsvisn value="%ALLWEB02.03.207">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=hcpprovno value="">
<input type=hidden name=defctype value="">
<input type=hidden name=deftclid value="">
<input type=hidden name=pmpmi059 value="%ALLWEB02.03.484.001">
<input type=hidden name=pmpmi060 value="%ALLWEB02.03.485.001">
<input type=hidden name=pmpmi061 value="%ALLWEB02.03.461">
<input type=hidden name=catAO value="AO">
<input type=hidden name=d_alref141 value="">

<tr><td class=DataLabel>Date of Referral</td>
    <td class=DataField>
    <input type=text name=alref019 size=12 tabindex=1
     onblur="checkDate(this,'Date')"
     class= "Mandatory PastDate" title="Date of Referral">
    <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.alref019
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=AddForm.alref019>
    </td>
    <td class=DataLabel>Department Code</td>
    <td><input name=allrf001 type=text value="%ALLWEB02.03.125.0" readonly
         class=Readonly notab></td>
    </tr>

<tr><td class=DataLabel>Date Letter Received</td>
    <td><input type=text name=alref039 size=12 class="Mandatory PastDate"
         value="%STANDARD.01.015" onblur="checkDate(this,'Date')"
         title="Date Letter Received" tabindex=2>
        <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
         date=AddForm.alref039 time=null>
        <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
         date=AddForm.alref039>
    </td>
    <td class=DataLabel>Link to Visit</td>
    <td><input type=text size=10 maxlength=8 name=alref005 tabindex=20
         onblur="justifyRight(this);
                ValidateVisit(AddForm.alref005,AddForm.urnumber,dummy);" >
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="VisitSearchFrame(AddForm.urnumber,AddForm.alref005);">
    </td>
    </tr>

<tr><td class=DataLabel>Referral Source</td>
    <td><select title="Referral Source" name=alref034 tabindex=3
         class="Mandatory SelectBig" onchange="DisplayTrnSrc();">
	<option></option>
	 %ALLWEB02.03.134.2
	</select></td>
    <td><div id=TranSrcHeading></div>
        <td><div id=TranSrc></div></td>
    </tr>

<tr><td class=DataLabel width=10%>Referring HCP</td>
   <td width=40%><input type=text name=alref022 size=10 maxlength=10 tabindex=4
       value="" class=Mandatory title="Referring HCP"
       onchange="UpCase(this);ReadDoc(18,0,alref022,n_alref022,dummy,dummy,dummy,dummy);">
       <input type=text name=n_alref022 size=30 readonly title="HCP Name"
        class=Readonly value="">
       <img src="../images/SearchIcon.gif" class=Icon
      onclick="GPHCPSearchFrame(alref022,n_alref022,dummy,dummy,dummy,dummy,0);">
       <img src="../images/ClearIcon.gif" class=Icon
        onclick='clrFields(AddForm.alref022,AddForm.n_alref022,AddForm.dummy);'>
    </td>
<!--
    <td class=DataLabel>Retain as Usual GP?</td>
    <td><input type=checkbox value="0" name=rusualgp tabindex=4
        title="Retain as Usual GP" onclick="UpdateGP();"></td>
-->
    </tr>

        <input type=hidden name=dummy>
<!--
<tr><td class=DataLabel>HCP Practice</td>
    <td><input type=text size=10 class=readonly value=""
         title="HCP Practice" readonly notab name=alref023>
        <input type=text size=30 class=readonly value=""
         title="Practice Name" readonly notab name=n_alref023>
        <input type=hidden name=alref024
         title="Practice Count" value="%ALLWEB02.03.461">
        <img src="../images/SearchIcon.gif" class=Icon
         onClick="GPHCGSearchFrame(alref022,n_alref022,hcpprovno,alref023,n_alref023,alref024)">
        <img src="../images/erase.gif" class=Icon onClick="clrFields(alref023,n_alref023,alref024,hcpprovno);"></td>
-->
<tr><td class=DataLabel>
    <script type="text/javascript">MRDescription()</script>
    </td>
    <td><input type=checkbox name=alref083
         value="1" tabindex=35>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.RI</td>
    <td><select name=alref124 title="%STANDARD.01.017.RI" tabindex=6
         class=Mandatory>
        <option></option>
         %ALLWEB02.03.186.2
        </select>
    </td>
    <td class=DataLabel>Reason for Referral</td>
    <td><input type=text size=42 maxlength=60 name=alref088
         tabindex=25></td>
    </tr>

<tr><td class=DataLabel>Problem 1</td>
    <td><select title="Problem 1" name=alref028 tabindex=7
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.128.2
        </select></td>
    <td class=DataLabel>Diagnosis 1</td>
    <td><input type=text name=alref031 title="Diagnosis 1" size=12 tabindex=26
         maxlength=8 onblur="validateAHDiag(deptcode,alref031,d_alref031);">
        <input type=text name=d_alref031 title="Diagnosis 1" size=25
         class=Readonly readonly notab>
        <img src="../images/SearchIcon.gif" class=Icon
        onClick="AHDiagSearchFrame(deptcode,alref031,d_alref031);">
        <img src="../images/ClearIcon.gif" class=Icon
        onClick="clrFields(alref031,d_alref031);">
        </td>
    </tr>

<tr><td class=DataLabel>Problem 2</td>
    <td><select title="Problem 2" name=alref029 tabindex=8
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.129.2
        </select></td>
    <td class=DataLabel>Diagnosis 2</td>
    <td><input type=text name=alref032 title="Diagnosis 1" size=12 tabindex=27
         maxlength=8 onblur="validateAHDiag(deptcode,alref032,d_alref032);">
        <input type=text name=d_alref032 title="Diagnosis 2" size=25
         class=Readonly readonly notab>
        <img src="../images/SearchIcon.gif" class=Icon
        onClick="AHDiagSearchFrame(deptcode,alref032,d_alref032);">
        <img src="../images/ClearIcon.gif" class=Icon
        onClick="clrFields(alref032,d_alref032);">
        </td>
    </tr>

<tr><td class=DataLabel>Problem 3</td>
    <td><select title="Problem 3" name=alref030 tabindex=9
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.130.2
        </select></td>
    <td class=DataLabel>Diagnosis 3</td>
    <td><input type=text name=alref033 title="Diagnosis 3" size=12 tabindex=28
         maxlength=8 onblur="validateAHDiag(deptcode,alref033,d_alref033);">
        <input type=text name=d_alref033 title="Diagnosis 1" size=25
         class=Readonly readonly notab>
        <img src="../images/SearchIcon.gif" class=Icon
        onClick="AHDiagSearchFrame(deptcode,alref033,d_alref033);">
        <img src="../images/ClearIcon.gif" class=Icon
        onClick="clrFields(alref033,d_alref033);">
        </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select title="%STANDARD.01.017.CL" name=alref035 tabindex=10
         class="Mandatory SelectBig">
        <option></option>
         %ALLWEB02.03.135.2
        </select></td>
<!--
    <td class=DataLabel>Score</td>
    <td><input type=text name=alref143 title="Score" size=5 maxlength=5
         tabindex=29></td>
-->
    </tr>

<!--
<tr><td class=DataLabel>%ALLWEB02.03.199.011.8</td>
    <td><select title="%ALLWEB02.03.199.011.8" name=alref140 tabindex=11
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.199.011.2
        </select></td>
    <td class=DataLabel>%ALLWEB02.03.199.013.8</td>
    <td><select title="%ALLWEB02.03.199.013.8" name=alref142 tabindex=30
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.199.013.2
        </select></td>
    </tr>
-->

<tr><td colspan=4><hr></td></tr>

<tr><td class=DataLabel>Preferred Site</td>
    <td class=DataField><select name=alref119 title="Preferred Site"
      tabindex=50 class="SelectBig" onchange="SetList();">
      <option></option>
      %ALLWEB02.03.182.2
    </select>
    </td>
    <td class=DataLabel>Priority</td>
    <td><select title="Priority" name=alref027 class="SelectBig" tabindex=70
       onchange="selectCatCodInd(catAO,alref141,d_alref141,alref027,'1','1');">
        <option></option>
        %ALLWEB02.03.127.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Clinic Type </td>
    <td><select class=SelectBig name=alref106 maxlength=45 tabindex=51
         class="SelectBig" title="Clinic Type" onchange="SetList2();">
        <option></option>
        </select></td>
    <td>Date of Priority</td>
    <td><input type=text name=alref127 size=12 tabindex=71
         onblur="checkDate(this,'Date')" value=""
         title="Date of Priority">
        <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
         date=AddForm.alref127 time=null>
        <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
         date=AddForm.alref127></td>
    </tr>

<tr><tr><td class=DataLabel>Clinic ID</td>
    <td><select name=alref120 title="Clinic ID" class="SelectBig" tabindex=52>
        <option></option>
        </select></td>
    <td>Must Be Seen By Date</td>
    <td><input type=text name=alref126 size=12 tabindex=72
         onblur="checkDate(this,'Date')" value=""
         title="Must Be Seen By Date">
        <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
         date=AddForm.alref126 time=null>
        <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
         date=AddForm.alref126></td>
    </tr>

<tr><td class=DataLabel width=10%>Slot Type</td>
    <td><select name=alref117 class=SelectBig title="Slot Type" tabindex=53>
        <option></option>
         %ALLWEB02.03.180.2
        </select>
    </td>
    <td class=DataLabel>Prioritising HCP</td>
    <td><input type=text name=alref084 size=10 maxlength=10
         tabindex=73 title="Prioritising HCP"
         onblur="UpCase(this);ValidateHCP(18,14,alref084,n_alref084);">
        <input type=text name=n_alref084 size=30 readonly notab
         title="Prioritising HCP" class=Readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.alref084,AddForm.n_alref084,1);">
        <img src="../images/ClearIcon.gif" class=Icon
        onClick="clrFields(alref084,n_alref084);">
        </td>
    </tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text name=alref038 size=10 maxlength=10
	 value="%ALLWEB02.03.138.1" class=Mandatory tabindex=54
          onblur="UpCase(this);ValidateHCP(18,14,alref038,n_alref038);">
	<input type=text name=n_alref038 size=30 readonly title="HCP Name"
	 value="%ALLWEB02.03.138.0" class=Readonly>
	<img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.alref038,AddForm.n_alref038,1);">
        <img src="../images/ClearIcon.gif" class=Icon
        onClick="clrFields(alref038,n_alref038);">
	</td>
    <td class=DataLabel>%ALLWEB02.03.199.012.8</td>
    <td><select title="%ALLWEB02.03.199.012.8" name=alref141 tabindex=74
         class="SelectBig">
        <option></option>
        </select></td>
    </tr>

<tr><td class=DataLabel>Case Team</td>
    <td><input type=text name=alref087 size=11 maxlength=10 title="Case Team"
        onblur="validateCode2(7,alref087,n_alref087)" tabindex=55>
       <input type=text name=n_alref087 size=29 readonly 
        class=Readonly tabindex=-1 title="Team Description">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="TeamSearchFrame(alref087,n_alref087)">
        <img src="../images/ClearIcon.gif" class=Icon
        onClick="clrFields(alref087,n_alref087);">
       </td>
    <td class=DataLabel>Activate Referral</td>
    <td><input type=checkbox name=alref003 value="1" title="Activate Referral" 
         tabindex=75>
    </td></tr>
<!--
<tr><td class=DataLabel colspan=2>Print New Referral Letter to Patient &nbsp;&nbsp;
      <input type=checkbox name=prtnewpt tabindex=80
       title="New Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl01 tabindex=81>
      %STANDARD.01.001.ALLNEWPT.01
      </select></td></tr>
<tr><td class=DataLabel colspan=2>Print New Referral Letter to Referrer
      <input type=checkbox name=prtnewrf tabindex=82
       title="New Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl02 tabindex=83>
      %STANDARD.01.001.ALLNEWRF.01
      </select></td></tr>

<tr><td class=DataLabel colspan=2>Referral Labels
    <input type=checkbox value="1" name=prtreflb width=30% tabindex=84
        onclick="SetPrinter(AddForm.prtpno07,AddForm.prtpsl07);">
    Copies
    <select name=prtpno07 width=20% tabindex=85>
        %STANDARD.01.027.2.1
    </select></td>


  <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=prtpsl07 title="Printer" width=15%
         tabindex=86>
        <option></option>
        %STANDARD.01.001.LABELALL.01
        </select></td></tr>
-->

<tr><td colspan=4 align=center><br>
    <input type=button name=formactn value="Add" class="button"
    onclick="tempDisable(this);AddReferral(AddForm);" tabindex=90>
    <input type=button Value="Cancel" class="button" 
     onClick="DFrameCloseRefresh();" tabindex=91>
    </td></tr>
</table>
</form>

<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>

<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=aldad001 class=Mandatory
      title="Transfer Source" tabindex=5
      onchange="validateCode(9,aldad001,trandesc);">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif"
      onClick="TransferSourceFrame(aldad001,trandesc,alref034)"></td>
</tr>
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=aldad001>
</span>
