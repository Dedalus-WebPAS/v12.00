<meta name="TemplateVersion" content="V11.00.00">
<meta name="TemplateHome" content="pacific">
<meta name="HelpFileName" content="NoContextSet.html">
<script language="JavaScript" src="../js/preadmission.js">    </script>
<script language="JavaScript">    
function SetWardBed() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     if(document.UpdateForm.ibcnmhos.value!="1") {
       document.UpdateForm.ptmis068.className="Mandatory";
     }
  } else {
     document.UpdateForm.admitbox.value="0";
     if(document.UpdateForm.ibcnmhos.value!="1") {
       UpdateForm.ptmis068.className="";
     }
  }
}
function SubmitAdm() {
    p=document.UpdateForm
    validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
    if(p.datefrom.value!='0'){
      if(p.admitbox.value=="1"){
         document.UpdateForm.admitbox.value="0";
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
               "\tPatient will not be admitted");
         }else{
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);}
         if (ans!=true) {
            return;
         } 
    }
  document.UpdateForm.ptmis004.value = document.UpdateForm.ptmis068.value;
  document.UpdateForm.ptmis005.value = document.UpdateForm.ptmis076.value;
  if (document.UpdateForm.admitbox.value == "1") {
     document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=";
  }
  else {
    document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=001"
    + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
    + "&admissno=";
  }
  SetLinkACC(UpdateForm,"PRE");
  SubmitHidden(UpdateForm);
}
function valClaimCode() {
  if(document.UpdateForm.nwbclaim.value!=""){
     return;}
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
//    alert(UpdateForm.ptmis027.options[i].value.substr(0,3));
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event); valClaimCode();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<form name=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
</form>
<form name=Lookup action=patweb94.pbl method=post>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=1>
<input type=hidden name=valcateg>
<input type=hidden name=valdtype>
<input type=hidden name=valdcode>
</form>
<form name=UpdateForm method=post onSubmit='return validateMandatory(this);'>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="reportno" value="2">
<input type="hidden" name="redirect">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptcnueoc" value="%PATWEB89.03.925">
<input type="hidden" name="claimc">
<input type="hidden" name="nwbclaim" value="%PATWEB89.03.126.1">
<input type="hidden" name="datefrom">
<input type="hidden" name="dateto">
<input type="hidden" name="exstward" value="%PATWEB89.03.449.1">
<input type="hidden" name="ptcnhpcd" value="%PATWEB89.03.930">
<input type=hidden name=residadm value="%PATWEB89.03.959">
<input type=hidden name=refvisno value="%PATWEB89.03.960">
<input type=hidden name="refrdate" value="%PATWEB89.03.999.101">
<input type="hidden" name="ptcnbage" value="%STANDARD.01.025.021.046.1.3">
<input type="hidden" name="pbdate"   value="%PATWEB89.03.020">
<input type="hidden" name="ibcnmhos" value="%STANDARD.01.025.000.043.1.1">

<tr><td class=HeadingCell align=center colspan=2>
    Patient Pre-Admission Details (New) </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=2 cellspacing=2>
<tr><td width=50%>
    <table width=100% border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 tabindex=1 
              class=Mandatory title="Admission Date" value="%STANDARD.01.015" 
      onBlur="checkDate(this,'AdmissionDate');ShowAdmissionWeight(UpdateForm);">
         <img notab src=../images/CalendarLookup.gif border=0 hspace=4
          align=absmiddle onclick="DateLookupFrame(ptmis001);">     
          Time <input type=text name=ptmis002 size=8 tabindex=2 
               value="%STANDARD.01.016" class="Mandatory" 
               title="Admission Time" onBlur="checkTime(this,'AdmissionTime');">
        <img notab src=../images/DateTimeStamp.gif border=0 hspace=4 
         align=absmiddle onClick="SetCurrentDateTime(null,ptmis002);">
       <img notab src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
        onclick="TimeLookupFrame(ptmis002);">
          </td></tr>
      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
       <td><select name=ptmis011 tabindex=3 class=Mandatory title="%STANDARD.01.017.P " 
               onChange="displayDiv(ptmis011,'PT');">
              <option> </option>
               %PATWEB89.03.112.4
              </select></tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 tabindex=4 onchange="DisplayTrnSrc()"
               class="Mandatory" title="Referral Source">
                 <option> </option>
                 %PATWEB89.03.110.2
                 </select></td></tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>

<tr><td class=DataLabel>Referring HCP</td>
    <td><input type="text" size=10 maxlength=10 name=ptvis028 tabindex=5
         value="%PATWEB89.03.884.001"
      onchange="ReadDoc(18,0,ptvis028,genpname,dummy,dummy,dummy,dummy);">
        <input type=text size=25 notab readonly name=genpname
         value="%PATWEB89.03.884.081">
        <img src="../images/SearchIcon.gif"
        onClick="GPHCPSearchFrame(ptvis028,genpname,dummy,dummy,dummy,dummy,0)">
       <img src="../images/erase.gif" align=absmiddle onClick="clrFields(ptvis028,genpname);"></td></tr>

          <input type=hidden name=dummy>
<!--
<tr><td class=DataLabel>Practice</td>
    <td><input type=text name=genpprac size=35 readonly 
         value="%PATWEB89.03.885.005" >
          <input type=hidden name=ptvis029 value="%PATWEB89.03.885.001">
          <input type=hidden name=ptvis030 value="%PATWEB89.03.861">
          <input type=hidden name=genpprov>
          <img src="../images/SearchIcon.gif"
      onClick="GPHCGSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030)">
    <img src="../images/erase.gif" align=absmiddle onClick="clrFields(ptvis029,genpprac,ptvis030,genpprov);"></td>
    </tr>
-->

      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 tabindex=6>
                <option> </option>
                 %PATWEB89.03.138.2
              </select></td></tr>     

      <tr><td class=DataLabel>Admission Type</td>
          <td><select name=ptmis012 tabindex=7 class="Mandatory" title="Admission Type"   
               onChange="displayDiv(ptmis012,'AT');">
                <option> </option>
                 %PATWEB89.03.113.2
              </select></td></tr>

      <tr><td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=8
               onBlur="UpCase(this); validateCode(3,ptmis007,doctnam2)"
               class="Mandatory" title="Admitting Doctor"
               value="%PATWEB89.03.108.003">
              <input type=text readonly size=25 notab name=doctnam2
               value="%PATWEB89.03.108.002">
              <img notab src="../images/SearchIcon.gif"
               onClick="DoctorSearchFrame(ptmis007,doctnam2)"> 
          </td>
            
      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <input type=hidden name=admiscat value="A ">
          <td><!--<input type=text name=ptmis010 size=5 maxlength=3 tabindex=9
              onBlur="UpCase(this); validateCatCode(admiscat,ptmis010,specialt);">-->
              <select name=ptmis010 tabindex=9
               title="%STANDARD.01.017.A " class="Mandatory"
              >
              <option> </option>
                 %PATWEB89.03.111.2
              </select>
          <!--<img notab src=../images/SelectNote.gif border=0 
               onclick="LookupPage(ptmis010,specialt,'Lookup_spec0000_000')">-->
          </td></tr>
      <tr><td>&nbsp;</td>
          <td><!--<input type=text readonly notab name=specialt size=30 maxlength=45
               value="">-->
          </td></tr>

<!--
      <tr><td class=DataLabel>Provisional DRG</td>
          <td class=DataLabel>
	      <input type=text name=ptmis066 size=5 maxlength=4 tabindex=10
               onblur='validateCode(5,ptmis066,drgdesc1)'>
              <img notab src="../images/SearchIcon.gif" 
               onClick="DrgSearchFrame(ptmis066,drgdesc1)">
               </td></tr>
      <tr><td>&nbsp;</td>
          <td><input type=text notab readonly name=drgdesc1 size=45 value="">
          </td></tr>
-->
     <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
          <td><select name=ptmis027 title="%STANDARD.01.017.CL" class="Mandatory"
               tabindex=22>
                <option> </option>
                 %PATWEB89.03.126.2
              </select>
           </td>
         </tr>
      <tr><td class=DataLabel>Admit Now</td>
          <td><input type=checkbox value="0" name="admitbox" onClick="SetWardBed();"></td>

</table>
</td> 
<!-- close left cell -->
<!-- open right cell -->
<td width=50%>
    <table width=100% border=0 class=TableBody cellpadding=0 cellspacing=0>
      <tr><td class=DataLabel>Diagnosis </td>
          <td><input tabindex=12 type=text name="ptmis020" size=50 maxlength=80>
          </td></tr>
      <tr><td>&nbsp;</td>
          <td><input tabindex=13 type=text name="ptmis021" size=50 maxlength=50>
          </td></tr>

<!--
      <tr><td class=DataLabel>Operator ID</td>
          <input type=hidden name=userdef3 value="U3">
        <td><input type=password name=ptmis039 tabindex=14 size=3 maxlength=3
              onChange="UpCase(this); validateCatCode(userdef3,ptmis039,operator)"
              class="Mandatory" title="Operator ID">
              <input type=text readonly name=operator size=20 value="">
	 </td></tr>
-->

<!--
      <tr><td class=DataLabel>Hospital</td>
          <td><select name="ptmis013" tabindex=15 class="Mandatory"
                      title="Hospital">
            <option> </option>
            %PATWEB89.03.114.2
          </select></td></tr>

      <tr><td class=DataLabel>Purchasing RHA</td>
          <td><select name="ptmis060" tabindex=16 class="Mandatory" title="Purchasing RHA">
            <option> </option>
            %PATWEB89.03.151.2
          </select>
         </td></tr>

      <tr><td class=DataLabel>Health Agency</td>
          <td><select name="ptmis061" tabindex=17 class="Mandatory" title="Health Agency">
            <option> </option>
            %PATWEB89.03.152.4
          </select>
          </td></tr>

-->
      <tr><td>Admitting Point</td>
       <td><select name=ptvis046 tabindex=18 title="Admitting Point"
                   onChange="defaultWard()">
           <option></option>
            %PATWEB89.03.290.2
         </select></td></tr>

     <tr><td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1>
           <input type=hidden name=ptmis004>
           <input type=hidden name=ptmis005 title="Bed">
           <input type=hidden name=warddesc>
           <select name=ptmis068 tabindex=19 >
            <option value="" title=Ward> </option>
            %PATWEB89.03.449.2
           <select>
           <input type=text name=ptmis076 maxlength=3 size=3 title="Bed"
            onChange="UpCase(this);">
           <img notab src=../images/SearchIcon.gif border=0 vspace=1
            onClick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td></tr>
     <tr><td class=DataLabel> Planned Length of Stay</td>
         <td><input type=text size=5 maxlength=5 name=ptmis030
              tabindex=22 title='Expected Length of Stay'
              class=Integer onblur="checkInteger(this,this.value);">
         </td></tr>
      <tr><td class=DataLabel>Diet</td>
          <td><select name=ptmis028>
              <option></option>
              %PATWEB89.03.065.2 
              </select>
          </td></tr>

      <tr><td colspan=2 rowspan=6>
          <table width=100% border=0> 
           <tr><td>
           <span id=BabyAge style="display:none">
             <table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
               <tr><td class=DataLabel width=37%>Admission Weight</td>
               <td><input type=text name=ptmis051 size=5 maxlength=4 value="" 
                    tabindex=20
                    title="Admission Weight" >grams</td>
               </tr>
             </table>
           </span>
           </td></tr>
           <tr><td>
           <span id=NewBorn style="display:none">
             <table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
               <input type=hidden name=userdef5 value="U5">
               <tr><td class=DataLabel width=37%>Gestation Period</td>
               <td><select name=ptmis077 title="Gestation Period">
                   <option></option>
                   %PATWEB89.03.199.006.2
                   </select>
             </td></tr>
             </table>
           </span>
           </td></tr>
          <tr><td rowspan=2>
          <span id=WaitingList style="display:none">
            <table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
              <tr><td class=DataLabel width=37%>Date of Referral</td>
              <td><input type=text size=12 name=ptmis058 tabindex=22 value=""
                   onBlur="checkDate(this,'ReferralDate')">
              <img notab src=../images/CalendarLookup.gif border=0 hspace=4
                   align=absmiddle onclick="DateLookupFrame(ptmis058);"></td></tr>
              <tr><td class=DataLabel>Date of 1st Spec Consult</td>
              <td><input type=text size=12 name=ptmis059 tabindex=23  value=""
                   onBlur="checkDate(this,'SpecConDate')">
              <img notab src=../images/CalendarLookup.gif border=0 hspace=4
                   align=absmiddle onclick="DateLookupFrame(ptmis059);"></td></tr>
             </table>
           </span>
           </td></tr>
          </table>
          </td></tr>

</table>
</td><!-- close right cell -->
</tr>

      <tr align=center>
       <td align=center colspan=4><br>
       <input type=button value="Ok" class="button" tabindex=24
         id="pat89sub"
         onclick="tempDisable(this);
           if(checkAdmissionDate()){
             checkBedStatus(ptmis068.value,ptmis076.value,
                            ptmis001.value,ptmis030.value,
                            SubmitAdm);}";></td></tr>
     </form>
    </table>
</td></tr>
</table>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType value="%PATWEB89.03.088">
</form>
<script language="javascript">
//
//for (var i=0;i<document.UpdateForm.ptmis060.length;i++){
//if (document.UpdateForm.ptmis060.options[i].value.substr(0,3)==
//    document.UpdateForm.ptcnhpcd.value){
//    document.UpdateForm.ptmis060.selectedIndex=i}};
//
ShowAdmissionWeight(UpdateForm);
//
</script>
</div>
<script language="Javascript">
//
//for (var i=0;i<document.UpdateForm.ptmis060.length;i++){
////if (document.UpdateForm.ptmis060.options[i].value.substr(0,3)==
//    document.UpdateForm.ptcnhpcd.value){
//    document.UpdateForm.ptmis060.selectedIndex=i}};
//
 if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
ibcnmhos="%STANDARD.01.025.000.043.1.1"
if(ibcnmhos=="1"){
  UpdateForm.ptmis068.className="Mandatory"
}
</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=5
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif"
      onClick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
