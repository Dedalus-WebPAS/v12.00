.******************************************************************************
.* System   : Patient Management                                              *
.* Include  : PATSHT8                                                         *
.* Desc     : Id Sheet Layout for  Port Macquarie                             *
.******************************************************************************
.* Function : This include contains setup & printing routines for P.M Id Sheet*
.* Requires : DIM22    DIM      22        ADOCDESC DIM      22                *
.*            RDOCTEL  DIM      12        A8DATE   DIM      8                 *
.*            B8DATE   DIM      8         D8DATE   DIM      8                 *
.*            XDAY     DIM      2         XMON     DIM      2                 *
.*            XYEAR    DIM      2         MARITAL1 DIM      20                *
.*            RELIGN   DIM      20        ADMSRC   DIM      20                *
.*            COUNTRY1 DIM      20        ADMTYPE  DIM      20                *
.*            AWRDBED  DIM      7         XAGE     DIM      3                 *
.* Used by  : IBAPAT31, IBABIL79                                              *
.* Routines : LINUPID8 - Print Lineup                                         *
.*            SETLID8  - Set up variables for Id Sheet                        *
.*            PRTSHT8  - Print Id Sheet                                       *
.******************************************************************************
.* Mods     : 
.         V9.08.01  08/06/2007  Mike Laming    CAR 125736
.                   Changes to PATDO1af Address lines - change DSADD3 to
.                   DSADD4 and DSADD2 to DSADD3 (new DSADD2 still to go in)
.
.*                  05/01/2000  J.Tan                                         *
.                   Mods to have zero filled dates
.                   08/10/1998  Glenn Berry      5.07 changes
.******************************************************************************
.*            V5.02.00  ROD  Copied from r6.01 H.O.A layout                   *
.*            V5.02.01  24/01/1995 Graeme Williams   SRF 134169               *
.*                      Truncate fields that were going over the 80 col. mark *
.******************************************************************************
.*        LINEUP PRINT                                                        *
.******************************************************************************
.
LINUPID8  CALL      OPNPRINT
          PRINT     *11,"Hospital",*49,"U/R Number":
                    *N,*11,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",*49,"xxxxxxxx":
                       *11,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",*49,"xxxxxxxx":
                    *N,*N,*11,"Surname",*32,"Given Name(s)",*58,"Title":
                       *65,"Sex",*71,"Date.Birth":
                  *N,*11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *58,"xxxx",*66,"x",*72,"xx/xx/xx":
                     *11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *58,"xxxx",*66,"x",*72,"xx/xx/xx":
                    *N,*N,*11,"Marital Status",*32,"Address",*58,"Telephone":
                       *78,"Age":
                  *N,*11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *58,"(H) xxxxxxxxxxxx",*78,"xxx":
                     *11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *58,"(H) xxxxxxxxxxxx",*78,"xxx":
                    *N,*32,"xxxxxxxxxxxxxxxxxxxxxxxxx",*58,"(B) xxxxxxxxxxxx":
                       *32,"xxxxxxxxxxxxxxxxxxxxxxxxx",*58,"(B) xxxxxxxxxxxx":
                    *N,*32,"xxxxxxxxxxxxxxxxxxxx xxxx":
                       *32,"xxxxxxxxxxxxxxxxxxxx xxxx":
                   *N,*N,*11,"Religion",*32,"Pension Number",*58,"Repat.Number":
                *N,*11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxx",*58,"xxxxxxxxxx":
                   *11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxx",*58,"xxxxxxxxxx":
                    *N,*N,*11,"Occupation",*32,"Country of Birth",*58:
                    "Language Used/Home":
                    *N,*11,"xxxxxxxxxxxx",*32,"xxxxxxxxxxxxxxxxxxxx":
                       *11,"xxxxxxxxxxxx",*32,"xxxxxxxxxxxxxxxxxxxx":
                       *58,"xxxxxxxxxxxxxxxxxxxxxx":
                       *58,"xxxxxxxxxxxxxxxxxxxxxx";
.
LUID8100  PRINT     *N,*N,*11,"Claim Type",*32,"Health Fund",*62,"Table":
                       *71,"Member No":
                   *N,*11,"xxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                       *62,"xxxxxxxx",*71,"xxxxxxxxxx":
                      *11,"xxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                       *62,"xxxxxxxx",*71,"xxxxxxxxxx":
                    *N,*N,*11,"Person to notify",*32,"Relationship":
                       *49,"Attending Doctor":
                    *N,*11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxx":
                       *49,"xxxxxxxxxxxxxxxxxxxx (xxxxxx)":
                       *11,"xxxxxxxxxxxxxxxxxxxx",*32,"xxxxxxxxxx":
                       *49,"xxxxxxxxxxxxxxxxxxxx (xxxxxx)":
                    *N,*11,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *49,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                       *11,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *49,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                    *N,*11,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *49,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                       *11,"xxxxxxxxxxxxxxxxxxxxxxxxx":
                       *49,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                    *N,*11,"xxxxxxxxxxxxxxx      xxxx":
                       *49,"xxxxxxxxxxxxxxx           xxxx":
                       *11,"xxxxxxxxxxxxxxx      xxxx":
                       *49,"xxxxxxxxxxxxxxx           xxxx":
                    *N,*11,"Phone: (H) xxxxxxxxxxxx",*49,"Phone: xxxxxxxxxxxx":
                       *22,"xxxxxxxxxxxx",*56,"xxxxxxxxxxxx":
                    *N,*18,"(B) xxxxxxxxxxxx":
                       *22,"xxxxxxxxxxxx":
                    *N,*11,"Admission No",*26,"Ward/Bed",*39,"Referring Doctor":
                       *69,"Phone":
                    *N,*11,"xxxxxxxx",*26,"xxx/xxx",*39,"xxxxxxxxxxxxxxxxxxxx":
                       *60,"(xxxxxx)",*69,"xxxxxxxxxxxx":
                       *11,"xxxxxxxx",*26,"xxx/xxx",*39,"xxxxxxxxxxxxxxxxxxxx":
                       *60,"(xxxxxx)",*69,"xxxxxxxxxxxx":
                    *N,*N,*11,"Admission Date",*26,"Admission Time":
                       *41,"Admission Type",*62,"Admission Source":
                    *N,*14,"xx/xx/xx",*30,"xx:xx",*41,"xxxxxxxxxxxxxxxxxxxx":
                       *62,"xxxxxxxxxxxxxxxxxx":
                       *14,"xx/xx/xx",*30,"xx:xx",*41,"xxxxxxxxxxxxxxxxxxxx":
                       *62,"xxxxxxxxxxxxxxxxxx":
                    *N,*N,*29,"Was Patient Admitted to a":
                    *N,*11,"Admission Weight",*29,"Psych Unit on Admission?":
                       *58,"TRF from other Hospital":
                    *N,*17,"xxxx",*17,"xxxx":
                    *N,*N,*11,"Provisional Diagnosis":
                    *N,*11,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                       *11,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                    *N,*11,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                       *11,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx":
                    *N,*11,"Discharge Date",*26,"Discharge Time":
                       *42,"Discharge Status",*62,"Discharge Dest":
                    *N,*14,"xx/xx/xx",*30,"xx:xx",*42,"xxxxxxxxxxxxxxxxxxx":
                       *62,"xxxxxxxxxxxxxxxxxx":
                       *14,"xx/xx/xx",*30,"xx:xx",*42,"xxxxxxxxxxxxxxxxxxx":
                       *62,"xxxxxxxxxxxxxxxxxx"
.
LUID8200  PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
.
LUID8300  CALL      CLSPRINT
          RETURN
.
.*******************************************************************************
.*        SETUP ALL VARIABLES FOR PRINT                                        *
.*******************************************************************************
.
SETLID8   CALL      LABELAGE                 * format age
. 
          UNPACK    ADATE,XCENT,XYEAR,XMON,XDAY    * Admission date
          PACK      A8DATE,XDAY,SLASH,XMON,SLASH,XYEAR
          REP       " 0",A8DATE
.
          UNPACK    PBDATE,XCENT,XYEAR,XMON,XDAY
          PACK      B8DATE,XDAY,SLASH,XMON,SLASH,XYEAR
          REP       " 0",B8DATE
.
. ------- Discharge details if applicable -------
.
          UNPACK    SP30,D8DATE,DSCSTAT      * Clear print fields
          UNPACK    SP30,DTIME,DSCDEST
.
          COMPARE   THREE,ASTAT              * Discharged ?
          GOTO      SLID8100 IF NOT EQUAL    * No - no discharge details
.
          MOVE      AADMNO,KEY8              * Admission no is the key
          CALL      RDDSCH1                  * Read discharge file
          BRANCH    OVRCD,SLID8100           * No discharge record
.
          UNPACK    DDATE,XCENT,XYEAR,XMON,XDAY    * Discharge date
          PACK      D8DATE,XDAY,SLASH,XMON,SLASH,XYEAR
          REP       " 0",D8DATE
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODED,DSTAT
          CALL      RDCODE1
          MOVE      TDESC,DSCSTAT            * Discharge status
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODEDD,DDEST
          CALL      RDCODE1
          MOVE      TDESC,DSCDEST            * Discharge destination
.
SLID8100  MOVE      SP20,RDOCTEL             * Clear print fields
          BRANCH    CRDRTYP,SLID8200         * No referring doctor
.
          MATCH     SP3,ADOCTR               * Is code being used ?
          GOTO      SLID8200 IF EQUAL        * No - use free format field
.
          MOVE      ADOCTR,KEY6              * Get referring doctor details
          CALL      GETD0000
          MOVE      DIM22,ARDRNAM
          MOVE      DTELES,RDOCTEL
.
SLID8200  MOVE      ADOCTA,KEY6              * Get attending doctor details
          CALL      GETD0000
          MOVE      DIM22,ADOCDESC
.
          MOVE      SP20,TDESC
          MATCH     SP3,PMSTAT
          GOTO      SLID8300 IF EQUAL
          PACK      KEY5,CODEM,PMSTAT
          CALL      RDCODE1
SLID8300  MOVE      TDESC,MARITAL1           * Marital status
.
          MOVE      SP20,TDESC
          MATCH     SP3,PREG
          GOTO      SLID8400 IF EQUAL
          PACK      KEY5,CODER,PREG
          CALL      RDCODE1
SLID8400  MOVE      TDESC,RELIGN             * Religion
.
          MOVE      SP20,TDESC
          MATCH     SP3,ASRCE
          GOTO      SLID8500 IF EQUAL
          PACK      KEY5,CODES,ASRCE
          CALL      RDCODE1
SLID8500  MOVE      TDESC,ADMSRC             * Admission Source
.
          MOVE      SP20,TDESC
          MATCH     SP3,PCONT
          GOTO      SLID8600 IF EQUAL
          PACK      KEY5,CODEC,PCONT
          CALL      RDCODE1
SLID8600  MOVE      TDESC,COUNTRY1           * Country of Birth
.
          MOVE      SP20,TDESC
          MATCH     SP3,AUSR1
          GOTO      SLID8700 IF EQUAL
          PACK      KEY5,ANSU,ONE,AUSR1
          CALL      RDCODE1
SLID8700  MOVE      TDESC,LANGUSED           * User defined
.
          MOVE      SP20,TDESC
          MATCH     SP3,ATYPE
          GOTO      SLID8800 IF EQUAL
          PACK      KEY5,CODEA,ATYPE
          CALL      RDCODE1
SLID8800  MOVE      TDESC,ADMTYPE            * Admission Type
.
          MOVE      "UNK",DALERG
          LOAD      DALERG,AALERG,DYES,DNO   * Allergies
.
          MOVE      "UNK",DSMOKE
          LOAD      DSMOKE,PSMOK,DYES,DNO    * Smoker
.
          MOVE      SP20,TDESC
          PACK      KEY5,CODECL,ACLAIM
          CALL      RDCODE1
          MOVE      TDESC,CLDESC             * Claim code
.
          PACK      HFNAME,SP30
          MOVE      "0000    ",HFTABL
          PACK      KEY14,AFUNDH,HFTABL
          CALL      RDFUND1                  * Health fund
.
          PACK      AWRDBED,SP7
          MATCH     SP3,AWARD
          GOTO      SLID8999 IF EQUAL
          PACK      AWRDBED,AWARD,SLASH,ABED
.
SLID8999  RETURN
.
.*******************************************************************************
.*        GETD0000 - Read doctor details                                       *
.*        Requires : Doctor code in KEY6                                       *
.*        Returns  : All doctor record variables                               *
.*                   Formatted doctor name in DIM22 - Init. Surname (Code)     *
.*******************************************************************************
.
GETD0000  MOVE      SP20,DGNAME
          MOVE      SP20,DSNAME
          MOVE      SP12,DTELES
          MOVE      SP30,DSADD1
          MOVE      SP30,DSADD2
          MOVE      SP30,DSADD3
          MOVE      SP30,DSADD4
          MOVE      SP30,DSPOST
          MOVE      SP30,DIM22
.
          CALL      RDDOCT1
          BRANCH    OVRCD,GETD4000
.
          MOVE      DGNAME,ANS
          CLEAR     DIM22
          MATCH     SP1,ANS
          GOTO      GETD1000 IF EQUAL
          APPEND    ANS,DIM22
          APPEND    DOT,DIM22
GETD1000  APPEND    DSNAME,DIM22
          RESET     DIM22,22
GETD2000  CMATCH    SP1,DIM22
          GOTO      GETD3000 IF NOT EQUAL
          BUMP      DIM22,-1
          GOTO      GETD2000
GETD3000  APPEND    " (",DIM22
          APPEND    KEY6,DIM22
          APPEND    ")",DIM22
          RESET     DIM22
GETD4000  RETURN
.
.*******************************************************************************
.*        Print Id Sheet                                                       *
.*******************************************************************************
.
PRTSHT8   CALL      OPNPRINT
          SETLPTR   PTELEP,15
          SETLPTR   PTELEB,15
          SETLPTR   DSADD1,30
          SETLPTR   DSADD2,30
          SETLPTR   DSADD3,30
          SETLPTR   DSADD4,25
          SETLPTR   DSPOST,4
          SETLPTR   ADMSRC,18
          SETLPTR   DSCDEST,18
          PRINT     *11,"Hospital",*49,"U/R Number":
                    *N,*11,CNAME,*49,AURNO:
                       *11,CNAME,*49,AURNO:
                    *N,*N,*11,"Surname",*32,"Given Name(s)",*58,"Title":
                       *65,"Sex",*71,"Date.Birth":
                    *N,*11,PSNAME,*32,PGNAME,*58,PTITL,*66,PSEX,*72,B8DATE:
                       *11,PSNAME,*32,PGNAME,*58,PTITL,*66,PSEX,*72,B8DATE:
                    *N,*N,*11,"Marital Status",*32,"Address",*58,"Telephone":
                       *78,"Age":
                    *N,*11,MARITAL1,*32,PADD1,*58,"(H) ",*+,PTELEP,*78,XAGE:
                       *11,MARITAL1,*32,PADD1,*58,"(H) ",*+,PTELEP,*78,XAGE:
                    *N,*32,PADD2,*58,"(B) ",*+,PTELEB:
                       *32,PADD2,*58,"(B) ",*+,PTELEB:
                    *N,*32,PSUBRB,*53,PPOST:
                       *32,PSUBRB,*53,PPOST:
                   *N,*N,*11,"Religion",*32,"Pension Number",*58,"Repat.Number":
                    *N,*11,RELIGN,*32,PPENNO,*58,PREPAT:
                       *11,RELIGN,*32,PPENNO,*58,PREPAT:
                    *N,*N,*11,"Occupation",*32,"Country of Birth":
                    *58,"Language Used/Home";
.
          PRINT     *N,*11,POCCUP,*32,COUNTRY1,*58,LANGUSED:
                       *11,POCCUP,*32,COUNTRY1,*58,LANGUSED;
.
PRSH8100  PRINT     *N,*N,*11,"Claim Type",*32,"Health Fund",*62,"Table":
                       *71,"Member No":
                    *N,*11,CLDESC,*32,HFNAME,*62,AFNDTB,*71,AFNDMM:
                       *11,CLDESC,*32,HFNAME,*62,AFNDTB,*71,AFNDMM:
                    *N,*N,*11,"Person to notify",*32,"Relationship":
                       *49,"Attending Doctor":
                    *N,*11,PNKNAME,*32,PNKRELP,*49,ADOCDESC:
                       *11,PNKNAME,*32,PNKRELP,*49,ADOCDESC:
                    *N,*11,PNKADD1,*49,*+,DSADD1:
                       *11,PNKADD1,*49,*+,DSADD1:
                    *N,*11,PNKADD2,*49,*+,DSADD3:
                       *11,PNKADD2,*49,*+,DSADD3:
                    *N,*11,PNKSUBR,*32,PNKPOST,*49,*+,DSADD4,*75,*+,DSPOST:
                       *11,PNKSUBR,*32,PNKPOST,*49,*+,DSADD4,*75,*+,DSPOST:
                    *N,*11,"Phone: (H) ",PNKTELP,*49,"Phone: ",DTELES:
                       *22,PNKTELP,*56,DTELES:
                    *N,*18,"(B) ",PNKTELB:
                       *22,PNKTELB:
                    *N,*11,"Admission No",*26,"Ward/Bed",*39,"Referring Doctor":
                       *69,"Phone":
                    *N,*11,AADMNO,*26,AWRDBED,*39,ARDRNAM,*69,RDOCTEL:
                       *11,AADMNO,*26,AWRDBED,*39,ARDRNAM,*69,RDOCTEL:
                    *N,*N,*11,"Admission Date",*26,"Admission Time":
                       *41,"Admission Type",*62,"Admission Source":
                    *N,*14,A8DATE,*30,ATIME,*41,ADMTYPE,*62,ADMSRC:
                       *14,A8DATE,*30,ATIME,*41,ADMTYPE,*62,ADMSRC:
                    *N,*N,*29,"Was Patient Admitted to a":
                    *N,*11,"Admission Weight",*29,"Psych Unit on Admission":
                       *58,"TRF from other Hospital":
                    *N,*17,ABWGHT,*17,ABWGHT:
                    *N,*N,*11,"Provisional Diagnosis":
                    *N,*11,ADIAG1:
                       *11,ADIAG1:
                    *N,*11,ADIAG2:
                       *11,ADIAG2:
                    *N,*11,"Discharge Date",*26,"Discharge Time":
                       *42,"Discharge Status",*62,"Discharge Dest":
                    *N,*14,D8DATE,*30,DTIME,*42,DSCSTAT,*62,*+,DSCDEST:
                       *14,D8DATE,*30,DTIME,*42,DSCSTAT,*62,*+,DSCDEST
          SETLPTR   PTELEP,20
          SETLPTR   PTELEB,20
          SETLPTR   DSADD1,35
          SETLPTR   DSADD2,35
          SETLPTR   DSADD3,35
          SETLPTR   DSADD4,35
          SETLPTR   DSPOST,8
          SETLPTR   ADMSRC,20
          SETLPTR   DSCDEST,20
.
PRSH8200  PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
.
PRSH8300  CALL      CLSPRINT
          RETURN
.
.
