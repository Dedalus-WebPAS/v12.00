.------------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.------------------------------------------------------------------------------
. V5.04.01  01.11.1993 B.G.Ackland
.           Change "Procedure" to Patient Service
.------------------------------------------------------------------------------
CCPERCNT  FORM      3                 IBACCS30   Period Count for Graph Display
CCTMTOT   FORM      12.2              IBACCS22   Direct Cost Account Total
FILENAME  DIM       8
LASTPRT   DIM       80                IBACCS4*   Last Print Variable Various
SAVEPER   DIM       2                 IBACCS30   Save Period
SAVEYEAR  DIM       4                 IBACCS30   Save Year
.------------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCS31
.   Function      :   Patient Service Enquiries               
.   Generated  On :   08/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCALFD/INC
          INC       CCSCMAFD/INC
          INC       CCSCMBFD/INC
          INC       CCSCMCFD/INC
          INC       CCSCMDFD/INC
          INC       CCSCMEFD/INC
          INC       CCSCMFFD/INC
          INC       CCSCONFD/INC
          INC       CCSDPTFD/INC
          INC       CCSPCDFD/INC
          INC       CCSPDPFD/INC
          INC       CCSPSDFD/INC
          INC       GPHSTDDF    
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 00 Fld     7
.-------------------------------------------------------
CCPD3NAM  INIT      "CCPD3"
CCPD3END  FORM      1   * End Display
CCPD3SNO  FORM      5   * Number of Items on the Screen
CCPD3MKY  DIM       127 * Match Key 
CCPD3EKY  DIM       127 * End Key
CCPD3SKY  DIM       127 * Start Key
CCPD3IDX  INIT      " 132 UC1-5"
CCPD3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCPD3FNM  DIM       8  * Filename
CCPD3CNT  FORM      3  * Number of Items on Screen
CCQTYVAR  FORM     10.2 * Scr 00 Fld    16
CCQTYPVA  FORM      6.4 * Scr 00 Fld    17
CCTOTQTY  FORM     10.2 * Scr 00 Fld    18
CCTOTBUD  FORM     10.2 * Scr 00 Fld    19
CCTQTVAR  FORM     10.2 * Scr 00 Fld    20
CCTQTPVA  FORM      6.4 * Scr 00 Fld    21
.
.    Multi Item Key Fields Scr 01 Fld     7
.-------------------------------------------------------
CCPS3NAM  INIT      "CCPS3"
CCPS3END  FORM      1   * End Display
CCPS3SNO  FORM      5   * Number of Items on the Screen
CCPS3MKY  DIM       127 * Match Key 
CCPS3EKY  DIM       127 * End Key
CCPS3SKY  DIM       127 * Start Key
CCPS3IDX  INIT      " 132 UC1-5"
CCPS3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCPS3FNM  DIM       8  * Filename
CCPS3CNT  FORM      3  * Number of Items on Screen
CCAVGUC   FORM     12.6 * Scr 01 Fld    26
CCAVGUB   FORM     12.6 * Scr 01 Fld    27
CCAVGUF   FORM     12.6 * Scr 01 Fld    28
CCAVGUS   FORM     12.6 * Scr 01 Fld    29
CCTOTUC   FORM     12.6 * Scr 01 Fld    30
CCTOTUB   FORM     12.6 * Scr 01 Fld    31
CCTOTUF   FORM     12.6 * Scr 01 Fld    32
CCTOTUS   FORM     12.6 * Scr 01 Fld    33
CCDPTTC   FORM     12.6 * Scr 02 Fld    26
CCDPTTB   FORM     12.6 * Scr 02 Fld    27
CCDPTTF   FORM     12.6 * Scr 02 Fld    28
CCDPTTS   FORM     12.6 * Scr 02 Fld    29
CCTOTTC   FORM     12.6 * Scr 02 Fld    30
CCTOTTB   FORM     12.6 * Scr 02 Fld    31
CCTOTTF   FORM     12.6 * Scr 02 Fld    32
CCTOTTS   FORM     12.6 * Scr 02 Fld    33
GPQTY     FORM      1 * Scr 03 Fld     5
GPBQT     FORM      1 * Scr 03 Fld     6
GPACT     FORM      1 * Scr 03 Fld     7
GPBUD     FORM      1 * Scr 03 Fld     8
GPFBU     FORM      1 * Scr 03 Fld     9
GPSTD     FORM      1 * Scr 03 Fld    10
GPCHG     FORM      1 * Scr 03 Fld    11
GPAA      FORM      1 * Scr 03 Fld    12
GPAB      FORM      1 * Scr 03 Fld    13
GPAF      FORM      1 * Scr 03 Fld    14
GPAS      FORM      1 * Scr 03 Fld    15
GPTCHG    FORM      1 * Scr 03 Fld    16
GPBA      FORM      1 * Scr 03 Fld    17
GPBB      FORM      1 * Scr 03 Fld    18
GPBF      FORM      1 * Scr 03 Fld    19
GPBS      FORM      1 * Scr 03 Fld    20
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCS31"
PRGNAM    INIT      "Patient Service Enquiries               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA1,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA2,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA3,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscmaaf";
          OPEN      CCSCMAA1,"ccscmaaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA1,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA2,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA3,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA4,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccspcdaf";
          OPEN      CCSPCDA1,"ccspcdaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA1,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA2,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA3,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA4,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspsdaf";
          OPEN      CCSPSDA1,"ccspsdaf"
          DISPLAY   *P56:24,"Opening ccspsdaf";
          OPEN      CCSPSDA2,"ccspsdaf"
          DISPLAY   *P56:24,"Opening ccspsdaf";
          OPEN      CCSPSDA3,"ccspsdaf"
.--------------------------------------------------------
. Initialise Batch Screen Hospital                           
.--------------------------------------------------------
          MOVE     ZERO,CCPD3SNO
          MOVE     "00    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCPD3SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Hospital                           
.--------------------------------------------------------
          MOVE     ZERO,CCPS3SNO
          MOVE     "01    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCPS3SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Patient Service Comparision        
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Unit Cost Analysis                 
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Total Cost Analysis                
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Graph Options                      
          ENDIF
          RETURN
.--------------------------------
. Screen - Patient Service Comparision        
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RCCCO000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Comparision        
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,CCMACOM 
          MOVE      SP70,CCPCPCD 
          MOVE      SP70,CCPDDES 
          MOVE      SP70,SAVEYEAR
          MOVE      SP70,SAVEPER 
          MOVE      SP70,CCPDHCD 
          MOVE      SP70,CCPDDPT 
          MOVE      SP70,CCDPDES 
          MOVE      ZERO,CCPSQTY 
          MOVE      ZERO,CCMEQTY 
          MOVE      ZERO,CCPSCST 
          MOVE      ZERO,CCMECST 
          MOVE      ZERO,CCMEFLX 
          MOVE      ZERO,CCPSSCT 
          MOVE      ZERO,CCQTYVAR
          MOVE      ZERO,CCQTYPVA
          MOVE      ZERO,CCTOTQTY
          MOVE      ZERO,CCTOTBUD
          MOVE      ZERO,CCTQTVAR
          MOVE      ZERO,CCTQTPVA
          MOVE      SP70,CCCATDT 
          MOVE      SP70,CCMADES 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Comparision        
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          CALL      CC31C000
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY00L120
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCPDDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCCPDB00
          MOVE      CCPDPCD,CCPCPCD
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCPCPCD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Comparision        
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Comparision        
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :     7 Hospital                           
.---------------------------------------------------------
          PACK      KEY18,CCPDPCD,SP70
          MOVE      KEY18,CCPD3EKY
          MOVE      CCPD3EKY,CCPD3SKY
          STRIP     CCPD3SKY
          SETLPTR   CCPD3EKY,8
          CALL      RDCCPD3 
          IF        OVRCD=0
            CALL      RPCCPD3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,CCPD3CNT
          MOVE     ZERO,CCPD3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L101,DP00L102:
                            DP00L103,DP00L104,DP00L105,DP00L106:
                            DP00L107,DP00L108,DP00L109,DP00L110:
                            DP00L111,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010
          GOTO      DP00L010
.
DP00L101
          IF        CCPD3END=0
            CALL      RKCCPD3 
            IF        OVRCD=0
              PACK      CCPD3MKY,CCPDPCD,CCPDHCD,CCPDDPT                                                        
              MATCH     CCPD3EKY,CCPD3MKY
              IF        @EQUAL
                MOVE      ZERO,CCPD3END
                ADD       ONE,CCPD3CNT
                MOVE      CCPDHCD,VAR      
                CALL      DISPITEM
          CALL      CC31A000
              ELSE
                MOVE      ONE,CCPD3END
              ENDIF
            ELSE
              MOVE      ONE,CCPD3END
            ENDIF
          ENDIF
          IF        CCPD3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        CCPD3END=0
            MOVE      CCPDDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        CCPD3END=0
            MOVE      CCDPDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        CCPD3END=0
            MOVE      CCPSQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        CCPD3END=0
            MOVE      CCMEQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        CCPD3END=0
            MOVE      CCPSCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        CCPD3END=0
            MOVE      CCMECST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        CCPD3END=0
            MOVE      CCMEFLX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        CCPD3END=0
            MOVE      CCPSSCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L110
          IF        CCPD3END=0
            MOVE      CCQTYVAR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L111
          IF        CCPD3END=0
            MOVE      CCQTYPVA,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "CCPD3",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTQTY,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTBUD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTQTVAR,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTQTPVA,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "CCPD3",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY18,CCPD3SKY,SP70
          CALL     RDCCPD3  * Start
          IF       OVRCD=0
            CALL     RPCCPD3  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "CCPD3",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY18,CCPD3SKY,Z70
          CALL     RSCCPD3  * End
          IF       OVRCD=1
            CALL     RPCCPD3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPD3SNO
            CALL     RPCCPD3 
            IF       OVRCD=1
              MOVE     CCPD3SNO,SECTOR
            ENDIF
            PACK     CCPD3MKY,CCPDPCD,CCPDHCD,CCPDDPT                                                        
            MATCH    CCPD3EKY,CCPD3MKY
            IF       !@EQUAL
              MOVE     CCPD3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "CCPD3",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          COMPARE  SECTOR,CCPD3SNO
          GOTO     PP00L110 IF EQUAL
          CALL     RPCCPD3 
          BRANCH   OVRCD,PP00L115
          PACK     CCPD3MKY,CCPDPCD,CCPDHCD,CCPDDPT                                                        
          MATCH    CCPD3EKY,CCPD3MKY
          GOTO     PP00L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP00L105
PP00L110
          MOVE     ZERO,SECTOR
          IF       CCPD3CNT=CCPD3SNO
            SUB      ONE,CCPD3CNT
          ENDIF
          WHILE    SECTOR<=CCPD3CNT
            CALL     RPCCPD3 
            IF       OVRCD=1
              MOVE     CCPD3SNO,SECTOR
            ENDIF
            PACK     CCPD3MKY,CCPDPCD,CCPDHCD,CCPDDPT                                                        
            MATCH    CCPD3EKY,CCPD3MKY
            IF       !@EQUAL
              MOVE     CCPD3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPD3SNO
            CALL     RKCCPD3 
            IF       OVRCD=1
              MOVE     CCPD3SNO,SECTOR
            ENDIF
            PACK     CCPD3MKY,CCPDPCD,CCPDHCD,CCPDDPT                                                        
            MATCH    CCPD3EKY,CCPD3MKY
            IF       !@EQUAL
              MOVE     CCPD3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "CCPD3",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RKCCPD3 
          BRANCH   OVRCD,NP00L110
          PACK     CCPD3MKY,CCPDPCD,CCPDHCD,CCPDDPT                                                        
          MATCH    CCPD3EKY,CCPD3MKY
          GOTO     NP00L110 IF NOT EQUAL
          CALL     RPCCPD3 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RPCCPD3 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Patient Service Comparision        
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Patient Service Comparision        
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "CCPD3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Comparision        
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L108,PS00L999,PS00L109:
                            PS00L999,PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      CCPDDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SAVEYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SAVEPER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCTOTQTY,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCTOTBUD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCTQTVAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCTQTPVA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          CALL      CC31B000
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Comparision        
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L101,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L102,SF00L103,SF00L104,SF00L105:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L106,SF00L006,SF00L006,SF00L006:
                            SF00L107,SF00L108,SF00L109,SF00L110
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "CCPD3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CC31D000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CCCHYR00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CC31E000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L107
          MOVE      "CCPD3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L108
          MOVE      "CCPD3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L109
          MOVE      "CCPD3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L110
          MOVE      "CCPD3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Unit Cost Analysis                 
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      CC31C000
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
          CALL      EXITSETF
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Unit Cost Analysis                 
.-------------------------------------------------------
CF01L000  COMPARE   ZERO,ACCEPT
              GOTO      CF01L999 IF EQUAL
          MOVE      SP70,SAVEYEAR
          MOVE      SP70,SAVEPER 
          MOVE      SP70,CCPSHCD 
          MOVE      SP70,CCPSDPT 
          MOVE      SP70,CCDPDES 
          MOVE      ZERO,CCPSQTY 
          MOVE      ZERO,CCPSBQT 
          MOVE      ZERO,CCPSCST 
          MOVE      ZERO,CCPSBCT 
          MOVE      ZERO,CCPSFBU 
          MOVE      ZERO,CCPSSCT 
          MOVE      ZERO,CCQTYVAR
          MOVE      ZERO,CCQTYPVA
          MOVE      ZERO,CCTOTQTY
          MOVE      ZERO,CCTOTBUD
          MOVE      ZERO,CCTQTVAR
          MOVE      ZERO,CCTQTPVA
          MOVE      ZERO,CCAVGUC 
          MOVE      ZERO,CCAVGUB 
          MOVE      ZERO,CCAVGUF 
          MOVE      ZERO,CCAVGUS 
          MOVE      ZERO,CCTOTUC 
          MOVE      ZERO,CCTOTUB 
          MOVE      ZERO,CCTOTUF 
          MOVE      ZERO,CCTOTUS 
          MOVE      SP70,CCCATDT 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Unit Cost Analysis                 
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Unit Cost Analysis                 
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Unit Cost Analysis                 
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :     7 Hospital                           
.---------------------------------------------------------
          PACK      KEY24,CCPDPCD,SAVEYEAR,SAVEPER,SP70
          MOVE      KEY24,CCPS3EKY
          MOVE      CCPS3EKY,CCPS3SKY
          STRIP     CCPS3SKY
          SETLPTR   CCPS3EKY,14
          CALL      RDCCPS3 
          IF        OVRCD=0
            CALL      RPCCPS3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,CCPS3CNT
          MOVE     ZERO,CCPS3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L101,DP01L102:
                            DP01L103,DP01L104,DP01L105,DP01L106:
                            DP01L107,DP01L108,DP01L109,DP01L110:
                            DP01L111,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        CCPS3END=0
            CALL      RKCCPS3 
            IF        OVRCD=0
              PACK      CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
              MATCH     CCPS3EKY,CCPS3MKY
              IF        @EQUAL
                MOVE      ZERO,CCPS3END
                ADD       ONE,CCPS3CNT
                MOVE      CCPSHCD,VAR      
                CALL      DISPITEM
          CALL      CC31A000
              ELSE
                MOVE      ONE,CCPS3END
              ENDIF
            ELSE
              MOVE      ONE,CCPS3END
            ENDIF
          ENDIF
          IF        CCPS3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        CCPS3END=0
            MOVE      CCPSDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        CCPS3END=0
            MOVE      CCDPDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        CCPS3END=0
            MOVE      CCPSQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        CCPS3END=0
            MOVE      CCPSBQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L106
          IF        CCPS3END=0
            MOVE      CCPSCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L107
          IF        CCPS3END=0
            MOVE      CCPSBCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L108
          IF        CCPS3END=0
            MOVE      CCPSFBU,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L109
          IF        CCPS3END=0
            MOVE      CCPSSCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L110
          IF        CCPS3END=0
            MOVE      CCQTYVAR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L111
          IF        CCPS3END=0
            MOVE      CCQTYPVA,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "CCPS3",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTQTY,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTBUD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTQTVAR,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTQTPVA,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCAVGUC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCAVGUB,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCAVGUF,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCAVGUS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTUC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTUB,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTUF,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTUS,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          MATCH    "CCPS3",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          PACK     KEY24,CCPS3SKY,SP70
          CALL     RDCCPS3  * Start
          IF       OVRCD=0
            CALL     RPCCPS3  * Start
          ENDIF
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          MATCH    "CCPS3",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY24,CCPS3SKY,Z70
          CALL     RSCCPS3  * End
          IF       OVRCD=1
            CALL     RPCCPS3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPS3SNO
            CALL     RPCCPS3 
            IF       OVRCD=1
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
            MATCH    CCPS3EKY,CCPS3MKY
            IF       !@EQUAL
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
          MATCH    "CCPS3",NAMSSFFI
          GOTO     PP01L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP01L105
          COMPARE  SECTOR,CCPS3SNO
          GOTO     PP01L110 IF EQUAL
          CALL     RPCCPS3 
          BRANCH   OVRCD,PP01L115
          PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
          MATCH    CCPS3EKY,CCPS3MKY
          GOTO     PP01L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP01L105
PP01L110
          MOVE     ZERO,SECTOR
          IF       CCPS3CNT=CCPS3SNO
            SUB      ONE,CCPS3CNT
          ENDIF
          WHILE    SECTOR<=CCPS3CNT
            CALL     RPCCPS3 
            IF       OVRCD=1
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
            MATCH    CCPS3EKY,CCPS3MKY
            IF       !@EQUAL
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPS3SNO
            CALL     RKCCPS3 
            IF       OVRCD=1
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
            MATCH    CCPS3EKY,CCPS3MKY
            IF       !@EQUAL
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP01L999
PP01L120
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "CCPS3",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          CALL     RKCCPS3 
          BRANCH   OVRCD,NP01L110
          PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
          MATCH    CCPS3EKY,CCPS3MKY
          GOTO     NP01L110 IF NOT EQUAL
          CALL     RPCCPS3 
          CALL     DP01L000
          GOTO     NP01L999
NP01L110
          CALL     RPCCPS3 
          BEEP
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
CT01L105
CT01L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Unit Cost Analysis                 
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Unit Cost Analysis                 
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Unit Cost Analysis                 
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L103,PS01L104,PS01L105:
                            PS01L106,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L107,PS01L108,PS01L109:
                            PS01L110,PS01L111,PS01L112,PS01L113:
                            PS01L114,PS01L999,PS01L999,PS01L115:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      SAVEYEAR,VAR     
          CALL      DISPITEM
          CALL      CC31C000
          GOTO     PS01L999
.
PS01L102
          MOVE      SAVEPER,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CCTOTQTY,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CCTOTBUD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CCTQTVAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CCTQTPVA,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CCAVGUC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CCAVGUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      CCAVGUF,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      CCAVGUS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      CCTOTUC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CCTOTUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      CCTOTUF,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      CCTOTUS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          CALL      CC31B000
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Unit Cost Analysis                 
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L101,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L102,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L103,SF01L104,SF01L006:
                            SF01L105,SF01L106,SF01L107,SF01L108:
                            SF01L109,SF01L110
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      CCCHYR00
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L104
          CALL      CCCHPR00
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L105
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L108
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
.
SF01L109
          CALL      EXITSET4
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L110
          CALL      EXITSET1
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Total Cost Analysis                
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      CC31C000
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
          CALL      EXITSETF
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Total Cost Analysis                
.-------------------------------------------------------
CF02L000  COMPARE   ZERO,ACCEPT
              GOTO      CF02L999 IF EQUAL
          MOVE      SP70,SAVEYEAR
          MOVE      SP70,SAVEPER 
          MOVE      SP70,CCPSHCD 
          MOVE      SP70,CCPSDPT 
          MOVE      SP70,CCDPDES 
          MOVE      ZERO,CCPSQTY 
          MOVE      ZERO,CCPSBQT 
          MOVE      ZERO,CCPSCST 
          MOVE      ZERO,CCPSBCT 
          MOVE      ZERO,CCPSFBU 
          MOVE      ZERO,CCPSSCT 
          MOVE      ZERO,CCQTYVAR
          MOVE      ZERO,CCQTYPVA
          MOVE      ZERO,CCTOTQTY
          MOVE      ZERO,CCTOTBUD
          MOVE      ZERO,CCTQTVAR
          MOVE      ZERO,CCTQTPVA
          MOVE      ZERO,CCDPTTC 
          MOVE      ZERO,CCDPTTB 
          MOVE      ZERO,CCDPTTF 
          MOVE      ZERO,CCDPTTS 
          MOVE      ZERO,CCTOTTC 
          MOVE      ZERO,CCTOTTB 
          MOVE      ZERO,CCTOTTF 
          MOVE      ZERO,CCTOTTS 
          MOVE      SP70,CCCATDT 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Total Cost Analysis                
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Total Cost Analysis                
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Total Cost Analysis                
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     7 Hospital                           
.---------------------------------------------------------
          PACK      KEY24,CCPDPCD,SAVEYEAR,SAVEPER,SP70
          MOVE      KEY24,CCPS3EKY
          MOVE      CCPS3EKY,CCPS3SKY
          STRIP     CCPS3SKY
          SETLPTR   CCPS3EKY,14
          CALL      RDCCPS3 
          IF        OVRCD=0
            CALL      RPCCPS3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,CCPS3CNT
          MOVE     ZERO,CCPS3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L105,DP02L106:
                            DP02L107,DP02L108,DP02L109,DP02L110:
                            DP02L111,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L112,DP02L113,DP02L114:
                            DP02L115,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          IF        CCPS3END=0
            CALL      RKCCPS3 
            IF        OVRCD=0
              PACK      CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
              MATCH     CCPS3EKY,CCPS3MKY
              IF        @EQUAL
                MOVE      ZERO,CCPS3END
                ADD       ONE,CCPS3CNT
                MOVE      CCPSHCD,VAR      
                CALL      DISPITEM
          CALL      CC31A000
              ELSE
                MOVE      ONE,CCPS3END
              ENDIF
            ELSE
              MOVE      ONE,CCPS3END
            ENDIF
          ENDIF
          IF        CCPS3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        CCPS3END=0
            MOVE      CCPSDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        CCPS3END=0
            MOVE      CCDPDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        CCPS3END=0
            MOVE      CCPSQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        CCPS3END=0
            MOVE      CCPSBQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        CCPS3END=0
            MOVE      CCPSCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        CCPS3END=0
            MOVE      CCPSBCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        CCPS3END=0
            MOVE      CCPSFBU,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        CCPS3END=0
            MOVE      CCPSSCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        CCPS3END=0
            MOVE      CCQTYVAR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        CCPS3END=0
            MOVE      CCQTYPVA,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        CCPS3END=0
            MOVE      CCDPTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        CCPS3END=0
            MOVE      CCDPTTB,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        CCPS3END=0
            MOVE      CCDPTTF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        CCPS3END=0
            MOVE      CCDPTTS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "CCPS3",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTQTY,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTBUD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTQTVAR,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTQTPVA,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTTC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTTB,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTTF,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCTOTTS,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "CCPS3",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY24,CCPS3SKY,SP70
          CALL     RDCCPS3  * Start
          IF       OVRCD=0
            CALL     RPCCPS3  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "CCPS3",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY24,CCPS3SKY,Z70
          CALL     RSCCPS3  * End
          IF       OVRCD=1
            CALL     RPCCPS3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPS3SNO
            CALL     RPCCPS3 
            IF       OVRCD=1
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
            MATCH    CCPS3EKY,CCPS3MKY
            IF       !@EQUAL
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "CCPS3",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          COMPARE  SECTOR,CCPS3SNO
          GOTO     PP02L110 IF EQUAL
          CALL     RPCCPS3 
          BRANCH   OVRCD,PP02L115
          PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
          MATCH    CCPS3EKY,CCPS3MKY
          GOTO     PP02L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP02L105
PP02L110
          MOVE     ZERO,SECTOR
          IF       CCPS3CNT=CCPS3SNO
            SUB      ONE,CCPS3CNT
          ENDIF
          WHILE    SECTOR<=CCPS3CNT
            CALL     RPCCPS3 
            IF       OVRCD=1
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
            MATCH    CCPS3EKY,CCPS3MKY
            IF       !@EQUAL
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPS3SNO
            CALL     RKCCPS3 
            IF       OVRCD=1
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
            MATCH    CCPS3EKY,CCPS3MKY
            IF       !@EQUAL
              MOVE     CCPS3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "CCPS3",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKCCPS3 
          BRANCH   OVRCD,NP02L110
          PACK     CCPS3MKY,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT                                       
          MATCH    CCPS3EKY,CCPS3MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPCCPS3 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPCCPS3 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Total Cost Analysis                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Total Cost Analysis                
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Total Cost Analysis                
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L103,PS02L104,PS02L105:
                            PS02L106,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L107,PS02L108,PS02L109:
                            PS02L110,PS02L999,PS02L999,PS02L111:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      SAVEYEAR,VAR     
          CALL      DISPITEM
          CALL      CC31C000
          GOTO     PS02L999
.
PS02L102
          MOVE      SAVEPER,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CCTOTQTY,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      CCTOTBUD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      CCTQTVAR,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      CCTQTPVA,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CCTOTTC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CCTOTTB,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      CCTOTTF,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      CCTOTTS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          CALL      CC31B000
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Total Cost Analysis                
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L102,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L103,SF02L104,SF02L006:
                            SF02L105,SF02L106,SF02L107,SF02L108:
                            SF02L109,SF02L110
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          CALL      CCCHYR00
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L104
          CALL      CCCHPR00
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L105
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L107
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L108
          MOVE      "CCPS3",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L109
          CALL      EXITSET4
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L110
          CALL      EXITSET1
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Graph Options                      
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      " 39",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
          CALL      EXITSETF
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Graph Options                      
.-------------------------------------------------------
CF03L000  COMPARE   ZERO,ACCEPT
              GOTO      CF03L999 IF EQUAL
          MOVE      ZERO,GPQTY   
          MOVE      ZERO,GPBQT   
          MOVE      ZERO,GPACT   
          MOVE      ZERO,GPBUD   
          MOVE      ZERO,GPFBU   
          MOVE      ZERO,GPSTD   
          MOVE      ZERO,GPCHG   
          MOVE      ZERO,GPAA    
          MOVE      ZERO,GPAB    
          MOVE      ZERO,GPAF    
          MOVE      ZERO,GPAS    
          MOVE      ZERO,GPTCHG  
          MOVE      ZERO,GPBA    
          MOVE      ZERO,GPBB    
          MOVE      ZERO,GPBF    
          MOVE      ZERO,GPBS    
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Graph Options                      
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Graph Options                      
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Graph Options                      
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Graph Options                      
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Graph Options                      
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L106,PS03L107,PS03L108:
                            PS03L109,PS03L110,PS03L111,PS03L112:
                            PS03L113,PS03L114,PS03L115,PS03L116:
                            PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPQTY,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBQT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPACT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBUD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPFBU,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPSTD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPCHG,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPTCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Graph Options                      
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L105,SF03L106,SF03L107:
                            SF03L108,SF03L109,SF03L110,SF03L111:
                            SF03L112,SF03L113,SF03L114,SF03L115:
                            SF03L116,SF03L117,SF03L118,SF03L119:
                            SF03L120
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L104,SF03L105,SF03L106,SF03L107:
                            SF03L108,SF03L109,SF03L110,SF03L111:
                            SF03L112,SF03L113,SF03L114,SF03L115:
                            SF03L116,SF03L117,SF03L118,SF03L119:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL      EXITSET2
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
          CALL      CC31G000
          GOTO      SF03L001
.
SF03L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPQTY   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPQTY,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPBQT   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBQT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPACT   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPACT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPBUD   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBUD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPFBU   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPFBU,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPSTD   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPSTD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPCHG   
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPCHG,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L111
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPAA    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L112
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPAB    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L113
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPAF    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPAS    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPTCHG  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPTCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPBA    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPBB    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L118
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPBF    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L119
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,GPBS    
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L120
          CALL      CC31H000
          GOTO      SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.-----------------------------------------
. Read Costing System Parameters
.-----------------------------------------
RCCCO000  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;CCCOYEAR,CCCOPER
          MOVE      CCCOYEAR,SAVEYEAR
          MOVE      CCCOPER,SAVEPER
          MOVE      CCCOYEAR,CCCAYEAR
          MOVE      CCCOPER,CCCAPER
          RETURN

.-----------------------------------------
. Clear Sub Totals
.-----------------------------------------
CC31C000
          MOVE     ZERO,CCTOTQTY
          MOVE     ZERO,CCTOTBUD
          MOVE     ZERO,CCTQTVAR
          MOVE     ZERO,CCTQTPVA
          MOVE     ZERO,CCQTYVAR
          MOVE     ZERO,CCQTYPVA
.
          MOVE     ZERO,CCAVGUC
          MOVE     ZERO,CCAVGUB
          MOVE     ZERO,CCAVGUF
          MOVE     ZERO,CCAVGUS
          MOVE     ZERO,CCTOTUC
          MOVE     ZERO,CCTOTUB
          MOVE     ZERO,CCTOTUF
          MOVE     ZERO,CCTOTUS
.
          MOVE     ZERO,CCTOTTC
          MOVE     ZERO,CCTOTTB
          MOVE     ZERO,CCTOTTF
          MOVE     ZERO,CCTOTTS
          MOVE     ZERO,CLNO
.
          RETURN

.-----------------------------------------
. Patient Service Analysis
.-----------------------------------------
CC31A000    PACK      KEY10,CCPDHCD,CCPDDPT
            CALL      RDCCDP1
            IF        OVRCD=1
              MOVE      "Invalid",CCDPDES
            ENDIF
.
            PACK      KEY24,CCPDHCD,CCPDDPT,CCCAYEAR,CCCAPER,CCPDPCD
            CALL      RDCCME1
            IF        OVRCD=1
              MOVE      ZERO,CCMEQTY
              MOVE      ZERO,CCMECST
              MOVE      ZERO,CCMEFLX
            ENDIF
            CALL      RDCCPS1
            IF        OVRCD=1
              MOVE      ZERO,CCPSQTY
              MOVE      ZERO,CCPSCST
              MOVE      ZERO,CCPSSCT
              MOVE      ZERO,CCPSCHG
            ENDIF
.
            ADD      ONE,CLNO
            ADD      CCPSCST,CCTOTUC
            ADD      CCMECST,CCTOTUB
            ADD      CCMEFLX,CCTOTUF
            ADD      CCPSSCT,CCTOTUS
            ASSIGN   CCTOTUC/CLNO,CCAVGUC
            ASSIGN   CCTOTUB/CLNO,CCAVGUB
            ASSIGN   CCTOTUF/CLNO,CCAVGUF
            ASSIGN   CCTOTUS/CLNO,CCAVGUS
.
            ASSIGN   CCPSCST*CCPSQTY,CCDPTTC
            ASSIGN   CCMECST*CCMEQTY,CCDPTTB
            ASSIGN   CCMEFLX*CCPSQTY,CCDPTTF
            ASSIGN   CCPSSCT*CCPSQTY,CCDPTTS
            ADD      CCDPTTC,CCTOTTC
            ADD      CCDPTTB,CCTOTTB
            ADD      CCDPTTF,CCTOTTF
            ADD      CCDPTTS,CCTOTTS
.
            ASSIGN   CCPSQTY-CCMEQTY,CCQTYVAR
            ASSIGN   ((CCPSQTY-CCMEQTY)/CCMEQTY)*100,CCQTYPVA
            ADD      CCPSQTY,CCTOTQTY
            ADD      CCMEQTY,CCTOTBUD
            ASSIGN   CCTOTQTY-CCTOTBUD,CCTQTVAR
            ASSIGN   ((CCTOTQTY-CCTOTBUD)/CCTOTBUD)*100,CCTQTPVA
.
          RETURN

.-----------------------------------------
. Read Calendar
.-----------------------------------------
CC31B000  PACK      KEY6,SAVEYEAR,SAVEPER
          CALL      RDCCCA1
          RETURN
ECMOD000  MOVE      ZERO,CKEYTYP
          CALL      CCSMOPCL    * Close Model
          CALL      KCCMAA00
          BRANCH    EXIT,ECMOD999,ECMOD999
.
          CALL      CCSMOPOP    * Open Model
          IF        EXIT=1
            MOVE      "Unable to Open Cost Model Files. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      ECMOD000
          ENDIF
ECMOD999  RETURN
.-----------------------------------------
. Unit Cost Analysis
.-----------------------------------------
CC31D000
          CALL      SC01L000
          BRANCH    EXITFLAG,CC31D100
          GOTO      CC31D900
CC31D100
          CALL      SC02L000
          BRANCH    EXITFLAG,CC31D000
CC31D900
          CALL      CC31C000
          IF        EXITFLAG=0
            MOVE      TWO,EXIT
          ENDIF
          RETURN

.-----------------------------------------
. Modify Year/Period
.-----------------------------------------
CCCHYR00  MOVE      "Enter New Year/Period : ",DISPMSG
          CALL      MESSAGE2
          MOVE      "25",CCOL
          MOVE      "24",CVERT
          UNPACK    SP70,CCCAPER,CCCAYEAR
          MOVE      ZERO,CKEYTYP
          CALL      KCCCAB00
          BRANCH    EXIT,CCCHYR99,CCCHYR99
.
          MOVE      "30",CCOL
          DISPLAY   *P29:24,"/"
          MOVE      ZERO,CKEYTYP
          CALL      KCCCAA00
          BRANCH    EXIT,CCCHYR99,CCCHYR99
.
CCCHYR99  CALL      MESSAGE3
          RETURN
.-----------------------------------------
. Unit Cost Analysis
.-----------------------------------------
CC31E000
          CALL      SC02L000
          BRANCH    EXITFLAG,CC31E100
          GOTO      CC31E900
CC31E100
          CALL      SC01L000
          BRANCH    EXITFLAG,CC31E000
CC31E900
          CALL      CC31C000
          IF        EXITFLAG=0
            MOVE      TWO,EXIT
          ENDIF
          RETURN

.------------------------------------------------------------------------------
. Setup Screen Exit Flag
.-----------------------
. This Routine is used to setup EXIT at the end of a Screen it should be used as
. a call after screen. EXITFLAG is set by other function in the screen to
. determine if the calling screen is to be redisplayed or exited.
. EXITFLAG= 0 Exit Screen
.           1 Return to Prompt
.           2 Restart
.           3 Restore Screen
.------------------------------------------------------------------------------
EXITSETF  MOVE      EXITFLAG,EXIT
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET0  MOVE      ZERO,EXITFLAG
          RETURN
.-----------------------------------------
. Modify Procedure Code
.-----------------------------------------
CCCHPR00  MOVE      "Enter New Procedure   : ",DISPMSG
          CALL      MESSAGE2
          MOVE      "25",CCOL
          MOVE      "24",CVERT
          MOVE      ZERO,CKEYTYP
CCCHPR10  CALL      KCCPDB00
          BRANCH    EXIT,CCCHPR10,CCCHPR10
          MOVE      CCPDPCD,CCPSPCD
.
CCCHPR99  CALL      MESSAGE3
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.           4 Restore and Display Fields
.------------------------------------------------------------------------------
EXITSET4  MOVE      FOUR,EXITFLAG
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET1  MOVE      ONE,EXITFLAG
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET2  MOVE      TWO,EXITFLAG
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET3  MOVE      THREE,EXITFLAG
          RETURN
.--------------------------------------------------------------------
. Display Procedure Analysis Graph for CCS37
.--------------------------------------------------------------------
CC31G000
          MOVE    ZERO,F3
          ADD     GPQTY,F3
          ADD     GPBQT,F3
          ADD     GPACT,F3
          ADD     GPBUD,F3
          ADD     GPFBU,F3
          ADD     GPSTD,F3
          ADD     GPCHG,F3
          ADD     GPAA,F3
          ADD     GPAB,F3
          ADD     GPAF,F3
          ADD     GPAS,F3
          ADD     GPTCHG,F3
          ADD     GPBA,F3
          ADD     GPBB,F3
          ADD     GPBF,F3
          ADD     GPBS,F3
          IF      F3>9
            MOVE    "Only 9 Selections Possible - ",DISPMSG
            CALL    MESSAGE1
            RETURN
          ENDIF
.
          CALL    OPNGRAPH
.
          CLEAR   GPHNAME
          APPEND  "Procedure Comparision - ",GPHNAME
          STRIP   CCPDDES
          APPEND  CCPDDES,GPHNAME
          APPEND  " for ",GPHNAME
          STRIP   CCCADES
          APPEND  CCCADES,GPHNAME
          APPEND  SP1,GPHNAME
          APPEND  CCCAYEAR,GPHNAME
          RESET   GPHNAME
.
          MOVE    TEN,GPHNOCOX
          MOVE    "20",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
          IF      GPQTY=1
            MOVE    "Actual Qty",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBQT=1
            MOVE    "Budget Qty",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPACT=1
            MOVE    "Actual Unit Cst",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBUD=1
            MOVE    "Budget Unit Cst",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPFBU=1
            MOVE    "Flex Unit Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPSTD=1
            MOVE    "Std Unit Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPCHG=1
            MOVE    "Av. Charge/Unit",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAA=1
            MOVE    "Actual Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAB=1
            MOVE    "Act Qty * Bud",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAF=1
            MOVE    "Act Qty * Flx",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAS=1
            MOVE    "Act Qty * Std",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPTCHG=1
            MOVE    "Charged",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBA=1
            MOVE    "Bud Qty * Act",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBB=1
            MOVE    "Budget Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBF=1
            MOVE    "Bud Qty * Flx",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBS=1
            MOVE    "Bud Qty * Std",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          MOVE    ZERO,CCPERCNT
          DISPLAY *P70:2,*BLINKON," Loading "
          PACK    KEY24,CCPS3EKY,SP70
          CALL    RSCCPS3
CC31G100
          CALL    RKCCPS3
          BRANCH  OVRCD,CC31G200
          PACK    KEY24,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT
          MATCH   CCPS3EKY,KEY24
          GOTO    CC31G200 IF NOT EQUAL
.
          ADD     ONE,CCPERCNT
          MOVE    CCPERCNT,SCGPPER
          PACK    KEY10,CCPSHCD,CCPSDPT
          CALL    RDCCDP1
          MOVE    CCDPDES,SCGPDES
          MOVE    ONE,F3
.
          IF      GPQTY=1
            ASSIGN   CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPBQT=1
            ASSIGN   CCPSBQT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPACT=1
            ASSIGN   CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPBUD=1
            ASSIGN   CCPSBCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPFBU=1
            ASSIGN   CCPSFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPSTD=1
            ASSIGN   CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPCHG=1
            ASSIGN   CCPSCHG/CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPAA=1
            ASSIGN   CCPSQTY*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPAB=1
            ASSIGN   CCPSQTY*CCPSBCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPAF=1
            ASSIGN   CCPSQTY*CCPSFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPAS=1
            ASSIGN   CCPSQTY*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPTCHG=1
            ASSIGN   CCPSCHG,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPBA=1
            ASSIGN   CCPSBQT*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPBB=1
            ASSIGN   CCPSBQT*CCPSBCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPBF=1
            ASSIGN   CCPSBQT*CCPSFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
.
          IF      GPBS=1
            ASSIGN   CCPSBQT*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31GWRT
          ENDIF
          GOTO    CC31G100
.
CC31G200  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ONE,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
CC31GWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN

.--------------------------------------------------------------------
. Display Periodic Analysis Graph for CCS31
.--------------------------------------------------------------------
CC31H000
          MOVE    ZERO,F3
          ADD     GPQTY,F3
          ADD     GPBQT,F3
          ADD     GPACT,F3
          ADD     GPBUD,F3
          ADD     GPFBU,F3
          ADD     GPSTD,F3
          ADD     GPCHG,F3
          ADD     GPAA,F3
          ADD     GPAB,F3
          ADD     GPAF,F3
          ADD     GPAS,F3
          ADD     GPTCHG,F3
          ADD     GPBA,F3
          ADD     GPBB,F3
          ADD     GPBF,F3
          ADD     GPBS,F3
          IF      F3>1
            MOVE    "Only 1 Selection Possible - ",DISPMSG
            CALL    MESSAGE1
            RETURN
          ENDIF
.
          CALL    OPNGRAPH
.
          CLEAR   GPHNAME
          APPEND  "Procedure ",GPHNAME
.
          IF      GPQTY=1
            APPEND  "Actual Qty - ",GPHNAME
          ENDIF
          IF      GPBQT=1
            APPEND  "Budget Qty - ",GPHNAME
          ENDIF
          IF      GPACT=1
            APPEND  "Actual Unit Cst - ",GPHNAME
          ENDIF
          IF      GPBUD=1
            APPEND  "Budget Unit Cst - ",GPHNAME
          ENDIF
          IF      GPFBU=1
            APPEND  "Flex Unit Cost - ",GPHNAME
          ENDIF
          IF      GPSTD=1
            APPEND  "Std Unit Cost - ",GPHNAME
          ENDIF
          IF      GPCHG=1
            APPEND  "Av. Charge/Unit - ",GPHNAME
          ENDIF
          IF      GPAA=1
            APPEND  "Actual Cost - ",GPHNAME
          ENDIF
          IF      GPAB=1
            APPEND  "Act Qty * Bud - ",GPHNAME
          ENDIF
          IF      GPAF=1
            APPEND  "Act Qty * Flx - ",GPHNAME
          ENDIF
          IF      GPAS=1
            APPEND  "Act Qty * Std - ",GPHNAME
          ENDIF
          IF      GPTCHG=1
            APPEND  "Charges - ",GPHNAME
          ENDIF
          IF      GPBA=1
            APPEND  "Bud Qty * Act - ",GPHNAME
          ENDIF
          IF      GPBB=1
            APPEND  "Budget Cost - ",GPHNAME
          ENDIF
          IF      GPBF=1
            APPEND  "Bud Qty * Flx - ",GPHNAME
          ENDIF
          IF      GPBS=1
            APPEND  "Bud Qty * Std - ",GPHNAME
          ENDIF
.
          STRIP   CCPDDES
          APPEND  CCPDDES,GPHNAME
          RESET   GPHNAME
.
          MOVE    TEN,GPHNOCOX
          MOVE    "20",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
.
          MOVE    SP70,GPHLEDG[1]
          MOVE    SP70,GPHLEDG[2]
          MOVE    SP70,GPHLEDG[3]
          MOVE    SP70,GPHLEDG[4]
          MOVE    SP70,GPHLEDG[5]
          MOVE    SP70,GPHLEDG[6]
          MOVE    SP70,GPHLEDG[7]
          MOVE    SP70,GPHLEDG[8]
          MOVE    SP70,GPHLEDG[9]
          MOVE    ZERO,CCPERCNT
.
          DISPLAY *P70:2,*BLINKON," Loading "
          PACK    KEY8,CCPS3EKY,SP70
          PACK    KEY24,KEY8,SP70
          CALL    RSCCPS3
          CALL    RKCCPS3
          PACK    LASTPRT,CCPSYEAR,CCPSPER
          MOVE    ONE,CCPERCNT
          MOVE    CCPERCNT,SCGPPER
          PACK    KEY24,KEY8,SP70
          CALL    RSCCPS3
CC31H100
          CALL    RKCCPS3
          BRANCH  OVRCD,CC31H200
          PACK    KEY24,CCPSPCD,CCPSYEAR,CCPSPER,CCPSHCD,CCPSDPT
          MATCH   KEY8,KEY24
          GOTO    CC31H200 IF NOT EQUAL
          PACK    KEY6,CCPSYEAR,CCPSPER
          CALL    RDCCCA1
          MOVE    CCCADES,KEY3
          MOVE    CCCATDT,KEY4
          PACK    SCGPDES,KEY3,SP1,KEY4
.
          MATCH   LASTPRT,KEY6
          IF      !@EQUAL
            MOVE    ONE,F3
            ADD     ONE,CCPERCNT
            MOVE    CCPERCNT,SCGPPER
            MOVE    KEY6,LASTPRT
          ENDIF
.
CC31H110
          IF      F3>9
            GOTO    CC31H100
          ENDIF
.
          PACK    KEY10,CCPSHCD,CCPSDPT
          MATCH   SP70,GPHLEDG[F3]
          GOTO    CC31H120 IF EQUAL
          MATCH   KEY10,GPHLEDG[F3]
          GOTO    CC31H120 IF EQUAL
          ADD     ONE,F3
          GOTO    CC31H110

CC31H120  MOVE    KEY10,GPHLEDG[F3]
.
          IF      GPQTY=1
            ASSIGN   CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPBQT=1
            ASSIGN   CCPSBQT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPACT=1
            ASSIGN   CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPBUD=1
            ASSIGN   CCPSBCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPFBU=1
            ASSIGN   CCPSFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPSTD=1
            ASSIGN   CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPCHG=1
            ASSIGN   CCPSCHG/CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPAA=1
            ASSIGN   CCPSQTY*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPAB=1
            ASSIGN   CCPSQTY*CCPSBCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPAF=1
            ASSIGN   CCPSQTY*CCPSFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPAS=1
            ASSIGN   CCPSQTY*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPTCHG=1
            ASSIGN   CCPSCHG,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPBA=1
            ASSIGN   CCPSBQT*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPBB=1
            ASSIGN   CCPSBQT*CCPSBCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPBF=1
            ASSIGN   CCPSBQT*CCPSFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
.
          IF      GPBS=1
            ASSIGN   CCPSBQT*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC31HWRT
          ENDIF
          GOTO    CC31H100
.
CC31H200
          MOVE     ZERO,F3
CC31H210
          ADD      ONE,F3
          MATCH    SP70,GPHLEDG[F3]
          GOTO     CC31H220 IF EQUAL
          MOVE     GPHLEDG[F3],KEY10
          CALL     RDCCDP1
          MOVE     CCDPDES,GPHLEDG[F3]
          COMPARE  NINE,F3
          GOTO     CC31H210 IF NOT EQUAL
          ADD      ONE,F3
.
CC31H220
          SUB      ONE,F3
          MOVE     F3,GPHNTYP
          MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ZERO,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
CC31HWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN

.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCALIO/INC
          INC       CCSCALKY    
          INC       CCSCMAIO/INC
          INC       CCSCMAKY    
          INC       CCSCMEIO/INC
          INC       CCSDPTIO/INC
          INC       CCSMOPCD    
          INC       CCSPCDIO/INC
          INC       CCSPDPIO/INC
          INC       CCSPDPKY    
          INC       CCSPSDIO/INC
          INC       GPHSTDCD    
.
          INC       STDGENCD
.
