.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSUDRKY
.   Routine   :   HFMUDA00 Report Style
.   Return    :
.-------------------------------------------------------------------------------
KUDRFM00
          MOVE      ZERO,CKEYTYP
          CALL      KFMUDA00
          RETURN
.
AUDRFM00
          MOVE      ONE,CKEYTYP
          CALL      KFMUDA00
          RETURN
.
.-------------------------------------------------------------------------------
.
HFMUDA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMUDA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMUDA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Report Style"
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
HFMUDA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMUDSTY
          PACK      KEY3,FMUDSTY,SP70
.
.
          CALL      RSFMUD1
HFMUDA10
          CALL      RKFMUD1
          BRANCH    OVRCD,HFMUDA15
          PACK      KEY3,FMUDSTY,SP70
.
.
          BRANCH    CSEARCH,HFMUDA12
          CALL      HFMUDA60
          BRANCH    OVRCD,HFMUDA10
HFMUDA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMUDSTY
          DISPLAY   *PSTDCOL02:STDROW,FMUDDES
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMUDA10 IF NOT EQUAL
HFMUDA15
.
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMUDA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMUDA30,HFMUDA35,HFMUDA40,HFMUDA45,HFMUDA04:
                              HFMUDA91,HFMUDA50
          GOTO      HFMUDA92
HFMUDA30
          CALL      RKFMUD1
          BRANCH    OVRCD,HFMUDA85
          PACK      KEY3,FMUDSTY,SP70
.
.
          CALL      RPFMUD1
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMUDA10
HFMUDA35
          MOVE      ST1,KEY3
          CALL      RDFMUD1
          CALL      RPFMUD1
          BRANCH    OVRCD,HFMUDA85
          PACK      KEY3,FMUDSTY,SP70
.
.
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMUDA36
          CALL      RPFMUD1
          BRANCH    OVRCD,HFMUDA37
          PACK      KEY3,FMUDSTY,SP70
.
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMUDA36 IF NOT EQUAL
HFMUDA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMUDA10
HFMUDA40
          MOVE      ST1,KEY3
          CALL      RDFMUD1
          CALL      RPFMUD1
          BRANCH    OVRCD,HFMUDA85
          PACK      KEY3,FMUDSTY,SP70
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMUDA08
HFMUDA45
          CALL      RKFMUD1
          BRANCH    OVRCD,HFMUDA85
          PACK      KEY3,FMUDSTY,SP70
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMUD1
HFMUDA46
          CALL      RPFMUD1
          BRANCH    OVRCD,HFMUDA47
          PACK      KEY3,FMUDSTY,SP70
.
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMUDA46 IF NOT EQUAL
HFMUDA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMUDA10
HFMUDA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMUDA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMUDA08
HFMUDA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMUDA08
HFMUDA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMUDA61 IF EQUAL
          MATCH     SCHFLD01,FMUDSTY
          GOTO      HFMUDA72 IF NOT EQUAL
HFMUDA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMUDA62 IF EQUAL
          MATCH     SCHFLD02,FMUDDES
          GOTO      HFMUDA72 IF NOT EQUAL
HFMUDA62
          MATCH     SP70,SCHFLD03
          GOTO      HFMUDA63 IF EQUAL
HFMUDA63
HFMUDA64
HFMUDA65
HFMUDA66
HFMUDA67
HFMUDA68
HFMUDA69
HFMUDA70
          GOTO      HFMUDA75
HFMUDA72  MOVE      ONE,OVRCD
HFMUDA75  RETURN
HFMUDA85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMUDSTY
          CALL      RDFMUD1
HFMUDA90
.
          BEEP
          GOTO      HFMUDA20
HFMUDA91
          MOVE      SP70,FMUDDES
          MOVE      SP70,KEY3
          MOVE      SP70,FMUDSTY
          GOTO      HFMUDA96
HFMUDA92
          MOVE      SP70,KEY3
          MOVE      SP70,FMUDSTY
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMUDSTY
HFMUDA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMUDA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSUDRKY
.   Routine   :   KFMUDA00 Keyin Report Style
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMUDA00
          MOVE      UNDLN70,FMUDSTY
          KEYIN     *PCCOL:CVERT,*DV,FMUDSTY:
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,FMUDSTY:
                    *PCCOL:CVERT,*DV,FMUDSTY
.
          ENDSET    FMUDSTY
          APPEND    SP70,FMUDSTY
          RESET     FMUDSTY
.
          MATCH     SP70,FMUDSTY
          GOTO      KFMUDA90 IF EQUAL
.
          ENDSET    FMUDSTY
          CMATCH    EXITCHAR,FMUDSTY
          GOTO      KFMUDA95 IF EQUAL
.
          CMATCH    QUEST,FMUDSTY
          GOTO      KFMUDA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMUDA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMUDSTY
          APPEND    SP70,FMUDSTY
          RESET     FMUDSTY
.
          MATCH     SP70,FMUDSTY
          GOTO      KFMUDA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMUDSTY
KFMUDA10
          RESET     FMUDSTY
          PACK      KEY3,FMUDSTY,SP70
          CALL      RAFMUD1
          BRANCH    OVRCD,KFMUDA80
          BRANCH    CKEYTYP,KFMUDA75
          CALL      RDFMUD1
KFMUDA70
          MOVE      ZERO,EXIT
          GOTO      KFMUDA99
KFMUDA75
          MOVE      "Report Style Already Exists - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFMUDA00
KFMUDA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMUDA99,KFMUDA99
          MOVE      "Report Style Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFMUDA00
KFMUDA90
          MOVE      ONE,EXIT
          GOTO      KFMUDA99
KFMUDA95
          MOVE      TWO,EXIT
KFMUDA99
          RETURN
