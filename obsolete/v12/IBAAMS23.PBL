.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.02  20.12.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Sear
.           srf 631485
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS23
.   Function      :   Asset Insurance Enquiries               
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSACMFD/INC
          INC       AMSCODFD/INC
          INC       AMSDEPFD/INC
          INC       AMSGILFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld    11
.-------------------------------------------------------
AMIN2NAM  INIT      "AMIN2"
AMIN2END  FORM      1   * End Display
AMIN2SNO  FORM      5   * Number of Items on the Screen
AMIN2MKY  DIM       127 * Match Key 
AMIN2EKY  DIM       127 * End Key
AMIN2SKY  DIM       127 * Start Key
AMIN2IDX  INIT      " 132 UC1-5"
AMIN2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMIN2FNM  DIM       8  * Filename
AMIN2CNT  FORM      3  * Number of Items on Screen
POLICY    DIM      30 * Scr 02 Fld     1
.
.    Multi Item Key Fields Scr 02 Fld     3
.-------------------------------------------------------
AMIN4NAM  INIT      "AMIN4"
AMIN4END  FORM      1   * End Display
AMIN4SNO  FORM      5   * Number of Items on the Screen
AMIN4MKY  DIM       127 * Match Key 
AMIN4EKY  DIM       127 * End Key
AMIN4SKY  DIM       127 * Start Key
AMIN4IDX  INIT      " 132 UC1-5"
AMIN4FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMIN4FNM  DIM       8  * Filename
AMIN4CNT  FORM      3  * Number of Items on Screen
FROMYEAR  DIM       4 * Scr 03 Fld     1
.
.    Multi Item Key Fields Scr 03 Fld     3
.-------------------------------------------------------
AMIN3NAM  INIT      "AMIN3"
AMIN3END  FORM      1   * End Display
AMIN3SNO  FORM      5   * Number of Items on the Screen
AMIN3MKY  DIM       127 * Match Key 
AMIN3EKY  DIM       127 * End Key
AMIN3SKY  DIM       127 * Start Key
AMIN3IDX  INIT      " 132 UC1-5"
AMIN3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMIN3FNM  DIM       8  * Filename
AMIN3CNT  FORM      3  * Number of Items on Screen
ADTDESC   DIM      35 * Scr AD Fld    18
ACCOPEN   FORM     12.2 * Scr AD Fld    19
TDTDESC   DIM      35 * Scr AD Fld    21
TAXOPEN   FORM     12.2 * Scr AD Fld    22
.
.Word Processor File * Scr AD Fld    57
.
NAMAMAC1  INIT      "Wamac1"
FILAMAC1  DIM       8
.
TYPDESC   DIM      35 * Scr AD Fld    59
DPTDESC   DIM      35 * Scr AD Fld    60
BLDDESC   DIM      35 * Scr AD Fld    61
SOFDESC   DIM      35 * Scr AD Fld    63
UC1DESC   DIM      35 * Scr AD Fld    64
UC2DESC   DIM      35 * Scr AD Fld    65
UC3DESC   DIM      35 * Scr AD Fld    66
UC4DESC   DIM      35 * Scr AD Fld    67
PMTDESC   DIM      35 * Scr AD Fld   103
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS23"
PRGNAM    INIT      "Asset Insurance Enquiries               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     AMIN2FL1,DELETE
.
          CLOSE     AMIN4FL1,DELETE
.
          CLOSE     AMIN3FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening amsacmaf";
          OPEN      AMSACMA1,"amsacmaf"
          MOVE      "    3",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudin";
            OPEN      AMSAUDIN,"amsaudin"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudle";
            OPEN      AMSAUDLE,"amsaudle"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudma";
            OPEN      AMSAUDMA,"amsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA2,"amscodaf"
          DISPLAY   *P56:24,"Opening amsdepaf";
          OPEN      AMSDEPA1,"amsdepaf"
          DISPLAY   *P56:24,"Opening amsgilaf";
          OPEN      AMSGILA1,"amsgilaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA2,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA3,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA4,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA2,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA3,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA4,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA5,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
.--------------------------------------------------------
. Initialise Batch Screen POLICY REFERENCE                   
.--------------------------------------------------------
          MOVE     ZERO,AMIN2SNO
          MOVE     "01   11",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMIN2SNO
            ENDIF
          ENDIF
          PACK      AMIN2FNM,ANST,AMIN2NAM,PORT
          REP       " 0",AMIN2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMIN2FL1,AMIN2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMIN2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMIN2FNM,AMIN2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMIN2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMIN2FL1,AMIN2FNM
.--------------------------------------------------------
. Initialise Batch Screen Insurance Company Code             
.--------------------------------------------------------
          MOVE     ZERO,AMIN4SNO
          MOVE     "02    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMIN4SNO
            ENDIF
          ENDIF
          PACK      AMIN4FNM,ANST,AMIN4NAM,PORT
          REP       " 0",AMIN4FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMIN4FL1,AMIN4FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMIN4FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMIN4FNM,AMIN4IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMIN4FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMIN4FL1,AMIN4FNM
.--------------------------------------------------------
. Initialise Batch Screen Renewal Date                       
.--------------------------------------------------------
          MOVE     ZERO,AMIN3SNO
          MOVE     "03    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMIN3SNO
            ENDIF
          ENDIF
          PACK      AMIN3FNM,ANST,AMIN3NAM,PORT
          REP       " 0",AMIN3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMIN3FL1,AMIN3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMIN3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMIN3FNM,AMIN3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMIN3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMIN3FL1,AMIN3FNM
.--------------------------------------------------------
. Initialise Wp Filename for Asset Comments                     
.--------------------------------------------------------
          PACK      FILAMAC1,NAMAMAC1,PORT
          REP       " 0",FILAMAC1
          DISPLAY   *P56:24,"Create & Open ",FILAMAC1;
          PREP      TEMPWORD,FILAMAC1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Enquire by Insurance Company       
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Insurance by Policy Reference      
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Insurance by Renewal Date          
          ENDIF
          MATCH     "AD",SCRID
          IF         @EQUAL
            CALL       PSADL000   * Asset Details                      
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Enquire by Insurance Company       
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Enquire by Insurance Company       
.-------------------------------------------------------
CF01L000
          MOVE      SP70,AMINCOM 
          MOVE      SP70,AMINREF 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Enquire by Insurance Company       
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          MOVE      APMACRD,AMINCOM
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      AMINCOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Enquire by Insurance Company       
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Enquire by Insurance Company       
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :    11 POLICY REFERENCE                   
.---------------------------------------------------------
          UNPACK    SP70,AMINCOM,AMINREF,AMINREG,AMINASS
          PACK      KEY49,APMACRD,SP70
          MOVE      KEY49,AMIN2EKY
          STRIP     AMIN2SKY
          SETLPTR   AMIN2EKY,5
          MOVE      AMIN2EKY,AMIN2SKY
          CALL      RDAMIN2 
          IF        OVRCD=0
            CALL      RPAMIN2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,AMIN2CNT
          MOVE     ZERO,AMIN2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L101,DP01L102:
                            DP01L103,DP01L104,DP01L105,DP01L106:
                            DP01L107,DP01L108,DP01L109,DP01L110:
                            DP01L111,DP01L112,DP01L113,DP01L114:
                            DP01L115,DP01L116,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          PACK      AMIN2MKY,SP70,SP70
          CALL      UPTAMIN2
          IF        AMIN2END=0
            CALL      RKAMIN2 
            IF        OVRCD=0
              PACK      AMIN2MKY,AMINCOM,AMINREF,AMINREG,AMINASS                                                
              MATCH     AMIN2EKY,AMIN2MKY
              IF        @EQUAL
                MOVE      ZERO,AMIN2END
                ADD       ONE,AMIN2CNT
                CALL      UPTAMIN2
          CALL      GETINS00
                MOVE      AMINREF,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMIN2END
              ENDIF
            ELSE
              MOVE      ONE,AMIN2END
            ENDIF
          ENDIF
          IF        AMIN2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        AMIN2END=0
            MOVE      AMINREG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        AMIN2END=0
            MOVE      AMINASS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        AMIN2END=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        AMIN2END=0
            MOVE      AMINCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L106
          IF        AMIN2END=0
            UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L107
          IF        AMIN2END=0
            MOVE      AMINVAL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L108
          IF        AMIN2END=0
            MOVE      AMINAPR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L109
          IF        AMIN2END=0
            MOVE      AMINUA1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L110
          IF        AMIN2END=0
            MOVE      AMINUA2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L111
          IF        AMIN2END=0
            MOVE      AMINUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L112
          IF        AMIN2END=0
            MOVE      AMINUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L113
          IF        AMIN2END=0
            UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L114
          IF        AMIN2END=0
            UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L115
          IF        AMIN2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMINUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L116
          IF        AMIN2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMINUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "AMIN2",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          MATCH    "AMIN2",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          PACK     KEY49,AMIN2SKY,SP70
          CALL     RDAMIN2  * Start
          IF       OVRCD=0
            CALL     RPAMIN2  * Start
          ENDIF
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          MATCH    "AMIN2",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY49,AMIN2SKY,Z70
          CALL     RSAMIN2  * End
          IF       OVRCD=1
            CALL     RPAMIN2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMIN2SNO
            CALL     RPAMIN2 
            IF       OVRCD=1
              MOVE     AMIN2SNO,SECTOR
            ENDIF
            PACK     AMIN2MKY,AMINCOM,AMINREF,AMINREG,AMINASS                                                
            MATCH    AMIN2EKY,AMIN2MKY
            IF       !@EQUAL
              MOVE     AMIN2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
          MATCH    "AMIN2",NAMSSFFI
          GOTO     PP01L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP01L105
          CALL      RFTAMIN2
          BRANCH   OVRCD,PP01L115
          MOVE      AMIN2MKY,KEY49 
          CALL      RSAMIN2 
PP01L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMIN2SNO
            CALL     RPAMIN2 
            IF       OVRCD=1
              MOVE     AMIN2SNO,SECTOR
            ENDIF
            PACK     AMIN2MKY,AMINCOM,AMINREF,AMINREG,AMINASS                                                
            MATCH    AMIN2EKY,AMIN2MKY
            IF       !@EQUAL
              MOVE     AMIN2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMIN2SNO
            CALL     RKAMIN2 
            IF       OVRCD=1
              MOVE     AMIN2SNO,SECTOR
            ENDIF
            PACK     AMIN2MKY,AMINCOM,AMINREF,AMINREG,AMINASS                                                
            MATCH    AMIN2EKY,AMIN2MKY
            IF       !@EQUAL
              MOVE     AMIN2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP01L999
PP01L120
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "AMIN2",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          CALL     RKAMIN2 
          BRANCH   OVRCD,NP01L110
          PACK     AMIN2MKY,AMINCOM,AMINREF,AMINREG,AMINASS                                                
          MATCH    AMIN2EKY,AMIN2MKY
          GOTO     NP01L110 IF NOT EQUAL
          CALL     RPAMIN2 
          CALL     DP01L000
          GOTO     NP01L999
NP01L110
          CALL     RPAMIN2 
          BEEP
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
CT01L105
CT01L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Enquire by Insurance Company       
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    11 POLICY REFERENCE                   
.---------------------------------------------------------
UPTAMIN2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMIN2FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMIN2FL1,KEY5;SCPSROW,SCPSCOL,AMIN2MKY
          ELSE
            UPDATE    AMIN2FL1;SCPSROW,SCPSCOL,AMIN2MKY
          ENDIF
          RETURN
RDTAMIN2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMIN2FL1,KEY5;SCPSROW,SCPSCOL,AMIN2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMIN2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMIN2FL1,KEY5;;
          READKS    AMIN2FL1;SCPSROW,SCPSCOL,AMIN2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMIN2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Enquire by Insurance Company       
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "AMIN2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Enquire by Insurance Company       
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L101,PS01L102,PS01L103:
                            PS01L104,PS01L105,PS01L106,PS01L107:
                            PS01L108,PS01L109,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Enquire by Insurance Company       
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L101,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L102,SF01L103:
                            SF01L006,SF01L006,SF01L104,SF01L105:
                            SF01L006,SF01L106,SF01L107
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L101,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "AMIN2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          COMPARE   ONE,ACCEPT
          GOTO      SF01L001 IF EQUAL
          CALL      RDTAMIN2
          IF        OVRCD=1
            BEEP
            GOTO      SF01L001
          ENDIF
          MATCH     SP70,AMIN2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF01L001
          ENDIF
          MOVE      AMIN2MKY,KEY49 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELASS00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMIN2
          IF        OVRCD=1
            CALL      FP01L000
          ELSE
            MOVE      AMIN2MKY,KEY49 
            CALL      RSAMIN2 
            CALL      RPAMIN2 
            CALL      DP01L000
          ENDIF
          GOTO     SF01L001
.
SF01L102
          MOVE      "AMIN2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L103
          MOVE      "AMIN2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L104
          MOVE      "AMIN2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      "AMIN2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L107
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Insurance by Policy Reference      
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insurance by Policy Reference      
.-------------------------------------------------------
CF02L000
          MOVE      SP70,POLICY  
          MOVE      SP70,AMINCOM 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insurance by Policy Reference      
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EPOL0000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      POLICY,VAR       
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insurance by Policy Reference      
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insurance by Policy Reference      
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     3 Insurance Company Code             
.---------------------------------------------------------
          UNPACK    SP70,AMINREF,AMINCOD,AMINREG,AMINASS
          PACK      KEY74,POLICY
          MOVE      KEY74,AMIN4EKY
          STRIP     AMIN4SKY
          SETLPTR   AMIN4EKY,30
          MOVE      AMIN4EKY,AMIN4SKY
          CALL      RDAMIN4 
          IF        OVRCD=0
            CALL      RPAMIN4 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,AMIN4CNT
          MOVE     ZERO,AMIN4END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L105,DP02L106:
                            DP02L107,DP02L108,DP02L109,DP02L110:
                            DP02L111,DP02L112,DP02L113,DP02L114:
                            DP02L115,DP02L116,DP02L117,DP02L118:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      AMIN4MKY,SP70,SP70
          CALL      UPTAMIN4
          IF        AMIN4END=0
            CALL      RKAMIN4 
            IF        OVRCD=0
              PACK      AMIN4MKY,AMINREF,AMINCOD,AMINREG,AMINASS                                                
              MATCH     AMIN4EKY,AMIN4MKY
              IF        @EQUAL
                MOVE      ZERO,AMIN4END
                ADD       ONE,AMIN4CNT
                CALL      UPTAMIN4
          CALL      GETINS00
                MOVE      AMINCOM,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMIN4END
              ENDIF
            ELSE
              MOVE      ONE,AMIN4END
            ENDIF
          ENDIF
          IF        AMIN4END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        AMIN4END=0
            MOVE      AMINREG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        AMIN4END=0
            MOVE      AMINASS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        AMIN4END=0
            MOVE      AMINREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        AMIN4END=0
            MOVE      AMINCOD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        AMIN4END=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        AMIN4END=0
            MOVE      AMINCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        AMIN4END=0
            UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        AMIN4END=0
            MOVE      AMINVAL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        AMIN4END=0
            MOVE      AMINAPR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        AMIN4END=0
            MOVE      AMINUA1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        AMIN4END=0
            MOVE      AMINUA2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        AMIN4END=0
            MOVE      AMINUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        AMIN4END=0
            MOVE      AMINUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        AMIN4END=0
            UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        AMIN4END=0
            UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        AMIN4END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMINUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        AMIN4END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMINUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "AMIN4",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "AMIN4",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY74,AMIN4SKY,SP70
          CALL     RDAMIN4  * Start
          IF       OVRCD=0
            CALL     RPAMIN4  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "AMIN4",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY74,AMIN4SKY,Z70
          CALL     RSAMIN4  * End
          IF       OVRCD=1
            CALL     RPAMIN4 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMIN4SNO
            CALL     RPAMIN4 
            IF       OVRCD=1
              MOVE     AMIN4SNO,SECTOR
            ENDIF
            PACK     AMIN4MKY,AMINREF,AMINCOD,AMINREG,AMINASS                                                
            MATCH    AMIN4EKY,AMIN4MKY
            IF       !@EQUAL
              MOVE     AMIN4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "AMIN4",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTAMIN4
          BRANCH   OVRCD,PP02L115
          MOVE      AMIN4MKY,KEY74 
          CALL      RSAMIN4 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMIN4SNO
            CALL     RPAMIN4 
            IF       OVRCD=1
              MOVE     AMIN4SNO,SECTOR
            ENDIF
            PACK     AMIN4MKY,AMINREF,AMINCOD,AMINREG,AMINASS                                                
            MATCH    AMIN4EKY,AMIN4MKY
            IF       !@EQUAL
              MOVE     AMIN4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMIN4SNO
            CALL     RKAMIN4 
            IF       OVRCD=1
              MOVE     AMIN4SNO,SECTOR
            ENDIF
            PACK     AMIN4MKY,AMINREF,AMINCOD,AMINREG,AMINASS                                                
            MATCH    AMIN4EKY,AMIN4MKY
            IF       !@EQUAL
              MOVE     AMIN4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "AMIN4",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKAMIN4 
          BRANCH   OVRCD,NP02L110
          PACK     AMIN4MKY,AMINREF,AMINCOD,AMINREG,AMINASS                                                
          MATCH    AMIN4EKY,AMIN4MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPAMIN4 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPAMIN4 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Insurance by Policy Reference      
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Insurance Company Code             
.---------------------------------------------------------
UPTAMIN4
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMIN4FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMIN4FL1,KEY5;SCPSROW,SCPSCOL,AMIN4MKY
          ELSE
            UPDATE    AMIN4FL1;SCPSROW,SCPSCOL,AMIN4MKY
          ENDIF
          RETURN
RDTAMIN4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMIN4FL1,KEY5;SCPSROW,SCPSCOL,AMIN4MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMIN4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMIN4FL1,KEY5;;
          READKS    AMIN4FL1;SCPSROW,SCPSCOL,AMIN4MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMIN4MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Insurance by Policy Reference      
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "AMIN4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insurance by Policy Reference      
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          CALL      STRKEY00
          MOVE      ANS,VAR          
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Insurance by Policy Reference      
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L101,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L102,SF02L103,SF02L104,SF02L105:
                            SF02L106,SF02L107,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L101,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "AMIN4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTAMIN4
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,AMIN4MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      AMIN4MKY,KEY74 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELASS00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMIN4
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      AMIN4MKY,KEY74 
            CALL      RSAMIN4 
            CALL      RPAMIN4 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "AMIN4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "AMIN4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "AMIN4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "AMIN4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L107
          MOVE      ONE,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Insurance by Renewal Date          
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insurance by Renewal Date          
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMYEAR
          MOVE      SP70,AMINDAT 
          MOVE      SP70,AMINREG 
          MOVE      SP70,AMINASS 
          MOVE      SP70,AMINCOM 
          MOVE      SP70,AMINCOD 
          MOVE      SP70,AMINREF 
          MOVE      SP70,AMINCON 
          MOVE      SP70,AMMADES 
          MOVE      ZERO,AMINVAL 
          MOVE      ZERO,AMINAPR 
          MOVE      ZERO,AMINUA1 
          MOVE      ZERO,AMINUA2 
          MOVE      SP70,AMINUR1 
          MOVE      SP70,AMINUR2 
          MOVE      SP70,AMINUD1 
          MOVE      SP70,AMINUD2 
          MOVE      SP70,AMINUY1 
          MOVE      SP70,AMINUY2 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insurance by Renewal Date          
.--------------------------------------------------------
KY03L000
.
KY03L110
          CALL      DATECURR
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KYEAR000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      FROMYEAR,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insurance by Renewal Date          
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insurance by Renewal Date          
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     3 Renewal Date                       
.---------------------------------------------------------
          UNPACK    SP70,AMINDAT,AMINREG,AMINASS
          PACK      KEY22,FROMYEAR,SP70
          MOVE      KEY22,AMIN3EKY
          STRIP     AMIN3SKY
          SETLPTR   AMIN3EKY,4
          MOVE      AMIN3EKY,AMIN3SKY
          CALL      RDAMIN3 
          IF        OVRCD=0
            CALL      RPAMIN3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,AMIN3CNT
          MOVE     ZERO,AMIN3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L101,DP03L102:
                            DP03L103,DP03L104,DP03L105,DP03L106:
                            DP03L107,DP03L108,DP03L109,DP03L110:
                            DP03L111,DP03L112,DP03L113,DP03L114:
                            DP03L115,DP03L116,DP03L117,DP03L118:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          PACK      AMIN3MKY,SP70,SP70
          CALL      UPTAMIN3
          IF        AMIN3END=0
            CALL      RKAMIN3 
            IF        OVRCD=0
              PACK      AMIN3MKY,AMINDAT,AMINREG,AMINASS                                                        
              MATCH     AMIN3EKY,AMIN3MKY
              IF        @EQUAL
                MOVE      ZERO,AMIN3END
                ADD       ONE,AMIN3CNT
                CALL      UPTAMIN3
          CALL      GETINS00
                UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMIN3END
              ENDIF
            ELSE
              MOVE      ONE,AMIN3END
            ENDIF
          ENDIF
          IF        AMIN3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        AMIN3END=0
            MOVE      AMINREG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        AMIN3END=0
            MOVE      AMINASS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        AMIN3END=0
            MOVE      AMINCOM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        AMIN3END=0
            MOVE      AMINCOD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L106
          IF        AMIN3END=0
            MOVE      AMINREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L107
          IF        AMIN3END=0
            MOVE      AMINCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L108
          IF        AMIN3END=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L109
          IF        AMIN3END=0
            MOVE      AMINVAL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L110
          IF        AMIN3END=0
            MOVE      AMINAPR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L111
          IF        AMIN3END=0
            MOVE      AMINUA1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L112
          IF        AMIN3END=0
            MOVE      AMINUA2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L113
          IF        AMIN3END=0
            MOVE      AMINUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L114
          IF        AMIN3END=0
            MOVE      AMINUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L115
          IF        AMIN3END=0
            UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L116
          IF        AMIN3END=0
            UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L117
          IF        AMIN3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMINUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L118
          IF        AMIN3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMINUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "AMIN3",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "AMIN3",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY22,AMIN3SKY,SP70
          CALL     RDAMIN3  * Start
          IF       OVRCD=0
            CALL     RPAMIN3  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "AMIN3",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY22,AMIN3SKY,Z70
          CALL     RSAMIN3  * End
          IF       OVRCD=1
            CALL     RPAMIN3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMIN3SNO
            CALL     RPAMIN3 
            IF       OVRCD=1
              MOVE     AMIN3SNO,SECTOR
            ENDIF
            PACK     AMIN3MKY,AMINDAT,AMINREG,AMINASS                                                        
            MATCH    AMIN3EKY,AMIN3MKY
            IF       !@EQUAL
              MOVE     AMIN3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "AMIN3",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          CALL      RFTAMIN3
          BRANCH   OVRCD,PP03L115
          MOVE      AMIN3MKY,KEY22 
          CALL      RSAMIN3 
PP03L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMIN3SNO
            CALL     RPAMIN3 
            IF       OVRCD=1
              MOVE     AMIN3SNO,SECTOR
            ENDIF
            PACK     AMIN3MKY,AMINDAT,AMINREG,AMINASS                                                        
            MATCH    AMIN3EKY,AMIN3MKY
            IF       !@EQUAL
              MOVE     AMIN3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMIN3SNO
            CALL     RKAMIN3 
            IF       OVRCD=1
              MOVE     AMIN3SNO,SECTOR
            ENDIF
            PACK     AMIN3MKY,AMINDAT,AMINREG,AMINASS                                                        
            MATCH    AMIN3EKY,AMIN3MKY
            IF       !@EQUAL
              MOVE     AMIN3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "AMIN3",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RKAMIN3 
          BRANCH   OVRCD,NP03L110
          PACK     AMIN3MKY,AMINDAT,AMINREG,AMINASS                                                        
          MATCH    AMIN3EKY,AMIN3MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RPAMIN3 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RPAMIN3 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Insurance by Renewal Date          
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Renewal Date                       
.---------------------------------------------------------
UPTAMIN3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMIN3FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMIN3FL1,KEY5;SCPSROW,SCPSCOL,AMIN3MKY
          ELSE
            UPDATE    AMIN3FL1;SCPSROW,SCPSCOL,AMIN3MKY
          ENDIF
          RETURN
RDTAMIN3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMIN3FL1,KEY5;SCPSROW,SCPSCOL,AMIN3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMIN3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMIN3FL1,KEY5;;
          READKS    AMIN3FL1;SCPSROW,SCPSCOL,AMIN3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMIN3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Insurance by Renewal Date          
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "AMIN3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insurance by Renewal Date          
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Insurance by Renewal Date          
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L101,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L101,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "AMIN3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          COMPARE   ONE,ACCEPT
          GOTO      SF03L001 IF EQUAL
          CALL      RDTAMIN3
          IF        OVRCD=1
            BEEP
            GOTO      SF03L001
          ENDIF
          MATCH     SP70,AMIN3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF03L001
          ENDIF
          MOVE      AMIN3MKY,KEY22 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELASS00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMIN3
          IF        OVRCD=1
            CALL      FP03L000
          ELSE
            MOVE      AMIN3MKY,KEY22 
            CALL      RSAMIN3 
            CALL      RPAMIN3 
            CALL      DP03L000
          ENDIF
          GOTO     SF03L001
.
SF03L102
          MOVE      "AMIN3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L103
          MOVE      "AMIN3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "AMIN3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "AMIN3",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L107
          MOVE      ONE,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Asset Details                      
.--------------------------------
SCADL000
SCADL100
          MOVE      "AD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCADL200
          CALL      CFADL000 * Clear Fields
SCADL300
          CALL      KYADL000 * Enter Key Fields
          BRANCH    EXIT,SCADL999,SCADL999
SCADL400
          CALL      WPADL000 * Load any WP Details
SCADL500
          CALL      LMADL000 * Load any Batch Details
SCADL600
          CALL      DFADL000 * Display Fields
SCADL700
          CALL      SFADL000 * Select Fields
          BRANCH    EXIT,SCADL100,SCADL100,SCADL200
SCADL800
SCADL900
SCADL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Details                      
.-------------------------------------------------------
CFADL000
CFADL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Details                      
.--------------------------------------------------------
KYADL000
          MOVE      ZERO,EXIT
          GOTO      KYADL999
.
KYADL900  MOVE      ONE,EXIT
KYADL999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Details                      
.---------------------------------------------------------
WPADL000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPADL100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPADL105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPADL105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPADL100
WPADL105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Details                      
.---------------------------------------------------------
LMADL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Details                      
.---------------------------------------------------------
DFADL000
          BRANCH   ACCEPT,DFADL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFADL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFADL900
          MATCH    PRGID,SCPSPID
          GOTO     DFADL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFADL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFADL010 IF NOT EQUAL
.
          CALL     PSADL000 * Display Field
          GOTO     DFADL010
DFADL900
DFADL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Details                      
.---------------------------------------------------------
PSADL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSADL101,PSADL102,PSADL103,PSADL104:
                            PSADL105,PSADL106,PSADL107,PSADL108:
                            PSADL109,PSADL110,PSADL111,PSADL112:
                            PSADL113,PSADL114,PSADL115,PSADL999:
                           PSADL116,PSADL117,PSADL118,PSADL119:
                            PSADL120,PSADL121,PSADL122,PSADL123:
                            PSADL124,PSADL125,PSADL126,PSADL127:
                            PSADL128,PSADL129,PSADL130,PSADL131:
                            PSADL132,PSADL133,PSADL134,PSADL135:
                            PSADL136,PSADL137,PSADL138,PSADL139:
                            PSADL140,PSADL141,PSADL142,PSADL143:
                            PSADL144,PSADL145,PSADL146,PSADL147:
                            PSADL148,PSADL149,PSADL150,PSADL151:
                            PSADL152,PSADL153,PSADL154,PSADL155:
                            PSADL156,PSADL157,PSADL158,PSADL159:
                            PSADL160,PSADL161,PSADL162,PSADL163:
                            PSADL164,PSADL165,PSADL166,PSADL167:
                            PSADL999,PSADL999,PSADL168,PSADL169:
                            PSADL170,PSADL171,PSADL172,PSADL173:
                            PSADL174,PSADL175,PSADL176,PSADL177:
                            PSADL178,PSADL179,PSADL180,PSADL181:
                            PSADL182,PSADL183,PSADL184,PSADL185:
                            PSADL186,PSADL187,PSADL188,PSADL189:
                            PSADL190,PSADL191,PSADL192,PSADL193:
                            PSADL194,PSADL195,PSADL196,PSADL197:
                            PSADL198,PSADL199,PSADL200,PSADL201
          GOTO     PSADL999
.
PSADL101
          MOVE      AMMAREG,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL102
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL103
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL104
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL105
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL106
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL107
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL108
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL112
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL113
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL114
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL115
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL116
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL117
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL118
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL119
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL120
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL121
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL122
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL123
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL124
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL125
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL126
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL127
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL128
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL129
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL130
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL131
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL132
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL133
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL134
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL135
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL136
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL137
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL138
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL139
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL140
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL141
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL142
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL143
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL144
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL145
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL146
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL147
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL148
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL149
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL150
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL151
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL154
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL155
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL156
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSADL999
.
PSADL157
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL158
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL159
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL160
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL161
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL162
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL163
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL164
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL165
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL166
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL167
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL168
          MOVE      AMINCOM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL169
          MOVE      AMINCOD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL170
          MOVE      AMINREF,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL171
          MOVE      AMINCON,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL172
          UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL173
          MOVE      AMINVAL,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL174
          MOVE      AMINAPR,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL175
          MOVE      AMINUA1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL176
          MOVE      AMINUA2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL177
          MOVE      AMINUR1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL178
          MOVE      AMINUR2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL179
          UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL180
          UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL181
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL182
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL183
          MOVE      AMLECOM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL184
          MOVE      AMLECNM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL185
          MOVE      AMLEREF,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL186
          MOVE      AMLECON,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL187
          UNPACK    AMLEDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL188
          MOVE      AMLEPER,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL189
          MOVE      AMLEINS,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL190
          MOVE      AMLEPMT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL191
          MOVE      AMLERES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL192
          MOVE      AMLEUA1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL193
          MOVE      AMLEUA2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL194
          MOVE      AMLEUR1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL195
          MOVE      AMLEUR2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL196
          UNPACK    AMLEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL197
          UNPACK    AMLEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL198
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL199
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL200
          MOVE      PMTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL201
          UNPACK    AMLEEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
PSADL999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Details                      
.---------------------------------------------------------
SFADL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFADL001  BRANCH   ACCEPT,SFADL020
.
SFADL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                           SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL101,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL102,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006
SFADL006  BEEP
          GOTO     SFADL005
SFADL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFADL090
          MATCH    PRGID,SCSLPID
          GOTO     SFADL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFADL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                           SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL101,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020
          GOTO     SFADL020
SFADL090  MOVE     ZERO,ACCEPT
          GOTO     SFADL001
.
SFADL101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SFADL001
.
SFADL102
          MOVE      ZERO,EXIT
          GOTO      SFADL999
SFADL990  MOVE      ONE,EXIT * Exit Char Restart
SFADL999  RETURN
.@@@@@ Function Restart Point @@@@@
.---------------------------------------
. Read Asset Description
.---------------------------------------
GETINS00  PACK     KEY14,AMINREG,AMINASS
          CALL     RDAMMA1
          RETURN
.---------------------------------------
. Display Selected Asset Details
.---------------------------------------
SELASS00  MATCH     "01",SCRID
          GOTO     SELASS10 IF NOT EQUAL
          UNPACK   AMIN2MKY,AMINCOM,AMINREF,AMINREG,AMINASS
          GOTO     SELASS30
.
SELASS10  MATCH     "02",SCRID
          GOTO     SELASS20 IF NOT EQUAL
          UNPACK   AMIN4MKY,AMINREF,AMINCOD,AMINREG,AMINASS
          GOTO     SELASS30
.
SELASS20  UNPACK   AMIN3MKY,AMINDAT,AMINREG,AMINASS
.
SELASS30  PACK     KEY2,AMINREG
          CALL     RDAMRE1
          PACK     KEY14,AMINREG,AMINASS
          CALL     RDAMMA1
          CALL     RDAMLE1
          CALL     RDAMIN1
          CALL     GASST000
.
          ASSIGN    AMMACST+AMMARVT-AMMATAD,TAXOPEN
          ASSIGN    AMMACST+AMMARVT-AMMAAAD,ACCOPEN
.
          CALL     SCADL000
.
          RETURN
GASST000
          MOVE      SP70,DPTDESC
          MATCH     SP70,AMMADPT
          IF        !@EQUAL
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADPT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DPTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,BLDDESC
          MATCH     SP70,AMMABLD
          IF        !@EQUAL
            MOVE      "BL",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMABLD
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,BLDDESC
            ENDIF
            PACK      KEY9,AMMABLD,AMMALOC
            CALL      RDAMLO1
          ENDIF
.
          MATCH     SP70,AMMASUPC
          IF        !@EQUAL
            MOVE      AMMASUPC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMASUPN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAMANC
          IF        !@EQUAL
            MOVE      AMMAMANC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMAMANN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAGIC
          IF        !@EQUAL
            MOVE      AMMAGIC,KEY5
            CALL      RDAMGI1
          ENDIF
.
          MOVE      SP70,SOFDESC
          MATCH     SP70,AMMASOF
          IF        !@EQUAL
            MOVE      "SF",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMASOF
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,SOFDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC1DESC
          MATCH     SP70,AMMAUC1
          IF        !@EQUAL
            MOVE      "A1",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC1
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC1DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC2DESC
          MATCH     SP70,AMMAUC2
          IF        !@EQUAL
            MOVE      "A2",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC2
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC2DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC3DESC
          MATCH     SP70,AMMAUC3
          IF        !@EQUAL
            MOVE      "A3",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC3
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC3DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC4DESC
          MATCH     SP70,AMMAUC4
          IF        !@EQUAL
            MOVE      "A4",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC4
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC4DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TYPDESC
          MATCH     SP70,AMMATYP
          IF        !@EQUAL
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMATYP
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,TYPDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,ADTDESC
          MATCH     SP70,AMMAADT
          IF        !@EQUAL
            PACK      KEY4,AMMAADT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,ADTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TDTDESC
          MATCH     SP70,AMMATDT
          IF        !@EQUAL
            PACK      KEY4,AMMATDT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,TDTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,PMTDESC
          MATCH     SP70,AMLEPMT
          IF        !@EQUAL
            MOVE      "PM",AMCDCAT
            PACK      KEY5,AMCDCAT,AMLEPMT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,PMTDESC
            ENDIF
          ENDIF
.
          RETURN
.-----------------
. Strip End Key
.-----------------
STRKEY00  STRIP     AMIN4EKY
          RETURN
.
EPOL0000  STRIP     POLICY
          SFORMAT   VAR,SCPSLEN
          MOVE      POLICY,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,POLICY
          ENDSET    POLICY
          APPEND    SP70,POLICY
          RESET     POLICY
          CMATCH    EXITCHAR,POLICY
          GOTO      EPOL9900 IF EQUAL
          MATCH     SP70,POLICY
          GOTO      EPOL9900 IF EQUAL
          MOVE      ZERO,EXIT
          STRIP     POLICY
          GOTO      EPOL9999
.
EPOL9900  MOVE      TWO,EXIT
.
EPOL9999  RETURN
DATECURR  MOVE      CDD,CDAY
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          REP       " 0",CYEAR
          REP       " 0",CMON
          REP       " 0",CDAY
          RETURN
.---------------------------------------
. Enter From Year
.---------------------------------------
KYEAR000  PACK     FROMYEAR,CCC,CYY
          REP      " 0",FROMYEAR
          KEYIN    *PCCOL:CVERT,*V2LON,*MASK,*RV,FROMYEAR
          MATCH    EXITCHAR,FROMYEAR
          GOTO     KYEAR9000 IF EQUAL
          MOVE     ZERO,EXIT
          GOTO     KYEAR999
KYEAR900  MOVE     TWO,EXIT
KYEAR999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSACMIO/INC
          INC       AMSCODIO/INC
          INC       AMSDEPIO/INC
          INC       AMSGILIO/INC
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSMASIO/INC
          INC       AMSREGIO/INC
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
.
          INC       STDGENCD
.
