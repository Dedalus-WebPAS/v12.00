.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSPPYKY
.   Routine   :   HCCPPA00 PowerPlay Definition
.   Return    :           
.-------------------------------------------------------------------------------
HCCPPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCPPA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCPPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 9",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HCCPPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCPPPID 
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          CALL      RSCCPP1 
HCCPPA10
          CALL      RKCCPP1 
          BRANCH    OVRCD,HCCPPA15
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HCCPPA12
          CALL      HCCPPA60
          BRANCH    OVRCD,HCCPPA10
HCCPPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCPPPID 
          DISPLAY   *PSTDCOL02:STDROW,CCPPDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCPPA10 IF NOT EQUAL
HCCPPA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCPPA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCPPA30,HCCPPA35,HCCPPA40,HCCPPA45,HCCPPA04:
                              HCCPPA91,HCCPPA50
          GOTO      HCCPPA92
HCCPPA30
          CALL      RKCCPP1 
          BRANCH    OVRCD,HCCPPA85
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          CALL      RPCCPP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPPA10
HCCPPA35
          MOVE      ST1,KEY8 
          CALL      RDCCPP1 
          CALL      RPCCPP1 
          BRANCH    OVRCD,HCCPPA85
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCPPA36
          CALL      RPCCPP1 
          BRANCH    OVRCD,HCCPPA37
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCPPA36 IF NOT EQUAL
HCCPPA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCPPA10
HCCPPA40
          MOVE      ST1,KEY8 
          CALL      RDCCPP1 
          CALL      RPCCPP1 
          BRANCH    OVRCD,HCCPPA85
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPPA08
HCCPPA45
          CALL      RKCCPP1 
          BRANCH    OVRCD,HCCPPA85
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCPP1 
HCCPPA46
          CALL      RPCCPP1 
          BRANCH    OVRCD,HCCPPA47
          PACK      KEY8,CCPPPID,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCPPA46 IF NOT EQUAL
HCCPPA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCPPA10
HCCPPA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCPPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPPA08
HCCPPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPPA08
HCCPPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCPPA61 IF EQUAL
          MATCH     SCHFLD01,CCPPPID 
          GOTO      HCCPPA72 IF NOT EQUAL
HCCPPA61
          MATCH     SP70,SCHFLD02
          GOTO      HCCPPA62 IF EQUAL
          MATCH     SCHFLD02,CCPPDES 
          GOTO      HCCPPA72 IF NOT EQUAL
HCCPPA62
HCCPPA63
HCCPPA64
HCCPPA65
HCCPPA66
HCCPPA67
HCCPPA68
HCCPPA69
HCCPPA70
          GOTO      HCCPPA75
HCCPPA72  MOVE      ONE,OVRCD
HCCPPA75  RETURN
HCCPPA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,CCPPPID                                                
          CALL      RDCCPP1 
HCCPPA90
.                                                                               
          BEEP
          GOTO      HCCPPA20
HCCPPA91
          MOVE      SP70,CCPPDES 
          MOVE      SP70,CCPPEID 
          MOVE      SP70,CCPPTIM 
          MOVE      SP70,CCPPARE 
          MOVE      SP70,CCPPCT1 
          MOVE      SP70,CCPPCT2 
          MOVE      SP70,CCPPCT3 
          MOVE      SP70,CCPPDN1 
          MOVE      SP70,CCPPDN2 
          MOVE      SP70,CCPPDN3 
          MOVE      SP70,CCPPDN4 
          MOVE      SP70,CCPPDN5 
          MOVE      ZERO,CCPPEPS 
          MOVE      ZERO,CCPPNE  
          MOVE      ZERO,CCPPBD  
          MOVE      ZERO,CCPPC1  
          MOVE      ZERO,CCPPC2  
          MOVE      ZERO,CCPPACC 
          MOVE      ZERO,CCPPTHE 
          MOVE      ZERO,CCPPOTH 
          MOVE      ZERO,CCPPALOS
          MOVE      ZERO,CCPPAC1 
          MOVE      ZERO,CCPPAC2 
          MOVE      ZERO,CCPPAACC
          MOVE      ZERO,CCPPATHE
          MOVE      ZERO,CCPPAOTH
          MOVE      ZERO,CCPPBC1 
          MOVE      ZERO,CCPPBC2 
          MOVE      ZERO,CCPPBACC
          MOVE      ZERO,CCPPBTHE
          MOVE      ZERO,CCPPBOTH
          MOVE      SP70,CCPPSPA1
          MOVE      SP70,CCPPSPA2
          MOVE      SP70,KEY8 
          MOVE      SP70,CCPPPID 
          GOTO      HCCPPA96
HCCPPA92
          MOVE      SP70,KEY8 
          MOVE      SP70,CCPPPID 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,CCPPPID                                                
HCCPPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCPPA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSPPYKY
.   Routine   :   KCCPPA00 Keyin PowerPlay ID        
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCPPA00 TOPIC     "CCPPPID "
          MOVE      UNDLN70,CCPPPID 
          KEYIN     *PCCOL:CVERT,*DV,CCPPPID:                                   
                    *PCCOL:CVERT,*V2LON,CCPPPID:                                
                    *PCCOL:CVERT,*DV,CCPPPID 
.
          ENDSET    CCPPPID 
          APPEND    SP70,CCPPPID 
          RESET     CCPPPID 
          REP       UPPLOW,CCPPPID
.
          MATCH     SP70,CCPPPID 
          GOTO      KCCPPA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCPPPID 
          GOTO      KCCPPA95 IF EQUAL
.
          CMATCH    QUEST,CCPPPID 
          GOTO      KCCPPA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCPPA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCPPPID 
          APPEND    SP70,CCPPPID 
          RESET     CCPPPID 
.
          MATCH     SP70,CCPPPID 
          GOTO      KCCPPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCPPPID                                 
KCCPPA10  REP       " 0",CCPPPID
          PACK      KEY8,CCPPPID                                                
          CALL      RACCPP1 
          BRANCH    OVRCD,KCCPPA80
          BRANCH    CKEYTYP,KCCPPA75
          CALL      RDCCPP1 
KCCPPA70
          MOVE      ZERO,EXIT
          GOTO      KCCPPA99
KCCPPA75
          MOVE      "PowerPlay ID Already Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KCCPPA00
KCCPPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCPPA99,KCCPPA99
          MOVE      "PowerPlay ID Does Not Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KCCPPA00
KCCPPA90
          MOVE      ONE,EXIT
          GOTO      KCCPPA99
KCCPPA95
          MOVE      TWO,EXIT
KCCPPA99 TOPIC    PRGID
          RETURN
