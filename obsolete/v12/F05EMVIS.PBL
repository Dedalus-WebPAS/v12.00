.*****************************************************************************
.*    Program      : F05EMVIS                                                *
.*    Description  : Conversion of emrvisaf to new file layout               *
.*                                                                           *
.*    Author       : Ania Pietrusewicz CAR 303879/304641/304104              *
.*    Date         : 13/08/2014                                              *
.*    Modifications:                                                         *
.*                                                                           *
.*****************************************************************************
.
          INC       STD001FD
.
FINDFILE  FILE      ASCII, FIXED=256
OLDFILE1  IFILE     SQL, FIXED=1480, KEY="U1-8"
.
.Data File Definition
.--------------------
.EMRVISA1   IFILE    SQL, FIXED=1480, KEY="U1-8"                                 
.EMRVISA2   IFILE    SQL, FIXED=1480, KEY="U9-9,1-8"                             
.EMRVISA3   IFILE    SQL, FIXED=1480, KEY="U10-17,1-8"                           
.EMRVISA4   IFILE    SQL, FIXED=1480, KEY="U18-25,26-33,1-8"                     
.EMRVISA5   IFILE    SQL, FIXED=1480, KEY="U983-985,9-9,1-8"                     
.EMRVISA6   IFILE    SQL, FIXED=1480, KEY="U983-985,18-25,26-33,1-8"             
.EMRVISA7   IFILE    SQL, FIXED=1480, KEY="U137-139,1-8"                         
.
.Name     Type      Length Physical Start Description
.----     ----      ------ -------- ----- -----------
.DEMVIADM  DIM       8      8        1     Visit Number                       
.DEMVISTA  DIM       1      1        9     Status                             
.EMVIURNO  DIM       8      8        10    Patient U/R Number                 
.EMVIDATE  DIM       8      8        18    Arrival Date (CCYYMMDD)            
.EMVITIME  DIM       8      8        26    Arrival Time (HH:MM:SS)            
.EMVITRIG  DIM       3      3        34    Triage Code (category AA)          
.EMVICOM1  DIM       50     50       37    Complaint Line 1                   
.EMVICOM2  DIM       50     50       87    Complaint Line 2                   
.EMVILOCN  DIM       3      3        137   Location (emrlocaf)                
.EMVIDOCT  DIM       10     10       140   Attending Doctor                   
.EMVICOMP  DIM       3      3        150   Compensation Code (category CL)    
.EMVICLAS  DIM       3      3        153   Patient Classification (category A)
.EMVIINSR  DIM       3      3        156   Insurance Status (category U1)     
.EMVISRCE  DIM       3      3        159   Source of Referal (category S)     
.EMVISITN  DIM       3      3        162   Situation (category ES)            
.EMVIMODE  DIM       3      3        165   Mode of Arrival (category EA)      
.EMVIADMT  FORM      1      2        168   Admitted to Hospital               
.EMVIDURN  FORM      4      3        170   Duration of Waiting (in minutes)   
.EMVIEMPL  DIM       20     20       173   Employer (Workcover)               
.EMVIWAIT  DIM       3      3        193   Completion Wait Code (category EW) 
.EMVIPREV  DIM       3      3        196   Previous A&E Attendance (cat. EP)  
.EMVIFUND  DIM       6      6        199   Health Fund                        
.EMVITABL  DIM       8      8        205   Health Fund Table                  
.EMVIREFG  DIM       10     10       213   Referred to on Departure (HCP)     
.EMVIREFD  DIM       10     10       223   Referring Doctor                   
.EMVIPLIN  DIM       3      3        233   Place of Incident (category AP)    
.EMVIINIT  DIM       3      3        236   Initiator (category AI)            
.EMVIRTAS  DIM       3      3        239   RTA Seatbelt Details (category AR) 
.EMVIDDAT  DIM       8      8        242   Discharge Date (CCYYMMDD)          
.EMVIDTIM  DIM       8      8        250   Discharge Time (HH:MM:SS)          
.EMVIDSTA  DIM       3      3        258   Discharge Status (category ED)     
.EMVIOPR1  DIM       10     10       261   Web Operator - event (websecaf)    
.EMVIOPR2  DIM       10     10       271   Web Operator - discharge (websecaf)
.EMVIUC01  DIM       3      3        281   User Defined Code 1  (category A1) 
.EMVIUC02  DIM       3      3        284   User Defined Code 2  (category A2) 
.EMVIUC03  DIM       3      3        287   User Defined Code 3  (category A3) 
.EMVIUC04  DIM       3      3        290   User Defined Code 4  (category A4) 
.EMVIUC05  DIM       3      3        293   User Defined Code 5  (category A5) 
.EMVIUC06  DIM       3      3        296   User Defined Code 6  (category A6) 
.EMVIUC07  DIM       3      3        299   User Defined Code 7  (category A7) 
.EMVIUC08  DIM       3      3        302   Discharge Dest ACT(category A8) 
.EMVIUC09  DIM       3      3        305   Transport Mode       (category ea) 
.EMVIUC10  DIM       3      3        308   Escort Source        (category eb) 
.EMVIUC11  DIM       3      3        311   Referred to on Disch (category ec) 
.EMVIUC12  DIM       3      3        314   Reason for Transfer  (category ed) 
.EMVIUC13  DIM       3      3        317   Attendance type      (category ee) 
.EMVIUC14  DIM       3      3        320   User Defined Code 14 (category ef) 
.EMVIUC15  DIM       3      3        323   User Defined Code 15 (category eg) 
.EMVIUC16  DIM       3      3        326   Nurse Code           (category eh) 
.EMVIUC17  DIM       3      3        329   User Defined Code 16 (category ei) 
.EMVIUC18  DIM       3      3        332   Reason for Undisch   (category ej) 
.EMVIUC19  DIM       3      3        335   User Defined Code 19 (category ek) 
.EMVIUC20  DIM       3      3        338   Presenting Complaint (category el) 
.EMVIUC21  DIM       3      3        341   Attendance Source    (category em) 
.EMVIUC22  DIM       3      3        344   Clerical ID          (category en) 
.EMVIUC23  DIM       3      3        347   User Defined Code 23 (category eo) 
.EMVIUC24  DIM       3      3        350   User Defined Code 24 (category ep) 
.EMVIUC25  DIM       3      3        353   User Defined Code 25 (category eq) 
.EMVIUC26  DIM       3      3        356   User Defined Code 26 (category er) 
.EMVIUC27  DIM       3      3        359   User Defined Code 27 (category es) 
.EMVIUC28  DIM       3      3        362   Ready for Admission  (category et) 
.EMVIUC29  DIM       3      3        365   Research             (category eu) 
.EMVIUC30  DIM       3      3        368   User Defined Code 30 (category ev) 
.EMVIUD01  DIM       8      8        371   Ready for Departure Date(ACT CCYYMMDD)
.EMVIUD02  DIM       8      8        379   User Defined Date 2  (CCYYMMDD)    
.EMVIUD03  DIM       8      8        387   Ward Request Date    (CCYYMMDD)    
.EMVIUD04  DIM       8      8        395   Ward Allocation Date (CCYYMMDD)    
.EMVIUD05  DIM       8      8        403   Bed Ready Date       (CCYYMMDD)    
.EMVIUD06  DIM       8      8        411   User Defined Date 6  (CCYYMMDD)    
.EMVIUD07  DIM       8      8        419   User Defined Date 7  (CCYYMMDD)    
.EMVIUD08  DIM       8      8        427   User Defined Date 8  (CCYYMMDD)    
.EMVIUD09  DIM       8      8        435   User Defined Date 9  (CCYYMMDD)    
.EMVIUD10  DIM       8      8        443   User Defined Date 10 (CCYYMMDD)    
.EMVIUT01  DIM       8      8        451   Ready for Departure Time ACT(HH:MM:SS)
.EMVIUT02  DIM       8      8        459   User Defined Time 2  (HH:MM:SS)    
.EMVIUT03  DIM       8      8        467   Ward Request Time    (HH:MM:SS)    
.EMVIUT04  DIM       8      8        475   Ward Allocation Time (HH:MM:SS)    
.EMVIUT05  DIM       8      8        483   Bed Ready Time       (HH:MM:SS)    
.EMVIUT06  DIM       8      8        491   User Defined Time 6  (HH:MM:SS)    
.EMVIUT07  DIM       8      8        499   User Defined Time 7  (HH:MM:SS)    
.EMVIUT08  DIM       8      8        507   User Defined Time 8  (HH:MM:SS)    
.EMVIUT09  DIM       8      8        515   User Defined Time 9  (HH:MM:SS)    
.EMVIUT10  DIM       8      8        523   User Defined Time 10 (HH:MM:SS)    
.EMVIYN01  FORM      1      2        531   User Defined Y/N Field 1           
.EMVIYN02  FORM      1      2        533   C-Type Admission         
.EMVIYN03  FORM      1      2        535   User Defined Y/N Field 3           
.EMVIYN04  FORM      1      2        537   User Defined Y/N Field 4           
.EMVIYN05  FORM      1      2        539   User Defined Y/N Field 5           
.EMVIYN06  FORM      1      2        541   User Defined Y/N Field 6           
.EMVIYN07  FORM      1      2        543   User Defined Y/N Field 7           
.EMVIYN08  FORM      1      2        545   User Defined Y/N Field 8           
.EMVIYN09  FORM      1      2        547   User Defined Y/N Field 9           
.EMVIYN10  FORM      1      2        549   Ongoing Care Communication         
.EMVITXT1  DIM       50     50       551   User Defined Text Field 1          
.EMVITXT2  DIM       50     50       601   User Defined Text Field 2          
.EMVITXT3  DIM       50     50       651   User Defined Text Field 3          
.EMVITXT4  DIM       50     50       701   User Defined Text Field 4          
.EMVITXT5  DIM       50     50       751   User Defined Text Field 5          
.EMVIUN01  FORM      6      4        801   User Defined Numeric Field 1       
.EMVIUN02  FORM      6      4        805   User Defined Numeric Field 2       
.EMVIUN03  FORM      6      4        809   User Defined Numeric Field 3       
.EMVIUN04  FORM      6      4        813   User Defined Numeric Field 4       
.EMVIUN05  FORM      6      4        817   User Defined Numeric Field 5       
.EMVIELAP  DIM       3      3        821   Elapsed Since Accident (cat. AE)   
.EMVINSDT  DIM       8      8        824   Date First Seen by Nurse (CCYYMMDD)
.EMVINSTM  DIM       8      8        832   Time First Seen by Nurse (HH:MM:SS)
.EMVIDRDT  DIM       8      8        840   Date First Seen by Doct. (CCYYMMDD)
.EMVIDRTM  DIM       8      8        848   Time First Seen by Doct. (HH:MM:SS)
.EMVIPATT  FORM      3      3        856   Number of Previous Attendences     
.EMVITSRC  DIM       5      5        859   Transfer Source Code               
.EMVIDEST  DIM       5      5        864   Discharge Destination Code         
.EMVIAMBL  DIM       6      6        869   Ambulance Case Number              
.EMVIREGN  DIM       2      2        875   Body Region                        
.EMVISENT  DIM       1      1        877   Extract Sent                       
.EMVIUR01  DIM       6      6        878   User Defined Doctor Field 1        
.EMVIUR02  DIM       6      6        884   User Defined Doctor Field 2        
.EMVIUR03  DIM       6      6        890   User Defined Doctor Field 3        
.EMVIUR04  DIM       6      6        896   User Defined Doctor Field 4        
.EMVIUR05  DIM       6      6        902   User Defined Doctor Field 5        
.EMVIPADM  DIM       8      8        908   Patient System Admission Number    
.EMVIEWRD  DIM       3      3        916   Expected Ward (Patient System)     
.EMVIEBED  DIM       3      3        919   Expected Bed  (Patient System)     
.EMVIHFMN  DIM       10     10       922   Health Fund Member Number          
.EMVIACLS  DIM       3      3        932   Admission Class (category P)       
.EMVICCLS  DIM       3      3        935   Care Class      (category CC)      
.EMVITRNS  DIM       10     10       938   Triage Nurse                       
.EMVIDUM1  DIM       3      3        948   Dummy Field 1                      
.EMVITRDT  DIM       8      8        951   Triage Date                        
.EMVITRTM  DIM       8      8        959   Triage Time                        
.EMVIATNS  DIM       10     10       967   Attending Nurse                    
.EMVIDUM2  DIM       3      3        977   Dummy Field 2                      
.EMVIEXLC  DIM       3      3        980   External Location Code (emrlocaf)  
.EMVISITE  DIM       3      3        983   Emergency Site Code                
.EMVIUNIT  DIM       3      3        986   Unit (category AC)                 
.EMVICOM3  DIM       50     50       989   Complaint Line 3                   
.EMVICOM4  DIM       50     50       1039  Complaint Line 4                   
.EMVICOM5  DIM       50     50       1089  Complaint Line 5                   
.EMVICOM6  DIM       50     50       1139  Complaint Line 6                   
.EMVIINJ1  DIM       50     50       1189  Injury Description Line 1          
.EMVIINJ2  DIM       50     50       1239  Injury Description Line 2          
.EMVINATI  DIM       3      3        1289  Nature of Main Injury (category ex)
.EMVIINJC  DIM       3      3        1292  Injury Cause          (category ey)
.EMVIHUMI  DIM       3      3        1295  Human Intent          (category ez)
.EMVIACTI  DIM       3      3        1298  Activity When Injured (category EY)
.EMVILOCO  DIM       25     25       1301  Other Location Description         
.EMVIPRLO  DIM       3      3        1326  Previous Location (emrlocaf)       
.EMVIPRTM  DIM       8      8        1329  Time Left Previous Location (hh:mm:ss)
.EMVIDPDT  DIM       8      8        1337  Departure Date (CCYYMMDD)
.EMVIDPTM  DIM       8      8        1345  Departure Time (HH:MM:SS)
.EMVIEXRS  DIM       3      3        1353  Extended Visit Reason (Cat RX)
.EMVIDLRS  DIM       3      3        1356  Departure Delay Reason (Cat RY) 
.EMVISPDT  DIM       8      8        1359  Speciality Date (CCYYMMDD)
.EMVISPTM  DIM       8      8        1367  Speciality Time (HH:MM:SS)
.EMVISADT  DIM       8      8        1375  Speciality Arrival Date (CCYYMMDD)
.EMVISATM  DIM       8      8        1383  Speciality Arrival Time (HH:MM:SS)
.EMVIMPRA  DIM       10     10       1391  Mental Health Practitioner (pmshcpaf)
.EMVIMPDT  DIM       8      8        1401  Date First Seen by MH Prac.(CCYYMMDD)
.EMVIMPTM  DIM       8      8        1409  Time First Seen by MH Prac.(HH:MM:SS)
OLDSPAR    DIM       63    63        1417  Spare Variables                    
.
.
.
.
.Data File Definition
.--------------------
EMRVISA1   IFILE    SQL, FIXED=1629, KEY="U1-8"                                 
EMRVISA2   IFILE    SQL, FIXED=1629, KEY="U9-9,1-8"                             
EMRVISA3   IFILE    SQL, FIXED=1629, KEY="U10-17,1-8"                           
EMRVISA4   IFILE    SQL, FIXED=1629, KEY="U18-25,26-33,1-8"                     
EMRVISA5   IFILE    SQL, FIXED=1629, KEY="U992-994,9-9,1-8"                     
EMRVISA6   IFILE    SQL, FIXED=1629, KEY="U992-994,18-25,26-33,1-8"             
EMRVISA7   IFILE    SQL, FIXED=1629, KEY="U137-139,1-8"                         
.
.Name     Type      Length Physical Start Description
.----     ----      ------ -------- ----- -----------
DEMVIADM  DIM       8      8        1     Visit Number                       
DEMVISTA  DIM       1      1        9     Status                             
EMVIURNO  DIM       8      8        10    Patient U/R Number                 
EMVIDATE  DIM       8      8        18    Arrival Date (CCYYMMDD)            
EMVITIME  DIM       8      8        26    Arrival Time (HH:MM:SS)            
EMVITRIG  DIM       3      3        34    Triage Code (category AA)          
EMVICOM1  DIM       50     50       37    Complaint Line 1                   
EMVICOM2  DIM       50     50       87    Complaint Line 2                   
EMVILOCN  DIM       3      3        137   Location (emrlocaf)                
EMVIDOCT  DIM       10     10       140   Attending Doctor                   
EMVICOMP  DIM       3      3        150   Compensation Code (category CL)    
EMVICLAS  DIM       3      3        153   Patient Classification (category A)
EMVIINSR  DIM       3      3        156   Insurance Status (category U1)     
EMVISRCE  DIM       3      3        159   Source of Referal (category S)     
EMVISITN  DIM       3      3        162   Situation (category ES)            
EMVIMODE  DIM       3      3        165   Mode of Arrival (category EA)      
EMVIADMT  FORM      1      2        168   Admitted to Hospital               
EMVIDURN  FORM      4      3        170   Duration of Waiting (in minutes)   
EMVIEMPL  DIM       20     20       173   Employer (Workcover)               
EMVIWAIT  DIM       3      3        193   Completion Wait Code (category EW) 
EMVIPREV  DIM       3      3        196   Previous A&E Attendance (cat. EP)  
EMVIFUND  DIM       6      6        199   Health Fund                        
EMVITABL  DIM       8      8        205   Health Fund Table                  
EMVIREFG  DIM       10     10       213   Referred to on Departure (HCP)     
EMVIREFD  DIM       10     10       223   Referring Doctor                   
EMVIPLIN  DIM       3      3        233   Place of Incident (category AP)    
EMVIINIT  DIM       3      3        236   Initiator (category AI)            
EMVIRTAS  DIM       3      3        239   RTA Seatbelt Details (category AR) 
EMVIDDAT  DIM       8      8        242   Discharge Date (CCYYMMDD)          
EMVIDTIM  DIM       8      8        250   Discharge Time (HH:MM:SS)          
EMVIDSTA  DIM       3      3        258   Discharge Status (category ED)     
EMVIOPR1  DIM       10     10       261   Web Operator - event (websecaf)    
EMVIOPR2  DIM       10     10       271   Web Operator - discharge (websecaf)
EMVIUC01  DIM       3      3        281   User Defined Code 1  (category A1) 
EMVIUC02  DIM       3      3        284   User Defined Code 2  (category A2) 
EMVIUC03  DIM       3      3        287   User Defined Code 3  (category A3) 
EMVIUC04  DIM       3      3        290   User Defined Code 4  (category A4) 
EMVIUC05  DIM       3      3        293   User Defined Code 5  (category A5) 
EMVIUC06  DIM       3      3        296   User Defined Code 6  (category A6) 
EMVIUC07  DIM       3      3        299   User Defined Code 7  (category A7) 
EMVIUC08  DIM       3      3        302   Discharge Dest ACT(category A8)    
EMVIUC09  DIM       3      3        305   Transport Mode (Cat ea)            
EMVIUC10  DIM       3      3        308   Escort Source (Cat eb)             
EMVIUC11  DIM       3      3        311   Referred to on Disch (Cat ec)      
EMVIUC12  DIM       3      3        314   Reason for Transfer (Cat ed)       
EMVIUC13  DIM       3      3        317   Attendance type (Cat ee)           
EMVIUC14  DIM       3      3        320   User Defined Code 14               
EMVIUC15  DIM       3      3        323   User Defined Code 15               
EMVIUC16  DIM       3      3        326   Nurse Code (Cat eh)                
EMVIUC17  DIM       3      3        329   User Defined Code 17 (category ei) 
EMVIUC18  DIM       3      3        332   Reason for Undisch (Cat ej)        
EMVIUC19  DIM       3      3        335   User Defined Code 19 (category ek) 
EMVIUC20  DIM       3      3        338   Presenting Complaint (Cat el)      
EMVIUC21  DIM       3      3        341   Attendance Source (Cat em)         
EMVIUC22  DIM       3      3        344   Clerical ID (Cal en)               
EMVIUC23  DIM       3      3        347   User Defined Code 23 (category eo) 
EMVIUC24  DIM       3      3        350   User Defined Code 24 (category ep) 
EMVIUC25  DIM       3      3        353   User Defined Code 25 (category eq) 
EMVIUC26  DIM       3      3        356   User Defined Code 26 (category er) 
EMVIUC27  DIM       3      3        359   User Defined Code 27 (category es) 
EMVIUC28  DIM       3      3        362   Ready for Admission (Cat et)       
EMVIUC29  DIM       3      3        365   Research (Cat eu)                  
EMVIUC30  DIM       3      3        368   User Defined Code 30 (category ev) 
EMVIUD01  DIM       8      8        371   Ready for Departure DT ACT CCYYMMDD
EMVIUD02  DIM       8      8        379   User Defined Date 2  (CCYYMMDD)    
EMVIUD03  DIM       8      8        387   Ward Request Date (CCYYMMDD)       
EMVIUD04  DIM       8      8        395   Ward Allocation Date (CCYYMMDD)    
EMVIUD05  DIM       8      8        403   Bed Ready Date (CCYYMMDD)          
EMVIUD06  DIM       8      8        411   User Defined Date 6  (CCYYMMDD)    
EMVIUD07  DIM       8      8        419   User Defined Date 7  (CCYYMMDD)    
EMVIUD08  DIM       8      8        427   User Defined Date 8  (CCYYMMDD)    
EMVIUD09  DIM       8      8        435   User Defined Date 9  (CCYYMMDD)    
EMVIUD10  DIM       8      8        443   User Defined Date 10 (CCYYMMDD)    
EMVIUT01  DIM       8      8        451   Ready for Depart. TM ACT (HH:MM:SS)
EMVIUT02  DIM       8      8        459   User Defined Time 2  (HH:MM:SS)    
EMVIUT03  DIM       8      8        467   Ward Request Time (HH:MM:SS)       
EMVIUT04  DIM       8      8        475   Ward Allocation Time (HH:MM:SS)    
EMVIUT05  DIM       8      8        483   Bed Ready Time (HH:MM:SS)          
EMVIUT06  DIM       8      8        491   User Defined Time 6  (HH:MM:SS)    
EMVIUT07  DIM       8      8        499   User Defined Time 7  (HH:MM:SS)    
EMVIUT08  DIM       8      8        507   User Defined Time 8  (HH:MM:SS)    
EMVIUT09  DIM       8      8        515   User Defined Time 9  (HH:MM:SS)    
EMVIUT10  DIM       8      8        523   User Defined Time 10 (HH:MM:SS)    
EMVIYN01  FORM      1      2        531   User Defined Y/N Field 1           
EMVIYN02  FORM      1      2        533   C-Type Admission                   
EMVIYN03  FORM      1      2        535   User Defined Y/N Field 3           
EMVIYN04  FORM      1      2        537   User Defined Y/N Field 4           
EMVIYN05  FORM      1      2        539   User Defined Y/N Field 5           
EMVIYN06  FORM      1      2        541   User Defined Y/N Field 6           
EMVIYN07  FORM      1      2        543   User Defined Y/N Field 7           
EMVIYN08  FORM      1      2        545   User Defined Y/N Field 8           
EMVIYN09  FORM      1      2        547   User Defined Y/N Field 9           
EMVIYN10  FORM      1      2        549   Ongoing Care Communication         
EMVITXT1  DIM       50     50       551   User Defined Text Field 1          
EMVITXT2  DIM       50     50       601   User Defined Text Field 2          
EMVITXT3  DIM       50     50       651   User Defined Text Field 3          
EMVITXT4  DIM       50     50       701   User Defined Text Field 4          
EMVITXT5  DIM       50     50       751   User Defined Text Field 5          
EMVIUN01  FORM      6      4        801   User Defined Numeric Field 1       
EMVIUN02  FORM      6      4        805   User Defined Numeric Field 2       
EMVIUN03  FORM      6      4        809   User Defined Numeric Field 3       
EMVIUN04  FORM      6      4        813   User Defined Numeric Field 4       
EMVIUN05  FORM      6      4        817   User Defined Numeric Field 5       
EMVIELAP  DIM       3      3        821   Elapsed Since Accident (cat. AE)   
EMVINSDT  DIM       8      8        824   Date First Seen by Nurse (CCYYMMDD)
EMVINSTM  DIM       8      8        832   Time First Seen by Nurse (HH:MM:SS)
EMVIDRDT  DIM       8      8        840   Date First Seen by Doct. (CCYYMMDD)
EMVIDRTM  DIM       8      8        848   Time First Seen by Doct. (HH:MM:SS)
EMVIPATT  FORM      3      3        856   Number of Previous Attendences     
EMVITSRC  DIM       5      5        859   Transfer Source Code               
EMVIDEST  DIM       5      5        864   Discharge Destination Code         
.
EMVIAMBL   DIM      15     15       869   Ambulance Case Number             
.
EMVIREGN  DIM       2      2        884   Body Region                        
EMVISENT  DIM       1      1        886   Extract Sent                       
EMVIUR01  DIM       6      6        887   User Defined Doctor Field 1        
EMVIUR02  DIM       6      6        893   User Defined Doctor Field 2        
EMVIUR03  DIM       6      6        899   User Defined Doctor Field 3        
EMVIUR04  DIM       6      6        905   User Defined Doctor Field 4        
EMVIUR05  DIM       6      6        911   User Defined Doctor Field 5        
EMVIPADM  DIM       8      8        917   Patient System Admission Number    
EMVIEWRD  DIM       3      3        925   Expected Ward (Patient System)     
EMVIEBED  DIM       3      3        928   Expected Bed  (Patient System)     
EMVIHFMN  DIM       10     10       931   Health Fund Member Number          
EMVIACLS  DIM       3      3        941   Admission Class (category P)       
EMVICCLS  DIM       3      3        944   Care Class      (category CC)      
EMVITRNS  DIM       10     10       947   Triage Nurse                       
EMVIDUM1  DIM       3      3        957   Dummy Field 1                      
EMVITRDT  DIM       8      8        960   Triage Date                        
EMVITRTM  DIM       8      8        968   Triage Time                        
EMVIATNS  DIM       10     10       976   Attending Nurse                    
EMVIDUM2  DIM       3      3        986   Dummy Field 2                      
EMVIEXLC  DIM       3      3        989   External Location Code (emrlocaf)  
EMVISITE  DIM       3      3        992   Emergency Site Code                
EMVIUNIT  DIM       3      3        995   Unit (category AC)                 
EMVICOM3  DIM       50     50       998   Complaint Line 3                   
EMVICOM4  DIM       50     50       1048  Complaint Line 4                   
EMVICOM5  DIM       50     50       1098  Complaint Line 5                   
EMVICOM6  DIM       50     50       1148  Complaint Line 6                   
EMVIINJ1  DIM       50     50       1198  Injury Description Line 1          
EMVIINJ2  DIM       50     50       1248  Injury Description Line 2          
EMVINATI  DIM       3      3        1298  Nature of Main Injury (category ex)
EMVIINJC  DIM       3      3        1301  Injury Cause          (category ey)
EMVIHUMI  DIM       3      3        1304  Human Intent          (category ez)
EMVIACTI  DIM       3      3        1307  Activity When Injured (category EY)
EMVILOCO  DIM       25     25       1310  Other Location Description         
EMVIPRLO  DIM       3      3        1335  Previous Location (emrlocaf)       
EMVIPRTM  DIM       8      8        1338  Time Left Previous Location (hh:mm:
EMVIDPDT  DIM       8      8        1346  Departure Date (CCYYMMDD)          
EMVIDPTM  DIM       8      8        1354  Departure Time (HH:MM:SS)          
EMVIEXRS  DIM       3      3        1362  Extended Visit Reason (Cat RX)     
EMVIDLRS  DIM       3      3        1365  Departure Delay Reason (Cat RY)    
EMVISPDT  DIM       8      8        1368  Speciality Date (CCYYMMDD)         
EMVISPTM  DIM       8      8        1376  Speciality Time (HH:MM:SS)         
EMVISADT  DIM       8      8        1384  Speciality Arrival Date (CCYYMMDD) 
EMVISATM  DIM       8      8        1392  Speciality Arrival Time (HH:MM:SS) 
EMVIMPRA  DIM       10     10       1400  Mental Health Practitioner (pmshcpa
EMVIMPDT  DIM       8      8        1410  Date First Seen by MH Prac.(CCYYMMD
EMVIMPTM  DIM       8      8        1418  Time First Seen by MH Prac.(HH:MM:S
EMVIAADT  DIM       8      8        1426  Ambulance Arrival Date (CCYYMMDD)  
EMVIAATM  DIM       8      8        1434  Ambulance Arrival Time (HH:MM:SS)  
EMVIAHDT  DIM       8      8        1442  Ambulance Handover Date (CCYYMMDD) 
EMVIAHTM  DIM       8      8        1450  Ambulance Handover Time (HH:MM:SS) 
EMVIDADT  DIM       8      8        1458  Decision to Admit Date (CCYYMMDD)  
EMVIDATM  DIM       8      8        1466  Decision to Admit Time (HH:MM:SS)  
EMVIPURC  DIM       3      3        1474  Health Purchaser (Cat HP)          
EMVIMNCD  DIM       10     10       1477  Meet & Greet Assessment Nurse Code 
EMVIMNDT  DIM       8      8        1487  Meet & Greet Ass. Nurse Date Seen  
EMVIMNTM  DIM       8      8        1495  Meet & Greet Ass. Nurse Time Seen  
EMVIMDCD  DIM       10     10       1503  Meet & Greet Ass. Doctor Code      
EMVIMDDT  DIM       8      8        1513  Meet & Greet Ass. Doctor Date Seen 
EMVIMDTM  DIM       8      8        1521  Meet & Greet Ass. Doctor Time Seen 
EMVISPAR  DIM       100    100      1529  Spare                              

OLDAMBL   DIM       6               ****************** NEW Extended Ambulance field ***********************
.
.
.
. LOCAL VARIABLES
. ---------------
CMDLINE   DIM       200
DEFPATH   DIM       60
DIM60     DIM       60
DISNUM    FORM      4
INPFILE   DIM       8
NEWFILE   DIM       60
NEWPATH   DIM       60
OLDPATH   DIM       60
RECNUM    FORM      8
SAVEFLG   FORM      1
.
.
. PROGRAM CONSTANTS
. -----------------
SP60      INIT    "                                                            "
.
.
PRGNAM    INIT      "CONVERSION EMRVISFD"
PRGID     INIT      "F05EMVIS"
VERSION   INIT      "V12.00.00"
+
.*****************************************************************************
.*                             MAIN0000                                      *
.*                         Program Mainline                                  *
.*****************************************************************************
.
MAIN0000  CALL      INIT0000                      * init and open files
          BRANCH    EXIT,MAIN9999                 * init failure
.
          CALL      OPTN0000                      * get option
          BRANCH    COPTION,MAIN1000              * run c-isam fixit
          GOTO      MAIN9999                      * exit selected
.
MAIN1000  CALL      KDIR0000                      * Keyin directory
          BRANCH    EXIT,MAIN9999
.
          CALL      CONTQST                       * Ok to continue ?
          BRANCH    CEXIT,MAIN5000:               * yes
                          MAIN0000:               * no
                          MAIN9999                * cancel
.
.         Running c-isam fix
.
MAIN5000  CALL      PREP0000                      * preparing files
          BRANCH    EXIT,MAIN9999
.
          CALL      READ0000                      * read old records and write
          CALL      ENDP0000                      * save/zip saved file
.
MAIN9999  CHAIN     PGM
+
.********************************************************************
.*                          INIT0000                                *
.*  Display heading and check that the files needed exist&open them *
.********************************************************************
.
INIT0000  CALL      DISPHEAD
          MOVE      ZERO,RECNUM
          MOVE      ZERO,DISNUM
          
INIT9999  RETURN
+
.*****************************************************************************
.*                                OPTN0000             Called by: MAIN0000   *
.*                        Get user options or exit                           *
.*    Returns:  EXIT    = FALSE (0)  Ok to proceed                           *
.*                        TRUE  (1)  Exit option selected                    *
.*              COPTION - option selected                                    *
.*****************************************************************************
.
OPTN0000  DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF,". Exit":
                    *P1:5,*V2LON,ONE,*HOFF,". Run Fixit (c-isam only)"
.
OPTN0500  KEYIN     *P1:7,*EL,"Select Option : ":
                    *P17:7,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9500 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9000             * run c-isam fixit
.
          BEEP
          GOTO      OPTN0500
.
OPTN9000  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.********************************************************************
.*                          KDIR0000                                *
.*  Keyin directories                                               *
.********************************************************************
.
KDIR0000  MOVE      ONE,SAVEFLG        * Default to keep file
          KEYIN     *P1:10,*EL,"Do you want to save the original file (Y/N) ? ":
                    ANS;
          REP       "yYnN",ANS
          CMATCH    "Y",ANS
          GOTO      KDIR1000 IF EQUAL
          MOVE      ZERO,SAVEFLG       * not to keep file
          CMATCH    "N",ANS
          GOTO      KDIR1000 IF EQUAL
          BEEP
          GOTO      KDIR0000
.
KDIR1000  CALL      DEFT0000                * Get the default path
          BRANCH    EXIT,KDIR9999
          MOVE      SP60,OLDPATH
.
          DISPLAY   *P1:24,*EL,"The directory path must end with a slash (/) ";
.
          MOVE      DEFPATH,OLDPATH
          BRANCH    SAVEFLG,KDIR2000
.
.         Keyin the path for the original file
.
          KEYIN     *P1:12,*EL,"Keyin path for temporarily saving original ":
                    "file: ":
                    *P10:13,*EL,*DV,*RV,OLDPATH:
                    *P10:13,OLDPATH;
          GOTO      KDIR3000
.
KDIR2000  KEYIN     *P1:12,*EL,"Keyin path for saving original file: ":
                    *P10:13,*EL,*DV,*RV,OLDPATH:
                    *P10:13,OLDPATH;
.
KDIR3000  ENDSET    OLDPATH
          APPEND    SP60,OLDPATH
          RESET     OLDPATH
.
          MATCH     SP60,OLDPATH
          IF        @EQUAL
            PACK      OLDPATH,DEFPATH      * use the default
            DISPLAY   *P10:13,*EL,*V2LON,OLDPATH;
          ENDIF
.
          SQUEEZE   OLDPATH
          CMATCH    EXITCHAR,OLDPATH
          GOTO      KDIR9000 IF EQUAL
.
          PACK      DIM60,OLDPATH,SP60
          CALL      VALD0000         * check if it's a valid directory
          BRANCH    EXIT,KDIR1000
.
.         Keyin the path for the new file
.
KDIR5000  MOVE      SP60,NEWPATH
          MOVE      DEFPATH,NEWPATH
          KEYIN     *P1:15,*EL,"Keyin path for the new file: ":
                    *P10:16,*EL,*DV,*RV,NEWPATH:
                    *P10:16,NEWPATH;
          ENDSET    NEWPATH
          APPEND    SP60,NEWPATH
          RESET     NEWPATH
.
          MATCH     SP60,NEWPATH
          IF        @EQUAL
            PACK      NEWPATH,DEFPATH      * use the default
            DISPLAY   *P10:16,*V2LON,NEWPATH;
          ENDIF
.
          SQUEEZE   NEWPATH
          CMATCH    EXITCHAR,NEWPATH
          GOTO      KDIR9000 IF EQUAL
.
          PACK      DIM60,NEWPATH,SP60
          CALL      VALD0000         * check if it's a valid directory
          BRANCH    EXIT,KDIR5000
          GOTO      KDIR9999
.
KDIR9000  MOVE      ONE,EXIT
.
KDIR9999  DISPLAY   *P1:24,*EL;
          RETURN
+
.********************************************************************
.*                          PREP0000                                *
.*  Preparing files                                                 *
.********************************************************************
.
PREP0000  MOVE      "emrvisaf",INPFILE
          CALL      CHEK0000             * check file exists or has been changed
          BRANCH    EXIT,PREP9000
.
          CLOSE     OLDFILE1
          DISPLAY   *P1:24,*EL,"Copying files ... Please wait !! ";
.
.         Copy old file to the keyin directory
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "cp `ldat emrvisaf.dat` ",CMDLINE
          APPEND    OLDPATH,CMDLINE
          APPEND    "semvisaf.dat",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CMATCH    "0",TASKID
          IF        !@EQUAL
            GOTO      PREP8000
          ENDIF
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "cp `ldat emrvisaf.idx` ",CMDLINE
          APPEND    OLDPATH,CMDLINE
          APPEND    "semvisaf.idx",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CMATCH    "0",TASKID
          IF        !@EQUAL
            GOTO      PREP8000
          ENDIF
.
.         Remove the original files
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "iserase ",CMDLINE
          APPEND    DEFPATH,CMDLINE
          APPEND    "emrvisaf",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CMATCH    "0",TASKID
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,"Unable to remove the original file.  ";
            CALL      HITENTER
            GOTO      PREP9000
          ENDIF
.
.         Opening old file after being copied
.
          MOVE      SP60,DIM60
          CLEAR     DIM60
          APPEND    OLDPATH,DIM60
          APPEND    "semvisaf",DIM60
          APPEND    SP60,DIM60
          RESET     DIM60
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OLDFILE1,DIM60
          TRAPCLR   IO
          IF        OVRCD = 1
            DISPLAY   *P1:24,*EL,*B,"Unable to open saved original file.  ";
            CALL      HITENTER
            GOTO      PREP9000
          ENDIF
.
.         Create the new file
.
          DISPLAY   *P1:24,*EL,"Creating new files ... Please wait !! ";
          PACK      NEWFILE,SP60
          CLEAR     NEWFILE
          APPEND    NEWPATH,NEWFILE
          APPEND    "emrvisaf",NEWFILE
          APPEND    SP60,NEWFILE
          RESET     NEWFILE
          SQUEEZE   NEWFILE
.
PREP1000  PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isbuild ",CMDLINE
          APPEND    NEWFILE,CMDLINE
.
.  The files new record length and unique key must be written here
.
          APPEND    " 1629 UC1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
.  If the file has more than one index, this piece of code below has 
.  to be repeated with for each individual index
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isadd ",CMDLINE
          APPEND    NEWFILE,CMDLINE
          APPEND    " UC9-9,1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isadd ",CMDLINE
          APPEND    NEWFILE,CMDLINE
          APPEND    " UC10-17,1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isadd ",CMDLINE
          APPEND    NEWFILE,CMDLINE
          APPEND    " UC18-25,26-33,1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isadd ",CMDLINE
          APPEND    NEWFILE,CMDLINE
          APPEND    " UC992-994,9-9,1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isadd ",CMDLINE
          APPEND    NEWFILE,CMDLINE
          APPEND    " UC992-994,18-25,26-33,1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "isadd ",CMDLINE
          APPEND    NEWFILE,CMDLINE
          APPEND    " UC137-139,1-8",CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          DISPLAY   *P1:24,*EL;
          MOVE      ZERO,EXIT
          CALL      IBACLOCK
          REP       " 0",CDATE
          DISPLAY   *P1:18,"Started : ",CDATE,SP1,CTIMEIS:
                    *P1:20,"Record : "
          GOTO      PREP9999
.
PREP5000  DISPLAY   *P1:24,*EL,*B,"Old file not found.  ";
          CALL      HITENTER
          GOTO      PREP9000
.
PREP8000  DISPLAY   *P1:24,*EL,*B,"Unable to copy original file.  ":
                    "(Error: ",TASKID,")  ";
          CALL      HITENTER
.
PREP9000  MOVE      ONE,EXIT
.
PREP9999  RETURN
+
.********************************************************************
.*                          CHEK0000                                *
.*  Check if file exists, or has already been converted             *
.********************************************************************
.
CHEK0000  MOVE      ZERO,EXIT
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND GIVING DIM60 IF IO
          OPEN      OLDFILE1,INPFILE
          TRAPCLR   IO
          BRANCH    OVRCD,CHEK2000       * Original file does not exist
          CLOSE     OLDFILE1
          GOTO      CHEK9999
.
CHEK2000  RESET     DIM60
          SCAN      "I * I",DIM60
          DISPLAY   *P1:23,*EF,"File '",INPFILE,"' ";
          IF        @EQUAL
            DISPLAY   "does not exist - ";
          ELSE
            RESET     DIM60
            SCAN      "I * L",DIM60
            IF        @EQUAL
              DISPLAY   "has already been converted - ";
            ELSE
              DISPLAY   "has caused an IO error - ";
            ENDIF
          ENDIF
          DISPLAY   "File will be bypassed"
.
          CALL      HITENTER
          DISPLAY   *P1:23,*EF;
.
CHEK9000  MOVE      ONE,EXIT
.
CHEK9999  RETURN
+
.**********************************************************************
.*                               READ0000                             *
.*             loop thru old file and write each record               *
.**********************************************************************
.
READ0000  DISPLAY   *P1:20,*EL,"Record No. : ";
          OPEN      EMRVISA1,"emrvisaf"
.
          PACK      KEY8,SP60
          CALL      READSOLD                      * position at start
READ1000  CALL      READKOLD                      * read next record
          BRANCH    OVRCD,READ6000                * no more records
.
          ADD       ONE,RECNUM                    * update record counter
          ADD       ONE,DISNUM                    * Display counter
.
          IF        DISNUM = 5000  | RECNUM = 1
            MOVE      ZERO,DISNUM
            DISPLAY   *P15:20,*V2LON,RECNUM
          ENDIF
.
          PACK      KEY8,EMVIURNO,SP70
          CALL      WREMVIS1                      * write to new file
.
          GOTO      READ1000                      * get next record
.
READ6000  CLOSE     EMRVISA1                      * close new file
          CLOSE     OLDFILE1                      * close old file
.
          CALL      IBACLOCK
          REP       " 0",CDATE
          DISPLAY   *P15:20,*V2LON,RECNUM,*HOFF:
                    *P1:22,"Ended  : ",CDATE,SP1,CTIMEIS:
                    *P1:24;
.
READ9999  RETURN
+
.**********************************************************************
.*                               VALD0000                             *
.*        Check if it a valid directory                               *
.**********************************************************************
.
VALD0000  MOVE      ZERO,EXIT
.
          SQUEEZE   DIM60
          ENDSET    DIM60
          CMATCH    SLASH,DIM60
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,"Directory path must end with a slash (/) ";
            CALL      HITENTER
            GOTO      VALD9000
          ENDIF
          RESET     DIM60
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          APPEND    "cd ",CMDLINE
          APPEND    DIM60,CMDLINE
          APPEND    SP60,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID      * check if exists
.
          CMATCH    "0",TASKID
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,"Directory does not exist ";
            CALL      HITENTER
            GOTO      VALD9000
          ENDIF
          GOTO      VALD9999
.
VALD9000  MOVE      ONE,EXIT            * Not valid
.
VALD9999  RETURN
+
.**********************************************************************
.*                               ENDP0000                             *
.*        Remove or zip save file                                     *
.**********************************************************************
.
ENDP0000  MOVE      SP60,DIM60
          CLEAR     DIM60
          APPEND    OLDPATH,DIM60        * set up the saved file with path
          APPEND    "semvisaf*",DIM60
          APPEND    SP60,DIM60
          RESET     DIM60
          SQUEEZE   DIM60
.
          PACK      CMDLINE,SP60,SP60
          CLEAR     CMDLINE
          IF        SAVEFLG = 1
            APPEND    "gzip -f ",CMDLINE
            APPEND    DIM60,CMDLINE
            APPEND    SP60,CMDLINE
            RESET     CMDLINE
            DISPLAY   *P1:24,*EL,"Compressing original file.. ":
                      "Please wait !!  ";
          ELSE
            APPEND    "rm ",CMDLINE
            APPEND    DIM60,CMDLINE
            APPEND    SP60,CMDLINE
            RESET     CMDLINE
            DISPLAY   *P1:24,*EL,"Removing original file.. Please wait !!  ";
          ENDIF
          EXECUTE   CMDLINE,TASKID      * check if exists
.
          CMATCH    "0",TASKID
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,"Saved file not zipped or removed.  ";
            CALL      HITENTER
            GOTO      ENDP9999
          ENDIF
.
          CALL      IBACLOCK
          REP       " 0",CDATE
          DISPLAY   *P1:24,*EL,*B,"Finished processing  ",CDATE,SP1,CTIMEIS:
                    ".  ";
          CALL      HITENTER
.
ENDP9999  RETURN
+
.**********************************************************************
.*        DEFT0000 -  Get the default directory                       *
.**********************************************************************
.
DEFT0000  EXECUTE   "ldat emrvisaf.dat > temp.txt",TASKID
.
          PACK      DEFPATH,SP30,SP30
          CLOSE     FINDFILE
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FINDFILE,"temp"
          TRAPCLR   IO
          BRANCH    OVRCD,DEFT3000
.
          READ      FINDFILE,SEQ;DEFPATH
          GOTO      DEFT3000 IF OVER
.
          ENDSET    DEFPATH
DEFT1000  CMATCH    "/",DEFPATH
          GOTO      DEFT2000 IF EQUAL
.
          BUMP      DEFPATH,-1
          GOTO      DEFT1000 IF NOT EOS
          GOTO      DEFT3000
.
DEFT2000  LENSET    DEFPATH
          RESET     DEFPATH
.
          PACK      DEFPATH,DEFPATH,SP30,SP30,SP30,SP30
          STRIP     DEFPATH
          ENDSET    DEFPATH
          RESET     DEFPATH
          CLOSE     FINDFILE
          MOVE      ZERO,EXIT
          GOTO      DEFT9999
.
DEFT3000  DISPLAY   *P1:24,*EL,*B,"Error finding 'emrvisaf'.  ";
          CALL      HITENTER
          CLOSE     FINDFILE
          MOVE      ONE,EXIT
.
DEFT9999  RETURN
+
.*****************************************************************************
.*        I/O Routines                                                       *
.*****************************************************************************
.
. EMRVISIO    
. --------
. Filename     : emrvisaf.dat
.
READSOLD  RESET     KEY8                                                        
          READ      OLDFILE1,KEY8;;                                             
          RETURN
.
.
READKOLD  MOVE      ZERO,OVRCD
          READKS    OLDFILE1;DEMVIADM,DEMVISTA,EMVIURNO,EMVIDATE,EMVITIME:      
                        EMVITRIG,EMVICOM1,EMVICOM2,EMVILOCN,EMVIDOCT,EMVICOMP:  
                        EMVICLAS,EMVIINSR,EMVISRCE,EMVISITN,EMVIMODE,EMVIADMT:  
                        EMVIDURN,EMVIEMPL,EMVIWAIT,EMVIPREV,EMVIFUND,EMVITABL:  
                        EMVIREFG,EMVIREFD,EMVIPLIN,EMVIINIT,EMVIRTAS,EMVIDDAT:  
                        EMVIDTIM,EMVIDSTA,EMVIOPR1,EMVIOPR2,EMVIUC01,EMVIUC02:  
                        EMVIUC03,EMVIUC04,EMVIUC05,EMVIUC06,EMVIUC07,EMVIUC08:  
                        EMVIUC09,EMVIUC10,EMVIUC11,EMVIUC12,EMVIUC13,EMVIUC14:  
                        EMVIUC15,EMVIUC16,EMVIUC17,EMVIUC18,EMVIUC19,EMVIUC20:  
                        EMVIUC21,EMVIUC22,EMVIUC23,EMVIUC24,EMVIUC25,EMVIUC26:  
                        EMVIUC27,EMVIUC28,EMVIUC29,EMVIUC30,EMVIUD01,EMVIUD02:  
                        EMVIUD03,EMVIUD04,EMVIUD05,EMVIUD06,EMVIUD07,EMVIUD08:  
                        EMVIUD09,EMVIUD10,EMVIUT01,EMVIUT02,EMVIUT03,EMVIUT04:  
                        EMVIUT05,EMVIUT06,EMVIUT07,EMVIUT08,EMVIUT09,EMVIUT10:  
                        EMVIYN01,EMVIYN02,EMVIYN03,EMVIYN04,EMVIYN05,EMVIYN06:  
                        EMVIYN07,EMVIYN08,EMVIYN09,EMVIYN10,EMVITXT1,EMVITXT2:  
                        EMVITXT3,EMVITXT4,EMVITXT5,EMVIUN01,EMVIUN02,EMVIUN03:  
                        EMVIUN04,EMVIUN05,EMVIELAP,EMVINSDT,EMVINSTM,EMVIDRDT:  
                        EMVIDRTM,EMVIPATT,EMVITSRC,EMVIDEST,OLDAMBL,EMVIREGN:  
                        EMVISENT,EMVIUR01,EMVIUR02,EMVIUR03,EMVIUR04,EMVIUR05:  
                        EMVIPADM,EMVIEWRD,EMVIEBED,EMVIHFMN,EMVIACLS,EMVICCLS:  
                        EMVITRNS,EMVIDUM1,EMVITRDT,EMVITRTM,EMVIATNS,EMVIDUM2:  
                        EMVIEXLC,EMVISITE,EMVIUNIT,EMVICOM3,EMVICOM4,EMVICOM5:  
                        EMVICOM6,EMVIINJ1,EMVIINJ2,EMVINATI,EMVIINJC,EMVIHUMI:  
                        EMVIACTI,EMVILOCO,EMVIPRLO,EMVIPRTM,EMVIDPDT,EMVIDPTM:
                        EMVIEXRS,EMVIDLRS,EMVISPDT,EMVISPTM,EMVISADT,EMVISATM:
                        EMVIMPRA,EMVIMPDT,EMVIMPTM,OLDSPAR
.
          GOTO      OVERCOND IF OVER
.
          UNPACK    OLDSPAR,EMVIAADT,EMVIAATM,EMVIAHDT:
                            EMVIAHTM,EMVIDADT,EMVIDATM
          PACK      EMVIAMBL,OLDAMBL,SP70
.
          RETURN
.
.
.
.
.                  ******************************    NEW IO ROUTINES
.
. EMRVISIO    
. --------
. Filename     : emrvisaf.dat
.
.
WREMVIS1  RESET     KEY8                                                        
          WRITE     EMRVISA1,KEY8;DEMVIADM,DEMVISTA,EMVIURNO,EMVIDATE,EMVITIME: 
                        EMVITRIG,EMVICOM1,EMVICOM2,EMVILOCN,EMVIDOCT,EMVICOMP:  
                        EMVICLAS,EMVIINSR,EMVISRCE,EMVISITN,EMVIMODE,EMVIADMT:  
                        EMVIDURN,EMVIEMPL,EMVIWAIT,EMVIPREV,EMVIFUND,EMVITABL:  
                        EMVIREFG,EMVIREFD,EMVIPLIN,EMVIINIT,EMVIRTAS,EMVIDDAT:  
                        EMVIDTIM,EMVIDSTA,EMVIOPR1,EMVIOPR2,EMVIUC01,EMVIUC02:  
                        EMVIUC03,EMVIUC04,EMVIUC05,EMVIUC06,EMVIUC07,EMVIUC08:  
                        EMVIUC09,EMVIUC10,EMVIUC11,EMVIUC12,EMVIUC13,EMVIUC14:  
                        EMVIUC15,EMVIUC16,EMVIUC17,EMVIUC18,EMVIUC19,EMVIUC20:  
                        EMVIUC21,EMVIUC22,EMVIUC23,EMVIUC24,EMVIUC25,EMVIUC26:  
                        EMVIUC27,EMVIUC28,EMVIUC29,EMVIUC30,EMVIUD01,EMVIUD02:  
                        EMVIUD03,EMVIUD04,EMVIUD05,EMVIUD06,EMVIUD07,EMVIUD08:  
                        EMVIUD09,EMVIUD10,EMVIUT01,EMVIUT02,EMVIUT03,EMVIUT04:  
                        EMVIUT05,EMVIUT06,EMVIUT07,EMVIUT08,EMVIUT09,EMVIUT10:  
                        EMVIYN01,EMVIYN02,EMVIYN03,EMVIYN04,EMVIYN05,EMVIYN06:  
                        EMVIYN07,EMVIYN08,EMVIYN09,EMVIYN10,EMVITXT1,EMVITXT2:  
                        EMVITXT3,EMVITXT4,EMVITXT5,EMVIUN01,EMVIUN02,EMVIUN03:  
                        EMVIUN04,EMVIUN05,EMVIELAP,EMVINSDT,EMVINSTM,EMVIDRDT:  
                        EMVIDRTM,EMVIPATT,EMVITSRC,EMVIDEST,EMVIAMBL,EMVIREGN:  
                        EMVISENT,EMVIUR01,EMVIUR02,EMVIUR03,EMVIUR04,EMVIUR05:  
                        EMVIPADM,EMVIEWRD,EMVIEBED,EMVIHFMN,EMVIACLS,EMVICCLS:  
                        EMVITRNS,EMVIDUM1,EMVITRDT,EMVITRTM,EMVIATNS,EMVIDUM2:  
                        EMVIEXLC,EMVISITE,EMVIUNIT,EMVICOM3,EMVICOM4,EMVICOM5:  
                        EMVICOM6,EMVIINJ1,EMVIINJ2,EMVINATI,EMVIINJC,EMVIHUMI:  
                        EMVIACTI,EMVILOCO,EMVIPRLO,EMVIPRTM,EMVIDPDT,EMVIDPTM:  
                        EMVIEXRS,EMVIDLRS,EMVISPDT,EMVISPTM,EMVISADT,EMVISATM:  
                        EMVIMPRA,EMVIMPDT,EMVIMPTM,EMVIAADT,EMVIAATM,EMVIAHDT:  
                        EMVIAHTM,EMVIDADT,EMVIDATM,EMVIPURC,EMVIMNCD,EMVIMNDT:  
                        EMVIMNTM,EMVIMDCD,EMVIMDDT,EMVIMDTM,EMVISPAR            
          RETURN
.
.
.
................................................................................
.
          INC       STD001IO
