.******************************************************************************
.* Include        : KYACCDET.PBL                                              *
.* System         : Patient Management                                        *
.* Author         : Howellsy (09/09/96)                                       *
.*                                                                            *
.* Function       : This contains the branch statement which calls the        *
.*                  appropriate keyin routine for the desired ACC var.        *
.*                  and all the keyin routines.                               *
.* Modifications  :                                                           *
.*        V5.08.01  27/06/2000  Greg Horvat                                   *
.*                  Recompiled for PATICDKY - Validating ICD10 version 2 codes*
.*        V5.07.01  06/11/1999  Greg Horvat                                   *
.*                  Recompiled for PATICDKY                                   *
.*                                                                            *
.******************************************************************************
KYACCDET  MOVE      SCPSITM,FIELDNO         * field no.
          MOVE      SCPSROW,CVERT           * row of keyin
          MOVE      SCPSCOL,CCOL            * column of keyin
          MOVE      SCPSROW,EVERT           * row of keyin
          MOVE      SCPSCOL,ECOL            * column of keyin
          MOVE      SCPSMAN,CKYIMAND        * mandatory
          SFORMAT   KEYFIELD,127
          MOVE      ZERO,EXIT
.
          BRANCH    FIELDNO,KACCD001,KACCD002,KACCD003,KACCD004,KACCD005:
                            KACCD006,KACCD007,KACCD008,KACCD009,KACCD010:   10
                            KACCD011,KACCD012,KACCD013,KACCD014,KACCD015:
                            KACCD999,KACCD017,KACCD999,KACCD019,KACCD999:   20
                            KACCD021,KACCD999,KACCD023,KACCD999,KACCD025:
                            KACCD999,KACCD027,KACCD999,KACCD029,KACCD999:   30
                            KACCD031,KACCD999,KACCD033,KACCD034,KACCD035:
                            KACCD036,KACCD037,KACCD038,KACCD039,KACCD040:   40
                            KACCD041,KACCD042,KACCD043,KACCD044,KACCD045:
                            KACCD046,KACCD047,KACCD048,KACCD049,KACCD050:   50
                            KACCD051,KACCD052,KACCD999,KACCD054,KACCD999:
                            KACCD056,KACCD999,KACCD058,KACCD999,KACCD060:   60
                            KACCD999,KACCD062,KACCD999,KACCD064,KACCD999:
                            KACCD066,KACCD999,KACCD068,KACCD999,KACCD070:   70
                            KACCD071,KACCD072
.
          GOTO      KACCD999
.
. 1. ACC Number   
.
KACCD001  CALL      KACCNU00     
          GOTO      KACCD995
.
. 2. ACC Approval 
.
KACCD002  MOVE      ECACACCA,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACACCA
          GOTO      KACCD995
.
. 3. Date Field 1               
.
KACCD003  MOVE      ECACDAT1,KEY8
          CALL      KADATE00
          MOVE      KEY8,ECACDAT1 
          GOTO      KACCD995
.
. 4. Time Field 1               
.
KACCD004  MOVE      ECACTIM1,KEY5
          CALL      KATIME00
          MOVE      KEY5,ECACTIM1 
          GOTO      KACCD995
.
. 5. Date Field 2               
.
KACCD005  MOVE      ECACDAT2,KEY8
          CALL      KADATE00
          MOVE      KEY8,ECACDAT2 
          GOTO      KACCD995
.
. 6. Time Field 2               
.
KACCD006  MOVE      ECACTIM2,KEY5
          CALL      KATIME00
          MOVE      KEY5,ECACTIM2 
          GOTO      KACCD995
.
. 7. Date Field 3               
.
KACCD007  MOVE      ECACDAT3,KEY8
          CALL      KADATE00
          MOVE      KEY8,ECACDAT3 
          GOTO      KACCD995
.
. 8. Time Field 3               
.
KACCD008  MOVE      ECACTIM3,KEY5
          CALL      KATIME00
          MOVE      KEY5,ECACTIM3 
          GOTO      KACCD995
.
. 9. Date Field 4               
.
KACCD009  MOVE      ECACDAT4,KEY8
          CALL      KADATE00
          MOVE      KEY8,ECACDAT4 
          GOTO      KACCD995
.
. 10. Time Field 4               
.
KACCD010  MOVE      ECACTIM4,KEY5
          CALL      KATIME00
          MOVE      KEY5,ECACTIM4 
          GOTO      KACCD995
.
. 11. Date Field 5               
.
KACCD011  MOVE      ECACDAT5,KEY8
          CALL      KADATE00
          MOVE      KEY8,ECACDAT5 
          GOTO      KACCD995
.
. 12. Time Field 5               
.
KACCD012  MOVE      ECACTIM5,KEY5
          CALL      KATIME00
          MOVE      KEY5,ECACTIM5 
          GOTO      KACCD995
.
. 13. Date Field 6               
.
KACCD013  MOVE      ECACDAT6,KEY8
          CALL      KADATE00
          MOVE      KEY8,ECACDAT6 
          GOTO      KACCD995
.
. 14. Time Field 6               
.
KACCD014  MOVE      ECACTIM6,KEY5
          CALL      KATIME00
          MOVE      KEY5,ECACTIM6 
          GOTO      KACCD995
.
. 15. Doctor Field 1        
.
KACCD015  CALL      KA1DOC00 
          GOTO      KACCD999
.
. 17. Doctor Field 2        
.
KACCD017  CALL      KA2DOC00 
          GOTO      KACCD999
.
. 19. Doctor Field 3        
.
KACCD019  CALL      KA3DOC00 
          GOTO      KACCD999
.
. 21. Doctor Field 4        
.
KACCD021  CALL      KA4DOC00 
          GOTO      KACCD999
.
. 23. Doctor Field 5        
.
KACCD023  CALL      KA5DOC00 
          GOTO      KACCD999
.
. 25. Doctor Field 6        
.
KACCD025  CALL      KA6DOC00 
          GOTO      KACCD999
.
. 27. Diagnosis Field 1     
.
KACCD027  MOVE      ECACDIA1,CKYIDEF9
          CALL      KA1DIA00
          GOTO      KACCD995
.
. 29. Diagnosis Field 2    
.
KACCD029  MOVE      ECACDIA2,CKYIDEF9
          CALL      KA2DIA00
          GOTO      KACCD995
.
. 31. Diagnosis Field 3    
.
KACCD031  MOVE      ECACDIA3,CKYIDEF9
          CALL      KA3DIA00
          GOTO      KACCD995
.
. 33. Diagnosis Field 4    
.
KACCD033  PACK      KEYFIELD,ECACDIA4,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACDIA4,KEYFIELD,SP20
          GOTO      KACCD995
.
. 34. Diagnosis Field 5    
.
KACCD034  PACK      KEYFIELD,ECACDIA5,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACDIA5,KEYFIELD,SP20
          GOTO      KACCD995
.
. 35. Diagnosis Field 6    
.
KACCD035  PACK      KEYFIELD,ECACDIA6,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACDIA6,KEYFIELD,SP20
          GOTO      KACCD995
.
. 36. Yes/No Field 1       
.
KACCD036  MOVE      ECACYNO1,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACYNO1
          GOTO      KACCD995
.
. 37. Yes/No Field 2       
.
KACCD037  MOVE      ECACYNO2,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACYNO2
          GOTO      KACCD995
.
. 38. Yes/No Field 3       
.
KACCD038  MOVE      ECACYNO3,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACYNO3
          GOTO      KACCD995
.
. 39. Yes/No Field 4       
.
KACCD039  MOVE      ECACYNO4,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACYNO4
          GOTO      KACCD995
.
. 40. Yes/No Field 5       
.
KACCD040  MOVE      ECACYNO5,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACYNO5
          GOTO      KACCD995
.
. 41. Yes/No Field 6       
.
KACCD041  MOVE      ECACYNO6,ANS
          CALL      KAYESN00
          MOVE      FORM1,ECACYNO6
          GOTO      KACCD995
.
. 42. Free Format Field 1  
.
KACCD042  PACK      KEYFIELD,ECACFRE1,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE1,KEYFIELD,SP20
          GOTO      KACCD995
.
. 43. Free Format Field 2  
.
KACCD043  PACK      KEYFIELD,ECACFRE2,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE2,KEYFIELD,SP20
          GOTO      KACCD995
.
. 44. Free Format Field 3  
.
KACCD044  PACK      KEYFIELD,ECACFRE3,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE3,KEYFIELD,SP20
          GOTO      KACCD995
.
. 45. Free Format Field 4  
.
KACCD045  PACK      KEYFIELD,ECACFRE4,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE4,KEYFIELD,SP20
          GOTO      KACCD995
.
. 46. Free Format Field 5  
.
KACCD046  PACK      KEYFIELD,ECACFRE5,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE5,KEYFIELD,SP20
          GOTO      KACCD995
.
. 47. Free Format Field 6  
.
KACCD047  PACK      KEYFIELD,ECACFRE6,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE6,KEYFIELD,SP20
          GOTO      KACCD995
.
. 48. Free Format Field 7  
.
KACCD048  PACK      KEYFIELD,ECACFRE7,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE7,KEYFIELD,SP20
          GOTO      KACCD995
.
. 49. Free Format Field 8  
.
KACCD049  PACK      KEYFIELD,ECACFRE8,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE8,KEYFIELD,SP20
          GOTO      KACCD995
.
. 50. Free Format Field 9  
.
KACCD050  PACK      KEYFIELD,ECACFRE9,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFRE9,KEYFIELD,SP20
          GOTO      KACCD995
.
. 51. Free Format Field 10 
.
KACCD051  PACK      KEYFIELD,ECACFR10,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
          PACK      ECACFR10,KEYFIELD,SP20
          GOTO      KACCD995
.
. 52. User Defined Field 1
.
KACCD052  CALL      KA1COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 54. User Defined Field 2
.
KACCD054  CALL      KA2COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 56. User Defined Field 3
.
KACCD056  CALL      KA3COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 58. User Defined Field 4
.
KACCD058  CALL      KA4COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 60. User Defined Field 5
.
KACCD060  CALL      KA5COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 62. User Defined Field 6
.
KACCD062  CALL      KA6COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 64. User Defined Field 7
.
KACCD064  CALL      KA7COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 66. User Defined Field 8
.
KACCD066  CALL      KA8COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 68. User Defined Field 9
.
KACCD068  CALL      KA9COD00                     * keyin to desired length
          GOTO      KACCD999
.
. 70. Numeric Field 1      
.
KACCD070  MOVE      ECACNUM1,FORM8
          CALL      KANUMB00
          MOVE      FORM8,ECACNUM1
          GOTO      KACCD995
.
. 71. Numeric Field 2      
.
KACCD071  MOVE      ECACNUM2,FORM8
          CALL      KANUMB00
          MOVE      FORM8,ECACNUM2
          GOTO      KACCD995
.
. 72. Date Of Accident           
.
KACCD072  MOVE      ECACDACC,KEY8
          CALL      KADATE00
          CALL      IBACLOCK
          PACK      DIM8,CCC,CYY,CMM,CDD,SP10
          REP       " 0",DIM8
          MATCH     KEY8,DIM8
          IF        @LESS
            DISPLAY   *P1:24,*EL,*B,"Date of Accident Cannot be in the":
                                    " Future. ";
            CALL      HITENTER
            GOTO      KACCD072
          ENDIF
          MOVE      KEY8,ECACDACC 
          GOTO      KACCD995
.
KACCD995  CALL      DISPVARS
.
KACCD999  RETURN
+
.***************************************************************************
.*  KACCNU00  :  Keyin ACC Number                                          *
.***************************************************************************
KACCNU00  PACK      KEYFIELD,ECACACCN,SP70,SP70
          MOVE      ONE,YESDFLTS
          MOVE      ZERO,KYNTITL
          CALL      KFREEF00                     * keyin to desired length
.
          CMATCH    EXITCHAR,KEYFIELD
          GOTO      KACCNU95 IF EQUAL
.
          MOVE      KEYFIELD,KEY20
.
. ------- Is it a different ACC Number Input ----------------
.
          MATCH     ECACACCN,KEY20
          GOTO      KACCNU90 IF EQUAL
.
. ------- make sure this ACC Number is not used ------
.
          PACK      KEY20,KEY20,SP20
          CALL      RAECACC1
          COMPARE   ZERO,OVRCD
          GOTO      KACCNU80 IF EQUAL
.
. ------- this is a new ACC Number -------------------
.
          PACK      ECACACCN,KEYFIELD,SP20
.
          GOTO      KACCNU90
.
.
KACCNU80  DISPLAY   *P1:24,*EL,*B,"ACC Number is linked to a different ":
                                  "Episode of Care. ";
          CALL      HITENTER
          GOTO      KACCNU00
.
KACCNU90  MOVE      ZERO,EXIT
          GOTO      KACCNU99
.
KACCNU95  MOVE      ONE,EXIT
.
KACCNU99  RETURN
.***************************************************************************
.*  KAYESN00  :  Yes/No                                                    *
.*               Default : ANS                                             *
.*               Returns : FORM1                                           *
.***************************************************************************
KAYESN00  REP       "1Y0N",ANS
          MOVE      ANS,DIM1                      * save default
.         
KAYESN10  MOVE      DIM1,ANS
          KEYIN     *PCCOL:CVERT,*DV,ANS:
                    *PCCOL:CVERT,*V2LON,*RV,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          RESET     ANS
          GOTO      KAYESN80 IF EOS
.
          TYPE      ANS                      * check if a number was input
          GOTO      KAYESN90 IF EQUAL         * yes, invalid
.
          REP       "Y1y1N0n0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KAYESN90 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,FORM1                * set exit to Y/N value
.
          MOVE      DNO,DIM3                 * assume answer was "No "
          LOAD      DIM3,FORM1,DYES,DNO      * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DIM3 
          GOTO      KAYESN99
.
KAYESN80  MOVE      ZERO,FORM1
          IF        SCPSMAN=1
            DISPLAY   *P1:24,*EL,*B,"Field is Mandatory. ";
            CALL      HITENTER
            MOVE      "0",ANS
            GOTO      KAYESN00
          ENDIF
.
KAYESN90  BEEP
          GOTO      KAYESN10
.
KAYESN99  RETURN
+
.***************************************************************************
.*  KADATE00  :  Date Field                                                *
.*               Default : KEY8                                            *
.*               Returns : KEY8                                            *
.***************************************************************************
KADATE00  MOVE      ZERO,CCANLDTE
          MOVE      ZERO,CDEFDTE
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          MATCH     SP8,KEY8
          IF        @EQUAL
            MOVE      CCC,CCENT
          ENDIF
.  
          CALL      KEYDATE
          BRANCH    CQUEST,KADATE00               * don't allow "?"
          BRANCH    OVRCD,KADATE90
.
          PACK      KEY8,CCENT,CYEAR,CMON,CDAY
          REP       " 0",KEY8
          GOTO      KADATE99
.
KADATE90  MOVE      SP8,KEY8
          IF        SCPSMAN=1
            DISPLAY   *P1:24,*EL,*B,"Field is Mandatory. ";
            CALL      HITENTER
            GOTO      KADATE00
          ENDIF
.
KADATE99  RETURN
.***************************************************************************
.*  KATIME00  :  Time Field                                                *
.*               Default : KEY5                                            *
.*               Returns : KEY5                                            *
.***************************************************************************
KATIME00  MOVE      ZERO,CCANLDTE
          MOVE      ONE,CDEFDTE
...          CLOCK     TIME,CTIMEIS
...          IF        ACCEPT = 1
...            MOVE      CTIMEIS,KEY5              * insert mode
...          ENDIF
          UNPACK    KEY5,CHOUR,ANS,CMIN        * insert mode
.  
          CALL      KEYTIME
          BRANCH    CQUEST,KATIME00               * don't allow "?"
          BRANCH    OVRCD,KATIME90
.
          PACK      KEY5,CHOUR,COLON,CMIN
          REP       " 0",KEY5
          GOTO      KATIME99
.
KATIME90  MOVE      SP5,KEY5
          IF        SCPSMAN=1
            DISPLAY   *P1:24,*EL,*B,"Field is Mandatory. ";
            CALL      HITENTER
            GOTO      KATIME00
          ENDIF
.
KATIME99  RETURN
.***************************************************************************
.*  KA1DOC00  :  Doctor Code 1                                             *
.***************************************************************************
KA1DOC00  MOVE      ECACDOC1,CKYIDEF6
.
          CALL      PATDOCKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA1DOC90 IF EQUAL
.
          MOVE      "   15",KEY5
          CALL      SCRCKFLD
          BRANCH    EXIT,KA1DOC40
          PACK      VAR,DCODE,SP70,SP10
          CALL      DISPITEM
.
KA1DOC40  MOVE      "   16",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA1DOC80                 * No
.
          MOVE      DCODE,ECACDOC1
          MOVE      DCODE,KEY6   
          CALL      DXPATDOC
.
KA1DOC60  PACK      VAR,PACFNAME,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA1DOC80  MOVE      ZERO,EXIT
          GOTO      KA1DOC99
.
KA1DOC90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA1DOC99  RETURN
.***************************************************************************
.*  KA2DOC00  :  Doctor Code 2                                             *
.***************************************************************************
KA2DOC00  MOVE      ECACDOC2,CKYIDEF6
.
          CALL      PATDOCKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA2DOC90 IF EQUAL
.
          MOVE      "   17",KEY5
          CALL      SCRCKFLD
          BRANCH    EXIT,KA2DOC40
          PACK      VAR,DCODE,SP70,SP10
          CALL      DISPITEM
.
KA2DOC40  MOVE      "   18",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA2DOC80                 * No
.
          MOVE      DCODE,ECACDOC2
          MOVE      DCODE,KEY6   
          CALL      DXPATDOC
.
KA2DOC60  PACK      VAR,PACFNAME,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA2DOC80  MOVE      ZERO,EXIT
          GOTO      KA2DOC99
.
KA2DOC90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA2DOC99  RETURN
.***************************************************************************
.*  KA3DOC00  :  Doctor Code 3                                             *
.***************************************************************************
KA3DOC00  MOVE      ECACDOC3,CKYIDEF6
.
          CALL      PATDOCKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA3DOC90 IF EQUAL
.
          MOVE      "   19",KEY5
          CALL      SCRCKFLD
          BRANCH    EXIT,KA3DOC40
          PACK      VAR,DCODE,SP70,SP10
          CALL      DISPITEM
.
KA3DOC40  MOVE      "   20",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA3DOC80                 * No
.
          MOVE      DCODE,ECACDOC3
          MOVE      DCODE,KEY6   
          CALL      DXPATDOC
.
KA3DOC60  PACK      VAR,PACFNAME,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA3DOC80  MOVE      ZERO,EXIT
          GOTO      KA3DOC99
.
KA3DOC90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA3DOC99  RETURN
.***************************************************************************
.*  KA4DOC00  :  Doctor Code 4                                             *
.***************************************************************************
KA4DOC00  MOVE      ECACDOC4,CKYIDEF6
.
          CALL      PATDOCKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA4DOC90 IF EQUAL
.
          MOVE      "   21",KEY5
          CALL      SCRCKFLD
          BRANCH    EXIT,KA4DOC40
          PACK      VAR,DCODE,SP70,SP10
          CALL      DISPITEM
.
KA4DOC40  MOVE      "   22",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA4DOC80                 * No
.
          MOVE      DCODE,ECACDOC4
          MOVE      DCODE,KEY6   
          CALL      DXPATDOC
.
KA4DOC60  PACK      VAR,PACFNAME,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA4DOC80  MOVE      ZERO,EXIT
          GOTO      KA4DOC99
.
KA4DOC90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA4DOC99  RETURN
.***************************************************************************
.*  KA5DOC00  :  Doctor Code 5                                             *
.***************************************************************************
KA5DOC00  MOVE      ECACDOC5,CKYIDEF6
.
          CALL      PATDOCKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA5DOC90 IF EQUAL
.
          MOVE      "   23",KEY5
          CALL      SCRCKFLD
          BRANCH    EXIT,KA5DOC40
          PACK      VAR,DCODE,SP70,SP10
          CALL      DISPITEM
.
KA5DOC40  MOVE      "   24",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA5DOC80                 * No
.
          MOVE      DCODE,ECACDOC5
          MOVE      DCODE,KEY6   
          CALL      DXPATDOC
.
KA5DOC60  PACK      VAR,PACFNAME,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA5DOC80  MOVE      ZERO,EXIT
          GOTO      KA5DOC99
.
KA5DOC90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA5DOC99  RETURN
.***************************************************************************
.*  KA6DOC00  :  Doctor Code 6                                             *
.***************************************************************************
KA6DOC00  MOVE      ECACDOC6,CKYIDEF6
.
          CALL      PATDOCKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA6DOC90 IF EQUAL
.
          MOVE      "   25",KEY5
          CALL      SCRCKFLD
          BRANCH    EXIT,KA6DOC40
          PACK      VAR,DCODE,SP70,SP10
          CALL      DISPITEM
.
KA6DOC40  MOVE      "   26",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA6DOC80                 * No
.
          MOVE      DCODE,ECACDOC6
          MOVE      DCODE,KEY6   
          CALL      DXPATDOC
.
KA6DOC60  PACK      VAR,PACFNAME,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA6DOC80  MOVE      ZERO,EXIT
          GOTO      KA6DOC99
.
KA6DOC90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA6DOC99  RETURN
.***************************************************************************
.*  KA1DIA00  :  Diagnosis Code 1                                          *
.***************************************************************************
KA1DIA00  MOVE      ECACDIA1,CKYIDEF9
.
          CALL      PATICDKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA1DIA90 IF EQUAL
.
          MOVE      "   28",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA1DIA80                 * No
.
          MOVE      DPCODE,ECACDIA1
.
KA1DIA60  PACK      VAR,DDESC,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA1DIA80  MOVE      ZERO,EXIT
          GOTO      KA1DIA99
.
KA1DIA90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA1DIA99  RETURN
.***************************************************************************
.*  KA2DIA00  :  Diagnosis Code 2                                          *
.***************************************************************************
KA2DIA00  MOVE      ECACDIA2,CKYIDEF9
.
          CALL      PATICDKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA2DIA90 IF EQUAL
.
          MOVE      "   30",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA2DIA80                 * No
.
          MOVE      DPCODE,ECACDIA2
.
KA2DIA60  PACK      VAR,DDESC,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA2DIA80  MOVE      ZERO,EXIT
          GOTO      KA2DIA99
.
KA2DIA90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA2DIA99  RETURN
.***************************************************************************
.*  KA3DIA00  :  Diagnosis Code 3                                          *
.***************************************************************************
KA3DIA00  MOVE      ECACDIA3,CKYIDEF9
.
          CALL      PATICDKY                      * keyin a Doctors code
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA3DIA90 IF EQUAL
.
          MOVE      "   32",KEY5
          CALL      SCRCKFLD                      * Display description ?
          BRANCH    EXIT,KA3DIA80                 * No
.
          MOVE      DPCODE,ECACDIA3
.
KA3DIA60  PACK      VAR,DDESC,SP70,SP10
          CALL      DISPITEM                      * Display description
.
KA3DIA80  MOVE      ZERO,EXIT
          GOTO      KA3DIA99
.
KA3DIA90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA3DIA99  RETURN
+
.***************************************************************************
.*  KA1COD00  :  Coded User Defined Field 1                                *
.***************************************************************************
KA1COD00  MOVE      CODEI1,CODE
          MOVE      ECACCOD1,CKYIDEF3
.
KA1COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA1COD90 IF EQUAL
          MOVE      ACODE,ECACCOD1
.
          MOVE      "   53",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA1COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA1COD80  MOVE      ZERO,EXIT
          GOTO      KA1COD99
.
KA1COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA1COD99  RETURN
+
.***************************************************************************
.*  KA2COD00  :  Coded User Defined Field 2                                *
.***************************************************************************
KA2COD00  MOVE      CODEI2,CODE
          MOVE      ECACCOD2,CKYIDEF3
.
KA2COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA2COD90 IF EQUAL
          MOVE      ACODE,ECACCOD2
.
          MOVE      "   55",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA2COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA2COD80  MOVE      ZERO,EXIT
          GOTO      KA2COD99
.
KA2COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA2COD99  RETURN
+
.***************************************************************************
.*  KA3COD00  :  Coded User Defined Field 3                                *
.***************************************************************************
KA3COD00  MOVE      CODEI3,CODE
          MOVE      ECACCOD3,CKYIDEF3
.
KA3COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA3COD90 IF EQUAL
          MOVE      ACODE,ECACCOD3
.
          MOVE      "   57",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA3COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA3COD80  MOVE      ZERO,EXIT
          GOTO      KA3COD99
.
KA3COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA3COD99  RETURN
+
.***************************************************************************
.*  KA4COD00  :  Coded User Defined Field 4                                *
.***************************************************************************
KA4COD00  MOVE      CODEI4,CODE
          MOVE      ECACCOD4,CKYIDEF3
.
KA4COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA4COD90 IF EQUAL
          MOVE      ACODE,ECACCOD4
.
          MOVE      "   59",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA4COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA4COD80  MOVE      ZERO,EXIT
          GOTO      KA4COD99
.
KA4COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA4COD99  RETURN
.***************************************************************************
.*  KA5COD00  :  Coded User Defined Field 5                                *
.***************************************************************************
KA5COD00  MOVE      CODEI5,CODE
          MOVE      ECACCOD5,CKYIDEF3
.
KA5COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA5COD90 IF EQUAL
          MOVE      ACODE,ECACCOD5
.
          MOVE      "   61",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA5COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA5COD80  MOVE      ZERO,EXIT
          GOTO      KA5COD99
.
KA5COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA5COD99  RETURN
+
.***************************************************************************
.*  KA6COD00  :  Coded User Defined Field 6                                *
.***************************************************************************
KA6COD00  MOVE      CODEI6,CODE
          MOVE      ECACCOD6,CKYIDEF3
.
KA6COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA6COD90 IF EQUAL
          MOVE      ACODE,ECACCOD6
.
          MOVE      "   63",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA6COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA6COD80  MOVE      ZERO,EXIT
          GOTO      KA6COD99
.
KA6COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA6COD99  RETURN
+
.***************************************************************************
.*  KA7COD00  :  Coded User Defined Field 7                                *
.***************************************************************************
KA7COD00  MOVE      CODEI7,CODE
          MOVE      ECACCOD7,CKYIDEF3
.
KA7COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA7COD90 IF EQUAL
          MOVE      ACODE,ECACCOD7
.
          MOVE      "   65",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA7COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA7COD80  MOVE      ZERO,EXIT
          GOTO      KA7COD99
.
KA7COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA7COD99  RETURN
+
.***************************************************************************
.*  KA8COD00  :  Coded User Defined Field 8                                *
.***************************************************************************
KA8COD00  MOVE      CODEI8,CODE
          MOVE      ECACCOD8,CKYIDEF3
.
KA8COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA8COD90 IF EQUAL
          MOVE      ACODE,ECACCOD8
.
          MOVE      "   67",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA8COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA8COD80  MOVE      ZERO,EXIT
          GOTO      KA8COD99
.
KA8COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA8COD99  RETURN
+
.***************************************************************************
.*  KA9COD00  :  Coded User Defined Field 9                                *
.***************************************************************************
KA9COD00  MOVE      CODEI9,CODE
          MOVE      ECACCOD9,CKYIDEF3
.
KA9COD05  CALL      PATCODKY
          COMPARE   TWO,EXIT                      * EXITCHAR ?
          GOTO      KA9COD90 IF EQUAL
          MOVE      ACODE,ECACCOD9
.
          MOVE      "   69",KEY5
          CALL      SCRCKFLD                      * display description ?
          BRANCH    EXIT,KA9COD80                 * No
          PACK      VAR,TDESC,SP70,SP10
          CALL      DISPITEM
.
KA9COD80  MOVE      ZERO,EXIT
          GOTO      KA9COD99
.
KA9COD90  MOVE      ONE,EXIT                      * EXITCHAR
.
KA9COD99  RETURN
.***************************************************************************
.*  KANUMB00  :  Keyin a Free Format Numeric Field                         *
.*               Default : FORM8                                           *
.*               Returns : FORM8                                           *
.***************************************************************************
KANUMB00  KEYIN     *PCCOL:CVERT,*DV,FORM8:
                    *PCCOL:CVERT,*V2LON,*RV,FORM8:
                    *PCCOL:CVERT,*DV,FORM8;
.
...          COMPARE   ZERO,FORM8
...          GOTO      KANUMB90 IF NOT EQUAL
.
...          BRANCH    SCPSMAN,KANUMB00        * field is mandatory
.
KANUMB90  MOVE      ZERO,EXIT
KANUMB99  RETURN
.
...............................................................................
