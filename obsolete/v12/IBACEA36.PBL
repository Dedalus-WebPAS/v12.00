.-------------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  15.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove PSN/OPR prefixed PAS cloned includes
.-------------------------------------------------------------------------------
. V6.04.01  07.07.1997 B.G.Ackland
.           File Layout Changes
.-------------------------------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------------------------------
ACTDUR    INIT      "Actual Duration"
COPYALL   FORM      1
OPRCLIOP  FORM      1
OPREXPOP  FORM      1
OPCNCLSU  FORM      1        111      Using Clinic or Surgeon ?
.                                          0 = Clinic
.                                          1 = Surgeon
PATDOCOP  FORM      1
SAVECOD   DIM       3
SAVEITM   DIM       9
.-------------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA36
.   Function      :   Theatre Patient Service Mapping         
.   Generated  On :   15/06/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSOPTDF    
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       CEATAMFD/INC
          INC       CEATBMFD/INC
          INC       CEATCMFD/INC
          INC       CEATDMFD/INC
          INC       CEATEMFD/INC
          INC       CEATFMFD/INC
          INC       CEATGMFD/INC
          INC       OPRCLIFD/INC
          INC       OPREXPFD/INC
          INC       PATCODFD/INC
          INC       PATDO1FD/INC
          INC       PATITMFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld     7
.-------------------------------------------------------
CETB1NAM  INIT      "CETB1"
CETB1LEN  FORM      "62"
CETB1IDX  INIT      "DC1-5 UC6-12"
CETB1FNM  DIM       8  * Filename
CETB1AFL  FORM      1  * End Accept Mode
CETB1END  FORM      1  * End Display
CETB1SNO  FORM      5  * Number of Items on the Screen
CETB1NXT  DIM         12
CETB1FL1  IFILE     SQL, FIXED=62,  KEY="D1-5"
CETB1FL2  IFILE     SQL, FIXED=62, KEY="U6-12"
CETB1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 02 Fld     7
.-------------------------------------------------------
CETA1NAM  INIT      "CETA1"
CETA1LEN  FORM      "56"
CETA1IDX  INIT      "DC1-5 UC6-12"
CETA1FNM  DIM       8  * Filename
CETA1AFL  FORM      1  * End Accept Mode
CETA1END  FORM      1  * End Display
CETA1SNO  FORM      5  * Number of Items on the Screen
CETA1NXT  DIM         12
CETA1FL1  IFILE     SQL, FIXED=56,  KEY="D1-5"
CETA1FL2  IFILE     SQL, FIXED=56, KEY="U6-12"
CETA1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 03 Fld     7
.-------------------------------------------------------
CETD1NAM  INIT      "CETD1"
CETD1LEN  FORM      "50"
CETD1IDX  INIT      "DC1-5 UC6-12"
CETD1FNM  DIM       8  * Filename
CETD1AFL  FORM      1  * End Accept Mode
CETD1END  FORM      1  * End Display
CETD1SNO  FORM      5  * Number of Items on the Screen
CETD1NXT  DIM         12
CETD1FL1  IFILE     SQL, FIXED=50,  KEY="D1-5"
CETD1FL2  IFILE     SQL, FIXED=50, KEY="U6-12"
CETD1CNT  FORM      3  * Number of Items on Screen
STRTDESC  DIM      18 * Scr 03 Fld    13
ENDTDESC  DIM      18 * Scr 03 Fld    14
.
.    Multi Item Key Fields Scr 04 Fld     7
.-------------------------------------------------------
CETC1NAM  INIT      "CETC1"
CETC1LEN  FORM      "50"
CETC1IDX  INIT      "DC1-5 UC6-12"
CETC1FNM  DIM       8  * Filename
CETC1AFL  FORM      1  * End Accept Mode
CETC1END  FORM      1  * End Display
CETC1SNO  FORM      5  * Number of Items on the Screen
CETC1NXT  DIM         12
CETC1FL1  IFILE     SQL, FIXED=50,  KEY="D1-5"
CETC1FL2  IFILE     SQL, FIXED=50, KEY="U6-12"
CETC1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 05 Fld     7
.-------------------------------------------------------
CETF1NAM  INIT      "CETF1"
CETF1LEN  FORM      "53"
CETF1IDX  INIT      "DC1-5 UC6-12"
CETF1FNM  DIM       8  * Filename
CETF1AFL  FORM      1  * End Accept Mode
CETF1END  FORM      1  * End Display
CETF1SNO  FORM      5  * Number of Items on the Screen
CETF1NXT  DIM         12
CETF1FL1  IFILE     SQL, FIXED=53,  KEY="D1-5"
CETF1FL2  IFILE     SQL, FIXED=53, KEY="U6-12"
CETF1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 06 Fld     7
.-------------------------------------------------------
CETG1NAM  INIT      "CETG1"
CETG1LEN  FORM      "54"
CETG1IDX  INIT      "DC1-5 UC6-12"
CETG1FNM  DIM       8  * Filename
CETG1AFL  FORM      1  * End Accept Mode
CETG1END  FORM      1  * End Display
CETG1SNO  FORM      5  * Number of Items on the Screen
CETG1NXT  DIM         12
CETG1FL1  IFILE     SQL, FIXED=54,  KEY="D1-5"
CETG1FL2  IFILE     SQL, FIXED=54, KEY="U6-12"
CETG1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 07 Fld     7
.-------------------------------------------------------
CETE1NAM  INIT      "CETE1"
CETE1LEN  FORM      "54"
CETE1IDX  INIT      "DC1-5 UC6-12"
CETE1FNM  DIM       8  * Filename
CETE1AFL  FORM      1  * End Accept Mode
CETE1END  FORM      1  * End Display
CETE1SNO  FORM      5  * Number of Items on the Screen
CETE1NXT  DIM         12
CETE1FL1  IFILE     SQL, FIXED=54,  KEY="D1-5"
CETE1FL2  IFILE     SQL, FIXED=54, KEY="U6-12"
CETE1CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA36"
PRGNAM    INIT      "Theatre Patient Service Mapping         "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      GETCON00
          CALL      SC00L000
          CLOSE     CETB1FL2
          CLOSE     CETB1FL1,DELETE
.
          CLOSE     CETA1FL2
          CLOSE     CETA1FL1,DELETE
.
          CLOSE     CETD1FL2
          CLOSE     CETD1FL1,DELETE
.
          CLOSE     CETC1FL2
          CLOSE     CETC1FL1,DELETE
.
          CLOSE     CETF1FL2
          CLOSE     CETF1FL1,DELETE
.
          CLOSE     CETG1FL2
          CLOSE     CETG1FL1,DELETE
.
          CLOSE     CETE1FL2
          CLOSE     CETE1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening ceatamaf";
          OPEN      CEATAMA1,"ceatamaf"
          DISPLAY   *P56:24,"Opening ceatbmaf";
          OPEN      CEATBMA1,"ceatbmaf"
          DISPLAY   *P56:24,"Opening ceatcmaf";
          OPEN      CEATCMA1,"ceatcmaf"
          DISPLAY   *P56:24,"Opening ceatdmaf";
          OPEN      CEATDMA1,"ceatdmaf"
          DISPLAY   *P56:24,"Opening ceatemaf";
          OPEN      CEATEMA1,"ceatemaf"
          DISPLAY   *P56:24,"Opening ceatfmaf";
          OPEN      CEATFMA1,"ceatfmaf"
          DISPLAY   *P56:24,"Opening ceatgmaf";
          OPEN      CEATGMA1,"ceatgmaf"
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CETB1SNO
          MOVE     "01    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETB1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CETA1SNO
          MOVE     "02    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETA1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CETD1SNO
          MOVE     "03    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETD1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CETC1SNO
          MOVE     "04    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETC1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CETF1SNO
          MOVE     "05    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETF1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CETG1SNO
          MOVE     "06    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETG1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CETE1SNO
          MOVE     "07    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CETE1SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Selections                         
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * MBS Item Mapping                   
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Theatre Band Mapping               
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Doctor Type Operation Times        
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Theatre Nursing Time Mapping       
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Theatre Clinic/Surgeon Op Times    
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Map Clinic/Surgeon Code            
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Map Implant Code                   
          ENDIF
          RETURN
.--------------------------------
. Screen - Selections                         
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Selections                         
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Selections                         
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Selections                         
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Selections                         
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Selections                         
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Selections                         
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Selections                         
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L006,SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC07L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - MBS Item Mapping                   
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : MBS Item Mapping                   
.-------------------------------------------------------
CF01L000
          MOVE      SP70,ITEMNO  
          MOVE      SP70,CETBSPC 
          MOVE      SP70,CETBPSC 
          MOVE      ZERO,CETBPQTY
          MOVE      ZERO,CETBSQTY
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for MBS Item Mapping                   
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KPITMA00
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      ITEMNO,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY01L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETBSPC
          BRANCH    EXIT,KY01L110,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CETBSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : MBS Item Mapping                   
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : MBS Item Mapping                   
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :     7 Patient Service Code               
.---------------------------------------------------------
          PACK      CETB1FNM,ANST,CETB1NAM,PORT
          REP       " 0",CETB1FNM
          MOVE      ZERO,CETB1AFL
          CLOSE     CETB1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETB1FL1,CETB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETB1FNM,SP1,CETB1LEN,SP1,CETB1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETB1FL1,CETB1FNM
          OPEN      CETB1FL2,CETB1FNM
          PACK      KEY19,ITEMNO,CESPSPC,SP70
          MOVE      KEY19,SAVKEY80
          SETLPTR   SAVKEY80,12
          CALL      RDCETB1 
          IF        OVRCD=0
            CALL      RPCETB1 
          ENDIF
LM01L100
          CALL      RKCETB1 
          BRANCH    OVRCD,LM01L105
          PACK      KEY19,CETBMBS,CETBSPC,CETBPSC
          MATCH     SAVKEY80,KEY19   
          GOTO      LM01L105 IF NOT EQUAL
          RESET     KEY19,13
          MOVE      KEY19,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETB12
          IF        OVRCD=0
            CALL      TUCETB12
          ELSE
            CALL      TWCETB12
          ENDIF
          GOTO     LM01L100
LM01L105
          MOVE     SP70,KEY7   
          CALL     TSCETB12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : MBS Item Mapping                   
.---------------------------------------------------------
SM01L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM01L010 IF EQUAL
SM01L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L101,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L007
          MATCH     PRGID,SCPSPID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L006 IF NOT EQUAL
          GOTO      SM01L005
SM01L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM01L010
          BRANCH    STDGSFLG,SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L900
          MATCH     PRGID,SCPSPID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L102:
                            SM01L103,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
          GOTO      SM01L010
.
SM01L101
          MOVE     ZERO,CETB1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM01L990,SM01L990
          PACK     KEY19,CETBMBS,CETBSPC,CETBPSC                                                   
          RESET    KEY19,13
          MOVE     KEY19,KEY7
          CALL      TACETB12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM01L101
          ENDIF
          MOVE      CETBPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   10",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM01L010
.
SM01L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CETBPQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CETBPQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM01L102
            ENDIF
          ENDIF
          MOVE      CETBPQTY,VAR     
          CALL      DISPITEM
          GOTO     SM01L010
.
SM01L103
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CETBSQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CETBSQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM01L103
            ENDIF
          ENDIF
          MOVE      CETBSQTY,VAR     
          CALL      DISPITEM
          GOTO     SM01L010
SM01L900
          MATCH    "CETB1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY19,CETBMBS,CETBSPC,CETBPSC
            RESET    KEY19,13
            MOVE     KEY19,KEY7
            CALL      TACETB12
            IF        OVRCD=0
              CALL      TUCETB12
            ELSE
              CALL      TWCETB12
            ENDIF
            GOTO      SM01L999
          ENDIF
          GOTO      SM01L999
SM01L990
          MATCH    "CETB1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETB1AFL
          ENDIF
SM01L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,CETB1CNT
          MOVE     ZERO,CETB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L101,DP01L102:
                            DP01L103,DP01L104,DP01L010,DP01L105:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        CETB1END=0
            CALL      TKCETB12
            IF        OVRCD=1
              MOVE      ONE,CETB1END
            ELSE
              MOVE      ZERO,CETB1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETB12
              MOVE      CETBPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        CETB1END=0
            MOVE      CETBPQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        CETB1END=0
            MOVE      CETBSQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        CETB1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        CETB1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "CETB1",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          CALL     CT01L000
          MATCH    "CETB1",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETB12 * Start
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          CALL     CT01L000
          MATCH    "CETB1",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETB12
          IF       OVRCD=1
            CALL     TPCETB12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETB1SNO
            CALL     TPCETB12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
PP01L100
          MATCH    "CETB1",NAMSSFFI
          GOTO     PP01L115 IF NOT EQUAL
PP01L105
          MOVE     SP70,CETB1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETB11
          CALL     TKCETB11 * First on Page
          MOVE     KEY7,CETB1NXT
          CALL     TSCETB12
          CALL     TPCETB12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
PP01L110
          MOVE     CETB1NXT,KEY7   
          CALL     TSCETB12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETB1SNO
            CALL     TPCETB12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "CETB1",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          MOVE     SP70,CETB1NXT
          PACK     KEY5,Z70
          CALL     TSCETB11
          CALL     TPCETB11
          MOVE     KEY7,CETB1NXT
          CALL     TSCETB12
          CALL     TKCETB12
          IF       OVRCD=1
            BEEP
            GOTO      NP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
NP01L110
          MOVE     CETB1NXT,KEY7   
          CALL     TSCETB12
          CALL     DP01L000
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
          MATCH    "CETB1",NAMSSFFI
          GOTO     CT01L115 IF NOT EQUAL
CT01L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETB11
          CALL     TKCETB11
          BRANCH   OVRCD,CT01L110
          CALL     TRCETB12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETB12
          GOTO     CT01L105
CT01L110
          GOTO     CT01L999
CT01L115
CT01L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP01L000
          CALL     CT01L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP01L999
          MATCH    PRGID,SCPSPID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L100,CP01L100:
                            CP01L100,CP01L100,CP01L010,CP01L100:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010
.
CP01L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP01L010
CP01L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD01L000
          CALL      CP01L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD01L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD01L000
          MATCH     PRGID,SCPSPID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD01L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM01L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETB1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETB1AFL
            GOTO      AD01L010 IF EQUAL
            CALL      FP01L000
            GOTO      AD01L999
          ENDIF
AD01L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL01L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL01L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL01L900,DL01L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL01L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETB1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETB11
            IF        OVRCD=0
              CALL      TDCETB12
            ELSE
              BEEP
              GOTO      DL01L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETB11
            CALL      TKCETB11
            MOVE     KEY7,CETB1NXT
            CALL      CT01L000
            MOVE      CETB1NXT,KEY7   
            CALL      TSCETB12
            CALL      TPCETB12
            CALL      DP01L000
            GOTO      DL01L005
          ENDIF
DL01L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL01L005
DL01L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : MBS Item Mapping                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service Code               
.---------------------------------------------------------
TSCETB11  RESET     KEY5
          READ      CETB1FL1,KEY5;;
          RETURN
.
TSCETB12  RESET     KEY7   
          READ      CETB1FL2,KEY7;;
          RETURN
.
TACETB12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETB1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETB11  RESET     KEY5
          DELETE    CETB1FL1,KEY5
          RETURN
.
TDCETB12  RESET     KEY7
          DELETE    CETB1FL2,KEY7
          RETURN
.
TKCETB11  MOVE      ZERO,OVRCD
          READKS    CETB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETB12  MOVE      ZERO,OVRCD
          READKS    CETB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETB11  MOVE      ZERO,OVRCD
          READKP    CETB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETB12  MOVE      ZERO,OVRCD
          READKP    CETB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETB11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETB1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETB12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETB1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETB11  UPDATE    CETB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          RETURN
.
TUCETB12
          UPDATE    CETB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          RETURN
.
TWCETB12  RESET     KEY7   
          WRITE     CETB1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETBMBS,CETBSPC,CETBPSC,CETBPQTY,CETBSQTY:
                        CETBSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : MBS Item Mapping                   
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : MBS Item Mapping                   
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L101,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L102,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      IDESC,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : MBS Item Mapping                   
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L006:
                            SF01L006,SF01L006,SF01L103,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L103,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          CALL      SAVE0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          MOVE      "CETB1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETB11
            BRANCH    OVRCD,SF01L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF01L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF01L001 IF NOT EQUAL
            CALL      SM01L000 * Change Line
          ELSE
            IF        CETB1AFL=0
              MOVE      "CETB1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD01L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L104
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL01L000
          GOTO     SF01L001
.
SF01L108
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L109
          MOVE      "CETB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
.
SF01L110
          CALL      COPY0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      REMV0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Theatre Band Mapping               
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Theatre Band Mapping               
.-------------------------------------------------------
CF02L000
          MOVE      SP70,ACODE   
          MOVE      SP70,CETASPC 
          MOVE      SP70,TDESC   
          MOVE      SP70,CETAPSC 
          MOVE      SP70,CEPSDES 
          MOVE      ZERO,CETAPQTY
          MOVE      ZERO,CETASQTY
          MOVE      SP70,CESPDES 
          MOVE      SP70,CEPSQDES
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Theatre Band Mapping               
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EKEY0000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY02L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETASPC
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CETASPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Theatre Band Mapping               
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Theatre Band Mapping               
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     7 Patient Service                    
.---------------------------------------------------------
          PACK      CETA1FNM,ANST,CETA1NAM,PORT
          REP       " 0",CETA1FNM
          MOVE      ZERO,CETA1AFL
          CLOSE     CETA1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETA1FL1,CETA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETA1FNM,SP1,CETA1LEN,SP1,CETA1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETA1FL1,CETA1FNM
          OPEN      CETA1FL2,CETA1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCETA1 
          IF        OVRCD=0
            CALL      RPCETA1 
          ENDIF
LM02L100
          CALL      RKCETA1 
          BRANCH    OVRCD,LM02L105
          PACK      KEY13,CETABAND,CETASPC,CETAPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM02L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETA12
          IF        OVRCD=0
            CALL      TUCETA12
          ELSE
            CALL      TWCETA12
          ENDIF
          GOTO     LM02L100
LM02L105
          MOVE     SP70,KEY7   
          CALL     TSCETA12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Theatre Band Mapping               
.---------------------------------------------------------
SM02L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM02L010 IF EQUAL
SM02L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L101,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010
SM02L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM02L007
          MATCH     PRGID,SCPSPID
          GOTO      SM02L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM02L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM02L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM02L006 IF NOT EQUAL
          GOTO      SM02L005
SM02L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM02L010
          BRANCH    STDGSFLG,SM02L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM02L900
          MATCH     PRGID,SCPSPID
          GOTO      SM02L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM02L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM02L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM02L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L102,SM02L103,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010
          GOTO      SM02L010
.
SM02L101
          MOVE     ZERO,CETA1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM02L990,SM02L990
          PACK     KEY13,CETABAND,CETASPC,CETAPSC                                                  
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACETA12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM02L101
          ENDIF
          MOVE      CETAPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "    8",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM02L010
.
SM02L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CETAPQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CETAPQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM02L102
            ENDIF
          ENDIF
          MOVE      CETAPQTY,VAR     
          CALL      DISPITEM
          GOTO     SM02L010
.
SM02L103
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CETASQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CETASQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM02L103
            ENDIF
          ENDIF
          MOVE      CETASQTY,VAR     
          CALL      DISPITEM
          GOTO     SM02L010
SM02L900
          MATCH    "CETA1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CETABAND,CETASPC,CETAPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACETA12
            IF        OVRCD=0
              CALL      TUCETA12
            ELSE
              CALL      TWCETA12
            ENDIF
            GOTO      SM02L999
          ENDIF
          GOTO      SM02L999
SM02L990
          MATCH    "CETA1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETA1AFL
          ENDIF
SM02L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,CETA1CNT
          MOVE     ZERO,CETA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L010,DP02L105:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          IF        CETA1END=0
            CALL      TKCETA12
            IF        OVRCD=1
              MOVE      ONE,CETA1END
            ELSE
              MOVE      ZERO,CETA1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETA12
              MOVE      CETAPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        CETA1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        CETA1END=0
            MOVE      CETAPQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        CETA1END=0
            MOVE      CETASQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        CETA1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "CETA1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          CALL     CT02L000
          MATCH    "CETA1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETA12 * Start
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          CALL     CT02L000
          MATCH    "CETA1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETA12
          IF       OVRCD=1
            CALL     TPCETA12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETA1SNO
            CALL     TPCETA12
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
PP02L100
          MATCH    "CETA1",NAMSSFFI
          GOTO     PP02L115 IF NOT EQUAL
PP02L105
          MOVE     SP70,CETA1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETA11
          CALL     TKCETA11 * First on Page
          MOVE     KEY7,CETA1NXT
          CALL     TSCETA12
          CALL     TPCETA12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP02L999
          ENDIF
.
          CALL     CT02L000
.
. Position and Display Page
.--------------------------
PP02L110
          MOVE     CETA1NXT,KEY7   
          CALL     TSCETA12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETA1SNO
            CALL     TPCETA12
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "CETA1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          MOVE     SP70,CETA1NXT
          PACK     KEY5,Z70
          CALL     TSCETA11
          CALL     TPCETA11
          MOVE     KEY7,CETA1NXT
          CALL     TSCETA12
          CALL     TKCETA12
          IF       OVRCD=1
            BEEP
            GOTO      NP02L999
          ENDIF
.
          CALL     CT02L000
.
. Position and Display Page
.--------------------------
NP02L110
          MOVE     CETA1NXT,KEY7   
          CALL     TSCETA12
          CALL     DP02L000
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
          MATCH    "CETA1",NAMSSFFI
          GOTO     CT02L115 IF NOT EQUAL
CT02L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETA11
          CALL     TKCETA11
          BRANCH   OVRCD,CT02L110
          CALL     TRCETA12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETA12
          GOTO     CT02L105
CT02L110
          GOTO     CT02L999
CT02L115
CT02L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP02L000
          CALL     CT02L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP02L999
          MATCH    PRGID,SCPSPID
          GOTO     CP02L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP02L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP02L010,CP02L010,CP02L010,CP02L010:
                            CP02L010,CP02L010,CP02L100,CP02L100:
                            CP02L100,CP02L100,CP02L010,CP02L100:
                            CP02L010,CP02L010,CP02L010,CP02L010:
                           CP02L010,CP02L010,CP02L010,CP02L010:
                           CP02L010,CP02L010,CP02L010,CP02L010:
                            CP02L010,CP02L010,CP02L010,CP02L010
.
CP02L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP02L010
CP02L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD02L000
          CALL      CP02L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD02L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD02L000
          MATCH     PRGID,SCPSPID
          GOTO      AD02L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD02L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD02L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM02L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETA1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETA1AFL
            GOTO      AD02L010 IF EQUAL
            CALL      FP02L000
            GOTO      AD02L999
          ENDIF
AD02L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL02L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL02L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL02L900,DL02L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL02L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETA1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETA11
            IF        OVRCD=0
              CALL      TDCETA12
            ELSE
              BEEP
              GOTO      DL02L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETA11
            CALL      TKCETA11
            MOVE     KEY7,CETA1NXT
            CALL      CT02L000
            MOVE      CETA1NXT,KEY7   
            CALL      TSCETA12
            CALL      TPCETA12
            CALL      DP02L000
            GOTO      DL02L005
          ENDIF
DL02L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL02L005
DL02L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Theatre Band Mapping               
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service                    
.---------------------------------------------------------
TSCETA11  RESET     KEY5
          READ      CETA1FL1,KEY5;;
          RETURN
.
TSCETA12  RESET     KEY7   
          READ      CETA1FL2,KEY7;;
          RETURN
.
TACETA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETA1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETA11  RESET     KEY5
          DELETE    CETA1FL1,KEY5
          RETURN
.
TDCETA12  RESET     KEY7
          DELETE    CETA1FL2,KEY7
          RETURN
.
TKCETA11  MOVE      ZERO,OVRCD
          READKS    CETA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETA12  MOVE      ZERO,OVRCD
          READKS    CETA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETA11  MOVE      ZERO,OVRCD
          READKP    CETA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETA12  MOVE      ZERO,OVRCD
          READKP    CETA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETA11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETA1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETA11  UPDATE    CETA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          RETURN
.
TUCETA12
          UPDATE    CETA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          RETURN
.
TWCETA12  RESET     KEY7   
          WRITE     CETA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETABAND,CETASPC,CETAPSC,CETAPQTY,CETASQTY:
                        CETASPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Theatre Band Mapping               
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Theatre Band Mapping               
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L101,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L102,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Theatre Band Mapping               
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L006:
                            SF02L006,SF02L006,SF02L103,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L104,SF02L105,SF02L106,SF02L107:
                            SF02L108,SF02L109,SF02L110,SF02L111
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L103,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          MOVE      "CETA1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETA11
            BRANCH    OVRCD,SF02L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF02L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF02L001 IF NOT EQUAL
            CALL      SM02L000 * Change Line
          ELSE
            IF        CETA1AFL=0
              MOVE      "CETA1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD02L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF02L001
.
SF02L104
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD02L000
          GOTO     SF02L001
.
SF02L107
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL02L000
          GOTO     SF02L001
.
SF02L108
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L109
          MOVE      "CETA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L110
          CALL      COPY0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Doctor Type Operation Times        
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Doctor Type Operation Times        
.-------------------------------------------------------
CF03L000
          MOVE      SP70,ACODE   
          MOVE      SP70,CETDSPC 
          MOVE      SP70,TDESC   
          MOVE      SP70,CETDPSC 
          MOVE      SP70,CEPSDES 
          MOVE      ZERO,CETDSTM 
          MOVE      ZERO,CETDETM 
          MOVE      SP70,CESPDES 
          MOVE      SP70,CEPSQDES
          MOVE      SP70,STRTDESC
          MOVE      SP70,ENDTDESC
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Doctor Type Operation Times        
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDTY0000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY03L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETDSPC
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CETDSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Doctor Type Operation Times        
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Doctor Type Operation Times        
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     7 Patient Service                    
.---------------------------------------------------------
          PACK      CETD1FNM,ANST,CETD1NAM,PORT
          REP       " 0",CETD1FNM
          MOVE      ZERO,CETD1AFL
          CLOSE     CETD1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETD1FL1,CETD1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETD1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETD1FNM,SP1,CETD1LEN,SP1,CETD1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETD1FL1,CETD1FNM
          OPEN      CETD1FL2,CETD1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCETD1 
          IF        OVRCD=0
            CALL      RPCETD1 
          ENDIF
LM03L100
          CALL      RKCETD1 
          BRANCH    OVRCD,LM03L105
          PACK      KEY13,CETDDTY,CETDSPC,CETDPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM03L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETD12
          IF        OVRCD=0
            CALL      TUCETD12
          ELSE
            CALL      TWCETD12
          ENDIF
          GOTO     LM03L100
LM03L105
          MOVE     SP70,KEY7   
          CALL     TSCETD12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Doctor Type Operation Times        
.---------------------------------------------------------
SM03L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM03L010 IF EQUAL
SM03L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L101,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010
SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L007
          MATCH     PRGID,SCPSPID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L006 IF NOT EQUAL
          GOTO      SM03L005
SM03L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM03L010
          BRANCH    STDGSFLG,SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L900
          MATCH     PRGID,SCPSPID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L102,SM03L103,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010
          GOTO      SM03L010
.
SM03L101
          MOVE     ZERO,CETD1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM03L990,SM03L990
          PACK     KEY13,CETDDTY,CETDSPC,CETDPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACETD12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM03L101
          ENDIF
          MOVE      CETDPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "    8",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM03L010
.
SM03L102
          MOVE      "0",CKEYTYP
          CALL      ESTRT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM03L102
            ENDIF
            BRANCH    EXIT,SM03L102,SM03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM03L990 IF EQUAL
          ENDIF
          MOVE      CETDSTM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      STRTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM03L010
.
SM03L103
          MOVE      "0",CKEYTYP
          CALL      EENDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM03L103
            ENDIF
            BRANCH    EXIT,SM03L103,SM03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM03L990 IF EQUAL
          ENDIF
          MOVE      CETDETM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      ENDTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM03L010
SM03L900
          MATCH    "CETD1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CETDDTY,CETDSPC,CETDPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACETD12
            IF        OVRCD=0
              CALL      TUCETD12
            ELSE
              CALL      TWCETD12
            ENDIF
            GOTO      SM03L999
          ENDIF
          GOTO      SM03L999
SM03L990
          MATCH    "CETD1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETD1AFL
          ENDIF
SM03L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,CETD1CNT
          MOVE     ZERO,CETD1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L101,DP03L102:
                            DP03L103,DP03L104,DP03L010,DP03L105:
                            DP03L106,DP03L107,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          IF        CETD1END=0
            CALL      TKCETD12
            IF        OVRCD=1
              MOVE      ONE,CETD1END
            ELSE
              MOVE      ZERO,CETD1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETD12
              MOVE      CETDPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETD1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        CETD1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        CETD1END=0
            MOVE      CETDSTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        CETD1END=0
            MOVE      CETDETM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        CETD1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L106
          IF        CETD1END=0
            MOVE      STRTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L107
          IF        CETD1END=0
            MOVE      ENDTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "CETD1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          CALL     CT03L000
          MATCH    "CETD1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETD12 * Start
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          CALL     CT03L000
          MATCH    "CETD1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETD12
          IF       OVRCD=1
            CALL     TPCETD12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETD1SNO
            CALL     TPCETD12
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
PP03L100
          MATCH    "CETD1",NAMSSFFI
          GOTO     PP03L115 IF NOT EQUAL
PP03L105
          MOVE     SP70,CETD1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETD11
          CALL     TKCETD11 * First on Page
          MOVE     KEY7,CETD1NXT
          CALL     TSCETD12
          CALL     TPCETD12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
PP03L110
          MOVE     CETD1NXT,KEY7   
          CALL     TSCETD12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETD1SNO
            CALL     TPCETD12
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "CETD1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          MOVE     SP70,CETD1NXT
          PACK     KEY5,Z70
          CALL     TSCETD11
          CALL     TPCETD11
          MOVE     KEY7,CETD1NXT
          CALL     TSCETD12
          CALL     TKCETD12
          IF       OVRCD=1
            BEEP
            GOTO      NP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
NP03L110
          MOVE     CETD1NXT,KEY7   
          CALL     TSCETD12
          CALL     DP03L000
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
          MATCH    "CETD1",NAMSSFFI
          GOTO     CT03L115 IF NOT EQUAL
CT03L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETD11
          CALL     TKCETD11
          BRANCH   OVRCD,CT03L110
          CALL     TRCETD12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETD12
          GOTO     CT03L105
CT03L110
          GOTO     CT03L999
CT03L115
CT03L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP03L000
          CALL     CT03L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP03L999
          MATCH    PRGID,SCPSPID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L100,CP03L100:
                            CP03L100,CP03L100,CP03L010,CP03L100:
                            CP03L100,CP03L100,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010
.
CP03L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP03L010
CP03L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD03L000
          CALL      CP03L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD03L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD03L000
          MATCH     PRGID,SCPSPID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD03L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM03L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETD1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETD1AFL
            GOTO      AD03L010 IF EQUAL
            CALL      FP03L000
            GOTO      AD03L999
          ENDIF
AD03L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL03L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL03L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL03L900,DL03L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL03L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETD1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETD11
            IF        OVRCD=0
              CALL      TDCETD12
            ELSE
              BEEP
              GOTO      DL03L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETD11
            CALL      TKCETD11
            MOVE     KEY7,CETD1NXT
            CALL      CT03L000
            MOVE      CETD1NXT,KEY7   
            CALL      TSCETD12
            CALL      TPCETD12
            CALL      DP03L000
            GOTO      DL03L005
          ENDIF
DL03L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL03L005
DL03L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Doctor Type Operation Times        
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service                    
.---------------------------------------------------------
TSCETD11  RESET     KEY5
          READ      CETD1FL1,KEY5;;
          RETURN
.
TSCETD12  RESET     KEY7   
          READ      CETD1FL2,KEY7;;
          RETURN
.
TACETD12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETD1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETD11  RESET     KEY5
          DELETE    CETD1FL1,KEY5
          RETURN
.
TDCETD12  RESET     KEY7
          DELETE    CETD1FL2,KEY7
          RETURN
.
TKCETD11  MOVE      ZERO,OVRCD
          READKS    CETD1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETD12  MOVE      ZERO,OVRCD
          READKS    CETD1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETD11  MOVE      ZERO,OVRCD
          READKP    CETD1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETD12  MOVE      ZERO,OVRCD
          READKP    CETD1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETD11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETD1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETD12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETD1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETD11  UPDATE    CETD1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          RETURN
.
TUCETD12
          UPDATE    CETD1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          RETURN
.
TWCETD12  RESET     KEY7   
          WRITE     CETD1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETDDTY,CETDSPC,CETDPSC,CETDSTM,CETDETM:
                        CETDSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Doctor Type Operation Times        
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Doctor Type Operation Times        
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L101,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L102,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Doctor Type Operation Times        
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L006:
                            SF03L006,SF03L006,SF03L103,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L104,SF03L105,SF03L106,SF03L107:
                            SF03L108,SF03L109,SF03L110
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L103,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          CALL      POOP0000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L103
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          MOVE      "CETD1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETD11
            BRANCH    OVRCD,SF03L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF03L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF03L001 IF NOT EQUAL
            CALL      SM03L000 * Change Line
          ELSE
            IF        CETD1AFL=0
              MOVE      "CETD1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD03L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L104
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD03L000
          GOTO     SF03L001
.
SF03L107
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL03L000
          GOTO     SF03L001
.
SF03L108
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L109
          MOVE      "CETD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
.
SF03L110
          CALL      DEOP0000
          MOVE      ONE,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Theatre Nursing Time Mapping       
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Theatre Nursing Time Mapping       
.-------------------------------------------------------
CF04L000
          MOVE      SP70,ACODE   
          MOVE      SP70,CETCSPC 
          MOVE      SP70,CETCPSC 
          MOVE      ZERO,CETCSTM 
          MOVE      ZERO,CETCETM 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Theatre Nursing Time Mapping       
.--------------------------------------------------------
KY04L000
.
KY04L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ENUR0000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY04L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETCSPC
          BRANCH    EXIT,KY04L110,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      CETCSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Theatre Nursing Time Mapping       
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Theatre Nursing Time Mapping       
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     7 Patient Service Code               
.---------------------------------------------------------
          PACK      CETC1FNM,ANST,CETC1NAM,PORT
          REP       " 0",CETC1FNM
          MOVE      ZERO,CETC1AFL
          CLOSE     CETC1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETC1FL1,CETC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETC1FNM,SP1,CETC1LEN,SP1,CETC1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETC1FL1,CETC1FNM
          OPEN      CETC1FL2,CETC1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCETC1 
          IF        OVRCD=0
            CALL      RPCETC1 
          ENDIF
LM04L100
          CALL      RKCETC1 
          BRANCH    OVRCD,LM04L105
          PACK      KEY13,CETCNT,CETCSPC,CETCPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM04L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETC12
          IF        OVRCD=0
            CALL      TUCETC12
          ELSE
            CALL      TWCETC12
          ENDIF
          GOTO     LM04L100
LM04L105
          MOVE     SP70,KEY7   
          CALL     TSCETC12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Theatre Nursing Time Mapping       
.---------------------------------------------------------
SM04L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM04L010 IF EQUAL
SM04L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L101,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010
SM04L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM04L007
          MATCH     PRGID,SCPSPID
          GOTO      SM04L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM04L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM04L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM04L006 IF NOT EQUAL
          GOTO      SM04L005
SM04L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM04L010
          BRANCH    STDGSFLG,SM04L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM04L900
          MATCH     PRGID,SCPSPID
          GOTO      SM04L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM04L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM04L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM04L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L102,SM04L103,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010
          GOTO      SM04L010
.
SM04L101
          MOVE     ZERO,CETC1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM04L990,SM04L990
          PACK     KEY13,CETCNT,CETCSPC,CETCPSC                                                    
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACETC12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM04L101
          ENDIF
          MOVE      CETCPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "    8",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM04L010
.
SM04L102
          MOVE      "0",CKEYTYP
          CALL      ESTRT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM04L102
            ENDIF
            BRANCH    EXIT,SM04L102,SM04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM04L990 IF EQUAL
          ENDIF
          MOVE      CETCSTM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      STRTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM04L010
.
SM04L103
          MOVE      "0",CKEYTYP
          CALL      EENDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM04L103
            ENDIF
            BRANCH    EXIT,SM04L103,SM04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM04L990 IF EQUAL
          ENDIF
          MOVE      CETCETM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      ENDTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM04L010
SM04L900
          MATCH    "CETC1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CETCNT,CETCSPC,CETCPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACETC12
            IF        OVRCD=0
              CALL      TUCETC12
            ELSE
              CALL      TWCETC12
            ENDIF
            GOTO      SM04L999
          ENDIF
          GOTO      SM04L999
SM04L990
          MATCH    "CETC1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETC1AFL
          ENDIF
SM04L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,CETC1CNT
          MOVE     ZERO,CETC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L101,DP04L102:
                            DP04L103,DP04L104,DP04L010,DP04L105:
                            DP04L106,DP04L107,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          IF        CETC1END=0
            CALL      TKCETC12
            IF        OVRCD=1
              MOVE      ONE,CETC1END
            ELSE
              MOVE      ZERO,CETC1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETC12
              MOVE      CETCPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        CETC1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        CETC1END=0
            MOVE      CETCSTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        CETC1END=0
            MOVE      CETCETM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        CETC1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        CETC1END=0
            MOVE      STRTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        CETC1END=0
            MOVE      ENDTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "CETC1",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          CALL     CT04L000
          MATCH    "CETC1",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETC12 * Start
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          CALL     CT04L000
          MATCH    "CETC1",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETC12
          IF       OVRCD=1
            CALL     TPCETC12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETC1SNO
            CALL     TPCETC12
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
PP04L100
          MATCH    "CETC1",NAMSSFFI
          GOTO     PP04L115 IF NOT EQUAL
PP04L105
          MOVE     SP70,CETC1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETC11
          CALL     TKCETC11 * First on Page
          MOVE     KEY7,CETC1NXT
          CALL     TSCETC12
          CALL     TPCETC12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP04L999
          ENDIF
.
          CALL     CT04L000
.
. Position and Display Page
.--------------------------
PP04L110
          MOVE     CETC1NXT,KEY7   
          CALL     TSCETC12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETC1SNO
            CALL     TPCETC12
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "CETC1",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          MOVE     SP70,CETC1NXT
          PACK     KEY5,Z70
          CALL     TSCETC11
          CALL     TPCETC11
          MOVE     KEY7,CETC1NXT
          CALL     TSCETC12
          CALL     TKCETC12
          IF       OVRCD=1
            BEEP
            GOTO      NP04L999
          ENDIF
.
          CALL     CT04L000
.
. Position and Display Page
.--------------------------
NP04L110
          MOVE     CETC1NXT,KEY7   
          CALL     TSCETC12
          CALL     DP04L000
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
          MATCH    "CETC1",NAMSSFFI
          GOTO     CT04L115 IF NOT EQUAL
CT04L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETC11
          CALL     TKCETC11
          BRANCH   OVRCD,CT04L110
          CALL     TRCETC12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETC12
          GOTO     CT04L105
CT04L110
          GOTO     CT04L999
CT04L115
CT04L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP04L000
          CALL     CT04L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP04L999
          MATCH    PRGID,SCPSPID
          GOTO     CP04L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP04L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010,CP04L010,CP04L100,CP04L100:
                            CP04L100,CP04L100,CP04L010,CP04L100:
                            CP04L100,CP04L100,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010,CP04L010,CP04L010
.
CP04L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP04L010
CP04L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD04L000
          CALL      CP04L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD04L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD04L000
          MATCH     PRGID,SCPSPID
          GOTO      AD04L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD04L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD04L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM04L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETC1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETC1AFL
            GOTO      AD04L010 IF EQUAL
            CALL      FP04L000
            GOTO      AD04L999
          ENDIF
AD04L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL04L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL04L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL04L900,DL04L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL04L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETC1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETC11
            IF        OVRCD=0
              CALL      TDCETC12
            ELSE
              BEEP
              GOTO      DL04L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETC11
            CALL      TKCETC11
            MOVE     KEY7,CETC1NXT
            CALL      CT04L000
            MOVE      CETC1NXT,KEY7   
            CALL      TSCETC12
            CALL      TPCETC12
            CALL      DP04L000
            GOTO      DL04L005
          ENDIF
DL04L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL04L005
DL04L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Theatre Nursing Time Mapping       
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service Code               
.---------------------------------------------------------
TSCETC11  RESET     KEY5
          READ      CETC1FL1,KEY5;;
          RETURN
.
TSCETC12  RESET     KEY7   
          READ      CETC1FL2,KEY7;;
          RETURN
.
TACETC12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETC1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETC11  RESET     KEY5
          DELETE    CETC1FL1,KEY5
          RETURN
.
TDCETC12  RESET     KEY7
          DELETE    CETC1FL2,KEY7
          RETURN
.
TKCETC11  MOVE      ZERO,OVRCD
          READKS    CETC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETC12  MOVE      ZERO,OVRCD
          READKS    CETC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETC11  MOVE      ZERO,OVRCD
          READKP    CETC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETC12  MOVE      ZERO,OVRCD
          READKP    CETC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETC11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETC1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETC12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETC1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETC11  UPDATE    CETC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          RETURN
.
TUCETC12
          UPDATE    CETC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          RETURN
.
TWCETC12  RESET     KEY7   
          WRITE     CETC1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETCNT,CETCSPC,CETCPSC,CETCSTM,CETCETM:
                        CETCSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Theatre Nursing Time Mapping       
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Theatre Nursing Time Mapping       
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L101,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L102,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Theatre Nursing Time Mapping       
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L006:
                            SF04L006,SF04L006,SF04L103,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L104,SF04L105,SF04L106,SF04L107:
                            SF04L108,SF04L109,SF04L110
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L103,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          CALL      PONT0000
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L102
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L103
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          MOVE      "CETC1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETC11
            BRANCH    OVRCD,SF04L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF04L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF04L001 IF NOT EQUAL
            CALL      SM04L000 * Change Line
          ELSE
            IF        CETC1AFL=0
              MOVE      "CETC1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD04L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L104
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD04L000
          GOTO     SF04L001
.
SF04L107
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL04L000
          GOTO     SF04L001
.
SF04L108
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L109
          MOVE      "CETC1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
.
SF04L110
          CALL      DENT0000
          MOVE      ONE,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Theatre Clinic/Surgeon Op Times    
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Theatre Clinic/Surgeon Op Times    
.-------------------------------------------------------
CF05L000
          MOVE      SP70,OPCLCLIN
          MOVE      SP70,CETFSPC 
          MOVE      SP70,CETFPSC 
          MOVE      ZERO,CETFSTM 
          MOVE      ZERO,CETFETM 
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Theatre Clinic/Surgeon Op Times    
.--------------------------------------------------------
KY05L000
.
KY05L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,OPCLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCLSU000
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      OPCLCLIN,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      OPCLDESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY05L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETFSPC
          BRANCH    EXIT,KY05L110,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      CETFSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
LM05L000
.---------------------------------------------------------
. Load for :     7 Patient Service Code               
.---------------------------------------------------------
          PACK      CETF1FNM,ANST,CETF1NAM,PORT
          REP       " 0",CETF1FNM
          MOVE      ZERO,CETF1AFL
          CLOSE     CETF1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETF1FL1,CETF1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETF1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETF1FNM,SP1,CETF1LEN,SP1,CETF1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETF1FL1,CETF1FNM
          OPEN      CETF1FL2,CETF1FNM
          PACK      KEY16,OPCLCLIN,CESPSPC,SP70
          MOVE      KEY16,SAVKEY80
          SETLPTR   SAVKEY80,9 
          CALL      RDCETF1 
          IF        OVRCD=0
            CALL      RPCETF1 
          ENDIF
LM05L100
          CALL      RKCETF1 
          BRANCH    OVRCD,LM05L105
          PACK      KEY16,CETFCLI,CETFSPC,CETFPSC
          MATCH     SAVKEY80,KEY16   
          GOTO      LM05L105 IF NOT EQUAL
          RESET     KEY16,10
          MOVE      KEY16,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETF12
          IF        OVRCD=0
            CALL      TUCETF12
          ELSE
            CALL      TWCETF12
          ENDIF
          GOTO     LM05L100
LM05L105
          MOVE     SP70,KEY7   
          CALL     TSCETF12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
SM05L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM05L010 IF EQUAL
SM05L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L101,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010
SM05L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM05L007
          MATCH     PRGID,SCPSPID
          GOTO      SM05L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM05L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM05L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM05L006 IF NOT EQUAL
          GOTO      SM05L005
SM05L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM05L010
          BRANCH    STDGSFLG,SM05L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM05L900
          MATCH     PRGID,SCPSPID
          GOTO      SM05L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM05L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM05L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM05L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L102,SM05L103,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010
          GOTO      SM05L010
.
SM05L101
          MOVE     ZERO,CETF1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM05L990,SM05L990
          PACK     KEY16,CETFCLI,CETFSPC,CETFPSC                                                   
          RESET    KEY16,10
          MOVE     KEY16,KEY7
          CALL      TACETF12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM05L101
          ENDIF
          MOVE      CETFPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "    8",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM05L010
.
SM05L102
          MOVE      "0",CKEYTYP
          CALL      ESTRT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM05L102
            ENDIF
            BRANCH    EXIT,SM05L102,SM05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM05L990 IF EQUAL
          ENDIF
          MOVE      CETFSTM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      STRTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM05L010
.
SM05L103
          MOVE      "0",CKEYTYP
          CALL      EENDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM05L103
            ENDIF
            BRANCH    EXIT,SM05L103,SM05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM05L990 IF EQUAL
          ENDIF
          MOVE      CETFETM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      ENDTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM05L010
SM05L900
          MATCH    "CETF1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY16,CETFCLI,CETFSPC,CETFPSC
            RESET    KEY16,10
            MOVE     KEY16,KEY7
            CALL      TACETF12
            IF        OVRCD=0
              CALL      TUCETF12
            ELSE
              CALL      TWCETF12
            ENDIF
            GOTO      SM05L999
          ENDIF
          GOTO      SM05L999
SM05L990
          MATCH    "CETF1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETF1AFL
          ENDIF
SM05L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP05L000
          MOVE     ZERO,CETF1CNT
          MOVE     ZERO,CETF1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP05L600
          MATCH    PRGID,SCPSPID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP05L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L101,DP05L102:
                            DP05L103,DP05L104,DP05L010,DP05L105:
                            DP05L106,DP05L107,DP05L010,DP05L010:
                           DP05L010,DP05L010,DP05L010,DP05L010:
                           DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010
          GOTO      DP05L010
.
DP05L101
          IF        CETF1END=0
            CALL      TKCETF12
            IF        OVRCD=1
              MOVE      ONE,CETF1END
            ELSE
              MOVE      ZERO,CETF1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETF12
              MOVE      CETFPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETF1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L102
          IF        CETF1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L103
          IF        CETF1END=0
            MOVE      CETFSTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L104
          IF        CETF1END=0
            MOVE      CETFETM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L105
          IF        CETF1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L106
          IF        CETF1END=0
            MOVE      STRTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L107
          IF        CETF1END=0
            MOVE      ENDTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
DP05L600
          MATCH    "CETF1",NAMSSFFI
          GOTO     DP05L605 IF NOT EQUAL
          GOTO     DP05L999
DP05L605
DP05L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP05L000
.
          CALL     CT05L000
          MATCH    "CETF1",NAMSSFFI
          GOTO     FP05L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETF12 * Start
          CALL     DP05L000
          GOTO     FP05L999
FP05L105
FP05L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP05L000
.
          CALL     CT05L000
          MATCH    "CETF1",NAMSSFFI
          GOTO     LP05L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETF12
          IF       OVRCD=1
            CALL     TPCETF12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETF1SNO
            CALL     TPCETF12
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     LP05L999
LP05L105
LP05L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP05L000
.
PP05L100
          MATCH    "CETF1",NAMSSFFI
          GOTO     PP05L115 IF NOT EQUAL
PP05L105
          MOVE     SP70,CETF1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETF11
          CALL     TKCETF11 * First on Page
          MOVE     KEY7,CETF1NXT
          CALL     TSCETF12
          CALL     TPCETF12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP05L999
          ENDIF
.
          CALL     CT05L000
.
. Position and Display Page
.--------------------------
PP05L110
          MOVE     CETF1NXT,KEY7   
          CALL     TSCETF12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETF1SNO
            CALL     TPCETF12
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     PP05L999
PP05L115
PP05L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP05L000
          MATCH    "CETF1",NAMSSFFI
          GOTO     NP05L115 IF NOT EQUAL
NP05L105
          MOVE     SP70,CETF1NXT
          PACK     KEY5,Z70
          CALL     TSCETF11
          CALL     TPCETF11
          MOVE     KEY7,CETF1NXT
          CALL     TSCETF12
          CALL     TKCETF12
          IF       OVRCD=1
            BEEP
            GOTO      NP05L999
          ENDIF
.
          CALL     CT05L000
.
. Position and Display Page
.--------------------------
NP05L110
          MOVE     CETF1NXT,KEY7   
          CALL     TSCETF12
          CALL     DP05L000
          GOTO     NP05L999
NP05L115
NP05L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT05L000
          MATCH    "CETF1",NAMSSFFI
          GOTO     CT05L115 IF NOT EQUAL
CT05L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETF11
          CALL     TKCETF11
          BRANCH   OVRCD,CT05L110
          CALL     TRCETF12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETF12
          GOTO     CT05L105
CT05L110
          GOTO     CT05L999
CT05L115
CT05L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP05L000
          CALL     CT05L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP05L999
          MATCH    PRGID,SCPSPID
          GOTO     CP05L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP05L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP05L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP05L010,CP05L010,CP05L010,CP05L010:
                            CP05L010,CP05L010,CP05L100,CP05L100:
                            CP05L100,CP05L100,CP05L010,CP05L100:
                            CP05L100,CP05L100,CP05L010,CP05L010:
                           CP05L010,CP05L010,CP05L010,CP05L010:
                           CP05L010,CP05L010,CP05L010,CP05L010:
                            CP05L010,CP05L010,CP05L010
.
CP05L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP05L010
CP05L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD05L000
          CALL      CP05L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD05L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD05L000
          MATCH     PRGID,SCPSPID
          GOTO      AD05L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD05L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD05L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM05L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETF1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETF1AFL
            GOTO      AD05L010 IF EQUAL
            CALL      FP05L000
            GOTO      AD05L999
          ENDIF
AD05L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL05L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL05L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL05L900,DL05L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL05L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETF1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETF11
            IF        OVRCD=0
              CALL      TDCETF12
            ELSE
              BEEP
              GOTO      DL05L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETF11
            CALL      TKCETF11
            MOVE     KEY7,CETF1NXT
            CALL      CT05L000
            MOVE      CETF1NXT,KEY7   
            CALL      TSCETF12
            CALL      TPCETF12
            CALL      DP05L000
            GOTO      DL05L005
          ENDIF
DL05L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL05L005
DL05L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service Code               
.---------------------------------------------------------
TSCETF11  RESET     KEY5
          READ      CETF1FL1,KEY5;;
          RETURN
.
TSCETF12  RESET     KEY7   
          READ      CETF1FL2,KEY7;;
          RETURN
.
TACETF12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETF1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETF11  RESET     KEY5
          DELETE    CETF1FL1,KEY5
          RETURN
.
TDCETF12  RESET     KEY7
          DELETE    CETF1FL2,KEY7
          RETURN
.
TKCETF11  MOVE      ZERO,OVRCD
          READKS    CETF1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETF12  MOVE      ZERO,OVRCD
          READKS    CETF1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETF11  MOVE      ZERO,OVRCD
          READKP    CETF1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETF12  MOVE      ZERO,OVRCD
          READKP    CETF1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETF11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETF1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETF12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETF1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETF11  UPDATE    CETF1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          RETURN
.
TUCETF12
          UPDATE    CETF1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          RETURN
.
TWCETF12  RESET     KEY7   
          WRITE     CETF1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETFCLI,CETFSPC,CETFPSC,CETFSTM,CETFETM:
                        CETFSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP05L000
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L101,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L102,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999
          GOTO     PS05L999
.
PS05L101
          MOVE      OPCLDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Theatre Clinic/Surgeon Op Times    
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L006:
                            SF05L006,SF05L006,SF05L103,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L104,SF05L105,SF05L106,SF05L107:
                            SF05L108,SF05L109,SF05L110
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L103,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L101
          CALL      PCTM0000
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L102
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L103
          CALL      SELECTED
          BRANCH    EXIT,SF05L001
          MOVE      "CETF1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETF11
            BRANCH    OVRCD,SF05L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF05L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF05L001 IF NOT EQUAL
            CALL      SM05L000 * Change Line
          ELSE
            IF        CETF1AFL=0
              MOVE      "CETF1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD05L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF05L001
.
SF05L104
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP05L000
          GOTO     SF05L001
.
SF05L105
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP05L000
          GOTO     SF05L001
.
SF05L106
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD05L000
          GOTO     SF05L001
.
SF05L107
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL05L000
          GOTO     SF05L001
.
SF05L108
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L109
          MOVE      "CETF1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP05L000
          GOTO     SF05L001
.
SF05L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DCLI0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF05L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF05L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF05L999
          ENDIF
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF05L000
          ENDIF
          GOTO      SF05L001
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Map Clinic/Surgeon Code            
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Map Clinic/Surgeon Code            
.-------------------------------------------------------
CF06L000
          MOVE      SP70,OPCLCLIN
          MOVE      SP70,CETGSPC 
          MOVE      SP70,OPCLDESC
          MOVE      SP70,CETGPSC 
          MOVE      ZERO,CETGQTY 
          MOVE      SP70,CEPSDES 
          MOVE      SP70,CESPDES 
          MOVE      SP70,CEPSQDES
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Map Clinic/Surgeon Code            
.--------------------------------------------------------
KY06L000
.
KY06L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,OPCLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCLSU000
          BRANCH    EXIT,KY06L900,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      OPCLCLIN,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      OPCLDESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY06L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETGSPC
          BRANCH    EXIT,KY06L110,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      CETGSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Map Clinic/Surgeon Code            
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Map Clinic/Surgeon Code            
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :     7 Patient Service                    
.---------------------------------------------------------
          PACK      CETG1FNM,ANST,CETG1NAM,PORT
          REP       " 0",CETG1FNM
          MOVE      ZERO,CETG1AFL
          CLOSE     CETG1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETG1FL1,CETG1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETG1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETG1FNM,SP1,CETG1LEN,SP1,CETG1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETG1FL1,CETG1FNM
          OPEN      CETG1FL2,CETG1FNM
          PACK      KEY16,OPCLCLIN,CESPSPC,SP70
          MOVE      KEY16,SAVKEY80
          SETLPTR   SAVKEY80,9 
          CALL      RDCETG1 
          IF        OVRCD=0
            CALL      RPCETG1 
          ENDIF
LM06L100
          CALL      RKCETG1 
          BRANCH    OVRCD,LM06L105
          PACK      KEY16,CETGCLI,CETGSPC,CETGPSC
          MATCH     SAVKEY80,KEY16   
          GOTO      LM06L105 IF NOT EQUAL
          RESET     KEY16,10
          MOVE      KEY16,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETG12
          IF        OVRCD=0
            CALL      TUCETG12
          ELSE
            CALL      TWCETG12
          ENDIF
          GOTO     LM06L100
LM06L105
          MOVE     SP70,KEY7   
          CALL     TSCETG12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Map Clinic/Surgeon Code            
.---------------------------------------------------------
SM06L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM06L010 IF EQUAL
SM06L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L101,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010
SM06L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM06L007
          MATCH     PRGID,SCPSPID
          GOTO      SM06L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM06L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM06L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM06L006 IF NOT EQUAL
          GOTO      SM06L005
SM06L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM06L010
          BRANCH    STDGSFLG,SM06L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM06L900
          MATCH     PRGID,SCPSPID
          GOTO      SM06L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM06L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM06L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM06L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L102:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010
          GOTO      SM06L010
.
SM06L101
          MOVE     ZERO,CETG1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM06L990,SM06L990
          PACK     KEY16,CETGCLI,CETGSPC,CETGPSC                                                   
          RESET    KEY16,10
          MOVE     KEY16,KEY7
          CALL      TACETG12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM06L101
          ENDIF
          MOVE      CETGPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   10",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM06L010
.
SM06L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CETGQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CETGQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM06L102
            ENDIF
          ENDIF
          MOVE      CETGQTY,VAR      
          CALL      DISPITEM
          GOTO     SM06L010
SM06L900
          MATCH    "CETG1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY16,CETGCLI,CETGSPC,CETGPSC
            RESET    KEY16,10
            MOVE     KEY16,KEY7
            CALL      TACETG12
            IF        OVRCD=0
              CALL      TUCETG12
            ELSE
              CALL      TWCETG12
            ENDIF
            GOTO      SM06L999
          ENDIF
          GOTO      SM06L999
SM06L990
          MATCH    "CETG1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETG1AFL
          ENDIF
SM06L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,CETG1CNT
          MOVE     ZERO,CETG1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L101,DP06L102:
                            DP06L010,DP06L103,DP06L010,DP06L104:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010
          GOTO      DP06L010
.
DP06L101
          IF        CETG1END=0
            CALL      TKCETG12
            IF        OVRCD=1
              MOVE      ONE,CETG1END
            ELSE
              MOVE      ZERO,CETG1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETG12
              MOVE      CETGPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETG1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        CETG1END=0
            MOVE      CETGQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        CETG1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        CETG1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "CETG1",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          CALL     CT06L000
          MATCH    "CETG1",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETG12 * Start
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          CALL     CT06L000
          MATCH    "CETG1",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETG12
          IF       OVRCD=1
            CALL     TPCETG12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETG1SNO
            CALL     TPCETG12
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
PP06L100
          MATCH    "CETG1",NAMSSFFI
          GOTO     PP06L115 IF NOT EQUAL
PP06L105
          MOVE     SP70,CETG1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETG11
          CALL     TKCETG11 * First on Page
          MOVE     KEY7,CETG1NXT
          CALL     TSCETG12
          CALL     TPCETG12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP06L999
          ENDIF
.
          CALL     CT06L000
.
. Position and Display Page
.--------------------------
PP06L110
          MOVE     CETG1NXT,KEY7   
          CALL     TSCETG12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETG1SNO
            CALL     TPCETG12
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "CETG1",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          MOVE     SP70,CETG1NXT
          PACK     KEY5,Z70
          CALL     TSCETG11
          CALL     TPCETG11
          MOVE     KEY7,CETG1NXT
          CALL     TSCETG12
          CALL     TKCETG12
          IF       OVRCD=1
            BEEP
            GOTO      NP06L999
          ENDIF
.
          CALL     CT06L000
.
. Position and Display Page
.--------------------------
NP06L110
          MOVE     CETG1NXT,KEY7   
          CALL     TSCETG12
          CALL     DP06L000
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
          MATCH    "CETG1",NAMSSFFI
          GOTO     CT06L115 IF NOT EQUAL
CT06L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETG11
          CALL     TKCETG11
          BRANCH   OVRCD,CT06L110
          CALL     TRCETG12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETG12
          GOTO     CT06L105
CT06L110
          GOTO     CT06L999
CT06L115
CT06L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP06L000
          CALL     CT06L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP06L999
          MATCH    PRGID,SCPSPID
          GOTO     CP06L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP06L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP06L010,CP06L010,CP06L010,CP06L010:
                            CP06L010,CP06L010,CP06L100,CP06L100:
                            CP06L010,CP06L100,CP06L010,CP06L100:
                            CP06L010,CP06L010,CP06L010,CP06L010:
                           CP06L010,CP06L010,CP06L010,CP06L010:
                           CP06L010,CP06L010,CP06L010,CP06L010:
                            CP06L010,CP06L010,CP06L010
.
CP06L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP06L010
CP06L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD06L000
          CALL      CP06L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD06L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD06L000
          MATCH     PRGID,SCPSPID
          GOTO      AD06L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD06L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD06L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM06L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETG1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETG1AFL
            GOTO      AD06L010 IF EQUAL
            CALL      FP06L000
            GOTO      AD06L999
          ENDIF
AD06L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL06L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL06L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL06L900,DL06L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL06L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETG1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETG11
            IF        OVRCD=0
              CALL      TDCETG12
            ELSE
              BEEP
              GOTO      DL06L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETG11
            CALL      TKCETG11
            MOVE     KEY7,CETG1NXT
            CALL      CT06L000
            MOVE      CETG1NXT,KEY7   
            CALL      TSCETG12
            CALL      TPCETG12
            CALL      DP06L000
            GOTO      DL06L005
          ENDIF
DL06L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL06L005
DL06L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Map Clinic/Surgeon Code            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service                    
.---------------------------------------------------------
TSCETG11  RESET     KEY5
          READ      CETG1FL1,KEY5;;
          RETURN
.
TSCETG12  RESET     KEY7   
          READ      CETG1FL2,KEY7;;
          RETURN
.
TACETG12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETG1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETG11  RESET     KEY5
          DELETE    CETG1FL1,KEY5
          RETURN
.
TDCETG12  RESET     KEY7
          DELETE    CETG1FL2,KEY7
          RETURN
.
TKCETG11  MOVE      ZERO,OVRCD
          READKS    CETG1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETG12  MOVE      ZERO,OVRCD
          READKS    CETG1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETG11  MOVE      ZERO,OVRCD
          READKP    CETG1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETG12  MOVE      ZERO,OVRCD
          READKP    CETG1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETG11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETG1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETG12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETG1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETG11  UPDATE    CETG1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          RETURN
.
TUCETG12
          UPDATE    CETG1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          RETURN
.
TWCETG12  RESET     KEY7   
          WRITE     CETG1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETGCLI,CETGSPC,CETGPSC,CETGQTY,CETGSPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Map Clinic/Surgeon Code            
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Map Clinic/Surgeon Code            
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L101,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L102,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999
          GOTO     PS06L999
.
PS06L101
          MOVE      OPCLDESC,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Map Clinic/Surgeon Code            
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L006:
                            SF06L006,SF06L006,SF06L103,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L104,SF06L105,SF06L106,SF06L107:
                            SF06L108,SF06L109,SF06L110
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L103,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          CALL      PCQT0000
          MOVE      ONE,EXIT
          GOTO      SF06L999
.
SF06L102
          MOVE      ONE,EXIT
          GOTO      SF06L999
.
SF06L103
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          MOVE      "CETG1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETG11
            BRANCH    OVRCD,SF06L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF06L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF06L001 IF NOT EQUAL
            CALL      SM06L000 * Change Line
          ELSE
            IF        CETG1AFL=0
              MOVE      "CETG1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD06L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF06L001
.
SF06L104
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L106
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD06L000
          GOTO     SF06L001
.
SF06L107
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL06L000
          GOTO     SF06L001
.
SF06L108
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L109
          MOVE      "CETG1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
.
SF06L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DCQT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF06L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF06L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF06L999
          ENDIF
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF06L000
          ENDIF
          GOTO      SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.--------------------------------
. Screen - Map Implant Code                   
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Map Implant Code                   
.-------------------------------------------------------
CF07L000
          MOVE      SP70,OPEXCODE
          MOVE      SP70,CETESPC 
          MOVE      SP70,CETEPSC 
          MOVE      ZERO,CETEQTY 
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Map Implant Code                   
.--------------------------------------------------------
KY07L000
.
KY07L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,OPEXDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KIMPL000
          BRANCH    EXIT,KY07L900,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      OPEXCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      OPEXDESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY07L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CETESPC
          BRANCH    EXIT,KY07L110,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      CETESPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Map Implant Code                   
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Map Implant Code                   
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :     7 Patient Service Code               
.---------------------------------------------------------
          PACK      CETE1FNM,ANST,CETE1NAM,PORT
          REP       " 0",CETE1FNM
          MOVE      ZERO,CETE1AFL
          CLOSE     CETE1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CETE1FL1,CETE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CETE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CETE1FNM,SP1,CETE1LEN,SP1,CETE1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CETE1FL1,CETE1FNM
          OPEN      CETE1FL2,CETE1FNM
          PACK      KEY16,OPEXCODE,CESPSPC,SP70
          MOVE      KEY16,SAVKEY80
          SETLPTR   SAVKEY80,9 
          CALL      RDCETE1 
          IF        OVRCD=0
            CALL      RPCETE1 
          ENDIF
LM07L100
          CALL      RKCETE1 
          BRANCH    OVRCD,LM07L105
          PACK      KEY16,CETEIMP,CETESPC,CETEPSC
          MATCH     SAVKEY80,KEY16   
          GOTO      LM07L105 IF NOT EQUAL
          RESET     KEY16,10
          MOVE      KEY16,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACETE12
          IF        OVRCD=0
            CALL      TUCETE12
          ELSE
            CALL      TWCETE12
          ENDIF
          GOTO     LM07L100
LM07L105
          MOVE     SP70,KEY7   
          CALL     TSCETE12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Map Implant Code                   
.---------------------------------------------------------
SM07L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM07L010 IF EQUAL
SM07L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L101,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010
SM07L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM07L007
          MATCH     PRGID,SCPSPID
          GOTO      SM07L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM07L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM07L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM07L006 IF NOT EQUAL
          GOTO      SM07L005
SM07L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM07L010
          BRANCH    STDGSFLG,SM07L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM07L900
          MATCH     PRGID,SCPSPID
          GOTO      SM07L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM07L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM07L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM07L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L102:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010
          GOTO      SM07L010
.
SM07L101
          MOVE     ZERO,CETE1AFL
          CALL      EPAC0000
          BRANCH    EXIT,SM07L990,SM07L990
          PACK     KEY16,CETEIMP,CETESPC,CETEPSC                                                   
          RESET    KEY16,10
          MOVE     KEY16,KEY7
          CALL      TACETE12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM07L101
          ENDIF
          MOVE      CETEPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   10",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM07L010
.
SM07L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CETEQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CETEQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM07L102
            ENDIF
          ENDIF
          MOVE      CETEQTY,VAR      
          CALL      DISPITEM
          GOTO     SM07L010
SM07L900
          MATCH    "CETE1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY16,CETEIMP,CETESPC,CETEPSC
            RESET    KEY16,10
            MOVE     KEY16,KEY7
            CALL      TACETE12
            IF        OVRCD=0
              CALL      TUCETE12
            ELSE
              CALL      TWCETE12
            ENDIF
            GOTO      SM07L999
          ENDIF
          GOTO      SM07L999
SM07L990
          MATCH    "CETE1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CETE1AFL
          ENDIF
SM07L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,CETE1CNT
          MOVE     ZERO,CETE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L101,DP07L102:
                            DP07L010,DP07L103,DP07L010,DP07L104:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010
          GOTO      DP07L010
.
DP07L101
          IF        CETE1END=0
            CALL      TKCETE12
            IF        OVRCD=1
              MOVE      ONE,CETE1END
            ELSE
              MOVE      ZERO,CETE1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCETE12
              MOVE      CETEPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CETE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        CETE1END=0
            MOVE      CETEQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        CETE1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        CETE1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "CETE1",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          CALL     CT07L000
          MATCH    "CETE1",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCETE12 * Start
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          CALL     CT07L000
          MATCH    "CETE1",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCETE12
          IF       OVRCD=1
            CALL     TPCETE12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CETE1SNO
            CALL     TPCETE12
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
PP07L100
          MATCH    "CETE1",NAMSSFFI
          GOTO     PP07L115 IF NOT EQUAL
PP07L105
          MOVE     SP70,CETE1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETE11
          CALL     TKCETE11 * First on Page
          MOVE     KEY7,CETE1NXT
          CALL     TSCETE12
          CALL     TPCETE12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP07L999
          ENDIF
.
          CALL     CT07L000
.
. Position and Display Page
.--------------------------
PP07L110
          MOVE     CETE1NXT,KEY7   
          CALL     TSCETE12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CETE1SNO
            CALL     TPCETE12
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "CETE1",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          MOVE     SP70,CETE1NXT
          PACK     KEY5,Z70
          CALL     TSCETE11
          CALL     TPCETE11
          MOVE     KEY7,CETE1NXT
          CALL     TSCETE12
          CALL     TKCETE12
          IF       OVRCD=1
            BEEP
            GOTO      NP07L999
          ENDIF
.
          CALL     CT07L000
.
. Position and Display Page
.--------------------------
NP07L110
          MOVE     CETE1NXT,KEY7   
          CALL     TSCETE12
          CALL     DP07L000
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
          MATCH    "CETE1",NAMSSFFI
          GOTO     CT07L115 IF NOT EQUAL
CT07L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCETE11
          CALL     TKCETE11
          BRANCH   OVRCD,CT07L110
          CALL     TRCETE12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCETE12
          GOTO     CT07L105
CT07L110
          GOTO     CT07L999
CT07L115
CT07L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP07L000
          CALL     CT07L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP07L999
          MATCH    PRGID,SCPSPID
          GOTO     CP07L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP07L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP07L010,CP07L010,CP07L010,CP07L010:
                            CP07L010,CP07L010,CP07L100,CP07L100:
                            CP07L010,CP07L100,CP07L010,CP07L100:
                            CP07L010,CP07L010,CP07L010,CP07L010:
                           CP07L010,CP07L010,CP07L010,CP07L010:
                           CP07L010,CP07L010,CP07L010,CP07L010:
                            CP07L010,CP07L010,CP07L010
.
CP07L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP07L010
CP07L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD07L000
          CALL      CP07L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD07L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD07L000
          MATCH     PRGID,SCPSPID
          GOTO      AD07L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD07L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD07L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM07L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CETE1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CETE1AFL
            GOTO      AD07L010 IF EQUAL
            CALL      FP07L000
            GOTO      AD07L999
          ENDIF
AD07L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL07L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL07L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL07L900,DL07L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL07L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CETE1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCETE11
            IF        OVRCD=0
              CALL      TDCETE12
            ELSE
              BEEP
              GOTO      DL07L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCETE11
            CALL      TKCETE11
            MOVE     KEY7,CETE1NXT
            CALL      CT07L000
            MOVE      CETE1NXT,KEY7   
            CALL      TSCETE12
            CALL      TPCETE12
            CALL      DP07L000
            GOTO      DL07L005
          ENDIF
DL07L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL07L005
DL07L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Map Implant Code                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service Code               
.---------------------------------------------------------
TSCETE11  RESET     KEY5
          READ      CETE1FL1,KEY5;;
          RETURN
.
TSCETE12  RESET     KEY7   
          READ      CETE1FL2,KEY7;;
          RETURN
.
TACETE12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETE1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCETE11  RESET     KEY5
          DELETE    CETE1FL1,KEY5
          RETURN
.
TDCETE12  RESET     KEY7
          DELETE    CETE1FL2,KEY7
          RETURN
.
TKCETE11  MOVE      ZERO,OVRCD
          READKS    CETE1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCETE12  MOVE      ZERO,OVRCD
          READKS    CETE1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETE11  MOVE      ZERO,OVRCD
          READKP    CETE1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCETE12  MOVE      ZERO,OVRCD
          READKP    CETE1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETE11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CETE1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCETE12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CETE1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCETE11  UPDATE    CETE1FL1;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          RETURN
.
TUCETE12
          UPDATE    CETE1FL2;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          RETURN
.
TWCETE12  RESET     KEY7   
          WRITE     CETE1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CETEIMP,CETESPC,CETEPSC,CETEQTY,CETESPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Map Implant Code                   
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Map Implant Code                   
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L101,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L102,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999
          GOTO     PS07L999
.
PS07L101
          MOVE      OPEXDESC,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Map Implant Code                   
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L101,SF07L102,SF07L006:
                            SF07L006,SF07L006,SF07L103,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L006:
                           SF07L104,SF07L105,SF07L106,SF07L107:
                            SF07L108,SF07L109,SF07L110
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L103,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          CALL      PIMP0000
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L102
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L103
          CALL      SELECTED
          BRANCH    EXIT,SF07L001
          MOVE      "CETE1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCETE11
            BRANCH    OVRCD,SF07L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF07L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF07L001 IF NOT EQUAL
            CALL      SM07L000 * Change Line
          ELSE
            IF        CETE1AFL=0
              MOVE      "CETE1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD07L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF07L001
.
SF07L104
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L105
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L106
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD07L000
          GOTO     SF07L001
.
SF07L107
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL07L000
          GOTO     SF07L001
.
SF07L108
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L109
          MOVE      "CETE1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
.
SF07L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DIMP0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF07L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF07L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF07L999
          ENDIF
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF07L000
          ENDIF
          GOTO      SF07L001
SF07L990  MOVE      FOUR,EXIT * Exit Char Exit
SF07L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Get Control File Details
.------------------------------------------------------------
GETCON00  MOVE      "68",AUDTSECT
          READ      CONTROLF,AUDTSECT;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4
          MOVE      "40",AUDTSECT
          READ      CONTROLF,AUDTSECT;*111,OPCNCLSU
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"                                * V90200
          TRAPCLR   IO
          MOVE      OVRCD,PATDOCOP
.
GETCON20  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OPRCLIA1,"oprcliaf"
          TRAPCLR   IO
          MOVE      OVRCD,OPRCLIOP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OPREXPA1,"oprexpaf"
          TRAPCLR   IO
          MOVE      OVRCD,OPREXPOP
.
          RETURN
.------------------------------------------------------------
. Save Theatre Band Mapping
.------------------------------------------------------------
RPSC0000  MOVE      SCRID,F2
          BRANCH    F2,RPSC1100,RPSC1200,RPSC1300,RPSC1400,RPSC1500,RPSC1600:
                                RPSC1700
.
RPSC1100  PACK      KEY7,CETBPSC
          GOTO      RPSC9000
.
RPSC1200  PACK      KEY7,CETAPSC
          GOTO      RPSC9000
.
RPSC1300  PACK      KEY7,CETDPSC
          LOAD      STRTDESC,CETDSTM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                     OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                     OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                     OPCNDPS4,ACTDUR
          LOAD      ENDTDESC,CETDETM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                     OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                     OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                     OPCNDPS4,ACTDUR
          GOTO      RPSC9000
.
RPSC1400  PACK      KEY7,CETCPSC
          LOAD      STRTDESC,CETCSTM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                     OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                     OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                     OPCNDPS4,ACTDUR
          LOAD      ENDTDESC,CETCETM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                     OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                     OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                     OPCNDPS4,ACTDUR
          GOTO      RPSC9000
.
RPSC1500  PACK      KEY7,CETFPSC
          LOAD      STRTDESC,CETFSTM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                     OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                     OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                     OPCNDPS4,ACTDUR
          LOAD      ENDTDESC,CETFETM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                     OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                     OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                     OPCNDPS4,ACTDUR
          GOTO      RPSC9000
.
RPSC1600  PACK      KEY7,CETGPSC
          GOTO      RPSC9000
.
RPSC1700  PACK      KEY7,CETEPSC
          GOTO      RPSC9000
.
RPSC9000  CALL      RDCEPS1
.
RPSC9999  RETURN
.
.------------------------------------------------------------
. Save Theatre MBS Mapping
.------------------------------------------------------------
SAVE0000  PACK      KEY19,ITEMNO,CESPSPC,SP70                          * V90200
          CALL      RSCETB1
SAVE1000  CALL      RKCETB1                * Delete all Patient Services
          BRANCH    OVRCD,SAVE1900
          MATCH     ITEMNO,CETBMBS                                     * V90200
          GOTO      SAVE1900 IF NOT EQUAL
          MATCH     CESPSPC,CETBSPC
          GOTO      SAVE1900 IF NOT EQUAL
.
          PACK      KEY19,CETBMBS,CETBSPC,CETBPSC,SP70
          CALL      DECETB1
          GOTO      SAVE1000
.
. Insert New Patient Services
.-----------------------------
SAVE1900  MOVE      SP70,KEY5
          CALL      TRCETB11
          COMPARE   ZERO,OVRCD
          GOTO      SAVE2100 IF EQUAL
SAVE2000  CALL      TKCETB11
          BRANCH    OVRCD,SAVE2900
.
SAVE2100  MOVE      ITEMNO,CETBMBS                                     * V90200
          MOVE      CESPSPC,CETBSPC
          PACK      KEY19,CETBMBS,CETBSPC,CETBPSC,SP70
          CALL      RACETB1
          IF        OVRCD=0
            CALL      UPCETB1
          ELSE
            CALL      WRCETB1
          ENDIF
          GOTO      SAVE2000
SAVE2900
SAVE9999  RETURN
EPAC0000  MOVE     ZERO,CKEYTYP
          CALL     KCEPSA00
          BRANCH   EXIT,EPAC9999,EPAC9999
          MOVE     CEPSPSC,CETAPSC
          MOVE     CEPSQTY,CETAPQTY
          MOVE     CEPSQTY,CETASQTY
          MOVE     CEPSPSC,CETBPSC
          MOVE     CEPSQTY,CETBPQTY
          MOVE     CEPSQTY,CETBSQTY
          MOVE     CEPSPSC,CETCPSC
          MOVE     CEPSPSC,CETDPSC
          MOVE     CEPSPSC,CETEPSC
          MOVE     CEPSPSC,CETFPSC
          MOVE     CEPSPSC,CETGPSC
EPAC9999  RETURN
.------------------------------------------------------------
. Copy Patient Service Mappings
.------------------------------------------------------------
COPY0000  MOVE      ITEMNO,SAVEITM                                     * V90200
          MOVE      ACODE,SAVECOD                                      * V90200
          DISPLAY   *P1:12,*EF
          HLINE     *G37,12,1,80
          DISPLAY   *P1:14,*V2LON,*ULON,"Copy Patient Services",*HOFF:
                    *P1:16,*V2LON," 0.",*HOFF," Exit":
                    *P1:17,*V2LON," 1.",*HOFF," From MBS Item ":
                    *P1:18,*V2LON," 2.",*HOFF," From Theatre Banding"
          KEYIN     *P1:20,"Select Option : ",*V2LON,F1
          COMPARE   ZERO,F1
          GOTO      COPY9999 IF EQUAL
          BRANCH    F1,COPY1000,COPY2000
          BEEP
          GOTO      COPY0000
.
. From MBS Item
.
COPY1000  MOVE      ZERO,CKEYTYP
          DISPLAY   *P1:22,"MBS Item     : "
          MOVE      "16",CCOL
          MOVE      "22",CVERT
          CALL      KPITMA00                                           * V90200
          BRANCH    EXIT,COPY9000,COPY9000
          DISPLAY   *P16:22,*V2LON,ITEMNO,*HOFF,SP1,IDESC              * V90200
.
          DISPLAY   *P1:23,"Copy Details for All Service Providers (":
                            *V2LON,"Y",*HOFF,"/":
                            *V2LON,"N",*HOFF,") ? "
          MOVE      "48",CCOL
          MOVE      "23",CVERT
          CALL      YORN0000
          MOVE      FYESNO,COPYALL
.
          DISPLAY   *P1:24,"Post Copy (",*V2LON,"Y",*HOFF,"/":
                                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      COPY9000 IF NOT EQUAL
.
          IF        COPYALL=1
            PACK      KEY19,ITEMNO,SP70                                * V90200
          ELSE
            PACK      KEY19,ITEMNO,CESPSPC,SP70                        * V90200
          ENDIF
          CALL      RSCETB1
COPY1100  CALL      RKCETB1
          BRANCH    OVRCD,COPY9000
          MATCH     ITEMNO,CETBMBS                                     * V90200
          GOTO      COPY9000 IF NOT EQUAL
          BRANCH    COPYALL,COPY1110
          MATCH     CESPSPC,CETBSPC
          GOTO      COPY9000 IF NOT EQUAL
.
COPY1110  MATCH     "01",SCRID
          IF        @EQUAL
            PACK      KEY19,SAVEITM,CETBSPC,CETBPSC
            UNPACK    KEY19,CETBMBS,CETBSPC,CETBPSC
            CALL      RACETB1
            IF        OVRCD=0
              CALL      UPCETB1
            ELSE
              CALL      WRCETB1
            ENDIF
            PACK      KEY19,ITEMNO,CETBSPC,CETBPSC                     * V90200
            CALL      RDCETB1
          ELSE
            MOVE      CETBPQTY,CETAPQTY
            MOVE      CETBSQTY,CETASQTY
            PACK      KEY13,SAVECOD,CETBSPC,CETBPSC
            UNPACK    KEY13,CETABAND,CETASPC,CETAPSC
            CALL      RACETA1
            IF        OVRCD=0
              CALL      UPCETA1
            ELSE
              CALL      WRCETA1
            ENDIF
          ENDIF
          GOTO      COPY1100
.
. From Theatre Band
.
COPY2000  MOVE      ZERO,CKEYTYP
          DISPLAY   *P1:22,"Theatre Band : "
          MOVE      "16",CCOL
          MOVE      "22",CVERT
          MOVE      "TB",TCODE                                         * V90200
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,COPY9000,COPY9000
          DISPLAY   *P16:22,*V2LON,ACODE,*HOFF,SP1,TDESC               * V90200
.
          DISPLAY   *P1:23,"Copy Details for All Service Providers (":
                            *V2LON,"Y",*HOFF,"/":
                            *V2LON,"N",*HOFF,") ? "
          MOVE      "48",CCOL
          MOVE      "23",CVERT
          CALL      YORN0000
          MOVE      FYESNO,COPYALL
.
          DISPLAY   *P1:24,"Post Copy (",*V2LON,"Y",*HOFF,"/":
                                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      COPY9000 IF NOT EQUAL
.
          IF        COPYALL=1
            PACK      KEY13,ACODE,SP70                                 * V90200
          ELSE
            PACK      KEY13,ACODE,CESPSPC,SP70                         * V90200
          ENDIF
          CALL      RSCETA1
COPY2100  CALL      RKCETA1
          BRANCH    OVRCD,COPY9000
          MATCH     ACODE,CETABAND                                     * V90200
          GOTO      COPY9000 IF NOT EQUAL
.
          BRANCH    COPYALL,COPY2110
          MATCH     CESPSPC,CETASPC
          GOTO      COPY9000 IF NOT EQUAL
.
COPY2110  MATCH     "01",SCRID
          IF        @EQUAL
            MOVE      CETAPQTY,CETBPQTY
            MOVE      CETASQTY,CETBSQTY
            PACK      KEY19,SAVEITM,CETASPC,CETAPSC
            UNPACK    KEY19,CETBMBS,CETBSPC,CETBPSC
            CALL      RACETB1
            IF        OVRCD=0
              CALL      UPCETB1
            ELSE
              CALL      WRCETB1
            ENDIF
          ELSE
            PACK      KEY13,SAVECOD,CETASPC,CETAPSC
            UNPACK    KEY13,CETABAND,CETASPC,CETAPSC
            CALL      RACETA1
            IF        OVRCD=0
              CALL      UPCETA1
            ELSE
              CALL      WRCETA1
            ENDIF
            PACK      KEY13,ACODE,CETASPC,CETAPSC                      * V90200
            CALL      RDCETA1
          ENDIF
          GOTO      COPY2100
.
COPY9000  MOVE      SAVEITM,KEY9
          MOVE      SAVEITM,CETBMBS
          MOVE      CESPSPC,CETASPC
          MOVE      CESPSPC,CETBSPC
          CALL      RDCODE1                                            * V90200
          MOVE      SAVECOD,CETABAND
          MOVE      "TB",TCODE                                         * V90200
          PACK      KEY5,TCODE,ACODE,SP70                              * V90200
          CALL      RDCODE1                                            * V90200
.
COPY9999  RETURN
.------------------------------------------------------------
. Delete Theatre Band Mapping
.------------------------------------------------------------
REMV0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,REMV1000,REMV9000,REMV9100
.
REMV1000  PACK      KEY19,ITEMNO,CESPSPC,SP70                          * V90200
          CALL      RSCETB1
REMV1100  CALL      RKCETB1                * Delete all Patient Services
          BRANCH    OVRCD,REMV1900
          MATCH     ITEMNO,CETBMBS                                     * V90200
          GOTO      REMV1900 IF NOT EQUAL
          MATCH     CESPSPC,CETBSPC
          GOTO      REMV1900 IF NOT EQUAL
          PACK      KEY19,CETBMBS,CETBSPC,CETBPSC
          CALL      DECETB1
          GOTO      REMV1100
.
REMV1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     REMV9999
REMV9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     REMV9999
REMV9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     REMV9999
REMV9999  RETURN
.------------------------------------------------------------
. Save Theatre Band Mapping
.------------------------------------------------------------
POST0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCETA1
POST1000  CALL      RKCETA1                * Delete all Patient Services
          BRANCH    OVRCD,POST1900
          MATCH     ACODE,CETABAND                                     * V90200
          GOTO      POST1900 IF NOT EQUAL
          MATCH     CESPSPC,CETASPC
          GOTO      POST1900 IF NOT EQUAL
          PACK      KEY13,CETABAND,CETASPC,CETAPSC
          CALL      DECETA1
          GOTO      POST1000
.
. Insert New Patient Services
.-----------------------------
POST1900  MOVE      SP70,KEY5
          CALL      TRCETA11
          COMPARE   ZERO,OVRCD
          GOTO      POST2100 IF EQUAL
.
POST2000  CALL      TKCETA11
          BRANCH    OVRCD,POST2900
.
POST2100  MOVE      ACODE,CETABAND                                     * V90200
          MOVE      CESPSPC,CETASPC
          PACK      KEY13,CETABAND,CETASPC,CETAPSC
          CALL      RACETA1
          IF        OVRCD=0
            CALL      UPCETA1
          ELSE
            CALL      WRCETA1
          ENDIF
          GOTO      POST2000
POST2900
POST9999  RETURN
.------------------------------------------------------------
. Enter Theatre Band Mapping
.------------------------------------------------------------
EKEY0000  MOVE      "TB",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EKEY9999,EKEY9999
          MOVE      ACODE,CETABAND                                     * V90200
EKEY9999  RETURN
.------------------------------------------------------------
. Delete Theatre Band Mapping
.------------------------------------------------------------
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCETA1
DELT1100  CALL      RKCETA1                * Delete all Patient Services
          BRANCH    OVRCD,DELT1900
          MATCH     ACODE,CETABAND                                     * V9020
          GOTO      DELT1900 IF NOT EQUAL
          MATCH     CESPSPC,CETASPC
          GOTO      DELT1900 IF NOT EQUAL
          PACK      KEY13,CETABAND,CETASPC,CETAPSC
          CALL      DECETA1
          GOTO      DELT1100
.
DELT1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.------------------------------------------------------------
. Save Theatre DTY Mapping
.------------------------------------------------------------
POOP0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCETD1
POOP1000  CALL      RKCETD1                * Delete all Patient Services
          BRANCH    OVRCD,POOP1900
          MATCH     ACODE,CETDDTY                                      * V90200
          GOTO      POOP1900 IF NOT EQUAL
          MATCH     CESPSPC,CETDSPC
          GOTO      POOP1900 IF NOT EQUAL
          PACK      KEY13,CETDDTY,CETDSPC,CETDPSC
          CALL      DECETD1
          GOTO      POOP1000
.
. Insert New Patient Services
.-----------------------------
POOP1900  MOVE      SP70,KEY5
          CALL      TRCETD11
          COMPARE   ZERO,OVRCD
          GOTO      POOP2100 IF EQUAL
.
POOP2000  CALL      TKCETD11
          BRANCH    OVRCD,POOP2900
.
POOP2100  MOVE      ACODE,CETDDTY                                      * V90200
          MOVE      CESPSPC,CETDSPC
          PACK      KEY13,CETDDTY,CETDSPC,CETDPSC
          CALL      RACETD1
          IF        OVRCD=0
            CALL      UPCETD1
          ELSE
            CALL      WRCETD1
          ENDIF
          GOTO      POOP2000
POOP2900
POOP9999  RETURN
.------------------------------------------------------------
. Enter Doctor Type Mapping
.------------------------------------------------------------
EDTY0000  BRANCH    OPRCLIOP,EDTY9000
          MOVE      "OP",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EDTY9999,EDTY9999
          MOVE      ACODE,CETDDTY                                      * V90200
          GOTO      EDTY9999
.
EDTY9000  MOVE      "Theatre System Tables Not Available - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      TWO,EXIT
.
EDTY9999  RETURN
.------------------------------------------------------------
. Enter Start Time
.------------------------------------------------------------
ESTRT000  CALL      KOTIM000
          BRANCH    EXIT,ESTRT999
          MOVE      OPRTIM,CETFSTM
          MOVE      OPRTIM,CETDSTM
          MOVE      OPRTIM,CETCSTM
          MOVE      OPRTIMD,STRTDESC
ESTRT999  RETURN
.
.------------------------------------------------------------
. Enter End Time
.------------------------------------------------------------
EENDT000  CALL      KOTIM000
          BRANCH    EXIT,ESTRT999
          MOVE      OPRTIM,CETFETM
          MOVE      OPRTIM,CETDETM
          MOVE      OPRTIM,CETCETM
          MOVE      OPRTIMD,ENDTDESC
EENDT999  RETURN
.
.------------------------------------------------------------
. Delete Doctor Type Mapping
.------------------------------------------------------------
DEOP0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DEOP1000,DEOP9000,DEOP9100
.
DEOP1000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCETD1
DEOP1100  CALL      RKCETD1                * Delete all Patient Services
          BRANCH    OVRCD,DEOP1900
          MATCH     ACODE,CETDDTY                                      * V90200
          GOTO      DEOP1900 IF NOT EQUAL
          MATCH     CESPSPC,CETDSPC
          GOTO      DEOP1900 IF NOT EQUAL
          PACK      KEY13,CETDDTY,CETDSPC,CETDPSC
          CALL      DECETD1
          GOTO      DEOP1100
.
DEOP1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DEOP9999
DEOP9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DEOP9999
DEOP9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DEOP9999
DEOP9999  RETURN
.------------------------------------------------------------
. Save Theatre Nurse Type Mapping
.------------------------------------------------------------
PONT0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCETC1
PONT1000  CALL      RKCETC1                * Delete all Patient Services
          BRANCH    OVRCD,PONT1900
          MATCH     ACODE,CETCNT                                       * V90200
          GOTO      PONT1900 IF NOT EQUAL
          MATCH     CESPSPC,CETCSPC
          GOTO      PONT1900 IF NOT EQUAL
          PACK      KEY13,CETCNT,CETCSPC,CETCPSC
          CALL      DECETC1
          GOTO      PONT1000
.
. Insert New Patient Services
.-----------------------------
PONT1900  MOVE      SP70,KEY5
          CALL      TRCETC11
          COMPARE   ZERO,OVRCD
          GOTO      PONT2100 IF EQUAL
.
PONT2000  CALL      TKCETC11
          BRANCH    OVRCD,PONT2900
.
PONT2100  MOVE      ACODE,CETCNT                                       * V90200
          MOVE      CESPSPC,CETCSPC
          PACK      KEY13,CETCNT,CETCSPC,CETCPSC
          CALL      RACETC1
          IF        OVRCD=0
            CALL      UPCETC1
          ELSE
            CALL      WRCETC1
          ENDIF
          GOTO      PONT2000
PONT2900
PONT9999  RETURN
.------------------------------------------------------------
. Enter Doctor Type Mapping
.------------------------------------------------------------
ENUR0000  BRANCH    OPRCLIOP,ENUR9000
          MOVE      "ON",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,ENUR9999,ENUR9999
          MOVE      ACODE,CETCNT                                       * V90200
          GOTO      ENUR9999
ENUR9000  MOVE      "Theatre System Tables Not Available - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      TWO,EXIT
ENUR9999  RETURN
.------------------------------------------------------------
. Delete Nurse Type Mapping
.------------------------------------------------------------
DENT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DENT1000,DENT9000,DENT9100
.
DENT1000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCETC1
DENT1100  CALL      RKCETC1                * Delete all Patient Services
          BRANCH    OVRCD,DENT1900
          MATCH     ACODE,CETCNT                                       * V90200
          GOTO      DENT1900 IF NOT EQUAL
          MATCH     CESPSPC,CETCSPC
          GOTO      DENT1900 IF NOT EQUAL
          PACK      KEY13,CETCNT,CETCSPC,CETCPSC
          CALL      DECETC1
          GOTO      DENT1100
.
DENT1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DENT9999
DENT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DENT9999
DENT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DENT9999
DENT9999  RETURN
.------------------------------------------------------------
. Save Theatre Nurse Type Mapping
.------------------------------------------------------------
PCTM0000  PACK      KEY16,OPCLCLIN,CESPSPC,SP70
          CALL      RSCETF1
PCTM1000  CALL      RKCETF1                * Delete all Patient Services
          BRANCH    OVRCD,PCTM1900
          MATCH     OPCLCLIN,CETFCLI
          GOTO      PCTM1900 IF NOT EQUAL
          MATCH     CESPSPC,CETFSPC
          GOTO      PCTM1900 IF NOT EQUAL
          PACK      KEY16,CETFCLI,CETFSPC,CETFPSC
          CALL      DECETF1
          GOTO      PCTM1000
.
. Insert New Patient Services
.-----------------------------
PCTM1900  MOVE      SP70,KEY5
          CALL      TRCETF11
          COMPARE   ZERO,OVRCD
          GOTO      PCTM2100 IF EQUAL
.
PCTM2000  CALL      TKCETF11
          BRANCH    OVRCD,PCTM2900
.
PCTM2100  MOVE      OPCLCLIN,CETFCLI
          MOVE      CESPSPC,CETFSPC
          PACK      KEY16,CETFCLI,CETFSPC,CETFPSC
          CALL      RACETF1
          IF        OVRCD=0
            CALL      UPCETF1
          ELSE
            CALL      WRCETF1
          ENDIF
          GOTO      PCTM2000
PCTM2900
PCTM9999  RETURN
.------------------------------------------------------------
. Enter Clinic or Surgeon
.------------------------------------------------------------
KCLSU000  BRANCH    OPRCLIOP,KCLSU900
          BRANCH    OPCNCLSU,KCLSU100
          MOVE      ZERO,CKEYTYP
          CALL      KOPCLA00              * Enter Clinic
          BRANCH    EXIT,KCLSU999,KCLSU999
          MOVE      OPCLCLIN,CETFCLI
          MOVE      OPCLCLIN,CETGCLI
          GOTO      KCLSU999
.
KCLSU100  BRANCH    PATDOCOP,KCLSU800
.
          MOVE      ZERO,CKEYTYP
          CALL      KPDOCA00              * Enter Doctors Code         * V90200
          BRANCH    EXIT,KCLSU999,KCLSU999
          MOVE      DCODE,OPCLCLIN        * User Later                 * V90200
          STRIP     DTITL                                              * V90200
          MOVE      DGNAME,ANS                                         * V90200
          PACK      OPCLDESC,DTITL,SP1,ANS,SP1,DSNAME,SP70             * V90200
          MOVE      OPCLCLIN,CETFCLI
          MOVE      OPCLCLIN,CETGCLI
          GOTO      KCLSU999
.
KCLSU800  BEEP
          MOVE      "Doctors Table Not Available (patdoctf) - ",DISPMSG
          CALL      MESSAGE1
          MOVE      TWO,EXIT
          GOTO      KCLSU999
KCLSU900  BEEP
          MOVE      "Theatre System Tables Not Available (oprcliaf) - ",DISPMSG
          CALL      MESSAGE1
          MOVE      TWO,EXIT
KCLSU999  RETURN
.
.------------------------------------------------------------
. Delete Clinic/Surgeon Op Time Mapping
.------------------------------------------------------------
DCLI0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DCLI1000,DCLI9000,DCLI9100
.
DCLI1000  PACK      KEY16,OPCLCLIN,CESPSPC,SP70
          CALL      RSCETF1
DCLI1100  CALL      RKCETF1                * Delete all Patient Services
          BRANCH    OVRCD,DCLI1900
          MATCH     OPCLCLIN,CETFCLI
          GOTO      DCLI1900 IF NOT EQUAL
          MATCH     CESPSPC,CETFSPC
          GOTO      DCLI1900 IF NOT EQUAL
          PACK      KEY16,CETFCLI,CETFSPC,CETFPSC
          CALL      DECETF1
          GOTO      DCLI1100
.
DCLI1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DCLI9999
DCLI9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DCLI9999
DCLI9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DCLI9999
DCLI9999  RETURN
.------------------------------------------------------------
. Save Clinic/Surgeon Quantity Type Mapping
.------------------------------------------------------------
PCQT0000  PACK      KEY16,OPCLCLIN,CESPSPC,SP70
          CALL      RSCETG1
PCQT1000  CALL      RKCETG1                * Delete all Patient Services
          BRANCH    OVRCD,PCQT1900
          MATCH     OPCLCLIN,CETGCLI
          GOTO      PCQT1900 IF NOT EQUAL
          MATCH     CESPSPC,CETGSPC
          GOTO      PCQT1900 IF NOT EQUAL
          PACK      KEY16,CETGCLI,CETGSPC,CETGPSC
          CALL      DECETG1
          GOTO      PCQT1000
.
. Insert New Patient Services
.-----------------------------
PCQT1900  MOVE      SP70,KEY5
          CALL      TRCETG11
          COMPARE   ZERO,OVRCD
          GOTO      PCQT2100 IF EQUAL
.
PCQT2000  CALL      TKCETG11
          BRANCH    OVRCD,PCQT2900
.
PCQT2100  MOVE      OPCLCLIN,CETGCLI
          MOVE      CESPSPC,CETGSPC
          PACK      KEY16,CETGCLI,CETGSPC,CETGPSC
          CALL      RACETG1
          IF        OVRCD=0
            CALL      UPCETG1
          ELSE
            CALL      WRCETG1
          ENDIF
          GOTO      PCQT2000
PCQT2900
PCQT9999  RETURN
.------------------------------------------------------------
. Delete Clinic/Surgeon Op Time Mapping
.------------------------------------------------------------
DCQT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DCQT1000,DCQT9000,DCQT9100
.
DCQT1000  PACK      KEY16,OPCLCLIN,CESPSPC,SP70
          CALL      RSCETG1
DCQT1100  CALL      RKCETG1                * Delete all Patient Services
          BRANCH    OVRCD,DCQT1900
          MATCH     OPCLCLIN,CETGCLI
          GOTO      DCQT1900 IF NOT EQUAL
          MATCH     CESPSPC,CETGSPC
          GOTO      DCQT1900 IF NOT EQUAL
          PACK      KEY16,CETGCLI,CETGSPC,CETGPSC
          CALL      DECETG1
          GOTO      DCQT1100
.
DCQT1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DCQT9999
DCQT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DCQT9999
DCQT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DCQT9999
DCQT9999  RETURN
.------------------------------------------------------------
. Save Implant Quantity Mapping
.------------------------------------------------------------
PIMP0000  PACK      KEY16,OPEXCODE,CESPSPC,SP70
          CALL      RSCETE1
PIMP1000  CALL      RKCETE1                * Delete all Patient Services
          BRANCH    OVRCD,PIMP1900
          MATCH     OPEXCODE,CETEIMP
          GOTO      PIMP1900 IF NOT EQUAL
          MATCH     CESPSPC,CETESPC
          GOTO      PIMP1900 IF NOT EQUAL
          PACK      KEY16,CETEIMP,CETESPC,CETEPSC
          CALL      DECETE1
          GOTO      PIMP1000
.
. Insert New Patient Services
.-----------------------------
PIMP1900  MOVE      SP70,KEY5
          CALL      TRCETE11
          COMPARE   ZERO,OVRCD
          GOTO      PIMP2100 IF EQUAL
.
PIMP2000  CALL      TKCETE11
          BRANCH    OVRCD,PIMP2900
.
PIMP2100  MOVE      OPEXCODE,CETEIMP
          MOVE      CESPSPC,CETESPC
          PACK      KEY16,CETEIMP,CETESPC,CETEPSC
          CALL      RACETE1
          IF        OVRCD=0
            CALL      UPCETE1
          ELSE
            CALL      WRCETE1
          ENDIF
          GOTO      PIMP2000
PIMP2900
PIMP9999  RETURN
.------------------------------------------------------------
. Enter Implant Code
.------------------------------------------------------------
KIMPL000  BRANCH    OPREXPOP,KIMPL900
          MOVE      ZERO,CKEYTYP
          CALL      KOPEXA00              * Enter Implant Code
          BRANCH    EXIT,KIMPL999,KIMPL999
          MOVE      OPEXCODE,CETEIMP
          GOTO      KIMPL999
.
KIMPL900  BEEP
          MOVE      "Theatre System Tables Not Available (oprexpaf) - ",DISPMSG
          CALL      MESSAGE1
          MOVE      TWO,EXIT
KIMPL999  RETURN
.
.------------------------------------------------------------
. Delete Clinic/Surgeon Op Time Mapping
.------------------------------------------------------------
DIMP0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DIMP1000,DIMP9000,DIMP9100
.
DIMP1000  PACK      KEY16,OPEXCODE,CESPSPC,SP70
          CALL      RSCETE1
DIMP1100  CALL      RKCETE1                * Delete all Patient Services
          BRANCH    OVRCD,DIMP1900
          MATCH     OPEXCODE,CETEIMP
          GOTO      DIMP1900 IF NOT EQUAL
          MATCH     CESPSPC,CETESPC
          GOTO      DIMP1900 IF NOT EQUAL
          PACK      KEY16,CETEIMP,CETESPC,CETEPSC
          CALL      DECETE1
          GOTO      DIMP1100
.
DIMP1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DIMP9999
DIMP9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DIMP9999
DIMP9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DIMP9999
DIMP9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSOPTKY    
          INC       CEACLIKY    
          INC       CEACODKY    
          INC       CEADOCKY    
          INC       CEAEXPKY    
          INC       CEAITMKY    
          INC       CEAPSCIO/INC
          INC       CEAPSCKY    
          INC       CEASPCIO/INC
          INC       CEASPCKY    
          INC       CEATAMIO/INC
          INC       CEATBMIO/INC
          INC       CEATCMIO/INC
          INC       CEATDMIO/INC
          INC       CEATEMIO/INC
          INC       CEATFMIO/INC
          INC       CEATGMIO/INC
          INC       OPRCLIIO/INC
          INC       OPREXPIO/INC
          INC       PATCODIO/INC
          INC       PATDO1IO/INC
          INC       PATITMIO/INC
.
          INC       STDGENCD
.
