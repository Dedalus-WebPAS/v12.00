.----------------------------------------------------------------------
.    File          : DEBINVCD.PBL
.    
.    Function      : Include to Print Debtors Invoices
.
.    Modifications :                              
.
.-------------------------------------------------------
.V10.03.02  17/04/2013  Don Nguyen   CAR 282342
.           Corrected pos read for PTCNURBP
.V10.03.01  09/04/2013  Don Nguyen   CAR 282342
.           Mods to use UR for BPAYINVN (if PTCNURBP=1)
.-------------------------------------------------------
.V10.00.01  30.03.2010 Davin             219072
.           Added templated field for BPAY No. (bpayrefn)
.-------------------------------------------------------
. V9.09.01  25.10.2007 Sandra Barcham    109997
.           Allow printing of partial quantities for layout 12
.-------------------------------------------------------
. V9.05.01  24.03.2006  Peter Vela        CAR 61299
.           Increased field no size from DIM3 to DIM5  
.-------------------------------------------------------
. V9.04.01  06.10.2004  Sandra Barcham    CAR 54065
.           Fix 132 standard carried forward layout for Holy Spirit
.-------------------------------------------------------
. V9.02.02  20.03.2003  Sandra Barcham 
.           Add changes for f.09 changes not done in v9
. V9.02.01  23.05.2002  Glenn Saunders 
.           Remove access to DEBDSC fields.  Use PATDSC ones instead.
. V9.02.00  09.05.2002  Glenn Saunders 
.           Port to v9.00 environment.                                  
.----------------------------------------------------------------------
.
.    Operation     : The calling program should have already performed a
.                    SELPRINT to select the printer being used. The line up
.                    print routines are as follows and do not require any
.                    parameters - INVLINE - Standard Layout
.                                 ACCLINE - Anne Caudle Centre
.                                 STHLINE - Southland
.                                 MODLINE - Modbury Hospital
.                                 EPWLINE - Epworth Hospital
.                    For the Invoice Print Routines the following files
.                    should have been read 
.                                 DBFH - Debtors Transaction Header
.                                 DBDB - Debtors Masterfile
.                                 DBTE - Debtors Terms. If Not Recorded
.                                        then ensure that DBTEDES is Blank
.                    The following files need to be open
.                                 debdbtaf
.                                 debfthaf
.                                 debfdtaf
.                                 debfnoaf
.                                 debitmaf
.                    The following includes are required
.
.                          DEBINVDF.PBL
.                          DEBCONFD.INC
.                          DEBDBTFD.INC
.                          DEBFTHFD.INC
.                          DEBFDTFD.INC
.                          DEBFNOFD.INC
.
.                          DEBFADCD.PBL
.                          DEBDBTIO.INC
.                          DEBFTHIO.INC
.                          DEBFDTIO.INC
.                          DEBFNOIO.INC
.
.----------------------------------------------------------------------
. Print Invoice
.----------------------------------------------------------------------
PRINV000  READ      CONTROLF,EIGHTY1;*43,CFDBBLIN,CFDBBLST,CFDBETEL:
                                      CFDBECON,*243,CFDBILAY,CFDBSLAY
          MOVE      ONE,TMPLTFLG
          LOAD      MAXCLNO,CFDBILAY,TWENTY8,TWENTY9,THIRTY,ZERO,TWENTY1:
                                     ZERO,ZERO,TWENTY5,TWENTY2,ZERO:
                                     THIRTY3,TWENTY2
          LOAD      MAXLENGT,CFDBILAY,SIXTY6,SEVENTY,SIXTY6,ZERO,SIXTY6:
                                     ZERO,ZERO,SIXTY6,SIXTY6,ZERO:
                                     SIXTY6,SIXTY6
          BRANCH    CFDBILAY,PRINV110,PRINV120,PRINV130,PRINV140,PRINV150:
                             PRINV160,PRINV170,PRINV180,PRINV190,PRINV200:
                             PRINV210,PRINV220
.
PRINV110  CALL      INSTD000     * Standard
          GOTO      PRINV999
.
PRINV120  CALL      INEPW000     * Epworth
          GOTO      PRINV999
.
PRINV130  CALL      INMOD000     * Modbury
          GOTO      PRINV999
.
PRINV140  CALL      INSTH000     * Southland
          GOTO      PRINV999
.
PRINV150  CALL      INWGH000     * West Gippsland
          GOTO      PRINV999
.
PRINV160  CALL      INCHC000     * Coast Health Care
          GOTO      PRINV999
.
PRINV170  CALL      INHWK000     * Hawkes Bay
          GOTO      PRINV999
.
PRINV180  CALL      INHSH000     * Holy Spirit
          GOTO      PRINV999
.
PRINV190  CALL      INWWH000     * West Wimmera
          GOTO      PRINV999
.
PRINV200  CALL      INHUT000     * Hutt Valley
          GOTO      PRINV999
.
PRINV210  CALL      INBHS000     * Ballarat Health Services
          GOTO      PRINV999
.
PRINV220  CALL      IN132000     * Standard 132 Columns
          GOTO      PRINV999
.
PRINV999  RETURN
.----------------------------------------------------------------------
. Print Invoice Print Linup
.----------------------------------------------------------------------
INVPL000  READ      CONTROLF,EIGHTY1;*43,CFDBBLIN,CFDBBLST,CFDBETEL:
                                      CFDBECON,*243,CFDBILAY,CFDBSLAY
          MOVE      ONE,TMPLTFLG
          LOAD      MAXCLNO,CFDBILAY,TWENTY2,THIRTY4,TWENTY9,ZERO,TWENTY:
                                     ZERO,ZERO,THIRTY6,TWENTY1,ZERO:
                                     THIRTY4,TWENTY2
          LOAD      MAXLENGT,CFDBILAY,SIXTY6,SEVENTY,SIXTY6,ZERO,SIXTY6:
                                     ZERO,ZERO,SIXTY6,SIXTY6,ZERO:
                                     SIXTY6,SIXTY6
          BRANCH    CFDBILAY,INVPL110,INVPL120,INVPL130,INVPL140,INVPL150:
                             INVPL160,INVPL170,INVPL180,INVPL190,INVPL200:
                             INVPL210,INVPL220
.
INVPL110  CALL      LNSTD000     * Standard
          GOTO      INVPL900
.
INVPL120  CALL      LNEPW000     * Epworth
          GOTO      INVPL900
.
INVPL130  CALL      LNMOD000     * Modbury
          GOTO      INVPL900
.
INVPL140  CALL      LNSTH000     * Southland
          GOTO      INVPL999
.
INVPL150  CALL      LNWGH000     * West Gippsland
          GOTO      INVPL900
.
INVPL160  CALL      LNCHC000     * Coast Health Care
          GOTO      INVPL999
.
INVPL170  CALL      LNHWK000     * Hawkes Bay
          GOTO      INVPL999
.
INVPL180  CALL      LNHSH000     * Holy Spirit
          GOTO      INVPL900
.
INVPL190  CALL      LNWWH000     * West Wimmera
          GOTO      INVPL900
.
INVPL200  CALL      LNHUT000     * Hutt Valley
          GOTO      INVPL999
.
INVPL210  CALL      LNBHS000     * Ballarat Health Services
          GOTO      INVPL900
.
INVPL220  CALL      LN132000     * Standard 132 Columns
          GOTO      INVPL900
.
INVPL900  PACK      DBFHUR1,SP70
          PACK      DBFHUR2,SP70
          GOTO      INVPL999
.
INVPL999  RETURN
.------------------------------------------------------------------------------
. Lineup print for invoices 
.------------------------------------------------------------------------------
LNSTD000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000      * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
.
            PRINT     CPCDATE,*12,DIM7:
                      *20,DBITUNT,*25,DIM10A,*37,DIM14A:
                      *52,DIM14B,*68,TOTDIM13
            PRINT     *12,KEY28
            MOVE      FOUR,CURRROW
            MOVE      MAXCLNO,F3
            CALL      XPOS0000
.
            PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                      *49,DIM14TAX,*67,DIM14GRN
.
            IF        TMPLTFLG=0
              MOVE      ONE,HEADTAIL  * Flagged to Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNSTD900
          ENDIF
.
         PRINT      *N,*N,*N,*N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*2,"000000",*71,"000000":
                    *N,*N,*N,*71,"00/00/0000":
                    *N,*N,*N,*N:
.
                    *N,"99/99/9999",*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *40,"99999.99 ","XXXX ","99999999.9999"," 9,999,999.99":
.
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*56,"INVOICE TOTAL",*71,"0000000.00":
                    *N,*N,*71,"0000000.00":
                    *N,*N,*N,*N:
                    *N,*71,"0000000.00":
                    *N,*N,*2,"00/00/0000",*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*13,"000000",*25,"000000":
                    *N,*N,*N,*N,*N
LNSTD900 CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNSTD000 IF EQUAL
.
LNSTD999 RETURN
.------------------------------------------------------------------------------
. Print invoices
.------------------------------------------------------------------------------
INSTD000 MOVE       ZERO,TOTINV
         MOVE       ZERO,TGSTEXCV
         MOVE       ZERO,TGSTAMNT
         MOVE       ZERO,CPAGENO
.
         CALL       STMPL000        * Set up for Templating
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHSTD000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INSTD100 CALL       RKDBFD1
         BRANCH     OVRCD,INSTD900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INSTD900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INSTD900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INSTD900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       "99999.99",QTYDIM8
         FEDIT      DBFDQTY,QTYDIM8
         IF         DBFDQTY=0
           MOVE       SP70,QTYDIM8
           MOVE       SP70,DBITUNT
         ENDIF
.
         MOVE       "99999999.9999",PRIDIM13
         FEDIT      DBFDPRI,PRIDIM13
         IF         DBFDPRI=0
           MOVE       SP70,PRIDIM13
         ENDIF
 
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTAX+DBFDTOT,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
         ADD        DBFDTOT,TGSTEXCV
         ADD        DBFDTAX,TGSTAMNT
.
         MOVE       DBITIDE,KEY28
.
          BRANCH    TMPLTFLG,INSTD130
.
          MOVE      "9999.99",DIM7
          MOVE      DBFDQTY,F4P2
          FEDIT     F4P2,DIM7
.
          MOVE      "999,999.99",DIM10A
          MOVE      DBFDPRI,F12P2
          FEDIT     F12P2,DIM10A
.
          MOVE      "999,999,999.99",DIM14A
          FEDIT     DBFDTOT,DIM14A
.
          MOVE      "999,999,999.99",DIM14B
          FEDIT     DBFDTAX,DIM14B
.
          PRINT     CPCDATE,*12,DIM7:
                    *20,DBITUNT,*25,DIM10A,*37,DIM14A:
                    *52,DIM14B,*68,TOTDIM13
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFSTD000 IF EQUAL
.
          PRINT     *12,KEY28
.
          GOTO      INSTD140
.
INSTD130  PRINT     CPCDATE,*12,KEY28:
                    *40,QTYDIM8,SP1,DBITUNT,SP1,PRIDIM13,TOTDIM13
INSTD140  ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFSTD000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IFSTD000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INSTD150 CALL       RKDBFN1
         BRANCH     OVRCD,INSTD100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INSTD100 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFSTD000 IF EQUAL
.
         GOTO       INSTD150
.
INSTD900 ASSIGN     MAXCLNO-TWO,F2
         COMPARE    F2,CLNO
         GOTO       INSTD990 IF NOT LESS
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INSTD900
.
INSTD990  MOVE      "999,999,999.99",DIM14
          FEDIT     TGSTEXCV,DIM14
          MOVE      "999,999,999.99",DIM14TAX
          FEDIT     TGSTAMNT,DIM14TAX
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     TOTINV,DIM14GRN
.
          PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                    *49,DIM14TAX,*67,DIM14GRN
          ADD       TWO,CLNO
.
          IF        TMPLTFLG=0
            MOVE      "999,999,999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "999,999,999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "999,999,999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
            MOVE      ONE,HEADTAIL    * Flagged to Tail
            CALL      XINV0000      * Print Tax Invoice Tail
            PRINT     " "
            GOTO      INSTD999
          ENDIF
.
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *N,*N,*52,"INVOICE TOTAL",*65,TOTINV:
                    *N,*N,*2,DBTEDES,*65,TOTINV:
                    *N,*N,*N,*N:
                    *N,*65,TOTINV:
                    *N,*N,*2,CPCDATE,*13,NADLINE1:
                    *N,*N,*N,*12,DBFHDEB,*22,F12:
                    *N,*N,*N,*N,*N
.
INSTD999  RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFSTD000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      ONE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFSTD100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFSTD900
          ENDIF
.
IFSTD100  PRINT     *N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*2,DBTEDES,*70,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N
IFSTD900  CALL      IHSTD000
.
IFSTD999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHSTD000  ADD       ONE,CPAGENO
          MOVE      ZERO,CLNO
.
. Determine whether to use Tax Invoice Templating
.
          IF        TMPLTFLG=0
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
            GOTO      IHSTD999
          ENDIF
.
          PRINT     *N,*N,*N,*N,*N,*N,*N:
                    *N,*2,NADLINE1,*43,DBFHUR1:
                    *N,*2,NADLINE2,*43,DBFHUR2:
                    *N,*2,NADLINE3:
                    *N,*2,NADLINE4:
                    *N,*2,NADLINE5:
                    *N,*N
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *2,DBFHDEB,*70,F12:
                    *N,*N,*N,*71,CPCDATE:
                    *N,*N,*N,*N
.
IHSTD999  RETURN
.------------------------------------------------------------
. Line Up OK Question Routine. Returns FYESNO  0=No 1=Yes
.------------------------------------------------------------
LOKYN000 DISPLAY    *P1:24,*EL,"Line-Up Print OK (",*V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,") ? "
         MOVE       "26",CCOL
         MOVE       "24",CVERT
         CALL       YORN0000
         RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices Epworth
.------------------------------------------------------------------------------
LNEPW000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000      * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
.
            PRINT     CPCDATE,*12,DIM7:
                      *20,DBITUNT,*25,DIM10A,*37,DIM14A:
                      *52,DIM14B,*68,TOTDIM13
            PRINT     *12,KEY28
            MOVE      FOUR,CURRROW
            MOVE      MAXCLNO,F3
            CALL      XPOS0000
.
            PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                      *49,DIM14TAX,*65,DIM14GRN
.
            IF        TMPLTFLG=0
              MOVE      ONE,HEADTAIL  * Flagged to Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNEPW900
          ENDIF
.
         PRINT      *N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*2,"000000",*71,"000000":
                    *N,*N,*N,*71,"00/00/00":
                    *N,*N,*N,*N:
.
                    *1,"99/99/9999":
                    *12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *40,"99999.99 ","XXXX"," 9999999.9999"," 9,999,999.99":
.
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*N,*71,"0000000.00":
                    *N,*N,*N,*N:
                    *N,*71,"0000000.00":
                    *N,*N,*2,"00/00/00",*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*13,"000000",*25,"000000":
                    *N,*N,*N,*N,*N,*N,*N,*N
LNEPW900 CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNEPW000 IF EQUAL
.
LNEPW999 RETURN
.------------------------------------------------------------------------------
. Print invoices Epworth
.------------------------------------------------------------------------------
INEPW000 MOVE       ZERO,TOTINV
         MOVE       ZERO,TGSTEXCV
         MOVE       ZERO,TGSTAMNT
         MOVE       ZERO,CPAGENO
.
         CALL       STMPL000        * Set up for Templating
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHEPW000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INEPW100 CALL       RKDBFD1
         BRANCH     OVRCD,INEPW900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INEPW900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INEPW900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INEPW900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
.
          MOVE      "9,999.99",DIM8QTY
          FEDIT     DBFDQTY,DIM8QTY
          IF        DBFDQTY=0
            MOVE      SP70,DIM8QTY
            MOVE      SP70,DBITUNT
          ENDIF
.
          MOVE      "999,999.99",DIM10PRI
          MOVE      DBFDPRI,F12P2
          FEDIT     F12P2,DIM10PRI
          IF        F12P2=0
            MOVE      SP70,DIM10PRI
          ENDIF
.
          MOVE      "999,999.99",DIM10TOT
          FEDIT     DBFDTOT,DIM10TOT
          IF        DBFDTOT=0
            MOVE      SP70,DIM10TOT
          ENDIF
          ADD       DBFDTOT,TGSTEXCV
.
          MOVE      "99,999,999.99",DIM13TAX
          FEDIT     DBFDTAX,DIM13TAX
          IF        DBFDTAX=0
            MOVE      SP70,DIM13TAX
          ENDIF
          ADD       DBFDTAX,TGSTAMNT
.
          ASSIGN    DBFDTAX+DBFDTOT,F12P2
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     F12P2,DIM14GRN
          IF        F12P2=0
            MOVE      SP70,DIM14GRN
          ENDIF
          ADD       F12P2,TOTINV
.
          PRINT     CPCDATE,*12,DIM8QTY:
                    *21,DBITUNT,*26,DIM10PRI,*38,DIM10TOT:
                    *49,DIM13TAX,*64,DIM14GRN
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFEPW000 IF EQUAL
.
          MOVE      DBITIDE,KEY28
.
          PRINT     *12,KEY28
.
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFEPW000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IFEPW000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INEPW150 CALL       RKDBFN1
         BRANCH     OVRCD,INEPW100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INEPW100 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFEPW000 IF EQUAL
.
         GOTO       INEPW150
.
INEPW900 ASSIGN     MAXCLNO-TWO,F2
         COMPARE    F2,CLNO
         GOTO       INEPW990 IF NOT LESS
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INEPW900
.
INEPW990  MOVE      "999,999,999.99",DIM14
          FEDIT     TGSTEXCV,DIM14
          MOVE      "999,999,999.99",DIM14TAX
          FEDIT     TGSTAMNT,DIM14TAX
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     TOTINV,DIM14GRN
.
          PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                    *49,DIM14TAX,*65,DIM14GRN
          ADD       TWO,CLNO
.
          IF        TMPLTFLG=0
            MOVE      "999,999,999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "999,999,999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "999,999,999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
            MOVE      ONE,HEADTAIL    * Flagged to Tail
            CALL      XINV0000      * Print Tax Invoice Tail
            PRINT     " "
            GOTO      INEPW999
          ENDIF
.
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *N,*N,*20,DBTEDES,*64,TOTINV:
                    *N,*N,*N,*N:
                    *N,*64,TOTINV:
                    *N,*N,*2,CPCDATE,*13,NADLINE1:
                    *N,*N,*N,*12,DBFHDEB,*21,F12:
                    *N,*N,*N,*N,*N,*N,*N,*N
.
INEPW999  RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFEPW000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      ONE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFEPW100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFEPW900
          ENDIF
.
IFEPW100  PRINT     *N,*2,DBTEDES,*70,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N
IFEPW900  CALL      IHEPW000
.
IFEPW999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHEPW000  ADD       ONE,CPAGENO
          MOVE      ZERO,CLNO
.
. Determine whether to use Tax Invoice Templating
.
          IF        TMPLTFLG=0
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            GOTO      IHEPW999
          ENDIF
.
          PRINT     *N,*N,*N,*N:
                    *N,*2,NADLINE1:
                    *N,*2,NADLINE2:
                    *N,*2,NADLINE3:
                    *N,*2,NADLINE4:
                    *N,*2,NADLINE5:
                    *N,*N
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *2,DBFHDEB,*69,F12:
                    *N,*N,*N,*71,CPCDATE:
                    *N,*N,*N,*N
.
IHEPW999  RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices (MOD)
.------------------------------------------------------------------------------
LNMOD000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000      * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
.
            PRINT     CPCDATE,*12,QTYDIM8:
                      *25,DIM10A,*37,DIM14A:
                      *52,DIM14B,*68,TOTDIM13
            PRINT     *12,DBFDITM,*21,KEY20
            MOVE      FOUR,CURRROW
            MOVE      MAXCLNO,F3
            CALL      XPOS0000
.
            PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                      *49,DIM14TAX,*67,DIM14GRN
.
            IF        TMPLTFLG=0
              MOVE      ONE,HEADTAIL  * Flagged to Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNMOD900
          ENDIF
.
         PRINT      *N,*N,*N,*N,*N,*N,*N:
                    *N,*3,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*3,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*3,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*3,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*3,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N:
                    *2,"XXXXXXXX",*72,"9999999999":
                    *N,*N,*N,*72,"99/99/9999":
                    *N,*N,*N,*N,*N:
.
                    *1,"XX/XX/XXXX":
                    *12,"XXXXXXXX":
                    *21,"XXXXXXXXXXXXXXXXXXXX":
                    *44,"99999.99 99999999.9999 99,999,999.99":
.
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*71,"00000000.00":
                    *N,*N,*N,*N,*N,*N,*N,*1,"99/99/9999":
                    *15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*71,"00000000.00":
                    *N,*24,"9999999999"
LNMOD900 CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNMOD000 IF EQUAL
.
LNMOD999 RETURN
.------------------------------------------------------------------------------
. Print invoices Modbury
.------------------------------------------------------------------------------
INMOD000 MOVE       ZERO,TOTINV
         MOVE       ZERO,TGSTEXCV
         MOVE       ZERO,TGSTAMNT
         MOVE       ZERO,CPAGENO
.
         CALL       STMPL000        * Set up for Templating
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHMOD000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INMOD100 CALL       RKDBFD1
         BRANCH     OVRCD,INMOD900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INMOD900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INMOD900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INMOD900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
.
          MOVE      "9,999.99",DIM8QTY
          FEDIT     DBFDQTY,DIM8QTY
          IF        DBFDQTY=0
            MOVE      SP70,DIM8QTY
            MOVE      SP70,DBITUNT
          ENDIF
.
          MOVE      "999,999.99",DIM10PRI
          MOVE      DBFDPRI,F12P2
          FEDIT     F12P2,DIM10PRI
          IF        F12P2=0
            MOVE      SP70,DIM10PRI
          ENDIF
.
          MOVE      "999,999.99",DIM10TOT
          FEDIT     DBFDTOT,DIM10TOT
          IF        DBFDTOT=0
            MOVE      SP70,DIM10TOT
          ENDIF
          ADD       DBFDTOT,TGSTEXCV
.
          MOVE      "99,999,999.99",DIM13TAX
          FEDIT     DBFDTAX,DIM13TAX
          IF        DBFDTAX=0
            MOVE      SP70,DIM13TAX
          ENDIF
          ADD       DBFDTAX,TGSTAMNT
.
          ASSIGN    DBFDTAX+DBFDTOT,F12P2
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     F12P2,DIM14GRN
          IF        F12P2=0
            MOVE      SP70,DIM14GRN
          ENDIF
          ADD       F12P2,TOTINV
.
          PRINT     CPCDATE,*12,DIM8QTY:
                    *26,DIM10PRI,*39,DIM10TOT:
                    *50,DIM13TAX,*65,DIM14GRN
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFMOD000 IF EQUAL
.
          MOVE      DBITIDE,KEY20
.
          PRINT     *12,DBFDITM,*21,KEY20
.
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFMOD000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IFMOD000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INMOD150 CALL       RKDBFN1
         BRANCH     OVRCD,INMOD100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INMOD100 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFMOD000 IF EQUAL
.
         GOTO       INMOD150
.
INMOD900 ASSIGN     MAXCLNO-TWO,F2
         COMPARE    F2,CLNO
         GOTO       INMOD990 IF EQUAL
         GOTO       INMOD980 IF NOT LESS
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INMOD900
.
INMOD980  CALL      IFMOD000
          GOTO      INMOD900
.
INMOD990  MOVE      "999,999,999.99",DIM14
          FEDIT     TGSTEXCV,DIM14
          MOVE      "999,999,999.99",DIM14TAX
          FEDIT     TGSTAMNT,DIM14TAX
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     TOTINV,DIM14GRN
.
          PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                    *49,DIM14TAX,*65,DIM14GRN
          ADD       TWO,CLNO
.
          IF        TMPLTFLG=0
            MOVE      "999,999,999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "999,999,999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "999,999,999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
            MOVE      ONE,HEADTAIL    * Flagged to Tail
            CALL      XINV0000      * Print Tax Invoice Tail
            PRINT     " "
            GOTO      INMOD999
          ENDIF
.
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *N,*2,DBTEDES,*64,TOTINV:
                    *N,*N,*N,*N,*N,*N,*N:
                    *1,CPCDATE,*15,NADLINE1:
                    *N,*N,*64,TOTINV:
                    *N,*13,DBFHDEB,*22,F12
.
INMOD999 RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFMOD000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      ONE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFMOD100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFMOD900
          ENDIF
.
IFMOD100  PRINT     *N,*N,*N,*2,DBTEDES,*71,"CARRIED FWD"
IFMOD900  CALL      IHMOD000
.
IFMOD999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHMOD000  ADD       ONE,CPAGENO
          MOVE      ZERO,CLNO
.
. Determine whether to use Tax Invoice Templating
.
          IF        TMPLTFLG=0
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            GOTO      IHMOD999
          ENDIF
.
          PRINT     *F,*N,*N,*N,*N,*N,*N,*N:
                    *N,*3,NADLINE1:
                    *N,*3,NADLINE2:
                    *N,*3,NADLINE3:
                    *N,*3,NADLINE4:
                    *N,*3,NADLINE5:
                    *N,*N,*N
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *2,DBFHDEB:
                    *69,F12:
                    *N,*N,*N:
                    *71,CPCDATE:
                    *N,*N,*N,*N
.
IHMOD999  RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices (WGH)
.------------------------------------------------------------------------------
LNWGH000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000      * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
.
            PRINT     CPCDATE,*12,DIM8QTY:
                      *26,DIM10PRI,*37,DIM10TOT:
                      *48,DIM14TAX,*64,DIM14GRN
            PRINT     *12,DBFDITM,*21,KEY20
            MOVE      FOUR,CURRROW
            MOVE      MAXCLNO,F3
            CALL      XPOS0000
.
            PRINT     *N,*1,"INVOICE TOTAL",*34,DIM14:
                      *48,DIM14TAX,*67,DIM14GRN
.
            IF        TMPLTFLG=0
              MOVE      ONE,HEADTAIL  * Flagged to Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNWGH900
          ENDIF
.
         PRINT      *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N
         PRINT      *2,"XXXXXXXX",*55,"99/99/9999":
                    *72,"9999999999":
                    *N,*N,*N,*N,*N,*N,*N:
.
                    "99/99/9999",*12,"9,999.99":
                    *26,"999,999.99",*37,"999,999.99":
                    *48,"999,999,999.99",*64,"999,999,999.99":
.
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N:
                    *N,*67,"00000000.00":
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*1,"99/99/9999",*15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*70,"00000000.00":
                    *N,*N,*N,*N,*3,"XXXXXXXX",*33,"9999999999"
LNWGH900 CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNWGH000 IF EQUAL
.
LNWGH999 RETURN
.------------------------------------------------------------------------------
. Print invoices West Gippsland
.------------------------------------------------------------------------------
INWGH000  MOVE      ZERO,TOTINV
          MOVE      ZERO,TGSTEXCV
          MOVE      ZERO,TGSTAMNT
          MOVE      ZERO,CPAGENO
.
          CALL      STMPL000        * Set up for Templating
          CALL      FORAD000        * Format Name & Address into 5 Lines
          CALL      IHWGH000         * Print Invoice Heading
.
          PACK      KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
          CALL      RSDBFD1
INWGH100  CALL      RKDBFD1
          BRANCH    OVRCD,INWGH900
          MATCH     DBFHDEB,DBFDDEB
          GOTO      INWGH900 IF NOT EQUAL
          MATCH     DBFHDTY,DBFDDTY
          GOTO      INWGH900 IF NOT EQUAL
          MATCH     DBFHDOC,DBFDDOC
          GOTO      INWGH900 IF NOT EQUAL
.
          PACK      KEY8,DBFDITM
          CALL      RDDBIT1        * Read Sales Item Details
.
          UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          MOVE      "9,999.99",DIM8QTY
          FEDIT     DBFDQTY,DIM8QTY
          IF        DBFDQTY=0
            MOVE      SP70,DIM8QTY
            MOVE      SP70,DBITUNT
          ENDIF
.
          MOVE      "999,999.99",DIM10PRI
          MOVE      DBFDPRI,F12P2
          FEDIT     F12P2,DIM10PRI
          IF        F12P2=0
            MOVE      SP70,DIM10PRI
          ENDIF
.
          MOVE      "999,999.99",DIM10TOT
          FEDIT     DBFDTOT,DIM10TOT
          IF        DBFDTOT=0
            MOVE      SP70,DIM10TOT
          ENDIF
          ADD       DBFDTOT,TGSTEXCV
.
          MOVE      "999,999,999.99",DIM14TAX
          FEDIT     DBFDTAX,DIM14TAX
          IF        DBFDTAX=0
            MOVE      SP70,DIM14TAX
          ENDIF
          ADD       DBFDTAX,TGSTAMNT
.
          ASSIGN    DBFDTAX+DBFDTOT,F12P2
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     F12P2,DIM14GRN
          IF        F12P2=0
            MOVE      SP70,DIM14GRN
          ENDIF
          ADD       F12P2,TOTINV
.
          PRINT     CPCDATE,*12,DIM8QTY:
                    *26,DIM10PRI,*37,DIM10TOT:
                    *48,DIM14TAX,*67,DIM14GRN
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFWGH000 IF EQUAL
.
          MOVE      DBITIDE,KEY20
.
          PRINT     *12,DBFDITM,*21,KEY20
.
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFWGH000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
          MATCH      SP70,DBFDDREF
          IF         !@EQUAL
            PRINT      *12,DBFDDREF
            ADD        ONE,CLNO
            COMPARE    MAXCLNO,CLNO
            CALL       IFWGH000 IF EQUAL
          ENDIF 
.
          PACK      KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
          CALL      RSDBFN1
INWGH150  CALL      RKDBFN1
          BRANCH    OVRCD,INWGH100
          PACK      KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
          PACK      KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
          MATCH     KEY24,KEY27
          GOTO      INWGH100 IF NOT EQUAL
.
          PRINT     *12,DBFNCOM
          ADD       ONE,CLNO
          COMPARE   MAXCLNO,CLNO
          CALL      IFWGH000 IF EQUAL
.
          GOTO      INWGH150
.
INWGH900  ASSIGN    MAXCLNO-TWO,F2
          COMPARE   F2,CLNO
          GOTO      INWGH990 IF EQUAL
          GOTO      INWGH980 IF NOT LESS
          PRINT     " "
          ADD       ONE,CLNO
          GOTO      INWGH900
.
INWGH980  CALL      IFWGH000
          GOTO      INWGH900
.
INWGH990  MOVE      "999,999,999.99",DIM14
          FEDIT     TGSTEXCV,DIM14
          MOVE      "999,999,999.99",DIM14TAX
          FEDIT     TGSTAMNT,DIM14TAX
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     TOTINV,DIM14GRN
.
          PRINT     *N,*1,"INVOICE TOTAL",*34,DIM14:
                    *48,DIM14TAX,*67,DIM14GRN
          ADD       TWO,CLNO
.
          IF        TMPLTFLG=0
            MOVE      "999,999,999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "999,999,999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "999,999,999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
            MOVE      ONE,HEADTAIL    * Flagged to Tail
            CALL      XINV0000      * Print Tax Invoice Tail
            PRINT     " "
            GOTO      INWGH999
          ENDIF
.
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *N,*2,DBTEDES,*67,TOTINV:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *1,CPCDATE,*15,NADLINE1:
                    *N,*N,*N,*N,*15,DBFHUR1,*67,TOTINV:
                    *N,*N,*N,*N,*3,DBFHDEB,*31,F12
.
INWGH999  RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFWGH000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      ONE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFWGH100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFWGH900
          ENDIF
.
IFWGH100  PRINT     *N,*2,DBTEDES,*71,"CARRIED FWD"
IFWGH900  CALL      IHWGH000
.
IFWGH999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHWGH000  ADD       ONE,CPAGENO
          MOVE      ZERO,CLNO
.
. Determine whether to use Tax Invoice Templating
.
          IF        TMPLTFLG=0
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            GOTO      IHWGH999
          ENDIF
.
          PRINT     *F,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*13,NADLINE1:
                    *N,*13,NADLINE2,*54,DBFHUR1:
                    *N,*13,NADLINE3:
                    *N,*13,NADLINE4:
                    *N,*13,NADLINE5:
                    *N,*N
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
          PRINT     *2,DBFHDEB:
                    *55,CPCDATE:
                    *70,F12:
                    *N,*N,*N,*N,*N,*N
.
IHWGH999 RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices (STH)
.------------------------------------------------------------------------------
LNSTH000 CALL       OPNPRINT
         PRINT      *N,*N,*N,*N,*N,*N,*N:
                    *N,*5,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*5,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*5,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*5,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*5,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*2,"000000",*71,"000000":
                    *N,*N,*N,*71,"00/00/00":
                    *N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXX":
                    *12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *42,"00000.00",*51,"XXXX":
                    *59,"0000000.00",*71,"0000000.00":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*56,"INVOICE TOTAL",*71,"0000000.00":
                    *N,*N,*71,"0000000.00":
                    *N,*N,*N,*N:
                    *N,*71,"0000000.00":
                    *N,*N,*2,"00/00/00",*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*13,"000000",*25,"000000":
                    *N,*N,*N,*N,*N
         CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNSTD000 IF EQUAL
         RETURN
.------------------------------------------------------------------------------
. Print invoices (SOUTHLAND)
.------------------------------------------------------------------------------
INSTH000 MOVE       ZERO,TOTINV
         MOVE       ZERO,CPAGENO
.
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHSTH000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INSTH100 CALL       RKDBFD1
         BRANCH     OVRCD,INSTH900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INSTH900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INSTH900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INSTH900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       "99999.99",QTYDIM8
         FEDIT      DBFDQTY,QTYDIM8
         IF         DBFDQTY=0
           MOVE       SP70,QTYDIM8
           MOVE       SP70,DBITUNT
         ENDIF
.
         MOVE       "99999999.99",PRIDIM11
         MOVE       DBFDPRI,F12P2
         FEDIT      F12P2,PRIDIM11
         IF         DBFDPRI=0
           MOVE       SP70,PRIDIM11
         ENDIF
.
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTOT,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
.
         MOVE       DBITIDE,KEY28
         PRINT      CPCDATE,*12,KEY28:
                    *40,QTYDIM8,SP1,DBITUNT,SP1,PRIDIM11,SP2,TOTDIM13
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFSTH000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    "28",CLNO
           CALL       IFSTH000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INSTH150 CALL       RKDBFN1
         BRANCH     OVRCD,INSTH200
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INSTH200 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFSTH000 IF EQUAL
.
         GOTO       INSTH150
.
INSTH200 CLEAR      KEY28
         APPEND     "GOODS & SERVICES TAX@",KEY28
         APPEND     DBFDTRT,KEY28
         RESET      KEY28
.
         MOVE       "99999999.99",PRIDIM11
         MOVE       DBFDTAX,F12P2
         FEDIT      F12P2,PRIDIM11
         IF         DBFDPRI=0
           MOVE       SP70,PRIDIM11
         ENDIF
.
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTAX,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
         PRINT      CPCDATE,*12,KEY28:
                    *40,"    1.00",SP1,SP4,SP1,PRIDIM11,SP2,TOTDIM13
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFSTH000 IF EQUAL
         GOTO       INSTH100
.
INSTH900 COMPARE    "27",CLNO
         GOTO       INSTH990 IF EQUAL
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INSTH900
.
INSTH990 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *N,*N,*53,"INVOICE TOTAL",*65,TOTINV:
                    *N,*N,*2,DBTEDES,*65,TOTINV:
                    *N,*N,*N,*N:
                    *N,*65,TOTINV:
                    *N,*N,*2,CPCDATE,*13,NADLINE1:
                    *N,*N,*N,*12,DBFHDEB,*22,F12:
                    *N,*N,*N,*N,*N
         RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFSTH000 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         PRINT      *N,*N,*N:
                    *2,DBTEDES,*70,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
         CALL       IHSTH000
         RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHSTH000 ADD        ONE,CPAGENO
         PRINT      *N,*N,*N,*N,*N,*N,*N:
                    *N,*5,NADLINE1,*43,DBFHUR1:
                    *N,*5,NADLINE2,*43,DBFHUR2:
                    *N,*5,NADLINE3:
                    *N,*5,NADLINE4:
                    *N,*5,NADLINE5:
                    *N,*N
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *2,DBFHDEB,*69,F12:     * srf 646116
                    *N,*N,*N,*71,CPCDATE:
                    *N,*N,*N,*N
         MOVE       ZERO,CLNO
         RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices Coast Health Care
.------------------------------------------------------------------------------
LNCHC000 CALL       OPNPRINT
         PRINT      *N,*N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*2,"000000",*71,"000000":
                    *N,*N,*N,*71,"00/00/00":
                    *N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXX":
                    *12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *42,"00000.00",*51,"XXXX":
                    *59,"0000000.00",*71,"0000000.00":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*N,*71,"0000000.00":
                    *N,*N,*N,*N:
                    *N,*71,"0000000.00":
                    *N,*N,*2,"00/00/00",*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*13,"000000",*25,"000000":
                    *N,*N,*N,*N,*N,*N,*N
         CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNCHC000 IF EQUAL
         RETURN
.------------------------------------------------------------------------------
. Print invoices Coast Health Care
.------------------------------------------------------------------------------
INCHC000 MOVE       ZERO,TOTINV
         MOVE       ZERO,CPAGENO
.
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHCHC000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INCHC100 CALL       RKDBFD1
         BRANCH     OVRCD,INCHC900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INCHC900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INCHC900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INCHC900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       "99999.99",QTYDIM8
         FEDIT      DBFDQTY,QTYDIM8
         IF         DBFDQTY=0
           MOVE       SP70,QTYDIM8
           MOVE       SP70,DBITUNT
         ENDIF
.
         MOVE       "99999999.9999",PRIDIM13
         FEDIT      DBFDPRI,PRIDIM13
         IF         DBFDPRI=0
           MOVE       SP70,PRIDIM13
         ENDIF
 
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTAX+DBFDTOT,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
.
         MOVE       DBITIDE,KEY28
         PRINT      CPCDATE,*12,KEY28:
                    *40,QTYDIM8,SP1,DBITUNT,SP1,PRIDIM13,TOTDIM13
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFCHC000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    "28",CLNO
           CALL       IFCHC000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INCHC150 CALL       RKDBFN1
         BRANCH     OVRCD,INCHC100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INCHC100 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFCHC000 IF EQUAL
.
         GOTO       INCHC150
.
INCHC900 COMPARE    "27",CLNO
         GOTO       INCHC990 IF EQUAL
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INCHC900
.
INCHC990 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *N,*N:
                    *N,*N,*20,DBTEDES,*65,TOTINV:
                    *N,*N,*N,*N:
                    *N,*65,TOTINV:
                    *N,*N,*2,CPCDATE,*13,NADLINE1:
                    *N,*N,*N,*12,DBFHDEB,*21,F12:
                    *N,*N,*N,*N,*N,*N,*N
         RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFCHC000 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         PRINT      *N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*2,DBTEDES,*70,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N
         CALL       IHCHC000
         RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHCHC000 ADD        ONE,CPAGENO
         PRINT      *N,*N,*N,*N,*N:
                    *N,*2,NADLINE1:
                    *N,*2,NADLINE2:
                    *N,*2,NADLINE3:
                    *N,*2,NADLINE4:
                    *N,*2,NADLINE5:
                    *N,*N
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *2,DBFHDEB,*67,F12:
                    *N,*N,*N,*71,CPCDATE:
                    *N,*N,*N,*N
         MOVE       ZERO,CLNO
         RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices Hawkes Bay
.------------------------------------------------------------------------------
LNHWK000 CALL       OPNPRINT
         PRINT      *N,*N,*N,*N,*N:
                    *N,*4,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*4,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*4,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*4,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*4,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*2,"000000",*71,"000000":
                    *N,*N,*N,*71,"00/00/00":
                    *N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXX":
                    *12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *42,"00000.00",*51,"XXXX":
                    *59,"0000000.00",*71,"0000000.00":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*N,*71,"0000000.00":
                    *N,*N,*N,*N:
                    *N,*71,"0000000.00":
                    *N,*N,*2,"00/00/00",*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*13,"000000",*25,"000000":
                    *N,*N,*N,*N,*N,*N,*N
         CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNHWK000 IF EQUAL
         RETURN
.------------------------------------------------------------------------------
. Print invoices Hawkes Bay
.------------------------------------------------------------------------------
INHWK000 MOVE       ZERO,TOTINV
         MOVE       ZERO,CPAGENO
.
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHHWK000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INHWK100 CALL       RKDBFD1
         BRANCH     OVRCD,INHWK900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INHWK900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INHWK900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INHWK900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
.
.        MOVE       "99999.99",QTYDIM8              * D CAR 21920
.        FEDIT      DBFDQTY,QTYDIM8
.        IF         DBFDQTY=0
.          MOVE       SP70,QTYDIM8
.          MOVE       SP70,DBITUNT
.        ENDIF                                      * end D CAR 21920
.
         MOVE       "99,999.99",QTYDIM9             * I CAR 21920
         FEDIT      DBFDQTY,QTYDIM9
         IF         DBFDQTY=0
           MOVE       SP70,QTYDIM9
           MOVE       SP70,DBITUNT
         ENDIF                                      * end I CAR 21920
.
.        MOVE       "99999999.99",PRIDIM11          * D CAR 21920
.        MOVE       DBFDPRI,F12P2
.        FEDIT      F12P2,PRIDIM11
.        IF         DBFDPRI=0
.          MOVE       SP70,PRIDIM11
.        ENDIF                                      * end D CAR 21920
.
         MOVE       "99,999,999.99",PRIDIM13        * I CAR 21920
         MOVE       DBFDPRI,F12P2
         FEDIT      F12P2,PRIDIM13
         IF         DBFDPRI=0
           MOVE       SP70,PRIDIM13
         ENDIF                                      * end I CAR 21920
.
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTOT,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
.
         MOVE       DBITIDE,KEY28
         PRINT      CPCDATE,*12,KEY28:
                    *40,QTYDIM9,SP1,DBITUNT,SP1,PRIDIM13,SP1,TOTDIM13
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFHWK000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    "28",CLNO
           CALL       IFHWK000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INHWK150 CALL       RKDBFN1
         BRANCH     OVRCD,INHWK200
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INHWK200 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFHWK000 IF EQUAL
.
         GOTO       INHWK150
.
INHWK200 CLEAR      KEY28
         APPEND     "GOODS & SERVICES TAX@",KEY28
         APPEND     DBFDTRT,KEY28
         RESET      KEY28
.
.        MOVE       "99999999.99",PRIDIM11            * D CAR 21920
.        MOVE       DBFDTAX,F12P2
.        FEDIT      F12P2,PRIDIM11
.        IF         DBFDPRI=0
.          MOVE       SP70,PRIDIM11
.        ENDIF                                        * end D CAR 21920
.
         MOVE       "99,999,999.99",PRIDIM13        * I CAR 21920
         MOVE       DBFDTAX,F12P2
         FEDIT      F12P2,PRIDIM13
         IF         DBFDTAX=0
           MOVE       SP70,PRIDIM13
         ENDIF                                      * end I CAR 21920
.
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTAX,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
         PRINT      CPCDATE,*12,KEY28:
                    *40,"     1.00",SP1,SP4,SP1,PRIDIM13,SP1,TOTDIM13
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFHWK000 IF EQUAL
         GOTO       INHWK100
.
INHWK900 COMPARE    "27",CLNO
         GOTO       INHWK990 IF EQUAL
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INHWK900
.
INHWK990 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
.
         MOVE       "99,999,999.99",TOTDIM13         * I CAR 21920
         ASSIGN     TOTINV,F12P2                     
         FEDIT      F12P2,TOTDIM13                   * Format Total with commas
         IF         F12P2=0
           MOVE       SP70,TOTDIM13                  * Reinitialise if zeroes
         ENDIF
.                                                    * end I CAR 21920
         PRINT      *N,*N:
                    *N,*N,*20,DBTEDES,*65,TOTDIM13:
                    *N,*N,*N,*N:
                    *N,*65,TOTDIM13:
                    *N,*N,*2,CPCDATE,*13,NADLINE1:
                    *N,*N,*N,*12,DBFHDEB,*22,F12:
                    *N,*N,*N,*N,*N,*N,*N
         RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFHWK000 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         PRINT      *N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*2,DBTEDES,*70,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N
         CALL       IHHWK000
         RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHHWK000 ADD        ONE,CPAGENO
         PRINT      *N,*N,*N,*51,CFDBETEL,*N,*N:
                    *N,*4,NADLINE1:
                    *N,*4,NADLINE2:
                    *N,*4,NADLINE3:
                    *N,*4,NADLINE4:
                    *N,*4,NADLINE5:
                    *N,*N
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *2,DBFHDEB,*70,F12:
                    *N,*N,*N,*71,CPCDATE:
                    *N,*N,*N,*N
         MOVE       ZERO,CLNO
         RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices Holy Spirit
.------------------------------------------------------------------------------
LNHSH000  CALL      OPNPRINT
.
          CALL      STMPL000         * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000       * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL  * Flagged to Invoice Header
            CALL      XINV0000       * Print Tax Invoice Header
            PRINT     *N;
.
            PRINT     CPCDATE,*21,F4,*25,DIM10A,*37,DIM14A:
                      *52,DIM14B,*68,TOTDIM13
            PRINT     *22,KEY27,*58,DIM12
            MOVE      FOUR,CURRROW
            MOVE      MAXCLNO,F3
            CALL      XPOS0000
.
            PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                      *49,DIM14TAX,*65,DIM14GRN
.
            IF        TMPLTFLG=0
              MOVE      ONE,HEADTAIL  * Flagged to Invoice Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNHSH900
          ENDIF
.
          PRINT     *N,*N,*N,*N,*N,*N,*N,*54,"Debtor No. : ","XXXXXXXX",*N,*N:
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*38,"XXXX":
                    *N,*N,*N,*N,*N,*N,*N:
                    *1,"PAGE ","XXX",*12,"XXXXXXXXXX",*65,"99/99/9999":
                    *N,*N,*N,*N:
.
                    "99/99/9999":
                    *22,"XXXXXXXXXXXXXXXXXXXXXXXXXXX",*54,"999":
                    *58,"XXXXXX",*67,"99,999,999.99":
.
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*67,"9999999999.99"
LNHSH900  CALL      CLSPRINT
          CALL      LOKYN000
          COMPARE   ZERO,FYESNO
          GOTO      LNHSH000 IF EQUAL
.
LNHSH999  RETURN
.------------------------------------------------------------------------------
. Print invoices Holy Spirit
.------------------------------------------------------------------------------
INHSH000 MOVE       ZERO,TOTINV
         MOVE       ZERO,TGSTEXCV                                              
         MOVE       ZERO,TGSTAMNT 
         MOVE       ZERO,CPAGENO
.
         CALL       STMPL000        * Set up for Templating
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHHSH000        * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INHSH100 CALL       RKDBFD1
         BRANCH     OVRCD,INHSH900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INHSH900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INHSH900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INHSH900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
.
          MOVE      "9,999.99",DIM8QTY
          FEDIT     DBFDQTY,DIM8QTY
          IF        DBFDQTY=0
            MOVE      SP70,DIM8QTY
            MOVE      SP70,DBITUNT
          ENDIF
.
          MOVE      "999,999.99",DIM10PRI
          MOVE      DBFDPRI,F12P2
          FEDIT     F12P2,DIM10PRI
          IF        F12P2=0
            MOVE      SP70,DIM10PRI
          ENDIF
.
          MOVE      "999,999.99",DIM10TOT
          FEDIT     DBFDTOT,DIM10TOT
          IF        DBFDTOT=0
            MOVE      SP70,DIM10TOT
          ENDIF
          ADD       DBFDTOT,TGSTEXCV
.
          MOVE      "99,999,999.99",DIM13TAX
          FEDIT     DBFDTAX,DIM13TAX
          IF        DBFDTAX=0
            MOVE      SP70,DIM13TAX
          ENDIF
          ADD       DBFDTAX,TGSTAMNT
.
          ASSIGN    DBFDTAX+DBFDTOT,F12P2
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     F12P2,DIM14GRN
          IF        F12P2=0
            MOVE      SP70,DIM14GRN
          ENDIF
          ADD       F12P2,TOTINV
.
         PACK       DIM35,SP70
         PACK       KEY8,DBITPTY,SP70
         CALL       RDDBPT1
         BRANCH     OVRCD,INHSH130
         PACK       KEY8,DBPTDEP,SP70
         CALL       RDDBDE1
         BRANCH     OVRCD,INHSH130
         MOVE       DBDEDES,DIM35
.
         MOVE       DBITIDE,KEY27
         MATCH      SP70,KEY27
         IF         @EQUAL
           MOVE       DBFDDREF,KEY27
           MOVE       SP70,DBFDDREF
         ENDIF  
.
INHSH130 PRINT      CPCDATE,*18,DIM8QTY,*26,DIM10PRI,*42,DIM10TOT:
                    *54,DIM13TAX,*68,DIM14GRN
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFHSH000 IF EQUAL
.
         PRINT      *18,KEY27,*47,DIM35
.
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFHSH000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *18,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IFHSH000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INHSH800 CALL       RKDBFN1
         BRANCH     OVRCD,INHSH100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INHSH100 IF NOT EQUAL
.
         PRINT      *18,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFHSH000 IF EQUAL
.
         GOTO       INHSH800
.
INHSH900 IF         TMPLTFLG = 1   
           COMPARE  MAXCLNO,CLNO
           GOTO     INHSH990 IF EQUAL
         ELSE
           ASSIGN   MAXCLNO-TWO,F2
           COMPARE  F2,CLNO
           GOTO     INHSH990 IF EQUAL
           GOTO     INHSH980 IF NOT LESS
         ENDIF

         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INHSH900
.
INHSH980 ASSIGN     MAXCLNO - ONE,F2
         IF         CLNO = F2
           PRINT    " "
         ENDIF

         CALL       IFHSH000
         GOTO       INHSH900
.
INHSH990  MOVE      "999,999,999.99",DIM14
          FEDIT     TGSTEXCV,DIM14
          MOVE      "999,999,999.99",DIM14TAX
          FEDIT     TGSTAMNT,DIM14TAX
          MOVE      "999,999,999.99",DIM14GRN
          FEDIT     TOTINV,DIM14GRN
.
          PRINT     *N,*1,"INVOICE TOTAL",*35,DIM14:
                    *49,DIM14TAX,*65,DIM14GRN
          ADD       TWO,CLNO
.
          IF        TMPLTFLG=0
            MOVE      "999,999,999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "999,999,999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "999,999,999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
            MOVE      ONE,HEADTAIL  * Flagged to Invoice Tail
            CALL      XINV0000      * Print Tax Invoice Tail
            PRINT     " "
            GOTO      INHSH999
          ENDIF
.
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         MOVE       DBFHDOC,F12
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     TOTINV,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         PRINT      *N,*N:
                    *N,*N,*67,TOTDIM13
.
INHSH999 RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFHSH000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      ONE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFHSH100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFHSH900
          ENDIF
.
IFHSH100  PRINT     *N,*N:
                    *N,*69,"CARRIED FWD"
.
IFHSH900  CALL      IHHSH000
.
IFHSH999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHHSH000 ADD        ONE,CPAGENO
         MOVE       ZERO,CLNO
         PACK       ADMDATE,SP70
         PACK       DISDATE,SP70
.
         MATCH      SP25,DBFHUR2
         GOTO       IHHSH900 IF EQUAL
.
         PACK       KEY8,DBFHUR2
.
.        Remove all access to DEB PAS clone includes; replace with real ones.
.
IHHSH200 CALL       RDMISS1                   * Change to PATMI1 read    v90201
         BRANCH     OVRCD,IHHSH900
.
         UNPACK     ADATE,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       CPCDATE,ADMDATE
         REP        " 0",ADMDATE
         BRANCH     ASTAT,IHHSH900,IHHSH900,IHHSH250
         GOTO       IHHSH900
.
IHHSH250 CALL       RDDSCH1                   * Use PAT DSC read         v90201
         BRANCH     OVRCD,IHHSH900
.
         UNPACK     DDATE,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       CPCDATE,DISDATE
         REP        " 0",DISDATE
         GOTO       IHHSH900
.
. Determine whether to use Tax Invoice Templating
.
IHHSH900 IF         TMPLTFLG=0
           MOVE       ZERO,HEADTAIL  * Flagged to Invoice Header
           CALL       XINV0000       * Print Tax Invoice Header
           GOTO       IHHSH999
         ENDIF
.
         PRINT      *F,*N,*N,*N,*N,*N,*N,*N,*54,"Debtor No. : ",DBFHDEB,*N,*N:
                    *N,*12,DBDBNA1:
                    *N,*12,DBDBNA2:
                    *N,*12,DBDBAD1:
                    *N,*12,DBDBAD2:
                    *N,*12,DBDBAD3:
                    *N,*38,DBDBPC:
                    *N,*N,*N,*N,*N
         MOVE       DBFHDOC,F12
         PRINT      *1,"PAGE ",CPAGENO,*11,F12,*37,ADMDATE,*50,DISDATE;
.
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         PRINT      *65,CPCDATE:
                    *N,*N,*N
.
IHHSH999 RETURN
.------------------------------------------------------------------------------
. Lineup print for invoices West Wimmera
.------------------------------------------------------------------------------
LNWWH000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000      * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
.
            PRINT     CPCDATE,*12,DIM8QTY:
                      *21,DBITUNT,*26,DIM10PRI,*46,DIM12TOT:
                      *58,DIM10TAX,*68,TOTDIM12
            PRINT     *12,KEY28
            IF        TMPLTFLG=0
              MOVE      FOUR,CURRROW
            ELSE
              MOVE      TWO,CURRROW
            ENDIF
            MOVE      MAXCLNO,F3
            CALL      XPOS0000
.
            IF        TMPLTFLG=0
              PRINT     *N,*1,"INVOICE TOTAL",*46,DIM12:
                        *58,DIM10TAX,*68,TOTDIM12
.
              MOVE      ONE,HEADTAIL  * Flagged to Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNWWH900
          ENDIF
.
         PRINT      *N,*N,*60,"    INVOICE",*N,*N,*N:
                    *N,*53,"9999999999",*70,"99/99/9999":
                    *N,*N,*N,*N:
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*N,*2,"99999999":
                    *N,*N,*N,*N:
.
                    "99/99/9999",*12,"9,999.99":
                    *26,"999,999.99",*37,"999,999.99":
                    *48,"999,999,999.99",*64,"999,999,999.99":
.
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*66,"000000000.00":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*53,"99999999",*70,"9999999999":
                    *N,*12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*69,"000000000.00" 
LNWWH900 CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNWWH000 IF EQUAL
.
LNWWH999 RETURN
.------------------------------------------------------------------------------
. Print invoices West Wimmera
.------------------------------------------------------------------------------
INWWH000 MOVE       ZERO,TOTINV
         MOVE       ZERO,TGSTEXCV                                              
         MOVE       ZERO,TGSTAMNT 
         MOVE       ZERO,CPAGENO
.
         CALL       STMPL000        * Set up for Templating
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHWWH000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INWWH100 CALL       RKDBFD1
         BRANCH     OVRCD,INWWH900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INWWH900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INWWH900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INWWH900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
.
         MOVE       "9,999.99",DIM8QTY
         FEDIT      DBFDQTY,DIM8QTY
         IF         DBFDQTY=0
           MOVE       SP70,DIM8QTY
           MOVE       SP70,DBITUNT
         ENDIF
.
         MOVE       DBFDPRI,F5P2
         MOVE       "999,999.99",DIM10PRI
         MOVE       DBFDPRI,F12P2
         FEDIT      F12P2,DIM10PRI
         IF         F12P2=0
           MOVE       SP70,DIM10PRI
         ENDIF
.
         MOVE       "9,999,999.99",DIM12TOT
         FEDIT      DBFDTOT,DIM12TOT
         IF         DBFDTOT=0
           MOVE       SP70,DIM12TOT
         ENDIF
         ADD        DBFDTOT,TGSTEXCV
.
         MOVE       "999,999.99",DIM10TAX
         FEDIT      DBFDTAX,DIM10TAX
         IF         DBFDTAX=0
           MOVE       SP70,DIM10TAX
         ENDIF
         ADD        DBFDTAX,TGSTAMNT
.
         ASSIGN     DBFDTAX+DBFDTOT,F12P2
         MOVE       "9,999,999.99",TOTDIM12
         FEDIT      F12P2,TOTDIM12
         IF         F12P2=0
           MOVE       SP70,TOTDIM12
         ENDIF
         ADD        F12P2,TOTINV
.
         IF         TMPLTFLG=1
           MOVE       DBITIDE,KEY28
           PRINT      CPCDATE,*12,KEY28:
                      *42,DIM8QTY,SP4,DBITUNT,SP2,F5P2,TOTDIM12
         ELSE
           PRINT      CPCDATE,*12,DIM8QTY:
                      *21,DBITUNT,*26,DIM10PRI,*46,DIM12TOT:
                      *58,DIM10TAX,*68,TOTDIM12
         ENDIF
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFWWH000 IF EQUAL
.
         IF         TMPLTFLG=0
           MOVE       DBITIDE,KEY28
           PRINT      *12,KEY28
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IFWWH000 IF EQUAL
         ENDIF
.
. Print invoice Detail lines
.----------------------------
INWWH140 MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IFWWH000 IF EQUAL
         ENDIF
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INWWH150 CALL       RKDBFN1
         BRANCH     OVRCD,INWWH100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INWWH100 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IFWWH000 IF EQUAL
         GOTO       INWWH150
.
INWWH900 IF         TMPLTFLG=1
           COMPARE    MAXCLNO,CLNO
           GOTO       INWWH990 IF EQUAL
         ELSE
           ASSIGN     MAXCLNO-TWO,F2
           COMPARE    F2,CLNO
           GOTO       INWWH990 IF EQUAL
           GOTO       INWWH980 IF NOT LESS
         ENDIF
.
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INWWH900
.
INWWH980 ASSIGN     MAXCLNO-ONE,F2
         IF         CLNO=F2
           PRINT      " "
         ENDIF
         CALL       IFWWH000
         GOTO       INWWH900
.
INWWH990  MOVE      "9,999,999.99",DIM12
          FEDIT     TGSTEXCV,DIM12
.
          MATCH     "************",DIM12
          IF        @EQUAL
            MOVE      TGSTEXCV,F9P2
            MOVE      F9P2,DIM12
          ENDIF
.
          MOVE      "999,999.99",DIM10TAX
          FEDIT     TGSTAMNT,DIM10TAX  
.
          MATCH     "**********",DIM10TAX
          IF        @EQUAL
            MOVE      TGSTAMNT,F7P2
            MOVE      F7P2,DIM10TAX
          ENDIF
.
          MOVE      "9,999,999.99",TOTDIM12
          FEDIT     TOTINV,TOTDIM12  
.
          MATCH     "************",TOTDIM12
          IF        @EQUAL
            MOVE      TOTINV,F9P2
            MOVE      F9P2,TOTDIM12
          ENDIF
.
          IF        TMPLTFLG=0
            PRINT     *N,*1,"INVOICE TOTAL",*46,DIM12:
                      *58,DIM10TAX,*68,TOTDIM12
            ADD       TWO,CLNO
.
            MOVE      "999,999,999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "999,999,999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "999,999,999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
           MOVE       ONE,HEADTAIL    * Flagged to Tail
           CALL       XINV0000      * Print Tax Invoice Tail
           PRINT      " "
           GOTO       INWWH999
         ENDIF
.
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         PRINT      *N,*N,*65,TOTINV:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*53,DBFHDEB,*68,F12:
                    *N,*12,NADLINE1,*N,*N,*N:
                    *N,*N,*65,TOTINV
.
INWWH999 RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFWWH000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      ONE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFWWH100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFWWH900
          ENDIF
.
IFWWH100  PRINT     *N,*N,*69,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N
IFWWH900  CALL      IHWWH000
.
IFWWH999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHWWH000 ADD        ONE,CPAGENO
         MOVE       ZERO,CLNO
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
.
. Determine whether to use Tax Invoice Templating
.
         IF         TMPLTFLG=0
           MOVE       ZERO,HEADTAIL   * Flagged to Header
           CALL       XINV0000      * Print Tax Invoice Header
           GOTO       IHWWH999
         ENDIF
.
         PRINT      *N,*N,*60,"INVOICE",*N,*N,*N:
                    *N,*51,F12,*70,CPCDATE:
                    *N,*N,*N,*N:
                    *N,*12,NADLINE1:
                    *N,*12,NADLINE2:
                    *N,*12,NADLINE3:
                    *N,*12,NADLINE4:
                    *N,*12,NADLINE5:
                    *N:
                    *N,*N,*N,*N,*4,DBFHDEB:
                    *N,*N,*N
.
IHWWH999 RETURN
.
.------------------------------------------------------------------------------
. Lineup print for invoices Hutt Valley
.------------------------------------------------------------------------------
LNHUT000 CALL       OPNPRINT
         PRINT      *N,*N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*2,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*2,"000000",*69,"000000000000":
                    *N,*N,*N,*69,"00/00/0000":
                    *N,*N,*N,*N:
                    *N,*2,"XXXXXXXXXX":
                    *12,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *42,"00000.00",*51,"XXXX":
                    *59,"0000000.00",*71,"0000000.00":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*N,*71,"0000000.00":
                    *N,*N,*N,*N:
                    *N,*71,"0000000.00":
                    *N,*N,*2,"00/00/00",*13,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*13,"000000",*25,"000000":
                    *N,*N,*N,*N,*N,*N,*N
         CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LNHUT000 IF EQUAL
         RETURN
.------------------------------------------------------------------------------
. Print invoices Hutt Valley
.------------------------------------------------------------------------------
INHUT000 MOVE       ZERO,TOTINV
         MOVE       ZERO,CPAGENO
.
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IHHUT000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
INHUT100 CALL       RKDBFD1
         BRANCH     OVRCD,INHUT900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       INHUT900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       INHUT900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       INHUT900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       "99999.99",QTYDIM8
         FEDIT      DBFDQTY,QTYDIM8
         IF         DBFDQTY=0
           MOVE       SP70,QTYDIM8
           MOVE       SP70,DBITUNT
         ENDIF
.
         MOVE       "99999999.9999",PRIDIM13
         FEDIT      DBFDPRI,PRIDIM13
         IF         DBFDPRI=0
           MOVE       SP70,PRIDIM13
         ENDIF
 
         MOVE       "99,999,999.99",TOTDIM13
         ASSIGN     DBFDTAX+DBFDTOT,F12P2
         FEDIT      F12P2,TOTDIM13
         IF         F12P2=0
           MOVE       SP70,TOTDIM13
         ENDIF
         ADD        F12P2,TOTINV
.
         MOVE       DBITIDE,KEY28
         PRINT      CPCDATE,*12,KEY28:
                    *40,QTYDIM8,SP1,DBITUNT,PRIDIM13,TOTDIM13
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFHUT000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
.
         MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *12,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    "28",CLNO
           CALL       IFHUT000 IF EQUAL
         ENDIF 
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
INHUT150 CALL       RKDBFN1
         BRANCH     OVRCD,INHUT100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       INHUT100 IF NOT EQUAL
.
         PRINT      *12,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    "28",CLNO
         CALL       IFHUT000 IF EQUAL
.
         GOTO       INHUT150
.
INHUT900 COMPARE    "27",CLNO
         GOTO       INHUT990 IF EQUAL
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       INHUT900
.
INHUT990 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *N,*N:
                    *N,*N,*20,DBTEDES,*64,TOTINV:
                    *N,*N,*N,*N:
                    *N,*64,TOTINV:
                    *N,*N,*2,CPDATE,*13,NADLINE1:
                    *N,*N,*N,*12,DBFHDEB,*20,F12:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N
         RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFHUT000 UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         PRINT      *N,*N,*N:
                    *N,*N,*N,*N:
                    *N,*2,DBTEDES,*68,"CARRIED FWD":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N
         CALL       IHHUT000
         RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHHUT000 ADD        ONE,CPAGENO
         PRINT      *N,*N,*N,*N,*N:
                    *N,*2,NADLINE1:
                    *N,*2,NADLINE2:
                    *N,*2,NADLINE3:
                    *N,*2,NADLINE4:
                    *N,*2,NADLINE5:
                    *N,*N
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
         PRINT      *2,DBFHDEB,*67,F12:
                    *N,*N,*N,*69,CPCDATE:
                    *N,*N,*N,*N
         MOVE       ZERO,CLNO
         RETURN
.------------------------------------------------------------------------------
. Lineup print for invoices Ballarat Health Services
.------------------------------------------------------------------------------
LNBHS000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          IF        TMPLTFLG=0
            CALL      XSET0000      * Set Variables value for lineup
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            PRINT     *N;
.
            MOVE      ZERO,CLNO
            MOVE      "9999999.99",DIM10TOT
            MOVE      "999999.99",DIM9TAX
            MOVE      "999999.99",DIM9GRN
.
            PRINT     CPDATE,*12,DIM8QTY:
                      *21,DBITUNT,*26,DIM10PRI,*37,DBITIDE:
                      *74,DIM10TOT,*85,DIM9TAX,*95,DIM9GRN;
            CALL      RSBHS000      * print on the right side
.
            MOVE      MAXCLNO,F2 
            SUB       TWO,MAXCLNO
            PACK      DBDBDEB,X70
            MOVE      ONE,OVRCD
            CALL      RSBHS000      * print on the right side
            MOVE      F2,MAXCLNO 
.
            MOVE      "9999999.99",DIM10
.
            PRINT     *N,*74,DIM10:
                      *85,DIM9TAX,*95,DIM9GRN
.
            IF        TMPLTFLG=0
              MOVE      "99999999999.99",FTOTINV
              MOVE      "99999999999.99",FTGSTEXC
              MOVE      "99999999999.99",FTGSTAMN
.
              MOVE      ONE,HEADTAIL  * Flagged to Tail
              CALL      XINV0000      * Print Tax Invoice Tail
              PRINT     " "
            ENDIF
            GOTO      LNBHS900
          ENDIF
.
          PRINT     *82,"TAX INVOICE",*N,*N,*N,*N:
                    *N,*76,"999999999999",*93,"99/99/9999":
                    *N,*N,*N,*N,*N:
                    *N,*15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*15,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*2,"XXXXXXXX":
                    *N,*N,*N,*N,*N:
.
                    "99/99/99",*12,"9,999.99":
                    *21,"XXXX",*26,"999,999.99":
                    *37,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *74,"9999999.99",*85,"999999.99",*95,"999999.99":
.
                    *114,"XXXXXXXX":
                    *N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N:
                    *120,"999999999999":
                    *N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N:
                    *118,"999,999,999.99":
                    *N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N:
                    *N,*N,*74,"9999999.99",*85,"999999.99",*95,"999999.99":
                    *N,*N,*93,"99999999.99":
                    *N,*N
.
LNBHS900  CALL      CLSPRINT
          CALL      LOKYN000
          COMPARE   ZERO,FYESNO
          GOTO      LNBHS000 IF EQUAL
.
LNBHS999  RETURN
.------------------------------------------------------------------------------
. Print invoices Ballarat Health Services
.------------------------------------------------------------------------------
INBHS000  MOVE      ZERO,TOTINV
          MOVE      ZERO,TGSTEXCV                                              
          MOVE      ZERO,TGSTAMNT 
          MOVE      ZERO,CPAGENO
.
          CALL      STMPL000         * Set up for Templating
          CALL      FORAD000         * Format Name & Address into 5 Lines
          CALL      IHBHS000         * Print Invoice Heading
          CALL      CTIBP000         * Calculate Total Invoice before process
.
          PACK      KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
          CALL      RSDBFD1
INBHS100  CALL      RKDBFD1
          BRANCH    OVRCD,INBHS900
          MATCH     DBFHDEB,DBFDDEB
          GOTO      INBHS890 IF NOT EQUAL
          MATCH     DBFHDTY,DBFDDTY
          GOTO      INBHS890 IF NOT EQUAL
          MATCH     DBFHDOC,DBFDDOC
          GOTO      INBHS890 IF NOT EQUAL
.
          PACK      KEY8,DBFDITM
          CALL      RDDBIT1        * Read Sales Item Details
.
          UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          MOVE      "9,999.99",DIM8QTY
          FEDIT     DBFDQTY,DIM8QTY
          IF        DBFDQTY=0
            MOVE      SP70,DIM8QTY
            MOVE      SP70,DBITUNT
          ENDIF
.
          MOVE      "999,999.99",DIM10PRI
          MOVE      DBFDPRI,F12P2
          FEDIT     F12P2,DIM10PRI
          IF        F12P2=0
            MOVE      SP70,DIM10PRI
          ENDIF
.
          MOVE      "9999999.99",DIM10TOT
          FEDIT     DBFDTOT,DIM10TOT
          IF        DBFDTOT=0
            MOVE      SP70,DIM10TOT
          ENDIF
          ADD       DBFDTOT,TGSTEXCV
.
..          MOVE      "999,999,999.99",DIM14TAX
          MOVE      "999999.99",DIM9TAX
          FEDIT     DBFDTAX,DIM9TAX
          IF        DBFDTAX=0
            MOVE      SP70,DIM9TAX
          ENDIF
          ADD       DBFDTAX,TGSTAMNT
.
          ASSIGN    DBFDTAX+DBFDTOT,F12P2
..          MOVE      "999,999,999.99",DIM14GRN
          MOVE      "999999.99",DIM9GRN
          FEDIT     F12P2,DIM9GRN
          IF        F12P2=0
            MOVE      SP70,DIM9GRN
          ENDIF
          ADD       F12P2,TOTINV
.
          PRINT     CPDATE,*12,DIM8QTY:
                    *21,DBITUNT,*26,DIM10PRI,*37,DBITIDE:
                    *74,DIM10TOT,*85,DIM9TAX,*95,DIM9GRN;
          ADD       ONE,CLNO
.
          CALL      RSBHS000        * print on the right side
.
          COMPARE   MAXCLNO,CLNO
          CALL      IFBHS000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
          MATCH     SP70,DBFDDREF
          IF        !@EQUAL
            PRINT     *12,DBFDDREF;
            ADD       ONE,CLNO
.
            CALL      RSBHS000      * print on the right side
.
            COMPARE   MAXCLNO,CLNO
            CALL      IFBHS000 IF EQUAL
          ENDIF 
.
          PACK      KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
          CALL      RSDBFN1
INBHS150  CALL      RKDBFN1
          BRANCH    OVRCD,INBHS100
          PACK      KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
          PACK      KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
          MATCH     KEY24,KEY27
          GOTO      INBHS100 IF NOT EQUAL
.
          PRINT     *12,DBFNCOM;
          ADD       ONE,CLNO
.
          CALL      RSBHS000        * print on the right side
.
          COMPARE   MAXCLNO,CLNO
          CALL      IFBHS000 IF EQUAL
          GOTO      INBHS150
.
INBHS890  MOVE      ONE,OVRCD
.
INBHS900  ADD       ONE,CLNO
          CALL      RSBHS000        * print on the right side
.
..          MOVE      "999,999,999.99",DIM14
          MOVE      "9999999.99",DIM10
          FEDIT     TGSTEXCV,DIM10
.
          MATCH     "*********",DIM10  
          IF        @EQUAL
            MOVE      TGSTEXCV,F7P2
            MOVE      F7P2,DIM10
          ENDIF
.
..          MOVE      "999,999,999.99",DIM14TAX
          MOVE      "999999.99",DIM9TAX
          FEDIT     TGSTAMNT,DIM9TAX  
.
          MATCH     "*********",DIM9TAX  
          IF        @EQUAL
            MOVE      TGSTAMNT,F6P2
            MOVE      F6P2,DIM9TAX
          ENDIF
.
          MOVE      "99999999999.99",DIM14GRN
          FEDIT     TOTINV,DIM14GRN
          MOVE      "999999.99",DIM9GRN
          FEDIT     TOTINV,DIM9GRN  
.
          MATCH     "*********",DIM9GRN  
          IF        @EQUAL
            MOVE      TOTINV,F6P2
            MOVE      F6P2,DIM9GRN
          ENDIF
.
          PRINT     *N,*N,*74,DIM10:
                    *85,DIM9TAX,*95,DIM9GRN
          ADD       TWO,CLNO
.
          IF        TMPLTFLG=0
            MOVE      "99999999999.99",FTOTINV 
            FEDIT     TOTINV,FTOTINV
.
            MOVE      "99999999999.99",FTGSTEXC
            FEDIT     TGSTEXCV,FTGSTEXC
.
            MOVE      "99999999999.99",FTGSTAMN
            FEDIT     TGSTAMNT,FTGSTAMN
.
            MOVE      ONE,HEADTAIL    * Flagged to Tail
            CALL      XINV0000      * Print Tax Invoice Tail
            PRINT     " "
            GOTO      INBHS999
          ENDIF
.
          PRINT     *N,*90,DIM14GRN:
                    *N,*N
          GOTO      INBHS999
.
INBHS980  CALL      IFBHS000
          GOTO      INBHS900
.
INBHS999  RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
IFBHS000  IF        TMPLTFLG=0
            MOVE      CRFWDROW,F3
            MOVE      THREE,CURRROW
            CALL      XPOS0000
            BRANCH    EXIT,IFBHS100
.
            PRINT     *CRFWDCOL,*+,"CARRIED FWD";
.
            MOVE      TAILLENG,F3
            CALL      XPOS0000
            PRINT     *N;
            GOTO      IFBHS900
          ENDIF
.
IFBHS100  PRINT     *N,*N,*N,*N,*93,"CARRIED FWD":
                    *N,*N
IFBHS900  CALL      IHBHS000
.
IFBHS999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IHBHS000  ADD       ONE,CPAGENO
          MOVE      ZERO,CLNO
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDOC,F12
.
. Determine whether to use Tax Invoice Templating
.
          IF        TMPLTFLG=0
            MOVE      ZERO,HEADTAIL   * Flagged to Header
            CALL      XINV0000      * Print Tax Invoice Header
            CALL      RSBHS000      * print on the right side
            GOTO      IHBHS999
          ENDIF
.
          PRINT     *82,"TAX INVOICE",*N,*N,*N,*N:
                    *N,*76,F12,*93,CPCDATE:
                    *N,*N,*N,*N,*N:
                    *N,*15,NADLINE1:
                    *N,*15,NADLINE2:
                    *N,*15,NADLINE3:
                    *N,*15,NADLINE4:
                    *N,*15,NADLINE5:
                    *N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*2,DBFHDEB:
                    *N,*N
          CALL      RSBHS000      * print on the right side
.
IHBHS999  RETURN
.------------------------------------------------------------------------------
. Print something on the right hand side of Stationery
. Requires : OVERCD = 1 - loop thru until MAXCLNO reach
.                     0 - just find the appropriate position to print
.------------------------------------------------------------------------------
RSBHS000  COMPARE   ZERO,CLNO
          GOTO      RSBHS020 IF EQUAL
.
          COMPARE   THREE,CLNO
          GOTO      RSBHS040 IF EQUAL
.
          COMPARE   TEN3,CLNO
          GOTO      RSBHS060 IF EQUAL
.
          COMPARE   TWENTY3,CLNO
          GOTO      RSBHS080 IF EQUAL
.
          COMPARE   MAXCLNO,CLNO
          GOTO      RSBHS010 IF NOT LESS
.
          PRINT     *133," "
RSBHS010  BRANCH    OVRCD,RSBHS990
          GOTO      RSBHS999
.
RSBHS020  PRINT     *114," ":
                    *N
          ADD       TWO,CLNO
          BRANCH    OVRCD,RSBHS000
          GOTO      RSBHS999
.
RSBHS040  PRINT     *114,DBFHDEB
          BRANCH    OVRCD,RSBHS990
          GOTO      RSBHS999
.
RSBHS060  PRINT     *120,F12
          BRANCH    OVRCD,RSBHS990
          GOTO      RSBHS999
.
RSBHS080  MOVE      "999,999,999.99",PRBALANC
          FEDIT     SVTOTALS,PRBALANC
.
          PRINT     *118,PRBALANC
          BRANCH    OVRCD,RSBHS990
          GOTO      RSBHS999
.
RSBHS990  ADD       ONE,CLNO
.
          COMPARE   MAXCLNO,CLNO
          GOTO      RSBHS999 IF NOT LESS
          GOTO      RSBHS000
.
RSBHS999  RETURN
.------------------------------------------------------------------------------
. Lineup print for invoices 132 Columns
.------------------------------------------------------------------------------
LN132000  CALL      OPNPRINT
.
          CALL      STMPL000        * Set up for Templating
          CALL      XSET0000      * Set Variables value for lineup
          MOVE      ZERO,HEADTAIL   * Flagged to Header
          CALL      XINV0000      * Print Tax Invoice Header
.
          PRINT     CPCDATE,*20,DIM4QTY:
                    *27,KEY28,*83,DIM10PRI,*92,DIM12TOT:
                    *107,DIM10TAX,*121,TOTDIM12
.
          PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N
.
          PRINT     *N,*27,"INVOICE TOTAL",*92,DIM12:
                    *107,DIM10TAX,*121,TOTDIM12:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N
.
          MOVE      ONE,HEADTAIL  * Flagged to Tail
          CALL      XINV0000      * Print Tax Invoice Tail
          PRINT     " "
.
LN132900 CALL       CLSPRINT
         CALL       LOKYN000
         COMPARE    ZERO,FYESNO
         GOTO       LN132000 IF EQUAL
.
LN132999 RETURN
.------------------------------------------------------------------------------
. Print invoices 132 Columns 
.------------------------------------------------------------------------------
IN132000 MOVE       ZERO,TOTINV
         MOVE       ZERO,TGSTEXCV                                              
         MOVE       ZERO,TGSTAMNT 
         MOVE       ZERO,CPAGENO
.
         CALL       STMPL000        * Set up for Templating
         CALL       FORAD000        * Format Name & Address into 5 Lines
         CALL       IH132000         * Print Invoice Heading
.
         PACK       KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
         CALL       RSDBFD1
IN132100 CALL       RKDBFD1
         BRANCH     OVRCD,IN132900
         MATCH      DBFHDEB,DBFDDEB
         GOTO       IN132900 IF NOT EQUAL
         MATCH      DBFHDTY,DBFDDTY
         GOTO       IN132900 IF NOT EQUAL
         MATCH      DBFHDOC,DBFDDOC
         GOTO       IN132900 IF NOT EQUAL
.
         PACK       KEY8,DBFDITM
         CALL       RDDBIT1        * Read Sales Item Details
.
         UNPACK     DBFDSDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
.
         MOVE       DBFDQTY,F4P2
         MOVE       "9999.99",DIM7QTY
         FEDIT      F4P2,DIM7QTY
         IF         DBFDQTY=0
           MOVE       SP70,DIM7QTY
           MOVE       SP70,DBITUNT
         ENDIF
.
         MOVE       DBFDPRI,F5P2
         MOVE       "999,999.99",DIM10PRI
         MOVE       DBFDPRI,F12P2
         FEDIT      F12P2,DIM10PRI
         IF         F12P2=0
           MOVE       SP70,DIM10PRI
         ENDIF
.
         MOVE       "9,999,999.99",DIM12TOT
         FEDIT      DBFDTOT,DIM12TOT
         IF         DBFDTOT=0
           MOVE       SP70,DIM12TOT
         ENDIF
         ADD        DBFDTOT,TGSTEXCV
.
         MOVE       "999,999.99",DIM10TAX
         FEDIT      DBFDTAX,DIM10TAX
         IF         DBFDTAX=0
           MOVE       SP70,DIM10TAX
         ENDIF
         ADD        DBFDTAX,TGSTAMNT
.
         ASSIGN     DBFDTAX+DBFDTOT,F12P2
         MOVE       "9,999,999.99",TOTDIM12
         FEDIT      F12P2,TOTDIM12
         IF         F12P2=0
           MOVE       SP70,TOTDIM12
         ENDIF
         ADD        F12P2,TOTINV
.
         PRINT      CPCDATE,*17,DIM7QTY:
                    *27,DBITIDE,*83,DIM10PRI,*92,DIM12TOT:
                    *107,DIM10TAX,*121,TOTDIM12
.
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IF132000 IF EQUAL
.
. Print invoice Detail lines
.----------------------------
IN132140 MATCH      SP70,DBFDDREF
         IF         !@EQUAL
           PRINT      *27,DBFDDREF
           ADD        ONE,CLNO
           COMPARE    MAXCLNO,CLNO
           CALL       IF132000 IF EQUAL
         ENDIF
.
         PACK       KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         CALL       RSDBFN1
IN132150 CALL       RKDBFN1
         BRANCH     OVRCD,IN132100
         PACK       KEY24,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
         PACK       KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,SP70
         MATCH      KEY24,KEY27
         GOTO       IN132100 IF NOT EQUAL
.
         PRINT      *27,DBFNCOM
         ADD        ONE,CLNO
         COMPARE    MAXCLNO,CLNO
         CALL       IF132000 IF EQUAL
         GOTO       IN132150
.
IN132900 ASSIGN     MAXCLNO-TWO,F2
         COMPARE    F2,CLNO
         GOTO       IN132990 IF EQUAL
         GOTO       IN132980 IF NOT LESS
.
         PRINT      " "
         ADD        ONE,CLNO
         GOTO       IN132900
.
IN132980 ASSIGN     MAXCLNO-ONE,F2
         IF         CLNO=F2
           PRINT      " "
         ENDIF
         CALL       IF132000
         GOTO       IN132900
.
IN132990  MOVE      "9,999,999.99",DIM12
          FEDIT     TGSTEXCV,DIM12
.
          MATCH     "************",DIM12
          IF        @EQUAL
            MOVE      TGSTEXCV,F9P2
            MOVE      F9P2,DIM12
          ENDIF
.
          MOVE      "999,999.99",DIM10TAX
          FEDIT     TGSTAMNT,DIM10TAX  
.
          MATCH     "**********",DIM10TAX
          IF        @EQUAL
            MOVE      TGSTAMNT,F7P2
            MOVE      F7P2,DIM10TAX
          ENDIF
.
          MOVE      "9,999,999.99",TOTDIM12
          FEDIT     TOTINV,TOTDIM12  
.
          MATCH     "************",TOTDIM12
          IF        @EQUAL
            MOVE      TOTINV,F9P2
            MOVE      F9P2,TOTDIM12
          ENDIF
.
          PRINT     *N,*27,"INVOICE TOTAL",*92,DIM12:
                    *107,DIM10TAX,*121,TOTDIM12:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N
          ADD       TEN1,CLNO
.
          MOVE      "999,999,999.99",FTOTINV 
          FEDIT     TOTINV,FTOTINV
.
          MOVE      "999,999,999.99",FTGSTEXC
          FEDIT     TGSTEXCV,FTGSTEXC
.
          MOVE      "999,999,999.99",FTGSTAMN
          FEDIT     TGSTAMNT,FTGSTAMN
.
          MOVE       ONE,HEADTAIL    * Flagged to Tail
          CALL       XINV0000      * Print Tax Invoice Tail
          PRINT      " "
          GOTO       IN132999
.
IN132999 RETURN
.------------------------------------------------------------------------------
. Carried forward
.------------------------------------------------------------------------------
.IF132000  PRINT     *N,*N,*122,"CARRIED FWD",*N,*N,*N,*N,*N,*N
IF132000  PRINT     *122,"CARRIED FWD",*N,*N,*N,*N,*N
          MOVE      ONE,CARRIED
          MOVE      ONE,HEADTAIL
          CALL      XINV0000
          PRINT     " "
.
IF132900  CALL      IH132000
.
IF132999  RETURN
.------------------------------------------------------------------------------
. Print Header for invoice 
.------------------------------------------------------------------------------
IH132000 ADD        ONE,CPAGENO
         MOVE       ZERO,CLNO
         UNPACK     DBFHDDAT,CCENT,CYEAR,CMON,CDAY
         CALL       PACDATE
         MOVE       DBFHDOC,F12
.
. Determine whether to use Tax Invoice Templating
.
         MOVE       ZERO,HEADTAIL   * Flagged to Header
         CALL       XINV0000      * Print Tax Invoice Header
         GOTO       IH132999
.
IH132999 RETURN
.
.------------------------------------------------------------------------------
. Calculate Total Invoice before start printing process
.------------------------------------------------------------------------------
CTIBP000  MOVE      ZERO,SVTOTALS
.
          PACK      KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
          CALL      RSDBFD1
CTIBP100  CALL      RKDBFD1
          BRANCH    OVRCD,CTIBP999
.
          MATCH     DBFHDEB,DBFDDEB
          GOTO      CTIBP999 IF NOT EQUAL
.
          MATCH     DBFHDTY,DBFDDTY
          GOTO      CTIBP999 IF NOT EQUAL
.
          MATCH     DBFHDOC,DBFDDOC
          GOTO      CTIBP999 IF NOT EQUAL
.
          ASSIGN    DBFDTAX+DBFDTOT,F12P2
          ADD       F12P2,SVTOTALS
          GOTO      CTIBP100
.
CTIBP999  RETURN
.------------------------------------------------------------------------------
. Set Template Files
. Checks whether Template being used
. Find appropriate position for carried forward
. Returns  : TMPLTFLG : 0 - do template, 1 - don't template
.            CRFWDROW
.            CRFWDCOL
.------------------------------------------------------------------------------
STMPL000  MOVE      ONE,TMPLTFLG
.
          MATCH     "000000",CFDBIVHD
          GOTO      STMPL050 IF EQUAL
.
          MATCH     SP6,CFDBIVHD
          GOTO      STMPL100 IF NOT EQUAL
.
STMPL050  MATCH     "000000",CFDBIVTL
          GOTO      STMPL999 IF EQUAL
.
          MATCH     SP6,CFDBIVTL
          GOTO      STMPL999 IF EQUAL
.
STMPL100  PACK      KEY6,CFDBIVHD,SP70
          CALL      RDIBTH1               * read header detail file
          BRANCH    OVRCD,STMPL900
.
          MOVE      IBTHLENG,HEADLENG
.
          PACK      KEY6,CFDBIVTL,SP70
          CALL      RDIBTH1               * read header detail file
          BRANCH    OVRCD,STMPL910
.
          MOVE      IBTHLENG,TAILLENG
.
          MOVE      SIXTY6,CRFWDCOL
          PACK      KEY12,CFDBIVTL,SP70
          CALL      RSIBDET1              * read detail file
STMPL200  CALL      RKIBDET1              * read detail file
          BRANCH    OVRCD,STMPL990
.
          MATCH     IBTHSCOD,IBDTSCOD
          GOTO      STMPL990 IF NOT EQUAL
.
          COMPARE   TWO,IBDTINDC
          GOTO      STMPL200 IF NOT EQUAL
.
          UNPACK    IBDTTXFL,D5
          MOVE      "    8",DIM5
          MATCH     DIM5,D5
          IF        @EQUAL
            MOVE      IBDTCOL,CRFWDCOL
            ADD       THREE,CRFWDCOL
            GOTO      STMPL250
          ENDIF
.
          MOVE      "    1",DIM5
          MATCH     DIM5,D5
          IF        @EQUAL
            MOVE      IBDTCOL,CRFWDCOL
            ADD       FOUR,CRFWDCOL
            GOTO      STMPL250
          ENDIF
          GOTO      STMPL200
.
STMPL250  MOVE      IBDTROW,CRFWDROW
          GOTO      STMPL990
.
.------ stationery code not on file ------
.
STMPL900  MOVE     "User Defined Stationery Header Code not on File. - ",DISPMSG
          CALL      MESSAGE1
          BEEP
          GOTO      STMPL999
.
STMPL910  MOVE      "User Defined Stationery Tail Code not on File. - ",DISPMSG
          CALL      MESSAGE1
          BEEP
          GOTO      STMPL999
.
STMPL990  MOVE      ZERO,TMPLTFLG
.
STMPL999  RETURN
.------------------------------------------------------------------------------
. Print Tax Invoice Header for All Sites
. Requires : HEADTAIL : 0 - Head , 1 - Tail
.------------------------------------------------------------------------------
XINV0000  MOVE      ONE,CURRROW              * Initialise current row counter
.
          IF        HEADTAIL=0
            PACK      KEY6,CFDBIVHD,SP70
            CALL      RDIBTH1               * read header detail file
.
            PACK      KEY12,CFDBIVHD,SP70
          ELSE
            PACK      KEY6,CFDBIVTL,SP70
            CALL      RDIBTH1               * read header detail file
.
            PACK      KEY12,CFDBIVTL,SP70
          ENDIF
          CALL      RSIBDET1
          CALL      RKIBDET1
          BRANCH    OVRCD,XINV8000
.
          IF        HEADTAIL=0
            MATCH     CFDBIVHD,IBDTSCOD        * Same form ?
            GOTO      XINV8000 IF NOT EQUAL    * No - pad out rest of form
            GOTO      XINV0100
          ELSE
            MATCH     CFDBIVTL,IBDTSCOD        * Same form ?
            GOTO      XINV8000 IF NOT EQUAL    * No - pad out rest of form
            GOTO      XINV0100
          ENDIF
.
XINV0100  COMPARE   CURRROW,IBDTROW          * Current row up to required row ?
          GOTO      XINV0400 IF EQUAL        * Yes - print data
          PRINT     *N;                      * Else print 1 extra line
          ADD       ONE,CURRROW              * Increment counter
          GOTO      XINV0100                 * Check counter again
.
. ------- Read through the details file -------
.
XINV0200  CALL      RKIBDET1                 * Read next detail record
          BRANCH    OVRCD,XINV8000           * No more records - pad out form
.
          BRANCH    HEADTAIL,XINV0250        * Header or Tail ?
.
          MATCH     CFDBIVHD,IBDTSCOD        * Same form ?
          GOTO      XINV8000 IF NOT EQUAL    * No - pad out rest of form
          GOTO      XINV0300
.
XINV0250  MATCH     CFDBIVTL,IBDTSCOD        * Same form ?
          GOTO      XINV8000 IF NOT EQUAL    * No - pad out rest of form
.
XINV0300  COMPARE   CURRROW,IBDTROW          * Are we at the required row ?
          GOTO      XINV0400 IF EQUAL        * Yes - print data
          PRINT     *N;                      * Else pad out to required row
          ADD       ONE,CURRROW              * One more row printed
          GOTO      XINV0300                 * Check row count
.
. ------- Print actual data lines -------
.
XINV0400  BRANCH    IBDTINDC,XINV0500:       * Text field
                             XINV0600        * Data field
.
. ------- Print text field -------
.
XINV0500  RESET     IBDTTXFL,IBDTPLEN
          LENSET    IBDTTXFL
          RESET     IBDTTXFL
          PRINT     *IBDTCOL,*+,IBDTTXFL;    * Print data
          MOVE      IBDTROW,CURRROW          * Row printed is current row
          GOTO      XINV0200                 * Read next record
.
. ------- Print data field -------
.
XINV0600  MOVE      IBDTTXFL,DIM5            * Data number 1st 3 chars of field
          MOVE      DIM5,FORM5               * Move to a FORM field for BRANCH
          PACK      VARIABLE,SP30,SP30,SP30,SP30,SP10  * Initialise variable
.
          BRANCH    HEADTAIL,XINV0650        * Header or Tail ?
.
          BRANCH    FORM5,XINV1010,XINV1020,XINV1030,XINV1040,XINV1050:
                          XINV1060,XINV1070,XINV1080,XINV1090,XINV1100:   10
                          XINV1110,XINV1120,XINV1130,XINV1140,XINV1150:
                          XINV1160,XINV1170,XINV1180,XINV1190,XINV1200:   20
                          XINV1210,XINV1220
          GOTO      XINV0200                 * ignoring, Read next record
.
XINV0650  BRANCH    FORM5,XINV0710,XINV1010,XINV1090,XINV1140,XINV0720:
                          XINV1130,XINV1190,XINV0730,XINV0740,XINV0750:   10
                          XINV0760,XINV0770,XINV0780,XINV0790,XINV1210:
                          XINV0800,XINV0810,XINV1220
          GOTO      XINV0200                 * ignoring, Read next record
.
. Tail Items/Fields below
.
XINV0710  IF        CARRIED=1
            MOVE      " CARRIED FWD",VARIABLE
            MOVE      ZERO,CARRIED
            GOTO      XINV5000
          ELSE
            MOVE      TOTINV,VARIABLE          * Unformated Total Invoice
          ENDIF
          MOVE      TEN5,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      XINV5000
.
XINV0720  MOVE      DBTEDES,VARIABLE         * Terms Code Description
          GOTO      XINV5000
.
XINV0730  IF        CARRIED=1
            MOVE      " CARRIED FWD",VARIABLE
            MOVE      ZERO,CARRIED
            GOTO      XINV5000
          ELSE
            MOVE      FTOTINV,VARIABLE         * Total Formated Invoice Amount
          ENDIF
          GOTO      XINV5000
.
XINV0740  MOVE      BAL3,VARIABLE            * Formated Stat.Amount Bal. 90 days
          GOTO      XINV5000
.
XINV0750  MOVE      BAL2,VARIABLE            * Formated Stat.Amount Bal. 60 days
          GOTO      XINV5000
.
XINV0760  MOVE      BAL1,VARIABLE            * Formated Stat.Amount Bal. 30 days
          GOTO      XINV5000
.
XINV0770  MOVE      CURR,VARIABLE            * Formated Stat. Current Balance
          GOTO      XINV5000
.
XINV0780  MOVE      STAMESS1,VARIABLE        * Statement Message 1
          GOTO      XINV5000
.
XINV0790  MOVE      STAMESS2,VARIABLE        * Statement Message 2
          GOTO      XINV5000
.
XINV0800  MOVE      FTGSTEXC,VARIABLE        * Formated Total GST Exclusive
          GOTO      XINV5000
.
XINV0810  MOVE      FTGSTAMN,VARIABLE        * Formated Total GST Amount
          GOTO      XINV5000
.
. Header Items/Fields below
.
XINV1010  MOVE      DBFHDEB,VARIABLE         * Debtor number
          GOTO      XINV5000
.
XINV1020  MOVE      DBDBNA1,VARIABLE         * Debtor Name 1
          GOTO      XINV5000
.
XINV1030  MOVE      DBDBNA2,VARIABLE         * Debtor Name 2
          GOTO      XINV5000
.
XINV1040  MOVE      DBDBAD1,VARIABLE         * Debtor Address Line 1
          GOTO      XINV5000
.
XINV1050  MOVE      DBDBAD2,VARIABLE         * Debtor Address Line 2
          GOTO      XINV5000
.
XINV1060  MOVE      DBDBAD3,VARIABLE         * Debtor Address Line 3
          GOTO      XINV5000
.
XINV1070  MOVE      DBDBAD4,VARIABLE         * Debtor Address Line 4
          GOTO      XINV5000
.
XINV1080  MOVE      DBDBPC,VARIABLE          * Debtor Post Code
          GOTO      XINV5000
.
XINV1090  MOVE      DBFHDOC,F12              * Invoice number
          MOVE      F12,VARIABLE
          MOVE      TEN2,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      XINV6000
.
XINV1100  MOVE      CPAGENO,VARIABLE         * Page number
          MOVE      THREE,PRNTSTRT
          SUB       IBDTPLEN,PRNTSTRT
          GOTO      XINV6000
.
XINV1110  MATCH     SP70,DISDATE             * Discharge date
          GOTO      XINV0200 IF EQUAL
.
          MOVE      DISDATE,VARIABLE
          MOVE      TEN,IBDTPLEN
          GOTO      XINV5000
.
XINV1120  MATCH     SP70,ADMDATE             * Admission date
          GOTO      XINV0200 IF EQUAL
.
          MOVE      ADMDATE,VARIABLE
          MOVE      TEN,IBDTPLEN
          GOTO      XINV5000
.
XINV1130  UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY    * Invoice date
          CALL      PACDATE
          IF        IBDTPLEN = 10
            MOVE      CPCDATE,VARIABLE
          ELSE
            MOVE      CPDATE,VARIABLE
          ENDIF
          GOTO      XINV5000
.
XINV1140  MOVE      NADLINE1,VARIABLE        * Debtor Name & Address 1
          GOTO      XINV5000
.
XINV1150  MOVE      NADLINE2,VARIABLE        * Debtor Name & Address 2
          GOTO      XINV5000
.
XINV1160  MOVE      NADLINE3,VARIABLE        * Debtor Name & Address 3
          GOTO      XINV5000
.
XINV1170  MOVE      NADLINE4,VARIABLE        * Debtor Name & Address 4
          GOTO      XINV5000
.
XINV1180  MOVE      NADLINE5,VARIABLE        * Debtor Name & Address 5
          GOTO      XINV5000
.
XINV1190  MOVE      DBFHUR1,VARIABLE         * User Def.Ref. 1 (Stat. Reference)
          GOTO      XINV5000
.
XINV1200  MOVE      DBFHUR2,VARIABLE         * User Def.Ref. 2
          GOTO      XINV5000
.
XINV1210  UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY    * Statement date
          CALL      PACDATE
          IF        IBDTPLEN = 10
            MOVE      CPCDATE,VARIABLE
          ELSE
            MOVE      CPDATE,VARIABLE
          ENDIF
          GOTO      XINV5000
.
XINV1220  MOVE      DBFHDOC,F12             * Invoice number
          MOVE      F12,F8
          READ      CONTROLF,HUND18;*249,PTCNURBP  * Use UR number as BPAYINVN?
          MATCH     "1",PTCNURBP
          IF        @EQUAL
            MOVE      PURNO,BPAYINVN
          ELSE
            MOVE      F8,BPAYINVN
          ENDIF
          CALL      GBCRN000                * Generate BPAY CRN
          MOVE      BPAYREFN,VARIABLE
          GOTO      XINV5000
.
. ------- Format the variable -------
.
XINV5000  RESET     VARIABLE,IBDTPLEN
          LENSET    VARIABLE
          RESET     VARIABLE
          PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      XINV0200                 * Read next record
.
. ------- Formatting for Form fields and right justified variables -------
.
XINV6000  COMPARE   ZERO,PRNTSTRT          * Don't bump if printing full length
          GOTO      XINV7000 IF EQUAL
.
          BUMP      VARIABLE,PRNTSTRT      * bump to starting position
.
. ------- Print the variable -------
.
XINV7000  PRINT     *IBDTCOL,*+,VARIABLE;
          GOTO      XINV0200                 * Read next record
.
.------ end of invoice reached ------
.
XINV8000  MOVE      FALSE,EXIT
.
.------ print new-lines until the end of page is reached ------
.
XINV9000  COMPARE   IBTHLENG,CURRROW         * test page length
          GOTO      XINV9999 IF NOT LESS
.
          PRINT     *N;
          ADD       ONE,CURRROW
          GOTO      XINV9000
.
XINV9999  MOVE      ZERO,CLNO                * Set column number
          RETURN                             * Finished
.------------------------------------------------------------------------------
. Position Invoice
. Requires : F3
. Returns  : CURRROW
.            EXIT - 0 Successful, 1 - Error positioning
.------------------------------------------------------------------------------
XPOS0000  MOVE      ZERO,EXIT
          COMPARE   CURRROW,F3               * Current row up to required row ?
          GOTO      XPOS9999 IF EQUAL        * Yes - print data
          GOTO      XPOS9990 IF LESS         * out of the loop
          PRINT     *N;                      * Else print 1 extra line
          ADD       ONE,CURRROW              * Increment counter
          GOTO      XPOS0000                 * Check counter again
.
XPOS9990  MOVE      ONE,EXIT
XPOS9999  RETURN
.------------------------------------------------------------------------------
. Set Variable value for Lineup print 
.------------------------------------------------------------------------------
XSET0000  MOVE      "999999999.99",TOTINV
          MOVE      "999999999.99",SVTOTALS
          PACK      DBTEDES,X70
          MOVE      "999,999,999.99",FTOTINV
          MOVE      "999,999,999.99",FTGSTEXC
          MOVE      "999,999,999.99",FTGSTAMN
          MOVE      "9,999,999.99",PRTOTBAL
          MOVE      "9,999,999.99",BAL1
          MOVE      "9,999,999.99",BAL2
          MOVE      "9,999,999.99",BAL3
          MOVE      "9,999,999.99",CURR
          PACK      STAMESS1,X70
          PACK      STAMESS2,X70
          PACK      DBFHDEB,X70
          PACK      DBDBNA1,X70
          PACK      DBDBNA2,X70
          PACK      DBDBAD1,X70
          PACK      DBDBAD2,X70
          PACK      DBDBAD3,X70
          PACK      DBDBAD4,X70
          PACK      DBDBPC,X70
          MOVE      "999999999999",DBFHDOC
          MOVE      "999",CPAGENO
          MOVE      "99/99/9999",ADMDATE
          MOVE      "99/99/9999",DISDATE
          MOVE      "99999999",DBFHDDAT
          PACK      NADLINE1,X70
          PACK      NADLINE2,X70
          PACK      NADLINE3,X70
          PACK      NADLINE4,X70
          PACK      NADLINE5,X70
          PACK      DBFHUR1,X70
          PACK      DBFHUR2,X70
          MOVE      "99999999",ASATDATE
.
          PACK      DBITUNT,X70
          PACK      DBFDITM,X70
          PACK      DBITIDE,X70
          PACK      DIM35,X70
          MOVE      "9999.99",DIM7
          MOVE      "99999.99",QTYDIM8
          MOVE      "9,999.99",DIM8QTY
          MOVE      "9999",DIM4QTY
          MOVE      "999,999.99",DIM10TOT
          MOVE      "9,999,999.99",DIM12TOT
          MOVE      "999,999.99",DIM10PRI
          MOVE      "99,999.99",DIM9GRN
          MOVE      "999,999,999.99",DIM14GRN
          MOVE      "99,999.99",DIM9TAX
          MOVE      "999,999.99",DIM10TAX
          MOVE      "99,999,999.99",DIM13TAX
          MOVE      "999,999,999.99",DIM14TAX
          MOVE      "999,999.99",DIM10
          MOVE      "999,999.99",DIM10A
          MOVE      "999,999,999.99",DIM14
          MOVE      "999,999,999.99",DIM14A
          MOVE      "999,999,999.99",DIM14B
          MOVE      "99999999.9999",PRIDIM13
          MOVE      "9,999,999.99",TOTDIM12
          MOVE      "99,999,999.99",TOTDIM13
          MOVE      "999,999,999.99",FTGSTEXC
          MOVE      "999,999,999.99",FTGSTAMN
          PACK      KEY20,X70
          PACK      KEY27,X70
          PACK      KEY28,X70
          MOVE      "9999",F4
          MOVE      "999",F3
.
XSET9999  RETURN
.
