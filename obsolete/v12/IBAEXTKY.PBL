.---------------------------------------------------------------------------
.   System    :   IBA Software                       
.   Include   :   IBAEXTKY
.   Routine   :   HIBEXA00 Extension           
.   Return    :           
.-------------------------------------------------------------------------------
HIBEXA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HIBEXA04
          CALL      GSCRN000
          BRANCH    EXIT,HIBEXA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Extension"          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "21",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Debtor"             
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 9",STDCOL04
HIBEXA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,IBEXEXTN
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          CALL      RSIBEXT1
HIBEXA10
          CALL      RKIBEXT1
          BRANCH    OVRCD,HIBEXA15
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HIBEXA12
          CALL      HIBEXA60
          BRANCH    OVRCD,HIBEXA10
HIBEXA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,IBEXEXTN
          DISPLAY   *PSTDCOL02:STDROW,IBEXDESC
          DISPLAY   *PSTDCOL03:STDROW,IBEXDEBT
          COMPARE   MAXITEM,XITEMNO
          GOTO      HIBEXA10 IF NOT EQUAL
HIBEXA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HIBEXA20
          CALL      HSCRI000
          BRANCH    EXIT,HIBEXA30,HIBEXA35,HIBEXA40,HIBEXA45,HIBEXA04:
                              HIBEXA91,HIBEXA50
          GOTO      HIBEXA92
HIBEXA30
          CALL      RKIBEXT1
          BRANCH    OVRCD,HIBEXA85
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          CALL      RPIBEXT1
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HIBEXA10
HIBEXA35
          MOVE      ST1,KEY4 
          CALL      RDIBEXT1
          CALL      RPIBEXT1
          BRANCH    OVRCD,HIBEXA85
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HIBEXA36
          CALL      RPIBEXT1
          BRANCH    OVRCD,HIBEXA37
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HIBEXA36 IF NOT EQUAL
HIBEXA37
          MOVE      ZERO,XITEMNO
          GOTO      HIBEXA10
HIBEXA40
          MOVE      ST1,KEY4 
          CALL      RDIBEXT1
          CALL      RPIBEXT1
          BRANCH    OVRCD,HIBEXA85
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HIBEXA08
HIBEXA45
          CALL      RKIBEXT1
          BRANCH    OVRCD,HIBEXA85
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSIBEXT1
HIBEXA46
          CALL      RPIBEXT1
          BRANCH    OVRCD,HIBEXA47
          PACK      KEY4,IBEXEXTN,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HIBEXA46 IF NOT EQUAL
HIBEXA47
          MOVE      ZERO,XITEMNO
          GOTO      HIBEXA10
HIBEXA50  COMPARE   ZERO,CSEARCH
          GOTO      HIBEXA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HIBEXA08
HIBEXA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HIBEXA08
HIBEXA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HIBEXA61 IF EQUAL
          MATCH     SCHFLD01,IBEXEXTN
          GOTO      HIBEXA72 IF NOT EQUAL
HIBEXA61
          MATCH     SP70,SCHFLD02
          GOTO      HIBEXA62 IF EQUAL
          MATCH     SCHFLD02,IBEXDESC
          GOTO      HIBEXA72 IF NOT EQUAL
HIBEXA62
          MATCH     SP70,SCHFLD03
          GOTO      HIBEXA63 IF EQUAL
          MATCH     SCHFLD03,IBEXDEBT
          GOTO      HIBEXA72 IF NOT EQUAL
HIBEXA63
HIBEXA64
HIBEXA65
HIBEXA66
HIBEXA67
HIBEXA68
HIBEXA69
HIBEXA70
          GOTO      HIBEXA75
HIBEXA72  MOVE      ONE,OVRCD
HIBEXA75  RETURN
HIBEXA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,IBEXEXTN                                               
          CALL      RDIBEXT1
HIBEXA90
.                                                                               
          BEEP
          GOTO      HIBEXA20
HIBEXA91
          MOVE      SP70,IBEXDESC
          MOVE      SP70,IBEXCHRG
          MOVE      ZERO,IBEXETYP
          MOVE      SP70,IBEXDEBT
          MOVE      SP70,IBEXSPAR
          MOVE      SP70,KEY4 
          MOVE      SP70,IBEXEXTN
          GOTO      HIBEXA96
HIBEXA92
          MOVE      SP70,KEY4 
          MOVE      SP70,IBEXEXTN
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,IBEXEXTN                                               
HIBEXA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HIBEXA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   IBA Software                       
.   Include   :   IBAEXTKY
.   Routine   :   KIBEXA00 Keyin Extension           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KIBEXA00 TOPIC     "IBEXEXTN"
          MOVE      UNDLN70,IBEXEXTN
          KEYIN     *PCCOL:CVERT,*DV,IBEXEXTN:                                  
                    *PCCOL:CVERT,*V2LON,IBEXEXTN:                               
                    *PCCOL:CVERT,*DV,IBEXEXTN
.
          ENDSET    IBEXEXTN
          APPEND    SP70,IBEXEXTN
          RESET     IBEXEXTN
.
          MATCH     SP70,IBEXEXTN
          GOTO      KIBEXA90 IF EQUAL
.
          CMATCH    EXITCHAR,IBEXEXTN
          GOTO      KIBEXA95 IF EQUAL
.
          CMATCH    QUEST,IBEXEXTN
          GOTO      KIBEXA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HIBEXA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    IBEXEXTN
          APPEND    SP70,IBEXEXTN
          RESET     IBEXEXTN
.
          MATCH     SP70,IBEXEXTN
          GOTO      KIBEXA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,IBEXEXTN                                
KIBEXA10
          PACK      KEY4,IBEXEXTN                                               
          CALL      RAIBEXT1
          BRANCH    OVRCD,KIBEXA80
          BRANCH    CKEYTYP,KIBEXA75
          CALL      RDIBEXT1
KIBEXA70
          MOVE      ZERO,EXIT
          GOTO      KIBEXA99
KIBEXA75
          MOVE      "Extension Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KIBEXA00
KIBEXA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KIBEXA99,KIBEXA99
          MOVE      "Extension Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KIBEXA00
KIBEXA90
          MOVE      ONE,EXIT
          GOTO      KIBEXA99
KIBEXA95
          MOVE      TWO,EXIT
KIBEXA99 TOPIC    PRGID
          RETURN
