.******************************************************************************
.* Include Name   : STDSCRIO.PBL                                              *
.* Function       : Standard Routines for screen painting                     *
.* Modifications  : 20/04/1994 Whirlpool                                      *
.*                  Removed updflock routine and put in IBAOVRIO              *
.******************************************************************************
.
          INC       SCRFLDIO/INC
          INC       SCRMASIO/INC
          INC       SCRPRGIO/INC
          INC       SCRPSTIO/INC
          INC       SCRSBGIO/INC
          INC       SCRSLTIO/INC
.
.*********************************************************************
.         Display an Item
.         Requires SCRPSTFD values
.*********************************************************************
DISPITEM  MOVE      SCPSROW,CVERT       * Setup Display Position
          MOVE      SCPSCOL,CCOL 
          MOVE      SCPSLEN,LLCNT
          COMPARE   ZERO,LLCNT
          GOTO      DISITM99 IF EQUAL
.
          PACK      DIM2,SP1,SCPSATT
          PACK      ATT,SP70,SP70
          REP       DIM2,ATT
          SETLPTR   ATT,LLCNT
          SETLPTR   VAR,LLCNT
          PUTVAR    VAR,ATT,CCOL,CVERT
.
DISITM99  RETURN
.
.*********************************************************************
.         Get The position of an Item
.         Para's  : FLDID         the variable/field number
.         Returns : EXIT = 1      field not on the screen
.*********************************************************************
GETPOSIT  PACK      KEY20,PRGID,SCRID,FLDID,SP70
          CALL      RSSCPS2
          CALL      RKSCPS2
          BRANCH    OVRCD,GETPOS90
          MATCH     PRGID,SCPSPID
          GOTO      GETPOS90 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      GETPOS90 IF NOT EQUAL
          MATCH     FLDID,SCPSITM
          GOTO      GETPOS90 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL 
          MOVE      ZERO,EXIT
          GOTO      GETPOS99
GETPOS90  MOVE      ONE,EXIT
GETPOS99  RETURN
.
.*********************************************************************
.         Display Screen Background (whole screen)
.*********************************************************************
SBACK000  DISPLAY   *P1:3,*EF
          MOVE      ZERO,EXIT
          PACK      KEY12,PRGID,SCRID,SP70
          CALL      RSSCSB1
SBACK100  CALL      RKSCSB1
          BRANCH    OVRCD,SBACK999
          MATCH     PRGID,SCSBPID
          GOTO      SBACK999 IF NOT EQUAL
          MATCH     SCRID,SCSBSID
          GOTO      SBACK999 IF NOT EQUAL
          MOVE      SCSBLIN,CVERT
          PUTVAR    SCSBDAT,SCSBATT,1,CVERT
          GOTO      SBACK100
SBACK999  RETURN
.
.*********************************************************************
.         Display Screen Background Clear Box (part of screen)
.*********************************************************************
VBACK000  BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,EXIT
          PACK      KEY12,PRGID,SCRID,SP70
          CALL      RSSCSB1
VBACK100  CALL      RKSCSB1
          BRANCH    OVRCD,VBACK999
          MATCH     PRGID,SCSBPID
          GOTO      VBACK999 IF NOT EQUAL
          MATCH     SCRID,SCSBSID
          GOTO      SBACK999 IF NOT EQUAL
          MOVE      SCSBLIN,CVERT
          SETLPTR   SCSBDAT,CRIG
          SETLPTR   SCSBATT,CRIG
          RESET     SCSBDAT,CLEF
          RESET     SCSBATT,CLEF
          PUTVAR    SCSBDAT,SCSBATT,CLEF,CVERT
          GOTO      VBACK100
.
VBACK999  RETURN
.
.*********************************************************************
.         Get Selected Item Details
.*********************************************************************
SELECTED  PACK     KEY20,PRGID,SCRID,SCSLITM,SCSLROW,SCSLCOL
          MOVE     ZERO,EXIT
          CALL     RDSCPS2
          IF       OVRCD=1
            MOVE     ONE,EXIT
          ENDIF
          MOVE     SCPSCOL,CCOL
          MOVE     SCPSROW,CVERT
          RETURN
...........................................................................
