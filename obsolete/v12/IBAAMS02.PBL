.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.05  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.04  09.11.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.03  02.11.1999 Sandra Barcham
.           Make Record Locked message use X
. VF.00.02  03.09.1999 Sandra Barcham
.           Add in Creditors Keyword Search
.           srf 631485
. VF.00.01  28.04.1999 Sandra Barcham
.           Stop depreciation start defaulting to current century
.           srf 631322
.-------------------------------------------------------
F2A       FORM      2
SAVEAQD   DIM       8
SAVEAYR   DIM       4
SAVEAPR   DIM       4
TMPAMT    FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS02
.   Function      :   Asset Maintenance                       
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSACMFD/INC
          INC       AMSCODFD/INC
          INC       AMSCONFD/INC
          INC       AMSDEPDF    
          INC       AMSDEPFD/INC
          INC       AMSDPHFD/INC
          INC       AMSDSFFD/INC
          INC       AMSGILFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSLOHFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.Word Processor File * Scr C1 Fld    15
.
NAMAMAC1  INIT      "Wamac1"
FILAMAC1  DIM       8
.
TAXOPEN   FORM     12.2 * Scr C2 Fld    13
ACCOPEN   FORM     12.2 * Scr C2 Fld    14
STRDEPN   DIM      10 * Scr C2 Fld    15
ADTDESC   DIM      35 * Scr C2 Fld    17
TDTDESC   DIM      35 * Scr C2 Fld    20
TYPDESC   DIM      35 * Scr C2 Fld    58
DPTDESC   DIM      35 * Scr C2 Fld    63
BLDDESC   DIM      35 * Scr C2 Fld    64
SOFDESC   DIM      35 * Scr C2 Fld    67
UC1DESC   DIM      35 * Scr C2 Fld    68
UC2DESC   DIM      35 * Scr C2 Fld    69
UC3DESC   DIM      35 * Scr C2 Fld    70
UC4DESC   DIM      35 * Scr C2 Fld    71
PMTDESC   DIM      35 * Scr I3 Fld    18
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS02"
PRGNAM    INIT      "Asset Maintenance                       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      DEFDATE1
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening amsacmaf";
          OPEN      AMSACMA1,"amsacmaf"
          MOVE      "    3",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudin";
            OPEN      AMSAUDIN,"amsaudin"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudle";
            OPEN      AMSAUDLE,"amsaudle"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudma";
            OPEN      AMSAUDMA,"amsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA2,"amscodaf"
          DISPLAY   *P56:24,"Opening amsdepaf";
          OPEN      AMSDEPA1,"amsdepaf"
          DISPLAY   *P56:24,"Opening amsdphaf";
          OPEN      AMSDPHA1,"amsdphaf"
          DISPLAY   *P56:24,"Opening amsdsfaf";
          OPEN      AMSDSFA1,"amsdsfaf"
          DISPLAY   *P56:24,"Opening amsdsfaf";
          OPEN      AMSDSFA2,"amsdsfaf"
          DISPLAY   *P56:24,"Opening amsgilaf";
          OPEN      AMSGILA1,"amsgilaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA2,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA3,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA4,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA2,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA3,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA4,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA5,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amslohaf";
          OPEN      AMSLOHA1,"amslohaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
.--------------------------------------------------------
. Initialise Wp Filename for Asset Comments                     
.--------------------------------------------------------
          PACK      FILAMAC1,NAMAMAC1,PORT
          REP       " 0",FILAMAC1
          DISPLAY   *P56:24,"Create & Open ",FILAMAC1;
          PREP      TEMPWORD,FILAMAC1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Asset Maintenance Options          
          ENDIF
          MATCH     "C1",SCRID
          IF         @EQUAL
            CALL       PSC1L000   * Modify Asset Details               
          ENDIF
          MATCH     "C2",SCRID
          IF         @EQUAL
            CALL       PSC2L000   * Asset Modification Screen 1        
          ENDIF
          MATCH     "C3",SCRID
          IF         @EQUAL
            CALL       PSC3L000   * Asset Modification Screen 2        
          ENDIF
          MATCH     "I1",SCRID
          IF         @EQUAL
            CALL       PSI1L000   * Insert Screen 1                    
          ENDIF
          MATCH     "I2",SCRID
          IF         @EQUAL
            CALL       PSI2L000   * Insert Screen 2                    
          ENDIF
          MATCH     "I3",SCRID
          IF         @EQUAL
            CALL       PSI3L000   * Leasing Details                    
          ENDIF
          MATCH     "I4",SCRID
          IF         @EQUAL
            CALL       PSI4L000   * Insurance Details                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Asset Maintenance Options          
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Maintenance Options          
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Maintenance Options          
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Maintenance Options          
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Maintenance Options          
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Maintenance Options          
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Maintenance Options          
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Maintenance Options          
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SCI1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SCC1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Modify Asset Details               
.--------------------------------
SCC1L000
SCC1L100
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCC1L200
          CALL      CFC1L000 * Clear Fields
SCC1L300
          CALL      KYC1L000 * Enter Key Fields
          BRANCH    EXIT,SCC1L999,SCC1L999
SCC1L400
          CALL      WPC1L000 * Load any WP Details
SCC1L500
          CALL      LMC1L000 * Load any Batch Details
SCC1L600
          CALL      DFC1L000 * Display Fields
SCC1L700
          CALL      SFC1L000 * Select Fields
          BRANCH    EXIT,SCC1L100,SCC1L100,SCC1L200
SCC1L800
SCC1L900
SCC1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Modify Asset Details               
.-------------------------------------------------------
CFC1L000
          MOVE      SP70,AMMAREG 
          MOVE      SP70,AMMAASS 
CFC1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Modify Asset Details               
.--------------------------------------------------------
KYC1L000
.
KYC1L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMREDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAMREA00
          MOVE      AMREREG,AMMAREG
          BRANCH    EXIT,KYC1L900,KYC1L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAREG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMREDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KYC1L120
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EASST000
          BRANCH    EXIT,KYC1L110,KYC1L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KYC1L999
.
KYC1L900  MOVE      ONE,EXIT
KYC1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Modify Asset Details               
.---------------------------------------------------------
WPC1L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPC1L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPC1L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPC1L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPC1L100
WPC1L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Modify Asset Details               
.---------------------------------------------------------
LMC1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Modify Asset Details               
.---------------------------------------------------------
DFC1L000
          BRANCH   ACCEPT,DFC1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFC1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFC1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFC1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFC1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFC1L010 IF NOT EQUAL
.
          CALL     PSC1L000 * Display Field
          GOTO     DFC1L010
DFC1L900
DFC1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Modify Asset Details               
.---------------------------------------------------------
PSC1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSC1L999,PSC1L999,PSC1L101,PSC1L102:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                           PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L103,PSC1L999
          GOTO     PSC1L999
.
PSC1L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L102
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L103
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSC1L999
PSC1L999
          RETURN
.---------------------------------------------------------
. Selections for : Modify Asset Details               
.---------------------------------------------------------
SFC1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFC1L001  BRANCH   ACCEPT,SFC1L020
.
SFC1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                           SFC1L006,SFC1L006,SFC1L101,SFC1L102:
                            SFC1L103,SFC1L104,SFC1L105,SFC1L106
SFC1L006  BEEP
          GOTO     SFC1L005
SFC1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFC1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFC1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFC1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                           SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L105,SFC1L020
          GOTO     SFC1L020
SFC1L090  MOVE     ZERO,ACCEPT
          GOTO     SFC1L001
.
SFC1L101
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      MODAQU00
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DFC1L000
          GOTO      SFC1L001
.
SFC1L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      MODLOC00
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DFC1L000
          GOTO      SFC1L001
.
SFC1L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      MODLEA00
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFC1L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFC1L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFC1L999
          ENDIF
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFC1L000
          ENDIF
          GOTO      SFC1L001
.
SFC1L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      MODINS00
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFC1L001
.
SFC1L105
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "17",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     "  9",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     "  9",WORDTYPE
            CALL     EDITWORD
          ENDIF
          CALL      PNOTE000
          GOTO     SFC1L001
.
SFC1L106
          CALL      UNLOCKC1
          MOVE      ONE,EXIT
          GOTO      SFC1L999
SFC1L990  MOVE      ONE,EXIT * Exit Char Restart
SFC1L999  RETURN
.--------------------------------
. Screen - Asset Modification Screen 1        
.--------------------------------
SCC2L000
SCC2L100
          MOVE      "C2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCC2L200
          CALL      CFC2L000 * Clear Fields
SCC2L300
          CALL      KYC2L000 * Enter Key Fields
          BRANCH    EXIT,SCC2L999,SCC2L999
SCC2L400
          CALL      WPC2L000 * Load any WP Details
SCC2L500
          CALL      LMC2L000 * Load any Batch Details
SCC2L600
          CALL      DFC2L000 * Display Fields
SCC2L700
          CALL      SFC2L000 * Select Fields
          BRANCH    EXIT,SCC2L100,SCC2L100,SCC2L200
SCC2L800
SCC2L900
SCC2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Modification Screen 1        
.-------------------------------------------------------
CFC2L000
CFC2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Modification Screen 1        
.--------------------------------------------------------
KYC2L000
          MOVE      ZERO,EXIT
          GOTO      KYC2L999
.
KYC2L900  MOVE      ONE,EXIT
KYC2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Modification Screen 1        
.---------------------------------------------------------
WPC2L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPC2L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPC2L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPC2L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPC2L100
WPC2L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Modification Screen 1        
.---------------------------------------------------------
LMC2L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Modification Screen 1        
.---------------------------------------------------------
DFC2L000
          BRANCH   ACCEPT,DFC2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFC2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFC2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFC2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFC2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFC2L010 IF NOT EQUAL
.
          CALL     PSC2L000 * Display Field
          GOTO     DFC2L010
DFC2L900
DFC2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Modification Screen 1        
.---------------------------------------------------------
PSC2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSC2L999,PSC2L999,PSC2L101,PSC2L102:
                            PSC2L103,PSC2L104,PSC2L105,PSC2L106:
                            PSC2L107,PSC2L108,PSC2L109,PSC2L110:
                            PSC2L111,PSC2L112,PSC2L113,PSC2L114:
                            PSC2L115,PSC2L116,PSC2L117,PSC2L118:
                            PSC2L119,PSC2L120,PSC2L121,PSC2L122:
                            PSC2L123,PSC2L124,PSC2L125,PSC2L126:
                            PSC2L127,PSC2L128,PSC2L129,PSC2L130:
                            PSC2L131,PSC2L132,PSC2L133,PSC2L134:
                            PSC2L135,PSC2L136,PSC2L137,PSC2L138:
                            PSC2L139,PSC2L140,PSC2L141,PSC2L142:
                            PSC2L143,PSC2L144,PSC2L145,PSC2L146:
                            PSC2L147,PSC2L148,PSC2L149,PSC2L150:
                            PSC2L151,PSC2L152,PSC2L153,PSC2L154:
                            PSC2L155,PSC2L156,PSC2L999,PSC2L157:
                            PSC2L158,PSC2L999,PSC2L159,PSC2L160:
                            PSC2L999,PSC2L161,PSC2L162,PSC2L163:
                            PSC2L164,PSC2L165,PSC2L166,PSC2L167:
                            PSC2L999,PSC2L999,PSC2L999,PSC2L999:
                           PSC2L999,PSC2L999,PSC2L999,PSC2L999
          GOTO     PSC2L999
.
PSC2L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L102
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L103
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L104
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L105
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L109
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L110
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L111
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L112
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L113
          MOVE      STRDEPN,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L114
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L115
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L116
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L117
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L118
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L119
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L120
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L121
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L122
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L123
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L124
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L125
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L126
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L127
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L128
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L129
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L130
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L131
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L132
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L133
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L134
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L135
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L136
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L137
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L138
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L139
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L140
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L141
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L142
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L143
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L144
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L145
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L146
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L147
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L148
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L149
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L154
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSC2L999
.
PSC2L155
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L156
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L157
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L158
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L159
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L160
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L161
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L162
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L163
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L164
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L165
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L166
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L167
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
PSC2L999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Modification Screen 1        
.---------------------------------------------------------
SFC2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFC2L001  BRANCH   ACCEPT,SFC2L020
.
SFC2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC2L006,SFC2L101,SFC2L102,SFC2L103:
                            SFC2L104,SFC2L105,SFC2L106,SFC2L107:
                            SFC2L108,SFC2L109,SFC2L110,SFC2L111:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L112:
                            SFC2L006,SFC2L113,SFC2L114,SFC2L006:
                            SFC2L115,SFC2L116,SFC2L117,SFC2L118:
                            SFC2L119,SFC2L120,SFC2L121,SFC2L122:
                            SFC2L123,SFC2L124,SFC2L006,SFC2L125:
                            SFC2L126,SFC2L006,SFC2L127,SFC2L128:
                            SFC2L129,SFC2L130,SFC2L131,SFC2L132:
                            SFC2L133,SFC2L134,SFC2L135,SFC2L136:
                            SFC2L137,SFC2L138,SFC2L139,SFC2L140:
                            SFC2L141,SFC2L142,SFC2L143,SFC2L144:
                            SFC2L145,SFC2L146,SFC2L147,SFC2L148:
                            SFC2L149,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                           SFC2L006,SFC2L006,SFC2L006,SFC2L150
SFC2L006  BEEP
          GOTO     SFC2L005
SFC2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFC2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFC2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFC2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC2L020,SFC2L020,SFC2L102,SFC2L103:
                            SFC2L104,SFC2L105,SFC2L106,SFC2L107:
                            SFC2L108,SFC2L109,SFC2L110,SFC2L111:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L112:
                            SFC2L020,SFC2L113,SFC2L114,SFC2L020:
                            SFC2L115,SFC2L116,SFC2L117,SFC2L118:
                            SFC2L119,SFC2L120,SFC2L121,SFC2L122:
                            SFC2L123,SFC2L124,SFC2L020,SFC2L125:
                            SFC2L126,SFC2L020,SFC2L127,SFC2L128:
                            SFC2L129,SFC2L130,SFC2L131,SFC2L132:
                            SFC2L133,SFC2L134,SFC2L135,SFC2L136:
                            SFC2L137,SFC2L138,SFC2L139,SFC2L140:
                            SFC2L141,SFC2L142,SFC2L143,SFC2L144:
                            SFC2L145,SFC2L146,SFC2L147,SFC2L148:
                            SFC2L149,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                           SFC2L020,SFC2L020,SFC2L020,SFC2L020
          GOTO     SFC2L020
SFC2L090  MOVE     ZERO,ACCEPT
          GOTO     SFC2L001
.
SFC2L101
          CALL      CSC20000
          MOVE      ZERO,EXIT
          GOTO      SFC2L999
.
SFC2L102
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     AMMADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMADES 
          SFORMAT   VAR,127
          ENDSET    AMMADES 
          APPEND    SP70,AMMADES 
          RESET     AMMADES 
          CMATCH    EXITCHAR,AMMADES 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L102
            ENDIF
          ENDIF
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L103
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DPTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDPT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L103
            ENDIF
            BRANCH    EXIT,SFC2L103,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DPTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L104
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,BLDDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBLD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L104
            ENDIF
            BRANCH    EXIT,SFC2L104,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      BLDDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L105
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMLODES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELOC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L105
            ENDIF
            BRANCH    EXIT,SFC2L105,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMLODES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L106
          CALL     SELECTED
          STRIP     AMMALCM 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMALCM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMALCM 
          SFORMAT   VAR,127
          ENDSET    AMMALCM 
          APPEND    SP70,AMMALCM 
          RESET     AMMALCM 
          CMATCH    EXITCHAR,AMMALCM 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMALCM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L106
            ENDIF
          ENDIF
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMASEC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L108
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMALEA 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L109
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAREN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAPRI 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAPRI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L110
            ENDIF
          ENDIF
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L111
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMARDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L112
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ADTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EADT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L112
            ENDIF
            BRANCH    EXIT,SFC2L112,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ADTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L113
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ACCOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L113
            ENDIF
            BRANCH    EXIT,SFC2L113,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ACCOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L114
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L114
            ENDIF
            BRANCH    EXIT,SFC2L114,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L115
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TAXOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L115
            ENDIF
            BRANCH    EXIT,SFC2L115,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TAXOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L116
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMGIDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAMGIA00
          MOVE      AMGIGIC,AMMAGIC
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L116
            ENDIF
            BRANCH    EXIT,SFC2L116,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMGIDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L117
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,STRDEPN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAQD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L117
            ENDIF
            BRANCH    EXIT,SFC2L117,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      STRDEPN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L118
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SOFDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESOF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L118
            ENDIF
            BRANCH    EXIT,SFC2L118,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SOFDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L119
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMADDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L120
          CALL     SELECTED
          STRIP     AMMAAQO 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQO 
          SFORMAT   VAR,127
          ENDSET    AMMAAQO 
          APPEND    SP70,AMMAAQO 
          RESET     AMMAAQO 
          CMATCH    EXITCHAR,AMMAAQO 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L120
            ENDIF
          ENDIF
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L121
          CALL     SELECTED
          STRIP     AMMAAQI 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQI 
          SFORMAT   VAR,127
          ENDSET    AMMAAQI 
          APPEND    SP70,AMMAAQI 
          RESET     AMMAAQI 
          CMATCH    EXITCHAR,AMMAAQI 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L121
            ENDIF
          ENDIF
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L122
          CALL     SELECTED
          STRIP     AMMASER 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASER,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASER 
          SFORMAT   VAR,127
          ENDSET    AMMASER 
          APPEND    SP70,AMMASER 
          RESET     AMMASER 
          CMATCH    EXITCHAR,AMMASER 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASER 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L122
            ENDIF
          ENDIF
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L123
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMACST 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMACST 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L123
            ENDIF
          ENDIF
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L124
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMAMANN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMAN0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L124
            ENDIF
            BRANCH    EXIT,SFC2L124,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMAMANN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L125
          CALL     SELECTED
          STRIP     AMMAMANP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAMANP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAMANP
          SFORMAT   VAR,127
          ENDSET    AMMAMANP
          APPEND    SP70,AMMAMANP
          RESET     AMMAMANP
          CMATCH    EXITCHAR,AMMAMANP
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAMANP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L125
            ENDIF
          ENDIF
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L126
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMASUPN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L126
            ENDIF
            BRANCH    EXIT,SFC2L126,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMASUPN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L127
          CALL     SELECTED
          STRIP     AMMASUPP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASUPP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASUPP
          SFORMAT   VAR,127
          ENDSET    AMMASUPP
          APPEND    SP70,AMMASUPP
          RESET     AMMASUPP
          CMATCH    EXITCHAR,AMMASUPP
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASUPP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L127
            ENDIF
          ENDIF
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L128
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L128
            ENDIF
          ENDIF
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L129
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L129
            ENDIF
          ENDIF
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L130
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA3 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L130
            ENDIF
          ENDIF
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L131
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMARVR 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMARVR 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L131
            ENDIF
          ENDIF
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L132
          CALL     SELECTED
          STRIP     AMMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR1 
          SFORMAT   VAR,127
          ENDSET    AMMAUR1 
          APPEND    SP70,AMMAUR1 
          RESET     AMMAUR1 
          CMATCH    EXITCHAR,AMMAUR1 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L132
            ENDIF
          ENDIF
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L133
          CALL     SELECTED
          STRIP     AMMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR2 
          SFORMAT   VAR,127
          ENDSET    AMMAUR2 
          APPEND    SP70,AMMAUR2 
          RESET     AMMAUR2 
          CMATCH    EXITCHAR,AMMAUR2 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L133
            ENDIF
          ENDIF
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L134
          CALL     SELECTED
          STRIP     AMMAUR3 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR3 
          SFORMAT   VAR,127
          ENDSET    AMMAUR3 
          APPEND    SP70,AMMAUR3 
          RESET     AMMAUR3 
          CMATCH    EXITCHAR,AMMAUR3 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L134
            ENDIF
          ENDIF
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L135
          CALL     SELECTED
          STRIP     AMMAUR4 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR4,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR4 
          SFORMAT   VAR,127
          ENDSET    AMMAUR4 
          APPEND    SP70,AMMAUR4 
          RESET     AMMAUR4 
          CMATCH    EXITCHAR,AMMAUR4 
          GOTO      SFC2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR4 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L135
            ENDIF
          ENDIF
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L136
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L137
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L138
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L139
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L140
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC1DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC10000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L140
            ENDIF
            BRANCH    EXIT,SFC2L140,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC1DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L141
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC2DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC20000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L141
            ENDIF
            BRANCH    EXIT,SFC2L141,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC2DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L142
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC3DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC30000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L142
            ENDIF
            BRANCH    EXIT,SFC2L142,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC3DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L143
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC4DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC40000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L143
            ENDIF
            BRANCH    EXIT,SFC2L143,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC4DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L144
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L145
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L146
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY3 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L147
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY4 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC2L001
.
SFC2L148
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SFC2L001
.
SFC2L149
.
.
          MOVE      "   58",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TYPDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETYP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC2L149
            ENDIF
            BRANCH    EXIT,SFC2L149,SFC2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC2L990 IF EQUAL
          ENDIF
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   58",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TYPDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC2L001
.
SFC2L150
          CALL      PSC20000
          MOVE      ZERO,EXIT
          GOTO      SFC2L999
SFC2L990  MOVE      ONE,EXIT * Exit Char Restart
SFC2L999  RETURN
.--------------------------------
. Screen - Asset Modification Screen 2        
.--------------------------------
SCC3L000
SCC3L100
          MOVE      "C3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCC3L200
          CALL      CFC3L000 * Clear Fields
SCC3L300
          CALL      KYC3L000 * Enter Key Fields
          BRANCH    EXIT,SCC3L999,SCC3L999
SCC3L400
          CALL      WPC3L000 * Load any WP Details
SCC3L500
          CALL      LMC3L000 * Load any Batch Details
SCC3L600
          CALL      DFC3L000 * Display Fields
SCC3L700
          CALL      SFC3L000 * Select Fields
          BRANCH    EXIT,SCC3L100,SCC3L100,SCC3L200
SCC3L800
SCC3L900
SCC3L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Modification Screen 2        
.-------------------------------------------------------
CFC3L000
CFC3L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Modification Screen 2        
.--------------------------------------------------------
KYC3L000
          MOVE      ZERO,EXIT
          GOTO      KYC3L999
.
KYC3L900  MOVE      ONE,EXIT
KYC3L999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Modification Screen 2        
.---------------------------------------------------------
WPC3L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPC3L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPC3L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPC3L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPC3L100
WPC3L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Modification Screen 2        
.---------------------------------------------------------
LMC3L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Modification Screen 2        
.---------------------------------------------------------
DFC3L000
          BRANCH   ACCEPT,DFC3L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFC3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFC3L900
          MATCH    PRGID,SCPSPID
          GOTO     DFC3L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFC3L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFC3L010 IF NOT EQUAL
.
          CALL     PSC3L000 * Display Field
          GOTO     DFC3L010
DFC3L900
DFC3L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Modification Screen 2        
.---------------------------------------------------------
PSC3L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSC3L999,PSC3L999,PSC3L101,PSC3L102:
                            PSC3L103,PSC3L104,PSC3L105,PSC3L106:
                            PSC3L107,PSC3L108,PSC3L109,PSC3L110:
                            PSC3L111,PSC3L112,PSC3L113,PSC3L114:
                            PSC3L115,PSC3L116,PSC3L117,PSC3L118:
                            PSC3L119,PSC3L120,PSC3L121,PSC3L122:
                            PSC3L123,PSC3L124,PSC3L125,PSC3L126:
                            PSC3L127,PSC3L128,PSC3L129,PSC3L130:
                            PSC3L131,PSC3L132,PSC3L133,PSC3L134:
                            PSC3L135,PSC3L136,PSC3L137,PSC3L138:
                            PSC3L139,PSC3L140,PSC3L141,PSC3L142:
                            PSC3L143,PSC3L144,PSC3L145,PSC3L146:
                            PSC3L147,PSC3L148,PSC3L149,PSC3L150:
                            PSC3L151,PSC3L152,PSC3L153,PSC3L154:
                            PSC3L999,PSC3L999,PSC3L999,PSC3L155:
                            PSC3L156,PSC3L999,PSC3L157,PSC3L158:
                            PSC3L999,PSC3L159,PSC3L160,PSC3L161:
                            PSC3L162,PSC3L163,PSC3L164,PSC3L165:
                            PSC3L999,PSC3L999,PSC3L999,PSC3L999:
                           PSC3L999,PSC3L999,PSC3L999,PSC3L999
          GOTO     PSC3L999
.
PSC3L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L102
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L103
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L104
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L105
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L109
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L110
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L111
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L112
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L113
          MOVE      STRDEPN,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L114
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L115
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L116
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L117
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L118
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L119
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L120
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L121
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L122
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L123
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L124
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L125
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L126
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L127
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L128
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L129
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L130
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L131
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L132
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L133
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L134
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L135
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L136
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L137
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L138
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L139
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L140
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L141
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L142
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L143
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L144
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L145
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L146
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L147
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L148
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L149
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L154
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSC3L999
.
PSC3L155
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L156
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L157
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L158
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L159
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L160
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L161
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L162
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L163
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L164
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
.
PSC3L165
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PSC3L999
PSC3L999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Modification Screen 2        
.---------------------------------------------------------
SFC3L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFC3L001  BRANCH   ACCEPT,SFC3L020
.
SFC3L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC3L006,SFC3L101,SFC3L102,SFC3L103:
                            SFC3L104,SFC3L105,SFC3L106,SFC3L107:
                            SFC3L108,SFC3L109,SFC3L110,SFC3L111:
                            SFC3L006,SFC3L006,SFC3L006,SFC3L112:
                            SFC3L006,SFC3L113,SFC3L114,SFC3L006:
                            SFC3L115,SFC3L116,SFC3L117,SFC3L118:
                            SFC3L119,SFC3L120,SFC3L121,SFC3L122:
                            SFC3L123,SFC3L124,SFC3L006,SFC3L125:
                            SFC3L126,SFC3L006,SFC3L127,SFC3L128:
                            SFC3L129,SFC3L130,SFC3L131,SFC3L132:
                            SFC3L133,SFC3L134,SFC3L135,SFC3L136:
                            SFC3L137,SFC3L138,SFC3L139,SFC3L140:
                            SFC3L141,SFC3L142,SFC3L143,SFC3L144:
                            SFC3L145,SFC3L146,SFC3L147,SFC3L148:
                            SFC3L006,SFC3L006,SFC3L006,SFC3L006:
                            SFC3L006,SFC3L006,SFC3L006,SFC3L006:
                            SFC3L006,SFC3L006,SFC3L006,SFC3L006:
                            SFC3L006,SFC3L006,SFC3L006,SFC3L006:
                            SFC3L006,SFC3L006,SFC3L006,SFC3L006:
                           SFC3L006,SFC3L006,SFC3L006,SFC3L149
SFC3L006  BEEP
          GOTO     SFC3L005
SFC3L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFC3L090
          MATCH    PRGID,SCSLPID
          GOTO     SFC3L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFC3L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC3L020,SFC3L020,SFC3L102,SFC3L103:
                            SFC3L104,SFC3L105,SFC3L106,SFC3L107:
                            SFC3L108,SFC3L109,SFC3L110,SFC3L111:
                            SFC3L020,SFC3L020,SFC3L020,SFC3L112:
                            SFC3L020,SFC3L113,SFC3L114,SFC3L020:
                            SFC3L115,SFC3L116,SFC3L117,SFC3L118:
                            SFC3L119,SFC3L120,SFC3L121,SFC3L122:
                            SFC3L123,SFC3L124,SFC3L020,SFC3L125:
                            SFC3L126,SFC3L020,SFC3L127,SFC3L128:
                            SFC3L129,SFC3L130,SFC3L131,SFC3L132:
                            SFC3L133,SFC3L134,SFC3L135,SFC3L136:
                            SFC3L137,SFC3L138,SFC3L139,SFC3L140:
                            SFC3L141,SFC3L142,SFC3L143,SFC3L144:
                            SFC3L145,SFC3L146,SFC3L147,SFC3L148:
                            SFC3L020,SFC3L020,SFC3L020,SFC3L020:
                            SFC3L020,SFC3L020,SFC3L020,SFC3L020:
                            SFC3L020,SFC3L020,SFC3L020,SFC3L020:
                            SFC3L020,SFC3L020,SFC3L020,SFC3L020:
                            SFC3L020,SFC3L020,SFC3L020,SFC3L020:
                           SFC3L020,SFC3L020,SFC3L020,SFC3L020
          GOTO     SFC3L020
SFC3L090  MOVE     ZERO,ACCEPT
          GOTO     SFC3L001
.
SFC3L101
          CALL      CSC20000
          MOVE      ZERO,EXIT
          GOTO      SFC3L999
.
SFC3L102
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     AMMADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMADES 
          SFORMAT   VAR,127
          ENDSET    AMMADES 
          APPEND    SP70,AMMADES 
          RESET     AMMADES 
          CMATCH    EXITCHAR,AMMADES 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L102
            ENDIF
          ENDIF
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L103
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DPTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDPT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L103
            ENDIF
            BRANCH    EXIT,SFC3L103,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DPTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L104
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,BLDDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBLD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L104
            ENDIF
            BRANCH    EXIT,SFC3L104,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      BLDDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L105
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMLODES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELOC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L105
            ENDIF
            BRANCH    EXIT,SFC3L105,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMLODES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L106
          CALL     SELECTED
          STRIP     AMMALCM 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMALCM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMALCM 
          SFORMAT   VAR,127
          ENDSET    AMMALCM 
          APPEND    SP70,AMMALCM 
          RESET     AMMALCM 
          CMATCH    EXITCHAR,AMMALCM 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMALCM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L106
            ENDIF
          ENDIF
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMASEC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L108
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMALEA 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L109
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAREN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAPRI 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAPRI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L110
            ENDIF
          ENDIF
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ERPD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L111
            ENDIF
            BRANCH    EXIT,SFC3L111,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L112
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ADTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EADT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L112
            ENDIF
            BRANCH    EXIT,SFC3L112,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ADTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L113
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ACCOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L113
            ENDIF
            BRANCH    EXIT,SFC3L113,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ACCOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L114
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L114
            ENDIF
            BRANCH    EXIT,SFC3L114,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L115
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TAXOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L115
            ENDIF
            BRANCH    EXIT,SFC3L115,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TAXOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L116
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMGIDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAMGIA00
          MOVE      AMGIGIC,AMMAGIC
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L116
            ENDIF
            BRANCH    EXIT,SFC3L116,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMGIDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L117
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,STRDEPN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAQD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L117
            ENDIF
            BRANCH    EXIT,SFC3L117,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      STRDEPN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L118
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SOFDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESOF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L118
            ENDIF
            BRANCH    EXIT,SFC3L118,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SOFDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L119
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMADDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L120
          CALL     SELECTED
          STRIP     AMMAAQO 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQO 
          SFORMAT   VAR,127
          ENDSET    AMMAAQO 
          APPEND    SP70,AMMAAQO 
          RESET     AMMAAQO 
          CMATCH    EXITCHAR,AMMAAQO 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L120
            ENDIF
          ENDIF
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L121
          CALL     SELECTED
          STRIP     AMMAAQI 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQI 
          SFORMAT   VAR,127
          ENDSET    AMMAAQI 
          APPEND    SP70,AMMAAQI 
          RESET     AMMAAQI 
          CMATCH    EXITCHAR,AMMAAQI 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L121
            ENDIF
          ENDIF
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L122
          CALL     SELECTED
          STRIP     AMMASER 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASER,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASER 
          SFORMAT   VAR,127
          ENDSET    AMMASER 
          APPEND    SP70,AMMASER 
          RESET     AMMASER 
          CMATCH    EXITCHAR,AMMASER 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASER 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L122
            ENDIF
          ENDIF
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L123
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMACST 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMACST 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L123
            ENDIF
          ENDIF
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L124
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMAMANN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMAN0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L124
            ENDIF
            BRANCH    EXIT,SFC3L124,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMAMANN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L125
          CALL     SELECTED
          STRIP     AMMAMANP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAMANP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAMANP
          SFORMAT   VAR,127
          ENDSET    AMMAMANP
          APPEND    SP70,AMMAMANP
          RESET     AMMAMANP
          CMATCH    EXITCHAR,AMMAMANP
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAMANP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L125
            ENDIF
          ENDIF
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L126
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMASUPN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L126
            ENDIF
            BRANCH    EXIT,SFC3L126,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMASUPN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L127
          CALL     SELECTED
          STRIP     AMMASUPP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASUPP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASUPP
          SFORMAT   VAR,127
          ENDSET    AMMASUPP
          APPEND    SP70,AMMASUPP
          RESET     AMMASUPP
          CMATCH    EXITCHAR,AMMASUPP
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASUPP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L127
            ENDIF
          ENDIF
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L128
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L128
            ENDIF
          ENDIF
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L129
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L129
            ENDIF
          ENDIF
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L130
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA3 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L130
            ENDIF
          ENDIF
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L131
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMARVR 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMARVR 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L131
            ENDIF
          ENDIF
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L132
          CALL     SELECTED
          STRIP     AMMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR1 
          SFORMAT   VAR,127
          ENDSET    AMMAUR1 
          APPEND    SP70,AMMAUR1 
          RESET     AMMAUR1 
          CMATCH    EXITCHAR,AMMAUR1 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L132
            ENDIF
          ENDIF
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L133
          CALL     SELECTED
          STRIP     AMMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR2 
          SFORMAT   VAR,127
          ENDSET    AMMAUR2 
          APPEND    SP70,AMMAUR2 
          RESET     AMMAUR2 
          CMATCH    EXITCHAR,AMMAUR2 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L133
            ENDIF
          ENDIF
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L134
          CALL     SELECTED
          STRIP     AMMAUR3 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR3 
          SFORMAT   VAR,127
          ENDSET    AMMAUR3 
          APPEND    SP70,AMMAUR3 
          RESET     AMMAUR3 
          CMATCH    EXITCHAR,AMMAUR3 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L134
            ENDIF
          ENDIF
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L135
          CALL     SELECTED
          STRIP     AMMAUR4 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR4,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR4 
          SFORMAT   VAR,127
          ENDSET    AMMAUR4 
          APPEND    SP70,AMMAUR4 
          RESET     AMMAUR4 
          CMATCH    EXITCHAR,AMMAUR4 
          GOTO      SFC3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR4 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L135
            ENDIF
          ENDIF
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L136
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L137
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L138
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L139
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L140
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC1DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC10000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L140
            ENDIF
            BRANCH    EXIT,SFC3L140,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC1DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L141
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC2DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC20000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L141
            ENDIF
            BRANCH    EXIT,SFC3L141,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC2DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L142
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC3DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC30000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L142
            ENDIF
            BRANCH    EXIT,SFC3L142,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC3DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L143
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC4DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC40000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFC3L143
            ENDIF
            BRANCH    EXIT,SFC3L143,SFC3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFC3L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC4DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFC3L001
.
SFC3L144
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L145
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L146
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY3 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L147
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY4 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFC3L001
.
SFC3L148
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SFC3L001
.
SFC3L149
          CALL      PSC20000
          MOVE      ZERO,EXIT
          GOTO      SFC3L999
SFC3L990  MOVE      ONE,EXIT * Exit Char Restart
SFC3L999  RETURN
.--------------------------------
. Screen - Insert Screen 1                    
.--------------------------------
SCI1L000
SCI1L100
          MOVE      "I1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCI1L200
          CALL      CFI1L000 * Clear Fields
SCI1L300
          CALL      KYI1L000 * Enter Key Fields
          BRANCH    EXIT,SCI1L999,SCI1L999
SCI1L400
          CALL      WPI1L000 * Load any WP Details
SCI1L500
          CALL      LMI1L000 * Load any Batch Details
SCI1L600
          CALL      DFI1L000 * Display Fields
SCI1L700
          CALL      SFI1L000 * Select Fields
          BRANCH    EXIT,SCI1L100,SCI1L100,SCI1L200
SCI1L800
SCI1L900
SCI1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insert Screen 1                    
.-------------------------------------------------------
CFI1L000
          MOVE      SP70,AMMAREG 
          MOVE      SP70,AMMAASS 
          MOVE      SP70,AMMADES 
          MOVE      SP70,AMMADPT 
          MOVE      SP70,AMMABLD 
          MOVE      SP70,AMMALOC 
          MOVE      SP70,AMMALCM 
          MOVE      ZERO,AMMASEC 
          MOVE      ZERO,AMMALEA 
          MOVE      ZERO,AMMAREN 
          MOVE      ZERO,AMMAPRI 
          MOVE      SP70,AMMARDT 
          MOVE      SP70,AMMAADT 
          MOVE      ZERO,AMMAAAD 
          MOVE      SP70,AMMATDT 
          MOVE      ZERO,AMMATAD 
          MOVE      SP70,AMMAGIC 
          MOVE      SP70,AMMAAQD 
          MOVE      SP70,AMMASOF 
          MOVE      SP70,AMMADDT 
          MOVE      SP70,AMMAAQO 
          MOVE      SP70,AMMAAQI 
          MOVE      SP70,AMMASER 
          MOVE      ZERO,AMMACST 
          MOVE      SP70,AMMAMANC
          MOVE      SP70,AMMAMANP
          MOVE      SP70,AMMASUPC
          MOVE      SP70,AMMASUPP
          MOVE      ZERO,AMMAUA1 
          MOVE      ZERO,AMMAUA2 
          MOVE      ZERO,AMMAUA3 
          MOVE      ZERO,AMMARVR 
          MOVE      SP70,AMMAUR1 
          MOVE      SP70,AMMAUR2 
          MOVE      SP70,AMMAUR3 
          MOVE      SP70,AMMAUR4 
          MOVE      SP70,AMMAUD1 
          MOVE      SP70,AMMAUD2 
          MOVE      SP70,AMMAUD3 
          MOVE      SP70,AMMAUD4 
          MOVE      SP70,AMMAUC1 
          MOVE      SP70,AMMAUC2 
          MOVE      SP70,AMMAUC3 
          MOVE      SP70,AMMAUC4 
          MOVE      SP70,AMMAUY1 
          MOVE      SP70,AMMAUY2 
          MOVE      SP70,AMMAUY3 
          MOVE      SP70,AMMAUY4 
          MOVE      SP70,AMMATYP 
CFI1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insert Screen 1                    
.--------------------------------------------------------
KYI1L000
.
KYI1L110
.
.
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMREDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAMREA00
          MOVE      AMREREG,AMMAREG
          BRANCH    EXIT,KYI1L900,KYI1L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAREG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMREDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KYI1L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "1",CKEYTYP
          CALL      EASST000
          BRANCH    EXIT,KYI1L110,KYI1L900
          MOVE      ONE,ACCEPT
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KYI1L999
.
KYI1L900  MOVE      ONE,EXIT
KYI1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insert Screen 1                    
.---------------------------------------------------------
WPI1L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPI1L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPI1L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPI1L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPI1L100
WPI1L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insert Screen 1                    
.---------------------------------------------------------
LMI1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Insert Screen 1                    
.---------------------------------------------------------
DFI1L000
          BRANCH   ACCEPT,DFI1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI1L010 IF NOT EQUAL
.
          CALL     PSI1L000 * Display Field
          GOTO     DFI1L010
DFI1L900
DFI1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insert Screen 1                    
.---------------------------------------------------------
PSI1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI1L999,PSI1L999,PSI1L101,PSI1L102:
                            PSI1L103,PSI1L104,PSI1L105,PSI1L106:
                            PSI1L107,PSI1L108,PSI1L109,PSI1L110:
                            PSI1L111,PSI1L112,PSI1L113,PSI1L114:
                            PSI1L115,PSI1L116,PSI1L117,PSI1L118:
                            PSI1L119,PSI1L120,PSI1L121,PSI1L122:
                            PSI1L123,PSI1L124,PSI1L125,PSI1L126:
                            PSI1L127,PSI1L128,PSI1L129,PSI1L130:
                            PSI1L131,PSI1L132,PSI1L133,PSI1L134:
                            PSI1L135,PSI1L136,PSI1L137,PSI1L138:
                            PSI1L139,PSI1L140,PSI1L141,PSI1L142:
                            PSI1L143,PSI1L144,PSI1L145,PSI1L146:
                            PSI1L147,PSI1L148,PSI1L149,PSI1L150:
                            PSI1L151,PSI1L152,PSI1L153,PSI1L154:
                            PSI1L155,PSI1L156,PSI1L999,PSI1L157:
                            PSI1L158,PSI1L999,PSI1L159,PSI1L160:
                            PSI1L999,PSI1L161,PSI1L162,PSI1L163:
                            PSI1L164,PSI1L165,PSI1L166,PSI1L167:
                            PSI1L999,PSI1L999,PSI1L999,PSI1L999:
                           PSI1L999,PSI1L999,PSI1L999,PSI1L999:
                            PSI1L999,PSI1L999
          GOTO     PSI1L999
.
PSI1L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L102
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L103
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L104
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L105
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L109
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L110
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L111
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L112
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L113
          MOVE      STRDEPN,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L114
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L115
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L116
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L117
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L118
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L119
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L120
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L121
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L122
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L123
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L124
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L125
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L126
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L127
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L128
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L129
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L130
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L131
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L132
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L133
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L134
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L135
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L136
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L137
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L138
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L139
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L140
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L141
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L142
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L143
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L144
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L145
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L146
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L147
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L148
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L149
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L154
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSI1L999
.
PSI1L155
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L156
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L157
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L158
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L159
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L160
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L161
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L162
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L163
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L164
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L165
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L166
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L167
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
PSI1L999
          RETURN
.---------------------------------------------------------
. Selections for : Insert Screen 1                    
.---------------------------------------------------------
SFI1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI1L001  BRANCH   ACCEPT,SFI1L020
.
SFI1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L006,SFI1L006,SFI1L101,SFI1L102:
                            SFI1L103,SFI1L104,SFI1L105,SFI1L106:
                            SFI1L107,SFI1L108,SFI1L109,SFI1L110:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L111:
                            SFI1L006,SFI1L112,SFI1L113,SFI1L006:
                            SFI1L114,SFI1L115,SFI1L116,SFI1L117:
                            SFI1L118,SFI1L119,SFI1L120,SFI1L121:
                            SFI1L122,SFI1L123,SFI1L006,SFI1L124:
                            SFI1L125,SFI1L006,SFI1L126,SFI1L127:
                            SFI1L128,SFI1L129,SFI1L130,SFI1L131:
                            SFI1L132,SFI1L133,SFI1L134,SFI1L135:
                            SFI1L136,SFI1L137,SFI1L138,SFI1L139:
                            SFI1L140,SFI1L141,SFI1L142,SFI1L143:
                            SFI1L144,SFI1L145,SFI1L146,SFI1L147:
                            SFI1L148,SFI1L006,SFI1L006,SFI1L006:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L006:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L006:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L006:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L006:
                           SFI1L006,SFI1L006,SFI1L006,SFI1L006:
                            SFI1L149,SFI1L150
SFI1L006  BEEP
          GOTO     SFI1L005
SFI1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L020,SFI1L020,SFI1L101,SFI1L102:
                            SFI1L103,SFI1L104,SFI1L105,SFI1L106:
                            SFI1L107,SFI1L108,SFI1L109,SFI1L110:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L111:
                            SFI1L020,SFI1L112,SFI1L113,SFI1L020:
                            SFI1L114,SFI1L115,SFI1L116,SFI1L117:
                            SFI1L118,SFI1L119,SFI1L120,SFI1L121:
                            SFI1L122,SFI1L123,SFI1L020,SFI1L124:
                            SFI1L125,SFI1L020,SFI1L126,SFI1L127:
                            SFI1L128,SFI1L129,SFI1L130,SFI1L131:
                            SFI1L132,SFI1L133,SFI1L134,SFI1L135:
                            SFI1L136,SFI1L137,SFI1L138,SFI1L139:
                            SFI1L140,SFI1L141,SFI1L142,SFI1L143:
                            SFI1L144,SFI1L145,SFI1L146,SFI1L147:
                            SFI1L148,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                           SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020
          GOTO     SFI1L020
SFI1L090  MOVE     ZERO,ACCEPT
          GOTO     SFI1L001
.
SFI1L101
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     AMMADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMADES 
          SFORMAT   VAR,127
          ENDSET    AMMADES 
          APPEND    SP70,AMMADES 
          RESET     AMMADES 
          CMATCH    EXITCHAR,AMMADES 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L101
            ENDIF
          ENDIF
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L102
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DPTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDPT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L102
            ENDIF
            BRANCH    EXIT,SFI1L102,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DPTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L103
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,BLDDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBLD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L103
            ENDIF
            BRANCH    EXIT,SFI1L103,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      BLDDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L104
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMLODES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELOC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L104
            ENDIF
            BRANCH    EXIT,SFI1L104,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMLODES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L105
          CALL     SELECTED
          STRIP     AMMALCM 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMALCM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMALCM 
          SFORMAT   VAR,127
          ENDSET    AMMALCM 
          APPEND    SP70,AMMALCM 
          RESET     AMMALCM 
          CMATCH    EXITCHAR,AMMALCM 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMALCM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L105
            ENDIF
          ENDIF
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L106
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMASEC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMALEA 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L108
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAREN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAPRI 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAPRI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L109
            ENDIF
          ENDIF
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L110
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMARDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L111
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ADTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EADT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L111
            ENDIF
            BRANCH    EXIT,SFI1L111,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ADTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L112
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ACCOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAAAD 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAAAD 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L112
            ENDIF
          ENDIF
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ACCOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L113
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L113
            ENDIF
            BRANCH    EXIT,SFI1L113,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L114
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TAXOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMATAD 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMATAD 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L114
            ENDIF
          ENDIF
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TAXOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L115
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMGIDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAMGIA00
          MOVE      AMGIGIC,AMMAGIC
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L115
            ENDIF
            BRANCH    EXIT,SFI1L115,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMGIDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L116
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,STRDEPN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      DATECURR
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAQD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L116
            ENDIF
            BRANCH    EXIT,SFI1L116,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      STRDEPN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L117
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SOFDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESOF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L117
            ENDIF
            BRANCH    EXIT,SFI1L117,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SOFDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L118
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMADDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L119
          CALL     SELECTED
          STRIP     AMMAAQO 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQO 
          SFORMAT   VAR,127
          ENDSET    AMMAAQO 
          APPEND    SP70,AMMAAQO 
          RESET     AMMAAQO 
          CMATCH    EXITCHAR,AMMAAQO 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L119
            ENDIF
          ENDIF
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L120
          CALL     SELECTED
          STRIP     AMMAAQI 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQI 
          SFORMAT   VAR,127
          ENDSET    AMMAAQI 
          APPEND    SP70,AMMAAQI 
          RESET     AMMAAQI 
          CMATCH    EXITCHAR,AMMAAQI 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L120
            ENDIF
          ENDIF
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L121
          CALL     SELECTED
          STRIP     AMMASER 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASER,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASER 
          SFORMAT   VAR,127
          ENDSET    AMMASER 
          APPEND    SP70,AMMASER 
          RESET     AMMASER 
          CMATCH    EXITCHAR,AMMASER 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASER 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L121
            ENDIF
          ENDIF
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L122
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMACST 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMACST 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L122
            ENDIF
          ENDIF
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L123
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMAMANN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMAN0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L123
            ENDIF
            BRANCH    EXIT,SFI1L123,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMAMANN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L124
          CALL     SELECTED
          STRIP     AMMAMANP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAMANP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAMANP
          SFORMAT   VAR,127
          ENDSET    AMMAMANP
          APPEND    SP70,AMMAMANP
          RESET     AMMAMANP
          CMATCH    EXITCHAR,AMMAMANP
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAMANP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L124
            ENDIF
          ENDIF
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L125
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMASUPN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L125
            ENDIF
            BRANCH    EXIT,SFI1L125,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMASUPN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L126
          CALL     SELECTED
          STRIP     AMMASUPP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASUPP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASUPP
          SFORMAT   VAR,127
          ENDSET    AMMASUPP
          APPEND    SP70,AMMASUPP
          RESET     AMMASUPP
          CMATCH    EXITCHAR,AMMASUPP
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASUPP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L126
            ENDIF
          ENDIF
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L127
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L127
            ENDIF
          ENDIF
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L128
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L128
            ENDIF
          ENDIF
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L129
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA3 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L129
            ENDIF
          ENDIF
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L130
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMARVR 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMARVR 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L130
            ENDIF
          ENDIF
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L131
          CALL     SELECTED
          STRIP     AMMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR1 
          SFORMAT   VAR,127
          ENDSET    AMMAUR1 
          APPEND    SP70,AMMAUR1 
          RESET     AMMAUR1 
          CMATCH    EXITCHAR,AMMAUR1 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L131
            ENDIF
          ENDIF
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L132
          CALL     SELECTED
          STRIP     AMMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR2 
          SFORMAT   VAR,127
          ENDSET    AMMAUR2 
          APPEND    SP70,AMMAUR2 
          RESET     AMMAUR2 
          CMATCH    EXITCHAR,AMMAUR2 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L132
            ENDIF
          ENDIF
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L133
          CALL     SELECTED
          STRIP     AMMAUR3 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR3 
          SFORMAT   VAR,127
          ENDSET    AMMAUR3 
          APPEND    SP70,AMMAUR3 
          RESET     AMMAUR3 
          CMATCH    EXITCHAR,AMMAUR3 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L133
            ENDIF
          ENDIF
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L134
          CALL     SELECTED
          STRIP     AMMAUR4 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR4,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR4 
          SFORMAT   VAR,127
          ENDSET    AMMAUR4 
          APPEND    SP70,AMMAUR4 
          RESET     AMMAUR4 
          CMATCH    EXITCHAR,AMMAUR4 
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR4 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L134
            ENDIF
          ENDIF
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L135
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L136
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L137
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L138
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L139
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC1DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC10000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L139
            ENDIF
            BRANCH    EXIT,SFI1L139,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC1DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L140
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC2DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC20000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L140
            ENDIF
            BRANCH    EXIT,SFI1L140,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC2DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L141
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC3DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC30000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L141
            ENDIF
            BRANCH    EXIT,SFI1L141,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC3DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L142
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC4DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC40000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L142
            ENDIF
            BRANCH    EXIT,SFI1L142,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC4DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L143
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L144
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L145
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY3 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L146
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY4 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L147
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SFI1L001
.
SFI1L148
.
.
          MOVE      "   58",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TYPDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETYP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L148
            ENDIF
            BRANCH    EXIT,SFI1L148,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   58",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TYPDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L149
          CALL      PINS0000
          MOVE      ONE,EXIT
          GOTO      SFI1L999
.
SFI1L150
          MOVE      ONE,EXIT
          GOTO      SFI1L999
SFI1L990  MOVE      ONE,EXIT * Exit Char Restart
SFI1L999  RETURN
.--------------------------------
. Screen - Insert Screen 2                    
.--------------------------------
SCI2L000
SCI2L100
          MOVE      "I2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCI2L200
          CALL      CFI2L000 * Clear Fields
SCI2L300
          CALL      KYI2L000 * Enter Key Fields
          BRANCH    EXIT,SCI2L999,SCI2L999
SCI2L400
          CALL      WPI2L000 * Load any WP Details
SCI2L500
          CALL      LMI2L000 * Load any Batch Details
SCI2L600
          CALL      DFI2L000 * Display Fields
SCI2L700
          CALL      SFI2L000 * Select Fields
          BRANCH    EXIT,SCI2L100,SCI2L100,SCI2L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SCI2L800
SCI2L900
SCI2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insert Screen 2                    
.-------------------------------------------------------
CFI2L000
CFI2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insert Screen 2                    
.--------------------------------------------------------
KYI2L000
          MOVE      ZERO,EXIT
          GOTO      KYI2L999
.
KYI2L900  MOVE      ONE,EXIT
KYI2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insert Screen 2                    
.---------------------------------------------------------
WPI2L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPI2L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPI2L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPI2L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPI2L100
WPI2L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insert Screen 2                    
.---------------------------------------------------------
LMI2L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Insert Screen 2                    
.---------------------------------------------------------
DFI2L000
          BRANCH   ACCEPT,DFI2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI2L010 IF NOT EQUAL
.
          CALL     PSI2L000 * Display Field
          GOTO     DFI2L010
DFI2L900
DFI2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insert Screen 2                    
.---------------------------------------------------------
PSI2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI2L999,PSI2L999,PSI2L101,PSI2L102:
                            PSI2L103,PSI2L104,PSI2L105,PSI2L106:
                            PSI2L107,PSI2L108,PSI2L109,PSI2L110:
                            PSI2L111,PSI2L112,PSI2L999,PSI2L113:
                            PSI2L114,PSI2L115,PSI2L116,PSI2L117:
                            PSI2L118,PSI2L119,PSI2L120,PSI2L121:
                            PSI2L122,PSI2L123,PSI2L124,PSI2L125:
                            PSI2L126,PSI2L127,PSI2L128,PSI2L129:
                            PSI2L130,PSI2L131,PSI2L132,PSI2L133:
                            PSI2L134,PSI2L135,PSI2L136,PSI2L137:
                            PSI2L138,PSI2L139,PSI2L140,PSI2L141:
                            PSI2L142,PSI2L143,PSI2L144,PSI2L145:
                            PSI2L146,PSI2L147,PSI2L148,PSI2L149:
                            PSI2L150,PSI2L151,PSI2L152,PSI2L153:
                            PSI2L999,PSI2L999,PSI2L999,PSI2L154:
                            PSI2L155,PSI2L999,PSI2L156,PSI2L157:
                            PSI2L999,PSI2L158,PSI2L159,PSI2L160:
                            PSI2L161,PSI2L162,PSI2L163,PSI2L164:
                            PSI2L999,PSI2L999,PSI2L999,PSI2L999:
                           PSI2L999,PSI2L999,PSI2L999,PSI2L999
          GOTO     PSI2L999
.
PSI2L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L102
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L103
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L104
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L105
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L109
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L110
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L111
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L112
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L113
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L114
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L115
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L116
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L117
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L118
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L119
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L120
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L121
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L122
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L123
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L124
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L125
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L126
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L127
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L128
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L129
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L130
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L131
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L132
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L133
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L134
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L135
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L136
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L137
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L138
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L139
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L140
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L141
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L142
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L143
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L144
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L145
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L146
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L147
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L148
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L149
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L153
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSI2L999
.
PSI2L154
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L155
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L156
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L157
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L158
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L159
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L160
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L161
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L162
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L163
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
.
PSI2L164
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PSI2L999
PSI2L999
          RETURN
.---------------------------------------------------------
. Selections for : Insert Screen 2                    
.---------------------------------------------------------
SFI2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI2L001  BRANCH   ACCEPT,SFI2L020
.
SFI2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI2L006,SFI2L101,SFI2L102,SFI2L103:
                            SFI2L104,SFI2L105,SFI2L106,SFI2L107:
                            SFI2L108,SFI2L109,SFI2L110,SFI2L111:
                            SFI2L006,SFI2L006,SFI2L006,SFI2L112:
                            SFI2L006,SFI2L113,SFI2L114,SFI2L006:
                            SFI2L115,SFI2L116,SFI2L117,SFI2L118:
                            SFI2L119,SFI2L120,SFI2L121,SFI2L122:
                            SFI2L123,SFI2L124,SFI2L006,SFI2L125:
                            SFI2L126,SFI2L006,SFI2L127,SFI2L128:
                            SFI2L129,SFI2L130,SFI2L131,SFI2L132:
                            SFI2L133,SFI2L134,SFI2L135,SFI2L136:
                            SFI2L137,SFI2L138,SFI2L139,SFI2L140:
                            SFI2L141,SFI2L142,SFI2L143,SFI2L144:
                            SFI2L145,SFI2L146,SFI2L147,SFI2L148:
                            SFI2L006,SFI2L006,SFI2L006,SFI2L006:
                            SFI2L006,SFI2L006,SFI2L006,SFI2L006:
                            SFI2L006,SFI2L006,SFI2L006,SFI2L006:
                            SFI2L006,SFI2L006,SFI2L006,SFI2L006:
                            SFI2L006,SFI2L006,SFI2L006,SFI2L006:
                           SFI2L006,SFI2L006,SFI2L006,SFI2L149
SFI2L006  BEEP
          GOTO     SFI2L005
SFI2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI2L020,SFI2L020,SFI2L102,SFI2L103:
                            SFI2L104,SFI2L105,SFI2L106,SFI2L107:
                            SFI2L108,SFI2L109,SFI2L110,SFI2L111:
                            SFI2L020,SFI2L020,SFI2L020,SFI2L112:
                            SFI2L020,SFI2L113,SFI2L114,SFI2L020:
                            SFI2L115,SFI2L116,SFI2L117,SFI2L118:
                            SFI2L119,SFI2L120,SFI2L121,SFI2L122:
                            SFI2L123,SFI2L124,SFI2L020,SFI2L125:
                            SFI2L126,SFI2L020,SFI2L127,SFI2L128:
                            SFI2L129,SFI2L130,SFI2L131,SFI2L132:
                            SFI2L133,SFI2L134,SFI2L135,SFI2L136:
                            SFI2L137,SFI2L138,SFI2L139,SFI2L140:
                            SFI2L141,SFI2L142,SFI2L143,SFI2L144:
                            SFI2L145,SFI2L146,SFI2L147,SFI2L148:
                            SFI2L020,SFI2L020,SFI2L020,SFI2L020:
                            SFI2L020,SFI2L020,SFI2L020,SFI2L020:
                            SFI2L020,SFI2L020,SFI2L020,SFI2L020:
                            SFI2L020,SFI2L020,SFI2L020,SFI2L020:
                            SFI2L020,SFI2L020,SFI2L020,SFI2L020:
                           SFI2L020,SFI2L020,SFI2L020,SFI2L020
          GOTO     SFI2L020
SFI2L090  MOVE     ZERO,ACCEPT
          GOTO     SFI2L001
.
SFI2L101
          CALL      CSI20000
          MOVE      ZERO,EXIT
          GOTO      SFI2L999
.
SFI2L102
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     AMMADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMADES 
          SFORMAT   VAR,127
          ENDSET    AMMADES 
          APPEND    SP70,AMMADES 
          RESET     AMMADES 
          CMATCH    EXITCHAR,AMMADES 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L102
            ENDIF
          ENDIF
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L103
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DPTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDPT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L103
            ENDIF
            BRANCH    EXIT,SFI2L103,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DPTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L104
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,BLDDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBLD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L104
            ENDIF
            BRANCH    EXIT,SFI2L104,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      BLDDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L105
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMLODES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELOC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L105
            ENDIF
            BRANCH    EXIT,SFI2L105,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMLODES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L106
          CALL     SELECTED
          STRIP     AMMALCM 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMALCM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMALCM 
          SFORMAT   VAR,127
          ENDSET    AMMALCM 
          APPEND    SP70,AMMALCM 
          RESET     AMMALCM 
          CMATCH    EXITCHAR,AMMALCM 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMALCM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L106
            ENDIF
          ENDIF
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMASEC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L108
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMALEA 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L109
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAREN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAPRI 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAPRI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L110
            ENDIF
          ENDIF
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L111
          CALL      DATECURR
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ERPD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L111
            ENDIF
            BRANCH    EXIT,SFI2L111,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L112
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ADTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EADT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L112
            ENDIF
            BRANCH    EXIT,SFI2L112,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ADTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L113
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ACCOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L113
            ENDIF
            BRANCH    EXIT,SFI2L113,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ACCOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L114
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L114
            ENDIF
            BRANCH    EXIT,SFI2L114,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L115
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TAXOPEN 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ETAD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L115
            ENDIF
            BRANCH    EXIT,SFI2L115,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TAXOPEN,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L116
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMGIDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAMGIA00
          MOVE      AMGIGIC,AMMAGIC
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L116
            ENDIF
            BRANCH    EXIT,SFI2L116,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMGIDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L117
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L118
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SOFDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESOF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L118
            ENDIF
            BRANCH    EXIT,SFI2L118,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SOFDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L119
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMADDT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L120
          CALL     SELECTED
          STRIP     AMMAAQO 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQO 
          SFORMAT   VAR,127
          ENDSET    AMMAAQO 
          APPEND    SP70,AMMAAQO 
          RESET     AMMAAQO 
          CMATCH    EXITCHAR,AMMAAQO 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L120
            ENDIF
          ENDIF
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L121
          CALL     SELECTED
          STRIP     AMMAAQI 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAAQI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAAQI 
          SFORMAT   VAR,127
          ENDSET    AMMAAQI 
          APPEND    SP70,AMMAAQI 
          RESET     AMMAAQI 
          CMATCH    EXITCHAR,AMMAAQI 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAAQI 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L121
            ENDIF
          ENDIF
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L122
          CALL     SELECTED
          STRIP     AMMASER 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASER,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASER 
          SFORMAT   VAR,127
          ENDSET    AMMASER 
          APPEND    SP70,AMMASER 
          RESET     AMMASER 
          CMATCH    EXITCHAR,AMMASER 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASER 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L122
            ENDIF
          ENDIF
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L123
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMACST 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMACST 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L123
            ENDIF
          ENDIF
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L124
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMAMANN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMAN0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L124
            ENDIF
            BRANCH    EXIT,SFI2L124,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMAMANN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L125
          CALL     SELECTED
          STRIP     AMMAMANP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAMANP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAMANP
          SFORMAT   VAR,127
          ENDSET    AMMAMANP
          APPEND    SP70,AMMAMANP
          RESET     AMMAMANP
          CMATCH    EXITCHAR,AMMAMANP
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAMANP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L125
            ENDIF
          ENDIF
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L126
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMASUPN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L126
            ENDIF
            BRANCH    EXIT,SFI2L126,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMASUPN,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L127
          CALL     SELECTED
          STRIP     AMMASUPP
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMASUPP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMASUPP
          SFORMAT   VAR,127
          ENDSET    AMMASUPP
          APPEND    SP70,AMMASUPP
          RESET     AMMASUPP
          CMATCH    EXITCHAR,AMMASUPP
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMASUPP
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L127
            ENDIF
          ENDIF
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L128
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L128
            ENDIF
          ENDIF
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L129
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L129
            ENDIF
          ENDIF
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L130
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAUA3 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMAUA3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L130
            ENDIF
          ENDIF
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L131
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMARVR 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMMARVR 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L131
            ENDIF
          ENDIF
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L132
          CALL     SELECTED
          STRIP     AMMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR1 
          SFORMAT   VAR,127
          ENDSET    AMMAUR1 
          APPEND    SP70,AMMAUR1 
          RESET     AMMAUR1 
          CMATCH    EXITCHAR,AMMAUR1 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L132
            ENDIF
          ENDIF
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L133
          CALL     SELECTED
          STRIP     AMMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR2 
          SFORMAT   VAR,127
          ENDSET    AMMAUR2 
          APPEND    SP70,AMMAUR2 
          RESET     AMMAUR2 
          CMATCH    EXITCHAR,AMMAUR2 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L133
            ENDIF
          ENDIF
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L134
          CALL     SELECTED
          STRIP     AMMAUR3 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR3 
          SFORMAT   VAR,127
          ENDSET    AMMAUR3 
          APPEND    SP70,AMMAUR3 
          RESET     AMMAUR3 
          CMATCH    EXITCHAR,AMMAUR3 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L134
            ENDIF
          ENDIF
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L135
          CALL     SELECTED
          STRIP     AMMAUR4 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMMAUR4,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMMAUR4 
          SFORMAT   VAR,127
          ENDSET    AMMAUR4 
          APPEND    SP70,AMMAUR4 
          RESET     AMMAUR4 
          CMATCH    EXITCHAR,AMMAUR4 
          GOTO      SFI2L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMMAUR4 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L135
            ENDIF
          ENDIF
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L136
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L137
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L138
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L139
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L140
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC1DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC10000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L140
            ENDIF
            BRANCH    EXIT,SFI2L140,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC1DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L141
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC2DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC20000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L141
            ENDIF
            BRANCH    EXIT,SFI2L141,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC2DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L142
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC3DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC30000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L142
            ENDIF
            BRANCH    EXIT,SFI2L142,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC3DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L143
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UC4DESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUC40000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI2L143
            ENDIF
            BRANCH    EXIT,SFI2L143,SFI2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI2L990 IF EQUAL
          ENDIF
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UC4DESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI2L001
.
SFI2L144
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L145
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L146
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY3 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L147
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMMAUY4 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI2L001
.
SFI2L148
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SFI2L001
.
SFI2L149
          CALL      PSI20000
          MOVE      ZERO,EXIT
          GOTO      SFI2L999
SFI2L990  MOVE      FOUR,EXIT * Exit Char Exit
SFI2L999  RETURN
.--------------------------------
. Screen - Leasing Details                    
.--------------------------------
SCI3L000
SCI3L100
          MOVE      "I3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCI3L200
          CALL      CFI3L000 * Clear Fields
SCI3L300
          CALL      KYI3L000 * Enter Key Fields
          BRANCH    EXIT,SCI3L999,SCI3L999
SCI3L400
          CALL      WPI3L000 * Load any WP Details
SCI3L500
          CALL      LMI3L000 * Load any Batch Details
SCI3L600
          CALL      DFI3L000 * Display Fields
SCI3L700
          CALL      SFI3L000 * Select Fields
          BRANCH    EXIT,SCI3L100,SCI3L100,SCI3L200
SCI3L800
SCI3L900
SCI3L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Leasing Details                    
.-------------------------------------------------------
CFI3L000
CFI3L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Leasing Details                    
.--------------------------------------------------------
KYI3L000
          MOVE      ZERO,EXIT
          GOTO      KYI3L999
.
KYI3L900  MOVE      ONE,EXIT
KYI3L999  RETURN
.---------------------------------------------------------
. Load WP files for : Leasing Details                    
.---------------------------------------------------------
WPI3L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Leasing Details                    
.---------------------------------------------------------
LMI3L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Leasing Details                    
.---------------------------------------------------------
DFI3L000
          BRANCH   ACCEPT,DFI3L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI3L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI3L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI3L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI3L010 IF NOT EQUAL
.
          CALL     PSI3L000 * Display Field
          GOTO     DFI3L010
DFI3L900
DFI3L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Leasing Details                    
.---------------------------------------------------------
PSI3L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI3L101,PSI3L102,PSI3L103,PSI3L104:
                            PSI3L105,PSI3L106,PSI3L107,PSI3L108:
                            PSI3L109,PSI3L110,PSI3L111,PSI3L112:
                            PSI3L113,PSI3L114,PSI3L115,PSI3L116:
                            PSI3L117,PSI3L118,PSI3L119,PSI3L999:
                            PSI3L999,PSI3L999
          GOTO     PSI3L999
.
PSI3L101
          MOVE      AMLECOM,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L102
          MOVE      AMLECNM,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L103
          MOVE      AMLEREF,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L104
          MOVE      AMLECON,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L105
          UNPACK    AMLEDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L106
          MOVE      AMLEPER,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L107
          MOVE      AMLEINS,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L108
          MOVE      AMLEPMT,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L109
          MOVE      AMLERES,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L110
          MOVE      AMLEUA1,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L111
          MOVE      AMLEUA2,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L112
          MOVE      AMLEUR1,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L113
          MOVE      AMLEUR2,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L114
          UNPACK    AMLEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L115
          UNPACK    AMLEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L118
          MOVE      PMTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSI3L999
.
PSI3L119
          UNPACK    AMLEEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI3L999
PSI3L999
          RETURN
.---------------------------------------------------------
. Selections for : Leasing Details                    
.---------------------------------------------------------
SFI3L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI3L001  BRANCH   ACCEPT,SFI3L020
.
SFI3L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI3L101,SFI3L006,SFI3L102,SFI3L103:
                            SFI3L104,SFI3L105,SFI3L106,SFI3L107:
                            SFI3L108,SFI3L109,SFI3L110,SFI3L111:
                            SFI3L112,SFI3L113,SFI3L114,SFI3L115:
                            SFI3L116,SFI3L006,SFI3L117,SFI3L006:
                            SFI3L118,SFI3L119
SFI3L006  BEEP
          GOTO     SFI3L005
SFI3L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI3L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI3L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI3L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI3L101,SFI3L020,SFI3L102,SFI3L103:
                            SFI3L104,SFI3L105,SFI3L106,SFI3L107:
                            SFI3L108,SFI3L109,SFI3L110,SFI3L111:
                            SFI3L112,SFI3L113,SFI3L114,SFI3L115:
                            SFI3L116,SFI3L020,SFI3L117,SFI3L020:
                            SFI3L020,SFI3L020
          GOTO     SFI3L020
SFI3L090  MOVE     ZERO,ACCEPT
          GOTO     SFI3L001
.
SFI3L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMLECNM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ELEA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L101
            ENDIF
            BRANCH    EXIT,SFI3L101,SFI3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI3L990 IF EQUAL
          ENDIF
          MOVE      AMLECOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMLECNM,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI3L001
.
SFI3L102
          CALL     SELECTED
          STRIP     AMLEREF 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMLEREF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMLEREF 
          SFORMAT   VAR,127
          ENDSET    AMLEREF 
          APPEND    SP70,AMLEREF 
          RESET     AMLEREF 
          CMATCH    EXITCHAR,AMLEREF 
          GOTO      SFI3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMLEREF 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L102
            ENDIF
          ENDIF
          MOVE      AMLEREF,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L103
          CALL     SELECTED
          STRIP     AMLECON 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMLECON,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMLECON 
          SFORMAT   VAR,127
          ENDSET    AMLECON 
          APPEND    SP70,AMLECON 
          RESET     AMLECON 
          CMATCH    EXITCHAR,AMLECON 
          GOTO      SFI3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMLECON 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L103
            ENDIF
          ENDIF
          MOVE      AMLECON,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L104
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMLEDAT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMLEDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMLEPER 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMLEPER 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L105
            ENDIF
          ENDIF
          MOVE      AMLEPER,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMLEINS 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMLEINS 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L106
            ENDIF
          ENDIF
          MOVE      AMLEINS,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L107
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,PMTDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPMT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L107
            ENDIF
            BRANCH    EXIT,SFI3L107,SFI3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI3L990 IF EQUAL
          ENDIF
          MOVE      AMLEPMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      PMTDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI3L001
.
SFI3L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMLERES 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMLERES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L108
            ENDIF
          ENDIF
          MOVE      AMLERES,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMLEUA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMLEUA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L109
            ENDIF
          ENDIF
          MOVE      AMLEUA1,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMLEUA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMLEUA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L110
            ENDIF
          ENDIF
          MOVE      AMLEUA2,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L111
          CALL     SELECTED
          STRIP     AMLEUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMLEUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMLEUR1 
          SFORMAT   VAR,127
          ENDSET    AMLEUR1 
          APPEND    SP70,AMLEUR1 
          RESET     AMLEUR1 
          CMATCH    EXITCHAR,AMLEUR1 
          GOTO      SFI3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMLEUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L111
            ENDIF
          ENDIF
          MOVE      AMLEUR1,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L112
          CALL     SELECTED
          STRIP     AMLEUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMLEUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMLEUR2 
          SFORMAT   VAR,127
          ENDSET    AMLEUR2 
          APPEND    SP70,AMLEUR2 
          RESET     AMLEUR2 
          CMATCH    EXITCHAR,AMLEUR2 
          GOTO      SFI3L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMLEUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L112
            ENDIF
          ENDIF
          MOVE      AMLEUR2,VAR      
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L113
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMLEUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMLEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L114
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMLEUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMLEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMLEUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMLEUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L117
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EEDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI3L117
            ENDIF
            BRANCH    EXIT,SFI3L117,SFI3L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI3L990 IF EQUAL
          ENDIF
          UNPACK    AMLEEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI3L001
.
SFI3L118
          CALL      CSI30000
          MOVE      ZERO,EXIT
          GOTO      SFI3L999
.
SFI3L119
          CALL      PSI30000
          MOVE      ZERO,EXIT
          GOTO      SFI3L999
SFI3L990  MOVE      ONE,EXIT * Exit Char Restart
SFI3L999  RETURN
.--------------------------------
. Screen - Insurance Details                  
.--------------------------------
SCI4L000
SCI4L100
          MOVE      "I4",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCI4L200
          CALL      CFI4L000 * Clear Fields
SCI4L300
          CALL      KYI4L000 * Enter Key Fields
          BRANCH    EXIT,SCI4L999,SCI4L999
SCI4L400
          CALL      WPI4L000 * Load any WP Details
SCI4L500
          CALL      LMI4L000 * Load any Batch Details
SCI4L600
          CALL      DFI4L000 * Display Fields
SCI4L700
          CALL      SFI4L000 * Select Fields
          BRANCH    EXIT,SCI4L100,SCI4L100,SCI4L200
SCI4L800
SCI4L900
SCI4L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insurance Details                  
.-------------------------------------------------------
CFI4L000
CFI4L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insurance Details                  
.--------------------------------------------------------
KYI4L000
          MOVE      ZERO,EXIT
          GOTO      KYI4L999
.
KYI4L900  MOVE      ONE,EXIT
KYI4L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insurance Details                  
.---------------------------------------------------------
WPI4L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insurance Details                  
.---------------------------------------------------------
LMI4L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Insurance Details                  
.---------------------------------------------------------
DFI4L000
          BRANCH   ACCEPT,DFI4L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI4L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI4L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI4L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI4L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI4L010 IF NOT EQUAL
.
          CALL     PSI4L000 * Display Field
          GOTO     DFI4L010
DFI4L900
DFI4L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insurance Details                  
.---------------------------------------------------------
PSI4L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI4L101,PSI4L102,PSI4L103,PSI4L104:
                            PSI4L105,PSI4L106,PSI4L107,PSI4L108:
                            PSI4L109,PSI4L110,PSI4L111,PSI4L112:
                            PSI4L113,PSI4L114,PSI4L115,PSI4L999:
                           PSI4L999,PSI4L999,PSI4L999,PSI4L999:
                            PSI4L999,PSI4L999
          GOTO     PSI4L999
.
PSI4L101
          MOVE      AMINCOM,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L102
          MOVE      AMINCOD,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L103
          MOVE      AMINREF,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L104
          MOVE      AMINCON,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L105
          UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L106
          MOVE      AMINVAL,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L107
          MOVE      AMINAPR,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L108
          MOVE      AMINUA1,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L109
          MOVE      AMINUA2,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L110
          MOVE      AMINUR1,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L111
          MOVE      AMINUR2,VAR      
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L112
          UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L113
          UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI4L999
.
PSI4L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI4L999
PSI4L999
          RETURN
.---------------------------------------------------------
. Selections for : Insurance Details                  
.---------------------------------------------------------
SFI4L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI4L001  BRANCH   ACCEPT,SFI4L020
.
SFI4L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI4L101,SFI4L006,SFI4L102,SFI4L103:
                            SFI4L104,SFI4L105,SFI4L106,SFI4L107:
                            SFI4L108,SFI4L109,SFI4L110,SFI4L111:
                            SFI4L112,SFI4L113,SFI4L114,SFI4L006:
                           SFI4L006,SFI4L006,SFI4L006,SFI4L006:
                            SFI4L115,SFI4L116
SFI4L006  BEEP
          GOTO     SFI4L005
SFI4L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI4L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI4L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI4L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI4L101,SFI4L020,SFI4L102,SFI4L103:
                            SFI4L104,SFI4L105,SFI4L106,SFI4L107:
                            SFI4L108,SFI4L109,SFI4L110,SFI4L111:
                            SFI4L112,SFI4L113,SFI4L114,SFI4L020:
                           SFI4L020,SFI4L020,SFI4L020,SFI4L020:
                            SFI4L020,SFI4L020
          GOTO     SFI4L020
SFI4L090  MOVE     ZERO,ACCEPT
          GOTO     SFI4L001
.
SFI4L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMINCOD 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EINC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L101
            ENDIF
            BRANCH    EXIT,SFI4L101,SFI4L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI4L990 IF EQUAL
          ENDIF
          MOVE      AMINCOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMINCOD,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFI4L001
.
SFI4L102
          CALL     SELECTED
          STRIP     AMINREF 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMINREF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMINREF 
          SFORMAT   VAR,127
          ENDSET    AMINREF 
          APPEND    SP70,AMINREF 
          RESET     AMINREF 
          CMATCH    EXITCHAR,AMINREF 
          GOTO      SFI4L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMINREF 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L102
            ENDIF
          ENDIF
          MOVE      AMINREF,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L103
          CALL     SELECTED
          STRIP     AMINCON 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMINCON,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMINCON 
          SFORMAT   VAR,127
          ENDSET    AMINCON 
          APPEND    SP70,AMINCON 
          RESET     AMINCON 
          CMATCH    EXITCHAR,AMINCON 
          GOTO      SFI4L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMINCON 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L103
            ENDIF
          ENDIF
          MOVE      AMINCON,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L104
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMINDAT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMINVAL 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMINVAL 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L105
            ENDIF
          ENDIF
          MOVE      AMINVAL,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMINAPR 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMINAPR 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L106
            ENDIF
          ENDIF
          MOVE      AMINAPR,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMINUA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMINUA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L107
            ENDIF
          ENDIF
          MOVE      AMINUA1,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMINUA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,AMINUA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L108
            ENDIF
          ENDIF
          MOVE      AMINUA2,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L109
          CALL     SELECTED
          STRIP     AMINUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMINUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMINUR1 
          SFORMAT   VAR,127
          ENDSET    AMINUR1 
          APPEND    SP70,AMINUR1 
          RESET     AMINUR1 
          CMATCH    EXITCHAR,AMINUR1 
          GOTO      SFI4L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMINUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L109
            ENDIF
          ENDIF
          MOVE      AMINUR1,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L110
          CALL     SELECTED
          STRIP     AMINUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      AMINUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,AMINUR2 
          SFORMAT   VAR,127
          ENDSET    AMINUR2 
          APPEND    SP70,AMINUR2 
          RESET     AMINUR2 
          CMATCH    EXITCHAR,AMINUR2 
          GOTO      SFI4L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,AMINUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI4L110
            ENDIF
          ENDIF
          MOVE      AMINUR2,VAR      
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L111
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMINUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L112
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      AMINUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L113
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMINUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,AMINUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI4L001
.
SFI4L115
          CALL      CSI40000
          MOVE      ZERO,EXIT
          GOTO      SFI4L999
.
SFI4L116
          CALL      PSI40000
          MOVE      ZERO,EXIT
          GOTO      SFI4L999
SFI4L990  MOVE      ONE,EXIT * Exit Char Restart
SFI4L999  RETURN
.@@@@@ Function Restart Point @@@@@
DEFDATE1  MOVE     CCC,CCENT
          MOVE     CYY,CYEAR
          MOVE     CMM,CMON
          MOVE     CDD,CDAY
          REP      " 0",CCENT
          REP      " 0",CYEAR
          REP      " 0",CMON
          REP      " 0",CDAY
          RETURN
.---------------------------
. Save Notes
.---------------------------
PNOTE000  PACK      KEY17,AMMAREG,AMMAASS,SP70
          CALL      RSAMAC1
PNOTE200  CALL      RKAMAC1
          BRANCH    OVRCD,PNOTE250
          MATCH     AMMAREG,AMACREG
          GOTO      PNOTE250 IF NOT EQUAL
          MATCH     AMMAASS,AMACASS
          GOTO      PNOTE250 IF NOT EQUAL
          PACK      KEY17,AMACREG,AMACASS,AMACLIN
          CALL      DEAMAC1
          GOTO      PNOTE200
.
PNOTE250  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          BRANCH    OVRCD,PNOTE999
          MOVE      ZERO,F3
PNOTE260  READ      TEMPWORD,SEQ;AMACCOM
          GOTO      PNOTE999 IF OVER
          MOVE      F3,AMACLIN
          PACK      KEY17,AMMAREG,AMMAASS,AMACLIN
          UNPACK    KEY17,AMACREG,AMACASS,AMACLIN
          CALL      WRAMAC1
          ADD       ONE,F3
          GOTO      PNOTE260
.
PNOTE999  RETURN
.-------------------------------------------------------------
. File : /users/bga/std/auditkey
.
. Audit & Locking Standard Routine to Enter Key Field
.
. where   14 = Key Length
.         AM = System 2 Character Code
.         MA = File 2 Character Code
.-------------------------------------------------------------
EASST000
          CALL      KAMMAA00                * Call Standard Keyin Routine with ?
          BRANCH    EXIT,EASST999,EASST999  * Exit 1 Null Entry 2 Exitchar
          COMPARE   ONE,OVRCD               * New Record so no Lock
          GOTO      EASST999 IF EQUAL       * Return
.
EASST100  PACK      KEY14,AMMAREG,AMMAASS   * Setup Key to File
          CALL      RLAMMA1                 * Read and Lock Record
          BRANCH    OVRCD,EASST999,EASST200 * OVRCD=1 Not on File 2 Locked
.
EASST110
          MOVE      AMMACST,SAVECST
          MOVE      AMMAAQD,SAVEAQD
          MOVE      AMMAAYR,SAVEAYR
          MOVE      AMMAAPR,SAVEAPR
          CALL      GASST000                * Get Description Details
.
          ASSIGN    AMMACST+AMMARVT-AMMATAD,TAXOPEN
          ASSIGN    AMMACST+AMMARVT-AMMAAAD,ACCOPEN
          CLEAR     STRDEPN
          APPEND    AMMAAPR,STRDEPN
          APPEND    "/",STRDEPN
          APPEND    AMMAAYR,STRDEPN
          RESET     STRDEPN
.
          MOVE      ZERO,EXIT               * Setup Exit Field
          MOVE      ZERO,OVRCD              * Setup Ovrcd Field
          GOTO      EASST999
.
EASST200  MOVE      SP70,DISPMSG            * Clear Line 24 Message Display
          CALL      MESSAGE2                * Clear Line 24 and Save
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3                * Restore Line 24
          REP       UPPLOW,ANS              * Convert to Upper Case
          MATCH     ANSR,ANS                * Re-try
          GOTO      EASST100 IF EQUAL       * Return to locking
          MATCH     ANSX,ANS                * Exit
          GOTO      EASST000 IF EQUAL       * Must be a valid response
          MATCH     ANSE,ANS                * Exit
          GOTO      EASST200 IF NOT EQUAL   * Must be a valid response
          GOTO      EASST000                * Return to Keyin
.
EASST999  RETURN                            * End of Routine
.
GASST000
          MOVE      SP70,DPTDESC
          MATCH     SP70,AMMADPT
          IF        !@EQUAL
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADPT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DPTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,BLDDESC
          MATCH     SP70,AMMABLD
          IF        !@EQUAL
            MOVE      "BL",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMABLD
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,BLDDESC
            ENDIF
            PACK      KEY9,AMMABLD,AMMALOC
            CALL      RDAMLO1
          ENDIF
.
          MATCH     SP70,AMMASUPC
          IF        !@EQUAL
            MOVE      AMMASUPC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMASUPN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAMANC
          IF        !@EQUAL
            MOVE      AMMAMANC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMAMANN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAGIC
          IF        !@EQUAL
            MOVE      AMMAGIC,KEY5
            CALL      RDAMGI1
          ENDIF
.
          MOVE      SP70,SOFDESC
          MATCH     SP70,AMMASOF
          IF        !@EQUAL
            MOVE      "SF",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMASOF
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,SOFDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC1DESC
          MATCH     SP70,AMMAUC1
          IF        !@EQUAL
            MOVE      "A1",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC1
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC1DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC2DESC
          MATCH     SP70,AMMAUC2
          IF        !@EQUAL
            MOVE      "A2",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC2
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC2DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC3DESC
          MATCH     SP70,AMMAUC3
          IF        !@EQUAL
            MOVE      "A3",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC3
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC3DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC4DESC
          MATCH     SP70,AMMAUC4
          IF        !@EQUAL
            MOVE      "A4",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC4
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC4DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TYPDESC
          MATCH     SP70,AMMATYP
          IF        !@EQUAL
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMATYP
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,TYPDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,ADTDESC
          MATCH     SP70,AMMAADT
          IF        !@EQUAL
            PACK      KEY4,AMMAADT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,ADTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TDTDESC
          MATCH     SP70,AMMATDT
          IF        !@EQUAL
            PACK      KEY4,AMMATDT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,TDTDESC
            ENDIF
          ENDIF
.
          RETURN
.----------------------------------------
. Modify Aquisition Details
.----------------------------------------
MODAQU00  PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMMA1
          IF       OVRCD=0
            MOVE     ZERO,ACCEPT
            MOVE     TWO,AUDTTYPE            * Type 2 Before Change Audit
            CALL     WAAMMA00                * Write Before Audit
            MOVE     AMMADPT,AMDHFDPT
            MOVE     AMMABLD,AMLHFBLD
            MOVE     AMMALOC,AMLHFLOC
          ELSE
            BEEP
            MOVE     "Can't Read Asset Details (MODAQU00) - ",DISPMSG
            CALL     MESSAGE1
            GOTO     MODAQU99
          ENDIF
.
          CALL     SCC2L000
.
MODAQU99  RETURN

.----------------------------------------
. Modify Location Details
.----------------------------------------
MODLOC00  PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMMA1
          IF       OVRCD=0
            MOVE     ZERO,ACCEPT
            MOVE     TWO,AUDTTYPE            * Type 2 Before Change Audit
            CALL     WAAMMA00                * Write Before Audit
            MOVE     AMMADPT,AMDHFDPT
            MOVE     AMMABLD,AMLHFBLD
            MOVE     AMMALOC,AMLHFLOC
          ELSE
            BEEP
            MOVE     "Can't Read Asset Details (MODLOC00) - ",DISPMSG
            CALL     MESSAGE1
            GOTO     MODLOC99
          ENDIF
.
          CALL     SCC3L000
.
MODLOC99  RETURN
.----------------------------------------
. Modify Leasing Details
.----------------------------------------
MODLEA00  IF       AMMALEA=0
            MOVE     "Asset is Not Leased. - ",DISPMSG
            BEEP
            CALL     MESSAGE1
            MOVE     ONE,EXIT
            GOTO     MODLEA99
          ENDIF
.
          PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMLE1
          IF       OVRCD=0
            MOVE     ZERO,ACCEPT
            MOVE     TWO,AUDTTYPE            * Type 2 Before Change Audit
            CALL     WAAMLE00                * Write Before Audit
          ELSE
            MOVE     ONE,ACCEPT
          ENDIF
.
          MOVE      SP70,PMTDESC
          MATCH     SP70,AMLEPMT
          IF        !@EQUAL
            MOVE      "PM",AMCDCAT
            PACK      KEY5,AMCDCAT,AMLEPMT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,PMTDESC
            ENDIF
          ENDIF
.
          CALL     SCI3L000
          MOVE     THREE,EXIT
.
MODLEA99  RETURN

.----------------------------------------
. Modify Insurance Details
.----------------------------------------
MODINS00
          PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMIN1
          IF       OVRCD=0
            MOVE     ZERO,ACCEPT
            MOVE     TWO,AUDTTYPE            * Type 2 Before Change Audit
            CALL     WAAMIN00                * Write Before Audit
          ELSE
            MOVE     SP70,AMINCOM
            MOVE     SP70,AMINCOD
            MOVE     SP70,AMINREF
            MOVE     SP70,AMINCON
            MOVE     SP70,AMINREF
            MOVE     SP70,AMINDAT
            MOVE     ZERO,AMINVAL
            MOVE     ZERO,AMINAPR
            MOVE     ZERO,AMINUA1
            MOVE     ZERO,AMINUA2
            MOVE     SP70,AMINUR1
            MOVE     SP70,AMINUR2
            MOVE     SP70,AMINUD1
            MOVE     SP70,AMINUD2
            MOVE     SP70,AMINUY1
            MOVE     SP70,AMINUY2
            MOVE     SP70,AMINSPA
            MOVE     ONE,ACCEPT
          ENDIF
.
          CALL     SCI4L000
.
MODINS99  RETURN

UNLOCKC1  PACK    KEY14,AMMAREG,AMMAASS
          CALL    UUAMMA1
          RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.------------------------------------------------------------
. Cancel Screen C2
.------------------------------------------------------------
CSC20000  PACK     KEY14,AMMAREG,AMMAASS
          CALL     RAAMMA1             * Check to see if record on file.
          IF       OVRCD=0
            CALL     DAAMMA00          * Delete Before Audit.
            CALL     RDAMMA1
          ENDIF
          RETURN
.
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EDPT0000  MOVE    ZERO,CKEYTYP
          MOVE    "DP",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EDPT9999,EDPT9999
          MOVE    AMCDCOD,AMMADPT
          MOVE    AMCDDES,DPTDESC
EDPT9999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EBLD0000  MOVE    ZERO,CKEYTYP
          MOVE    "BL",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EBLD9999,EBLD9999
          MOVE    AMCDCOD,AMMABLD
          MOVE    AMCDDES,BLDDESC
          IF      ACCEPT=0
            MOVE    "    6",FLDID
            CALL    GETPOSIT
            IF      EXIT=0
              CALL    ELOC0000
            ENDIF
            MOVE    "    5",FLDID
            CALL    GETPOSIT
          ENDIF
EBLD9999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
ELOC0000  MOVE    ZERO,CKEYTYP
          MOVE    AMMABLD,AMLOBLD
          CALL    KAMLOA00
          BRANCH  EXIT,ELOC9999,ELOC9999
          MOVE    AMLOLOC,AMMALOC
ELOC9999  RETURN
.-------------------------------------
. Enter Account Depreciation Details
.-------------------------------------
EADT0000  MOVE      ZERO,CKEYTYP
          CALL      KAMDEA00
          BRANCH    EXIT,EADT9999,EADT9999
          MOVE      AMDEDEP,AMMAADT
          MOVE      AMDEDES,ADTDESC
EADT9999  RETURN
EAAD0000  MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMAAAD
          ASSIGN    AMMACST-AMMAAAD+AMMARVT,ACCOPEN
          RETURN
.-------------------------------------
. Enter Tax Depreciation Details
.-------------------------------------
ETDT0000  MOVE      ZERO,CKEYTYP
          CALL      KAMDEA00
          BRANCH    EXIT,ETDT9999,ETDT9999
          MOVE      AMDEDEP,AMMATDT
          MOVE      AMDEDES,TDTDESC
ETDT9999  RETURN
ETAD0000  MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,AMMATAD
          ASSIGN    AMMACST-AMMATAD+AMMARVT,TAXOPEN
          RETURN
.
EAQD0000   MOVE     "   23",FLDID
           CALL     GETPOSIT
           CALL     KEYDATE
           BRANCH   OVRCD,EAQD0000
           PACK     AMMAAQD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",AMMAAQD
           MOVE     "   15",FLDID
           CALL     GETPOSIT
           MOVE     CMON,F2
           IF       F2>6
             SUB      "6",F2
             PACK     KEY4,CCENT,CYEAR
             MOVE     KEY4,CYEARF4
             ADD      ONE,CYEARF4
           ELSE
             ADD      "6",F2
             PACK     KEY4,CCENT,CYEAR
             MOVE     KEY4,CYEARF4
           ENDIF
           MOVE       SAVEAPR,F2
.
EAQD1100   KEYIN     *PCCOL:CVERT,*V2LON,*RV,F2
           IF        ((F2<1)|(F2>13))
             BEEP
             GOTO      EAQD1100
           ENDIF
.
           MOVE      SAVEAYR,CYEARF4
           KEYIN     *PCCOL:CVERT,*V2LON,*DV,F2,"/",*RV,CYEARF4
           CLEAR     STRDEPN
           APPEND    F2,STRDEPN
           APPEND    "/",STRDEPN
           MOVE      F2,AMMAAPR
           MOVE      CYEARF4,AMMAAYR
           SETLPTR   AMMAAYR,4
           RESET    STRDEPN,3
           APPEND    AMMAAYR,STRDEPN
           RESET     STRDEPN
           SETLPTR   STRDEPN,10
EAQD1200
           MOVE      "   23",FLDID
           CALL      GETPOSIT
           RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
ESOF0000  MOVE    ZERO,CKEYTYP
          MOVE    "SF",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,ESOF9999,ESOF9999
          MOVE    AMCDCOD,AMMASOF
          MOVE    AMCDDES,SOFDESC
ESOF9999  RETURN
.---------------------------------
. Enter Manufaturer Code or Name
.---------------------------------
EMAN0000  MOVE    ZERO,CKEYTYP
          CALL    KAPMAA00
          BRANCH  EXIT,EMAN1000,EMAN9999
          MOVE    APMACRD,AMMAMANC
          MOVE    APMASN1,AMMAMANN
          GOTO    EMAN9999
EMAN1000  MOVE    "   31",FLDID
          CALL    GETPOSIT
          IF      EXIT=0
            STRIP     AMMAMANN
            SFORMAT   VAR,SCPSLEN
            MOVE      AMMAMANN,VAR
            KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
            MOVE      VAR,AMMAMANN
            MOVE      SP70,AMMAMANC
          ENDIF
          MOVE    "   30",FLDID
          CALL    GETPOSIT
EMAN9999  RETURN
.---------------------------------
. Enter Supplier Code or Name
.---------------------------------
ESUP0000  MOVE    ZERO,CKEYTYP
          CALL    KAPMAA00
          BRANCH  EXIT,ESUP1000,ESUP9999
          MOVE    APMACRD,AMMASUPC
          MOVE    APMASN1,AMMASUPN
          GOTO    ESUP9999
ESUP1000  MOVE    "   34",FLDID
          CALL    GETPOSIT
          IF      EXIT=0
            STRIP     AMMASUPN
            SFORMAT   VAR,SCPSLEN
            MOVE      AMMASUPN,VAR
            KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
            MOVE      VAR,AMMASUPN
            MOVE      SP70,AMMASUPC
          ENDIF
          MOVE    "   33",FLDID
          CALL    GETPOSIT
ESUP9999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EUC10000  MOVE    ZERO,CKEYTYP
          MOVE    "A1",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EUC19999,EUC19999
          MOVE    AMCDCOD,AMMAUC1
          MOVE    AMCDDES,UC1DESC
EUC19999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EUC20000  MOVE    ZERO,CKEYTYP
          MOVE    "A2",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EUC29999,EUC29999
          MOVE    AMCDCOD,AMMAUC2
          MOVE    AMCDDES,UC2DESC
EUC29999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EUC30000  MOVE    ZERO,CKEYTYP
          MOVE    "A3",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EUC39999,EUC39999
          MOVE    AMCDCOD,AMMAUC3
          MOVE    AMCDDES,UC3DESC
EUC39999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EUC40000  MOVE    ZERO,CKEYTYP
          MOVE    "A4",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EUC49999,EUC49999
          MOVE    AMCDCOD,AMMAUC4
          MOVE    AMCDDES,UC4DESC
EUC49999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
ETYP0000  MOVE    ZERO,CKEYTYP
          MOVE    "AT",AMCDCAT
          MOVE    SP70,TYPDESC
          CALL    KAMCDA00
          BRANCH  EXIT,ETYP9999,ETYP9999
          MOVE    AMCDCOD,AMMATYP
          MOVE    AMCDDES,TYPDESC
.
ETYP9999  RETURN
.------------------------------------
. Post for Insert Screens I1
.------------------------------------
PSC20000  MATCH     AMMADPT,AMDHFDPT
          CALL      DPTHIS00 IF NOT EQUAL    * Write Department History Record
.
          MATCH     AMMABLD,AMLHFBLD
          GOTO      PSC20100 IF NOT EQUAL
          MATCH     AMMALOC,AMLHFLOC
          GOTO      PSC20200 IF EQUAL
.
PSC20100  CALL      LOCHIS00                 * Write Location History Record
.
PSC20200  PACK     KEY14,AMMAREG,AMMAASS     * Setup Key
          CALL     RAAMMA1                   * Check for record on file
          IF       OVRCD=0
            CALL     UPAMMA1                 * Update Any Changes
            MOVE     THREE,AUDTTYPE          * After Change Type
            CALL     WAAMMA00                * Write Audit Record
          ENDIF
.
          PACK      KEY17,AMMAREG,AMMAASS,SP70
          CALL      RSAMAC1
PSC21200  CALL      RKAMAC1
          BRANCH    OVRCD,PSC21250
          MATCH     AMMAREG,AMACREG
          GOTO      PSC21250 IF NOT EQUAL
          MATCH     AMMAASS,AMACASS
          GOTO      PSC21250 IF NOT EQUAL
          PACK      KEY17,AMACREG,AMACASS,AMACLIN
          CALL      DEAMAC1
          GOTO      PSC21200
.
PSC21250  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          BRANCH    OVRCD,PSC21999
          MOVE      ZERO,F3
PSC21260  READ      TEMPWORD,SEQ;AMACCOM
          GOTO      PSC21999 IF OVER
          MOVE      F3,AMACLIN
          PACK      KEY17,AMMAREG,AMMAASS,AMACLIN
          UNPACK    KEY17,AMACREG,AMACASS,AMACLIN
          CALL      WRAMAC1
          ADD       ONE,F3
          GOTO      PSC21260
.
PSC21999  MOVE      THREE,AUDTSECT
          READ      CONTROLF,AUDTSECT;CFAMSRUN,CFAMYEAR
          MOVE      CFAMYEAR,EFFYEAR
          MOVE      ZERO,EFFPER
.
          PACK      KEY18,AMMAREG,AMMAASS,CFAMYEAR
          CALL      RDAMDS1
          BRANCH    OVRCD,PSC24000
.
          COMPARE   SAVECST,AMMACST
          GOTO      PSC22000 IF NOT EQUAL
.
          MATCH     SAVEAYR,AMMAAYR
          GOTO      PSC22500 IF NOT EQUAL
          MATCH     SAVEAPR,AMMAAPR
          GOTO      PSC22500 IF NOT EQUAL
.
          MATCH     SAVEAQD,AMMAAQD
          GOTO      PSC22000 IF NOT EQUAL
          MATCH     AMMATDT,AMDSTDT
          GOTO      PSC22000 IF NOT EQUAL
          MATCH     AMMAADT,AMDSADT
          GOTO      PSC22000 IF NOT EQUAL
          COMPARE   AMMATAD,AMDSTAD
          GOTO      PSC22000 IF NOT EQUAL
          COMPARE   AMMAAAD,AMDSAAD
          GOTO      PSC22000 IF NOT EQUAL
          COMPARE   AMMARVT,AMDSRVT
          GOTO      PSC22000 IF NOT EQUAL
          GOTO      PSC29999
.
PSC22000  CALL      MODDEP00         * Post Depreciation
          CALL      EASST110
          GOTO      PSC29999
.
PSC22500  MATCH     EFFYEAR,AMMAAYR
          GOTO      PSC22000 IF NOT EQUAL
          MOVE      SAVEAPR,F2     * Old
          MOVE      AMMAAPR,EFFPER * New
          IF        EFFPER<=F2
            GOTO      PSC22000     * New <= Old
          ENDIF
          CALL      FIXPER00       * Fix Period Balances
          GOTO      PSC22000       * New <= Old
.
PSC24000  CALL      ASSDEP00
          GOTO      PSC29999
.
PSC29999  RETURN
.-----------------------------------------------------------------------------
. Fix Period Balances
.----------------------
. This routine is triggered if the Depreciation start period is
. changed to a future period.  eg from period 6 to period 9.
. This routine will attempt to clear the intervening periods eg 6,7 & 8
. If any periods have been transferred to the GL then the amounts will
. be accumulated and adjusted in the first period not transferred to the
. GL.
.-----------------------------------------------------------------------------
FIXPER00  PACK      KEY18,AMMAREG,AMMAASS,EFFYEAR
          UNPACK    KEY18,AMDSREG,AMDSASS,AMDSYEAR
          CALL      RDAMDS1
          BRANCH    OVRCD,FIXPER99
.
          MOVE      AMMAAPR,EFFPER * New
          MOVE      SAVEAPR,F2     * Old
          MOVE      ZERO,SAVAMT
FIXPER10  LOAD      F1,F2,AMDSG01,AMDSG02,AMDSG03,AMDSG04,AMDSG05:
                          AMDSG06,AMDSG07,AMDSG08,AMDSG09,AMDSG10:
                          AMDSG11,AMDSG12,AMDSG13
          IF        F1=0
            STORE     ZERO,F2,AMDSA01,AMDSA02,AMDSA03,AMDSA04,AMDSA05:
                              AMDSA06,AMDSA07,AMDSA08,AMDSA09,AMDSA10:
                              AMDSA11,AMDSA12,AMDSA13
          ELSE
           LOAD       OLDAMT,F2,AMDSA01,AMDSA02,AMDSA03,AMDSA04,AMDSA05:
                                AMDSA06,AMDSA07,AMDSA08,AMDSA09,AMDSA10:
                                AMDSA11,AMDSA12,AMDSA13
           SUB        OLDAMT,SAVAMT    * Adj for Periods Transfered to GL
          ENDIF
          STORE     ZERO,F2,AMDST01,AMDST02,AMDST03,AMDST04,AMDST05:
                            AMDST06,AMDST07,AMDST08,AMDST09,AMDST10:
                            AMDST11,AMDST12,AMDST13
          ADD       ONE,F2
          COMPARE   F2,EFFPER
          GOTO      FIXPER10 IF NOT EQUAL
.
          COMPARE   ZERO,SAVAMT
          GOTO      FIXPER90 IF EQUAL
.
FIXPER30  COMPARE   "13",F2
          GOTO      FIXPER90 IF EQUAL
          ADD       ONE,F2
          LOAD      F1,F2,AMDSG01,AMDSG02,AMDSG03,AMDSG04,AMDSG05:
                              AMDSG06,AMDSG07,AMDSG08,AMDSG09,AMDSG10:
                              AMDSG11,AMDSG12,AMDSG13
          BRANCH    F1,FIXPER30
          LOAD      OLDAMT,F2,AMDSA01,AMDSA02,AMDSA03,AMDSA04,AMDSA05:
                              AMDSA06,AMDSA07,AMDSA08,AMDSA09,AMDSA10:
                              AMDSA11,AMDSA12,AMDSA13
          ADD       SAVAMT,OLDAMT
          STORE     OLDAMT,F2,AMDSA01,AMDSA02,AMDSA03,AMDSA04,AMDSA05:
                              AMDSA06,AMDSA07,AMDSA08,AMDSA09,AMDSA10:
                              AMDSA11,AMDSA12,AMDSA13
.
FIXPER90  PACK      KEY18,AMMAREG,AMMAASS,EFFYEAR
          CALL      RAAMDS1
          IF        OVRCD=0
            CALL      UPAMDS1
          ENDIF
FIXPER99  RETURN
.----------------------------------------
. Write Department History Record
.----------------------------------------
DPTHIS00  PACK      AMDHDAT,CCC,CYY,CMM,CDD
          REP       " 0",AMDHDAT
          PACK      KEY22,AMMAREG,AMMAASS,AMDHDAT
          UNPACK    KEY22,AMDHREG,AMDHASS,AMDHDAT
          CALL      RDAMDH1
          IF        OVRCD=1
            MOVE      SP70,AMDHCOM
          ENDIF
          MOVE      AMMADPT,AMDHTDPT
.
DPTHIS10  BEEP
          STRIP     AMDHCOM
          KEYIN     *P1:24,*EL,*B,"Department Change Comment : ":
                    *V2LON,*RV,AMDHCOM
          ENDSET    AMDHCOM
          APPEND    SP70,AMDHCOM
          RESET     AMDHCOM
          MATCH     SP70,AMDHCOM
          GOTO      DPTHIS10 IF EQUAL
.
DPTHIS20  KEYIN     *P70:24,"Ok ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      DPTHIS10 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      DPTHIS20 IF NOT EQUAL
          IF        OVRCD=0
            CALL      UPAMDH1
          ELSE
            CALL      WRAMDH1
          ENDIF
          RETURN
.----------------------------------------
. Write Location History Record
.----------------------------------------
LOCHIS00  PACK      AMLHDAT,CCC,CYY,CMM,CDD
          REP       " 0",AMLHDAT
          PACK      KEY22,AMMAREG,AMMAASS,AMLHDAT
          UNPACK    KEY22,AMLHREG,AMLHASS,AMLHDAT
          CALL      RDAMLH1
          IF        OVRCD=1
            MOVE      SP70,AMLHCOM
          ENDIF
          MOVE      AMMABLD,AMLHTBLD
          MOVE      AMMALOC,AMLHTLOC
.
LOCHIS10  BEEP
          STRIP     AMLHCOM
          KEYIN     *P1:24,*EL,*B,"Location Change Comment : ":
                    *V2LON,*RV,AMLHCOM
          ENDSET    AMLHCOM
          APPEND    SP70,AMLHCOM
          RESET     AMLHCOM
          MATCH     SP70,AMLHCOM
          GOTO      LOCHIS10 IF EQUAL
.
LOCHIS20  KEYIN     *P70:24,"Ok ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      LOCHIS10 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      LOCHIS20 IF NOT EQUAL
          IF        OVRCD=0
            CALL      UPAMLH1
          ELSE
            CALL      WRAMLH1
          ENDIF
          RETURN
.
ERPD0000   CALL     KEYDATE
           BRANCH   OVRCD,ERPD0000
           PACK     AMMARDT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",AMMARDT
.
           MATCH    AMMAAQD,AMMARDT
           GOTO     ERPD9999 IF NOT LESS
.
           BEEP
           MOVE     "Replacement Date Must be > Acquisition Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     ERPD0000
.
ERPD9999   RETURN
DATECURR  MOVE      CDD,CDAY
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          REP       " 0",CYEAR
          REP       " 0",CMON
          REP       " 0",CDAY
          RETURN
.------------------------------------
. Post for Insert Screens I1
.------------------------------------
PINS0000  PACK     KEY14,AMMAREG,AMMAASS     * Setup Key
          CALL     RAAMMA1                   * Check for record on file
          IF       OVRCD=0
            BEEP
            MOVE     "Asset Code Added By Another User - ",DISPMSG
            CALL     MESSAGE1
            GOTO     PINS9999
          ELSE
            CALL     WRAMMA1                 * Write New Record
            CALL     RLAMMA1                 * Lock New Record
            MOVE     ONE,AUDTTYPE            * New Record Audit Type
            CALL     WAAMMA00                * Write Audit Record
          ENDIF
          MOVE      THREE,SECTOR
          READ      CONTROLF,SECTOR;CFAMSRUN,CFAMYEAR
.
          PACK      KEY17,AMMAREG,AMMAASS,SP70
          CALL      RSAMAC1
PINS1200  CALL      RKAMAC1
          BRANCH    OVRCD,PINS1250
          MATCH     AMMAREG,AMACREG
          GOTO      PINS1250 IF NOT EQUAL
          MATCH     AMMAASS,AMACASS
          GOTO      PINS1250 IF NOT EQUAL
          PACK      KEY17,AMACREG,AMACASS,AMACLIN
          CALL      DEAMAC1
          GOTO      PINS1200
.
PINS1250  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          BRANCH    OVRCD,PINS1999
          MOVE      ZERO,F3
PINS1260  READ      TEMPWORD,SEQ;AMACCOM
          GOTO      PINS1999 IF OVER
          MOVE      F3,AMACLIN
          PACK      KEY17,AMMAREG,AMMAASS,AMACLIN
          UNPACK    KEY17,AMACREG,AMACASS,AMACLIN
          CALL      WRAMAC1
          ADD       ONE,F3
          GOTO      PINS1260
.
PINS1999  MOVE      ZERO,EFFYEAR
          MOVE      CFAMYEAR,EFFYEAR
          CALL      ASSDEP00
          MOVE      ONE,ACCEPT
          CALL      SCI2L000
.
PINS9999  RETURN
.------------------------------------------------------------
. Cancel Screen I2
.------------------------------------------------------------
CSI20000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,CSI21000,CSI29000,CSI29100
.
CSI21000  PACK     KEY14,AMMAREG,AMMAASS
          CALL     RAAMMA1
          IF       OVRCD=0
            CALL     DEAMMA1
            MOVE     FOUR,AUDTTYPE     * Delete Audit Type
            CALL     WAAMMA00          * Write Delete Audit
          ENDIF
          PACK      KEY17,AMMAREG,AMMAASS,SP70
          CALL      RSAMAC1
CSI21100  CALL      RKAMAC1
          BRANCH    OVRCD,CSI21200
          MATCH     AMMAREG,AMACREG
          GOTO      CSI21200 IF NOT EQUAL
          MATCH     AMMAASS,AMACASS
          GOTO      CSI21200 IF NOT EQUAL
          PACK      KEY17,AMACREG,AMACASS,AMACLIN
          CALL      DEAMAC1
          GOTO      CSI21100
.
CSI21200  MOVE     TWO,EXIT
          GOTO     CSI29999
.
CSI29000  MOVE     ONE,EXIT
          GOTO     CSI29999
CSI29100  MOVE     TWO,EXIT
          GOTO     CSI29999
CSI29999  RETURN
.
.------------------------------------
. Post for Insert Screens I1
.------------------------------------
PSI20000  PACK     KEY14,AMMAREG,AMMAASS     * Setup Key
          CALL     RAAMMA1                   * Check for record on file
          IF       OVRCD=0
            CALL     UPAMMA1                 * Update Any Changes
          ENDIF
          MOVE      ZERO,EFFYEAR
          MOVE      CFAMYEAR,EFFYEAR
          CALL      ASSDEP00
.
          PACK      KEY17,AMMAREG,AMMAASS,SP70
          CALL      RSAMAC1
PSI21200  CALL      RKAMAC1
          BRANCH    OVRCD,PSI21250
          MATCH     AMMAREG,AMACREG
          GOTO      PSI21250 IF NOT EQUAL
          MATCH     AMMAASS,AMACASS
          GOTO      PSI21250 IF NOT EQUAL
          PACK      KEY17,AMACREG,AMACASS,AMACLIN
          CALL      DEAMAC1
          GOTO      PSI21200
.
PSI21250  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          BRANCH    OVRCD,PSI21999
          MOVE      ZERO,F3
PSI21260  READ      TEMPWORD,SEQ;AMACCOM
          GOTO      PSI21999 IF OVER
          MOVE      F3,AMACLIN
          PACK      KEY17,AMMAREG,AMMAASS,AMACLIN
          UNPACK    KEY17,AMACREG,AMACASS,AMACLIN
          CALL      WRAMAC1
          ADD       ONE,F3
          GOTO      PSI21260
.
PSI21999  COMPARE   ONE,AMMALEA
          GOTO      PSI23000 IF NOT EQUAL
.
PSI22000  KEYIN     *P1:24,*EL,"Input Lease Details Now (":
                    *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      PSI23000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      PSI22000 IF NOT EQUAL
          MOVE      ONE,ACCEPT
          CALL      SCI3L000
.
PSI23000  KEYIN     *P1:24,*EL,"Input Insurance Details Now (":
                    *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      PSI24000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      PSI23000 IF NOT EQUAL
          MOVE      ONE,ACCEPT
.
. Clear Insurance Detials and Call Screen
.
          MOVE     SP70,AMINCOM
          MOVE     SP70,AMINCOD
          MOVE     SP70,AMINREF
          MOVE     SP70,AMINCON
          MOVE     SP70,AMINREF
          MOVE     SP70,AMINDAT
          MOVE     ZERO,AMINVAL
          MOVE     ZERO,AMINAPR
          MOVE     ZERO,AMINUA1
          MOVE     ZERO,AMINUA2
          MOVE     SP70,AMINUR1
          MOVE     SP70,AMINUR2
          MOVE     SP70,AMINUD1
          MOVE     SP70,AMINUD2
          MOVE     SP70,AMINUY1
          MOVE     SP70,AMINUY2
          MOVE     SP70,AMINSPA
.
          CALL     SCI4L000
.
PSI24000  PACK     KEY14,AMMAREG,AMMAASS     * Setup Key
          CALL     UUAMMA1                   * Unlock
.
PSI29999  RETURN
.
.---------------------------------
. Enter Lease Company Code or Name
.---------------------------------
ELEA0000  MOVE    ZERO,CKEYTYP
          CALL    KAPMAA00
          BRANCH  EXIT,ELEA1000,ELEA9999
          MOVE    APMACRD,AMLECOM
          MOVE    APMASN1,AMLECNM
          GOTO    ELEA9999
ELEA1000  MOVE    "    2",FLDID
          CALL    GETPOSIT
          IF      EXIT=0
            STRIP   AMLECNM
            SFORMAT VAR,SCPSLEN
            MOVE    AMLECNM,VAR
            KEYIN   *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
            MOVE    VAR,AMLECNM
            MOVE    SP70,AMLECOM
          ENDIF
          MOVE    "    1",FLDID
          CALL    GETPOSIT
ELEA9999  RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
EPMT0000  MOVE    ZERO,CKEYTYP
          MOVE    "PM",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,EPMT9999,EPMT9999
          MOVE    AMCDCOD,AMLEPMT
          MOVE    AMCDDES,PMTDESC
EPMT9999  RETURN
EEDT0000  UNPACK     AMLEDAT,KEY4,CMON,CDAY
          MOVE       KEY4,F4
          MOVE       CMON,F2
          ASSIGN     F4+(AMLEPER/12),F4
          ASSIGN     F2+(AMLEPER%12),F2
          MOVE       F4,KEY4
          REP        " 0",KEY4
          UNPACK     KEY4,CCENT,CYEAR
          MOVE       F2,CMON
          REP        " 0",CMON
          CALL       KEYDATE
          BRANCH     OVRCD,EEDT0000
          PACK       AMLEEDT,CCENT,CYEAR,CMON,CDAY
          RETURN
CSI30000
CSI39999  RETURN
PSI30000  PACK     KEY14,AMMAREG,AMMAASS     * Setup Key
          UNPACK   KEY14,AMLEREG,AMLEASS     * Setup Key
          CALL     RAAMLE1                   * Check for record on file
          IF       OVRCD=0
            CALL     UPAMLE1                 * Update Changes
            MOVE     THREE,AUDTTYPE          * After Change Type
            CALL     WAAMLE00                * Write Audit Record
          ELSE
            CALL     WRAMLE1                 * Write New Record
            MOVE     ONE,AUDTTYPE            * New Record Audit Type
            CALL     WAAMLE00                * Write Audit Record
          ENDIF
PSI39999  RETURN
.---------------------------------------
. Enter Insurance Company Code or Name
.---------------------------------------
EINC0000  MOVE    ZERO,CKEYTYP
          CALL    KAPMAA00
          BRANCH  EXIT,EINC1000,EINC9999
          MOVE    APMACRD,AMINCOM
          MOVE    APMASN1,AMINCOD
          GOTO    EINC9999
EINC1000  MOVE    "    2",FLDID
          CALL    GETPOSIT
          IF      EXIT=0
            STRIP   AMINCOD
            SFORMAT VAR,SCPSLEN
            MOVE    AMINCOD,VAR
            KEYIN   *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
            MOVE    VAR,AMINCOD
            MOVE    SP70,AMINCOM
          ENDIF
          MOVE    "    1",FLDID
          CALL    GETPOSIT
EINC9999  RETURN
CSI40000
CSI49999  RETURN
PSI40000  PACK     KEY14,AMMAREG,AMMAASS     * Setup Key
          UNPACK   KEY14,AMINREG,AMINASS     * Setup Key
          CALL     RAAMIN1                   * Check for record on file
          IF       OVRCD=0
            CALL     UPAMIN1                 * Update Changes
            MOVE     THREE,AUDTTYPE          * After Change Type
            CALL     WAAMIN00                * Write Audit Record
          ELSE
            CALL     WRAMIN1                 * Write New Record
            MOVE     ONE,AUDTTYPE            * New Record Audit Type
            CALL     WAAMIN00                * Write Audit Record
          ENDIF
PSI49999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSACMIO/INC
          INC       AMSCODIO/INC
          INC       AMSCODKY    
          INC       AMSDEPCD    
          INC       AMSDEPIO/INC
          INC       AMSDEPKY    
          INC       AMSDPHIO/INC
          INC       AMSDSFIO/INC
          INC       AMSGILIO/INC
          INC       AMSGILKY    
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSLOCKY    
          INC       AMSLOHIO/INC
          INC       AMSMASIO/INC
          INC       AMSMASKY    
          INC       AMSREGIO/INC
          INC       AMSREGKY    
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
.
          INC       STDGENCD
.
