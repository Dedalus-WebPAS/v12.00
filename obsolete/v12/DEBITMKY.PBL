.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBITMKY
.   Routine   :   KDBITA00 Keyin Sales Item          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KDBITA00 TOPIC     "DBITITM "
          MOVE      UNDLN70,DBITITM 
          KEYIN     *PCCOL:CVERT,*DV,DBITITM:                                   
                    *PCCOL:CVERT,*V2LON,DBITITM:                                
                    *PCCOL:CVERT,*DV,DBITITM 
.
          ENDSET    DBITITM 
          APPEND    SP70,DBITITM 
          RESET     DBITITM 
.
          MATCH     SP70,DBITITM 
          GOTO      KDBITA90 IF EQUAL
.
          CMATCH    EXITCHAR,DBITITM 
          GOTO      KDBITA95 IF EQUAL
.
          CMATCH    QUEST,DBITITM 
          GOTO      KDBITA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HDBITA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DBITITM 
          APPEND    SP70,DBITITM 
          RESET     DBITITM 
.
          MATCH     SP70,DBITITM 
          GOTO      KDBITA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DBITITM                                 
KDBITA10
          PACK      KEY8,DBITITM                                                
          CALL      RADBIT1 
          BRANCH    OVRCD,KDBITA80
          BRANCH    CKEYTYP,KDBITA75
          CALL      RDDBIT1 
KDBITA70
          MOVE      ZERO,EXIT
          GOTO      KDBITA99
KDBITA75
          MOVE      "Sales Item Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KDBITA00
KDBITA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KDBITA99,KDBITA99
          MOVE      "Sales Item Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KDBITA00
KDBITA90
          MOVE      ONE,EXIT
          GOTO      KDBITA99
KDBITA95
          MOVE      TWO,EXIT
KDBITA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBITMKY
.   Routine   :   HDBITA00 Sales Item          
.   Return    :           
.-------------------------------------------------------------------------------
HDBITA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "01",HLEF
            MOVE      "80",HRIG
          ENDIF
HDBITA04
          CALL      GSCRN000
          BRANCH    EXIT,HDBITA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 9",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Sales Item Name"    
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Product Type"       
.
          MOVE      STDCOL03,STDCOL04
          ADD       "36",STDCOL04
HDBITA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,DBITITM 
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          CALL      RSDBIT1 
HDBITA10
          CALL      RKDBIT1 
          BRANCH    OVRCD,HDBITA15
          MOVE      DBITPTY,KEY8
          CALL      RDDBPT1
.                                                                               
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HDBITA12
          CALL      HDBITA60
          BRANCH    OVRCD,HDBITA10
HDBITA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,DBITITM 
          DISPLAY   *PSTDCOL02:STDROW,DBITDES 
          DISPLAY   *PSTDCOL03:STDROW,DBPTDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HDBITA10 IF NOT EQUAL
HDBITA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HDBITA20
          CALL      HSCRI000
          BRANCH    EXIT,HDBITA30,HDBITA35,HDBITA40,HDBITA45,HDBITA04:
                              HDBITA91,HDBITA50
          GOTO      HDBITA92
HDBITA30
          CALL      RKDBIT1 
          BRANCH    OVRCD,HDBITA85
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          CALL      RPDBIT1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBITA10
HDBITA35
          MOVE      ST1,KEY8 
          CALL      RDDBIT1 
          CALL      RPDBIT1 
          BRANCH    OVRCD,HDBITA85
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HDBITA36
          CALL      RPDBIT1 
          BRANCH    OVRCD,HDBITA37
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBITA36 IF NOT EQUAL
HDBITA37
          MOVE      ZERO,XITEMNO
          GOTO      HDBITA10
HDBITA40
          MOVE      ST1,KEY8 
          CALL      RDDBIT1 
          CALL      RPDBIT1 
          BRANCH    OVRCD,HDBITA85
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBITA08
HDBITA45
          CALL      RKDBIT1 
          BRANCH    OVRCD,HDBITA85
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSDBIT1 
HDBITA46
          CALL      RPDBIT1 
          BRANCH    OVRCD,HDBITA47
          PACK      KEY8,DBITITM,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBITA46 IF NOT EQUAL
HDBITA47
          MOVE      ZERO,XITEMNO
          GOTO      HDBITA10
HDBITA50  COMPARE   ZERO,CSEARCH
          GOTO      HDBITA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBITA08
HDBITA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBITA08
HDBITA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HDBITA61 IF EQUAL
          MATCH     SCHFLD01,DBITITM 
          GOTO      HDBITA72 IF NOT EQUAL
HDBITA61
          MATCH     SP70,SCHFLD02
          GOTO      HDBITA62 IF EQUAL
          MATCH     SCHFLD02,DBITDES 
          GOTO      HDBITA72 IF NOT EQUAL
HDBITA62
          MATCH     SP70,SCHFLD03
          GOTO      HDBITA63 IF EQUAL
          MATCH     SCHFLD03,DBPTDES 
          GOTO      HDBITA72 IF NOT EQUAL
HDBITA63
HDBITA64
HDBITA65
HDBITA66
HDBITA67
HDBITA68
HDBITA69
HDBITA70
          GOTO      HDBITA75
HDBITA72  MOVE      ONE,OVRCD
HDBITA75  RETURN
HDBITA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,DBITITM                                                
          CALL      RDDBIT1 
HDBITA90
.                                                                               
          BEEP
          GOTO      HDBITA20
HDBITA91
          MOVE      SP70,DBITDES 
          MOVE      SP70,DBITIDE 
          MOVE      SP70,DBITUNT 
          MOVE      SP70,DBITPTY 
          MOVE      ZERO,DBITPRI 
          MOVE      ZERO,DBITMOD 
          MOVE      ZERO,DBITACT 
          MOVE      SP70,DBITLED 
          MOVE      SP70,DBITIAC 
          MOVE      SP70,DBITCAC 
          MOVE      ZERO,DBITTRT 
          MOVE      SP70,DBITTAC 
          MOVE      SP70,DBITTCA 
          MOVE      SP70,DBITUR1 
          MOVE      SP70,DBITUR2 
          MOVE      SP70,DBITUD1 
          MOVE      SP70,DBITUD2 
          MOVE      SP70,DBITUY1 
          MOVE      SP70,DBITUY2 
          MOVE      SP70,DBITUC1 
          MOVE      SP70,DBITUC2 
          MOVE      SP70,DBITUC3 
          MOVE      SP70,DBITUC4 
          MOVE      SP70,DBITGST 
          MOVE      SP70,DBITSPA 
          MOVE      SP70,KEY8 
          MOVE      SP70,DBITITM 
          GOTO      HDBITA96
HDBITA92
          MOVE      SP70,KEY8 
          MOVE      SP70,DBITITM 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,DBITITM                                                
HDBITA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HDBITA99
          RETURN
