.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBPTYKY
.   Routine   :   KDBPTA00 Keyin Product Type        
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KDBPTA00 TOPIC     "DBPTPTY "
          MOVE      UNDLN70,DBPTPTY 
          KEYIN     *PCCOL:CVERT,*DV,DBPTPTY:                                   
                    *PCCOL:CVERT,*V2LON,DBPTPTY:                                
                    *PCCOL:CVERT,*DV,DBPTPTY 
.
          ENDSET    DBPTPTY 
          APPEND    SP70,DBPTPTY 
          RESET     DBPTPTY 
.
          MATCH     SP70,DBPTPTY 
          GOTO      KDBPTA90 IF EQUAL
.
          CMATCH    EXITCHAR,DBPTPTY 
          GOTO      KDBPTA95 IF EQUAL
.
          CMATCH    QUEST,DBPTPTY 
          GOTO      KDBPTA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HDBPTA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DBPTPTY 
          APPEND    SP70,DBPTPTY 
          RESET     DBPTPTY 
.
          MATCH     SP70,DBPTPTY 
          GOTO      KDBPTA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DBPTPTY                                 
KDBPTA10
          PACK      KEY8,DBPTPTY                                                
          CALL      RADBPT1 
          BRANCH    OVRCD,KDBPTA80
          BRANCH    CKEYTYP,KDBPTA75
          CALL      RDDBPT1 
KDBPTA70
          MOVE      ZERO,EXIT
          GOTO      KDBPTA99
KDBPTA75
          MOVE      "Product Type Already Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KDBPTA00
KDBPTA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KDBPTA99,KDBPTA99
          MOVE      "Product Type Does Not Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KDBPTA00
KDBPTA90
          MOVE      ONE,EXIT
          GOTO      KDBPTA99
KDBPTA95
          MOVE      TWO,EXIT
KDBPTA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBPTYKY
.   Routine   :   HDBPTA00 Product Type        
.   Return    :   DBPTPTY 
.-------------------------------------------------------------------------------
HDBPTA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HDBPTA04
          CALL      GSCRN000
          BRANCH    EXIT,HDBPTA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 9",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Product Type"       
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HDBPTA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,DBPTPTY 
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          CALL      RSDBPT1 
HDBPTA10
          CALL      RKDBPT1 
          BRANCH    OVRCD,HDBPTA15
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HDBPTA12
          CALL      HDBPTA60
          BRANCH    OVRCD,HDBPTA10
HDBPTA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,DBPTPTY 
          DISPLAY   *PSTDCOL02:STDROW,DBPTDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HDBPTA10 IF NOT EQUAL
HDBPTA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HDBPTA20
          CALL      HSCRI000
          BRANCH    EXIT,HDBPTA30,HDBPTA35,HDBPTA40,HDBPTA45,HDBPTA04:
                              HDBPTA91,HDBPTA50
          GOTO      HDBPTA92
HDBPTA30
          CALL      RKDBPT1 
          BRANCH    OVRCD,HDBPTA85
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          CALL      RPDBPT1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBPTA10
HDBPTA35
          MOVE      ST1,KEY8 
          CALL      RDDBPT1 
          CALL      RPDBPT1 
          BRANCH    OVRCD,HDBPTA85
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HDBPTA36
          CALL      RPDBPT1 
          BRANCH    OVRCD,HDBPTA37
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBPTA36 IF NOT EQUAL
HDBPTA37
          MOVE      ZERO,XITEMNO
          GOTO      HDBPTA10
HDBPTA40
          MOVE      ST1,KEY8 
          CALL      RDDBPT1 
          CALL      RPDBPT1 
          BRANCH    OVRCD,HDBPTA85
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBPTA08
HDBPTA45
          CALL      RKDBPT1 
          BRANCH    OVRCD,HDBPTA85
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSDBPT1 
HDBPTA46
          CALL      RPDBPT1 
          BRANCH    OVRCD,HDBPTA47
          PACK      KEY8,DBPTPTY,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBPTA46 IF NOT EQUAL
HDBPTA47
          MOVE      ZERO,XITEMNO
          GOTO      HDBPTA10
HDBPTA50  COMPARE   ZERO,CSEARCH
          GOTO      HDBPTA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBPTA08
HDBPTA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBPTA08
HDBPTA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HDBPTA61 IF EQUAL
          MATCH     SCHFLD01,DBPTPTY 
          GOTO      HDBPTA72 IF NOT EQUAL
HDBPTA61
          MATCH     SP70,SCHFLD02
          GOTO      HDBPTA62 IF EQUAL
          MATCH     SCHFLD02,DBPTDES 
          GOTO      HDBPTA72 IF NOT EQUAL
HDBPTA62
HDBPTA63
HDBPTA64
HDBPTA65
HDBPTA66
HDBPTA67
HDBPTA68
HDBPTA69
HDBPTA70
          GOTO      HDBPTA75
HDBPTA72  MOVE      ONE,OVRCD
HDBPTA75  RETURN
HDBPTA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,DBPTPTY                                                
          CALL      RDDBPT1 
HDBPTA90
.                                                                               
          BEEP
          GOTO      HDBPTA20
HDBPTA91
          MOVE      SP70,DBPTDES 
          MOVE      ZERO,DBPTACT 
          MOVE      SP70,DBPTDEP 
          MOVE      SP70,DBPTUR1 
          MOVE      SP70,DBPTUR2 
          MOVE      SP70,DBPTUD1 
          MOVE      SP70,DBPTUD2 
          MOVE      SP70,DBPTUY1 
          MOVE      SP70,DBPTUY2 
          MOVE      SP70,DBPTUC1 
          MOVE      SP70,DBPTUC2 
          MOVE      SP70,DBPTSPA 
          MOVE      SP70,KEY8 
          MOVE      SP70,DBPTPTY 
          GOTO      HDBPTA96
HDBPTA92
          MOVE      SP70,KEY8 
          MOVE      SP70,DBPTPTY 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,DBPTPTY                                                
HDBPTA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HDBPTA99
          RETURN
