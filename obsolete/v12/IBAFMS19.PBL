.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
.V10.02.01  07/04/2011 Mike Laming for Jill CAR 239574
.           Remove CALL to ' IBAPRNT1,"ibaprntf" '
. V9.03.01  16.02.2004  Sandra Barcham
.           Changed variable FMRTFORM to FMRTFRMT in FMSRSTFD
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 27.10.2000 Charles Handaya
.           Added new Colum Type : 7=Statistical Units
.           Recompiled for FMSRSTFD, FMSRSTIO changes
.-------------------------------------------------------
. VF.01.02  21.08.2000 Charles Handaya
.           Fix Print the right Header according Page Width selected
.           (related to a bug from previous version below)
. VF.01.01  11.07.2000 Charles Handaya
.           Fix a very tricky FMUDWID Page Width options 1 (80) & 2 (132)
. VF.01.00  17.03.2000 Charles Handaya
.           Rewrite Program
.-------------------------------------------------------
CHNGMODE  FORM      1
CMDLINE   DIM       80
CURRPNTR  FORM      2
CURYEAR   DIM       2
.
DIM16     DIM       16
DIM17     DIM       17
DIM18     DIM       18
DIM20     DIM       20
DIM52     DIM       52
DISPFLAG  FORM      1
.
F12       FORM      12
F12P1     FORM      12.1
F12P2     FORM      12.2
F12P3     FORM      12.3
F12P4     FORM      12.4
FILLCOLM  DIM       1
FORM2A    FORM      2
FORM2B    FORM      2
FORM2C    FORM      2
.
IDESPWD1  INIT      " 80 Characters"
IDESPWD2  INIT      "132 Characters"
IDESPWD3  INIT      "160 Characters"
IDESPWD4  INIT      "210 Characters"
IDESTYP1  INIT      "Account Code       "
IDESTYP2  INIT      "Account Description"
IDESTYP3  INIT      "Amount             "
IDESTYP4  INIT      "Variance Amount    "
IDESTYP5  INIT      "Variance %         "
IDESTYP6  INIT      "Text               "
IDESTYP7  INIT      "Statistical Unit   "
IDESVT01  INIT      "Actual                         "
IDESVT02  INIT      "Budget                         "
IDESVT03  INIT      "Alternative Budget             "
IDESVT04  INIT      "Last Years Actual              "
IDESVT05  INIT      "Actual to Budget               "
IDESVT06  INIT      "Actual to Alternative Budget   "
IDESVT07  INIT      "Actual to Last Year            "
IDESVT08  INIT      "Budget to Last Year            "
IDESVT09  INIT      "Alternative Budget to Budget   "
IDESVT10  INIT      "Alternative Budget to Last Year"
IDESPE14  INIT      "Current Period                                "
IDESPE15  INIT      "Year to Date                                  "
IDESPE16  INIT      "Annual Budget                                 "
IDESPE17  INIT      "Brought Forward                               "
IDESPE18  INIT      "Projection                                    "
IDESPE19  INIT      "Committed Received                            "
IDESPE20  INIT      "Period Opening Balance                        "
IDESPE21  INIT      "Year to Date Movement                         "
IDESPE22  INIT      "Previous Period                               "
IDESPE23  INIT      "Different between Current & Previous          "
IDESPE24  INIT      "Committed Raised                              "
IDESPE25  INIT      "Annual Budget-(YTD Act+Comm.Raised+Comm.Recvd)"
IDESPE26  INIT      "Annual Budget-(YTD Actual+Committed Received) "
IDESSCA1  INIT      "Dollar & Cents"
IDESSCA2  INIT      "Dollars Only  "
IDESSCA3  INIT      "Thousands     "
.
LINECNTR  FORM      2
.
MAXCNTER  FORM      2
MAXCOLMN  FORM      2
.
NEXTFILD  FORM      1
.
PERDESC   DIM       2
.
RCLOAD    FORM      3
ROWCNTER  FORM      2
.
SP80      INIT      "                                        ":
                    "                                        "
SVHDLN1A  DIM       80
SVHDLN1B  DIM       80
SVHDLN1C  DIM       50
SVHDLN2A  DIM       80
SVHDLN2B  DIM       80
SVHDLN2C  DIM       50
.
TYPECNTR  FORM      2
.
X70       INIT      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
.  ---- vars added for print style routines ----
.
COLTYPE   FORM      2
COLWIDT   FORM      2
COLATYP   FORM      2
COLSCAL   FORM      2
COLPERD   FORM      2
COLFORM   DIM       20
COLWID    FORM      2    * Column Width
CURROW    FORM      2    * Row Counter
CURCOL    FORM      2    * Column Counter
COLUMN    FORM      3
COUNT     FORM      3
.
AMOUNTS   FORM      12.5 * Unformatted Amount
AMOUNTC   FORM      12.2 * Unformatted Amount
AMOUNTD   FORM      12   * Unformatted Amount
FAMOUNT   DIM       20   * Formatted Amount
CURPERD   DIM       2
DESC35    DIM       35
.
TCOL      DIM       1   * Temp Print Array 1 -36
TCOL01    DIM       1
TCOL02    DIM       1
TCOL03    DIM       1
TCOL04    DIM       1
TCOL05    DIM       1
TCOL06    DIM       1
TCOL07    DIM       1
TCOL08    DIM       1
TCOL09    DIM       1
TCOL10    DIM       1
TCOL11    DIM       1
TCOL12    DIM       1
TCOL13    DIM       1
TCOL14    DIM       1
TCOL15    DIM       1
TCOL16    DIM       1
TCOL17    DIM       1
TCOL18    DIM       1
TCOL19    DIM       1
TCOL20    DIM       1
TCOL21    DIM       1
TCOL22    DIM       1
TCOL23    DIM       1
TCOL24    DIM       1
TCOL25    DIM       1
TCOL26    DIM       1
TCOL27    DIM       1
TCOL28    DIM       1
TCOL29    DIM       1
TCOL30    DIM       1
TCOL31    DIM       1
TCOL32    DIM       1
TCOL33    DIM       1
TCOL34    DIM       1
TCOL35    DIM       1
TCOL36    DIM       1
 .
CO001     DIM       1     * Print Array 1 - 210
CO002     DIM       1
CO003     DIM       1
CO004     DIM       1
CO005     DIM       1
CO006     DIM       1
CO007     DIM       1
CO008     DIM       1
CO009     DIM       1
CO010     DIM       1
CO011     DIM       1
CO012     DIM       1
CO013     DIM       1
CO014     DIM       1
CO015     DIM       1
CO016     DIM       1
CO017     DIM       1
CO018     DIM       1
CO019     DIM       1
CO020     DIM       1
CO021     DIM       1
CO022     DIM       1
CO023     DIM       1
CO024     DIM       1
CO025     DIM       1
CO026     DIM       1
CO027     DIM       1
CO028     DIM       1
CO029     DIM       1
CO030     DIM       1
CO031     DIM       1
CO032     DIM       1
CO033     DIM       1
CO034     DIM       1
CO035     DIM       1
CO036     DIM       1
CO037     DIM       1
CO038     DIM       1
CO039     DIM       1
CO040     DIM       1
CO041     DIM       1
CO042     DIM       1
CO043     DIM       1
CO044     DIM       1
CO045     DIM       1
CO046     DIM       1
CO047     DIM       1
CO048     DIM       1
CO049     DIM       1
CO050     DIM       1
CO051     DIM       1
CO052     DIM       1
CO053     DIM       1
CO054     DIM       1
CO055     DIM       1
CO056     DIM       1
CO057     DIM       1
CO058     DIM       1
CO059     DIM       1
CO060     DIM       1
CO061     DIM       1
CO062     DIM       1
CO063     DIM       1
CO064     DIM       1
CO065     DIM       1
CO066     DIM       1
CO067     DIM       1
CO068     DIM       1
CO069     DIM       1
CO070     DIM       1
CO071     DIM       1
CO072     DIM       1
CO073     DIM       1
CO074     DIM       1
CO075     DIM       1
CO076     DIM       1
CO077     DIM       1
CO078     DIM       1
CO079     DIM       1
CO080     DIM       1
CO081     DIM       1
CO082     DIM       1
CO083     DIM       1
CO084     DIM       1
CO085     DIM       1
CO086     DIM       1
CO087     DIM       1
CO088     DIM       1
CO089     DIM       1
CO090     DIM       1
CO091     DIM       1
CO092     DIM       1
CO093     DIM       1
CO094     DIM       1
CO095     DIM       1
CO096     DIM       1
CO097     DIM       1
CO098     DIM       1
CO099     DIM       1
CO100     DIM       1
CO101     DIM       1
CO102     DIM       1
CO103     DIM       1
CO104     DIM       1
CO105     DIM       1
CO106     DIM       1
CO107     DIM       1
CO108     DIM       1
CO109     DIM       1
CO110     DIM       1
CO111     DIM       1
CO112     DIM       1
CO113     DIM       1
CO114     DIM       1
CO115     DIM       1
CO116     DIM       1
CO117     DIM       1
CO118     DIM       1
CO119     DIM       1
CO120     DIM       1
CO121     DIM       1
CO122     DIM       1
CO123     DIM       1
CO124     DIM       1
CO125     DIM       1
CO126     DIM       1
CO127     DIM       1
CO128     DIM       1
CO129     DIM       1
CO130     DIM       1
CO131     DIM       1
CO132     DIM       1
CO133     DIM       1
CO134     DIM       1
CO135     DIM       1
CO136     DIM       1
CO137     DIM       1
CO138     DIM       1
CO139     DIM       1
CO140     DIM       1
CO141     DIM       1
CO142     DIM       1
CO143     DIM       1
CO144     DIM       1
CO145     DIM       1
CO146     DIM       1
CO147     DIM       1
CO148     DIM       1
CO149     DIM       1
CO150     DIM       1
CO151     DIM       1
CO152     DIM       1
CO153     DIM       1
CO154     DIM       1
CO155     DIM       1
CO156     DIM       1
CO157     DIM       1
CO158     DIM       1
CO159     DIM       1
CO160     DIM       1
CO161     DIM       1
CO162     DIM       1
CO163     DIM       1
CO164     DIM       1
CO165     DIM       1
CO166     DIM       1
CO167     DIM       1
CO168     DIM       1
CO169     DIM       1
CO170     DIM       1
CO171     DIM       1
CO172     DIM       1
CO173     DIM       1
CO174     DIM       1
CO175     DIM       1
CO176     DIM       1
CO177     DIM       1
CO178     DIM       1
CO179     DIM       1
CO180     DIM       1
CO181     DIM       1
CO182     DIM       1
CO183     DIM       1
CO184     DIM       1
CO185     DIM       1
CO186     DIM       1
CO187     DIM       1
CO188     DIM       1
CO189     DIM       1
CO190     DIM       1
CO191     DIM       1
CO192     DIM       1
CO193     DIM       1
CO194     DIM       1
CO195     DIM       1
CO196     DIM       1
CO197     DIM       1
CO198     DIM       1
CO199     DIM       1
CO200     DIM       1
CO201     DIM       1
CO202     DIM       1
CO203     DIM       1
CO204     DIM       1
CO205     DIM       1
CO206     DIM       1
CO207     DIM       1
CO208     DIM       1
CO209     DIM       1
CO210     DIM       1
 .
STF010    INIT      "(9999,999 "
STF011    INIT      "(99,999.9 "
STF012    INIT      "(9,999.99 "
STF013    INIT      "(9999.999 "
STF014    INIT      "(999.9999 "
STF015    INIT      "(99.99999 "
.
STF020    INIT      "(9,999,999 "
STF021    INIT      "(999,999.9 "
STF022    INIT      "(99,999.99 "
STF023    INIT      "(9,999.999 "
STF024    INIT      "(9999.9999 "
STF025    INIT      "(999.99999 "
.
STF030    INIT      "(99,999,999 "
STF031    INIT      "(9999,999.9 "
STF032    INIT      "(999,999.99 "
STF033    INIT      "(99,999.999 "
STF034    INIT      "(9,999.9999 "
STF035    INIT      "(9999.99999 "
.
STF040    INIT      "(999,999,999 "
STF041    INIT      "(9,999,999.9 "
STF042    INIT      "(9999,999.99 "
STF043    INIT      "(999,999.999 "
STF044    INIT      "(99,999.9999 "
STF045    INIT      "(9,999.99999 "
.
STF050    INIT      "(9999,999,999 "
STF051    INIT      "(99,999,999.9 "
STF052    INIT      "(9,999,999.99 "
STF053    INIT      "(9999,999.999 "
STF054    INIT      "(999,999.9999 "
STF055    INIT      "(99,999.99999 "
.
STF060    INIT      "(9,999,999,999 "
STF061    INIT      "(999,999,999.9 "
STF062    INIT      "(99,999,999.99 "
STF063    INIT      "(9,999,999.999 "
STF064    INIT      "(9999,999.9999 "
STF065    INIT      "(999,999.99999 "
.
STF070    INIT      "(99,999,999,999 "
STF071    INIT      "(9999,999,999.9 "
STF072    INIT      "(999,999,999.99 "
STF073    INIT      "(99,999,999.999 "
STF074    INIT      "(9,999,999.9999 "
STF075    INIT      "(9999,999.99999 "
.
STF080    INIT      "(999,999,999,999 "
STF081    INIT      "(9,999,999,999.9 "
STF082    INIT      "(9999,999,999.99 "
STF083    INIT      "(999,999,999.999 "
STF084    INIT      "(99,999,999.9999 "
STF085    INIT      "(9,999,999.99999 "
.
STF090    INIT      "(9999,999,999,999 "
STF091    INIT      "(99,999,999,999.9 "
STF092    INIT      "(9,999,999,999.99 "
STF093    INIT      "(9999,999,999.999 "
STF094    INIT      "(999,999,999.9999 "
STF095    INIT      "(99,999,999.99999 "
.
STF100    INIT      "(9,999,999,999,999 "
STF101    INIT      "(999,999,999,999.9 "
STF102    INIT      "(99,999,999,999.99 "
STF103    INIT      "(9,999,999,999.999 "
STF104    INIT      "(9999,999,999.9999 "
STF105    INIT      "(999,999,999.99999 "
.
STF110    INIT      "(99,999,999,999,999 "
STF111    INIT      "(9999,999,999,999.9 "
STF112    INIT      "(999,999,999,999.99 "
STF113    INIT      "(99,999,999,999.999 "
STF114    INIT      "(9,999,999,999.9999 "
STF115    INIT      "(9999,999,999.99999 "
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAFMS19
.   Function      :   Report Style Maintenance                
.   Generated  On :   07/04/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       FMSAMAFD/INC
          INC       FMSLMAFD/INC
          INC       FMSLMCFD/INC
          INC       FMSRSTFD/INC
          INC       FMSUDRFD/INC
          INC       IBAPRNFD/INC
.=========================
.Local Variable Definition
.-------------------------
VRSTDDES  DIM      35 * Scr 00 Fld     6
VRSTDWID  DIM       1 * Scr 00 Fld     7
VRSTDROW  DIM       2 * Scr 00 Fld     8
VDESPWID  DIM      15 * Scr 00 Fld     9
VDESMXRW  FORM      2 * Scr 01 Fld     4
.
.    Multi Item Key Fields Scr 02 Fld     1
.-------------------------------------------------------
FMRT1NAM  INIT      "FMRT1"
FMRT1END  FORM      1   * End Display
FMRT1SNO  FORM      5   * Number of Items on the Screen
FMRT1MKY  DIM       127 * Match Key 
FMRT1EKY  DIM       127 * End Key
FMRT1SKY  DIM       127 * Start Key
FMRT1IDX  INIT      " 132 UC1-5"
FMRT1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
FMRT1FNM  DIM       8  * Filename
FMRT1CNT  FORM      3  * Number of Items on Screen
RTYPDESC  DIM      19 * Scr 02 Fld     3
VTYPDESC  DIM      31 * Scr 02 Fld     5
VDESTYPE  DIM      19 * Scr 03 Fld     3
VRSTDH11  DIM      80 * Scr 04 Fld     9
VRSTDH12  DIM      80 * Scr 04 Fld    10
VRSTDH13  DIM      50 * Scr 04 Fld    11
VRSTDH21  DIM      80 * Scr 04 Fld    12
VRSTDH22  DIM      80 * Scr 04 Fld    13
VRSTDH23  DIM      50 * Scr 04 Fld    14
VDESRH1A  DIM      80 * Scr 04 Fld    15
VDESRH1B  DIM      80 * Scr 04 Fld    16
VDESRH1C  DIM      50 * Scr 04 Fld    17
VDESRH2A  DIM      80 * Scr 04 Fld    18
VDESRH2B  DIM      80 * Scr 04 Fld    19
VDESRH2C  DIM      50 * Scr 04 Fld    20
FROMRSTY  DIM       3 * Scr 05 Fld     1
TORSTY    DIM       3 * Scr 05 Fld     2
VDESMXWD  FORM      2 * Scr 3A Fld     6
VDESMNWD  FORM      2 * Scr 3A Fld     7
VDESVTYP  DIM      31 * Scr 3B Fld     9
VDESPERI  DIM      46 * Scr 3B Fld    11
VDESSCAL  DIM      14 * Scr 3B Fld    13
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAFMS19"
PRGNAM    INIT      "Report Style Maintenance                "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SELPRT00
          CALL      SC00L000
          CLOSE     FMRT1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA2,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA3,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA4,"fmsamaaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 43",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudam";
            OPEN      FMSAUDAM,"fmsaudam"
          ENDIF
          MOVE      "   51",AUDTSECT
          MOVE      " 46",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudla";
            OPEN      FMSAUDLA,"fmsaudla"
          ENDIF
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening fmslmcaf";
          OPEN      FMSLMCA1,"fmslmcaf"
          DISPLAY   *P56:24,"Opening fmsrstaf";
          OPEN      FMSRSTA1,"fmsrstaf"
          DISPLAY   *P56:24,"Opening  fmsudraf           ";
          OPEN      FMSUDRA1,"fmsudraf"          
.--------------------------------------------------------
. Initialise Batch Screen Line Number                        
.--------------------------------------------------------
          MOVE     ZERO,FMRT1SNO
          MOVE     "02    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,FMRT1SNO
            ENDIF
          ENDIF
          PACK      FMRT1FNM,ANST,FMRT1NAM,PORT
          REP       " 0",FMRT1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMRT1FL1,FMRT1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     FMRT1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,FMRT1FNM,FMRT1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",FMRT1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      FMRT1FL1,FMRT1FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Report Keyin                  
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Report Detail Keyin                
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Report Style Summary               
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Column Type Detail Keyin           
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Report Heading Lines               
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Copy Report Style                  
          ENDIF
          MATCH     "3A",SCRID
          IF         @EQUAL
            CALL       PS3AL000   * Account Type Detail Screen         
          ENDIF
          MATCH     "3B",SCRID
          IF         @EQUAL
            CALL       PS3BL000   * Amount/Variant Type Detail Screen  
          ENDIF
          MATCH     "3C",SCRID
          IF         @EQUAL
            CALL       PS3CL000   * Text Type Detail Screen            
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Report Keyin                  
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Report Keyin                  
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,FMUDSTY 
          MOVE      SP70,VRSTDDES
          MOVE      SP70,VRSTDWID
          MOVE      SP70,VRSTDROW
          MOVE      SP70,VDESPWID
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Report Keyin                  
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ERST0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      FMUDSTY,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Report Keyin                  
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Report Keyin                  
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Report Keyin                  
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Report Keyin                  
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      VRSTDDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      VRSTDWID,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      VRSTDROW,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      VDESPWID,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Report Keyin                  
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L105,SF00L106:
                            SF00L006,SF00L107
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L104,SF00L105,SF00L106:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      POSA0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      CANA0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELA0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L104
          CALL     SELECTED
          STRIP     VRSTDDES
          SFORMAT   VAR,SCPSLEN
          MOVE      VRSTDDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,VRSTDDES
          SFORMAT   VAR,127
          ENDSET    VRSTDDES
          APPEND    SP70,VRSTDDES
          RESET     VRSTDDES
          CMATCH    EXITCHAR,VRSTDDES
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,VRSTDDES
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
          ENDIF
          MOVE      VRSTDDES,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VDESPWID
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPWD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      VRSTDWID,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESPWID,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EROW0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      VRSTDROW,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL      COPY0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Report Detail Keyin                
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Report Detail Keyin                
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Report Detail Keyin                
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMUDDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VDESMXRW
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      DRST0000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      FMUDSTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMUDDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESMXRW,VAR     
            CALL      DISPITEM
          ENDIF
.
KY01L120
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EROW0000
          BRANCH    EXIT,KY01L110,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      VRSTDROW,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Report Detail Keyin                
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Report Detail Keyin                
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Report Detail Keyin                
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Report Detail Keyin                
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L101,PS01L999,PS01L102
          GOTO     PS01L999
.
PS01L101
          MOVE      FMUDDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      VDESMXRW,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Report Detail Keyin                
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Report Style Summary               
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Report Style Summary               
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Report Style Summary               
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Report Style Summary               
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Report Style Summary               
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     1 Line Number                        
.---------------------------------------------------------
          UNPACK    SP70,FMRTSTYC,FMRTROWN,FMRTLINE
          PACK      KEY7,FMUDSTY,VRSTDROW,SP70
          MOVE      KEY7,FMRT1EKY
          STRIP     FMRT1SKY
          SETLPTR   FMRT1EKY,5
          MOVE      FMRT1EKY,FMRT1SKY
          CALL      RDFMRT1 
          IF        OVRCD=0
            CALL      RPFMRT1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,FMRT1CNT
          MOVE     ZERO,FMRT1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L101,DP02L102,DP02L103,DP02L104:
                            DP02L105,DP02L106,DP02L107,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      FMRT1MKY,SP70,SP70
          CALL      UPTFMRT1
          IF        FMRT1END=0
            CALL      RKFMRT1 
            IF        OVRCD=0
              PACK      FMRT1MKY,FMRTSTYC,FMRTROWN,FMRTLINE                                                     
              MATCH     FMRT1EKY,FMRT1MKY
              IF        @EQUAL
                MOVE      ZERO,FMRT1END
                ADD       ONE,FMRT1CNT
                CALL      UPTFMRT1
                MOVE      FMRTLINE,VAR     
                CALL      DISPITEM
          CALL      RDES0000
              ELSE
                MOVE      ONE,FMRT1END
              ENDIF
            ELSE
              MOVE      ONE,FMRT1END
            ENDIF
          ENDIF
          IF        FMRT1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        FMRT1END=0
            MOVE      FMRTTYPE,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        FMRT1END=0
            MOVE      RTYPDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        FMRT1END=0
            MOVE      FMRTVTYP,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        FMRT1END=0
            MOVE      VTYPDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        FMRT1END=0
            MOVE      FMRTWIDT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        FMRT1END=0
            MOVE      FMRTFRMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "FMRT1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "FMRT1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY7,FMRT1SKY,SP70
          CALL     RDFMRT1  * Start
          IF       OVRCD=0
            CALL     RPFMRT1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "FMRT1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY7,FMRT1SKY,Z70
          CALL     RSFMRT1  * End
          IF       OVRCD=1
            CALL     RPFMRT1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<FMRT1SNO
            CALL     RPFMRT1 
            IF       OVRCD=1
              MOVE     FMRT1SNO,SECTOR
            ENDIF
            PACK     FMRT1MKY,FMRTSTYC,FMRTROWN,FMRTLINE                                                     
            MATCH    FMRT1EKY,FMRT1MKY
            IF       !@EQUAL
              MOVE     FMRT1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "FMRT1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTFMRT1
          BRANCH   OVRCD,PP02L115
          MOVE      FMRT1MKY,KEY7  
          CALL      RSFMRT1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=FMRT1SNO
            CALL     RPFMRT1 
            IF       OVRCD=1
              MOVE     FMRT1SNO,SECTOR
            ENDIF
            PACK     FMRT1MKY,FMRTSTYC,FMRTROWN,FMRTLINE                                                     
            MATCH    FMRT1EKY,FMRT1MKY
            IF       !@EQUAL
              MOVE     FMRT1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<FMRT1SNO
            CALL     RKFMRT1 
            IF       OVRCD=1
              MOVE     FMRT1SNO,SECTOR
            ENDIF
            PACK     FMRT1MKY,FMRTSTYC,FMRTROWN,FMRTLINE                                                     
            MATCH    FMRT1EKY,FMRT1MKY
            IF       !@EQUAL
              MOVE     FMRT1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "FMRT1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKFMRT1 
          BRANCH   OVRCD,NP02L110
          PACK     FMRT1MKY,FMRTSTYC,FMRTROWN,FMRTLINE                                                     
          MATCH    FMRT1EKY,FMRT1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPFMRT1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPFMRT1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Report Style Summary               
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Line Number                        
.---------------------------------------------------------
UPTFMRT1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      FMRT1FL1,KEY5;ANS
          IF        @OVER
            WRITE     FMRT1FL1,KEY5;SCPSROW,SCPSCOL,FMRT1MKY
          ELSE
            UPDATE    FMRT1FL1;SCPSROW,SCPSCOL,FMRT1MKY
          ENDIF
          RETURN
RDTFMRT1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      FMRT1FL1,KEY5;SCPSROW,SCPSCOL,FMRT1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTFMRT1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      FMRT1FL1,KEY5;;
          READKS    FMRT1FL1;SCPSROW,SCPSCOL,FMRT1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,FMRT1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Report Style Summary               
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "FMRT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Report Style Summary               
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Report Style Summary               
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L102,SF02L006,SF02L006,SF02L103:
                            SF02L104,SF02L105,SF02L106,SF02L006:
                           SF02L107,SF02L108
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "FMRT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTFMRT1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,FMRT1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      FMRT1MKY,KEY7  
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SLIN0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTFMRT1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      FMRT1MKY,KEY7  
            CALL      RSFMRT1 
            CALL      RPFMRT1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          CALL      SLIN0000
          GOTO      SF02L001
.
SF02L103
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L104
          MOVE      "FMRT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "FMRT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ALIN0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L107
          MOVE      "FMRT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L108
          MOVE      "FMRT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Column Type Detail Keyin           
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Column Type Detail Keyin           
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Column Type Detail Keyin           
.--------------------------------------------------------
KY03L000
.
KY03L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      STLN0000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      FMRTLINE,VAR     
          CALL      DISPITEM
.
KY03L120
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VDESTYPE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ETYP0000
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      OVRCD,ACCEPT
          CALL      MVACCEPT
          MOVE      FMRTTYPE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESTYPE,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Column Type Detail Keyin           
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Column Type Detail Keyin           
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Column Type Detail Keyin           
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Column Type Detail Keyin           
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L101
          GOTO     PS03L999
.
PS03L101
          MOVE      VDESTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Column Type Detail Keyin           
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Report Heading Lines               
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Report Heading Lines               
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Report Heading Lines               
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Report Heading Lines               
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Report Heading Lines               
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Report Heading Lines               
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Report Heading Lines               
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L101,PS04L102,PS04L103,PS04L104:
                            PS04L105,PS04L106,PS04L107,PS04L108:
                            PS04L109,PS04L110,PS04L111,PS04L112:
                            PS04L113,PS04L114,PS04L115,PS04L116:
                            PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      FMRTSTYC,VAR     
          CALL      DISPITEM
          CALL      DCHA0000
          GOTO     PS04L999
.
PS04L102
          MOVE      VRSTDDES,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      VDESMXRW,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      VDESPWID,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      VRSTDH11,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      VRSTDH12,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      VRSTDH13,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      VRSTDH21,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      VRSTDH22,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      VRSTDH23,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      VDESRH1A,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      VDESRH1B,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      VDESRH1C,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      VDESRH2A,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      VDESRH2B,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      VDESRH2C,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Report Heading Lines               
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L104,SF04L006,SF04L006,SF04L105:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L106
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L104,SF04L020,SF04L020,SF04L105:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          CALL      POSD0000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      CAND0000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      EHEA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      VRSTDH11,VAR     
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L105
          CALL     SELECTED
          MOVE      "2",CKEYTYP
          CALL      EHEB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L105
            ENDIF
            BRANCH    EXIT,SF04L105,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      VRSTDH21,VAR     
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L106
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Copy Report Style                  
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Copy Report Style                  
.-------------------------------------------------------
CF05L000
          MOVE      SP70,FROMRSTY
          MOVE      SP70,TORSTY  
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Copy Report Style                  
.--------------------------------------------------------
KY05L000
.
KY05L110
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      CRST0000
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      TORSTY,VAR       
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Copy Report Style                  
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Copy Report Style                  
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Copy Report Style                  
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Copy Report Style                  
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L101,PS05L999
          GOTO     PS05L999
.
PS05L101
          MOVE      FROMRSTY,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Copy Report Style                  
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.--------------------------------
. Screen - Account Type Detail Screen         
.--------------------------------
SC3AL000
SC3AL100
          MOVE      "3A",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 9",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC3AL200
          CALL      CF3AL000 * Clear Fields
          CALL      ST3X0000
SC3AL300
          CALL      KY3AL000 * Enter Key Fields
          BRANCH    EXIT,SC3AL999,SC3AL999
SC3AL400
          CALL      WP3AL000 * Load any WP Details
SC3AL500
          CALL      LM3AL000 * Load any Batch Details
SC3AL600
          CALL      DF3AL000 * Display Fields
SC3AL700
          CALL      SF3AL000 * Select Fields
          BRANCH    EXIT,SC3AL100,SC3AL100,SC3AL200
SC3AL800
SC3AL900
SC3AL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Account Type Detail Screen         
.-------------------------------------------------------
CF3AL000
CF3AL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Account Type Detail Screen         
.--------------------------------------------------------
KY3AL000
          MOVE      ZERO,EXIT
          GOTO      KY3AL999
.
KY3AL900  MOVE      ONE,EXIT
KY3AL999  RETURN
.---------------------------------------------------------
. Load WP files for : Account Type Detail Screen         
.---------------------------------------------------------
WP3AL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Account Type Detail Screen         
.---------------------------------------------------------
LM3AL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Account Type Detail Screen         
.---------------------------------------------------------
DF3AL000
          BRANCH   ACCEPT,DF3AL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF3AL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF3AL900
          MATCH    PRGID,SCPSPID
          GOTO     DF3AL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF3AL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF3AL010 IF NOT EQUAL
.
          CALL     PS3AL000 * Display Field
          GOTO     DF3AL010
DF3AL900
DF3AL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Account Type Detail Screen         
.---------------------------------------------------------
PS3AL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS3AL999,PS3AL999,PS3AL999,PS3AL999:
                            PS3AL101,PS3AL102,PS3AL103
          GOTO     PS3AL999
.
PS3AL101
          MOVE      FMRTWIDT,VAR     
          CALL      DISPITEM
          GOTO     PS3AL999
.
PS3AL102
          MOVE      VDESMXWD,VAR     
          CALL      DISPITEM
          GOTO     PS3AL999
.
PS3AL103
          MOVE      VDESMNWD,VAR     
          CALL      DISPITEM
          GOTO     PS3AL999
PS3AL999
          RETURN
.---------------------------------------------------------
. Selections for : Account Type Detail Screen         
.---------------------------------------------------------
SF3AL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF3AL001  BRANCH   ACCEPT,SF3AL020
.
SF3AL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF3AL006,SF3AL101,SF3AL102,SF3AL103:
                            SF3AL104,SF3AL006,SF3AL006
SF3AL006  BEEP
          GOTO     SF3AL005
SF3AL020  CALL     RKSCSL1
          BRANCH   OVRCD,SF3AL090
          MATCH    PRGID,SCSLPID
          GOTO     SF3AL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF3AL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF3AL020,SF3AL020,SF3AL020,SF3AL020:
                            SF3AL104,SF3AL020,SF3AL020
          GOTO     SF3AL020
SF3AL090  MOVE     ZERO,ACCEPT
          GOTO     SF3AL001
.
SF3AL101
          CALL      POSC0000
          MOVE      ZERO,EXIT
          GOTO      SF3AL999
.
SF3AL102
          CALL      CANC0000
          MOVE      ZERO,EXIT
          GOTO      SF3AL999
.
SF3AL103
          CALL      DELC0000
          MOVE      ZERO,EXIT
          GOTO      SF3AL999
.
SF3AL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWID0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3AL104
            ENDIF
            BRANCH    EXIT,SF3AL104,SF3AL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3AL990 IF EQUAL
          ENDIF
          MOVE      FMRTWIDT,VAR     
          CALL      DISPITEM
          GOTO     SF3AL001
SF3AL990  MOVE      ONE,EXIT * Exit Char Restart
SF3AL999  RETURN
.--------------------------------
. Screen - Amount/Variant Type Detail Screen  
.--------------------------------
SC3BL000
SC3BL100
          MOVE      "3B",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 9",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC3BL200
          CALL      CF3BL000 * Clear Fields
          CALL      ST3X0000
SC3BL300
          CALL      KY3BL000 * Enter Key Fields
          BRANCH    EXIT,SC3BL999,SC3BL999
SC3BL400
          CALL      WP3BL000 * Load any WP Details
SC3BL500
          CALL      LM3BL000 * Load any Batch Details
SC3BL600
          CALL      DF3BL000 * Display Fields
SC3BL700
          CALL      SF3BL000 * Select Fields
          BRANCH    EXIT,SC3BL100,SC3BL100,SC3BL200
SC3BL800
SC3BL900
SC3BL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Amount/Variant Type Detail Screen  
.-------------------------------------------------------
CF3BL000
CF3BL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Amount/Variant Type Detail Screen  
.--------------------------------------------------------
KY3BL000
          MOVE      ZERO,EXIT
          GOTO      KY3BL999
.
KY3BL900  MOVE      ONE,EXIT
KY3BL999  RETURN
.---------------------------------------------------------
. Load WP files for : Amount/Variant Type Detail Screen  
.---------------------------------------------------------
WP3BL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Amount/Variant Type Detail Screen  
.---------------------------------------------------------
LM3BL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Amount/Variant Type Detail Screen  
.---------------------------------------------------------
DF3BL000
          BRANCH   ACCEPT,DF3BL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF3BL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF3BL900
          MATCH    PRGID,SCPSPID
          GOTO     DF3BL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF3BL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF3BL010 IF NOT EQUAL
.
          CALL     PS3BL000 * Display Field
          GOTO     DF3BL010
DF3BL900
DF3BL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Amount/Variant Type Detail Screen  
.---------------------------------------------------------
PS3BL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS3BL999,PS3BL999,PS3BL999,PS3BL999:
                            PS3BL101,PS3BL102,PS3BL103,PS3BL104:
                            PS3BL105,PS3BL106,PS3BL107,PS3BL108:
                            PS3BL109,PS3BL110
          GOTO     PS3BL999
.
PS3BL101
          MOVE      FMRTWIDT,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL102
          MOVE      VDESMXWD,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL103
          MOVE      VDESMNWD,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL104
          MOVE      FMRTVTYP,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL105
          MOVE      VDESVTYP,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL106
          MOVE      FMRTPERI,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL107
          MOVE      VDESPERI,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL108
          MOVE      FMRTSCAL,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL109
          MOVE      VDESSCAL,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
.
PS3BL110
          MOVE      FMRTFRMT,VAR     
          CALL      DISPITEM
          GOTO     PS3BL999
PS3BL999
          RETURN
.---------------------------------------------------------
. Selections for : Amount/Variant Type Detail Screen  
.---------------------------------------------------------
SF3BL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF3BL001  BRANCH   ACCEPT,SF3BL020
.
SF3BL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF3BL006,SF3BL101,SF3BL102,SF3BL103:
                            SF3BL104,SF3BL006,SF3BL006,SF3BL105:
                            SF3BL006,SF3BL106,SF3BL006,SF3BL107:
                            SF3BL006,SF3BL108
SF3BL006  BEEP
          GOTO     SF3BL005
SF3BL020  CALL     RKSCSL1
          BRANCH   OVRCD,SF3BL090
          MATCH    PRGID,SCSLPID
          GOTO     SF3BL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF3BL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF3BL020,SF3BL020,SF3BL020,SF3BL020:
                            SF3BL104,SF3BL020,SF3BL020,SF3BL105:
                            SF3BL020,SF3BL106,SF3BL020,SF3BL107:
                            SF3BL020,SF3BL108
          GOTO     SF3BL020
SF3BL090  MOVE     ZERO,ACCEPT
          GOTO     SF3BL001
.
SF3BL101
          CALL      POSC0000
          MOVE      ZERO,EXIT
          GOTO      SF3BL999
.
SF3BL102
          CALL      CANC0000
          MOVE      ZERO,EXIT
          GOTO      SF3BL999
.
SF3BL103
          CALL      DELC0000
          MOVE      ZERO,EXIT
          GOTO      SF3BL999
.
SF3BL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWID0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3BL104
            ENDIF
            BRANCH    EXIT,SF3BL104,SF3BL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3BL990 IF EQUAL
          ENDIF
          MOVE      FMRTWIDT,VAR     
          CALL      DISPITEM
          GOTO     SF3BL001
.
SF3BL105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VDESVTYP
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EVTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3BL105
            ENDIF
            BRANCH    EXIT,SF3BL105,SF3BL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3BL990 IF EQUAL
          ENDIF
          MOVE      FMRTVTYP,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESVTYP,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF3BL001
.
SF3BL106
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VDESPERI
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EAPE0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3BL106
            ENDIF
            BRANCH    EXIT,SF3BL106,SF3BL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3BL990 IF EQUAL
          ENDIF
          MOVE      FMRTPERI,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESPERI,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF3BL001
.
SF3BL107
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VDESSCAL
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESCA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3BL107
            ENDIF
            BRANCH    EXIT,SF3BL107,SF3BL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3BL990 IF EQUAL
          ENDIF
          MOVE      FMRTSCAL,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESSCAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF3BL001
.
SF3BL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFOR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3BL108
            ENDIF
            BRANCH    EXIT,SF3BL108,SF3BL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3BL990 IF EQUAL
          ENDIF
          MOVE      FMRTFRMT,VAR     
          CALL      DISPITEM
          GOTO     SF3BL001
SF3BL990  MOVE      ONE,EXIT * Exit Char Restart
SF3BL999  RETURN
.--------------------------------
. Screen - Text Type Detail Screen            
.--------------------------------
SC3CL000
SC3CL100
          MOVE      "3C",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 9",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC3CL200
          CALL      CF3CL000 * Clear Fields
          CALL      ST3X0000
SC3CL300
          CALL      KY3CL000 * Enter Key Fields
          BRANCH    EXIT,SC3CL999,SC3CL999
SC3CL400
          CALL      WP3CL000 * Load any WP Details
SC3CL500
          CALL      LM3CL000 * Load any Batch Details
SC3CL600
          CALL      DF3CL000 * Display Fields
SC3CL700
          CALL      SF3CL000 * Select Fields
          BRANCH    EXIT,SC3CL100,SC3CL100,SC3CL200
SC3CL800
SC3CL900
SC3CL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Text Type Detail Screen            
.-------------------------------------------------------
CF3CL000
CF3CL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Text Type Detail Screen            
.--------------------------------------------------------
KY3CL000
          MOVE      ZERO,EXIT
          GOTO      KY3CL999
.
KY3CL900  MOVE      ONE,EXIT
KY3CL999  RETURN
.---------------------------------------------------------
. Load WP files for : Text Type Detail Screen            
.---------------------------------------------------------
WP3CL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Text Type Detail Screen            
.---------------------------------------------------------
LM3CL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Text Type Detail Screen            
.---------------------------------------------------------
DF3CL000
          BRANCH   ACCEPT,DF3CL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF3CL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF3CL900
          MATCH    PRGID,SCPSPID
          GOTO     DF3CL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF3CL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF3CL010 IF NOT EQUAL
.
          CALL     PS3CL000 * Display Field
          GOTO     DF3CL010
DF3CL900
DF3CL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Text Type Detail Screen            
.---------------------------------------------------------
PS3CL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS3CL999,PS3CL999,PS3CL999,PS3CL999:
                            PS3CL101,PS3CL102,PS3CL103,PS3CL104
          GOTO     PS3CL999
.
PS3CL101
          MOVE      FMRTWIDT,VAR     
          CALL      DISPITEM
          GOTO     PS3CL999
.
PS3CL102
          MOVE      VDESMXWD,VAR     
          CALL      DISPITEM
          GOTO     PS3CL999
.
PS3CL103
          MOVE      VDESMNWD,VAR     
          CALL      DISPITEM
          GOTO     PS3CL999
.
PS3CL104
          MOVE      FMRTFRMT,VAR     
          CALL      DISPITEM
          GOTO     PS3CL999
PS3CL999
          RETURN
.---------------------------------------------------------
. Selections for : Text Type Detail Screen            
.---------------------------------------------------------
SF3CL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF3CL001  BRANCH   ACCEPT,SF3CL020
.
SF3CL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF3CL006,SF3CL101,SF3CL102,SF3CL103:
                            SF3CL104,SF3CL006,SF3CL006,SF3CL105
SF3CL006  BEEP
          GOTO     SF3CL005
SF3CL020  CALL     RKSCSL1
          BRANCH   OVRCD,SF3CL090
          MATCH    PRGID,SCSLPID
          GOTO     SF3CL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF3CL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF3CL020,SF3CL020,SF3CL020,SF3CL020:
                            SF3CL104,SF3CL020,SF3CL020,SF3CL105
          GOTO     SF3CL020
SF3CL090  MOVE     ZERO,ACCEPT
          GOTO     SF3CL001
.
SF3CL101
          CALL      POSC0000
          MOVE      ZERO,EXIT
          GOTO      SF3CL999
.
SF3CL102
          CALL      CANC0000
          MOVE      ZERO,EXIT
          GOTO      SF3CL999
.
SF3CL103
          CALL      DELC0000
          MOVE      ZERO,EXIT
          GOTO      SF3CL999
.
SF3CL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWID0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3CL104
            ENDIF
            BRANCH    EXIT,SF3CL104,SF3CL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3CL990 IF EQUAL
          ENDIF
          MOVE      FMRTWIDT,VAR     
          CALL      DISPITEM
          GOTO     SF3CL001
.
SF3CL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFOR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF3CL105
            ENDIF
            BRANCH    EXIT,SF3CL105,SF3CL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF3CL990 IF EQUAL
          ENDIF
          MOVE      FMRTFRMT,VAR     
          CALL      DISPITEM
          GOTO     SF3CL001
SF3CL990  MOVE      ONE,EXIT * Exit Char Restart
SF3CL999  RETURN
.@@@@@ Function Restart Point @@@@@
.**********************************************************************
. SELPRT00 - select printer routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
SELPRT00  OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
          MOVE      SP70,SPLFILE
          CALL      SELPRINT
          RETURN
.------------------------------------------------------------
. Post Report Style Screen 00
.------------------------------------------------------------
POSA0000  CALL      CLRSF000
          CALL      CFMRD000                * clear report style temp. detail
          CALL      VMOD0000
          BRANCH    CHNGMODE,POSA0100
.
          GOTO      POSA0200
.
POSA0100  PACK      KEY3,FMUDSTY,SP70
          CALL      RDFMUD1
.
          CALL      LFMRD000                * load detail into report style temp
          MOVE      FMUDROW,VDESMXRW
.
POSA0200  CALL      SC01L000
.
POSA9999  RETURN
.------------------------------------------------------------
. Validate whether change or insert mode
.------------------------------------------------------------
VMOD0000  MOVE      ZERO,CHNGMODE
.
          PACK      KEY3,FMUDSTY,SP70
          CALL      RAFMUD1
          BRANCH    OVRCD,VMOD9999
.
          MOVE      ONE,CHNGMODE
.
VMOD9999  RETURN
.------------------------------------------------------------
. Clear all Report Style fields
.------------------------------------------------------------
CLRSF000  PACK      FMUDH11,SP70,SP70
          PACK      FMUDH12,SP70,SP70
          PACK      FMUDH13,SP70,SP70
          PACK      FMUDH21,SP70,SP70
          PACK      FMUDH22,SP70,SP70
          PACK      FMUDH23,SP70,SP70
.                                           * Row 1
          MOVE      ZERO,FMUDT101
          MOVE      ZERO,FMUDW101
          MOVE      ZERO,FMUDA101
          MOVE      ZERO,FMUDS101
          MOVE      ZERO,FMUDP101
          PACK      FMUDF101,SP70
.
          MOVE      ZERO,FMUDT102
          MOVE      ZERO,FMUDW102
          MOVE      ZERO,FMUDA102
          MOVE      ZERO,FMUDS102
          MOVE      ZERO,FMUDP102
          PACK      FMUDF102,SP70
.
          MOVE      ZERO,FMUDT103
          MOVE      ZERO,FMUDW103
          MOVE      ZERO,FMUDA103
          MOVE      ZERO,FMUDS103
          MOVE      ZERO,FMUDP103
          PACK      FMUDF103,SP70
.
          MOVE      ZERO,FMUDT104
          MOVE      ZERO,FMUDW104
          MOVE      ZERO,FMUDA104
          MOVE      ZERO,FMUDS104
          MOVE      ZERO,FMUDP104
          PACK      FMUDF104,SP70
.
          MOVE      ZERO,FMUDT105
          MOVE      ZERO,FMUDW105
          MOVE      ZERO,FMUDA105
          MOVE      ZERO,FMUDS105
          MOVE      ZERO,FMUDP105
          PACK      FMUDF105,SP70
.
          MOVE      ZERO,FMUDT106
          MOVE      ZERO,FMUDW106
          MOVE      ZERO,FMUDA106
          MOVE      ZERO,FMUDS106
          MOVE      ZERO,FMUDP106
          PACK      FMUDF106,SP70
.
          MOVE      ZERO,FMUDT107
          MOVE      ZERO,FMUDW107
          MOVE      ZERO,FMUDA107
          MOVE      ZERO,FMUDS107
          MOVE      ZERO,FMUDP107
          PACK      FMUDF107,SP70
.
          MOVE      ZERO,FMUDT108
          MOVE      ZERO,FMUDW108
          MOVE      ZERO,FMUDA108
          MOVE      ZERO,FMUDS108
          MOVE      ZERO,FMUDP108
          PACK      FMUDF108,SP70
.
          MOVE      ZERO,FMUDT109
          MOVE      ZERO,FMUDW109
          MOVE      ZERO,FMUDA109
          MOVE      ZERO,FMUDS109
          MOVE      ZERO,FMUDP109
          PACK      FMUDF109,SP70
.
          MOVE      ZERO,FMUDT110
          MOVE      ZERO,FMUDW110
          MOVE      ZERO,FMUDA110
          MOVE      ZERO,FMUDS110
          MOVE      ZERO,FMUDP110
          PACK      FMUDF110,SP70
.
          MOVE      ZERO,FMUDT111
          MOVE      ZERO,FMUDW111
          MOVE      ZERO,FMUDA111
          MOVE      ZERO,FMUDS111
          MOVE      ZERO,FMUDP111
          PACK      FMUDF111,SP70
.
          MOVE      ZERO,FMUDT112
          MOVE      ZERO,FMUDW112
          MOVE      ZERO,FMUDA112
          MOVE      ZERO,FMUDS112
          MOVE      ZERO,FMUDP112
          PACK      FMUDF112,SP70
.
          MOVE      ZERO,FMUDT113
          MOVE      ZERO,FMUDW113
          MOVE      ZERO,FMUDA113
          MOVE      ZERO,FMUDS113
          MOVE      ZERO,FMUDP113
          PACK      FMUDF113,SP70
.
          MOVE      ZERO,FMUDT114
          MOVE      ZERO,FMUDW114
          MOVE      ZERO,FMUDA114
          MOVE      ZERO,FMUDS114
          MOVE      ZERO,FMUDP114
          PACK      FMUDF114,SP70
.
          MOVE      ZERO,FMUDT115
          MOVE      ZERO,FMUDW115
          MOVE      ZERO,FMUDA115
          MOVE      ZERO,FMUDS115
          MOVE      ZERO,FMUDP115
          PACK      FMUDF115,SP70
.
          MOVE      ZERO,FMUDT116
          MOVE      ZERO,FMUDW116
          MOVE      ZERO,FMUDA116
          MOVE      ZERO,FMUDS116
          MOVE      ZERO,FMUDP116
          PACK      FMUDF116,SP70
.
          MOVE      ZERO,FMUDT117
          MOVE      ZERO,FMUDW117
          MOVE      ZERO,FMUDA117
          MOVE      ZERO,FMUDS117
          MOVE      ZERO,FMUDP117
          PACK      FMUDF117,SP70
.
          MOVE      ZERO,FMUDT118
          MOVE      ZERO,FMUDW118
          MOVE      ZERO,FMUDA118
          MOVE      ZERO,FMUDS118
          MOVE      ZERO,FMUDP118
          PACK      FMUDF118,SP70
.
          MOVE      ZERO,FMUDT119
          MOVE      ZERO,FMUDW119
          MOVE      ZERO,FMUDA119
          MOVE      ZERO,FMUDS119
          MOVE      ZERO,FMUDP119
          PACK      FMUDF119,SP70
.
          MOVE      ZERO,FMUDT120
          MOVE      ZERO,FMUDW120
          MOVE      ZERO,FMUDA120
          MOVE      ZERO,FMUDS120
          MOVE      ZERO,FMUDP120
          PACK      FMUDF120,SP70
.                                           * Row 2
          MOVE      ZERO,FMUDT201
          MOVE      ZERO,FMUDW201
          MOVE      ZERO,FMUDA201
          MOVE      ZERO,FMUDS201
          MOVE      ZERO,FMUDP201
          PACK      FMUDF201,SP70
.
          MOVE      ZERO,FMUDT202
          MOVE      ZERO,FMUDW202
          MOVE      ZERO,FMUDA202
          MOVE      ZERO,FMUDS202
          MOVE      ZERO,FMUDP202
          PACK      FMUDF202,SP70
.
          MOVE      ZERO,FMUDT203
          MOVE      ZERO,FMUDW203
          MOVE      ZERO,FMUDA203
          MOVE      ZERO,FMUDS203
          MOVE      ZERO,FMUDP203
          PACK      FMUDF203,SP70
.
          MOVE      ZERO,FMUDT204
          MOVE      ZERO,FMUDW204
          MOVE      ZERO,FMUDA204
          MOVE      ZERO,FMUDS204
          MOVE      ZERO,FMUDP204
          PACK      FMUDF204,SP70
.
          MOVE      ZERO,FMUDT205
          MOVE      ZERO,FMUDW205
          MOVE      ZERO,FMUDA205
          MOVE      ZERO,FMUDS205
          MOVE      ZERO,FMUDP205
          PACK      FMUDF205,SP70
.
          MOVE      ZERO,FMUDT206
          MOVE      ZERO,FMUDW206
          MOVE      ZERO,FMUDA206
          MOVE      ZERO,FMUDS206
          MOVE      ZERO,FMUDP206
          PACK      FMUDF206,SP70
.
          MOVE      ZERO,FMUDT207
          MOVE      ZERO,FMUDW207
          MOVE      ZERO,FMUDA207
          MOVE      ZERO,FMUDS207
          MOVE      ZERO,FMUDP207
          PACK      FMUDF207,SP70
.
          MOVE      ZERO,FMUDT208
          MOVE      ZERO,FMUDW208
          MOVE      ZERO,FMUDA208
          MOVE      ZERO,FMUDS208
          MOVE      ZERO,FMUDP208
          PACK      FMUDF208,SP70
.
          MOVE      ZERO,FMUDT209
          MOVE      ZERO,FMUDW209
          MOVE      ZERO,FMUDA209
          MOVE      ZERO,FMUDS209
          MOVE      ZERO,FMUDP209
          PACK      FMUDF209,SP70
.
          MOVE      ZERO,FMUDT210
          MOVE      ZERO,FMUDW210
          MOVE      ZERO,FMUDA210
          MOVE      ZERO,FMUDS210
          MOVE      ZERO,FMUDP210
          PACK      FMUDF210,SP70
.
          MOVE      ZERO,FMUDT211
          MOVE      ZERO,FMUDW211
          MOVE      ZERO,FMUDA211
          MOVE      ZERO,FMUDS211
          MOVE      ZERO,FMUDP211
          PACK      FMUDF211,SP70
.
          MOVE      ZERO,FMUDT212
          MOVE      ZERO,FMUDW212
          MOVE      ZERO,FMUDA212
          MOVE      ZERO,FMUDS212
          MOVE      ZERO,FMUDP212
          PACK      FMUDF212,SP70
.
          MOVE      ZERO,FMUDT213
          MOVE      ZERO,FMUDW213
          MOVE      ZERO,FMUDA213
          MOVE      ZERO,FMUDS213
          MOVE      ZERO,FMUDP213
          PACK      FMUDF213,SP70
.
          MOVE      ZERO,FMUDT214
          MOVE      ZERO,FMUDW214
          MOVE      ZERO,FMUDA214
          MOVE      ZERO,FMUDS214
          MOVE      ZERO,FMUDP214
          PACK      FMUDF214,SP70
.
          MOVE      ZERO,FMUDT215
          MOVE      ZERO,FMUDW215
          MOVE      ZERO,FMUDA215
          MOVE      ZERO,FMUDS215
          MOVE      ZERO,FMUDP215
          PACK      FMUDF215,SP70
.
          MOVE      ZERO,FMUDT216
          MOVE      ZERO,FMUDW216
          MOVE      ZERO,FMUDA216
          MOVE      ZERO,FMUDS216
          MOVE      ZERO,FMUDP216
          PACK      FMUDF216,SP70
.
          MOVE      ZERO,FMUDT217
          MOVE      ZERO,FMUDW217
          MOVE      ZERO,FMUDA217
          MOVE      ZERO,FMUDS217
          MOVE      ZERO,FMUDP217
          PACK      FMUDF217,SP70
.
          MOVE      ZERO,FMUDT218
          MOVE      ZERO,FMUDW218
          MOVE      ZERO,FMUDA218
          MOVE      ZERO,FMUDS218
          MOVE      ZERO,FMUDP218
          PACK      FMUDF218,SP70
.
          MOVE      ZERO,FMUDT219
          MOVE      ZERO,FMUDW219
          MOVE      ZERO,FMUDA219
          MOVE      ZERO,FMUDS219
          MOVE      ZERO,FMUDP219
          PACK      FMUDF219,SP70
.
          MOVE      ZERO,FMUDT220
          MOVE      ZERO,FMUDW220
          MOVE      ZERO,FMUDA220
          MOVE      ZERO,FMUDS220
          MOVE      ZERO,FMUDP220
          PACK      FMUDF220,SP70
.                                           * Row 3
          MOVE      ZERO,FMUDT301
          MOVE      ZERO,FMUDW301
          MOVE      ZERO,FMUDA301
          MOVE      ZERO,FMUDS301
          MOVE      ZERO,FMUDP301
          PACK      FMUDF301,SP70
.
          MOVE      ZERO,FMUDT302
          MOVE      ZERO,FMUDW302
          MOVE      ZERO,FMUDA302
          MOVE      ZERO,FMUDS302
          MOVE      ZERO,FMUDP302
          PACK      FMUDF302,SP70
.
          MOVE      ZERO,FMUDT303
          MOVE      ZERO,FMUDW303
          MOVE      ZERO,FMUDA303
          MOVE      ZERO,FMUDS303
          MOVE      ZERO,FMUDP303
          PACK      FMUDF303,SP70
.
          MOVE      ZERO,FMUDT304
          MOVE      ZERO,FMUDW304
          MOVE      ZERO,FMUDA304
          MOVE      ZERO,FMUDS304
          MOVE      ZERO,FMUDP304
          PACK      FMUDF304,SP70
.
          MOVE      ZERO,FMUDT305
          MOVE      ZERO,FMUDW305
          MOVE      ZERO,FMUDA305
          MOVE      ZERO,FMUDS305
          MOVE      ZERO,FMUDP305
          PACK      FMUDF305,SP70
.
          MOVE      ZERO,FMUDT306
          MOVE      ZERO,FMUDW306
          MOVE      ZERO,FMUDA306
          MOVE      ZERO,FMUDS306
          MOVE      ZERO,FMUDP306
          PACK      FMUDF306,SP70
.
          MOVE      ZERO,FMUDT307
          MOVE      ZERO,FMUDW307
          MOVE      ZERO,FMUDA307
          MOVE      ZERO,FMUDS307
          MOVE      ZERO,FMUDP307
          PACK      FMUDF307,SP70
.
          MOVE      ZERO,FMUDT308
          MOVE      ZERO,FMUDW308
          MOVE      ZERO,FMUDA308
          MOVE      ZERO,FMUDS308
          MOVE      ZERO,FMUDP308
          PACK      FMUDF308,SP70
.
          MOVE      ZERO,FMUDT309
          MOVE      ZERO,FMUDW309
          MOVE      ZERO,FMUDA309
          MOVE      ZERO,FMUDS309
          MOVE      ZERO,FMUDP309
          PACK      FMUDF309,SP70
.
          MOVE      ZERO,FMUDT310
          MOVE      ZERO,FMUDW310
          MOVE      ZERO,FMUDA310
          MOVE      ZERO,FMUDS310
          MOVE      ZERO,FMUDP310
          PACK      FMUDF310,SP70
.
          MOVE      ZERO,FMUDT311
          MOVE      ZERO,FMUDW311
          MOVE      ZERO,FMUDA311
          MOVE      ZERO,FMUDS311
          MOVE      ZERO,FMUDP311
          PACK      FMUDF311,SP70
.
          MOVE      ZERO,FMUDT312
          MOVE      ZERO,FMUDW312
          MOVE      ZERO,FMUDA312
          MOVE      ZERO,FMUDS312
          MOVE      ZERO,FMUDP312
          PACK      FMUDF312,SP70
.
          MOVE      ZERO,FMUDT313
          MOVE      ZERO,FMUDW313
          MOVE      ZERO,FMUDA313
          MOVE      ZERO,FMUDS313
          MOVE      ZERO,FMUDP313
          PACK      FMUDF313,SP70
.
          MOVE      ZERO,FMUDT314
          MOVE      ZERO,FMUDW314
          MOVE      ZERO,FMUDA314
          MOVE      ZERO,FMUDS314
          MOVE      ZERO,FMUDP314
          PACK      FMUDF314,SP70
.
          MOVE      ZERO,FMUDT315
          MOVE      ZERO,FMUDW315
          MOVE      ZERO,FMUDA315
          MOVE      ZERO,FMUDS315
          MOVE      ZERO,FMUDP315
          PACK      FMUDF315,SP70
.
          MOVE      ZERO,FMUDT316
          MOVE      ZERO,FMUDW316
          MOVE      ZERO,FMUDA316
          MOVE      ZERO,FMUDS316
          MOVE      ZERO,FMUDP316
          PACK      FMUDF316,SP70
.
          MOVE      ZERO,FMUDT317
          MOVE      ZERO,FMUDW317
          MOVE      ZERO,FMUDA317
          MOVE      ZERO,FMUDS317
          MOVE      ZERO,FMUDP317
          PACK      FMUDF317,SP70
.
          MOVE      ZERO,FMUDT318
          MOVE      ZERO,FMUDW318
          MOVE      ZERO,FMUDA318
          MOVE      ZERO,FMUDS318
          MOVE      ZERO,FMUDP318
          PACK      FMUDF318,SP70
.
          MOVE      ZERO,FMUDT319
          MOVE      ZERO,FMUDW319
          MOVE      ZERO,FMUDA319
          MOVE      ZERO,FMUDS319
          MOVE      ZERO,FMUDP319
          PACK      FMUDF319,SP70
.
          MOVE      ZERO,FMUDT320
          MOVE      ZERO,FMUDW320
          MOVE      ZERO,FMUDA320
          MOVE      ZERO,FMUDS320
          MOVE      ZERO,FMUDP320
          PACK      FMUDF320,SP70
.                                           * Row 4
          MOVE      ZERO,FMUDT401
          MOVE      ZERO,FMUDW401
          MOVE      ZERO,FMUDA401
          MOVE      ZERO,FMUDS401
          MOVE      ZERO,FMUDP401
          PACK      FMUDF401,SP70
.
          MOVE      ZERO,FMUDT402
          MOVE      ZERO,FMUDW402
          MOVE      ZERO,FMUDA402
          MOVE      ZERO,FMUDS402
          MOVE      ZERO,FMUDP402
          PACK      FMUDF402,SP70
.
          MOVE      ZERO,FMUDT403
          MOVE      ZERO,FMUDW403
          MOVE      ZERO,FMUDA403
          MOVE      ZERO,FMUDS403
          MOVE      ZERO,FMUDP403
          PACK      FMUDF403,SP70
.
          MOVE      ZERO,FMUDT404
          MOVE      ZERO,FMUDW404
          MOVE      ZERO,FMUDA404
          MOVE      ZERO,FMUDS404
          MOVE      ZERO,FMUDP404
          PACK      FMUDF404,SP70
.
          MOVE      ZERO,FMUDT405
          MOVE      ZERO,FMUDW405
          MOVE      ZERO,FMUDA405
          MOVE      ZERO,FMUDS405
          MOVE      ZERO,FMUDP405
          PACK      FMUDF405,SP70
.
          MOVE      ZERO,FMUDT406
          MOVE      ZERO,FMUDW406
          MOVE      ZERO,FMUDA406
          MOVE      ZERO,FMUDS406
          MOVE      ZERO,FMUDP406
          PACK      FMUDF406,SP70
.
          MOVE      ZERO,FMUDT407
          MOVE      ZERO,FMUDW407
          MOVE      ZERO,FMUDA407
          MOVE      ZERO,FMUDS407
          MOVE      ZERO,FMUDP407
          PACK      FMUDF407,SP70
.
          MOVE      ZERO,FMUDT408
          MOVE      ZERO,FMUDW408
          MOVE      ZERO,FMUDA408
          MOVE      ZERO,FMUDS408
          MOVE      ZERO,FMUDP408
          PACK      FMUDF408,SP70
.
          MOVE      ZERO,FMUDT409
          MOVE      ZERO,FMUDW409
          MOVE      ZERO,FMUDA409
          MOVE      ZERO,FMUDS409
          MOVE      ZERO,FMUDP409
          PACK      FMUDF409,SP70
.
          MOVE      ZERO,FMUDT410
          MOVE      ZERO,FMUDW410
          MOVE      ZERO,FMUDA410
          MOVE      ZERO,FMUDS410
          MOVE      ZERO,FMUDP410
          PACK      FMUDF410,SP70
.
          MOVE      ZERO,FMUDT411
          MOVE      ZERO,FMUDW411
          MOVE      ZERO,FMUDA411
          MOVE      ZERO,FMUDS411
          MOVE      ZERO,FMUDP411
          PACK      FMUDF411,SP70
.
          MOVE      ZERO,FMUDT412
          MOVE      ZERO,FMUDW412
          MOVE      ZERO,FMUDA412
          MOVE      ZERO,FMUDS412
          MOVE      ZERO,FMUDP412
          PACK      FMUDF412,SP70
.
          MOVE      ZERO,FMUDT413
          MOVE      ZERO,FMUDW413
          MOVE      ZERO,FMUDA413
          MOVE      ZERO,FMUDS413
          MOVE      ZERO,FMUDP413
          PACK      FMUDF413,SP70
.
          MOVE      ZERO,FMUDT414
          MOVE      ZERO,FMUDW414
          MOVE      ZERO,FMUDA414
          MOVE      ZERO,FMUDS414
          MOVE      ZERO,FMUDP414
          PACK      FMUDF414,SP70
.
          MOVE      ZERO,FMUDT415
          MOVE      ZERO,FMUDW415
          MOVE      ZERO,FMUDA415
          MOVE      ZERO,FMUDS415
          MOVE      ZERO,FMUDP415
          PACK      FMUDF415,SP70
.
          MOVE      ZERO,FMUDT416
          MOVE      ZERO,FMUDW416
          MOVE      ZERO,FMUDA416
          MOVE      ZERO,FMUDS416
          MOVE      ZERO,FMUDP416
          PACK      FMUDF416,SP70
.
          MOVE      ZERO,FMUDT417
          MOVE      ZERO,FMUDW417
          MOVE      ZERO,FMUDA417
          MOVE      ZERO,FMUDS417
          MOVE      ZERO,FMUDP417
          PACK      FMUDF417,SP70
.
          MOVE      ZERO,FMUDT418
          MOVE      ZERO,FMUDW418
          MOVE      ZERO,FMUDA418
          MOVE      ZERO,FMUDS418
          MOVE      ZERO,FMUDP418
          PACK      FMUDF418,SP70
.
          MOVE      ZERO,FMUDT419
          MOVE      ZERO,FMUDW419
          MOVE      ZERO,FMUDA419
          MOVE      ZERO,FMUDS419
          MOVE      ZERO,FMUDP419
          PACK      FMUDF419,SP70
.
          MOVE      ZERO,FMUDT420
          MOVE      ZERO,FMUDW420
          MOVE      ZERO,FMUDA420
          MOVE      ZERO,FMUDS420
          MOVE      ZERO,FMUDP420
          PACK      FMUDF420,SP70
.                                           * Row 5
          MOVE      ZERO,FMUDT501
          MOVE      ZERO,FMUDW501
          MOVE      ZERO,FMUDA501
          MOVE      ZERO,FMUDS501
          MOVE      ZERO,FMUDP501
          PACK      FMUDF501,SP70
.
          MOVE      ZERO,FMUDT502
          MOVE      ZERO,FMUDW502
          MOVE      ZERO,FMUDA502
          MOVE      ZERO,FMUDS502
          MOVE      ZERO,FMUDP502
          PACK      FMUDF502,SP70
.
          MOVE      ZERO,FMUDT503
          MOVE      ZERO,FMUDW503
          MOVE      ZERO,FMUDA503
          MOVE      ZERO,FMUDS503
          MOVE      ZERO,FMUDP503
          PACK      FMUDF503,SP70
.
          MOVE      ZERO,FMUDT504
          MOVE      ZERO,FMUDW504
          MOVE      ZERO,FMUDA504
          MOVE      ZERO,FMUDS504
          MOVE      ZERO,FMUDP504
          PACK      FMUDF504,SP70
.
          MOVE      ZERO,FMUDT505
          MOVE      ZERO,FMUDW505
          MOVE      ZERO,FMUDA505
          MOVE      ZERO,FMUDS505
          MOVE      ZERO,FMUDP505
          PACK      FMUDF505,SP70
.
          MOVE      ZERO,FMUDT506
          MOVE      ZERO,FMUDW506
          MOVE      ZERO,FMUDA506
          MOVE      ZERO,FMUDS506
          MOVE      ZERO,FMUDP506
          PACK      FMUDF506,SP70
.
          MOVE      ZERO,FMUDT507
          MOVE      ZERO,FMUDW507
          MOVE      ZERO,FMUDA507
          MOVE      ZERO,FMUDS507
          MOVE      ZERO,FMUDP507
          PACK      FMUDF507,SP70
.
          MOVE      ZERO,FMUDT508
          MOVE      ZERO,FMUDW508
          MOVE      ZERO,FMUDA508
          MOVE      ZERO,FMUDS508
          MOVE      ZERO,FMUDP508
          PACK      FMUDF508,SP70
.
          MOVE      ZERO,FMUDT509
          MOVE      ZERO,FMUDW509
          MOVE      ZERO,FMUDA509
          MOVE      ZERO,FMUDS509
          MOVE      ZERO,FMUDP509
          PACK      FMUDF509,SP70
.
          MOVE      ZERO,FMUDT510
          MOVE      ZERO,FMUDW510
          MOVE      ZERO,FMUDA510
          MOVE      ZERO,FMUDS510
          MOVE      ZERO,FMUDP510
          PACK      FMUDF510,SP70
.
          MOVE      ZERO,FMUDT511
          MOVE      ZERO,FMUDW511
          MOVE      ZERO,FMUDA511
          MOVE      ZERO,FMUDS511
          MOVE      ZERO,FMUDP511
          PACK      FMUDF511,SP70
.
          MOVE      ZERO,FMUDT512
          MOVE      ZERO,FMUDW512
          MOVE      ZERO,FMUDA512
          MOVE      ZERO,FMUDS512
          MOVE      ZERO,FMUDP512
          PACK      FMUDF512,SP70
.
          MOVE      ZERO,FMUDT513
          MOVE      ZERO,FMUDW513
          MOVE      ZERO,FMUDA513
          MOVE      ZERO,FMUDS513
          MOVE      ZERO,FMUDP513
          PACK      FMUDF513,SP70
.
          MOVE      ZERO,FMUDT514
          MOVE      ZERO,FMUDW514
          MOVE      ZERO,FMUDA514
          MOVE      ZERO,FMUDS514
          MOVE      ZERO,FMUDP514
          PACK      FMUDF514,SP70
.
          MOVE      ZERO,FMUDT515
          MOVE      ZERO,FMUDW515
          MOVE      ZERO,FMUDA515
          MOVE      ZERO,FMUDS515
          MOVE      ZERO,FMUDP515
          PACK      FMUDF515,SP70
.
          MOVE      ZERO,FMUDT516
          MOVE      ZERO,FMUDW516
          MOVE      ZERO,FMUDA516
          MOVE      ZERO,FMUDS516
          MOVE      ZERO,FMUDP516
          PACK      FMUDF516,SP70
.
          MOVE      ZERO,FMUDT517
          MOVE      ZERO,FMUDW517
          MOVE      ZERO,FMUDA517
          MOVE      ZERO,FMUDS517
          MOVE      ZERO,FMUDP517
          PACK      FMUDF517,SP70
.
          MOVE      ZERO,FMUDT518
          MOVE      ZERO,FMUDW518
          MOVE      ZERO,FMUDA518
          MOVE      ZERO,FMUDS518
          MOVE      ZERO,FMUDP518
          PACK      FMUDF518,SP70
.
          MOVE      ZERO,FMUDT519
          MOVE      ZERO,FMUDW519
          MOVE      ZERO,FMUDA519
          MOVE      ZERO,FMUDS519
          MOVE      ZERO,FMUDP519
          PACK      FMUDF519,SP70
.
          MOVE      ZERO,FMUDT520
          MOVE      ZERO,FMUDW520
          MOVE      ZERO,FMUDA520
          MOVE      ZERO,FMUDS520
          MOVE      ZERO,FMUDP520
          PACK      FMUDF520,SP70
.
CLRSF999  RETURN
.------------------------------------------------------------
. Load into Temporary File
.------------------------------------------------------------
LFMRD000  MOVE      FMUDROW,MAXCNTER
          MOVE      ZERO,ROWCNTER
          MOVE      FMUDSTY,FMRTSTYC
          REPEAT
            ADD       ONE,ROWCNTER
            MOVE      ROWCNTER,FMRTROWN
            MOVE      ZERO,F2
            REPEAT
              ADD       ONE,F2
              BRANCH    ROWCNTER,LFMRD100,LFMRD200,LFMRD300,LFMRD400,LFMRD500
.
LFMRD100      LOAD      FMRTTYPE,F2,FMUDT101,FMUDT102,FMUDT103,FMUDT104:
                                    FMUDT105,FMUDT106,FMUDT107,FMUDT108:
                                    FMUDT109,FMUDT110,FMUDT111,FMUDT112:
                                    FMUDT113,FMUDT114,FMUDT115,FMUDT116:
                                    FMUDT117,FMUDT118,FMUDT119,FMUDT120
.
              LOAD      FMRTWIDT,F2,FMUDW101,FMUDW102,FMUDW103,FMUDW104:
                                    FMUDW105,FMUDW106,FMUDW107,FMUDW108:
                                    FMUDW109,FMUDW110,FMUDW111,FMUDW112:
                                    FMUDW113,FMUDW114,FMUDW115,FMUDW116:
                                    FMUDW117,FMUDW118,FMUDW119,FMUDW120
.
              LOAD      FMRTVTYP,F2,FMUDA101,FMUDA102,FMUDA103,FMUDA104:
                                    FMUDA105,FMUDA106,FMUDA107,FMUDA108:
                                    FMUDA109,FMUDA110,FMUDA111,FMUDA112:
                                    FMUDA113,FMUDA114,FMUDA115,FMUDA116:
                                    FMUDA117,FMUDA118,FMUDA119,FMUDA120
.
              LOAD      FMRTSCAL,F2,FMUDS101,FMUDS102,FMUDS103,FMUDS104:
                                    FMUDS105,FMUDS106,FMUDS107,FMUDS108:
                                    FMUDS109,FMUDS110,FMUDS111,FMUDS112:
                                    FMUDS113,FMUDS114,FMUDS115,FMUDS116:
                                    FMUDS117,FMUDS118,FMUDS119,FMUDS120
.
              LOAD      FMRTPERI,F2,FMUDP101,FMUDP102,FMUDP103,FMUDP104:
                                    FMUDP105,FMUDP106,FMUDP107,FMUDP108:
                                    FMUDP109,FMUDP110,FMUDP111,FMUDP112:
                                    FMUDP113,FMUDP114,FMUDP115,FMUDP116:
                                    FMUDP117,FMUDP118,FMUDP119,FMUDP120
.
              LOAD      FMRTFRMT,F2,FMUDF101,FMUDF102,FMUDF103,FMUDF104:
                                    FMUDF105,FMUDF106,FMUDF107,FMUDF108:
                                    FMUDF109,FMUDF110,FMUDF111,FMUDF112:
                                    FMUDF113,FMUDF114,FMUDF115,FMUDF116:
                                    FMUDF117,FMUDF118,FMUDF119,FMUDF120
              GOTO      LFMRD600
.
LFMRD200      LOAD      FMRTTYPE,F2,FMUDT201,FMUDT202,FMUDT203,FMUDT204:
                                    FMUDT205,FMUDT206,FMUDT207,FMUDT208:
                                    FMUDT209,FMUDT210,FMUDT211,FMUDT212:
                                    FMUDT213,FMUDT214,FMUDT215,FMUDT216:
                                    FMUDT217,FMUDT218,FMUDT219,FMUDT220
.
              LOAD      FMRTWIDT,F2,FMUDW201,FMUDW202,FMUDW203,FMUDW204:
                                    FMUDW205,FMUDW206,FMUDW207,FMUDW208:
                                    FMUDW209,FMUDW210,FMUDW211,FMUDW212:
                                    FMUDW213,FMUDW214,FMUDW215,FMUDW216:
                                    FMUDW217,FMUDW218,FMUDW219,FMUDW220
.
              LOAD      FMRTVTYP,F2,FMUDA201,FMUDA102,FMUDA203,FMUDA204:
                                    FMUDA205,FMUDA106,FMUDA207,FMUDA208:
                                    FMUDA209,FMUDA110,FMUDA211,FMUDA212:
                                    FMUDA213,FMUDA114,FMUDA215,FMUDA216:
                                    FMUDA217,FMUDA118,FMUDA219,FMUDA220
.
              LOAD      FMRTSCAL,F2,FMUDS201,FMUDS202,FMUDS203,FMUDS204:
                                    FMUDS205,FMUDS206,FMUDS207,FMUDS208:
                                    FMUDS209,FMUDS210,FMUDS211,FMUDS212:
                                    FMUDS213,FMUDS214,FMUDS215,FMUDS216:
                                    FMUDS217,FMUDS218,FMUDS219,FMUDS220
.
              LOAD      FMRTPERI,F2,FMUDP201,FMUDP202,FMUDP203,FMUDP204:
                                    FMUDP205,FMUDP206,FMUDP207,FMUDP208:
                                    FMUDP209,FMUDP210,FMUDP211,FMUDP212:
                                    FMUDP213,FMUDP214,FMUDP215,FMUDP216:
                                    FMUDP217,FMUDP218,FMUDP219,FMUDP220
.
              LOAD      FMRTFRMT,F2,FMUDF201,FMUDF202,FMUDF203,FMUDF204:
                                    FMUDF205,FMUDF206,FMUDF207,FMUDF208:
                                    FMUDF209,FMUDF210,FMUDF211,FMUDF212:
                                    FMUDF213,FMUDF214,FMUDF215,FMUDF216:
                                    FMUDF217,FMUDF218,FMUDF219,FMUDF220
              GOTO      LFMRD600
.
LFMRD300      LOAD      FMRTTYPE,F2,FMUDT301,FMUDT302,FMUDT303,FMUDT304:
                                    FMUDT305,FMUDT306,FMUDT307,FMUDT308:
                                    FMUDT309,FMUDT310,FMUDT311,FMUDT312:
                                    FMUDT313,FMUDT314,FMUDT315,FMUDT316:
                                    FMUDT317,FMUDT318,FMUDT319,FMUDT320
.
              LOAD      FMRTWIDT,F2,FMUDW301,FMUDW302,FMUDW303,FMUDW304:
                                    FMUDW305,FMUDW306,FMUDW307,FMUDW308:
                                    FMUDW309,FMUDW310,FMUDW311,FMUDW312:
                                    FMUDW313,FMUDW314,FMUDW315,FMUDW316:
                                    FMUDW317,FMUDW318,FMUDW319,FMUDW320
.
              LOAD      FMRTVTYP,F2,FMUDA301,FMUDA302,FMUDA303,FMUDA304:
                                    FMUDA305,FMUDA306,FMUDA307,FMUDA308:
                                    FMUDA309,FMUDA310,FMUDA311,FMUDA312:
                                    FMUDA313,FMUDA314,FMUDA315,FMUDA316:
                                    FMUDA317,FMUDA318,FMUDA319,FMUDA320
.
              LOAD      FMRTSCAL,F2,FMUDS301,FMUDS302,FMUDS303,FMUDS304:
                                    FMUDS305,FMUDS306,FMUDS307,FMUDS308:
                                    FMUDS309,FMUDS310,FMUDS311,FMUDS312:
                                    FMUDS313,FMUDS314,FMUDS315,FMUDS316:
                                    FMUDS317,FMUDS318,FMUDS319,FMUDS320
.
              LOAD      FMRTPERI,F2,FMUDP301,FMUDP302,FMUDP303,FMUDP104:
                                    FMUDP305,FMUDP306,FMUDP307,FMUDP308:
                                    FMUDP309,FMUDP310,FMUDP311,FMUDP312:
                                    FMUDP313,FMUDP314,FMUDP315,FMUDP316:
                                    FMUDP317,FMUDP318,FMUDP319,FMUDP320
.
              LOAD      FMRTFRMT,F2,FMUDF301,FMUDF302,FMUDF303,FMUDF304:
                                    FMUDF305,FMUDF306,FMUDF307,FMUDF308:
                                    FMUDF309,FMUDF310,FMUDF311,FMUDF312:
                                    FMUDF313,FMUDF314,FMUDF315,FMUDF316:
                                    FMUDF317,FMUDF318,FMUDF319,FMUDF320
              GOTO      LFMRD600
.
LFMRD400      LOAD      FMRTTYPE,F2,FMUDT401,FMUDT402,FMUDT403,FMUDT404:
                                    FMUDT405,FMUDT406,FMUDT407,FMUDT408:
                                    FMUDT409,FMUDT410,FMUDT411,FMUDT412:
                                    FMUDT413,FMUDT414,FMUDT415,FMUDT416:
                                    FMUDT417,FMUDT418,FMUDT419,FMUDT420
.
              LOAD      FMRTWIDT,F2,FMUDW401,FMUDW402,FMUDW403,FMUDW404:
                                    FMUDW405,FMUDW406,FMUDW407,FMUDW408:
                                    FMUDW409,FMUDW410,FMUDW411,FMUDW412:
                                    FMUDW413,FMUDW414,FMUDW415,FMUDW416:
                                    FMUDW417,FMUDW418,FMUDW419,FMUDW420
.
              LOAD      FMRTVTYP,F2,FMUDA401,FMUDA402,FMUDA403,FMUDA404:
                                    FMUDA405,FMUDA406,FMUDA407,FMUDA408:
                                    FMUDA409,FMUDA410,FMUDA411,FMUDA412:
                                    FMUDA413,FMUDA414,FMUDA415,FMUDA416:
                                    FMUDA417,FMUDA418,FMUDA419,FMUDA420
.
              LOAD      FMRTSCAL,F2,FMUDS401,FMUDS402,FMUDS103,FMUDS404:
                                    FMUDS405,FMUDS406,FMUDS407,FMUDS408:
                                    FMUDS409,FMUDS410,FMUDS411,FMUDS412:
                                    FMUDS413,FMUDS414,FMUDS415,FMUDS416:
                                    FMUDS417,FMUDS418,FMUDS419,FMUDS420
.
              LOAD      FMRTPERI,F2,FMUDP401,FMUDP102,FMUDP103,FMUDP104:
                                    FMUDP405,FMUDP106,FMUDP107,FMUDP108:
                                    FMUDP409,FMUDP110,FMUDP111,FMUDP112:
                                    FMUDP413,FMUDP114,FMUDP115,FMUDP116:
                                    FMUDP417,FMUDP118,FMUDP119,FMUDP120
.
              LOAD      FMRTFRMT,F2,FMUDF401,FMUDF402,FMUDF403,FMUDF404:
                                    FMUDF405,FMUDF406,FMUDF407,FMUDF408:
                                    FMUDF409,FMUDF410,FMUDF411,FMUDF412:
                                    FMUDF413,FMUDF414,FMUDF415,FMUDF416:
                                    FMUDF417,FMUDF418,FMUDF419,FMUDF420
              GOTO      LFMRD600
.
LFMRD500      LOAD      FMRTTYPE,F2,FMUDT501,FMUDT502,FMUDT503,FMUDT504:
                                    FMUDT505,FMUDT506,FMUDT507,FMUDT508:
                                    FMUDT509,FMUDT510,FMUDT511,FMUDT512:
                                    FMUDT513,FMUDT514,FMUDT515,FMUDT516:
                                    FMUDT517,FMUDT518,FMUDT519,FMUDT520
.
              LOAD      FMRTWIDT,F2,FMUDW501,FMUDW502,FMUDW503,FMUDW504:
                                    FMUDW505,FMUDW506,FMUDW507,FMUDW508:
                                    FMUDW509,FMUDW510,FMUDW511,FMUDW512:
                                    FMUDW513,FMUDW514,FMUDW515,FMUDW516:
                                    FMUDW517,FMUDW518,FMUDW519,FMUDW520
.
              LOAD      FMRTVTYP,F2,FMUDA501,FMUDA502,FMUDA503,FMUDA504:
                                    FMUDA505,FMUDA506,FMUDA507,FMUDA508:
                                    FMUDA509,FMUDA510,FMUDA511,FMUDA512:
                                    FMUDA513,FMUDA514,FMUDA515,FMUDA516:
                                    FMUDA517,FMUDA518,FMUDA519,FMUDA520
.
              LOAD      FMRTSCAL,F2,FMUDS501,FMUDS502,FMUDS503,FMUDS504:
                                    FMUDS505,FMUDS506,FMUDS507,FMUDS508:
                                    FMUDS509,FMUDS510,FMUDS511,FMUDS512:
                                    FMUDS513,FMUDS514,FMUDS515,FMUDS516:
                                    FMUDS517,FMUDS518,FMUDS519,FMUDS520
.
              LOAD      FMRTPERI,F2,FMUDP501,FMUDP502,FMUDP503,FMUDP504:
                                    FMUDP505,FMUDP506,FMUDP507,FMUDP508:
                                    FMUDP509,FMUDP510,FMUDP511,FMUDP512:
                                    FMUDP513,FMUDP514,FMUDP515,FMUDP516:
                                    FMUDP517,FMUDP518,FMUDP519,FMUDP520
.
              LOAD      FMRTFRMT,F2,FMUDF501,FMUDF502,FMUDF503,FMUDF504:
                                    FMUDF505,FMUDF506,FMUDF507,FMUDF508:
                                    FMUDF509,FMUDF510,FMUDF511,FMUDF512:
                                    FMUDF513,FMUDF514,FMUDF515,FMUDF516:
                                    FMUDF517,FMUDF518,FMUDF519,FMUDF520
              GOTO      LFMRD600
.
LFMRD600      MATCH     " 0",FMRTTYPE
              IF        @EQUAL
                MOVE      "20",F2
              ELSE
                MOVE      F2,FMRTLINE
                PACK      KEY7,FMRTSTYC,FMRTROWN,FMRTLINE,SP70
                CALL      WRFMRT1
              ENDIF
            UNTIL     F2=20
          UNTIL     ROWCNTER=MAXCNTER
.
LFMRD999  RETURN
.------------------------------------------------------------
. Delete Report Style Temporary Detail
.------------------------------------------------------------
CFMRD000  PACK      KEY7,FMUDSTY,SP70
CFMRD100  CALL      RSFMRT1
          CALL      RKFMRT1
          BRANCH    OVRCD,CFMRD999
.
          MATCH     FMRTSTYC,FMUDSTY
          GOTO      CFMRD999 IF NOT EQUAL
.
          PACK      KEY7,FMRTSTYC,FMRTROWN,FMRTLINE,SP70
          CALL      DEFMRT1
          GOTO      CFMRD100
.
CFMRD999  RETURN
.
.------------------------------------------------------------
. Cancel Main Screen
.------------------------------------------------------------
CANA0000  CALL      CFMRD000                * delete temporary records
.
CANA9999  RETURN
.
.------------------------------------------------------------
. Delete Report Style Record
.------------------------------------------------------------
DELA0000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          CALL      DELQST
          CALL      MESSAGE3
          BRANCH    CEXIT,DELA1000,DELA9000,DELA9100
.
DELA1000  PACK      KEY3,FMUDSTY,SP70
          CALL      RAFMUD1
          IF        OVRCD=0
            CALL      DEFMUD1
          ENDIF
          CALL      CFMRD000                * delete temporary records
          GOTO      DELA9100
.
DELA9000  MOVE      ONE,EXIT
          GOTO      DELA9999
.
DELA9100  MOVE      TWO,EXIT
          GOTO      DELA9999
.
DELA9999  RETURN
.
.------------------------------------------------------------
. Enter Report Style
.------------------------------------------------------------
ERST0000  MOVE      ONE,CHNGMODE
          MOVE      TWO,CKEYTYP
          PACK      FMUDSTY,SP70
          PACK      FMUDDES,SP70
          CALL      KFMUDA00
          BRANCH    EXIT,ERST9999,ERST9999
          BRANCH    OVRCD,ERST9900
.
          PACK      VRSTDDES,FMUDDES,SP70
          MOVE      FMUDROW,VRSTDROW
.
          LOAD      F1,FMUDWID,TWO,ONE,THREE,FOUR
          MOVE      F1,VRSTDWID
          LOAD      VDESPWID,F1,IDESPWD1,IDESPWD2,IDESPWD3,IDESPWD4
          GOTO      ERST9999
.
ERST9900  MOVE      ZERO,CHNGMODE
          UNPACK    SP70,VRSTDDES,VRSTDWID,VRSTDROW,VDESPWID
.
ERST9999  RETURN
.------------------------------------------------------------
. Enter Page Width
.------------------------------------------------------------
EPWD0000  CALL      BOXPW000
.
EPWD0100  KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDWID
          MOVE      VRSTDWID,F1
          BRANCH    F1,EPWD0200,EPWD0200,EPWD0200,EPWD0200
          BEEP
          GOTO      EPWD0100
.
EPWD0200  LOAD      VDESPWID,F1,IDESPWD1,IDESPWD2,IDESPWD3,IDESPWD4
          MOVE      F1,VRSTDWID
          CALL      PUTSCR00
.
          MOVE      "10",HTOP
          MOVE      "30",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
.
EPWD9999  RETURN
.------------------------------------------------------------
. Draw a Box of Page Width Selection
.------------------------------------------------------------
BOXPW000  MOVE      "17",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:18,*V2LON,*ULON,"Page Width    ",*HOFF:
                    *P57:19,*V2LON,"1. ",*HOFF,IDESPWD1:
                    *P57:20,*V2LON,"2. ",*HOFF,IDESPWD2:
                    *P57:21,*V2LON,"3. ",*HOFF,IDESPWD3:
                    *P57:22,*V2LON,"4. ",*HOFF,IDESPWD4
.
BOXPW999  RETURN
.
.------------------------------------------------------------
. Enter Number of Rows
.------------------------------------------------------------
EROW0000  MATCH     "00",SCRID
          GOTO      EROW1000 IF NOT EQUAL
.
EROW0100  KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDROW
          MOVE      VRSTDROW,F2
          BRANCH    F2,EROW0200,EROW0200,EROW0200,EROW0200,EROW0200
          BEEP
          GOTO      EROW0100
.
EROW0200  MOVE      F2,VDESMXRW
          MOVE      F2,VRSTDROW
          GOTO      EROW9999
.
EROW1000  MOVE      ZERO,F2
          MOVE      SP70,VRSTDROW
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDROW
          MOVE      VRSTDROW,F2
          PACK      VRSTDROW,VRSTDROW,SP70
.
          MATCH     SP70,VRSTDROW
          GOTO      EROW2000 IF EQUAL
.
          CMATCH    EXITCHAR,VRSTDROW
          GOTO      EROW9000 IF EQUAL
.
          COMPARE   ONE,F2
          GOTO      EROW1000 IF LESS
          COMPARE   F2,VDESMXRW
          GOTO      EROW1000 IF LESS
.
          MOVE      F2,VRSTDROW
          MOVE      ZERO,CHNGMODE
.
          PACK      KEY7,FMUDSTY,VRSTDROW,SP70
          CALL      RSFMRT1
          CALL      RKFMRT1
          BRANCH    OVRCD,EROW1200
.
          MATCH     FMUDSTY,FMRTSTYC
          GOTO      EROW1200 IF NOT EQUAL
.
          MATCH     VRSTDROW,FMRTROWN
          GOTO      EROW1200 IF NOT EQUAL
.
          MOVE      FMRTLINE,LINECNTER
          MOVE      ONE,CHNGMODE
.
          CALL      SC02L000
          GOTO      EROW1300
.
EROW1200  CALL      ALIN0000
.
EROW1300  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          GOTO      EROW9800
.
EROW2000  MOVE      ZERO,F2
          REPEAT
            ADD       ONE,F2
            PACK      KEY7,FMUDSTY,F2,SP1,ONE,SP70
            CALL      RAFMRT1
          UNTIL     F2=VDESMXRW | OVRCD=1
          IF        OVRCD=1
            CLEAR     DISPMSG
            APPEND    "No Record in Row No.",DISPMSG
            APPEND    F2,DISPMSG
            APPEND    ". - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EROW1000
          ENDIF
.
          MOVE      FMUDH11,VRSTDH11
          MOVE      FMUDH12,VRSTDH12
          MOVE      FMUDH13,VRSTDH13
          MOVE      FMUDH21,VRSTDH21
          MOVE      FMUDH22,VRSTDH22
          MOVE      FMUDH23,VRSTDH23
.
          MOVE      FMUDH11,SVHDLN1A
          MOVE      FMUDH12,SVHDLN1B
          MOVE      FMUDH13,SVHDLN1C
          MOVE      FMUDH21,SVHDLN2A
          MOVE      FMUDH22,SVHDLN2B
          MOVE      FMUDH23,SVHDLN2C
.
          CALL      SC04L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
          BRANCH    EXITFLAG,EROW9800
          GOTO      EROW9000
.
EROW9000  CALL      CFMRD000                * delete temporary records
          GOTO      EROW9900
.
EROW9800  MOVE      ONE,EXIT                * Restart this Screen
          GOTO      EROW9999
.
EROW9900  MOVE      TWO,EXIT                * exit out of Screen
          GOTO      EROW9999
.
EROW9999  RETURN
.
.------------------------------------------------------------
. Copy Report Style
.------------------------------------------------------------
COPY0000  BRANCH    CHNGMODE,COPY0100
          MOVE      "Unable copy New Report Style. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      COPY9999
.
COPY0100  CALL      SC05L000
.
COPY9999  RETURN
.------------------------------------------------------------
. Display Report Style
.------------------------------------------------------------
DRST0000  MOVE      VRSTDDES,FMUDDES
.
DRST9999  RETURN
.
.------------------------------------------------------------
. Read Descriptions
.------------------------------------------------------------
RDES0000  PACK      RTYPDESC,SP70
          MOVE      FMRTTYPE,F2
          LOAD      RTYPDESC,F2,IDESTYP1,IDESTYP2,IDESTYP3,IDESTYP4:
                                IDESTYP5,IDESTYP6,IDESTYP7
.
          PACK      VTYPDESC,SP70
          BRANCH    F2,RDES9999,RDES9999,RDES0100,RDES0200,RDES0200
          GOTO      RDES9999
.
RDES0100  MOVE      FMRTVTYP,F2
          LOAD      VTYPDESC,F2,IDESVT01,IDESVT02,IDESVT03,IDESVT04
          GOTO      RDES9999
.
RDES0200  MOVE      FMRTVTYP,F2
          LOAD      VTYPDESC,F2,IDESVT05,IDESVT06,IDESVT07,IDESVT08:
                                IDESVT09,IDESVT10
          GOTO      RDES9999
.
RDES9999  RETURN
.
.------------------------------------------------------------
. Select Line Number
.------------------------------------------------------------
SLIN0000  MOVE      SCSLSEL,F2
          PACK      KEY7,FMUDSTY,VRSTDROW,F2,SP70
          CALL      RDFMRT1
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
            MOVE      ZERO,HLEF
            CALL      GETSCR00
.
            CALL      SC03L000
.
            MOVE      "02",SCRID
            MOVE      ZERO,PRCOL
            MOVE      ZERO,PRVERT
            MOVE      "   10",FLDID
            CALL      GETPOSIT
            IF        EXIT=0
              MOVE     SCPSCOL,PRCOL
              MOVE     SCPSROW,PRVERT
            ENDIF
            CALL      PUTSCR00
          ENDIF
.
          CALL      FP02L000
          MOVE      ZERO,LINECNTR
.
SLIN0999  RETURN
.
STSCR000  MOVE      FMRTTYPE,F2
          LOAD      VDESTYPE,F2,IDESTYP1,IDESTYP2,IDESTYP3:
                                IDESTYP4,IDESTYP5,IDESTYP6:
                                IDESTYP7
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMRTTYPE,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESTYPE,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
.
          BRANCH    F2,STSCR100,STSCR200,STSCR300,STSCR300,STSCR400,STSCR500:
                       STSCR600
.
STSCR100  MOVE      ONE,VDESMNWD            * set minimum Column Width allowed
          MOVE      "13",VDESMXWD           * set maximum Column Width allowed
          CALL      SC3AL000
          GOTO      STSCR900
.
STSCR200  MOVE      ONE,VDESMNWD            * set minimum Column Width allowed
          MOVE      "36",VDESMXWD           * set maximum Column Width allowed
          CALL      SC3AL000
          GOTO      STSCR900
.
STSCR300  MOVE      TEN,VDESMNWD            * set minimum Column Width allowed
          MOVE      TWENTY,VDESMXWD         * set maximum Column Width allowed
          CALL      SC3BL000
          GOTO      STSCR900
.
STSCR400  MOVE      SIX,VDESMNWD            * set minimum Column Width allowed
          MOVE      TWENTY,VDESMXWD         * set maximum Column Width allowed
          CALL      SC3BL000
          GOTO      STSCR900
.
STSCR500  MOVE      ZERO,VDESMNWD           * set minimum Column Width allowed
          MOVE      TWENTY,VDESMXWD         * set maximum Column Width allowed
          CALL      SC3CL000
          GOTO      STSCR900
.
STSCR600  MOVE      ONE,VDESMNWD            * set minimum Column Width allowed
          MOVE      "21",VDESMXWD           * set maximum Column Width allowed
          CALL      SC3AL000
          GOTO      STSCR900
.
STSCR900  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
.
STSCR999  RETURN
.
.------------------------------------------------------------
. Add Line Number
.------------------------------------------------------------
ALIN0000  MOVE      ZERO,CHNGMODE
.
          PACK      KEY7,FMUDSTY,VRSTDROW,Z70
          CALL      RSFMRT1
          CALL      RPFMRT1
          BRANCH    OVRCD,ALIN0100
.
          MATCH     FMUDSTY,FMRTSTYC
          GOTO      ALIN0100 IF NOT EQUAL
.
          MATCH     VRSTDROW,FMRTROWN
          GOTO      ALIN0100 IF NOT EQUAL
.
          MOVE      FMRTLINE,LINECNTER
          GOTO      ALIN0200
.
ALIN0100  MOVE      ZERO,LINECNTR
.
ALIN0200  ADD       ONE,LINECNTR
          MOVE      LINECNTR,FMRTLINE
.
          CALL      CLTMP000
          CALL      SC03L000
          BRANCH    CHNGMODE,ALIN9999
          GOTO      ALIN0200
.
ALIN9999  RETURN
.------------------------------------------------------------
. Clear Temp File
.------------------------------------------------------------
CLTMP000  PACK      FMRTTYPE,SP70
          PACK      FMRTWIDT,SP70
          PACK      FMRTVTYP,SP70
          PACK      FMRTSCAL,SP70
          PACK      FMRTPERI,SP70
          PACK      FMRTFRMT,SP70
.
CLTMP999  RETURN
.
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.------------------------------------------------------------
. Set Line Number
.------------------------------------------------------------
STLN0000  BRANCH    CHNGMODE,STLN0100
          MOVE      LINECNTR,FMRTLINE
.
STLN0100  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMRTLINE,VAR
            CALL      DISPITEM
          ENDIF
.
          GOTO      STLN9999
.
STLN9999  RETURN
.
.------------------------------------------------------------
. Enter Type
.------------------------------------------------------------
ETYP0000  CALL      BOXTY000
.
ETYP0100  BRANCH    CHNGMODE,ETYP0200
          MOVE      SP70,FMRTTYPE
.
ETYP0200  MOVE      ZERO,F2
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,FMRTTYPE
          MOVE      FMRTTYPE,F2
          PACK      FMRTTYPE,FMRTTYPE,SP70
.
          MATCH     SP70,FMRTTYPE
          GOTO      ETYP9500 IF EQUAL
.
          CMATCH    EXITCHAR,FMRTTYPE
          GOTO      ETYP9500 IF EQUAL
.
          MOVE      FMRTTYPE,F2
          LOAD      VDESTYPE,F2,IDESTYP1,IDESTYP2,IDESTYP3:
                                IDESTYP4,IDESTYP5,IDESTYP6:
                                IDESTYP7
          BRANCH    F2,ETYP0500,ETYP0600,ETYP0700,ETYP0700,ETYP0800:
                       ETYP0900,ETYP1000
          BEEP
          GOTO      ETYP0100
.
ETYP0500  MOVE      F2,FMRTTYPE
          CALL      PUTSCR00
          MOVE      ONE,VDESMNWD            * set minimum Column Width allowed
          MOVE      "13",VDESMXWD           * set maximum Column Width allowed
          GOTO      ETYP1800
.
ETYP0600  MOVE      F2,FMRTTYPE
          CALL      PUTSCR00
          MOVE      ONE,VDESMNWD            * set minimum Column Width allowed
          MOVE      "36",VDESMXWD           * set maximum Column Width allowed
          GOTO      ETYP1800
.
ETYP0700  MOVE      F2,FMRTTYPE
          CALL      PUTSCR00
          MOVE      TEN,VDESMNWD            * set minimum Column Width allowed
          MOVE      TWENTY,VDESMXWD         * set maximum Column Width allowed
          GOTO      ETYP1800
.
ETYP0800  MOVE      F2,FMRTTYPE
          CALL      PUTSCR00
          MOVE      SIX,VDESMNWD            * set minimum Column Width allowed
          MOVE      TWENTY,VDESMXWD         * set maximum Column Width allowed
          GOTO      ETYP1800
.
ETYP0900  MOVE      F2,FMRTTYPE
          CALL      PUTSCR00
          MOVE      ZERO,VDESMNWD           * set minimum Column Width allowed
          MOVE      TWENTY,VDESMXWD         * set maximum Column Width allowed
          GOTO      ETYP1800
.
ETYP1000  MOVE      F2,FMRTTYPE
          CALL      PUTSCR00
          MOVE      ONE,VDESMNWD            * set minimum Column Width allowed
          MOVE      "21",VDESMXWD           * set maximum Column Width allowed
          GOTO      ETYP1800
.
ETYP1800  MOVE      "10",HTOP
          MOVE      "30",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
.
          MOVE      ZERO,DISPFLAG
.
          CALL      STSCR000
          GOTO      ETYP9900
.
ETYP9500  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      FMRTTYPE,SP70
            MOVE      FMRTTYPE,VAR
            CALL      DISPITEM
          ENDIF
          CALL      PUTSCR00
          MOVE      ONE,CHNGMODE
          GOTO      ETYP9900
.
ETYP9800  MOVE      ONE,EXIT                * Restart this Screen
          GOTO      ETYP9999
.
ETYP9900  MOVE      TWO,EXIT                * exit out of Screen
          GOTO      ETYP9999
.
ETYP9999  RETURN
.------------------------------------------------------------
. Draw a Box of Type Selection
.------------------------------------------------------------
BOXTY000  MOVE      "15",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:16,*V2LON,*ULON,"Column Type   ",*HOFF:
                    *P57:17,*V2LON,"1. ",*HOFF,IDESTYP1:
                    *P57:18,*V2LON,"2. ",*HOFF,IDESTYP2:
                    *P57:19,*V2LON,"3. ",*HOFF,IDESTYP3:
                    *P57:20,*V2LON,"4. ",*HOFF,IDESTYP4:
                    *P57:21,*V2LON,"5. ",*HOFF,IDESTYP5:
                    *P57:22,*V2LON,"6. ",*HOFF,IDESTYP6:
                    *P57:23,*V2LON,"7. ",*HOFF,IDESTYP7
.
BOXTY999  RETURN
.
.------------------------------------------------------------
. Display Character Description
.------------------------------------------------------------
DCHA0000  MOVE      ZERO,EXITFLAG
          MOVE      FMUDSTY,FMRTSTYC
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMRTSTYC,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      ZERO,ACCEPT
          CALL      VMOD0000
          BRANCH    CHNGMODE,DCHA0100
          MOVE      ONE,ACCEPT
.
DCHA0100  MOVE      VRSTDWID,F1
          LOAD      VDESPWID,F1,IDESPWD1,IDESPWD2,IDESPWD3,IDESPWD4
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESPWID,VAR
            CALL      DISPITEM
          ENDIF
.
          CALL      EDITD000
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESRH1A,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESRH1B,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESRH1C,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESRH2A,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESRH2B,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESRH2C,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    1",FLDID
          CALL      GETPOSIT
.
DCHA9999  RETURN
.
EDITD000  PACK      VDESRH1A,SP70,SP70
          CLEAR     VDESRH1A
          PACK      VDESRH1B,SP70,SP70
          CLEAR     VDESRH1B
          PACK      VDESRH1C,SP70,SP70
          CLEAR     VDESRH1C
          PACK      VDESRH2A,SP70,SP70
          CLEAR     VDESRH2A
          PACK      VDESRH2B,SP70,SP70
          CLEAR     VDESRH2B
          PACK      VDESRH2C,SP70,SP70
          CLEAR     VDESRH2C
          MOVE      "79",MAXCNTER
          MOVE      ONE,NEXTFILD
          MOVE      ZERO,CURRPNTR
          PACK      KEY7,FMUDSTY,SP1,ONE,SP70
          CALL      RSFMRT1
EDITD100  CALL      RKFMRT1
          BRANCH    OVRCD,EDITD900
.
          MATCH     FMUDSTY,FMRTSTYC
          GOTO      EDITD900 IF NOT EQUAL
.
          MATCH     " 1",FMRTROWN
          GOTO      EDITD900 IF NOT EQUAL
.
          MOVE      FMRTWIDT,MAXCOLMN
          MOVE      FMRTTYPE,TYPECNTR
.
          COMPARE   SIX,TYPECNTR
          GOTO      EDITD200 IF EQUAL
          SUB       ONE,MAXCOLMN
.
EDITD200  CALL      FILLA000
          GOTO      EDITD100
.
EDITD900  RESET     VDESRH1A
          RESET     VDESRH1B
          RESET     VDESRH1C
          MOVE      VDESRH1A,VDESRH2A
          MOVE      VDESRH1B,VDESRH2B
          MOVE      VDESRH1C,VDESRH2C
.
EDITD999  RETURN
.
FILLA000  PACK      FILLCOLM,SP70
          LOAD      FILLCOLM,TYPECNTR,ANSX,ANSX,NINE,NINE,NINE,ANSX,ANSX
.
          MOVE      ONE,F2
          REPEAT
            IF        CURRPNTR>MAXCNTER
              ADD       ONE,NEXTFILD
              LOAD      MAXCNTER,NEXTFILD,SEVENTY9,SEVENTY9,SEVENTY9,FORTY9
              MOVE      ZERO,CURRPNTR
            ENDIF
            PERFORM   NEXTFILD,FILLX000,FILLY000,FILLZ000
            ADD       ONE,F2
          UNTIL     F2>MAXCOLMN
.
          IF        CURRPNTR>MAXCNTER
            ADD       ONE,NEXTFILD
            LOAD      MAXCNTER,NEXTFILD,SEVENTY9,SEVENTY9,SEVENTY9,FORTY9
            MOVE      ZERO,CURRPNTR
          ENDIF
.
          COMPARE   SIX,TYPECNTR
          GOTO      FILLA999 IF EQUAL
.
          PACK      FILLCOLM,SP10
          PERFORM   NEXTFILD,FILLX000,FILLY000,FILLZ000
.
FILLA999  RETURN
.
FILLX000  APPEND    FILLCOLM,VDESRH1A
          MOVELPTR  VDESRH1A,CURRPNTR
          RETURN
.
FILLY000  APPEND    FILLCOLM,VDESRH1B
          MOVELPTR  VDESRH1B,CURRPNTR
          RETURN
.
FILLZ000  APPEND    FILLCOLM,VDESRH1C
          MOVELPTR  VDESRH1C,CURRPNTR
          RETURN
.
.------------------------------------------------------------
. Post one whole Record
.------------------------------------------------------------
POSD0000  CALL      CLRSF000
          CALL      WFMRX000
.
          MOVE      VRSTDDES,FMUDDES
          MOVE      VRSTDWID,F1
          LOAD      FMUDWID,F1,TWO,ONE,THREE,FOUR
          MOVE      VDESMXRW,FMUDROW
.
          MOVE      VRSTDH11,FMUDH11
          MOVE      VRSTDH12,FMUDH12
          MOVE      VRSTDH13,FMUDH13
          MOVE      VRSTDH21,FMUDH21
          MOVE      VRSTDH22,FMUDH22
          MOVE      VRSTDH23,FMUDH23
.
          PACK      KEY3,FMUDSTY,SP70
          CALL      RAFMUD1
          BRANCH    OVRCD,POSD0100
.
          CALL      UPFMUD1
          GOTO      POSD9999
.
POSD0100  PACK      KEY3,FMUDSTY,SP70
          CALL      WRFMUD1
          GOTO      POSD9999
.
POSD9999  RETURN
.------------------------------------------------------------
. Write from Temporary File
.------------------------------------------------------------
WFMRX000  MOVE      FMUDROW,MAXCNTER
          MOVE      ZERO,ROWCNTER
          REPEAT
            ADD       ONE,ROWCNTER
            MOVE      ROWCNTER,FMRTROWN
            MOVE      ZERO,F2
            REPEAT
              ADD       ONE,F2
              PACK      KEY7,FMUDSTY,ROWCNTER,F2,SP70
              CALL      RDFMRT1
              IF        OVRCD=0
                PERFORM   ROWCNTER,WFMRA000,WFMRB000,WFMRC000,WFMRD000,WFMRE000
              ENDIF
            UNTIL     F2=20 | OVRCD=1
          UNTIL     ROWCNTER=MAXCNTER
.
WFMRX999  RETURN
.
WFMRA000  STORE     FMRTTYPE,F2,FMUDT101,FMUDT102,FMUDT103,FMUDT104:
                                FMUDT105,FMUDT106,FMUDT107,FMUDT108:
                                FMUDT109,FMUDT110,FMUDT111,FMUDT112:
                                FMUDT113,FMUDT114,FMUDT115,FMUDT116:
                                FMUDT117,FMUDT118,FMUDT119,FMUDT120
.
          STORE     FMRTWIDT,F2,FMUDW101,FMUDW102,FMUDW103,FMUDW104:
                                FMUDW105,FMUDW106,FMUDW107,FMUDW108:
                                FMUDW109,FMUDW110,FMUDW111,FMUDW112:
                                FMUDW113,FMUDW114,FMUDW115,FMUDW116:
                                FMUDW117,FMUDW118,FMUDW119,FMUDW120
.
          STORE     FMRTVTYP,F2,FMUDA101,FMUDA102,FMUDA103,FMUDA104:
                                FMUDA105,FMUDA106,FMUDA107,FMUDA108:
                                FMUDA109,FMUDA110,FMUDA111,FMUDA112:
                                FMUDA113,FMUDA114,FMUDA115,FMUDA116:
                                FMUDA117,FMUDA118,FMUDA119,FMUDA120
.
          STORE     FMRTSCAL,F2,FMUDS101,FMUDS102,FMUDS103,FMUDS104:
                                FMUDS105,FMUDS106,FMUDS107,FMUDS108:
                                FMUDS109,FMUDS110,FMUDS111,FMUDS112:
                                FMUDS113,FMUDS114,FMUDS115,FMUDS116:
                                FMUDS117,FMUDS118,FMUDS119,FMUDS120
.
          STORE     FMRTPERI,F2,FMUDP101,FMUDP102,FMUDP103,FMUDP104:
                                FMUDP105,FMUDP106,FMUDP107,FMUDP108:
                                FMUDP109,FMUDP110,FMUDP111,FMUDP112:
                                FMUDP113,FMUDP114,FMUDP115,FMUDP116:
                                FMUDP117,FMUDP118,FMUDP119,FMUDP120
.
          STORE     FMRTFRMT,F2,FMUDF101,FMUDF102,FMUDF103,FMUDF104:
                                FMUDF105,FMUDF106,FMUDF107,FMUDF108:
                                FMUDF109,FMUDF110,FMUDF111,FMUDF112:
                                FMUDF113,FMUDF114,FMUDF115,FMUDF116:
                                FMUDF117,FMUDF118,FMUDF119,FMUDF120
.
WFMRA999  RETURN
.
WFMRB000  STORE     FMRTTYPE,F2,FMUDT201,FMUDT202,FMUDT203,FMUDT204:
                                FMUDT205,FMUDT206,FMUDT207,FMUDT208:
                                FMUDT209,FMUDT210,FMUDT211,FMUDT212:
                                FMUDT213,FMUDT214,FMUDT215,FMUDT216:
                                FMUDT217,FMUDT218,FMUDT219,FMUDT220
.
          STORE     FMRTWIDT,F2,FMUDW201,FMUDW202,FMUDW203,FMUDW204:
                                FMUDW205,FMUDW206,FMUDW207,FMUDW208:
                                FMUDW209,FMUDW210,FMUDW211,FMUDW212:
                                FMUDW213,FMUDW214,FMUDW215,FMUDW216:
                                FMUDW217,FMUDW218,FMUDW219,FMUDW220
.
          STORE     FMRTVTYP,F2,FMUDA201,FMUDA202,FMUDA203,FMUDA204:
                                FMUDA205,FMUDA206,FMUDA207,FMUDA208:
                                FMUDA209,FMUDA210,FMUDA211,FMUDA212:
                                FMUDA213,FMUDA214,FMUDA215,FMUDA216:
                                FMUDA217,FMUDA218,FMUDA219,FMUDA220
.
          STORE     FMRTSCAL,F2,FMUDS201,FMUDS202,FMUDS203,FMUDS204:
                                FMUDS205,FMUDS206,FMUDS207,FMUDS208:
                                FMUDS209,FMUDS210,FMUDS211,FMUDS212:
                                FMUDS213,FMUDS214,FMUDS215,FMUDS216:
                                FMUDS217,FMUDS218,FMUDS219,FMUDS220
.
          STORE     FMRTPERI,F2,FMUDP201,FMUDP202,FMUDP203,FMUDP204:
                                FMUDP205,FMUDP206,FMUDP207,FMUDP208:
                                FMUDP209,FMUDP210,FMUDP211,FMUDP212:
                                FMUDP213,FMUDP214,FMUDP215,FMUDP216:
                                FMUDP217,FMUDP218,FMUDP219,FMUDP220
.
          STORE     FMRTFRMT,F2,FMUDF201,FMUDF202,FMUDF203,FMUDF204:
                                FMUDF205,FMUDF206,FMUDF207,FMUDF208:
                                FMUDF209,FMUDF210,FMUDF211,FMUDF212:
                                FMUDF213,FMUDF214,FMUDF215,FMUDF216:
                                FMUDF217,FMUDF218,FMUDF219,FMUDF220
.
WFMRB999  RETURN
.
WFMRC000  STORE     FMRTTYPE,F2,FMUDT301,FMUDT302,FMUDT303,FMUDT304:
                                FMUDT305,FMUDT306,FMUDT307,FMUDT308:
                                FMUDT309,FMUDT310,FMUDT311,FMUDT312:
                                FMUDT313,FMUDT314,FMUDT315,FMUDT316:
                                FMUDT317,FMUDT318,FMUDT319,FMUDT320
.
          STORE     FMRTWIDT,F2,FMUDW301,FMUDW302,FMUDW303,FMUDW304:
                                FMUDW305,FMUDW306,FMUDW307,FMUDW308:
                                FMUDW309,FMUDW310,FMUDW311,FMUDW312:
                                FMUDW313,FMUDW314,FMUDW315,FMUDW316:
                                FMUDW317,FMUDW318,FMUDW319,FMUDW320
.
          STORE     FMRTVTYP,F2,FMUDA301,FMUDA302,FMUDA303,FMUDA304:
                                FMUDA305,FMUDA306,FMUDA307,FMUDA308:
                                FMUDA309,FMUDA310,FMUDA311,FMUDA312:
                                FMUDA313,FMUDA314,FMUDA315,FMUDA316:
                                FMUDA317,FMUDA318,FMUDA319,FMUDA320
.
          STORE     FMRTSCAL,F2,FMUDS301,FMUDS302,FMUDS303,FMUDS304:
                                FMUDS305,FMUDS306,FMUDS307,FMUDS308:
                                FMUDS309,FMUDS310,FMUDS311,FMUDS312:
                                FMUDS313,FMUDS314,FMUDS315,FMUDS316:
                                FMUDS317,FMUDS318,FMUDS319,FMUDS320
.
          STORE     FMRTPERI,F2,FMUDP301,FMUDP302,FMUDP303,FMUDP304:
                                FMUDP305,FMUDP306,FMUDP307,FMUDP308:
                                FMUDP309,FMUDP310,FMUDP311,FMUDP312:
                                FMUDP313,FMUDP314,FMUDP315,FMUDP316:
                                FMUDP317,FMUDP318,FMUDP319,FMUDP320
.
          STORE     FMRTFRMT,F2,FMUDF301,FMUDF302,FMUDF303,FMUDF304:
                                FMUDF305,FMUDF306,FMUDF307,FMUDF308:
                                FMUDF309,FMUDF310,FMUDF311,FMUDF312:
                                FMUDF313,FMUDF314,FMUDF315,FMUDF316:
                                FMUDF317,FMUDF318,FMUDF319,FMUDF320
.
WFMRC999  RETURN
.
WFMRD000  STORE     FMRTTYPE,F2,FMUDT401,FMUDT402,FMUDT403,FMUDT404:
                                FMUDT405,FMUDT406,FMUDT407,FMUDT408:
                                FMUDT409,FMUDT410,FMUDT411,FMUDT412:
                                FMUDT413,FMUDT414,FMUDT415,FMUDT416:
                                FMUDT417,FMUDT418,FMUDT419,FMUDT420
.
          STORE     FMRTWIDT,F2,FMUDW401,FMUDW402,FMUDW403,FMUDW404:
                                FMUDW405,FMUDW406,FMUDW407,FMUDW408:
                                FMUDW409,FMUDW410,FMUDW411,FMUDW412:
                                FMUDW413,FMUDW414,FMUDW415,FMUDW416:
                                FMUDW417,FMUDW418,FMUDW419,FMUDW420
.
          STORE     FMRTVTYP,F2,FMUDA401,FMUDA402,FMUDA403,FMUDA404:
                                FMUDA405,FMUDA406,FMUDA407,FMUDA408:
                                FMUDA409,FMUDA410,FMUDA411,FMUDA412:
                                FMUDA413,FMUDA414,FMUDA415,FMUDA416:
                                FMUDA417,FMUDA418,FMUDA419,FMUDA420
.
          STORE     FMRTSCAL,F2,FMUDS401,FMUDS402,FMUDS403,FMUDS404:
                                FMUDS405,FMUDS406,FMUDS407,FMUDS408:
                                FMUDS409,FMUDS410,FMUDS411,FMUDS412:
                                FMUDS413,FMUDS414,FMUDS415,FMUDS416:
                                FMUDS417,FMUDS418,FMUDS419,FMUDS420
.
          STORE     FMRTPERI,F2,FMUDP401,FMUDP402,FMUDP403,FMUDP404:
                                FMUDP405,FMUDP406,FMUDP407,FMUDP408:
                                FMUDP409,FMUDP410,FMUDP411,FMUDP412:
                                FMUDP413,FMUDP414,FMUDP415,FMUDP416:
                                FMUDP417,FMUDP418,FMUDP419,FMUDP420
.
          STORE     FMRTFRMT,F2,FMUDF401,FMUDF402,FMUDF403,FMUDF404:
                                FMUDF405,FMUDF406,FMUDF407,FMUDF408:
                                FMUDF409,FMUDF410,FMUDF411,FMUDF412:
                                FMUDF413,FMUDF414,FMUDF415,FMUDF416:
                                FMUDF417,FMUDF418,FMUDF419,FMUDF420
.
WFMRD999  RETURN
.
WFMRE000  STORE     FMRTTYPE,F2,FMUDT501,FMUDT502,FMUDT503,FMUDT504:
                                FMUDT505,FMUDT506,FMUDT507,FMUDT508:
                                FMUDT509,FMUDT510,FMUDT511,FMUDT512:
                                FMUDT513,FMUDT514,FMUDT515,FMUDT516:
                                FMUDT517,FMUDT518,FMUDT519,FMUDT520
.
          STORE     FMRTWIDT,F2,FMUDW501,FMUDW502,FMUDW503,FMUDW504:
                                FMUDW505,FMUDW506,FMUDW507,FMUDW508:
                                FMUDW509,FMUDW510,FMUDW511,FMUDW512:
                                FMUDW513,FMUDW514,FMUDW515,FMUDW516:
                                FMUDW517,FMUDW518,FMUDW519,FMUDW520
.
          STORE     FMRTVTYP,F2,FMUDA501,FMUDA502,FMUDA503,FMUDA504:
                                FMUDA505,FMUDA506,FMUDA507,FMUDA508:
                                FMUDA509,FMUDA510,FMUDA511,FMUDA512:
                                FMUDA513,FMUDA514,FMUDA515,FMUDA516:
                                FMUDA517,FMUDA518,FMUDA519,FMUDA520
.
          STORE     FMRTSCAL,F2,FMUDS501,FMUDS502,FMUDS503,FMUDS504:
                                FMUDS505,FMUDS506,FMUDS507,FMUDS508:
                                FMUDS509,FMUDS510,FMUDS511,FMUDS512:
                                FMUDS513,FMUDS514,FMUDS515,FMUDS516:
                                FMUDS517,FMUDS518,FMUDS519,FMUDS520
.
          STORE     FMRTPERI,F2,FMUDP501,FMUDP502,FMUDP503,FMUDP504:
                                FMUDP505,FMUDP506,FMUDP507,FMUDP508:
                                FMUDP509,FMUDP510,FMUDP511,FMUDP512:
                                FMUDP513,FMUDP514,FMUDP515,FMUDP516:
                                FMUDP517,FMUDP518,FMUDP519,FMUDP520
.
          STORE     FMRTFRMT,F2,FMUDF501,FMUDF502,FMUDF503,FMUDF504:
                                FMUDF505,FMUDF506,FMUDF507,FMUDF508:
                                FMUDF509,FMUDF510,FMUDF511,FMUDF512:
                                FMUDF513,FMUDF514,FMUDF515,FMUDF516:
                                FMUDF517,FMUDF518,FMUDF519,FMUDF520
.
WFMRE999  RETURN
.
.------------------------------------------------------------
. Cancel whole Record
.------------------------------------------------------------
CAND0000  MOVE      SVHDLN1A,VRSTDH11
          MOVE      SVHDLN1B,VRSTDH12
          MOVE      SVHDLN1C,VRSTDH13
          MOVE      SVHDLN2A,VRSTDH21
          MOVE      SVHDLN2B,VRSTDH22
          MOVE      SVHDLN2C,VRSTDH23
.
          MOVE      ONE,EXITFLAG
.
CAND9999  RETURN
.
.------------------------------------------------------------
. Print Report Style
.------------------------------------------------------------
PRNT0000  PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
.
          CALL      WFMRX000
          CALL      OPNPRINT             * open print file
.
          MOVE      ZERO,CPAGENO         * reset page no.
          CLOCK     TIME,CTIMEIS         * get current time
          CALL      SVAR0000             * set up variables
          CALL      HEAD0000             * start new page
          CALL      MLPR0000             * print details
.
          CALL      LINE0000             * print line
          PRINT     *N,"*** End of Report ***",*N:
                    *N,"    Report Style : ",FMUDSTY,SP1,FMUDDES
.
PRNT9900  CALL      CLSPRINT             * close print file & print
          CALL      MESSAGE3
          MOVE      ONE,EXIT
.
PRNT9999  RETURN
.------------------------------------------------------------
. Set up variables
.------------------------------------------------------------
SVAR0000  UNPACK    X70,FMLALEDG,FMLADESC,FMLACYRR
          MOVE      ZERO,FMLAPERS
          UNPACK    X70,FMAMLEDG,FMAMACCT,FMAMDESC
          MOVE      ONE,FMAMTYPE
          MOVE      ZERO,FMAMAYTD
          MOVE      TWO,FMAMDPLA
          UNPACK    X70,CURYEAR,CURPERD,PERDESC
          UNPACK    X70,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
SVAR9999  RETURN
.------------------------------------------------------------
. Print Header
.------------------------------------------------------------
HEAD0000  MOVE      VRSTDWID,F2
          BRANCH    F2,HEAD2000,HEAD1000,HEAD3000,HEAD4000
.
HEAD1000  CALL      HEAD132                      * print header
          PRINT        "Ledger                     : ",FMLALEDG,SP1,FMLADESC:
                    *N,"From Period/Financial Year : ",CURPERD,"/",CURYEAR:
                    *N,"To   Period/Financial Year : ",CURPERD,"/",CURYEAR:
                     SP1,PERDESC," Ending ",CPCDATE
          ADD       "3",CLNO
          CALL      LINE0000                     * print line
          MOVE      VRSTDH12,DIM52
          PRINT     VRSTDH11,DIM52
          ADD       ONE,CLNO
.
          MATCH     SP80,VRSTDH21
          GOTO      HEAD1100 IF NOT EQUAL
          MATCH     SP80,VRSTDH22
          GOTO      HEAD1200 IF EQUAL
.
HEAD1100  MOVE      VRSTDH22,DIM52
          PRINT     VRSTDH21,DIM52
          ADD       ONE,CLNO
.
HEAD1200  CALL      LINE0000                     * print line
          GOTO      HEAD9999
.
HEAD2000  CALL      HEAD80
          PRINT       "Ledger                : ",FMLALEDG,SP1,FMLADESC:
                    *N,"Period/Financial Year : ",CURPERD,"/",CURYEAR:
                     SP1,PERDESC," Ending ",CPCDATE
          ADD       TWO,CLNO
          CALL      LINE0000                     * print line
          PRINT     VRSTDH11
          ADD       ONE,CLNO
          MATCH     SP80,VRSTDH21
          GOTO      HEAD2100 IF EQUAL
.
          PRINT     VRSTDH21
          ADD       ONE,CLNO
HEAD2100  CALL      LINE0000                     * print line
          GOTO      HEAD9999
.
HEAD3000  CALL      HEAD160                      * print header
          PRINT        "Ledger                : ",FMLALEDG,SP1,FMLADESC:
                    *N,"Period/Financial Year : ",CURPERD,"/",CURYEAR:
                     SP1,PERDESC," Ending ",CPCDATE
          ADD       TWO,CLNO
          CALL      LINE0000                     * print line
          PRINT     VRSTDH11,VRSTDH12
          ADD       ONE,CLNO
.
          MATCH     SP80,VRSTDH21
          GOTO      HEAD3100 IF NOT EQUAL
          MATCH     SP80,VRSTDH22
          GOTO      HEAD3200 IF EQUAL
.
HEAD3100  PRINT     VRSTDH21,VRSTDH22
          ADD       ONE,CLNO
.
HEAD3200  CALL      LINE0000                     * print line
          GOTO      HEAD9999
.
HEAD4000  CALL      HEAD160                      * print header
          PRINT        "Ledger                : ",FMLALEDG,SP1,FMLADESC:
                    *N,"Period/Financial Year : ",CURPERD,"/",CURYEAR:
                     SP1,PERDESC," Ending ",CPCDATE
          ADD       TWO,CLNO
          CALL      LINE0000                     * print line
          PRINT     VRSTDH11,VRSTDH12,VRSTDH13
          ADD       ONE,CLNO
.
          MATCH     SP80,VRSTDH21
          GOTO      HEAD4100 IF NOT EQUAL
          MATCH     SP80,VRSTDH22
          GOTO      HEAD4100 IF NOT EQUAL
          MATCH     SP80,VRSTDH23
          GOTO      HEAD4200 IF EQUAL
.
HEAD4100  PRINT     VRSTDH21,VRSTDH22,VRSTDH23
          ADD       ONE,CLNO
.
HEAD4200  CALL      LINE0000                     * print line
          GOTO      HEAD9999
.
HEAD160   BRANCH    CNOUNDLN,HEAD160A         * No underlines
          COMPARE   ZERO,CPAGENO              * First page ?
          GOTO      HEAD160A IF EQUAL         * Yes. Don't print underlines
.
          CALL      UND160                    * Print the last line of prev page
.
HEAD160A  ADD       ONE,CPAGENO
.
          RESET     CPHDROPT                  * Do we have a header option ?
          GOTO      HEAD160B IF EOS           * No.
.
          MATCH     SP20,CPHDROPT             * Do we have a header option ?
          GOTO      HEAD160B IF EQUAL         * No.
.
          PRINT     *F,PRGID,*60,CNAME,*146,"DATE : ",CDATE:
                    *N,VERSION,*60,PRGNAM,SP1,*+,CPHDROPT:
                       *146,"TIME : ",CTIMEIS:
                    *N,*146,"PAGE :      ",CPAGENO
          GOTO      HEAD160Z
.
HEAD160B  PRINT     *F,PRGID,*60,CNAME,*146,"DATE : ",CDATE:
                    *N,VERSION,*60,PRGNAM,*146,"TIME : ",CTIMEIS:
                    *N,*146,"PAGE :      ",CPAGENO
.
HEAD160Z  CALL      IBACLOCK
          MOVE      THREE,CLNO
          GOTO      HEAD9999
.
HEAD210   BRANCH   CNOUNDLN,HEAD210A         * No underlines
          COMPARE  ZERO,CPAGENO              * First page ?
          GOTO     HEAD210A IF EQUAL         * Yes. Don't print underlines
.
          CALL     UND210                    * Print the last line of prev page
.
HEAD210A  ADD      ONE,CPAGENO
.
          RESET    CPHDROPT                  * Do we have a header option ?
          GOTO     HEAD210B IF EOS           * No.
.
          MATCH    SP20,CPHDROPT             * Do we have a header option ?
          GOTO     HEAD210B IF EQUAL         * No.
.
          PRINT    *F,PRGID,*60,CNAME,*146,"DATE : ",CDATE:
                   *N,VERSION,*60,PRGNAM,SP1,*+,CPHDROPT:
                      *146,"TIME : ",CTIMEIS:
                   *N,*146,"PAGE :      ",CPAGENO
          GOTO     HEAD210Z
.
HEAD210B  PRINT    *F,PRGID,*60,CNAME,*146,"DATE : ",CDATE:
                   *N,VERSION,*60,PRGNAM,*146,"TIME : ",CTIMEIS:
                   *N,*146,"PAGE :      ",CPAGENO
.
HEAD210Z  CALL     IBACLOCK
          MOVE     THREE,CLNO
          GOTO     HEAD9999
.
HEAD9999  RETURN
.
UND160    PRINT    *1,"*---------------------------------------":
                      "----------------------------------------":
                      "----------------------------------------":
                      "---------------------------------------*"
          ADD      ONE,CLNO
          RETURN
.
UND210    PRINT    *1,"*---------------------------------------":
                      "----------------------------------------":
                      "----------------------------------------":
                      "----------------------------------------":
                      "----------------------------------------":
                      "---------*"
          ADD      ONE,CLNO
          RETURN
.------------------------------------------------------------
. Print Header Line
.------------------------------------------------------------
LINE0000  ADD       ONE,CLNO
          MOVE      VRSTDWID,F2
          BRANCH    F2,LINE1200,LINE1100,LINE1300,LINE1400
.
LINE1100  PRINT     "--------------------------------------------":
                    "--------------------------------------------":
                    "--------------------------------------------"
          GOTO      LINE9999
.
LINE1200  PRINT     "----------------------------------------":
                    "----------------------------------------"
          GOTO      LINE9999
.
LINE1300  PRINT     "----------------------------------------":
                    "----------------------------------------":
                    "----------------------------------------":
                    "----------------------------------------"
          GOTO      LINE9999
.
LINE1400  PRINT     "----------------------------------------":
                    "----------------------------------------":
                    "----------------------------------------":
                    "----------------------------------------":
                    "----------------------------------------":
                    "----------"
          GOTO      LINE9999
.
LINE9999  RETURN
.------------------------------------------------------------
. Main "Print Line" Routine
.                           - fmsudr record read at start of program
.------------------------------------------------------------
MLPR0000  MOVE      ZERO,CURROW       * Row Count
.
MLPR1000  MOVE      VRSTDWID,F2
          COMPARE   F2,CURROW         * Test to see if all rows have been
          GOTO      MLPR9000 IF EQUAL * printed exit if true
          ADD       ONE,CURROW        * Next Row
          MOVE      ZERO,CURCOL       * Column Count
          MOVE      ZERO,COLUMN
          CALL      CLRR0000          * Clear Row
.
MLPR2000  COMPARE   "20",CURCOL       * Check for last column
          GOTO      MLPR3000 IF EQUAL
          ADD       ONE,CURCOL        * Next Column
          CALL      LCOB0000          * Load Column Parameters
          COMPARE   ZERO,COLTYPE      * Column Type so last column
          GOTO      MLPR3000 IF EQUAL
.
          CALL      LROW0000          * Load variable into Print Array
          GOTO      MLPR2000
.
MLPR3000  CALL      PROW0000
          GOTO      MLPR1000
.
MLPR9000
.
MLPR9999  RETURN
.------------------------------------------------------------
. Print a Line
.------------------------------------------------------------
PROW0000  CALL      PRTL0000
          PRINT     SP1
          ADD       ONE,CLNO
.
PROW9999  RETURN
.------------------------------------------------------------
. Load Column Parameters
.------------------------------------------------------------
LCOB0000   MOVE     CURROW,RCLOAD    * Calculate load number
           SUB      ONE,RCLOAD
           MULT     "20",RCLOAD
           ADD      CURCOL,RCLOAD
.
           LOAD     COLTYPE,RCLOAD,FMUDT101,FMUDT102,FMUDT103,FMUDT104,FMUDT105:
                                   FMUDT106,FMUDT107,FMUDT108,FMUDT109,FMUDT110:
                                   FMUDT111,FMUDT112,FMUDT113,FMUDT114,FMUDT115:
                                   FMUDT116,FMUDT117,FMUDT118,FMUDT119,FMUDT120:
                                   FMUDT201,FMUDT202,FMUDT203,FMUDT204,FMUDT205:
                                   FMUDT206,FMUDT207,FMUDT208,FMUDT209,FMUDT210:
                                   FMUDT211,FMUDT212,FMUDT213,FMUDT214,FMUDT215:
                                   FMUDT216,FMUDT217,FMUDT218,FMUDT219,FMUDT220:
                                   FMUDT301,FMUDT302,FMUDT303,FMUDT304,FMUDT305:
                                   FMUDT306,FMUDT307,FMUDT308,FMUDT309,FMUDT310:
                                   FMUDT311,FMUDT312,FMUDT313,FMUDT314,FMUDT315:
                                   FMUDT316,FMUDT317,FMUDT318,FMUDT319,FMUDT320:
                                   FMUDT401,FMUDT402,FMUDT403,FMUDT404,FMUDT405:
                                   FMUDT406,FMUDT407,FMUDT408,FMUDT409,FMUDT410:
                                   FMUDT411,FMUDT412,FMUDT413,FMUDT414,FMUDT415:
                                   FMUDT501,FMUDT502,FMUDT503,FMUDT504,FMUDT505:
                                   FMUDT506,FMUDT507,FMUDT508,FMUDT509,FMUDT510:
                                   FMUDT511,FMUDT512,FMUDT513,FMUDT514,FMUDT515:
                                   FMUDT516,FMUDT517,FMUDT518,FMUDT519,FMUDT520
.
           LOAD     COLWIDT,RCLOAD,FMUDW101,FMUDW102,FMUDW103,FMUDW104,FMUDW105:
                                   FMUDW106,FMUDW107,FMUDW108,FMUDW109,FMUDW110:
                                   FMUDW111,FMUDW112,FMUDW113,FMUDW114,FMUDW115:
                                   FMUDW116,FMUDW117,FMUDW118,FMUDW119,FMUDW120:
                                   FMUDW201,FMUDW202,FMUDW203,FMUDW204,FMUDW205:
                                   FMUDW206,FMUDW207,FMUDW208,FMUDW209,FMUDW210:
                                   FMUDW211,FMUDW212,FMUDW213,FMUDW214,FMUDW215:
                                   FMUDW216,FMUDW217,FMUDW218,FMUDW219,FMUDW220:
                                   FMUDW301,FMUDW302,FMUDW303,FMUDW304,FMUDW305:
                                   FMUDW306,FMUDW307,FMUDW308,FMUDW309,FMUDW310:
                                   FMUDW311,FMUDW312,FMUDW313,FMUDW314,FMUDW315:
                                   FMUDW316,FMUDW317,FMUDW318,FMUDW319,FMUDW320:
                                   FMUDW401,FMUDW402,FMUDW403,FMUDW404,FMUDW405:
                                   FMUDW406,FMUDW407,FMUDW408,FMUDW409,FMUDW410:
                                   FMUDW411,FMUDW412,FMUDW413,FMUDW414,FMUDW415:
                                   FMUDW501,FMUDW502,FMUDW503,FMUDW504,FMUDW505:
                                   FMUDW506,FMUDW507,FMUDW508,FMUDW509,FMUDW510:
                                   FMUDW511,FMUDW512,FMUDW513,FMUDW514,FMUDW515:
                                   FMUDW516,FMUDW517,FMUDW518,FMUDW519,FMUDW520
.
           LOAD     COLATYP,RCLOAD,FMUDA101,FMUDA102,FMUDA103,FMUDA104,FMUDA105:
                                   FMUDA106,FMUDA107,FMUDA108,FMUDA109,FMUDA110:
                                   FMUDA111,FMUDA112,FMUDA113,FMUDA114,FMUDA115:
                                   FMUDA116,FMUDA117,FMUDA118,FMUDA119,FMUDA120:
                                   FMUDA201,FMUDA202,FMUDA203,FMUDA204,FMUDA205:
                                   FMUDA206,FMUDA207,FMUDA208,FMUDA209,FMUDA210:
                                   FMUDA211,FMUDA212,FMUDA213,FMUDA214,FMUDA215:
                                   FMUDA216,FMUDA217,FMUDA218,FMUDA219,FMUDA220:
                                   FMUDA301,FMUDA302,FMUDA303,FMUDA304,FMUDA305:
                                   FMUDA306,FMUDA307,FMUDA308,FMUDA309,FMUDA310:
                                   FMUDA311,FMUDA312,FMUDA313,FMUDA314,FMUDA315:
                                   FMUDA316,FMUDA317,FMUDA318,FMUDA319,FMUDA320:
                                   FMUDA401,FMUDA402,FMUDA403,FMUDA404,FMUDA405:
                                   FMUDA406,FMUDA407,FMUDA408,FMUDA409,FMUDA410:
                                   FMUDA411,FMUDA412,FMUDA413,FMUDA414,FMUDA415:
                                   FMUDA501,FMUDA502,FMUDA503,FMUDA504,FMUDA505:
                                   FMUDA506,FMUDA507,FMUDA508,FMUDA509,FMUDA510:
                                   FMUDA511,FMUDA512,FMUDA513,FMUDA514,FMUDA515:
                                   FMUDA516,FMUDA517,FMUDA518,FMUDA519,FMUDA520
.
           LOAD     COLSCAL,RCLOAD,FMUDS101,FMUDS102,FMUDS103,FMUDS104,FMUDS105:
                                   FMUDS106,FMUDS107,FMUDS108,FMUDS109,FMUDS110:
                                   FMUDS111,FMUDS112,FMUDS113,FMUDS114,FMUDS115:
                                   FMUDS116,FMUDS117,FMUDS118,FMUDS119,FMUDS120:
                                   FMUDS201,FMUDS202,FMUDS203,FMUDS204,FMUDS205:
                                   FMUDS206,FMUDS207,FMUDS208,FMUDS209,FMUDS210:
                                   FMUDS211,FMUDS212,FMUDS213,FMUDS214,FMUDS215:
                                   FMUDS216,FMUDS217,FMUDS218,FMUDS219,FMUDS220:
                                   FMUDS301,FMUDS302,FMUDS303,FMUDS304,FMUDS305:
                                   FMUDS306,FMUDS307,FMUDS308,FMUDS309,FMUDS310:
                                   FMUDS311,FMUDS312,FMUDS313,FMUDS314,FMUDS315:
                                   FMUDS316,FMUDS317,FMUDS318,FMUDS319,FMUDS320:
                                   FMUDS401,FMUDS402,FMUDS403,FMUDS404,FMUDS405:
                                   FMUDS406,FMUDS407,FMUDS408,FMUDS409,FMUDS410:
                                   FMUDS411,FMUDS412,FMUDS413,FMUDS414,FMUDS415:
                                   FMUDS501,FMUDS502,FMUDS503,FMUDS504,FMUDS505:
                                   FMUDS506,FMUDS507,FMUDS508,FMUDS509,FMUDS510:
                                   FMUDS511,FMUDS512,FMUDS513,FMUDS514,FMUDS515:
                                   FMUDS516,FMUDS517,FMUDS518,FMUDS519,FMUDS520
.
           LOAD     COLPERD,RCLOAD,FMUDP101,FMUDP102,FMUDP103,FMUDP104,FMUDP105:
                                   FMUDP106,FMUDP107,FMUDP108,FMUDP109,FMUDP110:
                                   FMUDP111,FMUDP112,FMUDP113,FMUDP114,FMUDP115:
                                   FMUDP116,FMUDP117,FMUDP118,FMUDP119,FMUDP120:
                                   FMUDP201,FMUDP202,FMUDP203,FMUDP204,FMUDP205:
                                   FMUDP206,FMUDP207,FMUDP208,FMUDP209,FMUDP210:
                                   FMUDP211,FMUDP212,FMUDP213,FMUDP214,FMUDP215:
                                   FMUDP216,FMUDP217,FMUDP218,FMUDP219,FMUDP220:
                                   FMUDP301,FMUDP302,FMUDP303,FMUDP304,FMUDP305:
                                   FMUDP306,FMUDP307,FMUDP308,FMUDP309,FMUDP310:
                                   FMUDP311,FMUDP312,FMUDP313,FMUDP314,FMUDP315:
                                   FMUDP316,FMUDP317,FMUDP318,FMUDP319,FMUDP320:
                                   FMUDP401,FMUDP402,FMUDP403,FMUDP404,FMUDP405:
                                   FMUDP406,FMUDP407,FMUDP408,FMUDP409,FMUDP410:
                                   FMUDP411,FMUDP412,FMUDP413,FMUDP414,FMUDP415:
                                   FMUDP501,FMUDP502,FMUDP503,FMUDP504,FMUDP505:
                                   FMUDP506,FMUDP507,FMUDP508,FMUDP509,FMUDP510:
                                   FMUDP511,FMUDP512,FMUDP513,FMUDP514,FMUDP515:
                                   FMUDP516,FMUDP517,FMUDP518,FMUDP519,FMUDP520
.
           LOAD     COLFORM,RCLOAD,FMUDF101,FMUDF102,FMUDF103,FMUDF104,FMUDF105:
                                   FMUDF106,FMUDF107,FMUDF108,FMUDF109,FMUDF110:
                                   FMUDF111,FMUDF112,FMUDF113,FMUDF114,FMUDF115:
                                   FMUDF116,FMUDF117,FMUDF118,FMUDF119,FMUDF120:
                                   FMUDF201,FMUDF202,FMUDF203,FMUDF204,FMUDF205:
                                   FMUDF206,FMUDF207,FMUDF208,FMUDF209,FMUDF210:
                                   FMUDF211,FMUDF212,FMUDF213,FMUDF214,FMUDF215:
                                   FMUDF216,FMUDF217,FMUDF218,FMUDF219,FMUDF220:
                                   FMUDF301,FMUDF302,FMUDF303,FMUDF304,FMUDF305:
                                   FMUDF306,FMUDF307,FMUDF308,FMUDF309,FMUDF310:
                                   FMUDF311,FMUDF312,FMUDF313,FMUDF314,FMUDF315:
                                   FMUDF316,FMUDF317,FMUDF318,FMUDF319,FMUDF320:
                                   FMUDF401,FMUDF402,FMUDF403,FMUDF404,FMUDF405:
                                   FMUDF406,FMUDF407,FMUDF408,FMUDF409,FMUDF410:
                                   FMUDF411,FMUDF412,FMUDF413,FMUDF414,FMUDF415:
                                   FMUDF501,FMUDF502,FMUDF503,FMUDF504,FMUDF505:
                                   FMUDF506,FMUDF507,FMUDF508,FMUDF509,FMUDF510:
                                   FMUDF511,FMUDF512,FMUDF513,FMUDF514,FMUDF515:
                                   FMUDF516,FMUDF517,FMUDF518,FMUDF519,FMUDF520
.
           RETURN
.------------------------------------------------------------
. Load a variable into the print array
.
. Parameters for column - COLTYPE = column type
.------------------------------------------------------------
LROW0000  UNPACK    SP70,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                         TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                         TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                         TCOL16,TCOL17,TCOL18,TCOL19,TCOL20:
                         TCOL21,TCOL22,TCOL23,TCOL24,TCOL25:
                         TCOL26,TCOL27,TCOL28,TCOL29,TCOL30:
                         TCOL31,TCOL32,TCOL33,TCOL34,TCOL35:
                         TCOL36
.
          BRANCH    COLTYPE,LROW1000,LROW2000
.
LROW0100  MATCH     "7",FMAMTYPE
          GOTO      LROW0200 IF EQUAL
.
          BRANCH    COLTYPE,LROW1000,LROW2000,LROW3000,LROW4000,LROW5000:
                            LROW6000
.
LROW0200  CALL      STRC0000
          GOTO      LROW9999
.
. 1 Account Code
.
LROW1000  UNPACK    FMAMACCT,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                             TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                             TCOL11,TCOL12
.
          CALL      STRC0000
.
          GOTO      LROW9999
.
. 2 Account Description
.
LROW2000  CALL      FDES0000   * Get Required Description
          UNPACK    DESC35,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                             TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                             TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                             TCOL16,TCOL17,TCOL18,TCOL19,TCOL20:
                             TCOL21,TCOL22,TCOL23,TCOL24,TCOL25:
                             TCOL26,TCOL27,TCOL28,TCOL29,TCOL30:
                             TCOL31,TCOL32,TCOL33,TCOL34,TCOL35:
                             TCOL36
          MATCH     "7",FMAMTYPE
          GOTO      LROW2100 IF NOT EQUAL
.
LROW2100  CALL      STRC0000
.
          GOTO      LROW9999
.
. 3 Amount
.
LROW3000  CALL      FAMT0000    * Determine Formated Amount
.
          UNPACK    FAMOUNT,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                            TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                            TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                            TCOL16,TCOL17,TCOL18,TCOL19,TCOL20
          CALL      STRC0000
          GOTO      LROW9999
.
. 4 Variance Amount
.
LROW4000  CALL      XVAR0000
          UNPACK    FAMOUNT,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                            TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                            TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                            TCOL16,TCOL17,TCOL18,TCOL19,TCOL20
          CALL      STRC0000
          GOTO      LROW9999
.
. 5 Variance Percentage
.
LROW5000  CALL      FPVA0000
          UNPACK    FAMOUNT,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                            TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                            TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                            TCOL16,TCOL17,TCOL18,TCOL19,TCOL20
          CALL      STRC0000
          GOTO      LROW9999
.
. 6 Text
.
LROW6000  UNPACK    COLFORM,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                            TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                            TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                            TCOL16,TCOL17,TCOL18,TCOL19,TCOL20
          CALL      STRC0000
          GOTO      LROW9999
.
LROW9999  RETURN
.------------------------------------------------------------
. FDES format Description
.------------------------------------------------------------
FDES0000  MOVE      FMAMDESC,DESC35
.
FDES9999  RETURN
.------------------------------------------------------------
. Get And Format Amount
.------------------------------------------------------------
FAMT0000  MOVE      ZERO,AMOUNTD
          MOVE      ZERO,AMOUNTS
          MOVE      ZERO,AMOUNTC
.
FAMT8000  MATCH     "7",FMAMTYPE
          GOTO      FAMT8400 IF NOT LESS
          BRANCH    COLSCAL,FAMT8100,FAMT8200,FAMT8300
.
FAMT8100  MOVE      COLFORM,FAMOUNT     * Dollars and Cents
          FEDIT     AMOUNTC,FAMOUNT
          GOTO      FAMT9999
.
FAMT8200  MOVE      COLFORM,FAMOUNT     * Dollars Only
          FEDIT     AMOUNTD,FAMOUNT
          GOTO      FAMT9999
.
FAMT8300  MOVE      COLFORM,FAMOUNT     * Thousands Only
          DIV       "1000",AMOUNTD
          FEDIT     AMOUNTD,FAMOUNT
          GOTO      FAMT9999
.
FAMT8400  CALL      FSTAT000            * Format Statistical Amount
          GOTO      FAMT9999
.
FAMT9999  RETURN
.------------------------------------------------------------
. Store a Variable into the Print Array
. Fields Passed to Routine - Field Length 1 - 36
.                          - Arrary of the Field in TCOL01 to TCOL36
.------------------------------------------------------------
STRC0000  MOVE      ZERO,COUNT
          COMPARE   ZERO,COLWIDT
          GOTO      STRC9999 IF EQUAL
.
STRC1000  ADD       ONE,COUNT
          LOAD      TCOL,COUNT,TCOL01,TCOL02,TCOL03,TCOL04,TCOL05:
                               TCOL06,TCOL07,TCOL08,TCOL09,TCOL10:
                               TCOL11,TCOL12,TCOL13,TCOL14,TCOL15:
                               TCOL16,TCOL17,TCOL18,TCOL19,TCOL20:
                               TCOL21,TCOL22,TCOL23,TCOL24,TCOL25:
                               TCOL26,TCOL27,TCOL28,TCOL29,TCOL30:
                               TCOL31,TCOL32,TCOL33,TCOL34,TCOL35:
                               TCOL36
.
          ADD       ONE,COLUMN
          STORE     TCOL,COLUMN,CO001,CO002,CO003,CO004,CO005:
                                CO006,CO007,CO008,CO009,CO010:
                    CO011,CO012,CO013,CO014,CO015,CO016,CO017,CO018,CO019,CO020:
                    CO021,CO022,CO023,CO024,CO025,CO026,CO027,CO028,CO029,CO030:
                    CO031,CO032,CO033,CO034,CO035,CO036,CO037,CO038,CO039,CO040:
                    CO041,CO042,CO043,CO044,CO045,CO046,CO047,CO048,CO049,CO050:
                    CO051,CO052,CO053,CO054,CO055,CO056,CO057,CO058,CO059,CO060:
                    CO061,CO062,CO063,CO064,CO065,CO066,CO067,CO068,CO069,CO070:
                    CO071,CO072,CO073,CO074,CO075,CO076,CO077,CO078,CO079,CO080:
                    CO081,CO082,CO083,CO084,CO085,CO086,CO087,CO088,CO089,CO090:
                    CO091,CO092,CO093,CO094,CO095,CO096,CO097,CO098,CO099,CO100:
                    CO101,CO102,CO103,CO104,CO105,CO106,CO107,CO108,CO109,CO110:
                    CO111,CO112,CO113,CO114,CO115,CO116,CO117,CO118,CO119,CO120:
                    CO121,CO122,CO123,CO124,CO125,CO126,CO127,CO128,CO129,CO130:
                    CO131,CO132,CO133,CO134,CO135,CO136,CO137,CO138,CO139,CO140:
                    CO141,CO142,CO143,CO144,CO145,CO146,CO147,CO148,CO149,CO150:
                    CO151,CO152,CO153,CO154,CO155,CO156,CO157,CO158,CO159,CO160:
                    CO161,CO162,CO163,CO164,CO165,CO166,CO167,CO168,CO169,CO170:
                    CO171,CO172,CO173,CO174,CO175,CO176,CO177,CO178,CO179,CO180:
                    CO181,CO182,CO183,CO184,CO185,CO186,CO187,CO188,CO189,CO190:
                    CO191,CO192,CO193,CO194,CO195,CO196,CO197,CO198,CO199,CO200:
                    CO201,CO202,CO203,CO204,CO205,CO206,CO207,CO208,CO209,CO210
.
          COMPARE   COLWIDT,COUNT
          GOTO      STRC1000 IF NOT EQUAL
.
STRC9999  RETURN
.------------------------------------------------------------
. Print Print Array
.------------------------------------------------------------
PRTL0000  MOVE      FMUDWID,F1
          BRANCH    F1,PRTL1000,PRTL2000,PRTL3000,PRTL40000
.
PRTL1000  PRINT  *1,CO001,CO002,CO003,CO004,CO005,CO006,CO007,CO008,CO009,CO010:
                    CO011,CO012,CO013,CO014,CO015,CO016,CO017,CO018,CO019,CO020:
                    CO021,CO022,CO023,CO024,CO025,CO026,CO027,CO028,CO029,CO030:
                    CO031,CO032,CO033,CO034,CO035,CO036,CO037,CO038,CO039,CO040:
                    CO041,CO042,CO043,CO044,CO045,CO046,CO047,CO048,CO049,CO050:
                    CO051,CO052,CO053,CO054,CO055,CO056,CO057,CO058,CO059,CO060:
                    CO061,CO062,CO063,CO064,CO065,CO066,CO067,CO068,CO069,CO070:
                    CO071,CO072,CO073,CO074,CO075,CO076,CO077,CO078,CO079,CO080:
                    CO081,CO082,CO083,CO084,CO085,CO086,CO087,CO088,CO089,CO090:
                    CO091,CO092,CO093,CO094,CO095,CO096,CO097,CO098,CO099,CO100:
                    CO101,CO102,CO103,CO104,CO105,CO106,CO107,CO108,CO109,CO110:
                    CO111,CO112,CO113,CO114,CO115,CO116,CO117,CO118,CO119,CO120:
                    CO121,CO122,CO123,CO124,CO125,CO126,CO127,CO128,CO129,CO130:
                    CO131;
          GOTO      PRTL9999
.
PRTL2000  PRINT  *1,CO001,CO002,CO003,CO004,CO005,CO006,CO007,CO008,CO009,CO010:
                    CO011,CO012,CO013,CO014,CO015,CO016,CO017,CO018,CO019,CO020:
                    CO021,CO022,CO023,CO024,CO025,CO026,CO027,CO028,CO029,CO030:
                    CO031,CO032,CO033,CO034,CO035,CO036,CO037,CO038,CO039,CO040:
                    CO041,CO042,CO043,CO044,CO045,CO046,CO047,CO048,CO049,CO050:
                    CO051,CO052,CO053,CO054,CO055,CO056,CO057,CO058,CO059,CO060:
                    CO071,CO072,CO073,CO074,CO075,CO076,CO077,CO078,CO079;
          GOTO      PRTL9999
.
PRTL3000  PRINT  *1,CO001,CO002,CO003,CO004,CO005,CO006,CO007,CO008,CO009,CO010:
                    CO011,CO012,CO013,CO014,CO015,CO016,CO017,CO018,CO019,CO020:
                    CO021,CO022,CO023,CO024,CO025,CO026,CO027,CO028,CO029,CO030:
                    CO031,CO032,CO033,CO034,CO035,CO036,CO037,CO038,CO039,CO040:
                    CO041,CO042,CO043,CO044,CO045,CO046,CO047,CO048,CO049,CO050:
                    CO051,CO052,CO053,CO054,CO055,CO056,CO057,CO058,CO059,CO060:
                    CO061,CO062,CO063,CO064,CO065,CO066,CO067,CO068,CO069,CO070:
                    CO071,CO072,CO073,CO074,CO075,CO076,CO077,CO078,CO079,CO080:
                    CO081,CO082,CO083,CO084,CO085,CO086,CO087,CO088,CO089,CO090:
                    CO091,CO092,CO093,CO094,CO095,CO096,CO097,CO098,CO099,CO100:
                    CO101,CO102,CO103,CO104,CO105,CO106,CO107,CO108,CO109,CO110:
                    CO111,CO112,CO113,CO114,CO115,CO116,CO117,CO118,CO119,CO120:
                    CO121,CO122,CO123,CO124,CO125,CO126,CO127,CO128,CO129,CO130:
                    CO131,CO132,CO133,CO134,CO135,CO136,CO137,CO138,CO139,CO140:
                    CO141,CO142,CO143,CO144,CO145,CO146,CO147,CO148,CO149,CO150:
                    CO151,CO152,CO153,CO154,CO155,CO156,CO157,CO158,CO159;
          GOTO      PRTL9999
.
PRTL4000  PRINT  *1,CO001,CO002,CO003,CO004,CO005,CO006,CO007,CO008,CO009,CO010:
                    CO011,CO012,CO013,CO014,CO015,CO016,CO017,CO018,CO019,CO020:
                    CO021,CO022,CO023,CO024,CO025,CO026,CO027,CO028,CO029,CO030:
                    CO031,CO032,CO033,CO034,CO035,CO036,CO037,CO038,CO039,CO040:
                    CO041,CO042,CO043,CO044,CO045,CO046,CO047,CO048,CO049,CO050:
                    CO051,CO052,CO053,CO054,CO055,CO056,CO057,CO058,CO059,CO060:
                    CO061,CO062,CO063,CO064,CO065,CO066,CO067,CO068,CO069,CO070:
                    CO071,CO072,CO073,CO074,CO075,CO076,CO077,CO078,CO079,CO080:
                    CO081,CO082,CO083,CO084,CO085,CO086,CO087,CO088,CO089,CO090:
                    CO091,CO092,CO093,CO094,CO095,CO096,CO097,CO098,CO099,CO100:
                    CO101,CO102,CO103,CO104,CO105,CO106,CO107,CO108,CO109,CO110:
                    CO111,CO112,CO113,CO114,CO115,CO116,CO117,CO118,CO119,CO120:
                    CO121,CO122,CO123,CO124,CO125,CO126,CO127,CO128,CO129,CO130:
                    CO131,CO132,CO133,CO134,CO135,CO136,CO137,CO138,CO139,CO140:
                    CO141,CO142,CO143,CO144,CO145,CO146,CO147,CO148,CO149,CO150:
                    CO151,CO152,CO153,CO154,CO155,CO156,CO157,CO158,CO159,CO160:
                    CO161,CO162,CO163,CO164,CO165,CO166,CO167,CO168,CO169,CO170:
                    CO171,CO172,CO173,CO174,CO175,CO176,CO177,CO178,CO179,CO180:
                    CO181,CO182,CO183,CO184,CO185,CO186,CO187,CO188,CO189,CO190:
                    CO191,CO192,CO193,CO194,CO195,CO196,CO197,CO198,CO199,CO200:
                    CO201,CO202,CO203,CO204,CO205,CO206,CO207,CO208,CO209;
          GOTO      PRTL9999
.
PRTL9999  RETURN
.------------------------------------------------------------
. Format Statistical Amount
.------------------------------------------------------------
FSTAT000  MOVE      FMAMDPLA,F2
          CLEAR     FAMOUNT
          BRANCH    F2,FSTAT100,FSTAT200,FSTAT300,FSTAT400,FSTAT500
.
.---- no decimal places ----
.
          MOVE      AMOUNTS,F12
          MOVE      COLWIDT,F2
          SUB       NINE,F2
          LOAD      FAMOUNT,F2,STF010,STF020,STF030,STF040,STF050:
                               STF060,STF070,STF080,STF090,STF100,STF110
          FEDIT     F12,FAMOUNT
          GOTO      FSTAT999
.
.---- 1 decimal places ----
.
FSTAT100  MOVE      AMOUNTS,F12P1
          MOVE      COLWIDT,F2
          SUB       NINE,F2
          LOAD      FAMOUNT,F2,STF011,STF021,STF031,STF041,STF051:
                               STF061,STF071,STF081,STF091,STF101,STF111
          FEDIT     F12P1,FAMOUNT
          GOTO      FSTAT999
.
.---- 2 decimal places ----
.
FSTAT200  MOVE      AMOUNTS,F12P2
          MOVE      COLWIDT,F2
          SUB       NINE,F2
          LOAD      FAMOUNT,F2,STF012,STF022,STF032,STF042,STF052:
                               STF062,STF072,STF082,STF092,STF102,STF112
          FEDIT     F12P2,FAMOUNT
          GOTO      FSTAT999
.
.---- 3 decimal places ----
.
FSTAT300  MOVE      AMOUNTS,F12P3
          MOVE      COLWIDT,F2
          SUB       NINE,F2
          LOAD      FAMOUNT,F2,STF013,STF023,STF033,STF043,STF053:
                               STF063,STF073,STF083,STF093,STF103,STF113
          FEDIT     F12P3,FAMOUNT
          GOTO      FSTAT999
.
.---- 4 decimal places ----
.
FSTAT400  MOVE      AMOUNTS,F12P4
          MOVE      COLWIDT,F2
          SUB       NINE,F2
          LOAD      FAMOUNT,F2,STF014,STF024,STF034,STF044,STF054:
                               STF064,STF074,STF084,STF094,STF104,STF114
          FEDIT     F12P4,FAMOUNT
          GOTO      FSTAT999
.
.---- 5 decimal places ----
.
FSTAT500  MOVE      COLWIDT,F2
          SUB       NINE,F2
          LOAD      FAMOUNT,F2,STF015,STF025,STF035,STF045,STF055:
                               STF065,STF075,STF085,STF095,STF105,STF115
          FEDIT     AMOUNTS,FAMOUNT
.
FSTAT999  RETURN
.------------------------------------------------------------
. Calculate Variance Amount
.------------------------------------------------------------
XVAR0000  MOVE      ZERO,AMOUNTD
          MOVE      ZERO,AMOUNTS
          MOVE      ZERO,AMOUNTC
.
XVAR8000  MATCH     "7",FMAMTYPE
          GOTO      XVAR8400 IF NOT LESS
          BRANCH    COLSCAL,XVAR8100,XVAR8200,XVAR8300
.
XVAR8100  MOVE      COLFORM,FAMOUNT     * Dollars and Cents
          FEDIT     AMOUNTC,FAMOUNT
          GOTO      XVAR9999
.
XVAR8200  MOVE      COLFORM,FAMOUNT     * Dollars Only
          FEDIT     AMOUNTD,FAMOUNT
          GOTO      XVAR9999
.
XVAR8300  MOVE      COLFORM,FAMOUNT     * Thousands Only
          DIV       "1000",AMOUNTD
          FEDIT     AMOUNTD,FAMOUNT
          GOTO      XVAR9999
.
XVAR8400  CALL      FSTAT000            * Format Statistical Amount
          GOTO      XVAR9999
.
XVAR9999  RETURN
.
CLRR0000  UNPACK     SP70,CO001,CO002,CO003,CO004,CO005,CO006,CO007:
                          CO008,CO009,CO010,CO011,CO012,CO013,CO014:
                          CO015,CO016,CO017,CO018,CO019,CO020,CO021:
                          CO022,CO023,CO024,CO025,CO026,CO027,CO028:
                          CO029,CO030,CO031,CO032,CO033,CO034,CO035:
                          CO036,CO037,CO038,CO039,CO040,CO041,CO042:
                          CO043,CO044,CO045,CO046,CO047,CO048,CO049:
                          CO050,CO051,CO052,CO053,CO054,CO055,CO056:
                          CO057,CO058,CO059,CO060,CO061,CO062,CO063:
                          CO064,CO065,CO066,CO067,CO068,CO069,CO070
          UNPACK     SP70,CO071,CO072,CO073,CO074,CO075,CO076,CO077:
                          CO078,CO079,CO080,CO081,CO082,CO083,CO084:
                          CO085,CO086,CO087,CO088,CO089,CO090,CO091:
                          CO092,CO093,CO094,CO095,CO096,CO097,CO098:
                          CO099,CO100,CO101,CO102,CO103,CO104,CO105:
                          CO106,CO107,CO108,CO109,CO110,CO111,CO112:
                          CO113,CO114,CO115,CO116,CO117,CO118,CO119:
                          CO120,CO121,CO122,CO123,CO124,CO125,CO126:
                          CO127,CO128,CO129,CO130,CO131,CO132,CO133:
                          CO134,CO135,CO136,CO137,CO138,CO139,CO140
          UNPACK     SP70,CO141,CO142,CO143,CO144,CO145,CO146,CO147:
                          CO148,CO149,CO150,CO151,CO152,CO153,CO154:
                          CO155,CO156,CO157,CO158,CO159,CO160,CO161:
                          CO162,CO163,CO164,CO165,CO166,CO167,CO168:
                          CO169,CO170,CO171,CO172,CO173,CO174,CO175:
                          CO176,CO177,CO178,CO179,CO180,CO181,CO182:
                          CO183,CO184,CO185,CO186,CO187,CO188,CO189:
                          CO190,CO191,CO192,CO193,CO194,CO195,CO196:
                          CO197,CO198,CO199,CO200,CO201,CO202,CO203:
                          CO204,CO205,CO206,CO207,CO208,CO209,CO210
          RETURN
.------------------------------------------------------------
. Calculate Percentage Variance Amount
.------------------------------------------------------------
FPVA0000  MOVE      ZERO,AMOUNTD
          MOVE      ZERO,AMOUNTS
          MOVE      ZERO,AMOUNTC
.
FPVA8000  MATCH     "7",FMAMTYPE
          GOTO      FPVA8400 IF NOT LESS
          BRANCH    COLSCAL,FPVA8100,FPVA8200,FPVA8300
.
FPVA8100  MOVE      COLFORM,FAMOUNT     * Dollars and Cents
          FEDIT     AMOUNTC,FAMOUNT
          GOTO      FPVA9999
.
FPVA8200  MOVE      COLFORM,FAMOUNT     * Dollars Only
          FEDIT     AMOUNTD,FAMOUNT
          GOTO      FPVA9999
.
FPVA8300  MOVE      COLFORM,FAMOUNT     * Thousands Only
          DIV       "1000",AMOUNTD
          FEDIT     AMOUNTD,FAMOUNT
          GOTO      FPVA9999
.
FPVA8400  CALL      FSTAT000            * Format Statistical Amount
          GOTO      FPVA9999
.
FPVA9999  RETURN
.
.------------------------------------------------------------
. Enter Report Heading Line 1
.------------------------------------------------------------
EHEA0000  MOVE      VRSTDWID,F1
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDH11
          BRANCH    F1,EHEA9000
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,CCOL
            MOVE     SCPSROW,CVERT
          ENDIF
.
          IF        F1=2
            PACK      DIM52,VRSTDH12
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,DIM52
            PACK      VRSTDH12,DIM52,SP70
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDH12
          ENDIF
          BRANCH    F1,EHEA9000,EHEA9000,EHEA9000
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,CCOL
            MOVE     SCPSROW,CVERT
          ENDIF
.
EHEA0200  KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDH13
.
EHEA9000  BRANCH    F1,EHEA9100,EHEA9200,EHEA9200
          GOTO      EHEA9900
.
EHEA9100  PACK      VRSTDH12,SP70,SP70
EHEA9200  PACK      VRSTDH13,SP70,SP70
          GOTO      EHEA9900
.
EHEA9900  MOVE      "    9",FLDID
          CALL      GETPOSIT
.
EHEA9999  RETURN
.
.------------------------------------------------------------
. Enter Report Heading Line 2
.------------------------------------------------------------
EHEB0000  MOVE      VRSTDWID,F1
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDH21
          BRANCH    F1,EHEB9000
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,CCOL
            MOVE     SCPSROW,CVERT
          ENDIF
.
          IF        F1=2
            PACK      DIM52,VRSTDH22
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,DIM52
            PACK      VRSTDH22,DIM52,SP70
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDH22
          ENDIF
          BRANCH    F1,EHEB9000,EHEB9000,EHEB9000
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,CCOL
            MOVE     SCPSROW,CVERT
          ENDIF
.
EHEB0200  KEYIN     *PCCOL:CVERT,*V2LON,*RV,VRSTDH23
.
EHEB9000  BRANCH    F1,EHEB9100,EHEB9200,EHEB9200
          GOTO      EHEB9900
.
EHEB9100  PACK      VRSTDH22,SP70,SP70
EHEB9200  PACK      VRSTDH23,SP70,SP70
          GOTO      EHEB9900
.
EHEB9900  MOVE      "   12",FLDID
          CALL      GETPOSIT
.
EHEB9999  RETURN
.
.------------------------------------------------------------
. Copy Report Style
.------------------------------------------------------------
..CRST0000  PACK      DISPMSG,SP70,SP70
..          CALL      MESSAGE2
.
CRST0000  MOVE      FMUDSTY,FROMRSTY
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMRSTY,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
.
CRST0100  MOVE      TWO,CKEYTYP
          PACK      FMUDSTY,SP70
          PACK      FMUDDES,SP70
          CALL      KFMUDA00
          BRANCH    EXIT,CRST9900,CRST9900
          BRANCH    OVRCD,CRST0200
.
          MOVE      "Unable copy to an Existing Report Style. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      CRST0100
.
CRST0200  PACK      TORSTY,FMUDSTY,SP70
.
          CALL      POSTQST
          BRANCH    CEXIT,CRST0300,CRST9900
          GOTO      CRST9900
.
CRST0300  PACK      KEY3,FROMRSTY,SP70
          CALL      RDFMUD1
          BRANCH    OVRCD,CRST9900
.
          MOVE      TORSTY,FMUDSTY
          PACK      KEY3,FMUDSTY,SP70
          CALL      RAFMUD1
          IF        OVRCD=1
            CALL      WRFMUD1
          ENDIF
.
CRST9900  MOVE      ONE,EXIT
.
CRST9999  RETURN
.------------------------------------------------------------
. Set Screen 3A,B,and C
.------------------------------------------------------------
ST3X0000  MOVE      ZERO,ACCEPT
          BRANCH    CHNGMODE,ST3X0100
          MOVE      ONE,ACCEPT
.
ST3X0100  MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESMNWD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VDESMXWD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      FMRTTYPE,F2
          BRANCH    F2,ST3X9900,ST3X9900,ST3X0200,ST3X0200,ST3X0200
          GOTO      ST3X9900
.
ST3X0200  MOVE      FMRTVTYP,F2
          CALL      DVTYP000
.
          MOVE      FMRTPERI,F2
          CALL      DAPER000
.
          MOVE      FMRTSCAL,F2
          CALL      DSCAL000
.
ST3X9900  MOVE      "    5",FLDID
          CALL      GETPOSIT
.
ST3X9999  RETURN
.
.------------------------------------------------------------
. Post Detail
.------------------------------------------------------------
POSC0000  MOVE      FMRTTYPE,F2
          BRANCH    F2,POSC0200,POSC0200,POSC0500,POSC0500,POSC0500,POSC0300
.
POSC0200  PACK      FMRTFRMT,SP70
.
POSC0300  MOVE      " 0",FMRTVTYP
          MOVE      " 0",FMRTSCAL
          MOVE      " 0",FMRTPERI
.
POSC0500  PACK      FMRTSPAR,SP70
.
          MOVE      FMUDSTY,FMRTSTYC
          MOVE      VRSTDROW,FMRTROWN
          PACK      KEY7,FMUDSTY,VRSTDROW,FMRTLINE,SP70
          CALL      RAFMRT1
          BRANCH    OVRCD,POSC0600
.
          CALL      UPFMRT1
          GOTO      POSC9000
.
POSC0600  CALL      WRFMRT1
          GOTO      POSC9000
.
POSC9000  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
.
          GOTO      POSC9999
.
POSC9999  RETURN
.
.------------------------------------------------------------
. Cancel Detail
.------------------------------------------------------------
CANC0000  BRANCH    CHNGMODE,CANC9999
          SUB       ONE,LINECNTER
.
CANC9999  RETURN
.
.------------------------------------------------------------
. Delete Detail
.------------------------------------------------------------
DELC0000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          CALL      DELQST
          CALL      MESSAGE3
          BRANCH    CEXIT,DELC1000,DELC9999,DELC9999
.
DELC1000  PACK      KEY7,FMUDSTY,VRSTDROW,FMRTLINE,SP70
          CALL      RAFMRT1
          IF        OVRCD=0
            CALL      DEFMRT1
            CALL      SORTC000
          ENDIF
.
          BRANCH    CHNGMODE,DELC9999
          SUB       ONE,LINECNTER
.
DELC9999  RETURN
.------------------------------------------------------------
. Sort temporary record
.------------------------------------------------------------
SORTC000  MOVE      FMRTLINE,F2
SORTC100  ADD       ONE,F2
          PACK      KEY7,FMUDSTY,VRSTDROW,F2,SP70
          CALL      RDFMRT1
          BRANCH    OVRCD,SORTC999
.
          SUB       ONE,F2
          MOVE      F2,FMRTLINE
          CALL      UPFMRT1
          ADD       ONE,F2
          GOTO      SORTC100
.
SORTC999  RETURN
.
.------------------------------------------------------------
. Enter Column Width
.------------------------------------------------------------
EWID0000  KEYIN     *PCCOL:CVERT,*V2LON,*RV,FMRTWIDT
          MATCH     SP70,FMRTWIDT
          GOTO      EWID0000 IF EQUAL
.
          CMATCH    EXITCHAR,FMRTWIDT
          GOTO      EWID0000 IF EQUAL
.
          TYPE      FMRTWIDT
          GOTO      EWID0000 IF NOT EQUAL
.
          MOVE      FMRTWIDT,F2
          COMPARE   VDESMNWD,F2
          GOTO      EWID0000 IF LESS
          COMPARE   F2,VDESMXWD
          GOTO      EWID0000 IF LESS
.
          MOVE      F2,FMRTWIDT
          IF        ACCEPT=0
            CALL      DWID0000
          ENDIF
.
          GOTO      EWID9999
.
EWID9999  RETURN
.
DWID0000  MOVE      FMRTTYPE,F2
          BRANCH    F2,DWID9999,DWID9999,DWID0100,DWID0100,DWID0100,DWID0200
          GOTO      DWID9999
.
DWID0100  MOVE      "   14",FLDID
          GOTO      DWID0300
.
DWID0200  MOVE      "    8",FLDID
          GOTO      DWID0300
.
DWID0300  CALL      GETPOSIT
          MOVE      ONE,DISPFLAG
          CALL      EFOR0000
          MOVE      ZERO,DISPFLAG
.
          MOVE      FMRTFRMT,VAR
          CALL      DISPITEM
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
.
DWID9999  RETURN
.------------------------------------------------------------
. Enter Amount/Variant Type
.------------------------------------------------------------
EVTY0000  CALL      BOXVT000
.
EVTY0100  KEYIN     *PCCOL:CVERT,*V2LON,*RV,FMRTVTYP
          TYPE      FMRTVTYP
          GOTO      EVTY0100 IF NOT EQUAL
.
          MOVE      FMRTTYPE,F2
          BRANCH    F2,EVTY9999,EVTY9999,EVTY1000,EVTY2000,EVTY2000,EVTY9999
          GOTO      EVTY9999
.
EVTY1000  MOVE      FMRTVTYP,F2
          BRANCH    F2,EVTY1100,EVTY1100,EVTY1100,EVTY1100
          BEEP
          GOTO      EVTY0100
.
EVTY1100  MOVE      F2,FMRTVTYP
          LOAD      VDESVTYP,F2,IDESVT01,IDESVT02,IDESVT03,IDESVT04
          GOTO      EVTY9900
.
EVTY2000  MOVE      FMRTVTYP,F2
          BRANCH    F2,EVTY2100,EVTY2100,EVTY2100,EVTY2100:
                       EVTY2100,EVTY2100
          BEEP
          GOTO      EVTY0100
.
EVTY2100  MOVE      F2,FMRTVTYP
          CALL      DVTYP000
.
EVTY9900  CALL      PUTSCR00
          MOVE      "10",HTOP
          MOVE      "30",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          GOTO      EVTY9999
.
EVTY9999  RETURN
.------------------------------------------------------------
. Display Amount/Variant Type Description
.------------------------------------------------------------
DVTYP000  LOAD      VDESVTYP,F2,IDESVT05,IDESVT06,IDESVT07,IDESVT08:
                                IDESVT09,IDESVT10
.
DVTYP999  RETURN
.------------------------------------------------------------
. Draw a Box of Amount/Variation Type Selection
.------------------------------------------------------------
BOXVT000  MOVE      FMRTTYPE,F2
          BRANCH    F2,BOXVT999,BOXVT999,BOXVT100,BOXVT200,BOXVT200,BOXVT999
          GOTO      BOXVT999
.
BOXVT100  MOVE      "17",HTOP
          MOVE      "44",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P49:18,*V2LON,*ULON,"Amount Type                   ",*HOFF:
                    *P46:19,*V2LON,"1. ",*HOFF,IDESVT01:
                    *P46:20,*V2LON,"2. ",*HOFF,IDESVT02:
                    *P46:21,*V2LON,"3. ",*HOFF,IDESVT03:
                    *P46:22,*V2LON,"4. ",*HOFF,IDESVT04
          GOTO      BOXVT999
.
BOXVT200  MOVE      "15",HTOP
          MOVE      "44",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P49:16,*V2LON,*ULON,"Variant Type                  ",*HOFF:
                    *P46:17,*V2LON,"1. ",*HOFF,IDESVT05:
                    *P46:18,*V2LON,"2. ",*HOFF,IDESVT06:
                    *P46:19,*V2LON,"3. ",*HOFF,IDESVT07:
                    *P46:20,*V2LON,"4. ",*HOFF,IDESVT08:
                    *P46:21,*V2LON,"5. ",*HOFF,IDESVT09:
                    *P46:22,*V2LON,"6. ",*HOFF,IDESVT10
          GOTO      BOXVT999
.
BOXVT999  RETURN
.
.------------------------------------------------------------
. Enter Amount/Variant Type
.------------------------------------------------------------
EAPE0000  CALL      BOXAP000
.
EAPE9900  CALL      PUTSCR00
          MOVE      "10",HTOP
          MOVE      "30",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          GOTO      EAPE9999
.
EAPE9999  RETURN
.------------------------------------------------------------
. Draw a Box of Amount Period
.------------------------------------------------------------
BOXAP000  MOVE      "8",HTOP
          MOVE      "3",HLEF
          MOVE      "23",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          PACK      KEY6,SP70
          CALL      RSFMLC1
          CALL      RKFMLC1
.
          PACK      KEY2,SP70
          CALL      RSFMLA1
          CALL      RKFMLA1
.
          COMPARE   ZERO,FMLAPERS  * are there thirteen periods?
          GOTO      BOXAP050 IF NOT EQUAL
          MOVE      "Not Applicable",FMLC13DE
.
BOXAP050  BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P32:9,*V2LON,*ULON,"Available Periods",*HOFF:
                    *P4:11,*V2LON," 1. ",*HOFF,FMLC01DE,SP5:
                           *V2LON," 2. ",*HOFF,FMLC02DE,SP5:
                           *V2LON," 3. ",*HOFF,FMLC03DE:
                    *P4:12,*V2LON," 4. ",*HOFF,FMLC04DE,SP5:
                           *V2LON," 5. ",*HOFF,FMLC05DE,SP5:
                           *V2LON," 6. ",*HOFF,FMLC06DE:
                    *P4:13,*V2LON," 7. ",*HOFF,FMLC07DE,SP5:
                           *V2LON," 8. ",*HOFF,FMLC08DE,SP5:
                           *V2LON," 9. ",*HOFF,FMLC09DE:
                    *P4:14,*V2LON,"10. ",*HOFF,FMLC10DE,SP5:
                           *V2LON,"11. ",*HOFF,FMLC11DE,SP5:
                           *V2LON,"12. ",*HOFF,FMLC12DE:
                    *P4:15,*V2LON,"13. ",*HOFF,FMLC13DE,SP5:
                           *V2LON,"14. ",*HOFF,IDESPE14:
                    *P52:15,*V2LON,"15. ",*HOFF,"Year to Date":
                    *P4:16,*V2LON,"16. ",*HOFF,IDESPE16;
.
          MOVE      FMRTVTYP,F2
          BRANCH    F2,BOXAP100,BOXAP200,BOXAP200
.
BOXAP100  DISPLAY   *P28:16,*V2LON,"17. ",*HOFF,IDESPE17:
                    *P52:16,*V2LON,"18. ",*HOFF,"Projection":
                    *P4:17,*V2LON,"19. ",*HOFF,IDESPE19:
                    *P28:17,*V2LON,"20. ",*HOFF,"Period Opening Bal.":
                    *P52:17,*V2LON,"21. ",*HOFF,"YTD Movement":
                    *P4:18,*V2LON,"22. ",*HOFF,IDESPE22:
                    *P28:18,*V2LON,"23. ",*HOFF,"Diff B/n Cur & Prev ":
                           *V2LON,"24. ",*HOFF,"Committed Raised":
                    *P4:19,*V2LON,"25. ",*HOFF,IDESPE25:
                    *P4:20,*V2LON,"26. ",*HOFF,IDESPE26;
.
BOXAP200  PACK      DIM2,SP70
          CLEAR     DIM2
          DISPLAY   *P4:22,"Amount Period :                                   ";
          KEYIN     *P20:22,*V2LON,DIM2
.
          TYPE      DIM2
          GOTO      BOXAP200 IF NOT EQUAL
.
          MOVE      DIM2,F2
          MOVE      FMRTVTYP,FORM2A
          MOVE      FMRTTYPE,FORM2B
          IF        (F2=25 | F2=26)
            IF      (FORM2A<>1 | FORM2B<>3)
       MOVE      "Types must be 'Amount' & 'Actual' for Period Type. - ",DISPMSG
              CALL      MESSAGE1
              GOTO      BOXAP200
            ENDIF
          ENDIF
.
          BRANCH    F2,BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500
          BRANCH    FORM2A,BOXAP300,BOXAP400,BOXAP400
.
BOXAP300  BRANCH    F2,BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500,BOXAP500,BOXAP500,BOXAP500,BOXAP500:
                           BOXAP500
.
BOXAP400  BEEP
          GOTO      BOXAP200
.
BOXAP500  CALL      DAPER000
          MOVE      F2,FMRTPERI
.
BOXAP999  RETURN
.------------------------------------------------------------
. Display Amount Period Description
.------------------------------------------------------------
DAPER000  LOAD      VDESPERI,F2,FMLC01DE,FMLC02DE,FMLC03DE,FMLC04DE:
                                FMLC05DE,FMLC06DE,FMLC07DE,FMLC08DE:
                                FMLC09DE,FMLC10DE,FMLC11DE,FMLC12DE:
                                FMLC13DE,IDESPE14,IDESPE15,IDESPE16:
                                IDESPE17,IDESPE18,IDESPE19,IDESPE20:
                                IDESPE21,IDESPE22,IDESPE23,IDESPE24:
                                IDESPE25,IDESPE26
.
DAPER999  RETURN
.
.------------------------------------------------------------
. Enter Scale
.------------------------------------------------------------
ESCA0000  CALL      BOXSC000
.
ESCA0100  KEYIN     *PCCOL:CVERT,*V2LON,*RV,FMRTSCAL
          TYPE      FMRTSCAL
          GOTO      ESCA0100 IF NOT EQUAL
.
          MOVE      FMRTSCAL,F2
          BRANCH    F2,ESCA0200,ESCA0200,ESCA0200
          BEEP
          GOTO      ESCA0100
.
ESCA0200  MOVE      F2,FMRTSCAL
          CALL      DSCAL000
.
ESCA9900  CALL      PUTSCR00
          MOVE      "10",HTOP
          MOVE      "30",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
.
          IF        ACCEPT=0
            CALL      DSCA0000
          ENDIF
.
          GOTO      ESCA9999
.
ESCA9999  RETURN
.------------------------------------------------------------
. Display Scale Description
.------------------------------------------------------------
DSCAL000  LOAD      VDESSCAL,F2,IDESSCA1,IDESSCA2,IDESSCA3
.
DSCAL999  RETURN
.------------------------------------------------------------
. Draw a Box of Scale Selection
.------------------------------------------------------------
BOXSC000  MOVE      "18",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:19,*V2LON,*ULON,"Scale         ",*HOFF:
                    *P57:20,*V2LON,"1. ",*HOFF,IDESSCA1:
                    *P57:21,*V2LON,"2. ",*HOFF,IDESSCA2:
                    *P57:22,*V2LON,"3. ",*HOFF,IDESSCA3
.
BOXSC999  RETURN
.
DSCA0000  MOVE      "   14",FLDID
          CALL      GETPOSIT
          MOVE      ONE,DISPFLAG
          CALL      EFOR0000
          MOVE      ZERO,DISPFLAG
.
          MOVE      FMRTFRMT,VAR
          CALL      DISPITEM
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
.
DSCA9999  RETURN
.
.------------------------------------------------------------
. Enter Format
.------------------------------------------------------------
EFOR0000  MOVE      FMRTTYPE,F2
          BRANCH    F2,EFOR9999,EFOR9999,EFOR0100,EFOR0100,EFOR0100,EFOR0400
          GOTO      EFOR9999
.
EFOR0100  MOVE      FMRTSCAL,F2
          BRANCH    F2,EFOR0200,EFOR0300,EFOR0300
          GOTO      EFOR9999
.
EFOR0200  MOVE      FMRTTYPE,F2
          IF        F2=5
            MOVE      FMRTWIDT,F2
            BRANCH    F2,EFOR9999,EFOR9999,EFOR9999,EFOR9999,EFOR9999:
                         EFOR0206,EFOR0207,EFOR0208,EFOR0209,EFOR0210:
                         EFOR0211,EFOR0212,EFOR0213,EFOR0214,EFOR0215:
                         EFOR0216,EFOR0217,EFOR0218,EFOR0219,EFOR0220
          ELSE
            MOVE      FMRTWIDT,F2
            BRANCH    F2,EFOR9999,EFOR9999,EFOR9999,EFOR9999,EFOR9999:
                         EFOR9999,EFOR9999,EFOR9999,EFOR9999,EFOR0210:
                         EFOR0211,EFOR0212,EFOR0213,EFOR0214,EFOR0215:
                         EFOR0216,EFOR0217,EFOR0218,EFOR0219,EFOR0220
          ENDIF
          GOTO      EFOR9999
.
EFOR0206  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9.9 ",DIM5
            ELSE
              MOVE      FMRTFRMT,DIM5
            ENDIF
          ELSE
            MOVE      "(9.9 ",DIM5
          ENDIF
          GOTO      EFOR0505
.
EFOR0207  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9.99 ",DIM6
            ELSE
              MOVE      FMRTFRMT,DIM6
            ENDIF
          ELSE
            MOVE      "(9.99 ",DIM6
          ENDIF
          GOTO      EFOR0506
.
EFOR0208  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99.99 ",DIM7
            ELSE
              MOVE      FMRTFRMT,DIM7
            ENDIF
          ELSE
            MOVE      "(99.99 ",DIM7
          ENDIF
          GOTO      EFOR0507
.
EFOR0209  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999.99 ",DIM8
            ELSE
              MOVE      FMRTFRMT,DIM8
            ENDIF
          ELSE
            MOVE      "(999.99 ",DIM8
          ENDIF
          GOTO      EFOR0508
.
EFOR0210  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999.99 ",DIM9
            ELSE
              MOVE      FMRTFRMT,DIM9
            ENDIF
          ELSE
            MOVE      "(9999.99 ",DIM9
          ENDIF
          GOTO      EFOR0509
.
EFOR0211  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999.99 ",DIM10
            ELSE
              MOVE      FMRTFRMT,DIM10
            ENDIF
          ELSE
            MOVE      "(9,999.99 ",DIM10
          ENDIF
          GOTO      EFOR0510
.
EFOR0212  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99,999.99 ",DIM11
            ELSE
              MOVE      FMRTFRMT,DIM11
            ENDIF
          ELSE
            MOVE      "(99,999.99 ",DIM11
          ENDIF
          GOTO      EFOR0511
.
EFOR0213  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999,999.99 ",DIM12
            ELSE
              MOVE      FMRTFRMT,DIM12
            ENDIF
          ELSE
            MOVE      "(999,999.99 ",DIM12
          ENDIF
          GOTO      EFOR0512
.
EFOR0214  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999,999.99 ",DIM13
            ELSE
              MOVE      FMRTFRMT,DIM13
            ENDIF
          ELSE
            MOVE      "(9999,999.99 ",DIM13
          ENDIF
          GOTO      EFOR0513
.
EFOR0215  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999,999.99 ",DIM14
            ELSE
              MOVE      FMRTFRMT,DIM14
            ENDIF
          ELSE
            MOVE      "(9,999,999.99 ",DIM14
          ENDIF
          GOTO      EFOR0514
.
EFOR0216  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99,999,999.99 ",DIM15
            ELSE
              MOVE      FMRTFRMT,DIM15
            ENDIF
          ELSE
            MOVE      "(99,999,999.99 ",DIM15
          ENDIF
          GOTO      EFOR0515
.
EFOR0217  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999,999,999.99 ",DIM16
            ELSE
              MOVE      FMRTFRMT,DIM16
            ENDIF
          ELSE
            MOVE      "(999,999,999.99 ",DIM16
          ENDIF
          GOTO      EFOR0516
.
EFOR0218  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999,999,999.99 ",DIM17
            ELSE
              MOVE      FMRTFRMT,DIM17
            ENDIF
          ELSE
            MOVE      "(9999,999,999.99 ",DIM17
          ENDIF
          GOTO      EFOR0517
.
EFOR0219  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999,999,999.99 ",DIM18
            ELSE
              MOVE      FMRTFRMT,DIM18
            ENDIF
          ELSE
            MOVE      "(9,999,999,999.99 ",DIM18
          ENDIF
          GOTO      EFOR0518
.
EFOR0220  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99,999,999,999.99 ",DIM19
            ELSE
              MOVE      FMRTFRMT,DIM19
            ENDIF
          ELSE
            MOVE      "(99,999,999,999.99 ",DIM19
          ENDIF
          GOTO      EFOR0519
.
EFOR0300  MOVE      FMRTTYPE,F2
          IF        F2=5
            MOVE      FMRTWIDT,F2
            BRANCH    F2,EFOR9999,EFOR9999,EFOR9999,EFOR9999,EFOR9999:
                         EFOR0306,EFOR0307,EFOR0308,EFOR0309,EFOR0310:
                         EFOR0311,EFOR0312,EFOR0313,EFOR0314,EFOR0315:
                         EFOR0316,EFOR0317,EFOR0318,EFOR0319,EFOR0320
          ELSE
            MOVE      FMRTWIDT,F2
            BRANCH    F2,EFOR9999,EFOR9999,EFOR9999,EFOR9999,EFOR9999:
                         EFOR9999,EFOR9999,EFOR9999,EFOR9999,EFOR0310:
                         EFOR0311,EFOR0312,EFOR0313,EFOR0314,EFOR0315:
                         EFOR0316,EFOR0317,EFOR0318,EFOR0319,EFOR0320
          ENDIF
          GOTO      EFOR9999
.
EFOR0306  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999 ",DIM5
            ELSE
              MOVE      FMRTFRMT,DIM5
            ENDIF
          ELSE
            MOVE      "(999 ",DIM5
          ENDIF
          GOTO      EFOR0505
.
EFOR0307  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999 ",DIM6
            ELSE
              MOVE      FMRTFRMT,DIM6
            ENDIF
          ELSE
            MOVE      "(9999 ",DIM6
          ENDIF
          GOTO      EFOR0506
.
EFOR0308  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999 ",DIM7
            ELSE
              MOVE      FMRTFRMT,DIM7
            ENDIF
          ELSE
            MOVE      "(9,999 ",DIM7
          ENDIF
          GOTO      EFOR0507
.
EFOR0309  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99,999 ",DIM8
            ELSE
              MOVE      FMRTFRMT,DIM8
            ENDIF
          ELSE
            MOVE      "(99,999 ",DIM8
          ENDIF
          GOTO      EFOR0508
.
EFOR0310  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999,999 ",DIM9
            ELSE
              MOVE      FMRTFRMT,DIM9
            ENDIF
          ELSE
            MOVE      "(999,999 ",DIM9
          ENDIF
          GOTO      EFOR0509
.
EFOR0311  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999,999 ",DIM10
            ELSE
              MOVE      FMRTFRMT,DIM10
            ENDIF
          ELSE
            MOVE      "(9999,999 ",DIM10
          ENDIF
          GOTO      EFOR0510
.
EFOR0312  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999,999 ",DIM11
            ELSE
              MOVE      FMRTFRMT,DIM11
            ENDIF
          ELSE
            MOVE      "(9,999,999 ",DIM11
          ENDIF
          GOTO      EFOR0511
.
EFOR0313  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99,999,999 ",DIM12
            ELSE
              MOVE      FMRTFRMT,DIM12
            ENDIF
          ELSE
            MOVE      "(99,999,999 ",DIM12
          ENDIF
          GOTO      EFOR0512
.
EFOR0314  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999,999,999 ",DIM13
            ELSE
              MOVE      FMRTFRMT,DIM10
            ENDIF
          ELSE
            MOVE      "(999,999,999 ",DIM13
          ENDIF
          GOTO      EFOR0513
.
EFOR0315  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999,999,999 ",DIM14
            ELSE
              MOVE      FMRTFRMT,DIM14
            ENDIF
          ELSE
            MOVE      "(9999,999,999 ",DIM14
          ENDIF
          GOTO      EFOR0514
.
EFOR0316  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999,999,999 ",DIM15
            ELSE
              MOVE      FMRTFRMT,DIM15
            ENDIF
          ELSE
            MOVE      "(9,999,999,999 ",DIM15
          ENDIF
          GOTO      EFOR0515
.
EFOR0317  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(99,999,999,999 ",DIM16
            ELSE
              MOVE      FMRTFRMT,DIM16
            ENDIF
          ELSE
            MOVE      "(99,999,999,999 ",DIM16
          ENDIF
          GOTO      EFOR0516
.
EFOR0318  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(999,999,999,999 ",DIM17
            ELSE
              MOVE      FMRTFRMT,DIM17
            ENDIF
          ELSE
            MOVE      "(999,999,999,999 ",DIM17
          ENDIF
          GOTO      EFOR0517
.
EFOR0319  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9999,999,999,999 ",DIM18
            ELSE
              MOVE      FMRTFRMT,DIM18
            ENDIF
          ELSE
            MOVE      "(9999,999,999,999 ",DIM18
          ENDIF
          GOTO      EFOR0518
.
EFOR0320  IF        DISPFLAG=0
            IF        CHNGMODE=0
              MOVE      "(9,999,999,999,999 ",DIM19
            ELSE
              MOVE      FMRTFRMT,DIM19
            ENDIF
          ELSE
            MOVE      "(9,999,999,999,999 ",DIM19
          ENDIF
          GOTO      EFOR0519
.
EFOR0400  MOVE      FMRTWIDT,F2
          BRANCH    F2,EFOR0401,EFOR0402,EFOR0403,EFOR0404,EFOR0405:
                       EFOR0406,EFOR0407,EFOR0408,EFOR0409,EFOR0410:
                       EFOR0411,EFOR0412,EFOR0413,EFOR0414,EFOR0415:
                       EFOR0416,EFOR0417,EFOR0418,EFOR0419,EFOR0420
          GOTO      EFOR9999
.
EFOR0401  MOVE      FMRTFRMT,DIM1
          GOTO      EFOR0501
.
EFOR0402  MOVE      FMRTFRMT,DIM2
          GOTO      EFOR0502
.
EFOR0403  MOVE      FMRTFRMT,DIM3
          GOTO      EFOR0503
.
EFOR0404  MOVE      FMRTFRMT,DIM4
          GOTO      EFOR0504
.
EFOR0405  MOVE      FMRTFRMT,DIM5
          GOTO      EFOR0505
.
EFOR0406  MOVE      FMRTFRMT,DIM6
          GOTO      EFOR0506
.
EFOR0407  MOVE      FMRTFRMT,DIM7
          GOTO      EFOR0507
.
EFOR0408  MOVE      FMRTFRMT,DIM8
          GOTO      EFOR0508
.
EFOR0409  MOVE      FMRTFRMT,DIM9
          GOTO      EFOR0509
.
EFOR0410  MOVE      FMRTFRMT,DIM10
          GOTO      EFOR0510
.
EFOR0411  MOVE      FMRTFRMT,DIM11
          GOTO      EFOR0511
.
EFOR0412  MOVE      FMRTFRMT,DIM12
          GOTO      EFOR0512
.
EFOR0413  MOVE      FMRTFRMT,DIM13
          GOTO      EFOR0513
.
EFOR0414  MOVE      FMRTFRMT,DIM14
          GOTO      EFOR0514
.
EFOR0415  MOVE      FMRTFRMT,DIM15
          GOTO      EFOR0515
.
EFOR0416  MOVE      FMRTFRMT,DIM16
          GOTO      EFOR0516
.
EFOR0417  MOVE      FMRTFRMT,DIM17
          GOTO      EFOR0517
.
EFOR0418  MOVE      FMRTFRMT,DIM18
          GOTO      EFOR0518
.
EFOR0419  MOVE      FMRTFRMT,DIM19
          GOTO      EFOR0519
.
EFOR0420  MOVE      FMRTFRMT,DIM20
          GOTO      EFOR0520
.
EFOR0501  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM1
          ENDIF
          MOVE      DIM1,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0502  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM2
          ENDIF
          MOVE      DIM2,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0503  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM3
          ENDIF
          MOVE      DIM3,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0504  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM4
          ENDIF
          MOVE      DIM4,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0505  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM5
          ENDIF
          MOVE      DIM5,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0506  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM6
          ENDIF
          MOVE      DIM6,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0507  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM7
          ENDIF
          MOVE      DIM7,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0508  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM8
          ENDIF
          MOVE      DIM8,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0509  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM9
          ENDIF
          MOVE      DIM9,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0510  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM10
          ENDIF
          MOVE      DIM10,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0511  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM11
          ENDIF
          MOVE      DIM11,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0512  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM12
          ENDIF
          MOVE      DIM12,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0513  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM13
          ENDIF
          MOVE      DIM13,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0514  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM14
          ENDIF
          MOVE      DIM14,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0515  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM15
          ENDIF
          MOVE      DIM15,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0516  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM16
          ENDIF
          MOVE      DIM16,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0517  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM17
          ENDIF
          MOVE      DIM17,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0518  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM18
          ENDIF
          MOVE      DIM18,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0519  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM19
          ENDIF
          MOVE      DIM19,FMRTFRMT
          GOTO      EFOR9999
.
EFOR0520  IF        DISPFLAG=0
            KEYIN     *PCCOL:CVERT,*V2LON,*EL,*RV,DIM20
          ENDIF
          MOVE      DIM20,FMRTFRMT
          GOTO      EFOR9999
.
EFOR9999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       FMSAMAIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMCIO/INC
          INC       FMSRSTIO/INC
          INC       FMSUDRIO/INC
          INC       FMSUDRKY    
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
.
          INC       STDGENCD
.
