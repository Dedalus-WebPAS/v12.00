.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.01  20.12.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS20
.   Function      :   Asset Enquiries                         
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSACMFD/INC
          INC       AMSCODFD/INC
          INC       AMSCONFD/INC
          INC       AMSDEPFD/INC
          INC       AMSDPHFD/INC
          INC       AMSDSFFD/INC
          INC       AMSGILFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSLOHFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       AMSRVAFD/INC
          INC       AMSSTMFD/INC
          INC       AMSSTPFD/INC
          INC       AMSTRNFD/INC
          INC       APSMASFD/INC
          INC       FMSAMAFD/INC
          INC       FMSLMAFD/INC
          INC       IBAPASFD/INC
.=========================
.Local Variable Definition
.-------------------------
ADTDESC   DIM      35 * Scr 00 Fld    33
ACCOPEN   FORM     12.2 * Scr 00 Fld    34
TDTDESC   DIM      35 * Scr 00 Fld    36
TAXOPEN   FORM     12.2 * Scr 00 Fld    37
.
.Word Processor File * Scr 00 Fld    72
.
NAMAMAC1  INIT      "Wamac1"
FILAMAC1  DIM       8
.
TYPDESC   DIM      35 * Scr 00 Fld    74
DPTDESC   DIM      35 * Scr 00 Fld    75
BLDDESC   DIM      35 * Scr 00 Fld    76
SOFDESC   DIM      35 * Scr 00 Fld    78
UC1DESC   DIM      35 * Scr 00 Fld    79
UC2DESC   DIM      35 * Scr 00 Fld    80
UC3DESC   DIM      35 * Scr 00 Fld    81
UC4DESC   DIM      35 * Scr 00 Fld    82
DTYDESC   DIM      35 * Scr 00 Fld    86
TOTALDEP  FORM     12.2 * Scr 01 Fld    75
ACCCLOSE  FORM     12.2 * Scr 01 Fld    76
PROFIT    FORM     12.2 * Scr 01 Fld    77
.
.    Multi Item Key Fields Scr 02 Fld    10
.-------------------------------------------------------
AMDH1NAM  INIT      "AMDH1"
AMDH1END  FORM      1   * End Display
AMDH1SNO  FORM      5   * Number of Items on the Screen
AMDH1MKY  DIM       127 * Match Key 
AMDH1EKY  DIM       127 * End Key
AMDH1SKY  DIM       127 * Start Key
AMDH1IDX  INIT      " 132 UC1-5"
AMDH1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMDH1FNM  DIM       8  * Filename
AMDH1CNT  FORM      3  * Number of Items on Screen
FDPTDESC  DIM      35 * Scr 02 Fld    20
TDPTDESC  DIM      35 * Scr 02 Fld    21
LOCDESC   DIM      35 * Scr 03 Fld     6
.
.    Multi Item Key Fields Scr 03 Fld    10
.-------------------------------------------------------
AMLH1NAM  INIT      "AMLH1"
AMLH1END  FORM      1   * End Display
AMLH1SNO  FORM      5   * Number of Items on the Screen
AMLH1MKY  DIM       127 * Match Key 
AMLH1EKY  DIM       127 * End Key
AMLH1SKY  DIM       127 * Start Key
AMLH1IDX  INIT      " 132 UC1-5"
AMLH1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMLH1FNM  DIM       8  * Filename
AMLH1CNT  FORM      3  * Number of Items on Screen
FBLDDESC  DIM      35 * Scr 03 Fld    22
FLOCDESC  DIM      35 * Scr 03 Fld    23
TBLDDESC  DIM      35 * Scr 03 Fld    24
TLOCDESC  DIM      35 * Scr 03 Fld    25
PMTDESC   DIM      35 * Scr 04 Fld    19
.
.    Multi Item Key Fields Scr 06 Fld    10
.-------------------------------------------------------
AMST2NAM  INIT      "AMST2"
AMST2END  FORM      1   * End Display
AMST2SNO  FORM      5   * Number of Items on the Screen
AMST2MKY  DIM       127 * Match Key 
AMST2EKY  DIM       127 * End Key
AMST2SKY  DIM       127 * Start Key
AMST2IDX  INIT      " 132 UC1-5"
AMST2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMST2FNM  DIM       8  * Filename
AMST2CNT  FORM      3  * Number of Items on Screen
SBLDDESC  DIM      35 * Scr 06 Fld    27
SLOCDESC  DIM      35 * Scr 06 Fld    28
TOTALRVT  FORM     12.2 * Scr 07 Fld     5
DISPADT   DIM       4 * Scr 07 Fld     7
DISPTDT   DIM       4 * Scr 07 Fld     8
TOTALTAD  FORM     12.2 * Scr 07 Fld     9
TOTALAAD  FORM     12.2 * Scr 07 Fld    10
TAXDEPN   FORM     12.2 * Scr 07 Fld    16
ACCDEPN   FORM     12.2 * Scr 07 Fld    17
DESCTDT   DIM      35 * Scr 07 Fld    18
DESCADT   DIM      35 * Scr 07 Fld    19
PRIMECST  FORM     12.2 * Scr 07 Fld    20
TAXCLOSE  FORM     12.2 * Scr 07 Fld    24
.
.    Multi Item Key Fields Scr 08 Fld     3
.-------------------------------------------------------
AMRV1NAM  INIT      "AMRV1"
AMRV1END  FORM      1   * End Display
AMRV1SNO  FORM      5   * Number of Items on the Screen
AMRV1MKY  DIM       127 * Match Key 
AMRV1EKY  DIM       127 * End Key
AMRV1SKY  DIM       127 * Start Key
AMRV1IDX  INIT      " 132 UC1-5"
AMRV1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMRV1FNM  DIM       8  * Filename
AMRV1CNT  FORM      3  * Number of Items on Screen
RTYDESC   DIM      35 * Scr 08 Fld    19
.
.    Multi Item Key Fields Scr 09 Fld     3
.-------------------------------------------------------
AMTR1NAM  INIT      "AMTR1"
AMTR1END  FORM      1   * End Display
AMTR1SNO  FORM      5   * Number of Items on the Screen
AMTR1MKY  DIM       127 * Match Key 
AMTR1EKY  DIM       127 * End Key
AMTR1SKY  DIM       127 * Start Key
AMTR1IDX  INIT      " 132 UC1-5"
AMTR1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMTR1FNM  DIM       8  * Filename
AMTR1CNT  FORM      3  * Number of Items on Screen
GENOPER   DIM      20 * Scr SD Fld     6
PROOPER   DIM      20 * Scr SD Fld    24
DRDESC    DIM      35 * Scr TD Fld    17
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS20"
PRGNAM    INIT      "Asset Enquiries                         "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      GETCON00
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     AMST2FL1,DELETE
.
          CLOSE     AMRV1FL1,DELETE
.
          CLOSE     AMTR1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening amsacmaf";
          OPEN      AMSACMA1,"amsacmaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amsdepaf";
          OPEN      AMSDEPA1,"amsdepaf"
          DISPLAY   *P56:24,"Opening amsdphaf";
          OPEN      AMSDPHA1,"amsdphaf"
          DISPLAY   *P56:24,"Opening amsdsfaf";
          OPEN      AMSDSFA1,"amsdsfaf"
          DISPLAY   *P56:24,"Opening amsgilaf";
          OPEN      AMSGILA1,"amsgilaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amslohaf";
          OPEN      AMSLOHA1,"amslohaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          DISPLAY   *P56:24,"Opening amsrvaaf";
          OPEN      AMSRVAA1,"amsrvaaf"
          DISPLAY   *P56:24,"Opening amsrvaaf";
          OPEN      AMSRVAA2,"amsrvaaf"
          DISPLAY   *P56:24,"Opening amsstmaf";
          OPEN      AMSSTMA1,"amsstmaf"
          DISPLAY   *P56:24,"Opening amsstpaf";
          OPEN      AMSSTPA1,"amsstpaf"
          DISPLAY   *P56:24,"Opening amsstpaf";
          OPEN      AMSSTPA2,"amsstpaf"
          DISPLAY   *P56:24,"Opening amstrnaf";
          OPEN      AMSTRNA1,"amstrnaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
.--------------------------------------------------------
. Initialise Wp Filename for Asset Comments                     
.--------------------------------------------------------
          PACK      FILAMAC1,NAMAMAC1,PORT
          REP       " 0",FILAMAC1
          DISPLAY   *P56:24,"Create & Open ",FILAMAC1;
          PREP      TEMPWORD,FILAMAC1
.
.--------------------------------------------------------
. Initialise Batch Screen Transfer Date                      
.--------------------------------------------------------
          MOVE     ZERO,AMDH1SNO
          MOVE     "02   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMDH1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Location Transfer Date             
.--------------------------------------------------------
          MOVE     ZERO,AMLH1SNO
          MOVE     "03   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMLH1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Stocktake Number                   
.--------------------------------------------------------
          MOVE     ZERO,AMST2SNO
          MOVE     "06   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMST2SNO
            ENDIF
          ENDIF
          PACK      AMST2FNM,ANST,AMST2NAM,PORT
          REP       " 0",AMST2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMST2FL1,AMST2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMST2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMST2FNM,AMST2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMST2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMST2FL1,AMST2FNM
.--------------------------------------------------------
. Initialise Batch Screen Revaluation Date                   
.--------------------------------------------------------
          MOVE     ZERO,AMRV1SNO
          MOVE     "08    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMRV1SNO
            ENDIF
          ENDIF
          PACK      AMRV1FNM,ANST,AMRV1NAM,PORT
          REP       " 0",AMRV1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMRV1FL1,AMRV1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMRV1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMRV1FNM,AMRV1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMRV1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMRV1FL1,AMRV1FNM
.--------------------------------------------------------
. Initialise Batch Screen Counter                            
.--------------------------------------------------------
          MOVE     ZERO,AMTR1SNO
          MOVE     "09    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMTR1SNO
            ENDIF
          ENDIF
          PACK      AMTR1FNM,ANST,AMTR1NAM,PORT
          REP       " 0",AMTR1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMTR1FL1,AMTR1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMTR1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMTR1FNM,AMTR1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMTR1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMTR1FL1,AMTR1FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Acquisition & Disposal Details     
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Department History                 
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Location History                   
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Leasing Details                    
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Insurance Details                  
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Stocktake History                  
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Depreciation Details               
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Revaluation Details                
          ENDIF
          MATCH     "09",SCRID
          IF         @EQUAL
            CALL       PS09L000   * General Ledger Interface Details   
          ENDIF
          MATCH     "DM",SCRID
          IF         @EQUAL
            CALL       PSDML000   * Depreciation by Month              
          ENDIF
          MATCH     "RD",SCRID
          IF         @EQUAL
            CALL       PSRDL000   * Revaluation Details                
          ENDIF
          MATCH     "SD",SCRID
          IF         @EQUAL
            CALL       PSSDL000   * Stocktake Details                  
          ENDIF
          MATCH     "TD",SCRID
          IF         @EQUAL
            CALL       PSTDL000   * Transaction Details                
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,AMMAREG 
          MOVE      SP70,AMMAASS 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMREDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAMREA00
          MOVE      AMREREG,AMMAREG
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAREG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMREDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY00L120
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EASST000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WP00L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L999,PS00L114:
                            PS00L115,PS00L116,PS00L117,PS00L118:
                            PS00L119,PS00L120,PS00L121,PS00L122:
                            PS00L123,PS00L124,PS00L125,PS00L126:
                            PS00L127,PS00L128,PS00L129,PS00L130:
                            PS00L131,PS00L132,PS00L133,PS00L134:
                            PS00L135,PS00L136,PS00L137,PS00L138:
                            PS00L139,PS00L140,PS00L141,PS00L142:
                            PS00L143,PS00L144,PS00L145,PS00L146:
                            PS00L147,PS00L148,PS00L149,PS00L150:
                            PS00L151,PS00L152,PS00L153,PS00L154:
                            PS00L155,PS00L156,PS00L157,PS00L158:
                            PS00L159,PS00L160,PS00L161,PS00L162:
                            PS00L163,PS00L164,PS00L165,PS00L166:
                            PS00L167,PS00L168,PS00L169
          GOTO     PS00L999
.
PS00L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L144
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L145
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L146
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L147
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L148
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L149
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L154
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L155
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L156
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L157
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L158
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L159
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L160
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L161
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L162
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L163
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L164
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L165
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L166
          UNPACK    AMMASDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L167
          MOVE      AMMADTY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L168
          MOVE      DTYDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L169
          MOVE      AMMADVA,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L101,SF00L102,SF00L103,SF00L104:
                            SF00L105,SF00L106,SF00L107,SF00L108:
                            SF00L109,SF00L110,SF00L111,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L112:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L112:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GETLEA00
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GETINS00
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC07L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC08L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC09L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L112
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Acquisition & Disposal Details     
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Acquisition & Disposal Details     
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Acquisition & Disposal Details     
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Acquisition & Disposal Details     
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WP01L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Acquisition & Disposal Details     
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Acquisition & Disposal Details     
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Acquisition & Disposal Details     
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L999:
                            PS01L999,PS01L999,PS01L104,PS01L105:
                            PS01L106,PS01L107,PS01L108,PS01L109:
                            PS01L110,PS01L111,PS01L112,PS01L113:
                            PS01L114,PS01L115,PS01L116,PS01L117:
                            PS01L118,PS01L119,PS01L120,PS01L121:
                            PS01L122,PS01L123,PS01L124,PS01L125:
                            PS01L126,PS01L127,PS01L128,PS01L129:
                            PS01L130,PS01L131,PS01L132,PS01L133:
                            PS01L134,PS01L135,PS01L136,PS01L137:
                            PS01L138,PS01L139,PS01L140,PS01L141:
                            PS01L142,PS01L143,PS01L144,PS01L145:
                            PS01L146,PS01L147,PS01L148,PS01L149:
                            PS01L150,PS01L151,PS01L152,PS01L153:
                            PS01L154,PS01L155,PS01L156,PS01L157:
                            PS01L158,PS01L159,PS01L160,PS01L161:
                            PS01L162,PS01L163,PS01L164,PS01L165:
                            PS01L166,PS01L167,PS01L168,PS01L169:
                            PS01L170,PS01L171,PS01L172,PS01L173:
                            PS01L174,PS01L175,PS01L176,PS01L177
          GOTO     PS01L999
.
PS01L101
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L141
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L142
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L143
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L144
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L145
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L146
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L147
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L148
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L149
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L153
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L154
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L155
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L156
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L157
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L158
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L159
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L160
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L161
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L162
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L163
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L164
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L165
          UNPACK    AMMASDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L166
          MOVE      AMMADTY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L167
          MOVE      DTYDESC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L168
          MOVE      AMMADVA,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L169
          MOVE      AMMARVT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L170
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L171
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L172
          CALL      CALDEP00
          MOVE      TOTALDEP,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L173
          CALL      CALDEP00
          MOVE      ACCCLOSE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L174
          MOVE      PROFIT,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L175
          MOVE      AMMADRF,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L176
          MOVE      AMMADYR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L177
          MOVE      AMMADPR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Acquisition & Disposal Details     
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L101:
                            SF01L102,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L103:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Department History                 
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Department History                 
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Department History                 
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Department History                 
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Department History                 
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    10 Transfer Date                      
.---------------------------------------------------------
          UNPACK    SP70,AMDHREG,AMDHASS,AMDHDAT
          PACK      KEY22,AMMAREG,AMMAASS,SP70
          MOVE      KEY22,AMDH1EKY
          STRIP     AMDH1SKY
          SETLPTR   AMDH1EKY,14
          MOVE      AMDH1EKY,AMDH1SKY
          CALL      RDAMDH1 
          IF        OVRCD=0
            CALL      RPAMDH1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,AMDH1CNT
          MOVE     ZERO,AMDH1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L101,DP02L102,DP02L103:
                            DP02L104,DP02L105,DP02L106,DP02L107:
                            DP02L108,DP02L109,DP02L110,DP02L111:
                            DP02L112,DP02L010,DP02L010,DP02L010:
                            DP02L010
          GOTO      DP02L010
.
DP02L101
          IF        AMDH1END=0
            CALL      RPAMDH1 
            IF        OVRCD=0
              PACK      AMDH1MKY,AMDHREG,AMDHASS,AMDHDAT                                                        
              MATCH     AMDH1EKY,AMDH1MKY
              IF        @EQUAL
                MOVE      ZERO,AMDH1END
                ADD       ONE,AMDH1CNT
          CALL      GETDPT00
                UNPACK    AMDHDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMDH1END
              ENDIF
            ELSE
              MOVE      ONE,AMDH1END
            ENDIF
          ENDIF
          IF        AMDH1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        AMDH1END=0
            MOVE      AMDHFDPT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        AMDH1END=0
            MOVE      AMDHTDPT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        AMDH1END=0
            MOVE      AMDHCOM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        AMDH1END=0
            MOVE      AMDHUA1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        AMDH1END=0
            MOVE      AMDHUA2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        AMDH1END=0
            MOVE      AMDHUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        AMDH1END=0
            MOVE      AMDHUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        AMDH1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMDHUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        AMDH1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMDHUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        AMDH1END=0
            MOVE      FDPTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        AMDH1END=0
            MOVE      TDPTDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "AMDH1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "AMDH1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY22,AMDH1SKY,Z70
          CALL     RDAMDH1  * Start
          IF       OVRCD=0
            CALL     RPAMDH1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "AMDH1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY22,AMDH1SKY,SP70
          CALL     RSAMDH1  * End
          IF       OVRCD=1
            CALL     RKAMDH1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMDH1SNO
            CALL     RKAMDH1 
            IF       OVRCD=1
              MOVE     AMDH1SNO,SECTOR
            ENDIF
            PACK     AMDH1MKY,AMDHREG,AMDHASS,AMDHDAT                                                        
            MATCH    AMDH1EKY,AMDH1MKY
            IF       !@EQUAL
              MOVE     AMDH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "AMDH1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          COMPARE  SECTOR,AMDH1SNO
          GOTO     PP02L110 IF EQUAL
          CALL     RKAMDH1 
          BRANCH   OVRCD,PP02L115
          PACK     AMDH1MKY,AMDHREG,AMDHASS,AMDHDAT                                                        
          MATCH    AMDH1EKY,AMDH1MKY
          GOTO     PP02L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP02L105
PP02L110
          MOVE     ZERO,SECTOR
          IF       AMDH1CNT=AMDH1SNO
            SUB      ONE,AMDH1CNT
          ENDIF
          WHILE    SECTOR<=AMDH1CNT
            CALL     RKAMDH1 
            IF       OVRCD=1
              MOVE     AMDH1SNO,SECTOR
            ENDIF
            PACK     AMDH1MKY,AMDHREG,AMDHASS,AMDHDAT                                                        
            MATCH    AMDH1EKY,AMDH1MKY
            IF       !@EQUAL
              MOVE     AMDH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMDH1SNO
            CALL     RPAMDH1 
            IF       OVRCD=1
              MOVE     AMDH1SNO,SECTOR
            ENDIF
            PACK     AMDH1MKY,AMDHREG,AMDHASS,AMDHDAT                                                        
            MATCH    AMDH1EKY,AMDH1MKY
            IF       !@EQUAL
              MOVE     AMDH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "AMDH1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RPAMDH1 
          BRANCH   OVRCD,NP02L110
          PACK     AMDH1MKY,AMDHREG,AMDHASS,AMDHDAT                                                        
          MATCH    AMDH1EKY,AMDH1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RKAMDH1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RKAMDH1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Department History                 
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Department History                 
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "AMDH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Department History                 
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L101,PS02L102:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Department History                 
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L102,SF02L103,SF02L104:
                            SF02L105
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "AMDH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          MOVE      "AMDH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "AMDH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "AMDH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "AMDH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Location History                   
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Location History                   
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Location History                   
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Location History                   
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Location History                   
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :    10 Location Transfer Date             
.---------------------------------------------------------
          UNPACK    SP70,AMLHREG,AMLHASS,AMLHDAT
          PACK      KEY22,AMMAREG,AMMAASS,SP70
          MOVE      KEY22,AMLH1EKY
          STRIP     AMLH1SKY
          SETLPTR   AMLH1EKY,14
          MOVE      AMLH1EKY,AMLH1SKY
          CALL      RDAMLH1 
          IF        OVRCD=0
            CALL      RPAMLH1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,AMLH1CNT
          MOVE     ZERO,AMLH1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L101,DP03L102,DP03L103:
                            DP03L104,DP03L105,DP03L106,DP03L107:
                            DP03L108,DP03L109,DP03L110,DP03L111:
                            DP03L112,DP03L113,DP03L114,DP03L115:
                            DP03L116,DP03L010,DP03L010,DP03L010:
                            DP03L010
          GOTO      DP03L010
.
DP03L101
          IF        AMLH1END=0
            CALL      RPAMLH1 
            IF        OVRCD=0
              PACK      AMLH1MKY,AMLHREG,AMLHASS,AMLHDAT                                                        
              MATCH     AMLH1EKY,AMLH1MKY
              IF        @EQUAL
                MOVE      ZERO,AMLH1END
                ADD       ONE,AMLH1CNT
          CALL      GETLOC00
                UNPACK    AMLHDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMLH1END
              ENDIF
            ELSE
              MOVE      ONE,AMLH1END
            ENDIF
          ENDIF
          IF        AMLH1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        AMLH1END=0
            MOVE      AMLHFBLD,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        AMLH1END=0
            MOVE      AMLHFLOC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        AMLH1END=0
            MOVE      AMLHTBLD,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        AMLH1END=0
            MOVE      AMLHTLOC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L106
          IF        AMLH1END=0
            MOVE      AMLHCOM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L107
          IF        AMLH1END=0
            MOVE      AMLHUA1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L108
          IF        AMLH1END=0
            MOVE      AMLHUA2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L109
          IF        AMLH1END=0
            MOVE      AMLHUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L110
          IF        AMLH1END=0
            MOVE      AMLHUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L111
          IF        AMLH1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMLHUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L112
          IF        AMLH1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMLHUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L113
          IF        AMLH1END=0
            MOVE      FBLDDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L114
          IF        AMLH1END=0
            MOVE      FLOCDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L115
          IF        AMLH1END=0
            MOVE      TBLDDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L116
          IF        AMLH1END=0
            MOVE      TLOCDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "AMLH1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "AMLH1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY22,AMLH1SKY,Z70
          CALL     RDAMLH1  * Start
          IF       OVRCD=0
            CALL     RPAMLH1  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "AMLH1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY22,AMLH1SKY,SP70
          CALL     RSAMLH1  * End
          IF       OVRCD=1
            CALL     RKAMLH1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMLH1SNO
            CALL     RKAMLH1 
            IF       OVRCD=1
              MOVE     AMLH1SNO,SECTOR
            ENDIF
            PACK     AMLH1MKY,AMLHREG,AMLHASS,AMLHDAT                                                        
            MATCH    AMLH1EKY,AMLH1MKY
            IF       !@EQUAL
              MOVE     AMLH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "AMLH1",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          COMPARE  SECTOR,AMLH1SNO
          GOTO     PP03L110 IF EQUAL
          CALL     RKAMLH1 
          BRANCH   OVRCD,PP03L115
          PACK     AMLH1MKY,AMLHREG,AMLHASS,AMLHDAT                                                        
          MATCH    AMLH1EKY,AMLH1MKY
          GOTO     PP03L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP03L105
PP03L110
          MOVE     ZERO,SECTOR
          IF       AMLH1CNT=AMLH1SNO
            SUB      ONE,AMLH1CNT
          ENDIF
          WHILE    SECTOR<=AMLH1CNT
            CALL     RKAMLH1 
            IF       OVRCD=1
              MOVE     AMLH1SNO,SECTOR
            ENDIF
            PACK     AMLH1MKY,AMLHREG,AMLHASS,AMLHDAT                                                        
            MATCH    AMLH1EKY,AMLH1MKY
            IF       !@EQUAL
              MOVE     AMLH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMLH1SNO
            CALL     RPAMLH1 
            IF       OVRCD=1
              MOVE     AMLH1SNO,SECTOR
            ENDIF
            PACK     AMLH1MKY,AMLHREG,AMLHASS,AMLHDAT                                                        
            MATCH    AMLH1EKY,AMLH1MKY
            IF       !@EQUAL
              MOVE     AMLH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "AMLH1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RPAMLH1 
          BRANCH   OVRCD,NP03L110
          PACK     AMLH1MKY,AMLHREG,AMLHASS,AMLHDAT                                                        
          MATCH    AMLH1EKY,AMLH1MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RKAMLH1 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RKAMLH1 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Location History                   
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Location History                   
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "AMLH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Location History                   
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L103,PS03L104,PS03L105,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      LOCDESC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Location History                   
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L102,SF03L103,SF03L104:
                            SF03L105
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "AMLH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          MOVE      "AMLH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L103
          MOVE      "AMLH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "AMLH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "AMLH1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Leasing Details                    
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Leasing Details                    
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Leasing Details                    
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Leasing Details                    
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Leasing Details                    
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Leasing Details                    
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Leasing Details                    
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L101,PS04L102,PS04L103,PS04L104:
                            PS04L105,PS04L106,PS04L107,PS04L108:
                            PS04L109,PS04L110,PS04L111,PS04L112:
                            PS04L113,PS04L114,PS04L115,PS04L116:
                            PS04L117,PS04L118,PS04L119,PS04L120:
                            PS04L121,PS04L122,PS04L123,PS04L124:
                            PS04L125,PS04L126,PS04L127,PS04L128:
                            PS04L129,PS04L130,PS04L131,PS04L132:
                            PS04L133,PS04L134,PS04L135,PS04L136:
                            PS04L137,PS04L999,PS04L999,PS04L999:
                            PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      AMLECOM,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      AMLECNM,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      AMLEREF,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      AMLECON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          UNPACK    AMLEDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      AMLEPER,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          UNPACK    AMLEEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      AMLEINS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      AMLEPMT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      AMLERES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      AMLEUA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      AMLEUA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      AMLEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      AMLEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          UNPACK    AMLEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          UNPACK    AMLEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      PMTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L121
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L122
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L123
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L124
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L125
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L126
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L127
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L128
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L129
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L130
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L131
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L132
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L133
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L134
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L135
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L136
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L137
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Leasing Details                    
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L101
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Insurance Details                  
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insurance Details                  
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insurance Details                  
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insurance Details                  
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insurance Details                  
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Insurance Details                  
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insurance Details                  
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L101,PS05L102,PS05L103,PS05L104:
                            PS05L105,PS05L106,PS05L107,PS05L108:
                            PS05L109,PS05L110,PS05L111,PS05L112:
                            PS05L113,PS05L114,PS05L115,PS05L116:
                            PS05L117,PS05L118,PS05L119,PS05L120:
                            PS05L121,PS05L122,PS05L123,PS05L124:
                            PS05L125,PS05L126,PS05L127,PS05L128:
                            PS05L129,PS05L130,PS05L131,PS05L132:
                            PS05L133,PS05L999,PS05L999
          GOTO     PS05L999
.
PS05L101
          MOVE      AMINCOM,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      AMINCOD,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      AMINREF,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      AMINCON,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      AMINVAL,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      AMINAPR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      AMINUA1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      AMINUA2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      AMINUR1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      AMINUR2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L129
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L131
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L132
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L133
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Insurance Details                  
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L101
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Stocktake History                  
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Stocktake History                  
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Stocktake History                  
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Stocktake History                  
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Stocktake History                  
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :    10 Stocktake Number                   
.---------------------------------------------------------
          UNPACK    SP70,AMSTREG,AMSTASS,AMSTSTK
          PACK      KEY19,AMMAREG,AMMAASS,SP70
          MOVE      KEY19,AMST2EKY
          STRIP     AMST2SKY
          SETLPTR   AMST2EKY,14
          MOVE      AMST2EKY,AMST2SKY
          CALL      RDAMST2 
          IF        OVRCD=0
            CALL      RPAMST2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,AMST2CNT
          MOVE     ZERO,AMST2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L101,DP06L102,DP06L103:
                            DP06L104,DP06L105,DP06L106,DP06L107:
                            DP06L108,DP06L109,DP06L110,DP06L111:
                            DP06L112,DP06L113,DP06L114,DP06L115:
                            DP06L116,DP06L117,DP06L118,DP06L119:
                            DP06L010,DP06L010,DP06L010,DP06L010
          GOTO      DP06L010
.
DP06L101
          PACK      AMST2MKY,SP70,SP70
          CALL      UPTAMST2
          IF        AMST2END=0
            CALL      RPAMST2 
            IF        OVRCD=0
              PACK      AMST2MKY,AMSTREG,AMSTASS,AMSTSTK                                                        
              MATCH     AMST2EKY,AMST2MKY
              IF        @EQUAL
                MOVE      ZERO,AMST2END
                ADD       ONE,AMST2CNT
                CALL      UPTAMST2
          CALL      GETSTK00
                MOVE      AMSTSTK,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMST2END
              ENDIF
            ELSE
              MOVE      ONE,AMST2END
            ENDIF
          ENDIF
          IF        AMST2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        AMST2END=0
            MOVE      AMSTBLD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        AMST2END=0
            MOVE      AMSTLOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        AMST2END=0
            UNPACK    AMSTGDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L105
          IF        AMST2END=0
            UNPACK    AMSTPDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L106
          IF        AMST2END=0
            MOVE      AMSTCBY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L107
          IF        AMST2END=0
            MOVE      AMSTCOM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L108
          IF        AMST2END=0
            MOVE      AMSTLCM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L109
          IF        AMST2END=0
            MOVE      AMSTPOP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L110
          IF        AMST2END=0
            UNPACK    AMSTPDA,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L111
          IF        AMST2END=0
            MOVE      AMSTPTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L112
          IF        AMST2END=0
            MOVE      AMSTUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L113
          IF        AMST2END=0
            MOVE      AMSTUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L114
          IF        AMST2END=0
            UNPACK    AMSTUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L115
          IF        AMST2END=0
            UNPACK    AMSTUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L116
          IF        AMST2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMSTUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L117
          IF        AMST2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMSTUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L118
          IF        AMST2END=0
            MOVE      SBLDDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L119
          IF        AMST2END=0
            MOVE      SLOCDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "AMST2",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          MATCH    "AMST2",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          PACK     KEY19,AMST2SKY,Z70
          CALL     RDAMST2  * Start
          IF       OVRCD=0
            CALL     RPAMST2  * Start
          ENDIF
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          MATCH    "AMST2",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY19,AMST2SKY,SP70
          CALL     RSAMST2  * End
          IF       OVRCD=1
            CALL     RKAMST2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMST2SNO
            CALL     RKAMST2 
            IF       OVRCD=1
              MOVE     AMST2SNO,SECTOR
            ENDIF
            PACK     AMST2MKY,AMSTREG,AMSTASS,AMSTSTK                                                        
            MATCH    AMST2EKY,AMST2MKY
            IF       !@EQUAL
              MOVE     AMST2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
          MATCH    "AMST2",NAMSSFFI
          GOTO     PP06L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP06L105
          CALL      RFTAMST2
          BRANCH   OVRCD,PP06L115
          MOVE      AMST2MKY,KEY19 
          CALL      RSAMST2 
PP06L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMST2SNO
            CALL     RKAMST2 
            IF       OVRCD=1
              MOVE     AMST2SNO,SECTOR
            ENDIF
            PACK     AMST2MKY,AMSTREG,AMSTASS,AMSTSTK                                                        
            MATCH    AMST2EKY,AMST2MKY
            IF       !@EQUAL
              MOVE     AMST2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMST2SNO
            CALL     RPAMST2 
            IF       OVRCD=1
              MOVE     AMST2SNO,SECTOR
            ENDIF
            PACK     AMST2MKY,AMSTREG,AMSTASS,AMSTSTK                                                        
            MATCH    AMST2EKY,AMST2MKY
            IF       !@EQUAL
              MOVE     AMST2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP06L999
PP06L120
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "AMST2",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          CALL     RPAMST2 
          BRANCH   OVRCD,NP06L110
          PACK     AMST2MKY,AMSTREG,AMSTASS,AMSTSTK                                                        
          MATCH    AMST2EKY,AMST2MKY
          GOTO     NP06L110 IF NOT EQUAL
          CALL     RKAMST2 
          CALL     DP06L000
          GOTO     NP06L999
NP06L110
          CALL     RKAMST2 
          BEEP
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
CT06L105
CT06L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Stocktake History                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Stocktake Number                   
.---------------------------------------------------------
UPTAMST2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMST2FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMST2FL1,KEY5;SCPSROW,SCPSCOL,AMST2MKY
          ELSE
            UPDATE    AMST2FL1;SCPSROW,SCPSCOL,AMST2MKY
          ENDIF
          RETURN
RDTAMST2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMST2FL1,KEY5;SCPSROW,SCPSCOL,AMST2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMST2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMST2FL1,KEY5;;
          READKS    AMST2FL1;SCPSROW,SCPSCOL,AMST2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMST2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Stocktake History                  
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "AMST2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Stocktake History                  
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Stocktake History                  
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L102,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L103,SF06L104,SF06L105,SF06L106
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L102,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "AMST2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          COMPARE   ONE,ACCEPT
          GOTO      SF06L001 IF EQUAL
          CALL      RDTAMST2
          IF        OVRCD=1
            BEEP
            GOTO      SF06L001
          ENDIF
          MATCH     SP70,AMST2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF06L001
          ENDIF
          MOVE      AMST2MKY,KEY19 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELSTK00
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMST2
          IF        OVRCD=1
            CALL      FP06L000
          ELSE
            MOVE      AMST2MKY,KEY19 
            CALL      RSAMST2 
            CALL      RKAMST2 
            CALL      DP06L000
          ENDIF
          GOTO     SF06L001
.
SF06L103
          MOVE      "AMST2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L104
          MOVE      "AMST2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "AMST2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L106
          MOVE      "AMST2",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
SF06L990  MOVE      ONE,EXIT * Exit Char Restart
SF06L999  RETURN
.--------------------------------
. Screen - Depreciation Details               
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Depreciation Details               
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Depreciation Details               
.--------------------------------------------------------
KY07L000
.
KY07L110
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          BRANCH    EXIT,KY07L900,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      AMDSYEAR,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Depreciation Details               
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Depreciation Details               
.---------------------------------------------------------
LM07L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Depreciation Details               
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Depreciation Details               
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L101:
                            PS07L102,PS07L103,PS07L104,PS07L105:
                            PS07L106,PS07L107,PS07L108,PS07L109:
                            PS07L110,PS07L111,PS07L112,PS07L113:
                            PS07L114,PS07L115,PS07L116,PS07L117:
                            PS07L118,PS07L119,PS07L120,PS07L121:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999
          GOTO     PS07L999
.
PS07L101
          UNPACK    AMMAVDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      TOTALRVT,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L103
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L104
          MOVE      DISPADT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L105
          MOVE      DISPTDT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L106
          MOVE      TOTALTAD,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L107
          MOVE      TOTALAAD,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L108
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L109
          MOVE      AMMADDT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L110
          MOVE      AMMADTY,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L111
          MOVE      AMMADVA,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L112
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L113
          MOVE      TAXDEPN,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L114
          MOVE      ACCDEPN,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L115
          MOVE      DESCTDT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L116
          MOVE      DESCADT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L117
          MOVE      PRIMECST,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L118
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L119
          MOVE      ACCCLOSE,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L120
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L121
          MOVE      TAXCLOSE,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Depreciation Details               
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L101,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                           SF07L006,SF07L102
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          GOTO     SF07L001
.
SF07L101
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCDML000
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.--------------------------------
. Screen - Revaluation Details                
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC08L200
          CALL      CF08L000 * Clear Fields
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Revaluation Details                
.-------------------------------------------------------
CF08L000
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Revaluation Details                
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Revaluation Details                
.---------------------------------------------------------
WP08L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Revaluation Details                
.---------------------------------------------------------
LM08L000
.---------------------------------------------------------
. Load for :     3 Revaluation Date                   
.---------------------------------------------------------
          UNPACK    SP70,AMRVREG,AMRVASS,AMRVRDT
          PACK      KEY22,AMMAREG,AMMAASS,SP70
          MOVE      KEY22,AMRV1EKY
          STRIP     AMRV1SKY
          SETLPTR   AMRV1EKY,14
          MOVE      AMRV1EKY,AMRV1SKY
          CALL      RDAMRV1 
          IF        OVRCD=0
            CALL      RPAMRV1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP08L000
          MOVE     ZERO,AMRV1CNT
          MOVE     ZERO,AMRV1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP08L600
          MATCH    PRGID,SCPSPID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP08L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP08L010,DP08L010,DP08L101,DP08L102:
                            DP08L103,DP08L104,DP08L105,DP08L106:
                            DP08L107,DP08L108,DP08L109,DP08L110:
                            DP08L111,DP08L112,DP08L113,DP08L114:
                            DP08L115,DP08L116,DP08L117,DP08L010:
                            DP08L010,DP08L010,DP08L010
          GOTO      DP08L010
.
DP08L101
          PACK      AMRV1MKY,SP70,SP70
          CALL      UPTAMRV1
          IF        AMRV1END=0
            CALL      RPAMRV1 
            IF        OVRCD=0
              PACK      AMRV1MKY,AMRVREG,AMRVASS,AMRVRDT                                                        
              MATCH     AMRV1EKY,AMRV1MKY
              IF        @EQUAL
                MOVE      ZERO,AMRV1END
                ADD       ONE,AMRV1CNT
                CALL      UPTAMRV1
                UNPACK    AMRVRDT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMRV1END
              ENDIF
            ELSE
              MOVE      ONE,AMRV1END
            ENDIF
          ENDIF
          IF        AMRV1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L102
          IF        AMRV1END=0
            MOVE      AMRVYEAR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L103
          IF        AMRV1END=0
            MOVE      AMRVPER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L104
          IF        AMRV1END=0
            MOVE      AMRVRTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L105
          IF        AMRV1END=0
            MOVE      AMRVREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L106
          IF        AMRV1END=0
            MOVE      AMRVDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L107
          IF        AMRV1END=0
            MOVE      AMRVAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L108
          IF        AMRV1END=0
            MOVE      AMRVAAD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L109
          IF        AMRV1END=0
            MOVE      AMRVRVR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L110
          IF        AMRV1END=0
            MOVE      AMRVPVR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L111
          IF        AMRV1END=0
            MOVE      AMRVUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L112
          IF        AMRV1END=0
            MOVE      AMRVUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L113
          IF        AMRV1END=0
            UNPACK    AMRVUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L114
          IF        AMRV1END=0
            UNPACK    AMRVUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L115
          IF        AMRV1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMRVUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L116
          IF        AMRV1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMRVUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L117
          IF        AMRV1END=0
            MOVE      RTYDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
DP08L600
          MATCH    "AMRV1",NAMSSFFI
          GOTO     DP08L605 IF NOT EQUAL
          GOTO     DP08L999
DP08L605
DP08L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP08L000
.
          MATCH    "AMRV1",NAMSSFFI
          GOTO     FP08L105 IF NOT EQUAL
          PACK     KEY22,AMRV1SKY,Z70
          CALL     RDAMRV1  * Start
          IF       OVRCD=0
            CALL     RPAMRV1  * Start
          ENDIF
          CALL     DP08L000
          GOTO     FP08L999
FP08L105
FP08L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP08L000
.
          MATCH    "AMRV1",NAMSSFFI
          GOTO     LP08L105 IF NOT EQUAL
          PACK     KEY22,AMRV1SKY,SP70
          CALL     RSAMRV1  * End
          IF       OVRCD=1
            CALL     RKAMRV1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMRV1SNO
            CALL     RKAMRV1 
            IF       OVRCD=1
              MOVE     AMRV1SNO,SECTOR
            ENDIF
            PACK     AMRV1MKY,AMRVREG,AMRVASS,AMRVRDT                                                        
            MATCH    AMRV1EKY,AMRV1MKY
            IF       !@EQUAL
              MOVE     AMRV1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     LP08L999
LP08L105
LP08L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP08L000
.
          MATCH    "AMRV1",NAMSSFFI
          GOTO     PP08L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP08L105
          CALL      RFTAMRV1
          BRANCH   OVRCD,PP08L115
          MOVE      AMRV1MKY,KEY22 
          CALL      RSAMRV1 
PP08L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMRV1SNO
            CALL     RKAMRV1 
            IF       OVRCD=1
              MOVE     AMRV1SNO,SECTOR
            ENDIF
            PACK     AMRV1MKY,AMRVREG,AMRVASS,AMRVRDT                                                        
            MATCH    AMRV1EKY,AMRV1MKY
            IF       !@EQUAL
              MOVE     AMRV1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     PP08L999
PP08L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMRV1SNO
            CALL     RPAMRV1 
            IF       OVRCD=1
              MOVE     AMRV1SNO,SECTOR
            ENDIF
            PACK     AMRV1MKY,AMRVREG,AMRVASS,AMRVRDT                                                        
            MATCH    AMRV1EKY,AMRV1MKY
            IF       !@EQUAL
              MOVE     AMRV1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP08L999
PP08L120
PP08L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP08L000
          MATCH    "AMRV1",NAMSSFFI
          GOTO     NP08L115 IF NOT EQUAL
NP08L105
          CALL     RPAMRV1 
          BRANCH   OVRCD,NP08L110
          PACK     AMRV1MKY,AMRVREG,AMRVASS,AMRVRDT                                                        
          MATCH    AMRV1EKY,AMRV1MKY
          GOTO     NP08L110 IF NOT EQUAL
          CALL     RKAMRV1 
          CALL     DP08L000
          GOTO     NP08L999
NP08L110
          CALL     RKAMRV1 
          BEEP
          GOTO     NP08L999
NP08L115
NP08L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT08L000
CT08L105
CT08L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Revaluation Details                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Revaluation Date                   
.---------------------------------------------------------
UPTAMRV1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMRV1FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMRV1FL1,KEY5;SCPSROW,SCPSCOL,AMRV1MKY
          ELSE
            UPDATE    AMRV1FL1;SCPSROW,SCPSCOL,AMRV1MKY
          ENDIF
          RETURN
RDTAMRV1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMRV1FL1,KEY5;SCPSROW,SCPSCOL,AMRV1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMRV1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMRV1FL1,KEY5;;
          READKS    AMRV1FL1;SCPSROW,SCPSCOL,AMRV1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMRV1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Revaluation Details                
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
          MOVE      "AMRV1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP08L000
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Revaluation Details                
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Revaluation Details                
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L006,SF08L101,SF08L102,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L103:
                            SF08L104,SF08L105,SF08L106
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L020,SF08L020,SF08L102,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          MOVE      "AMRV1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L101
          MOVE      ZERO,EXIT
          GOTO      SF08L999
.
SF08L102
          CALL      SELECTED
          BRANCH    EXIT,SF08L001
          COMPARE   ONE,ACCEPT
          GOTO      SF08L001 IF EQUAL
          CALL      RDTAMRV1
          IF        OVRCD=1
            BEEP
            GOTO      SF08L001
          ENDIF
          MATCH     SP70,AMRV1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF08L001
          ENDIF
          MOVE      AMRV1MKY,KEY22 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELREV00
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMRV1
          IF        OVRCD=1
            CALL      FP08L000
          ELSE
            MOVE      AMRV1MKY,KEY22 
            CALL      RSAMRV1 
            CALL      RKAMRV1 
            CALL      DP08L000
          ENDIF
          GOTO     SF08L001
.
SF08L103
          MOVE      "AMRV1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP08L000
          GOTO     SF08L001
.
SF08L104
          MOVE      "AMRV1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP08L000
          GOTO     SF08L001
.
SF08L105
          MOVE      "AMRV1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L106
          MOVE      "AMRV1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP08L000
          GOTO     SF08L001
SF08L990  MOVE      ONE,EXIT * Exit Char Restart
SF08L999  RETURN
.--------------------------------
. Screen - General Ledger Interface Details   
.--------------------------------
SC09L000
SC09L100
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC09L200
          CALL      CF09L000 * Clear Fields
SC09L300
          CALL      KY09L000 * Enter Key Fields
          BRANCH    EXIT,SC09L999,SC09L999
SC09L400
          CALL      WP09L000 * Load any WP Details
SC09L500
          CALL      LM09L000 * Load any Batch Details
SC09L600
          CALL      DF09L000 * Display Fields
SC09L700
          CALL      SF09L000 * Select Fields
          BRANCH    EXIT,SC09L100,SC09L100,SC09L200
SC09L800
SC09L900
SC09L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : General Ledger Interface Details   
.-------------------------------------------------------
CF09L000
CF09L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for General Ledger Interface Details   
.--------------------------------------------------------
KY09L000
          MOVE      ZERO,EXIT
          GOTO      KY09L999
.
KY09L900  MOVE      ONE,EXIT
KY09L999  RETURN
.---------------------------------------------------------
. Load WP files for : General Ledger Interface Details   
.---------------------------------------------------------
WP09L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : General Ledger Interface Details   
.---------------------------------------------------------
LM09L000
.---------------------------------------------------------
. Load for :     3 Counter                            
.---------------------------------------------------------
          UNPACK    SP70,AMTRREG,AMTRASS,AMTRUNI
          PACK      KEY19,AMMAREG,AMMAASS,SP70
          MOVE      KEY19,AMTR1EKY
          STRIP     AMTR1SKY
          SETLPTR   AMTR1EKY,14
          MOVE      AMTR1EKY,AMTR1SKY
          CALL      RDAMTR1 
          IF        OVRCD=0
            CALL      RPAMTR1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP09L000
          MOVE     ZERO,AMTR1CNT
          MOVE     ZERO,AMTR1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP09L600
          MATCH    PRGID,SCPSPID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP09L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP09L010,DP09L010,DP09L101,DP09L102:
                            DP09L103,DP09L104,DP09L105,DP09L106:
                            DP09L107,DP09L108,DP09L109,DP09L110:
                            DP09L111,DP09L112,DP09L113,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L114:
                            DP09L115
          GOTO      DP09L010
.
DP09L101
          PACK      AMTR1MKY,SP70,SP70
          CALL      UPTAMTR1
          IF        AMTR1END=0
            CALL      RPAMTR1 
            IF        OVRCD=0
              PACK      AMTR1MKY,AMTRREG,AMTRASS,AMTRUNI                                                        
              MATCH     AMTR1EKY,AMTR1MKY
              IF        @EQUAL
                MOVE      ZERO,AMTR1END
                ADD       ONE,AMTR1CNT
                CALL      UPTAMTR1
                MOVE      AMTRUNI,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMTR1END
              ENDIF
            ELSE
              MOVE      ONE,AMTR1END
            ENDIF
          ENDIF
          IF        AMTR1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L102
          IF        AMTR1END=0
            UNPACK    AMTRDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L103
          IF        AMTR1END=0
            MOVE      AMTRREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L104
          IF        AMTR1END=0
            MOVE      AMTRCOM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L105
          IF        AMTR1END=0
            MOVE      AMTRAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L106
          IF        AMTR1END=0
            MOVE      AMTRIRUN,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L107
          IF        AMTR1END=0
            MOVE      AMTRDLED,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L108
          IF        AMTR1END=0
            MOVE      AMTRDACC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L109
          IF        AMTR1END=0
            MOVE      AMTRCACC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L110
          IF        AMTR1END=0
            MOVE      AMTRUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L111
          IF        AMTR1END=0
            MOVE      AMTRUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L112
          IF        AMTR1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMTRUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L113
          IF        AMTR1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      AMTRUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L114
          IF        AMTR1END=0
            MOVE      AMTRYEAR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L115
          IF        AMTR1END=0
            MOVE      AMTRPER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
DP09L600
          MATCH    "AMTR1",NAMSSFFI
          GOTO     DP09L605 IF NOT EQUAL
          GOTO     DP09L999
DP09L605
DP09L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP09L000
.
          MATCH    "AMTR1",NAMSSFFI
          GOTO     FP09L105 IF NOT EQUAL
          PACK     KEY19,AMTR1SKY,Z70
          CALL     RDAMTR1  * Start
          IF       OVRCD=0
            CALL     RPAMTR1  * Start
          ENDIF
          CALL     DP09L000
          GOTO     FP09L999
FP09L105
FP09L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP09L000
.
          MATCH    "AMTR1",NAMSSFFI
          GOTO     LP09L105 IF NOT EQUAL
          PACK     KEY19,AMTR1SKY,SP70
          CALL     RSAMTR1  * End
          IF       OVRCD=1
            CALL     RKAMTR1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMTR1SNO
            CALL     RKAMTR1 
            IF       OVRCD=1
              MOVE     AMTR1SNO,SECTOR
            ENDIF
            PACK     AMTR1MKY,AMTRREG,AMTRASS,AMTRUNI                                                        
            MATCH    AMTR1EKY,AMTR1MKY
            IF       !@EQUAL
              MOVE     AMTR1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     LP09L999
LP09L105
LP09L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP09L000
.
          MATCH    "AMTR1",NAMSSFFI
          GOTO     PP09L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP09L105
          CALL      RFTAMTR1
          BRANCH   OVRCD,PP09L115
          MOVE      AMTR1MKY,KEY19 
          CALL      RSAMTR1 
PP09L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMTR1SNO
            CALL     RKAMTR1 
            IF       OVRCD=1
              MOVE     AMTR1SNO,SECTOR
            ENDIF
            PACK     AMTR1MKY,AMTRREG,AMTRASS,AMTRUNI                                                        
            MATCH    AMTR1EKY,AMTR1MKY
            IF       !@EQUAL
              MOVE     AMTR1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     PP09L999
PP09L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMTR1SNO
            CALL     RPAMTR1 
            IF       OVRCD=1
              MOVE     AMTR1SNO,SECTOR
            ENDIF
            PACK     AMTR1MKY,AMTRREG,AMTRASS,AMTRUNI                                                        
            MATCH    AMTR1EKY,AMTR1MKY
            IF       !@EQUAL
              MOVE     AMTR1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP09L999
PP09L120
PP09L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP09L000
          MATCH    "AMTR1",NAMSSFFI
          GOTO     NP09L115 IF NOT EQUAL
NP09L105
          CALL     RPAMTR1 
          BRANCH   OVRCD,NP09L110
          PACK     AMTR1MKY,AMTRREG,AMTRASS,AMTRUNI                                                        
          MATCH    AMTR1EKY,AMTR1MKY
          GOTO     NP09L110 IF NOT EQUAL
          CALL     RKAMTR1 
          CALL     DP09L000
          GOTO     NP09L999
NP09L110
          CALL     RKAMTR1 
          BEEP
          GOTO     NP09L999
NP09L115
NP09L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT09L000
CT09L105
CT09L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : General Ledger Interface Details   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Counter                            
.---------------------------------------------------------
UPTAMTR1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMTR1FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMTR1FL1,KEY5;SCPSROW,SCPSCOL,AMTR1MKY
          ELSE
            UPDATE    AMTR1FL1;SCPSROW,SCPSCOL,AMTR1MKY
          ENDIF
          RETURN
RDTAMTR1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMTR1FL1,KEY5;SCPSROW,SCPSCOL,AMTR1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMTR1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMTR1FL1,KEY5;;
          READKS    AMTR1FL1;SCPSROW,SCPSCOL,AMTR1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMTR1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : General Ledger Interface Details   
.---------------------------------------------------------
DF09L000
          BRANCH   ACCEPT,DF09L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF09L900
          MATCH    PRGID,SCPSPID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF09L010 IF NOT EQUAL
.
          CALL     PS09L000 * Display Field
          GOTO     DF09L010
DF09L900
          MOVE      "AMTR1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP09L000
DF09L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : General Ledger Interface Details   
.---------------------------------------------------------
PS09L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999
          GOTO     PS09L999
PS09L999
          RETURN
.---------------------------------------------------------
. Selections for : General Ledger Interface Details   
.---------------------------------------------------------
SF09L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF09L001  BRANCH   ACCEPT,SF09L020
.
SF09L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L006,SF09L101,SF09L102,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L103:
                            SF09L104,SF09L105,SF09L106,SF09L006:
                            SF09L006
SF09L006  BEEP
          GOTO     SF09L005
SF09L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF09L090
          MATCH    PRGID,SCSLPID
          GOTO     SF09L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF09L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L020,SF09L020,SF09L102,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020
          GOTO     SF09L020
SF09L090  MOVE     ZERO,ACCEPT
          MOVE      "AMTR1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L101
          MOVE      ZERO,EXIT
          GOTO      SF09L999
.
SF09L102
          CALL      SELECTED
          BRANCH    EXIT,SF09L001
          COMPARE   ONE,ACCEPT
          GOTO      SF09L001 IF EQUAL
          CALL      RDTAMTR1
          IF        OVRCD=1
            BEEP
            GOTO      SF09L001
          ENDIF
          MATCH     SP70,AMTR1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF09L001
          ENDIF
          MOVE      AMTR1MKY,KEY19 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELTRN00
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMTR1
          IF        OVRCD=1
            CALL      FP09L000
          ELSE
            MOVE      AMTR1MKY,KEY19 
            CALL      RSAMTR1 
            CALL      RKAMTR1 
            CALL      DP09L000
          ENDIF
          GOTO     SF09L001
.
SF09L103
          MOVE      "AMTR1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP09L000
          GOTO     SF09L001
.
SF09L104
          MOVE      "AMTR1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP09L000
          GOTO     SF09L001
.
SF09L105
          MOVE      "AMTR1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L106
          MOVE      "AMTR1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP09L000
          GOTO     SF09L001
SF09L990  MOVE      ONE,EXIT * Exit Char Restart
SF09L999  RETURN
.--------------------------------
. Screen - Depreciation by Month              
.--------------------------------
SCDML000
SCDML100
          MOVE      "DM",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCDML200
          CALL      CFDML000 * Clear Fields
SCDML300
          CALL      KYDML000 * Enter Key Fields
          BRANCH    EXIT,SCDML999,SCDML999
SCDML400
          CALL      WPDML000 * Load any WP Details
SCDML500
          CALL      LMDML000 * Load any Batch Details
SCDML600
          CALL      DFDML000 * Display Fields
SCDML700
          CALL      SFDML000 * Select Fields
          BRANCH    EXIT,SCDML100,SCDML100,SCDML200
SCDML800
SCDML900
SCDML999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Depreciation by Month              
.-------------------------------------------------------
CFDML000
CFDML999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Depreciation by Month              
.--------------------------------------------------------
KYDML000
          MOVE      ZERO,EXIT
          GOTO      KYDML999
.
KYDML900  MOVE      ONE,EXIT
KYDML999  RETURN
.---------------------------------------------------------
. Load WP files for : Depreciation by Month              
.---------------------------------------------------------
WPDML000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Depreciation by Month              
.---------------------------------------------------------
LMDML000
          RETURN
.---------------------------------------------------------
. Display Fields for : Depreciation by Month              
.---------------------------------------------------------
DFDML000
          BRANCH   ACCEPT,DFDML999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFDML010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFDML900
          MATCH    PRGID,SCPSPID
          GOTO     DFDML900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFDML900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFDML010 IF NOT EQUAL
.
          CALL     PSDML000 * Display Field
          GOTO     DFDML010
DFDML900
DFDML999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Depreciation by Month              
.---------------------------------------------------------
PSDML000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSDML999,PSDML999,PSDML999,PSDML101:
                            PSDML102,PSDML103,PSDML104,PSDML105:
                            PSDML106,PSDML107,PSDML108,PSDML109:
                            PSDML110,PSDML111,PSDML112,PSDML113:
                            PSDML114,PSDML115,PSDML116,PSDML117:
                            PSDML118,PSDML119,PSDML120,PSDML121:
                            PSDML122,PSDML123,PSDML124,PSDML125:
                            PSDML126,PSDML127,PSDML128,PSDML129:
                            PSDML130,PSDML131,PSDML132,PSDML133:
                            PSDML134,PSDML135,PSDML136,PSDML137:
                            PSDML138,PSDML139,PSDML140,PSDML141:
                            PSDML142,PSDML143,PSDML144,PSDML145:
                            PSDML146,PSDML147,PSDML148,PSDML149:
                            PSDML150,PSDML151,PSDML152,PSDML153:
                            PSDML154,PSDML155,PSDML156,PSDML157:
                            PSDML158,PSDML159,PSDML160
          GOTO     PSDML999
.
PSDML101
          UNPACK    AMMAVDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML102
          MOVE      AMMARVT,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML103
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML104
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML105
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML106
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML107
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML108
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML109
          MOVE      AMMADDT,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML110
          MOVE      AMMADTY,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML111
          MOVE      AMMADVA,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML112
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML113
          MOVE      TAXDEPN,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML114
          MOVE      ACCDEPN,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML115
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML116
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML117
          MOVE      PRIMECST,VAR     
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML118
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML119
          MOVE      ACCCLOSE,VAR     
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML120
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML121
          MOVE      TAXCLOSE,VAR     
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG01,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG02,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG03,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG04,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG05,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG06,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG07,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG08,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG09,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG10,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG11,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG12,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMDSG13,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML135
          MOVE      AMDSA01,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML136
          MOVE      AMDSA02,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML137
          MOVE      AMDSA03,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML138
          MOVE      AMDSA04,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML139
          MOVE      AMDSA05,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML140
          MOVE      AMDSA06,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML141
          MOVE      AMDSA07,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML142
          MOVE      AMDSA08,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML143
          MOVE      AMDSA09,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML144
          MOVE      AMDSA10,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML145
          MOVE      AMDSA11,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML146
          MOVE      AMDSA12,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML147
          MOVE      AMDSA13,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML148
          MOVE      AMDST01,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML149
          MOVE      AMDST02,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML150
          MOVE      AMDST03,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML151
          MOVE      AMDST04,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML152
          MOVE      AMDST05,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML153
          MOVE      AMDST06,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML154
          MOVE      AMDST07,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML155
          MOVE      AMDST08,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML156
          MOVE      AMDST09,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML157
          MOVE      AMDST10,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML158
          MOVE      AMDST11,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML159
          MOVE      AMDST12,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
.
PSDML160
          MOVE      AMDST13,VAR      
          CALL      DISPITEM
          GOTO     PSDML999
PSDML999
          RETURN
.---------------------------------------------------------
. Selections for : Depreciation by Month              
.---------------------------------------------------------
SFDML000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFDML001  BRANCH   ACCEPT,SFDML020
.
SFDML005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDML006,SFDML101,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006,SFDML006:
                            SFDML006,SFDML006,SFDML006
SFDML006  BEEP
          GOTO     SFDML005
SFDML020  CALL     RKSCSL1
          BRANCH   OVRCD,SFDML090
          MATCH    PRGID,SCSLPID
          GOTO     SFDML090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFDML090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020,SFDML020:
                            SFDML020,SFDML020,SFDML020
          GOTO     SFDML020
SFDML090  MOVE     ZERO,ACCEPT
          GOTO     SFDML001
.
SFDML101
          MOVE      ZERO,EXIT
          GOTO      SFDML999
SFDML990  MOVE      ONE,EXIT * Exit Char Restart
SFDML999  RETURN
.--------------------------------
. Screen - Revaluation Details                
.--------------------------------
SCRDL000
SCRDL100
          MOVE      "RD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCRDL200
          CALL      CFRDL000 * Clear Fields
SCRDL300
          CALL      KYRDL000 * Enter Key Fields
          BRANCH    EXIT,SCRDL999,SCRDL999
SCRDL400
          CALL      WPRDL000 * Load any WP Details
SCRDL500
          CALL      LMRDL000 * Load any Batch Details
SCRDL600
          CALL      DFRDL000 * Display Fields
SCRDL700
          CALL      SFRDL000 * Select Fields
          BRANCH    EXIT,SCRDL100,SCRDL100,SCRDL200
SCRDL800
SCRDL900
SCRDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Revaluation Details                
.-------------------------------------------------------
CFRDL000
CFRDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Revaluation Details                
.--------------------------------------------------------
KYRDL000
          MOVE      ZERO,EXIT
          GOTO      KYRDL999
.
KYRDL900  MOVE      ONE,EXIT
KYRDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Revaluation Details                
.---------------------------------------------------------
WPRDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Revaluation Details                
.---------------------------------------------------------
LMRDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Revaluation Details                
.---------------------------------------------------------
DFRDL000
          BRANCH   ACCEPT,DFRDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFRDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFRDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFRDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFRDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFRDL010 IF NOT EQUAL
.
          CALL     PSRDL000 * Display Field
          GOTO     DFRDL010
DFRDL900
DFRDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Revaluation Details                
.---------------------------------------------------------
PSRDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSRDL999,PSRDL999,PSRDL101,PSRDL102:
                            PSRDL103,PSRDL104,PSRDL105,PSRDL106:
                            PSRDL107,PSRDL108,PSRDL109,PSRDL110:
                            PSRDL111,PSRDL112,PSRDL113,PSRDL114:
                            PSRDL115,PSRDL116,PSRDL117
          GOTO     PSRDL999
.
PSRDL101
          UNPACK    AMRVRDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL102
          MOVE      AMRVYEAR,VAR     
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL103
          MOVE      AMRVPER,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL104
          MOVE      AMRVRTY,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL105
          MOVE      AMRVREF,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL106
          MOVE      AMRVDES,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL107
          MOVE      AMRVAMT,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL108
          MOVE      AMRVAAD,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL109
          MOVE      AMRVRVR,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL110
          MOVE      AMRVPVR,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL111
          MOVE      AMRVUR1,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL112
          MOVE      AMRVUR2,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL113
          UNPACK    AMRVUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL114
          UNPACK    AMRVUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMRVUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMRVUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSRDL999
.
PSRDL117
          MOVE      RTYDESC,VAR      
          CALL      DISPITEM
          GOTO     PSRDL999
PSRDL999
          RETURN
.---------------------------------------------------------
. Selections for : Revaluation Details                
.---------------------------------------------------------
SFRDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFRDL001  BRANCH   ACCEPT,SFRDL020
.
SFRDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFRDL006,SFRDL101,SFRDL006,SFRDL006:
                            SFRDL006,SFRDL006,SFRDL006,SFRDL006:
                            SFRDL006,SFRDL006,SFRDL006,SFRDL006:
                            SFRDL006,SFRDL006,SFRDL006,SFRDL006:
                            SFRDL006,SFRDL006,SFRDL006
SFRDL006  BEEP
          GOTO     SFRDL005
SFRDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFRDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFRDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFRDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFRDL020,SFRDL020,SFRDL020,SFRDL020:
                            SFRDL020,SFRDL020,SFRDL020,SFRDL020:
                            SFRDL020,SFRDL020,SFRDL020,SFRDL020:
                            SFRDL020,SFRDL020,SFRDL020,SFRDL020:
                            SFRDL020,SFRDL020,SFRDL020
          GOTO     SFRDL020
SFRDL090  MOVE     ZERO,ACCEPT
          GOTO     SFRDL001
.
SFRDL101
          MOVE      ZERO,EXIT
          GOTO      SFRDL999
SFRDL990  MOVE      ONE,EXIT * Exit Char Restart
SFRDL999  RETURN
.--------------------------------
. Screen - Stocktake Details                  
.--------------------------------
SCSDL000
SCSDL100
          MOVE      "SD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCSDL200
          CALL      CFSDL000 * Clear Fields
SCSDL300
          CALL      KYSDL000 * Enter Key Fields
          BRANCH    EXIT,SCSDL999,SCSDL999
SCSDL400
          CALL      WPSDL000 * Load any WP Details
SCSDL500
          CALL      LMSDL000 * Load any Batch Details
SCSDL600
          CALL      DFSDL000 * Display Fields
SCSDL700
          CALL      SFSDL000 * Select Fields
          BRANCH    EXIT,SCSDL100,SCSDL100,SCSDL200
SCSDL800
SCSDL900
SCSDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Stocktake Details                  
.-------------------------------------------------------
CFSDL000
CFSDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Stocktake Details                  
.--------------------------------------------------------
KYSDL000
          MOVE      ZERO,EXIT
          GOTO      KYSDL999
.
KYSDL900  MOVE      ONE,EXIT
KYSDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Stocktake Details                  
.---------------------------------------------------------
WPSDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Stocktake Details                  
.---------------------------------------------------------
LMSDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Stocktake Details                  
.---------------------------------------------------------
DFSDL000
          BRANCH   ACCEPT,DFSDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFSDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFSDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFSDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFSDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFSDL010 IF NOT EQUAL
.
          CALL     PSSDL000 * Display Field
          GOTO     DFSDL010
DFSDL900
DFSDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Stocktake Details                  
.---------------------------------------------------------
PSSDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSSDL999,PSSDL999,PSSDL101,PSSDL102:
                            PSSDL103,PSSDL104,PSSDL999,PSSDL105:
                            PSSDL106,PSSDL107,PSSDL108,PSSDL109:
                            PSSDL110,PSSDL111,PSSDL112,PSSDL113:
                            PSSDL114,PSSDL115,PSSDL116,PSSDL117:
                            PSSDL118,PSSDL119,PSSDL120,PSSDL121:
                            PSSDL122,PSSDL123,PSSDL124,PSSDL125:
                            PSSDL126,PSSDL127,PSSDL128,PSSDL129:
                            PSSDL130,PSSDL131
          GOTO     PSSDL999
.
PSSDL101
          MOVE      AMSMSTK,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL102
          UNPACK    AMSMDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL103
          MOVE      AMSMTIM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL104
          MOVE      GENOPER,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL105
          MOVE      AMSMCOM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL106
          MOVE      AMSMUR1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL107
          MOVE      AMSMUR2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL108
          UNPACK    AMSMUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL109
          UNPACK    AMSMUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMSMUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMSMUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL112
          MOVE      AMSTBLD,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL113
          MOVE      AMSTLOC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL114
          MOVE      AMSTREG,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL115
          MOVE      AMSTASS,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL116
          UNPACK    AMSTGDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL117
          UNPACK    AMSTPDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL118
          MOVE      AMSTCBY,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL119
          MOVE      AMSTCOM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL120
          MOVE      AMSTLCM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL121
          MOVE      PROOPER,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL122
          UNPACK    AMSTPDA,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL123
          MOVE      AMSTPTM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL124
          MOVE      AMSTUR1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL125
          MOVE      AMSTUR2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL126
          UNPACK    AMSTUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL127
          UNPACK    AMSTUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMSTUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMSTUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL130
          MOVE      SBLDDESC,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL131
          MOVE      SLOCDESC,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
PSSDL999
          RETURN
.---------------------------------------------------------
. Selections for : Stocktake Details                  
.---------------------------------------------------------
SFSDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFSDL001  BRANCH   ACCEPT,SFSDL020
.
SFSDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFSDL006,SFSDL101,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006
SFSDL006  BEEP
          GOTO     SFSDL005
SFSDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFSDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFSDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFSDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020
          GOTO     SFSDL020
SFSDL090  MOVE     ZERO,ACCEPT
          GOTO     SFSDL001
.
SFSDL101
          MOVE      ZERO,EXIT
          GOTO      SFSDL999
SFSDL990  MOVE      ONE,EXIT * Exit Char Restart
SFSDL999  RETURN
.--------------------------------
. Screen - Transaction Details                
.--------------------------------
SCTDL000
SCTDL100
          MOVE      "TD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCTDL200
          CALL      CFTDL000 * Clear Fields
SCTDL300
          CALL      KYTDL000 * Enter Key Fields
          BRANCH    EXIT,SCTDL999,SCTDL999
SCTDL400
          CALL      WPTDL000 * Load any WP Details
SCTDL500
          CALL      LMTDL000 * Load any Batch Details
SCTDL600
          CALL      DFTDL000 * Display Fields
SCTDL700
          CALL      SFTDL000 * Select Fields
          BRANCH    EXIT,SCTDL100,SCTDL100,SCTDL200
SCTDL800
SCTDL900
SCTDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transaction Details                
.-------------------------------------------------------
CFTDL000
CFTDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transaction Details                
.--------------------------------------------------------
KYTDL000
          MOVE      ZERO,EXIT
          GOTO      KYTDL999
.
KYTDL900  MOVE      ONE,EXIT
KYTDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Transaction Details                
.---------------------------------------------------------
WPTDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transaction Details                
.---------------------------------------------------------
LMTDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transaction Details                
.---------------------------------------------------------
DFTDL000
          BRANCH   ACCEPT,DFTDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFTDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFTDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFTDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFTDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFTDL010 IF NOT EQUAL
.
          CALL     PSTDL000 * Display Field
          GOTO     DFTDL010
DFTDL900
DFTDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transaction Details                
.---------------------------------------------------------
PSTDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSTDL999,PSTDL999,PSTDL101,PSTDL102:
                            PSTDL103,PSTDL104,PSTDL105,PSTDL106:
                            PSTDL107,PSTDL108,PSTDL109,PSTDL110:
                            PSTDL111,PSTDL112,PSTDL113,PSTDL114:
                            PSTDL115,PSTDL116,PSTDL117,PSTDL118:
                            PSTDL119,PSTDL120
          GOTO     PSTDL999
.
PSTDL101
          MOVE      AMTRUNI,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL102
          UNPACK    AMTRDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL103
          MOVE      AMTRREF,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL104
          MOVE      AMTRCOM,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL105
          MOVE      AMTRAMT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL106
          MOVE      AMTRIRUN,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL107
          MOVE      AMTRDLED,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL108
          MOVE      AMTRDACC,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL109
          MOVE      AMTRCACC,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL110
          MOVE      AMTRUR1,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL111
          MOVE      AMTRUR2,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMTRUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMTRUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL114
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL115
          MOVE      DRDESC,VAR       
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL116
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL117
          MOVE      AMTRYEAR,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL118
          MOVE      AMTRPER,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL119
          MOVE      AMTRDIS,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL120
          MOVE      AMTRRES,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
PSTDL999
          RETURN
.---------------------------------------------------------
. Selections for : Transaction Details                
.---------------------------------------------------------
SFTDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFTDL001  BRANCH   ACCEPT,SFTDL020
.
SFTDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFTDL006,SFTDL101,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006
SFTDL006  BEEP
          GOTO     SFTDL005
SFTDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFTDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFTDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFTDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020
          GOTO     SFTDL020
SFTDL090  MOVE     ZERO,ACCEPT
          GOTO     SFTDL001
.
SFTDL101
          MOVE      ZERO,EXIT
          GOTO      SFTDL999
SFTDL990  MOVE      ONE,EXIT * Exit Char Restart
SFTDL999  RETURN
.@@@@@ Function Restart Point @@@@@
GETCON00  MOVE      THREE,AUDTSECT
          READ      CONTROLF,AUDTSECT;CFAMSRUN,CFAMYEAR,*53,CFAMPASS
          RETURN
.-------------------------------------------------------------
EASST000  MOVE      ZERO,CKEYTYP
          CALL      KAMMAA00                * Call Standard Keyin Routine with ?
          BRANCH    EXIT,EASST999,EASST999  * Exit 1 Null Entry 2 Exitchar
.
EASST100  CALL      GASST000                * Get Description Details
          MOVE      ZERO,EXIT               * Setup Exit Field
          MOVE      ZERO,OVRCD              * Setup Ovrcd Field
          GOTO      EASST999
.
EASST999  RETURN                            * End of Routine
.
GASST000  MOVE      SP70,DTYDESC
          MATCH     SP70,AMMADTY
          IF        !@EQUAL
            MOVE      "DT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADTY
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DTYDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,DPTDESC
          MATCH     SP70,AMMADPT
          IF        !@EQUAL
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADPT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DPTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,BLDDESC
          MATCH     SP70,AMMABLD
          IF        !@EQUAL
            MOVE      "BL",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMABLD
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,BLDDESC
            ENDIF
            PACK      KEY9,AMMABLD,AMMALOC
            CALL      RDAMLO1
            IF        OVRCD=0
              MOVE      AMLODES,LOCDESC
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMASUPC
          IF        !@EQUAL
            MOVE      AMMASUPC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMASUPN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAMANC
          IF        !@EQUAL
            MOVE      AMMAMANC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMAMANN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAGIC
          IF        !@EQUAL
            MOVE      AMMAGIC,KEY5
            CALL      RDAMGI1
          ENDIF
.
          MOVE      SP70,SOFDESC
          MATCH     SP70,AMMASOF
          IF        !@EQUAL
            MOVE      "SF",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMASOF
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,SOFDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC1DESC
          MATCH     SP70,AMMAUC1
          IF        !@EQUAL
            MOVE      "A1",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC1
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC1DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC2DESC
          MATCH     SP70,AMMAUC2
          IF        !@EQUAL
            MOVE      "A2",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC2
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC2DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC3DESC
          MATCH     SP70,AMMAUC3
          IF        !@EQUAL
            MOVE      "A3",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC3
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC3DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC4DESC
          MATCH     SP70,AMMAUC4
          IF        !@EQUAL
            MOVE      "A4",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC4
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC4DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TYPDESC
          MATCH     SP70,AMMATYP
          IF        !@EQUAL
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMATYP
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,TYPDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,ADTDESC
          MATCH     SP70,AMMAADT
          IF        !@EQUAL
            PACK      KEY4,AMMAADT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,ADTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TDTDESC
          MATCH     SP70,AMMATDT
          IF        !@EQUAL
            PACK      KEY4,AMMATDT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,TDTDESC
            ENDIF
          ENDIF
.
          RETURN
GETLEA00  IF       AMMALEA=0
            MOVE     "Asset is Not Leased. - ",DISPMSG
            BEEP
            CALL     MESSAGE1
            MOVE     ONE,EXIT
            GOTO     GETLEA99
          ENDIF
.
          PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMLE1
          IF       OVRCD=1
            MOVE     "No Details on File. - ",DISPMSG
            BEEP
            CALL     MESSAGE1
            MOVE     ONE,EXIT
            GOTO     GETLEA99
          ENDIF
.
          MOVE      SP70,PMTDESC
          MATCH     SP70,AMLEPMT
          IF        !@EQUAL
            MOVE      "PM",AMCDCAT
            PACK      KEY5,AMCDCAT,AMLEPMT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,PMTDESC
            ENDIF
          ENDIF
.
          CALL     SC04L000
          MOVE     THREE,EXIT
.
GETLEA99  RETURN
GETINS00  PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMIN1
          IF       OVRCD=1
            MOVE     "No Insurance Details Available. - ",DISPMSG
            BEEP
            CALL     MESSAGE1
            MOVE     ONE,EXIT
            GOTO     GETINS99
          ENDIF
.
          CALL     SC05L000
          MOVE     THREE,EXIT
.
GETINS99  RETURN
CALDEP00   MATCH     SP70,AMMADDT
           GOTO      CALDEP80 IF EQUAL
.
           MATCH     CFAMYEAR,AMMADYR
           GOTO      CALDEP80 IF NOT EQUAL
.
           PACK      KEY18,AMMAREG,AMMAASS,AMMADYR
           CALL      RDAMDS1
           BRANCH    OVRCD,CALDEP80
.
           ASSIGN    AMMAAAD+AMDSA01+AMDSA02+AMDSA03+AMDSA04+AMDSA05,TOTALDEP
           ASSIGN    TOTALDEP+AMDSA06+AMDSA07+AMDSA08+AMDSA09+AMDSA10,TOTALDEP
           ASSIGN    TOTALDEP+AMDSA11+AMDSA12+AMDSA13,TOTALDEP
           GOTO      CALDEP90
.
CALDEP80   MOVE      AMMAAAD,TOTALDEP
.
CALDEP90   ASSIGN    AMMACST+AMMARVT-TOTALDEP,ACCCLOSE
           MATCH     SP70,AMMADDT
           IF        @EQUAL
             MOVE      ZERO,PROFIT
           ELSE
             ASSIGN    AMMADVA-ACCCLOSE,PROFIT
           ENDIF
.
CALDEP99   RETURN
.
GETDPT00  MOVE      "DP",AMCDCAT
          PACK      KEY5,AMCDCAT,AMDHFDPT
          CALL      RDAMCD1
          IF        OVRCD=0
            MOVE      AMCDDES,FDPTDESC
          ENDIF
.
          PACK      KEY5,AMCDCAT,AMDHTDPT
          CALL      RDAMCD1
          IF        OVRCD=0
            MOVE      AMCDDES,TDPTDESC
          ENDIF
.
          RETURN
.
GETLOC00
          MOVE      "BL",AMCDCAT
          PACK      KEY5,AMCDCAT,AMLHFBLD
          CALL      RDAMCD1
          IF        OVRCD=0
            MOVE      AMCDDES,FBLDDESC
          ENDIF
          PACK      KEY9,AMLHFBLD,AMLHFLOC
          CALL      RDAMLO1
          IF        OVRCD=0
            MOVE      AMLODES,FLOCDESC
          ENDIF
.
          PACK      KEY5,AMCDCAT,AMLHTBLD
          CALL      RDAMCD1
          IF        OVRCD=0
            MOVE      AMCDDES,TBLDDESC
          ENDIF
          PACK      KEY9,AMLHTBLD,AMLHTLOC
          CALL      RDAMLO1
          IF        OVRCD=0
            MOVE      AMLODES,TLOCDESC
          ENDIF
.
          RETURN

.------------------------------------------------------------
. Get Stocktake Details
.------------------------------------------------------------
GETSTK00
          MOVE     "BL",AMCDCAT
          PACK     KEY5,AMCDCAT,AMSTBLD
          CALL     RDAMCD1
          MOVE     AMCDDES,SBLDDESC
.
          PACK     KEY9,AMSTBLD,AMSTLOC
          CALL     RDAMLO1
          MOVE     AMLODES,SLOCDESC
          RETURN
.------------------------------------------------------------
. Select Stocktake Number from Screen for an Asset
.------------------------------------------------------------
SELSTK00
          PACK     KEY17,AMSTREG,AMSTASS,AMSTSTK
          CALL     RDAMST2
          PACK     KEY5,AMSTSTK
          CALL     RDAMSM1
.
          MOVE     "BL",AMCDCAT
          PACK     KEY5,AMCDCAT,AMSTBLD
          CALL     RDAMCD1
          MOVE     AMCDDES,SBLDDESC
.
          MOVE     SP70,GENOPER
          MOVE     SP70,PROOPER
          MOVE     AMSMOPR,KEY4
          CALL     RDPASS1
          IF       OVRCD=0
            MOVE     SECUSER,GENOPER
          ENDIF
.
          MOVE     AMSTPOP,KEY4
          CALL     RDPASS1
          IF       OVRCD=0
            MOVE     SECUSER,PROOPER
          ENDIF
.
          PACK     KEY9,AMSTBLD,AMSTLOC
          CALL     RDAMLO1
          MOVE     AMLODES,SLOCDESC
.
          CALL     SCSDL000    * Stocktake Details Screen
.
          RETURN
.------------------------------------------------------------
. Enter Year for Depreciation Record
.------------------------------------------------------------
EYEAR000  MOVE    ZERO,CKEYTYP
          MOVE    AMMAREG,AMDSREG
          MOVE    AMMAASS,AMDSASS
          CALL    KAMDSA00
          BRANCH  EXIT,EYEAR999,EYEAR999
.
          ASSIGN  AMDST01+AMDST02+AMDST03,TAXDEPN
          ASSIGN  TAXDEPN+AMDST04+AMDST05+AMDST06,TAXDEPN
          ASSIGN  TAXDEPN+AMDST07+AMDST08+AMDST09,TAXDEPN
          ASSIGN  TAXDEPN+AMDST10+AMDST11+AMDST12+AMDST13,TAXDEPN
.
          ASSIGN  AMDSA01+AMDSA02+AMDSA03,ACCDEPN
          ASSIGN  ACCDEPN+AMDSA04+AMDSA05+AMDSA06,ACCDEPN
          ASSIGN  ACCDEPN+AMDSA07+AMDSA08+AMDSA09,ACCDEPN
          ASSIGN  ACCDEPN+AMDSA10+AMDSA11+AMDSA12+AMDSA13,ACCDEPN
.
          MATCH   AMDSYEAR,CFAMYEAR
          IF      @EQUAL
            MOVE    AMMARVT,TOTALRVT
            MOVE    AMMAAAD,TOTALAAD
            MOVE    AMMATAD,TOTALTAD
            MOVE    AMMATDT,DISPTDT
            MOVE    AMMAADT,DISPADT
          ELSE
            MOVE    AMDSRVT,TOTALRVT
            MOVE    AMDSAAD,TOTALAAD
            MOVE    AMDSTAD,TOTALTAD
            MOVE    AMDSTDT,DISPTDT
            MOVE    AMDSADT,DISPADT
          ENDIF
.
          MOVE    SP70,DESCTDT
          MOVE    SP70,DESCADT
          MOVE    DISPTDT,KEY4
          CALL    RDAMDE1
          IF      OVRCD=0
            MOVE    AMDEDES,DESCTDT
          ENDIF
.
          MOVE    DISPADT,KEY4
          CALL    RDAMDE1
          IF      OVRCD=0
            MOVE    AMDEDES,DESCADT
          ENDIF
.
          ASSIGN  AMMACST+TOTALRVT,PRIMECST
          ASSIGN  PRIMECST-TOTALTAD,TAXOPEN
          ASSIGN  PRIMECST-TOTALAAD,ACCOPEN
          ASSIGN  TAXOPEN-TAXDEPN,TAXCLOSE
          ASSIGN  ACCOPEN-ACCDEPN,ACCCLOSE
.
EYEAR999  RETURN
.
SELREV00  CALL    RDAMRV1
          MOVE    "RT",AMCDCAT
          PACK    KEY5,AMCDCAT,AMRVRTY
          CALL    RDAMCD1
          MOVE    AMCDDES,RTYDESC
.
          CALL    SCRDL000
.
          RETURN
SELTRN00  CALL    RDAMTR1
.
          PACK    KEY2,AMTRDLED
          CALL    RDFMLA1
          PACK    KEY14,AMTRDLED,AMTRDACC
          CALL    RDFMAM1
          MOVE    FMAMDESC,DRDESC
          PACK    KEY14,AMTRDLED,AMTRCACC
          CALL    RDFMAM1
          CALL    SCTDL000
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSACMIO/INC
          INC       AMSCODIO/INC
          INC       AMSDEPIO/INC
          INC       AMSDPHIO/INC
          INC       AMSDSFIO/INC
          INC       AMSDSFKY    
          INC       AMSGILIO/INC
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSLOHIO/INC
          INC       AMSMASIO/INC
          INC       AMSMASKY    
          INC       AMSREGIO/INC
          INC       AMSREGKY    
          INC       AMSRVAIO/INC
          INC       AMSSTMIO/INC
          INC       AMSSTPIO/INC
          INC       AMSTRNIO/INC
          INC       APSMASIO/INC
          INC       FMSAMAIO/INC
          INC       FMSLMAIO/INC
          INC       IBAPASIO/INC
.
          INC       STDGENCD
.
