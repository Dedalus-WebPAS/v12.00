.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  18/04/2005  Mike Laming   CAR 13293
.           Add Print option to Option 6 - Search by Doc/Cheque
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           17.11.1999 Sandra Barcham
.           Allow Cancelled direct debits
.           srf 635048
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
COMMAND   DIM       50
DIM16     DIM       16
.-------------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS22
.   Function      :   Creditor Enquiries                      
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCIOFD/INC
          INC       APSCNTFD/INC
          INC       APSCTSFD/INC
          INC       APSIMSFD/INC
          INC       APSINPFD/INC
          INC       APSISLFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSORDFD/INC
          INC       APSPPDFD/INC
          INC       APSSNTFD/INC
          INC       APSTMPDF    
          INC       FMSAMAFD/INC
          INC       FMSCODFD/INC
          INC       FMSDISFD/INC
          INC       FMSLMAFD/INC
          INC       FMSRESFD/INC
          INC       SINPOCFD/INC
.=========================
.Local Variable Definition
.-------------------------
CRDNAM80  DIM      80 * Scr 00 Fld    47
CRDADD80  DIM      80 * Scr 00 Fld    48
AMTWRK00  FORM     12.2 * Scr 00 Fld    49
OFFSDESC  DIM      20 * Scr 00 Fld    57
AMTOUT00  FORM     12.2 * Scr 00 Fld    58
AMTOUT30  FORM     12.2 * Scr 00 Fld    59
AMTOUT60  FORM     12.2 * Scr 00 Fld    60
AMTOUT90  FORM     12.2 * Scr 00 Fld    61
AMTOUT99  FORM     12.2 * Scr 00 Fld    62
UDDESC1   DIM      20 * Scr 00 Fld    63
UDDESC2   DIM      20 * Scr 00 Fld    64
CURJDAY   FORM      3 * Scr 00 Fld    65
CURJYEAR  FORM      4 * Scr 00 Fld    66
WRKJDAY   FORM      3 * Scr 00 Fld    67
WRKJYEAR  FORM      4 * Scr 00 Fld    68
SUPNAM80  DIM      80 * Scr 00 Fld    69
SUPADD80  DIM      80 * Scr 00 Fld    70
INCOSTYP  FORM      1 * Scr 00 Fld    83
.
.Word Processor File * Scr 01 Fld    71
.
NAMAPCN1  INIT      "Wapcn1"
FILAPCN1  DIM       8
.
.
.Word Processor File * Scr 01 Fld    72
.
NAMAPSN1  INIT      "Wapsn1"
FILAPSN1  DIM       8
.
NZBANKAC  DIM      16 * Scr 01 Fld    83
PMETDES   DIM      30 * Scr 01 Fld    84
.
.    Multi Item Key Fields Scr 04 Fld    73
.-------------------------------------------------------
APIM2NAM  INIT      "APIM2"
APIM2END  FORM      1   * End Display
APIM2SNO  FORM      5   * Number of Items on the Screen
APIM2MKY  DIM       127 * Match Key 
APIM2EKY  DIM       127 * End Key
APIM2SKY  DIM       127 * Start Key
APIM2IDX  INIT      " 132 UC1-5"
APIM2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM2FNM  DIM       8  * Filename
APIM2CNT  FORM      3  * Number of Items on Screen
DOCTYPE   DIM       4 * Scr 04 Fld    76
DOCTOTAL  FORM     12.2 * Scr 04 Fld    78
INVREFER  DIM      15 * Scr 05 Fld    73
.
.    Multi Item Key Fields Scr 05 Fld    74
.-------------------------------------------------------
APIM3NAM  INIT      "APIM3"
APIM3END  FORM      1   * End Display
APIM3SNO  FORM      5   * Number of Items on the Screen
APIM3MKY  DIM       127 * Match Key 
APIM3EKY  DIM       127 * End Key
APIM3SKY  DIM       127 * Start Key
APIM3IDX  INIT      " 132 UC1-5"
APIM3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM3FNM  DIM       8  * Filename
APIM3CNT  FORM      3  * Number of Items on Screen
SCRTOTAL  FORM     12.2 * Scr 05 Fld    88
TOTALINV  FORM     12.2 * Scr 05 Fld    89
CHEQUEYN  FORM      1 * Scr 06 Fld    73
DOCREFER  DIM      15 * Scr 06 Fld    74
.
.    Multi Item Key Fields Scr 06 Fld    75
.-------------------------------------------------------
APIM4NAM  INIT      "APIM4"
APIM4END  FORM      1   * End Display
APIM4SNO  FORM      5   * Number of Items on the Screen
APIM4MKY  DIM       127 * Match Key 
APIM4EKY  DIM       127 * End Key
APIM4SKY  DIM       127 * Start Key
APIM4IDX  INIT      " 132 UC1-5"
APIM4FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM4FNM  DIM       8  * Filename
APIM4CNT  FORM      3  * Number of Items on Screen
ORDERFF   FORM      7 * Scr 07 Fld    36
ORDERNO   DIM       8 * Scr 07 Fld    73
.
.    Multi Item Key Fields Scr 07 Fld    74
.-------------------------------------------------------
APIN2NAM  INIT      "APIN2"
APIN2END  FORM      1   * End Display
APIN2SNO  FORM      5   * Number of Items on the Screen
APIN2MKY  DIM       127 * Match Key 
APIN2EKY  DIM       127 * End Key
APIN2SKY  DIM       127 * Start Key
APIN2IDX  INIT      " 132 UC1-5"
APIN2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIN2FNM  DIM       8  * Filename
APIN2CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 08 Fld    73
.-------------------------------------------------------
APIM6NAM  INIT      "APIM6"
APIM6END  FORM      1   * End Display
APIM6SNO  FORM      5   * Number of Items on the Screen
APIM6MKY  DIM       127 * Match Key 
APIM6EKY  DIM       127 * End Key
APIM6SKY  DIM       127 * Start Key
APIM6IDX  INIT      " 132 UC1-5"
APIM6FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM6FNM  DIM       8  * Filename
APIM6CNT  FORM      3  * Number of Items on Screen
OUTSTTOT  FORM     12.2 * Scr 08 Fld    78
.
.    Multi Item Key Fields Scr 09 Fld    73
.-------------------------------------------------------
APCI2NAM  INIT      "APCI2"
APCI2END  FORM      1   * End Display
APCI2SNO  FORM      5   * Number of Items on the Screen
APCI2MKY  DIM       127 * Match Key 
APCI2EKY  DIM       127 * End Key
APCI2SKY  DIM       127 * Start Key
APCI2IDX  INIT      " 132 UC1-5"
APCI2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APCI2FNM  DIM       8  * Filename
APCI2CNT  FORM      3  * Number of Items on Screen
ORDTOTAL  FORM     12.2 * Scr 09 Fld    77
ORDSTAT   DIM       6 * Scr 09 Fld    83
TRNTERM   DIM      35 * Scr 11 Fld    98
TRNOUTS   FORM     12.2 * Scr 11 Fld    99
TRNTYPE   DIM      18 * Scr 11 Fld   100
.
.    Multi Item Key Fields Scr 11 Fld   101
.-------------------------------------------------------
APIN1NAM  INIT      "APIN1"
APIN1END  FORM      1   * End Display
APIN1SNO  FORM      5   * Number of Items on the Screen
APIN1MKY  DIM       127 * Match Key 
APIN1EKY  DIM       127 * End Key
APIN1SKY  DIM       127 * Start Key
APIN1IDX  INIT      " 132 UC1-5"
APIN1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIN1FNM  DIM       8  * Filename
APIN1CNT  FORM      3  * Number of Items on Screen
DESCAPIN  DIM      70 * Scr 11 Fld   116
.
.    Multi Item Key Fields Scr 14 Fld     7
.-------------------------------------------------------
APOD1NAM  INIT      "APOD1"
APOD1END  FORM      1   * End Display
APOD1SNO  FORM      5   * Number of Items on the Screen
APOD1MKY  DIM       127 * Match Key 
APOD1EKY  DIM       127 * End Key
APOD1SKY  DIM       127 * Start Key
APOD1IDX  INIT      " 132 UC1-5"
APOD1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APOD1FNM  DIM       8  * Filename
APOD1CNT  FORM      3  * Number of Items on Screen
CATALOG   DIM       7 * Scr 14 Fld     7
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS22"
PRGNAM    INIT      "Creditor Enquiries                      "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APIM2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APIM3FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APIM4FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APIN2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APIM6FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APCI2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APIN1FL1,DELETE
.
          CALL      KILL0000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apscioaf";
          OPEN      APSCIOA1,"apscioaf"
          DISPLAY   *P56:24,"Opening apscioaf";
          OPEN      APSCIOA2,"apscioaf"
          DISPLAY   *P56:24,"Opening apscntaf";
          OPEN      APSCNTA1,"apscntaf"
          DISPLAY   *P56:24,"Opening apsctsaf";
          OPEN      APSCTSA1,"apsctsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA1,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA2,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA3,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA4,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA5,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA6,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsinpaf";
          OPEN      APSINPA1,"apsinpaf"
          DISPLAY   *P56:24,"Opening apsinpaf";
          OPEN      APSINPA2,"apsinpaf"
          DISPLAY   *P56:24,"Opening apsislaf";
          OPEN      APSISLA1,"apsislaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsordaf";
          OPEN      APSORDA1,"apsordaf"
          DISPLAY   *P56:24,"Opening apsppdaf";
          OPEN      APSPPDA1,"apsppdaf"
          DISPLAY   *P56:24,"Opening apssntaf";
          OPEN      APSSNTA1,"apssntaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening  fmscodaf           ";
          OPEN      FMSCODA1,"fmscodaf"          
          DISPLAY   *P56:24,"Opening fmsdisaf";
          OPEN      FMSDISA1,"fmsdisaf"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening fmsresaf";
          OPEN      FMSRESA1,"fmsresaf"
.--------------------------------------------------------
. Initialise Wp Filename for Creditor Notes                     
.--------------------------------------------------------
          PACK      FILAPCN1,NAMAPCN1,PORT
          REP       " 0",FILAPCN1
          DISPLAY   *P56:24,"Create & Open ",FILAPCN1;
          PREP      TEMPWORD,FILAPCN1
.
.--------------------------------------------------------
. Initialise Wp Filename for Supplier Notes                     
.--------------------------------------------------------
          PACK      FILAPSN1,NAMAPSN1,PORT
          REP       " 0",FILAPSN1
          DISPLAY   *P56:24,"Create & Open ",FILAPSN1;
          PREP      TEMPWORD,FILAPSN1
.
.--------------------------------------------------------
. Initialise Batch Screen Invoice Date                       
.--------------------------------------------------------
          MOVE     ZERO,APIM2SNO
          MOVE     "04   73",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM2SNO
            ENDIF
          ENDIF
          PACK      APIM2FNM,ANST,APIM2NAM,PORT
          REP       " 0",APIM2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APIM2FL1,APIM2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APIM2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APIM2FNM,APIM2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APIM2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APIM2FL1,APIM2FNM
.--------------------------------------------------------
. Initialise Batch Screen Document Reference                 
.--------------------------------------------------------
          MOVE     ZERO,APIM3SNO
          MOVE     "05   74",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM3SNO
            ENDIF
          ENDIF
          PACK      APIM3FNM,ANST,APIM3NAM,PORT
          REP       " 0",APIM3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APIM3FL1,APIM3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APIM3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APIM3FNM,APIM3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APIM3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APIM3FL1,APIM3FNM
.--------------------------------------------------------
. Initialise Batch Screen Invoice Reference                  
.--------------------------------------------------------
          MOVE     ZERO,APIM4SNO
          MOVE     "06   75",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM4SNO
            ENDIF
          ENDIF
          PACK      APIM4FNM,ANST,APIM4NAM,PORT
          REP       " 0",APIM4FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APIM4FL1,APIM4FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APIM4FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APIM4FNM,APIM4IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APIM4FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APIM4FL1,APIM4FNM
.--------------------------------------------------------
. Initialise Batch Screen Invoice Reference                  
.--------------------------------------------------------
          MOVE     ZERO,APIN2SNO
          MOVE     "07   74",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIN2SNO
            ENDIF
          ENDIF
          PACK      APIN2FNM,ANST,APIN2NAM,PORT
          REP       " 0",APIN2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APIN2FL1,APIN2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APIN2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APIN2FNM,APIN2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APIN2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APIN2FL1,APIN2FNM
.--------------------------------------------------------
. Initialise Batch Screen Invoice Reference                  
.--------------------------------------------------------
          MOVE     ZERO,APIM6SNO
          MOVE     "08   73",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM6SNO
            ENDIF
          ENDIF
          PACK      APIM6FNM,ANST,APIM6NAM,PORT
          REP       " 0",APIM6FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APIM6FL1,APIM6FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APIM6FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APIM6FNM,APIM6IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APIM6FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APIM6FL1,APIM6FNM
.--------------------------------------------------------
. Initialise Batch Screen Date Order Received                
.--------------------------------------------------------
          MOVE     ZERO,APCI2SNO
          MOVE     "09   73",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APCI2SNO
            ENDIF
          ENDIF
          PACK      APCI2FNM,ANST,APCI2NAM,PORT
          REP       " 0",APCI2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APCI2FL1,APCI2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APCI2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APCI2FNM,APCI2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APCI2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APCI2FL1,APCI2FNM
.--------------------------------------------------------
. Initialise Batch Screen Order Number                       
.--------------------------------------------------------
          MOVE     ZERO,APIN1SNO
          MOVE     "11  101",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIN1SNO
            ENDIF
          ENDIF
          PACK      APIN1FNM,ANST,APIN1NAM,PORT
          REP       " 0",APIN1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APIN1FL1,APIN1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APIN1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APIN1FNM,APIN1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APIN1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APIN1FL1,APIN1FNM
.--------------------------------------------------------
. Initialise Batch Screen Catalog Code                       
.--------------------------------------------------------
          MOVE     ZERO,APOD1SNO
          MOVE     "14    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APOD1SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Input Creditor Code                
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Static Details Screen 1            
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Static Details Screen 2            
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Creditor Financial Summary         
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Transaction Details                
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Search by Invoice                  
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Search by Doc. Ref or Cheque No.   
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Search by Order                    
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Display Outstanding Details        
          ENDIF
          MATCH     "09",SCRID
          IF         @EQUAL
            CALL       PS09L000   * Order Received Not Invoiced        
          ENDIF
          MATCH     "11",SCRID
          IF         @EQUAL
            CALL       PS11L000   * Transaction Allocation Display     
          ENDIF
          MATCH     "12",SCRID
          IF         @EQUAL
            CALL       PS12L000   * Allocation Detail Non Inventory    
          ENDIF
          MATCH     "14",SCRID
          IF         @EQUAL
            CALL       PS14L000   * Order Details                      
          ENDIF
          MATCH     "15",SCRID
          IF         @EQUAL
            CALL       PS15L000   * Transaction Details (New Inventory)
          ENDIF
          RETURN
.--------------------------------
. Screen - Input Creditor Code                
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      CONTROLF
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Input Creditor Code                
.-------------------------------------------------------
CF00L000
          MOVE      SP70,APMACRD 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Input Creditor Code                
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECRED000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Input Creditor Code                
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Input Creditor Code                
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Input Creditor Code                
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Input Creditor Code                
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L124,PS00L125,PS00L126,PS00L127:
                            PS00L128,PS00L129,PS00L130,PS00L131:
                            PS00L132,PS00L133,PS00L134,PS00L135:
                            PS00L136,PS00L137,PS00L138,PS00L139:
                            PS00L140,PS00L141,PS00L142,PS00L143:
                            PS00L144,PS00L145,PS00L146,PS00L147:
                            PS00L148,PS00L149,PS00L150,PS00L151:
                            PS00L152,PS00L153,PS00L154,PS00L155:
                            PS00L156,PS00L157,PS00L158,PS00L159:
                            PS00L160,PS00L161,PS00L162,PS00L163:
                            PS00L164,PS00L165,PS00L166,PS00L167:
                            PS00L168,PS00L169,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L170
          GOTO     PS00L999
.
PS00L101
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      APMADTM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L170
          MOVE      INCOSTYP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Input Creditor Code                
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L101,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L006:
                            SF00L110,SF00L111,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC04L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC05L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC08L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC07L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC09L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Static Details Screen 1            
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Static Details Screen 1            
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Static Details Screen 1            
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Static Details Screen 1            
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP01L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP01L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP01L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L110
WP01L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Static Details Screen 1            
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Static Details Screen 1            
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Static Details Screen 1            
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L127,PS01L128:
                            PS01L129,PS01L130,PS01L131,PS01L132:
                            PS01L133,PS01L134,PS01L135,PS01L999:
                           PS01L136,PS01L137,PS01L138,PS01L139:
                            PS01L140,PS01L141,PS01L142,PS01L143:
                            PS01L144,PS01L145,PS01L146,PS01L147:
                            PS01L148,PS01L149,PS01L150,PS01L151:
                            PS01L152,PS01L153,PS01L154,PS01L155:
                            PS01L156,PS01L157,PS01L158,PS01L159:
                            PS01L160,PS01L161,PS01L162,PS01L163:
                            PS01L164,PS01L165,PS01L166,PS01L167:
                            PS01L168,PS01L169,PS01L170,PS01L171:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L172,PS01L173,PS01L174,PS01L175:
                            PS01L176
          GOTO     PS01L999
.
PS01L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L172
          MOVE      APMATSE,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L173
          MOVE      APMAGMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L174
          MOVE      NZBANKAC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L175
          MOVE      PMETDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L176
          MOVE      APMAABN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Static Details Screen 1            
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L101,SF01L102:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L103,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L101,SF01L102:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 4",SCPSROW
              MOVE     "  4",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "17",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L103
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Static Details Screen 2            
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Static Details Screen 2            
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Static Details Screen 2            
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Static Details Screen 2            
.---------------------------------------------------------
WP02L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP02L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP02L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP02L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP02L100
WP02L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP02L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP02L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP02L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP02L110
WP02L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Static Details Screen 2            
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Static Details Screen 2            
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Static Details Screen 2            
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117,PS02L118,PS02L119,PS02L120:
                            PS02L121,PS02L122,PS02L123,PS02L124:
                            PS02L125,PS02L126,PS02L127,PS02L128:
                            PS02L129,PS02L130,PS02L131,PS02L132:
                            PS02L133,PS02L134,PS02L135,PS02L999:
                           PS02L136,PS02L137,PS02L138,PS02L139:
                            PS02L140,PS02L141,PS02L142,PS02L143:
                            PS02L144,PS02L145,PS02L146,PS02L147:
                            PS02L148,PS02L149,PS02L150,PS02L151:
                            PS02L152,PS02L153,PS02L154,PS02L155:
                            PS02L156,PS02L157,PS02L158,PS02L159:
                            PS02L160,PS02L161,PS02L162,PS02L163:
                            PS02L164,PS02L165,PS02L166,PS02L167:
                            PS02L168,PS02L169,PS02L170,PS02L171:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS02L999
.
PS02L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Static Details Screen 2            
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L101,SF02L102:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L103,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L101,SF02L102:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF02L001
.
SF02L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF02L001
.
SF02L103
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Creditor Financial Summary         
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Creditor Financial Summary         
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Creditor Financial Summary         
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Creditor Financial Summary         
.---------------------------------------------------------
WP03L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP03L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP03L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP03L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L100
WP03L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP03L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP03L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP03L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L110
WP03L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Creditor Financial Summary         
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Creditor Financial Summary         
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Creditor Financial Summary         
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L106,PS03L107,PS03L108:
                            PS03L109,PS03L110,PS03L111,PS03L112:
                            PS03L113,PS03L114,PS03L115,PS03L116:
                            PS03L117,PS03L118,PS03L119,PS03L120:
                            PS03L121,PS03L122,PS03L123,PS03L124:
                            PS03L125,PS03L126,PS03L127,PS03L128:
                            PS03L129,PS03L130,PS03L131,PS03L132:
                            PS03L133,PS03L134,PS03L135,PS03L999:
                           PS03L136,PS03L137,PS03L138,PS03L139:
                            PS03L140,PS03L141,PS03L142,PS03L143:
                            PS03L144,PS03L145,PS03L146,PS03L147:
                            PS03L148,PS03L149,PS03L150,PS03L151:
                            PS03L152,PS03L153,PS03L154,PS03L155:
                            PS03L156,PS03L157,PS03L158,PS03L159:
                            PS03L160,PS03L161,PS03L162,PS03L163:
                            PS03L164,PS03L165,PS03L166,PS03L167:
                            PS03L168,PS03L169,PS03L170,PS03L171:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
.
PS03L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Creditor Financial Summary         
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L101,SF03L102:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L103,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L101,SF03L102:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L103
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Transaction Details                
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transaction Details                
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transaction Details                
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transaction Details                
.---------------------------------------------------------
WP04L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP04L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP04L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP04L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L100
WP04L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP04L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP04L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP04L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L110
WP04L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transaction Details                
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :    73 Invoice Date                       
.---------------------------------------------------------
          UNPACK    SP70,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH
          PACK      KEY48,APMACRD,SP70
          MOVE      KEY48,APIM2EKY
          STRIP     APIM2SKY
          SETLPTR   APIM2EKY,5
          MOVE      APIM2EKY,APIM2SKY
          CALL      RDAPIM2 
          IF        OVRCD=0
            CALL      RPAPIM2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,APIM2CNT
          MOVE     ZERO,APIM2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L101,DP04L102,DP04L103,DP04L104:
                            DP04L105,DP04L106,DP04L107,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          PACK      APIM2MKY,SP70,SP70
          CALL      UPTAPIM2
          IF        APIM2END=0
            CALL      RPAPIM2 
            IF        OVRCD=0
              PACK      APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
              MATCH     APIM2EKY,APIM2MKY
              IF        @EQUAL
                MOVE      ZERO,APIM2END
                ADD       ONE,APIM2CNT
                CALL      UPTAPIM2
                UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM2END
              ENDIF
            ELSE
              MOVE      ONE,APIM2END
            ENDIF
          ENDIF
          IF        APIM2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        APIM2END=0
            MOVE      APIMREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        APIM2END=0
            MOVE      APIMDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        APIM2END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        APIM2END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        APIM2END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        APIM2END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "APIM2",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "APIM2",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY48,APIM2SKY,Z70
          CALL     RDAPIM2  * Start
          IF       OVRCD=0
            CALL     RPAPIM2  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "APIM2",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY48,APIM2SKY,SP70
          CALL     RSAPIM2  * End
          IF       OVRCD=1
            CALL     RKAPIM2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM2SNO
            CALL     RKAPIM2 
            IF       OVRCD=1
              MOVE     APIM2SNO,SECTOR
            ENDIF
            PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM2EKY,APIM2MKY
            IF       !@EQUAL
              MOVE     APIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "APIM2",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          CALL      RFTAPIM2
          BRANCH   OVRCD,PP04L115
          MOVE      APIM2MKY,KEY48 
          CALL      RSAPIM2 
PP04L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APIM2SNO
            CALL     RKAPIM2 
            IF       OVRCD=1
              MOVE     APIM2SNO,SECTOR
            ENDIF
            PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM2EKY,APIM2MKY
            IF       !@EQUAL
              MOVE     APIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM2SNO
            CALL     RPAPIM2 
            IF       OVRCD=1
              MOVE     APIM2SNO,SECTOR
            ENDIF
            PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM2EKY,APIM2MKY
            IF       !@EQUAL
              MOVE     APIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "APIM2",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RPAPIM2 
          BRANCH   OVRCD,NP04L110
          PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
          MATCH    APIM2EKY,APIM2MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RKAPIM2 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RKAPIM2 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Transaction Details                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    73 Invoice Date                       
.---------------------------------------------------------
UPTAPIM2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM2FL1,KEY5;ANS
          IF        @OVER
            WRITE     APIM2FL1,KEY5;SCPSROW,SCPSCOL,APIM2MKY
          ELSE
            UPDATE    APIM2FL1;SCPSROW,SCPSCOL,APIM2MKY
          ENDIF
          RETURN
RDTAPIM2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM2FL1,KEY5;SCPSROW,SCPSCOL,APIM2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPIM2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APIM2FL1,KEY5;;
          READKS    APIM2FL1;SCPSROW,SCPSCOL,APIM2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APIM2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Transaction Details                
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "APIM2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transaction Details                
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L101,PS04L102,PS04L103,PS04L104:
                            PS04L105,PS04L106,PS04L107,PS04L108:
                            PS04L109,PS04L110,PS04L111,PS04L112:
                            PS04L113,PS04L114,PS04L115,PS04L116:
                            PS04L117,PS04L118,PS04L119,PS04L120:
                            PS04L121,PS04L122,PS04L123,PS04L124:
                            PS04L125,PS04L126,PS04L127,PS04L128:
                            PS04L129,PS04L130,PS04L131,PS04L132:
                            PS04L133,PS04L134,PS04L135,PS04L999:
                           PS04L136,PS04L137,PS04L138,PS04L139:
                            PS04L140,PS04L141,PS04L142,PS04L143:
                            PS04L144,PS04L145,PS04L146,PS04L147:
                            PS04L148,PS04L149,PS04L150,PS04L151:
                            PS04L152,PS04L153,PS04L154,PS04L155:
                            PS04L156,PS04L157,PS04L158,PS04L159:
                            PS04L160,PS04L161,PS04L162,PS04L163:
                            PS04L164,PS04L165,PS04L166,PS04L167:
                            PS04L168,PS04L169,PS04L170,PS04L171:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
.
PS04L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Transaction Details                
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L101,SF04L102:
                            SF04L103,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L104,SF04L105,SF04L006,SF04L006:
                           SF04L106,SF04L107,SF04L108,SF04L109
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L101,SF04L102:
                            SF04L103,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L103
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          COMPARE   ONE,ACCEPT
          GOTO      SF04L001 IF EQUAL
          CALL      RDTAPIM2
          IF        OVRCD=1
            BEEP
            GOTO      SF04L001
          ENDIF
          MATCH     SP70,APIM2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF04L001
          ENDIF
          MOVE      APIM2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      DTRN0000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPIM2
          IF        OVRCD=1
            CALL      FP04L000
          ELSE
            MOVE      APIM2MKY,KEY48 
            CALL      RSAPIM2 
            CALL      RKAPIM2 
            CALL      DP04L000
          ENDIF
          GOTO     SF04L001
.
SF04L104
          MOVE      "APIM2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "APIM2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "APIM2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L107
          MOVE      "APIM2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
.
SF04L108
          CALL      KDATE000
          GOTO      SF04L001
.
SF04L109
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Search by Invoice                  
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Search by Invoice                  
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Search by Invoice                  
.--------------------------------------------------------
KY05L000
.
KY05L110
.
.
          MOVE      "   89",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTALINV
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      CLRREF00
          MOVE      "   73",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          STRIP     INVREFER
          SFORMAT   VAR,SCPSLEN
          MOVE      INVREFER,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,INVREFER
          SFORMAT   VAR,127
          ENDSET    INVREFER
          APPEND    SP70,INVREFER
          RESET     INVREFER
          MATCH     SP70,INVREFER
          GOTO      KY05L900 IF EQUAL
          CMATCH    EXITCHAR,INVREFER
          GOTO      KY05L900 IF EQUAL
          MOVE      OVRCD,ACCEPT
          CALL      GENINT00
          MOVE      INVREFER,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   89",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALINV,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Search by Invoice                  
.---------------------------------------------------------
WP05L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP05L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP05L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP05L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP05L100
WP05L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP05L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP05L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP05L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP05L110
WP05L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Search by Invoice                  
.---------------------------------------------------------
LM05L000
.---------------------------------------------------------
. Load for :    74 Document Reference                 
.---------------------------------------------------------
          UNPACK    SP70,APIMCRD,APIMREF,APIMDOC,APIMBCH
          PACK      KEY40,APMACRD,INVREFER,SP70
          MOVE      KEY40,APIM3EKY
          STRIP     APIM3SKY
          SETLPTR   APIM3EKY,20
          MOVE      APIM3EKY,APIM3SKY
          CALL      RDAPIM3 
          IF        OVRCD=0
            CALL      RPAPIM3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP05L000
          MOVE     ZERO,APIM3CNT
          MOVE     ZERO,APIM3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP05L600
          MATCH    PRGID,SCPSPID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP05L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                           DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L101,DP05L102,DP05L103:
                            DP05L104,DP05L105,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L106,DP05L107:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010
          GOTO      DP05L010
.
DP05L101
          PACK      APIM3MKY,SP70,SP70
          CALL      UPTAPIM3
          IF        APIM3END=0
            CALL      RKAPIM3 
            IF        OVRCD=0
              PACK      APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
              MATCH     APIM3EKY,APIM3MKY
              IF        @EQUAL
                MOVE      ZERO,APIM3END
                ADD       ONE,APIM3CNT
                CALL      UPTAPIM3
                MOVE      APIMDOC,VAR      
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM3END
              ENDIF
            ELSE
              MOVE      ONE,APIM3END
            ENDIF
          ENDIF
          IF        APIM3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L102
          IF        APIM3END=0
            UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L103
          IF        APIM3END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L104
          IF        APIM3END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L105
          IF        APIM3END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L106
          IF        APIM3END=0
            UNPACK    APIMTDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L107
          IF        APIM3END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
DP05L600
          MATCH    "APIM3",NAMSSFFI
          GOTO     DP05L605 IF NOT EQUAL
.
.
          MOVE      "   88",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCRTOTAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP05L999
DP05L605
DP05L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP05L000
.
          MATCH    "APIM3",NAMSSFFI
          GOTO     FP05L105 IF NOT EQUAL
          PACK     KEY40,APIM3SKY,SP70
          CALL     RDAPIM3  * Start
          IF       OVRCD=0
            CALL     RPAPIM3  * Start
          ENDIF
          CALL     DP05L000
          GOTO     FP05L999
FP05L105
FP05L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP05L000
.
          MATCH    "APIM3",NAMSSFFI
          GOTO     LP05L105 IF NOT EQUAL
          PACK     KEY40,APIM3SKY,Z70
          CALL     RSAPIM3  * End
          IF       OVRCD=1
            CALL     RPAPIM3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM3SNO
            CALL     RPAPIM3 
            IF       OVRCD=1
              MOVE     APIM3SNO,SECTOR
            ENDIF
            PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
            MATCH    APIM3EKY,APIM3MKY
            IF       !@EQUAL
              MOVE     APIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     LP05L999
LP05L105
LP05L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP05L000
.
          MATCH    "APIM3",NAMSSFFI
          GOTO     PP05L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP05L105
          CALL      RFTAPIM3
          BRANCH   OVRCD,PP05L115
          MOVE      APIM3MKY,KEY40 
          CALL      RSAPIM3 
PP05L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APIM3SNO
            CALL     RPAPIM3 
            IF       OVRCD=1
              MOVE     APIM3SNO,SECTOR
            ENDIF
            PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
            MATCH    APIM3EKY,APIM3MKY
            IF       !@EQUAL
              MOVE     APIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     PP05L999
PP05L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM3SNO
            CALL     RKAPIM3 
            IF       OVRCD=1
              MOVE     APIM3SNO,SECTOR
            ENDIF
            PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
            MATCH    APIM3EKY,APIM3MKY
            IF       !@EQUAL
              MOVE     APIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP05L999
PP05L120
PP05L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP05L000
          MATCH    "APIM3",NAMSSFFI
          GOTO     NP05L115 IF NOT EQUAL
NP05L105
          CALL     RKAPIM3 
          BRANCH   OVRCD,NP05L110
          PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
          MATCH    APIM3EKY,APIM3MKY
          GOTO     NP05L110 IF NOT EQUAL
          CALL     RPAPIM3 
          CALL     DP05L000
          GOTO     NP05L999
NP05L110
          CALL     RPAPIM3 
          BEEP
          GOTO     NP05L999
NP05L115
NP05L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT05L000
CT05L105
CT05L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Search by Invoice                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    74 Document Reference                 
.---------------------------------------------------------
UPTAPIM3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM3FL1,KEY5;ANS
          IF        @OVER
            WRITE     APIM3FL1,KEY5;SCPSROW,SCPSCOL,APIM3MKY
          ELSE
            UPDATE    APIM3FL1;SCPSROW,SCPSCOL,APIM3MKY
          ENDIF
          RETURN
RDTAPIM3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM3FL1,KEY5;SCPSROW,SCPSCOL,APIM3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPIM3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APIM3FL1,KEY5;;
          READKS    APIM3FL1;SCPSROW,SCPSCOL,APIM3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APIM3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Search by Invoice                  
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
          MOVE      "APIM3",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      FP05L000
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Search by Invoice                  
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L101,PS05L102,PS05L103,PS05L104:
                            PS05L105,PS05L106,PS05L107,PS05L108:
                            PS05L109,PS05L110,PS05L111,PS05L112:
                            PS05L113,PS05L114,PS05L115,PS05L116:
                            PS05L117,PS05L118,PS05L119,PS05L120:
                            PS05L121,PS05L122,PS05L123,PS05L124:
                            PS05L125,PS05L126,PS05L127,PS05L128:
                            PS05L129,PS05L130,PS05L131,PS05L132:
                            PS05L133,PS05L134,PS05L135,PS05L999:
                           PS05L136,PS05L137,PS05L138,PS05L139:
                            PS05L140,PS05L141,PS05L142,PS05L143:
                            PS05L144,PS05L145,PS05L146,PS05L147:
                            PS05L148,PS05L149,PS05L150,PS05L151:
                            PS05L152,PS05L153,PS05L154,PS05L155:
                            PS05L156,PS05L157,PS05L158,PS05L159:
                            PS05L160,PS05L161,PS05L162,PS05L163:
                            PS05L164,PS05L165,PS05L166,PS05L167:
                            PS05L168,PS05L169,PS05L170,PS05L171:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L172:
                            PS05L173
          GOTO     PS05L999
.
PS05L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS05L999
.
PS05L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS05L999
.
PS05L172
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L173
          MOVE      TOTALINV,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Search by Invoice                  
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L101,SF05L102:
                            SF05L006,SF05L103,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L104,SF05L006:
                            SF05L105,SF05L106,SF05L006,SF05L006:
                            SF05L107,SF05L108,SF05L109,SF05L006:
                            SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L101,SF05L102:
                            SF05L020,SF05L103,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM3",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF05L001
.
SF05L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF05L001
.
SF05L103
          CALL      SELECTED
          BRANCH    EXIT,SF05L001
          COMPARE   ONE,ACCEPT
          GOTO      SF05L001 IF EQUAL
          CALL      RDTAPIM3
          IF        OVRCD=1
            BEEP
            GOTO      SF05L001
          ENDIF
          MATCH     SP70,APIM3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF05L001
          ENDIF
          MOVE      APIM3MKY,KEY40 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      DTRN0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPIM3
          IF        OVRCD=1
            CALL      FP05L000
          ELSE
            MOVE      APIM3MKY,KEY40 
            CALL      RSAPIM3 
            CALL      RPAPIM3 
            CALL      DP05L000
          ENDIF
          GOTO     SF05L001
.
SF05L104
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L105
          MOVE      "APIM3",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      NP05L000
          GOTO     SF05L001
.
SF05L106
          MOVE      "APIM3",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      PP05L000
          GOTO     SF05L001
.
SF05L107
          MOVE      "APIM3",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L108
          MOVE      "APIM3",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      LP05L000
          GOTO     SF05L001
.
SF05L109
          MOVE      ONE,EXIT
          GOTO      SF05L999
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Search by Doc. Ref or Cheque No.   
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Search by Doc. Ref or Cheque No.   
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Search by Doc. Ref or Cheque No.   
.--------------------------------------------------------
KY06L000
.
KY06L110
          CALL      CLRREF00
          MOVE      "   73",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      YORN0000
          MOVE       FYESNO,CHEQUEYN
          MOVE      ZERO,ACCEPT
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CHEQUEYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
.
KY06L120
.
.
          MOVE      "   92",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTALINV
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   74",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDOCR000
          BRANCH    EXIT,KY06L110,KY06L900
          MOVE      ZERO,ACCEPT
          CALL      GENDOC00
          MOVE      DOCREFER,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   92",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALINV,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Search by Doc. Ref or Cheque No.   
.---------------------------------------------------------
WP06L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP06L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP06L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP06L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP06L100
WP06L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP06L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP06L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP06L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP06L110
WP06L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Search by Doc. Ref or Cheque No.   
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :    75 Invoice Reference                  
.---------------------------------------------------------
          UNPACK    SP70,APIMCRD,APIMDOC,APIMREF,APIMBCH
          PACK      KEY40,APMACRD,DOCREFER,SP70
          MOVE      KEY40,APIM4EKY
          STRIP     APIM4SKY
          SETLPTR   APIM4EKY,20
          MOVE      APIM4EKY,APIM4SKY
          CALL      RDAPIM4 
          IF        OVRCD=0
            CALL      RPAPIM4 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,APIM4CNT
          MOVE     ZERO,APIM4END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L101,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L102,DP06L103,DP06L104,DP06L105:
                            DP06L106,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010
          GOTO      DP06L010
.
DP06L101
          PACK      APIM4MKY,SP70,SP70
          CALL      UPTAPIM4
          IF        APIM4END=0
            CALL      RKAPIM4 
            IF        OVRCD=0
              PACK      APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
              MATCH     APIM4EKY,APIM4MKY
              IF        @EQUAL
                MOVE      ZERO,APIM4END
                ADD       ONE,APIM4CNT
                CALL      UPTAPIM4
                MOVE      APIMREF,VAR      
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM4END
              ENDIF
            ELSE
              MOVE      ONE,APIM4END
            ENDIF
          ENDIF
          IF        APIM4END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        APIM4END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        APIM4END=0
            UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        APIM4END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L105
          IF        APIM4END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L106
          IF        APIM4END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "APIM4",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
.
.
          MOVE      "   88",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCRTOTAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          MATCH    "APIM4",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          PACK     KEY40,APIM4SKY,SP70
          CALL     RDAPIM4  * Start
          IF       OVRCD=0
            CALL     RPAPIM4  * Start
          ENDIF
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          MATCH    "APIM4",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY40,APIM4SKY,Z70
          CALL     RSAPIM4  * End
          IF       OVRCD=1
            CALL     RPAPIM4 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM4SNO
            CALL     RPAPIM4 
            IF       OVRCD=1
              MOVE     APIM4SNO,SECTOR
            ENDIF
            PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
            MATCH    APIM4EKY,APIM4MKY
            IF       !@EQUAL
              MOVE     APIM4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
          MATCH    "APIM4",NAMSSFFI
          GOTO     PP06L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP06L105
          CALL      RFTAPIM4
          BRANCH   OVRCD,PP06L115
          MOVE      APIM4MKY,KEY40 
          CALL      RSAPIM4 
PP06L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APIM4SNO
            CALL     RPAPIM4 
            IF       OVRCD=1
              MOVE     APIM4SNO,SECTOR
            ENDIF
            PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
            MATCH    APIM4EKY,APIM4MKY
            IF       !@EQUAL
              MOVE     APIM4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM4SNO
            CALL     RKAPIM4 
            IF       OVRCD=1
              MOVE     APIM4SNO,SECTOR
            ENDIF
            PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
            MATCH    APIM4EKY,APIM4MKY
            IF       !@EQUAL
              MOVE     APIM4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP06L999
PP06L120
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "APIM4",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          CALL     RKAPIM4 
          BRANCH   OVRCD,NP06L110
          PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
          MATCH    APIM4EKY,APIM4MKY
          GOTO     NP06L110 IF NOT EQUAL
          CALL     RPAPIM4 
          CALL     DP06L000
          GOTO     NP06L999
NP06L110
          CALL     RPAPIM4 
          BEEP
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
CT06L105
CT06L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Search by Doc. Ref or Cheque No.   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    75 Invoice Reference                  
.---------------------------------------------------------
UPTAPIM4
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM4FL1,KEY5;ANS
          IF        @OVER
            WRITE     APIM4FL1,KEY5;SCPSROW,SCPSCOL,APIM4MKY
          ELSE
            UPDATE    APIM4FL1;SCPSROW,SCPSCOL,APIM4MKY
          ENDIF
          RETURN
RDTAPIM4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM4FL1,KEY5;SCPSROW,SCPSCOL,APIM4MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPIM4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APIM4FL1,KEY5;;
          READKS    APIM4FL1;SCPSROW,SCPSCOL,APIM4MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APIM4MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Search by Doc. Ref or Cheque No.   
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "APIM4",NAMSSFFI
          MOVE      "   75",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Search by Doc. Ref or Cheque No.   
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L101,PS06L102,PS06L103,PS06L104:
                            PS06L105,PS06L106,PS06L107,PS06L108:
                            PS06L109,PS06L110,PS06L111,PS06L112:
                            PS06L113,PS06L114,PS06L115,PS06L116:
                            PS06L117,PS06L118,PS06L119,PS06L120:
                            PS06L121,PS06L122,PS06L123,PS06L124:
                            PS06L125,PS06L126,PS06L127,PS06L128:
                            PS06L129,PS06L130,PS06L131,PS06L132:
                            PS06L133,PS06L134,PS06L135,PS06L999:
                           PS06L136,PS06L137,PS06L138,PS06L139:
                            PS06L140,PS06L141,PS06L142,PS06L143:
                            PS06L144,PS06L145,PS06L146,PS06L147:
                            PS06L148,PS06L149,PS06L150,PS06L151:
                            PS06L152,PS06L153,PS06L154,PS06L155:
                            PS06L156,PS06L157,PS06L158,PS06L159:
                            PS06L160,PS06L161,PS06L162,PS06L163:
                            PS06L164,PS06L165,PS06L166,PS06L167:
                            PS06L168,PS06L169,PS06L170,PS06L171:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L172:
                            PS06L999,PS06L999,PS06L999,PS06L173:
                            PS06L999
          GOTO     PS06L999
.
PS06L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS06L999
.
PS06L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS06L999
.
PS06L172
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L173
          MOVE      TOTALINV,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Search by Doc. Ref or Cheque No.   
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L101,SF06L102:
                            SF06L006,SF06L006,SF06L103,SF06L006:
                           SF06L006,SF06L006,SF06L104,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L105,SF06L106,SF06L006:
                            SF06L107,SF06L108,SF06L109,SF06L006:
                            SF06L110
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L101,SF06L102:
                            SF06L020,SF06L020,SF06L103,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM4",NAMSSFFI
          MOVE      "   75",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF06L001
.
SF06L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF06L001
.
SF06L103
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          COMPARE   ONE,ACCEPT
          GOTO      SF06L001 IF EQUAL
          CALL      RDTAPIM4
          IF        OVRCD=1
            BEEP
            GOTO      SF06L001
          ENDIF
          MATCH     SP70,APIM4MKY
          IF        @EQUAL
            BEEP
            GOTO      SF06L001
          ENDIF
          MOVE      APIM4MKY,KEY40 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      DTRN0000
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPIM4
          IF        OVRCD=1
            CALL      FP06L000
          ELSE
            MOVE      APIM4MKY,KEY40 
            CALL      RSAPIM4 
            CALL      RPAPIM4 
            CALL      DP06L000
          ENDIF
          GOTO     SF06L001
.
SF06L104
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L105
          MOVE      "APIM4",NAMSSFFI
          MOVE      "   75",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L106
          MOVE      "APIM4",NAMSSFFI
          MOVE      "   75",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L107
          MOVE      ONE,EXIT
          GOTO      SF06L999
.
SF06L108
          MOVE      "APIM4",NAMSSFFI
          MOVE      "   75",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L109
          MOVE      "APIM4",NAMSSFFI
          MOVE      "   75",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
.
SF06L110
          CALL      REPT0000
          GOTO      SF06L001
SF06L990  MOVE      ONE,EXIT * Exit Char Restart
SF06L999  RETURN
.--------------------------------
. Screen - Search by Order                    
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Search by Order                    
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Search by Order                    
.--------------------------------------------------------
KY07L000
.
KY07L110
.
.
          MOVE      "   91",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTALINV
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      CLRREF00
          MOVE      "   73",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EORDN000
          BRANCH    EXIT,KY07L900,KY07L900
          MOVE      ZERO,ACCEPT
          CALL      GENORD00
          MOVE      ORDERNO,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   91",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALINV,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Search by Order                    
.---------------------------------------------------------
WP07L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP07L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP07L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP07L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP07L100
WP07L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP07L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP07L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP07L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP07L110
WP07L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Search by Order                    
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :    74 Invoice Reference                  
.---------------------------------------------------------
          UNPACK    SP70,APINCRD,APINORD,APINREF,APINDOC,APINBCH,APINLIN
          PACK      KEY51,APMACRD,ORDERNO,SP70
          MOVE      KEY51,APIN2EKY
          STRIP     APIN2SKY
          SETLPTR   APIN2EKY,13
          MOVE      APIN2EKY,APIN2SKY
          CALL      RDAPIN2 
          IF        OVRCD=0
            CALL      RPAPIN2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,APIN2CNT
          MOVE     ZERO,APIN2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L101,DP07L102,DP07L103:
                            DP07L104,DP07L010,DP07L010,DP07L010:
                            DP07L105,DP07L106,DP07L107,DP07L108:
                            DP07L010,DP07L010,DP07L010,DP07L109:
                            DP07L010,DP07L010,DP07L010
          GOTO      DP07L010
.
DP07L101
          PACK      APIN2MKY,SP70,SP70
          CALL      UPTAPIN2
          IF        APIN2END=0
            CALL      RKAPIN2 
            IF        OVRCD=0
              PACK      APIN2MKY,APINCRD,APINORD,APINREF,APINDOC,APINBCH,APINLIN                                
              MATCH     APIN2EKY,APIN2MKY
              IF        @EQUAL
                MOVE      ZERO,APIN2END
                ADD       ONE,APIN2CNT
                CALL      UPTAPIN2
                MOVE      APINREF,VAR      
                CALL      DISPITEM
          CALL      MASDET00
              ELSE
                MOVE      ONE,APIN2END
              ENDIF
            ELSE
              MOVE      ONE,APIN2END
            ENDIF
          ENDIF
          IF        APIN2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        APIN2END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        APIN2END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        APIN2END=0
            MOVE      APINDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L105
          IF        APIN2END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L106
          IF        APIN2END=0
            MOVE      APINBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L107
          IF        APIN2END=0
            MOVE      APINCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L108
          IF        APIN2END=0
            MOVE      APINQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L109
          IF        APIN2END=0
            MOVE      APINUCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "APIN2",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
.
.
          MOVE      "   87",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCRTOTAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          MATCH    "APIN2",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          PACK     KEY51,APIN2SKY,SP70
          CALL     RDAPIN2  * Start
          IF       OVRCD=0
            CALL     RPAPIN2  * Start
          ENDIF
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          MATCH    "APIN2",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY51,APIN2SKY,Z70
          CALL     RSAPIN2  * End
          IF       OVRCD=1
            CALL     RPAPIN2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIN2SNO
            CALL     RPAPIN2 
            IF       OVRCD=1
              MOVE     APIN2SNO,SECTOR
            ENDIF
            PACK     APIN2MKY,APINCRD,APINORD,APINREF,APINDOC,APINBCH,APINLIN                                
            MATCH    APIN2EKY,APIN2MKY
            IF       !@EQUAL
              MOVE     APIN2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
          MATCH    "APIN2",NAMSSFFI
          GOTO     PP07L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP07L105
          CALL      RFTAPIN2
          BRANCH   OVRCD,PP07L115
          MOVE      APIN2MKY,KEY51 
          CALL      RSAPIN2 
PP07L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APIN2SNO
            CALL     RPAPIN2 
            IF       OVRCD=1
              MOVE     APIN2SNO,SECTOR
            ENDIF
            PACK     APIN2MKY,APINCRD,APINORD,APINREF,APINDOC,APINBCH,APINLIN                                
            MATCH    APIN2EKY,APIN2MKY
            IF       !@EQUAL
              MOVE     APIN2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIN2SNO
            CALL     RKAPIN2 
            IF       OVRCD=1
              MOVE     APIN2SNO,SECTOR
            ENDIF
            PACK     APIN2MKY,APINCRD,APINORD,APINREF,APINDOC,APINBCH,APINLIN                                
            MATCH    APIN2EKY,APIN2MKY
            IF       !@EQUAL
              MOVE     APIN2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP07L999
PP07L120
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "APIN2",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          CALL     RKAPIN2 
          BRANCH   OVRCD,NP07L110
          PACK     APIN2MKY,APINCRD,APINORD,APINREF,APINDOC,APINBCH,APINLIN                                
          MATCH    APIN2EKY,APIN2MKY
          GOTO     NP07L110 IF NOT EQUAL
          CALL     RPAPIN2 
          CALL     DP07L000
          GOTO     NP07L999
NP07L110
          CALL     RPAPIN2 
          BEEP
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
CT07L105
CT07L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Search by Order                    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    74 Invoice Reference                  
.---------------------------------------------------------
UPTAPIN2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIN2FL1,KEY5;ANS
          IF        @OVER
            WRITE     APIN2FL1,KEY5;SCPSROW,SCPSCOL,APIN2MKY
          ELSE
            UPDATE    APIN2FL1;SCPSROW,SCPSCOL,APIN2MKY
          ENDIF
          RETURN
RDTAPIN2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIN2FL1,KEY5;SCPSROW,SCPSCOL,APIN2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPIN2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APIN2FL1,KEY5;;
          READKS    APIN2FL1;SCPSROW,SCPSCOL,APIN2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APIN2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Search by Order                    
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "APIN2",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Search by Order                    
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L101,PS07L102,PS07L103,PS07L104:
                            PS07L105,PS07L106,PS07L107,PS07L108:
                            PS07L109,PS07L110,PS07L111,PS07L112:
                            PS07L113,PS07L114,PS07L115,PS07L116:
                            PS07L117,PS07L118,PS07L119,PS07L120:
                            PS07L121,PS07L122,PS07L123,PS07L124:
                            PS07L125,PS07L126,PS07L127,PS07L128:
                            PS07L129,PS07L130,PS07L131,PS07L132:
                            PS07L133,PS07L134,PS07L135,PS07L136:
                            PS07L137,PS07L138,PS07L139,PS07L140:
                            PS07L141,PS07L142,PS07L143,PS07L144:
                            PS07L145,PS07L146,PS07L147,PS07L148:
                            PS07L149,PS07L150,PS07L151,PS07L152:
                            PS07L153,PS07L154,PS07L155,PS07L156:
                            PS07L157,PS07L158,PS07L159,PS07L160:
                            PS07L161,PS07L162,PS07L163,PS07L164:
                            PS07L165,PS07L166,PS07L167,PS07L168:
                            PS07L169,PS07L170,PS07L171,PS07L172:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L173,PS07L999:
                            PS07L999,PS07L999,PS07L174
          GOTO     PS07L999
.
PS07L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L136
          MOVE      ORDERFF,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L137
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L138
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L139
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L140
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L141
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L142
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L145
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L146
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L147
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L148
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L149
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L150
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L151
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L152
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L153
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L154
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L155
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L156
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L157
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L158
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L159
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L160
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L161
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L162
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L163
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L164
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L165
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L166
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L167
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L168
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L169
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L170
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L171
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS07L999
.
PS07L172
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS07L999
.
PS07L173
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L174
          MOVE      TOTALINV,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Search by Order                    
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L101,SF07L102:
                            SF07L006,SF07L103,SF07L006,SF07L006:
                            SF07L006,SF07L104,SF07L105,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L106,SF07L107,SF07L006,SF07L006:
                            SF07L108,SF07L109,SF07L006
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L101,SF07L102:
                            SF07L020,SF07L103,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "APIN2",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF07L001
.
SF07L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF07L001
.
SF07L103
          CALL      SELECTED
          BRANCH    EXIT,SF07L001
          COMPARE   ONE,ACCEPT
          GOTO      SF07L001 IF EQUAL
          CALL      RDTAPIN2
          IF        OVRCD=1
            BEEP
            GOTO      SF07L001
          ENDIF
          MATCH     SP70,APIN2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF07L001
          ENDIF
          MOVE      APIN2MKY,KEY51 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      DTRN0000
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPIN2
          IF        OVRCD=1
            CALL      FP07L000
          ELSE
            MOVE      APIN2MKY,KEY51 
            CALL      RSAPIN2 
            CALL      RPAPIN2 
            CALL      DP07L000
          ENDIF
          GOTO     SF07L001
.
SF07L104
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L105
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L106
          MOVE      "APIN2",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L107
          MOVE      "APIN2",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L108
          MOVE      "APIN2",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L109
          MOVE      "APIN2",NAMSSFFI
          MOVE      "   74",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.--------------------------------
. Screen - Display Outstanding Details        
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC08L200
          CALL      CF08L000 * Clear Fields
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Display Outstanding Details        
.-------------------------------------------------------
CF08L000
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Display Outstanding Details        
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Display Outstanding Details        
.---------------------------------------------------------
WP08L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP08L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP08L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP08L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP08L100
WP08L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP08L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP08L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP08L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP08L110
WP08L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Display Outstanding Details        
.---------------------------------------------------------
LM08L000
.---------------------------------------------------------
. Load for :    73 Invoice Reference                  
.---------------------------------------------------------
          UNPACK    SP70,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH
          PACK      KEY41,ONE,APMACRD,SP70
          MOVE      KEY41,APIM6EKY
          STRIP     APIM6SKY
          SETLPTR   APIM6EKY,6
          MOVE      APIM6EKY,APIM6SKY
          CALL      RDAPIM6 
          IF        OVRCD=0
            CALL      RPAPIM6 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP08L000
          MOVE     ZERO,APIM6CNT
          MOVE     ZERO,APIM6END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP08L600
          MATCH    PRGID,SCPSPID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP08L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                           DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                            DP08L101,DP08L102,DP08L103,DP08L104:
                            DP08L105,DP08L106,DP08L010,DP08L010:
                            DP08L107,DP08L108,DP08L010,DP08L010:
                            DP08L109,DP08L110,DP08L010,DP08L010
          GOTO      DP08L010
.
DP08L101
          PACK      APIM6MKY,SP70,SP70
          CALL      UPTAPIM6
          IF        APIM6END=0
            CALL      RKAPIM6 
            IF        OVRCD=0
              PACK      APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
              MATCH     APIM6EKY,APIM6MKY
              IF        @EQUAL
                MOVE      ZERO,APIM6END
                ADD       ONE,APIM6CNT
                CALL      UPTAPIM6
                MOVE      APIMREF,VAR      
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM6END
              ENDIF
            ELSE
              MOVE      ONE,APIM6END
            ENDIF
          ENDIF
          IF        APIM6END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L102
          IF        APIM6END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L103
          IF        APIM6END=0
            MOVE      APIMDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L104
          IF        APIM6END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L105
          IF        APIM6END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L106
          IF        APIM6END=0
            MOVE      OUTSTTOT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L107
          IF        APIM6END=0
            UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L108
          IF        APIM6END=0
            MOVE      APIMICM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L109
          IF        APIM6END=0
            MOVE      APIMTER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L110
          IF        APIM6END=0
            UNPACK    APIMPDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
DP08L600
          MATCH    "APIM6",NAMSSFFI
          GOTO     DP08L605 IF NOT EQUAL
          GOTO     DP08L999
DP08L605
DP08L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP08L000
.
          MATCH    "APIM6",NAMSSFFI
          GOTO     FP08L105 IF NOT EQUAL
          PACK     KEY41,APIM6SKY,SP70
          CALL     RDAPIM6  * Start
          IF       OVRCD=0
            CALL     RPAPIM6  * Start
          ENDIF
          CALL     DP08L000
          GOTO     FP08L999
FP08L105
FP08L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP08L000
.
          MATCH    "APIM6",NAMSSFFI
          GOTO     LP08L105 IF NOT EQUAL
          PACK     KEY41,APIM6SKY,Z70
          CALL     RSAPIM6  * End
          IF       OVRCD=1
            CALL     RPAPIM6 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM6SNO
            CALL     RPAPIM6 
            IF       OVRCD=1
              MOVE     APIM6SNO,SECTOR
            ENDIF
            PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM6EKY,APIM6MKY
            IF       !@EQUAL
              MOVE     APIM6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     LP08L999
LP08L105
LP08L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP08L000
.
          MATCH    "APIM6",NAMSSFFI
          GOTO     PP08L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP08L105
          CALL      RFTAPIM6
          BRANCH   OVRCD,PP08L115
          MOVE      APIM6MKY,KEY41 
          CALL      RSAPIM6 
PP08L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APIM6SNO
            CALL     RPAPIM6 
            IF       OVRCD=1
              MOVE     APIM6SNO,SECTOR
            ENDIF
            PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM6EKY,APIM6MKY
            IF       !@EQUAL
              MOVE     APIM6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     PP08L999
PP08L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM6SNO
            CALL     RKAPIM6 
            IF       OVRCD=1
              MOVE     APIM6SNO,SECTOR
            ENDIF
            PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM6EKY,APIM6MKY
            IF       !@EQUAL
              MOVE     APIM6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP08L999
PP08L120
PP08L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP08L000
          MATCH    "APIM6",NAMSSFFI
          GOTO     NP08L115 IF NOT EQUAL
NP08L105
          CALL     RKAPIM6 
          BRANCH   OVRCD,NP08L110
          PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
          MATCH    APIM6EKY,APIM6MKY
          GOTO     NP08L110 IF NOT EQUAL
          CALL     RPAPIM6 
          CALL     DP08L000
          GOTO     NP08L999
NP08L110
          CALL     RPAPIM6 
          BEEP
          GOTO     NP08L999
NP08L115
NP08L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT08L000
CT08L105
CT08L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Display Outstanding Details        
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    73 Invoice Reference                  
.---------------------------------------------------------
UPTAPIM6
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM6FL1,KEY5;ANS
          IF        @OVER
            WRITE     APIM6FL1,KEY5;SCPSROW,SCPSCOL,APIM6MKY
          ELSE
            UPDATE    APIM6FL1;SCPSROW,SCPSCOL,APIM6MKY
          ENDIF
          RETURN
RDTAPIM6
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIM6FL1,KEY5;SCPSROW,SCPSCOL,APIM6MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPIM6
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APIM6FL1,KEY5;;
          READKS    APIM6FL1;SCPSROW,SCPSCOL,APIM6MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APIM6MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Display Outstanding Details        
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
          MOVE      "APIM6",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP08L000
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Display Outstanding Details        
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L101,PS08L102,PS08L103,PS08L104:
                            PS08L105,PS08L106,PS08L107,PS08L108:
                            PS08L109,PS08L110,PS08L111,PS08L112:
                            PS08L113,PS08L114,PS08L115,PS08L116:
                            PS08L117,PS08L118,PS08L119,PS08L120:
                            PS08L121,PS08L122,PS08L123,PS08L124:
                            PS08L125,PS08L126,PS08L127,PS08L128:
                            PS08L129,PS08L130,PS08L131,PS08L132:
                            PS08L133,PS08L134,PS08L135,PS08L999:
                           PS08L136,PS08L137,PS08L138,PS08L139:
                            PS08L140,PS08L141,PS08L142,PS08L143:
                            PS08L144,PS08L145,PS08L146,PS08L147:
                            PS08L148,PS08L149,PS08L150,PS08L151:
                            PS08L152,PS08L153,PS08L154,PS08L155:
                            PS08L156,PS08L157,PS08L158,PS08L159:
                            PS08L160,PS08L161,PS08L162,PS08L163:
                            PS08L164,PS08L165,PS08L166,PS08L167:
                            PS08L168,PS08L169,PS08L170,PS08L171:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999
          GOTO     PS08L999
.
PS08L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS08L999
.
PS08L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Display Outstanding Details        
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                           SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L101,SF08L102:
                            SF08L103,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L104,SF08L006:
                            SF08L006,SF08L006,SF08L105,SF08L106:
                            SF08L006,SF08L006,SF08L107,SF08L108
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                           SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L101,SF08L102:
                            SF08L103,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM6",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF08L001
.
SF08L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF08L001
.
SF08L103
          CALL      SELECTED
          BRANCH    EXIT,SF08L001
          COMPARE   ONE,ACCEPT
          GOTO      SF08L001 IF EQUAL
          CALL      RDTAPIM6
          IF        OVRCD=1
            BEEP
            GOTO      SF08L001
          ENDIF
          MATCH     SP70,APIM6MKY
          IF        @EQUAL
            BEEP
            GOTO      SF08L001
          ENDIF
          MOVE      APIM6MKY,KEY41 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      DTRN0000
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPIM6
          IF        OVRCD=1
            CALL      FP08L000
          ELSE
            MOVE      APIM6MKY,KEY41 
            CALL      RSAPIM6 
            CALL      RPAPIM6 
            CALL      DP08L000
          ENDIF
          GOTO     SF08L001
.
SF08L104
          MOVE      ZERO,EXIT
          GOTO      SF08L999
.
SF08L105
          MOVE      "APIM6",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      NP08L000
          GOTO     SF08L001
.
SF08L106
          MOVE      "APIM6",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      PP08L000
          GOTO     SF08L001
.
SF08L107
          MOVE      "APIM6",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L108
          MOVE      "APIM6",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      LP08L000
          GOTO     SF08L001
SF08L990  MOVE      ONE,EXIT * Exit Char Restart
SF08L999  RETURN
.--------------------------------
. Screen - Order Received Not Invoiced        
.--------------------------------
SC09L000
SC09L100
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC09L200
          CALL      CF09L000 * Clear Fields
          CALL      CLEARF00
SC09L300
          CALL      KY09L000 * Enter Key Fields
          BRANCH    EXIT,SC09L999,SC09L999
SC09L400
          CALL      WP09L000 * Load any WP Details
SC09L500
          CALL      LM09L000 * Load any Batch Details
SC09L600
          CALL      DF09L000 * Display Fields
SC09L700
          CALL      SF09L000 * Select Fields
          BRANCH    EXIT,SC09L100,SC09L100,SC09L200
SC09L800
SC09L900
SC09L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Order Received Not Invoiced        
.-------------------------------------------------------
CF09L000
CF09L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Order Received Not Invoiced        
.--------------------------------------------------------
KY09L000
          MOVE      ZERO,EXIT
          GOTO      KY09L999
.
KY09L900  MOVE      ONE,EXIT
KY09L999  RETURN
.---------------------------------------------------------
. Load WP files for : Order Received Not Invoiced        
.---------------------------------------------------------
WP09L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP09L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP09L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP09L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP09L100
WP09L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP09L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP09L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP09L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP09L110
WP09L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Order Received Not Invoiced        
.---------------------------------------------------------
LM09L000
.---------------------------------------------------------
. Load for :    73 Date Order Received                
.---------------------------------------------------------
          UNPACK    SP70,APCICRD,APCIDAT,APCIISC,APCIORD
          PACK      KEY21,APMACRD,SP70
          MOVE      KEY21,APCI2EKY
          STRIP     APCI2SKY
          SETLPTR   APCI2EKY,5
          MOVE      APCI2EKY,APCI2SKY
          CALL      RDAPCI2 
          IF        OVRCD=0
            CALL      RPAPCI2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP09L000
          MOVE     ZERO,APCI2CNT
          MOVE     ZERO,APCI2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP09L600
          MATCH    PRGID,SCPSPID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP09L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                           DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L010,DP09L010:
                            DP09L101,DP09L102,DP09L103,DP09L104:
                            DP09L105,DP09L010,DP09L010,DP09L010:
                            DP09L010,DP09L010,DP09L106,DP09L107:
                            DP09L010,DP09L010
          GOTO      DP09L010
.
DP09L101
          PACK      APCI2MKY,SP70,SP70
          CALL      UPTAPCI2
          IF        APCI2END=0
            CALL      RPAPCI2 
            IF        OVRCD=0
              PACK      APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
              MATCH     APCI2EKY,APCI2MKY
              IF        @EQUAL
                MOVE      ZERO,APCI2END
                ADD       ONE,APCI2CNT
                CALL      UPTAPCI2
                UNPACK    APCIDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      ORDDET00
              ELSE
                MOVE      ONE,APCI2END
              ENDIF
            ELSE
              MOVE      ONE,APCI2END
            ENDIF
          ENDIF
          IF        APCI2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L102
          IF        APCI2END=0
            MOVE      APISISC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L103
          IF        APCI2END=0
            MOVE      APISDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L104
          IF        APCI2END=0
            MOVE      APCIORD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L105
          IF        APCI2END=0
            MOVE      ORDTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L106
          IF        APCI2END=0
            MOVE      ORDSTAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L107
          IF        APCI2END=0
            MOVE      KEY8,VAR         
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
DP09L600
          MATCH    "APCI2",NAMSSFFI
          GOTO     DP09L605 IF NOT EQUAL
          GOTO     DP09L999
DP09L605
DP09L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP09L000
.
          MATCH    "APCI2",NAMSSFFI
          GOTO     FP09L105 IF NOT EQUAL
          PACK     KEY21,APCI2SKY,Z70
          CALL     RDAPCI2  * Start
          IF       OVRCD=0
            CALL     RPAPCI2  * Start
          ENDIF
          CALL     DP09L000
          GOTO     FP09L999
FP09L105
FP09L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP09L000
.
          MATCH    "APCI2",NAMSSFFI
          GOTO     LP09L105 IF NOT EQUAL
          PACK     KEY21,APCI2SKY,SP70
          CALL     RSAPCI2  * End
          IF       OVRCD=1
            CALL     RKAPCI2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APCI2SNO
            CALL     RKAPCI2 
            IF       OVRCD=1
              MOVE     APCI2SNO,SECTOR
            ENDIF
            PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
            MATCH    APCI2EKY,APCI2MKY
            IF       !@EQUAL
              MOVE     APCI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     LP09L999
LP09L105
LP09L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP09L000
.
          MATCH    "APCI2",NAMSSFFI
          GOTO     PP09L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP09L105
          CALL      RFTAPCI2
          BRANCH   OVRCD,PP09L115
          MOVE      APCI2MKY,KEY21 
          CALL      RSAPCI2 
PP09L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APCI2SNO
            CALL     RKAPCI2 
            IF       OVRCD=1
              MOVE     APCI2SNO,SECTOR
            ENDIF
            PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
            MATCH    APCI2EKY,APCI2MKY
            IF       !@EQUAL
              MOVE     APCI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     PP09L999
PP09L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APCI2SNO
            CALL     RPAPCI2 
            IF       OVRCD=1
              MOVE     APCI2SNO,SECTOR
            ENDIF
            PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
            MATCH    APCI2EKY,APCI2MKY
            IF       !@EQUAL
              MOVE     APCI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP09L999
PP09L120
PP09L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP09L000
          MATCH    "APCI2",NAMSSFFI
          GOTO     NP09L115 IF NOT EQUAL
NP09L105
          CALL     RPAPCI2 
          BRANCH   OVRCD,NP09L110
          PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
          MATCH    APCI2EKY,APCI2MKY
          GOTO     NP09L110 IF NOT EQUAL
          CALL     RKAPCI2 
          CALL     DP09L000
          GOTO     NP09L999
NP09L110
          CALL     RKAPCI2 
          BEEP
          GOTO     NP09L999
NP09L115
NP09L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT09L000
CT09L105
CT09L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Order Received Not Invoiced        
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    73 Date Order Received                
.---------------------------------------------------------
UPTAPCI2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APCI2FL1,KEY5;ANS
          IF        @OVER
            WRITE     APCI2FL1,KEY5;SCPSROW,SCPSCOL,APCI2MKY
          ELSE
            UPDATE    APCI2FL1;SCPSROW,SCPSCOL,APCI2MKY
          ENDIF
          RETURN
RDTAPCI2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APCI2FL1,KEY5;SCPSROW,SCPSCOL,APCI2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPCI2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APCI2FL1,KEY5;;
          READKS    APCI2FL1;SCPSROW,SCPSCOL,APCI2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APCI2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Order Received Not Invoiced        
.---------------------------------------------------------
DF09L000
          BRANCH   ACCEPT,DF09L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF09L900
          MATCH    PRGID,SCPSPID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF09L010 IF NOT EQUAL
.
          CALL     PS09L000 * Display Field
          GOTO     DF09L010
DF09L900
          MOVE      "APCI2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP09L000
DF09L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Order Received Not Invoiced        
.---------------------------------------------------------
PS09L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS09L101,PS09L102,PS09L103,PS09L104:
                            PS09L105,PS09L106,PS09L107,PS09L108:
                            PS09L109,PS09L110,PS09L111,PS09L112:
                            PS09L113,PS09L114,PS09L115,PS09L116:
                            PS09L117,PS09L118,PS09L119,PS09L120:
                            PS09L121,PS09L122,PS09L123,PS09L124:
                            PS09L125,PS09L126,PS09L127,PS09L128:
                            PS09L129,PS09L130,PS09L131,PS09L132:
                            PS09L133,PS09L134,PS09L135,PS09L999:
                           PS09L136,PS09L137,PS09L138,PS09L139:
                            PS09L140,PS09L141,PS09L142,PS09L143:
                            PS09L144,PS09L145,PS09L146,PS09L147:
                            PS09L148,PS09L149,PS09L150,PS09L151:
                            PS09L152,PS09L153,PS09L154,PS09L155:
                            PS09L156,PS09L157,PS09L158,PS09L159:
                            PS09L160,PS09L161,PS09L162,PS09L163:
                            PS09L164,PS09L165,PS09L166,PS09L167:
                            PS09L168,PS09L169,PS09L170,PS09L171:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L172,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999
          GOTO     PS09L999
.
PS09L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
.
PS09L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS09L999
.
PS09L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS09L999
.
PS09L172
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
PS09L999
          RETURN
.---------------------------------------------------------
. Selections for : Order Received Not Invoiced        
.---------------------------------------------------------
SF09L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF09L001  BRANCH   ACCEPT,SF09L020
.
SF09L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                           SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L101,SF09L102:
                            SF09L103,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L104,SF09L006:
                            SF09L105,SF09L106,SF09L006,SF09L006:
                            SF09L107,SF09L108
SF09L006  BEEP
          GOTO     SF09L005
SF09L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF09L090
          MATCH    PRGID,SCSLPID
          GOTO     SF09L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF09L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                           SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L101,SF09L102:
                            SF09L103,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020
          GOTO     SF09L020
SF09L090  MOVE     ZERO,ACCEPT
          MOVE      "APCI2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF09L001
.
SF09L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF09L001
.
SF09L103
          CALL      SELECTED
          BRANCH    EXIT,SF09L001
          COMPARE   ONE,ACCEPT
          GOTO      SF09L001 IF EQUAL
          CALL      RDTAPCI2
          IF        OVRCD=1
            BEEP
            GOTO      SF09L001
          ENDIF
          MATCH     SP70,APCI2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF09L001
          ENDIF
          MOVE      APCI2MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      DETORD00
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPCI2
          IF        OVRCD=1
            CALL      FP09L000
          ELSE
            MOVE      APCI2MKY,KEY21 
            CALL      RSAPCI2 
            CALL      RKAPCI2 
            CALL      DP09L000
          ENDIF
          GOTO     SF09L001
.
SF09L104
          MOVE      ZERO,EXIT
          GOTO      SF09L999
.
SF09L105
          MOVE      "APCI2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      NP09L000
          GOTO     SF09L001
.
SF09L106
          MOVE      "APCI2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      PP09L000
          GOTO     SF09L001
.
SF09L107
          MOVE      "APCI2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L108
          MOVE      "APCI2",NAMSSFFI
          MOVE      "   73",ITMSSFFI
          CALL      LP09L000
          GOTO     SF09L001
SF09L990  MOVE      ONE,EXIT * Exit Char Restart
SF09L999  RETURN
.--------------------------------
. Screen - Transaction Allocation Display     
.--------------------------------
SC11L000
SC11L100
          MOVE      "11",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC11L200
          CALL      CF11L000 * Clear Fields
SC11L300
          CALL      KY11L000 * Enter Key Fields
          BRANCH    EXIT,SC11L999,SC11L999
SC11L400
          CALL      WP11L000 * Load any WP Details
SC11L500
          CALL      LM11L000 * Load any Batch Details
SC11L600
          CALL      DF11L000 * Display Fields
SC11L700
          CALL      SF11L000 * Select Fields
          BRANCH    EXIT,SC11L100,SC11L100,SC11L200
SC11L800
SC11L900
SC11L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transaction Allocation Display     
.-------------------------------------------------------
CF11L000
CF11L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transaction Allocation Display     
.--------------------------------------------------------
KY11L000
          MOVE      ZERO,EXIT
          GOTO      KY11L999
.
KY11L900  MOVE      ONE,EXIT
KY11L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transaction Allocation Display     
.---------------------------------------------------------
WP11L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP11L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP11L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP11L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP11L100
WP11L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP11L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP11L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP11L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP11L110
WP11L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transaction Allocation Display     
.---------------------------------------------------------
LM11L000
.---------------------------------------------------------
. Load for :   101 Order Number                       
.---------------------------------------------------------
          UNPACK    SP70,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN
          PACK      KEY51,APIMBCH,APIMCRD,APIMREF,APIMDOC,SP70
          MOVE      KEY51,APIN1EKY
          STRIP     APIN1SKY
          SETLPTR   APIN1EKY,40
          MOVE      APIN1EKY,APIN1SKY
          CALL      RDAPIN1 
          IF        OVRCD=0
            CALL      RPAPIN1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP11L000
          MOVE     ZERO,APIN1CNT
          MOVE     ZERO,APIN1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP11L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP11L600
          MATCH    PRGID,SCPSPID
          GOTO     DP11L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP11L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP11L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                           DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                           DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L010,DP11L010,DP11L010,DP11L010:
                            DP11L101,DP11L010,DP11L102,DP11L103:
                            DP11L104,DP11L105,DP11L106,DP11L107:
                            DP11L108,DP11L109,DP11L110,DP11L111:
                            DP11L112,DP11L010,DP11L010,DP11L113:
                            DP11L010,DP11L010,DP11L010,DP11L114:
                            DP11L010,DP11L010
          GOTO      DP11L010
.
DP11L101
          PACK      APIN1MKY,SP70,SP70
          CALL      UPTAPIN1
          IF        APIN1END=0
            CALL      RKAPIN1 
            IF        OVRCD=0
              PACK      APIN1MKY,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN                                
              MATCH     APIN1EKY,APIN1MKY
              IF        @EQUAL
                MOVE      ZERO,APIN1END
                ADD       ONE,APIN1CNT
                CALL      UPTAPIN1
                MOVE      APINORD,VAR      
                CALL      DISPITEM
          CALL      GETAIN00
              ELSE
                MOVE      ONE,APIN1END
              ENDIF
            ELSE
              MOVE      ONE,APIN1END
            ENDIF
          ENDIF
          IF        APIN1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L102
          IF        APIN1END=0
            MOVE      APINLED,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L103
          IF        APIN1END=0
            MOVE      APINACC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L104
          IF        APIN1END=0
            MOVE      APINDIS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L105
          IF        APIN1END=0
            MOVE      APINRES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L106
          IF        APIN1END=0
            MOVE      APINCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L107
          IF        APIN1END=0
            MOVE      APINDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L108
          IF        APIN1END=0
            MOVE      APINQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L109
          IF        APIN1END=0
            MOVE      APINUCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L110
          IF        APIN1END=0
            MOVE      APINAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L111
          IF        APIN1END=0
            MOVE      APINPAY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L112
          IF        APIN1END=0
            MOVE      APINGST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L113
          IF        APIN1END=0
            MOVE      DESCAPIN,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
.
DP11L114
          IF        APIN1END=0
            MOVE      FMAMDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP11L010
DP11L600
          MATCH    "APIN1",NAMSSFFI
          GOTO     DP11L605 IF NOT EQUAL
          GOTO     DP11L999
DP11L605
DP11L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP11L000
.
          MATCH    "APIN1",NAMSSFFI
          GOTO     FP11L105 IF NOT EQUAL
          PACK     KEY51,APIN1SKY,SP70
          CALL     RDAPIN1  * Start
          IF       OVRCD=0
            CALL     RPAPIN1  * Start
          ENDIF
          CALL     DP11L000
          GOTO     FP11L999
FP11L105
FP11L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP11L000
.
          MATCH    "APIN1",NAMSSFFI
          GOTO     LP11L105 IF NOT EQUAL
          PACK     KEY51,APIN1SKY,Z70
          CALL     RSAPIN1  * End
          IF       OVRCD=1
            CALL     RPAPIN1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIN1SNO
            CALL     RPAPIN1 
            IF       OVRCD=1
              MOVE     APIN1SNO,SECTOR
            ENDIF
            PACK     APIN1MKY,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN                                
            MATCH    APIN1EKY,APIN1MKY
            IF       !@EQUAL
              MOVE     APIN1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP11L000
          GOTO     LP11L999
LP11L105
LP11L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP11L000
.
          MATCH    "APIN1",NAMSSFFI
          GOTO     PP11L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP11L105
          CALL      RFTAPIN1
          BRANCH   OVRCD,PP11L115
          MOVE      APIN1MKY,KEY51 
          CALL      RSAPIN1 
PP11L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APIN1SNO
            CALL     RPAPIN1 
            IF       OVRCD=1
              MOVE     APIN1SNO,SECTOR
            ENDIF
            PACK     APIN1MKY,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN                                
            MATCH    APIN1EKY,APIN1MKY
            IF       !@EQUAL
              MOVE     APIN1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP11L000
          GOTO     PP11L999
PP11L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIN1SNO
            CALL     RKAPIN1 
            IF       OVRCD=1
              MOVE     APIN1SNO,SECTOR
            ENDIF
            PACK     APIN1MKY,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN                                
            MATCH    APIN1EKY,APIN1MKY
            IF       !@EQUAL
              MOVE     APIN1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP11L999
PP11L120
PP11L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP11L000
          MATCH    "APIN1",NAMSSFFI
          GOTO     NP11L115 IF NOT EQUAL
NP11L105
          CALL     RKAPIN1 
          BRANCH   OVRCD,NP11L110
          PACK     APIN1MKY,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN                                
          MATCH    APIN1EKY,APIN1MKY
          GOTO     NP11L110 IF NOT EQUAL
          CALL     RPAPIN1 
          CALL     DP11L000
          GOTO     NP11L999
NP11L110
          CALL     RPAPIN1 
          BEEP
          GOTO     NP11L999
NP11L115
NP11L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT11L000
CT11L105
CT11L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Transaction Allocation Display     
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :   101 Order Number                       
.---------------------------------------------------------
UPTAPIN1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIN1FL1,KEY5;ANS
          IF        @OVER
            WRITE     APIN1FL1,KEY5;SCPSROW,SCPSCOL,APIN1MKY
          ELSE
            UPDATE    APIN1FL1;SCPSROW,SCPSCOL,APIN1MKY
          ENDIF
          RETURN
RDTAPIN1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APIN1FL1,KEY5;SCPSROW,SCPSCOL,APIN1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPIN1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APIN1FL1,KEY5;;
          READKS    APIN1FL1;SCPSROW,SCPSCOL,APIN1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APIN1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Transaction Allocation Display     
.---------------------------------------------------------
DF11L000
          BRANCH   ACCEPT,DF11L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF11L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF11L900
          MATCH    PRGID,SCPSPID
          GOTO     DF11L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF11L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF11L010 IF NOT EQUAL
.
          CALL     PS11L000 * Display Field
          GOTO     DF11L010
DF11L900
          MOVE      "APIN1",NAMSSFFI
          MOVE      "  101",ITMSSFFI
          CALL      FP11L000
DF11L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transaction Allocation Display     
.---------------------------------------------------------
PS11L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS11L101,PS11L102,PS11L103,PS11L104:
                            PS11L105,PS11L106,PS11L107,PS11L108:
                            PS11L109,PS11L110,PS11L111,PS11L112:
                            PS11L113,PS11L114,PS11L115,PS11L116:
                            PS11L117,PS11L118,PS11L119,PS11L120:
                            PS11L121,PS11L122,PS11L123,PS11L124:
                            PS11L125,PS11L126,PS11L127,PS11L128:
                            PS11L129,PS11L130,PS11L131,PS11L132:
                            PS11L133,PS11L134,PS11L135,PS11L999:
                           PS11L136,PS11L137,PS11L138,PS11L139:
                            PS11L140,PS11L141,PS11L142,PS11L143:
                            PS11L144,PS11L145,PS11L146,PS11L147:
                            PS11L148,PS11L149,PS11L150,PS11L151:
                            PS11L152,PS11L153,PS11L154,PS11L155:
                            PS11L156,PS11L157,PS11L158,PS11L159:
                            PS11L160,PS11L161,PS11L162,PS11L163:
                            PS11L164,PS11L165,PS11L166,PS11L167:
                            PS11L168,PS11L169,PS11L170,PS11L171:
                            PS11L999,PS11L999,PS11L999,PS11L999:
                           PS11L999,PS11L999,PS11L999,PS11L999:
                            PS11L172,PS11L173,PS11L174,PS11L175:
                            PS11L176,PS11L177,PS11L178,PS11L179:
                            PS11L180,PS11L181,PS11L182,PS11L183:
                            PS11L184,PS11L185,PS11L186,PS11L187:
                            PS11L188,PS11L189,PS11L190,PS11L191:
                            PS11L999,PS11L999,PS11L999,PS11L999:
                            PS11L999,PS11L999,PS11L999,PS11L999:
                            PS11L999,PS11L999,PS11L999,PS11L999:
                            PS11L999,PS11L999,PS11L999,PS11L999:
                            PS11L999,PS11L999,PS11L999,PS11L999:
                            PS11L999,PS11L999
          GOTO     PS11L999
.
PS11L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS11L999
.
PS11L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS11L999
.
PS11L172
          MOVE      APIMBCH,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L173
          MOVE      APIMREF,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L174
          MOVE      APIMDOC,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L175
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APIMUPD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L176
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APIMOUT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L177
          MOVE      APIMTER,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L178
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L179
          UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L180
          UNPACK    APIMPDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L181
          UNPACK    APIMTDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L182
          MOVE      APIMTOT,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L183
          MOVE      APIMDIS,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L184
          MOVE      APIMGST,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L185
          MOVE      APIMPAY,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L186
          MOVE      APIMCM1,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L187
          MOVE      APIMCM2,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L188
          MOVE      APIMICM,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L189
          MOVE      TRNTERM,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L190
          MOVE      TRNOUTS,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
.
PS11L191
          MOVE      TRNTYPE,VAR      
          CALL      DISPITEM
          GOTO     PS11L999
PS11L999
          RETURN
.---------------------------------------------------------
. Selections for : Transaction Allocation Display     
.---------------------------------------------------------
SF11L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF11L001  BRANCH   ACCEPT,SF11L020
.
SF11L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                           SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L101,SF11L102:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                           SF11L006,SF11L006,SF11L103,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L104,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L006,SF11L006,SF11L006,SF11L006:
                            SF11L105,SF11L106,SF11L006,SF11L006:
                            SF11L107,SF11L108
SF11L006  BEEP
          GOTO     SF11L005
SF11L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF11L090
          MATCH    PRGID,SCSLPID
          GOTO     SF11L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF11L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                           SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L101,SF11L102:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                           SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L104,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020,SF11L020,SF11L020:
                            SF11L020,SF11L020
          GOTO     SF11L020
SF11L090  MOVE     ZERO,ACCEPT
          MOVE      "APIN1",NAMSSFFI
          MOVE      "  101",ITMSSFFI
          CALL      FP11L000
          GOTO     SF11L001
.
SF11L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF11L001
.
SF11L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF11L001
.
SF11L103
          MOVE      ZERO,EXIT
          GOTO      SF11L999
.
SF11L104
          CALL      SELECTED
          BRANCH    EXIT,SF11L001
          COMPARE   ONE,ACCEPT
          GOTO      SF11L001 IF EQUAL
          CALL      RDTAPIN1
          IF        OVRCD=1
            BEEP
            GOTO      SF11L001
          ENDIF
          MATCH     SP70,APIN1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF11L001
          ENDIF
          MOVE      APIN1MKY,KEY51 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      ITEM0000
          MOVE      "11",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPIN1
          IF        OVRCD=1
            CALL      FP11L000
          ELSE
            MOVE      APIN1MKY,KEY51 
            CALL      RSAPIN1 
            CALL      RPAPIN1 
            CALL      DP11L000
          ENDIF
          GOTO     SF11L001
.
SF11L105
          MOVE      "APIN1",NAMSSFFI
          MOVE      "  101",ITMSSFFI
          CALL      NP11L000
          GOTO     SF11L001
.
SF11L106
          MOVE      "APIN1",NAMSSFFI
          MOVE      "  101",ITMSSFFI
          CALL      PP11L000
          GOTO     SF11L001
.
SF11L107
          MOVE      "APIN1",NAMSSFFI
          MOVE      "  101",ITMSSFFI
          CALL      FP11L000
          GOTO     SF11L001
.
SF11L108
          MOVE      "APIN1",NAMSSFFI
          MOVE      "  101",ITMSSFFI
          CALL      LP11L000
          GOTO     SF11L001
SF11L990  MOVE      ONE,EXIT * Exit Char Restart
SF11L999  RETURN
.--------------------------------
. Screen - Allocation Detail Non Inventory    
.--------------------------------
SC12L000
SC12L100
          MOVE      "12",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC12L200
          CALL      CF12L000 * Clear Fields
SC12L300
          CALL      KY12L000 * Enter Key Fields
          BRANCH    EXIT,SC12L999,SC12L999
SC12L400
          CALL      WP12L000 * Load any WP Details
SC12L500
          CALL      LM12L000 * Load any Batch Details
SC12L600
          CALL      DF12L000 * Display Fields
SC12L700
          CALL      SF12L000 * Select Fields
          BRANCH    EXIT,SC12L100,SC12L100,SC12L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC12L800
SC12L900
SC12L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Allocation Detail Non Inventory    
.-------------------------------------------------------
CF12L000
CF12L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Allocation Detail Non Inventory    
.--------------------------------------------------------
KY12L000
          MOVE      ZERO,EXIT
          GOTO      KY12L999
.
KY12L900  MOVE      ONE,EXIT
KY12L999  RETURN
.---------------------------------------------------------
. Load WP files for : Allocation Detail Non Inventory    
.---------------------------------------------------------
WP12L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Allocation Detail Non Inventory    
.---------------------------------------------------------
LM12L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Allocation Detail Non Inventory    
.---------------------------------------------------------
DF12L000
          BRANCH   ACCEPT,DF12L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF12L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF12L900
          MATCH    PRGID,SCPSPID
          GOTO     DF12L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF12L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF12L010 IF NOT EQUAL
.
          CALL     PS12L000 * Display Field
          GOTO     DF12L010
DF12L900
DF12L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Allocation Detail Non Inventory    
.---------------------------------------------------------
PS12L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS12L999,PS12L999,PS12L101,PS12L102:
                            PS12L103,PS12L104,PS12L105,PS12L106:
                            PS12L107,PS12L108,PS12L109,PS12L110:
                            PS12L111,PS12L112,PS12L113,PS12L114:
                            PS12L115,PS12L116,PS12L117
          GOTO     PS12L999
.
PS12L101
          MOVE      APINORD,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L102
          MOVE      APINLIN,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L103
          MOVE      APINLED,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L104
          MOVE      APINACC,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L105
          MOVE      APINDIS,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L106
          MOVE      APINRES,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L107
          MOVE      APINCAT,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L108
          MOVE      APINDES,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L109
          MOVE      APINQTY,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L110
          MOVE      APINUCT,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L111
          MOVE      APINAMT,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L112
          MOVE      APINPAY,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L113
          MOVE      APINGST,VAR      
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L114
          MOVE      FMRSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L115
          MOVE      FMDSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L116
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
.
PS12L117
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS12L999
PS12L999
          RETURN
.---------------------------------------------------------
. Selections for : Allocation Detail Non Inventory    
.---------------------------------------------------------
SF12L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF12L001  BRANCH   ACCEPT,SF12L020
.
SF12L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF12L006,SF12L101,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006,SF12L006:
                            SF12L006,SF12L006,SF12L006
SF12L006  BEEP
          GOTO     SF12L005
SF12L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF12L090
          MATCH    PRGID,SCSLPID
          GOTO     SF12L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF12L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020,SF12L020:
                            SF12L020,SF12L020,SF12L020
          GOTO     SF12L020
SF12L090  MOVE     ZERO,ACCEPT
          GOTO     SF12L001
.
SF12L101
          MOVE      ZERO,EXIT
          GOTO      SF12L999
SF12L990  MOVE      FOUR,EXIT * Exit Char Exit
SF12L999  RETURN
.--------------------------------
. Screen - Order Details                      
.--------------------------------
SC14L000
SC14L100
          MOVE      "14",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC14L200
          CALL      CF14L000 * Clear Fields
SC14L300
          CALL      KY14L000 * Enter Key Fields
          BRANCH    EXIT,SC14L999,SC14L999
SC14L400
          CALL      WP14L000 * Load any WP Details
SC14L500
          CALL      LM14L000 * Load any Batch Details
SC14L600
          CALL      DF14L000 * Display Fields
SC14L700
          CALL      SF14L000 * Select Fields
          BRANCH    EXIT,SC14L100,SC14L100,SC14L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC14L800
SC14L900
SC14L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Order Details                      
.-------------------------------------------------------
CF14L000
CF14L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Order Details                      
.--------------------------------------------------------
KY14L000
          MOVE      ZERO,EXIT
          GOTO      KY14L999
.
KY14L900  MOVE      ONE,EXIT
KY14L999  RETURN
.---------------------------------------------------------
. Load WP files for : Order Details                      
.---------------------------------------------------------
WP14L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Order Details                      
.---------------------------------------------------------
LM14L000
.---------------------------------------------------------
. Load for :     7 Catalog Code                       
.---------------------------------------------------------
          UNPACK    SP70,APODISC,APODORD,APODCAT
          PACK      KEY14,APCIISC,APCIORD,SP70
          MOVE      KEY14,APOD1EKY
          STRIP     APOD1SKY
          SETLPTR   APOD1EKY,8
          MOVE      APOD1EKY,APOD1SKY
          CALL      RDAPOD1 
          IF        OVRCD=0
            CALL      RPAPOD1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP14L000
          MOVE     ZERO,APOD1CNT
          MOVE     ZERO,APOD1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP14L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP14L600
          MATCH    PRGID,SCPSPID
          GOTO     DP14L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP14L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP14L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L101,DP14L102:
                            DP14L103,DP14L104,DP14L010,DP14L105:
                            DP14L106,DP14L107,DP14L108,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010
          GOTO      DP14L010
.
DP14L101
          IF        APOD1END=0
            CALL      RKAPOD1 
            IF        OVRCD=0
              PACK      APOD1MKY,APODISC,APODORD,APODCAT                                                        
              MATCH     APOD1EKY,APOD1MKY
              IF        @EQUAL
                MOVE      ZERO,APOD1END
                ADD       ONE,APOD1CNT
          CALL      CATCOD00
                MOVE      CATALOG,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,APOD1END
              ENDIF
            ELSE
              MOVE      ONE,APOD1END
            ENDIF
          ENDIF
          IF        APOD1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L102
          IF        APOD1END=0
            MOVE      APODLED,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L103
          IF        APOD1END=0
            MOVE      APODACC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L104
          IF        APOD1END=0
            MOVE      APODDIS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L105
          IF        APOD1END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L106
          IF        APOD1END=0
            MOVE      APODAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L107
          IF        APOD1END=0
            MOVE      APODUCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L108
          IF        APOD1END=0
            MOVE      APODQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
DP14L600
          MATCH    "APOD1",NAMSSFFI
          GOTO     DP14L605 IF NOT EQUAL
          GOTO     DP14L999
DP14L605
DP14L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP14L000
.
          MATCH    "APOD1",NAMSSFFI
          GOTO     FP14L105 IF NOT EQUAL
          PACK     KEY14,APOD1SKY,SP70
          CALL     RDAPOD1  * Start
          IF       OVRCD=0
            CALL     RPAPOD1  * Start
          ENDIF
          CALL     DP14L000
          GOTO     FP14L999
FP14L105
FP14L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP14L000
.
          MATCH    "APOD1",NAMSSFFI
          GOTO     LP14L105 IF NOT EQUAL
          PACK     KEY14,APOD1SKY,Z70
          CALL     RSAPOD1  * End
          IF       OVRCD=1
            CALL     RPAPOD1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APOD1SNO
            CALL     RPAPOD1 
            IF       OVRCD=1
              MOVE     APOD1SNO,SECTOR
            ENDIF
            PACK     APOD1MKY,APODISC,APODORD,APODCAT                                                        
            MATCH    APOD1EKY,APOD1MKY
            IF       !@EQUAL
              MOVE     APOD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP14L000
          GOTO     LP14L999
LP14L105
LP14L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP14L000
.
          MATCH    "APOD1",NAMSSFFI
          GOTO     PP14L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP14L105
          COMPARE  SECTOR,APOD1SNO
          GOTO     PP14L110 IF EQUAL
          CALL     RPAPOD1 
          BRANCH   OVRCD,PP14L115
          PACK     APOD1MKY,APODISC,APODORD,APODCAT                                                        
          MATCH    APOD1EKY,APOD1MKY
          GOTO     PP14L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP14L105
PP14L110
          MOVE     ZERO,SECTOR
          IF       APOD1CNT=APOD1SNO
            SUB      ONE,APOD1CNT
          ENDIF
          WHILE    SECTOR<=APOD1CNT
            CALL     RPAPOD1 
            IF       OVRCD=1
              MOVE     APOD1SNO,SECTOR
            ENDIF
            PACK     APOD1MKY,APODISC,APODORD,APODCAT                                                        
            MATCH    APOD1EKY,APOD1MKY
            IF       !@EQUAL
              MOVE     APOD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP14L000
          GOTO     PP14L999
PP14L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APOD1SNO
            CALL     RKAPOD1 
            IF       OVRCD=1
              MOVE     APOD1SNO,SECTOR
            ENDIF
            PACK     APOD1MKY,APODISC,APODORD,APODCAT                                                        
            MATCH    APOD1EKY,APOD1MKY
            IF       !@EQUAL
              MOVE     APOD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP14L999
PP14L120
PP14L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP14L000
          MATCH    "APOD1",NAMSSFFI
          GOTO     NP14L115 IF NOT EQUAL
NP14L105
          CALL     RKAPOD1 
          BRANCH   OVRCD,NP14L110
          PACK     APOD1MKY,APODISC,APODORD,APODCAT                                                        
          MATCH    APOD1EKY,APOD1MKY
          GOTO     NP14L110 IF NOT EQUAL
          CALL     RPAPOD1 
          CALL     DP14L000
          GOTO     NP14L999
NP14L110
          CALL     RPAPOD1 
          BEEP
          GOTO     NP14L999
NP14L115
NP14L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT14L000
CT14L105
CT14L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Order Details                      
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Order Details                      
.---------------------------------------------------------
DF14L000
          BRANCH   ACCEPT,DF14L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF14L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF14L900
          MATCH    PRGID,SCPSPID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF14L010 IF NOT EQUAL
.
          CALL     PS14L000 * Display Field
          GOTO     DF14L010
DF14L900
          MOVE      "APOD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP14L000
DF14L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Order Details                      
.---------------------------------------------------------
PS14L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS14L999,PS14L999,PS14L101,PS14L102:
                            PS14L103,PS14L104,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L105,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L106:
                            PS14L999,PS14L999,PS14L999,PS14L999
          GOTO     PS14L999
.
PS14L101
          MOVE      APCIISC,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L102
          MOVE      APCIORD,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L103
          UNPACK    APCIDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L104
          MOVE      APISDES,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L105
          MOVE      APODRES,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L106
          MOVE      ORDTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
PS14L999
          RETURN
.---------------------------------------------------------
. Selections for : Order Details                      
.---------------------------------------------------------
SF14L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF14L001  BRANCH   ACCEPT,SF14L020
.
SF14L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L006,SF14L101,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L102,SF14L103,SF14L104,SF14L105
SF14L006  BEEP
          GOTO     SF14L005
SF14L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF14L090
          MATCH    PRGID,SCSLPID
          GOTO     SF14L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF14L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020
          GOTO     SF14L020
SF14L090  MOVE     ZERO,ACCEPT
          MOVE      "APOD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP14L000
          GOTO     SF14L001
.
SF14L101
          MOVE      ZERO,EXIT
          GOTO      SF14L999
.
SF14L102
          MOVE      "APOD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP14L000
          GOTO     SF14L001
.
SF14L103
          MOVE      "APOD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP14L000
          GOTO     SF14L001
.
SF14L104
          MOVE      "APOD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP14L000
          GOTO     SF14L001
.
SF14L105
          MOVE      "APOD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP14L000
          GOTO     SF14L001
SF14L990  MOVE      FOUR,EXIT * Exit Char Exit
SF14L999  RETURN
.--------------------------------
. Screen - Transaction Details (New Inventory)
.--------------------------------
SC15L000
SC15L100
          MOVE      "15",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC15L200
          CALL      CF15L000 * Clear Fields
SC15L300
          CALL      KY15L000 * Enter Key Fields
          BRANCH    EXIT,SC15L999,SC15L999
SC15L400
          CALL      WP15L000 * Load any WP Details
SC15L500
          CALL      LM15L000 * Load any Batch Details
SC15L600
          CALL      DF15L000 * Display Fields
SC15L700
          CALL      SF15L000 * Select Fields
          BRANCH    EXIT,SC15L100,SC15L100,SC15L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC15L800
SC15L900
SC15L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transaction Details (New Inventory)
.-------------------------------------------------------
CF15L000
CF15L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transaction Details (New Inventory)
.--------------------------------------------------------
KY15L000
          MOVE      ZERO,EXIT
          GOTO      KY15L999
.
KY15L900  MOVE      ONE,EXIT
KY15L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transaction Details (New Inventory)
.---------------------------------------------------------
WP15L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transaction Details (New Inventory)
.---------------------------------------------------------
LM15L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transaction Details (New Inventory)
.---------------------------------------------------------
DF15L000
          BRANCH   ACCEPT,DF15L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF15L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF15L900
          MATCH    PRGID,SCPSPID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF15L010 IF NOT EQUAL
.
          CALL     PS15L000 * Display Field
          GOTO     DF15L010
DF15L900
DF15L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transaction Details (New Inventory)
.---------------------------------------------------------
PS15L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS15L999,PS15L999,PS15L101,PS15L102:
                            PS15L103,PS15L104,PS15L105,PS15L106:
                            PS15L107,PS15L108,PS15L109,PS15L110:
                            PS15L111,PS15L112,PS15L113,PS15L114:
                            PS15L115,PS15L116,PS15L117,PS15L118:
                            PS15L119,PS15L120,PS15L121,PS15L122:
                            PS15L123,PS15L124,PS15L125,PS15L126:
                            PS15L127,PS15L128,PS15L129,PS15L130
          GOTO     PS15L999
.
PS15L101
          MOVE      APINORD,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L102
          MOVE      APINLIN,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L103
          MOVE      APINLED,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L104
          MOVE      APINACC,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L105
          MOVE      APINDIS,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L106
          MOVE      APINRES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L107
          MOVE      APINCAT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L108
          MOVE      APINDES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L109
          MOVE      APINQTY,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L110
          MOVE      APINUCT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L111
          MOVE      APINAMT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L112
          MOVE      APINPAY,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L113
          MOVE      APINGST,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L114
          MOVE      FMRSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L115
          MOVE      FMDSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L116
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L117
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L118
          MOVE      APISISC,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L119
          MOVE      APISDES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L120
          MOVE      APISDIR,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L121
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L122
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L123
          MOVE      SIPCWAR,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L124
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L125
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L126
          MOVE      SIPCPD,VAR       
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L127
          MOVE      SIPCCON,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L128
          UNPACK    SIPCCDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L129
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L130
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
PS15L999
          RETURN
.---------------------------------------------------------
. Selections for : Transaction Details (New Inventory)
.---------------------------------------------------------
SF15L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF15L001  BRANCH   ACCEPT,SF15L020
.
SF15L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L006,SF15L101,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006
SF15L006  BEEP
          GOTO     SF15L005
SF15L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF15L090
          MATCH    PRGID,SCSLPID
          GOTO     SF15L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF15L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020
          GOTO     SF15L020
SF15L090  MOVE     ZERO,ACCEPT
          GOTO     SF15L001
.
SF15L101
          MOVE      ZERO,EXIT
          GOTO      SF15L999
SF15L990  MOVE      FOUR,EXIT * Exit Char Exit
SF15L999  RETURN
.@@@@@ Function Restart Point @@@@@
KILL0000  CLEAR     COMMAND                     * TAPIM2pp   pp-port#
          APPEND    "iserase ",COMMAND
          APPEND    APIM2FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
          CLEAR     COMMAND                     * TAPIM3pp
          APPEND    "iserase ",COMMAND
          APPEND    APIM3FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
          CLEAR     COMMAND                     * TAPIM4pp
          APPEND    "iserase ",COMMAND
          APPEND    APIM4FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
          CLEAR     COMMAND                     * TAPIM6pp
          APPEND    "iserase ",COMMAND
          APPEND    APIM6FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
          CLEAR     COMMAND                     * TAPIN1pp
          APPEND    "iserase ",COMMAND
          APPEND    APIN1FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
          CLEAR     COMMAND                     * TAPCI2pp
          APPEND    "iserase ",COMMAND
          APPEND    APIN2FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
          CLEAR     COMMAND                     * TAPCI2pp
          APPEND    "iserase ",COMMAND
          APPEND    APCI2FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
.
KILL9999  RETURN
.--------------------------------------------------
. Read Controlf Flags
.--------------------------------------------------
CONTROLF
          MOVE      "63",SECTOR
          READ      CONTROLF,SECTOR;*85,INCOSTYP
          RETURN
.----------------------------------------------------------------------
. Enter Creditor Code for Enquiries and Read all Relevant Information
.----------------------------------------------------------------------
ECRED000
          MOVE      ZERO,CKEYTYP
          CALL      KAPMAA00
          BRANCH    EXIT,ECRED999,ECRED999
.
          MOVE      "Cheque",PMETDES
          BRANCH    APMAGMT,ECRED010,ECRED020,ECRED030
          GOTO      ECRED040
ECRED010  MOVE      "Direct Dr (w Advice)          ",PMETDES
          GOTO      ECRED040
ECRED020  MOVE      "Direct Dr (w Advice if>1 Inv.)",PMETDES
          GOTO      ECRED040
ECRED030  MOVE      "Direct Dr (w/o Advice)        ",PMETDES
.
ECRED040  PACK      NZBANKAC,APMABSB,APMABAC,SP70
.
. Determine Creditor Type Description
.
          MOVE      APMATYP,KEY3
          CALL      RDAPCT1
          IF        OVRCD=1
            MOVE      SP70,APCTDESC
            MOVE      SP70,APCTCODE
          ENDIF
.
. Default Payment Period Details
.
          MOVE      APMAPPD,KEY2
          CALL      RDAPPP1
          IF        OVRCD=1
            MOVE      SP70,OFFSDESC
            MOVE      SP70,APPPDES
            MOVE      ZERO,APPPTYP
            MOVE      ZERO,APPPDA1
            MOVE      ZERO,APPPPE1
            MOVE      ZERO,APPPDA2
            MOVE      ZERO,APPPPE2
            MOVE      ZERO,APPPDA3
            MOVE      ZERO,APPPPE3
          ELSE
            IF        APPPTYP=0
              MOVE     "Invoice Date      ",OFFSDESC
            ENDIF
            IF        APPPTYP=1
              MOVE     "Batch Entered Date",OFFSDESC
            ENDIF
            IF        APPPTYP=2
              MOVE     "Batch Period Date ",OFFSDESC
            ENDIF
            IF        APPPTYP=3
              MOVE     "Fixed Day of Month",OFFSDESC
            ENDIF
          ENDIF
.
. Combined Creditor Name and Address Details
.
          STRIP    APMACN1
          STRIP    APMACN2
          CLEAR    CRDNAM80
          APPEND   APMACN1,CRDNAM80
          APPEND   SP1,CRDNAM80
          APPEND   APMACN2,CRDNAM80
          RESET    CRDNAM80
.
          STRIP    APMACA1
          STRIP    APMACA2
          STRIP    APMACA3
          STRIP    APMACPC
          CLEAR    CRDADD80
          APPEND   APMACA1,CRDADD80
          APPEND   SP1,CRDADD80
          APPEND   APMACA2,CRDADD80
          APPEND   SP1,CRDADD80
          APPEND   APMACA3,CRDADD80
          APPEND   SP1,CRDADD80
          APPEND   APMACPC,CRDADD80
          RESET    CRDADD80
.
          CLEAR    KEY5
          APPEND   "a1",KEY5
          APPEND   APMAUC1,KEY5
          RESET    KEY5
          CALL     RDFMCD1
          IF       OVRCD=0
            MOVE     FMCDDESC,UDDESC1
          ELSE
            MOVE     SP70,UDDESC1
          ENDIF
.
          CLEAR    KEY5
          APPEND   "a2",KEY5
          APPEND   APMAUC2,KEY5
          RESET    KEY5
          CALL     RDFMCD1
          IF       OVRCD=0
            MOVE     FMCDDESC,UDDESC2
          ELSE
            MOVE     SP70,UDDESC2
          ENDIF
.
          CALL     COUTS000           * Calculate Outstanding for Creditor
.
ECRED999  RETURN
.------------------------------------------------------------
. Calculate Outstanding for a Creditor
.
. AMTOUT00 - Current
. AMTOUT30 - 30 Days
. AMTOUT60 - 60 Days
. AMTOUT90 - 90 Days
. AMTOUT99 - Total
. AMTWRK00 - Working Variable
.
.------------------------------------------------------------
COUTS000  MOVE      ZERO,AMTOUT00
          MOVE      ZERO,AMTOUT30
          MOVE      ZERO,AMTOUT60
          MOVE      ZERO,AMTOUT90
          MOVE      ZERO,AMTOUT99
.
          MOVE      CCC,CC
          MOVE      CYY,YY
          MOVE      CMM,MM
          MOVE      CDD,DD
          CALL      DMYCON
          MOVE      JULDAY,CURJDAY
          ASSIGN    (JULCC*100)+JULYR,CURJYEAR
.
          PACK      KEY41,ONE,APMACRD,SP70
          CALL      RSAPIM6
COUTS100  CALL      RKAPIM6                  * Loop Through Outstanding Trans
          BRANCH    OVRCD,COUTS999
          MATCH     "1",APIMOUT
          GOTO      COUTS999 IF NOT EQUAL
          MATCH     APMACRD,APIMCRD
          GOTO      COUTS999 IF NOT EQUAL
.
          MATCH     "0",APIMTYP
          GOTO      COUTS110 IF EQUAL
          MATCH     "1",APIMTYP
          GOTO      COUTS100 IF NOT EQUAL
.
COUTS110  PACK      KEY41,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH
          ASSIGN    APIMTOT-APIMDIS+APIMGST-APIMPAY,AMTWRK00
          COMPARE   ZERO,AMTWRK00
          GOTO      COUTS200 IF NOT EQUAL
.----------------------------------------
. Zero Outstanding so Update Flag
.----------------------------------------
          PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
          CALL      RDAPIM1
          IF        OVRCD=0
            MOVE      ZERO,APIMOUT
            CALL      UPAPIM1
          ENDIF
          PACK      KEY41,ONE,APIMCRD,APIMREF,APIMDOC,APIMBCH
          CALL      RSAPIM6
          GOTO      COUTS100
.
COUTS200  MATCH     "1",APIMTYP
          IF        @EQUAL
            MULT      SEQ,AMTWRK00
          ENDIF
.
          ADD       AMTWRK00,AMTOUT99
.
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CCENT,CC
          MOVE      CYEAR,YY
          MOVE      CMON,MM
          MOVE      CDAY,DD
          CALL      DMYCON
          MOVE      JULDAY,WRKJDAY
          ASSIGN    (JULCC*100)+JULYR,WRKJYEAR
.
          IF        WRKJYEAR>CURJYEAR
            ADD       AMTWRK00,AMTOUT00
            GOTO      COUTS100
          ENDIF
          IF        WRKJYEAR+1<CURJYEAR
            ADD       AMTWRK00,AMTOUT90
            GOTO      COUTS100
          ENDIF
          IF        WRKJYEAR<CURJYEAR
............ASSIGN    WRKJDAY+LEAPYR+365,WRKJDAY...........srf 127328
            ASSIGN    WRKJDAY-LEAPYR-365,WRKJDAY
          ENDIF
.
          ASSIGN    CURJDAY-WRKJDAY,WRKJDAY
          IF        WRKJDAY<31
            ADD       AMTWRK00,AMTOUT00
            GOTO      COUTS100
          ENDIF
          IF        WRKJDAY<61
            ADD       AMTWRK00,AMTOUT30
            GOTO      COUTS100
          ENDIF
          IF        WRKJDAY<91
            ADD       AMTWRK00,AMTOUT60
            GOTO      COUTS100
          ENDIF
          ADD       AMTWRK00,AMTOUT90
          GOTO      COUTS100
.
COUTS999  RETURN
.--------------------------------------------------
. Get Transaction Details
.--------------------------------------------------
TRNDET00
          ASSIGN   APIMTOT-APIMDIS+APIMGST,DOCTOTAL
          MOVE     ZERO,OUTSTTOT
          MOVE     APIMTYP,F1
          BRANCH   F1,TRNDET10,TRNDET20,TRNDET30,TRNDET40
.
          MOVE     "Inv ",DOCTYPE
          ADD      DOCTOTAL,SCRTOTAL
          ASSIGN   APIMTOT-APIMDIS+APIMGST-APIMPAY,OUTSTTOT
          GOTO     TRNDET99
.
TRNDET10  MOVE     "Crd ",DOCTYPE
          MULT     SEQ,DOCTOTAL
          ADD      DOCTOTAL,SCRTOTAL
          ASSIGN   APIMTOT-APIMDIS+APIMGST-APIMPAY,OUTSTTOT
          MULT     SEQ,OUTSTTOT
          GOTO     TRNDET99
.
TRNDET20  MOVE     "Pay ",DOCTYPE
          MOVE     APIMPAY,DOCTOTAL
          MULT     SEQ,DOCTOTAL
          ADD      DOCTOTAL,SCRTOTAL
          GOTO     TRNDET99
.
TRNDET30  MOVE     "Can ",DOCTYPE
          MOVE     APIMPAY,DOCTOTAL
          GOTO     TRNDET99
.
TRNDET40  MOVE     "Rein",DOCTYPE
          ADD      DOCTOTAL,SCRTOTAL
          GOTO     TRNDET99
.
TRNDET99
          RETURN
.--------------------------------------------------
. Display Transaction Details
.--------------------------------------------------
DTRN0000  MATCH     "04",SCRID
          GOTO      DTRN1400 IF EQUAL
.
          MATCH     "05",SCRID
          GOTO      DTRN1500 IF EQUAL
.
          MATCH     "06",SCRID
          GOTO      DTRN1600 IF EQUAL
.
          MATCH     "07",SCRID
          GOTO      DTRN1700 IF EQUAL
.
          MATCH     "08",SCRID
          GOTO      DTRN1800 IF EQUAL
.
DTRN1400  UNPACK    APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH
          GOTO      DTRN2000
.
DTRN1500  UNPACK    APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH
          GOTO      DTRN2000
.
DTRN1600  UNPACK    APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH
          GOTO      DTRN2000
.
DTRN1700  UNPACK    APIN2MKY,APIMCRD,KEY8,APIMREF,APIMDOC,APIMBCH
          GOTO      DTRN2000
.
DTRN1800  UNPACK    APIM6MKY,KEY1,APIMCRD,APIMREF,APIMDOC,APIMBCH
          GOTO      DTRN2000
.
DTRN2000  PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
          CALL      RDAPIM1
          BRANCH    OVRCD,DTRN9000
.
          MOVE      APIMTYP,F1
          BRANCH    F1,DTRN2010,DTRN2020,DTRN2030,DTRN2040
          MOVE      "Invoices          ",TRNTYPE
          GOTO      DTRN2100
.
DTRN2010  MOVE      "Credit Notes      ",TRNTYPE
          MULT      SEQ,APIMTOT
          MULT      SEQ,APIMDIS
          MULT      SEQ,APIMGST
          MULT      SEQ,APIMPAY
          GOTO      DTRN2100
.
DTRN2020  MOVE      "Payments          ",TRNTYPE
          MULT      SEQ,APIMTOT
          MULT      SEQ,APIMDIS
          MULT      SEQ,APIMGST
          MULT      SEQ,APIMPAY
          GOTO      DTRN2100
.
DTRN2030  MOVE      "Cancelled Payments",TRNTYPE
          GOTO      DTRN2100
.
DTRN2040  MOVE      "Reinstate Invoices",TRNTYPE
          GOTO      DTRN2100
.
DTRN2100  MOVE      APIMTER,KEY2
          CALL      RDAPPP1
          IF        OVRCD=0
            MOVE      APPPDES,TRNTERM
          ENDIF
          MOVE      APMAPPD,KEY2
          CALL      RDAPPP1
          IF        OVRCD=1
            MOVE      SP70,OFFSDESC
            MOVE      SP70,APPPDES
            MOVE      ZERO,APPPTYP
            MOVE      ZERO,APPPDA1
            MOVE      ZERO,APPPPE1
            MOVE      ZERO,APPPDA2
            MOVE      ZERO,APPPPE2
            MOVE      ZERO,APPPDA3
            MOVE      ZERO,APPPPE3
          ENDIF
.
          ASSIGN    APIMTOT-APIMDIS+APIMGST-APIMPAY,TRNOUTS
          CALL      SC11L000
          GOTO      DTRN9999
.
DTRN9000  BEEP
.
DTRN9999  RETURN
.----------------------------------------------------------------------
. Keyin Date
.----------------------------------------------------------------------
KDATE000
          PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
          DISPLAY   *P1:24,"Search for Date : ",*EF;
.
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          PACK      KEY8,CCC,CYY,CMM,SP70             * default to blank date
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY        * set up date parameters
          CALL      KEYDATE                           * keyin date
.
          PACK      KEY8,CCENT,CYEAR,CMON,CDAY        * pack desired date
          LOAD      KEY8,OVRCD,SP70
          MOVE      OVRCD,EXIT                        * 0=continue 1=nothing ent
.
          CALL      MESSAGE3
.
          PACK      KEY48,APMACRD,KEY8,Z70            * display data
          CALL      RSAPIM2
          CALL      DP04L000
.
KDATE999  RETURN
.--------------------------------------------------
. Clear Reference
.--------------------------------------------------
CLRREF00   MOVE      SP70,INVREFER
           MOVE      ZERO,SCRTOTAL
           CALL      DISPTOP0
           RETURN
.--------------------------------------------------
. Display Top Part
.--------------------------------------------------
DISPTOP0
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACRD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CRDNAM80,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CRDADD80,VAR
            CALL      DISPITEM
          ENDIF
.
DISPTOP9  RETURN
.
GENINT00  MOVE      ZERO,TOTALINV
          PACK      KEY40,APMACRD,INVREFER,SP70
          CALL      RSAPIM3
.
GENINT10  CALL      RKAPIM3
          BRANCH    OVRCD,GENINT99
.
          MATCH     APMACRD,APIMCRD
          GOTO      GENINT99 IF NOT EQUAL
.
          MATCH     INVREFER,APIMREF
          GOTO      GENINT99 IF NOT EQUAL
.
          MATCH     "1",APIMUPD
          GOTO      GENINT10 IF NOT EQUAL
.
          MOVE      APIMTYP,F1
          BRANCH    F1,GENINT30,GENINT30,GENINT10,GENINT20
.
GENINT20  ASSIGN    TOTALINV+APIMTOT-APIMDIS+APIMGST,TOTALINV
          GOTO      GENINT10
.
GENINT30  ASSIGN    TOTALINV-APIMTOT+APIMDIS-APIMGST,TOTALINV
          GOTO      GENINT10
.
.
GENINT99  RETURN
.
GENDOC00  MOVE      ZERO,TOTALINV
          PACK      KEY40,APMACRD,DOCREFER,SP70
          CALL      RSAPIM4
.
GENDOC10  CALL      RKAPIM4
          BRANCH    OVRCD,GENDOC99
.
          MATCH     APMACRD,APIMCRD
          GOTO      GENDOC99 IF NOT EQUAL
.
          MATCH     DOCREFER,APIMDOC
          GOTO      GENDOC99 IF NOT EQUAL
.
          MATCH     "1",APIMUPD
          GOTO      GENDOC10 IF NOT EQUAL
.
          MOVE      APIMTYP,F1
          BRANCH    F1,GENDOC30,GENDOC30,GENDOC10,GENDOC20
.
GENDOC20  ASSIGN    TOTALINV+APIMTOT-APIMDIS+APIMGST,TOTALINV
          GOTO      GENDOC10
.
GENDOC30  ASSIGN    TOTALINV-APIMTOT+APIMDIS-APIMGST,TOTALINV
          GOTO      GENDOC10
.
GENDOC99  RETURN
.--------------------------------------------------
. Enter Document for Search
.--------------------------------------------------
EDOCR000   MOVE      SP70,DOCREFER
           MOVE      SP70,KEY8
           BRANCH    CHEQUEYN,EDOCR500
           KEYIN     *PCCOL:CVERT,*V2LON,DOCREFER
           ENDSET    DOCREFER
           APPEND    SP70,DOCREFER
           RESET     DOCREFER
           MATCH     SP70,DOCREFER
           GOTO      EDOCR900 IF EQUAL
           MATCH     EXITCHAR,DOCREFER
           GOTO      EDOCR900 IF EQUAL
           MOVE      ZERO,EXIT
           GOTO      EDOCR999
.
EDOCR500   KEYIN     *PCCOL:CVERT,*V2LON,*JR,KEY8
           ENDSET    KEY8
           APPEND    SP70,KEY8
           RESET     KEY8
.
           MATCH     SP70,KEY8
           GOTO      EDOCR900 IF EQUAL
.
           ENDSET    KEY8
           CMATCH    EXITCHAR,KEY8
           GOTO      EDOCR900 IF EQUAL
           RESET     KEY8
           PACK      DOCREFER,SP7,KEY8
           MOVE      ZERO,EXIT
           GOTO      EDOCR999
.
EDOCR900   MOVE      TWO,EXIT
.
EDOCR999   RETURN
.--------------------------------------------------------------------
. Print Creditor Report
.--------------------------------------------------------------------
.
REPT0000  MOVE      ZERO,CPAGENO
          MOVE      "99",CLNO
          CLOCK     TIME,CTIMEIS
          DISPLAY   *P70:24,"Printing",*W1;
.
          MOVE      ZERO,TOTALINV
          PACK      KEY40,APMACRD,DOCREFER,SP70
          CALL      RSAPIM4
.
REPT1000  CALL      RKAPIM4
          BRANCH    OVRCD,REPT9000
.
          MATCH     APMACRD,APIMCRD
          GOTO      REPT9000 IF NOT EQUAL
.
          MATCH     DOCREFER,APIMDOC
          GOTO      REPT9000 IF NOT EQUAL
.
          MATCH     "1",APIMUPD
          GOTO      REPT1000 IF NOT EQUAL
          MATCH     "3",APIMTYP
          GOTO      REPT1000 IF EQUAL
.
REPT2000  COMPARE   "56",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DIM10
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DIM11
.
          MOVE      APIMTYP,F1
          BRANCH    F1,REPT2010,REPT2020,REPT2030,REPT2040
.
          MOVE      "Inv ",DOCTYPE
          ASSIGN    APIMTOT-APIMDIS+APIMGST-APIMPAY,OUTSTTOT
          GOTO      REPT2050
.
REPT2010  MOVE      "Crd ",DOCTYPE
          ASSIGN    APIMTOT-APIMDIS+APIMGST-APIMPAY,OUTSTTOT
          GOTO      REPT2050
.
REPT2020  MOVE      "Pay ",DOCTYPE
          MOVE      APIMPAY,DOCTOTAL
          MULT      SEQ,DOCTOTAL
          MOVE      DOCTOTAL,OUTSTTOT
          GOTO      REPT2050
.
REPT2030  MOVE      "Can.",DOCTYPE
          MOVE      APIMPAY,OUTSTTOT
          GOTO      REPT2050
.
REPT2040  MOVE      "Rein",DOCTYPE
          MOVE      APIMPAY,OUTSTTOT
          GOTO      REPT2050
.
REPT2050  MOVE      OUTSTTOT,VAR
          CALL      FORMATRD
          MOVE      VAR,DIM16
REPT2070  PRINT     *1,APIMREF,*20,DIM10,*32,DIM11:
                    *46,APIMBCH,*54,DOCTYPE,*65,DIM16
.
.
.                                           * calculate final Doc. Total
          MOVE      APIMTYP,F1
          BRANCH    F1,REPT4000,REPT4000,REPT1000,REPT3000
.
REPT3000  ASSIGN    TOTALINV+APIMTOT-APIMDIS+APIMGST,TOTALINV
          GOTO      REPT1000
.
REPT4000  ASSIGN    TOTALINV-APIMTOT+APIMDIS-APIMGST,TOTALINV
          GOTO      REPT1000
.
.
.
REPT9000  MOVE      SP1,DIM1
          MOVE      TOTALINV,VAR
          CALL      FORMATRD
          MOVE      VAR,DIM16
.
          PRINT     *65,"---------------":
                    *N,*46,"Document Total",*65,DIM16:
                    *N,"----------------------------------------":
                    "----------------------------------------":
                    *N,"*** End of Report ***",*N,*N
.
          DISPLAY   *P70:24,*EL;
.
REPT9999  RETURN
.
.--------------------------------------------------------------------
. Print Creditor Report heading
.--------------------------------------------------------------------
.
HEAD0000  CALL      HEAD80
.
          PRINT     *1,"Creditor Code  : ",APMACRD,"  ",CRDNAM80:
                    *N,*25,CRDADD80:
                    *N,*1,"Document Ref.  : ",APIMDOC
          ADD       EIGHT,CLNO
.
HEAD1000  PRINT     *N,*1,"Invoice Ref.",*20,"Doc. Date",*32,"Inv. Date":
                    *46,"Batch",*54,"Type",*70,"Amount":
                    *N,"----------------------------------------":
                    "----------------------------------------"
          ADD       THREE,CLNO
.
HEAD9999  RETURN
.--------------------------------------------------------------------
.
GENORD00  MOVE      ZERO,TOTALINV
          PACK      KEY51,APMACRD,ORDERNO,SP70
          CALL      RSAPIN2
.
GENORD10  CALL      RKAPIN2
          BRANCH    OVRCD,GENORD99
.
          MATCH     APMACRD,APINCRD
          GOTO      GENORD99 IF NOT EQUAL
.
          MATCH     ORDERNO,APINORD
          GOTO      GENORD99 IF NOT EQUAL
.
          MATCH     "1",APINUPD
          GOTO      GENORD10 IF NOT EQUAL
.
          PACK      KEY40,APINBCH,APINCRD,APINREF,APINDOC
          CALL      RDAPIM1
          BRANCH    OVRCD,GENORD10
.
          MOVE      APIMTYP,F1
          BRANCH    F1,GENORD30,GENORD30,GENORD10,GENORD20
.
GENORD20  ASSIGN    TOTALINV+APINAMT+APINGST,TOTALINV
          GOTO      GENORD10
.
GENORD30  ASSIGN    TOTALINV-APINAMT-APINGST,TOTALINV
          GOTO      GENORD10
.
GENORD99  RETURN
.-------------------------------------------------------
. Get Master Details from INP Record
.-------------------------------------------------------
MASDET00  PACK      KEY40,APINBCH,APINCRD,APINREF,APINDOC
          CALL      RDAPIM1
          ASSIGN    APINAMT+APINGST,DOCTOTAL
          MOVE      APIMTYP,F1
          BRANCH    F1,MASDET10,MASDET20,MASDET30,MASDET40
          MOVE      "Inv ",DOCTYPE
          ADD       DOCTOTAL,SCRTOTAL
          GOTO      MASDET50
MASDET10  MOVE      "Crd ",DOCTYPE
          MULT      SEQ,DOCTOTAL
          ADD       DOCTOTAL,SCRTOTAL
          GOTO      MASDET50
MASDET20  MOVE      "Pay ",DOCTYPE
          MOVE      APINPAY,DOCTOTAL
          MULT      SEQ,DOCTOTAL
          ADD       DOCTOTAL,SCRTOTAL
          GOTO      MASDET50
MASDET30  MOVE      "Can.",DOCTYPE
          MOVE      APINPAY,DOCTOTAL
          GOTO      MASDET50
MASDET40  MOVE      "Rein",DOCTYPE
          MOVE      APINPAY,DOCTOTAL
          GOTO      MASDET50
MASDET50
          RETURN
.-------------------------------------------------------
. Enter Order Number
.-------------------------------------------------------
EORDN000  MOVE      SP70,KEY8
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,KEY8
          MOVE      KEY8,DIM8
          SQUEEZE   DIM8
          MOVE      DIM8,KEY1
.
          ENDSET    KEY8
          APPEND    SP70,KEY8
          RESET     KEY8
          MOVE      "1",FORM1
          WHILE     FORM1<=8
            CMATCH    KEY8,SP1
            IF        !@EQUAL
              CMOVE     SP1,KEY8
              MOVE      "8",FORM1
            ELSE
              BUMP      KEY8
            ENDIF
            ADD       "1",FORM1
          DO
          RESET     KEY8
          UNPACK    KEY8,ANS,KEY7
          PACK      KEY8,KEY1,KEY7
          MOVE      KEY8,ORDERNO
.
          MATCH     SP70,KEY8
          GOTO      EORDN900 IF EQUAL
          MATCH     EXITCHAR,KEY8
          GOTO      EORDN900 IF EQUAL
.
          CALL      RDAPCI1            * does order number exist ?
          COMPARE   ONE,OVRCD
          GOTO      EORDN999 IF NOT EQUAL
.
          PACK      KEY51,APMACRD,ORDERNO,SP70
          CALL      RSAPIN2
          CALL      RKAPIN2
          IF        OVRCD=0
            PACK      KEY20,APINCRD,APINORD,SP70
            MATCH     KEY20,KEY51
            GOTO      EORDN999 IF EQUAL
          ENDIF
.
          MOVE      "Order does not exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EORDN000
.
EORDN900
          MOVE      TWO,EXIT
EORDN999
          RETURN
.--------------------------------------------------
. Clear Reference
.--------------------------------------------------
CLEARF00   MOVE      SP70,INVREFER
           MOVE      ZERO,SCRTOTAL
.
           PACK      KEY21,APMACRD,SP70
           CALL      RSAPCI2
.
CLEARF10   CALL      RKAPCI2
           BRANCH    OVRCD,CLEARF99
.
           MATCH     APMACRD,APCICRD
           GOTO      CLEARF99 IF NOT EQUAL
.
           PACK      KEY14,APCIISC,APCIORD,SP70
           CALL      RSAPOD1
.
CLEARF20   CALL      RKAPOD1
           BRANCH    OVRCD,CLEARF10
.
           MATCH     APCIISC,APODISC
           GOTO      CLEARF10 IF NOT EQUAL
           MATCH     APCIORD,APODORD
           GOTO      CLEARF10 IF NOT EQUAL
.
           ADD       APODAMT,SCRTOTAL
           GOTO      CLEARF20
.
CLEARF99   RETURN
.--------------------------------------------------
. Display Order Details
.--------------------------------------------------
ORDDET00
          PACK       KEY1,APCIISC
          CALL       RDAPIS1
          PACK       KEY8,APCIISC,APCIORD
          PACK       KEY14,APCIISC,APCIORD,SP70
          MOVE       ZERO,ORDTOTAL
          MOVE       SP70,ORDSTAT
          CALL       RSAPOD1
ORDDET10
          CALL       RKAPOD1
          BRANCH     OVRCD,ORDDET90
          PACK       KEY14,APODISC,APODORD,APODCAT
          MATCH      KEY8,KEY14
          GOTO       ORDDET90 IF NOT EQUAL
          COMPARE    "-1",APODUCT
          GOTO       ORDDET20 IF EQUAL
          ADD        APODAMT,ORDTOTAL
          GOTO       ORDDET10
.
ORDDET20  MOVE       "T.B.A.",ORDSTAT
          GOTO       ORDDET10
.
ORDDET90  ADD        ORDTOTAL,SCRTOTAL
          RETURN
.--------------------------------------------------
. Display Order Details
.--------------------------------------------------
DETORD00  MOVE      APCI2MKY,KEY21
          CALL      RDAPCI2
          BRANCH    OVRCD,DETORD90
          MOVE      APCIISC,KEY1
          CALL      RDAPIS1
          PACK      KEY8,APCIISC,APCIORD,SP70
          PACK      KEY14,APCIISC,APCIORD,SP70
          MOVE      ZERO,ORDTOTAL
          CALL      RSAPOD1
.
DETORD10  CALL      RKAPOD1
          BRANCH    OVRCD,DETORD80
          PACK      KEY14,APODISC,APODORD,SP70
          MATCH     KEY8,KEY14
          GOTO      DETORD80 IF NOT EQUAL
          ADD       APODAMT,ORDTOTAL
          GOTO      DETORD10
.
DETORD80  BRANCH    INCOSTYP,DETORD81
          GOTO      DETORD82
.
DETORD81  MOVE      "sinpocaf",KEY8
          PACK      KEY80,APISDIR,KEY8
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SINPOCA1,KEY80
          TRAPCLR   IO
          BRANCH    OVRCD,DETORD85
.
DETORD82  CALL      SC14L000
          GOTO      DETORD99
.
DETORD85  CLEAR     DISPMSG
          APPEND    "Inventory Files Not Available in ",DISPMSG
          STRIP     APISDIR
          APPEND    APISDIR,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
DETORD90  BEEP
DETORD99  RETURN
.--------------------------------------------------
. Display Transaction Details
.--------------------------------------------------
GETAIN00
          MOVE      APIMTYP,F1
          BRANCH    F1,GETAIN10,GETAIN10,GETAIN20,GETAIN20
          GOTO      GETAIN20
GETAIN10
          MULT      SEQ,APINPAY
          MULT      SEQ,APINAMT
          MULT      SEQ,APINGST
          MULT      SEQ,APINUCT
          MULT      SEQ,APINQTY
GETAIN20  MATCH     SP70,APINCAT
          IF        @EQUAL
            PACK      KEY14,APINLED,APINACC
            CALL      RDFMAM1
            STRIP     APINDES
            STRIP     APINACC
            CLEAR     DESCAPIN
            APPEND    APINDES,DESCAPIN
            APPEND    " - ",DESCAPIN
            APPEND    APINLED,DESCAPIN
            APPEND    "/",DESCAPIN
            APPEND    APINACC,DESCAPIN
            APPEND    SP1,DESCAPIN
            APPEND    FMAMDESC,DESCAPIN
            RESET     DESCAPIN
          ELSE
            CLEAR     DESCAPIN
            APPEND    "Catalog : ",DESCAPIN
            APPEND    APINCAT,DESCAPIN
            MOVE      APINQTY,KEY13
            SQUEEZE   KEY13
            APPEND    " Qty : ",DESCAPIN
            APPEND    KEY13,DESCAPIN
            APPEND    " Cost: ",DESCAPIN
            MOVE      APINUCT,KEY17
            SQUEEZE   KEY17
            APPEND    KEY17,DESCAPIN
            RESET     DESCAPIN
          ENDIF
          RETURN
.--------------------------------------------------
. Display Item Details
.--------------------------------------------------
ITEM0000  MOVE      APIN1MKY,KEY51
          CALL      RDAPIN1
          BRANCH    OVRCD,ITEM9000
          PACK      KEY14,APINLED,APINACC
          CALL      RDFMAM1
          MOVE      APINLED,KEY2
          CALL      RDFMLA1
          MOVE      APINDIS,KEY5
          CALL      RDFMDS1
          MOVE      APINRES,KEY4
          CALL      RDFMRS1
          MATCH     SP70,APINCAT
          GOTO      ITEM5000 IF EQUAL
.
          UNPACK    APINORD,KEY1,KEY7
          CALL      RDAPIS1          * Read Inventory Directory Information
          BRANCH    OVRCD,ITEM5000
          BRANCH    APISTYP,ITEM4000
          BRANCH    INCOSTYP,ITEM2000
          GOTO      ITEM9999
.
ITEM2000  CALL      SYSSIN00
          BRANCH    EXIT,ITEM4000
          CALL      SC15L000
          GOTO      ITEM9999
.
ITEM4000  MOVE      ZERO,EXIT
          CLEAR     DISPMSG
          APPEND    "Inventory Files Not Available in ",DISPMSG
          STRIP     APISDIR
          APPEND    APISDIR,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
.
ITEM5000  CALL      SC12L000
          GOTO      ITEM9999
.
ITEM9000  BEEP
ITEM9999  RETURN
.
SYSSIN00  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          MOVE      "sinpocaf",KEY8
          PACK      KEY80,APISDIR,KEY8
          SQUEEZE   KEY80
          OPEN      SINPOCA1,KEY80
          TRAPCLR   IO
          BRANCH    OVRCD,SYSSIN90
.
          UNPACK    APINORD,KEY1,KEY7
          UNPACK    APINCAT,KEY3,KEY2
          PACK      KEY10,KEY7,KEY3
          CALL      RDSIPC1
          IF        OVRCD=1
            CLEAR     DISPMSG
            APPEND    "Missing Order/Item : ",DISPMSG
            APPEND    KEY7,DISPMSG
            APPEND    "/",DISPMSG
            APPEND    KEY3,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SYSSIN99
SYSSIN90  MOVE      ONE,EXIT
SYSSIN99  RETURN
.
CATCOD00   BRANCH     INCOSTYP,CATCOD10
           MOVE       APODCAT,CATALOG
           GOTO       CATCOD99
.
CATCOD10   UNPACK     APODCAT,KEY3,KEY2
           PACK       KEY10,APODORD,KEY3
           CALL       RDSIPC1
           MOVE       SIPCCAT,CATALOG
           MATCH      SP70,CATALOG
           IF         @EQUAL
             PACK       CATALOG,KEY3,SLASH,KEY2
           ENDIF
CATCOD99   RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCIOIO/INC
          INC       APSCKIKY    
          INC       APSCNTIO/INC
          INC       APSCTSIO/INC
          INC       APSIMSIO/INC
          INC       APSINPIO/INC
          INC       APSISLIO/INC
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSORDIO/INC
          INC       APSPPDIO/INC
          INC       APSSNTIO/INC
          INC       FMSAMAIO/INC
          INC       FMSCODIO/INC
          INC       FMSDISIO/INC
          INC       FMSLMAIO/INC
          INC       FMSRESIO/INC
          INC       SINPOCIO/INC
.
          INC       STDGENCD
.
