.
.---------------------------------------------------------------------------
.   System    :   Patient System (New Standards)     
.   Include   :   CEADOCKY
.   Routine   :   KPDOCA00 Keyin Doctors Code        
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KPDOCA00  TOPIC     "DCODE "
          MOVE      UNDLN70,DCODE 
          KEYIN     *PCCOL:CVERT,*DV,DCODE:                                   
                    *PCCOL:CVERT,*V2LON,DCODE:                                
                    *PCCOL:CVERT,*DV,DCODE 
.
          ENDSET    DCODE 
          APPEND    SP70,DCODE 
          RESET     DCODE 
.
          MATCH     SP70,DCODE 
          GOTO      KPDOCA90 IF EQUAL
.
          CMATCH    EXITCHAR,DCODE 
          GOTO      KPDOCA95 IF EQUAL
.
          CMATCH    QUEST,DCODE 
          GOTO      KPDOCA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HPDOCA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DCODE 
          APPEND    SP70,DCODE 
          RESET     DCODE 
.
          MATCH     SP70,DCODE 
          GOTO      KPDOCA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DCODE                                 
KPDOCA10
          PACK      KEY6,DCODE                                                
          CALL      RDADOCT1 
          BRANCH    OVRCD,KPDOCA80
          BRANCH    CKEYTYP,KPDOCA75
          CALL      RDDOCT1 
KPDOCA70
          MOVE      ZERO,EXIT
          GOTO      KPDOCA99
KPDOCA75
          MOVE      "Doctors Code Already Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KPDOCA00
KPDOCA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KPDOCA99,KPDOCA99
          MOVE      "Doctors Code Does Not Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KPDOCA00
KPDOCA90
          MOVE      ONE,EXIT
          GOTO      KPDOCA99
KPDOCA95
          MOVE      TWO,EXIT
KPDOCA99  TOPIC     PRGID
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Patient System (New Standards)     
.   Include   :   CEADOCKY
.   Routine   :   HPDOCA00 Doctors Code        
.   Return    :           
.-------------------------------------------------------------------------------
HPDOCA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HPDOCA04
          CALL      GSCRN000
          BRANCH    EXIT,HPDOCA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Dr Code"            
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 8",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Title"              
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 9",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Surname"            
.
          MOVE      STDCOL03,STDCOL04
          ADD       "21",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Given Names"        
.
          MOVE      STDCOL04,STDCOL05
          ADD       "26",STDCOL05
HPDOCA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,DCODE 
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          CALL      RDSDOCT1 
HPDOCA10
          CALL      RDKDOCT1 
          BRANCH    OVRCD,HPDOCA15
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          BRANCH    CSEARCH,HPDOCA12
          CALL      HPDOCA60
          BRANCH    OVRCD,HPDOCA10
HPDOCA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY6,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,DCODE 
          DISPLAY   *PSTDCOL02:STDROW,DTITL 
          DISPLAY   *PSTDCOL03:STDROW,DSNAME 
          DISPLAY   *PSTDCOL04:STDROW,DGNAME 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HPDOCA10 IF NOT EQUAL
HPDOCA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HPDOCA20
          CALL      HSCRI000
          BRANCH    EXIT,HPDOCA30,HPDOCA35,HPDOCA40,HPDOCA45,HPDOCA04:
                              HPDOCA91,HPDOCA50
          GOTO      HPDOCA92
HPDOCA30
          CALL      RDKDOCT1 
          BRANCH    OVRCD,HPDOCA85
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          CALL      RDPDOCT1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPDOCA10
HPDOCA35
          MOVE      ST1,KEY6 
          CALL      RDDOCT1 
          CALL      RDPDOCT1 
          BRANCH    OVRCD,HPDOCA85
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HPDOCA36
          CALL      RDPDOCT1 
          BRANCH    OVRCD,HPDOCA37
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HPDOCA36 IF NOT EQUAL
HPDOCA37
          MOVE      ZERO,XITEMNO
          GOTO      HPDOCA10
HPDOCA40
          MOVE      ST1,KEY6 
          CALL      RDDOCT1 
          CALL      RDPDOCT1 
          BRANCH    OVRCD,HPDOCA85
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPDOCA08
HPDOCA45
          CALL      RDKDOCT1 
          BRANCH    OVRCD,HPDOCA85
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY6,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RDSDOCT1 
HPDOCA46
          CALL      RDPDOCT1 
          BRANCH    OVRCD,HPDOCA47
          PACK      KEY6,DCODE,SP70                                           
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HPDOCA46 IF NOT EQUAL
HPDOCA47
          MOVE      ZERO,XITEMNO
          GOTO      HPDOCA10
HPDOCA50  COMPARE   ZERO,CSEARCH
          GOTO      HPDOCA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPDOCA08
HPDOCA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPDOCA08
HPDOCA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HPDOCA61 IF EQUAL
          MATCH     SCHFLD01,DCODE 
          GOTO      HPDOCA72 IF NOT EQUAL
HPDOCA61
          MATCH     SP70,SCHFLD02
          GOTO      HPDOCA62 IF EQUAL
          MATCH     SCHFLD02,DTITL 
          GOTO      HPDOCA72 IF NOT EQUAL
HPDOCA62
          MATCH     SP70,SCHFLD03
          GOTO      HPDOCA63 IF EQUAL
          MATCH     SCHFLD03,DSNAME 
          GOTO      HPDOCA72 IF NOT EQUAL
HPDOCA63
          MATCH     SP70,SCHFLD04
          GOTO      HPDOCA64 IF EQUAL
          MATCH     SCHFLD04,DGNAME 
          GOTO      HPDOCA72 IF NOT EQUAL
HPDOCA64
HPDOCA65
HPDOCA66
HPDOCA67
HPDOCA68
HPDOCA69
HPDOCA70
          GOTO      HPDOCA75
HPDOCA72  MOVE      ONE,OVRCD
HPDOCA75  RETURN
HPDOCA85
          LOAD      KEY6,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY6,DCODE                                                
          CALL      RDDOCT1 
HPDOCA90
.                                                                               
          BEEP
          GOTO      HPDOCA20
HPDOCA91
          MOVE      SP70,DTITL 
          MOVE      SP70,DGNAME 
          MOVE      SP70,DSNAME 
          MOVE      SP70,DRTYPE
          MOVE      SP70,DRNAME
          MOVE      SP70,DSADD1 
          MOVE      SP70,DSADD2 
          MOVE      SP70,DSADD3 
          MOVE      SP70,DSADD4 
          MOVE      SP70,DSPOST
          MOVE      SP70,PTDOSEML
          MOVE      SP70,DTELES
          MOVE      SP70,DTELEP
          MOVE      SP70,DPAGER
          MOVE      SP70,DASSOC1 
          MOVE      SP70,DASSOC2 
          MOVE      SP70,DASSOC3 
          MOVE      SP70,DASSOC4 
          MOVE      SP70,DASSOC5 
          MOVE      SP70,DPROV
          MOVE      SP70,DTELEH
          MOVE      SP70,DHADD1
          MOVE      SP70,DHADD2
          MOVE      SP70,DHADD3
          MOVE      SP70,DHADD4
          MOVE      SP70,DHPOST
          MOVE      SP70,PTDOHEML
          MOVE      SP70,DAFIRST
          MOVE      SP70,DALAST
          MOVE      ZERO,DAYEARS
          MOVE      SP70,DACCRED
          MOVE      SP70,DRTYPE2 
          MOVE      SP70,DRTYPE3 
          MOVE      SP70,DRTYPE4 
          MOVE      SP70,DRTYPE5 
          MOVE      SP70,DFSPARE
          MOVE      SP70,DBIRTH 
          MOVE      ZERO,DHCSCOD
          MOVE      SP70,DALEVEL
          MOVE      ZERO,DRSTAT
          MOVE      SP70,PTDOFAXN
          MOVE      SP70,PTDOHFAX
          MOVE      SP70,PTDOMOBL
          MOVE      SP70,PTDOGLCC
          MOVE      SP70,PTDOWHDP
          MOVE      SP70,PTDOMREG
          MOVE      SP70,PTDONHSN
          MOVE      SP70,DLUPDDTE
          MOVE      SP70,DLUPDTME
          MOVE      SP70,PTDOUDF1
          MOVE      SP70,PTDOUDF2
          MOVE      SP70,PTDOUDF3
          MOVE      SP70,PTDOUDF4
          MOVE      SP70,PTDOUDF5
          MOVE      SP70,PTDOINSC
          MOVE      SP70,PTDOINSN
          MOVE      SP70,PTDOINSF
          MOVE      SP70,PTDOINST
          MOVE      SP70,PTDOREGN
          MOVE      SP70,PTDOREGF
          MOVE      SP70,PTDOREGT
          MOVE      SP70,PTDOVISA
          MOVE      SP70,PTDOCOMT
          MOVE      SP70,PTDOPREF
          MOVE      SP70,PTDOABNN
          MOVE      SP70,PTDODINA
          MOVE      SP70,PTDODACT
          MOVE      SP70,PTDODACO
          MOVE      SP70,PTDOPRO2
          MOVE      SP70,PTDOPRO3
          MOVE      SP70,PTDOPRO4
          MOVE      SP70,PTDOPRO5
          MOVE      SP70,DASPARE
          MOVE      SP70,KEY6 
          MOVE      SP70,DCODE 
          GOTO      HPDOCA96
HPDOCA92
          MOVE      SP70,KEY6 
          MOVE      SP70,DCODE 
          LOAD      KEY6,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY6,DCODE                                                
HPDOCA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HPDOCA99
          RETURN
