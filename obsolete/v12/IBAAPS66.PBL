.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
.V10.02.01  07/04/2011 Mike Laming for Jill CAR 239574
.           Remove CALL to ' IBAPRNT1,"ibaprntf" '
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.01.01  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS66
.   Function      :   Subjective/Charge Code Maintenance      
.   Generated  On :   07/04/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSSCXFD/INC
          INC       APSTMPDF    
          INC       FMSAMADF    
          INC       FMSAMAFD/INC
          INC       FMSCONFD/INC
          INC       FMSLMAFD/INC
          INC       FMSSBAFD/INC
          INC       FMSXCSFD/INC
          INC       IBAPRNFD/INC
.=========================
.Local Variable Definition
.-------------------------
CHARGE    DIM      12 * Scr 01 Fld     5
LEDGER    DIM       2 * Scr 01 Fld     6
FROMSUB   DIM      12 * Scr 01 Fld     7
TOSUB     DIM      12 * Scr 01 Fld     9
FROMLA12  DIM      12 * Scr 03 Fld     4
TOLA12    DIM      12 * Scr 03 Fld     5
FROMLA15  DIM      15 * Scr 04 Fld     4
TOLA15    DIM      15 * Scr 04 Fld     5
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS66"
PRGNAM    INIT      "Subjective/Charge Code Maintenance      "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      OPEN0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsscxaf";
          OPEN      APSSCXA1,"apsscxaf"
          DISPLAY   *P56:24,"Opening apsscxaf";
          OPEN      APSSCXA2,"apsscxaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA2,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA3,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA4,"fmsamaaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 43",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudam";
            OPEN      FMSAUDAM,"fmsaudam"
          ENDIF
          MOVE      "   51",AUDTSECT
          MOVE      " 46",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudla";
            OPEN      FMSAUDLA,"fmsaudla"
          ENDIF
          MOVE      "   51",AUDTSECT
          MOVE      " 44",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudsa";
            OPEN      FMSAUDSA,"fmsaudsa"
          ENDIF
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening  fmssbaaf           ";
          OPEN      FMSSBAA1,"fmssbaaf"          
          DISPLAY   *P56:24,"Opening  fmssbaaf           ";
          OPEN      FMSSBAA2,"fmssbaaf"          
          DISPLAY   *P56:24,"Opening  fmsxcsaf           ";
          OPEN      FMSXCSA1,"fmsxcsaf"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Menu                          
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Modify Charge Code by Subjective   
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Modify Charge Code by Account      
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Print by Charge Code               
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Print By Subjective/Account        
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Print Invalid Accounts             
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Menu                          
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Menu                          
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Menu                          
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Menu                          
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Menu                          
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Menu                          
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Menu                          
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Menu                          
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      PRNT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      GSTR0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Modify Charge Code by Subjective   
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETSCR01
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Modify Charge Code by Subjective   
.-------------------------------------------------------
CF01L000
          MOVE      SP70,CHARGE  
          MOVE      SP70,LEDGER  
          MOVE      SP70,FROMSUB 
          MOVE      SP70,DESC1   
          MOVE      SP70,TOSUB   
          MOVE      SP70,DESC2   
          MOVE      SP70,FMLADESC
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Modify Charge Code by Subjective   
.--------------------------------------------------------
KY01L000
.
KY01L110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KAPSCA00
          MOVE      APSCCOD,CHARGE
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      OVRCD,ACCEPT
          MOVE      CHARGE,VAR       
          CALL      DISPITEM
.
KY01L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMLADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KFMLAA00
          MOVE      FMLALEDG,LEDGER
          BRANCH    EXIT,KY01L110,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      LEDGER,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMLADESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY01L130
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCODF000
          BRANCH    EXIT,KY01L120,KY01L900
          MOVE      ZERO,ACCEPT
          CALL      SSUBJ000
          MOVE      FROMSUB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC1,VAR        
            CALL      DISPITEM
          ENDIF
.
KY01L140
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC2   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCODT000
          BRANCH    EXIT,KY01L130,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      TOSUB,VAR        
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC2,VAR        
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Modify Charge Code by Subjective   
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Modify Charge Code by Subjective   
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Modify Charge Code by Subjective   
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Modify Charge Code by Subjective   
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L999,PS01L102,PS01L103
          GOTO     PS01L999
.
PS01L101
          MOVE      DESC1,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      DESC2,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Modify Charge Code by Subjective   
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      WAPSC000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      DAPSC000
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Modify Charge Code by Account      
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      SETSCR02
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Modify Charge Code by Account      
.-------------------------------------------------------
CF02L000
          MOVE      SP70,CHARGE  
          MOVE      SP70,LEDGER  
          MOVE      SP70,FROMSUB 
          MOVE      SP70,DESC1   
          MOVE      SP70,TOSUB   
          MOVE      SP70,DESC2   
          MOVE      SP70,FMLADESC
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Modify Charge Code by Account      
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KAPSCA00
          MOVE      APSCCOD,CHARGE
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      OVRCD,ACCEPT
          MOVE      CHARGE,VAR       
          CALL      DISPITEM
.
KY02L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMLADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KFMLAA00
          MOVE      FMLALEDG,LEDGER
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      LEDGER,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMLADESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY02L130
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCODF000
          BRANCH    EXIT,KY02L120,KY02L900
          MOVE      ZERO,ACCEPT
          CALL      SSUBJ000
          MOVE      FROMSUB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC1,VAR        
            CALL      DISPITEM
          ENDIF
.
KY02L140
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESC2   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCODT000
          BRANCH    EXIT,KY02L130,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      TOSUB,VAR        
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESC2,VAR        
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Modify Charge Code by Account      
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Modify Charge Code by Account      
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Modify Charge Code by Account      
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Modify Charge Code by Account      
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L999,PS02L102,PS02L103
          GOTO     PS02L999
.
PS02L101
          MOVE      DESC1,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      DESC2,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Modify Charge Code by Account      
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      WAPSC000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          CALL      DAPSC000
          MOVE      ONE,EXIT
          GOTO      SF02L999
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Print by Charge Code               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      SETACCEP
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print by Charge Code               
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMLA12
          MOVE      SP70,TOLA12  
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print by Charge Code               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print by Charge Code               
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print by Charge Code               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print by Charge Code               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print by Charge Code               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMLA12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      TOLA12,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Print by Charge Code               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L104
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNTA000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCDF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMLA12,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      TOLA12,VAR       
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Print By Subjective/Account        
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      SETACCEP
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print By Subjective/Account        
.-------------------------------------------------------
CF04L000
          MOVE      SP70,FROMLA15
          MOVE      SP70,TOLA15  
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print By Subjective/Account        
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print By Subjective/Account        
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print By Subjective/Account        
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print By Subjective/Account        
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print By Subjective/Account        
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMLA15,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      TOLA15,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Print By Subjective/Account        
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L104
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L104
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNTB000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSACF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMLA15,VAR     
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSACT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      TOLA15,VAR       
          CALL      DISPITEM
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Print Invalid Accounts             
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      SETACCEP
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print Invalid Accounts             
.-------------------------------------------------------
CF05L000
          MOVE      SP70,FROMLA15
          MOVE      SP70,TOLA15  
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print Invalid Accounts             
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print Invalid Accounts             
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print Invalid Accounts             
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print Invalid Accounts             
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print Invalid Accounts             
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L101:
                            PS05L102
          GOTO     PS05L999
.
PS05L101
          MOVE      FROMLA15,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      TOLA15,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Print Invalid Accounts             
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L103:
                            SF05L104
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L103:
                            SF05L104
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRTIN000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF05L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF05L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF05L999
          ENDIF
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF05L000
          ENDIF
          GOTO      SF05L001
.
SF05L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIACF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMLA15,VAR     
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIACT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
            BRANCH    EXIT,SF05L104,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      TOLA15,VAR       
          CALL      DISPITEM
          GOTO     SF05L001
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Open files and read parameters
.----------------------------------------------------------------------
OPEN0000
          CALL      RDFMCO50
          CALL      RDFMCO51
          CALL      RDFMCO52
          CALL      RDFMCO65
.
OPEN9999  RETURN
.**********************************************************************
. PRNTA - print by charge code
.**********************************************************************
PRNTA000  MOVE      "1",OPTIONA
          CALL      PRNT0000           * print data
.
PRNTA999  RETURN
.**********************************************************************
. PRNTB - print by charge code
.**********************************************************************
PRNTB000  MOVE      "2",OPTIONA
          CALL      PRNT0000           * print data
.
PRNTB999  RETURN
.**********************************************************************
. PRNT - print routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
PRNT0000
          OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
          CALL      OPNPRINT
.
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          CALL      PDAT0000                * print routine
          CALL      MESSAGE3
          BRANCH    EXIT,PRNT9000
.                                           * check if anything to print
          IF        CPAGENO>0
            CALL      SELPRINT
          ELSE
            MOVE      "Nothing to Print !! - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
          MOVE      ZERO,EXIT               * 0=printed ok
.
PRNT9000  CALL      CLSPRINT
          CLOSE     IBACODE1                * close files
...       CLOSE     IBAPRNT1
.
PRNT9999  RETURN
.**********************************************************************
. PDAT - Print data                              Called by PDAT0000
.**********************************************************************
PDAT0000
          IF        OPTIONA=1
            MATCH     FROMCO12,TOCO12
            IF        @LESS
              DISPLAY   *P1:24,"Illegal Range - ",DISPMSG
              CALL      HITENTER
              GOTO      PDAT9500
            ENDIF
          ELSE
            MATCH     FROMCO14,TOCO14
            IF        @LESS
              DISPLAY   *P1:24,"Illegal Range - ",DISPMSG
              CALL      HITENTER
              GOTO      PDAT9500
            ENDIF
          ENDIF
.
          DISPLAY   *P50:24,"Printing :   ";
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "999",CLNO                   * init last line number
.
          CALL      FILE0000                    * go to correct position in file
.
PDAT1000  CALL      NREC0000                     * get next record
          BRANCH    OVRCD,PDAT9000               * end of file ?
.
          DISPLAY   *P61:24,*V2LON,APSCCOD,*EL;
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
.
          CALL      WRIT0000                     * print details
          GOTO      PDAT1000                     * get next record
.
PDAT9000  COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL          * print header if nothing printed
          CALL      UND80                        * print line
          PRINT     "****   End of Report   ****"
          MOVE      ZERO,EXIT
          GOTO      PDAT9999
.
PDAT9500  MOVE      ONE,EXIT
.
PDAT9999  RETURN
.**********************************************************************
.  FILE - Set file pointer                             Called By PDAT
.**********************************************************************
FILE0000  BRANCH    OPTIONA,FILE0100,FILE0200,FILE9999,FILE9999:
                            FILE9999,FILE9999,FILE9999,FILE9999
.
.---- print by type 1 ----
.
FILE0100  PACK      KEY26,FROMCO12,SP70
          CALL      RSAPSC1
          GOTO      FILE9999
.
.---- print by type 2 ----
.
FILE0200  PACK      KEY26,FROMCO14,SP70
          CALL      RSAPSC2
          GOTO      FILE9999
.
FILE9999  RETURN
.**********************************************************************
.  NREC - Get next record                              Called By PDAT
.**********************************************************************
NREC0000  BRANCH    OPTIONA,NREC0100,NREC0200,NREC9999,NREC9999:
                            NREC9999,NREC9999,NREC9999,NREC9999
.
.---- print by type 1 ----
.
NREC0100  CALL      RKAPSC1
          BRANCH    OVRCD,NREC9500
          MATCH     APSCCOD,TOCO12
          GOTO      NREC9500 IF LESS
          GOTO      NREC9000
.
.---- print by type 2 ----
.
NREC0200  CALL      RKAPSC2
          BRANCH    OVRCD,NREC9500
          PACK      KEY14,APSCLED,APSCSUB,SP70
          MATCH     KEY14,TOCO14
          GOTO      NREC9500 IF LESS
          GOTO      NREC9000
.
NREC9000  MOVE      ZERO,OVRCD         * continue
          GOTO      NREC9999
.
NREC9500  MOVE      ONE,OVRCD          * quit
.
NREC9999  RETURN
.********************************************************************
. HEAD - print report                               Called by PDAT
.********************************************************************
HEAD0000  CALL      HEAD80                       * print heading
          CALL      UND80                        * print line
          PRINT     "| Charge Code  | Type | Subjective/Account":
                    *80,"|"
          ADD       "1",CLNO
          CALL      UND80                        * print line
.
HEAD9999  RETURN
.********************************************************************
. WRIT - print data line                            Called by PDAT
.********************************************************************
WRIT0000
          MATCH     SP70,APSCTYP
          IF        @EQUAL
            MOVE      SP70,FMSADESC
            PACK      KEY14,APSCLED,APSCSUB,SP70
            CALL      RDFMSA1
            MOVE      FMSADESC,KEY35
            MOVE      "Subj",KEY4
          ELSE
            MOVE      SP70,FMAMDESC
            PACK      KEY14,APSCLED,APSCSUB,SP70
            CALL      RDFMAM1
            MOVE      FMAMDESC,KEY35
            MOVE      "Acct",KEY4
          ENDIF
.
          PRINT     "| ",APSCCOD," | ",KEY4," | ":
                    APSCLED,SLASH,APSCSUB,SP2,KEY35:
                    *80,"|"
          ADD       "1",CLNO           * add one to line number
.
WRIT9999  RETURN
.*****************************************************************************
. GSTR - get a string of a specified length           Called by lots
.    Requires - CCOL, CVERT  (screen address to get input)
.               CSTRLEN      (string length - up to 35 chars)
.    Returns  - CSTRING      (string entered)
.*****************************************************************************
GSTR0000  STORE     UNDLN70,CSTRLEN,KEY1:
                    KEY2,KEY3,KEY4,KEY5,KEY6,KEY7,KEY8,KEY9,KEY10:
                    KEY11,KEY12,KEY13,KEY14,KEY15,KEY16,KEY17,KEY18,KEY19,KEY20:
                    KEY21,KEY22,KEY23,KEY24,KEY25,KEY26,KEY27,KEY28,KEY29,KEY30:
                    KEY31,KEY32,KEY33,KEY34,KEY35
          BRANCH    CSTRLEN,GSTR0001,GSTR0002,GSTR0003,GSTR0004:
                            GSTR0005,GSTR0006,GSTR0007,GSTR0008:
                            GSTR0009,GSTR0010,GSTR0011,GSTR0012:
                            GSTR0013,GSTR0014,GSTR0015,GSTR0016:
                            GSTR0017,GSTR0018,GSTR0019,GSTR0020:
                            GSTR0021,GSTR0022,GSTR0023,GSTR0024:
                            GSTR0025,GSTR0026,GSTR0027,GSTR0028:
                            GSTR0029,GSTR0030,GSTR0031,GSTR0032:
                            GSTR0033,GSTR0034,GSTR0035
.
GSTR0001  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY1:
                    *PCCOL:CVERT,*V2LON,KEY1;
          GOTO      GSTR0090
.
GSTR0002  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY2:
                    *PCCOL:CVERT,*V2LON,KEY2;
          GOTO      GSTR0090
.
GSTR0003  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY3:
                    *PCCOL:CVERT,*V2LON,KEY3;
          GOTO      GSTR0090
.
GSTR0004  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY4:
                    *PCCOL:CVERT,*V2LON,KEY4;
          GOTO      GSTR0090
.
GSTR0005  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY5:
                    *PCCOL:CVERT,*V2LON,KEY5;
          GOTO      GSTR0090
.
GSTR0006  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY6:
                    *PCCOL:CVERT,*V2LON,KEY6;
          GOTO      GSTR0090
.
GSTR0007  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY7:
                    *PCCOL:CVERT,*V2LON,KEY7;
          GOTO      GSTR0090
.
GSTR0008  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY8:
                    *PCCOL:CVERT,*V2LON,KEY8;
          GOTO      GSTR0090
.
GSTR0009  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY9:
                    *PCCOL:CVERT,*V2LON,KEY9;
          GOTO      GSTR0090
.
GSTR0010  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY10:
                    *PCCOL:CVERT,*V2LON,KEY10;
          GOTO      GSTR0090
.
GSTR0011  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY11:
                    *PCCOL:CVERT,*V2LON,KEY11;
          GOTO      GSTR0090
.
GSTR0012  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY12:
                    *PCCOL:CVERT,*V2LON,KEY12;
          GOTO      GSTR0090
.
GSTR0013  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY13:
                    *PCCOL:CVERT,*V2LON,KEY13;
          GOTO      GSTR0090
.
GSTR0014  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY14:
                    *PCCOL:CVERT,*V2LON,KEY14;
          GOTO      GSTR0090
.
GSTR0015  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY15:
                    *PCCOL:CVERT,*V2LON,KEY15;
          GOTO      GSTR0090
.
GSTR0016  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY16:
                    *PCCOL:CVERT,*V2LON,KEY16;
          GOTO      GSTR0090
.
GSTR0017  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY17:
                    *PCCOL:CVERT,*V2LON,KEY17;
          GOTO      GSTR0090
.
GSTR0018  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY18:
                    *PCCOL:CVERT,*V2LON,KEY18;
          GOTO      GSTR0090
.
GSTR0019  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY19:
                    *PCCOL:CVERT,*V2LON,KEY19;
          GOTO      GSTR0090
.
GSTR0020  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY20:
                    *PCCOL:CVERT,*V2LON,KEY20;
          GOTO      GSTR0090
.
GSTR0021  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY21:
                    *PCCOL:CVERT,*V2LON,KEY21;
          GOTO      GSTR0090
.
GSTR0022  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY22:
                    *PCCOL:CVERT,*V2LON,KEY22;
          GOTO      GSTR0090
.
GSTR0023  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY23:
                    *PCCOL:CVERT,*V2LON,KEY23;
          GOTO      GSTR0090
.
GSTR0024  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY24:
                    *PCCOL:CVERT,*V2LON,KEY24;
          GOTO      GSTR0090
.
GSTR0025  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY25:
                    *PCCOL:CVERT,*V2LON,KEY25;
          GOTO      GSTR0090
.
GSTR0026  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY26:
                    *PCCOL:CVERT,*V2LON,KEY26;
          GOTO      GSTR0090
.
GSTR0027  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY27:
                    *PCCOL:CVERT,*V2LON,KEY27;
          GOTO      GSTR0090
.
GSTR0028  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY28:
                    *PCCOL:CVERT,*V2LON,KEY28;
          GOTO      GSTR0090
.
GSTR0029  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY29:
                    *PCCOL:CVERT,*V2LON,KEY29;
          GOTO      GSTR0090
.
GSTR0030  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY30:
                    *PCCOL:CVERT,*V2LON,KEY30;
          GOTO      GSTR0090
.
GSTR0031  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY31:
                    *PCCOL:CVERT,*V2LON,KEY31;
          GOTO      GSTR0090
.
GSTR0032  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY32:
                    *PCCOL:CVERT,*V2LON,KEY32;
          GOTO      GSTR0090
.
GSTR0033  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY33:
                    *PCCOL:CVERT,*V2LON,KEY33;
          GOTO      GSTR0090
.
GSTR0034  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY34:
                    *PCCOL:CVERT,*V2LON,KEY34;
          GOTO      GSTR0090
.
GSTR0035  KEYIN     *PCCOL:CVERT,*EL,*DV,KEY35:
                    *PCCOL:CVERT,*V2LON,KEY35;
          GOTO      GSTR0090
.
GSTR0090  LOAD      CSTRING,CSTRLEN,KEY1:
                    KEY2,KEY3,KEY4,KEY5,KEY6,KEY7,KEY8,KEY9,KEY10:
                    KEY11,KEY12,KEY13,KEY14,KEY15,KEY16,KEY17,KEY18,KEY19,KEY20:
                    KEY21,KEY22,KEY23,KEY24,KEY25,KEY26,KEY27,KEY28,KEY29,KEY30:
                    KEY31,KEY32,KEY33,KEY34,KEY35
          DISPLAY   *PCCOL:CVERT,*V2LON,CSTRING;
.
GSTR9999  RETURN
.----------------------------------------------------------------------
. Set up for screen 01
.----------------------------------------------------------------------
SETSCR01  MOVE      "1",OPTIONA
.
          RETURN
.*****************************************************************************
. SSUBJ - Save Subjective
.*****************************************************************************
SSUBJ000
          MOVE      FMSASUBJ,APSCSUB
.
SSUBJ999  RETURN
.----------------------------------------------------------------------
. Write Data
.----------------------------------------------------------------------
WAPSC000
          MATCH     FROMSUB,TOSUB
          IF        @LESS
            CLEAR     DISPMSG
            APPEND    "Illegal Range - ",DISPMSG
            CALL      MESSAGE1
            GOTO      WAPSC999
          ENDIF
.
          IF        OPTIONA=1
            MOVE      SP70,CURTYP
          ELSE
            MOVE      "1",CURTYP
          ENDIF
.
          PACK      KEY14,LEDGER,FROMSUB,SP70
          CALL      RSFMX000
          CALL      RPFMX000
.
WAPSC100
          CALL      RKFMX000
          BRANCH    OVRCD,WAPSC999           * any more records ?
          MATCH     FMSALEDG,LEDGER
          GOTO      WAPSC999 IF NOT EQUAL
          MATCH     FMSASUBJ,TOSUB
          GOTO      WAPSC999 IF LESS
.
          MOVE      CHARGE,APSCCOD
          MOVE      FMSALEDG,APSCLED
          MOVE      FMSASUBJ,APSCSUB
.
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70
          PACK      KEY27,KEY26,SP70
.
          PACK      KEY26,APSCLED,APSCSUB,SP70
          CALL      RSAPSC2                  * check if subj already exists
          CALL      RKAPSC2
          BRANCH    OVRCD,WAPSC300
          PACK      KEY14,APSCLED,APSCSUB,SP70
          MATCH     KEY14,KEY26
          GOTO      WAPSC300 IF NOT EQUAL
.
          MATCH     CURTYP,APSCTYP           * check if desired type
          GOTO      WAPSC300 IF NOT EQUAL
.
          MATCH     APSCCOD,KEY27            * already alloc to curr charge code
          GOTO      WAPSC100 IF EQUAL
.
          CLEAR     DISPMSG
.
          IF        OPTIONA=1
            APPEND    "Subj ",DISPMSG
          ELSE
            APPEND    "Acct ",DISPMSG
          ENDIF
.
          APPEND    APSCLED,DISPMSG
          APPEND    SLASH,DISPMSG
          APPEND    APSCSUB,DISPMSG
          APPEND    " Allocated to Charge Code ",DISPMSG
          APPEND    APSCCOD,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      WAPSC100
.
WAPSC300  PACK      KEY26,KEY27,SP70
          UNPACK    KEY26,APSCCOD,APSCLED,APSCSUB
          CALL      RAAPSC1
          IF        OVRCD=1
            MOVE      CURTYP,APSCTYP
            CALL      WRAPSC1
          ENDIF
          GOTO      WAPSC100
.
WAPSC999  RETURN
.
.
RSFMX000  IF        OPTIONA=1
            CALL      RSFMSA1
          ELSE
            CALL      RSFMAM1
          ENDIF
          RETURN
.
RKFMX000  IF        OPTIONA=1
            CALL      RKFMSA1
          ELSE
            CALL      RKFMAM1
            MOVE      FMAMLEDG,FMSALEDG
            MOVE      FMAMACCT,FMSASUBJ
            IF        OVRCD=0
              MATCH     "6",FMAMTYPE        * posting account ?
              GOTO      RKFMX000 IF NOT LESS
            ENDIF
          ENDIF
          RETURN
.
RPFMX000  IF        OPTIONA=1
            CALL      RPFMSA1
          ELSE
            CALL      RPFMAM1
            MOVE      FMAMLEDG,FMSALEDG
            MOVE      FMAMACCT,FMSASUBJ
            IF        OVRCD=0
              MATCH     "6",FMAMTYPE        * posting account ?
              GOTO      RPFMX000 IF NOT LESS
            ENDIF
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Delete Data
.----------------------------------------------------------------------
DAPSC000
          MATCH     FROMSUB,TOSUB
          IF        @LESS
            CLEAR     DISPMSG
            APPEND    "Illegal Range - ",DISPMSG
            CALL      MESSAGE1
            GOTO      DAPSC999
          ENDIF
.
          IF        OPTIONA=1
            MOVE      SP70,CURTYP
          ELSE
            MOVE      "1",CURTYP
          ENDIF
.
          PACK      KEY14,LEDGER,FROMSUB,SP70
          CALL      RSFMX000
          CALL      RPFMX000
.
DAPSC100
          CALL      RKFMX000
          BRANCH    OVRCD,DAPSC999           * any more records ?
          MATCH     FMSALEDG,LEDGER
          GOTO      DAPSC999 IF NOT EQUAL
          MATCH     FMSASUBJ,TOSUB
          GOTO      DAPSC999 IF LESS
.
          MOVE      CHARGE,APSCCOD
          MOVE      FMSALEDG,APSCLED
          MOVE      FMSASUBJ,APSCSUB
.
          MOVE      CURTYP,APSCTYP
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70
          CALL      RDAPSC1
.
          MATCH     CURTYP,APSCTYP
          CALL      DEAPSC1 IF EQUAL
          GOTO      DAPSC100
.
DAPSC999  RETURN
.----------------------------------------------------------------------
. Keyin from subj
.----------------------------------------------------------------------
KCODF000
          IF        OPTIONA=1
            MOVE      FMLALEDG,FMSALEDG
            CALL      KSBAFM00
            BRANCH    EXIT,KCODF999,KCODF999
            PACK      FROMSUB,FMSASUBJ,SP70
            PACK      DESC1,FMSADESC,SP70
          ELSE
            MOVE      FMLALEDG,FMAMLEDG
            CALL      KAMAFM00
            BRANCH    EXIT,KCODF999,KCODF999
            PACK      FROMSUB,FMAMACCT,SP70
            PACK      DESC1,FMAMDESC,SP70
          ENDIF
.
KCODF999  RETURN
.----------------------------------------------------------------------
. Keyin to subj
.----------------------------------------------------------------------
KCODT000
          IF        OPTIONA=1
            MOVE      FMLALEDG,FMSALEDG
            CALL      KSBAFM00
            BRANCH    EXIT,KCODT999,KCODT999
            PACK      TOSUB,FMSASUBJ,SP70
            PACK      DESC2,FMSADESC,SP70
          ELSE
            MOVE      FMLALEDG,FMAMLEDG
            CALL      KAMAFM00
            BRANCH    EXIT,KCODT999,KCODT999
            PACK      TOSUB,FMAMACCT,SP70
            PACK      DESC2,FMAMDESC,SP70
          ENDIF
.
KCODT999  RETURN
.----------------------------------------------------------------------
. Set up for screen 02
.----------------------------------------------------------------------
SETSCR02  MOVE      "2",OPTIONA
.
          RETURN
.********************************************************************
. Set accept mode
.********************************************************************
SETACCEP  MOVE      ONE,ACCEPT
          RETURN
.----------------------------------------------------------------------
. Keyin from code (APSC)
.----------------------------------------------------------------------
KCCDF000
          CALL      KAPSCA00                     * keyin APSC
          BRANCH    EXIT,KCCDF100,KCCDF950
.
          PACK      FROMLA12,APSCCOD,SP70        * item entered
          PACK      FROMCO12,APSCCOD,SP70
          GOTO      KCCDF900
.
KCCDF100  PACK      FROMLA12,START,SP70          * nothing entered
          PACK      FROMCO12,SP70
          GOTO      KCCDF900
.
KCCDF900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KCCDF999
.
KCCDF950  MOVE      TWO,EXIT                     * quit screen
.
KCCDF999  RETURN
.----------------------------------------------------------------------
. Keyin to code (APSC)
.----------------------------------------------------------------------
KCCDT000
          CALL      KAPSCA00                     * keyin APSC
          BRANCH    EXIT,KCCDT100,KCCDT950
.
          PACK      TOLA12,APSCCOD,SP70          * item entered
          PACK      TOCO12,APSCCOD,SP70
          GOTO      KCCDT900
.
KCCDT100  PACK      TOLA12,END,SP70              * nothing entered
          PACK      TOCO12,Z70
          GOTO      KCCDT900
.
KCCDT900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KCCDT999
.
KCCDT950  MOVE      TWO,EXIT                     * quit screen
.
KCCDT999  RETURN
.----------------------------------------------------------------------
. Keyin from code (FMLA)
.----------------------------------------------------------------------
KSACF000
          MOVE      SP70,FROMCO12
          DISPLAY   *PCCOL:CVERT,*V2LON,SP2,SLASH,FROMCO12;
          CALL      KFMLAA00                     * keyin FMLA
          BRANCH    EXIT,KSACF100,KSACF950
.
          KEYIN     *PCCOL:CVERT,*V2LON,*DV,FMLALEDG,*DV,SLASH,FROMCO12;
.
          PACK      FROMCO12,FROMCO12,SP70
          MATCH     FROMCO12,SP70
          IF        @EQUAL
            PACK      FROMLA15,FMLALEDG,SLASH,START,SP70        * spaces entered
            PACK      FROMCO14,FMLALEDG,SP70
          ELSE
            PACK      FROMLA15,FMLALEDG,SLASH,FROMCO12,SP70     * item entered
            PACK      FROMCO14,FMLALEDG,FROMCO12,SP70
          ENDIF
          GOTO      KSACF900
.
KSACF100  PACK      FROMLA15,START,SP70          * nothing entered
          PACK      FROMCO14,SP70
          GOTO      KSACF900
.
KSACF900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KSACF999
.
KSACF950  MOVE      TWO,EXIT                     * quit screen
.
KSACF999  RETURN
.----------------------------------------------------------------------
. Keyin to code (FMLA)
.----------------------------------------------------------------------
KSACT000
          MOVE      SP70,TOCO12
          DISPLAY   *PCCOL:CVERT,*V2LON,SP2,SLASH,TOCO12;
          CALL      KFMLAA00                     * keyin FMLA
          BRANCH    EXIT,KSACT100,KSACT950
.
          KEYIN     *PCCOL:CVERT,*V2LON,*DV,FMLALEDG,*DV,SLASH,TOCO12;
.
          PACK      TOCO12,TOCO12,SP70
          MATCH     TOCO12,SP70
          IF        @EQUAL
            PACK      TOLA15,FMLALEDG,SLASH,END,SP70            * spaces entered
            PACK      TOCO14,FMLALEDG,Z70
          ELSE
            PACK      TOLA15,FMLALEDG,SLASH,TOCO12,SP70         * item entered
            PACK      TOCO14,FMLALEDG,TOCO12,SP70
          ENDIF
          GOTO      KSACT900
.
KSACT100  PACK      TOLA15,END,SP70              * nothing entered
          PACK      TOCO14,Z70
          GOTO      KSACT900
.
KSACT900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KSACT999
.
KSACT950  MOVE      TWO,EXIT                     * quit screen
.
KSACT999  RETURN
.**********************************************************************
. PRTIN- print routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
PRTIN000
          PACK      DISPMSG,SP70,SP70       * save line 24
          CALL      MESSAGE2
.
          OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
.
          CLOSE     SCRSBGA1                * close files to stop "S*O 024"
          CLOSE     SCRPSTA1
.
          CALL      OPNPRINT
.
          OPEN      SCRSBGA1,"scrsbgaf"     * re-open files
          OPEN      SCRPSTA1,"scrpstaf"
.
          CLOSE     NEZTMP0Z                * set up temp file
          PACK      KILLTMPZ,ISERASE,NAMEZ
          EXECUTE   KILLTMPZ,TASKID
          PACK      MAKETMPZ,ISBUILD,NAMEZ,TMP0ZDAT
          EXECUTE   MAKETMPZ,TASKID
          OPEN      NEZTMP0Z,NAMEZ
.
          CALL      PDAA0000                * print routine
          BRANCH    EXIT,PRTIN900           * check if anything to print
.
          CALL      PDAB0000                * print routine
.
          CLOSE     NEZTMP0Z                * delete temp file
          PACK      KILLTMPZ,ISERASE,NAMEZ
          EXECUTE   KILLTMPZ,TASKID
.
          IF        CPAGENO>0
            CALL      SELPRINT
          ELSE
            DISPLAY   *P1:24,*EL,"Nothing to Print !! - ";
            CALL      HITENTER
          ENDIF
          MOVE      ZERO,EXIT
.
PRTIN900  CALL      CLSPRINT
          CLOSE     IBACODE1                * close files
...       CLOSE     IBAPRNT1
.
PRTIN999
          CALL      MESSAGE3                * restore line 24
          RETURN
.********************************************************************
. PDAA - print report for FMAM                      Called by ML
.         Returns  : EXIT            (1=illegal range entered)
.********************************************************************
PDAA0000  MOVE      ONE,OPTIONA
          MATCH     FROMCO14,TOCO14
          IF        @LESS
            DISPLAY   *P1:24,"Illegal Range - ",DISPMSG
            CALL      HITENTER
            GOTO      PDAT9500
          ENDIF
.
          DISPLAY   *P1:24,"Printing :   ";
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "999",CLNO                   * init last line number
.
          CALL      FILA0000                    * go to correct position in file
.
PDAA1000  CALL      NREA0000                     * get next record
          BRANCH    OVRCD,PDAA8000               * end of file ?
.
          DISPLAY   *P12:24,*V2LON,FMAMLEDG,SLASH,FMAMACCT,*EL;
.
          CALL      WRIA0000                     * print details
          GOTO      PDAA1000                     * get next record
.
PDAA8000  COMPARE   ZERO,CPAGENO
          CALL      HEAA0000 IF EQUAL          * print header if nothing printed
.
.
PDAA9000  MOVE      ZERO,EXIT                    * exit screen
          GOTO      PDAA9999
.
PDAA9500  MOVE      ONE,EXIT                     * continue
.
PDAA9999  RETURN
.**********************************************************************
.  FILA - Set file pointer                             Called By PRNT
.**********************************************************************
FILA0000  BRANCH    OPTIONA,FILA0100,FILA9999,FILA9999,FILA9999:
                            FILA9999,FILA9999,FILA9999,FILA9999
.
.---- print by type 1 ----
.
FILA0100  PACK      KEY14,FROMCO14,SP70
          CALL      RSFMAM1
          CALL      RPFMAM1
          GOTO      FILA9999
.
FILA9999  RETURN
.**********************************************************************
.  NREA - Get next record                              Called By PRNT
.**********************************************************************
NREA0000  BRANCH    OPTIONA,NREA0100,NREA9999,NREA9999,NREA9999:
                            NREA9999,NREA9999,NREA9999,NREA9999
.
.---- print by type 1 ----
.
NREA0100  CALL      RKFMAM1
          BRANCH    OVRCD,NREA9500
.
          MATCH     "6",FMAMTYPE
          GOTO      NREA0100 IF NOT LESS
          PACK      KEY14,FMAMLEDG,FMAMACCT,SP70
          MATCH     KEY14,TOCO14
          GOTO      NREA9500 IF LESS
.
          GOTO      NREA9000
.
NREA9000  MOVE      ZERO,OVRCD         * continue
          GOTO      NREA9999
.
NREA9500  MOVE      ONE,OVRCD          * quit
.
NREA9999  RETURN
.********************************************************************
. HEAA - print report                               Called by PRNT
.********************************************************************
HEAA0000  CALL      HEAD80                      * print heading
.
          ADD       "1",CLNO
          PRINT     *20,"Print Accounts Not Linked To Any Charge Codes"
          CALL      UND80                       * print line
          PRINT     "| Ledger/Account":
                    *80,"|"
          ADD       "1",CLNO
          CALL      UND80                       * print line
.
HEAA9999  RETURN
.********************************************************************
. WRIA - print data line                            Called by PRNT
.********************************************************************
WRIA0000
.
.---- get charge code by account ----
.
          PACK      KEY26,FMAMLEDG,FMAMACCT,SP70
          CALL      RSAPSC2                      * get charge code (if exists)
          CALL      RKAPSC2
          BRANCH    OVRCD,WRIA1000
          PACK      KEY14,APSCLED,APSCSUB,SP70
          MATCH     KEY14,KEY26
          GOTO      WRIA1000 IF NOT EQUAL
          MATCH     "1",APSCTYP
          GOTO      WRIA1000 IF NOT EQUAL
          GOTO      WRIA9999                     * must be ok !!
.
.---- get charge code by subj ----
.
WRIA1000
          PACK      ACCOUNT,FMAMACCT,SP70
          CALL      GCOD0000                     * get subjective/cost centre
.
          PACK      KEY26,FMAMLEDG,SUBJCODE,COSTCODE,SP70
          CALL      RDFMXC1                      * check if cc/subj related
          BRANCH    OVRCD,WRIA2000
.
          PACK      KEY26,FMAMLEDG,SUBJCODE,SP70
          CALL      RSAPSC2                      * get charge code (if exists)
          CALL      RKAPSC2
          BRANCH    OVRCD,WRIA1500
          PACK      KEY14,APSCLED,APSCSUB,SP70
          MATCH     KEY14,KEY26
          GOTO      WRIA1500 IF NOT EQUAL
          MATCH     " ",APSCTYP
          GOTO      WRIA1500 IF NOT EQUAL
          GOTO      WRIA9999                     * must be ok !!
.
.---- save invalid subjective ----
.
WRIA1500
          PACK      KEY14,FMAMLEDG,SUBJCODE,SP70
          UNPACK    KEY14,NEZZLEDG,NEZZACCT
          CALL      RDNEZZ1
          IF        OVRCD=1
            CALL      WRNEZZ1
          ENDIF
          GOTO      WRIA9999
.
.---- print invalid account ----
.
WRIA2000
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAA0000 IF NOT LESS         * start new page
.
          PRINT     "| ",FMAMLEDG,SLASH,FMAMACCT,SP2,FMAMDESC:
                    *80,"|"
          ADD       "1",CLNO           * add one to line number
.
WRIA9999  RETURN
.********************************************************************
. PDAB - print report for FMAM                      Called by ML
.         Returns  : EXIT            (1=illegal range entered)
.********************************************************************
PDAB0000
          MOVE      "999",CLNO                   * init last line number
          CALL      FILB0000                    * go to correct position in file
.
PDAB1000  CALL      NREB0000                     * get next record
          BRANCH    OVRCD,PDAB8000               * end of file ?
.
          DISPLAY   *P12:24,*V2LON,FMAMLEDG,SLASH,FMAMACCT,*EL;
.
          CALL      WRIB0000                     * print details
          GOTO      PDAB1000                     * get next record
.
PDAB8000  COMPARE   ZERO,CPAGENO
          CALL      HEAB0000 IF EQUAL          * print header if nothing printed
          CALL      UND80                       * print line
          PRINT     "****   End of Report   ****"
.
.
PDAB9000  MOVE      ZERO,EXIT                    * exit screen
          GOTO      PDAB9999
.
PDAB9500  MOVE      ONE,EXIT                     * continue
.
PDAB9999  RETURN
.**********************************************************************
.  FILB - Set file pointer                             Called By PRNT
.**********************************************************************
FILB0000  BRANCH    OPTIONA,FILB0100,FILB9999,FILB9999,FILB9999:
                            FILB9999,FILB9999,FILB9999,FILB9999
.
.---- print by type 1 ----
.
FILB0100  PACK      KEY14,SP70
          CALL      RSNEZZ1
          CALL      RPNEZZ1
          GOTO      FILB9999
.
FILB9999  RETURN
.**********************************************************************
.  NREB - Get next record                              Called By PRNT
.**********************************************************************
NREB0000  BRANCH    OPTIONA,NREB0100,NREB9999,NREB9999,NREB9999:
                            NREB9999,NREB9999,NREB9999,NREB9999
.
.---- print by type 1 ----
.
NREB0100  CALL      RKNEZZ1
          BRANCH    OVRCD,NREB9500
.
          GOTO      NREB9000
.
NREB9000  MOVE      ZERO,OVRCD         * continue
          GOTO      NREB9999
.
NREB9500  MOVE      ONE,OVRCD          * quit
.
NREB9999  RETURN
.********************************************************************
. HEAB - print report                               Called by PRNT
.********************************************************************
HEAB0000  CALL      HEAD80                      * print heading
.
          ADD       "1",CLNO
          PRINT     *20,"Print Subjectives Not Linked To Any Charge Codes"
          CALL      UND80                       * print line
          PRINT     "| Ledger/Subjective":
                    *80,"|"
          ADD       "1",CLNO
          CALL      UND80                       * print line
.
HEAB9999  RETURN
.********************************************************************
. WRIB - print data line                            Called by PRNT
.********************************************************************
WRIB0000
.
.---- get charge code by subj ----
.
          PACK      KEY26,NEZZLEDG,NEZZACCT,SP70
          CALL      RSAPSC2                      * get charge code (if exists)
          CALL      RKAPSC2
          BRANCH    OVRCD,WRIB2000
          PACK      KEY14,APSCLED,APSCSUB,SP70
          MATCH     KEY14,KEY26
          GOTO      WRIB2000 IF NOT EQUAL
          MATCH     " ",APSCTYP
          GOTO      WRIB2000 IF NOT EQUAL
          GOTO      WRIB9999                     * must be ok !!
.
.---- print invalid account ----
.
WRIB2000
          COMPARE   "55",CLNO                    * end of page ?
          CALL      HEAB0000 IF NOT LESS         * start new page
.
          MOVE      SP70,FMSADESC
          PACK      KEY14,NEZZLEDG,NEZZACCT,SP70
          CALL      RDFMSA1
.
          PRINT     "| ",NEZZLEDG,SLASH,NEZZACCT,SP2,FMSADESC:
                    *80,"|"
          ADD       "1",CLNO           * add one to line number
.
WRIB9999  RETURN
.****************************************************************************
.  GCOD - get subjective and cost codes from account code    Called by lots
.        Requires - ACCOUNT   (account code)
.                   FMSUUD2A  (separate CC/Subj 1=yes)
.                   FMSUUD4A  (cost centre code length)
.        Returns  - SUBJCODE  (subjective code)
.                   COSTCODE  (cost centre code)
.****************************************************************************
GCOD0000  UNPACK    SP70,SUBJCODE,COSTCODE       * clear old vars
          BRANCH    FMSUUD4A,GCOD0100,GCOD0200,GCOD0300,GCOD0400:
                             GCOD0500,GCOD0600,GCOD0700,GCOD0800:
                             GCOD0900,GCOD1000,GCOD1100,GCOD1200
.
GCOD0100  BRANCH    FMSUUD2A,GCOD0110
          UNPACK    ACCOUNT,KEY1,SUBJCODE
          GOTO      GCOD90000
.
GCOD0110  UNPACK    ACCOUNT,KEY1,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0200  BRANCH    FMSUUD2A,GCOD0210
          UNPACK    ACCOUNT,KEY2,SUBJCODE
          GOTO      GCOD90000
.
GCOD0210  UNPACK    ACCOUNT,KEY2,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0300  BRANCH    FMSUUD2A,GCOD0310
          UNPACK    ACCOUNT,KEY3,SUBJCODE
          GOTO      GCOD90000
.
GCOD0310  UNPACK    ACCOUNT,KEY3,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0400  BRANCH    FMSUUD2A,GCOD0410
          UNPACK    ACCOUNT,KEY4,SUBJCODE
          GOTO      GCOD90000
.
GCOD0410  UNPACK    ACCOUNT,KEY4,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0500  BRANCH    FMSUUD2A,GCOD0510
          UNPACK    ACCOUNT,KEY5,SUBJCODE
          GOTO      GCOD90000
.
GCOD0510  UNPACK    ACCOUNT,KEY5,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0600  BRANCH    FMSUUD2A,GCOD0610
          UNPACK    ACCOUNT,KEY6,SUBJCODE
          GOTO      GCOD90000
.
GCOD0610  UNPACK    ACCOUNT,KEY6,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0700  BRANCH    FMSUUD2A,GCOD0710
          UNPACK    ACCOUNT,KEY7,SUBJCODE
          GOTO      GCOD90000
.
GCOD0710  UNPACK    ACCOUNT,KEY7,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0800  BRANCH    FMSUUD2A,GCOD0810
          UNPACK    ACCOUNT,KEY8,SUBJCODE
          GOTO      GCOD90000
.
GCOD0810  UNPACK    ACCOUNT,KEY8,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD0900  BRANCH    FMSUUD2A,GCOD0910
          UNPACK    ACCOUNT,KEY9,SUBJCODE
          GOTO      GCOD90000
.
GCOD0910  UNPACK    ACCOUNT,KEY9,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD1000  BRANCH    FMSUUD2A,GCOD1010
          UNPACK    ACCOUNT,KEY10,SUBJCODE
          GOTO      GCOD90000
.
GCOD1010  UNPACK    ACCOUNT,KEY10,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD1100  BRANCH    FMSUUD2A,GCOD1110
          UNPACK    ACCOUNT,KEY11,SUBJCODE
          GOTO      GCOD90000
.
GCOD1110  UNPACK    ACCOUNT,KEY11,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD1200  BRANCH    FMSUUD2A,GCOD1210
          UNPACK    ACCOUNT,KEY12,SUBJCODE
          GOTO      GCOD90000
.
GCOD1210  UNPACK    ACCOUNT,KEY12,ANS,SUBJCODE
          GOTO      GCOD90000
.
GCOD9000  LOAD      COSTCODE,FMSUUD4A,KEY1,KEY2,KEY3,KEY4:
                                      KEY5,KEY6,KEY7,KEY8:
                                      KEY9,KEY10,KEY11,KEY12
          PACK      SUBJCODE,SUBJCODE,SP70
          PACK      COSTCODE,COSTCODE,SP70
.
GCOD9999  RETURN
.
.----- temp file IO routines -----
.
RSNEZZ1   RESET     KEY14
          READ      NEZTMP0Z,KEY14;;
          RETURN
.
RANEZZ1   RESET     KEY14
          MOVE      ZERO,OVRCD
          READ      NEZTMP0Z,KEY14;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RDNEZZ1   RESET     KEY14
          MOVE      ZERO,OVRCD
          READ      NEZTMP0Z,KEY14;NEZZLEDG,NEZZACCT
          GOTO      OVERCOND IF OVER
          RETURN
.
RLNEZZ1   RESET     KEY14
          MOVE      ZERO,OVRCD
          READL     NEZTMP0Z,KEY14;NEZZLEDG,NEZZACCT
          GOTO      OVERCOND IF OVER
          GOTO      OVERLOCK IF LOCKED
          RETURN
.
UUNEZZ1   RESET     KEY14
          UNLOCK    NEZTMP0Z
          RETURN
.
RKNEZZ1   MOVE      ZERO,OVRCD
          READKS    NEZTMP0Z;NEZZLEDG,NEZZACCT
          GOTO      OVERCOND IF OVER
          RETURN
.
RPNEZZ1   MOVE      ZERO,OVRCD
          READKP    NEZTMP0Z;NEZZLEDG,NEZZACCT
          GOTO      OVERCOND IF OVER
          RETURN
.
UPNEZZ1   UPDATE    NEZTMP0Z;NEZZLEDG,NEZZACCT
          RETURN
.
WRNEZZ1   RESET     KEY14
          WRITE     NEZTMP0Z,KEY14;NEZZLEDG,NEZZACCT
          RETURN
.
DENEZZ1   RESET     KEY14
          DELETE    NEZTMP0Z,KEY14
          RETURN
.
.----------------------------------------------------------------------
. Keyin from code (FMLA)
.----------------------------------------------------------------------
KIACF000
          MOVE      SP70,FROMCO12
          DISPLAY   *PCCOL:CVERT,*V2LON,SP2,SLASH,FROMCO12;
          CALL      KFMLAA00                     * keyin FMLA
          BRANCH    EXIT,KIACF100,KIACF950
.
          PACK      FMAMLEDG,FMLALEDG,SP70
          ADD       "3",CCOL
          CALL      KFMAMA00                     * keyin FMAM
          SUB       "3",CCOL
          BRANCH    EXIT,KIACF200,KIACF950
.
          PACK      FROMLA15,FMLALEDG,SLASH,FMAMACCT,SP70  * item entered
          PACK      FROMCO14,FMLALEDG,FMAMACCT,SP70
          GOTO      KIACF900
.
KIACF100  PACK      FROMLA15,START,SP70          * nothing entered
          PACK      FROMCO14,SP70
          GOTO      KIACF900
.
KIACF200  PACK      FROMLA15,FMLALEDG,SLASH,START,SP70     * no account entered
          PACK      FROMCO14,FMLALEDG,SP70
          GOTO      KIACF900
.
KIACF900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KIACF999
.
KIACF950  MOVE      TWO,EXIT                     * quit screen
.
KIACF999  RETURN
.----------------------------------------------------------------------
. Keyin to code (FMLA)
.----------------------------------------------------------------------
KIACT000
          MOVE      SP70,TOCO12
          DISPLAY   *PCCOL:CVERT,*V2LON,SP2,SLASH,TOCO12;
          CALL      KFMLAA00                     * keyin FMLA
          BRANCH    EXIT,KIACT100,KIACT950
.
          PACK      FMAMLEDG,FMLALEDG,SP70
          ADD       "3",CCOL
          CALL      KFMAMA00                     * keyin FMAM
          SUB       "3",CCOL
          BRANCH    EXIT,KIACT200,KIACT950
.
          PACK      TOLA15,FMLALEDG,SLASH,FMAMACCT,SP70  * item entered
          PACK      TOCO14,FMLALEDG,FMAMACCT,SP70
          GOTO      KIACT900
.
KIACT100  PACK      TOLA15,END,SP70              * nothing entered
          PACK      TOCO14,Z70
          GOTO      KIACT900
.
KIACT200  PACK      TOLA15,FMLALEDG,SLASH,END,SP70     * no account entered
          PACK      TOCO14,FMLALEDG,Z70
          GOTO      KIACT900
.
KIACT900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KIACT999
.
KIACT950  MOVE      TWO,EXIT                     * quit screen
.
KIACT999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSSCXIO/INC
          INC       APSSCXKY    
          INC       FMSAMAIO/INC
          INC       FMSAMAKY    
          INC       FMSCONIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMAKY    
          INC       FMSSBAIO/INC
          INC       FMSSBAKY    
          INC       FMSXCSIO/INC
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
.
          INC       STDGENCD
.
