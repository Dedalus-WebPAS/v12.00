.----------------------------------------------------------------------
. Patient Data Interface to IBA Systems
.----------------------------------------------------------------------
         INC        CALCAGE
         INC        CALCDAYS
         INC        NHOSPDAY
         INC        PATCALCR     
         INC       AAEDE1IO/INC
         INC       AAEDI1IO/INC
         INC        CCIDPTIO/INC
         INC       PATCODIO/INC
         INC       PATDSCIO/INC
         INC       PATDO1IO/INC
         INC       PATDTRIO/INC
          INC       PATECDIO/INC
          INC       PATECOIO/INC
         INC       PATICUIO/INC
         INC       PATINVIO/INC
         INC       PATMA1IO/INC
         INC       PATMI1IO/INC
         INC       PATMMBIO/INC
         INC       PMSMTIIO/INC
         INC       PATVISIO/INC
         INC       PATTRNIO/INC
         INC        OPRDEAIO/INC
         INC        OPRDECIO/INC
         INC        OPRCLIIO/INC
         INC        OPRSESIO/INC
         INC       OUTSITIO/INC
         INC       OUTBOAIO/INC
         INC       OUTBB1IO/INC
.----------------------------------------------------------------------
. File Open Routines
.----------------------------------------------------------------------
.
. Open Doctors File
.----------------------
PATDOC00  TRAP     OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     "patdo1af",KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLPDC
          IF       @EQUAL  
            OPEN     PATDO1A1,KEY8
          ELSE
            STRIP    CCHLPDC
            PACK     KEY80,CCHLPDC,KEY8
            OPEN     PATDO1A1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATDOCOP
          RETURN
.
. Open Patient Master File
.--------------------------
PATMA100  TRAP     OVERCOND IF IO
          OPEN      PATMA1A1,"patma1af"            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     "patma1af",KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLPMA
          IF       @EQUAL  
            OPEN     PATMA1A1,KEY8
          ELSE
            STRIP    CCHLPMA
            PACK     KEY80,CCHLPMA,KEY8
            OPEN     PATMA1A1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMASOP
          RETURN
.
.
. Open Patient Master Extention File
.------------------------------------
PATMX100  TRAP     OVERCOND IF IO
          OPEN      PATMX1A1,"patmx1af"            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     "patmx1af",KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLPMA
          IF       @EQUAL  
            OPEN     PATMX1A1,KEY8
          ELSE
            STRIP    CCHLPMA
            PACK     KEY80,CCHLPMA,KEY8
            OPEN     PATMX1A1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMASOP
          RETURN
.
. Open Admission File
.---------------------
PATMI100  TRAP     OVERCOND IF IO
          OPEN      PATMI1A1,"patmi1af"            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     "patmi1af",KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLPMI
          IF       @EQUAL  
            OPEN     PATMI1A1,KEY8
            OPEN     PATMI1A3,KEY8
          ELSE
            STRIP    CCHLPMI
            PACK     KEY80,CCHLPMI,KEY8
            OPEN     PATMI1A1,KEY80
            OPEN     PATMI1A3,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMISOP
          RETURN
.
. Open A & E Discharges File
.----------------------------
AAEDI100  TRAP     OVERCOND IF IO
          OPEN      AAEDI1A1,"aaedi1af"            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     "aaedi1af",KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLADI
          IF       @EQUAL  
            OPEN     AAEDI1A1,KEY8
          ELSE
            STRIP    CCHLADI
            PACK     KEY80,CCHLADI,KEY8
            OPEN     AAEDI1A1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,AAEDISOP
          RETURN
.
. Open A & E Details File
.------------------------
AAEDE100  TRAP     OVERCOND IF IO
          OPEN      AAEDE1A1,"aaede1af"            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     "aaede1af",KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLADE
          IF       @EQUAL  
            OPEN     AAEDE1A3,KEY8
          ELSE
            STRIP    CCHLADE
            PACK     KEY80,CCHLADE,KEY8
            OPEN     AAEDE1A3,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,AAEDEAOP
          RETURN
.
. Open Outpatient Details
.--------------------------
OUTBB100  PACK     CFNAME,OSTFILE,FILBB1A1
          TRAP     OVERCOND IF IO
          CALL     OPOTBB11            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     CFNAME,KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLOBB
          IF       @EQUAL  
            OPEN     OUTBB1A1,KEY8
          ELSE
            STRIP    CCHLOBB
            PACK     KEY80,CCHLOBB,KEY8
            OPEN     OUTBB1A1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OUTBOBOP
          RETURN
.
.
. Open Outpatient Details
.--------------------------
OUTBB200  PACK     CFNAME,OSTFILE,FILBB1A1
          TRAP     OVERCOND IF IO
          CALL     OPOTBB12            * Call Open Routine to set up flags
          TRAPCLR  IO
.
          TRAP     OVERCOND IF IO
          MOVE     CFNAME,KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLOBB
          IF       @EQUAL  
            OPEN     OUTBB1A2,KEY8
          ELSE
            STRIP    CCHLOBB
            PACK     KEY80,CCHLOBB,KEY8
            OPEN     OUTBB1A2,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OUTBOBOP
          RETURN
.
. Open Outpatient Details
.--------------------------
OUTBA300  PACK     CFNAME,OSTFILE,FILBOKA3
          TRAP     OVERCOND IF IO
          MOVE     CFNAME,KEY8
          MOVE     ZERO,OVRCD
          MATCH    SP70,CCHLOBB
          IF       @EQUAL  
            OPEN     OUTBOKA3,KEY8
          ELSE
            STRIP    CCHLOBB
            PACK     KEY80,CCHLOBB,KEY8
            OPEN     OUTBOKA3,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OUTBOBOP
          RETURN
.
