. **********************************************************************
. * System    :   Accounting System                                    *
. * Program   :   IBAFMS78                                             *
. * Desc      :   Maintenance Total Account Recalculation              *
. **********************************************************************
. * Date      :   20.03.1991                                           *
. * Author    :   Neeriem Dye (IBA)                                    *
. * Mods      :                                                        *
. **********************************************************************
. * V9.02.00  03.05.2002 Glenn Saunders                                *
. *           Export to new release i.e. v9.02 from vf.09              *
. **********************************************************************
. * VF.00.01  11.01.2000 Charles Handaya                               *
. *           Recompiled for Audit File date                           *
. **********************************************************************
.$$$$$$
.        PROGRAM IBAFMS78
.             open files and initialise variables
.             FOR each record on the FMSTUPAF file DO
.                  update for total account
.             END FOR
.        END
.$$$$$$
. Standard FMS Accounting System Include
.---------------------------------------
.
          INC       FMSSTDDF
          INC       FMSUPDDF
          INC       FMSUDADF           * FMS audit update variables
.
          INC       FMSBPFFD/INC
.
.==============================================================================
.FILE DESCRIPTION INCLUDES
.-------------------------
.
.==============================================================================
.LOCAL VARIABLE DEFINITION
.-------------------------
.
PRGID     INIT      "IBAFMS78"
PRGNAM    INIT      "Maintenance Total Account Recalculation"
VERSION   INIT      "V12.00.00"
.
.******************************************************************************
.   MAINLINE - Controlling Logic
.******************************************************************************
ML0000    CALL      INIT0000           * display heading and open files
.
ML0100    CALL      SELA0000           * perform screen A
          BRANCH    EXIT,ML9999        * exit program
.
          CALL      POST0000           * save data
.
ML9999    CHAIN     PGM                * chain back to menu
.
.******************************************************************************
.  INIT - Open Files                             Called by ML
.******************************************************************************
INIT0000  CALL      DISPHEAD
          CALL      OUPD0000           * open files for update
          MOVE      ONE,CCENTRY
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
.
          DISPLAY   *P56:24,"Opening fmsbpfaf";  * cost centre file
          OPEN      FMSBPFA1,"fmsbpfaf"
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.**********************************************************************
.  SELA - confirm desire to update data                Called By ML
.        Returns  - EXIT     (1=quit)
.**********************************************************************
SELA0000  DISPLAY   *P1:4,"This program updates all total accounts that ":
                    "require updating.":
                    *P1:6,"Ok to Continue (",*V2LON:
                    "Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? ";
.
SELA0100  MOVE      "24",CCOL
          MOVE      "6",CVERT
          CALL      YORN0000
          BRANCH    FYESNO,SELA9000
          GOTO      SELA9500
.
SELA9000  MOVE      ZERO,EXIT          * continue
          GOTO      SELA9999
.
SELA9500  MOVE      ONE,EXIT           * quit
.
SELA9999  RETURN
.**********************************************************************
.  POST - update data                                  Called By ML
.**********************************************************************
POST0000  DISPLAY   *P1:24,*V2LON,"**** Updating Data ****";
          PACK      PORTCODE,SP70
          CALL      CTUP0000           * update all records
.
POST9999  RETURN
.******************************************************************************
.  INCLUDES FOR I/O'S
.******************************************************************************
.
          INC       FMSBPFIO/INC
.
          INC       FMSSTDCD           * FMS Acc. standard routines
          INC       FMSUPDCD           * FMS Acc. standard update routines
          INC       FMSUDACD           * FMS audit update routines 
