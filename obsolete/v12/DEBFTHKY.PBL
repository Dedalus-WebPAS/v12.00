.
EDBFHA00  UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      "999,999,999.99",DBFHFTOT
          ASSIGN    DBFHTAX+DBFHTOT,DBFHDTOT 
          FEDIT     DBFHDTOT,DBFHFTOT
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBFTHKY
.   Routine   :   HDBFHA00 Invoice             
.   Return    :           
.-------------------------------------------------------------------------------
HDBFHA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "20",HLEF
            MOVE      "80",HRIG
          ENDIF
HDBFHA04
          CALL      GSCRN000
          BRANCH    EXIT,HDBFHA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Invoice"            
.
          MOVE      STDCOL01,STDCOL02
          ADD       "13",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"   Date   "               
.
          MOVE      STDCOL02,STDCOL03
          ADD       "11",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"         Total"
.
          MOVE      STDCOL03,STDCOL04
          ADD       "14",STDCOL04
HDBFHA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,DBFHDOC 
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          PACK      SAVKEY80,DBFHDEB,DBFHDTY,DBFHDOC,SP70                       
          SETLPTR   SAVKEY80,9                                                  
          CALL      RSDBFH1 
HDBFHA10
          CALL      RKDBFH1 
          BRANCH    OVRCD,HDBFHA15
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA15 IF NOT EQUAL                                       
          CALL      EDBFHA00
          BRANCH    CSEARCH,HDBFHA12
          CALL      HDBFHA60
          BRANCH    OVRCD,HDBFHA10
HDBFHA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY21,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,DBFHDOC 
          DISPLAY   *PSTDCOL02:STDROW,CPCDATE 
          DISPLAY   *PSTDCOL03:STDROW,DBFHFTOT
          COMPARE   MAXITEM,XITEMNO
          GOTO      HDBFHA10 IF NOT EQUAL
HDBFHA15
          UNPACK    SAVKEY80,DBFHDEB,DBFHDTY,DBFHDOC                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HDBFHA20
          CALL      HSCRI000
          BRANCH    EXIT,HDBFHA30,HDBFHA35,HDBFHA40,HDBFHA45,HDBFHA04:
                              HDBFHA91,HDBFHA50
          GOTO      HDBFHA92
HDBFHA30
          CALL      RKDBFH1 
          BRANCH    OVRCD,HDBFHA85
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA85 IF NOT EQUAL                                       
          CALL      RPDBFH1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBFHA10
HDBFHA35
          MOVE      ST1,KEY21
          CALL      RDDBFH1 
          CALL      RPDBFH1 
          BRANCH    OVRCD,HDBFHA85
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA85 IF NOT EQUAL                                       
          MATCH     SP70,DBFHDOC                                                
          GOTO      HDBFHA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HDBFHA36
          CALL      RPDBFH1 
          BRANCH    OVRCD,HDBFHA37
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBFHA36 IF NOT EQUAL
HDBFHA37
          MOVE      ZERO,XITEMNO
          GOTO      HDBFHA10
HDBFHA40
          MOVE      ST1,KEY21
          CALL      RDDBFH1 
          CALL      RPDBFH1 
          BRANCH    OVRCD,HDBFHA85
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBFHA08
HDBFHA45
          CALL      RKDBFH1 
          BRANCH    OVRCD,HDBFHA85
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY21,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSDBFH1 
HDBFHA46
          CALL      RPDBFH1 
          BRANCH    OVRCD,HDBFHA47
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC,SP70                          
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HDBFHA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBFHA46 IF NOT EQUAL
HDBFHA47
          MOVE      ZERO,XITEMNO
          GOTO      HDBFHA10
HDBFHA50  COMPARE   ZERO,CSEARCH
          GOTO      HDBFHA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBFHA08
HDBFHA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBFHA08
HDBFHA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HDBFHA61 IF EQUAL
          MATCH     SCHFLD01,DBFHDOC 
          GOTO      HDBFHA72 IF NOT EQUAL
HDBFHA61
          CALL      EDBFHA00
          MATCH     SP70,SCHFLD02
          GOTO      HDBFHA62 IF EQUAL
          MATCH     SCHFLD02,CPCDATE 
          GOTO      HDBFHA72 IF NOT EQUAL
HDBFHA62
          MATCH     SP70,SCHFLD03
          GOTO      HDBFHA63 IF EQUAL
          MATCH     SCHFLD03,DBFHFTOT
          GOTO      HDBFHA72 IF NOT EQUAL
HDBFHA63
HDBFHA64
HDBFHA65
HDBFHA66
HDBFHA67
HDBFHA68
HDBFHA69
HDBFHA70
          GOTO      HDBFHA75
HDBFHA72  MOVE      ONE,OVRCD
HDBFHA75  RETURN
HDBFHA85
          LOAD      KEY21,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY21,DBFHDEB,DBFHDTY,DBFHDOC                               
          CALL      RDDBFH1 
HDBFHA90
          UNPACK    SAVKEY80,DBFHDEB,DBFHDTY,DBFHDOC                            
          BEEP
          GOTO      HDBFHA20
HDBFHA91
          MOVE      SP70,DBFHDDAT
          MOVE      SP70,DBFHTER 
          MOVE      ZERO,DBFHTOT 
          MOVE      ZERO,DBFHTAX 
          MOVE      SP70,DBFHDPRT
          MOVE      SP70,DBFHDSTA
          MOVE      SP70,DBFHCDAT
          MOVE      SP70,DBFHCTIM
          MOVE      SP70,DBFHCUSR
          MOVE      SP70,DBFHUR1 
          MOVE      SP70,DBFHUR2 
          MOVE      SP70,DBFHUD1 
          MOVE      SP70,DBFHUD2 
          MOVE      SP70,DBFHUY1 
          MOVE      SP70,DBFHUY2 
          MOVE      SP70,DBFHUC1 
          MOVE      SP70,DBFHUC2 
          MOVE      SP70,DBFHSPA 
          MOVE      SP70,KEY21
          MOVE      SP70,DBFHDOC 
          GOTO      HDBFHA96
HDBFHA92
          MOVE      SP70,KEY21
          MOVE      SP70,DBFHDOC 
          LOAD      KEY21,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY21,DBFHDEB,DBFHDTY,DBFHDOC                               
HDBFHA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HDBFHA99
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBFTHKY
.   Routine   :   KDBFHA00 Keyin Invoice             
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KDBFHA00 TOPIC     "DBFHDOC "
          MOVE      UNDLN70,DBFHDOC 
          KEYIN     *PCCOL:CVERT,*DV,DBFHDOC:                                   
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,DBFHDOC:                        
                    *PCCOL:CVERT,*DV,DBFHDOC 
.
          ENDSET    DBFHDOC 
          APPEND    SP70,DBFHDOC 
          RESET     DBFHDOC 
.
          MATCH     SP70,DBFHDOC 
          GOTO      KDBFHA90 IF EQUAL
.
          ENDSET    DBFHDOC 
          CMATCH    EXITCHAR,DBFHDOC 
          GOTO      KDBFHA95 IF EQUAL
.
          CMATCH    QUEST,DBFHDOC 
          GOTO      KDBFHA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HDBFHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DBFHDOC 
          APPEND    SP70,DBFHDOC 
          RESET     DBFHDOC 
.
          MATCH     SP70,DBFHDOC 
          GOTO      KDBFHA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DBFHDOC                                 
KDBFHA10
          RESET     DBFHDOC 
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC                               
          CALL      RADBFH1 
          BRANCH    OVRCD,KDBFHA80
          BRANCH    CKEYTYP,KDBFHA75
          CALL      RDDBFH1 
KDBFHA70
          MOVE      ZERO,EXIT
          GOTO      KDBFHA99
KDBFHA75
          MOVE      "Invoice Already Exist - ",DISPMSG                                               
          CALL      MESSAGE1
          GOTO      KDBFHA00
KDBFHA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KDBFHA99,KDBFHA99
          MOVE      "Invoice Does Not Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KDBFHA00
KDBFHA90
          MOVE      ONE,EXIT
          GOTO      KDBFHA99
KDBFHA95
          MOVE      TWO,EXIT
KDBFHA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBFTHKY
.   Routine   :   KDBFHX00 Keyin Invoice             
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KDBFHX00 TOPIC     "DBFHDOC "
          MOVE      UNDLN70,DBFHDOC 
          KEYIN     *PCCOL:CVERT,*DV,DBFHDOC:                                   
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,DBFHDOC:                        
                    *PCCOL:CVERT,*DV,DBFHDOC 
.
          ENDSET    DBFHDOC 
          APPEND    SP70,DBFHDOC 
          RESET     DBFHDOC 
.
          MATCH     SP70,DBFHDOC 
          GOTO      KDBFHX90 IF EQUAL
.
          MATCH     "000000000000",DBFHDOC 
          GOTO      KDBFHX85 IF EQUAL
.
          ENDSET    DBFHDOC 
          CMATCH    EXITCHAR,DBFHDOC 
          GOTO      KDBFHX95 IF EQUAL
.
          CMATCH    QUEST,DBFHDOC 
          GOTO      KDBFHX10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HDBFHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DBFHDOC 
          APPEND    SP70,DBFHDOC 
          RESET     DBFHDOC 
.
          MATCH     SP70,DBFHDOC 
          GOTO      KDBFHX00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DBFHDOC                                 
KDBFHX10
          RESET     DBFHDOC 
          PACK      KEY21,DBFHDEB,DBFHDTY,DBFHDOC                               
          CALL      RADBFH1 
          BRANCH    OVRCD,KDBFHX80
          BRANCH    CKEYTYP,KDBFHX75
          CALL      RDDBFH1 
KDBFHX70
          MOVE      ZERO,EXIT
          GOTO      KDBFHX99
KDBFHX75
          MOVE      "Invoice Already Exist - ",DISPMSG                                               
          CALL      MESSAGE1
          GOTO      KDBFHX00
KDBFHX80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KDBFHX99,KDBFHX99
          MOVE      "Invoice Does Not Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KDBFHX00
.
KDBFHX85  MOVE      THREE,EXIT   * Special for Credit Note 
          GOTO      KDBFHX99
.
KDBFHX90  MOVE      ONE,EXIT
          GOTO      KDBFHX99
KDBFHX95
          MOVE      TWO,EXIT
KDBFHX99 TOPIC    PRGID
          RETURN
