.------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  14.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove PSN prefixed PAS cloned includes
.-------------------------------------------------------
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.04.01  07.07.1997 B.G.Ackland
.           File Layout Changes
.-------------------------------------------------------
ACCOTHER  INIT      "Acc. Other"
ACTDUR    INIT      "Actual Duration"
BANTOTPC  FORM      12.2
BANTOTSC  FORM      12.2
BANTOTPQ  FORM      12.2
BANTOTSQ  FORM      12.2
COST1     FORM      10.2[9]
COST2     FORM      10.2[9]
COST3     FORM      10.2[9]
COST4     FORM      10.2[9]
COST5     FORM      10.2[9]
ENDBAN    DIM       3
ENDCLI    DIM       6
ENDDTY    DIM       3
ENDIMP    DIM       6
ENDMBS    DIM       9
ENDNTY    DIM       3
ENDTDESC  DIM      18
F12P2     FORM      12.2
FMT01     DIM       11
FMT02     DIM       11
FMT03     DIM       11
FMT04     DIM       11
FMT05     DIM       11
FMT06     DIM       11
LASTBAN   DIM       3
LASTCLI   DIM       6
LASTDTY   DIM       3
LASTIMP   DIM       6
LASTMBS   DIM       9
LASTNTY   DIM       3
LASTSPC   DIM       3
MBSTOTPC  FORM      12.2
MBSTOTSC  FORM      12.2
MBSTOTPQ  FORM      12.2
MBSTOTSQ  FORM      12.2
MISOTHER  INIT      "Misc Other"
OPCNCLSU  FORM      1        111      Using Clinic or Surgeon ?
.                                          0 = Clinic
.                                          1 = Surgeon
OPRCLIOP  FORM      1
OPREXPOP  FORM      1
PATDOCOP  FORM      1
PRICST    DIM       11
PRIQTY    DIM       9
SECCST    DIM       11
SECQTY    DIM       9
STRBAN    DIM       3
STRCLI    DIM       6
STRDTY    DIM       3
STRIMP    DIM       6
STRMBS    DIM       9
STRNTY    DIM       3
STRTDESC  DIM      18
THEATRE   INIT      "Theatre   "
TOTCOST1  FORM      12.2
TOTCOST2  FORM      12.2
TOTCOST3  FORM      12.2
TOTCOST4  FORM      12.2
TOTCOST5  FORM      12.2
TYPDESC   DIM       10
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA38
.   Function      :   Theatre Patient Service Report          
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCONFD/INC
          INC       CCSOPTDF    
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       CEATAMFD/INC
          INC       CEATBMFD/INC
          INC       CEATCMFD/INC
          INC       CEATDMFD/INC
          INC       CEATEMFD/INC
          INC       CEATFMFD/INC
          INC       CEATGMFD/INC
          INC       OPRCLIFD/INC
          INC       OPREXPFD/INC
          INC       PATCODFD/INC
          INC       PATDO1FD/INC
          INC       PATITMFD/INC
.=========================
.Local Variable Definition
.-------------------------
REPTFMT   FORM      2 * Scr 01 Fld     4
FROMMBS   DIM      40 * Scr 01 Fld     5
TOMBS     DIM      40 * Scr 01 Fld     6
DESCFMT   DIM      20 * Scr 01 Fld     7
FROMBAN   DIM      40 * Scr 02 Fld     5
TOBAN     DIM      40 * Scr 02 Fld     6
FROMDTY   DIM      40 * Scr 03 Fld     5
TODTY     DIM      40 * Scr 03 Fld     6
FROMNTY   DIM      40 * Scr 04 Fld     5
TONTY     DIM      40 * Scr 04 Fld     6
FROMCLI   DIM      40 * Scr 05 Fld     5
TOCLI     DIM      40 * Scr 05 Fld     6
FROMIMP   DIM      40 * Scr 07 Fld     5
TOIMP     DIM      40 * Scr 07 Fld     6
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA38"
PRGNAM    INIT      "Theatre Patient Service Report          "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening ceatamaf";
          OPEN      CEATAMA1,"ceatamaf"
          DISPLAY   *P56:24,"Opening ceatbmaf";
          OPEN      CEATBMA1,"ceatbmaf"
          DISPLAY   *P56:24,"Opening ceatcmaf";
          OPEN      CEATCMA1,"ceatcmaf"
          DISPLAY   *P56:24,"Opening ceatdmaf";
          OPEN      CEATDMA1,"ceatdmaf"
          DISPLAY   *P56:24,"Opening ceatemaf";
          OPEN      CEATEMA1,"ceatemaf"
          DISPLAY   *P56:24,"Opening ceatfmaf";
          OPEN      CEATFMA1,"ceatfmaf"
          DISPLAY   *P56:24,"Opening ceatgmaf";
          OPEN      CEATGMA1,"ceatgmaf"
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE1,"patcodes"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A1,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patitemn           ";
          OPEN      PATITEM1,"patitemn"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Report Options                     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * MBS Item Report                    
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Theatre Band Mapping               
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Doctor Time Report                 
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Nurse Type Mapping                 
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Clinic/Surgeon Time Mapping        
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Clinic/Surgeon Materials           
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Implant Code Mapping               
          ENDIF
          RETURN
.--------------------------------
. Screen - Report Options                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Report Options                     
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Report Options                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Report Options                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Report Options                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Report Options                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Report Options                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Report Options                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC07L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - MBS Item Report                    
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      REPDEF00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : MBS Item Report                    
.-------------------------------------------------------
CF01L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMMBS 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for MBS Item Report                    
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : MBS Item Report                    
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : MBS Item Report                    
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : MBS Item Report                    
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : MBS Item Report                    
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104
          GOTO     PS01L999
.
PS01L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      FROMMBS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      TOMBS,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : MBS Item Report                    
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L104,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      REPA0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMBS   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMBS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMMBS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMBS,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Theatre Band Mapping               
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      REPDEF00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Theatre Band Mapping               
.-------------------------------------------------------
CF02L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMBAN 
          MOVE      SP70,TOBAN   
          MOVE      SP70,DESCFMT 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Theatre Band Mapping               
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Theatre Band Mapping               
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Theatre Band Mapping               
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Theatre Band Mapping               
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Theatre Band Mapping               
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104
          GOTO     PS02L999
.
PS02L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      FROMBAN,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      TOBAN,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Theatre Band Mapping               
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L104,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      REPB0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOBAN   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RBAN0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMBAN,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOBAN,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Doctor Time Report                 
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      REPDEF00
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Doctor Time Report                 
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Doctor Time Report                 
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Doctor Time Report                 
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Doctor Time Report                 
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Doctor Time Report                 
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Doctor Time Report                 
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L101,PS03L102
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMDTY,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      TODTY,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Doctor Time Report                 
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L006:
                           SF03L103,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L103,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      REPC0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMDTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Nurse Type Mapping                 
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      REPDEF00
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Nurse Type Mapping                 
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Nurse Type Mapping                 
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Nurse Type Mapping                 
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Nurse Type Mapping                 
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Nurse Type Mapping                 
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Nurse Type Mapping                 
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L101,PS04L102
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMNTY,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      TONTY,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Nurse Type Mapping                 
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L006:
                           SF04L103,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L103,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      REPD0000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TONTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RNTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMNTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TONTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Clinic/Surgeon Time Mapping        
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      REPDEF00
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Clinic/Surgeon Time Mapping        
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Clinic/Surgeon Time Mapping        
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Clinic/Surgeon Time Mapping        
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Clinic/Surgeon Time Mapping        
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Clinic/Surgeon Time Mapping        
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Clinic/Surgeon Time Mapping        
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L101,PS05L102
          GOTO     PS05L999
.
PS05L101
          MOVE      FROMCLI,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      TOCLI,VAR        
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Clinic/Surgeon Time Mapping        
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L006:
                           SF05L103,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L103,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      REPE0000
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCLI   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCLI0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMCLI,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCLI,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.--------------------------------
. Screen - Clinic/Surgeon Materials           
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
          CALL      REPDEF00
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Clinic/Surgeon Materials           
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Clinic/Surgeon Materials           
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Clinic/Surgeon Materials           
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Clinic/Surgeon Materials           
.---------------------------------------------------------
LM06L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Clinic/Surgeon Materials           
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Clinic/Surgeon Materials           
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L101,PS06L102
          GOTO     PS06L999
.
PS06L101
          MOVE      FROMCLI,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      TOCLI,VAR        
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Clinic/Surgeon Materials           
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L006:
                           SF06L103,SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L103,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      REPF0000
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCLI   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCLI0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L103
            ENDIF
            BRANCH    EXIT,SF06L103,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      FROMCLI,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCLI,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.--------------------------------
. Screen - Implant Code Mapping               
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC07L200
          CALL      CF07L000 * Clear Fields
          CALL      REPDEF00
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Implant Code Mapping               
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Implant Code Mapping               
.--------------------------------------------------------
KY07L000
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Implant Code Mapping               
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Implant Code Mapping               
.---------------------------------------------------------
LM07L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Implant Code Mapping               
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Implant Code Mapping               
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L101,PS07L102
          GOTO     PS07L999
.
PS07L101
          MOVE      FROMIMP,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      TOIMP,VAR        
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Implant Code Mapping               
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L101,SF07L102,SF07L006:
                           SF07L103,SF07L006
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L103,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          GOTO     SF07L001
.
SF07L101
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L102
          CALL      REPG0000
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOIMP   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RIMP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF07L103
            ENDIF
            BRANCH    EXIT,SF07L103,SF07L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF07L990 IF EQUAL
          ENDIF
          MOVE      FROMIMP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOIMP,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF07L001
SF07L990  MOVE      FOUR,EXIT * Exit Char Exit
SF07L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Setup Report Defaults
.------------------------------------------------------------
REPDEF00  MOVE      SP70,STRMBS
          MOVE      Z70,ENDMBS
          MOVE      "Start                  ",FROMMBS
          MOVE      "Finish                 ",TOMBS
          MOVE      SP70,STRBAN
          MOVE      Z70,ENDBAN
          MOVE      "Start                  ",FROMBAN
          MOVE      "Finish                 ",TOBAN
          MOVE      SP70,STRDTY
          MOVE      Z70,ENDDTY
          MOVE      "Start                  ",FROMDTY
          MOVE      "Finish                 ",TODTY
          MOVE      SP70,STRNTY
          MOVE      Z70,ENDNTY
          MOVE      "Start                  ",FROMNTY
          MOVE      "Finish                 ",TONTY
          MOVE      SP70,STRCLI
          MOVE      Z70,ENDCLI
          MOVE      "Start                  ",FROMCLI
          MOVE      "Finish                 ",TOCLI
          MOVE      SP70,STRIMP
          MOVE      Z70,ENDIMP
          MOVE      "Start                  ",FROMIMP
          MOVE      "Finish                 ",TOIMP
          MOVE      ZERO,REPTFMT
          MOVE      "Standard",DESCFMT
.
          MOVE      "40",AUDTSECT
          READ      CONTROLF,AUDTSECT;*111,OPCNCLSU
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OPREXPA1,"oprexpaf"
          TRAPCLR   IO
          MOVE      OVRCD,OPREXPOP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OPRCLIA1,"oprcliaf"
          TRAPCLR   IO
          MOVE      OVRCD,OPRCLIOP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"                                * V90200
          TRAPCLR   IO
          MOVE      OVRCD,PATDOCOP
          GOTO      REPDEF99
.
REPDEF99  RETURN
.
.------------------------------------------------------------
. Print Service Provider Listing
.------------------------------------------------------------
REPA0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      ZERO,MBSTOTPC
          MOVE      ZERO,MBSTOTSC
          COMPARE   ONE,REPTFMT
          CALL      CLRTOT00 IF EQUAL
.
          MOVE      SP70,LASTMBS
          MOVE      SP70,LASTSPC
          PACK      KEY19,STRMBS,SP70
          CALL      RDCETB1
          IF        OVRCD=0
            CALL      RPCETB1
          ENDIF
REPA1000  CALL      RKCETB1
          BRANCH    OVRCD,REPA9000
          MATCH     CETBMBS,ENDMBS
          GOTO      REPA9000 IF LESS
.
          MATCH     LASTMBS,CETBMBS
          IF        !@EQUAL
            CALL      PRTMBS00
          ENDIF
.
          BRANCH    REPTFMT,REPA2000,REPA3000
.
          COMPARE   "55",CLNO
          CALL      HEDA0000 IF NOT LESS
.
          MATCH     LASTSPC,CETBSPC
          IF        !@EQUAL
            MOVE       CETBSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETBSPC,SP1,CESPDES;
            MOVE       CETBSPC,LASTSPC
          ENDIF
.
          MOVE       CETBPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "99,999.99",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      CETBPQTY,PRIQTY
          FEDIT      CETBSQTY,SECQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CETBPQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,MBSTOTPC       * MBS Primary Op Total
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CETBSQTY,F12P2
          FEDIT      F12P2,SECCST
          ADD        F12P2,MBSTOTSC
.
          PRINT     *47,CETBPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          GOTO      REPA1000
.
REPA2000  MOVE       CETBPSC,KEY7
          CALL       RDCEPS1
          MOVE       CEPSTYP,F1
.
          ASSIGN     COST1[F1]+(CEPSST1*CETBPQTY),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CETBPQTY),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CETBPQTY),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CETBPQTY),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CETBPQTY),COST5[F1]
          GOTO       REPA1000
.
REPA3000  MOVE       CETBPSC,KEY7
          CALL       RDCEPS1
          MOVE       CEPSTYP,F1
          ASSIGN     COST1[F1]+(CEPSST1*CETBSQTY),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CETBSQTY),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CETBSQTY),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CETBSQTY),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CETBSQTY),COST5[F1]
          GOTO       REPA1000
.
REPA9000  CALL      MBSTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDA0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre MBS ITem Mapping From : ",FROMMBS
          PRINT     "                         To   : ",TOMBS
          PRINT     "Report Format                 : ",REPTFMT,SP1,DESCFMT
          CALL      UND132
          IF        REPTFMT=0
            PRINT     "MBS Item                                           ":
                      "                                          Primary O":
                      "peration |   Non-Primary Op."
            PRINT     "      Service Provider                        Patie":
                      "nt Service                                   Qty   ":
                      "    Cost |      Qty      Cost"
          ELSE
            PRINT     "MBS Item                                            ":
                      "Income     |                    Cost Components   ":
                      "                  |      Total"
            PRINT     "                                                    ":
                      "Component  |  ",CCCOCD1,SP1,CCCOCD2,SP1,CCCOCD3:
                      CCCOCD4,SP1,CCCOCD5," |           "
          ENDIF
          CALL      UND132
          RETURN

PRTMBS00  MATCH     SP70,LASTMBS
          CALL      MBSTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDA0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      CETBMBS,KEY9
          CALL      RDITEM1                                            * V90200
          MOVE      CETBMBS,LASTMBS
          MOVE      SP70,LASTSPC
.
          BRANCH    REPTFMT,PRTMBS99,PRTMBS99
.
          PRINT     CETBMBS,SP1,IDESC                                  * V90200
          PRINT      *7,CETBSPC,SP1,CESPDES;
.
PRTMBS99  RETURN
.
MBSTOT00  BRANCH     REPTFMT,MBSTOT50,MBSTOT50
          CALL      UND132
          MOVE       "         ",PRIQTY
          MOVE       "         ",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      MBSTOTPC,PRICST
          FEDIT      MBSTOTSC,SECCST
          PRINT     "Total",*91,PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,MBSTOTPC
          MOVE      ZERO,MBSTOTSC
          GOTO      MBSTOT99
.
MBSTOT50  COMPARE   "40",CLNO
          CALL      HEDA0000 IF NOT LESS
          MOVE      ZERO,F1
          MOVE      ZERO,TOTCOST1
          MOVE      ZERO,TOTCOST2
          MOVE      ZERO,TOTCOST3
          MOVE      ZERO,TOTCOST4
          MOVE      ZERO,TOTCOST5
          PRINT     LASTMBS,SP1,IDESC;                                 * V90200
.
MBSTOT60  ADD       ONE,F1
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     COST1[F1],FMT01
          FEDIT     COST2[F1],FMT02
          FEDIT     COST3[F1],FMT03
          FEDIT     COST4[F1],FMT04
          FEDIT     COST5[F1],FMT05
          ADD       COST1[F1],TOTCOST1
          ADD       COST2[F1],TOTCOST2
          ADD       COST3[F1],TOTCOST3
          ADD       COST4[F1],TOTCOST4
          ADD       COST5[F1],TOTCOST5
          ASSIGN    COST1[F1]+COST2[F1]+COST3[F1]+COST4[F1]+COST5[F1],F12P2
          COMPARE   ZERO,F12P2
          GOTO      MBSTOT70 IF EQUAL
          FEDIT     F12P2,FMT06
          LOAD      TYPDESC,F1,THEATRE,CCCOIA1,CCCOIA2,CCCOIA3,ACCOTHER:
                               CCCOIM1,CCCOIM2,CCCOIM3,MISOTHER
.
          ADD       "1",CLNO
          PRINT     *53,TYPDESC," |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
MBSTOT70  COMPARE   "9",F1
          GOTO      MBSTOT60 IF NOT EQUAL
.
          CALL      UND132
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     TOTCOST1,FMT01
          FEDIT     TOTCOST2,FMT02
          FEDIT     TOTCOST3,FMT03
          FEDIT     TOTCOST4,FMT04
          FEDIT     TOTCOST5,FMT05
          ASSIGN    TOTCOST1+TOTCOST2+TOTCOST3+TOTCOST4+TOTCOST5,F12P2
          FEDIT     F12P2,FMT06
          PRINT     *53,"Total      |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
          CALL      UND132
          ADD       "1",CLNO
          CALL      CLRTOT00
.
MBSTOT99  RETURN
.
CLRTOT00  MOVE      ZERO,F1
.
CLRTOT10  ADD       ONE,F1
          MOVE      ZERO,COST1[F1]
          MOVE      ZERO,COST2[F1]
          MOVE      ZERO,COST3[F1]
          MOVE      ZERO,COST4[F1]
          MOVE      ZERO,COST5[F1]
.
          COMPARE   "9",F1
          GOTO      CLRTOT10 IF NOT EQUAL
          RETURN
.------------------------------------------------------------
. ENter Report Format 0=Standard
.------------------------------------------------------------
EFMT0000   CALL      DFMT0000
           MOVE      ZERO,REPTFMT
EFMT0100   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTFMT
           COMPARE   ZERO,REPTFMT
           GOTO      EFMT9000 IF EQUAL
           BRANCH    REPTFMT,EFMT1000,EFMT1100
           BEEP
           GOTO      EFMT0100
.
EFMT1000   MOVE      "Primary Cost Summary",DESCFMT
           GOTO      EFMT9999
EFMT1100   MOVE      "Non-Primary Cost Summary",DESCFMT
           GOTO      EFMT9999
.
EFMT9000   MOVE      "Standard",DESCFMT
           GOTO      EFMT9999
.
EFMT9999   CALL      PUTSCR00
           RETURN
.
DFMT0000  MOVE      "18",HTOP
          MOVE      "50",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P55:19,*V2LON,*ULON,"Report Format",*HOFF:
                    *P52:20,*V2LON,"0. ",*HOFF,"Standard":
                    *P52:21,*V2LON,"1. ",*HOFF,"Primary Cost Summary":
                    *P52:22,*V2LON,"2. ",*HOFF,"Non-Primary Cost Summary"
          RETURN
.

.------------------------------------------------------------
. Enter a Range of Patient Service Codes
.------------------------------------------------------------
RMBS0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           CALL     KPITMA00                                           * V90200
           BRANCH   EXIT,RMBS0100,RMBS0999
           MOVE     ITEMNO,STRMBS                                      * V90200
           PACK     FROMMBS,ITEMNO,SP1,IDESC                           * V90200
           GOTO     RMBS0140
RMBS0100   MOVE     "Start             ",FROMMBS
           MOVE     SP70,STRMBS
.
RMBS0140   MOVE     FROMMBS,VAR
           CALL     DISPITEM
.
RMBS0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           CALL     KPITMA00                                           * V90200
           BRANCH   EXIT,RMBS0200,RMBS0999
           MOVE     ITEMNO,ENDMBS                                      * V90200
           PACK     TOMBS,ITEMNO,SP1,IDESC                             * V90200
           MATCH    STRMBS,ENDMBS
           GOTO     RMBS0999 IF EQUAL
           GOTO     RMBS0999 IF NOT LESS
           BEEP
           MOVE     "To MBS Must Be > From MBS - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RMBS0000
.
RMBS0200   MOVE     "Finish             ",TOMBS
           MOVE     "ZZ",ENDMBS
.
RMBS0999   MOVE     "    1",FLDID
           CALL     GETPOSIT
           RETURN

.------------------------------------------------------------
. Print Service Provider Listing
.------------------------------------------------------------
REPB0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      ZERO,BANTOTPC
          MOVE      ZERO,BANTOTSC
          COMPARE   ONE,REPTFMT
          CALL      CLRTOT00 IF EQUAL
          COMPARE   TWO,REPTFMT
          CALL      CLRTOT00 IF EQUAL
.
          MOVE      SP70,LASTBAN
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRBAN,SP70
          CALL      RDCETA1
          IF        OVRCD=0
            CALL      RPCETA1
          ENDIF
REPB1000  CALL      RKCETA1
          BRANCH    OVRCD,REPB9000
          MATCH     CETABAND,ENDBAN
          GOTO      REPB9000 IF LESS
.
          MATCH     LASTBAN,CETABAND
          IF        !@EQUAL
            CALL      PRTBAN00
          ENDIF
.
          BRANCH    REPTFMT,REPB2000,REPB3000
.
          COMPARE   "55",CLNO
          CALL      HEDB0000 IF NOT LESS
.
          MATCH     LASTSPC,CETASPC
          IF        !@EQUAL
            MOVE       CETASPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETASPC,SP1,CESPDES;
            MOVE       CETASPC,LASTSPC
          ENDIF
.
          MOVE       CETAPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "99,999.99",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      CETAPQTY,PRIQTY
          FEDIT      CETASQTY,SECQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CETAPQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,BANTOTPC       * BAND Primary Op Total
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CETASQTY,F12P2
          FEDIT      F12P2,SECCST
          ADD        F12P2,BANTOTSC
.
          PRINT     *47,CETAPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          GOTO      REPB1000
.
REPB2000  MOVE       CETAPSC,KEY7
          CALL       RDCEPS1
          MOVE       CEPSTYP,F1
.
          ASSIGN     COST1[F1]+(CEPSST1*CETAPQTY),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CETAPQTY),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CETAPQTY),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CETAPQTY),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CETAPQTY),COST5[F1]
          GOTO       REPB1000
.
REPB3000  MOVE       CETAPSC,KEY7
          CALL       RDCEPS1
          MOVE       CEPSTYP,F1
.
          ASSIGN     COST1[F1]+(CEPSST1*CETASQTY),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CETASQTY),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CETASQTY),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CETASQTY),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CETASQTY),COST5[F1]
          GOTO       REPB1000
.
REPB9000  CALL      BANTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDB0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre Band Mapping From : ",FROMBAN
          PRINT     "                     To   : ",TOBAN
          PRINT     "Report Format             : ",REPTFMT,SP1,DESCFMT
          CALL      UND132
          IF        REPTFMT=0
            PRINT     "Theatre Band                                       ":
                      "                                          Primary O":
                      "peration |   Non-Primary Op."
            PRINT     "      Service Provider                        Patie":
                      "nt Service                                   Qty   ":
                      "    Cost |      Qty      Cost"
          ELSE
            PRINT     "Theatre Band                                        ":
                      "Income     |                    Cost Components   ":
                      "                  |      Total"
            PRINT     "                                                    ":
                      "Component  |  ",CCCOCD1,SP1,CCCOCD2,SP1,CCCOCD3:
                      CCCOCD4,SP1,CCCOCD5," |           "
          ENDIF
          CALL      UND132
          RETURN

PRTBAN00  MATCH     SP70,LASTBAN
          CALL      BANTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDB0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "TB",TCODE                                         * V90200
          PACK      KEY5,TCODE,CETABAND                                * V90200
          CALL      RDCODE1                                            * V90200
          MOVE      CETABAND,LASTBAN
          MOVE      SP70,LASTSPC
.
          BRANCH    REPTFMT,PRTBAN99,PRTBAN99
.
          PRINT     CETABAND,SP1,TDESC                                 * V90200
          PRINT      *7,CETASPC,SP1,TDESC;                             * V90200
.
PRTBAN99  RETURN
.
BANTOT00  BRANCH     REPTFMT,BANTOT50,BANTOT50
          CALL      UND132
          MOVE       "         ",PRIQTY
          MOVE       "         ",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      BANTOTPC,PRICST
          FEDIT      BANTOTSC,SECCST
          PRINT     "Total",*91,PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,BANTOTPC
          MOVE      ZERO,BANTOTSC
          GOTO      BANTOT99
.
BANTOT50  COMPARE   "40",CLNO
          CALL      HEDB0000 IF NOT LESS
          MOVE      ZERO,F1
          MOVE      ZERO,TOTCOST1
          MOVE      ZERO,TOTCOST2
          MOVE      ZERO,TOTCOST3
          MOVE      ZERO,TOTCOST4
          MOVE      ZERO,TOTCOST5
          PRINT     LASTBAN,SP1,TDESC;                                * V90200
.
BANTOT60  ADD       ONE,F1
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     COST1[F1],FMT01
          FEDIT     COST2[F1],FMT02
          FEDIT     COST3[F1],FMT03
          FEDIT     COST4[F1],FMT04
          FEDIT     COST5[F1],FMT05
          ADD       COST1[F1],TOTCOST1
          ADD       COST2[F1],TOTCOST2
          ADD       COST3[F1],TOTCOST3
          ADD       COST4[F1],TOTCOST4
          ADD       COST5[F1],TOTCOST5
          ASSIGN    COST1[F1]+COST2[F1]+COST3[F1]+COST4[F1]+COST5[F1],F12P2
          COMPARE   ZERO,F12P2
          GOTO      BANTOT70 IF EQUAL
          FEDIT     F12P2,FMT06
          LOAD      TYPDESC,F1,THEATRE,CCCOIA1,CCCOIA2,CCCOIA3,ACCOTHER:
                               CCCOIM1,CCCOIM2,CCCOIM3,MISOTHER
.
          ADD       "1",CLNO
          PRINT     *53,TYPDESC," |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
BANTOT70  COMPARE   "9",F1
          GOTO      BANTOT60 IF NOT EQUAL
.
          CALL      UND132
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     TOTCOST1,FMT01
          FEDIT     TOTCOST2,FMT02
          FEDIT     TOTCOST3,FMT03
          FEDIT     TOTCOST4,FMT04
          FEDIT     TOTCOST5,FMT05
          ASSIGN    TOTCOST1+TOTCOST2+TOTCOST3+TOTCOST4+TOTCOST5,F12P2
          FEDIT     F12P2,FMT06
          PRINT     *53,"Total      |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
          CALL      UND132
          ADD       "1",CLNO
          CALL      CLRTOT00
.
BANTOT99  RETURN
.
.------------------------------------------------------------
. Enter a Range of Patient Service Codes
.------------------------------------------------------------
RBAN0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     "TB",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RBAN0100,RBAN0999
           MOVE     ACODE,STRBAN                                       * V90200
           PACK     FROMBAN,ACODE,SP1,TDESC                            * V90200
           GOTO     RBAN0140
RBAN0100   MOVE     "Start             ",FROMBAN
           MOVE     SP70,STRBAN
.
RBAN0140   MOVE     FROMBAN,VAR
           CALL     DISPITEM
.
RBAN0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     "TB",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RBAN0200,RBAN0999
           MOVE     ACODE,ENDBAN                                       * V90200
           PACK     TOBAN,ACODE,SP1,TDESC                              * V90200
           MATCH    STRBAN,ENDBAN
           GOTO     RBAN0999 IF EQUAL
           GOTO     RBAN0999 IF NOT LESS
           BEEP
           MOVE     "To Theatre Band Must Be > From Theatre Band - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RBAN0000
.
RBAN0200   MOVE     "Finish             ",TOBAN
           MOVE     "ZZ",ENDBAN
.
RBAN0999   MOVE     "    1",FLDID
           CALL     GETPOSIT
           RETURN

.------------------------------------------------------------
. Print Report
.------------------------------------------------------------
REPC0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "68",AUDTSECT
          READ      CONTROLF,AUDTSECT;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTDTY
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRDTY,SP70
          CALL      RDCETD1
          IF        OVRCD=0
            CALL      RPCETD1
          ENDIF
REPC1000  CALL      RKCETD1
          BRANCH    OVRCD,REPC9000
          MATCH     CETDDTY,ENDDTY
          GOTO      REPC9000 IF LESS
.
          MATCH     LASTDTY,CETDDTY
          IF        !@EQUAL
            CALL      PRTDTY00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          MATCH     LASTSPC,CETDSPC
          IF        !@EQUAL
            MOVE       CETDSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETDSPC,SP1,CESPDES;
            MOVE       CETDSPC,LASTSPC
          ENDIF
.
          LOAD       STRTDESC,CETDSTM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4,ACTDUR
          LOAD       ENDTDESC,CETDETM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4,ACTDUR
          MOVE       CETDPSC,KEY7
          CALL       RDCEPS1
          PRINT     *47,CETDPSC,SP1,CEPSDES,SP1:
                    CETDSTM,SP1,STRTDESC,SP1,CETDETM,SP1,ENDTDESC
          ADD       ONE,CLNO
          GOTO      REPC1000
.
REPC9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDC0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre Doctor Type  Mapping From : ",FROMDTY
          PRINT     "                             To   : ",TODTY
          CALL      UND132
          PRINT     "Doctor Type                                        "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                             Start Time ":
                    "           End Time          "
          CALL      UND132
          RETURN

PRTDTY00  MATCH     SP70,LASTDTY
          CALL      UND132 IF NOT EQUAL
          COMPARE   "50",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "OP",KEY2
          PACK      KEY5,KEY2,CETDDTY,SP70
          CALL      RDCODE1                                            * V90200
          MOVE      CETDDTY,LASTDTY
          MOVE      SP70,LASTSPC
.
          PRINT     CETDDTY,SP1,TCODE                                  * V90200
          PRINT      *7,CETDSPC,SP1,TCODE;                             * V90200
.
PRTDTY99  RETURN
.
.------------------------------------------------------------
. Enter DTYtor Type Range
.------------------------------------------------------------
RDTY0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "OP",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RDTY0100,RDTY0999
           MOVE     ACODE,STRDTY                                       * V90200
           PACK     FROMDTY,ACODE,SP1,TDESC                            * V90200
           GOTO     RDTY0140
RDTY0100   MOVE     "Start             ",FROMDTY
           MOVE     SP70,STRDTY
.
RDTY0140   MOVE     FROMDTY,VAR
           CALL     DISPITEM
.
RDTY0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "OP",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RDTY0200,RDTY0999
           MOVE     ACODE,ENDDTY                                       * V90200
           PACK     TODTY,ACODE,SP1,TDESC                              * V90200
           MATCH    STRDTY,ENDDTY
           GOTO     RDTY0999 IF EQUAL
           GOTO     RDTY0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDTY0000
.
RDTY0200   MOVE     "Finish             ",TODTY
           MOVE     "~~~~~~~~~~",ENDDTY
.
RDTY0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.
.------------------------------------------------------------
. Print Report
.------------------------------------------------------------
REPD0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "68",AUDTSECT
          READ      CONTROLF,AUDTSECT;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTNTY
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRNTY,SP70
          CALL      RDCETC1
          IF        OVRCD=0
            CALL      RPCETC1
          ENDIF
REPD1000  CALL      RKCETC1
          BRANCH    OVRCD,REPD9000
          MATCH     CETCNT,ENDNTY
          GOTO      REPD9000 IF LESS
.
          MATCH     LASTNTY,CETCNT
          IF        !@EQUAL
            CALL      PRTNTY00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDD0000 IF NOT LESS
.
          MATCH     LASTSPC,CETCSPC
          IF        !@EQUAL
            MOVE       CETCSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETCSPC,SP1,CESPDES;
            MOVE       CETCSPC,LASTSPC
          ENDIF
.
          LOAD       STRTDESC,CETCSTM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4,ACTDUR
          LOAD       ENDTDESC,CETCETM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4,ACTDUR
          MOVE       CETCPSC,KEY7
          CALL       RDCEPS1
          PRINT     *47,CETCPSC,SP1,CEPSDES,SP1:
                    CETCSTM,SP1,STRTDESC,SP1,CETCETM,SP1,ENDTDESC
          ADD       ONE,CLNO
          GOTO      REPD1000
.
REPD9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDD0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre Nurse Type  Mapping From : ",FROMNTY
          PRINT     "                            To   : ",TONTY
          CALL      UND132
          PRINT     "Nurse Type                                         "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                             Start Time ":
                    "           End Time          "
          CALL      UND132
          RETURN

PRTNTY00  MATCH     SP70,LASTNTY
          CALL      UND132 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDD0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "ON",TCODE                                         * V90200
          PACK      KEY5,TCODE,CETCNT                                  * V90200
          CALL      RDCODE1                                            * V90200
          MOVE      CETCNT,LASTNTY
          MOVE      SP70,LASTSPC
.
          PRINT     CETCNT,SP1,TDESC                                   * V90200
          PRINT      *7,CETCSPC,SP1,TDESC;                             * V90200
.
PRTNTY99  RETURN
.
.------------------------------------------------------------
. Enter Nurse Type Range
.------------------------------------------------------------
RNTY0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "ON",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RNTY0100,RNTY0999
           MOVE     ACODE,STRNTY                                       * V90200
           PACK     FROMNTY,ACODE,SP1,TDESC                            * V90200
           GOTO     RNTY0140
RNTY0100   MOVE     "Start             ",FROMNTY
           MOVE     SP70,STRNTY
.
RNTY0140   MOVE     FROMNTY,VAR
           CALL     DISPITEM
.
RNTY0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "ON",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RNTY0200,RNTY0999
           MOVE     ACODE,ENDNTY                                       * V90200
           PACK     TONTY,ACODE,SP1,TDESC                              * V90200
           MATCH    STRNTY,ENDNTY
           GOTO     RNTY0999 IF EQUAL
           GOTO     RNTY0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RNTY0000
.
RNTY0200   MOVE     "Finish             ",TONTY
           MOVE     "~~~~~~~~~~",ENDNTY
.
RNTY0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.
.------------------------------------------------------------
. Print Report
.------------------------------------------------------------
REPE0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "68",AUDTSECT
          READ      CONTROLF,AUDTSECT;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTCLI
          MOVE      SP70,LASTSPC
          PACK      KEY16,STRCLI,SP70
          CALL      RDCETF1
          IF        OVRCD=0
            CALL      RPCETF1
          ENDIF
REPE1000  CALL      RKCETF1
          BRANCH    OVRCD,REPE9000
          MATCH     CETFCLI,ENDCLI
          GOTO      REPE9000 IF LESS
.
          MATCH     LASTCLI,CETFCLI
          IF        !@EQUAL
            CALL      PRTCLI00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDE0000 IF NOT LESS
.
          MATCH     LASTSPC,CETFSPC
          IF        !@EQUAL
            MOVE       CETFSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETFSPC,SP1,CESPDES;
            MOVE       CETFSPC,LASTSPC
          ENDIF
.
          LOAD       STRTDESC,CETFSTM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4,ACTDUR
          LOAD       ENDTDESC,CETFETM,OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4,ACTDUR
          MOVE       CETFPSC,KEY7
          CALL       RDCEPS1
          PRINT     *47,CETFPSC,SP1,CEPSDES,SP1:
                    CETFSTM,SP1,STRTDESC,SP1,CETFETM,SP1,ENDTDESC
          ADD       ONE,CLNO
          GOTO      REPE1000
.
REPE9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDE0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre Clinic/Surgeon Mapping From : ",FROMCLI
          PRINT     "                               To   : ",TOCLI
          CALL      UND132
          PRINT     "Clinic/Surgeon                                     "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                             Start Time ":
                    "           End Time          "
          CALL      UND132
          RETURN

PRTCLI00  MATCH     SP70,LASTCLI
          CALL      UND132 IF NOT EQUAL
          COMPARE   "50",CLNO
          CALL      HEDE0000 IF NOT LESS
          ADD       ONE,CLNO
.
          PACK      KEY6,CETFCLI,SP70
          IF        OPCNCLSU=0
            CALL      RDOPCLI1
          ELSE
            CALL      RDDOCT1                                          * V90200
            STRIP     DTITL                                            * V90200
            MOVE      DGNAME,ANS                                       * V90200
            PACK      OPCLDESC,DTITL,SP1,ANS,SP1,DSNAME,SP70           * V90200
          ENDIF
          MOVE      CETFCLI,LASTCLI
          MOVE      SP70,LASTSPC
.
          PRINT     CETFCLI,SP1,OPCLDESC
          PRINT      *7,CETFSPC,SP1,CESPDES;
.
PRTCLI99  RETURN
.
.------------------------------------------------------------
. Enter Clinic/Surgeon Range
.------------------------------------------------------------
RCLI0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KCLSU000
           BRANCH   EXIT,RCLI0100,RCLI0999
           MOVE     OPCLCLIN,STRCLI
           PACK     FROMCLI,OPCLCLIN,SP1,OPCLDESC
           GOTO     RCLI0140
RCLI0100   MOVE     "Start             ",FROMCLI
           MOVE     SP70,STRCLI
.
RCLI0140   MOVE     FROMCLI,VAR
           CALL     DISPITEM
.
RCLI0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KCLSU000
           BRANCH   EXIT,RCLI0200,RCLI0999
           MOVE     OPCLCLIN,ENDCLI
           PACK     TOCLI,OPCLCLIN,SP1,OPCLDESC
           MATCH    STRCLI,ENDCLI
           GOTO     RCLI0999 IF EQUAL
           GOTO     RCLI0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCLI0000
.
RCLI0200   MOVE     "Finish             ",TOCLI
           MOVE     "~~~~~~~~~~",ENDCLI
.
RCLI0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Enter Clinic or Surgeon
.------------------------------------------------------------
KCLSU000  BRANCH    OPRCLIOP,KCLSU900
          BRANCH    OPCNCLSU,KCLSU100
          MOVE      ZERO,CKEYTYP
          CALL      KOPCLA00              * Enter Clinic
          BRANCH    EXIT,KCLSU999,KCLSU999
          GOTO      KCLSU999
.
KCLSU100  BRANCH    PATDOCOP,KCLSU800
.
KCLSU200  MOVE      ZERO,CKEYTYP
          CALL      KPDOCA00              * Enter Doctors Code         * V90200
          BRANCH    EXIT,KCLSU999,KCLSU999
          MOVE      DCODE,OPCLCLIN        * User Later                 * V90200
          STRIP     DTITL                                              * V90200
          MOVE      DGNAME,ANS                                         * V90200
          PACK      OPCLDESC,DTITL,SP1,ANS,SP1,DSNAME,SP70             * V90200
          MOVE      OPCLCLIN,CETFCLI
          GOTO      KCLSU999
.
KCLSU800  BEEP
          MOVE      "Doctors Table Not Available (patdoctf) - ",DISPMSG
          CALL      MESSAGE1
          MOVE      TWO,EXIT
          GOTO      KCLSU999
.
KCLSU900  BEEP
          MOVE      "Theatre System Tables Not Available (oprcliaf) - ",DISPMSG
          CALL      MESSAGE1
          MOVE      TWO,EXIT
KCLSU999  RETURN
.
.------------------------------------------------------------
. Print Report
.------------------------------------------------------------
REPF0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "68",AUDTSECT
          READ      CONTROLF,AUDTSECT;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTCLI
          MOVE      SP70,LASTSPC
          PACK      KEY16,STRCLI,SP70
          CALL      RDCETG1
          IF        OVRCD=0
            CALL      RPCETG1
          ENDIF
REPF1000  CALL      RKCETG1
          BRANCH    OVRCD,REPF9000
          MATCH     CETGCLI,ENDCLI
          GOTO      REPF9000 IF LESS
.
          MATCH     LASTCLI,CETGCLI
          IF        !@EQUAL
            CALL      CLIPRT00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDF0000 IF NOT LESS
.
          MATCH     LASTSPC,CETGSPC
          IF        !@EQUAL
            MOVE       CETGSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETGSPC,SP1,CESPDES;
            MOVE       CETGSPC,LASTSPC
          ENDIF
.
          MOVE       CETGPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "9999,999.99",PRICST
          FEDIT      CETGQTY,PRIQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CETGQTY,F12P2
          FEDIT      F12P2,PRICST
.
          PRINT     *47,CETGPSC,SP1,CEPSDES,SP1:
                    *112,PRIQTY,PRICST
          ADD       ONE,CLNO
          GOTO      REPF1000
.
REPF9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDF0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre Clinic/Surgeon Mapping From : ",FROMCLI
          PRINT     "                               To   : ",TOCLI
          CALL      UND132
          PRINT     "Clinic/Surgeon                                     "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                        ":
                    "                Qty      Cost"
          CALL      UND132
          RETURN

CLIPRT00  MATCH     SP70,LASTCLI
          CALL      UND132 IF NOT EQUAL
          COMPARE   "50",CLNO
          CALL      HEDF0000 IF NOT LESS
          ADD       ONE,CLNO
.
          PACK      KEY6,CETGCLI,SP70
          IF        OPCNCLSU=0
            CALL      RDOPCLI1
          ELSE
            CALL      RDDOCT1                                          * V90200
            STRIP     DTITL                                            * V90200
            MOVE      DGNAME,ANS                                       * V90200
            PACK      OPCLDESC,DTITL,SP1,ANS,SP1,DSNAME,SP70           * V90200
          ENDIF
          MOVE      CETGCLI,LASTCLI
          MOVE      SP70,LASTSPC
.
          PRINT     CETGCLI,SP1,OPCLDESC
          PRINT      *7,CETGSPC,SP1,CESPDES;
.
CLIPRT99  RETURN
.
.------------------------------------------------------------
. Print Report
.------------------------------------------------------------
REPG0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "68",AUDTSECT
          READ      CONTROLF,AUDTSECT;OPCNDPR1,OPCNDPR2,OPCNDPR3,OPCNDPR4:
                                      OPCNDPR5,OPCNDOP1,OPCNDOP2,OPCNDOP3:
                                      OPCNDOP4,OPCNDPS1,OPCNDPS2,OPCNDPS3:
                                      OPCNDPS4
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTIMP
          MOVE      SP70,LASTSPC
          PACK      KEY16,STRIMP,SP70
          CALL      RDCETE1
          IF        OVRCD=0
            CALL      RPCETE1
          ENDIF
REPG1000  CALL      RKCETE1
          BRANCH    OVRCD,REPG9000
          MATCH     CETEIMP,ENDIMP
          GOTO      REPG9000 IF LESS
.
          MATCH     LASTIMP,CETEIMP
          IF        !@EQUAL
            CALL      IMPPRT00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDG0000 IF NOT LESS
.
          MATCH     LASTSPC,CETESPC
          IF        !@EQUAL
            MOVE       CETESPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CETESPC,SP1,CESPDES;
            MOVE       CETESPC,LASTSPC
          ENDIF
.
          MOVE       CETEPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "9999,999.99",PRICST
          FEDIT      CETEQTY,PRIQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CETEQTY,F12P2
          FEDIT      F12P2,PRICST
.
          PRINT     *47,CETEPSC,SP1,CEPSDES,SP1:
                    *112,PRIQTY,PRICST
          ADD       ONE,CLNO
          GOTO      REPG1000
.
REPG9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDG0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Theatre Implant Code   Mapping From : ",FROMIMP
          PRINT     "                               To   : ",TOIMP
          CALL      UND132
          PRINT     "Implant Code                                       "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                        ":
                    "                Qty      Cost"
          CALL      UND132
          RETURN

IMPPRT00  MATCH     SP70,LASTIMP
          CALL      UND132 IF NOT EQUAL
          COMPARE   "50",CLNO
          CALL      HEDG0000 IF NOT LESS
          ADD       ONE,CLNO
.
          PACK      KEY6,CETEIMP,SP70
          CALL      RDOPEXP1
          MOVE      CETEIMP,LASTIMP
          MOVE      SP70,LASTSPC
.
          PRINT     CETEIMP,SP1,OPEXDESC
          PRINT      *7,CETESPC,SP1,CESPDES;
.
IMPPRT99  RETURN
.
.------------------------------------------------------------
. Enter Implant Code   Range
.------------------------------------------------------------
RIMP0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KOPEXA00
           BRANCH   EXIT,RIMP0100,RIMP0999
           MOVE     OPEXCODE,STRIMP
           PACK     FROMIMP,OPEXCODE,SP1,OPEXDESC
           GOTO     RIMP0140
RIMP0100   MOVE     "Start             ",FROMIMP
           MOVE     SP70,STRIMP
.
RIMP0140   MOVE     FROMIMP,VAR
           CALL     DISPITEM
.
RIMP0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KOPEXA00
           BRANCH   EXIT,RIMP0200,RIMP0999
           MOVE     OPEXCODE,ENDIMP
           PACK     TOIMP,OPEXCODE,SP1,OPEXDESC
           MATCH    STRIMP,ENDIMP
           GOTO     RIMP0999 IF EQUAL
           GOTO     RIMP0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RIMP0000
.
RIMP0200   MOVE     "Finish             ",TOIMP
           MOVE     "~~~~~~~~~~",ENDIMP
.
RIMP0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CEACLIKY    
          INC       CEACODKY    
          INC       CEADOCKY    
          INC       CEAEXPKY    
          INC       CEAITMKY    
          INC       CEAPSCIO/INC
          INC       CEASPCIO/INC
          INC       CEATAMIO/INC
          INC       CEATBMIO/INC
          INC       CEATCMIO/INC
          INC       CEATDMIO/INC
          INC       CEATEMIO/INC
          INC       CEATFMIO/INC
          INC       CEATGMIO/INC
          INC       OPRCLIIO/INC
          INC       OPREXPIO/INC
          INC       PATCODIO/INC
          INC       PATDO1IO/INC
          INC       PATITMIO/INC
.
          INC       STDGENCD
.
