.----------------------------------------------------------------------
. File Open Routines
.----------------------------------------------------------------------
.
. Open Doctors File
.----------------------
PATDOC00  TRAP     OVERCOND IF IO
          MOVE     "patdo1af",KEY8
          MATCH    SP70,CCHLPDC
          IF       @EQUAL  
            MOVE     ZERO,OVRCD
            OPEN     PATDO1A1,KEY8                                     * V90200
          ELSE
            STRIP    CCHLPDC
            PACK     KEY80,CCHLPDC,KEY8
            OPEN     PATDO1A1,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATDOCOP
          RETURN
.
. Open Patient Master File
.--------------------------
PATMA100  TRAP     OVERCOND IF IO
          MOVE     "patma1af",KEY8
          MOVE     "patmx1af",D8              * Open Extension file also V90202
          MATCH    SP70,CCHLPMA
          IF       @EQUAL  
            MOVE     ZERO,OVRCD
            OPEN     PATMA1A1,KEY8                                     * V90200
            OPEN     PATMX1A1,D8                                       * V90202
          ELSE
            STRIP    CCHLPMA
            PACK     KEY80,CCHLPMA,KEY8
            OPEN     PATMA1A1,KEY80                                    * V90200
            PACK     KEY80,CCHLPMA,D8                                  * V90202
            OPEN     PATMX1A1,KEY80                                    * V90202
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMASOP
          RETURN
.
. Open Admission File
.---------------------
PATMI100  TRAP     OVERCOND IF IO
          MOVE     "patmi1af",KEY8
          MATCH    SP70,CCHLPMI
          IF       @EQUAL  
            MOVE     ZERO,OVRCD
            OPEN     PATMI1A1,KEY8                                     * V90200
            OPEN     PATMI1A3,KEY8                                     * V90200
          ELSE
            STRIP    CCHLPMI
            PACK     KEY80,CCHLPMI,KEY8
            OPEN     PATMI1A1,KEY80                                    * V90200
            OPEN     PATMI1A3,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMISOP
          RETURN
.
. Open A & E Discharges File
.----------------------------
AAEDI100  TRAP     OVERCOND IF IO
          MOVE     "aaedi1af",KEY8
          MATCH    SP70,CCHLADI
          IF       @EQUAL  
            MOVE     ZERO,OVRCD
            OPEN     AAEDI1A1,KEY8                                     * V90200
          ELSE
            STRIP    CCHLADI
            PACK     KEY80,CCHLADI,KEY8
            OPEN     AAEDI1A1,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,AAEDISOP
          RETURN
.
. Open A & E Details File
.------------------------
AAEDE100  TRAP     OVERCOND IF IO
          MOVE     "aaede1af",KEY8
          MATCH    SP70,CCHLADE
          IF       @EQUAL  
            MOVE     ZERO,OVRCD
            OPEN     AAEDE1A1,KEY8                                     * V90200
            OPEN     AAEDE1A3,KEY8                                     * V90200
          ELSE
            STRIP    CCHLADE
            PACK     KEY80,CCHLADE,KEY8
            OPEN     AAEDE1A1,KEY80                                    * V90200
            OPEN     AAEDE1A3,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,AAEDEAOP
          RETURN
.
. Open Outpatient Details
.--------------------------
OUTBB100  PACK     CFNAME,OSTFILE,FILBB1A1
          TRAP     OVERCOND IF IO
          MOVE     CFNAME,KEY8
          MATCH    SP70,CCHLOBB
          IF       @EQUAL  
            MOVE     ZERO,OVRCD
            OPEN     OUTBB1A1,KEY8                                     * V90200
            OPEN     OUTBB1A2,KEY8                                     * V99020
          ELSE
            STRIP    CCHLOBB
            PACK     KEY80,CCHLOBB,KEY8
            OPEN     OUTBB1A1,KEY80                                    * V90200
            OPEN     OUTBB1A2,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OUTBOBOP
          RETURN
.
