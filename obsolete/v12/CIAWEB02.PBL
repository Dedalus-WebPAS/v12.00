.----------------------------------------------------------------------
. Program       : CIAWEB02
.
. Function      : Casemix Generation - Processing
.
. Modifications : 
.----------------------------------------------------------------------
. V11.03.01 05/01/2023  Bella Turco   TSK 0921957
.           Added NOMORE00 - Display "No more records" at end of list
.           Added PTCNNRTD - Displays number of rows set by parameter value
.----------------------------------------------------------------------
. V11.01.01 27/04/2021  Thanh T        TSK 0895165
.           Recompiled for OPRARDFD changes
.----------------------------------------------------------------------
. V10.05.01 06/11/2014  Don Nguyen   CAR 304059
.           Recompiled for changes to OPRSESIO - added Default Team Completed 
.           fields.
.----------------------------------------------------------------------
. V10.04.01 31.03.2014  B.G.Ackland  CAR 299363
.           Replace META Tag Redirect with Javascript in Common RDIREC00
.           Routine
.----------------------------------------------------------------------
. V10.03.01 04/10/2013  Patrick Adair  CAR 284134
.           Recompiled for new oprcliaf field
.----------------------------------------------------------------------
. V9.05.01  09/03/2006  Ebon Clements CAR 78533
.           Mods for PATCODTM - Hospital specific category codes
. V9.05.B03 20/02/2006  Ebon Clements     CAR 76341                   
.           Added referral and encounter file audit                   
. V9.05.B02 30/01/2006  Ebon Clements CAR 93186
.           Mods for REDIRECT length change. Recompiled for IBAWEBDF
. V9.05.B01 20/12/2005  Ebon Clements CAR 76341
.           Key length changes for encounter number
. V9.04.03  20/09/2005  Ebon Clements CAR 76890
.           Added link to update extract screen in CTAB000 if there are
.           no extract files or that status is 1 or 2
. V9.04.02  11/07/2004  Mike Laming   CAR 62596
.           Change IBACCC69 Option 3 to "Total Income" at CTAG0500
. V9.04.01  13/08/2003 Lina Vo                   CAR 52596          
.           Replaced oprdetcf with oprardaf and added oprsrgaf for CIAS 
. V9.03.04  31/03/2003 Ebon Clements             CAR 48697          
.           Fixed discharge date range display in extract list
. V9.03.03  15/03/2003 Ebon Clements             CAR 45489          
.           Added PowerPlay download file generation
.           Added letter merge file generation
. V9.03.02  20/02/2003 Ebon Clements             CAR 46515 45488
.           Added create excel download file option.
.           Added Outpatient, Allied Health and Emergency to extract generation
. V9.03.01  09/01/2003 Ebon Clements             CAR 45487
.           Added extract generation code              
. V9.03.00  19/12/2003 Ebon Clements             CAR 45473
.           Created Web Server.
.----------------------------------------------------------------------
          INC       IBAWEBDF    
          INC       WEBDATDF
          INC       RSHWEBDF
.
          INC       ALLCONFD/INC
          INC       ALLREFFD/INC
          INC       ALLENCFD/INC
          INC       CCSCONFD/INC
          INC       CCSAGEFD/INC
          INC       CCSDRGFD/INC
          INC       CCSEPSFD/INC
          INC       CCSEWTFD/INC
          INC       CCSHCDFD/INC
          INC       CCSHLCFD/INC
          INC       CCSIADFD/INC
          INC       CCSIMCFD/INC
          INC       CCSXHDFD/INC
.
          INC       CEAMAPFD/INC
          INC       CEABHDFD/INC
          INC       CEADEFFD/INC
          INC       CEAMBPFD/INC
          INC       CEAMCPFD/INC
          INC       CEAMDPFD/INC
          INC       CEAMEPFD/INC
          INC       CEANAMFD/INC
          INC       CEANBMFD/INC
          INC       CEANCMFD/INC
          INC       CEANDMFD/INC
          INC       CEAPSCFD/INC
          INC       CEASTRFD/INC
          INC       CEATAMFD/INC
          INC       CEATBMFD/INC
          INC       CEATCMFD/INC
          INC       CEATDMFD/INC
          INC       CEATEMFD/INC
          INC       CEATFMFD/INC
          INC       CEATGMFD/INC
          INC       CEAVAMFD/INC
          INC       CEAVBMFD/INC
.
          INC       PATMA1FD/INC
          INC       PATPGRFD/INC
          INC       PMSMTIFD/INC
          INC       OUTSITFD/INC
          INC       OPRSESFD/INC
          INC       OPRCLIFD/INC
          INC       OPRARDFD/INC
          INC       OPRSRGFD/INC
          INC       OPRDEAFD/INC
          INC       PATDSCFD/INC
          INC       PATECOFD/INC
          INC       PATECDFD/INC
          INC       PATTRNFD/INC
          INC       PATVISFD/INC
          INC       PATMMBFD/INC
          INC       PATINVFD/INC
          INC       PATDTRFD/INC
          INC       PATDO1FD/INC
          INC       EMRVISFD/INC
          INC       PATMI1FD/INC
          INC       OUTBOAFD/INC
          INC       OUTBB1FD/INC
          INC       CCSCEAFD/INC
.
          INC       PATCONFD/INC
.
          INC       CCSCEATD/INC
          INC       CCSCEXTD/INC
          INC       CCSEYATD/INC
          INC       CCSSTYFD/INC
          INC       CCSCEXFD/INC
          INC       CEAPPMFD/INC
          INC       CCSCEGFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEBFD/INC
          INC       CCSEYAFD/INC
          INC       CEASPCFD/INC
          INC       CCSPPYFD/INC
          INC       CCSPPYTD/INC
          INC       CCSTIMFD/INC
.
.----------------------------------------------------------------------
NEXTPAGE  DIM       1       * Nextpage parameter CGI parameter
UPDTTYPE  DIM       1       * Update Type
CMIXTYPE  DIM       3       * Casemix Type for search
.
PTCNUGRP  FORM      1        249      Using 3.1 grouper, 4.1 or mapping
.                                        0 = 3.1 grouper
.                                        1 = 4.1 grouper
.                                        2 = 4.1 grouper mapping to 3.1
COSTFLAG  FORM      1 
CONSOL01  FORM      1
CONSOL02  FORM      3
CONSOL03  FORM      3
CONSOL04  FORM      3
TRIMMX01  FORM      1
TRIMMX02  FORM      1
TRIMMX03  DIM       1
TRIMMX04  FORM      1
TRIMMX05  FORM      2.2
DISPDAT1  DIM       11
DISPDAT2  DIM       11
EXTRACID  DIM       4
POWERXID  DIM       8
EXPORTLV  DIM       1
EXPORTFL  DIM       40
STARTKEY  DIM       10
LINK2PRT   FORM      1         * Update parent
PATMASOP  FORM      1
PATTRNOP  FORM      1
PATMISOP  FORM      1
PATDSCOP  FORM      1
PATVISOP  FORM      1
ALLENCOP  FORM      1
ALLREFOP  FORM      1
PATMOPOP  FORM      1
PATMDIOP  FORM      1
EMRVISOP  FORM      1
UPDATPRG  DIM       8
UPDATREP  DIM       2
UPDATTEM  DIM       3
OUTSITOP  FORM      1
OUTBOBOP  FORM      1
PATMMBOP  FORM      1
PATCODOP  FORM      1
PATDOCOP  FORM      1
PATINVOP  FORM      1
PATDTROP  FORM      1
OPRDEAOP  FORM      1
OPRARDOP  FORM      1
OPRSRGOP  FORM      1
OPRSESOP  FORM      1
OPRCLIOP  FORM      1
GENPOWER  DIM       1
.
.----------------------------------------------------------------------
PRGID     INIT      "CIAWEB02"
VERSION   INIT      "V12.00.00"
PRGNAM    INIT      "Casemix Generation - Processing"
.----------------------------------------------------------------------
.
          CALL      WEBINT00       * Initialise Fifo Etc.
          CALL      INIT0000       * Open Files
.
MAIN1000  CALL      WEBRED00       * Read Fifo WEBPID and USERID
.
          COMPARE   "999",REPORTNO * End Server Process on Report Option 999
          GOTO      MAIN9999 IF EQUAL
.
          BRANCH    REPORTNO,MAIN1100,MAIN1200,MAIN1300,MAIN1400:
                             MAIN1500,MAIN1600,MAIN1700,MAIN1800
.
          PACK      WEBTITLE,PRGID,SP1,VERSION,SP1,PRGNAM,SP70
          MOVE      "Invalid Option",WEBTITLE
          CALL      WEBERR00   * Create Output File and Write HTML Page Header
          GOTO      MAIN1000
.
MAIN1100  CALL      PDAT0000        * Show Load IBA Patient Data Screen
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1200  CALL      CGEN0000        * Casemix Extract Generation         
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1300  CALL      CTSH0000        * Casemix Type/Casemix Type & Code Search                
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1400  CALL      EXTD0000        * Display a casemix extract          
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1500  CALL      RANG0000        * Extract Ranges
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1600  CALL      ANAL0000        * Extract Analysis
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1700  CALL      CONS0000        * Extract Consolidation and Trimming
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1800  CALL      PLAY0000        * PowerPlay extract generation        
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN9999  MOVE      "SERVER SHUTDOWN COMPLETE",WEBTITLE
          CALL      WEBERR00
          STOP
.------------------------------------------------------------
. Output Next Page Based on CGI Parameter nextpage
.------------------------------------------------------------
NXTPAG00  MOVE      ZERO,F1
          MOVE      NEXTPAGE,F1
          BRANCH    F1,NXTPAG10,NXTPAG20
.
          CALL      WINCLS00
          GOTO      NXTPAG99
.
NXTPAG10  CALL      RDIREC00
          GOTO      NXTPAG99
.
NXTPAG20  CALL      PREDIR00      * Redirect Parent
          GOTO      NXTPAG99
.
NXTPAG99  RETURN
.------------------------------------------------------------------------------
.  Redirect Parent URL
.------------------------------------------------------------------------------
PREDIR00  CALL      OPENHTML
          BRANCH    EXIT,PREDIR90
.
          WRITE     HTMLFILE;"<script type=#"text/javascript#"> {":
                             " parent.location.href=#"",REDIRECT,"#";":
                             "}":
                             "</script>"
          CALL      CLOSHTML
          GOTO      PREDIR99
.
PREDIR90  DISPLAY   "*** Fifo Not Found ***"
.
PREDIR99  RETURN
.------------------------------------------------------------
. Open Files and Initialize Variables
.------------------------------------------------------------
INIT0000  OPEN      CCSAGEA2,"ccsageaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          MOVE      "   64",AUDTSECT
          MOVE      " 38",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            OPEN      CCSAUDIA,"ccsaudia"
          ENDIF
          OPEN      CCSDRGA1,"ccsdrgaf"
          OPEN      CCSEPSA1,"ccsepsaf"
          OPEN      CCSEPSA2,"ccsepsaf"
          OPEN      CCSEPSA3,"ccsepsaf"
          OPEN      CCSEPSA4,"ccsepsaf"
          OPEN      CCSEPSA5,"ccsepsaf"
          OPEN      CCSEWTA1,"ccsewtaf"
          OPEN      CCSHCDA1,"ccshcdaf"
          OPEN      CCSHCDA2,"ccshcdaf"
          OPEN      CCSHLCA1,"ccshlcaf"
          OPEN      CCSIADA1,"ccsiadaf"
          OPEN      CCSIMCA1,"ccsimcaf"
          OPEN      CCSXHDA1,"ccsxhdaf"
          OPEN      CCSXHDA3,"ccsxhdaf"
.
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
.
          MOVE      "   64",AUDTSECT
          MOVE      " 40",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            OPEN      CEAAUDST,"ceaaudst"
          ENDIF
.
          OPEN      CEABHDA1,"ceabhdaf"
          OPEN      CEADEFA1,"ceadefaf"
          OPEN      CEAMAPA1,"ceamapaf"
          OPEN      CEAMBPA1,"ceambpaf"
          OPEN      CEAMCPA1,"ceamcpaf"
          OPEN      CEAMDPA1,"ceamdpaf"
          OPEN      CEAMEPA1,"ceamepaf"
          OPEN      CEANAMA1,"ceanamaf"
          OPEN      CEANBMA1,"ceanbmaf"
          OPEN      CEANBMA2,"ceanbmaf"
          OPEN      CEANCMA1,"ceancmaf"
          OPEN      CEANDMA1,"ceandmaf"
          OPEN      CEAPSCA1,"ceapscaf"
          OPEN      CEASTRA1,"ceastraf"
          OPEN      CEASTRA2,"ceastraf"
          OPEN      CEASTRA3,"ceastraf"
          OPEN      CEASTRA4,"ceastraf"
          OPEN      CEASTRA5,"ceastraf"
          OPEN      CEATAMA1,"ceatamaf"
          OPEN      CEATBMA1,"ceatbmaf"
          OPEN      CEATCMA1,"ceatcmaf"
          OPEN      CEATDMA1,"ceatdmaf"
          OPEN      CEATEMA1,"ceatemaf"
          OPEN      CEATFMA1,"ceatfmaf"
          OPEN      CEATGMA1,"ceatgmaf"
          OPEN      CEAVAMA1,"ceavamaf"
          OPEN      CEAVBMA1,"ceavbmaf"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PATPGRA1,"patpgraf"
          OPEN      PMSMTIA1,"pmsmtiaf"
          OPEN      PMSMTIA2,"pmsmtiaf"
          OPEN      PMSMTIA3,"pmsmtiaf"
.
          READ      CONTROLF,SEVENTY9;*249,PTCNUGRP
          READ      CONTROLF,SIXTY4;*183,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          READ      CONTROLF,SIXTY4;*109,CCCOIA1,CCCOIA2,CCCOIA3
          READ      CONTROLF,SIXTY4;*139,CCCOIM1,CCCOIM2,CCCOIM3
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          READ      CONTROLF,HUND25;*238,PTCNNRTD
.
          MOVE      ZERO,F2
          MOVE      PTCNNRTD,F2
          IF        F2 = 0
            MOVE      "10",PTCNNRTD
          ENDIF
.
          IF        IBCNMHOS=1
            OPEN      MLTCODA1,"mltcodaf"
            OPEN      MLTCODA2,"mltcodaf"
          ENDIF
.
          CALL      OPPMS000                * open patient data files
.
          OPEN      CCSCEAA1,"ccsceaaf"
          OPEN      CCSSTYA2,"ccsstyaf"
          OPEN      CEAPPMA1,"ceappmaf"
          OPEN      CCSSTYA1,"ccsstyaf"
          OPEN      CCSCEXA1,"ccscexaf"
          OPEN      CCSEYAA1,"ccseyaaf"
          OPEN      CCSPPYA1,"ccsppyaf"
          OPEN      CCSTIMA1,"ccstimaf"
.
          MOVE      ZERO,COSTFLAG
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEASPCA1,"ceaspcaf"
          TRAPCLR   IO
          MOVE      OVRCD,COSTFLAG
.
INIT9999  RETURN
.------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------
CLRPAR00  MOVE      ZERO,REPORTNO
          MOVE      SP70,TEMPLATE
          MOVE      SP70,NEXTPAGE
          PACK      REDIRECT,SP70,SP70,SP70,SP70
          MOVE      SP70,UPDTTYPE
          MOVE      SP70,ADMISSNO
          MOVE      SP70,URNUMBER
          MOVE      SP70,STARTKEY
          MOVE      ZERO,STARTNUM
          MOVE      ZERO,NORECORD
          MOVE      SP70,KEYWORDS
          MOVE      SP70,EXTRACID
          MOVE      SP70,POWERXID
          MOVE      SP70,EXPORTLV
          MOVE      SP70,EXPORTFL
          MOVE      SP70,CMIXTYPE
          MOVE      ZERO,CONSOL01
          MOVE      ZERO,CONSOL02
          MOVE      ZERO,CONSOL03
          MOVE      ZERO,CONSOL04
          MOVE      ZERO,TRIMMX01	
          MOVE      ZERO,TRIMMX02	
          MOVE      SP70,TRIMMX03	
          MOVE      ZERO,TRIMMX04	
          MOVE      ZERO,TRIMMX05	
          MOVE      SP70,GENPOWER
.
          CALL      CPCSCA00                     * Casemix Extract Master File
          CALL      CPCSCX00                     * Casemix Ranges
          CALL      CPCSEY00                     * Casemix Analysis
          CALL      CPCSPY00                     * PowerPlay
.
CLRPAR99  RETURN
.------------------------------------------------------------
. Set Parameters
.------------------------------------------------------------
SETPAR00  MATCH     "reportno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REPORTNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "template=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TEMPLATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "updttype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,UPDTTYPE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "urnumber=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,URNUMBER
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "admissno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,ADMISSNO
            GOTO      SETPAR99
          ENDIF
.  
          MATCH     "nextpage=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NEXTPAGE
            GOTO      SETPAR99
          ENDIF 
.
          MATCH     "redirect=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REDIRECT
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startkey=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTKEY
            PACK      STARTKEY,STARTKEY,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "norecord=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NORECORD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startnum=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTNUM
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "extracid=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,EXTRACID
            PACK      EXTRACID,EXTRACID,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "powerxid=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,POWERXID
            PACK      POWERXID,POWERXID,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "exportlv=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,EXPORTLV
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "exportfl=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,EXPORTFL
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "keywords=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,KEYWORDS
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "cmixtype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CMIXTYPE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "consol01=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CONSOL01
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "consol02=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CONSOL02
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "consol03=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CONSOL03
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "consol04=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CONSOL04
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "cscea",QRYNAME
          IF        @EQUAL
            CALL      SPCSA000                   * Casemix Extract Master File
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "cscex",QRYNAME
          IF        @EQUAL
            CALL      SPCSX000                   * Casemix Ranges File
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "cseya",QRYNAME
          IF        @EQUAL
            CALL      SPCSY000                   * Casemix Analysis File
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "csppy",QRYNAME
          IF        @EQUAL
            CALL      SPCPY000                   * PowerPlay File
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "trimmx01=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TRIMMX01
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "trimmx02=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TRIMMX02
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "trimmx03=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TRIMMX03
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "trimmx04=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TRIMMX04
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "trimmx05=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TRIMMX05 
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "genpower=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,GENPOWER 
            GOTO      SETPAR99
          ENDIF
.
SETPAR99  RETURN
.------------------------------------------------------------
. Show Load IBA Patient Data Screens
.------------------------------------------------------------
PDAT0000  MATCH     SP70,UPDTTYPE
          GOTO      PDAT7000 IF EQUAL
.
..          MATCH     "A",UPDTTYPE    * XXXXXXXXXXXXXXXX
..          GOTO      PDAT1000 IF EQUAL
.
          GOTO      PDAT9000
.
PDAT7000  CLEAR     WEBTITLE
          MOVE      "Casemix Load Patient Data",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PDAT9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      PDAT9999
.
PDAT9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PDAT9999
.
PDAT9999  RETURN
.------------------------------------------------------------
. Process Fields 
.------------------------------------------------------------
PROFLD00  BRANCH    REPORTNO,PROFLD10,PROFLD20,PROFLD30,PROFLD40:
                             PROFLD50,PROFLD60,PROFLD70,PROFLD80
.
          GOTO      PROFLD99 
.
PROFLD10  BRANCH    FLDSETNO,PROFLD11
          GOTO      PROFLD99
.
PROFLD11  CALL      PTAG0000                * Load IBA Patient Data Tags
          GOTO      PROFLD99
.
PROFLD20  BRANCH    FLDSETNO,PROFLD21,PROFLD22
          GOTO      PROFLD99
.
PROFLD21  CALL      CSCA0000                * Casemix Extract Master File
          GOTO      PROFLD99
.
PROFLD22  CALL      CTAG0000                * Casemix Extract General Tags
          GOTO      PROFLD99
.
PROFLD30  BRANCH    FLDSETNO,PROFLD31
          GOTO      PROFLD99
.
PROFLD31  CALL      CSRC0000                * Casemix Type Search           
          GOTO      PROFLD99
.
PROFLD40  BRANCH    FLDSETNO,PROFLD41
          GOTO      PROFLD99
.
PROFLD41  CALL      CSCA0000                * Casemix Extract Master File
          GOTO      PROFLD99
.
PROFLD50  BRANCH    FLDSETNO,PROFLD51,PROFLD52
          GOTO      PROFLD99
.
PROFLD51  CALL      CSCA0000                * Casemix Extract Master File
          GOTO      PROFLD99
.
PROFLD52  CALL      CSCX0000                * Casemix Ranges
          GOTO      PROFLD99
.
PROFLD60  BRANCH    FLDSETNO,PROFLD61,PROFLD62
          GOTO      PROFLD99
.
PROFLD61  CALL      CSCA0000                * Casemix Extract Master File
          GOTO      PROFLD99
.
PROFLD62  CALL      CSEY0000                * Casemix Ranges
          GOTO      PROFLD99
.
PROFLD70  BRANCH    FLDSETNO,PROFLD71,PROFLD72
          GOTO      PROFLD99
.
PROFLD71  CALL      CSCA0000                * Casemix Extract Master File
          GOTO      PROFLD99
.
PROFLD72  CALL      CTAG0000                * Casemix Extract General Tags
          GOTO      PROFLD99
.
PROFLD80  BRANCH    FLDSETNO,PROFLD81,PROFLD82,PROFLD83
          GOTO      PROFLD99
.
PROFLD81  CALL      CSCA0000                * Casemix Extract Master File
          GOTO      PROFLD99
.
PROFLD82  CALL      CSPY0000                * PowerPlay General Tags
          GOTO      PROFLD99
.
PROFLD83  CALL      CTAG0000                * Casemix Extract General Tags
          GOTO      PROFLD99
.
PROFLD99  RETURN
.------------------------------------------------------------
. Load IBA Patient Data Screen Tags
.------------------------------------------------------------
PTAG0000  BRANCH    FLDITMNO,PTAG0010,PTAG0020,PTAG0030,PTAG0040,PTAG0050:
                             PTAG0060,PTAG0070,PTAG0080,PTAG0090,PTAG0100:
                             PTAG0110,PTAG0120,PTAG0130,PTAG0140,PTAG0150:
                             PTAG0160,PTAG0170,PTAG0180,PTAG0190,PTAG0200:
                             PTAG0210,PTAG0220
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      PTAG9999
.
PTAG0010  COMPARE   "0",PATMASOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0020  COMPARE   "0",PATTRNOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0030  COMPARE   "0",PATMISOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0040  COMPARE   "0",PATDSCOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0050  COMPARE   "0",PATVISOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0060  COMPARE   "0",PATMOPOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0070  COMPARE   "0",PATMDIOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0080  COMPARE   "0",EMRVISOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0090  COMPARE   "0",OUTSITOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0100  COMPARE   "0",OUTBOBOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0110  COMPARE   "0",PATMMBOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0120  COMPARE   "0",PATCODOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0130  COMPARE   "0",PATDOCOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0140  COMPARE   "0",PATINVOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0150  COMPARE   "0",PATDTROP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0160  COMPARE   "0",OPRDEAOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0170  COMPARE   "0",OPRARDOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0180  COMPARE   "0",OPRSESOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0190  COMPARE   "0",OPRCLIOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0200  COMPARE   "0",ALLREFOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0210  COMPARE   "0",ALLENCOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG0220  COMPARE   "0",OPRSRGOP
          IF        @EQUAL
            WRITE     HTMLFILE;"Yes";
          ELSE
            WRITE     HTMLFILE;"No";
          ENDIF
          GOTO      PTAG9999
.
PTAG9999  RETURN
.
.---------------------------------------------------------------------
. Open Patient Management Files
.------------------------------
. Flag Files That Could Be Opened
.--------------------------------
. PATVISOP FORM 1 0=Yes Visit File
. PATMASOP FORM 1 0=Yes Patient Master File
. PATTRNOP FORM 1 0=Yes Bed Transfer File
. PATMISOP FORM 1 0=Yes Admissions File
. PATMDIOP FORM 1 0=Yes Diagnosis
. PATMOPOP FORM 1 0=Yes Operations
. PATDSCOP FORM 1 0=Yes Discharge File
. EMRVISOP FORM 1 0=Yes Emergency File
. OUTSITOP FORM 1 0=Yes Outpatient Site File
. OUTBOBOP FORM 1 0=Yes Outpatient File B with "out" default prefix
.---------------------------------------------------------------------
OPPMS000  MOVE     ONE,PATVISOP
          MOVE     ONE,PATMASOP
          MOVE     ONE,PATTRNOP
          MOVE     ONE,ALLREFOP
          MOVE     ONE,ALLENCOP
          MOVE     ONE,PATMISOP
          MOVE     ONE,PATMDIOP
          MOVE     ONE,PATMOPOP
          MOVE     ONE,PATDSCOP
          MOVE     ONE,EMRVISOP
          MOVE     ONE,OUTSITOP
          MOVE     ONE,OUTBOBOP
          MOVE     ONE,PATDOCOP
          MOVE     ONE,PATMMBOP
          MOVE     ONE,PATINVOP
          MOVE     ONE,PATDTROP
          MOVE     ONE,PATCODOP
          MOVE     ONE,OPRSESOP
          MOVE     ONE,OPRDEAOP
          MOVE     ONE,OPRARDOP
          MOVE     ONE,OPRSRGOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPDT
          IF       @EQUAL
            OPEN     PATDTRA1,"patdtraf"                               * V90200
          ELSE
            MOVE     "patdtraf",KEY8
            STRIP    CCHLPDT
            PACK     KEY80,CCHLPDT,KEY8
            OPEN     PATDTRA1,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATDTROP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPIN
          IF       @EQUAL
            OPEN     PATINVR3,"patinvrf"                               * V90200
          ELSE
            MOVE     "patinvrf",KEY8
            STRIP    CCHLPIN
            PACK     KEY80,CCHLPIN,KEY8
            OPEN     PATINVR3,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATINVOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPCD
          IF       @EQUAL
            OPEN     PATCODE1,"patcodes"                               * V90200
          ELSE
            MOVE     "patcodes",KEY8
            STRIP    CCHLPCD
            PACK     KEY80,CCHLPCD,KEY8
            OPEN     PATCODE1,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATCODOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPMB
          IF       @EQUAL
            OPEN     PATMMBS1,"patmmbsf"
          ELSE
            MOVE     "patmmbsf",KEY8
            STRIP    CCHLPMB
            PACK     KEY80,CCHLPMB,KEY8
            OPEN     PATMMBS1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMMBOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPVI
          IF       @EQUAL
            OPEN     PATVISA1,"patvisaf"
          ELSE
            MOVE     "patvisaf",KEY8
            STRIP    CCHLPVI
            PACK     KEY80,CCHLPVI,KEY8
            OPEN     PATVISA1,KEY80
          ENDIF
          TRAPCLR  IO
          TRAPCLR  IO
          MOVE     OVRCD,PATVISOP
.
          CALL     PATDOC00
          CALL     PATMA100
          CALL     PATMI100
          CALL     EMRVI100
.
          MOVE     "out",OSTFILE
          CALL     OUTBB100
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPTR
          IF       @EQUAL
            OPEN     PATTRAN2,"pattranf"                               * V90200
          ELSE
            MOVE     "pattranf",KEY8
            STRIP    CCHLPTR
            PACK     KEY80,CCHLPTR,KEY8
            OPEN     PATTRAN2,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATTRNOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPMD
          IF       @EQUAL
            OPEN     PATECDA2,"patecdaf"
          ELSE
            MOVE     "patecdaf",KEY8
            STRIP    CCHLPMD
            PACK     KEY80,CCHLPMD,KEY8
            OPEN     PATECDA2,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMDIOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPMO
          IF       @EQUAL
            OPEN     PATECOA2,"patecoaf"
          ELSE
            MOVE     "patecoaf",KEY8
            STRIP    CCHLPMO
            PACK     KEY80,CCHLPMO,KEY8
            OPEN     PATECOA2,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMOPOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPDS
          IF       @EQUAL
            OPEN     PATDSCH1,"patdschf"                               * V90200
          ELSE
            MOVE     "patdschf",KEY8
            STRIP    CCHLPDS
            PACK     KEY80,CCHLPDS,KEY8
            OPEN     PATDSCH1,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
.
          MOVE     OVRCD,PATDSCOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLOSI
          IF       @EQUAL
            OPEN     OUTSITA1,"outsitaf"
          ELSE
            MOVE     "outsitaf",KEY8
            STRIP    CCHLOSI
            PACK     KEY80,CCHLOSI,KEY8
            OPEN     OUTSITA1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OUTSITOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLOPR
          IF       @EQUAL
            OPEN     OPRDETA2,"oprdetaf"
          ELSE
            MOVE     "oprdetaf",KEY8
            STRIP    CCHLOPR
            PACK     KEY80,CCHLOPR,KEY8
            OPEN     OPRDETA2,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OPRDEAOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLOPR
          IF       @EQUAL
            OPEN     OPRARDA1,"oprardaf"
          ELSE
            MOVE     "oprardaf",KEY8
            STRIP    CCHLOPR
            PACK     KEY80,CCHLOPR,KEY8
            OPEN     OPRARDA1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OPRARDOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLOPR
          IF       @EQUAL
            OPEN     OPRSRGA1,"oprsrgaf"
          ELSE
            MOVE     "oprsrgaf",KEY8
            STRIP    CCHLOPR
            PACK     KEY80,CCHLOPR,KEY8
            OPEN     OPRSRGA1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OPRSRGOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLOPR
          IF       @EQUAL
            OPEN     OPRSESA1,"oprsesaf"
          ELSE
            MOVE     "oprsesaf",KEY8
            STRIP    CCHLOPR
            PACK     KEY80,CCHLOPR,KEY8
            OPEN     OPRSESA1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OPRSESOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLOPR
          IF       @EQUAL
            OPEN     OPRCLIA1,"oprcliaf"
          ELSE
            MOVE     "oprcliaf",KEY8
            STRIP    CCHLOPR
            PACK     KEY80,CCHLOPR,KEY8
            OPEN     OPRCLIA1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OPRCLIOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLARF
          IF       @EQUAL
            OPEN     ALLREFA1,"allrefaf"
          ELSE
            MOVE     "allrefaf",KEY8
            STRIP    CCHLARF
            PACK     KEY80,CCHLARF,KEY8
            OPEN     ALLREFA1,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,ALLREFOP
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLENC
          IF       @EQUAL
            OPEN     ALLENCA4,"allencaf"
          ELSE
            MOVE     "allencaf",KEY8
            STRIP    CCHLENC
            PACK     KEY80,CCHLENC,KEY8
            OPEN     ALLENCA4,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,ALLENCOP
.
.
OPPMS999  RETURN
.
.-----------------------------------------
.
. Open Doctors File
.----------------------
PATDOC00  TRAP     OVERCOND IF IO
          MOVE     "patdo1af",KEY8
          MATCH    SP70,CCHLPDC
          IF       @EQUAL
            MOVE     ZERO,OVRCD
            OPEN     PATDO1A1,KEY8        

          ELSE
            STRIP    CCHLPDC
            PACK     KEY80,CCHLPDC,KEY8
            OPEN     PATDO1A1,KEY80       

          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATDOCOP
          RETURN
.
.-----------------------------------------
.
. Open Patient Master File
.--------------------------
PATMA100  TRAP     OVERCOND IF IO
          MOVE     "patma1af",KEY8
          MOVE     "patmx1af",D8              * Open Extension file a

          MATCH    SP70,CCHLPMA
          IF       @EQUAL
            MOVE     ZERO,OVRCD
            OPEN     PATMA1A1,KEY8                                   
            OPEN     PATMX1A1,D8                                     
          ELSE
            STRIP    CCHLPMA
            PACK     KEY80,CCHLPMA,KEY8
            OPEN     PATMA1A1,KEY80                                  
            PACK     KEY80,CCHLPMA,D8                                
            OPEN     PATMX1A1,KEY80                                  
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMASOP
          RETURN
.
.-----------------------------------------
.
. Open Admission File
.---------------------
PATMI100  TRAP     OVERCOND IF IO
          MOVE     "patmi1af",KEY8
          MATCH    SP70,CCHLPMI
          IF       @EQUAL
            MOVE     ZERO,OVRCD
            OPEN     PATMI1A1,KEY8                    
            OPEN     PATMI1A3,KEY8                    
          ELSE
            STRIP    CCHLPMI
            PACK     KEY80,CCHLPMI,KEY8
            OPEN     PATMI1A1,KEY80                   
            OPEN     PATMI1A3,KEY80                   
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,PATMISOP
          RETURN
.
.----------------------------
. Open Emrvisaf File
.----------------------------
EMRVI100  TRAP     OVERCOND IF IO
          MOVE     "emrvisaf",KEY8
          MATCH    SP70,CCHLADE
          IF       @EQUAL
            MOVE     ZERO,OVRCD
            OPEN     EMRVISA1,KEY8            
          ELSE
            STRIP    CCHLADE
            PACK     KEY80,CCHLADE,KEY8
            OPEN     EMRVISA1,KEY80           
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,EMRVISOP
          RETURN
.
.----------------------------
. Open Outpatient Details
.--------------------------
OUTBB100  PACK     CFNAME,OSTFILE,FILBB1A1
          TRAP     OVERCOND IF IO
          MOVE     CFNAME,KEY8
          MATCH    SP70,CCHLOBB
          IF       @EQUAL
            MOVE     ZERO,OVRCD
            OPEN     OUTBB1A1,KEY8
            OPEN     OUTBB1A2,KEY8
          ELSE
            STRIP    CCHLOBB
            PACK     KEY80,CCHLOBB,KEY8
            OPEN     OUTBB1A1,KEY80
            OPEN     OUTBB1A2,KEY80
          ENDIF
          TRAPCLR  IO
          MOVE     OVRCD,OUTBOBOP
          RETURN
.
.------------------------------------------------------------
. Casemix Extract Generation
.------------------------------------------------------------
CGEN0000  MATCH     SP70,UPDTTYPE
          GOTO      CGEN7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE                 * Add Casemix Extract
          GOTO      CGEN1000 IF EQUAL
.
          MATCH     "U",UPDTTYPE                 * Update Casemix Extract
          GOTO      CGEN2000 IF EQUAL
.
          MATCH     "D",UPDTTYPE                 * Delete Casemix Extract
          GOTO      CGEN3000 IF EQUAL
.
          GOTO      CGEN9000
.
CGEN1000  CALL      EXTA0000                     * Add Casemix Extract
          GOTO      CGEN9999
.
CGEN2000  CALL      EXTU0000                     * Update Casemix Extract
          GOTO      CGEN9999
.
CGEN3000  CALL      DELT0000                     * Delete Casemix Extract
          GOTO      CGEN9999
.
CGEN7000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEA1
          IF       OVRCD=1
            CALL     CLCCEA00                    * Clear CCSCEAFD variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Extract Generation",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,CGEN9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      CGEN9999
.
CGEN9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CGEN9999
.
CGEN9999  RETURN
+
.------------------------------------------------------------
. Casemix Extract General Tags
.------------------------------------------------------------
CTAG0000  BRANCH    FLDITMNO,CTAG0100,CTAG0200,CTAG0300,CTAG0400:
                             CTAG0500,CTAG0600,CTAG0700,CTAG0800:
                             CTAG0900,CTAG1000
          GOTO      CTAG9999
.
CTAG0100  MOVE      ZERO,LINK2PRT
          CALL      CTAB0000                     * Casemix Extract Table
          GOTO      CTAG9999
.
CTAG0200  MOVE      ONE,LINK2PRT
          CALL      CTAB0000                     * Casemix Extract Table
          GOTO      CTAG9999
.
CTAG0300  CALL      NEXTX000                     * Next Extract List Page
          GOTO      CTAG9999
.
CTAG0400  CALL      PREVX000                     * Prev Extract List Page
          GOTO      CTAG9999
.
CTAG0500  WRITE     HTMLFILE;"<option value=#"1#">No. of Episodes</option>"
          WRITE     HTMLFILE;"<option value=#"2#">Total Bed Days</option>"
          WRITE     HTMLFILE;"<option value=#"3#">Total Income</option>"
.
          COMPARE   ZERO,COSTFLAG
          GOTO      CTAG9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;"<option value=#"4#">Total Cost</option>"
.
          GOTO      CTAG9999
.
CTAG0600  MATCH     SP70,CCEALV1
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"1#">Level 1</option>"
          ENDIF
.
          MATCH     SP70,CCEALV2
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"2#">Level 2</option>"
          ENDIF
.
          MATCH     SP70,CCEALV3
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"3#">Level 3</option>"
          ENDIF
.
          GOTO      CTAG9999
.
CTAG0700  WRITE     HTMLFILE;"<option value=#"1#">Length of Stay</option>"
          WRITE     HTMLFILE;"<option value=#"2#">Income</option>"
.
          COMPARE   ZERO,COSTFLAG
          GOTO      CTAG9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;"<option value=#"3#">Cost</option>"
.
          GOTO      CTAG9999
.
CTAG0800  MATCH     SP70,CCEALV1
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"1#">Level 1</option>"
          ENDIF
.
          MATCH     SP70,CCEALV2
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"2#">Level 2</option>"
          ENDIF
.
          MATCH     SP70,CCEALV3
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"3#">Level 3</option>"
          ENDIF
.
          WRITE     HTMLFILE;"<option value=#"4#">Patient Episode</option>"
.
          GOTO      CTAG9999
.
CTAG0900  MOVE      ZERO,LINK2PRT
          CALL      PTAB0000                     * Casemix PowerPlay List
          GOTO      CTAG9999
.
CTAG1000  MOVE      ONE,LINK2PRT
          CALL      PTAB0000                     * Casemix PowerPlay List
          GOTO      CTAG9999
.
CTAG9999  RETURN
.
.-----------------------------------------------------------
. Link to Next Group
.-----------------------------------------------------------
NEXTX000  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          REP       " +",STARTKEY
          REP       "'~",STARTKEY
          REP       " +",KEYWORDS
          REP       "'~",KEYWORDS
          REP       " +",CMIXTYPE
.
          WRITE     HTMLFILE;"ciaweb02.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&keywords=",KEYWORDS:
                                 "&startkey=",STARTKEY:
                                 "&cmixtype=",CMIXTYPE;
.
          REP       "+ ",STARTKEY
          REP       "~'",STARTKEY
          REP       "+ ",KEYWORDS
          REP       "~'",KEYWORDS
          REP       "+ ",CMIXTYPE
.
NEXTX999  RETURN
.-------------------------------------------------------------
. Link to Prev Group
.-------------------------------------------------------------
PREVX000  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          REP       " +",STARTKEY
          REP       "'~",STARTKEY
          REP       " +",KEYWORDS
          REP       "'~",KEYWORDS
          REP       " +",CMIXTYPE
.
          WRITE     HTMLFILE;"ciaweb02.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY:
                                 "&keywords=",KEYWORDS:
                                 "&cmixtype=",CMIXTYPE;
.
          REP       "+ ",STARTKEY
          REP       "~'",STARTKEY
          REP       "+ ",KEYWORDS
          REP       "~'",KEYWORDS
          REP       "+ ",CMIXTYPE
.
PREVX999  RETURN
.
+
.------------------------------------------------------------
. Table of Casemix Type by code
.------------------------------------------------------------
CTAB0000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          UNPACK    DIM127,D1,UPDATPRG,DIM127
          UNPACK    DIM127,D1,UPDATREP,DIM127
          UNPACK    DIM127,D1,UPDATTEM,DIM127
.
          CALL      CXHD0000              * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY4,STARTKEY,SP70
          CALL      RSCCEA1
          IF        OVRCD=0
            CALL      RPCCEA1
          ENDIF
CTAB1000  CALL      RKCCEA1
          BRANCH    OVRCD,CTAB9000
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CTAB1000
          ENDIF
.
          CALL      CROW0000      * Display Casemix Extract Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CTAB1000 IF NOT EQUAL
          GOTO      CTAB9999
.
CTAB9000  CALL      NOMORE00      * Display No More Records Message
.
CTAB9999  RETURN
.------------------------------------------------------------
. Casemix Extract Table Heading
.------------------------------------------------------------
CXHD0000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=20%>ID":
                             "</td>":
                             "<td class=HeadingCell width=40%>Description":
                             "</td>":
                             "<td class=HeadingCell width=10% align=center>":
                             "Level 1":
                             "</td>":
                             "<td class=HeadingCell width=15% align=center>":
                             "Discharge Date From ":
                             "</td>":
                             "<td class=HeadingCell width=15% align=center>":
                             "Discharge Date To":
                             "</td></tr>"
.
CXHD9999  RETURN
.
.------------------------------------------------------------
. Category Extract Table Row
.------------------------------------------------------------
CROW0000  MOVE      SP70,DISPDAT1
          MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE    "Start",DISPDAT1
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP:
                                 OCT,NOV,DEC
            PACK      DISPDAT1,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          MOVE      SP70,DISPDAT2
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish",DISPDAT2
          ELSE
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP:
                                 OCT,NOV,DEC
            PACK      DISPDAT2,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
. 
          CALL      CCSCOPOP                     * Open Casemix Files
          COMPARE   ONE,EXIT
          IF        @EQUAL
            MOVE      ONE,CCEASTAT               * No Extract files generated
          ENDIF
.
          CALL      CCSCOPCL                     * Close Casemix Files
.
          BRANCH    LINK2PRT,CROW1000
.
          MATCH     "0",CCEASTAT
          IF        @EQUAL
            WRITE     HTMLFILE;"<tr><td nowrap>":
                               "<A HREF='javascript:ShowDetail02":
                               "(#"",LINKPRG,"#.pbl":
                               "?reportno=",LINKREP:
                               "&template=",LINKTEM:
                               "&extracid=",CCEAEID,"#")'>";
          ELSE
            WRITE     HTMLFILE;"<tr><td nowrap>":
                               "<A HREF='javascript:ShowDetailWarn02":
                               "(#"",UPDATPRG,"#.pbl":
                               "?reportno=",UPDATREP:
                               "&template=",UPDATTEM:
                               "&extracid=",CCEAEID,"#",#"":
                               CCEASTAT,"#");'>";
          ENDIF
.
          WRITE     HTMLFILE;"<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             CCEAEID,"</td>":
                             "<td>&nbsp;",CCEADES,"</td>":
                             "<td align=center>&nbsp;",CCEALV1,"</td>":
                             "<td align=center>&nbsp;",DISPDAT1,"</td>":
                             "<td align=center>&nbsp;",DISPDAT2,"</td>":
                             "</tr>"
.
          GOTO      CROW9999
.
CROW1000  WRITE     HTMLFILE;"<tr valign=top>":
                             "<td><a href=#"#" ":
                             "OnClick=#"UpdateParent02('",CCEAEID,"')#">":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             CCEAEID,"</td>":
                             "<td>",CCEADES,"</td>":
                             "<td align=center>",CCEALV1,"</td>":
                             "<td align=center>&nbsp;",DISPDAT1,"</td>":
                             "<td align=center>&nbsp;",DISPDAT2,"</td>":
                             "</tr>"
.
CROW9999  RETURN
.
.
.------------------------------------------------------------
. Casemix Type Search
.------------------------------------------------------------
CTSH0000  MATCH     SP70,UPDTTYPE
          GOTO      CTSH7000 IF EQUAL
.
..          MATCH     "A",UPDTTYPE    * XXXXXXXXXXXXXXXX
..          GOTO      CTSH1000 IF EQUAL
.
          GOTO      CTSH9000
.
CTSH7000  CLEAR     WEBTITLE
          MOVE      "Casemix Type Search",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,CTSH9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      CTSH9999
.
CTSH9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CTSH9999
.
CTSH9999  RETURN
.
+
.------------------------------------------------------------
. Casemix Type Search Tags
.------------------------------------------------------------
CSRC0000  BRANCH    FLDITMNO,CSRC0100,CSRC0200,CSRC0300,CSRC0400:
                             CSRC0500,CSRC0600,CSRC0700,CSRC0800:
                             CSRC0900
          GOTO      CSRC9999
.
CSRC0100  MOVE      ZERO,LINK2PRT
          CALL      SPCTYS00                     * Casemix Type Search
          GOTO      CSRC9999
.
CSRC0200  MOVE      ONE,LINK2PRT
          CALL      SPCTYS00                     * Casemix Type Search
          GOTO      CSRC9999
.
CSRC0300  MOVE      ONE,LINK2PRT
          CALL      SPCTYS00                     * Casemix Type Search
          GOTO      CSRC9999
.
CSRC0400  CALL      PREVX000                     * Prev Page
          GOTO      CSRC9999
.
CSRC0500  CALL      NEXTX000                     * Next Page
          GOTO      CSRC9999
.
CSRC0600  MOVE      ZERO,LINK2PRT
          CALL      SPCCCS00                     * Casemix Type/Code Search
          GOTO      CSRC9999
.
CSRC0700  MOVE      ONE,LINK2PRT
          CALL      SPCCCS00                     * Casemix Type/Code Search
          GOTO      CSRC9999
.
CSRC0800  MOVE      ONE,LINK2PRT
          CALL      SPCCCS00                     * Casemix Type/Code Search
          GOTO      CSRC9999
.
CSRC0900  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CSRC0910
.
          PACK      KEY3,CMIXTYPE,SP70
          CALL      RDCCST1
          BRANCH    OVRCD,CSRC9999
.
          WRITE     HTMLFILE;CCSTDES;            * Casemix Type for search
          GOTO      CSRC9999

CSRC0910  WRITE     HTMLFILE;CMIXTYPE;           * Casemix Type for search
          GOTO      CSRC9999
.
CSRC9999  RETURN
.
.------------------------------------------------------------
. Display Clinic Type Search Results
.------------------------------------------------------------
SPCTYS00  WRITE     HTMLFILE;"<tr align=center>":
                             "<td class=HeadingCell colspan=4><b>":
                             "You Searched for ":
                               KEYWORDS,"</td>":
                             "</tr>":
                             "<tr>";
            WRITE     HTMLFILE;"<td class=HeadingCell><b>Casemix Type</b></td>":
                             "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          IF        LINK2PRT<>1
            UNPACK    DIM127,D1,LINKPRG,DIM127
            UNPACK    DIM127,D1,LINKREP,DIM127
            UNPACK    DIM127,D1,LINKTEM,DIM127
          ENDIF
.
          IF        NORECORD=0
            MOVE      "10",NORECORD       * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY38,KEYWORDS,SP70
          CALL      RDCCST2
          IF        OVRCD=0
            CALL      RPCCST2
          ENDIF
SPCTYS10  CALL      RKCCST2
          BRANCH    OVRCD,SPCTYS90
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPCTYS10
          ENDIF
.
          BRANCH    LINK2PRT,SPCTYS20,SPCTYS30
.
          WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=",LINKPRG,".pbl?":
                               "&reportno=",LINKREP:
                               "&template=",LINKTEM:
                               "&catyp001=",CCSTSTY,">":
                               CCSTSTY,"</a></td>":
                               "<td>&nbsp;",CCSTDES,"</td></font>":
                             "</tr>"
.
          GOTO      SPCTYS80
.
SPCTYS20  REP       "#', ",CCSTDES
          REP       "#", ",CCSTDES
          RESET     CCSTDES
.
          WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"":
                              "javascript:updateParent03('",CCSTDES:
                              "','",CCSTSTY,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              CCSTSTY,"</td>":
                              "<td>&nbsp;",CCSTDES,"</td>":
                             "</tr>"
.
          GOTO      SPCTYS80
.
SPCTYS30  WRITE     HTMLFILE;"<tr valign=top>":
                             "<td><a href='":
                             "javascript:showCtyp03(#"":
                              LINKPRG,".pbl?":
                              "&reportno=",LINKREP:
                              "&template=",LINKTEM:
                              "&catyp001=",CCSTSTY,"#");'>":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              CCSTSTY,"</td>":
                              "<td>&nbsp;",CCSTDES,"</td>":
                             "</tr>"
.
SPCTYS80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPCTYS10 IF NOT EQUAL
SPCTYS90
SPCTYS99  RETURN
.
.------------------------------------------------------------
. Display Clinic Type/Code Search Results
.------------------------------------------------------------
SPCCCS00  WRITE     HTMLFILE;"<tr align=center>":
                             "<td class=HeadingCell colspan=2><b>":
                             "You Searched for ":
                               KEYWORDS,"</td>":
                             "</tr>":
                             "<tr>";
          WRITE     HTMLFILE;"<td width=20% class=HeadingCell><b>":
                             "Casemix Code </b></td>":
                             "<td class=HeadingCell><b>":
                             "Description</b></td>":
                             "</tr>"
.
          IF        LINK2PRT<>1
            UNPACK    DIM127,D1,LINKPRG,DIM127
            UNPACK    DIM127,D1,LINKREP,DIM127
            UNPACK    DIM127,D1,LINKTEM,DIM127
          ENDIF
.
          IF        NORECORD=0
            MOVE      "10",NORECORD       * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          MATCH     SP70,CMIXTYPE         * You must have a casemix type
          GOTO      SPCCCS90 IF EQUAL
.
          MATCH     SP70,KEYWORDS         * You must have a keyword      
          GOTO      SPCCCS90 IF EQUAL
.
          PACK      KEY48,CMIXTYPE,KEYWORDS,SP70
          CALL      RSCCXH3
          IF        OVRCD=0
            CALL      RPCCXH3
          ENDIF
SPCCCS10  CALL      RKCCXH3
          BRANCH    OVRCD,SPCCCS90
.
          MATCH     CMIXTYPE,CCXHSTY
          GOTO      SPCCCS90 IF NOT EQUAL
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPCCCS10
          ENDIF
.
          BRANCH    LINK2PRT,SPCCCS20,SPCCCS30
.
          WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=",LINKPRG,".pbl?":
                               "&reportno=",LINKREP:
                               "&template=",LINKTEM:
                               "&cacod001=",CCXHKEY,">":
                               CCXHKEY,"</a></td>":
                               "<td>&nbsp;",CCXHDES,"</td></font>":
                             "</tr>"
.
          GOTO      SPCCCS80
.
SPCCCS20  REP       "#', ",CCXHDES
          REP       "#", ",CCXHDES
          RESET     CCSTDES
.
          WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"":
                              "javascript:updateParent03('",CCXHDES:
                              "','",CCXHKEY,"','",CCXHSTY,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              CCXHKEY,"</td>":
                              "<td>&nbsp;",CCXHDES,"</td>":
                             "</tr>"
.
          GOTO      SPCCCS80
.
SPCCCS30  WRITE     HTMLFILE;"<tr valign=top>":
                             "<td><a href='":
                             "javascript:showCode03(#"":
                              LINKPRG,".pbl?":
                              "&reportno=",LINKREP:
                              "&template=",LINKTEM:
                              "&cacod001=",CCXHKEY,"#");'>":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              CCXHKEY,"</td>":
                              "<td>&nbsp;",CCXHDES,"</td>":
                             "</tr>"
.
SPCCCS80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPCCCS10 IF NOT EQUAL
SPCCCS90
SPCCCS99  RETURN
.
.------------------------------------------------------------
. Add Casemix Extract Details
.------------------------------------------------------------
EXTA0000  PACK      KEY4,EXTRACID,SP70
          CALL      RDCCEA1
          COMPARE   ZERO,OVRCD
          GOTO      EXTA9000 IF EQUAL
.
          CALL      CLCCEA00                     * Clear vars
          MOVE      "1 ",CCEAHCD
          MOVE      ZERO,CCEAUST
          MOVE      "99999999",CCEAFDD
          MOVE      "99999999",CCEATAD
.
          CALL      MVCSCA00                     * Move cgi's to file vars
.
          MOVE      EXTRACID,CCEAEID
          MOVE      ONE,CCEASTAT                 * Not processed
.
          PACK      KEY4,CCEAEID,SP70
          CALL      WRCCEA1                      * Write Record
.
          CALL      RUNEXT00                     * Schedule Extract to Run
.
          MOVE      ZERO,EXIT
          GOTO      EXTA9999
.
EXTA9000  MOVE      "Extract ID exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      EXTA9999
.
EXTA9999  RETURN
.
.------------------------------------------------------------
. Update Casemix Extract Details
.------------------------------------------------------------
EXTU0000  PACK      KEY4,EXTRACID,SP70
          CALL      RDCCEA1
          BRANCH    OVRCD,EXTU9000
.
          CALL      MVCSCA00                     * Move cgi's to file vars
.
          MOVE      EXTRACID,CCEAEID
          MOVE      ONE,CCEASTAT
.
          PACK      KEY4,CCEAEID,SP70
          CALL      UPCCEA1                      * Write Record
.
          CALL      RUNEXT00                     * Schedule Extract to Run
.
          MOVE      ZERO,EXIT
          GOTO      EXTU9999
.
EXTU9000  MOVE      "Invalid Extract ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      EXTU9999
.
EXTU9999  RETURN
.
.--------------------------------------------------------------------------
.*                             RUNEXT00                                   *
.*   Schedule Casemix Extract Extract to RUN                              *
.--------------------------------------------------------------------------
RUNEXT00  MOVE      "IBACCC55",SCHDPGID
          MOVE      "CIAS - Casemix Extract Generation",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
.         Write Keyin parameters
.
          MOVE      ONE,KEYSTARR[1]         * Option
          MOVE      CCEAEID,KEYSTARR[2]     * Extract ID
          MOVE      ANSY,KEYSTARR[3]        * Yes
          MOVE      SP70,KEYSTARR[4]        * Yes
          MOVE      FOUR,KEYSTCNT
.
          CALL      SCHPRO00   * Schedule Extract
.
RUNEXT99  RETURN
.
.------------------------------------------------------------
. Casemix Extract Generation
.------------------------------------------------------------
EXTD0000  MATCH     SP70,UPDTTYPE
          GOTO      EXTD7000 IF EQUAL
.
..        MATCH     "A",UPDTTYPE                 * Add Casemix Extract
..        GOTO      EXTD1000 IF EQUAL
.
          GOTO      EXTD9000
.
EXTD7000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEA1
          IF       OVRCD=1
            CALL     CLCCEA00                    * Clear CCSCEAFD variables
          ENDIF
.
          PACK     KEY4,CCEAEID,SP70
          CALL     RDCCEX1
          IF       OVRCD=1
            CALL     CLCCEX00                    * Clear CCSCEXFD variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Extract Generation",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,EXTD9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      EXTD9999
.
EXTD9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      EXTD9999
.
EXTD9999  RETURN
.
.
.------------------------------------------------------------
. Casemix Extract Ranges                   
.------------------------------------------------------------
RANG0000  MATCH     SP70,UPDTTYPE
          GOTO      RANG7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE                 * Add Extract Ranges
          GOTO      RANG1000 IF EQUAL
.
          MATCH     "D",UPDTTYPE                 * Delete All Extract Ranges
          GOTO      RANG2000 IF EQUAL
.
          GOTO      RANG9000
.
RANG1000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEX1
          IF       OVRCD=1
            CALL     CLCCEX00                   * Clear file vars
            MOVE     EXTRACID,CCEXEID
            CALL     MVCSCX00                   * Move cgi to file vars
.
            PACK     KEY4,CCEXEID,SP70
            CALL     WRCCEX1
          ELSE
            CALL     MVCSCX00                   * Move cgi to file vars
            CALL     UPCCEX1
          ENDIF
.
          CALL      RUNEXT00                     * Schedule Extract to Run
.
          MOVE     ZERO,EXIT
          GOTO     RANG9999
.
RANG2000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEX1
          IF       OVRCD=0
            CALL     DECCEX1
          ENDIF
.
          CALL      RUNEXT00                     * Schedule Extract to Run
.
          MOVE     ZERO,EXIT
          GOTO     RANG9999
.
RANG7000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEA1
          IF       OVRCD=1
            CALL     CLCCEA00                    * Clear CCSCEAFD variables
          ENDIF
.
          PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEX1
          IF       OVRCD=1
            CALL     CLCCEX00                    * Clear CCSCEXFD variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Extract Ranges",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,RANG9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      RANG9999
.
RANG9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      RANG9999
.
RANG9100  MOVE      "Invalid Extract ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      RANG9999
.
RANG9999  RETURN
.
.------------------------------------------------------------
. Delete Casemix Extract
.------------------------------------------------------------
DELT0000  PACK     KEY4,CCEAEID
          CALL     RDCCEA1             * Read Record
          IF       OVRCD=0
            CALL     DECCEA1           * Delete Record
            CALL     CCSCOPOP          * Open Files Then Delete Files
            CLOSE    CCSCEBA1,DELETE
            CLOSE    CCSCECA1
            CLOSE    CCSCECA2,DELETE
            CLOSE    CCSCEDA1,DELETE
            CLOSE    CCSCEEA1,DELETE
            CLOSE    CCSCEFA1
            CLOSE    CCSCEFA2,DELETE
            CLOSE    CCSCEGA1
            CLOSE    CCSCEGA2,DELETE
.
            MOVE       ZERO,EXIT
            GOTO       DELT9999
          ENDIF
.
DELT9000  MOVE      "Invalid Extract ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CGEN9999
.
DELT9999  RETURN
.
.------------------------------------------------------------
. Casemix Extract Analysis
.------------------------------------------------------------
ANAL0000  MATCH     SP70,UPDTTYPE
          GOTO      ANAL7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE                 * Add Extract Analysis
          GOTO      ANAL1000 IF EQUAL
.
          MATCH     "D",UPDTTYPE                 * Delete All Analysis
          GOTO      ANAL2000 IF EQUAL
.
          GOTO      ANAL9000
.
ANAL1000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEY1
          IF       OVRCD=1
            CALL     CLCSEY00                   * Clear file vars
            MOVE     EXTRACID,CCEYEID
            CALL     MVCSEY00                   * Move cgi to file vars
.
            PACK     KEY4,CCEYEID,SP70
            CALL     WRCCEY1
          ELSE
            CALL     MVCSEY00                   * Move cgi to file vars
            CALL     UPCCEY1
          ENDIF
.
          MOVE     ZERO,EXIT
          GOTO     ANAL9999
.
ANAL2000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEY1
          IF       OVRCD=0
            CALL     DECCEY1
          ENDIF
.
          MOVE     ZERO,EXIT
          GOTO     ANAL9999
.
ANAL7000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEA1
          IF       OVRCD=1
            CALL     CLCCEA00                    * Clear CCSCEAFD variables
          ENDIF
.
          PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEY1
          IF       OVRCD=1
            CALL     CLCSEY00                    * Clear CCSEYAFD variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Extract Analysis",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ANAL9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      ANAL9999
.
ANAL9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ANAL9999
.
ANAL9100  MOVE      "Invalid Extract ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ANAL9999
.
ANAL9999  RETURN
.
.------------------------------------------------------------
. Casemix Extract Consolidation
.------------------------------------------------------------
CONS0000  MATCH     SP70,UPDTTYPE
          GOTO      CONS7000 IF EQUAL
.
          MATCH     "S",UPDTTYPE                 * Schedule Consolidation
          GOTO      CONS1000 IF EQUAL
.
          MATCH     "T",UPDTTYPE                 * Schedule Trimming 
          GOTO      CONS2000 IF EQUAL
.
          MATCH     "E",UPDTTYPE                 * Create Excel Export File
          GOTO      CONS3000 IF EQUAL
.
          MATCH     "M",UPDTTYPE                 * Create Letter Merge File
          GOTO      CONS4000 IF EQUAL
.
          GOTO      CONS9000
.
CONS1000  MOVE      "IBACCC69",SCHDPGID
          MOVE      "CIAS - Extract Consolidation",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
.         Write Keyin parameters
.
          MOVE      ONE,KEYSTARR[1]         * Option
          MOVE      EXTRACID,KEYSTARR[2]    * Extract Id
          MOVE      CONSOL01,KEYSTARR[3]    * Consolidate by
          MOVE      CONSOL02,KEYSTARR[4]    * Top no of codes level 1
          MOVE      CONSOL03,KEYSTARR[5]    * Top no of codes level 2
          MOVE      CONSOL04,KEYSTARR[6]    * Top no of codes level 3
          MOVE      ANSY,KEYSTARR[7]        * Yes
          MOVE      SP70,KEYSTARR[8] 
          MOVE      EIGHT,KEYSTCNT
.
          CALL      SCHPRO00                * Schedule Consolidation
.
          MOVE     ZERO,EXIT
          GOTO     CONS9999
.         
CONS2000  MOVE      "IBACCC65",SCHDPGID
          MOVE      "CIAS - Extract Trimming",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
.         Write Keyin parameters
.
          MOVE      ONE,KEYSTARR[1]         * Option
          MOVE      EXTRACID,KEYSTARR[2]    * Extract Id
          MOVE      TRIMMX01,KEYSTARR[3]    * Trim at extract level
          MOVE      TRIMMX02,KEYSTARR[4]    * Trim based on   
          MOVE      TRIMMX03,KEYSTARR[5]    * Trim upper, lower or both
.
          IF        TRIMMX04=1
            MOVE      ANSY,KEYSTARR[6]      * User quartile trimming yes
          ELSE
            MOVE      ANSN,KEYSTARR[6]      * User quartile trimming no
          ENDIF
.
          MOVE      TRIMMX05,KEYSTARR[7]    * Percent to trim
          MOVE      ANSY,KEYSTARR[8]        * Yes
          MOVE      SP70,KEYSTARR[9]        * Exit
          MOVE      NINE,KEYSTCNT
.
          CALL      SCHPRO00                * Schedule Consolidation
.
          MOVE     ZERO,EXIT
          GOTO     CONS9999
.
.
CONS3000  MOVE      "IBACCC51",SCHDPGID
          MOVE      "CIAS - Create Export File",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
.         Write Keyin parameters
.
          MOVE      ONE,KEYSTARR[1]         * Option
          MOVE      EXTRACID,KEYSTARR[2]    * Extract Id
          MOVE      EXPORTLV,KEYSTARR[3]    * Export level
          MOVE      EXPORTFL,KEYSTARR[4]    * Export data file name
          MOVE      ANSY,KEYSTARR[5]        * Yes
          MOVE      SP70,KEYSTARR[6]        * Exit
          MOVE      SIX,KEYSTCNT
.
          CALL      SCHPRO00                * Schedule export file creation
.
          MOVE     ZERO,EXIT
          GOTO     CONS9999
.
.
CONS4000  MOVE      "IBACCC64",SCHDPGID
          MOVE      "CIAS - Letter Merge Generation",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
.         Write Keyin parameters
.
          MOVE      ONE,KEYSTARR[1]         * Option
          MOVE      EXTRACID,KEYSTARR[2]    * Extract Id
          MOVE      EXPORTFL,KEYSTARR[3]    * Export data file name
          MOVE      ANSY,KEYSTARR[4]        * Yes
          MOVE      SP70,KEYSTARR[5]        * Exit
          MOVE      FIVE,KEYSTCNT
.
          CALL      SCHPRO00                * Schedule export file creation
.
          MOVE     ZERO,EXIT
          GOTO     CONS9999
.
CONS7000  PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEA1
          IF       OVRCD=1
            CALL     CLCCEA00                    * Clear CCSCEAFD variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Extract Consolidation",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,CONS9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      CONS9999
.
CONS9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CONS9999
.
CONS9100  MOVE      "Invalid Extract ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CONS9999
.
CONS9999  RETURN
.
.
.------------------------------------------------------------
. PowerPlay Analysis
.------------------------------------------------------------
PLAY0000  MATCH     SP70,UPDTTYPE
          GOTO      PLAY7000 IF EQUAL
.
          MATCH     "A",UPDTTYPE                 * Add PowerPlay extract
          GOTO      PLAY1000 IF EQUAL
.
          MATCH     "U",UPDTTYPE                 * Update PowerPlay extract
          GOTO      PLAY2000 IF EQUAL
.
          MATCH     "D",UPDTTYPE                 * Delete PowerPlay extract
          GOTO      PLAY3000 IF EQUAL
.
          GOTO      PLAY9000
.
PLAY1000  PACK     KEY8,POWERXID,SP70
          CALL     RDCCPP1
          COMPARE  ZERO,OVRCD
          GOTO     PLAY9200 IF EQUAL
.
          CALL     CLCSPY00                   * Clear file vars
          MOVE     POWERXID,CCPPPID
          CALL     MVCSPY00                   * Move cgi to file vars
.
          PACK     KEY8,CCPPPID,SP70
          CALL     WRCCPP1
.
          MATCH    "1",GENPOWER
          IF       @EQUAL
            CALL     RUNPOW00                 * Generate PowerPlay extract
          ENDIF
.
          MOVE     ZERO,EXIT
          GOTO     PLAY9999
.
PLAY2000  PACK     KEY8,POWERXID,SP70
          CALL     RDCCPP1
          BRANCH   OVRCD,PLAY9100,PLAY9300
.
          MOVE     POWERXID,CCPPPID
          CALL     MVCSPY00                   * Move cgi to file vars
.         
          PACK     KEY8,CCPPPID,SP70
          CALL     UPCCPP1
.         
          MATCH    "1",GENPOWER
          IF       @EQUAL
            CALL     RUNPOW00                 * Generate PowerPlay extract
          ENDIF
.
          MOVE     ZERO,EXIT
          GOTO     PLAY9999
.
PLAY3000  PACK     KEY8,POWERXID,SP70
          CALL     RDCCPP1
          IF       OVRCD=0
            CALL     DECCPP1
          ENDIF
.
          MOVE     ZERO,EXIT
          GOTO     PLAY9999
.
PLAY7000  PACK     KEY8,POWERXID,SP70
          CALL     RDCCPP1
          IF       OVRCD=1
            CALL     CLCSPY00                    * Clear CCSPPYFD variables
          ENDIF
.
          PACK     KEY4,EXTRACID,SP70
          CALL     RDCCEA1
          IF       OVRCD=1
            CALL     CLCCEA00                    * Clear CCSCEAFD variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "PowerPlay Extract Analysis",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PLAY9999
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
.
          MOVE      ONE,EXIT
          GOTO      PLAY9999
.
PLAY9000  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PLAY9999
.
PLAY9100  MOVE      "Invalid Extract ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PLAY9999
.
PLAY9200  MOVE      "PowerPlay Extract ID Exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PLAY9999
.
PLAY9300  MOVE      "PowerPlay Extract ID Locked.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PLAY9999
.
PLAY9999  RETURN
.
.------------------------------------------------------------
. Table of Casemix Type by code
.------------------------------------------------------------
PTAB0000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      PHED0000              * Output Table Heading
.
          IF        NORECORD=0
            MOVE      "13",NORECORD       * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY8,STARTKEY,SP70
          CALL      RSCCPP1
          IF        OVRCD=0
            CALL      RPCCPP1
          ENDIF
PTAB1000  CALL      RKCCPP1
          BRANCH    OVRCD,PTAB9999
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      PTAB1000
          ENDIF
.
          CALL      PROW0000      * Display PowerPlay Extract Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      PTAB1000 IF NOT EQUAL
.
PTAB9999  RETURN
.------------------------------------------------------------
. Casemix Extract Table Heading
.------------------------------------------------------------
PHED0000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=20%>PowerPlay ID":
                             "</td>":
                             "<td class=HeadingCell width=40%>Description":
                             "</td>":
                             "<td class=HeadingCell width=40% align=center>":
                             "Casemix Extract":
                             "</td>":
                             "</tr>"
.
PHED9999  RETURN
.
.------------------------------------------------------------
. Category Extract Table Row
.------------------------------------------------------------
PROW0000  BRANCH    LINK2PRT,PROW1000
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail08":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&powerxid=",CCPPPID,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             CCPPPID,"</td>":
                             "<td>&nbsp;",CCPPDES,"</td>":
                             "<td align=center>&nbsp;",CCPPEID,"</td>":
                             "</tr>"
.
          GOTO      PROW9999
.
PROW1000  WRITE     HTMLFILE;"<tr valign=top>":
                             "<td><a href=#"#" ":
                             "OnClick=#"UpdateParent08('",CCPPPID,"')#">":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             CCPPPID,"</td>":
                             "<td>",CCPPDES,"</td>":
                             "<td align=center>",CCPPEID,"</td>":
                             "</tr>"
.
PROW9999  RETURN
.
.--------------------------------------------------------------------------
.*                             RUNPOW00                                   *
.*   Schedule PowerPlay extract generatoin                                *
.--------------------------------------------------------------------------
RUNPOW00  MOVE      "IBACCC77",SCHDPGID
          MOVE      "CIAS - PowerPlay Analysis Generation",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
.         Write Keyin parameters
.
          MOVE      ONE,KEYSTARR[1]         * Option
          MOVE      POWERXID,KEYSTARR[2]    * Extract ID
          MOVE      ANSY,KEYSTARR[3]        * Yes
          MOVE      SP70,KEYSTARR[4]        * Enter
          MOVE      FOUR,KEYSTCNT
.
          CALL      SCHPRO00   * Schedule Extract
.
RUNPOW99  RETURN
.
.------------------------------------------------------------
. NOMORE00 - Display "No more records" at end of list
.------------------------------------------------------------
NOMORE00  WRITE     HTMLFILE;"<tr>":
                             "<td class=RedCell colspan=20 align=center>":
                             "No more records</td>"
.
NOMORE99  RETURN
+
.------------------------------------------------------------
.
          INC       IBAWEBCD
          INC       WEBDATCD
          INC       DAYOFWEK
          INC       CCSCEATM
          INC       CCSCEXTM
          INC       CCSEYATM
          INC       RSHWEBCD
          INC       CCSPPYTM
.
          INC       CCSAGEIO/INC
          INC       CCSDRGIO/INC
          INC       CCSEPSIO/INC
          INC       CCSEWTIO/INC
          INC       CCSHCDIO/INC
          INC       CCSHLCIO/INC
          INC       CCSIADIO/INC
          INC       CCSIMCIO/INC
          INC       CCSXHDIO/INC
.
          INC       CEAMAPIO/INC
          INC       CEABHDIO/INC
          INC       CEADEFIO/INC
          INC       CEAMBPIO/INC
          INC       CEAMCPIO/INC
          INC       CEAMDPIO/INC
          INC       CEAMEPIO/INC
          INC       CEANAMIO/INC
          INC       CEANBMIO/INC
          INC       CEANCMIO/INC
          INC       CEANDMIO/INC
          INC       CEAPSCIO/INC
          INC       CEASTRIO/INC
          INC       CEATAMIO/INC
          INC       CEATBMIO/INC
          INC       CEATCMIO/INC
          INC       CEATDMIO/INC
          INC       CEATEMIO/INC
          INC       CEATFMIO/INC
          INC       CEATGMIO/INC
          INC       CEAVAMIO/INC
          INC       CEAVBMIO/INC
.
          INC       PATMA1IO/INC
          INC       PATPGRIO/INC
          INC       PMSMTIIO/INC
          INC       OUTSITIO/INC
          INC       OPRCLIIO/INC
          INC       OPRSESIO/INC
          INC       OPRARDIO/INC
          INC       OPRSRGIO/INC
          INC       OPRDEAIO/INC
          INC       PATDSCIO/INC
          INC       PATECDIO/INC
          INC       PATECOIO/INC
          INC       PATTRNIO/INC
          INC       PATVISIO/INC
          INC       PATMMBIO/INC
          INC       PATINVIO/INC
          INC       PATDTRIO/INC
          INC       PATDO1IO/INC
          INC       EMRVISIO/INC
          INC       PATMI1IO/INC
          INC       OUTBOAIO/INC
          INC       OUTBB1IO/INC
          INC       CCSCEAIO/INC
          INC       CCSSTYIO/INC
          INC       CEAPPMIO/INC
          INC       CCSCEXIO/INC
          INC       CCSCEGIO/INC
          INC       CCSCEFIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCECIO/INC
          INC       CCSEYAIO/INC
          INC       CEASPCIO/INC
          INC       ALLREFIO/INC
          INC       ALLENCIO/INC
          INC       CCSPPYIO/INC
          INC       CCSTIMIO/INC
          INC       CCSCOPCD
