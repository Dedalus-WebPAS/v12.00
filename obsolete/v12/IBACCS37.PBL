.------------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.------------------------------------------------------------------------------
. V5.04.01  01.11.1993 B.G.Ackland
.           Change "Procedure" to Patient Service
.------------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCS37
.   Function      :   Departmental Enquiries                  
.   Generated  On :   08/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCS37TDF.PBL
          INC       CCSAWGFD/INC
          INC       CCSBULFD/INC
          INC       CCSCALFD/INC
          INC       CCSCMAFD/INC
          INC       CCSCMBFD/INC
          INC       CCSCMCFD/INC
          INC       CCSCMDFD/INC
          INC       CCSCMEFD/INC
          INC       CCSCMFFD/INC
          INC       CCSCONFD/INC
          INC       CCSCTYFD/INC
          INC       CCSDCOFD/INC
          INC       CCSDNOFD/INC
          INC       CCSDPTFD/INC
          INC       CCSHCDFD/INC
          INC       CCSPDPFD/INC
          INC       CCSPSDFD/INC
          INC       CCSPVRFD/INC
          INC       CCSSDCFD/INC
          INC       GPHSTDDF    
.=========================
.Local Variable Definition
.-------------------------
.
.Word Processor File * Scr 00 Fld     5
.
NAMCCDN1  INIT      "Wccdn1"
FILCCDN1  DIM       8
.
.
.Word Processor File * Scr 00 Fld     9
.
NAMCCBU1  INIT      "Wccbu1"
FILCCBU1  DIM       8
.
STARTFLG  FORM      1 * Scr 00 Fld    18
.
.    Multi Item Key Fields Scr C1 Fld    10
.-------------------------------------------------------
CCCA1NAM  INIT      "CCCA1"
CCCA1END  FORM      1   * End Display
CCCA1SNO  FORM      5   * Number of Items on the Screen
CCCA1MKY  DIM       127 * Match Key 
CCCA1EKY  DIM       127 * End Key
CCCA1SKY  DIM       127 * Start Key
CCCA1IDX  INIT      " 132 UC1-5"
CCCA1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCCA1FNM  DIM       8  * Filename
CCCA1CNT  FORM      3  * Number of Items on Screen
CCTOTCST  FORM     12.2 * Scr C1 Fld    20
CCTOTBUD  FORM     12.2 * Scr C1 Fld    21
CCVDCB    FORM     12.2 * Scr C1 Fld    22
CCVICB    FORM     12.2 * Scr C1 Fld    23
CCVTCB    FORM     12.2 * Scr C1 Fld    24
CCVTCF    FORM     12.2 * Scr C1 Fld    25
CCVTCS    FORM     12.2 * Scr C1 Fld    26
CCVTCC    FORM     12.2 * Scr C1 Fld    27
CCVTBF    FORM     12.2 * Scr C1 Fld    28
CCVTBS    FORM     12.2 * Scr C1 Fld    29
CCVTBC    FORM     12.2 * Scr C1 Fld    30
CCVTFS    FORM     12.2 * Scr C1 Fld    31
CCVTFC    FORM     12.2 * Scr C1 Fld    32
CCVTSC    FORM     12.2 * Scr C1 Fld    33
CCPVDCB   FORM      6.4 * Scr C1 Fld    34
CCPVICB   FORM      6.4 * Scr C1 Fld    35
CCPVTCB   FORM      6.4 * Scr C1 Fld    36
CCPVTCF   FORM      6.4 * Scr C1 Fld    37
CCPVTCS   FORM      6.4 * Scr C1 Fld    38
CCPVTCC   FORM      6.4 * Scr C1 Fld    39
CCPVTBF   FORM      6.4 * Scr C1 Fld    40
CCPVTBS   FORM      6.4 * Scr C1 Fld    41
CCPVTBC   FORM      6.4 * Scr C1 Fld    42
CCPVTFS   FORM      6.4 * Scr C1 Fld    43
CCPVTFC   FORM      6.4 * Scr C1 Fld    44
CCPVTSC   FORM      6.4 * Scr C1 Fld    45
YTDDIR    FORM     12.2 * Scr C1 Fld    66
YTDIND    FORM     12.2 * Scr C1 Fld    67
YTDDBU    FORM     12.2 * Scr C1 Fld    68
YTDIBU    FORM     12.2 * Scr C1 Fld    69
YTDFBU    FORM     12.2 * Scr C1 Fld    70
YTDSTD    FORM     12.2 * Scr C1 Fld    71
YTDCHG    FORM     12.2 * Scr C1 Fld    72
YTDCST    FORM     12.2 * Scr C1 Fld    73
YTDBUD    FORM     12.2 * Scr C1 Fld    74
VYTDDIR   FORM     12.2 * Scr C1 Fld    75
VYTDIND   FORM     12.2 * Scr C1 Fld    76
VYTDCB    FORM     12.2 * Scr C1 Fld    77
VYTDCF    FORM     12.2 * Scr C1 Fld    78
VYTDCS    FORM     12.2 * Scr C1 Fld    79
VYTDCC    FORM     12.2 * Scr C1 Fld    80
VYTDBF    FORM     12.2 * Scr C1 Fld    81
VYTDBS    FORM     12.2 * Scr C1 Fld    82
VYTDBC    FORM     12.2 * Scr C1 Fld    83
VYTDFS    FORM     12.2 * Scr C1 Fld    84
VYTDFC    FORM     12.2 * Scr C1 Fld    85
VYTDSC    FORM     12.2 * Scr C1 Fld    86
PYTDDIR   FORM      6.4 * Scr C1 Fld    87
PYTDIND   FORM      6.4 * Scr C1 Fld    88
PYTDCB    FORM      6.4 * Scr C1 Fld    89
PYTDCF    FORM      6.4 * Scr C1 Fld    90
PYTDCS    FORM      6.4 * Scr C1 Fld    91
PYTDCC    FORM      6.4 * Scr C1 Fld    92
PYTDBF    FORM      6.4 * Scr C1 Fld    93
PYTDBS    FORM      6.4 * Scr C1 Fld    94
PYTDBC    FORM      6.4 * Scr C1 Fld    95
PYTDFS    FORM      6.4 * Scr C1 Fld    96
PYTDFC    FORM      6.4 * Scr C1 Fld    97
PYTDSC    FORM      6.4 * Scr C1 Fld    98
TOTACT    FORM     12.2 * Scr C2 Fld    12
TOTBUD    FORM     12.2 * Scr C2 Fld    13
.
.    Multi Item Key Fields Scr C2 Fld    14
.-------------------------------------------------------
CCMB1NAM  INIT      "CCMB1"
CCMB1END  FORM      1   * End Display
CCMB1SNO  FORM      5   * Number of Items on the Screen
CCMB1MKY  DIM       127 * Match Key 
CCMB1EKY  DIM       127 * End Key
CCMB1SKY  DIM       127 * Start Key
CCMB1IDX  INIT      " 132 UC1-5"
CCMB1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCMB1FNM  DIM       8  * Filename
CCMB1CNT  FORM      3  * Number of Items on Screen
ACTTOT    FORM     12.2 * Scr C2 Fld    21
BUDTOT    FORM     12.2 * Scr C2 Fld    22
VARDIR    FORM     12.2 * Scr C2 Fld    23
VARIND    FORM     12.2 * Scr C2 Fld    24
VARCB     FORM     12.2 * Scr C2 Fld    25
VARCF     FORM     12.2 * Scr C2 Fld    26
VARBF     FORM     12.2 * Scr C2 Fld    27
PVADIR    FORM      6.4 * Scr C2 Fld    28
PVAIND    FORM      6.4 * Scr C2 Fld    29
PVACB     FORM      6.4 * Scr C2 Fld    30
PVACF     FORM      6.4 * Scr C2 Fld    31
PVABF     FORM      6.4 * Scr C2 Fld    32
GPHDIR    FORM      1 * Scr CG Fld     4
GPHIND    FORM      1 * Scr CG Fld     5
GPHCST    FORM      1 * Scr CG Fld     6
GPHDBU    FORM      1 * Scr CG Fld     7
GPHIBU    FORM      1 * Scr CG Fld     8
GPHBUD    FORM      1 * Scr CG Fld     9
GPHFBU    FORM      1 * Scr CG Fld    10
GPHSTD    FORM      1 * Scr CG Fld    11
GPHCHG    FORM      1 * Scr CG Fld    12
GPQTY     FORM      1 * Scr GP Fld     5
GPBQT     FORM      1 * Scr GP Fld     6
GPACT     FORM      1 * Scr GP Fld     7
GPBUD     FORM      1 * Scr GP Fld     8
GPFBU     FORM      1 * Scr GP Fld     9
GPSTD     FORM      1 * Scr GP Fld    10
GPCHG     FORM      1 * Scr GP Fld    11
GPAA      FORM      1 * Scr GP Fld    12
GPAB      FORM      1 * Scr GP Fld    13
GPAF      FORM      1 * Scr GP Fld    14
GPAS      FORM      1 * Scr GP Fld    15
GPTCHG    FORM      1 * Scr GP Fld    16
GPBA      FORM      1 * Scr GP Fld    17
GPBB      FORM      1 * Scr GP Fld    18
GPBF      FORM      1 * Scr GP Fld    19
GPBS      FORM      1 * Scr GP Fld    20
.
.    Multi Item Key Fields Scr P1 Fld    21
.-------------------------------------------------------
CCPD4NAM  INIT      "CCPD4"
CCPD4END  FORM      1   * End Display
CCPD4SNO  FORM      5   * Number of Items on the Screen
CCPD4MKY  DIM       127 * Match Key 
CCPD4EKY  DIM       127 * End Key
CCPD4SKY  DIM       127 * Start Key
CCPD4IDX  INIT      " 132 UC1-5"
CCPD4FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCPD4FNM  DIM       8  * Filename
CCPD4CNT  FORM      3  * Number of Items on Screen
AVECHG    FORM     10.4 * Scr P1 Fld    29
AQTACT    FORM     12.2 * Scr P1 Fld    30
AQTBUD    FORM     12.2 * Scr P1 Fld    31
AQTFBU    FORM     12.2 * Scr P1 Fld    32
AQTSTD    FORM     12.2 * Scr P1 Fld    33
BQTACT    FORM     12.2 * Scr P1 Fld    34
BQTBUD    FORM     12.2 * Scr P1 Fld    35
BQTFBU    FORM     12.2 * Scr P1 Fld    36
BQTSTD    FORM     12.2 * Scr P1 Fld    37
VQTYAB    FORM     10.2 * Scr P1 Fld    41
PVQTYAB   FORM      6.4 * Scr P1 Fld    42
VUCAB     FORM     10.6 * Scr P1 Fld    43
VUCAF     FORM     10.6 * Scr P1 Fld    44
VUCAS     FORM     10.6 * Scr P1 Fld    45
VUCAC     FORM     10.6 * Scr P1 Fld    46
VUCBF     FORM     10.6 * Scr P1 Fld    47
VUCBS     FORM     10.6 * Scr P1 Fld    48
VUCBC     FORM     10.6 * Scr P1 Fld    49
VUCFS     FORM     10.2 * Scr P1 Fld    50
VUCFC     FORM     10.6 * Scr P1 Fld    51
VUCSC     FORM     10.2 * Scr P1 Fld    52
PVUCAB    FORM      6.4 * Scr P1 Fld    53
PVUCAF    FORM      6.4 * Scr P1 Fld    54
PVUCAS    FORM      6.4 * Scr P1 Fld    55
PVUCAC    FORM      6.4 * Scr P1 Fld    56
PVUCBF    FORM      6.4 * Scr P1 Fld    57
PVUCBS    FORM      6.4 * Scr P1 Fld    58
PVUCBC    FORM      6.4 * Scr P1 Fld    59
PVUCFS    FORM      6.4 * Scr P1 Fld    60
PVUCFC    FORM      6.4 * Scr P1 Fld    61
PVUCSC    FORM      6.4 * Scr P1 Fld    62
VTCAB     FORM     10.2 * Scr P1 Fld    63
VTCAF     FORM     10.2 * Scr P1 Fld    64
VTCAS     FORM     10.2 * Scr P1 Fld    65
VTCAC     FORM     10.2 * Scr P1 Fld    66
VTCBF     FORM     10.2 * Scr P1 Fld    67
VTCBS     FORM     10.2 * Scr P1 Fld    68
VTCBC     FORM     10.2 * Scr P1 Fld    69
VTCFS     FORM     10.2 * Scr P1 Fld    70
VTCFC     FORM     10.2 * Scr P1 Fld    71
VTCSC     FORM     10.2 * Scr P1 Fld    72
PVTCAB    FORM      6.4 * Scr P1 Fld    73
PVTCAF    FORM      6.4 * Scr P1 Fld    74
PVTCAS    FORM      6.4 * Scr P1 Fld    75
PVTCAC    FORM      6.4 * Scr P1 Fld    76
PVTCBF    FORM      6.4 * Scr P1 Fld    77
PVTCBS    FORM      6.4 * Scr P1 Fld    78
PVTCBC    FORM      6.4 * Scr P1 Fld    79
PVTCFS    FORM      6.4 * Scr P1 Fld    80
PVTCFC    FORM      6.4 * Scr P1 Fld    81
PVTCSC    FORM      6.4 * Scr P1 Fld    82
PERDESC   DIM       8 * Scr PP Fld    21
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCS37"
PRGNAM    INIT      "Departmental Enquiries                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILCCDN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILCCBU1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     CCCA1FL1,DELETE
.
          CLOSE     CCPD4FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsawgaf";
          OPEN      CCSAWGA1,"ccsawgaf"
          DISPLAY   *P56:24,"Opening ccsbulaf";
          OPEN      CCSBULA1,"ccsbulaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA1,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA2,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA3,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscmaaf";
          OPEN      CCSCMAA1,"ccscmaaf"
          DISPLAY   *P56:24,"Opening ccsctyaf";
          OPEN      CCSCTYA1,"ccsctyaf"
          DISPLAY   *P56:24,"Opening ccsdcoaf";
          OPEN      CCSDCOA1,"ccsdcoaf"
          DISPLAY   *P56:24,"Opening ccsdcoaf";
          OPEN      CCSDCOA2,"ccsdcoaf"
          DISPLAY   *P56:24,"Opening ccsdnoaf";
          OPEN      CCSDNOA1,"ccsdnoaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA1,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA1,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA2,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA3,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA4,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspsdaf";
          OPEN      CCSPSDA1,"ccspsdaf"
          DISPLAY   *P56:24,"Opening ccspsdaf";
          OPEN      CCSPSDA2,"ccspsdaf"
          DISPLAY   *P56:24,"Opening ccspvraf";
          OPEN      CCSPVRA1,"ccspvraf"
          DISPLAY   *P56:24,"Opening ccssdcaf";
          OPEN      CCSSDCA1,"ccssdcaf"
          DISPLAY   *P56:24,"Opening ccssdcaf";
          OPEN      CCSSDCA2,"ccssdcaf"
.--------------------------------------------------------
. Initialise Wp Filename for Departmental Notes                 
.--------------------------------------------------------
          PACK      FILCCDN1,NAMCCDN1,PORT
          REP       " 0",FILCCDN1
          DISPLAY   *P56:24,"Create & Open ",FILCCDN1;
          PREP      TEMPWORD,FILCCDN1
.
.--------------------------------------------------------
. Initialise Wp Filename for System Bulletin                    
.--------------------------------------------------------
          PACK      FILCCBU1,NAMCCBU1,PORT
          REP       " 0",FILCCBU1
          DISPLAY   *P56:24,"Create & Open ",FILCCBU1;
          PREP      TEMPWORD,FILCCBU1
.
.--------------------------------------------------------
. Initialise Batch Screen Period                             
.--------------------------------------------------------
          MOVE     ZERO,CCCA1SNO
          MOVE     "C1   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCCA1SNO
            ENDIF
          ENDIF
          PACK      CCCA1FNM,ANST,CCCA1NAM,PORT
          REP       " 0",CCCA1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCCA1FL1,CCCA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCCA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCCA1FNM,CCCA1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCCA1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCCA1FL1,CCCA1FNM
.--------------------------------------------------------
. Initialise Batch Screen Cost Type                          
.--------------------------------------------------------
          MOVE     ZERO,CCMB1SNO
          MOVE     "C2   14",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCMB1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Selection          
.--------------------------------------------------------
          MOVE     ZERO,CCPD4SNO
          MOVE     "P1   21",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCPD4SNO
            ENDIF
          ENDIF
          PACK      CCPD4FNM,ANST,CCPD4NAM,PORT
          REP       " 0",CCPD4FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCPD4FL1,CCPD4FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCPD4FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCPD4FNM,CCPD4IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCPD4FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCPD4FL1,CCPD4FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Initial Department Enquiries       
          ENDIF
          MATCH     "C1",SCRID
          IF         @EQUAL
            CALL       PSC1L000   * Cost Analysis Summary              
          ENDIF
          MATCH     "C2",SCRID
          IF         @EQUAL
            CALL       PSC2L000   * Cost Analysis Period Selection     
          ENDIF
          MATCH     "C3",SCRID
          IF         @EQUAL
            CALL       PSC3L000   * Alternative Cost Analysis          
          ENDIF
          MATCH     "CG",SCRID
          IF         @EQUAL
            CALL       PSCGL000   * Cost Analysis Graph Options        
          ENDIF
          MATCH     "GP",SCRID
          IF         @EQUAL
            CALL       PSGPL000   * Graph Patient Service by Period    
          ENDIF
          MATCH     "P1",SCRID
          IF         @EQUAL
            CALL       PSP1L000   * Production Analysis                
          ENDIF
          MATCH     "P2",SCRID
          IF         @EQUAL
            CALL       PSP2L000   * Alternate Patient Service Analysis 
          ENDIF
          MATCH     "PC",SCRID
          IF         @EQUAL
            CALL       PSPCL000   * Patient Service Cost Type Analysis 
          ENDIF
          MATCH     "PG",SCRID
          IF         @EQUAL
            CALL       PSPGL000   * Patient Service Graph Options      
          ENDIF
          MATCH     "PP",SCRID
          IF         @EQUAL
            CALL       PSPPL000   * Patient Service Period Analysis    
          ENDIF
          MATCH     "PU",SCRID
          IF         @EQUAL
            CALL       PSPUL000   * Patient Service Usage              
          ENDIF
          MATCH     "TG",SCRID
          IF         @EQUAL
            CALL       PSTGL000   * Cost Type Graph Options            
          ENDIF
          RETURN
.--------------------------------
. Screen - Initial Department Enquiries       
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Initial Department Enquiries       
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Initial Department Enquiries       
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCDPHCD 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCDPDPT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCHCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCDPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      RCCCO000
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          CALL      RCCCA000
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCDPHCD,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCDPDPT,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCDPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Initial Department Enquiries       
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILCCDN1
          PACK     KEY13,CCHCHCD,CCDPDPT,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDCCDN1 
          IF        OVRCD=0
            CALL      RPCCDN1 
          ENDIF
WP00L100
          CALL     RKCCDN1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY13,CCDNHCD,CCDNDPT,CCDNLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,CCDNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     CCDNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILCCBU1
          PACK     KEY3,SP70
          MOVE     KEY3,SAVKEY80
          SETLPTR  SAVKEY80,1 
          CALL      RDCCBU1 
          IF        OVRCD=0
            CALL      RPCCBU1 
          ENDIF
WP00L110
          CALL     RKCCBU1 
          BRANCH   OVRCD,WP00L115
          PACK     KEY3,CCBULIN
          MATCH    SAVKEY80,KEY3    
          GOTO     WP00L115 IF NOT EQUAL
          PACK     VAR,CCBUDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     CCBUDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L110
WP00L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Initial Department Enquiries       
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Initial Department Enquiries       
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Initial Department Enquiries       
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L999,PS00L999,PS00L999:
                            PS00L105,PS00L999,PS00L999,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L110:
                            PS00L999,PS00L111,PS00L112,PS00L113
          GOTO     PS00L999
.
PS00L101
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCDPHCD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCDPDPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE     FILCCDN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L105
          MOVE     FILCCBU1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L106
          MOVE      CCCOPER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCCOYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CCCADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          UNPACK    CCCAFDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      STARTFLG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      CCDPDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Initial Department Enquiries       
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L101,SF00L006,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L101,SF00L020,SF00L020,SF00L020:
                            SF00L104,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  3",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "17",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILCCDN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILCCDN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF00L001
.
SF00L102
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  3",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "17",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILCCBU1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILCCBU1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCC1L000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CC37P000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Cost Analysis Summary              
.--------------------------------
SCC1L000
SCC1L100
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCC1L200
          CALL      CFC1L000 * Clear Fields
          CALL      DPYTD000
SCC1L300
          CALL      KYC1L000 * Enter Key Fields
          BRANCH    EXIT,SCC1L999,SCC1L999
SCC1L400
          CALL      WPC1L000 * Load any WP Details
SCC1L500
          CALL      LMC1L000 * Load any Batch Details
SCC1L600
          CALL      DFC1L000 * Display Fields
SCC1L700
          CALL      SFC1L000 * Select Fields
          BRANCH    EXIT,SCC1L100,SCC1L100,SCC1L200
SCC1L800
          CALL      EXITSETA
SCC1L900
SCC1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Analysis Summary              
.-------------------------------------------------------
CFC1L000
CFC1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Analysis Summary              
.--------------------------------------------------------
KYC1L000
          MOVE      ZERO,EXIT
          GOTO      KYC1L999
.
KYC1L900  MOVE      ONE,EXIT
KYC1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Analysis Summary              
.---------------------------------------------------------
WPC1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Analysis Summary              
.---------------------------------------------------------
LMC1L000
.---------------------------------------------------------
. Load for :    10 Period                             
.---------------------------------------------------------
          PACK      KEY6,CCCOYEAR,SP70
          MOVE      KEY6,CCCA1EKY
          MOVE      CCCA1EKY,CCCA1SKY
          STRIP     CCCA1SKY
          SETLPTR   CCCA1EKY,4
          CALL      RDCCCA1 
          IF        OVRCD=0
            CALL      RPCCCA1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPC1L000
          MOVE     ZERO,CCCA1CNT
          MOVE     ZERO,CCCA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPC1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPC1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPC1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPC1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPC1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                           DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L101,DPC1L102,DPC1L010:
                           DPC1L103,DPC1L104,DPC1L105,DPC1L106:
                            DPC1L107,DPC1L108,DPC1L109,DPC1L110:
                            DPC1L111,DPC1L112,DPC1L113,DPC1L114:
                            DPC1L115,DPC1L116,DPC1L117,DPC1L118:
                            DPC1L119,DPC1L120,DPC1L121,DPC1L122:
                            DPC1L123,DPC1L124,DPC1L125,DPC1L126:
                            DPC1L127,DPC1L128,DPC1L129,DPC1L130:
                            DPC1L131,DPC1L132,DPC1L133,DPC1L134:
                            DPC1L135,DPC1L010,DPC1L010,DPC1L010:
                           DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                           DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                           DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010,DPC1L010:
                            DPC1L010,DPC1L010,DPC1L010
          GOTO      DPC1L010
.
DPC1L101
          PACK      CCCA1MKY,SP70,SP70
          CALL      UPTCCCA1
          IF        CCCA1END=0
            CALL      RPCCCA1 
            IF        OVRCD=0
              PACK      CCCA1MKY,CCCAYEAR,CCCAPER                                                               
              MATCH     CCCA1EKY,CCCA1MKY
              IF        @EQUAL
                MOVE      ZERO,CCCA1END
                ADD       ONE,CCCA1CNT
                CALL      UPTCCCA1
                MOVE      CCCAPER,VAR      
                CALL      DISPITEM
          CALL      CC37B000
              ELSE
                MOVE      ONE,CCCA1END
              ENDIF
            ELSE
              MOVE      ONE,CCCA1END
            ENDIF
          ENDIF
          IF        CCCA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L102
          IF        CCCA1END=0
            MOVE      CCCADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L103
          IF        CCCA1END=0
            MOVE      CCSDDIR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L104
          IF        CCCA1END=0
            MOVE      CCMCDIR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L105
          IF        CCCA1END=0
            MOVE      CCSDIND,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L106
          IF        CCCA1END=0
            MOVE      CCMCIND,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L107
          IF        CCCA1END=0
            MOVE      CCMCFLX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L108
          IF        CCCA1END=0
            MOVE      CCSDSTD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L109
          IF        CCCA1END=0
          CALL      CC30C000
            MOVE      CCSDCHG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L110
          IF        CCCA1END=0
            MOVE      CCTOTCST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L111
          IF        CCCA1END=0
            MOVE      CCTOTBUD,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L112
          IF        CCCA1END=0
            MOVE      CCVDCB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L113
          IF        CCCA1END=0
            MOVE      CCVICB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L114
          IF        CCCA1END=0
            MOVE      CCVTCB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L115
          IF        CCCA1END=0
            MOVE      CCVTCF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L116
          IF        CCCA1END=0
            MOVE      CCVTCS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L117
          IF        CCCA1END=0
            MOVE      CCVTCC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L118
          IF        CCCA1END=0
            MOVE      CCVTBF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L119
          IF        CCCA1END=0
            MOVE      CCVTBS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L120
          IF        CCCA1END=0
            MOVE      CCVTBC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L121
          IF        CCCA1END=0
            MOVE      CCVTFS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L122
          IF        CCCA1END=0
            MOVE      CCVTFC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L123
          IF        CCCA1END=0
            MOVE      CCVTSC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L124
          IF        CCCA1END=0
            MOVE      CCPVDCB,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L125
          IF        CCCA1END=0
            MOVE      CCPVICB,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L126
          IF        CCCA1END=0
            MOVE      CCPVTCB,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L127
          IF        CCCA1END=0
            MOVE      CCPVTCF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L128
          IF        CCCA1END=0
            MOVE      CCPVTCS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L129
          IF        CCCA1END=0
            MOVE      CCPVTCC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L130
          IF        CCCA1END=0
            MOVE      CCPVTBF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L131
          IF        CCCA1END=0
            MOVE      CCPVTBS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L132
          IF        CCCA1END=0
            MOVE      CCPVTBC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L133
          IF        CCCA1END=0
            MOVE      CCPVTFS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L134
          IF        CCCA1END=0
            MOVE      CCPVTFC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
.
DPC1L135
          IF        CCCA1END=0
            MOVE      CCPVTSC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC1L010
DPC1L600
          MATCH    "CCCA1",NAMSSFFI
          GOTO     DPC1L605 IF NOT EQUAL
          GOTO     DPC1L999
DPC1L605
DPC1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPC1L000
.
          MATCH    "CCCA1",NAMSSFFI
          GOTO     FPC1L105 IF NOT EQUAL
          PACK     KEY6,CCCA1SKY,Z70
          CALL     RDCCCA1  * Start
          IF       OVRCD=0
            CALL     RPCCCA1  * Start
          ENDIF
          CALL     DPC1L000
          GOTO     FPC1L999
FPC1L105
FPC1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPC1L000
.
          MATCH    "CCCA1",NAMSSFFI
          GOTO     LPC1L105 IF NOT EQUAL
          PACK     KEY6,CCCA1SKY,SP70
          CALL     RSCCCA1  * End
          IF       OVRCD=1
            CALL     RKCCCA1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCCA1SNO
            CALL     RKCCCA1 
            IF       OVRCD=1
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
            MATCH    CCCA1EKY,CCCA1MKY
            IF       !@EQUAL
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPC1L000
          GOTO     LPC1L999
LPC1L105
LPC1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPC1L000
.
          MATCH    "CCCA1",NAMSSFFI
          GOTO     PPC1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPC1L105
          CALL      RFTCCCA1
          BRANCH   OVRCD,PPC1L115
          MOVE      CCCA1MKY,KEY6  
          CALL      RSCCCA1 
PPC1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCCA1SNO
            CALL     RKCCCA1 
            IF       OVRCD=1
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
            MATCH    CCCA1EKY,CCCA1MKY
            IF       !@EQUAL
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPC1L000
          GOTO     PPC1L999
PPC1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCCA1SNO
            CALL     RPCCCA1 
            IF       OVRCD=1
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
            MATCH    CCCA1EKY,CCCA1MKY
            IF       !@EQUAL
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPC1L999
PPC1L120
PPC1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPC1L000
          MATCH    "CCCA1",NAMSSFFI
          GOTO     NPC1L115 IF NOT EQUAL
NPC1L105
          CALL     RPCCCA1 
          BRANCH   OVRCD,NPC1L110
          PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
          MATCH    CCCA1EKY,CCCA1MKY
          GOTO     NPC1L110 IF NOT EQUAL
          CALL     RKCCCA1 
          CALL     DPC1L000
          GOTO     NPC1L999
NPC1L110
          CALL     RKCCCA1 
          BEEP
          GOTO     NPC1L999
NPC1L115
NPC1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTC1L000
CTC1L105
CTC1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Cost Analysis Summary              
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Period                             
.---------------------------------------------------------
UPTCCCA1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCCA1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCCA1FL1,KEY5;SCPSROW,SCPSCOL,CCCA1MKY
          ELSE
            UPDATE    CCCA1FL1;SCPSROW,SCPSCOL,CCCA1MKY
          ENDIF
          RETURN
RDTCCCA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCCA1FL1,KEY5;SCPSROW,SCPSCOL,CCCA1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCCA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCCA1FL1,KEY5;;
          READKS    CCCA1FL1;SCPSROW,SCPSCOL,CCCA1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCCA1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Analysis Summary              
.---------------------------------------------------------
DFC1L000
          BRANCH   ACCEPT,DFC1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFC1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFC1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFC1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFC1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFC1L010 IF NOT EQUAL
.
          CALL     PSC1L000 * Display Field
          GOTO     DFC1L010
DFC1L900
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPC1L000
DFC1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Analysis Summary              
.---------------------------------------------------------
PSC1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSC1L999,PSC1L101,PSC1L999,PSC1L999:
                           PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                           PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                           PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                           PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                           PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L999,PSC1L999,PSC1L999:
                            PSC1L999,PSC1L102,PSC1L103,PSC1L104:
                            PSC1L105,PSC1L106,PSC1L107,PSC1L108:
                            PSC1L109,PSC1L110,PSC1L111,PSC1L112:
                            PSC1L113,PSC1L114,PSC1L115,PSC1L116:
                            PSC1L117,PSC1L118,PSC1L119,PSC1L120:
                            PSC1L121,PSC1L122,PSC1L123,PSC1L124:
                            PSC1L125,PSC1L126,PSC1L127,PSC1L128:
                            PSC1L129,PSC1L130,PSC1L131,PSC1L132:
                            PSC1L133,PSC1L134,PSC1L999
          GOTO     PSC1L999
.
PSC1L101
          MOVE      CCCOYEAR,VAR     
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L102
          MOVE      YTDDIR,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L103
          MOVE      YTDIND,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L104
          MOVE      YTDDBU,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L105
          MOVE      YTDIBU,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L106
          MOVE      YTDFBU,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L107
          MOVE      YTDSTD,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L108
          MOVE      YTDCHG,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L109
          MOVE      YTDCST,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L110
          MOVE      YTDBUD,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L111
          MOVE      VYTDDIR,VAR      
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L112
          MOVE      VYTDIND,VAR      
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L113
          MOVE      VYTDCB,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L114
          MOVE      VYTDCF,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L115
          MOVE      VYTDCS,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L116
          MOVE      VYTDCC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L117
          MOVE      VYTDBF,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L118
          MOVE      VYTDBS,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L119
          MOVE      VYTDBC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L120
          MOVE      VYTDFS,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L121
          MOVE      VYTDFC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L122
          MOVE      VYTDSC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L123
          MOVE      PYTDDIR,VAR      
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L124
          MOVE      PYTDIND,VAR      
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L125
          MOVE      PYTDCB,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L126
          MOVE      PYTDCF,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L127
          MOVE      PYTDCS,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L128
          MOVE      PYTDCC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L129
          MOVE      PYTDBF,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L130
          MOVE      PYTDBS,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L131
          MOVE      PYTDBC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L132
          MOVE      PYTDFS,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L133
          MOVE      PYTDFC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
.
PSC1L134
          MOVE      PYTDSC,VAR       
          CALL      DISPITEM
          GOTO     PSC1L999
PSC1L999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Analysis Summary              
.---------------------------------------------------------
SFC1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFC1L001  BRANCH   ACCEPT,SFC1L020
.
SFC1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC1L101,SFC1L006,SFC1L006,SFC1L006:
                           SFC1L006,SFC1L006,SFC1L006,SFC1L102:
                            SFC1L103,SFC1L104,SFC1L006,SFC1L006:
                           SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                           SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                           SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                           SFC1L006,SFC1L006,SFC1L006,SFC1L105:
                            SFC1L106,SFC1L107,SFC1L006,SFC1L108:
                            SFC1L109,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L006,SFC1L006:
                            SFC1L006,SFC1L006,SFC1L110
SFC1L006  BEEP
          GOTO     SFC1L005
SFC1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFC1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFC1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFC1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                           SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L104,SFC1L020,SFC1L020:
                           SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                           SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                           SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                           SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020,SFC1L020:
                            SFC1L020,SFC1L020,SFC1L020
          GOTO     SFC1L020
SFC1L090  MOVE     ZERO,ACCEPT
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPC1L000
          GOTO     SFC1L001
.
SFC1L101
          CALL      EYEAR000
          MOVE      ONE,EXIT
          GOTO      SFC1L999
.
SFC1L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCCGL000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFC1L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFC1L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFC1L999
          ENDIF
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFC1L000
          ENDIF
          GOTO      SFC1L001
.
SFC1L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCC3L000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFC1L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFC1L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFC1L999
          ENDIF
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFC1L000
          ENDIF
          GOTO      SFC1L001
.
SFC1L104
          CALL      SELECTED
          BRANCH    EXIT,SFC1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFC1L001 IF EQUAL
          CALL      RDTCCCA1
          IF        OVRCD=1
            BEEP
            GOTO      SFC1L001
          ENDIF
          MATCH     SP70,CCCA1MKY
          IF        @EQUAL
            BEEP
            GOTO      SFC1L001
          ENDIF
          MOVE      CCCA1MKY,KEY6  
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      CC37D000
          MOVE      "C1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCCA1
          IF        OVRCD=1
            CALL      FPC1L000
          ELSE
            MOVE      CCCA1MKY,KEY6  
            CALL      RSCCCA1 
            CALL      RKCCCA1 
            CALL      DPC1L000
          ENDIF
          GOTO     SFC1L001
.
SFC1L105
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "     ",ITMSSFFI
          CALL      NPC1L000
          GOTO     SFC1L001
.
SFC1L106
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PPC1L000
          GOTO     SFC1L001
.
SFC1L107
          CALL      EXITSET2
          MOVE      ZERO,EXIT
          GOTO      SFC1L999
.
SFC1L108
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPC1L000
          GOTO     SFC1L001
.
SFC1L109
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LPC1L000
          GOTO     SFC1L001
.
SFC1L110
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFC1L999
SFC1L990  MOVE      ONE,EXIT * Exit Char Restart
SFC1L999  RETURN
.--------------------------------
. Screen - Cost Analysis Period Selection     
.--------------------------------
SCC2L000
SCC2L100
          MOVE      "C2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCC2L200
          CALL      CFC2L000 * Clear Fields
SCC2L300
          CALL      KYC2L000 * Enter Key Fields
          BRANCH    EXIT,SCC2L999,SCC2L999
SCC2L400
          CALL      WPC2L000 * Load any WP Details
SCC2L500
          CALL      LMC2L000 * Load any Batch Details
SCC2L600
          CALL      DFC2L000 * Display Fields
SCC2L700
          CALL      SFC2L000 * Select Fields
          BRANCH    EXIT,SCC2L100,SCC2L100,SCC2L200
SCC2L800
          CALL      EXITSETF
SCC2L900
SCC2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Analysis Period Selection     
.-------------------------------------------------------
CFC2L000
CFC2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Analysis Period Selection     
.--------------------------------------------------------
KYC2L000
          MOVE      ZERO,EXIT
          GOTO      KYC2L999
.
KYC2L900  MOVE      ONE,EXIT
KYC2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Analysis Period Selection     
.---------------------------------------------------------
WPC2L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Analysis Period Selection     
.---------------------------------------------------------
LMC2L000
.---------------------------------------------------------
. Load for :    14 Cost Type                          
.---------------------------------------------------------
          PACK      KEY20,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER,SP9
          MOVE      KEY20,CCMB1EKY
          MOVE      CCMB1EKY,CCMB1SKY
          STRIP     CCMB1SKY
          SETLPTR   CCMB1EKY,16
          CALL      RDCCMB1 
          IF        OVRCD=0
            CALL      RPCCMB1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPC2L000
          MOVE     ZERO,CCMB1CNT
          MOVE     ZERO,CCMB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPC2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPC2L600
          MATCH    PRGID,SCPSPID
          GOTO     DPC2L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPC2L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPC2L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPC2L010,DPC2L010,DPC2L010,DPC2L010:
                            DPC2L010,DPC2L010,DPC2L010,DPC2L010:
                            DPC2L010,DPC2L010,DPC2L010,DPC2L010:
                            DPC2L010,DPC2L101,DPC2L102,DPC2L103:
                            DPC2L104,DPC2L105,DPC2L106,DPC2L107:
                            DPC2L108,DPC2L109,DPC2L110,DPC2L111:
                            DPC2L112,DPC2L113,DPC2L010,DPC2L114:
                            DPC2L115,DPC2L116,DPC2L117,DPC2L118:
                            DPC2L010,DPC2L010,DPC2L010,DPC2L010:
                           DPC2L010,DPC2L010,DPC2L010,DPC2L010:
                            DPC2L010,DPC2L010,DPC2L010,DPC2L010:
                            DPC2L010,DPC2L010,DPC2L010,DPC2L010
          GOTO      DPC2L010
.
DPC2L101
          IF        CCMB1END=0
            CALL      RKCCMB1 
            IF        OVRCD=0
              PACK      CCMB1MKY,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY                                       
              MATCH     CCMB1EKY,CCMB1MKY
              IF        @EQUAL
                MOVE      ZERO,CCMB1END
                ADD       ONE,CCMB1CNT
          CALL      CC37E000
                MOVE      CCMBCTY,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCMB1END
              ENDIF
            ELSE
              MOVE      ONE,CCMB1END
            ENDIF
          ENDIF
          IF        CCMB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L102
          IF        CCMB1END=0
            MOVE      CCDCDIR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L103
          IF        CCMB1END=0
            MOVE      CCDCIND,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L104
          IF        CCMB1END=0
            MOVE      CCCTDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L105
          IF        CCMB1END=0
            MOVE      CCMBDIR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L106
          IF        CCMB1END=0
            MOVE      CCMBIND,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L107
          IF        CCMB1END=0
            MOVE      CCMBFLX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L108
          IF        CCMB1END=0
            MOVE      ACTTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L109
          IF        CCMB1END=0
            MOVE      BUDTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L110
          IF        CCMB1END=0
            MOVE      VARDIR,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L111
          IF        CCMB1END=0
            MOVE      VARIND,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L112
          IF        CCMB1END=0
            MOVE      VARCB,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L113
          IF        CCMB1END=0
            MOVE      VARCF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L114
          IF        CCMB1END=0
            MOVE      PVADIR,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L115
          IF        CCMB1END=0
            MOVE      PVAIND,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L116
          IF        CCMB1END=0
            MOVE      PVACB,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L117
          IF        CCMB1END=0
            MOVE      PVACF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
.
DPC2L118
          IF        CCMB1END=0
            MOVE      PVABF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPC2L010
DPC2L600
          MATCH    "CCMB1",NAMSSFFI
          GOTO     DPC2L605 IF NOT EQUAL
          GOTO     DPC2L999
DPC2L605
DPC2L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPC2L000
.
          MATCH    "CCMB1",NAMSSFFI
          GOTO     FPC2L105 IF NOT EQUAL
          PACK     KEY20,CCMB1SKY,SP70
          CALL     RDCCMB1  * Start
          IF       OVRCD=0
            CALL     RPCCMB1  * Start
          ENDIF
          CALL     DPC2L000
          GOTO     FPC2L999
FPC2L105
FPC2L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPC2L000
.
          MATCH    "CCMB1",NAMSSFFI
          GOTO     LPC2L105 IF NOT EQUAL
          PACK     KEY20,CCMB1SKY,Z70
          CALL     RSCCMB1  * End
          IF       OVRCD=1
            CALL     RPCCMB1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCMB1SNO
            CALL     RPCCMB1 
            IF       OVRCD=1
              MOVE     CCMB1SNO,SECTOR
            ENDIF
            PACK     CCMB1MKY,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY                                       
            MATCH    CCMB1EKY,CCMB1MKY
            IF       !@EQUAL
              MOVE     CCMB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPC2L000
          GOTO     LPC2L999
LPC2L105
LPC2L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPC2L000
.
          MATCH    "CCMB1",NAMSSFFI
          GOTO     PPC2L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPC2L105
          COMPARE  SECTOR,CCMB1SNO
          GOTO     PPC2L110 IF EQUAL
          CALL     RPCCMB1 
          BRANCH   OVRCD,PPC2L115
          PACK     CCMB1MKY,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY                                       
          MATCH    CCMB1EKY,CCMB1MKY
          GOTO     PPC2L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PPC2L105
PPC2L110
          MOVE     ZERO,SECTOR
          IF       CCMB1CNT=CCMB1SNO
            SUB      ONE,CCMB1CNT
          ENDIF
          WHILE    SECTOR<=CCMB1CNT
            CALL     RPCCMB1 
            IF       OVRCD=1
              MOVE     CCMB1SNO,SECTOR
            ENDIF
            PACK     CCMB1MKY,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY                                       
            MATCH    CCMB1EKY,CCMB1MKY
            IF       !@EQUAL
              MOVE     CCMB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPC2L000
          GOTO     PPC2L999
PPC2L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCMB1SNO
            CALL     RKCCMB1 
            IF       OVRCD=1
              MOVE     CCMB1SNO,SECTOR
            ENDIF
            PACK     CCMB1MKY,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY                                       
            MATCH    CCMB1EKY,CCMB1MKY
            IF       !@EQUAL
              MOVE     CCMB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPC2L999
PPC2L120
PPC2L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPC2L000
          MATCH    "CCMB1",NAMSSFFI
          GOTO     NPC2L115 IF NOT EQUAL
NPC2L105
          CALL     RKCCMB1 
          BRANCH   OVRCD,NPC2L110
          PACK     CCMB1MKY,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY                                       
          MATCH    CCMB1EKY,CCMB1MKY
          GOTO     NPC2L110 IF NOT EQUAL
          CALL     RPCCMB1 
          CALL     DPC2L000
          GOTO     NPC2L999
NPC2L110
          CALL     RPCCMB1 
          BEEP
          GOTO     NPC2L999
NPC2L115
NPC2L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTC2L000
CTC2L105
CTC2L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Cost Analysis Period Selection     
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Cost Analysis Period Selection     
.---------------------------------------------------------
DFC2L000
          BRANCH   ACCEPT,DFC2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFC2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFC2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFC2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFC2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFC2L010 IF NOT EQUAL
.
          CALL     PSC2L000 * Display Field
          GOTO     DFC2L010
DFC2L900
          MOVE      "CCMB1",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      FPC2L000
DFC2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Analysis Period Selection     
.---------------------------------------------------------
PSC2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSC2L101,PSC2L102,PSC2L103,PSC2L104:
                            PSC2L105,PSC2L106,PSC2L107,PSC2L108:
                            PSC2L109,PSC2L110,PSC2L111,PSC2L112:
                            PSC2L113,PSC2L999,PSC2L999,PSC2L999:
                            PSC2L999,PSC2L999,PSC2L999,PSC2L999:
                            PSC2L999,PSC2L999,PSC2L999,PSC2L999:
                            PSC2L999,PSC2L999,PSC2L114,PSC2L999:
                            PSC2L999,PSC2L999,PSC2L999,PSC2L999:
                            PSC2L999,PSC2L999,PSC2L999,PSC2L999:
                           PSC2L999,PSC2L999,PSC2L999,PSC2L999:
                            PSC2L115,PSC2L116,PSC2L117,PSC2L999:
                            PSC2L999,PSC2L999,PSC2L999,PSC2L999
          GOTO     PSC2L999
.
PSC2L101
          MOVE      CCSDHCD,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L102
          MOVE      CCSDDPT,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L103
          MOVE      CCSDYEAR,VAR     
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L104
          MOVE      CCSDPER,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L105
          MOVE      CCSDDIR,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L106
          MOVE      CCMCDIR,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L107
          MOVE      CCSDIND,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L108
          MOVE      CCMCIND,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L109
          MOVE      CCMCFLX,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L110
          MOVE      CCSDSTD,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L111
          MOVE      CCSDCHG,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L112
          MOVE      TOTACT,VAR       
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L113
          MOVE      TOTBUD,VAR       
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L114
          MOVE      VARBF,VAR        
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L115
          MOVE      CCCADES,VAR      
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L116
          UNPACK    CCCAFDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
.
PSC2L117
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSC2L999
PSC2L999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Analysis Period Selection     
.---------------------------------------------------------
SFC2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFC2L001  BRANCH   ACCEPT,SFC2L020
.
SFC2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L006:
                           SFC2L101,SFC2L006,SFC2L102,SFC2L103:
                            SFC2L006,SFC2L006,SFC2L006,SFC2L104:
                            SFC2L105,SFC2L106,SFC2L107,SFC2L108
SFC2L006  BEEP
          GOTO     SFC2L005
SFC2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFC2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFC2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFC2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                           SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020:
                            SFC2L020,SFC2L020,SFC2L020,SFC2L020
          GOTO     SFC2L020
SFC2L090  MOVE     ZERO,ACCEPT
          MOVE      "CCMB1",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      FPC2L000
          GOTO     SFC2L001
.
SFC2L101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFC2L999
.
SFC2L102
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFC2L999
.
SFC2L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCTGL000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFC2L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFC2L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFC2L999
          ENDIF
          MOVE      "C2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFC2L000
          ENDIF
          GOTO      SFC2L001
.
SFC2L104
          CALL      EXITSET1
          MOVE      ZERO,EXIT
          GOTO      SFC2L999
.
SFC2L105
          MOVE      "CCMB1",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      NPC2L000
          GOTO     SFC2L001
.
SFC2L106
          MOVE      "CCMB1",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      PPC2L000
          GOTO     SFC2L001
.
SFC2L107
          MOVE      "CCMB1",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      FPC2L000
          GOTO     SFC2L001
.
SFC2L108
          MOVE      "CCMB1",NAMSSFFI
          MOVE      "   14",ITMSSFFI
          CALL      LPC2L000
          GOTO     SFC2L001
SFC2L990  MOVE      ONE,EXIT * Exit Char Restart
SFC2L999  RETURN
.--------------------------------
. Screen - Alternative Cost Analysis          
.--------------------------------
SCC3L000
SCC3L100
          MOVE      "C3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCC3L200
          CALL      CFC3L000 * Clear Fields
SCC3L300
          CALL      KYC3L000 * Enter Key Fields
          BRANCH    EXIT,SCC3L999,SCC3L999
SCC3L400
          CALL      WPC3L000 * Load any WP Details
SCC3L500
          CALL      LMC3L000 * Load any Batch Details
SCC3L600
          CALL      DFC3L000 * Display Fields
SCC3L700
          CALL      SFC3L000 * Select Fields
          BRANCH    EXIT,SCC3L100,SCC3L100,SCC3L200
SCC3L800
          CALL      EXITSETF
SCC3L900
SCC3L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Alternative Cost Analysis          
.-------------------------------------------------------
CFC3L000  COMPARE   ZERO,ACCEPT
              GOTO      CFC3L999 IF EQUAL
CFC3L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Alternative Cost Analysis          
.--------------------------------------------------------
KYC3L000
          MOVE      ZERO,EXIT
          GOTO      KYC3L999
.
KYC3L900  MOVE      ONE,EXIT
KYC3L999  RETURN
.---------------------------------------------------------
. Load WP files for : Alternative Cost Analysis          
.---------------------------------------------------------
WPC3L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Alternative Cost Analysis          
.---------------------------------------------------------
LMC3L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Alternative Cost Analysis          
.---------------------------------------------------------
DFC3L000
          BRANCH   ACCEPT,DFC3L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFC3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFC3L900
          MATCH    PRGID,SCPSPID
          GOTO     DFC3L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFC3L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFC3L010 IF NOT EQUAL
.
          CALL     PSC3L000 * Display Field
          GOTO     DFC3L010
DFC3L900
DFC3L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Alternative Cost Analysis          
.---------------------------------------------------------
PSC3L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSC3L999,PSC3L999
          GOTO     PSC3L999
PSC3L999
          RETURN
.---------------------------------------------------------
. Selections for : Alternative Cost Analysis          
.---------------------------------------------------------
SFC3L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFC3L001  BRANCH   ACCEPT,SFC3L020
.
SFC3L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC3L006,SFC3L101
SFC3L006  BEEP
          GOTO     SFC3L005
SFC3L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFC3L090
          MATCH    PRGID,SCSLPID
          GOTO     SFC3L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFC3L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFC3L020,SFC3L020
          GOTO     SFC3L020
SFC3L090  MOVE     ZERO,ACCEPT
          GOTO     SFC3L001
.
SFC3L101
          MOVE      ZERO,EXIT
          GOTO      SFC3L999
SFC3L990  MOVE      ONE,EXIT * Exit Char Restart
SFC3L999  RETURN
.--------------------------------
. Screen - Cost Analysis Graph Options        
.--------------------------------
SCCGL000
SCCGL100
          MOVE      "CG",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      " 40",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCCGL200
          CALL      CFCGL000 * Clear Fields
SCCGL300
          CALL      KYCGL000 * Enter Key Fields
          BRANCH    EXIT,SCCGL999,SCCGL999
SCCGL400
          CALL      WPCGL000 * Load any WP Details
SCCGL500
          CALL      LMCGL000 * Load any Batch Details
SCCGL600
          CALL      DFCGL000 * Display Fields
SCCGL700
          CALL      SFCGL000 * Select Fields
          BRANCH    EXIT,SCCGL100,SCCGL100,SCCGL200
SCCGL800
          CALL      EXITSETF
SCCGL900
SCCGL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Analysis Graph Options        
.-------------------------------------------------------
CFCGL000  COMPARE   ZERO,ACCEPT
              GOTO      CFCGL999 IF EQUAL
          MOVE      ZERO,GPHDIR  
          MOVE      ZERO,GPHIND  
          MOVE      ZERO,GPHCST  
          MOVE      ZERO,GPHDBU  
          MOVE      ZERO,GPHIBU  
          MOVE      ZERO,GPHBUD  
          MOVE      ZERO,GPHFBU  
          MOVE      ZERO,GPHSTD  
          MOVE      ZERO,GPHCHG  
CFCGL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Analysis Graph Options        
.--------------------------------------------------------
KYCGL000
          MOVE      ZERO,EXIT
          GOTO      KYCGL999
.
KYCGL900  MOVE      ONE,EXIT
KYCGL999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Analysis Graph Options        
.---------------------------------------------------------
WPCGL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Analysis Graph Options        
.---------------------------------------------------------
LMCGL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Analysis Graph Options        
.---------------------------------------------------------
DFCGL000
          BRANCH   ACCEPT,DFCGL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFCGL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFCGL900
          MATCH    PRGID,SCPSPID
          GOTO     DFCGL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFCGL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFCGL010 IF NOT EQUAL
.
          CALL     PSCGL000 * Display Field
          GOTO     DFCGL010
DFCGL900
DFCGL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Analysis Graph Options        
.---------------------------------------------------------
PSCGL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSCGL999,PSCGL999,PSCGL999,PSCGL101:
                            PSCGL102,PSCGL103,PSCGL104,PSCGL105:
                            PSCGL106,PSCGL107,PSCGL108,PSCGL109:
                            PSCGL999
          GOTO     PSCGL999
.
PSCGL101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDIR,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIND,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHCST,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHBUD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHSTD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
.
PSCGL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSCGL999
PSCGL999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Analysis Graph Options        
.---------------------------------------------------------
SFCGL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFCGL001  BRANCH   ACCEPT,SFCGL020
.
SFCGL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFCGL006,SFCGL101,SFCGL102,SFCGL103:
                            SFCGL104,SFCGL105,SFCGL106,SFCGL107:
                            SFCGL108,SFCGL109,SFCGL110,SFCGL111:
                            SFCGL112
SFCGL006  BEEP
          GOTO     SFCGL005
SFCGL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFCGL090
          MATCH    PRGID,SCSLPID
          GOTO     SFCGL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFCGL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFCGL020,SFCGL020,SFCGL020,SFCGL103:
                            SFCGL104,SFCGL105,SFCGL106,SFCGL107:
                            SFCGL108,SFCGL109,SFCGL110,SFCGL111:
                            SFCGL020
          GOTO     SFCGL020
SFCGL090  MOVE     ZERO,ACCEPT
          GOTO     SFCGL001
.
SFCGL101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFCGL999
.
SFCGL102
          CALL      CCGCST00
          GOTO      SFCGL001
.
SFCGL103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHDIR00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL103
            ENDIF
            BRANCH    EXIT,SFCGL103,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDIR,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHIND00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL104
            ENDIF
            BRANCH    EXIT,SFCGL104,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIND,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHCST00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL105
            ENDIF
            BRANCH    EXIT,SFCGL105,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHCST,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHDBU00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL106
            ENDIF
            BRANCH    EXIT,SFCGL106,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHIBU00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL107
            ENDIF
            BRANCH    EXIT,SFCGL107,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHBUD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL108
            ENDIF
            BRANCH    EXIT,SFCGL108,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHBUD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFBU00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL109
            ENDIF
            BRANCH    EXIT,SFCGL109,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHSTD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL110
            ENDIF
            BRANCH    EXIT,SFCGL110,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHSTD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHCHG00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFCGL111
            ENDIF
            BRANCH    EXIT,SFCGL111,SFCGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFCGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFCGL001
.
SFCGL112
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFCGL999
SFCGL990  MOVE      ONE,EXIT * Exit Char Restart
SFCGL999  RETURN
.--------------------------------
. Screen - Graph Patient Service by Period    
.--------------------------------
SCGPL000
SCGPL100
          MOVE      "GP",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      " 39",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCGPL200
          CALL      CFGPL000 * Clear Fields
SCGPL300
          CALL      KYGPL000 * Enter Key Fields
          BRANCH    EXIT,SCGPL999,SCGPL999
SCGPL400
          CALL      WPGPL000 * Load any WP Details
SCGPL500
          CALL      LMGPL000 * Load any Batch Details
SCGPL600
          CALL      DFGPL000 * Display Fields
SCGPL700
          CALL      SFGPL000 * Select Fields
          BRANCH    EXIT,SCGPL100,SCGPL100,SCGPL200
SCGPL800
          CALL      EXITSETF
SCGPL900
SCGPL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Graph Patient Service by Period    
.-------------------------------------------------------
CFGPL000  COMPARE   ZERO,ACCEPT
              GOTO      CFGPL999 IF EQUAL
          MOVE      ZERO,GPQTY   
          MOVE      ZERO,GPBQT   
          MOVE      ZERO,GPACT   
          MOVE      ZERO,GPBUD   
          MOVE      ZERO,GPFBU   
          MOVE      ZERO,GPSTD   
          MOVE      ZERO,GPCHG   
          MOVE      ZERO,GPAA    
          MOVE      ZERO,GPAB    
          MOVE      ZERO,GPAF    
          MOVE      ZERO,GPAS    
          MOVE      ZERO,GPTCHG  
          MOVE      ZERO,GPBA    
          MOVE      ZERO,GPBB    
          MOVE      ZERO,GPBF    
          MOVE      ZERO,GPBS    
CFGPL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Graph Patient Service by Period    
.--------------------------------------------------------
KYGPL000
          MOVE      ZERO,EXIT
          GOTO      KYGPL999
.
KYGPL900  MOVE      ONE,EXIT
KYGPL999  RETURN
.---------------------------------------------------------
. Load WP files for : Graph Patient Service by Period    
.---------------------------------------------------------
WPGPL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Graph Patient Service by Period    
.---------------------------------------------------------
LMGPL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Graph Patient Service by Period    
.---------------------------------------------------------
DFGPL000
          BRANCH   ACCEPT,DFGPL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFGPL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFGPL900
          MATCH    PRGID,SCPSPID
          GOTO     DFGPL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFGPL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFGPL010 IF NOT EQUAL
.
          CALL     PSGPL000 * Display Field
          GOTO     DFGPL010
DFGPL900
DFGPL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Graph Patient Service by Period    
.---------------------------------------------------------
PSGPL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSGPL999,PSGPL999,PSGPL999,PSGPL999:
                            PSGPL101,PSGPL102,PSGPL103,PSGPL104:
                            PSGPL105,PSGPL106,PSGPL107,PSGPL108:
                            PSGPL109,PSGPL110,PSGPL111,PSGPL112:
                            PSGPL113,PSGPL114,PSGPL115,PSGPL116
          GOTO     PSGPL999
.
PSGPL101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPQTY,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBQT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPACT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBUD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPFBU,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPSTD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPCHG,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPTCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
.
PSGPL116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGPL999
PSGPL999
          RETURN
.---------------------------------------------------------
. Selections for : Graph Patient Service by Period    
.---------------------------------------------------------
SFGPL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFGPL001  BRANCH   ACCEPT,SFGPL020
.
SFGPL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGPL006,SFGPL101,SFGPL102,SFGPL103:
                            SFGPL104,SFGPL105,SFGPL106,SFGPL107:
                            SFGPL108,SFGPL109,SFGPL110,SFGPL111:
                            SFGPL112,SFGPL113,SFGPL114,SFGPL115:
                            SFGPL116,SFGPL117,SFGPL118,SFGPL119
SFGPL006  BEEP
          GOTO     SFGPL005
SFGPL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFGPL090
          MATCH    PRGID,SCSLPID
          GOTO     SFGPL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFGPL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGPL020,SFGPL020,SFGPL020,SFGPL020:
                            SFGPL104,SFGPL105,SFGPL106,SFGPL107:
                            SFGPL108,SFGPL109,SFGPL110,SFGPL111:
                            SFGPL112,SFGPL113,SFGPL114,SFGPL115:
                            SFGPL116,SFGPL117,SFGPL118,SFGPL119
          GOTO     SFGPL020
SFGPL090  MOVE     ZERO,ACCEPT
          GOTO     SFGPL001
.
SFGPL101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFGPL999
.
SFGPL102
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFGPL999
.
SFGPL103
          CALL      CC37Z000
          GOTO      SFGPL001
.
SFGPL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPQTY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL104
            ENDIF
            BRANCH    EXIT,SFGPL104,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPQTY,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBQT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL105
            ENDIF
            BRANCH    EXIT,SFGPL105,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBQT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPACT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL106
            ENDIF
            BRANCH    EXIT,SFGPL106,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPACT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBUD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL107
            ENDIF
            BRANCH    EXIT,SFGPL107,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBUD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPFBU000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL108
            ENDIF
            BRANCH    EXIT,SFGPL108,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPFBU,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPSTD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL109
            ENDIF
            BRANCH    EXIT,SFGPL109,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPSTD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPCHG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL110
            ENDIF
            BRANCH    EXIT,SFGPL110,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPCHG,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL111
            ENDIF
            BRANCH    EXIT,SFGPL111,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL112
            ENDIF
            BRANCH    EXIT,SFGPL112,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL113
            ENDIF
            BRANCH    EXIT,SFGPL113,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL114
            ENDIF
            BRANCH    EXIT,SFGPL114,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPTCHG00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL115
            ENDIF
            BRANCH    EXIT,SFGPL115,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPTCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL116
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL116
            ENDIF
            BRANCH    EXIT,SFGPL116,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL117
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL117
            ENDIF
            BRANCH    EXIT,SFGPL117,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL118
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL118
            ENDIF
            BRANCH    EXIT,SFGPL118,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
.
SFGPL119
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGPL119
            ENDIF
            BRANCH    EXIT,SFGPL119,SFGPL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGPL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGPL001
SFGPL990  MOVE      ONE,EXIT * Exit Char Restart
SFGPL999  RETURN
.--------------------------------
. Screen - Production Analysis                
.--------------------------------
SCP1L000
SCP1L100
          MOVE      "P1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCP1L200
          CALL      CFP1L000 * Clear Fields
SCP1L300
          CALL      KYP1L000 * Enter Key Fields
          BRANCH    EXIT,SCP1L999,SCP1L999
SCP1L400
          CALL      WPP1L000 * Load any WP Details
SCP1L500
          CALL      LMP1L000 * Load any Batch Details
SCP1L600
          CALL      DFP1L000 * Display Fields
SCP1L700
          CALL      SFP1L000 * Select Fields
          BRANCH    EXIT,SCP1L100,SCP1L100,SCP1L200
SCP1L800
          CALL      EXITSETF
SCP1L900
SCP1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Production Analysis                
.-------------------------------------------------------
CFP1L000
CFP1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Production Analysis                
.--------------------------------------------------------
KYP1L000
          MOVE      ZERO,EXIT
          GOTO      KYP1L999
.
KYP1L900  MOVE      ONE,EXIT
KYP1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Production Analysis                
.---------------------------------------------------------
WPP1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Production Analysis                
.---------------------------------------------------------
LMP1L000
.---------------------------------------------------------
. Load for :    21 Patient Service Selection          
.---------------------------------------------------------
          PACK      KEY21,CCHCHCD,CCDPDPT,SP70
          MOVE      KEY21,CCPD4EKY
          MOVE      CCPD4EKY,CCPD4SKY
          STRIP     CCPD4SKY
          SETLPTR   CCPD4EKY,10
          CALL      RDCCPD4 
          IF        OVRCD=0
            CALL      RPCCPD4 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPP1L000
          MOVE     ZERO,CCPD4CNT
          MOVE     ZERO,CCPD4END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPP1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPP1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPP1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPP1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPP1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L101,DPP1L102,DPP1L103,DPP1L104:
                            DPP1L105,DPP1L106,DPP1L107,DPP1L108:
                            DPP1L109,DPP1L110,DPP1L111,DPP1L112:
                            DPP1L113,DPP1L114,DPP1L115,DPP1L116:
                            DPP1L117,DPP1L118,DPP1L119,DPP1L120:
                            DPP1L121,DPP1L122,DPP1L123,DPP1L124:
                            DPP1L125,DPP1L126,DPP1L127,DPP1L128:
                            DPP1L129,DPP1L130,DPP1L131,DPP1L132:
                            DPP1L133,DPP1L134,DPP1L135,DPP1L136:
                            DPP1L137,DPP1L138,DPP1L139,DPP1L140:
                            DPP1L141,DPP1L142,DPP1L143,DPP1L144:
                            DPP1L145,DPP1L146,DPP1L147,DPP1L148:
                            DPP1L149,DPP1L150,DPP1L151,DPP1L152:
                            DPP1L153,DPP1L154,DPP1L155,DPP1L156:
                            DPP1L157,DPP1L158,DPP1L159,DPP1L160:
                            DPP1L161,DPP1L162,DPP1L010,DPP1L010:
                           DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                           DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L010,DPP1L010,DPP1L010,DPP1L010:
                            DPP1L010
          GOTO      DPP1L010
.
DPP1L101
          PACK      CCPD4MKY,SP70,SP70
          CALL      UPTCCPD4
          IF        CCPD4END=0
            CALL      RKCCPD4 
            IF        OVRCD=0
              PACK      CCPD4MKY,CCPDHCD,CCPDDPT,CCPDSEQ,CCPDPCD                                                
              MATCH     CCPD4EKY,CCPD4MKY
              IF        @EQUAL
                MOVE      ZERO,CCPD4END
                ADD       ONE,CCPD4CNT
                CALL      UPTCCPD4
                MOVE      CCPDPCD,VAR      
                CALL      DISPITEM
          CALL      CC37Q000
              ELSE
                MOVE      ONE,CCPD4END
              ENDIF
            ELSE
              MOVE      ONE,CCPD4END
            ENDIF
          ENDIF
          IF        CCPD4END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L102
          IF        CCPD4END=0
            MOVE      CCPSQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L103
          IF        CCPD4END=0
            MOVE      CCMEQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L104
          IF        CCPD4END=0
            MOVE      CCPSCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L105
          IF        CCPD4END=0
            MOVE      CCMECST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L106
          IF        CCPD4END=0
            MOVE      CCMEFLX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L107
          IF        CCPD4END=0
            MOVE      CCPSSCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L108
          IF        CCPD4END=0
            MOVE      CCPSCHG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L109
          IF        CCPD4END=0
            MOVE      AVECHG,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L110
          IF        CCPD4END=0
            MOVE      AQTACT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L111
          IF        CCPD4END=0
            MOVE      AQTBUD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L112
          IF        CCPD4END=0
            MOVE      AQTFBU,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L113
          IF        CCPD4END=0
            MOVE      AQTSTD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L114
          IF        CCPD4END=0
            MOVE      BQTACT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L115
          IF        CCPD4END=0
            MOVE      BQTBUD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L116
          IF        CCPD4END=0
            MOVE      BQTFBU,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L117
          IF        CCPD4END=0
            MOVE      BQTSTD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L118
          IF        CCPD4END=0
            MOVE      CCPDGCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L119
          IF        CCPD4END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L120
          IF        CCPD4END=0
            MOVE      CCPDSTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L121
          IF        CCPD4END=0
            MOVE      VQTYAB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L122
          IF        CCPD4END=0
            MOVE      PVQTYAB,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L123
          IF        CCPD4END=0
            MOVE      VUCAB,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L124
          IF        CCPD4END=0
            MOVE      VUCAF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L125
          IF        CCPD4END=0
            MOVE      VUCAS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L126
          IF        CCPD4END=0
            MOVE      VUCAC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L127
          IF        CCPD4END=0
            MOVE      VUCBF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L128
          IF        CCPD4END=0
            MOVE      VUCBS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L129
          IF        CCPD4END=0
            MOVE      VUCBC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L130
          IF        CCPD4END=0
            MOVE      VUCFS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L131
          IF        CCPD4END=0
            MOVE      VUCFC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L132
          IF        CCPD4END=0
            MOVE      VUCSC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L133
          IF        CCPD4END=0
            MOVE      PVUCAB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L134
          IF        CCPD4END=0
            MOVE      PVUCAF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L135
          IF        CCPD4END=0
            MOVE      PVUCAS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L136
          IF        CCPD4END=0
            MOVE      PVUCAC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L137
          IF        CCPD4END=0
            MOVE      PVUCBF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L138
          IF        CCPD4END=0
            MOVE      PVUCBS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L139
          IF        CCPD4END=0
            MOVE      PVUCBC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L140
          IF        CCPD4END=0
            MOVE      PVUCFS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L141
          IF        CCPD4END=0
            MOVE      PVUCFC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L142
          IF        CCPD4END=0
            MOVE      PVUCSC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L143
          IF        CCPD4END=0
            MOVE      VTCAB,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L144
          IF        CCPD4END=0
            MOVE      VTCAF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L145
          IF        CCPD4END=0
            MOVE      VTCAS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L146
          IF        CCPD4END=0
            MOVE      VTCAC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L147
          IF        CCPD4END=0
            MOVE      VTCBF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L148
          IF        CCPD4END=0
            MOVE      VTCBS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L149
          IF        CCPD4END=0
            MOVE      VTCBC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L150
          IF        CCPD4END=0
            MOVE      VTCFS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L151
          IF        CCPD4END=0
            MOVE      VTCFC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L152
          IF        CCPD4END=0
            MOVE      VTCSC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L153
          IF        CCPD4END=0
            MOVE      PVTCAB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L154
          IF        CCPD4END=0
            MOVE      PVTCAF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L155
          IF        CCPD4END=0
            MOVE      PVTCAS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L156
          IF        CCPD4END=0
            MOVE      PVTCAC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L157
          IF        CCPD4END=0
            MOVE      PVTCBF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L158
          IF        CCPD4END=0
            MOVE      PVTCBS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L159
          IF        CCPD4END=0
            MOVE      PVTCBC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L160
          IF        CCPD4END=0
            MOVE      PVTCFS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L161
          IF        CCPD4END=0
            MOVE      PVTCFC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
.
DPP1L162
          IF        CCPD4END=0
            MOVE      PVTCSC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPP1L010
DPP1L600
          MATCH    "CCPD4",NAMSSFFI
          GOTO     DPP1L605 IF NOT EQUAL
          GOTO     DPP1L999
DPP1L605
DPP1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPP1L000
.
          MATCH    "CCPD4",NAMSSFFI
          GOTO     FPP1L105 IF NOT EQUAL
          PACK     KEY21,CCPD4SKY,SP70
          CALL     RDCCPD4  * Start
          IF       OVRCD=0
            CALL     RPCCPD4  * Start
          ENDIF
          CALL     DPP1L000
          GOTO     FPP1L999
FPP1L105
FPP1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPP1L000
.
          MATCH    "CCPD4",NAMSSFFI
          GOTO     LPP1L105 IF NOT EQUAL
          PACK     KEY21,CCPD4SKY,Z70
          CALL     RSCCPD4  * End
          IF       OVRCD=1
            CALL     RPCCPD4 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPD4SNO
            CALL     RPCCPD4 
            IF       OVRCD=1
              MOVE     CCPD4SNO,SECTOR
            ENDIF
            PACK     CCPD4MKY,CCPDHCD,CCPDDPT,CCPDSEQ,CCPDPCD                                                
            MATCH    CCPD4EKY,CCPD4MKY
            IF       !@EQUAL
              MOVE     CCPD4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPP1L000
          GOTO     LPP1L999
LPP1L105
LPP1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPP1L000
.
          MATCH    "CCPD4",NAMSSFFI
          GOTO     PPP1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPP1L105
          CALL      RFTCCPD4
          BRANCH   OVRCD,PPP1L115
          MOVE      CCPD4MKY,KEY21 
          CALL      RSCCPD4 
PPP1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCPD4SNO
            CALL     RPCCPD4 
            IF       OVRCD=1
              MOVE     CCPD4SNO,SECTOR
            ENDIF
            PACK     CCPD4MKY,CCPDHCD,CCPDDPT,CCPDSEQ,CCPDPCD                                                
            MATCH    CCPD4EKY,CCPD4MKY
            IF       !@EQUAL
              MOVE     CCPD4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPP1L000
          GOTO     PPP1L999
PPP1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPD4SNO
            CALL     RKCCPD4 
            IF       OVRCD=1
              MOVE     CCPD4SNO,SECTOR
            ENDIF
            PACK     CCPD4MKY,CCPDHCD,CCPDDPT,CCPDSEQ,CCPDPCD                                                
            MATCH    CCPD4EKY,CCPD4MKY
            IF       !@EQUAL
              MOVE     CCPD4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPP1L999
PPP1L120
PPP1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPP1L000
          MATCH    "CCPD4",NAMSSFFI
          GOTO     NPP1L115 IF NOT EQUAL
NPP1L105
          CALL     RKCCPD4 
          BRANCH   OVRCD,NPP1L110
          PACK     CCPD4MKY,CCPDHCD,CCPDDPT,CCPDSEQ,CCPDPCD                                                
          MATCH    CCPD4EKY,CCPD4MKY
          GOTO     NPP1L110 IF NOT EQUAL
          CALL     RPCCPD4 
          CALL     DPP1L000
          GOTO     NPP1L999
NPP1L110
          CALL     RPCCPD4 
          BEEP
          GOTO     NPP1L999
NPP1L115
NPP1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTP1L000
CTP1L105
CTP1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Production Analysis                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    21 Patient Service Selection          
.---------------------------------------------------------
UPTCCPD4
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCPD4FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCPD4FL1,KEY5;SCPSROW,SCPSCOL,CCPD4MKY
          ELSE
            UPDATE    CCPD4FL1;SCPSROW,SCPSCOL,CCPD4MKY
          ENDIF
          RETURN
RDTCCPD4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCPD4FL1,KEY5;SCPSROW,SCPSCOL,CCPD4MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCPD4
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCPD4FL1,KEY5;;
          READKS    CCPD4FL1;SCPSROW,SCPSCOL,CCPD4MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCPD4MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Production Analysis                
.---------------------------------------------------------
DFP1L000
          BRANCH   ACCEPT,DFP1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFP1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFP1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFP1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFP1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFP1L010 IF NOT EQUAL
.
          CALL     PSP1L000 * Display Field
          GOTO     DFP1L010
DFP1L900
          MOVE      "CCPD4",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      FPP1L000
DFP1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Production Analysis                
.---------------------------------------------------------
PSP1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSP1L101,PSP1L102,PSP1L103,PSP1L104:
                            PSP1L105,PSP1L106,PSP1L107,PSP1L108:
                            PSP1L109,PSP1L110,PSP1L111,PSP1L112:
                            PSP1L113,PSP1L999,PSP1L114,PSP1L115:
                            PSP1L116,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                           PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                           PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999,PSP1L999,PSP1L999,PSP1L999:
                            PSP1L999
          GOTO     PSP1L999
.
PSP1L101
          MOVE      CCSDHCD,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L102
          MOVE      CCSDDPT,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L103
          MOVE      CCSDYEAR,VAR     
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L104
          MOVE      CCSDPER,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L105
          MOVE      CCSDDIR,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L106
          MOVE      CCMCDIR,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L107
          MOVE      CCSDIND,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L108
          MOVE      CCMCIND,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L109
          MOVE      CCMCFLX,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L110
          MOVE      CCSDSTD,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L111
          MOVE      CCSDCHG,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L112
          MOVE      TOTACT,VAR       
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L113
          MOVE      TOTBUD,VAR       
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L114
          MOVE      CCCADES,VAR      
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L115
          UNPACK    CCCAFDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSP1L999
.
PSP1L116
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSP1L999
PSP1L999
          RETURN
.---------------------------------------------------------
. Selections for : Production Analysis                
.---------------------------------------------------------
SFP1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFP1L001  BRANCH   ACCEPT,SFP1L020
.
SFP1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L101,SFP1L102,SFP1L103:
                            SFP1L104,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                            SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                           SFP1L006,SFP1L006,SFP1L006,SFP1L006:
                           SFP1L105,SFP1L106,SFP1L107,SFP1L108:
                            SFP1L109,SFP1L006,SFP1L006,SFP1L110:
                            SFP1L111
SFP1L006  BEEP
          GOTO     SFP1L005
SFP1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFP1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFP1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFP1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L104,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                           SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                           SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020,SFP1L020,SFP1L020,SFP1L020:
                            SFP1L020
          GOTO     SFP1L020
SFP1L090  MOVE     ZERO,ACCEPT
          MOVE      "CCPD4",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      FPP1L000
          GOTO     SFP1L001
.
SFP1L101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFP1L999
.
SFP1L102
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFP1L999
.
SFP1L103
          CALL      EXITSET1
          MOVE      ZERO,EXIT
          GOTO      SFP1L999
.
SFP1L104
          CALL      SELECTED
          BRANCH    EXIT,SFP1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFP1L001 IF EQUAL
          CALL      RDTCCPD4
          IF        OVRCD=1
            BEEP
            GOTO      SFP1L001
          ENDIF
          MATCH     SP70,CCPD4MKY
          IF        @EQUAL
            BEEP
            GOTO      SFP1L001
          ENDIF
          MOVE      CCPD4MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      CC37R000
          MOVE      "P1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCPD4
          IF        OVRCD=1
            CALL      FPP1L000
          ELSE
            MOVE      CCPD4MKY,KEY21 
            CALL      RSCCPD4 
            CALL      RPCCPD4 
            CALL      DPP1L000
          ENDIF
          GOTO     SFP1L001
.
SFP1L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCPGL000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFP1L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFP1L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFP1L999
          ENDIF
          MOVE      "P1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFP1L000
          ENDIF
          GOTO      SFP1L001
.
SFP1L106
          CALL      CC37F000
          MOVE      ONE,EXIT
          GOTO      SFP1L999
.
SFP1L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCP2L000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFP1L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFP1L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFP1L999
          ENDIF
          MOVE      "P1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFP1L000
          ENDIF
          GOTO      SFP1L001
.
SFP1L108
          MOVE      "CCPD4",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      NPP1L000
          GOTO     SFP1L001
.
SFP1L109
          MOVE      "CCPD4",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      PPP1L000
          GOTO     SFP1L001
.
SFP1L110
          MOVE      "CCPD4",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      FPP1L000
          GOTO     SFP1L001
.
SFP1L111
          MOVE      "CCPD4",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      LPP1L000
          GOTO     SFP1L001
SFP1L990  MOVE      ONE,EXIT * Exit Char Restart
SFP1L999  RETURN
.--------------------------------
. Screen - Alternate Patient Service Analysis 
.--------------------------------
SCP2L000
SCP2L100
          MOVE      "P2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCP2L200
          CALL      CFP2L000 * Clear Fields
SCP2L300
          CALL      KYP2L000 * Enter Key Fields
          BRANCH    EXIT,SCP2L999,SCP2L999
SCP2L400
          CALL      WPP2L000 * Load any WP Details
SCP2L500
          CALL      LMP2L000 * Load any Batch Details
SCP2L600
          CALL      DFP2L000 * Display Fields
SCP2L700
          CALL      SFP2L000 * Select Fields
          BRANCH    EXIT,SCP2L100,SCP2L100,SCP2L200
SCP2L800
          CALL      EXITSETF
SCP2L900
SCP2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Alternate Patient Service Analysis 
.-------------------------------------------------------
CFP2L000  COMPARE   ZERO,ACCEPT
              GOTO      CFP2L999 IF EQUAL
CFP2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Alternate Patient Service Analysis 
.--------------------------------------------------------
KYP2L000
          MOVE      ZERO,EXIT
          GOTO      KYP2L999
.
KYP2L900  MOVE      ONE,EXIT
KYP2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Alternate Patient Service Analysis 
.---------------------------------------------------------
WPP2L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Alternate Patient Service Analysis 
.---------------------------------------------------------
LMP2L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Alternate Patient Service Analysis 
.---------------------------------------------------------
DFP2L000
          BRANCH   ACCEPT,DFP2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFP2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFP2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFP2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFP2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFP2L010 IF NOT EQUAL
.
          CALL     PSP2L000 * Display Field
          GOTO     DFP2L010
DFP2L900
DFP2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Alternate Patient Service Analysis 
.---------------------------------------------------------
PSP2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSP2L999,PSP2L999
          GOTO     PSP2L999
PSP2L999
          RETURN
.---------------------------------------------------------
. Selections for : Alternate Patient Service Analysis 
.---------------------------------------------------------
SFP2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFP2L001  BRANCH   ACCEPT,SFP2L020
.
SFP2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFP2L006,SFP2L101
SFP2L006  BEEP
          GOTO     SFP2L005
SFP2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFP2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFP2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFP2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFP2L020,SFP2L020
          GOTO     SFP2L020
SFP2L090  MOVE     ZERO,ACCEPT
          GOTO     SFP2L001
.
SFP2L101
          MOVE      ZERO,EXIT
          GOTO      SFP2L999
SFP2L990  MOVE      ONE,EXIT * Exit Char Restart
SFP2L999  RETURN
.--------------------------------
. Screen - Patient Service Cost Type Analysis 
.--------------------------------
SCPCL000
SCPCL100
          MOVE      "PC",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPCL200
          CALL      CFPCL000 * Clear Fields
SCPCL300
          CALL      KYPCL000 * Enter Key Fields
          BRANCH    EXIT,SCPCL999,SCPCL999
SCPCL400
          CALL      WPPCL000 * Load any WP Details
SCPCL500
          CALL      LMPCL000 * Load any Batch Details
SCPCL600
          CALL      DFPCL000 * Display Fields
SCPCL700
          CALL      SFPCL000 * Select Fields
          BRANCH    EXIT,SCPCL100,SCPCL100,SCPCL200
SCPCL800
          CALL      EXITSETF
SCPCL900
SCPCL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Cost Type Analysis 
.-------------------------------------------------------
CFPCL000  COMPARE   ZERO,ACCEPT
              GOTO      CFPCL999 IF EQUAL
CFPCL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Cost Type Analysis 
.--------------------------------------------------------
KYPCL000
          MOVE      ZERO,EXIT
          GOTO      KYPCL999
.
KYPCL900  MOVE      ONE,EXIT
KYPCL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Cost Type Analysis 
.---------------------------------------------------------
WPPCL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Cost Type Analysis 
.---------------------------------------------------------
LMPCL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Cost Type Analysis 
.---------------------------------------------------------
DFPCL000
          BRANCH   ACCEPT,DFPCL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPCL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPCL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPCL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPCL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPCL010 IF NOT EQUAL
.
          CALL     PSPCL000 * Display Field
          GOTO     DFPCL010
DFPCL900
DFPCL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Cost Type Analysis 
.---------------------------------------------------------
PSPCL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPCL999,PSPCL999
          GOTO     PSPCL999
PSPCL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Cost Type Analysis 
.---------------------------------------------------------
SFPCL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPCL001  BRANCH   ACCEPT,SFPCL020
.
SFPCL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPCL006,SFPCL101
SFPCL006  BEEP
          GOTO     SFPCL005
SFPCL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPCL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPCL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPCL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPCL020,SFPCL020
          GOTO     SFPCL020
SFPCL090  MOVE     ZERO,ACCEPT
          GOTO     SFPCL001
.
SFPCL101
          MOVE      ZERO,EXIT
          GOTO      SFPCL999
SFPCL990  MOVE      ONE,EXIT * Exit Char Restart
SFPCL999  RETURN
.--------------------------------
. Screen - Patient Service Graph Options      
.--------------------------------
SCPGL000
SCPGL100
          MOVE      "PG",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      " 39",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPGL200
          CALL      CFPGL000 * Clear Fields
SCPGL300
          CALL      KYPGL000 * Enter Key Fields
          BRANCH    EXIT,SCPGL999,SCPGL999
SCPGL400
          CALL      WPPGL000 * Load any WP Details
SCPGL500
          CALL      LMPGL000 * Load any Batch Details
SCPGL600
          CALL      DFPGL000 * Display Fields
SCPGL700
          CALL      SFPGL000 * Select Fields
          BRANCH    EXIT,SCPGL100,SCPGL100,SCPGL200
SCPGL800
          CALL      EXITSETF
SCPGL900
SCPGL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Graph Options      
.-------------------------------------------------------
CFPGL000
CFPGL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Graph Options      
.--------------------------------------------------------
KYPGL000
          MOVE      ZERO,EXIT
          GOTO      KYPGL999
.
KYPGL900  MOVE      ONE,EXIT
KYPGL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Graph Options      
.---------------------------------------------------------
WPPGL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Graph Options      
.---------------------------------------------------------
LMPGL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Graph Options      
.---------------------------------------------------------
DFPGL000
          BRANCH   ACCEPT,DFPGL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPGL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPGL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPGL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPGL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPGL010 IF NOT EQUAL
.
          CALL     PSPGL000 * Display Field
          GOTO     DFPGL010
DFPGL900
DFPGL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Graph Options      
.---------------------------------------------------------
PSPGL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPGL999,PSPGL999,PSPGL999,PSPGL999:
                            PSPGL101,PSPGL102,PSPGL103,PSPGL104:
                            PSPGL105,PSPGL106,PSPGL107,PSPGL108:
                            PSPGL109,PSPGL110,PSPGL111,PSPGL112:
                            PSPGL113,PSPGL114,PSPGL115,PSPGL116
          GOTO     PSPGL999
.
PSPGL101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPQTY,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBQT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPACT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBUD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPFBU,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPSTD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPCHG,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPTCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
.
PSPGL116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPGL999
PSPGL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Graph Options      
.---------------------------------------------------------
SFPGL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPGL001  BRANCH   ACCEPT,SFPGL020
.
SFPGL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPGL006,SFPGL101,SFPGL102,SFPGL103:
                            SFPGL104,SFPGL105,SFPGL106,SFPGL107:
                            SFPGL108,SFPGL109,SFPGL110,SFPGL111:
                            SFPGL112,SFPGL113,SFPGL114,SFPGL115:
                            SFPGL116,SFPGL117,SFPGL118,SFPGL119
SFPGL006  BEEP
          GOTO     SFPGL005
SFPGL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPGL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPGL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPGL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPGL020,SFPGL020,SFPGL020,SFPGL020:
                            SFPGL104,SFPGL105,SFPGL106,SFPGL107:
                            SFPGL108,SFPGL109,SFPGL110,SFPGL111:
                            SFPGL112,SFPGL113,SFPGL114,SFPGL115:
                            SFPGL116,SFPGL117,SFPGL118,SFPGL119
          GOTO     SFPGL020
SFPGL090  MOVE     ZERO,ACCEPT
          GOTO     SFPGL001
.
SFPGL101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFPGL999
.
SFPGL102
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFPGL999
.
SFPGL103
          CALL      GPHPG000
          GOTO      SFPGL001
.
SFPGL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPQTY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL104
            ENDIF
            BRANCH    EXIT,SFPGL104,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPQTY,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBQT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL105
            ENDIF
            BRANCH    EXIT,SFPGL105,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBQT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPACT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL106
            ENDIF
            BRANCH    EXIT,SFPGL106,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPACT,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBUD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL107
            ENDIF
            BRANCH    EXIT,SFPGL107,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBUD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPFBU000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL108
            ENDIF
            BRANCH    EXIT,SFPGL108,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPFBU,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPSTD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL109
            ENDIF
            BRANCH    EXIT,SFPGL109,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPSTD,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPCHG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL110
            ENDIF
            BRANCH    EXIT,SFPGL110,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPCHG,FORM2      
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL111
            ENDIF
            BRANCH    EXIT,SFPGL111,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL112
            ENDIF
            BRANCH    EXIT,SFPGL112,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL113
            ENDIF
            BRANCH    EXIT,SFPGL113,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPAS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL114
            ENDIF
            BRANCH    EXIT,SFPGL114,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPAS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPTCHG00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL115
            ENDIF
            BRANCH    EXIT,SFPGL115,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPTCHG,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL116
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL116
            ENDIF
            BRANCH    EXIT,SFPGL116,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBA,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL117
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL117
            ENDIF
            BRANCH    EXIT,SFPGL117,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBB,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL118
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL118
            ENDIF
            BRANCH    EXIT,SFPGL118,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBF,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
.
SFPGL119
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPBS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPGL119
            ENDIF
            BRANCH    EXIT,SFPGL119,SFPGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPBS,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFPGL001
SFPGL990  MOVE      ONE,EXIT * Exit Char Restart
SFPGL999  RETURN
.--------------------------------
. Screen - Patient Service Period Analysis    
.--------------------------------
SCPPL000
SCPPL100
          MOVE      "PP",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPPL200
          CALL      CFPPL000 * Clear Fields
SCPPL300
          CALL      KYPPL000 * Enter Key Fields
          BRANCH    EXIT,SCPPL999,SCPPL999
SCPPL400
          CALL      WPPPL000 * Load any WP Details
SCPPL500
          CALL      LMPPL000 * Load any Batch Details
SCPPL600
          CALL      DFPPL000 * Display Fields
SCPPL700
          CALL      SFPPL000 * Select Fields
          BRANCH    EXIT,SCPPL100,SCPPL100,SCPPL200
SCPPL800
          CALL      EXITSETF
SCPPL900
SCPPL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Period Analysis    
.-------------------------------------------------------
CFPPL000  COMPARE   ZERO,ACCEPT
              GOTO      CFPPL999 IF EQUAL
          MOVE      SP70,CCSDHCD 
          MOVE      SP70,CCSDDPT 
          MOVE      SP70,CCSDYEAR
          MOVE      SP70,CCSDPER 
          MOVE      ZERO,CCSDDIR 
          MOVE      ZERO,CCMCDIR 
          MOVE      ZERO,CCSDIND 
          MOVE      ZERO,CCMCIND 
          MOVE      ZERO,CCMCFLX 
          MOVE      ZERO,CCSDSTD 
          MOVE      ZERO,CCSDCHG 
          MOVE      ZERO,TOTACT  
          MOVE      ZERO,TOTBUD  
          MOVE      SP70,CCCADES 
          MOVE      SP70,CCCAFDT 
          MOVE      SP70,CCCATDT 
          MOVE      SP70,CCPSPCD 
          MOVE      SP70,CCPDDES 
          MOVE      SP70,CCCAPER 
          MOVE      SP70,PERDESC 
          MOVE      ZERO,CCPSQTY 
          MOVE      ZERO,CCMEQTY 
          MOVE      ZERO,CCPSCST 
          MOVE      ZERO,CCMECST 
          MOVE      ZERO,CCMEFLX 
          MOVE      ZERO,CCPSSCT 
          MOVE      ZERO,CCPSCHG 
          MOVE      ZERO,AVECHG  
          MOVE      ZERO,AQTACT  
          MOVE      ZERO,AQTBUD  
          MOVE      ZERO,AQTFBU  
          MOVE      ZERO,AQTSTD  
          MOVE      ZERO,BQTACT  
          MOVE      ZERO,BQTBUD  
          MOVE      ZERO,BQTFBU  
          MOVE      ZERO,BQTSTD  
          MOVE      SP70,CCPDGCD 
          MOVE      ZERO,CCPDSTC 
          MOVE      ZERO,VQTYAB  
          MOVE      ZERO,PVQTYAB 
          MOVE      ZERO,VUCAB   
          MOVE      ZERO,VUCAF   
          MOVE      ZERO,VUCAS   
          MOVE      ZERO,VUCAC   
          MOVE      ZERO,VUCBF   
          MOVE      ZERO,VUCBS   
          MOVE      ZERO,VUCBC   
          MOVE      ZERO,VUCFS   
          MOVE      ZERO,VUCFC   
          MOVE      ZERO,VUCSC   
          MOVE      ZERO,PVUCAB  
          MOVE      ZERO,PVUCAF  
          MOVE      ZERO,PVUCAS  
          MOVE      ZERO,PVUCAC  
          MOVE      ZERO,PVUCBF  
          MOVE      ZERO,PVUCBS  
          MOVE      ZERO,PVUCBC  
          MOVE      ZERO,PVUCFS  
          MOVE      ZERO,PVUCFC  
          MOVE      ZERO,PVUCSC  
          MOVE      ZERO,VTCAB   
          MOVE      ZERO,VTCAF   
          MOVE      ZERO,VTCAS   
          MOVE      ZERO,VTCAC   
          MOVE      ZERO,VTCBF   
          MOVE      ZERO,VTCBS   
          MOVE      ZERO,VTCBC   
          MOVE      ZERO,VTCFS   
          MOVE      ZERO,VTCFC   
          MOVE      ZERO,VTCSC   
          MOVE      ZERO,PVTCAB  
          MOVE      ZERO,PVTCAF  
          MOVE      ZERO,PVTCAS  
          MOVE      ZERO,PVTCAC  
          MOVE      ZERO,PVTCBF  
          MOVE      ZERO,PVTCBS  
          MOVE      ZERO,PVTCBC  
          MOVE      ZERO,PVTCFS  
          MOVE      ZERO,PVTCFC  
          MOVE      ZERO,PVTCSC  
CFPPL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Period Analysis    
.--------------------------------------------------------
KYPPL000
          MOVE      ZERO,EXIT
          GOTO      KYPPL999
.
KYPPL900  MOVE      ONE,EXIT
KYPPL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Period Analysis    
.---------------------------------------------------------
WPPPL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Period Analysis    
.---------------------------------------------------------
LMPPL000
.---------------------------------------------------------
. Load for :    20 Period                             
.---------------------------------------------------------
          PACK      KEY6,CCCOYEAR,SP70
          MOVE      KEY6,CCCA1EKY
          MOVE      CCCA1EKY,CCCA1SKY
          STRIP     CCCA1SKY
          SETLPTR   CCCA1EKY,4
          CALL      RDCCCA1 
          IF        OVRCD=0
            CALL      RPCCCA1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPPPL000
          MOVE     ZERO,CCCA1CNT
          MOVE     ZERO,CCCA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPPPL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPPPL600
          MATCH    PRGID,SCPSPID
          GOTO     DPPPL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPPPL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPPPL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPPPL010,DPPPL010,DPPPL010,DPPPL010:
                            DPPPL010,DPPPL010,DPPPL010,DPPPL010:
                            DPPPL010,DPPPL010,DPPPL010,DPPPL010:
                            DPPPL010,DPPPL010,DPPPL010,DPPPL010:
                            DPPPL010,DPPPL010,DPPPL010,DPPPL101:
                            DPPPL102,DPPPL103,DPPPL104,DPPPL105:
                            DPPPL106,DPPPL107,DPPPL108,DPPPL109:
                            DPPPL110,DPPPL111,DPPPL112,DPPPL113:
                            DPPPL114,DPPPL115,DPPPL116,DPPPL117:
                            DPPPL118,DPPPL010,DPPPL010,DPPPL010:
                            DPPPL119,DPPPL120,DPPPL121,DPPPL122:
                            DPPPL123,DPPPL124,DPPPL125,DPPPL126:
                            DPPPL127,DPPPL128,DPPPL129,DPPPL130:
                            DPPPL131,DPPPL132,DPPPL133,DPPPL134:
                            DPPPL135,DPPPL136,DPPPL137,DPPPL138:
                            DPPPL139,DPPPL140,DPPPL141,DPPPL142:
                            DPPPL143,DPPPL144,DPPPL145,DPPPL146:
                            DPPPL147,DPPPL148,DPPPL149,DPPPL150:
                            DPPPL151,DPPPL152,DPPPL153,DPPPL154:
                            DPPPL155,DPPPL156,DPPPL157,DPPPL158:
                            DPPPL159,DPPPL160,DPPPL010,DPPPL010:
                            DPPPL010,DPPPL010,DPPPL010,DPPPL010:
                            DPPPL010,DPPPL010,DPPPL010
          GOTO      DPPPL010
.
DPPPL101
          IF        CCCA1END=0
            CALL      RPCCCA1 
            IF        OVRCD=0
              PACK      CCCA1MKY,CCCAYEAR,CCCAPER                                                               
              MATCH     CCCA1EKY,CCCA1MKY
              IF        @EQUAL
                MOVE      ZERO,CCCA1END
                ADD       ONE,CCCA1CNT
                MOVE      CCCAPER,VAR      
                CALL      DISPITEM
          CALL      CC37N000
              ELSE
                MOVE      ONE,CCCA1END
              ENDIF
            ELSE
              MOVE      ONE,CCCA1END
            ENDIF
          ENDIF
          IF        CCCA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL102
          IF        CCCA1END=0
            MOVE      PERDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL103
          IF        CCCA1END=0
            MOVE      CCPSQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL104
          IF        CCCA1END=0
            MOVE      CCMEQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL105
          IF        CCCA1END=0
            MOVE      CCPSCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL106
          IF        CCCA1END=0
            MOVE      CCMECST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL107
          IF        CCCA1END=0
            MOVE      CCMEFLX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL108
          IF        CCCA1END=0
            MOVE      CCPSSCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL109
          IF        CCCA1END=0
            MOVE      CCPSCHG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL110
          IF        CCCA1END=0
            MOVE      AVECHG,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL111
          IF        CCCA1END=0
            MOVE      AQTACT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL112
          IF        CCCA1END=0
            MOVE      AQTBUD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL113
          IF        CCCA1END=0
            MOVE      AQTFBU,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL114
          IF        CCCA1END=0
            MOVE      AQTSTD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL115
          IF        CCCA1END=0
            MOVE      BQTACT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL116
          IF        CCCA1END=0
            MOVE      BQTBUD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL117
          IF        CCCA1END=0
            MOVE      BQTFBU,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL118
          IF        CCCA1END=0
            MOVE      BQTSTD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL119
          IF        CCCA1END=0
            MOVE      VQTYAB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL120
          IF        CCCA1END=0
            MOVE      PVQTYAB,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL121
          IF        CCCA1END=0
            MOVE      VUCAB,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL122
          IF        CCCA1END=0
            MOVE      VUCAF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL123
          IF        CCCA1END=0
            MOVE      VUCAS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL124
          IF        CCCA1END=0
            MOVE      VUCAC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL125
          IF        CCCA1END=0
            MOVE      VUCBF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL126
          IF        CCCA1END=0
            MOVE      VUCBS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL127
          IF        CCCA1END=0
            MOVE      VUCBC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL128
          IF        CCCA1END=0
            MOVE      VUCFS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL129
          IF        CCCA1END=0
            MOVE      VUCFC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL130
          IF        CCCA1END=0
            MOVE      VUCSC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL131
          IF        CCCA1END=0
            MOVE      PVUCAB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL132
          IF        CCCA1END=0
            MOVE      PVUCAF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL133
          IF        CCCA1END=0
            MOVE      PVUCAS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL134
          IF        CCCA1END=0
            MOVE      PVUCAC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL135
          IF        CCCA1END=0
            MOVE      PVUCBF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL136
          IF        CCCA1END=0
            MOVE      PVUCBS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL137
          IF        CCCA1END=0
            MOVE      PVUCBC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL138
          IF        CCCA1END=0
            MOVE      PVUCFS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL139
          IF        CCCA1END=0
            MOVE      PVUCFC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL140
          IF        CCCA1END=0
            MOVE      PVUCSC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL141
          IF        CCCA1END=0
            MOVE      VTCAB,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL142
          IF        CCCA1END=0
            MOVE      VTCAF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL143
          IF        CCCA1END=0
            MOVE      VTCAS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL144
          IF        CCCA1END=0
            MOVE      VTCAC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL145
          IF        CCCA1END=0
            MOVE      VTCBF,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL146
          IF        CCCA1END=0
            MOVE      VTCBS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL147
          IF        CCCA1END=0
            MOVE      VTCBC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL148
          IF        CCCA1END=0
            MOVE      VTCFS,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL149
          IF        CCCA1END=0
            MOVE      VTCFC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL150
          IF        CCCA1END=0
            MOVE      VTCSC,VAR        
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL151
          IF        CCCA1END=0
            MOVE      PVTCAB,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL152
          IF        CCCA1END=0
            MOVE      PVTCAF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL153
          IF        CCCA1END=0
            MOVE      PVTCAS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL154
          IF        CCCA1END=0
            MOVE      PVTCAC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL155
          IF        CCCA1END=0
            MOVE      PVTCBF,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL156
          IF        CCCA1END=0
            MOVE      PVTCBS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL157
          IF        CCCA1END=0
            MOVE      PVTCBC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL158
          IF        CCCA1END=0
            MOVE      PVTCFS,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL159
          IF        CCCA1END=0
            MOVE      PVTCFC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
.
DPPPL160
          IF        CCCA1END=0
            MOVE      PVTCSC,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPPL010
DPPPL600
          MATCH    "CCCA1",NAMSSFFI
          GOTO     DPPPL605 IF NOT EQUAL
          GOTO     DPPPL999
DPPPL605
DPPPL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPPPL000
.
          MATCH    "CCCA1",NAMSSFFI
          GOTO     FPPPL105 IF NOT EQUAL
          PACK     KEY6,CCCA1SKY,Z70
          CALL     RDCCCA1  * Start
          IF       OVRCD=0
            CALL     RPCCCA1  * Start
          ENDIF
          CALL     DPPPL000
          GOTO     FPPPL999
FPPPL105
FPPPL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPPPL000
.
          MATCH    "CCCA1",NAMSSFFI
          GOTO     LPPPL105 IF NOT EQUAL
          PACK     KEY6,CCCA1SKY,SP70
          CALL     RSCCCA1  * End
          IF       OVRCD=1
            CALL     RKCCCA1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCCA1SNO
            CALL     RKCCCA1 
            IF       OVRCD=1
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
            MATCH    CCCA1EKY,CCCA1MKY
            IF       !@EQUAL
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPPPL000
          GOTO     LPPPL999
LPPPL105
LPPPL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPPPL000
.
          MATCH    "CCCA1",NAMSSFFI
          GOTO     PPPPL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPPPL105
          COMPARE  SECTOR,CCCA1SNO
          GOTO     PPPPL110 IF EQUAL
          CALL     RKCCCA1 
          BRANCH   OVRCD,PPPPL115
          PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
          MATCH    CCCA1EKY,CCCA1MKY
          GOTO     PPPPL115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PPPPL105
PPPPL110
          MOVE     ZERO,SECTOR
          IF       CCCA1CNT=CCCA1SNO
            SUB      ONE,CCCA1CNT
          ENDIF
          WHILE    SECTOR<=CCCA1CNT
            CALL     RKCCCA1 
            IF       OVRCD=1
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
            MATCH    CCCA1EKY,CCCA1MKY
            IF       !@EQUAL
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPPPL000
          GOTO     PPPPL999
PPPPL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCCA1SNO
            CALL     RPCCCA1 
            IF       OVRCD=1
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
            MATCH    CCCA1EKY,CCCA1MKY
            IF       !@EQUAL
              MOVE     CCCA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPPPL999
PPPPL120
PPPPL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPPPL000
          MATCH    "CCCA1",NAMSSFFI
          GOTO     NPPPL115 IF NOT EQUAL
NPPPL105
          CALL     RPCCCA1 
          BRANCH   OVRCD,NPPPL110
          PACK     CCCA1MKY,CCCAYEAR,CCCAPER                                                               
          MATCH    CCCA1EKY,CCCA1MKY
          GOTO     NPPPL110 IF NOT EQUAL
          CALL     RKCCCA1 
          CALL     DPPPL000
          GOTO     NPPPL999
NPPPL110
          CALL     RKCCCA1 
          BEEP
          GOTO     NPPPL999
NPPPL115
NPPPL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTPPL000
CTPPL105
CTPPL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Patient Service Period Analysis    
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Patient Service Period Analysis    
.---------------------------------------------------------
DFPPL000
          BRANCH   ACCEPT,DFPPL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPPL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPPL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPPL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPPL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPPL010 IF NOT EQUAL
.
          CALL     PSPPL000 * Display Field
          GOTO     DFPPL010
DFPPL900
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FPPPL000
DFPPL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Period Analysis    
.---------------------------------------------------------
PSPPL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPPL101,PSPPL102,PSPPL103,PSPPL104:
                            PSPPL105,PSPPL106,PSPPL107,PSPPL108:
                            PSPPL109,PSPPL110,PSPPL111,PSPPL112:
                            PSPPL113,PSPPL999,PSPPL114,PSPPL115:
                            PSPPL116,PSPPL117,PSPPL118,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL119,PSPPL999,PSPPL120:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999,PSPPL999:
                            PSPPL999,PSPPL999,PSPPL999
          GOTO     PSPPL999
.
PSPPL101
          MOVE      CCSDHCD,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL102
          MOVE      CCSDDPT,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL103
          MOVE      CCSDYEAR,VAR     
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL104
          MOVE      CCSDPER,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL105
          MOVE      CCSDDIR,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL106
          MOVE      CCMCDIR,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL107
          MOVE      CCSDIND,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL108
          MOVE      CCMCIND,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL109
          MOVE      CCMCFLX,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL110
          MOVE      CCSDSTD,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL111
          MOVE      CCSDCHG,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL112
          MOVE      TOTACT,VAR       
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL113
          MOVE      TOTBUD,VAR       
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL114
          MOVE      CCCADES,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL115
          UNPACK    CCCAFDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL116
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL117
          MOVE      CCPSPCD,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL118
          MOVE      CCPDDES,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL119
          MOVE      CCPDGCD,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
.
PSPPL120
          MOVE      CCPDSTC,VAR      
          CALL      DISPITEM
          GOTO     PSPPL999
PSPPL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Period Analysis    
.---------------------------------------------------------
SFPPL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPPL001  BRANCH   ACCEPT,SFPPL020
.
SFPPL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL006,SFPPL006:
                            SFPPL006,SFPPL006,SFPPL101,SFPPL102:
                            SFPPL103,SFPPL104,SFPPL105,SFPPL106:
                            SFPPL107,SFPPL108,SFPPL109
SFPPL006  BEEP
          GOTO     SFPPL005
SFPPL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPPL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPPL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPPL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020,SFPPL020:
                            SFPPL020,SFPPL020,SFPPL020
          GOTO     SFPPL020
SFPPL090  MOVE     ZERO,ACCEPT
          MOVE      "CCCA1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FPPPL000
          GOTO     SFPPL001
.
SFPPL101
          MOVE      "CCPS2",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      NPPPL000
          GOTO     SFPPL001
.
SFPPL102
          MOVE      "CCPS2",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      PPPPL000
          GOTO     SFPPL001
.
SFPPL103
          MOVE      "CCPS2",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FPPPL000
          GOTO     SFPPL001
.
SFPPL104
          MOVE      "CCPS2",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      LPPPL000
          GOTO     SFPPL001
.
SFPPL105
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFPPL999
.
SFPPL106
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFPPL999
.
SFPPL107
          CALL      EXITSET1
          MOVE      ZERO,EXIT
          GOTO      SFPPL999
.
SFPPL108
          CALL      EXITSET2
          MOVE      ZERO,EXIT
          GOTO      SFPPL999
.
SFPPL109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCGPL000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFPPL999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFPPL001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFPPL999
          ENDIF
          MOVE      "PP",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFPPL000
          ENDIF
          GOTO      SFPPL001
SFPPL990  MOVE      ONE,EXIT * Exit Char Restart
SFPPL999  RETURN
.--------------------------------
. Screen - Patient Service Usage              
.--------------------------------
SCPUL000
SCPUL100
          MOVE      "PU",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPUL200
          CALL      CFPUL000 * Clear Fields
SCPUL300
          CALL      KYPUL000 * Enter Key Fields
          BRANCH    EXIT,SCPUL999,SCPUL999
SCPUL400
          CALL      WPPUL000 * Load any WP Details
SCPUL500
          CALL      LMPUL000 * Load any Batch Details
SCPUL600
          CALL      DFPUL000 * Display Fields
SCPUL700
          CALL      SFPUL000 * Select Fields
          BRANCH    EXIT,SCPUL100,SCPUL100,SCPUL200
SCPUL800
          CALL      EXITSETF
SCPUL900
SCPUL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Usage              
.-------------------------------------------------------
CFPUL000  COMPARE   ZERO,ACCEPT
              GOTO      CFPUL999 IF EQUAL
CFPUL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Usage              
.--------------------------------------------------------
KYPUL000
          MOVE      ZERO,EXIT
          GOTO      KYPUL999
.
KYPUL900  MOVE      ONE,EXIT
KYPUL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Usage              
.---------------------------------------------------------
WPPUL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Usage              
.---------------------------------------------------------
LMPUL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Usage              
.---------------------------------------------------------
DFPUL000
          BRANCH   ACCEPT,DFPUL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPUL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPUL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPUL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPUL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPUL010 IF NOT EQUAL
.
          CALL     PSPUL000 * Display Field
          GOTO     DFPUL010
DFPUL900
DFPUL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Usage              
.---------------------------------------------------------
PSPUL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPUL999,PSPUL999
          GOTO     PSPUL999
PSPUL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Usage              
.---------------------------------------------------------
SFPUL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPUL001  BRANCH   ACCEPT,SFPUL020
.
SFPUL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPUL006,SFPUL101
SFPUL006  BEEP
          GOTO     SFPUL005
SFPUL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPUL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPUL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPUL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPUL020,SFPUL020
          GOTO     SFPUL020
SFPUL090  MOVE     ZERO,ACCEPT
          GOTO     SFPUL001
.
SFPUL101
          MOVE      ZERO,EXIT
          GOTO      SFPUL999
SFPUL990  MOVE      ONE,EXIT * Exit Char Restart
SFPUL999  RETURN
.--------------------------------
. Screen - Cost Type Graph Options            
.--------------------------------
SCTGL000
SCTGL100
          MOVE      "TG",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 40",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCTGL200
          CALL      CFTGL000 * Clear Fields
SCTGL300
          CALL      KYTGL000 * Enter Key Fields
          BRANCH    EXIT,SCTGL999,SCTGL999
SCTGL400
          CALL      WPTGL000 * Load any WP Details
SCTGL500
          CALL      LMTGL000 * Load any Batch Details
SCTGL600
          CALL      DFTGL000 * Display Fields
SCTGL700
          CALL      SFTGL000 * Select Fields
          BRANCH    EXIT,SCTGL100,SCTGL100,SCTGL200
SCTGL800
          CALL      EXITSETF
SCTGL900
SCTGL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Type Graph Options            
.-------------------------------------------------------
CFTGL000
CFTGL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Type Graph Options            
.--------------------------------------------------------
KYTGL000
          MOVE      ZERO,EXIT
          GOTO      KYTGL999
.
KYTGL900  MOVE      ONE,EXIT
KYTGL999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Type Graph Options            
.---------------------------------------------------------
WPTGL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Type Graph Options            
.---------------------------------------------------------
LMTGL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Type Graph Options            
.---------------------------------------------------------
DFTGL000
          BRANCH   ACCEPT,DFTGL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFTGL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFTGL900
          MATCH    PRGID,SCPSPID
          GOTO     DFTGL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFTGL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFTGL010 IF NOT EQUAL
.
          CALL     PSTGL000 * Display Field
          GOTO     DFTGL010
DFTGL900
DFTGL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Type Graph Options            
.---------------------------------------------------------
PSTGL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSTGL999,PSTGL999,PSTGL999,PSTGL101:
                            PSTGL102,PSTGL103,PSTGL104,PSTGL105:
                            PSTGL106,PSTGL107,PSTGL999,PSTGL999:
                           PSTGL999
          GOTO     PSTGL999
.
PSTGL101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDIR,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
.
PSTGL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIND,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
.
PSTGL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHCST,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
.
PSTGL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
.
PSTGL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
.
PSTGL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHBUD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
.
PSTGL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTGL999
PSTGL999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Type Graph Options            
.---------------------------------------------------------
SFTGL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFTGL001  BRANCH   ACCEPT,SFTGL020
.
SFTGL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFTGL006,SFTGL101,SFTGL102,SFTGL103:
                            SFTGL104,SFTGL105,SFTGL106,SFTGL107:
                            SFTGL108,SFTGL109,SFTGL006,SFTGL006:
                           SFTGL110
SFTGL006  BEEP
          GOTO     SFTGL005
SFTGL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFTGL090
          MATCH    PRGID,SCSLPID
          GOTO     SFTGL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFTGL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFTGL020,SFTGL020,SFTGL020,SFTGL103:
                            SFTGL104,SFTGL105,SFTGL106,SFTGL107:
                            SFTGL108,SFTGL109,SFTGL020,SFTGL020:
                           SFTGL020
          GOTO     SFTGL020
SFTGL090  MOVE     ZERO,ACCEPT
          GOTO     SFTGL001
.
SFTGL101
          CALL      EXITSET0
          MOVE      ZERO,EXIT
          GOTO      SFTGL999
.
SFTGL102
          CALL      CC37G000
          GOTO      SFTGL001
.
SFTGL103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHDIR00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL103
            ENDIF
            BRANCH    EXIT,SFTGL103,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDIR,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHIND00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL104
            ENDIF
            BRANCH    EXIT,SFTGL104,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIND,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHCST00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL105
            ENDIF
            BRANCH    EXIT,SFTGL105,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHCST,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHDBU00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL106
            ENDIF
            BRANCH    EXIT,SFTGL106,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHDBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHIBU00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL107
            ENDIF
            BRANCH    EXIT,SFTGL107,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHIBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHBUD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL108
            ENDIF
            BRANCH    EXIT,SFTGL108,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHBUD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFBU00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFTGL109
            ENDIF
            BRANCH    EXIT,SFTGL109,SFTGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFTGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFBU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFTGL001
.
SFTGL110
          CALL      EXITSET3
          MOVE      ZERO,EXIT
          GOTO      SFTGL999
SFTGL990  MOVE      ONE,EXIT * Exit Char Restart
SFTGL999  RETURN
.@@@@@ Function Restart Point @@@@@
.-----------------------------------------
. Read Costing System Parameters
.-----------------------------------------
RCCCO000  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;CCCOYEAR,CCCOPER,CCCODIR
          RETURN
.-----------------------------------------
. Read Period Description
.-----------------------------------------
RCCCA000
          PACK      KEY6,CCCOYEAR,CCCOPER
          CALL      RDCCCA1
          IF        OVRCD=1
            MOVE      "Invalid",CCCADES
          ENDIF
          RETURN
.
.
. Enter Key Enquiry Fields
.--------------------------
ECMOD000  BRANCH    STARTFLG,ECMOD200
.
ECMOD010  MOVE      ZERO,CKEYTYP
          MOVE      ONE,STARTFLG
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          CALL      CCSMOPCL    * Close Model
          CALL      KCCMAA00
          BRANCH    EXIT,ECMOD999,ECMOD999
.
          CALL      CCSMOPOP    * Open Model
          IF        EXIT=1
            MOVE      "Unable to Open Cost Model Files. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      ECMOD000
          ENDIF
          CALL      DPMOD000
.
ECMOD100  MOVE      "    3",FLDID
          CALL      GETPOSIT
          CALL      KCCHCA00
          BRANCH    EXIT,ECMOD010,ECMOD999
          CALL      DPHOS000
          GOTO      ECMOD300
.
ECMOD200  PACK      KEY4,CCMACOM
          CALL      RDCCMA1
.
          PACK      KEY2,CCHCHCD
          CALL      RDCCHC1
          CALL      DPMOD000
          CALL      DPHOS000
.
ECMOD300  MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCHCHCD,CCDPHCD
          CALL      KCCDPA00
          BRANCH    EXIT,ECMOD100,ECMOD999
.
ECMOD900  MOVE      "    1",FLDID
          CALL      GETPOSIT
.
ECMOD999  RETURN

DPMOD000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMACOM,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR
            CALL      DISPITEM
          ENDIF
          RETURN
.
DPHOS000  MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCHCD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCDES,VAR
            CALL      DISPITEM
          ENDIF
.
          RETURN

.--------------------------------------------------
. Production Analysis Selection from Notice Board
.--------------------------------------------------
CC37P000  MOVE      CCCOYEAR,CCCAYEAR
          MOVE      CCCOPER,CCCAPER
          PACK      KEY16,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER
          CALL      RDCCSD1
.
          ASSIGN    CCSDDIR+CCSDIND,TOTACT
          ASSIGN    CCSDDRB+CCSDINB,TOTBUD
.
          PACK      KEY6,CCCAYEAR,CCCAPER
          CALL      RDCCCA1
CC37P100
          CALL      SCP1L000
          BRANCH    EXITFLAG,CC37P200
          GOTO      CC37P900
CC37P200
          CALL      SCC2L000
          BRANCH    EXITFLAG,CC37P100,CC37P900,CC37P100
          GOTO      CC37P900
CC37P900
          IF        EXITFLAG=0
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------
. Calculate Ytd (Annual Amount)
.----------------------------------------
DPYTD000
          MOVE      ZERO,YTDDIR
          MOVE      ZERO,YTDDBU
          MOVE      ZERO,YTDIND
          MOVE      ZERO,YTDIBU
          MOVE      ZERO,YTDFBU
          MOVE      ZERO,YTDSTD
          MOVE      ZERO,YTDCHG
.
          PACK      KEY6,CCCOYEAR,SP70
          CALL      RSCCCA1
DPYTD100  CALL      RKCCCA1
          BRANCH    OVRCD,DPYTD200
          MATCH     CCCAYEAR,CCCOYEAR
          GOTO      DPYTD200 IF NOT EQUAL
.
          PACK      KEY16,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER
          CALL      RDCCSD1
          IF        OVRCD=1
            MOVE      ZERO,CCSDDIR
            MOVE      ZERO,CCSDIND
            MOVE      ZERO,CCSDCHG
            MOVE      ZERO,CCSDSTD
          ENDIF
          CALL      RDCCMC1
          IF        OVRCD=1
            MOVE      ZERO,CCMCDIR
            MOVE      ZERO,CCMCIND
            MOVE      ZERO,CCMCFLX
          ENDIF
          ADD       CCSDDIR,YTDDIR
          ADD       CCMCDIR,YTDDBU
          ADD       CCSDIND,YTDIND
          ADD       CCMCIND,YTDIBU
          ADD       CCMCFLX,YTDFBU
          ADD       CCSDSTD,YTDSTD
          ADD       CCSDCHG,YTDCHG
          GOTO      DPYTD100
DPYTD200
.
          ASSIGN    YTDDIR+YTDIND,YTDCST
          ASSIGN    YTDDBU+YTDIBU,YTDBUD
.
          ASSIGN    YTDDIR-YTDDBU,VYTDDIR
          ASSIGN    YTDIND-YTDIBU,VYTDIND
.
          ASSIGN    YTDCST-YTDBUD,VYTDCB
          ASSIGN    YTDCST-YTDFBU,VYTDCF
          ASSIGN    YTDCST-YTDSTD,VYTDCS
          ASSIGN    YTDCST-YTDCHG,VYTDCC
          ASSIGN    YTDBUD-YTDFBU,VYTDBF
          ASSIGN    YTDBUD-YTDSTD,VYTDBS
          ASSIGN    YTDBUD-YTDCHG,VYTDBC
          ASSIGN    YTDFBU-YTDSTD,VYTDFS
          ASSIGN    YTDFBU-YTDCHG,VYTDFC
          ASSIGN    YTDSTD-YTDCHG,VYTDSC
.
          ASSIGN    ((YTDDIR-YTDDBU)/YTDDBU)*100,PYTDDIR
          ASSIGN    ((YTDIND-YTDIBU)/YTDIBU)*100,PYTDIND
          ASSIGN    ((YTDCST-YTDBUD)/YTDBUD)*100,PYTDCB
          ASSIGN    ((YTDCST-YTDFBU)/YTDFBU)*100,PYTDCF
          ASSIGN    ((YTDCST-YTDSTD)/YTDSTD)*100,PYTDCS
          ASSIGN    ((YTDCST-YTDCHG)/YTDCHG)*100,PYTDCC
          ASSIGN    ((YTDBUD-YTDFBU)/YTDFBU)*100,PYTDBF
          ASSIGN    ((YTDBUD-YTDSTD)/YTDSTD)*100,PYTDBS
          ASSIGN    ((YTDBUD-YTDCHG)/YTDCHG)*100,PYTDBC
          ASSIGN    ((YTDFBU-YTDSTD)/YTDSTD)*100,PYTDFS
          ASSIGN    ((YTDFBU-YTDCHG)/YTDCHG)*100,PYTDFC
          ASSIGN    ((YTDSTD-YTDCHG)/YTDCHG)*100,PYTDSC
.
          RETURN
.
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Return to the start of the main screen without exiting the program.
. If EXITFLAG=0 set EXIT to 2 Restart
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSETA  MOVE      EXITFLAG,EXIT
          IF        EXIT=0
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.-----------------------------------------
. Calculations for Cost Analysis
.-----------------------------------------
CC37B000  PACK      KEY16,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER
          CALL      RDCCSD1
          IF        OVRCD=1
            MOVE      ZERO,CCSDDIR
            MOVE      ZERO,CCSDIND
            MOVE      ZERO,CCSDCHG
            MOVE      ZERO,CCSDSTD
          ENDIF
.
          CALL      RDCCMC1
          IF        OVRCD=1
            MOVE      ZERO,CCMCDIR
            MOVE      ZERO,CCMCIND
            MOVE      ZERO,CCMCFLX
          ENDIF
.
          ASSIGN    CCSDDIR+CCSDIND,CCTOTCST
          ASSIGN    CCMCDIR+CCMCIND,CCTOTBUD
.
          ASSIGN    CCSDDIR-CCMCDIR,CCVDCB
          ASSIGN    CCSDIND-CCMCIND,CCVICB
          ASSIGN    CCTOTCST-CCTOTBUD,CCVTCB
          ASSIGN    CCTOTCST-CCMCFLX,CCVTCF
          ASSIGN    CCTOTCST-CCSDSTD,CCVTCS
          ASSIGN    CCTOTCST-CCSDCHG,CCVTCC
          ASSIGN    CCTOTBUD-CCMCFLX,CCVTBF
          ASSIGN    CCTOTBUD-CCSDSTD,CCVTBS
          ASSIGN    CCTOTBUD-CCSDCHG,CCVTBC
          ASSIGN    CCMCFLX-CCSDSTD,CCVTFS
          ASSIGN    CCMCFLX-CCSDCHG,CCVTFC
          ASSIGN    CCSDSTD-CCSDCHG,CCVTSC
.
          ASSIGN    ((CCSDDIR-CCMCDIR)/CCMCDIR)*100,CCPVDCB
          ASSIGN    ((CCSDIND-CCMCIND)/CCSDIND)*100,CCPVICB
          ASSIGN    ((CCTOTCST-CCTOTBUD)/CCTOTBUD)*100,CCPVTCB
          ASSIGN    ((CCTOTCST-CCMCFLX)/CCMCFLX)*100,CCPVTCF
          ASSIGN    ((CCTOTCST-CCSDSTD)/CCSDSTD)*100,CCPVTCS
          ASSIGN    ((CCTOTCST-CCSDCHG)/CCSDCHG)*100,CCPVTCC
          ASSIGN    ((CCTOTBUD-CCMCFLX)/CCMCFLX)*100,CCPVTBF
          ASSIGN    ((CCTOTBUD-CCSDSTD)/CCSDSTD)*100,CCPVTBS
          ASSIGN    ((CCTOTBUD-CCSDCHG)/CCSDCHG)*100,CCPVTBC
          ASSIGN    ((CCMCFLX-CCSDSTD)/CCSDSTD)*100,CCPVTFS
          ASSIGN    ((CCMCFLX-CCSDCHG)/CCSDCHG)*100,CCPVTFC
          ASSIGN    ((CCSDSTD-CCSDCHG)/CCSDCHG)*100,CCPVTSC
          RETURN
.
.------------------------------------
. Calculate YTD Variance
.------------------------------------
CC30C000
.          ASSIGN   CCYTDCST-CCYTDBUD,CCYTDVAR
.          ASSIGN   ((CCYTDCST-CCYTDBUD)/CCYTDBUD)*100,CCYTDPVA
.          ASSIGN   YTDDIR-YTDDBU,CCYTDDVA
.          ASSIGN   ((YTDDIR-YTDDBU)/YTDDBU)*100,CCYTDDPV
.          ASSIGN   YTDIND-YTDIBU,CCYTDIVA
.          ASSIGN   ((YTDIND-YTDIBU)/YTDIBU)*100,CCYTDIPV
          RETURN
.------------------------------------
. Enter Year
.------------------------------------
EYEAR000   MOVE      "    2",FLDID
           CALL      GETPOSIT
           MOVE      SP70,CCCAPER
           CALL      KCCCAB00
           BRANCH    EXIT,EYEAR000,EYEAR000
           MOVE      CCCAYEAR,CCCOYEAR
           RETURN
.----------------------------------------
. Cost Analysis Period Selection
.----------------------------------------
CC37D000  CALL      RDCCCA1
          IF        OVRCD=1
            BEEP
            GOTO      CC37D999
          ENDIF
.
          PACK      KEY16,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER
          CALL      RDCCSD1
          IF        OVRCD=1
            MOVE      ZERO,CCSDDIR
            MOVE      ZERO,CCSDIND
            MOVE      ZERO,CCSDSTD
            MOVE      ZERO,CCSDCHG
          ENDIF
.
          CALL      RDCCMC1
          IF        OVRCD=1
            MOVE      ZERO,CCMCDIR
            MOVE      ZERO,CCMCIND
            MOVE      ZERO,CCMCFLX
          ENDIF
          ASSIGN    CCSDDIR+CCSDIND,TOTACT
          ASSIGN    CCMCDIR+CCMCIND,TOTBUD
CC37D100
          KEYIN     *P1:24,*EL,*V2LON,"P",*HOFF,"roduction or ":
                               *V2LON,"C",*HOFF,"ost Type Analysis ? ",ANS
          REP       UPPLOW,ANS
          MATCH     ANSP,ANS
          GOTO      CC37D200 IF EQUAL
          MATCH     ANSC,ANS
          GOTO      CC37D300 IF EQUAL
          BEEP
          GOTO      CC37D100

CC37D200
          CALL      SCP1L000    *  Production Analysis
          BRANCH    EXITFLAG,CC37D300
          GOTO      CC37D900
CC37D300
          CALL      SCC2L000    *  Cost Type Analysis
          BRANCH    EXITFLAG,CC37D200
          GOTO      CC37D900
CC37D900
          IF        EXITFLAG=0
            NORETURN
            CALL      FRESCR00
            MOVE      ZERO,EXIT
          ENDIF
.
CC37D999  RETURN
.
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET2  MOVE      TWO,EXITFLAG
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET3  MOVE      THREE,EXITFLAG
          RETURN
.------------------------------------------------------------------------------
. Setup Screen Exit Flag
.-----------------------
. This Routine is used to setup EXIT at the end of a Screen it should be used as
. a call after screen. EXITFLAG is set by other function in the screen to
. determine if the calling screen is to be redisplayed or exited.
. EXITFLAG= 0 Exit Screen
.           1 Return to Prompt
.           2 Restart
.           3 Restore Screen
.------------------------------------------------------------------------------
EXITSETF  MOVE      EXITFLAG,EXIT
          RETURN
.----------------------------------------
. Cost Period Analysis
.----------------------------------------
CC37E000  PACK      KEY20,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER,CCMBCTY
          CALL      RDCCDC1
          IF        OVRCD=1
            MOVE      ZERO,CCDCDIR
            MOVE      ZERO,CCDCIND
          ENDIF
.
          MOVE      CCMBCTY,KEY4
          CALL      RDCCCT1
.
          ASSIGN    CCDCDIR+CCDCIND,ACTTOT
          ASSIGN    CCMBDIR+CCMBIND,BUDTOT
.
          ASSIGN    CCDCDIR-CCMBDIR,VARDIR
          ASSIGN    CCDCIND-CCMBIND,VARIND
          ASSIGN    ACTTOT-BUDTOT,VARCB
          ASSIGN    ACTTOT-CCMBFLX,VARCF
          ASSIGN    BUDTOT-CCMBFLX,VARBF
.
          ASSIGN    ((CCDCDIR-CCMBDIR)/CCMBDIR)*100,PVADIR
          ASSIGN    ((CCDCIND-CCMBIND)/CCMBIND)*100,PVAIND
          ASSIGN    ((ACTTOT-BUDTOT)/BUDTOT)*100,PVACB
          ASSIGN    ((ACTTOT-CCMBFLX)/CCMBFLX)*100,PVACF
          ASSIGN    ((BUDTOT-CCMBFLX)/CCMBFLX)*100,PVABF
.
CC37E999  RETURN
.
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET0  MOVE      ZERO,EXITFLAG
          RETURN
.------------------------------------------------------------------------------
. Set Exit Flag
.-----------------------
. Call After Screen - EXITSETF
. EXITFLAG= 0 Exit Screen, 1 Return to Prompt, 2 Restart, 3 Restore Screen
.------------------------------------------------------------------------------
EXITSET1  MOVE      ONE,EXITFLAG
          RETURN
.--------------------------------------------------------------------
. Display Cost Analysis Graph for CCS37
.--------------------------------------------------------------------
CCGCST00  CALL    OPNGRAPH
.
          CLEAR   GPHNAME
          APPEND  "Cost Analysis - ",GPHNAME
          STRIP   CCDPDES
          APPEND  CCDPDES,GPHNAME
          RESET   GPHNAME
.
          MOVE    SEVEN,GPHNOCOX
          MOVE    SEVEN,GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
          IF      GPHDIR=1
            MOVE    "Direct Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHIND=1
            MOVE    "Indirect Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHCST=1
            MOVE    "Total Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHDBU=1
            MOVE    "Direct Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHIBU=1
            MOVE    "Indirect Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHBUD=1
            MOVE    "Total Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFBU=1
            MOVE    "Flexible Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHSTD=1
            MOVE    "Standard Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHCHG=1
            MOVE    "Charges",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHNTYP=GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
          IF      GPHNTYP>GPHNOCOY
            MOVE    GPHNTYP,GPHNOCOX
            MOVE    GPHNTYP,GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
.
          MOVE    ZERO,CCPERCNT
          DISPLAY   *P70:2,*BLINKON," Loading "
          PACK      KEY6,CCCOYEAR,Z70
          CALL      RSCCCA1
GRAPH100  CALL      RPCCCA1
          BRANCH    OVRCD,GRAPH200
.
          PACK      KEY16,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER
          CALL      RDCCSD1
          IF        OVRCD=1
            MOVE      ZERO,CCSDDIR
            MOVE      ZERO,CCSDIND
            MOVE      ZERO,CCSDCHG
            MOVE      ZERO,CCSDSTD
          ENDIF
          CALL      RDCCMC1
          IF        OVRCD=1
            MOVE      ZERO,CCMCDIR
            MOVE      ZERO,CCMCIND
            MOVE      ZERO,CCMCFLX
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          MOVE      CCCADES,KEY3
.
          UNPACK    CCCATDT,DIM2,KEY2
          PACK      SCGPDES,KEY3,SP1,KEY2     * mmm yy
          MOVE      ONE,F3
.
          IF        GPHDIR=1
            ASSIGN    CCSDDIR,CCTMTOT
            MOVE      CCTMTOT,SCGPVAL
            CALL      GRAPHWRT
          ENDIF
.
          IF      GPHIND=1
            ASSIGN   CCSDIND,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHCST=1
            ASSIGN   CCSDDIR+CCSDIND,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHDBU=1
            ASSIGN   CCMCDIR,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHIBU=1
            ASSIGN   CCMCIND,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHBUD=1
            ASSIGN   CCMCDIR+CCMCIND,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFBU=1
            ASSIGN   CCMCFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHSTD=1
            ASSIGN   CCSDSTD,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHCHG=1
            ASSIGN   CCSDCHG,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    GRAPH100
.
GRAPH200  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ZERO,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
GRAPHWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN

GPHDIR00  IF      GPHDIR=0
            MOVE    ONE,GPHDIR
          ELSE
            MOVE    ZERO,GPHDIR
          ENDIF
          RETURN
GPHIND00  IF      GPHIND=0
            MOVE    ONE,GPHIND
          ELSE
            MOVE    ZERO,GPHIND
          ENDIF
          RETURN
GPHCST00  IF      GPHCST=0
            MOVE    ONE,GPHCST
          ELSE
            MOVE    ZERO,GPHCST
          ENDIF
          RETURN
GPHDBU00  IF      GPHDBU=0
            MOVE    ONE,GPHDBU
          ELSE
            MOVE    ZERO,GPHDBU
          ENDIF
          RETURN
GPHIBU00  IF      GPHIBU=0
            MOVE    ONE,GPHIBU
          ELSE
            MOVE    ZERO,GPHIBU
          ENDIF
          RETURN
GPHBUD00  IF      GPHBUD=0
            MOVE    ONE,GPHBUD
          ELSE
            MOVE    ZERO,GPHBUD
          ENDIF
          RETURN
GPHFBU00  IF      GPHFBU=0
            MOVE    ONE,GPHFBU
          ELSE
            MOVE    ZERO,GPHFBU
          ENDIF
          RETURN
GPHSTD00  IF      GPHSTD=0
            MOVE    ONE,GPHSTD
          ELSE
            MOVE    ZERO,GPHSTD
          ENDIF
          RETURN
GPHCHG00  IF      GPHCHG=0
            MOVE    ONE,GPHCHG
          ELSE
            MOVE    ZERO,GPHCHG
          ENDIF
          RETURN
.--------------------------------------------------------------------
. Display Pat. Serv.by Period Analysis Graph for CCS37
.--------------------------------------------------------------------
CC37Z000
          MOVE    ZERO,F3
          ADD     GPQTY,F3
          ADD     GPBQT,F3
          ADD     GPACT,F3
          ADD     GPBUD,F3
          ADD     GPFBU,F3
          ADD     GPSTD,F3
          ADD     GPCHG,F3
          ADD     GPAA,F3
          ADD     GPAB,F3
          ADD     GPAF,F3
          ADD     GPAS,F3
          ADD     GPTCHG,F3
          ADD     GPBA,F3
          ADD     GPBB,F3
          ADD     GPBF,F3
          ADD     GPBS,F3
          IF      F3>9
            MOVE    "Only 9 Selections Possible - ",DISPMSG
            CALL    MESSAGE1
            RETURN
          ENDIF
.
          CALL    OPNGRAPH
.
          CLEAR   GPHNAME
          APPEND  "Period Analysis for Pat.Serv. ",GPHNAME
          STRIP   CCPDPCD
          APPEND  CCPDPCD,GPHNAME
          APPEND  SP1,GPHNAME
          STRIP   CCPDDES
          APPEND  CCPDDES,GPHNAME
          APPEND  SP1,GPHNAME
          RESET   GPHNAME
.
          MOVE    TEN,GPHNOCOX
          MOVE    TEN,GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
          IF      GPQTY=1
            MOVE    "Actual Qty",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBQT=1
            MOVE    "Budget Qty",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPACT=1
            MOVE    "Actual Unit Cst",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBUD=1
            MOVE    "Budget Unit Cst",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPFBU=1
            MOVE    "Flex Unit Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPSTD=1
            MOVE    "Std Unit Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPCHG=1
            MOVE    "Av. Charge/Unit",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAA=1
            MOVE    "Actual Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAB=1
            MOVE    "Act Qty * Bud",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAF=1
            MOVE    "Act Qty * Flx",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAS=1
            MOVE    "Act Qty * Std",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPTCHG=1
            MOVE    "Charged",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBA=1
            MOVE    "Bud Qty * Act",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBB=1
            MOVE    "Budget Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBF=1
            MOVE    "Bud Qty * Flx",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBS=1
            MOVE    "Bud Qty * Std",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          MOVE    ZERO,CCPERCNT
          DISPLAY *P70:2,*BLINKON," Loading "
.
          PACK    KEY6,CCCOYEAR,Z70
          CALL    RSCCCA1
CC37Z100  CALL    RPCCCA1
          BRANCH  OVRCD,CC37Z200
.
          PACK      KEY24,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER,CCPDPCD
          CALL      RDCCPS1
          IF        OVRCD=1
            MOVE      ZERO,CCPSQTY
            MOVE      ZERO,CCPSCST
            MOVE      ZERO,CCPSSCT
            MOVE      ZERO,CCPSCHG
          ENDIF
          CALL      RDCCME1
          IF        OVRCD=1
            MOVE      ZERO,CCMEQTY
            MOVE      ZERO,CCMECST
            MOVE      ZERO,CCMEFLX
          ENDIF
.
          ADD     ONE,CCPERCNT
          MOVE    CCPERCNT,SCGPPER
.
          MOVE    CCCADES,KEY3
          MOVE    CCCATDT,KEY4
          PACK    SCGPDES,KEY3,SP1,KEY4
          MOVE    ONE,F3
.
          IF      GPQTY=1
            ASSIGN   CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPBQT=1
            ASSIGN   CCMEQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPACT=1
            ASSIGN   CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPBUD=1
            ASSIGN   CCMECST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPFBU=1
            ASSIGN   CCMEFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPSTD=1
            ASSIGN   CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPCHG=1
            ASSIGN   CCPSCHG/CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPAA=1
            ASSIGN   CCPSQTY*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPAB=1
            ASSIGN   CCPSQTY*CCMECST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPAF=1
            ASSIGN   CCPSQTY*CCMEFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPAS=1
            ASSIGN   CCPSQTY*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPTCHG=1
            ASSIGN   CCPSCHG,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPBA=1
            ASSIGN   CCMEQTY*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPBB=1
            ASSIGN   CCMEQTY*CCMECST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPBF=1
            ASSIGN   CCMEQTY*CCMEFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
.
          IF      GPBS=1
            ASSIGN   CCMEQTY*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37ZWRT
          ENDIF
          GOTO    CC37Z100
.
CC37Z200  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ZERO,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
CC37ZWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN

GPQTY000  IF      GPQTY=0
            MOVE    ONE,GPQTY
          ELSE
            MOVE    ZERO,GPQTY
          ENDIF
          RETURN
GPBQT000  IF      GPBQT=0
            MOVE    ONE,GPBQT
          ELSE
            MOVE    ZERO,GPBQT
          ENDIF
          RETURN
GPACT000  IF      GPACT=0
            MOVE    ONE,GPACT
          ELSE
            MOVE    ZERO,GPACT
          ENDIF
          RETURN
GPBUD000  IF      GPBUD=0
            MOVE    ONE,GPBUD
          ELSE
            MOVE    ZERO,GPBUD
          ENDIF
          RETURN
GPFBU000  IF      GPFBU=0
            MOVE    ONE,GPFBU
          ELSE
            MOVE    ZERO,GPFBU
          ENDIF
          RETURN
GPSTD000  IF      GPSTD=0
            MOVE    ONE,GPSTD
          ELSE
            MOVE    ZERO,GPSTD
          ENDIF
          RETURN
GPCHG000  IF      GPCHG=0
            MOVE    ONE,GPCHG
          ELSE
            MOVE    ZERO,GPCHG
          ENDIF
          RETURN
GPAA0000  IF      GPAA=0
            MOVE    ONE,GPAA
          ELSE
            MOVE    ZERO,GPAA
          ENDIF
          RETURN
GPAB0000  IF      GPAB=0
            MOVE    ONE,GPAB
          ELSE
            MOVE    ZERO,GPAB
          ENDIF
          RETURN
GPAF0000  IF      GPAF=0
            MOVE    ONE,GPAF
          ELSE
            MOVE    ZERO,GPAF
          ENDIF
          RETURN
GPAS0000  IF      GPAS=0
            MOVE    ONE,GPAS
          ELSE
            MOVE    ZERO,GPAS
          ENDIF
          RETURN
GPTCHG00  IF      GPTCHG=0
            MOVE    ONE,GPTCHG
          ELSE
            MOVE    ZERO,GPTCHG
          ENDIF
          RETURN
GPBA0000  IF      GPBA=0
            MOVE    ONE,GPBA
          ELSE
            MOVE    ZERO,GPBA
          ENDIF
          RETURN
GPBB0000  IF      GPBB=0
            MOVE    ONE,GPBB
          ELSE
            MOVE    ZERO,GPBB
          ENDIF
          RETURN
GPBF0000  IF      GPBF=0
            MOVE    ONE,GPBF
          ELSE
            MOVE    ZERO,GPBF
          ENDIF
          RETURN
GPBS0000  IF      GPBS=0
            MOVE    ONE,GPBS
          ELSE
            MOVE    ZERO,GPBS
          ENDIF
          RETURN
.--------------------------------------------------
. Production Analysis (P1) Calculations
.--------------------------------------------------
CC37Q000
          PACK      KEY24,CCPDHCD,CCPDDPT,CCCAYEAR,CCCAPER,CCPDPCD
          CALL      RDCCPS1
          IF        OVRCD=1
            MOVE      ZERO,CCPSQTY
            MOVE      ZERO,CCPSCST
            MOVE      ZERO,CCPSSCT
            MOVE      ZERO,CCPSCHG
          ENDIF
          CALL      RDCCME1
          IF        OVRCD=1
            MOVE      ZERO,CCMEQTY
            MOVE      ZERO,CCMECST
            MOVE      ZERO,CCMEFLX
          ENDIF
.
          ASSIGN    CCPSCHG/CCPSQTY,AVECHG
.
. Actual Qty Total Calculations
.
          ASSIGN    CCPSQTY*CCPSCST,AQTACT
          ASSIGN    CCPSQTY*CCMECST,AQTBUD
          ASSIGN    CCPSQTY*CCMEFLX,AQTFBU
          ASSIGN    CCPSQTY*CCPSSCT,AQTSTD
.
. Budget Qty Total Calculations
.
          ASSIGN    CCMEQTY*CCPSCST,BQTACT
          ASSIGN    CCMEQTY*CCMECST,BQTBUD
          ASSIGN    CCMEQTY*CCMEFLX,BQTFBU
          ASSIGN    CCMEQTY*CCPSSCT,BQTSTD
.
. Quantity Variance Calculation
.
          ASSIGN    CCPSQTY-CCMEQTY,VQTYAB
          ASSIGN    ((CCPSQTY-CCMEQTY)/CCMEQTY)*100,PVQTYAB
.
. Unit Cost Variance Calculation
.
          ASSIGN    CCPSCST-CCMECST,VUCAB
          ASSIGN    CCPSCST-CCMEFLX,VUCAF
          ASSIGN    CCPSCST-CCPSSCT,VUCAS
          ASSIGN    CCPSCST-AVECHG,VUCAC
          ASSIGN    CCMECST-CCMEFLX,VUCBF
          ASSIGN    CCMECST-CCPSSCT,VUCBS
          ASSIGN    CCMECST-AVECHG,VUCBC
          ASSIGN    CCMEFLX-CCPSSCT,VUCFS
          ASSIGN    CCMEFLX-AVECHG,VUCFC
          ASSIGN    CCPSSCT-AVECHG,VUCSC
.
          ASSIGN    ((CCPSCST-CCMECST)/CCMECST)*100,PVUCAB
          ASSIGN    ((CCPSCST-CCMEFLX)/CCMEFLX)*100,PVUCAF
          ASSIGN    ((CCPSCST-CCPSSCT)/CCPSSCT)*100,PVUCAS
          ASSIGN    ((CCPSCST-AVECHG)/AVECHG)*100,PVUCAC
          ASSIGN    ((CCMECST-CCMEFLX)/CCMEFLX)*100,PVUCBF
          ASSIGN    ((CCMECST-CCPSSCT)/CCPSSCT)*100,PVUCBS
          ASSIGN    ((CCMECST-AVECHG)/AVECHG)*100,PVUCBC
          ASSIGN    ((CCMEFLX-CCPSSCT)/CCPSSCT)*100,PVUCFS
          ASSIGN    ((CCMEFLX-AVECHG)/AVECHG)*100,PVUCFC
          ASSIGN    ((CCPSSCT-AVECHG)/AVECHG)*100,PVUCSC
.
. Total Cost Variance Calculation
.
          ASSIGN    AQTACT-BQTBUD,VTCAB
          ASSIGN    AQTACT-AQTFBU,VTCAF
          ASSIGN    AQTACT-AQTSTD,VTCAS
          ASSIGN    AQTACT-CCPSCHG,VTCAC
          ASSIGN    BQTBUD-AQTFBU,VTCBF
          ASSIGN    BQTBUD-AQTSTD,VTCBS
          ASSIGN    BQTBUD-CCPSCHG,VTCBC
          ASSIGN    AQTFBU-AQTSTD,VTCFS
          ASSIGN    AQTFBU-CCPSCHG,VTCFC
          ASSIGN    AQTSTD-CCPSCHG,VTCSC
.
          ASSIGN    ((AQTACT-BQTBUD)/BQTBUD)*100,PVTCAB
          ASSIGN    ((AQTACT-AQTFBU)/AQTFBU)*100,PVTCAF
          ASSIGN    ((AQTACT-AQTSTD)/AQTSTD)*100,PVTCAS
          ASSIGN    ((AQTACT-CCPSCHG)/CCPSCHG)*100,PVTCAC
          ASSIGN    ((BQTBUD-AQTFBU)/AQTFBU)*100,PVTCBF
          ASSIGN    ((BQTBUD-AQTSTD)/AQTSTD)*100,PVTCBS
          ASSIGN    ((BQTBUD-CCPSCHG)/CCPSCHG)*100,PVTCBC
          ASSIGN    ((AQTFBU-AQTSTD)/AQTSTD)*100,PVTCFS
          ASSIGN    ((AQTFBU-CCPSCHG)/CCPSCHG)*100,PVTCFC
          ASSIGN    ((AQTSTD-CCPSCHG)/CCPSCHG)*100,PVTCSC
.
          RETURN
.
.--------------------------------------------------
. Production Analysis (P1) Selection
.--------------------------------------------------
CC37R000  CALL      RDCCPD1
          PACK      KEY6,CCCAYEAR,CCCAPER
          CALL      RDCCCA1
.
          CALL      CC37Q000   * Calculate Totals
.
CC37R010
          KEYIN     *P1:24,*EL,*V2LON,"U",*HOFF,"sage, ":
                               *V2LON,"P",*HOFF,"eriod or ":
                               *V2LON,"C",*HOFF,"ost Analysis  ? ":
                               *V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSU,ANS
          GOTO      CC37R100 IF EQUAL
          MATCH     ANSC,ANS
          GOTO      CC37R200 IF EQUAL
          MATCH     ANSP,ANS
          GOTO      CC37R300 IF EQUAL
          BEEP
          GOTO      CC37R010
.
CC37R100
          CALL      SCPUL000   * Patient Service Usage Selection
          BRANCH    EXITFLAG,CC37R200,CC37R300
          GOTO      CC37R900
CC37R200
          CALL      SCPCL000   * Patient Service Cost Selection
          BRANCH    EXITFLAG,CC37R100,CC37R300
          GOTO      CC37R900
CC37R300
          CALL      SCPPL000   * Pat. Serv.Period Selection
          BRANCH    EXITFLAG,CC37R100,CC37R200
          GOTO      CC37R900
CC37R900
          IF        EXITFLAG=0
            NORETURN
            CALL    FRESCR00
            MOVE    ZERO,EXIT
          ENDIF
          RETURN
.
.-----------------------------------------
. Modify Year/Period
.-----------------------------------------
CC37F000  DISPLAY   *P1:24,*EL,"Enter New Year/Period : "
          MOVE      "25",CCOL
          MOVE      "24",CVERT
          UNPACK    SP70,CCCAPER,CCCAYEAR
          MOVE      ZERO,CKEYTYP
          CALL      KCCCAB00
          BRANCH    EXIT,CC37F000,CC37F000
.
CC37F100
          MOVE      "30",CCOL
          DISPLAY   *P29:24,"/"
          MOVE      ZERO,CKEYTYP
          CALL      KCCCAA00
          BRANCH    EXIT,CC37F100,CC37F100
CC37F999
          PACK      KEY16,CCHCHCD,CCDPDPT,CCCAYEAR,CCCAPER
          CALL      RDCCSD1
          IF        OVRCD=1
            MOVE      ZERO,CCSDDIR
            MOVE      ZERO,CCSDIND
            MOVE      ZERO,CCSDCHG
            MOVE      ZERO,CCSDSTD
          ENDIF
.
          CALL      RDCCMC1
          IF        OVRCD=1
            MOVE      ZERO,CCMCDIR
            MOVE      ZERO,CCMCIND
            MOVE      ZERO,CCMCFLX
          ENDIF
.
          ASSIGN    CCSDDIR+CCSDIND,TOTACT
          ASSIGN    CCMCDIR+CCMCIND,TOTBUD
          RETURN
.--------------------------------------------------------------------
. Display Patient Service Analysis Graph for CCS37
.--------------------------------------------------------------------
GPHPG000
          MOVE    ZERO,F3
          ADD     GPQTY,F3
          ADD     GPBQT,F3
          ADD     GPACT,F3
          ADD     GPBUD,F3
          ADD     GPFBU,F3
          ADD     GPSTD,F3
          ADD     GPCHG,F3
          ADD     GPAA,F3
          ADD     GPAB,F3
          ADD     GPAF,F3
          ADD     GPAS,F3
          ADD     GPTCHG,F3
          ADD     GPBA,F3
          ADD     GPBB,F3
          ADD     GPBF,F3
          ADD     GPBS,F3
          IF      F3>9
            MOVE    "Only 9 Selections Possible - ",DISPMSG
            CALL    MESSAGE1
            RETURN
          ENDIF
.
          CALL    OPNGRAPH
.
          CLEAR   GPHNAME
          APPEND  "Patient Service Analysis - ",GPHNAME
          STRIP   CCDPDES
          APPEND  CCDPDES,GPHNAME
          APPEND  SP1,GPHNAME
          STRIP   CCCADES
          APPEND  CCCADES,GPHNAME
          APPEND  SP1,GPHNAME
          APPEND  CCCAYEAR,GPHNAME
          RESET   GPHNAME
.
          MOVE    TEN,GPHNOCOX
          MOVE    "20",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
          IF      GPQTY=1
            MOVE    "Actual Qty",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBQT=1
            MOVE    "Budget Qty",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPACT=1
            MOVE    "Actual Unit Cst",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBUD=1
            MOVE    "Budget Unit Cst",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPFBU=1
            MOVE    "Flex Unit Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPSTD=1
            MOVE    "Std Unit Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPCHG=1
            MOVE    "Av. Charge/Unit",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAA=1
            MOVE    "Actual Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAB=1
            MOVE    "Act Qty * Bud",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAF=1
            MOVE    "Act Qty * Flx",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPAS=1
            MOVE    "Act Qty * Std",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPTCHG=1
            MOVE    "Charged",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBA=1
            MOVE    "Bud Qty * Act",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBB=1
            MOVE    "Budget Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBF=1
            MOVE    "Bud Qty * Flx",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPBS=1
            MOVE    "Bud Qty * Std",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          MOVE    ZERO,CCPERCNT
          DISPLAY *P70:2,*BLINKON," Loading "
          PACK    KEY22,CCHCHCD,CCDPDPT,SP70
          CALL    RSCCPD4
GPHPG100  CALL    RKCCPD4
          BRANCH  OVRCD,GPHPG200
          MATCH   CCPDHCD,CCHCHCD
          GOTO    GPHPG200 IF NOT EQUAL
          MATCH   CCPDDPT,CCDPDPT
          GOTO    GPHPG200 IF NOT EQUAL
.
          PACK      KEY24,CCPDHCD,CCPDDPT,CCCAYEAR,CCCAPER,CCPDPCD
          CALL      RDCCPS1
          IF        OVRCD=1
            MOVE      ZERO,CCPSQTY
            MOVE      ZERO,CCPSCST
            MOVE      ZERO,CCPSSCT
            MOVE      ZERO,CCPSCHG
          ENDIF
          CALL      RDCCME1
          IF        OVRCD=1
            MOVE      ZERO,CCMEQTY
            MOVE      ZERO,CCMECST
            MOVE      ZERO,CCMEFLX
          ENDIF
.
          ADD     ONE,CCPERCNT
          MOVE    CCPERCNT,SCGPPER
          MOVE    CCPDDES,SCGPDES
          MOVE    ONE,F3
.
          IF      GPQTY=1
            ASSIGN   CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPBQT=1
            ASSIGN   CCMEQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPACT=1
            ASSIGN   CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPBUD=1
            ASSIGN   CCMECST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPFBU=1
            ASSIGN   CCMEFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPSTD=1
            ASSIGN   CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPCHG=1
            ASSIGN   CCPSCHG/CCPSQTY,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPAA=1
            ASSIGN   CCPSQTY*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPAB=1
            ASSIGN   CCPSQTY*CCMECST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPAF=1
            ASSIGN   CCPSQTY*CCMEFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPAS=1
            ASSIGN   CCPSQTY*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPTCHG=1
            ASSIGN   CCPSCHG,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPBA=1
            ASSIGN   CCMEQTY*CCPSCST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPBB=1
            ASSIGN   CCMEQTY*CCMECST,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPBF=1
            ASSIGN   CCMEQTY*CCMEFLX,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
.
          IF      GPBS=1
            ASSIGN   CCMEQTY*CCPSSCT,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     GPHPGWRT
          ENDIF
          GOTO    GPHPG100
.
GPHPG200  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ONE,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
GPHPGWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN
.--------------------------------------------------
. Proc Analysis Screen PP
.--------------------------------------------------
CC37N000  CALL      CC37Q000
          PACK      KEY6,CCCAYEAR,CCCAPER
          CALL      RDCCCA1
          MOVE      CCCADES,DIM3
          PACK      PERDESC,DIM3,SP1,CCCATDT
          RETURN
.
.--------------------------------------------------------------------
. Display Cost Type Analysis Graph for CCS37
.--------------------------------------------------------------------
CC37G000  CALL    OPNGRAPH
.
          CLEAR   GPHNAME
          APPEND  "Cost Type Analysis - ",GPHNAME
          STRIP   CCDPDES
          APPEND  CCDPDES,GPHNAME
          RESET   GPHNAME
.
          MOVE    TEN,GPHNOCOX
          MOVE    "20",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
          IF      GPHDIR=1
            MOVE    "Direct Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHIND=1
            MOVE    "Indirect Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHCST=1
            MOVE    "Total Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHDBU=1
            MOVE    "Direct Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHIBU=1
            MOVE    "Indirect Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHBUD=1
            MOVE    "Total Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFBU=1
            MOVE    "Flexible Budget",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          DISPLAY *P70:2,*BLINKON," Loading "
          MOVE    ZERO,CCPERCNT
          PACK    KEY20,CCSDHCD,CCSDDPT,CCSDYEAR,CCSDPER,SP70
          PACK    KEY16,CCSDHCD,CCSDDPT,CCSDYEAR,CCSDPER,SP70
          CALL    RSCCDC1
CC37G100
          CALL    RKCCDC1
          BRANCH  OVRCD,CC37G200
          PACK    KEY20,CCDCHCD,CCDCDPT,CCDCYEAR,CCDCPER,CCDCCTY
          MATCH   KEY20,KEY16
          GOTO    CC37G200 IF NOT EQUAL
          ADD     ONE,CCPERCNT
          MOVE    CCPERCNT,SCGPPER

          MOVE    CCDCCTY,KEY4
          CALL    RDCCCT1
          MOVE    CCCTDES,SCGPDES
          MOVE     ONE,F3
.
          IF      GPHDIR=1
            ASSIGN   CCDCDIR,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          IF      GPHIND=1
            ASSIGN   CCDCIND,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          IF      GPHCST=1
            ASSIGN   CCDCDIR+CCDCIND,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          IF      GPHDBU=1
            ASSIGN   CCDCDBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          IF      GPHIBU=1
            ASSIGN   CCDCIBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          IF      GPHBUD=1
            ASSIGN   CCDCDBU+CCDCIBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          IF      GPHFBU=1
            ASSIGN   CCDCFBU,CCTMTOT
            MOVE     CCTMTOT,SCGPVAL
            CALL     CC37GWRT
          ENDIF
.
          GOTO    CC37G100
.
CC37G200  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ONE,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
CC37GWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN

.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSBULIO/INC
          INC       CCSCALIO/INC
          INC       CCSCALKY    
          INC       CCSCMAIO/INC
          INC       CCSCMAKY    
          INC       CCSCMBIO/INC
          INC       CCSCMCIO/INC
          INC       CCSCMDIO/INC
          INC       CCSCMEIO/INC
          INC       CCSCMFIO/INC
          INC       CCSCONIO/INC
          INC       CCSCTYIO/INC
          INC       CCSDCOIO/INC
          INC       CCSDNOIO/INC
          INC       CCSDPTIO/INC
          INC       CCSDPTKY    
          INC       CCSHCDIO/INC
          INC       CCSHCDKY    
          INC       CCSMOPCD    
          INC       CCSPDPIO/INC
          INC       CCSPSDIO/INC
          INC       CCSPVRIO/INC
          INC       CCSSDCIO/INC
          INC       GPHSTDCD    
.
          INC       STDGENCD
.
