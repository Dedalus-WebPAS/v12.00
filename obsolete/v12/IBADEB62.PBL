.-----------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.07.01 08.12.2015  Steve Armstrong  CAR 324595
.           Replaced IHAPASFD with IBAPASFD
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-----------------------------------------------------------------------------
. VF.09.01  28.02.2002  Glenn Saunders   srf 15126
.           Re-compile for changes in DEBDKIKY
.-----------------------------------------------------------------------------
ASATXXX   DIM       8        * Date Outstanding must be > .
.                            * Calculated from X Days Outstanding & As At Date
BOUT      FORM      12.2
CFDBSQLA  DIM       20        77  Enquiries SQL Form A
CFDBSQLB  DIM       20        97  Enquiries SQL Form B
CODEDESC  DIM       35
COMMAND   DIM       127
ENDDAT    DIM       8
ENDDEB    DIM       8
ENDDEP    DIM       8
ENDNUM    DIM       12
ENDPTY    DIM       8
ENDUSR    DIM       4
F12P2     FORM      12.2
FALLDEP   FORM      1
FALLPTY   FORM      1
FILENAME  DIM       8
FOREXT    DIM       18
FORTAX    DIM       18
FORTOT    DIM       18
G30       FORM      12.2
G60       FORM      12.2
G90       FORM      12.2
GCUR      FORM      12.2
GOUT      FORM      12.2
INVTOTAL  FORM      12.2
ISBUILD   INIT      "isbuild "
LASTDEB   DIM       8
LASTFLG   FORM      1
LASTNUM   FORM      12
LASTSEQ   DIM       8
NEXTDEB   DIM       8
THISNUM   FORM      12
STRDAT    DIM       8
STRDEB    DIM       8
STRDEP    DIM       8
STRNUM    DIM       12
STRPTY    DIM       8
STRUSR    DIM       4
T30       DIM       13
T60       DIM       13
T90       DIM       13
TCUR      DIM       13
TOUT      DIM       13
TOTEXT    FORM      12.2
TOTTAX    FORM      12.2
.
DEBTMPA1  IFILE    SQL, FIXED=33, KEY="U1-8,9-16,17-17,18-29,30-32"
.
DBTMSEQ   DIM       8      8        1     Sequence
DBTMDEB   DIM       8      8        9     Debtor
DBTMDTY   DIM       1      1        17    Doc. Type 1=Inv, 2=Cr, 3=Pay, 4=Adj
DBTMDOC   DIM       12     12       18    Document Reference
DBTMDLN   DIM       3      3        30    Document Line Number
.
.End                                33
.-----------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB62
.   Function      :   Debtors Transaction Audit Report        
.   Generated  On :   08/12/2015
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBCODFD/INC
          INC       DEBDBTFD/INC
          INC       DEBDEPFD/INC
          INC       DEBDKIFD/INC
          INC       DEBFDTFD/INC
          INC       DEBFTHFD/INC
          INC       DEBITMFD/INC
          INC       DEBOUTDF    
          INC       DEBPTYFD/INC
          INC       IBAPASFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMNUM   DIM      12 * Scr 01 Fld     4
TONUM     DIM      12 * Scr 01 Fld     5
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB62"
PRGNAM    INIT      "Debtors Transaction Audit Report        "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   81",AUDTSECT
          MOVE      "  9",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudcd";
            OPEN      DEBAUDCD,"debaudcd"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debauddb";
            OPEN      DEBAUDDB,"debauddb"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudde";
            OPEN      DEBAUDDE,"debaudde"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudit";
            OPEN      DEBAUDIT,"debaudit"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA1,"debcodaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA2,"debcodaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA1,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA2,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA3,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA4,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA1,"debdepaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA2,"debdepaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA1,"debdkiaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA2,"debdkiaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA1,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA2,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA3,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA4,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA5,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA6,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA7,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA8,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA1,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA2,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA3,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA4,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA5,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA6,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA7,"debfthaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA1,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA2,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA3,"debitmaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS2,"ihapassf"          
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS3,"ihapassf"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Report Options                     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Sequencial Invoice Audit Report    
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Credit Note Audit Listing          
          ENDIF
          RETURN
.--------------------------------
. Screen - Report Options                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Report Options                     
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Report Options                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Report Options                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Report Options                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Report Options                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Report Options                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Report Options                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Sequencial Invoice Audit Report    
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      DEFPAR00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Sequencial Invoice Audit Report    
.-------------------------------------------------------
CF01L000  COMPARE   ZERO,ACCEPT
              GOTO      CF01L999 IF EQUAL
          MOVE      SP70,FROMNUM 
          MOVE      SP70,TONUM   
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Sequencial Invoice Audit Report    
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Sequencial Invoice Audit Report    
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Sequencial Invoice Audit Report    
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Sequencial Invoice Audit Report    
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Sequencial Invoice Audit Report    
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102
          GOTO     PS01L999
.
PS01L101
          MOVE      FROMNUM,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      TONUM,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Sequencial Invoice Audit Report    
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      IREP0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TONUM   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RNUM0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMNUM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TONUM,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Credit Note Audit Listing          
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      DEFPAR00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Credit Note Audit Listing          
.-------------------------------------------------------
CF02L000
          MOVE      SP70,FROMNUM 
          MOVE      SP70,TONUM   
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Credit Note Audit Listing          
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Credit Note Audit Listing          
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Credit Note Audit Listing          
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Credit Note Audit Listing          
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Credit Note Audit Listing          
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102
          GOTO     PS02L999
.
PS02L101
          MOVE      FROMNUM,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      TONUM,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Credit Note Audit Listing          
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      CREP0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TONUM   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RNUM0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMNUM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TONUM,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.@@@@@ Function Restart Point @@@@@
.---------------------------------------
. Setup Defaults
.---------------------------------------
DEFPAR00  MOVE      "Start      ",FROMNUM
          MOVE      "Finish     ",TONUM
          MOVE      SP70,STRNUM
          MOVE      Z70,ENDNUM
          RETURN
.
.------------------------------------------------------------
. Print Invoice Seq Report
.------------------------------------------------------------
IREP0000  MOVE      ZERO,CPAGENO
          MOVE      "99",CLNO
          CLOCK     TIME,CTIMEIS
.
          PACK      KEY21,STRNUM,SP70
          CALL      RSDBFH3
IREP0010  CALL      RKDBFH3       * Loop through by document number
          BRANCH    OVRCD,IREP9000
          MATCH     DBFHDOC,ENDNUM
          GOTO      IREP9000 IF LESS
          MATCH     "1",DBFHDTY   * Invoices Only
          GOTO      IREP0010 IF NOT EQUAL
          MOVE      DBFHDOC,LASTNUM
          SUB       ONE,LASTNUM
.
          PACK      KEY21,STRNUM,SP70
          CALL      RSDBFH3
IREP1000  CALL      RKDBFH3       * Loop through by document number
          BRANCH    OVRCD,IREP9000
          MATCH     DBFHDOC,ENDNUM
          GOTO      IREP9000 IF LESS
          MATCH     "1",DBFHDTY   * Invoices Only
          GOTO      IREP1000 IF NOT EQUAL
          MOVE      DBFHDOC,THISNUM
          SUB       ONE,THISNUM
          IF        THISNUM<>LASTNUM
            PRINT     "**********"
            ADD       ONE,CLNO
          ENDIF
          MOVE      DBFHDOC,LASTNUM
.
          CALL      ILIN0000      * Print Line
          GOTO      IREP1000      * Next Invoice
.
IREP9000  CALL      IEND0000
.
IREP9999  RETURN
.------------------------------------------------------------
. Print End of Report
.------------------------------------------------------------
IEND0000  COMPARE   ZERO,CPAGENO
          CALL      IHED0000 IF EQUAL
          MOVE      "999,999,999,999.99",FOREXT
          FEDIT     TOTEXT,FOREXT
          MOVE      "999,999,999,999.99",FORTAX
          FEDIT     TOTTAX,FORTAX
          MOVE      "999,999,999,999.99",FORTOT
          ASSIGN    TOTEXT+TOTTAX,F12P2
          FEDIT     F12P2,FORTOT
          CALL      UND132
          PRINT     "Report Total",*79,FOREXT,FORTAX,FORTOT
          CALL      UND132
          PRINT     *50,"*** End of Report ***"
          RETURN
.------------------------------------------------------------
. Print Invoice Line
.------------------------------------------------------------
ILIN0000  UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,KEY10
          UNPACK    DBFHCDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDEB,KEY8
          CALL      RDDBDB1
          UNPACK    DBFHCTIM,CHOUR,CMIN,KEY2
          MOVE      ":",KEY1
          PACK      KEY8,CHOUR,KEY1,CMIN,KEY1,KEY2
          MOVE      "999,999,999,999.99",FOREXT
          FEDIT     DBFHTOT,FOREXT
          MOVE      "999,999,999,999.99",FORTAX
          FEDIT     DBFHTAX,FORTAX
          MOVE      "999,999,999,999.99",FORTOT
          ASSIGN    DBFHTOT+DBFHTAX,F12P2
          FEDIT     F12P2,FORTOT
          UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY
          COMPARE   "55",CLNO
          CALL      IHED0000 IF NOT LESS
          MOVE      DBDBNA1,KEY24
          PRINT     DBFHDOC,*14,DBFHDEB,*23,KEY24,*48,KEY10,*59,CPCDATE:
                    *70,KEY8,*79,FOREXT,FORTAX,FORTOT
          ADD       ONE,CLNO
          ADD       DBFHTAX,TOTTAX
          ADD       DBFHTOT,TOTEXT
          RETURN
.------------------------------------------------------------
. Print Header
.------------------------------------------------------------
IHED0000  CALL      HEAD132
          DISPLAY   *P1:24,*EL,"Printing Page : ",CPAGENO
          PRINT     *40,"Invoice Audit Listing"
          PRINT     "Invoice From : ",FROMNUM," to ",TONUM
          CALL      UND132
          PRINT     "Invoice",*14,"Debtor",*50,"Date",*59,"Inp. Date":
                    *72,"Time",*91,"Ex Tax",*112,"Tax",*128,"Total"
          CALL      UND132
          ADD       TWO,CLNO
          RETURN
.
.--------------------------------------------------
. Enter Number Range
.--------------------------------------------------
RNUM0000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           KEYIN    *PCCOL:CVERT,*RV,*V2LON,*JR,*ZF,STRNUM
           MATCH    "000000000000",STRNUM
           GOTO     RNUM0100 IF EQUAL
           PACK     FROMNUM,STRNUM,SP70
           GOTO     RNUM0140
RNUM0100   MOVE     "Start             ",FROMNUM
           MOVE     SP70,STRNUM
.
RNUM0140   MOVE     FROMNUM,VAR
           CALL     DISPITEM
.
RNUM0150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           KEYIN    *PCCOL:CVERT,*RV,*V2LON,*JR,*ZF,ENDNUM
           MATCH    "000000000000",ENDNUM
           GOTO     RNUM0200 IF EQUAL
           PACK     TONUM,ENDNUM,SP70
           MATCH    STRNUM,ENDNUM
           GOTO     RNUM0999 IF EQUAL
           GOTO     RNUM0999 IF NOT LESS
           BEEP
           MOVE     "To Number Must Be > From Number - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RNUM0000
.
RNUM0200   MOVE     "Finish             ",TONUM
           MOVE     Z70,ENDNUM
.
RNUM0999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN
.
.------------------------------------------------------------
. Print Credit Note Seq Report
.------------------------------------------------------------
CREP0000  MOVE      ZERO,CPAGENO
          MOVE      "99",CLNO
          CLOCK     TIME,CTIMEIS
.
          PACK      KEY21,STRNUM,SP70
          CALL      RSDBFH3
CREP0010  CALL      RKDBFH3       * Loop through by document number
          BRANCH    OVRCD,CREP9000
          MATCH     DBFHDOC,ENDNUM
          GOTO      CREP9000 IF LESS
          MATCH     "2",DBFHDTY   * Cr Notes Only
          GOTO      CREP0010 IF NOT EQUAL
          MOVE      DBFHDOC,LASTNUM
          SUB       ONE,LASTNUM
.
          PACK      KEY21,STRNUM,SP70
          CALL      RSDBFH3
CREP1000  CALL      RKDBFH3       * Loop through by document number
          BRANCH    OVRCD,CREP9000
          MATCH     DBFHDOC,ENDNUM
          GOTO      CREP9000 IF LESS
          MATCH     "2",DBFHDTY   * Cr Notes Only
          GOTO      CREP1000 IF NOT EQUAL
          MOVE      DBFHDOC,THISNUM
          SUB       ONE,THISNUM
          IF        THISNUM<>LASTNUM
            PRINT     "**********"
            ADD       ONE,CLNO
          ENDIF
          MOVE      DBFHDOC,LASTNUM
.
          CALL      CLIN0000      * Print Line
          GOTO      CREP1000      * Next Invoice
.
CREP9000  CALL      CEND0000
.
CREP9999  RETURN
.------------------------------------------------------------
. Print End of Report
.------------------------------------------------------------
CEND0000  COMPARE   ZERO,CPAGENO
          CALL      CHED0000 IF EQUAL
          MOVE      "999,999,999,999.99",FOREXT
          FEDIT     TOTEXT,FOREXT
          MOVE      "999,999,999,999.99",FORTAX
          FEDIT     TOTTAX,FORTAX
          MOVE      "999,999,999,999.99",FORTOT
          ASSIGN    TOTEXT+TOTTAX,F12P2
          FEDIT     F12P2,FORTOT
          CALL      UND132
          PRINT     "Report Total",*79,FOREXT,FORTAX,FORTOT
          CALL      UND132
          PRINT     *50,"*** End of Report ***"
          RETURN
.------------------------------------------------------------
. Print Invoice Line
.------------------------------------------------------------
CLIN0000  UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,KEY10
          UNPACK    DBFHCDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      DBFHDEB,KEY8
          CALL      RDDBDB1
          UNPACK    DBFHCTIM,CHOUR,CMIN,KEY2
          MOVE      ":",KEY1
          PACK      KEY8,CHOUR,KEY1,CMIN,KEY1,KEY2
          MOVE      "999,999,999,999.99",FOREXT
          FEDIT     DBFHTOT,FOREXT
          MOVE      "999,999,999,999.99",FORTAX
          FEDIT     DBFHTAX,FORTAX
          MOVE      "999,999,999,999.99",FORTOT
          ASSIGN    DBFHTOT+DBFHTAX,F12P2
          FEDIT     F12P2,FORTOT
          UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY
          COMPARE   "55",CLNO
          CALL      CHED0000 IF NOT LESS
          MOVE      DBDBNA1,KEY24
          PRINT     DBFHDOC,*14,DBFHDEB,*23,KEY24,*48,KEY10,*59,CPCDATE:
                    *70,KEY8,*79,FOREXT,FORTAX,FORTOT
          ADD       ONE,CLNO
          ADD       DBFHTAX,TOTTAX
          ADD       DBFHTOT,TOTEXT
          RETURN
.------------------------------------------------------------
. Print Header
.------------------------------------------------------------
CHED0000  CALL      HEAD132
          DISPLAY   *P1:24,*EL,"Printing Page : ",CPAGENO
          PRINT     *40,"Credit Note Audit Listing"
          PRINT     "Credit Note From : ",FROMNUM," to ",TONUM
          CALL      UND132
          PRINT     "Invoice",*14,"Debtor",*50,"Date",*59,"Inp. Date":
                    *72,"Time",*91,"Ex Tax",*112,"Tax",*128,"Total"
          CALL      UND132
          ADD       TWO,CLNO
          RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBCODIO/INC
          INC       DEBDBTIO/INC
          INC       DEBDBTKY    
          INC       DEBDEPIO/INC
          INC       DEBDEPKY    
          INC       DEBDKIIO/INC
          INC       DEBDKIKY    
          INC       DEBDKIPR    
          INC       DEBFDTIO/INC
          INC       DEBFTHIO/INC
          INC       DEBITMIO/INC
          INC       DEBPTYIO/INC
          INC       DEBPTYKY    
          INC       IBAPASIO/INC
          INC       IBAPASKY    
.
          INC       STDGENCD
.
